<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS202384</article-id><article-id pub-id-type="doi">10.1101/2024.12.23.630099</article-id><article-id pub-id-type="archive">PPR959334</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Gene network organization, mutation and selection collectively drive developmental pattern evolvability and predictability</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Booth</surname><given-names>Harry</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hadjivasiliou</surname><given-names>Z.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04tnbqb63</institution-id><institution>The Francis Crick Institute</institution></institution-wrap>: Mathematical and Physical Biology Laboratory, <addr-line>1 Midland Road</addr-line>, <city>London</city>, <postal-code>NW1 1AT</postal-code>, <country country="GB">UK</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap>: Department of Physics and Astronomy, <addr-line>Gower Street</addr-line>, <city>London</city>, <postal-code>WC1E 6BT</postal-code>, <country country="GB">UK</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04ptp8872</institution-id><institution>London Centre for Nanotechnology</institution></institution-wrap>, <addr-line>19 Gordon Street</addr-line>, <city>London</city>, <postal-code>WC1H 0AH</postal-code>, <country country="GB">UK</country></aff><pub-date pub-type="nihms-submitted"><day>17</day><month>01</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>23</day><month>12</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">A hallmark of development is the generation of spatial patterns driven by morphogen gradients and Gene Regulatory Networks (GRNs). Although the mechanistic basis by which GRNs orchestrate cellular responses and tissue patterning during development is well understood, their evolutionary dynamics remain less clear. Still, mutations in regulatory elements that govern GRN-driven patterning are a key mechanism for patterning evolution. In this study, we use the <italic>de novo</italic> evolution of a stripe phenotype as a model framework to investigate the evolutionary dynamics associated with the emergence of new spatial gene expression boundaries and the adjustment of existing boundaries. To probe general principles of GRN-driven pattern evolution we introduce a new high-throughput theoretical framework that rapidly produces a comprehensive dataset of evolutionary trajectories. We leverage this large dataset to investigate the types of mutations that drive different phenotypic shifts in spatial patterning. Our findings suggest that the order in which mutations in gene-gene interactions appear, and the specific combination of gene-gene interactions that mutate together determine the evolvability of novel spatial gene expression patterns. We interpret our results in the context of epistatic effects that naturally arise in networks of interconnected genes, and show how contingencies and constraints emerge in our system. Our results elucidate the interplay between mutation and gene network organization, revealing how historical contingencies arise and impact the evolvability of GRNs and the predictability of their evolutionary outcomes.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">A central challenge in evolutionary developmental biology is to elucidate how phenotypic variation arises from underlying developmental mechanisms. At the core of development lies the spatial patterning of tissues into different cell types, driven by gene regulatory networks (GRNs) that interpret morphogen gradients<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. While the mechanistic basis of how GRNs influence spatial patterning during development is well-established, the interplay of these networks with evolutionary forces such as mutation, selection, and historical contingency remains poorly understood. Yet, several studies have revealed the critical role of GRNs in generating morphological variation both within and across species<sup><xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R6">6</xref></sup>, underscoring the importance of investigating their evolutionary dynamics in this developmental context.</p><p id="P3">Understanding how mutations at the sequence level impact GRN function and their evolutionary dynamics is a key milestone for the study of GRN-driven pattern evolution. The current consensus is that GRN evolution advances through mutations not in the regulatory genes or transcription factors (TFs) themselves, but in cis-regulatory elements (CREs) or enhancers that drive TF expression levels<sup><xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>. In this way pleiotropic effects associated with TF mutations are bypassed, while mutations in regulatory regions are able to generate variation for selection to act upon. Therefore, the ways in which mutations in CREs reorganize gene interactions and the associated GRN topology is central in understanding the evolution of GRNs and the spatial patterns they coordinate during development.</p><p id="P4">Recent work has investigated the role of point mutations in native CREs and the insertion of <italic>de novo</italic> CREs into a GRN controlling the patterning of fruit fly embryos. This revealed that the impact of mutations on the phenotype depends on whether mutations affect existing CREs or introduce new regulatory elements in the system<sup><xref ref-type="bibr" rid="R9">9</xref></sup>. New assays that allow targeted genetic manipulation of GRNs <italic>in vivo</italic> can generate large datasets of mutations at the regulatory and TF level linked to phenotypic shifts<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>. Furthermore, synthetic approaches to patterning network evolution offer promising tools for investigating the mechanistic role of genes, their interactions in patterning networks and impact on evolution<sup><xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R13">13</xref></sup>.</p><p id="P5">However, it is currently unfeasible to characterize the GRN re-organization which may result from high throughput experimental mutation assays at a scale large enough to extract common principles of network re-wiring in these systems. Furthermore, the difficulty of imposing a selection pressure for novel patterns in multicellular development means that the role of this network re-wiring within an evolutionary process is challenging to analyze. Hence, although new experimental tools promise to advance our understanding of the evolution of development, the complexity of GRN-driven patterning evolution, characterized by multi-scale, multi-component, and non-linear dynamics, coupled with the timescales over which evolutionary change occurs, present challenges that experimental tools alone may struggle to overcome. Since mutation arises at the sequence level, a comprehensive understanding how mutation drives network re-wiring must account for the complexity of the sequence-to-network mapping. However, this bottom-up approach to understanding patterning evolution can be complemented with a top down approach that focuses on genes and their network of interactions. More minimal, mechanistic models are tractable while having the potential to capture physical constraints emerging from the collective transcriptional dynamics, which are relevant in the evolution and diversification of patterning mechanisms. This approach requires a mechanistic description of GRN-driven patterning integrated with mutation and selection, and forms much of the motivation behind this work.</p><p id="P6">A related question and long standing debate in evolutionary biology is the relative role of stochasticity and constraints in determining evolutionary outcomes. Historical contingency during evolution describes a sensitivity to past events, that are often inconsequential at the time they occur, but that nonetheless impact subsequent evolution. This sensitivity becomes heightened when adaptation takes place on “rugged” fitness landscapes<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, a property which emerges through the complex, non-linear nature of many biological genotype-phenotype mappings<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. Whilst historical contingency has been investigated using evolutionary simulations in protein evolution<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, and in GRNs with simple evolved functions<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, these investigations have yet to be extended to genotype-phenotype maps defined by multicellular development processes such as patterning. For example, whilst it is known that spatial pattern accessibility is dependent on GRN topology<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>, we do not yet understand at what point in the evolution of new developmental patterns network constraints might become influential, or how these constraints interact with other evolutionary forces. For instance, neutral evolution - whereby mutations with little or no impact on the phenotype can accumulate - has been proposed as a potentially important force in GRN-driven pattern evolution<sup><xref ref-type="bibr" rid="R12">12</xref></sup>. But the ways in which nearly neutral mutations may impact future evolution and diversification of GRN topology and spatial patterns is not understood. Theoretically, multiple GRN topologies can drive the same spatial pattern at the tissue scale<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, which poses the question how and why certain patterning mechanisms may have evolved in preference to others.</p><p id="P7">Theoretical models of GRN-driven patterning have successfully captured the spatiotemporal patterning dynamics observed in various model systems, from the <italic>Drosophila</italic> embryo<sup><xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R22">22</xref></sup> to the vertebrate neural tube<sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>. While these models do not explicitly track genetic information at a molecular scale, they have provided crucial mechanistic insights into the fundamental characteristics and emergent properties of GRN patterning<sup><xref ref-type="bibr" rid="R25">25</xref>–<xref ref-type="bibr" rid="R27">27</xref></sup>, and offer a promising and tractable framework for exploring GRN-driven pattern evolution. Previous work integrating mechanistic GRN patterning models into evolutionary simulations has yielded valuable insights into the constraints and design principles that optimize specific phenotypic outcomes, or “fitness”<sup><xref ref-type="bibr" rid="R28">28</xref>–<xref ref-type="bibr" rid="R31">31</xref></sup>. For example, simulations have identified parsimonious paths in GRN space linking Dipteran species and their homologous relationships<sup><xref ref-type="bibr" rid="R32">32</xref></sup>, elucidated the design principles underlying body plan segmentation in flies<sup><xref ref-type="bibr" rid="R33">33</xref></sup>, and explored potential routes toward the <italic>de novo</italic> evolution of body segmentation<sup><xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R35">35</xref></sup>. This mechanism-centered approach highlights the central role of gene interactions and network topology – rather than individual genes – as key drivers of evolutionary processes. A common limitation of these approaches to date has been the efficiency at which they can generate evolutionary trajectories. As a result, previous studies have been limited to datasets of evolutionary repeats that were not large enough to investigate general principles of mutation and selection in a developmental context.</p><p id="P8">In this work we explore the interplay between mutation, gene network organization and natural selection in shaping the evolution of GRNs and developmental patterns. We specifically use stripe-forming networks as a framework to investigate how new gene expression boundaries are formed and how existing gene expression boundaries diversify. We present a high-throughput theoretical framework that integrates a mechanistic description of GRN patterning with evolutionary parameters. By leveraging the framework’s capacity to rapidly evolve target phenotypes, we produce an extensive dataset of independent evolutionary trajectories. This allows us to employ statistical tools to investigate general principles that emerge in our evolution experiments. By employing computational and machine learning techniques we 1) investigate the types of mutations that establish <italic>de novo</italic> gene expression boundaries in space, or refine existing boundaries and 2) build a predictive framework of GRN pattern evolution that we use to identify sources of contingency and convergence as gene networks evolve and complexify. In this way we were able to identify how constraints that emerge from the mutational process and current topology of a patterning GRN may impact developmental pattern evolvability. Our framework offers a powerful and adaptable platform for the investigation of GRN-driven pattern evolution, that has the potential to link physical constraints that emerge from genetic architecture to evolutionary change and diversification.</p></sec><sec id="S2" sec-type="methods"><title>Methods</title><sec id="S3"><title>A high-throughput framework for GRN evolution</title><p id="P9">We use the <italic>de novo</italic> evolution of a stripe as a model framework to investigate the evolutionary dynamics associated with the emergence of new spatial gene expression boundaries and the adjustment of existing boundaries. We consider a minimal GRN downstream of a morphogen and introduce mutation of the regulatory interactions between genes. Our theoretical framework encompasses three key components (<xref ref-type="fig" rid="F1">fig. 1</xref>): i) GRN-mediated spatial patterning, ii) mutation and fitness evaluation, and iii) a Monte-Carlo scheme which simulates an evolutionary trajectory.</p><p id="P10">We consider a 1-dimensional tissue composed of a discrete number of cells, over which a morphogen gradient is established (<xref ref-type="fig" rid="F1">fig. 1.A</xref>). Each cell has an identical GRN consisting of 3 genes {<italic>a, b, c</italic>}, with gene <italic>a</italic> activated by the morphogen, <italic>m</italic> (<xref ref-type="fig" rid="F1">fig. 1.A-B</xref>). The network is specified by a weight matrix <italic>W</italic> whose entries <italic>w</italic><sub><italic>ij</italic></sub> encode the pairwise regulatory interactions between genes (<xref ref-type="fig" rid="F1">fig. 1.B</xref>). We then assume that the concentration dynamics of gene product <italic>j</italic> in cell <italic>i</italic> ∈ {1, …, <italic>N</italic><sub>cells</sub>} satisfy <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula> <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="1em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M3"><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is a sigmoidal activation function with corresponding steepness parameter <italic>θ &gt;</italic> 0 and <italic>γ</italic><sub><italic>g</italic></sub> is the gene product degradation rate. This description of gene regulation is widely used in both theoretical and experimental studies of spatial patterning in biological systems<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R36">36</xref></sup>.</p><p id="P11">The evolutionary starting point in our simulations is given by an initial weight matrix, <italic>W</italic><sub>0</sub>, with a minimal number of non-zero interactions (<xref ref-type="fig" rid="F1">fig. 1.C</xref>), representing an initial state for network evolution. Subsequent mutation adds new regulatory interactions between genes, or adjusts the magnitude of existing ones. Thus, the weight matrix <italic>W</italic> represents the genotype in our model, and mutation acts directly on its entries to produce a mutant GRN.</p><p id="P12">Previous work has suggested that multiplicative weight changes most accurately represent the effect of point mutations on binding affinities in transcription factor (TF) binding sites<sup><xref ref-type="bibr" rid="R37">37</xref></sup>. We model this as <inline-formula><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> exp(<italic>k</italic>), where <italic>k</italic> is normally distributed with <inline-formula><mml:math id="M5"><mml:mrow><mml:mi>k</mml:mi><mml:mo>~</mml:mo><mml:mspace width="0.2em"/><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represent the regulatory effect of gene <italic>i</italic> on <italic>j</italic> before and after mutation respectively. Typically point mutations in binding sites decrease affinity<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup>, and so we set <italic>µ</italic><sub><italic>M</italic></sub> &lt; 0. Whilst point mutations can generate <italic>de novo</italic> regulatory interactions<sup><xref ref-type="bibr" rid="R39">39</xref></sup>, GRN evolution is thought to occur more efficiently though alternative mechanisms such as duplication<sup><xref ref-type="bibr" rid="R40">40</xref>,<xref ref-type="bibr" rid="R41">41</xref></sup> or co-option<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup>. Therefore, to enable mutations of larger effects we also consider additive weight changes such that <inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>k</italic> is normally distributed with <inline-formula><mml:math id="M9"><mml:mrow><mml:mi>k</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> This allows the distribution of weight change magnitudes <inline-formula><mml:math id="M10"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to be independent of the initial magnitude <inline-formula><mml:math id="M11"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> In particular additive mutations enable the introduction of novel interactions <inline-formula><mml:math id="M12"><mml:mrow><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mtext>i</mml:mtext><mml:mo>.</mml:mo><mml:mtext>e</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>→</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>≫</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> Furthermore, additive mutations enable the sign of a regulatory interaction to change from activating to inhibiting or vice versa.</p><p id="P13">To investigate the impact of mutations that change a single versus multiple gene interactions in the network, we assume that a single mutant may carry multiple weight changes simultaneously. We implement this by allowing each weight in <italic>W</italic> to change independently with probability <italic>p</italic>. This generates a distribution of weight changes per mutant dictated by <italic>p</italic> (SM, Section 1.2.1). Note that <italic>p</italic> could be interpreted to reflect constraints which emerge from the architecture of CREs and TF interactions, and is hence separate from the mutation rate. For instance, multiple weight changes could occur simultaneously when single mutations on the same CRE affect the binding affinity of multiple TFs, or when TFs themselves mutate. In this way, our framework is set up to investigate how constraints emerging from genetic architecture may impact evolutionary trajectories and evolvability. We return to the implications and biological interpretation of this assumption in the results section and the discussion.</p><p id="P14">We define a target stripe by a specific width and position (<xref ref-type="fig" rid="F1">fig. 1.A</xref>), and compute the fitness differential Δℱ of mutants relative to the resident phenotype (<xref ref-type="fig" rid="F1">fig. 1.C</xref>). The phenotype <italic>ϕ</italic> upon which selection acts is taken to be the steady-state expression of gene <italic>c</italic> (<xref ref-type="fig" rid="F1">fig. 1.A</xref>). Fitness is evaluated in a two-stage process employing two distinct fitness functions - ℱ<sub><italic>S</italic></sub> and ℱ<sub><italic>R</italic></sub>. ℱ<sub><italic>S</italic></sub> is an indicator function which recognizes the transition to a stripe by evaluating phenotypes against a set of general stripe criteria (see SM, Section 1.3). These conditions ensure a stripe-like pattern, but they do not enforce any particular boundary locations. ℱ<sub><italic>R</italic></sub> measures the average distance of the steady state expression of gene <italic>c</italic> to a target stripe pattern with specific boundaries. The target pattern is a stripe that splits the tissue into three equally sized parts (<xref ref-type="fig" rid="F1">fig. 1.A</xref>). Selection for this phenotype can be imposed through the following fitness functional: <disp-formula id="FD3"><label>(3)</label><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>ℱ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>L</italic> is the tissue length and <italic>γ</italic><sub><italic>g</italic></sub> is the gene product degradation rate. The first integral rewards high expression of the gene product in the central region of the tissue. This is then penalized by the average expression of the gene product in the neighboring regions. Finally, this is normalized into the range [−1, 1] by dividing by the upper bound on the difference between the first and second terms. The fitness differential Δℱ between the resident phenotype <italic>ϕ</italic> and mutant phenotype <italic>ϕ′</italic> is then evaluated as ℱ<sub><italic>S</italic></sub>(<italic>ϕ′</italic>) − ℱ<sub><italic>S</italic></sub>(<italic>ϕ</italic>) if ℱ<sub><italic>S</italic></sub>(<italic>ϕ′</italic>) ≠ ℱ<sub><italic>S</italic></sub>(<italic>ϕ</italic>) and ℱ<sub><italic>R</italic></sub>(<italic>ϕ′</italic>) − ℱ<sub><italic>R</italic></sub>(<italic>ϕ</italic>) otherwise. This choice is motivated by the fact a phenotype may display a stripe-like pattern whilst not necessarily having a close match in expression space to a stripe with specific boundaries. In these instances we assume its fitness to be higher than a phenotype with no stripe-like characteristics.</p><p id="P15">This combination of selection functions is designed to generate conditions that favor: 1) the generation of new gene expression boundaries and 2) the adjustment of the position of existing boundaries. In this way our evolutionary algorithm is set up to investigate the network re-organization, and associated mutations, necessary to evolve novel gene expression boundaries and adjust existing ones. The formation and adjustment of gene expression boundaries is a hallmark of developmental patterning and its evolution<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R42">42</xref></sup> and so this approach has the potential to yield general insights about the evolution of development.</p><p id="P16">We model monomorphic evolutionary dynamics with a sequential fixation model, by assuming that the rate at which mutants appear is lower than the time it takes for them to fix<sup><xref ref-type="bibr" rid="R43">43</xref>–<xref ref-type="bibr" rid="R45">45</xref></sup>. The Monte-Carlo scheme for an evolutionary trajectory is defined by the probability that a mutant fixes in a population of size <italic>P</italic><sub><italic>s</italic></sub>: <disp-formula id="FD4"><label>(4)</label><mml:math id="M14"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>β</mml:mi><mml:mtext>Δ</mml:mtext><mml:mi>ℱ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>P</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>β</mml:mi><mml:mtext>Δ</mml:mtext><mml:mi>ℱ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>β</italic> represents the strength of selection<sup><xref ref-type="bibr" rid="R46">46</xref></sup>. Refer to SM, Section 1 for further details on the dynamical equations, evolutionary algorithm and parameters used.</p></sec></sec><sec id="S4" sec-type="results"><label>1</label><title>Results</title><sec id="S5"><title>Multiple GRN topologies evolve following selection for stripe phenotype</title><p id="P17">We use the algorithm defined in the previous section to generate <italic>~</italic> 10<sup>5</sup> independent evolutionary trajectories from the initial conditions to the target phenotype. We start our analysis by developing a method to classify the stripe-forming mechanisms associated with networks that evolved across our simulations. To do this, we recorded the evolutionary trajectory <inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of accepted genotypes, where <italic>N</italic><sub><italic>i</italic></sub> is the total number of accepted mutants leading to the target phenotype for the <italic>i</italic><sup><italic>th</italic></sup> trajectory (<xref ref-type="fig" rid="F1">fig. 1.C</xref>). We found that 88.2% of our simulations converged to the target phenotype within 250,000 generations (SM, Section 4, Figure M8.A). Across evolutionary trajectories we defined four key stages; the first accepted mutant (<italic>n</italic> = 1), a period of pre-stripe formation for <italic>n</italic> ∈ (1, <italic>S</italic><sub>0</sub>), stripe inception at <italic>n</italic> = <italic>S</italic><sub>0</sub> and post-stripe formation for <italic>n</italic> ∈ (<italic>S</italic><sub>0</sub>, <italic>N</italic><sub><italic>i</italic></sub>]. Therefore, <italic>S</italic><sub>0</sub> is the mutant number for which a stripe first manifests (<xref ref-type="fig" rid="F2">fig. 2.A</xref>).</p><p id="P18">To classify the mechanistic outcomes of individual trajectories, we identified the minimal subset of regulatory interactions that maintain a basic stripe phenotype, which we term the <italic>minimal stripe topology (MST)</italic>. We determine the MST for the evolved networks at two key time points during evolution: the point of stripe formation, <italic>n</italic> = <italic>S</italic><sub>0</sub>, and the point at which the target stripe is achieved, <italic>n</italic> = <italic>N</italic><sub><italic>i</italic></sub>, and denote the MSTs at these two time points by <inline-formula><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M17"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> respectively (<xref ref-type="fig" rid="F1">fig. 1.C</xref> and SM, Section 1.6). Using this information we infer a distribution of unique evolutionary outcomes relating to the core mechanisms of stripe formation (<xref ref-type="fig" rid="F2">fig. 2.B</xref>). We identified a total of 732 unique MSTs, with the eight most frequent (MST:1-8) accounting for <italic>~</italic>75% of outcomes. The remaining MST outcomes occurred with a mean frequency of 0.034%, and hence this tail represents many different but rare outcomes. We discuss and interpret these rare MSTs and their relationship to MST:1-8 in the Supplementary Text (SM, Section 2).</p><p id="P19">MST:{1, 2, 5, 6, 7} feature the well-studied feed-forward incoherent type-2 (I2-FFL) mechanism, found in the gap gene network responsible for embryo segmentation in fruit flies<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R47">47</xref></sup>. MST:4 is the I3-FFL mechanism<sup><xref ref-type="bibr" rid="R48">48</xref></sup>, which has not been observed in natural stripe-forming regulatory networks but has been investigated synthetically<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. MST:{3, 8} feature a negative feedback loop with gene B serving as a controller to determine different responses across inputs, a mechanism which has been shown to enable perfect biochemical adaption<sup><xref ref-type="bibr" rid="R49">49</xref></sup>.</p><p id="P20">To illustrate that our MST classification captures essential differences in transcriptional dynamics, we solved each of the final networks to steady state and collected concentration profiles at intermediary times<sup><xref ref-type="bibr" rid="R19">19</xref></sup> (see SM, Section 1.7). These spatial snapshots of gene expression levels as steady state is approached generate a high-dimensional “fingerprint” for each evolved network and its dynamics (for an examples see Movie 1). A 2-D projection of these dynamical profiles indicates that networks are in general grouped dynamically according to their MST identity (<xref ref-type="fig" rid="F2">fig. 2.C</xref>). This suggests a correspondence between the essential gene interactions for basic stripe formation and the temporal dynamics of gene expression, driven by the complete and (often) more complex network.</p><p id="P21">In the example trajectory shown in <xref ref-type="fig" rid="F2">Figure 2.A</xref>, the MST associated with the initial and final stripe forming networks are the same <inline-formula><mml:math id="M18"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> Therefore, after the phenotypic transition to a stripe has been achieved, refinement of the boundaries occurred within the same mechanism. We found that this was often true across our simulations (<xref ref-type="fig" rid="F2">fig. 2.D</xref>). Analogously, developmental patterning typically involves deeply conserved networks, with species specific variations likely achieved through adjustment of interaction strengths<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R50">50</xref></sup>.</p><p id="P22">We identified 3 additional scenarios related to mechanism preservation across our simulations (<xref ref-type="fig" rid="F2">fig. 2.D</xref>). In some cases, the final mechanism contains additional but necessary interactions whilst maintaining the initial MST interactions <inline-formula><mml:math id="M19"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊂</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, representing “complexification” of the mechanism. Alternatively, the final mechanism represents a simplification of the original <inline-formula><mml:math id="M20"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊂</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, whereby core interactions have been removed without losing the stripe phenotype. Finally in rare cases a fundamental mechanistic shift occurs; at least one core interaction present in both the initial stripe forming network and final network differs in sign <inline-formula><mml:math id="M21"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊄</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊄</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> Whilst rare, this latter scenario echoes observations made in bacterial evolution experiments, in which GRNs were selected to have differing responses in a modulating environment<sup><xref ref-type="bibr" rid="R51">51</xref></sup>. Here, topological innovations were required to overcome conflicting objectives, while changes in regulatory strengths that preserved network topology were sufficient to drive evolution in the absence of conflict.</p><p id="P23">Overall, the distribution of stripe-forming mechanisms identified in our evolution experiments highlights the many-to-one aspect of the design space of stripe-forming mechanisms as found before<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. Our analysis also hints towards the differential accessibility of different stripe-forming mechanisms arising from the evolutionary process, possibly dictated by constraints that accumulate during evolution. In what follows we investigate how the mutational process interacts with GRN organization to drive and constrain network evolution and pattern innovation.</p></sec><sec id="S6"><title>New gene expression boundaries require multiple weight changes per mutant</title><p id="P24">To understand how mutation interacts with GRN organization and selection for novel patterns, we asked whether specific types of mutations were typically associated with the formation of new gene expression boundaries or the adjustment of existing ones. To this end, we first characterized the phenotypic transition associated with each accepted mutant. Given the mechanistic variation we observed in the final evolved networks (<xref ref-type="fig" rid="F2">fig. 2.B</xref>), we wondered whether there was similar variation in the phenotypic transitions produced through selection. To this end, we characterized the phenotypic transition associated with each accepted mutant.</p><p id="P25">We reasoned that there are three “routes” to a stripe pattern (<xref ref-type="fig" rid="F3">fig. 3.A</xref>). Starting from the shallow proximal boundary associated with the initial genotype, evolution can first establish a sharp proximal boundary followed by a sharp distal boundary through sequential mutants, do this in reverse, or establish both proximal and distal boundaries simultaneously (colored arrows in <xref ref-type="fig" rid="F3">fig. 3.A</xref>). In between establishing new boundaries, mutation and selection can continue to alter the phenotype, e.g. by adjusting the location or amplitude of existing boundaries (self loops in <xref ref-type="fig" rid="F3">fig. 3.A</xref>). Finally, mutants can be phenotypically neutral, creating no phenotypic changes and no fitness change compared to the resident phenotype.</p><p id="P26">We found that 98.8% of trajectories introduced the proximal boundary first followed by the distal boundary (<xref ref-type="fig" rid="F3">Figure 3.B</xref>). The vast majority (98.4%), establish a sharp proximal boundary with the first accepted mutant (<italic>n</italic> = 1), followed by adjustment of the newly formed proximal boundary to align it with that of the target stripe (1 &lt; <italic>n</italic> &lt; <italic>S</italic><sub>0</sub>). The distal boundary is established at <italic>n</italic> = <italic>S</italic><sub>0</sub>, with its location then similarly adjusted to match the target pattern during <italic>n &gt; S</italic><sub>0</sub>. The prominence of this phenotypic path is consistent with the initial network topology, in which the morphogen inhibits output gene <italic>c</italic> (orange) through the intermediary gene <italic>a</italic> (gray) (<xref ref-type="fig" rid="F1">fig. 1.C</xref>). This initial constraint means that creating the proximal boundary simply requires increasing positive feedback on gene <italic>c</italic>. Accordingly, <italic>~</italic> 96% of accepted mutations at <italic>n</italic> = 1 introduce a self-activation interaction on the output gene <italic>c</italic> (orange). The wait times associated with the acceptance of mutants in each evolutionary period indicate that the proximal boundary is typically established quickly (<xref ref-type="fig" rid="F3">fig. 3.C</xref>). In contrast, establishing the distal boundary at <italic>n</italic> = <italic>S</italic><sub>0</sub> takes orders of magnitude longer (<xref ref-type="fig" rid="F3">fig. 3.C</xref>). Therefore, despite the degeneracy in the genotype that underlies stripe formation identified in the previous section, phenotypic trajectories are highly stereotyped. These phenotypic trajectories reflect the accessibility of new gene expression boundaries imposed by gene interactions already present in the system at the onset of selection for a stripe-like pattern. Accordingly, altering the initial network configuration impacts the typical sequence of phenotypic transitions (fig.S1).</p><p id="P27">To understand what type of network changes typically produced each phenotypic transition, we characterized the types of weight changes carried by mutants accepted within each evolutionary stage (<xref ref-type="fig" rid="F3">fig. 3.D</xref>). Mutants accepted in periods 1 &lt; <italic>n</italic> &lt; <italic>S</italic><sub>0</sub> and <italic>n &gt; S</italic><sub>0</sub> primarily carry adjustments to existing weights, and weight changes during these periods are typically of small magnitude (<xref ref-type="fig" rid="F3">fig. 3.D-E</xref>). These periods are associated with the movement of existing boundaries, supporting the conclusion that the refinement of existing gene expression boundaries can be achieved through small adjustments to an existing network. In contrast, formation of new boundaries at <italic>n</italic> = 1 and <italic>n</italic> = <italic>S</italic><sub>0</sub> typically required the addition of novel regulatory interactions (i.e. new edges in the GRN; <xref ref-type="fig" rid="F3">fig. 3.D</xref>) and was often associated with weight changes of larger magnitude (<xref ref-type="fig" rid="F3">fig. 3.E</xref>). Additionally, distal boundary formation was frequently associated with a change in sign of an existing regulatory interaction, from inhibition to activation or vice versa (<xref ref-type="fig" rid="F3">fig. 3.D</xref>). Therefore our model suggests that generating novel gene expression boundaries typically requires more extensive network re-organization than the adjustment of existing boundaries. These findings are consistent with observations made in the fly embryo, whereby point mutations in existing enhancers led to changes in expression levels that were typically restricted to the WT pattern, whereas new patterning phenotypes emerged through insertion of novel enhancer elements<sup><xref ref-type="bibr" rid="R9">9</xref></sup>.</p><p id="P28">To investigate whether the number of weight changes in individual mutants impacts fitness, we next characterized the number of weight changes per accepted mutant in each evolutionary period (<xref ref-type="fig" rid="F3">fig. 3.F</xref>). Pre-selection, the probability of a single weight change, <italic>p</italic>, specifies a null distribution for the number of weight changes per mutant (crosses, <xref ref-type="fig" rid="F3">fig. 3.F[i]</xref> - for derivation see SM, Section 1.2.1). Post-selection this null distribution may be “rebalanced”, representing the number of weight changes carried by accepted mutants, and may be suggestive of a selective bias towards more or less weight changes (bars, <xref ref-type="fig" rid="F3">fig. 3.F[i]</xref>). Multiple weight changes in a single mutant could emerge due to correlations between binding affinities of different TFs to CREs, due to the proximity of their binding sites, cooperative or competitive effects<sup><xref ref-type="bibr" rid="R52">52</xref>–<xref ref-type="bibr" rid="R54">54</xref></sup>. Alternatively, in rare cases, two independent mutations at the sequence level may appear in the same mutant.</p><p id="P29">For <italic>n</italic> = 1 and <italic>n</italic> = <italic>S</italic><sub>0</sub> we noted a bias for more weight changes in accepted mutants in the post-selection distribution compared to the null distribution. The probability that a stripe-forming mutant carries only a single weight change is <italic>~</italic> 3%, compared to the null expectation of <italic>~</italic>60% (<xref ref-type="fig" rid="F3">fig. 3.F[i]</xref>). A similar bias, albeit less pronounced, is observed for <italic>n</italic> = 1 (<xref ref-type="fig" rid="F3">fig. 3.F[i]</xref>)). Conversely, the number of weight changes carried by mutants in periods 1 &lt; <italic>n</italic> &lt; <italic>S</italic><sub>0</sub> and <italic>n &gt; S</italic><sub>0</sub> follow the null distribution. Taken together, these results suggest that the generation of new gene expression boundaries requires interactions between multiple genes in the network to change simultaneously. Inversely, adjustment of existing boundaries is more readily achieved through single weight changes.</p><p id="P30">To investigate whether our results depend on how rarely two weight changes appear together, we repeated our analysis for smaller values of <italic>p</italic>, reducing the frequency at which multiple weight changes appear in the same mutant. Notably, the post-selection distribution of weight changes per mutant across the different evolutionary periods was invariant for smaller <italic>p</italic>, but the wait times for stripe inception increased as expected given the increasing rarity of the multiple mutation for smaller <italic>p</italic> (fig.S2.A-B). This finding suggests that the capacity to generate multiple weight changes at once may impact the evolvability of GRNs and the spatial patterns they regulate during development. We elaborate on possible constraints at the regulatory level that could therefore either hinder or facilitate pattern evolution in the discussion.</p><p id="P31">For each mutant carrying multiple weight changes we additionally evaluated the minimum number of weight changes that were strictly necessary to achieve the observed fitness gain (<xref ref-type="fig" rid="F3">fig. 3.F[ii]</xref>). This evaluation reveals 1) when multiple weight changes were strictly necessary for the original fitness gain and 2) when weight changes interact with one another to impact the phenotype. The quantification shown in <xref ref-type="fig" rid="F3">Figure 3.F[ii]</xref> reveals that many of the initial mutants (<italic>n</italic> = 1) carrying multiple weight changes achieve the associated fitness gain using only a single weight change. This is puzzling as the post-selection distribution of the number of weight changes per accepted mutant suggests a selective advantage for multiple weight changes. We reasoned that this selective advantage for multiple weight changes at <italic>n</italic> = 1 can be understood in the context of the minimality of the network at this stage of evolution. Because few interactions are initially present, new interactions are more likely to have no regulatory effect on the output gene and hence be phenotypically neutral. Introducing more weight changes merely increases the likelihood that an interaction between genes with a positive fitness effect is introduced (fig.S3).</p><p id="P32">Inversely, at <italic>n</italic> = <italic>S</italic><sub>0</sub>, the increasing number of weight changes carried by accepted mutants is necessary for the associated fitness advantage (<xref ref-type="fig" rid="F3">fig. 3.F[ii]</xref>). Given that multiple weight changes per mutant is a necessary feature for the evolution of new gene expression boundaries in our model, we sought to mechanistically understand how these interactions worked in combination to facilitate evolutionary trajectories. To this end, we investigated the quantitative effects of individual versus combined weight changes on fitness. Epistatic effects naturally arise within gene regulatory networks since by definition multiple genes interact to activate or inhibit other nodes in the network<sup><xref ref-type="bibr" rid="R55">55</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup>. Therefore, placing our analysis in the context of epispastic interactions is a promising framework for our analysis.</p></sec><sec id="S7"><title>Epistatic effects explain the need for multiple weight-changes</title><p id="P33">A broad definition of epistasis implies non-additive fitness effects between individual mutations<sup><xref ref-type="bibr" rid="R57">57</xref></sup>. Epistasis in our model emerges when the sum of the fitness changes associated with individual weight changes does not equal the fitness change induced by the combined weight change mutant. Epistatic effects can be classified into different types. In a 2-weight mutant which is adaptive (i.e. Δℱ &gt; 0), sign epistasis refers to a situation where at least one of the changes is deleterious in absence of the other. When both changes are deleterious individually this is known as reciprocal sign epistasis. Magnitude epistasis refers to the case where both individual changes are adaptive but together produce a fitness effect which differs from the sum of their individual contributions, and can be positive or negative<sup><xref ref-type="bibr" rid="R57">57</xref></sup> (for quantitative definitions see SM, Section 1.8.2).</p><p id="P34">To understand the role of these epistatic effects in our evolutionary process, we focused on mutants carrying two weight changes, and characterized their epistasis type across the four key evolutionary periods we have identified. Firstly, we noted that the frequency at which two-weight mutants exhibited epistasis increased as evolution progressed (<xref ref-type="fig" rid="F4">Figure 4.A</xref>). This is an intuitive result, as the addition of more interactions in a network creates dependencies between its connected components. Secondly, the point of stripe inception was strongly correlated with elevated sign and reciprocal sign epistasis, with the vast majority of two-weight mutants at this point in evolution showing some form of epistasis (<xref ref-type="fig" rid="F4">Figure 4.A</xref>).</p><p id="P35">To understand this, first note that stripe formation in our evolved networks is achieved largely through incoherent feed-forward or negative feedback loops (<xref ref-type="fig" rid="F2">fig. 2.B</xref>). Accordingly, at <italic>n</italic> = <italic>S</italic><sub>0</sub> nearly all (99.6%) trajectories carried at least one weight change in the regulatory pathway that connects the gene that is activated by the morphogen (gray) to the stripe forming gene (orange) via interactions with the third gene in the network (pink) (fig.S4). These connections are necessary to form a variant of feed-forward or feedback loop and hence to define the distal boundary.</p><p id="P36">To investigate why the formation of these mechanisms come hand-in-hand with epistatic effects, we examined the most frequent 2-weight mutants that led to stripe inceptions at n = <italic>S</italic><sub>0</sub> (fig.S5.A). Our data indicates that reciprocal sign epistasis frequently arises at <italic>n</italic> = <italic>S</italic><sub>0</sub> since gene <italic>b</italic> (pink) has an existing role in regulating the stripe forming gene <italic>c</italic> (orange) prior to stripe formation, either directly or through another gene (e.g <xref ref-type="fig" rid="F4">fig. 4.B</xref>, fig.S6.A). Therefore, any alteration of gene <italic>b</italic> activity must be appropriately compensated by the second mutation, else its individual effect is often deleterious. Sign epistasis at this point emerges when one of the two weight changes is neutral and the other is deleterious when introduced individually. To explain this observation, note that the construction of a feed-forward/feedback loop requires the inclusion of gene <italic>b</italic> (pink). However frequently just prior to stripe inception at <italic>n</italic> = <italic>S</italic><sub>0</sub> − 1 gene <italic>b</italic> has no existing regulatory effect on the phenotype (e.g <xref ref-type="fig" rid="F4">fig. 4.C</xref>, fig.S6.B). Therefore, any new regulatory interaction which alters gene <italic>b</italic> without additionally introducing an interaction between gene <italic>b</italic> and the stripe forming gene c (orange) will be neutral. It follows that an increased capacity for accepting neutral mutants may allow trajectories to bypass the constraints imposed by sign epistasis at stripe inception.</p><p id="P37">To test the effect of neutral evolution, we increased the likelihood of accepting neutral mutants, and restricted the mutational process to generate only single weight changes per mutant. In this high-drift regime mutants that provide no fitness advantage, and so are evolutionarily neutral, can fix at higher probability. Under these conditions, new gene expression boundaries at <italic>n</italic> = 1 and <italic>n</italic> = <italic>S</italic><sub>0</sub> were frequently established via the sequential fixation of a single weight change at a time (fig.S7,S8). So whilst a selective advantage exists for mutants which induce multiple regulatory changes simultaneously, neutral mutations and drift may contribute to the evolution of new gene expression boundaries. This occurs when weight changes of little or no effect on fitness accumulate simply by chance but provide a fitness advantage to future single-weight change mutants. In this way our findings suggest that neutral drift may contribute to the evolvability and diversification of GRN-driven patterning.</p><p id="P38">The overall increase of epistasis as evolution progressed in our model is to be expected, since stripe-forming mechanisms represent an increasingly connected set of regulatory interactions supporting non-linear patterning dynamics. Indeed the correct function of feed forward mechanisms involves precise interactions between participating genes<sup><xref ref-type="bibr" rid="R58">58</xref></sup>, which can arise through mechanistic requirements such as maintaining counter-balanced gene-gene interactions<sup><xref ref-type="bibr" rid="R59">59</xref></sup>. We reasoned that this increased mechanistic dependency between genes is likely to induce correlations in the underlying regulatory weight changes post selection. To test if this was true in our model, we calculated the weight changes <inline-formula><mml:math id="M22"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> induced by accepted 2-weight mutants, where <inline-formula><mml:math id="M23"><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We then measured the correlation <italic>ρ</italic> after grouping <inline-formula><mml:math id="M24"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by unique weight identity, MST and epistasis type (<xref ref-type="fig" rid="F4">fig. 4.E</xref>). As predicted, the correlations between weight changes are higher in the presence of epistasis and maximal in mutants that exhibit RSE (<xref ref-type="fig" rid="F4">fig. 4.F</xref>). Furthermore, we found that RSE was particularly enriched when considering weight changes within the MST sub-network (fig.S9). These findings echo previous theoretical work whereby the primary dynamics of biological systems and their evolution depend on a reduced set of system parameters, effectively constraining the possible directions along which evolutionary change can occur<sup><xref ref-type="bibr" rid="R60">60</xref>,<xref ref-type="bibr" rid="R61">61</xref></sup>.</p><p id="P39">Together these results indicate that epistatic effects strongly constrain evolutionary exploration in patterning evolution as has been demonstrated in other systems<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R62">62</xref>,<xref ref-type="bibr" rid="R63">63</xref></sup>. Therefore, regulatory constraints that induce dependencies between different gene-gene interactions may facilitate or hinder the evolutionary process. The effects of these dependencies on evolutionary paths is likely to depend on on whether the direction of increasing fitness and the induced correlations are orthogonal or parallel.</p></sec><sec id="S8"><title>Constraints and predictability during GRN evolution</title><p id="P40">In the context of evolution, epistasis is known to constrain evolutionary trajectories<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. In particular the presence of reciprocal sign epistasis (RSE) represents “valleys” in the fitness landscape, which are less likely to be crossed through natural selection, mutation and drift<sup><xref ref-type="bibr" rid="R62">62</xref>,<xref ref-type="bibr" rid="R63">63</xref></sup>. Moreover, epistasis has been shown to typically increase as evolution progresses<sup><xref ref-type="bibr" rid="R64">64</xref></sup>. Whilst epistasis has been identified in patterning networks<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R65">65</xref></sup>, its emergence in a mechanistic context and its association with specific network changes within an evolutionary process is relatively unexplored. Epistasis also provides an important context for the classic question of historical contingency<sup><xref ref-type="bibr" rid="R66">66</xref></sup>, in which early chance mutations can restrict evolutionary paths<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R59">59</xref>,<xref ref-type="bibr" rid="R67">67</xref>,<xref ref-type="bibr" rid="R68">68</xref></sup>, committing evolution to particular yet highly contingent outcomes.</p><p id="P41">We therefore wondered to what extent future evolutionary paths in our model become contingent upon the weight changes accepted in intermediate steps. Whilst it is theoretically understood that evolutionary paths in high dimensional genotype spaces become increasingly constrained as evolution progresses,<sup><xref ref-type="bibr" rid="R69">69</xref></sup>, the mechanistic underpinnings of this phenomena, particularly in the context of complex developmental mechanisms, is not clear<sup><xref ref-type="bibr" rid="R70">70</xref></sup>. Our framework generates a large number of evolutionary trajectories at high efficiency. Thus, we can obtain data sets that are sufficiently large to investigate the predictability of evolution using statistical methods. Using our large dataset of trajectories, we next aimed to identify mutations that hold a pivotal role in influencing evolutionary outcomes, despite the inherent randomness within the evolutionary process.</p><p id="P42">We built a predictive model of MST outcome given the regulatory interactions present at any point in an evolutionary trajectory. We set a prediction task that can be described as follows. Given an evolutionary trajectory which has not yet achieved a stripe, predict a set of probabilities representing the likelihood of each possible mechanistic outcome (MST). In other words, given some partial trajectory of genotype evolution <inline-formula><mml:math id="M25"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="M26"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> we want to predict a set of probabilities <inline-formula><mml:math id="M27"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>N</italic><sub><italic>T</italic></sub> is the number of MSTs identified and <inline-formula><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability that the MST associated with the stripe forming mutant at <italic>n</italic> = <italic>S</italic><sub>0</sub> is the j-th MST. This is a probabilistic classification task, where the history of the evolutionary process up until the prediction point constitutes the explanatory features, and the initial MST at <italic>n</italic> = <italic>S</italic><sub>0</sub> represents the “class outcome”. The learning problem simplifies considerably under the observation that our evolutionary process is Markov, and therefore given a partial trajectory <inline-formula><mml:math id="M29"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the most recent state <inline-formula><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is all that is required to make a prediction about the future. We can then use the trained classifier to yield probabilities for the different MST outcomes given the evolved network at any point in a trajectory. For the purpose of training a probabilistic classifier we limited ourselves to the top 4 MST’s (65.4% of trajectories; <xref ref-type="fig" rid="F2">fig. 2.B</xref>), with an additional “Other” category representing the remaining MST examples (34.6%). Further details of the training procedure can be found in SM, Section 1.9.</p><p id="P43">An example trajectory and its associated predictions is shown in <xref ref-type="fig" rid="F5">Figure 5.A</xref>. This trajectory consisted of four accepted mutants before stripe inception at <italic>n</italic> = <italic>S</italic><sub>0</sub> = 4. The initial prediction <italic>p</italic><sup>(<italic>i</italic>)</sup>(0) simply reflects the proportion of each MST observed in the train-set - the null prediction learned by the model in absence of any information on the further evolution of the network. Following the first accepted mutant a new prediction, <italic>p</italic><sup>(<italic>i</italic>)</sup>(1), indicates that the network changes have increased the likelihood that MST:1 will be adopted at the point of stripe formation. Following the second accepted mutant MST:4 becomes the most likely outcome, and forms a correct prediction which persists until <italic>S</italic><sub>0</sub>. We describe a mutant which changes the MST outcome prediction as branching (see SM, Section 1.9). Therefore in the above example, the second mutant was branching. In this way our model suggests that a single mutant can drastically change the likely evolved stripe-forming mechanism. These types of mutants are important since they represent the incorporation of regulatory constraints which change the likely path of evolution. Therefore, this quantitative framework allows network changes driving specific mechanistic outcomes to be identified automatically at a large scale.</p><p id="P44">In general we were able to predict final MST outcome prior to <italic>S</italic><sub>0</sub>, with a good out-of-sample predictive performance given relatively few network modifications (<xref ref-type="fig" rid="F5">fig. 5.B</xref>, SM, Fig.M1). Interestingly, the predictive performance of the model deteriorated significantly when only topological information was considered by the classifier (<xref ref-type="fig" rid="F5">fig. 5.B[i]</xref> versus [ii]), indicating that network topology alone is not sufficient for determining the likely path of evolution and that the magnitude of the interactions between genes matter.</p><p id="P45">We quantified the statistical entropy, <italic>H</italic>(·), associated with the predicted probabilities <italic>p</italic><sup>(<italic>i</italic>)</sup>(<italic>k</italic>) changes as mutants fix (<xref ref-type="fig" rid="F5">Figure 5.A</xref>). Interpreting the entropy as a measure of uncertainty inherent to the MST outcome, this example highlights the intuitive notion that uncertainty decreases as evolution progresses. We found this to be a general principle, with mutants and their corresponding network changes most often decreasing uncertainty in eventual MST outcome (fig.S10.A-B). This is in agreement with previous work showing that the space of possible evolutionary paths that a trait can take tends to narrow during its evolutionary history<sup><xref ref-type="bibr" rid="R70">70</xref>,<xref ref-type="bibr" rid="R71">71</xref></sup>. Despite this been an intuitive and established result for abstract genotype-phenotype models<sup><xref ref-type="bibr" rid="R69">69</xref></sup>, our analysis identifies possible mechanistic origins for these constraints in the context of developmental GRNs.</p><p id="P46">We then wondered whether we could steer evolution towards a particular MST outcome by “engineering” the initial mutant. We used the predictive model to identify initial (<italic>n</italic> = 1) mutants that were branching towards a specific MST outcome and identified the branching mutant producing the largest negative entropy change, implying a highly certain mechanistic prediction. To aid tractability, we focused on mutants carrying 2 weight changes relative to the initial network. The mutants found through this procedure for MST:2 and MST:3 both induce the same change in fitness and hence have an equal probability of fixation (<xref ref-type="fig" rid="F5">fig. 5.C[i]</xref>). Interestingly, these mutants induce the same topological change, however differences in the weight values result in alternative mechanistic predictions (<xref ref-type="fig" rid="F5">fig. 5.C[ii]</xref>). We then imposed the identified mutations at <italic>n</italic> = 1 and simulated 5000 independent trajectories from these new initial conditions. In both instances evolution was steered towards the predicted mechanism (<xref ref-type="fig" rid="F5">fig. 5.C[iii-iv]</xref>). Similar results were observed for mutations predicted to steer evolution towards other MSTs (fig.S11). These findings suggest that regulatory interactions incorporated early in network evolution could significantly bias evolution towards a specific mechanistic outcome.</p><p id="P47">Recall that multiple weight changes were often selected for together at the fist accepted mutant (<italic>n</italic> = 1), not all of which were strictly necessary (<xref ref-type="fig" rid="F3">Fig. 3 F</xref>). Each adaptive weight change at <italic>n</italic> = 1 therefore likely fixed with a non-adaptive weight change, reminiscent of genetic hitchhiking whereby neutral or slightly deleterious mutations appear together with a beneficial mutation and increase in frequency as a result<sup><xref ref-type="bibr" rid="R72">72</xref></sup>. Neutral or nearly neutral network changes may provide a reservoir of cryptic genetic variation for subsequent evolution<sup><xref ref-type="bibr" rid="R73">73</xref></sup>, which enables paths to new adaptive genotypes and creates historical contingency in protein evolution<sup><xref ref-type="bibr" rid="R74">74</xref></sup>. We explore this idea in the context of regulatory evolution by using our predictive model to identify which weight changes carried by a mutant contributes most strongly to its mechanistic prediction.</p><p id="P48">For each weight change we produce a prediction attribution, Φ, which quantifies to what extent an individual weight change shifts the prediction for the MST outcome of evolution (see SM, Section 1.9.5). To then identify the relative importance of the hitchhiking versus adaptive weight change in each mutant, we calculate the ratio Φ<sub>carrier</sub>/Φ<sub>hitchhike</sub>. In the majority of cases, the hitchhiking weight change is far more instrumental in determining the mechanistic outcome than the weight change associated with the carrier (<xref ref-type="fig" rid="F5">fig. 5.E</xref>). This suggests that regulatory networks may accumulate mutations which are selectively-neutral but nonetheless significantly alter the course of subsequent evolution. A similar conclusion has been reached experimentally in a transcription network that controls the response to mating pheromone in yeast<sup><xref ref-type="bibr" rid="R75">75</xref></sup>, where the gain of a neutral regulatory interaction permitted changes in the overlapping circuit responsible for pheromone induction.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P49">In this work we have examined how developmental mechanisms interact with evolutionary processes. By placing GRNs in an evolutionary context we have investigated how gene network organization, mutation and natural selection together determine evolutionary outcomes. Changes at the regulatory level is a fundamental avenue through which developmental patterns diversify during evolution<sup><xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>. Although our analysis focuses on evolving stripes, forming and adjusting gene expression boundaries is fundamental to developmental patterning and its evolution. Therefore, our findings and conceptual framework may offer general insights towards a mechanistic understanding of how regulatory networks that drive spatial patterns emerge and diversify.</p><p id="P50">By framing the evolution of a stripe in gene expression levels as successively establishing and adjusting sharp gene expression boundaries, we identified network modifications commonly linked with specific phenotypic innovations. Our findings suggest that adjustments of existing boundaries typically occur through smaller changes in the strength of existing gene interactions. Inversely, novel boundaries are achieved through mutations that impact multiple gene interactions and have a larger effect on network organization. These findings are consistent with recent mutagenic studies in <italic>Drosophila</italic> embryos<sup><xref ref-type="bibr" rid="R9">9</xref></sup> where point mutations on native enhancers rarely resulted in expression outside of the native pattern, whereas inserting <italic>de novo</italic> enhancer elements often drove novel patterns. Our model offers a mechanistic theoretical framework to interpret these experimental observations. Point mutations in binding sites or TF coding regions typically induce smaller changes in transcription rates<sup><xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R76">76</xref></sup>, whereas larger changes can arise through whole enhancer duplication<sup><xref ref-type="bibr" rid="R77">77</xref></sup>. Alternatively, a novel enhancer element may induce a new regulatory interaction into the network<sup><xref ref-type="bibr" rid="R78">78</xref></sup>. Therefore, although we do not explicitly model gene regulation at the sequence level, our model is able to capture key aspects of GRN response to mutation and corresponding phenotypic shifts.</p><p id="P51">The capacity to generate changes in multiple gene interactions within the same mutant was crucial to forming and adjusting gene expression boundaries in our model. In our analysis, we have placed this observation in the context of functional epistasis, that is known to characterize patterning GRNs<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R65">65</xref></sup>. Accordingly, epistatic effects were prominent throughout evolutionary simulations. Specifically, sign and reciprocal sign epistasis, whereby two changes in gene interactions are adaptive only when they appear in the same mutant, were key to the formation of new gene expression boundaries and boundary adjustment at later stages of evolution when the core network becomes established. The ubiquitous presence of these epistatic effects across more than 10<sup>5</sup> independent evolution trajectories indicates that they may be a general property of GRN-driven pattern evolution. Given this prevalence of epistasis in our analysis, we speculate on its possible implications for the evolvability of GRN-driven patterning mechanisms.</p><p id="P52">A pervasiveness of sign and reciprocal sign epistasis during GRN evolution implies that the capacity to generate adaptive mutants depends on the likelihood of generating single mutants where multiple gene interactions change. Therefore the evolvability of GRN-driven patterning, broadly defined as the ease with which new phenotypes are accessed, depends on the genetic constraints which determine how likely multiple gene interactions are to change together in single mutants. Indeed convergence rates in our simulations correlated with the likelihood of generating multiple weight changes at once. A key question then becomes: how does the molecular basis of transcription and regulation interact with mutation to re-wire regulatory networks?</p><p id="P53">Experimental work has characterized the evolutionary potential of mutations at the TF level for network rewiring<sup><xref ref-type="bibr" rid="R53">53</xref></sup> and the role of enhancers in introducing novel genes into a regulatory network<sup><xref ref-type="bibr" rid="R78">78</xref></sup>. In our model, specific combinations of gene interactions were selected for together and in a highly correlated manner. Could genetic architecture itself facilitate the correlations that are necessary to resolve these constraints and hence facilitate the evolution of patterning GRNs? For example, theoretical work in a class of genetic algorithms suggests that correlations in system parameters may enable mutations to align optimally with the contours of a fitness landscape, resulting in faster convergence towards fitness optima<sup><xref ref-type="bibr" rid="R79">79</xref></sup>. In a regulatory network, these type of correlated changes could arise through mutations in enhancer binding sites with cooperative or competitive effects, or when binding sites of independent TFs are in proximity of one another<sup><xref ref-type="bibr" rid="R52">52</xref>,<xref ref-type="bibr" rid="R54">54</xref></sup>. Our work provides ground for studying these effects and their potential role in the evolution of patterning mechanisms. Advances in synthetic biology are beginning to shed light on how fragments on individual enhancers drive TF expression by engineering synthetic CREs and screening for their function<sup><xref ref-type="bibr" rid="R80">80</xref></sup>. This approach could be combined with our framework in the future to elucidate how the logical rules that underlie enhancer signaling impact GRN-driven spatial pattern evolution. Furthermore, insights from theoretical frameworks that study regulatory evolution by modeling mutation at the sequence level<sup><xref ref-type="bibr" rid="R81">81</xref></sup> could be incorporated in our framework to explore their consequences for patterning evolution.</p><p id="P54">We showed that in principle neutral drift could bypass epistatic constraints by allowing the accumulation of multiple weight changes in the same individual sequentially. Therefore in spite of the strong preference for multiple weight changes, we saw successful stripe evolution using only single weight changes given an increased propensity for neutral weight changes to fix. In this way, our work provides a mechanistic argument for the importance of neutral adaption in the evolution of regulatory networks<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. The epistatic effects identified in the evolution of stripe forming mechanisms imply that the ability for neutral adaption to circumnavigate epistatic constraints could be a general property of evolution on patterning fitness landscapes. This may arise due to the inherent degeneracy in network topology for GRN-mediated patterning, whereby multiple network topologies can drive the same spatial pattern,<sup><xref ref-type="bibr" rid="R19">19</xref></sup> and the presence of so-called neutral networks, which have been shown using synthetic networks to enable new phenotypes to be accessed through mechanisms such as drift<sup><xref ref-type="bibr" rid="R12">12</xref></sup>.</p><p id="P55">The dependence of phenotypic accessibility on GRN topology and the mutational process alludes to historical contingency as an important aspect of GRN evolution, so that network changes accumulated early may influence subsequent evolution<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>. We have built on this idea by investigating how the evolution of specific stripe forming mechanisms becomes contingent upon early network organization. By developing a predictive framework we identified “branching mutations” early in evolution, which we were able to show significantly altered the likely mechanistic outcome. This suggests that degeneracy in patterning mechanisms, in combination with the constraints imposed by the existing network on subsequent mutations drives historical contingency. By employing machine learning techniques in combination with a large dataset of evolutionary trajectories we present a novel method to investigate the importance of historical contingency, echoing existing probabilistic characterizations of historical contingency<sup><xref ref-type="bibr" rid="R83">83</xref></sup>. In particular we demonstrated how explainability techniques<sup><xref ref-type="bibr" rid="R84">84</xref></sup> offers a principled way to identify the specific motifs which introduce constraints in a network evolution setting. Furthermore, the identification of branching mutations using our framework could guide synthetic GRN evolution assays in the future.</p><p id="P56">In conclusion, we have developed a high-throughput and tractable computational approach for GRN-driven developmental patterning that we have used to probe general principles of the evolution of development. Our framework can be adapted in the future to integrate new information from synthetic engineering assays<sup><xref ref-type="bibr" rid="R80">80</xref></sup> and simulations at the sequence level<sup><xref ref-type="bibr" rid="R81">81</xref></sup> that probe the constraints that regulatory architecture introduces to the evolution of GRN-driven developmental patterning. In addition, the framework we have developed can be adapted to investigate other phenotypic transitions or more complex networks. In this way we hope that our findings will stimulate further research, driving advancements in our understanding of developmental pattern evolution.</p></sec></body><back><ack id="S10"><title>Acknowledgments</title><p>We would like to thank Amy Bowen, James Briscoe, Jake Cornwall-Scoones, Leonard Dekens, James DiFrisco, Kabir Hussain, Taniya Mandal and Lewis Mosby for discussions and feedback on this work. This work was supported by the Francis Crick Institute, which receives its core funding from Cancer Research UK, the UK Medical Research Council, and Wellcome Trust.</p></ack><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kicheva</surname><given-names>A</given-names></name><name><surname>Briscoe</surname><given-names>J</given-names></name></person-group><article-title>Control of tissue development by morphogens</article-title><source>Annu Rev Cell Dev Biol</source><year>2023</year><volume>39</volume><fpage>91</fpage><lpage>121</lpage><pub-id pub-id-type="pmid">37418774</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Méndez-González</surname><given-names>ID</given-names></name><name><surname>Williams</surname><given-names>TM</given-names></name><name><surname>Rebeiz</surname><given-names>M</given-names></name></person-group><article-title>Changes in locus wide repression underlie the evolution of <italic>Drosophila</italic> abdominal pigmentation</article-title><source>PLoS Genet</source><year>2023</year><volume>19</volume><elocation-id>e1010722</elocation-id><pub-id pub-id-type="pmcid">PMC10184908</pub-id><pub-id pub-id-type="pmid">37134121</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1010722</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadier</surname><given-names>A</given-names></name><name><surname>Santana</surname><given-names>SE</given-names></name><name><surname>Sears</surname><given-names>KE</given-names></name></person-group><article-title>The role of core and variable gene regulatory network modules in tooth development and evolution</article-title><source>Integr Comp Biol</source><year>2023</year><volume>63</volume><fpage>162</fpage><lpage>175</lpage><pub-id pub-id-type="pmid">32761089</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>MR</given-names></name><etal/></person-group><article-title>A multifunctional Wnt regulator underlies the evolution of rodent stripe patterns</article-title><source>Nat Ecol Evol</source><year>2023</year><volume>7</volume><fpage>2143</fpage><lpage>2159</lpage><pub-id pub-id-type="pmcid">PMC10839778</pub-id><pub-id pub-id-type="pmid">37813945</pub-id><pub-id pub-id-type="doi">10.1038/s41559-023-02213-7</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Onimaru</surname><given-names>K</given-names></name><name><surname>Marcon</surname><given-names>L</given-names></name><name><surname>Musy</surname><given-names>M</given-names></name><name><surname>Tanaka</surname><given-names>M</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><article-title>The fin-to-limb transition as the re-organization of a Turing pattern</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><elocation-id>11582</elocation-id><pub-id pub-id-type="pmcid">PMC4879262</pub-id><pub-id pub-id-type="pmid">27211489</pub-id><pub-id pub-id-type="doi">10.1038/ncomms11582</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prud’homme</surname><given-names>B</given-names></name><etal/></person-group><article-title>Repeated morphological evolution through cis-regulatory changes in a pleiotropic gene</article-title><source>Nature</source><year>2006</year><volume>440</volume><fpage>1050</fpage><lpage>1053</lpage><pub-id pub-id-type="pmid">16625197</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinman</surname><given-names>VF</given-names></name><name><surname>Nguyen</surname><given-names>AT</given-names></name><name><surname>Cameron</surname><given-names>RA</given-names></name><name><surname>Davidson</surname><given-names>EH</given-names></name></person-group><article-title>Developmental gene regulatory network architecture across 500 million years of echinoderm evolution</article-title><source>Proc Natl Acad Sci</source><year>2003</year><volume>100</volume><fpage>13356</fpage><lpage>13361</lpage><pub-id pub-id-type="pmcid">PMC263818</pub-id><pub-id pub-id-type="pmid">14595011</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2235868100</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peter</surname><given-names>IS</given-names></name><name><surname>Davidson</surname><given-names>EH</given-names></name></person-group><article-title>Evolution of gene regulatory networks controlling body plan development</article-title><source>Cell</source><year>2011</year><volume>144</volume><fpage>970</fpage><lpage>985</lpage><pub-id pub-id-type="pmcid">PMC3076009</pub-id><pub-id pub-id-type="pmid">21414487</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2011.02.017</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galupa</surname><given-names>R</given-names></name><etal/></person-group><article-title>Enhancer architecture and chromatin accessibility constrain pheno-typic space during <italic>Drosophila</italic> development</article-title><source>Dev Cell</source><year>2023</year><volume>58</volume><fpage>51</fpage><lpage>62</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC9860173</pub-id><pub-id pub-id-type="pmid">36626871</pub-id><pub-id pub-id-type="doi">10.1016/j.devcel.2022.12.003</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>XC</given-names></name><etal/></person-group><article-title>Rapid response of fly populations to gene dosage across development and generations</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><elocation-id>4551</elocation-id><pub-id pub-id-type="pmcid">PMC11137061</pub-id><pub-id pub-id-type="pmid">38811562</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-48960-4</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuqua</surname><given-names>T</given-names></name><etal/></person-group><article-title>Dense and pleiotropic regulatory information in a developmental enhancer</article-title><source>Nature</source><year>2020</year><volume>587</volume><fpage>235</fpage><lpage>239</lpage><pub-id pub-id-type="pmcid">PMC8236315</pub-id><pub-id pub-id-type="pmid">33057197</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2816-5</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santos-Moreno</surname><given-names>J</given-names></name><name><surname>Tasiudi</surname><given-names>E</given-names></name><name><surname>Kusumawardhani</surname><given-names>H</given-names></name><name><surname>Stelling</surname><given-names>J</given-names></name><name><surname>Schaerli</surname><given-names>Y</given-names></name></person-group><article-title>Robustness and innovation in synthetic genotype networks</article-title><source>Nat Commun</source><year>2023</year><volume>14</volume><elocation-id>2454</elocation-id><pub-id pub-id-type="pmcid">PMC10147661</pub-id><pub-id pub-id-type="pmid">37117168</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-38033-3</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaerli</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Synthetic circuits reveal how mechanisms of gene regulatory networks constrain evolution</article-title><source>Mol Syst Biol</source><year>2018</year><volume>14</volume><elocation-id>e8102</elocation-id><pub-id pub-id-type="pmcid">PMC6129954</pub-id><pub-id pub-id-type="pmid">30201776</pub-id><pub-id pub-id-type="doi">10.15252/msb.20178102</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><source>The roles of mutation, inbreeding, crossbreeding and selection in evolution</source><conf-name>Proc 6th Int Cong Genet</conf-name><year>1932</year><volume>1</volume><fpage>356</fpage><lpage>366</lpage></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Visser</surname><given-names>JAGM</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nat Rev Genet</source><year>2014</year><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="pmid">24913663</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>P</given-names></name><name><surname>McCandlish</surname><given-names>DM</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><article-title>Contingency and entrenchment in protein evolution under purifying selection</article-title><source>Proc Natl Acad Sci</source><year>2015</year><volume>112</volume><fpage>E3226</fpage><lpage>E3235</lpage><pub-id pub-id-type="pmcid">PMC4485141</pub-id><pub-id pub-id-type="pmid">26056312</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1412933112</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payne</surname><given-names>JL</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><article-title>Constraint and contingency in multifunctional gene regulatory circuits</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><elocation-id>e1003071</elocation-id><pub-id pub-id-type="pmcid">PMC3675121</pub-id><pub-id pub-id-type="pmid">23762020</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003071</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiménez</surname><given-names>A</given-names></name><name><surname>Cotterell</surname><given-names>J</given-names></name><name><surname>Munteanu</surname><given-names>A</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><article-title>Dynamics of gene circuits shapes evolvability</article-title><source>Proc Natl Acad Sci</source><year>2015</year><volume>112</volume><fpage>2103</fpage><lpage>2108</lpage><pub-id pub-id-type="pmcid">PMC4343095</pub-id><pub-id pub-id-type="pmid">25646408</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1411065112</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cotterell</surname><given-names>J</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><article-title>An atlas of gene regulatory networks reveals multiple three-gene mechanisms for interpreting morphogen gradients</article-title><source>Mol Syst Biol</source><year>2010</year><volume>6</volume><fpage>425</fpage><pub-id pub-id-type="pmcid">PMC3010108</pub-id><pub-id pub-id-type="pmid">21045819</pub-id><pub-id pub-id-type="doi">10.1038/msb.2010.74</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sokolowski</surname><given-names>TR</given-names></name><name><surname>Gregor</surname><given-names>T</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name></person-group><article-title>Deriving a genetic regulatory network from an optimization principle</article-title><source>arXiv preprint</source><year>2023</year><elocation-id>arXiv:2302.05680</elocation-id><pub-id pub-id-type="pmcid">PMC11725783</pub-id><pub-id pub-id-type="pmid">39752518</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2402925121</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verd</surname><given-names>B</given-names></name><name><surname>Crombach</surname><given-names>A</given-names></name><name><surname>Jaeger</surname><given-names>J</given-names></name></person-group><article-title>Dynamic maternal gradients control timing and shift-rates for <italic>Drosophila</italic> gap gene expression</article-title><source>PLoS Comput Biol</source><year>2017</year><volume>13</volume><elocation-id>e1005285</elocation-id><pub-id pub-id-type="pmcid">PMC5291410</pub-id><pub-id pub-id-type="pmid">28158178</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005285</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaeger</surname><given-names>J</given-names></name><etal/></person-group><article-title>Dynamic control of positional information in the early <italic>Drosophila</italic> embryo</article-title><source>Nature</source><year>2004</year><volume>430</volume><fpage>368</fpage><lpage>371</lpage><pub-id pub-id-type="pmid">15254541</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>M</given-names></name><etal/></person-group><article-title>Ptch1 and Gli regulate Shh signalling dynamics via multiple mechanisms</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><elocation-id>6709</elocation-id><pub-id pub-id-type="pmcid">PMC4396374</pub-id><pub-id pub-id-type="pmid">25833741</pub-id><pub-id pub-id-type="doi">10.1038/ncomms7709</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balaskas</surname><given-names>N</given-names></name><etal/></person-group><article-title>Gene regulatory logic for reading the Sonic Hedgehog signaling gradient in the vertebrate neural tube</article-title><source>Cell</source><year>2012</year><volume>148</volume><fpage>273</fpage><lpage>284</lpage><pub-id pub-id-type="pmcid">PMC3267043</pub-id><pub-id pub-id-type="pmid">22265416</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2011.10.047</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pezzotta</surname><given-names>A</given-names></name><name><surname>Briscoe</surname><given-names>J</given-names></name></person-group><article-title>Optimal control of gene regulatory networks for morphogen-driven tissue patterning</article-title><source>Cell Syst</source><year>2023</year><volume>14</volume><fpage>940</fpage><lpage>952</lpage><elocation-id>e11</elocation-id><pub-id pub-id-type="pmid">37972560</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Exelby</surname><given-names>K</given-names></name><etal/></person-group><article-title>Precision of tissue patterning is controlled by dynamical properties of gene regulatory networks</article-title><source>Development</source><year>2021</year><volume>148</volume><elocation-id>dev197566</elocation-id><pub-id pub-id-type="pmcid">PMC7929933</pub-id><pub-id pub-id-type="pmid">33547135</pub-id><pub-id pub-id-type="doi">10.1242/dev.197566</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verd</surname><given-names>B</given-names></name><name><surname>Monk</surname><given-names>NA</given-names></name><name><surname>Jaeger</surname><given-names>J</given-names></name></person-group><article-title>Modularity, criticality, and evolvability of a developmental gene regulatory network</article-title><source>eLife</source><year>2019</year><volume>8</volume><elocation-id>e42832</elocation-id><pub-id pub-id-type="pmcid">PMC6645726</pub-id><pub-id pub-id-type="pmid">31169494</pub-id><pub-id pub-id-type="doi">10.7554/eLife.42832</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mousavi</surname><given-names>R</given-names></name><name><surname>Lobo</surname><given-names>D</given-names></name></person-group><article-title>Automatic design of gene regulatory mechanisms for spatial pattern formation</article-title><source>NPJ Syst Biol Appl</source><year>2024</year><volume>10</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC10987498</pub-id><pub-id pub-id-type="pmid">38565850</pub-id><pub-id pub-id-type="doi">10.1038/s41540-024-00361-5</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname><given-names>A</given-names></name><name><surname>Hemery</surname><given-names>M</given-names></name><name><surname>François</surname><given-names>P</given-names></name></person-group><article-title>Φ-evo: A program to evolve phenotypic models of biological networks</article-title><source>PLoS Comput Biol</source><year>2018</year><volume>14</volume><elocation-id>e1006244</elocation-id><pub-id pub-id-type="pmcid">PMC6013240</pub-id><pub-id pub-id-type="pmid">29889886</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006244</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>François</surname><given-names>P</given-names></name><name><surname>Siggia</surname><given-names>ED</given-names></name></person-group><article-title>Predicting embryonic patterning using mutual entropy fitness and in silico evolution</article-title><source>Development</source><year>2010</year><volume>137</volume><fpage>2385</fpage><lpage>2395</lpage><pub-id pub-id-type="pmid">20570938</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>François</surname><given-names>P</given-names></name><name><surname>Hakim</surname><given-names>V</given-names></name></person-group><article-title>Design of genetic networks with specified functions by evolution in silico</article-title><source>Proc Natl Acad Sci</source><year>2004</year><volume>101</volume><fpage>580</fpage><lpage>585</lpage><pub-id pub-id-type="pmcid">PMC327190</pub-id><pub-id pub-id-type="pmid">14704282</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0304532101</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothschild</surname><given-names>JB</given-names></name><name><surname>Tsimiklis</surname><given-names>P</given-names></name><name><surname>Siggia</surname><given-names>ED</given-names></name><name><surname>François</surname><given-names>P</given-names></name></person-group><article-title>Predicting ancestral segmentation phenotypes from <italic>Drosophila</italic> to anopheles using <italic>in silico</italic> evolution</article-title><source>PLoS Genet</source><year>2016</year><volume>12</volume><elocation-id>e1006052</elocation-id><pub-id pub-id-type="pmcid">PMC4882032</pub-id><pub-id pub-id-type="pmid">27227405</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1006052</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>François</surname><given-names>P</given-names></name><name><surname>Hakim</surname><given-names>V</given-names></name><name><surname>Siggia</surname><given-names>ED</given-names></name></person-group><article-title>Deriving structure from evolution: metazoan segmentation</article-title><source>Mol Syst Biol</source><year>2007</year><volume>3</volume><fpage>154</fpage><pub-id pub-id-type="pmcid">PMC2174625</pub-id><pub-id pub-id-type="pmid">18091725</pub-id><pub-id pub-id-type="doi">10.1038/msb4100192</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vroomans</surname><given-names>RMA</given-names></name><name><surname>Hogeweg</surname><given-names>P</given-names></name><name><surname>ten Tusscher</surname><given-names>KHWJ</given-names></name></person-group><article-title>In silico evo-devo: reconstructing stages in the evolution of animal segmentation</article-title><source>EvoDevo</source><year>2016</year><volume>7</volume><fpage>14</fpage><pub-id pub-id-type="pmcid">PMC4968448</pub-id><pub-id pub-id-type="pmid">27482374</pub-id><pub-id pub-id-type="doi">10.1186/s13227-016-0052-8</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujimoto</surname><given-names>K</given-names></name><name><surname>Ishihara</surname><given-names>S</given-names></name><name><surname>Kaneko</surname><given-names>K</given-names></name></person-group><article-title>Network evolution of body plans</article-title><source>PLoS One</source><year>2008</year><volume>3</volume><elocation-id>e2772</elocation-id><pub-id pub-id-type="pmcid">PMC2464711</pub-id><pub-id pub-id-type="pmid">18648662</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0002772</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinitz</surname><given-names>J</given-names></name><name><surname>Sharp</surname><given-names>DH</given-names></name></person-group><article-title>Mechanism of eve stripe formation</article-title><source>Mech Dev</source><year>1995</year><volume>49</volume><fpage>133</fpage><lpage>158</lpage><pub-id pub-id-type="pmid">7748785</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedlander</surname><given-names>T</given-names></name><name><surname>Mayo</surname><given-names>AE</given-names></name><name><surname>Tlusty</surname><given-names>T</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><article-title>Mutation rules and the evolution of sparseness and modularity in biological systems</article-title><source>PLoS One</source><year>2013</year><volume>8</volume><elocation-id>e70444</elocation-id><pub-id pub-id-type="pmcid">PMC3735639</pub-id><pub-id pub-id-type="pmid">23936433</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0070444</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>AJ</given-names></name><name><surname>Hannenhalli</surname><given-names>S</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><article-title>Why transcription factor binding sites are ten nucleotides long</article-title><source>Genetics</source><year>2012</year><volume>192</volume><fpage>973</fpage><lpage>985</lpage><pub-id pub-id-type="pmcid">PMC3522170</pub-id><pub-id pub-id-type="pmid">22887818</pub-id><pub-id pub-id-type="doi">10.1534/genetics.112.143370</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duque</surname><given-names>T</given-names></name><name><surname>Sinha</surname><given-names>S</given-names></name></person-group><article-title>What does it take to evolve an enhancer? A simulation-based study of factors influencing the emergence of combinatorial regulation</article-title><source>Genome Biol and Evol</source><year>2015</year><volume>7</volume><fpage>1415</fpage><lpage>1431</lpage><pub-id pub-id-type="pmcid">PMC4494070</pub-id><pub-id pub-id-type="pmid">25956793</pub-id><pub-id pub-id-type="doi">10.1093/gbe/evv080</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiménez-Delgado</surname><given-names>S</given-names></name><name><surname>Pascual-Anaya</surname><given-names>J</given-names></name><name><surname>Garcia-Fernàndez</surname><given-names>J</given-names></name></person-group><article-title>Implications of duplicated cis-regulatory elements in the evolution of metazoans: the DDI model or how simplicity begets novelty</article-title><source>Brief Funct Genom</source><year>2009</year><volume>8</volume><fpage>266</fpage><lpage>275</lpage><pub-id pub-id-type="pmid">19651705</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Babu</surname><given-names>MM</given-names></name></person-group><article-title>Gene regulatory network growth by duplication</article-title><source>Nat Genet</source><year>2004</year><volume>36</volume><fpage>492</fpage><lpage>496</lpage><pub-id pub-id-type="pmid">15107850</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosby</surname><given-names>LS</given-names></name><name><surname>Bowen</surname><given-names>AE</given-names></name><name><surname>Hadjivasiliou</surname><given-names>Z</given-names></name></person-group><article-title>Morphogens in the evolution of size, shape and patterning</article-title><source>Development</source><year>2024</year><volume>151</volume><elocation-id>dev202412</elocation-id><pub-id pub-id-type="pmcid">PMC7616732</pub-id><pub-id pub-id-type="pmid">39302048</pub-id><pub-id pub-id-type="doi">10.1242/dev.202412</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>JH</given-names></name></person-group><article-title>Molecular evolution over the mutational landscape</article-title><source>Evolution</source><year>1984</year><volume>38</volume><fpage>1116</fpage><lpage>1129</lpage><pub-id pub-id-type="pmid">28555784</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khatri</surname><given-names>BS</given-names></name><name><surname>McLeish</surname><given-names>TCB</given-names></name><name><surname>Sear</surname><given-names>RP</given-names></name></person-group><article-title>Statistical mechanics of convergent evolution in spatial patterning</article-title><source>Proc Natl Acad Sci</source><year>2009</year><volume>106</volume><fpage>9564</fpage><lpage>9569</lpage><pub-id pub-id-type="pmcid">PMC2701012</pub-id><pub-id pub-id-type="pmid">19497876</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0812260106</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenbury</surname><given-names>SF</given-names></name><name><surname>Louis</surname><given-names>AA</given-names></name><name><surname>Ahnert</surname><given-names>SE</given-names></name></person-group><article-title>The structure of genotype-phenotype maps makes fitness landscapes navigable</article-title><source>Nat Ecol Evol</source><year>2022</year><volume>6</volume><fpage>1742</fpage><lpage>1752</lpage><pub-id pub-id-type="pmid">36175543</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><article-title>On the probability of fixation of mutant genes in a population</article-title><source>Genetics</source><year>1962</year><volume>47</volume><fpage>713</fpage><pub-id pub-id-type="pmcid">PMC1210364</pub-id><pub-id pub-id-type="pmid">14456043</pub-id><pub-id pub-id-type="doi">10.1093/genetics/47.6.713</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clyde</surname><given-names>DE</given-names></name><etal/></person-group><article-title>A self-organizing system of repressor gradients establishes segmental complexity in <italic>Drosophila</italic></article-title><source>Nature</source><year>2003</year><volume>426</volume><fpage>849</fpage><lpage>853</lpage><pub-id pub-id-type="pmid">14685241</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mangan</surname><given-names>S</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><article-title>Structure and function of the feed-forward loop network motif</article-title><source>Proc Natl Acad Sci</source><year>2003</year><volume>100</volume><fpage>11980</fpage><lpage>11985</lpage><pub-id pub-id-type="pmcid">PMC218699</pub-id><pub-id pub-id-type="pmid">14530388</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2133841100</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Ma</surname><given-names>W</given-names></name><name><surname>Xiong</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name></person-group><article-title>Adaptation with transcriptional regulation</article-title><source>Sci Rep</source><year>2017</year><volume>7</volume><elocation-id>42648</elocation-id><pub-id pub-id-type="pmcid">PMC5324054</pub-id><pub-id pub-id-type="pmid">28233824</pub-id><pub-id pub-id-type="doi">10.1038/srep42648</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uygur</surname><given-names>A</given-names></name><etal/></person-group><article-title>Scaling pattern to variations in size during development of the vertebrate neural tube</article-title><source>Dev Cell</source><year>2016</year><volume>37</volume><fpage>127</fpage><lpage>135</lpage><pub-id pub-id-type="pmcid">PMC4854284</pub-id><pub-id pub-id-type="pmid">27093082</pub-id><pub-id pub-id-type="doi">10.1016/j.devcel.2016.03.024</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kogenaru</surname><given-names>M</given-names></name><name><surname>Nghe</surname><given-names>P</given-names></name><name><surname>Poelwijk</surname><given-names>FJ</given-names></name><name><surname>Tans</surname><given-names>SJ</given-names></name></person-group><article-title>Predicting evolutionary constraints by identifying conflicting demands in regulatory networks</article-title><source>Cell Syst</source><year>2020</year><volume>10</volume><fpage>526</fpage><lpage>534</lpage><elocation-id>e3</elocation-id><pub-id pub-id-type="pmid">32553183</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weingarten-Gabbay</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name></person-group><article-title>The grammar of transcriptional regulation</article-title><source>Hum Genet</source><year>2014</year><volume>133</volume><fpage>701</fpage><lpage>711</lpage><pub-id pub-id-type="pmcid">PMC4024068</pub-id><pub-id pub-id-type="pmid">24390306</pub-id><pub-id pub-id-type="doi">10.1007/s00439-013-1413-1</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Igler</surname><given-names>C</given-names></name><name><surname>Lagator</surname><given-names>M</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name><name><surname>Bollback</surname><given-names>JP</given-names></name><name><surname>Guet</surname><given-names>CC</given-names></name></person-group><article-title>Evolutionary potential of transcription factors for gene regulatory rewiring</article-title><source>Nat Ecol Evol</source><year>2018</year><volume>2</volume><fpage>1633</fpage><lpage>1643</lpage><pub-id pub-id-type="pmid">30201966</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>K</surname><given-names>S</given-names></name><name><surname>W</surname><given-names>J</given-names></name></person-group><article-title>Deciphering the multi-scale, quantitative cis-regulatory code</article-title><source>Mol Cell</source><year>2023</year><volume>83</volume><pub-id pub-id-type="pmcid">PMC9898153</pub-id><pub-id pub-id-type="pmid">36693380</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2022.12.032</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyler</surname><given-names>AL</given-names></name><name><surname>Asselbergs</surname><given-names>FW</given-names></name><name><surname>Williams</surname><given-names>SM</given-names></name><name><surname>Moore</surname><given-names>JH</given-names></name></person-group><article-title>Shadows of complexity: What biological networks reveal about epistasis and pleiotropy</article-title><source>Bioessays</source><year>2009</year><volume>31</volume><fpage>220</fpage><lpage>227</lpage><pub-id pub-id-type="pmcid">PMC3159922</pub-id><pub-id pub-id-type="pmid">19204994</pub-id><pub-id pub-id-type="doi">10.1002/bies.200800022</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nghe</surname><given-names>P</given-names></name><etal/></person-group><article-title>Predicting evolution using regulatory architecture</article-title><source>Annu Rev Biophys</source><year>2020</year><volume>49</volume><fpage>181</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">32040932</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crona</surname><given-names>K</given-names></name><name><surname>Greene</surname><given-names>D</given-names></name><name><surname>Barlow</surname><given-names>M</given-names></name></person-group><article-title>The peaks and geometry of fitness landscapes</article-title><source>J Theor Biol</source><year>2013</year><volume>317</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmcid">PMC3529755</pub-id><pub-id pub-id-type="pmid">23036916</pub-id><pub-id pub-id-type="doi">10.1016/j.jtbi.2012.09.028</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reeves</surname><given-names>GT</given-names></name></person-group><article-title>The engineering principles of combining a transcriptional incoherent feedforward loop with negative feedback</article-title><source>J Biol Eng</source><year>2019</year><volume>13</volume><fpage>62</fpage><pub-id pub-id-type="pmcid">PMC6617889</pub-id><pub-id pub-id-type="pmid">31333758</pub-id><pub-id pub-id-type="doi">10.1186/s13036-019-0190-3</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cotterell</surname><given-names>J</given-names></name><name><surname>Sharpe</surname><given-names>J</given-names></name></person-group><article-title>Mechanistic explanations for restricted evolutionary paths that emerge from gene regulatory networks</article-title><source>PLoS ONE</source><year>2013</year><volume>8</volume><elocation-id>e61178</elocation-id><pub-id pub-id-type="pmcid">PMC3629181</pub-id><pub-id pub-id-type="pmid">23613807</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0061178</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutenkunst</surname><given-names>RN</given-names></name><etal/></person-group><article-title>Universally sloppy parameter sensitivities in systems biology models</article-title><source>PLoS Comput Biol</source><year>2007</year><volume>3</volume><elocation-id>e189</elocation-id><pub-id pub-id-type="pmcid">PMC2000971</pub-id><pub-id pub-id-type="pmid">17922568</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0030189</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husain</surname><given-names>K</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name></person-group><article-title>Physical constraints on epistasis</article-title><source>Mol Biol Evol</source><year>2020</year><volume>37</volume><fpage>2865</fpage><lpage>2874</lpage><pub-id pub-id-type="pmid">32421772</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Depristo</surname><given-names>MA</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><year>2006</year><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="pmid">16601193</pub-id></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiotti</surname><given-names>K</given-names></name><etal/></person-group><article-title>The valley of death: Reciprocal sign epistasis constrains adaptive trajectories in a constant, nutrient limiting environment</article-title><source>Genomics</source><year>2014</year><volume>104</volume><fpage>431</fpage><lpage>437</lpage><pub-id pub-id-type="pmcid">PMC4454348</pub-id><pub-id pub-id-type="pmid">25449178</pub-id><pub-id pub-id-type="doi">10.1016/j.ygeno.2014.10.011</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Draghi</surname><given-names>JA</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><article-title>Selection biases the prevalence and type of epistasis along adaptive trajectories</article-title><source>Evolution</source><year>2013</year><volume>67</volume><fpage>3120</fpage><lpage>3131</lpage><pub-id pub-id-type="pmid">24151997</pub-id></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baier</surname><given-names>F</given-names></name><name><surname>Gauye</surname><given-names>F</given-names></name><name><surname>Perez-Carrasco</surname><given-names>R</given-names></name><name><surname>Payne</surname><given-names>JL</given-names></name><name><surname>Schaerli</surname><given-names>Y</given-names></name></person-group><article-title>Environment-dependent epistasis increases phenotypic diversity in gene regulatory networks</article-title><source>Sci Adv</source><year>2023</year><volume>9</volume><elocation-id>eadf1773</elocation-id><pub-id pub-id-type="pmcid">PMC10208579</pub-id><pub-id pub-id-type="pmid">37224262</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.adf1773</pub-id></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gould</surname><given-names>SJ</given-names></name></person-group><source>Wonderful Life: The Burgess shale and the nature of history</source><year>1989</year><publisher-name>WW Norton &amp; Company</publisher-name></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salverda</surname><given-names>MLM</given-names></name><etal/></person-group><article-title>Initial mutations direct alternative pathways of protein evolution</article-title><source>PLoS Genet</source><year>2011</year><volume>7</volume><elocation-id>e1001321</elocation-id><pub-id pub-id-type="pmcid">PMC3048372</pub-id><pub-id pub-id-type="pmid">21408208</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1001321</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kryazhimskiy</surname><given-names>S</given-names></name><name><surname>Rice</surname><given-names>DP</given-names></name><name><surname>Jerison</surname><given-names>ER</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><article-title>Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title><source>Science</source><year>2014</year><volume>344</volume><fpage>1519</fpage><lpage>1522</lpage><pub-id pub-id-type="pmcid">PMC4314286</pub-id><pub-id pub-id-type="pmid">24970088</pub-id><pub-id pub-id-type="doi">10.1126/science.1250939</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kauffman</surname><given-names>S</given-names></name><name><surname>Levin</surname><given-names>S</given-names></name></person-group><article-title>Towards a general theory of adaptive walks on rugged landscapes</article-title><source>J Theor Biol</source><year>1987</year><volume>128</volume><fpage>11</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">3431131</pub-id></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DiFrisco</surname><given-names>J</given-names></name><name><surname>Wagner</surname><given-names>GP</given-names></name></person-group><article-title>Body plan identity: A mechanistic model</article-title><source>Evol Biol</source><year>2022</year><volume>49</volume><fpage>123</fpage><lpage>141</lpage></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ijäs</surname><given-names>T</given-names></name><name><surname>Koskinen</surname><given-names>R</given-names></name></person-group><article-title>Exploring biological possibility through synthetic biology</article-title><source>Euro Jnl Phil Sci</source><year>2021</year><volume>11</volume><fpage>39</fpage></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Genetic hitchhiking</article-title><source>Philos Trans R Soc Lond B Biol Sci</source><year>2000</year><volume>355</volume><fpage>1553</fpage><lpage>1562</lpage><pub-id pub-id-type="pmcid">PMC1692896</pub-id><pub-id pub-id-type="pmid">11127900</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2000.0716</pub-id></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McQueen</surname><given-names>E</given-names></name><name><surname>Rebeiz</surname><given-names>M</given-names></name></person-group><article-title>On the individuality of gene regulatory networks: how does network re-use affect subsequent evolution?</article-title><source>Curr Top Dev Biol</source><year>2020</year><volume>139</volume><fpage>375</fpage><lpage>405</lpage><pub-id pub-id-type="pmcid">PMC8382235</pub-id><pub-id pub-id-type="pmid">32450967</pub-id><pub-id pub-id-type="doi">10.1016/bs.ctdb.2020.03.002</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Payne</surname><given-names>JL</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><article-title>Cryptic genetic variation accelerates evolution by opening access to diverse adaptive peaks</article-title><source>Science</source><year>2019</year><volume>365</volume><fpage>347</fpage><lpage>353</lpage><pub-id pub-id-type="pmid">31346060</pub-id></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sorrells</surname><given-names>TR</given-names></name><name><surname>Booth</surname><given-names>LN</given-names></name><name><surname>Tuch</surname><given-names>BB</given-names></name><name><surname>Johnson</surname><given-names>AD</given-names></name></person-group><article-title>Intersecting transcription networks constrain gene regulatory evolution</article-title><source>Nature</source><year>2015</year><volume>523</volume><fpage>361</fpage><lpage>365</lpage><pub-id pub-id-type="pmcid">PMC4531262</pub-id><pub-id pub-id-type="pmid">26153861</pub-id><pub-id pub-id-type="doi">10.1038/nature14613</pub-id></element-citation></ref><ref id="R76"><label>76</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lässig</surname><given-names>M</given-names></name></person-group><article-title>From biophysics to evolutionary genetics: statistical aspects of gene regulation</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>S7</fpage><pub-id pub-id-type="pmcid">PMC1995540</pub-id><pub-id pub-id-type="pmid">17903288</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-S6-S7</pub-id></element-citation></ref><ref id="R77"><label>77</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martinez-Ara</surname><given-names>M</given-names></name><name><surname>Comoglio</surname><given-names>F</given-names></name><name><surname>van Steensel</surname><given-names>B</given-names></name></person-group><article-title>Large-scale analysis of the integration of enhancer-enhancer signals by promoters</article-title><source>eLife</source><year>2024</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC11517252</pub-id><pub-id pub-id-type="pmid">39466837</pub-id><pub-id pub-id-type="doi">10.7554/eLife.91994</pub-id></element-citation></ref><ref id="R78"><label>78</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Majic</surname><given-names>P</given-names></name><name><surname>Payne</surname><given-names>JL</given-names></name></person-group><article-title>Enhancers facilitate the birth of <italic>de novo</italic> genes and gene integration into regulatory networks</article-title><source>Mol Biol Evol</source><year>2020</year><volume>37</volume><fpage>1165</fpage><lpage>1178</lpage><pub-id pub-id-type="pmcid">PMC7086177</pub-id><pub-id pub-id-type="pmid">31845961</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msz300</pub-id></element-citation></ref><ref id="R79"><label>79</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shir</surname><given-names>OM</given-names></name><name><surname>Yehudayoff</surname><given-names>A</given-names></name></person-group><article-title>On the covariance-hessian relation in evolution strategies</article-title><source>Theor Comput Sci</source><year>2020</year><volume>801</volume><fpage>157</fpage><lpage>174</lpage></element-citation></ref><ref id="R80"><label>80</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornwall-Scoones</surname><given-names>J</given-names></name><etal/></person-group><article-title>Predictable engineering of signal-dependent cis-regulatory elements</article-title><source>bioRxiv</source><year>2025</year><elocation-id>2025.03.07.642002</elocation-id></element-citation></ref><ref id="R81"><label>81</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedlander</surname><given-names>T</given-names></name><name><surname>Prizak</surname><given-names>R</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name></person-group><article-title>Evolution of new regulatory functions on biophysically realistic fitness landscapes</article-title><source>Nat Comm</source><year>2017</year><volume>8</volume><fpage>216</fpage><pub-id pub-id-type="pmcid">PMC5548793</pub-id><pub-id pub-id-type="pmid">28790313</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-00238-8</pub-id></element-citation></ref><ref id="R82"><label>82</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>M</given-names></name></person-group><article-title>The frailty of adaptive hypotheses for the origins of organismal complexity</article-title><source>Proc Natl Acad Sci</source><year>2007</year><volume>104</volume><fpage>8597</fpage><lpage>8604</lpage></element-citation></ref><ref id="R83"><label>83</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>TYW</given-names></name></person-group><article-title>Sources of evolutionary contingency: chance variation and genetic drift</article-title><source>Biol Philos</source><year>2020</year><volume>35</volume><fpage>36</fpage></element-citation></ref><ref id="R84"><label>84</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundberg</surname><given-names>SM</given-names></name><name><surname>Erion</surname><given-names>GG</given-names></name><name><surname>Lee</surname><given-names>SI</given-names></name></person-group><source>Consistent individualized feature attribution for tree ensembles</source><year>2019</year><elocation-id>arXiv:1802.03888</elocation-id></element-citation></ref><ref id="R85"><label>85</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group><article-title>UMAP: Uniform manifold approximation and projection</article-title><source>J Open Source Softw</source><year>2018</year><volume>3</volume><fpage>861</fpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Method Summary</title><p>A. Model of developmental patterning and target stripe. A tissue is made up of a discrete number of cells (blue ovals), each with an identical 3-node gene regulatory network (GRN). A morphogen gradient (yellow) is assumed to be at steady state across the tissue. The target stripe profile (orange) has boundaries which define three equal size regions across the tissue. The gray and pink circles represent the two other genes in the network. Lines in the plot are a schematic of the putative concentration at steady state for the morphogen (yellow) and three genes shown in the diagram below (gray, orange, pink) B. An example GRN. The morphogen, <italic>m</italic> (yellow) activates gene <italic>a</italic> (gray), which then regulates the output gene <italic>c</italic> (orange) directly and through an intermediary gene <italic>b</italic> (pink). The regulatory organization is specified by a matrix <italic>W</italic> that holds the weights that define an effective strength for activation (positive weights) and inhibition (negative weights) arrows, and represents the genotype in our analysis. C. A schematic outlining the Monte-Carlo scheme for simulating evolutionary trajectories. The resident genotype associated with the current phenotype is mutated by introducing or editing existing interactions (weight changes). The new phenotype defines a fitness differential Δℱ, which then determines the probability <italic>p</italic>(Δℱ, <italic>β, P</italic><sub><italic>s</italic></sub>) of fixation for the mutant based on the selection strength <italic>β</italic> and population size <italic>P</italic><sub><italic>s</italic></sub>. This process then repeats until a predefined fitness threshold is reached. The sequence of accepted mutants is collected to form an “evolutionary trajectory”. The MST (<italic>minimal stripe topology</italic>) associated with the first stripe forming mutant <inline-formula><mml:math id="M31"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the final mutant <italic>W</italic><sub><italic>N</italic></sub> are then evaluated. The MST is the topology associated with the minimal set of regulatory interactions able to maintain a stripe phenotype. Details of parameters used in the evolutionary algorithm are provided in SM.</p></caption><graphic xlink:href="EMS202384-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>The distribution of adaptive outcomes relating to the core mechanisms of stripe formation.</title><p>A. An example evolutionary trajectory showing topological changes in the underlying network along with the associated phenotypes. Each step indicates an accepted mutant. The change in the network topology (genotype) is shown on top with the corresponding gene expression profile (phenotype) below. The value of <italic>n</italic> is the index of the shown accepted mutant. The interactions which form the MST at <italic>n</italic> = <italic>S</italic><sub>0</sub> and <italic>n</italic> = <italic>N</italic> are highlighted and denoted as <inline-formula><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>M</italic><sub><italic>N</italic></sub> respectively. B. The distribution of top 8 MST outcomes <inline-formula><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> across evolutionary simulations. Colors correspond to the MSTs visualized below the distribution. C. A UMAP<sup><xref ref-type="bibr" rid="R85">85</xref></sup> embedding of the dynamics associated with final evolved networks <inline-formula><mml:math id="M34"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, with color coding indicating MST classification shown in B. D. The proportion of trajectories pertaining to the four different cases describing the relation of the first stripe-forming MST and the final MST, split by final MST outcome. The four cases are: MST preservation <inline-formula><mml:math id="M35"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, complexification <inline-formula><mml:math id="M36"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊂</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, simplification <inline-formula><mml:math id="M37"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊂</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and MST change <inline-formula><mml:math id="M38"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊄</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∧</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊄</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="EMS202384-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Key components of stripe evolution.</title><p>A. Phenotypic transitions during evolution. The initial phenotype is that of a shallow proximal-boundary (bottom left). The first accepted mutant at <italic>n</italic> = 1 may lead to a sharp proximal boundary (top left, pink arrow), a stripe (top right, purple arrow), a sharp distal boundary (bottom right, brown arrow) or adjust the existing phenotype without introducing new boundaries (self arrow). Arrows between these states indicate the acceptance of a mutant driving the respective phenotypic changes. Self-arrows indicate accepted mutants that adjust the respective phenotype without adding or removing boundaries. Arrows for transitions that lead to stripe inception are marked by <italic>n</italic> = <italic>S</italic><sub>0</sub>. B. Percentage of accepted mutants in different evolutionary periods associated with specific phenotype transitions. Colors correspond to arrows in A. The black bar for 1 &lt; <italic>n</italic> &lt; <italic>S</italic><sub>0</sub> corresponds to neutral mutants that do not induce a phenotypic shift or fitness change. C. Median wait times associated with accepted mutants in each evolutionary period (dots). Range bars represent the 25<sup>th</sup> to 75<sup>th</sup> percentiles of the wait time distribution. D. Classification of the weight change (w.c.) types carried by accepted mutants in different evolutionary periods as follows: introduction of a new weight (purple), adjustment of existing weight while preserving sign (green) adjustment of existing weight with sign change (yellow). Solid bars indicate the probability of mutants carrying at least one weight change of the type corresponding to the colour. E. The distribution of accepted weight change magnitudes expressed relative to the maximum regulatory effect, defined as <inline-formula><mml:math id="M39"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> associated with mutants in different evolutionary periods. Color indicates weight change category as in D. F. Percentage of accepted mutants carrying 1-4 weight changes, across different evolutionary periods. Crosses indicate likelihood according to null sampling distribution (pre-selection), bars indicate post selection percentages. For each mutant carrying multiple weight changes we evaluate the minimum number of weight changes, <italic>k</italic>, required to produce the observed fitness gain. This information is visualized in the heatmap, which presents the distribution of required weight changes <italic>k</italic> against the original number carried by the mutants. Yellow along diagonal entries indicates that all weight changes are necessary for the fitness gain.</p></caption><graphic xlink:href="EMS202384-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Epistatic effects in 2-weight mutants</title><p>A. The distribution of epistatic effect classifications, as defined in the main text and with color coding specified in legend, measured across 2-weight mutants in four different evolutionary stages. B. An example of an mutant at the point of stripe inception, <italic>n</italic> = <italic>S</italic><sub>0</sub>, with high prevalence of RSE C. An example of an <italic>S</italic><sub>0</sub> mutant with high prevalence of sign epistasis. In both panels B and C: (i) The boxed GRN visualization shows the weight changes carried by an example 2-weight mutant and does not show the remainder of the existing network (ii) the top two most frequent network structures prior to mutation (iii) the distribution of measured epistatic effects for this <italic>S</italic><sub>0</sub> mutant across our evolutionary simulations. D. The heatmap shows the frequency of fitness effects associated with each individual accepted weight change for the two mutants in panels B[i] and C[i]. Individual weight changes are classified as adaptive (+), neutral, or deleterious (-). For example, instances where ℱ (<italic>w</italic><sub><italic>ij</italic></sub>) and ℱ (<italic>w</italic><sub><italic>kl</italic></sub>) are deleterious would represent a 2 weight mutant with R.S.E. E. Example calculation of weight change correlation. We calculated the weight changes <inline-formula><mml:math id="M40"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> induced by accepted 2-weight mutants, where <inline-formula><mml:math id="M41"><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We then measured the correlation <italic>ρ</italic> after grouping <inline-formula><mml:math id="M42"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by unique weight identity, MST and epistasis type. F. The distribution of spearman correlation magnitudes measured between pairwise weights, calculated from all 2-weight mutants conditioned on epistasis type.</p></caption><graphic xlink:href="EMS202384-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Predictability of stripe evolution.</title><p>A. An example trajectory and the MST prediction probabilities for intermediate mutants. Colors (Red,Blue,Green and Purple) represent MST labels and correspond to color coding used in <xref ref-type="fig" rid="F2">Figure 2</xref>, with gray representing the “other” MST category. A sequence of network configurations corresponding to fixed mutants in an example trajectory <italic>i</italic> is shown, with the MST realized at <italic>S</italic><sub>0</sub> shown highlighted in purple, corresponding to MST:4. For each network <inline-formula><mml:math id="M43"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in the <italic>i™</italic>th trajectory we produce a probabilistic MST prediction <italic>p</italic><sup>(<italic>i</italic>)</sup>(<italic>k</italic>) using a trained XGBoost classifier. Here <inline-formula><mml:math id="M44"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>4</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mtext>other</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="M45"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability that the <italic>j</italic>-th MST is realized at <italic>S</italic><sub>0</sub> given the <italic>k</italic>-th mutant. Coloured bars indicate the individual MST prediction probabilities <inline-formula><mml:math id="M46"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> Black line indicates entropy associated with the prediction probabilities <italic>p</italic><sup>(<italic>i</italic>)</sup>(<italic>k</italic>). B. The recall for each MST outcome evaluated on out-of sample networks at different stages of evolution, evaluated using the complete predictive model (i) and the topology only predictive model (ii). Networks were first binned according to the number of weight edits they had accumulated as a percentage of the total accumulated at <italic>S</italic><sub>0</sub>. The bins were chosen so that the number of networks in each bin was approximately equal. Next, the recall for each MST outcome was evaluated for the networks in each bin. Recall is the % of correct predictions for the outcome. A prediction is deemed correct if it matches the MST outcome and furthermore, persists from the point of prediction to <italic>S</italic><sub>0</sub> - for more details see SM. C. 2-dimensional fitness landscapes associated with pairwise weight changes carried by the (<italic>n</italic> = 1) mutant (i) with the associated MST predictions (ii). Pink and cyan arrows indicate weight changes associated with selected branching mutations. Bar charts (iii) and (iv) represent the MST outcome distributions associated with pink and cyan branching mutations. Filled bars indicate the distribution induced by the branching mutations, whereas non-filled bars represent the null distribution <inline-formula><mml:math id="M47"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> Scatter crosses indicate probability of each MST outcome given by predictive model for the branching mutants. D. Histogram showing the distribution of prediction attribution ratios Φ<sub>carrier</sub><italic>/</italic>Φ<sub>carrier</sub> associated with mutants carrying hitchhiking weight changes. Red dashed line indicates equal attribution between hitchhiking and carrier weight changes. The schematic shows that hitchhiking weight changes (<italic>b → B</italic>) are those which are deleterious individually, but adaptive when fix with a carrier mutation (<italic>a → A</italic>).</p></caption><graphic xlink:href="EMS202384-f005"/></fig></floats-group></article>