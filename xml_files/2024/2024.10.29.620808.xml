<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199803</article-id><article-id pub-id-type="doi">10.1101/2024.10.29.620808</article-id><article-id pub-id-type="archive">PPR933456</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>SeqTagger, a rapid and accurate tool to demultiplex direct RNA nanopore sequencing datasets</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Pryszcz</surname><given-names>Leszek P</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Diensthuber</surname><given-names>Gregor</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Llovera</surname><given-names>Laia</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Medina</surname><given-names>Rebeca</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Delgado-Tejedor</surname><given-names>Anna</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Cozzuto</surname><given-names>Luca</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ponomarenko</surname><given-names>Julia</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Novoa</surname><given-names>Eva Maria</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wyzt892</institution-id><institution>Centre for Genomic Regulation (CRG)</institution></institution-wrap>, The Barcelona Institute of Science and Technology, <addr-line>Dr. Aiguader 88</addr-line>, <city>Barcelona</city><postal-code>08003</postal-code>, <country country="ES">Spain</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04n0g0b29</institution-id><institution>Universitat Pompeu Fabra (UPF)</institution></institution-wrap>, <city>Barcelona</city>, <country country="ES">Spain</country></aff><author-notes><corresp id="CR1"><label>*</label>Correspondence to: Leszek P Pryszcz (<email>leszek.pryszcz@crg.eu</email>) and Eva Maria Novoa (<email>eva.novoa@,crg.eu</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>02</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>30</day><month>10</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Nanopore direct RNA sequencing (DRS) enables direct measurement of RNA molecules, including their native RNA modifications, without prior conversion to cDNA. However, commercial methods for molecular barcoding of multiple DRS samples are lacking, and community-driven efforts, such as DeePlexiCon, are not compatible with newer RNA chemistry flowcells and the latest-generation GPU cards. To overcome these limitations, we introduce SeqTagger, a rapid and robust method that can demultiplex direct RNA sequencing datasets with 99% precision and 95% recall. We demonstrate the applicability of SeqTagger in both RNA002/R9.4 and RNA004/RNA chemistries and show its robust performance both for long and short RNA libraries, including custom libraries that do not contain standard poly-(A) tails, such as Nano-tRNAseq libraries. Finally, we demonstrate that increasing the multiplexing up to 96 barcodes yields highly accurate demultiplexing models. SeqTagger can be executed in a standalone manner or through the MasterOfPores NextFlow workflow. The availability of an efficient and simple multiplexing strategy improves the cost-effectiveness of this technology and facilitates the analysis of low-input biological samples.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Nanopore sequencing technologies have revolutionised our ability to study the transcriptome, by enabling direct sequencing of the native RNA molecules, offering insights into gene expression profiles while retaining RNA modification and polyA tail length information (<xref ref-type="bibr" rid="R10">Garalde et al. 2018</xref>). Direct RNA sequencing offers several advantages over traditional sequencing methods such as obviating the need for PCR amplification and cDNA synthesis steps, thus preserving the native state of RNA molecules and providing a less biassed and comprehensive view of the transcriptome (<xref ref-type="bibr" rid="R24">Workman et al. 2019</xref>).</p><p id="P3">However, key challenges persist, such as the lack of commercial barcoding kits and demultiplexing algorithms specific to direct RNA sequencing (DRS) data, hampering the broader use of this technology. To overcome these limitations, community-driven efforts have been made to enable demultiplexing of DRS data, such as PorePlex or DeePlexiCon (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>). DeePlexiCon relies on the conversion of signal information to images, which are then classified using 2D convolutional neural networks (2D CNNs) into their corresponding barcodes. This is a computationally expensive task in the bioinformatic processing of direct RNA-sequencing data (<xref ref-type="bibr" rid="R4">Cozzuto et al. 2023</xref>). In addition, the user has to decide whether high demultiplexing accuracy or recovery takes precedence, with DeePlexiCon being able to reach 99% accuracy sacrificing around 40% of total reads or 92% accuracy losing 7% of reads (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>).</p><p id="P4">Here we reasoned that developing a novel demultiplexing software that relies on basecalling the reverse transcription adapter (RTA), used during direct RNA-sequencing library preparation, should yield superior performance compared to existing tools. We rigorously benchmarked this novel tool, which we named <italic>SeqTagger</italic>, against the <italic>de-facto</italic> standard <italic>DeePlexiCon,</italic> to determine both improvements in model performance (recall and precision) and system performance (computation time and CPU usage). The applicability of <italic>SeqTagger</italic> was tested across sequencing devices (MinION and PromethION), sequencing chemistries (SQK-RNA002 and SQK-RNA004), RNA biotypes (poly-(A)+and tRNA), and for extended sets of barcodes (up to 96 barcodes).</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Demultiplexing DRS libraries through direct basecalling of the DNA barcode</title><p id="P5">To date, efforts for demultiplexing DRS datasets have relied on the transformation of signal intensities to images, followed by classification of resulting 2D images, as performed by the software DeePlexiCon (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>). While this approach leads to robust and accurate demultiplexing statistics, it is computationally expensive, limited to 4 barcodes, and does not support newer RNA004 kit chemistries.</p><p id="P6">We hypothesised that training a DNA basecaller that could directly basecall a DNA barcode sequence present in the reverse transcription adapter (RTA), which is ligated to the native RNA molecules during library preparation, should lead to improved performance of the demultiplexing algorithm. In particular, the use of a DNA basecaller would allow skipping the most computationally expensive step of demultiplexing, i.e. the signal transformation step (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>), and would in principle be flexible towards classifying an unlimited number of barcodes with minimal losses in demultiplexing accuracy, thus allowing to increase the number of samples that are loaded in a single flowcell.</p><p id="P7">We should note that the need for training a new DNA basecalling model – rather than using existing pre-trained DNA basecalling models – arises from the fact that the DNA barcode is sequenced using the ‘RNA’ chemistry, which exhibits several key differences to the DNA chemistry, preventing the use existing DNA basecalling models : i) RNA is sequenced from its 3' end (in 3'&gt;5' direction), while DNA is sequenced from its 5' end (in 5'&gt;3' direction); ii) the RNA helicase is slower than the DNA helicase (70 bps for RNA002 and 130 bps for RNA004, compared to 400-450 bps for DNA); and iii) RNA molecules are sampled with a different frequency than DNA molecules (3-4kHz for RNA, compared to 4-5kHz for DNA, depending on the flowcell). Thus, the same DNA barcode will generate different signals when sequenced with DNA and RNA kits, making existing DNA basecalling models unusable for basecalling of DNA barcodes in DRS datasets.</p><p id="P8">To demultiplex reads, SeqTagger performs several consecutive steps on each read: (i) signal segmentation (trimming of barcode signal) and normalisation, (ii) decoding of the signal into the sequence space (basecalling) followed by mapping to the reference, and (iii) filtering out potential misassigned barcodes using per-read median base quality information (<xref ref-type="fig" rid="F1">Fig. 1</xref>). To train the basecalling model, we chose the latest CTC-CRF model architecture that is achieving over 99% basecalling accuracy for DNA basecalling (<ext-link ext-link-type="uri" xlink:href="https://nanoporetech.com/platform/accuracy/">https://nanoporetech.com/platform/accuracy/</ext-link>). Training was performed using the <italic>Bonito</italic> software (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/bonito/">https://github.com/nanoporetech/bonito/</ext-link>) (see <italic>Methods</italic>), and trained models (listed in <xref ref-type="supplementary-material" rid="SD2">Supplemental Table S1</xref>) were independently validated on PromethION direct RNA sequencing datasets, both for RNA002 and RNA004 chemistries (see <xref ref-type="supplementary-material" rid="SD3">Supplemental Table S2</xref> for full list of DRS datasets used).</p></sec><sec id="S4"><title>Systematic benchmarking of DRS demultiplexing software</title><p id="P9">We first trained SeqTagger on DRS data sequenced with R9.4/RNA002 chemistry, using 4 different barcodes that were embedded within the RT adapter (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). Notably, barcode sequences were kept identical to those used to train the DeePlexiCon model, to allow for direct comparison between SeqTagger and DeePlexiCon (see <xref ref-type="supplementary-material" rid="SD2">SupplementalTable S1</xref> and <italic>Methods</italic>).</p><p id="P10">To test the performance of the trained models, we generated three datasets of 100,000 reads each from an independently sequenced sample, in which each barcode had been ligated to a different <italic>in vitro</italic> transcribed (IVT) RNA (<xref ref-type="supplementary-material" rid="SD3">Supplemental Table S2</xref>). In this design, the ground truth is known thus allowing us to determine classification metrics of the trained model (see <xref ref-type="fig" rid="F2">Fig. 2A</xref> and <xref ref-type="supplementary-material" rid="SD4">Supplemental Table S3</xref>). We should note that this independently sequenced run was not used for training/validation or of either demultiplexing tool. To facilitate the monitoring of resources, and ensure that the computational resources used by each of the software were directly comparable, the data was analysed using MasterOfPores (<xref ref-type="bibr" rid="R4">Cozzuto et al. 2023</xref>; <xref ref-type="bibr" rid="R7">Di Tommaso et al. 2017</xref>), a nextflow workflow for the analysis of DRS data, with the option ‘SeqTagger’ (model b04_RNA002), ‘DeePlexiCon’ (model resnet20-final.h5) or ‘no demultiplexing’ (ground-truth) (see <italic>Methods</italic>).</p><p id="P11">We then compared SeqTagger results (using default settings, i.e. baseQ-cutoff ≥ 50) to those obtained with DeePlexiCon, either using settings for high recovery (<monospace>-s 0.5</monospace>) or high accuracy (<monospace>--s 0.9</monospace>). Samples were processed using GPU computing nodes running CUDA10, as CUDA11 is not supported by DeePlexiCon, and thus would not be directly comparable to SeqTagger. Of note, SeqTagger can be executed both in GPU computing nodes running CUDA10 and CUDA11. Our analysis revealed that SeqTagger reached 99% precision on the independent test datasets, whereas DeePlexiCon achieved 93% and 97% precision with the high recovery and high accuracy settings, respectively (<xref ref-type="fig" rid="F2">Fig. 2B</xref>, top panel, <italic>see also</italic> <xref ref-type="supplementary-material" rid="SD4">Supplemental Table S3</xref>). In addition, SeqTagger achieved a recall of 95%, whereas DeePlexiCon's high recovery mode reached 89%, followed by the high accuracy mode with 75% recall (<xref ref-type="fig" rid="F2">Fig. 2B</xref>, bottom panel, <italic>see also</italic> <xref ref-type="supplementary-material" rid="SD4">Supplemental Table S3</xref>).</p><p id="P12">Next, we examined the computing time and resources required for demultiplexing. Our analysis demonstrated that SeqTagger was ~9x faster than DeePlexiCon (<xref ref-type="fig" rid="F2">Fig. 2C</xref> top panel, <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1A</xref>, and <xref ref-type="supplementary-material" rid="SD5">Supplemental Table S4</xref>). Notably, this increase in speed has important implications for the pre-processing of DRS data, as the demultiplexing step is typically a major computational bottleneck, taking up ≥ 50% of the overall computation time (<xref ref-type="fig" rid="F2">Fig. 2C</xref> bottom panel, <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1B</xref>, and <xref ref-type="supplementary-material" rid="SD5">Supplemental Table S4</xref>). Similar results were observed when performing the same analysis on a more complex dataset of mouse poly(A)-selected material, where DeePlexiCon was found to take ~40% of the overall computation time while SeqTagger reduced this to 8.5% of the total time required (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1C</xref>).</p><p id="P13">Finally, we tested SeqTagger’s classification performance on <italic>in vivo</italic> data, by using two runs of poly(A)-tailed, total RNA from <italic>E. coli</italic> (<xref ref-type="bibr" rid="R6">Delgado-Tejedor et al. 2023</xref>). Both runs contained two (out of the four possible) barcodes used in our b04 models, thus allowing us to determine the false positive rate per barcode. This showed that between 0.1-0.2% of total demultiplexed reads were incorrectly assigned per barcode using SeqTagger, resulting in an overall precision of ≥ 99% (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1D</xref>, <italic>see also</italic> <xref ref-type="supplementary-material" rid="SD6">Supplemental Table S5</xref>). By contrast, DeePlexiCon had higher amounts of incorrectly predicted barcodes, reaching 3-6% per barcode in high-recovery mode and 1-3% in high-accuracy mode (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1D</xref>). In addition, SeqTagger recovered higher proportions of demultiplexed reads (90-93% recall) than DeePlexiCon under high-recovery (81-88% recall) or high-accuracy modes (65-73% recall), supporting our observations made on <italic>in vitro</italic> datasets (<italic>see</italic> <xref ref-type="supplementary-material" rid="SD6">Supplemental Table S5</xref>).</p><p id="P14">Taken together, these results demonstrate that demultiplexing direct RNA sequencing datasets by basecalling the DNA part of the RT adapter yields superior performance both in terms of precision and recall, while providing a significant increase in speed over existing tools.</p></sec><sec id="S5"><title>SeqTagger is compatible with both RNA002 and RNA004 chemistries</title><p id="P15">We then examined whether SeqTagger would be able to demultiplex DRS datasets sequenced with the recently upgraded chemistry that ONT has released for sequencing DRS datasets, which uses SQK-RNA004 kits (replacing SQK-RNA002 kits) and ‘RNA’ flowcells (replacing R9.4 flowcells). Notably, demultiplexing options are currently unavailable for this newer chemistry, neither commercially nor from the scientific community, thus making the transition to the newer chemistry highly problematic.</p><p id="P16">Here, we prepared DRS libraries using the recently released SQK-RNA004 library preparation kit on the same 4 barcodes (<xref ref-type="supplementary-material" rid="SD3">Table S2</xref>) ligated to IVT products as previously described, and trained a new demultiplexing model using <italic>Bonito</italic> (b04_RNA004). The performance of the model was assessed using reads from an independent test dataset (flowcell not used for training/validation of the model), as previously done for the SQK-RNA002/R9.4 chemistry (<xref ref-type="fig" rid="F2">Fig. 2D</xref> top panels, <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1E</xref>, and <xref ref-type="supplementary-material" rid="SD4">Supplemental Table S3</xref>). Our results showed that SeqTagger was able to reach an overall precision above 99% with a recall of 97% on the new RNA004 chemistry (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. 2D</xref> bottom panels), thus showing improved performance compared to the old R9.4/RNA002 chemistry.</p><p id="P17">Altogether, our results demonstrate that SeqTagger is a robust DRS demultiplexing algorithm, reaching ≥ 99% precision on both RNA002 and RNA004 chemistries while recovering 95% and 97% of all reads, respectively. Notably, the increased demultiplexing speed that direct basecalling of the DNA barcode offers (<xref ref-type="fig" rid="F2">Fig. 2C</xref>), makes SeqTagger well-suited for larger-sized datasets that are expected to be generated with RNA004 kits (due to increased helicase speed and likely higher flowcell longevity), thus removing a potential computational bottleneck in DRS data analyses.</p></sec><sec id="S6"><title>SeqTagger can be extended to different RNA biotypes</title><p id="P18">Commercial DRS library preparation kits were initially designed to sequence poly-(A)-tailed RNA (mRNA, lncRNA, etc.) or <italic>in-vitro</italic> polyadenylated RNA molecules. For this reason, many DRS-related software, such as DeePlexiCon, were trained on polyadenylated RNA molecules, and rely on the identification of the poly-(A) homopolymeric region to segment the barcode signal.</p><p id="P19">Recent works have shown that it is possible to sequence very short RNA reads (e.g. tRNAs, (<xref ref-type="bibr" rid="R20">Thomas et al. 2021</xref>; <xref ref-type="bibr" rid="R15">Lucas et al. 2023</xref>)), opening novel avenues to explore the small RNA (epi)transcriptome at single molecule resolution. To efficiently capture these short RNA molecules, adapted library preparation protocols, such as those used in ‘Nano-tRNAseq’, are required (<xref ref-type="bibr" rid="R15">Lucas et al. 2023</xref>). Notably, Nano-tRNAseq libraries substantially differ from standard DRS protocols, and the resulting reads contain very short poly-(A)-tails, which are RNA-DNA hybrids, and thus potentially lead to incorrect demultiplexing due to imprecise segmentation. Indeed, our initial explorations revealed that DeePlexiCon was not able to accurately demultiplex Nano-tRNAseq libraries, reaching 70% precision and 77% recall on Nano-tRNAseq libraries (<xref ref-type="supplementary-material" rid="SD7">Table S6</xref>).</p><p id="P20">To overcome this limitation, we specifically trained a new model to multiplex Nano-tRNAseq datasets (see <xref ref-type="fig" rid="F3">Fig. 3A</xref>). Our results showed that SeqTagger was able to demultiplex up to four barcodes reaching high precision (98.3%) on the validation set (<xref ref-type="fig" rid="F3">Fig. 3B</xref>), making it possible to multiplex Nano-tRNAseq libraries in the same flowcell, thus reducing Nano-tRNAseq library preparation and sequencing costs.</p></sec><sec id="S7"><title>SeqTagger can be extended to accurately demultiplex large barcode sets</title><p id="P21">Next, we wondered whether SeqTagger could be extended in terms of multiplexing capacity, i.e., by training a model that would predict additional barcodes, and whether demultiplexing performance would be significantly affected by the increased number of barcodes. To examine this, we trained a model containing a total 96 different barcodes (b96_RNA002), using the same procedure as previously described for four barcodes (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, <italic>see also</italic> <xref ref-type="supplementary-material" rid="SD2">Supplemental Table S1</xref>). Our results obtained on the validation dataset demonstrated that increasing the barcoding capacity by 24-fold only had a minor effect on model precision (98.8%) enabling simultaneous sequencing of up to 96 samples on a single flowcell (<xref ref-type="fig" rid="F3">Fig. 3C</xref>).</p><p id="P22">We then examined the ability of SeqTagger to demultiplex <italic>in vivo</italic> samples using three independent test datasets. To this end, we extracted total RNA from human samples, which we poly(A)-tailed to make them amenable for direct RNA sequencing (<italic>see</italic> Methods). Next, we prepared three independent libraries barcoding each with one of the barcodes used for training the 96 barcode model (b96_RNA002). As expected, analysis of all three libraries revealed that the average base quality (baseQ) for barcodes present in the library was significantly higher than those absent, suggesting that base quality is an efficient parameter to remove false positive predictions (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, see also <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S2A</xref>). Moreover, applying the default base quality filter used internally by SeqTagger (baseQ &gt; 50), removed the majority of incorrectly assigned barcodes (96-97%) while maintaining between 93-95% of reads assigned to barcodes present in each library (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, see also <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S2B</xref>). Of note, SCBC-25 which showed lower base quality on the independent test data (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, left panel), performed well on an additional independent test run containing this same barcode suggesting that the low performance on this particular test dataset was possibly related to the sample/library preparation, rather than the demultiplexing model (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S2C</xref>).</p></sec></sec><sec id="S8" sec-type="discussion"><title>Discussion</title><p id="P23">Direct RNA nanopore sequencing has recently emerged as a transformative platform to characterise the (epi)transcriptome, offering unparalleled advantages in the analysis of RNA molecules, such as the possibility to detect its native RNA modifications (<xref ref-type="bibr" rid="R10">Garalde et al. 2018</xref>; <xref ref-type="bibr" rid="R15">Lucas and Novoa 2023</xref>). DRS has so far been used to address a wide range of biological questions in different biological systems, such as deciphering the order of intron removal during RNA splicing (<xref ref-type="bibr" rid="R9">Drexler et al. 2020</xref>), dissecting RNA modification dynamics upon chemical or biological stress (<xref ref-type="bibr" rid="R12">Huang et al. 2021</xref>; <xref ref-type="bibr" rid="R2">Begik et al. 2021</xref>; <xref ref-type="bibr" rid="R6">Delgado-Tejedor et al. 2023</xref>; <xref ref-type="bibr" rid="R15">Lucas et al. 2023</xref>), and elucidating viral RNA dynamics (<xref ref-type="bibr" rid="R21">Viehweger et al. 2019</xref>; <xref ref-type="bibr" rid="R17">Price et al. 2020</xref>; <xref ref-type="bibr" rid="R14">Kim et al. 2020</xref>; <xref ref-type="bibr" rid="R1">Baquero-Pérez et al. 2024</xref>), among others.</p><p id="P24">To date, commercial options for DRS multiplexing are lacking. Consequently, the field has relied on community-based solutions for demultiplexing, such as PorePlex (<ext-link ext-link-type="uri" xlink:href="https://github.com/hyeshik/poreplex">https://github.com/hyeshik/poreplex</ext-link>) or DeePlexiCon (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>). The latter, while being accurate and widely adopted by the community (<xref ref-type="bibr" rid="R18">Rajan et al. 2023</xref>; <xref ref-type="bibr" rid="R2">Begik et al. 2021</xref>; <xref ref-type="bibr" rid="R13">Javaran et al. 2023</xref>; <xref ref-type="bibr" rid="R11">Gupta et al. 2023</xref>; <xref ref-type="bibr" rid="R22">White et al. 2023</xref>), suffers from several limitations: i) it currently supports only 4 barcodes; ii) to date, it only supports old sequencing chemistries (RNA002, currently being deprecated); iii) it requires CUDA v10 - and consequently won't work with GPUs released after 2019, which use CUDA v11; iv) it does not work with custom reads that do not contain standard polyadenylated reads, such as Nano-tRNAseq reads, and v) the signal transformation step, is computationally expensive.</p><p id="P25">To overcome these limitations, we developed a novel approach for demultiplexing DRS reads, which relies on DNA basecalling of the barcode region, referred to as <italic>SeqTagger</italic>. We find that SeqTagger is a rapid and accurate demultiplexing program that is robust across different sequencing chemistries (RNA002, RNA004), devices (MinION, PromethION), and RNA species (mRNA, tRNA), supporting both fast5 and pod5 file formats. It achieves very high precision and recall on both smaller (4) and larger (96) barcode sets, thus opening exciting possibilities for the cost-effective sequencing of multiple samples on a single flowcell. To put these results into a broader context, a study published on cDNA demultiplexing on the ONT platform reached similar performance metrics on a twelve-barcode set compared to SeqTagger (b96_RNA002) (<xref ref-type="bibr" rid="R23">Wick et al. 2018</xref>). This suggests that demultiplexing using SeqTagger for direct RNA-sequencing can reach similar (RNA002) or higher (RNA004) classification metrics than current tools for cDNA demultiplexing.</p><p id="P26">We would like to note that the speed of demultiplexing with SeqTagger is still mostly bound by data access (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1A</xref>) with our results reflecting a network filesystem. We observed that one million reads can be demultiplexed in 5 or 12 minutes when using a local SSD or HDD, respectively. Moreover, when data access isn't a bottleneck, for example when the read signals are already loaded in system memory, SeqTagger can classify 50 barcodes in 5 milliseconds. This opens exciting possibilities such as real-time barcode classification of direct RNA sequencing reads, similar to what is currently available for DNA nanopore sequencing.</p><p id="P27">Finally, as an alternative approach to SeqTagger, one could imagine ligating either an RNA:DNA heteroduplex or an RNA:RNA barcode at the first step of library preparation (instead of DNA:DNA), which could be readily basecalled with existing RNA basecalling models and subsequently demultiplexed. However, there are several major challenges from both a wet- and dry-lab perspective with such an approach. Firstly, this would require a change to the library preparation protocol as ligases exhibit different substrate specificities, which in turn could reduce the overall efficiency of the library preparation (<xref ref-type="bibr" rid="R3">Bullard and Bowater 2006</xref>). Additionally, RNA oligonucleotides pose a substantial economic burden. For example, ordering only one strand of the oligonucleotides used in this study as an RNA molecule increases the cost of one RT adapter by ten fold, making large barcode sets prohibitively expensive. Moreover, RNA molecules are inherently less stable than DNA, which could lead to problems particularly when freeze-thawed multiple times, which is common for RT adapters. From a computational perspective, RNA oligonucleotides would require major changes to both the acquisition software MinKNOW and the basecalling software, as many definitions rely on differences in the current intensity signals obtained from RNA ligated to the DNA adapter.</p></sec><sec id="S9" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S10"><title>Plasmid extraction and linearization</title><p id="P28">We selected plasmids encoding <italic>in vitro</italic> transcripts from a T7 promoter that share little sequence similarity (<italic>see</italic> <xref ref-type="supplementary-material" rid="SD8">Supplemental Table S7</xref>) to enable unambiguous mapping of sequencing reads. Overnight cultures (LB-Ampicillin, 100μg/ml) containing <italic>E.coli</italic> transfected with the plasmids were processed using the Monarch® Plasmid DNA Miniprep Kit Protocol (NEB #T1010). Subsequently, plasmids were linearized using 25μl plasmid solution, 5μl of Enzyme 1, 5μl of Enzyme 2 (specific enzymes are mentioned in <xref ref-type="supplementary-material" rid="SD8">Supplemental Table S7</xref>), and 10μl of CutSmartBuffer in a total volume of 100μl for 3h at 37C. Volumes were topped up to 300μl using nuclease-free H2O before cleanup using 1x volume of basic Phenol:Chloroform:Isoamyl Alcohol (Sigma, P3803). Samples were vortexed followed by centrifugation at 16.000rpm for 5min. The aqueous phase was transferred to a new tube and supplemented with 0.1X 3M NaOAc (pH = 5.2), 2.5x EtOh abs., and 2μl of GlycoBlue™ (Thermo Fisher, AM9515). After overnight storage at -20C, precipitated plasmids were collected by centrifugation at 4C for 30min, 16000rpm. The pellet was washed twice with 70% EtOH and eluted in 30μl. Concentrations and purity were determined using a Nanodrop One/One<sup>c</sup> (Thermo Fisher).</p></sec><sec id="S11"><title>In vitro transcription and poly(A)-tailing</title><p id="P29"><italic>In vitro</italic> transcription was performed using the AmpliScribe T7-Flash Transcription Kit (Biosearch Technologies, ASF3507) with 1μg of each linearized plasmid as input. The reaction was carried out as specified in the manufacturer’s instructions with an overnight incubation at 37°C. The plasmid template was digested by adding 2μl of TURBO™ DNase (Thermo Fisher, AM2238) followed by incubation at 37C for 15min. <italic>In vitro</italic> transcripts were cleaned up using the RNeasy Mini Kit (Quiagen, 74104) and eluted in 60μl of nuclease-free H2O. Concentration and purity were determined using a Nanodrop One/One<sup>c</sup> (Thermo Fisher). Transcript integrity was determined using a TapeStation 4150 (Agilent). For poly-(A)-tailing 2μl of 10X <italic>E. coli</italic> Poly(A) Polymerase Reaction Buffer, 2μl of 10mM ATP, 0.5μl SUPERasedn™ RNase Inhibitor (Thermo Fisher, AM2696) and 1μl of <italic>E. coli</italic> Poly(A) Polymerase (NEB, M0276S) were added to 7μg of input <italic>in vitro</italic> transcript in a total volume of 20μl. The reaction was carried out for 3min at 37C to obtain short poly-(A)-tails. Samples were cleaned up using the RNA Clean &amp; Concentrator-5 Kit (Zymo Research, R1013) and eluted in 25μl of nuclease-free H<sub>2</sub>O.</p></sec><sec id="S12"><title>Barcode design</title><p id="P30">BC-01 to BC-04 correspond to barcodes previously described and used by DeePlexiCon (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>). They are comprised of a 30nt long oligoA with a 5’P end, to enable ligation during library preparation and a 49nt long oligoB which contains a 10nt poly-d(T) 3’-end required for annealing to the target poly-(A)-containing library. SCBC-01 through SCBC-96 were designed to contain regions that are highly distinguishable in the sequence space (<xref ref-type="bibr" rid="R8">Doroschak et al. 2020</xref>). They are comprised of a 47nt long oligoA with a 5’P group to enable ligation during library preparation, and a 66nt long oligoB which contains a 10nt poly-d(T) 3’-end required for annealing to the target poly-(A)-containing library. See <xref ref-type="supplementary-material" rid="SD2">Table S1</xref> for details on all oligonucleotide sequences used to build barcoded libraries.</p></sec><sec id="S13"><title>Hybridization of custom RT adapters containing barcode sequences</title><p id="P31">All DNA oligos were ordered from IDT and annealed prior to library preparation using a final concentration of 1.4μM of each oligonucleotide, 0.01M Tris-HCl (pH = 7.5), and 0.05M NaCl in a total volume of 75μl nuclease-free H2O. The mixture was incubated at 94°C for 1 min and slowly cooled down (-0.1°C/sec) to room temperature. Small Aliquots were prepared to prevent repeated freeze/thawing of hybridized adapters. All oligonucleotides used in this work are listed in <xref ref-type="supplementary-material" rid="SD2">SupplementalTable S1</xref>.</p></sec><sec id="S14"><title>Direct RNA sequencing of training data</title><p id="P32"><italic>RNA002:</italic> Library preparation was carried out according to the manufacturer’s instructions (direct-rna-sequencing-sqk-rna002-DRS_9080_v2_revR_14Aug2019-minion) with some adjustments to enable barcode adapter ligation, prevent cross-contamination of barcodes and enable cost-efficient library preparation of multiple barcodes. Adapter ligation was carried out for 15min at room temperature using 100ng of input poly-A-tailed substrate, 0.5μl of custom barcode adapter (1.4μM), 1.5μl of NEBNext® Quick Ligation Reaction Buffer (NEB, B6058S), 0.5μl of RNAse Inhibitor (NEB, M0314S) and 0.75μl of concentrated T4 DNA Ligase (NEB, M0202T) in a total volume of 7.75μl nuclease-free H2O. Subsequently, 4μl of 5x SuperScript IV Buffer, 1μl of dNTPs (NEB, N0447S), 2μl 0.1 DTT, and 1μl of SuperScript™ IV Reverse Transcriptase (Thermo Fisher, 18090010) were added and the reaction incubated for 15min at 50C before heat inactivation for 2min at 70C. Reverse transcribed RNA:DNA hybrids were cleaned up using 1X RNAClean XP beads (Beckman Coulter, A63987), washed twice using freshly prepared 70% EtOH, and eluted in 3μl of nuclease-free H<sub>2</sub>O. 2.5μl of eluate was transferred to a new tube and RMX ligation was carried out individually for each barcode by adding 1μl of NEBNext® Quick Ligation Reaction Buffer (NEB, B6058S), 0.75μl of RMX adapter, and 0.375μl of T4 DNA Ligase (NEB, M0202T) in a total volume of 5μl nuclease-free H2O by incubating for 15min at room temperature. Libraries were cleaned up using 0.8X RNAClean XP beads (Beckman Coulter, A63987), and washed twice using 20μl of Wash Buffer (WSB) each time. Samples were eluted in 4μl of elution buffer (EB). Barcoded libraries were pooled at this step and the volume was adjusted to 18.75μl using nuclease-free H<sub>2</sub>O. Each library was mixed with 18.75μl of RNA running buffer (RRB) and run on a primed R9.4.1 flowcell using a MinlON sequencer with MinKNOW acquisition software version v23.11.4. Live base calling and mapping were activated and runs stopped once ≥ 40.000 mapped reads were reached per barcode. Flowcells were reused multiple times following flushing (<italic>see</italic> Flowcell nuclease flushing).</p><p id="P33"><italic>RNA004:</italic> Library preparation was carried out according to the manufacturer’s instructions (direct-rna-sequencing-sqk-rna004-DRS_9195_v4_revB_20Sep2023-promethion). Changes to the above workflow for <italic>RNA002</italic> are mentioned, the remaining steps were identical. For adapter ligation 0.75μl of RNA Ligation Adapter (RLA) were used. Barcoded libraries were pooled and the volume was adjusted to 32μl using nuclease-free H<sub>2</sub>O. Before loading the libraries were mixed with 100μl of Sequencing Buffer (SB) and 68μl of Library Solution (LIS). Libraries were run on a primed FLO-PRO004RA flowcell using a PromethlON 2 solo sequencer with MinKNOW acquisition software version v23.11.4.</p></sec><sec id="S15"><title>Flowcell nuclease flushing</title><p id="P34">Preventing carry-over during sequencing runs was paramount for generating high-quality training data. Hence, we adapted the existing flowcell flushing protocol (EXP-WSH004) by preparing a modified flowcell wash mix. To this end, we mixed 20μl of TURBO™ DNase (Thermo Fisher, AM2238) with 380μl of wash diluent (DIL, provided with EXP-WSH004). After loading the mix into the flowcell the reaction was incubated for 20 minutes. The remaining steps were identical to the manufacturer’s protocol. In our hands, this yielded negligible carry-over between runs (0.01-0.03%).</p></sec><sec id="S16"><title>Sample preparation and direct RNA sequencing of independent test data for b96</title><p id="P35">Total RNA was isolated using the AllPrep RNA/DNA/miRNA Universal Kit (Qiagen, 80224) using the manufacturer’s instructions. Frozen lung cryosections were homogenised with the TissueLyser mixer-mill disruptor (2 x 2 min, 25 Hz, Qiagen, Hilden, Germany). The quality of total RNA was assessed with an Agilent 2100 Bioanalyzer and Agilent RNA 6000 Nano Kit (Agilent Technologies, Boeblingen, Germany). Next, total RNA was split into a long (≥200nt) and short (&lt;200nt) fraction using the RNeasy MinElute kit (Qiagen, #74204). Subsequently the long RNA fraction was poly-A-tailed (NEB, #M0276) in a total of 40μl. Individual poly-(A)-tailed samples were cleaned up using RNAClean XP beads (Beckman, #A63987).</p><p id="P36">For direct RNA-sequencing library preparation, individual samples (150 ng each) were ligated to pre-annealed (as described above) barcode-containing RT adapters (SCBCs) using concentrated T4 DNA Ligase (NEB, M0202T). Following reverse transcription using SuperScript™ IV Reverse Transcriptase (Thermo Fisher, 18090010), barcoded samples were pooled prior to clean-up RNAClean XP beads (Beckman, #A63987). For RMX ligation 250 ng of pooled library were used. Subsequent steps followed the standard direct RNA-sequencing library preparation protocol for RNA002 (direct-rna-sequencing-sqk-rna002-DRS_9080_v2_revS_14Aug2019-promethion). Libraries were run on a primed R9.4.1 flowcell using a PromethION sequencer with MinKNOW acquisition software version v23.11.4.</p></sec><sec id="S17"><title>Training the DNA basecaller</title><p id="P37">The training algorithm, <italic>bonito</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/bonito/">https://github.com/nanoporetech/bonito/</ext-link>), was used to train the DNA basecaller model. Bonito requires as input signal chunks of fixed length and their corresponding barcode sequences. To know the signal-to-sequence correspondence for training purposes, one can either sequence one barcode per flowcell/run or ligate each barcode to a unique RNA molecule and later assign each read to the barcode by mapping reads to the corresponding references (see <xref ref-type="supplementary-material" rid="SD2">Table S1</xref> for barcode-sequence design).</p><p id="P38">We used 120,000 reads per barcode to train 4-barcode models (b04) and 40,000 reads per barcode for larger barcode sets (b96). Reads were randomly subsampled to reach the required number of reads per barcode. Importantly, we used only the last 3,000 (RNA002) or 2,000 (RNA004) samples of every barcode signal for training and basecalling. The reads with shorter barcodes were skipped.</p><p id="P39">The CTC-CRF models were trained with bonito v0.7.2. We used a window of 31 and a stride of 10. We tested three model versions with an increasing number of features used by the encoder (and model parameters): 96 (fast with 519,880 parameters), 384 (hac with 6,499,048 parameters) and 768 (sup with 24,793,192 parameters). Since we found only marginal differences in their accuracy for barcode basecalling (data not shown), we decided to use the lightest (and fastest) version with 96 features (fast).</p></sec><sec id="S18"><title>Basecalling of DNA barcode from direct RNA sequencing</title><p id="P40">The demultiplexing algorithm follows several steps: i) signal segmentation, ii) normalisation, iii) barcode sequence decoding, iv) barcode identification and v) quality filtering. First, the signal corresponding to the barcode is identified by T-test statistics in two window sizes (450 and 1,000) rolling over the first 30,000 read samples. We define barcode end as the position with the highest T-test score, additionally adding 100 samples of poly-A tail. Secondly, the barcode signal is normalised using median absolute deviation. Thirdly, the barcode sequence (and corresponding base qualities) are decoded using bonito v0.7.2 with a custom barcode basecalling model. Subsequently, the sequence is aligned onto barcode reference using minimap2 v2.26 executed with custom parameters: -k6 -w3 -A1 -B1 -O1 -E1 -c1 -m10 -s13. The best primary alignment for every barcode sequence is reported as the predicted barcode. Finally, only barcodes with median basecall quality above 50 are reported.</p></sec><sec id="S19"><title>Comparative analysis of demultiplexing software</title><p id="P41">For comparative performance analysis of demultiplexing software, we sampled 3 x 100,000 reads from an independent RNA002 run which consisted of IVT-01-04 ligated to BC-01-04 (<xref ref-type="fig" rid="F2">Fig. 2A</xref>, <italic>see also</italic> <xref ref-type="supplementary-material" rid="SD3">Supplemental Table S2</xref>), which had not been used to train or validate the models. Each dataset was processed using the MasterOfPores (<xref ref-type="bibr" rid="R5">Cozzuto et al. 2020</xref>) version 3 nextflow (<xref ref-type="bibr" rid="R7">Di Tommaso et al. 2017</xref>) workflow, using either SeqTagger (model: <italic>b04_RNA002</italic>), DeePlexiCon (<xref ref-type="bibr" rid="R19">Smith et al. 2020</xref>) (model: <italic>resnet20-final.h5)</italic> or no demultiplexing (ground-truth) while keeping the remaining parameters identical. We compared default SeqTagger settings (baseQ ≥ 50, <monospace>-b 50</monospace>) with DeePlexiCon settings for high recovery (<monospace>-s 0.5</monospace>) and high accuracy (<monospace>-s 0.9</monospace>). Demultiplexing of individual samples (100,000 reads) was performed on a single GPU (RTX2080 Ti, CUDA10) and a single CPU with 12GB of memory allocated (<monospace>--granularity 25</monospace>). Samples were basecalled using guppy (v6.0.6, model = rna_r9.4.1_70bps_hac.cfg) and aligned to the reference sequence using minimap2 (v2.17) with <monospace>-ax map-ont -k14</monospace>.</p><p id="P42">Model performance metrics used to build confusion matrices and receiver operating characteristic curves were extracted using custom python scripts. Computational resources required per sample were extracted from the nextflow report (<monospace>-with-report</monospace>, see <xref ref-type="supplementary-material" rid="SD5">Supplemental Table S4</xref>) and analyzed using custom R scripts.</p><p id="P43">To compare the computation time of processes executed in the mop_preprocess workflow we used rep-1 of the benchmarking dataset and recorded the computation time required by each process (<xref ref-type="fig" rid="F2">Fig. 2C</xref> bottom, and <xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1B</xref>). We realized that these results would underestimate the relative contribution of the mapping step as mapping was performed to a small reference of four sequences. To obtain a more realistic representation of the required computation time per process we sampled 100,000 reads from a poly-(A)-selected <italic>M. musculus</italic> library which was aligned to the mm39 reference genome (minimap2, v2.17, <monospace>-uf -ax splice -k14</monospace>). In addition, we activated counting, another optional step in the preprocessing pipeline. We obtained comparable results to the benchmarking dataset with DeePlexiCon taking up 40% of the overall computation time while SeqTagger reduces the time required to 8.5% (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1C</xref>). To determine the performance of SeqTagger on <italic>in vivo</italic> datasets, we demultiplexed two runs containing poly(A)-tailed, total RNA extracted from <italic>E.coli (<xref ref-type="bibr" rid="R6">Delgado-Tejedor et al. 2023</xref>)</italic> (<xref ref-type="supplementary-material" rid="SD1">Supplemental Fig. S1D</xref>, and <xref ref-type="supplementary-material" rid="SD6">Supplemental Table S5</xref>). Both runs were aligned to the <italic>E. coli</italic> rRNA reference (minimap2, v2.17, <monospace>-ax map-ont -k14</monospace>) after demultiplexing using either SeqTagger (model: <italic>b04_RNA002</italic>) or DeePlexiCon (model: <italic>resnet20-final.h5)</italic> with high recovery (-s 0.5) or high accuracy (-s 0.9) settings. Accuracy was determined by counting the number of reads assigned to each barcode in the fastq files (<xref ref-type="supplementary-material" rid="SD6">Supplemental Table S5</xref>). All scripts used to perform this analysis, as well as the reference sequences, can be found on the Github page (<ext-link ext-link-type="uri" xlink:href="https://github.com/novoalab/SeqTagger/">https://github.com/novoalab/SeqTagger/</ext-link>).</p></sec><sec id="S20"><title>Benchmarking model performance for RNA004, extended barcode models and tRNA models</title><p id="P44">To determine model performance on the new RNA004 chemistry we used an independent test dataset in which IVT-01-04 was ligated to BC-01-04, which hadn’t been previously used for model training or validation. Results were processed identically to the process described above (see <italic>Comparative Analysis of demultiplexing software</italic>) with exceptions mentioned next. Demultiplexing was run on a CUDA11-enabled single GPU (NVIDIA RTX A4000) and a single CPU with 12GB of memory allocated. For basecalling we used dorado (v0.5.3, <ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/dorado">https://github.com/nanoporetech/dorado</ext-link>, model = rna004_130bps_sup@v3.0.1). The extended barcode model (b96_RNA002) was trained on 24 runs each containing four <italic>in vitro</italic> transcripts ligated to the respective barcode. Confusion matrices were generated based on the validation dataset (analysis notebooks available at <ext-link ext-link-type="uri" xlink:href="https://github.com/novoalab">https://github.com/novoalab</ext-link>). The tRNA model was trained by using four individual Nano-tRNAseq runs performed on human cell lines, each using a different barcode sequence. Confusion matrices were generated based on the validation dataset. All runs used to generate training and testing data are listed in <xref ref-type="supplementary-material" rid="SD3">SupplementalTable S2</xref>.</p></sec></sec><sec id="S21"><title>Software Availability</title><p id="P45">SeqTagger can be executed using a Docker container following the instructions on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/novoalab/SeqTagger">https://github.com/novoalab/SeqTagger</ext-link>) or using the MasterOfPores (version 3.0) nextflow pipeline (MoP3) (<ext-link ext-link-type="uri" xlink:href="https://github.com/biocorecrg/MOP3">https://github.com/biocorecrg/MOP3</ext-link>) (<xref ref-type="bibr" rid="R4">Cozzuto et al. 2023</xref>; <xref ref-type="bibr" rid="R7">Di Tommaso et al. 2017</xref>). Processing of raw fast5 files was performed using MasterOfPores (version 3.0). Full documentation on installation, usage, and dependencies related to MoP3 (including running SeqTagger via MoP3) can be found at <ext-link ext-link-type="uri" xlink:href="https://biocorecrg.github.io/MoP3/">https://biocorecrg.github.io/MoP3/</ext-link>.</p></sec><sec id="S22"><title>Data Access</title><p id="P46">Raw fast5 files and associated basecalled data in the form of bam files, generated in this work have been deposited in the European Nucleotide Archive (ENA) under accession code PRJEB78482. Basecalled fast5 datasets for poly-(A)-tailed, total RNA from <italic>E. coli</italic> used to determine cross-contamination are publicly available under accession code PRJEB42568. A summary of all datasets used in this work can be found in <xref ref-type="supplementary-material" rid="SD3">Supplemental Table S2</xref>.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental_Figures</label><media xlink:href="EMS199803-supplement-Supplemental_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d29aAcGbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplemental_Table_S1</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplemental_Table_S2</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplemental_Table_S3</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S3.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplemental_Table_S4</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S4.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGfB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>Supplemental_Table_S5</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S5.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGgB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>Supplemental_Table_S6</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S6.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGhB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD8"><label>Supplemental_Table_S7</label><media xlink:href="EMS199803-supplement-Supplemental_Table_S7.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d29aAcGiB" position="anchor"/></supplementary-material></sec></body><back><ack id="S23"><title>Acknowledgements</title><p>LPP was supported by funding from the European Union’s H2020 research and innovation program under Marie Sklodowska-Curie grant agreement No. 754422 and is currently supported by ERC funds (ERC-StG-2021 No 101042103 to EMN). GD is part of the ROPES ITN which received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie grant agreement no. 956810. AD-T is supported by an FPI Severo-Ochoa fellowship by the Spanish Ministry of Economy, Industry and Competitiveness (MEIC). We would like to thank Dr. Huanle Liu for his insights and discussions at the commencement of this project. This work was supported by funds from the Spanish Ministry of Economy, Industry and Competitiveness (MEIC) (PID2021-128193NB-100 to EMN) and the European Research Council (ERC-StG-2021 No 101042103 to EMN). We acknowledge the support of the MEIC to the EMBL partnership, Centro de Excelencia Severo Ochoa, and CERCA Programme / Generalitat de Catalunya.</p></ack><fn-group><fn id="FN1" fn-type="con"><p id="P47"><bold>Author Contributions</bold></p><p id="P48">GD generated training sets used to train SeqTagger models and performed bioinformatic analysis of the data, including comparative performance analysis to DeePlexiCon. LPP developed the SeqTagger algorithm and trained the models. LLL and RM contributed to generating nanopore sequencing datasets used to train the models. AD-T, LC and JP contributed to the data analysis and implementation of SeqTagger into MasterOfPores version 3. LPP and EMN conceived the project. EMN supervised the project. GD built the figures. GD, LPP and EMN wrote the manuscript, with contributions from all authors.</p></fn><fn id="FN2" fn-type="conflict"><p id="P49"><bold>Competing Interest Statement</bold></p><p id="P50">LPP, GD and EMN have filed patents on the SeqTagger demultiplexing algorithm and method (application EP24382340) and an extension thereof (application EP24383144). EMN has received travel and accommodation expenses to speak at Oxford Nanopore Technologies conferences. GD has received travel bursaries from ONT to present his work at conferences. EMN is a member of the Scientific Advisory Board of IMMAGINA Biotech.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baquero-Pérez</surname><given-names>B</given-names></name><name><surname>Yonchev</surname><given-names>ID</given-names></name><name><surname>Delgado-Tejedor</surname><given-names>A</given-names></name><name><surname>Medina</surname><given-names>R</given-names></name><name><surname>Puig-Torrents</surname><given-names>M</given-names></name><name><surname>Sudbery</surname><given-names>I</given-names></name><name><surname>Begik</surname><given-names>O</given-names></name><name><surname>Wilson</surname><given-names>SA</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name><name><surname>Díez</surname><given-names>J</given-names></name></person-group><article-title>N6-methyladenosine modification is not a general trait of viral RNA genomes</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="pmcid">PMC10928186</pub-id><pub-id pub-id-type="pmid">38467633</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-46278-9</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Begik</surname><given-names>O</given-names></name><name><surname>Lucas</surname><given-names>MC</given-names></name><name><surname>Pryszcz</surname><given-names>LP</given-names></name><name><surname>Ramirez</surname><given-names>JM</given-names></name><name><surname>Medina</surname><given-names>R</given-names></name><name><surname>Milenkovic</surname><given-names>I</given-names></name><name><surname>Cruciani</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Vieira</surname><given-names>HGS</given-names></name><name><surname>Sas-Chen</surname><given-names>A</given-names></name><etal/></person-group><article-title>Quantitative profiling of pseudouridylation dynamics in native RNAs with nanopore sequencing</article-title><source>Nat Biotechnol</source><year>2021</year><pub-id pub-id-type="pmid">33986546</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>DR</given-names></name><name><surname>Bowater</surname><given-names>RP</given-names></name></person-group><article-title>Direct comparison of nick-joining activity of the nucleic acid ligases from bacteriophage T4</article-title><source>Biochem J</source><year>2006</year><volume>398</volume><date-in-citation>Accessed July 11,2024</date-in-citation><pub-id pub-id-type="pmcid">PMC1525015</pub-id><pub-id pub-id-type="pmid">16671895</pub-id><pub-id pub-id-type="doi">10.1042/BJ20060313</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cozzuto</surname><given-names>L</given-names></name><name><surname>Delgado-Tejedor</surname><given-names>A</given-names></name><name><surname>Hermoso Pulido</surname><given-names>T</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name><name><surname>Ponomarenko</surname><given-names>J</given-names></name></person-group><article-title>Nanopore Direct RNA Sequencing Data Processing and Analysis Using MasterOfPores</article-title><source>Methods Mol Biol</source><year>2023</year><volume>2624</volume><fpage>185</fpage><lpage>205</lpage><pub-id pub-id-type="pmid">36723817</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cozzuto</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Pryszcz</surname><given-names>LP</given-names></name><name><surname>Pulido</surname><given-names>TH</given-names></name><name><surname>Delgado-Tejedor</surname><given-names>A</given-names></name><name><surname>Ponomarenko</surname><given-names>J</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name></person-group><article-title>MasterOfPores: A Workflow for the Analysis of Oxford Nanopore Direct RNA Sequencing Datasets</article-title><source>Front Genet</source><year>2020</year><volume>11</volume><fpage>211</fpage><pub-id pub-id-type="pmcid">PMC7089958</pub-id><pub-id pub-id-type="pmid">32256520</pub-id><pub-id pub-id-type="doi">10.3389/fgene.2020.00211</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delgado-Tejedor</surname><given-names>A</given-names></name><name><surname>Medina</surname><given-names>R</given-names></name><name><surname>Begik</surname><given-names>O</given-names></name><name><surname>Cozzuto</surname><given-names>L</given-names></name><name><surname>Ponomarenko</surname><given-names>J</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name></person-group><article-title>Native RNA nanopore sequencing reveals antibiotic-induced loss of rRNA modifications in the A- and P-sites</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.03.21.533606</elocation-id><date-in-citation>Accessed April 19, 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/biorxiv/early/2023/03/21/2023.03.21.533606">https://www.biorxiv.org/content/biorxiv/early/2023/03/21/2023.03.21.533606</ext-link></comment></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Tommaso</surname><given-names>P</given-names></name><name><surname>Chatzou</surname><given-names>M</given-names></name><name><surname>Floden</surname><given-names>EW</given-names></name><name><surname>Barja</surname><given-names>PP</given-names></name><name><surname>Palumbo</surname><given-names>E</given-names></name><name><surname>Notredame</surname><given-names>C</given-names></name></person-group><article-title>Nextflow enables reproducible computational workflows</article-title><source>Nat Biotechnol</source><year>2017</year><volume>35</volume><fpage>316</fpage><lpage>319</lpage><pub-id pub-id-type="pmid">28398311</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doroschak</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Queen</surname><given-names>M</given-names></name><name><surname>Mandyam</surname><given-names>A</given-names></name><name><surname>Strauss</surname><given-names>K</given-names></name><name><surname>Ceze</surname><given-names>L</given-names></name><name><surname>Nivala</surname><given-names>J</given-names></name></person-group><article-title>Rapid and robust assembly and decoding of molecular tags with DNA-based nanoporesignatures</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC7642340</pub-id><pub-id pub-id-type="pmid">33144581</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-19151-8</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drexler</surname><given-names>HL</given-names></name><name><surname>Choquet</surname><given-names>K</given-names></name><name><surname>Churchman</surname><given-names>LS</given-names></name></person-group><article-title>Splicing Kinetics and Coordination Revealed by Direct Nascent RNA Sequencing through Nanopores</article-title><source>Mol Cell</source><year>2020</year><volume>77</volume><fpage>985</fpage><lpage>998</lpage><elocation-id>e8</elocation-id><pub-id pub-id-type="pmcid">PMC7060811</pub-id><pub-id pub-id-type="pmid">31839405</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2019.11.017</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garalde</surname><given-names>DR</given-names></name><name><surname>Snell</surname><given-names>EA</given-names></name><name><surname>Jachimowicz</surname><given-names>D</given-names></name><name><surname>Sipos</surname><given-names>B</given-names></name><name><surname>Lloyd</surname><given-names>JH</given-names></name><name><surname>Bruce</surname><given-names>M</given-names></name><name><surname>Pantic</surname><given-names>N</given-names></name><name><surname>Admassu</surname><given-names>T</given-names></name><name><surname>James</surname><given-names>P</given-names></name><name><surname>Warland</surname><given-names>A</given-names></name><etal/></person-group><article-title>Highly parallel direct RNA sequencing on an array ofnanopores</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>201</fpage><lpage>206</lpage><pub-id pub-id-type="pmid">29334379</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>S-H</given-names></name><name><surname>Papas</surname><given-names>BN</given-names></name><name><surname>Martin</surname><given-names>NP</given-names></name><name><surname>Morgan</surname><given-names>M</given-names></name></person-group><article-title>TUT4/7-mediated uridylation of a coronavirus subgenomic RNAs delays viral replication</article-title><source>Commun Biol</source><year>2023</year><volume>6</volume><fpage>438</fpage><pub-id pub-id-type="pmcid">PMC10119532</pub-id><pub-id pub-id-type="pmid">37085578</pub-id><pub-id pub-id-type="doi">10.1038/s42003-023-04814-1</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Katanski</surname><given-names>CD</given-names></name><name><surname>Dersh</surname><given-names>D</given-names></name><name><surname>Dai</surname><given-names>Q</given-names></name><name><surname>Lolans</surname><given-names>K</given-names></name><name><surname>Yewdell</surname><given-names>J</given-names></name><name><surname>Eren</surname><given-names>AM</given-names></name><name><surname>Pan</surname><given-names>T</given-names></name></person-group><article-title>Interferon inducible pseudouridine modification in human mRNA by quantitativenanopore profiling</article-title><source>Genome Biol</source><year>2021</year><volume>22</volume><fpage>330</fpage><pub-id pub-id-type="pmcid">PMC8646010</pub-id><pub-id pub-id-type="pmid">34872593</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02557-y</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Javaran</surname><given-names>VJ</given-names></name><name><surname>Poursalavati</surname><given-names>A</given-names></name><name><surname>Lemoyne</surname><given-names>P</given-names></name><name><surname>Ste-Croix</surname><given-names>DT</given-names></name><name><surname>Moffett</surname><given-names>P</given-names></name><name><surname>Fall</surname><given-names>ML</given-names></name></person-group><article-title>NanoViromics: long-read sequencing of dsRNA for plant virus and viroid rapid detection</article-title><source>Front Microbiol</source><year>2023</year><volume>14</volume><elocation-id>1192781</elocation-id><pub-id pub-id-type="pmcid">PMC10320856</pub-id><pub-id pub-id-type="pmid">37415816</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2023.1192781</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Lee</surname><given-names>J-Y</given-names></name><name><surname>Yang</surname><given-names>J-S</given-names></name><name><surname>Kim</surname><given-names>JW</given-names></name><name><surname>Kim</surname><given-names>VN</given-names></name><name><surname>Chang</surname><given-names>H</given-names></name></person-group><article-title>The Architecture of SARS-CoV-2 Transcriptome</article-title><source>Cell</source><year>2020</year><volume>181</volume><fpage>914</fpage><lpage>921</lpage><elocation-id>e10</elocation-id><pub-id pub-id-type="pmcid">PMC7179501</pub-id><pub-id pub-id-type="pmid">32330414</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.04.011</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>MC</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name></person-group><article-title>Long-read sequencing in the era of epigenomics and epitranscriptomics</article-title><source>Nat Methods</source><year>2023</year><volume>20</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">36635539</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lucas</surname><given-names>MC</given-names></name><name><surname>Pryszcz</surname><given-names>LP</given-names></name><name><surname>Medina</surname><given-names>R</given-names></name><name><surname>Milenkovic</surname><given-names>I</given-names></name><name><surname>Camacho</surname><given-names>N</given-names></name><name><surname>Marchand</surname><given-names>V</given-names></name><name><surname>Motorin</surname><given-names>Y</given-names></name><name><surname>Ribasde Pouplana</surname><given-names>L</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name></person-group><article-title>Quantitative analysis of tRNA abundance andmodifications by nanopore RNA sequencing</article-title><source>Nat Biotechnol</source><year>2023</year><volume>42</volume><fpage>72</fpage><lpage>86</lpage><pub-id pub-id-type="pmcid">PMC10791586</pub-id><pub-id pub-id-type="pmid">37024678</pub-id><pub-id pub-id-type="doi">10.1038/s41587-023-01743-6</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AM</given-names></name><name><surname>Hayer</surname><given-names>KE</given-names></name><name><surname>McIntyre</surname><given-names>ABR</given-names></name><name><surname>Gokhale</surname><given-names>NS</given-names></name><name><surname>Abebe</surname><given-names>JS</given-names></name><name><surname>Della Fera</surname><given-names>AN</given-names></name><name><surname>Mason</surname><given-names>CE</given-names></name><name><surname>Horner</surname><given-names>SM</given-names></name><name><surname>Wilson</surname><given-names>AC</given-names></name><name><surname>Depledge</surname><given-names>DP</given-names></name><etal/></person-group><article-title>Direct RNA sequencing reveals m6A modifications on adenovirus RNA are necessary for efficient splicing</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>6016</elocation-id><pub-id pub-id-type="pmcid">PMC7691994</pub-id><pub-id pub-id-type="pmid">33243990</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-19787-6</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname><given-names>KS</given-names></name><name><surname>Madmoni</surname><given-names>H</given-names></name><name><surname>Bashan</surname><given-names>A</given-names></name><name><surname>Taoka</surname><given-names>M</given-names></name><name><surname>Aryal</surname><given-names>S</given-names></name><name><surname>Nobe</surname><given-names>Y</given-names></name><name><surname>Doniger</surname><given-names>T</given-names></name><name><surname>Galili Kostin</surname><given-names>B</given-names></name><name><surname>Blumberg</surname><given-names>A</given-names></name><name><surname>Cohen-Chalamish</surname><given-names>S</given-names></name><etal/></person-group><article-title>A single pseudouridine on rRNA regulates ribosome structure and function in the mammalian parasite Trypanosomabrucei</article-title><source>Nat Commun</source><year>2023</year><volume>14</volume><elocation-id>7462</elocation-id><pub-id pub-id-type="pmcid">PMC10662448</pub-id><pub-id pub-id-type="pmid">37985661</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-43263-6</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>MA</given-names></name><name><surname>Ersavas</surname><given-names>T</given-names></name><name><surname>Ferguson</surname><given-names>JM</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Lucas</surname><given-names>MC</given-names></name><name><surname>Begik</surname><given-names>O</given-names></name><name><surname>Bojarski</surname><given-names>L</given-names></name><name><surname>Barton</surname><given-names>K</given-names></name><name><surname>Novoa</surname><given-names>EM</given-names></name></person-group><article-title>Molecular barcoding of native RNAs using nanopore sequencing and deep learning</article-title><source>Genome Res</source><year>2020</year><volume>30</volume><fpage>1345</fpage><lpage>1353</lpage><pub-id pub-id-type="pmcid">PMC7545146</pub-id><pub-id pub-id-type="pmid">32907883</pub-id><pub-id pub-id-type="doi">10.1101/gr.260836.120</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>NK</given-names></name><name><surname>Poodari</surname><given-names>VC</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Olsen</surname><given-names>HE</given-names></name><name><surname>Akeson</surname><given-names>M</given-names></name><name><surname>Abu-Shumays</surname><given-names>RL</given-names></name></person-group><article-title>Direct Nanopore Sequencing of Individual Full Length tRNA Strands</article-title><source>ACS Nano</source><year>2021</year><date-in-citation>Accessed July 17, 2024</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://pubs.acs.org/doi/full/10.1021/acsnano.1c06488">https://pubs.acs.org/doi/full/10.1021/acsnano.1c06488</ext-link></comment><pub-id pub-id-type="pmcid">PMC10189790</pub-id><pub-id pub-id-type="pmid">34618430</pub-id><pub-id pub-id-type="doi">10.1021/acsnano.1c06488</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viehweger</surname><given-names>A</given-names></name><name><surname>Krautwurst</surname><given-names>S</given-names></name><name><surname>Lamkiewicz</surname><given-names>K</given-names></name><name><surname>Madhugiri</surname><given-names>R</given-names></name><name><surname>Ziebuhr</surname><given-names>J</given-names></name><name><surname>Hölzer</surname><given-names>M</given-names></name><name><surname>Marz</surname><given-names>M</given-names></name></person-group><article-title>Direct RNA nanopore sequencing of full-length coronavirus genomes provides nove linsights into structural variants and enables modification analysis</article-title><source>Genome Res</source><year>2019</year><volume>29</volume><fpage>1545</fpage><lpage>1554</lpage><pub-id pub-id-type="pmcid">PMC6724671</pub-id><pub-id pub-id-type="pmid">31439691</pub-id><pub-id pub-id-type="doi">10.1101/gr.247064.118</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>LK</given-names></name><name><surname>Strugar</surname><given-names>SM</given-names></name><name><surname>MacFadden</surname><given-names>A</given-names></name><name><surname>Hesselberth</surname><given-names>JR</given-names></name></person-group><article-title>Nanopore sequencing of internal 2’-PO4 modifications installed by RNA repair</article-title><source>RNA</source><year>2023</year><volume>29</volume><fpage>847</fpage><lpage>861</lpage><pub-id pub-id-type="pmcid">PMC10187680</pub-id><pub-id pub-id-type="pmid">36854608</pub-id><pub-id pub-id-type="doi">10.1261/rna.079290.122</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name></person-group><article-title>Deepbinner: Demultiplexing barcoded Oxford Nanopore reads with deep convolutional neural networks</article-title><source>PLoS Comput Biol</source><year>2018</year><volume>14</volume><elocation-id>e1006583</elocation-id><pub-id pub-id-type="pmcid">PMC6245502</pub-id><pub-id pub-id-type="pmid">30458005</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006583</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Workman</surname><given-names>RE</given-names></name><name><surname>Tang</surname><given-names>AD</given-names></name><name><surname>Tang</surname><given-names>PS</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Tyson</surname><given-names>JR</given-names></name><name><surname>Razaghi</surname><given-names>R</given-names></name><name><surname>Zuzarte</surname><given-names>PC</given-names></name><name><surname>Gilpatrick</surname><given-names>T</given-names></name><name><surname>Payne</surname><given-names>A</given-names></name><name><surname>Quick</surname><given-names>J</given-names></name><etal/></person-group><article-title>Author Correction: Nanopore native RNA sequencing of a human poly(A) transcriptome</article-title><source>Nat Methods</source><year>2019</year><volume>17</volume><fpage>114</fpage><lpage>114</lpage><pub-id pub-id-type="pmcid">PMC11428203</pub-id><pub-id pub-id-type="pmid">31819268</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0697-z</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Schematic overview of the direct RNA sequencing (DRS) demultiplexing workflow.</title><p><bold>(A)</bold> Overview of the barcoded direct RNA sequencing workflow in which the standard reverse transcription adapter (RTA) is replaced with a barcode-containing adapter. Following adapter ligation and reverse transcription the RNA ligation adapter (RLA), containing the helicase enzyme, is ligated, making the library sequencing-ready. <bold>(B)</bold> Overview of the demultiplexing workflow performed by SeqTagger. The algorithm first segments the raw current intensity signal by identifying the poly-(A)-tail signal to extract the barcode-containing RT adapter. Following signal normalisation, the DNA sequence is basecalled and aligned to a set of reference barcodes. Finally, a filtering step is applied based on the median base quality (BaseQ) to remove misassigned barcode sequences.</p></caption><graphic xlink:href="EMS199803-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comprehensive benchmarking of SeqTagger performance.</title><p><bold>(A)</bold> Schematic overview of the workflow used for comparative analysis of DRS demultiplexing software: DeePlexicon (purple) and SeqTagger (green). <bold>(B)</bold> Barplots depicting the demultiplexing precision and recall achieved with SeqTagger default settings (baseQ &gt; 50), DeePlexiCon high recovery settings (-s 0.5), and DeePlexiCon high accuracy settings (-s 0.9), on the same 3 datasets described in panel A. Bars represent the mean (also indicated by the numeric value to the right of each bar) with error bars showing +/- 1 standard deviation. Dots represent individual replicates. <bold>(C)</bold> Top: Barplot depicting the computation time of SeqTagger and DeePlexiCon, on the benchmarking datasets. Bars represent the mean value with error bars indicating +/- 1 standard deviation. Dots represent individual replicates. Statistical significance was determined using a two-sided t-test (ns: p &gt; 0.05, *: p &lt;= 0.05, **: p &lt;= 0.01, ***: p &lt;= 0.001). Bottom: Barplot representing the absolute contribution of individual preprocessing steps to the total computation time (Rep-1). <bold>(D)</bold> Confusion matrices (left), ROC curves (middle), and Precision-Recall curves (right) on independent test data generated with RNA002 and RNA004 kit chemistries. Data was analysed with SeqTagger model b04_RNA002 (upper panels) and b04_RNA004 (bottom panels), respectively. Abbreviations: AUC (Area Under the Curve); AP (Average Precision).</p></caption><graphic xlink:href="EMS199803-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>SeqTagger can be expanded to work on RNA-DNA hybrids (Nano-tRNAseq libraries) and with larger sets of barcodes</title><p><bold>(A)</bold> Schematic overview of the demultiplexing models supported by SeqTagger. A four barcode (b04) and 96 barcode (b96) model are available. Additionally, a four barcode demuxing model is available for custom Nano-tRNAseq libraries (b04_tRNA). <bold>(B)</bold> Confusion matrix for the 4 barcode tRNA model (b04_tRNA) generated on Nano-tRNAseq validation data. Recorded precision is indicated on top. <bold>(C)</bold> Confusion matrix of the 96 barcode mRNA model (b96_RNA002) generated on the validation data. Recorded precision is indicated on top. Zoomed panels of the 96x96 confusion matrix for eight barcodes are shown on the right.</p></caption><graphic xlink:href="EMS199803-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Performance of SeqTagger’s 96 barcode model on independent test data.</title><p><bold>(A)</bold> Boxplots depicting the base quality (baseQ) per barcode for three independent test runs using SCBC1-30 (left panel), SCBC-31-60 (middle panel) and SCBC-57-96 (right panel). Libraries were prepared using poly-(A)-tailed total RNA from human samples (<italic>see</italic> Methods). Boxes are limited by the lower quartile Q1 (bottom) and upper quartile Q3 (top). Whiskers are defined as 1.5 * IQR with outliers not shown. <bold>(B)</bold> Lineplot representing the total number of reads for each barcode (baseQ &gt;50) for runs shown in <xref ref-type="fig" rid="F4">Figure 4A</xref>, following demultiplexing. The total number of reads for each run with baseQ &gt; 50 is indicated by <italic>n</italic>.</p></caption><graphic xlink:href="EMS199803-f004"/></fig></floats-group></article>