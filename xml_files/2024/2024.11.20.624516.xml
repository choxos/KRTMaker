<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS200710</article-id><article-id pub-id-type="doi">10.1101/2024.11.20.624516</article-id><article-id pub-id-type="archive">PPR944108</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Development of novel signal and spike velocity analysis tools in peripheral nerve cuffs</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Klus</surname><given-names>Jonas</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Boys</surname><given-names>Alexander J.</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Serrano</surname><given-names>Ruben Ruiz-Mateos</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Malliaras</surname><given-names>George G.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Carnicer-Lombarte</surname><given-names>Alejandro</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Neuroscience, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03m2x1q45</institution-id><institution>University of Arizona</institution></institution-wrap>, <city>Tucson</city>, <state>AZ</state><postal-code>85721</postal-code><country country="US">USA</country></aff><aff id="A2"><label>2</label>Electrical Engineering Division, Department of Engineering, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <city>Cambridge</city>, <postal-code>CB3 0FA</postal-code>, <country country="GB">United Kingdom</country></aff><aff id="A3"><label>3</label>Department of Chemical Engineering &amp; Biotechnology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <city>Cambridge</city>, <postal-code>CB3 0AS</postal-code>, <country country="GB">United Kingdom</country></aff><aff id="A4"><label>4</label>Thayer School of Engineering, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/049s0rh22</institution-id><institution>Dartmouth College</institution></institution-wrap>, <city>Hanover</city>, <postal-code>NH 03755</postal-code><country country="US">USA</country></aff><author-notes><corresp id="CR1">
<label>*</label>Author to whom any correspondence should be addressed. <email>ac723@cam.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>23</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>11</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Objective</title><p id="P1">Peripheral nerve neurotechnologies hold significant promise as avenues for new closed-loop clinical treatments. However, analysis tools for nerve recordings – a key component of closed-loop nerve technologies – remain underdeveloped compared to brain-focused methods. This study introduces and explores the performance of two novel nerve signal analysis techniques which rely on a defining feature of peripheral nerve signals: the reliable conduction velocity of signals transmitted by axons in nerves.</p></sec><sec id="S2"><title>Approach</title><p id="P2">We test the capabilities of the introduced cross-correlation and spike delay velocity analysis techniques both <italic>in silico</italic> on synthetic nerve signals and on <italic>in vivo</italic> nerve signals acquired from freely-moving rats.</p></sec><sec id="S3"><title>Main results</title><p id="P3">Our findings show that both techniques can be successfully employed to extract transmission direction and velocity information from nerve cuff recordings. Notably, cross-correlation analysis can be employed to detect neural signals of very low signal-to-noise ratio, otherwise undetectable by typical spike detection approaches.</p></sec><sec id="S4"><title>Significance</title><p id="P4">Our findings provide new techniques to both enhance detection and extract new information in the form of velocity data from nerve recordings. As axon signal conduction direction and velocity is tightly linked to neural function, these techniques can support new research into peripheral nervous system function and new therapeutic approaches driven by neural interfaces.</p></sec></abstract><kwd-group><kwd>Peripheral nerve neurotechnology</kwd><kwd>neural interfaces</kwd><kwd>nerve cuff recordings</kwd><kwd>nerve signal conduction velocity</kwd><kwd>cross-correlation analysis</kwd></kwd-group></article-meta></front><body><sec id="S5" sec-type="intro"><label>1</label><title>Introduction</title><p id="P5">Implantable neurotechnologies, in particular those applied to the peripheral nervous system, are emerging as promising therapeutic modalities for a range of conditions. In clinical practice, conditions such as epilepsy and depression are now being treated through implantable nerve stimulators, which modulate nerve activity to alleviate symptoms [<xref ref-type="bibr" rid="R1">1</xref>]. Other nerve stimulation-driven treatments, such as those targeting immune responses, are also showing significant potential [<xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R4">4</xref>]. Similar to other neurotechnology fields, therapies that combine recording with stimulation in nerves in the form of closed-loop neurotechnologies are rapidly gaining attention as powerful treatment modalities [<xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R7">7</xref>].</p><p id="P6">The addition of nerve recording capabilities in closed-loop nerve neurotechnologies enables real-time monitoring of the state of the nerve, allowing for dynamic adjustment of the therapeutic stimulation. Although nerve recording is technically more challenging than stimulation, advances in materials and fabrication techniques for implantable devices now enable reliable nerve recording in both anesthetized [<xref ref-type="bibr" rid="R8">8</xref>–<xref ref-type="bibr" rid="R11">11</xref>] and freely-moving awake conditions [<xref ref-type="bibr" rid="R12">12</xref>]. Recent work has shown that activity recorded from peripheral nerves correlates with clinically relevant parameters, including blood glucose levels in diabetes research [<xref ref-type="bibr" rid="R13">13</xref>] and bladder state in spinal cord injury research [<xref ref-type="bibr" rid="R9">9</xref>]. These findings underscore the broad potential for closed-loop therapeutics powered by nerve recordings.</p><p id="P7">Despite this promise, neural analysis tools for peripheral nerve recordings remain underdeveloped compared to those used for brain recordings. Techniques such as spike sorting, commonly used in brain recordings, may be less effective for nerve signals, particularly when recorded through cuff electrodes placed around the nerve’s epineurium where large numbers of axon signals at low signal-to-noise ratio (SNR) are expected to contribute to the recordings. The anatomy of peripheral nerves, however, presents a unique opportunity for the application of velocity-based analysis approaches. Nerves are composed of bundles of axon fibres with diverse diameters and degrees of myelination, which affects the conduction velocity of action potentials and reflects the fibre’s functional role. By positioning two electrodes along the nerve’s length, the propagation of these signals could be recorded and employed to enable more robust and informative analyses of electrophysiological data from peripheral nerves.</p><p id="P8">In this work, we investigate the application of velocity-based analysis techniques in peripheral nerve recordings. We focus on two strategies: cross-correlation of signal and spike delay velocity analysis. First, we assess the validity and accuracy of these techniques on a synthetic dataset of recorded nerve signals. Building on these insights, we develop improved velocity-based analysis methods and apply them to nerve recordings from freely-moving awake rat models.</p></sec><sec id="S6" sec-type="methods"><label>2</label><title>Method</title><sec id="S7"><label>2.1</label><title>Synthetic nerve signal simulation</title><p id="P9">Synthetic nerve signals were generated using an object-oriented <italic>Python 3</italic>.<italic>12</italic>.<italic>4</italic> framework, incorporating custom-built classes to simulate recordings at two electrode sites spaced 2 mm apart. Additional classes were designed to handle spike generation and noise addition. The simulation utilized <italic>NumPy (v1</italic>.<italic>26</italic>.<italic>4)</italic> for numerical computations, <italic>Pandas (v2</italic>.<italic>2</italic>.<italic>2)</italic> for data management, <italic>SciPy (v1</italic>.<italic>13</italic>.<italic>1)</italic> for signal processing tasks like filtering, and <italic>Matplotlib (v3</italic>.<italic>8</italic>.<italic>4)</italic> for visualization.</p><p id="P10">Spike velocities were predefined at 1, 5, 10, 30, 60, and 120 m/s, serving as a simplified model of different nerve fibre types [<xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R15">15</xref>]. Velocities were assigned randomly to each spike. During simulation trials, approximately 60 spikes per second were produced. Spikes were modelled using exponential functions that approximate extracellularly recorded spike shapes [<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R17">17</xref>]. Details of these functions are provided in the <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>. The peak amplitude of spikes was adjusted using a scaling factor, which preserved the spike shape while proportionally increasing or decreasing the overall amplitude of both the negative depolarization peak and the positive hyperpolarization peak. This approach enabled the modelling of spikes with high amplitudes exceeding 7 times the root mean square (RMS) of the background noise, as used in our spike velocity analysis, as well as very low amplitudes near 1 RMS of the background noise, as used in our cross-correlation analysis.</p><p id="P11">The ground truth signal was initially created at 3 MHz to provide a high-resolution approximation of a continuous nerve signal, selected to facilitate straightforward calculations and minimize rounding errors during subsequent sampling to 30 kHz. This sampled rate was chosen as it represents the maximum digital sampling rate supported by common commercial electrophysiology hardware. Spikes were modelled to propagate across the 2 mm gap between electrodes (<xref ref-type="fig" rid="F1">Fig. 1a</xref>), with the time delay between recordings calculated based on velocity and then converted into sample point differences across the two traces. The electrodes were assumed to be infinitesimally small points, simplifying the propagation model by focusing solely on the time delay between the two locations.</p><p id="P12">To simulate background noise in <italic>in vivo</italic> nerve recordings, we used <italic>Python’s NumPy random</italic>.<italic>normal</italic> function to generate white noise, drawing random samples from a normal (Gaussian) distribution. This noise was then filtered through a 5th-order Butterworth low-pass filter with a cutoff frequency of 1 kHz to reduce high-frequency components. The filtered noise was added to the spike traces, creating a more realistic total nerve signal (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p><p id="P13">A time array was generated for both the analogue (3 MHz) and the digital (30 kHz) signal, ensuring accurate spike and noise positioning over the trial. Data for each spike, including amplitude, velocity, and peak positions in both analogue and digital formats, were stored in a <italic>Pandas DataFrame</italic>, facilitating efficient tracking and analysis across trials. The final synthetic nerve signal combined spike traces with filtered noise (<xref ref-type="fig" rid="F1">Fig. 1b</xref>), providing both high-resolution analogue and sampled digital versions. Each trial introduced unique spike and noise combinations, simulating real-world variability.</p></sec><sec id="S8"><label>2.2</label><title>Signal cross-correlation</title><p id="P14">Cross-correlation analysis was conducted to evaluate the similarity between two signals at various time lags, aimed at detecting time delays between spikes recorded at the two electrodes spaced 2 mm apart. The cross-correlation of two signals, <italic>f(t)</italic> and <italic>g(t)</italic>, with <italic>τ</italic> as the time lag, is defined as <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>∗</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></disp-formula></p><p id="P15">This calculation provides a measure of similarity between the two signals as one is shifted in time relative to the other. Using <italic>NumPy’s correlate</italic> function in <italic>full</italic> mode, the cross-correlation was computed for all possible time lags, from the maximum negative lag (where spikes in the second signal lead those in the first) to the maximum positive lag (where spikes in the first signal lead those in the second), capturing the entire range of time-lagged correlations.</p><p id="P16">For the whole signal cross-correlation analysis (<xref ref-type="fig" rid="F3">Fig. 3</xref>), a time array was generated to span the full range of possible time lags, encompassing both negative and positive values. Analyses and graphs were presented with the x-axis scaled in milliseconds (<xref ref-type="fig" rid="F2">Fig. 2</xref>, <xref ref-type="fig" rid="F3">3</xref>), aligning with the expected propagation times for nerve signals. This scaling enabled direct interpretation of time delays in terms of spike propagation velocity. To assess low-amplitude spike detection, cross-correlation analyses were conducted using traces ranging from 100 milliseconds to 30,000 milliseconds (<xref ref-type="fig" rid="F3">Fig. 3p</xref>). For a single analysis segment, ten spikes were added at equidistant intervals to an array of 300,000 zero-valued sampling points (<xref ref-type="fig" rid="F3">Fig. 3a-c</xref>), followed by the addition of random noise to create a realistic composite signal (<xref ref-type="fig" rid="F3">Fig. 3e-g</xref>). For longer traces, multiple spike-only segments were concatenated, and random noise was applied across the entire combined signal (<xref ref-type="fig" rid="F3">Fig. 3m-p</xref>). This approach enabled the examination of cross-correlation performance in detecting low-amplitude spikes over varying signal lengths.</p></sec><sec id="S9"><label>2.3</label><title>Peak search and velocity estimation</title><p id="P17">Two spike velocity estimation methods—peak interval velocity and cross-correlation coefficient—were employed to assess nerve signal velocity across different RMS thresholds. For both methods, peaks were first identified using a hill climbing algorithm. Only negative spikes were considered, as we simulated extracellular recordings [<xref ref-type="bibr" rid="R16">16</xref>]. The peak velocity method then calculates velocity based on the difference in sampling points between peaks. The cross-correlation coefficient method computes time-shifted cross-correlation coefficients around the identified peaks to determine velocity.</p><p id="P18">The RMS threshold in this context is used to detect peaks in the signal that represent potential spikes. Calculated as a multiple of the signal’s RMS, this threshold sets a minimum amplitude that a data point must exceed to be classified as a spike [<xref ref-type="bibr" rid="R18">18</xref>]. By defining the threshold as an RMS multiple, this approach dynamically adapts to signal variability, distinguishing spikes from background noise. This method assumes that spikes are sporadic, meaning their influence on the RMS calculation is minimal and the RMS primarily reflects the noise floor. Higher thresholds reduce the likelihood of false positives by requiring larger deviations from the mean, while lower thresholds increase sensitivity to smaller amplitude spikes, though with a higher risk of false positives. The optimal threshold depends on the specific study objectives. Thus, different thresholds were employed in our analyses to test changes in performance when accommodating varying detection needs.</p><p id="P19">The peak detection uses a hill climbing algorithm to identify corresponding spikes in two signals recorded at electrode sites spaced 2 mm apart (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). Hill climbing works by comparing each data point to its immediate neighbours to locate local maxima, moving point by point until a peak is identified. In the initial signal, peaks are detected using a threshold set as a multiple of the signal's RMS. Once a peak is detected, a search window of 100 samples is established around the peak to locate a corresponding spike in the second signal for the sampled signal. For interpolated signals, this search window is scaled by the upsampling factor, which in our simulations is 100 as described below, resulting in an effective search window of 100 * 100 = 10,000 samples.</p><p id="P20">The peak velocity is then calculated by determining the sampling point delay between the detected peaks in the two signals. The velocity calculation follows <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P21">where <italic>d</italic> is the electrode distance (2 mm), <italic>f</italic> is the sampling rate (30 kHz), <italic>s</italic> is the search scaler (1 for simple inter-spike interval and 100 for sinc and cubic spline interpolation as detailed below), and <italic>t</italic><sub><italic>1</italic></sub> and <italic>t</italic><sub><italic>2</italic></sub> are the detected peak times in the first and second signals, respectively. The calculated velocity is compared to the true velocity and classified as correct if it falls within ±40% of the true speed, which implies that the direction is correctly identified as well. This 40% margin was arbitrarily selected as it allows for approximate classification of spikes to specific fibre types, preserving clear separation between modelled true velocities, even in the presence of modest velocity estimation errors. However, we also created plots displaying in more detail the magnitude of any errors in velocity estimation.</p><p id="P22">The cross-correlation coefficient method provides an alternative velocity estimation by analysing the similarity between two signals as a function of time lag. After initial peak detection using hill climbing, a 100-sample window is extracted around each peak in both signals. The cross-correlation is calculated using <italic>NumPy’s correlate</italic> function, with the time lag at the maximum correlation value giving the delay <italic>Δt</italic> between spikes. The velocity for the corresponding spikes is then calculated using <disp-formula id="FD3"><mml:math id="M3"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P23">where <italic>d</italic> is the electrode spacing (2 mm), <italic>f</italic> is the sampling rate (30 kHz), and <italic>Δt</italic> is the sample delay. The velocity is again classified as correct if it falls within 40% of the true speed. In contrast to its earlier application (<xref ref-type="fig" rid="F2">Fig. 2</xref>-<xref ref-type="fig" rid="F3">3</xref>), cross-correlation here is employed to estimate delays between individual spike pairs, rather than whole signal traces.</p></sec><sec id="S10"><label>2.4</label><title>Signal interpolation</title><p id="P24">In addition to testing two velocity estimation methods, the effect of interpolation to increase sampling rate on spike velocity estimation was also tested. Specifically, two interpolation techniques—sinc interpolation and cubic spline interpolation—were used to enhance signal resolution before performing peak search and peak interval velocity estimation.</p><p id="P25">The sinc interpolation method, which refines time resolution through upsampling and reconstructs the continuous signal, is defined as <disp-formula id="FD4"><mml:math id="M4"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P26">where <italic>f(nT)</italic> are discrete sampling points, <italic>T</italic> is the sampling interval, and <italic>sinc(x)</italic> is <italic>sin(πx) / (πx)</italic> [<xref ref-type="bibr" rid="R19">19</xref>]. The nerve signal is converted to the frequency domain via Fast Fourier Transform (FFT), zero-padded for higher resolution, and transformed back to the time domain with 100x finer detail.</p><p id="P27">The cubic spline interpolation method improves time resolution by fitting a piecewise cubic polynomial through the data points, allowing for smooth signal reconstruction. It constructs a continuous signal by interpolating between sampled points using cubic polynomials. For each interval [x<sub>i</sub>, x<sub>i+1</sub>], the cubic spline is defined as <disp-formula id="FD5"><mml:math id="M5"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.2em"/><mml:mo>+</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mspace width="0.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p id="P28">where x<sub>i</sub> and x<sub>i+1</sub> are consecutive discrete sampling points, a<sub>i</sub>, b<sub>i</sub>, c<sub>i</sub>, and d<sub>i</sub> are coefficients determined from the data points, and x is any point within the interval [x<sub>i</sub>, x<sub>i+1</sub>]. This method generates a smooth curve between each pair of points, preserving continuity in both the first and second derivatives [<xref ref-type="bibr" rid="R20">20</xref>]. Like sinc interpolation, we used cubic spline interpolation to enhance signal resolution by a factor of 100x, enabling more accurate spike detection.</p></sec><sec id="S11"><label>2.5</label><title>Spike velocity estimation performance evaluation metrics</title><p id="P29">Performance evaluation for all methods involved simulations across RMS thresholds from 2.0 to 7.0 in 0.05 increments, with 100 runs per threshold to ensure statistical robustness. Several metrics were calculated as percentages of all ground truth spikes: <list list-type="bullet" id="L1"><list-item><p id="P30"><italic>A – True Spike, True Velocity:</italic> Percentage of correctly detected spike pairs with correct velocity (within ±40% of the true speed).</p></list-item><list-item><p id="P31"><italic>B – True Spike, False Velocity:</italic> Percentage of correctly detected spike pairs but with incorrect velocity.</p></list-item><list-item><p id="P32"><italic>C – Missed Spike:</italic> Percentage of true spike pairs not detected.</p></list-item><list-item><p id="P33"><italic>D – False Spike:</italic> Percentage of detected spike pairs without true corresponding spikes.</p></list-item></list></p><p id="P34">This categorization meant that A, B, and C groups summed to 100% of ground truth spikes. The error group <italic>B – True Spike, False Velocity</italic> can be further subdivided into spikes with the correct direction but incorrect velocity, spikes with incorrect direction and velocity, and spikes with no sampling point difference, causing the velocity to be calculated as infinite (Fig. 5).</p></sec><sec id="S12"><label>2.6</label><title><italic>In vivo</italic> validation</title><p id="P35">All <italic>in vivo</italic> procedures were done in accordance with the UK Animals (Scientific Procedures) Act, 1986. Work was approved by the Animal Welfare and Ethical Review Body of the University of Cambridge and was approved by the UK Home Office (project license number PP5478947). Experiments were conducted on Lewis rats (~150g, ~9 weeks of age) (Charles River, UK). Rats were group-housed in individually ventilated cages with ad libitum access to food and water for the duration of the study.</p><p id="P36">Surgical implantation of devices was carried out under isoflurane anaesthesia (2.25% v/v in medical oxygen). Body temperature was monitored and maintained using a thermal blanket. An ultraconformable parylene-C device containing 100 by 100 μm PEDOT:PSS microelectrodes divided into three cuffs was implanted into the right forearm of rats and around the median, ulnar, and radial nerves. The microelectrodes were divided into distal and proximal rings of three or four microelectrodes which were used to perform the velocity analyses in this work. The devices, together with a ground cable connected to screw drilled into the space above the cerebellum, were externalized via a head-mounted access port. Analgesia was provided for two days following surgery (Metacam, oral suspension), and were kept under post-operative observation for three days following surgery. The custom-fabricated devices and implantation locations used were the same as those previously used [<xref ref-type="bibr" rid="R12">12</xref>].</p><p id="P37">Electrophysiology recordings were carried out in awake rats three to five days post-implantation. Implanted devices were connected to an acquisition system (RHS Stim/Recording System, Intan Technologies). Nerve recordings were performed while animals were placed on a platform on which they were free to move, at 30 kHz sampling rate. Once acquired, these recordings were bandpass filtered (300 to 2000 Hz), and referencing was performed. For referencing, the signal of either a proximal or distal microelectrode had the average signal of its corresponding proximal or distal ring of microelectrodes subtracted. This removed correlated noise while preserving any delays in signal seen between proximal and distal electrodes.</p><p id="P38">Cross-correlation coefficient calculation was performed similarly to that used with synthetic data. In addition to this, a method was developed to visualize cross-correlation coefficient evolution over time in recordings in the form of heatmap plots (e.g. <xref ref-type="fig" rid="F6">Fig 6b</xref>, middle). These plots were generated by performing cross-correlation calculations at different intervals along the recording. Intervals of 50 ms (<xref ref-type="fig" rid="F6">Fig. 6b-c</xref>) or 0.5 ms (<xref ref-type="fig" rid="F6">Fig. 6d</xref>) step sizes were used to create the plots shown. The averaging window (time window over which cross-correlation was calculated at each step) was varied as indicated in the heatmap plots. Spike velocity calculation was performed in the same manner as used with synthetic data, with measured spike delays between -2 and +2 ms grouped into histograms with bin size 0.1 ms (<xref ref-type="fig" rid="F7">Fig. 7</xref>). Within the central bin, spikes with a delay of exactly 0 ms were highlighted in red.</p></sec></sec><sec id="S13" sec-type="results"><label>3</label><title>Results</title><sec id="S14"><label>3.1</label><title>Synthetic nerve signal simulation</title><p id="P39">Nerves are composed of bundles of axons, each axon being capable of conducting action potential signals at a particular velocity. These action potentials involve changes in membrane potential which can be recorded extracellularly. While action potential spike amplitudes may be large when recorded in close proximity to neurons or axons, recorded amplitude decreases as the distance between the membrane and recording electrodes increases [<xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R22">22</xref>]. Recordings with cuff electrodes generally capture action potentials with amplitudes on the order of microvolts, alongside baseline electrical noise. Using the characteristics of nerve cuff recordings – frequent spikes with low SNR and varying conduction velocity (<xref ref-type="fig" rid="F1">Fig. 1a</xref>) – we designed a synthetic model to approximate peripheral nerve cuff recordings (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p><p id="P40">The synthetic nerve recording model was designed with simplified spike shapes and noise patterns to highlight key patterns observed in real data, enhancing clarity and interpretability. This approach was not intended to capture the full complexity of real nerve signals but instead focused on creating a tool that allows for straightforward analysis of the results. To simulate above- and below-threshold spikes, two types of spikes were generated with different amplitudes (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). Each spike was modelled with three simple exponential functions, selected for their similarity to extracellular spike shapes, then normalized and scaled by RMS values to achieve realistic approximations (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>). By limiting the model to two distinct spike shapes, we aimed to strike a balance between biological realism and model simplicity, which aids in the interpretation of the results.</p><p id="P41">The spatial setup of the model was designed with a 2 mm distance between the two recording electrodes (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). This separation reflects a realistic configuration for a single multielectrode cuff implant [<xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref>], and aligns with the electrode configuration used in our <italic>in vivo</italic> model validation. Using a single cuff also reduces complications related to imprecision from animal movement or accurate implant location, which can occur in dual-cuff setups.</p><p id="P42">The digital sampling rate in our model was set at 30 kHz, which represents the maximum rate supported by common commercial electrophysiology hardware This sampling rate also matches the one used in our in <italic>vivo</italic> model validation. The analogue signal was modelled at 3 MHz, providing 100 ground truth sampling points between each digital sampling point, thereby closely approximating a continuous signal for our experimental purposes. Simulated spike velocities were set at 1, 5, 10, 30, 60, and 120 m/s, serving as a simplified model of different nerve fibre types [<xref ref-type="bibr" rid="R14">14</xref>], including slower-conducting C fibres and Aδ fibres associated with pain and temperature sensory transmission, as well as faster-conducting Aα and Aβ fibres involved in motor as well as sensory proprio- and mechano-receptive functions [<xref ref-type="bibr" rid="R15">15</xref>]. This discrete set of velocities ensures an unambiguous ground truth for analysis. Of particular importance, 60 m/s represents the highest velocity detectable with the 30 kHz sampling rate and 2 mm electrode spacing, corresponding to exactly one sample point difference. The 120 m/s velocity was included to simulate a detected spike ‘infinite’ velocity scenario, where no sample point difference would be detected in the discretely sampled signal.</p><p id="P43">To simulate realistic i<italic>n vivo</italic> conditions, white noise was generated and added to the spike signal. This white noise mimics the broadband noise frequently observed in experimental nerve recordings. A low-pass filter was applied to the white noise, ensuring that only relevant frequency components were preserved (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). High- and low-amplitude spikes were randomly generated and distributed across the trace to ensure a realistic yet simplified signal composition (<xref ref-type="fig" rid="F1">Fig 1b</xref>). The random generation of spikes ensured variability consistent with <italic>in vivo</italic> recordings, avoiding systematic biases in the simulated signals.</p></sec><sec id="S15"><label>3.2</label><title>Cross-correlation velocity analysis</title><p id="P44">Cross-correlation is a technique used to measure the similarity between two signals as one signal is shifter (positively or negatively) relative to the other. It is widely applied in various areas of signal processing and pattern recognition [<xref ref-type="bibr" rid="R25">25</xref>]. When a propagating signal conducted by a nerve such as a spike is recorded at two different locations by for example two electrodes, the same signal is captured with a time delay between two electrode recordings (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). By applying a cross-correlation analysis to the recordings of the two electrodes as a function of time delay, we can detect the co-occurrence of the spike, as well as the time lag at which it occurs. The position of the resulting peak in the cross-correlation function corresponds to the time shift with which the signal is recorded across the electrodes, which allows us to estimate the velocity of the propagating signal. While the effect of this analysis can be best pictured with the propagation of an individual neural spike, its application does not require individual spike identification or isolation within a recording for its application, eliminating the need for spike detection techniques which may be poorly suited to low SNR signals recorded from nerve cuffs.</p><p id="P45">Our simulations showed that cross-correlation provides a robust way to detect nerve signals and their velocity (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Compared to single spikes (<xref rid="F2" ref-type="fig">Fig. 2a, f</xref>), multiple spikes of the same amplitude present in the signal have an additive effect on the cross-correlation function, increasing the overall correlation signal (<xref rid="F2" ref-type="fig">Fig. 2b, g</xref>). In contrast, increasing the amplitude of individual spikes has a multiplicative effect on the cross-correlation, producing even more pronounced peaks (<xref rid="F2" ref-type="fig">Fig. 2c, h</xref>). Both effects can occur simultaneously, resulting in combined additive and multiplicative influences on the cross-correlation (<xref rid="F2" ref-type="fig">Fig. 2d, i</xref>). Random noise, unlike structured signals, does not follow a consistent pattern, and thus its cross-correlation fluctuates around the mean without producing any distinct peaks or identifiable structure (<xref rid="F2" ref-type="fig">Fig. 2e, j</xref>). This contrast highlights the effectiveness of cross-correlation in distinguishing spikes from noise, ultimately improving the performance of velocity estimation in noisy neural signals. Another observation of note made from these simulations is that peaks in correlation coefficient produced by spikes were flanked by dips in coefficient (<xref rid="F2" ref-type="fig">Fig. 2f-i</xref>). This occurs due to the biphasic nature of the spikes, where the negative depolarization phase of the spike coincides with the positive hyperpolarization, resulting in a negative correlation.</p><p id="P46">Having confirmed the ability of cross-correlation analysis to identify spikes among noise, we tested whether realistic nerve signals could be processed with this technique. We simulated trains of low or high amplitude spikes (<xref ref-type="fig" rid="F3">Fig. 3a-d</xref>) combined with background noise (<xref ref-type="fig" rid="F3">Fig. 3e-h</xref>) and analysed their resulting cross-correlation function (<xref ref-type="fig" rid="F3">Fig. 3i-l</xref>). A train of high-amplitude spikes (7.2*RMS of noise) combined with a noisy signal over a short 100 ms trace, produced a clearly identifiable cross-correlation peak (<xref ref-type="fig" rid="F3">Fig. 3j</xref>). In contrast, a train of low-amplitude spikes (1.2*RMS) which visually cannot be identified from among noise (<xref ref-type="fig" rid="F3">Fig. 3g</xref>), produces no identifiable peak in its cross-correlation (<xref ref-type="fig" rid="F3">Fig. 3 k</xref>), with the cross-correlation pattern resembling that of a noise signal without any spikes (<xref ref-type="fig" rid="F3">Fig. 3l</xref>).</p><p id="P47">Given the additive effect of increasing spike counts on cross-correlation strength, we hypothesized that extending the recording window over which the cross-correlation was calculated could uncover low-amplitude spikes otherwise masked by noise. To test this, we gradually extended the window length from 100 ms to 30 s. As shown in <xref ref-type="fig" rid="F3">Fig. 3m-o</xref>, the ground truth spike with a +2 ms delay, initially obscured by noise in the 100 ms window (<xref ref-type="fig" rid="F3">Fig. 3k</xref>), produced a clearly distinguishable cross-correlation peak with a 10 s window and was clearly visible at 20 s (<xref ref-type="fig" rid="F3">Fig. 3o</xref>). We examined how this effect generalised to various spike amplitudes and window widths (<xref ref-type="fig" rid="F3">Fig. 3p</xref>). The correlation coefficient peak at +2 ms cross-correlation steadily increased with increasing window width, with the effect being more pronounced for higher amplitude spikes. Our results indicate that cross-correlation analysis can identify signals made up of low amplitude spikes. By averaging the signal over a longer time window, the random noise averages out, while the consistent patterns, such as spikes, become more prominent. This results in a progressive increase in the signal-to-noise ratio which can allow for the detection of even sub-threshold spikes.</p></sec><sec id="S16"><label>3.3</label><title>Spike velocity analysis</title><p id="P48">Individual neural spike detection is commonly conducted in both brain and peripheral nerve studies to identify and classify spikes based on shape and amplitude. Researchers often focus on detecting spike occurrences and clustering them according to waveform characteristics [<xref ref-type="bibr" rid="R26">26</xref>–<xref ref-type="bibr" rid="R29">29</xref>]. Although our analysis strategy operates within the broader field of neural spike detection, our focus is different: we analysed time delays between spike pairs recorded at two electrodes in the peripheral nervous system to both more reliably identify neural spikes as well as gain insights into signal transmission velocities (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p><p id="P49">Using the synthetic nerve signal simulation, we studied how different processing approaches affect spike and velocity detection. More specifically, we explored the effect of different spike velocity estimation methods and signal interpolation techniques to enhance signal resolution. The first approach tested the identification of spike peaks using a hill climbing algorithm and estimation of velocity based on the sampling point difference between signals recorded at two sites within a nerve cuff, positioned 2 mm apart (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). We refer to this approach as ‘Sampled signal + Peak velocity’. This spike velocity estimation method was applied to a digitally sampled signal, simulating <italic>in vivo</italic> nerve recording acquisition. However, the small delay expected in spike pairs for the highest conduction velocities suggested that spike peaks could be misidentified, leading to incorrect velocity estimations (Fig. 4a-b). We therefore tested whether signal interpolation could be used as a way to increase velocity estimation accuracy (Fig. 4c). We tested two commonly used interpolation methods: sinc and cubic spline interpolation. After applying these, we again identified peaks using a hill climbing algorithm and estimated velocity based on sampling point difference between signals. We refer to these two methods as ‘Sinc interpolation + Peak velocity’ and ‘Spline interpolation + Peak velocity’. Finally, we tested whether a different method of estimating spike velocity performed differently. After identifying peaks using a hill climbing algorithm (applied over the signal with no interpolation) we estimated their velocity based on their cross-correlation. We refer to this method as ‘Sampled signal + CrossCoeff velocity’. It should be noted that this implementation of cross-correlation for velocity estimation is different from that of our earlier application (<xref ref-type="fig" rid="F2">Fig. 2</xref>-<xref ref-type="fig" rid="F3">3</xref>). In contrast to this earlier application, cross-correlation here is employed to estimate delays between individual spike pairs, rather than whole signal traces. Spike detection was employed over signal segments exceeding a given amplitude threshold crossing. These four tested methods provided a way to establish whether changes in spike processing approaches could have a noticeable impact on peak detection and velocity estimation without exhaustively exploring every possible approach.</p><p id="P50">To evaluate the performance of each method, we conducted simulations across a range of signal RMS thresholds for spike detection and various spike velocities representing different nerve fibre types [<xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R15">15</xref>] (1, 5, 10, 30, 60, 120 m/s), at an approximate spike rate of 60 spikes/s (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2</xref>). Each spike had an equal probability of being either a low-amplitude spike (3.6*RMS of baseline noise) or a high-amplitude spike (just above 7.2*RMS of baseline noise). These properties are similar to spike-rich nerve recordings acquired by us in our later <italic>in vivo</italic> experiments, and were chosen so half of the spikes had amplitudes above the tested spike detection thresholds while the other half had amplitudes within this tested range (prior to the addition of noise). For every detected spike, we evaluated the performance of the various velocity estimation approaches dividing them into groups expressed as percentages of all ground truth spikes. These consisted of: A) ‘True Spike, True Velocity’: correctly detected spikes with correct velocity estimates (within ±40% of the true speed), B) ‘True Spike, False Velocity’: correctly detected spikes but with incorrect velocity estimates, C) ‘Missed Spike’: true spikes that were not detected, and D) ‘False Spike’: detected spike pairs that did not correspond to true spikes. This categorisation meant that A, B, and C groups summed to 100% of ground truth spikes. The category of correctly detected spikes with incorrect velocity estimates was further subdivided into spikes with the correct direction but incorrect velocity, spikes with incorrect direction and velocity, and spikes where no sampling point difference was detected, resulting in an infinite velocity calculation.</p><p id="P51">All four methods exhibited similar patterns of performance when tested on signals of all combined velocities (1 to 120 m/s) (Fig. 4d-g). As spike detection threshold increased, the fraction of correctly detected spikes (groups A and B) decreased, while missed spikes increased (group C). Notably, no false spikes (group D) were detected by any method except for a small fraction at the lowest thresholds ∼2*RMS, indicating that co-detection of signals across two electrodes represents a robust way of eliminating this undesirable component of spike detection. In terms of velocity estimation, while all methods generally produced a higher portion of correct velocity estimations (group A) than incorrect estimations (group B), ‘Sampled signal + CrossCoeff velocity’ performed the worst of all four methods (Fig. 4d-g). This was particularly evident when focusing on 4*RMS spike detection threshold (Fig. 4h, group A: 32.9%, 34.8%, 34.8%, 28.7%; group B: 15.6%, 13.7%, 13.7%, 19.7%, ‘Sampled signal + Peak velocity’, ‘Sinc interpolation + Peak velocity’, ‘Spline interpolation + Peak velocity’, ‘Sampled signal + CrossCoeff velocity’, respectively; group C: 51.5% for all, group D: 0.0% for all). ‘Sampled signal + Peak velocity’ seemed to underperform compared to the interpolation-using methods, but a more detailed analysis of the velocity error magnitudes (Fig. 4i-l) showed that this group produced the highest fraction of high accuracy velocity estimations (within -5% and +5% of real velocity) (Fig. 4i).</p><p id="P52">The detailed velocity error analysis also yielded other insights. Due to the 2 mm distance between proximal and distal electrodes in our simulation, some portion of high velocity spikes were expected to yield peaks coinciding exactly in time across proximal and distal electrode recordings. In particular, a 2 mm gap implemented on signals sampled at 30 kHz would make a single sample point peak delay be equivalent to a velocity of 60 m/s. Higher velocities such as 120 m/s (included in our simulations and representative of the fastest axon fibres) could lead to coinciding peaks which would be calculated as having infinite velocity. Consistent with this, tested methods applied over these 30 kHz sampled signals yielded a portion of infinite velocity spikes (Fig. 4i, l). Both methods utilizing interpolation vastly suppressed this type of error (Fig. 4j-k).</p><p id="P53">Having examined overall spike velocity estimation method performance, we sought to focus on whether these differences were particularly important for specific spike velocities. All methods performed best for the lowest velocity spikes (1 m/s), and worst for the highest velocity spikes (120 m/s), with performance overall decreasing with spike velocity (Fig. 5 and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3-6</xref>). Similar to what was observed earlier, ‘Sampled signal + CrossCoeff velocity’ performed worse for all individual tested velocities (Fig. 5d and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6</xref>). In contrast, differences in performance between the other three groups appeared to vary based on spike velocity. ‘Sampled signal + Peak velocity’ yielded a higher portion of high accuracy spikes (-5% to +5% of real velocity), particularly in the moderate velocity ranges (30 and 60 m/s) (Fig. 5a and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3</xref>), although it also yielded the highest portion of very high error results (darker purple bars in Fig. 5) including spikes classified as infinite velocity. ‘Sinc interpolation + Peak velocity’ (Fig. 5b and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 4</xref>) and ‘Spline interpolation + Peak velocity’ (Fig. 5c and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 5</xref>) in turn performed better at the highest velocities (120 m/s) and classified no spikes as infinite velocity. Overall, both interpolation methods yielded practically identical results in both tests on all combined velocity spikes (Fig. 4) and specific velocity spikes (Fig. 5). Ultimately, our results showed that while all tested methods represent a viable approach to spike detection and velocity estimation, the choice should align with the study's objectives. If detecting high velocities beyond 60 m/s is crucial, interpolation is the only viable approach, despite reducing the overall proportion of spikes identified with very low error. In research scenarios where both directionality accuracy and very low error rates are to be prioritised, and velocities beyond 60 m/s are not needed, the simpler sampled signal approach may be preferable.</p></sec><sec id="S17"><label>3.4</label><title><italic>In vivo</italic> validation of velocity analysis</title><p id="P54">Following our results of velocity analysis performance using synthetic data, we sought to test our findings on real nerve recordings. We carried out implantations of parylene-C ultraconformable cuff electrodes into nerves controlling arm function (median, ulnar, and radial nerves) of rats (<xref ref-type="fig" rid="F6">Fig. 6a</xref>) similar to those previously used [<xref ref-type="bibr" rid="R12">12</xref>]. We performed recordings of nerve activity while animals were placed and walked along a platform, yielding datasets with both high SNR spike bursts and periods with no visible spikes. Each cuff electrode consisted of rings of microelectrodes at their proximal and distal ends, with an inter-electrode distance of 2 mm, similar to those used in our earlier simulations. This arrangement allowed us to reference the signal of each microelectrode to the average of all of the microelectrodes within the proximal or distal rings, thereby eliminating correlated noise while leaving any proximal-distal time delays in the recorded nerve signal unaltered. This technique, sometimes referred to as common average reference, is often used in other fields to effectively eliminate noise of neural recordings [<xref ref-type="bibr" rid="R30">30</xref>].</p><p id="P55">We first focused on applying the earlier developed cross-correlation velocity analysis to the <italic>in vivo</italic> recordings. We identified a recording containing no visibly apparent spikes (<xref ref-type="fig" rid="F6">Fig. 6b</xref>). While this recording was acquired when the animal was exploring the behavioural chamber and from a somatic nerve of the forelimb (ulnar nerve), no distinct bursts of spike activity were seen by eye within the recording. We evaluated the cross-correlation between proximal and distal recordings and plotted its values over time (<xref ref-type="fig" rid="F6">Fig. 6b</xref>). As earlier, we identified the appropriate averaging window length at which distinct velocity signals could be seen. We found that when using a long (5 s) averaging window we observed the conduction of both afferent and efferent signals of different velocities (seen as horizontal orange bands in the heatmap plot), as well as how these changed over the duration of the recording. In contrast, recordings containing high SNR spike bursts yielded cross-correlation plots with easily identifiable activity at different velocities even with short (200 ms) averaging windows (<xref ref-type="fig" rid="F6">Fig. 6c</xref>).</p><p id="P56">We examined at which averaging window widths velocity signal patterns could be observed to appear in the previously used low SNR recording. Focusing on an arbitrarily chosen 400 ms fragment of a recording, we found that distinguishable bands of activity in cross-correlation heatmap plots began to be observed with averaging windows of 50 to 100 ms (<xref ref-type="fig" rid="F6">Fig. 6d</xref>). These bands of activity were longer than the averaging windows used to produce the plots, suggesting that these were not an artefact of data averaging over time. Shorter windows of 5 to 10 ms yielded no identifiable bands of activity at any particular delay value. Examining individual cross-correlation plots for a specific timepoint at these averaging window widths highlighted how peaks in cross-correlation only become identifiable above certain window widths – 100 ms in the case of the specific timepoint examined (<xref ref-type="fig" rid="F6">Fig. 6e</xref>). As even longer averaging windows are used, these peaks in cross-correlation became progressively more distinct, while the delays at which they appeared remained generally consistent (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 7</xref>). Notably, the amplitude of the correlation coefficient peaks also increased with averaging window width, indicating that larger amounts of signal with various time delays were being included, consistent with our earlier simulations (<xref ref-type="fig" rid="F3">Fig. 3</xref>).</p><p id="P57">Finally, we compared the performance of the various approaches earlier tested for the estimation of spike velocity. In nerve recordings with visible spike activity (<xref ref-type="fig" rid="F7">Fig. 7a</xref>), all four methods yielded similar distributions of spike velocities for the 94-109 spikes co-detected in the +2 to -2 ms delay range (+1 to -1 m/s velocity). The four spike velocity analysis approaches identified similar velocity distributions (<xref ref-type="fig" rid="F7">Fig. 7b-e</xref>), with the biggest difference seen in the ‘Sampled signal + CrossCoeff velocity’. Furthermore, both this group and ‘Sampled signal + Peak velocity’ identified a similar number of spikes with infinite velocity (6 and 5 spikes – 6.4% and 4.6% of all spikes, respectively), while methods including an interpolation step identified none. Furthermore, the two methods including an interpolation step showed identical distributions. Notably, ‘Sampled signal + Peak velocity’ showed a very similar distribution to the interpolation-including methods, with minor differences seen mostly at the fastest spike velocities (between -0.15 and +0.15 ms, equivalent to &gt;13 m/s). These results across methods match the results seen in our earlier simulations (Fig. 4).</p></sec></sec><sec id="S18" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P58">In this study, we have developed novel tools for analysing signal and spike velocity in nerve cuff recordings, evaluating their performance <italic>in silico</italic> and validating their function <italic>in vivo</italic>. A key limitation of all signal processing is SNR. In the context of neural interfaces recording neural spikes, spikes with an SNR below ~3 are obscured by the baseline noise, making them inaccessible to detection and processing. We find that in nerve cuff recordings, cross-correlation analysis provides a way to detect these low-amplitude spikes. Specifically, by increasing the window length for cross-correlation, we amplify the cumulative additive effects of spikes, thereby enhancing the effective signal-to-noise ratio. This approach allows for the recovery of neural signals that are not detectable in shorter recordings due to the masking effect of noise. Through synthetic nerve signal simulations, we show that spikes with amplitudes below 1x RMS of the noise with recordings in the tens of seconds. Moreover, our <italic>in vivo</italic> experiments validate this finding, demonstrating that longer averaging windows in cross-correlation analysis can reveal underlying neural activity in peripheral nerve recordings that appear to lack visible spikes. While such long averaging windows may not be suitable for neural interface applications requiring low latencies, many nerve-dependent processes are expected to be driven by activity over longer periods of time. The ability to detect these low-amplitude signals has profound implications for both neuroscience research and clinical neurotechnology applications. In research settings, this enhanced detection capability enables a more comprehensive mapping of neural activity, including signals from small-diameter fibres that are crucial for functions like chronic pain but are traditionally difficult to record due to their low amplitudes. Clinically, improved detection of subtle neural signals can facilitate earlier diagnosis and monitoring of peripheral neuropathies and neurodegenerative diseases, where small changes in nerve activity may precede clinical symptoms. Additionally, this method can enhance the performance of neuroprosthetic devices and closed-loop neuromodulation therapies by providing more accurate and detailed feedback from the nervous system, particularly those relying on slow processes such as bladder state or immune system modulation, leading to more precise interventions and better patient outcomes.</p><p id="P59">When instead focusing on higher amplitude spikes, our comparative analysis of different spike velocity estimation methods performance was overall good across methods but depended strongly on spike velocity. We found that the simplest method: peak velocity estimation applied directly on the sampled signal is effective for lower velocities but is inherently limited by the digital sampling rate and electrode spacing. To address this, we employed interpolation methods, which increased the detectable velocity range beyond the inherent limitations of the sampling rate, but introduced increased susceptibility to noise leading to increases in misclassifications for certain velocities. Overall, the best choice between these methods ultimately appears to depend on the specific goals of the researcher or clinician. If detecting high-velocity nerve signals is crucial—for example, in studies focusing on fast-conducting motor neurons or large-diameter sensory fibres involved in proprioception—then interpolation will likely be an optimal choice. Conversely, if the priority is obtaining highly accurate velocity estimates and precise directionality for slower fibres, or the latency or computational burden introduced by interpolation is incompatible with the application, then relying on the sampled signal without interpolation may be preferable.</p><p id="P60">While our specific approach to nerve signal simulation offers valuable insights, it is important to recognize the limitations that come with using a simplified synthetic nerve signal model. We intentionally designed a model with simplified spike shapes, discrete velocities, and no modelling of the effect of axon-electrode distance or axon type on spike amplitude to facilitate a clearer understanding of the tested signal processing approaches. This simplification, however, means that certain aspects of biological nerve signals were not fully represented in our simulations. In reality, spike shapes are not always consistent and may vary across different fibres, with some spikes even overlapping in time, adding complexity to spike detection and analysis. Furthermore, the amplitude of recorded signals depends both on the axon properties as well as on the distance between the axon and the recording electrode. Our study focused on the accuracy and capabilities of velocity analysis methods in nerves. However, factors such as axon heterogeneity and distribution, and how this may be reflected in the analysis, may be of interest to explore in future work to further understand and refine these tools.</p><p id="P61">Another limitation important to discuss in our simulation approach is noise. In our simulations, we assumed that noise was entirely random and uncorrelated across electrodes, generated by adding separate filtered white noise to either electrode signal. However, in <italic>in vivo</italic> recordings, noise sources are often more complex and will likely not be entirely uncorrelated across electrodes. For example, biological noise can arise from various physiological processes, such as muscle activity and other neural signals, which can introduce correlated noise components across recording sites. Additionally, environmental noise, electrolyte-electrode noise, and thermal noise can contribute to the overall noise spectrum [<xref ref-type="bibr" rid="R31">31</xref>]. In practice, noise correlated across electrodes can be eliminated using techniques such as common average referencing [<xref ref-type="bibr" rid="R30">30</xref>], as we have employed in our <italic>in vivo</italic> recordings. While we cannot determine whether this eliminates the entirety of correlated noise in electrode recordings, this technique strongly suppresses these while leaving uncorrelated components such as spikes unaffected, indicating that our <italic>in silico</italic> findings should apply to <italic>in vivo</italic> recordings.</p><p id="P62">Overall, our study shows that both cross-correlation and spike velocity analysis represent powerful approaches to extract velocity information from nerve signals recorded with cuff electrodes. While methods to determine nerve signal velocities already exist [<xref ref-type="bibr" rid="R32">32</xref>–<xref ref-type="bibr" rid="R37">37</xref>], these methods are typically either applied over larger amplitude evoked compound action potentials and require long arrays of longitudinally placed nerve electrodes. The methods here presented can be implemented on compact nerve cuff designs, requiring minimal data processing, and providing robust results even in challenging environments with dense spontaneous nerve activity such as freely-moving awake recordings. Furthermore, the presented correlation-coefficient method represents to our knowledge the first method to detect nerve activity through signal velocity even in very low SNR environments tested <italic>in vivo</italic>. The advances presented in our work represent powerful tools for nerve recording analysis with applications in both research and clinical translation.</p></sec><sec id="S19" sec-type="conclusions"><label>5</label><title>Conclusion</title><p id="P63">In this study, we have introduced innovative methods for analysing signal and spike velocity in nerve cuff recordings, demonstrating their effectiveness both <italic>in silico</italic> and <italic>in vivo</italic>. By employing cross-correlation analysis with extended window lengths, we successfully detected and characterised the velocities of low-amplitude neural signals that are typically obscured by noise. In signals containing higher amplitude spikes, we find that spike interval analysis provides a useful tool to characterise spike velocity, applied with or without interpolation depending on for which velocities accuracy should be prioritised. Our findings highlight the potential of these methods to enhance the detection and analysis of nerve signals, representing a valuable advance for neuroscience research and clinical neurotechnology applications.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Information</label><media xlink:href="EMS200710-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d140aAcFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgements</title><p>A.C.L. acknowledges support from the University of Cambridge for a Borysiewicz Interdisciplinary Fellowship and the Wellcome Trust for a Junior Interdisciplinary Fellowship. A.J.B. acknowledges support from his Cross-disciplinary Fellowship (LT000034/2020-C) from the Human Frontier Science Program (HFSP) Organization. R.R.S. acknowledges support from the EPSRC (EP/S022139/1). This work was funded by the ECH2020 FUTURE &amp; EMERGING TECHNOLOGIES (FET) projects BrainCom (732032) and MITICS (964677), and by CloseNIT, an EPSRC/MRC funded Network+, grant code EP/W035057/1.</p></ack><sec id="S21" sec-type="data-availability"><title>Data availability</title><p id="P64">The data generated in this study and supporting its results have been deposited in the Figshare database under accession code <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.27687309">https://doi.org/10.6084/m9.figshare.27687309</ext-link> [<xref ref-type="bibr" rid="R38">38</xref>].</p></sec><sec id="S22" sec-type="data-availability"><title>Code availability</title><p id="P65">MATLAB and Python code used in data processing and analysis is accessible in the following repository: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.27694590">https://doi.org/10.6084/m9.figshare.27694590</ext-link>.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P66"><bold>Author contributions</bold></p><p id="P67">J.K. carried out <italic>in silico</italic> work. A.C.L. carried out <italic>in vivo</italic> work. A.J.B. carried out the fabrication of devices. J.K., R.R.S. and A.C.L. developed the concept for the analysis techniques. G.G.M. and A.C.L. supervised the work. J.K. and A.C.L. wrote the manuscript. All authors contributed to the review and revision of the manuscript.</p></fn><fn id="FN2" fn-type="conflict"><p id="P68"><bold>Competing interests</bold></p><p id="P69">The authors declare no competing interests.</p></fn><fn id="FN3"><p id="P70"><bold>Ethical statement</bold></p><p id="P71">All in vivo procedures were done in accordance with the UK Animals (Scientific Procedures) Act, 1986. Work was approved by the Animal Welfare and Ethical Review Body of the University of Cambridge and was approved by the UK Home Office (project license number PP5478947).</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>RL</given-names></name><name><surname>Wilson</surname><given-names>CG</given-names></name></person-group><article-title>A review of vagus nerve stimulation as a therapeutic intervention</article-title><source>J Inflamm Res</source><year>2018</year><volume>11</volume><fpage>203</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC5961632</pub-id><pub-id pub-id-type="pmid">29844694</pub-id><pub-id pub-id-type="doi">10.2147/JIR.S163248</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koopman</surname><given-names>FA</given-names></name><name><surname>Chavan</surname><given-names>SS</given-names></name><name><surname>Miljko</surname><given-names>S</given-names></name><name><surname>Grazio</surname><given-names>S</given-names></name><name><surname>Sokolovic</surname><given-names>S</given-names></name><name><surname>Schuurman</surname><given-names>PR</given-names></name><name><surname>Mehta</surname><given-names>AD</given-names></name><name><surname>Levine</surname><given-names>YA</given-names></name><name><surname>Faltys</surname><given-names>M</given-names></name><name><surname>Zitnik</surname><given-names>R</given-names></name><name><surname>Tracey</surname><given-names>KJ</given-names></name><etal/></person-group><article-title>Vagus nerve stimulation inhibits cytokine production and attenuates disease severity in rheumatoid arthritis</article-title><source>Proceedings of the National Academy of Sciences</source><year>2016</year><volume>113</volume><fpage>8284</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC4961187</pub-id><pub-id pub-id-type="pmid">27382171</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1605635113</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donegà</surname><given-names>M</given-names></name><name><surname>Fjordbakk</surname><given-names>CT</given-names></name><name><surname>Kirk</surname><given-names>J</given-names></name><name><surname>Sokal</surname><given-names>DM</given-names></name><name><surname>Gupta</surname><given-names>I</given-names></name><name><surname>Hunsberger</surname><given-names>GE</given-names></name><name><surname>Crawford</surname><given-names>A</given-names></name><name><surname>Cook</surname><given-names>S</given-names></name><name><surname>Viscasillas</surname><given-names>J</given-names></name><name><surname>Stathopoulou</surname><given-names>T-R</given-names></name><name><surname>Miranda</surname><given-names>JA</given-names></name><etal/></person-group><article-title>Human-relevant near-organ neuromodulation of the immune system via the splenic nerve</article-title><source>Proc Natl Acad Sci US A</source><year>2021</year><volume>118</volume><elocation-id>e2025428118</elocation-id><pub-id pub-id-type="pmcid">PMC8157920</pub-id><pub-id pub-id-type="pmid">33972441</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2025428118</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>Y-T</given-names></name><name><surname>Lin</surname><given-names>Y-T</given-names></name><name><surname>Tseng</surname><given-names>W-L</given-names></name><name><surname>Tseng</surname><given-names>P</given-names></name><name><surname>Hua</surname><given-names>G-L</given-names></name><name><surname>Chao</surname><given-names>Y-J</given-names></name><name><surname>Wu</surname><given-names>Y-J</given-names></name></person-group><article-title>Neuroimmunomodulation of vagus nerve stimulation and the therapeutic implications</article-title><source>Front Aging Neurosci</source><year>2023</year><volume>15</volume><pub-id pub-id-type="pmcid">PMC10358778</pub-id><pub-id pub-id-type="pmid">37484689</pub-id><pub-id pub-id-type="doi">10.3389/fnagi.2023.1173987</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D’Anna</surname><given-names>E</given-names></name><name><surname>Valle</surname><given-names>G</given-names></name><name><surname>Mazzoni</surname><given-names>A</given-names></name><name><surname>Strauss</surname><given-names>I</given-names></name><name><surname>Iberite</surname><given-names>F</given-names></name><name><surname>Patton</surname><given-names>J</given-names></name><name><surname>Petrini</surname><given-names>FM</given-names></name><name><surname>Raspopovic</surname><given-names>S</given-names></name><name><surname>Granata</surname><given-names>G</given-names></name><name><surname>Iorio</surname><given-names>RD</given-names></name><etal/></person-group><article-title>A closed-loop hand prosthesis with simultaneous intraneural tactile and position feedback</article-title><source>Science Robotics</source><year>2019</year><volume>4</volume><elocation-id>eaau8892</elocation-id><pub-id pub-id-type="pmid">33137741</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Güemes Gonzalez</surname><given-names>A</given-names></name><name><surname>Etienne-Cummings</surname><given-names>R</given-names></name><name><surname>Georgiou</surname><given-names>P</given-names></name></person-group><article-title>Closed-loop bioelectronic medicine for diabetes management</article-title><source>Bioelectronic Medicine</source><year>2020</year><volume>6</volume><fpage>11</fpage><pub-id pub-id-type="pmcid">PMC7227365</pub-id><pub-id pub-id-type="pmid">32467827</pub-id><pub-id pub-id-type="doi">10.1186/s42234-020-00046-4</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Micera</surname><given-names>S</given-names></name><name><surname>Menciassi</surname><given-names>A</given-names></name><name><surname>Cianferotti</surname><given-names>L</given-names></name><name><surname>Gruppioni</surname><given-names>E</given-names></name><name><surname>Lionetti</surname><given-names>V</given-names></name></person-group><article-title>Organ Neuroprosthetics: Connecting Transplanted and Artificial Organs with the Nervous System</article-title><source>Advanced Healthcare Materials</source><year>2024</year><comment>n/a</comment><elocation-id>2302896</elocation-id><pub-id pub-id-type="pmid">38656615</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raspopovic</surname><given-names>S</given-names></name><name><surname>Carpaneto</surname><given-names>J</given-names></name><name><surname>Udina</surname><given-names>E</given-names></name><name><surname>Navarro</surname><given-names>X</given-names></name><name><surname>Micera</surname><given-names>S</given-names></name></person-group><article-title>On the identification of sensory information from mixed nerves by using single-channel cuff electrodes</article-title><source>Journal of NeuroEngineering and Rehabilitation</source><year>2010</year><volume>7</volume><fpage>17</fpage><pub-id pub-id-type="pmcid">PMC2887885</pub-id><pub-id pub-id-type="pmid">20423488</pub-id><pub-id pub-id-type="doi">10.1186/1743-0003-7-17</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chew</surname><given-names>DJ</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Delivopoulos</surname><given-names>E</given-names></name><name><surname>Minev</surname><given-names>IR</given-names></name><name><surname>Musick</surname><given-names>KM</given-names></name><name><surname>Mosse</surname><given-names>CA</given-names></name><name><surname>Craggs</surname><given-names>M</given-names></name><name><surname>Donaldson</surname><given-names>N</given-names></name><name><surname>Lacour</surname><given-names>SP</given-names></name><name><surname>McMahon</surname><given-names>SB</given-names></name><name><surname>Fawcett</surname><given-names>JW</given-names></name></person-group><article-title>A Microchannel Neuroprosthesis for Bladder Control After Spinal Cord Injury in Rat</article-title><source>Sci Transl Med</source><year>2013</year><volume>5</volume><elocation-id>210ra155</elocation-id><pub-id pub-id-type="pmid">24197736</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metcalfe</surname><given-names>BW</given-names></name><name><surname>Nielsen</surname><given-names>TN</given-names></name><name><surname>de Donaldson N</surname><given-names>N</given-names></name><name><surname>Hunter</surname><given-names>AJ</given-names></name><name><surname>Taylor</surname><given-names>JT</given-names></name></person-group><article-title>First demonstration of velocity selective recording from the pig vagus using a nerve cuff shows respiration afferents</article-title><source>Biomed Eng Lett</source><year>2017</year><volume>8</volume><fpage>127</fpage><lpage>36</lpage><pub-id pub-id-type="pmcid">PMC6208561</pub-id><pub-id pub-id-type="pmid">30603197</pub-id><pub-id pub-id-type="doi">10.1007/s13534-017-0054-z</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giannotti</surname><given-names>A</given-names></name><name><surname>Vecchio</surname><given-names>SL</given-names></name><name><surname>Musco</surname><given-names>S</given-names></name><name><surname>Pollina</surname><given-names>L</given-names></name><name><surname>Vallone</surname><given-names>F</given-names></name><name><surname>Strauss</surname><given-names>I</given-names></name><name><surname>Paggi</surname><given-names>V</given-names></name><name><surname>Bernini</surname><given-names>F</given-names></name><name><surname>Gabisonia</surname><given-names>K</given-names></name><name><surname>Carlucci</surname><given-names>L</given-names></name><name><surname>Lenzi</surname><given-names>C</given-names></name><etal/></person-group><article-title>Decoding bladder state from pudendal intraneural signals in pigs</article-title><source>APL Bioengineering</source><year>2023</year><volume>7</volume><elocation-id>046101</elocation-id><pub-id pub-id-type="pmcid">PMC10558243</pub-id><pub-id pub-id-type="pmid">37811476</pub-id><pub-id pub-id-type="doi">10.1063/5.0156484</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carnicer-Lombarte</surname><given-names>A</given-names></name><name><surname>Boys</surname><given-names>AJ</given-names></name><name><surname>Güemes</surname><given-names>A</given-names></name><name><surname>Gurke</surname><given-names>J</given-names></name><name><surname>Velasco-Bosom</surname><given-names>S</given-names></name><name><surname>Hilton</surname><given-names>S</given-names></name><name><surname>Barone</surname><given-names>DG</given-names></name><name><surname>Malliaras</surname><given-names>GG</given-names></name></person-group><article-title>Ultraconformable cuff implants for long-term bidirectional interfacing of peripheral nerves at sub-nerve resolutions</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><elocation-id>7523</elocation-id><pub-id pub-id-type="pmcid">PMC11364531</pub-id><pub-id pub-id-type="pmid">39214981</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-51988-1</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez</surname><given-names>AG</given-names></name><name><surname>Carnicer-Lombarte</surname><given-names>A</given-names></name><name><surname>Hilton</surname><given-names>S</given-names></name><name><surname>Malliaras</surname><given-names>G</given-names></name></person-group><article-title>A multivariate physiological model of vagus nerve signalling during metabolic challenges in anaesthetised rats for diabetes treatment</article-title><source>J Neural Eng</source><year>2023</year><volume>20</volume><elocation-id>056033</elocation-id><pub-id pub-id-type="pmid">37757803</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ni</surname><given-names>Z</given-names></name><name><surname>Vial</surname><given-names>F</given-names></name><name><surname>Avram</surname><given-names>AV</given-names></name><name><surname>Leodori</surname><given-names>G</given-names></name><name><surname>Pajevic</surname><given-names>S</given-names></name><name><surname>Basser</surname><given-names>PJ</given-names></name><name><surname>Hallett</surname><given-names>M</given-names></name></person-group><article-title>Measuring conduction velocity distributions in peripheral nerves using neurophysiological techniques</article-title><source>Clinical Neurophysiology</source><year>2020</year><volume>131</volume><fpage>1581</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC8284026</pub-id><pub-id pub-id-type="pmid">32417700</pub-id><pub-id pub-id-type="doi">10.1016/j.clinph.2020.04.008</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kandel</surname><given-names>E</given-names></name><name><surname>Koester</surname><given-names>JD</given-names></name><name><surname>Mack</surname><given-names>SH</given-names></name><name><surname>Siegelbaum</surname><given-names>S</given-names></name></person-group><source>Principles of Neural Science</source><publisher-name>McGraw-Hill Interamericana de España S.L</publisher-name><publisher-loc>New York, N.Y</publisher-loc><edition>Sixth Edition</edition><year>2021</year></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>YJ</given-names></name><name><surname>Sun</surname><given-names>SH</given-names></name><name><surname>Almasi</surname><given-names>A</given-names></name><name><surname>Yunzab</surname><given-names>M</given-names></name><name><surname>Meffin</surname><given-names>H</given-names></name><name><surname>Ibbotson</surname><given-names>MR</given-names></name></person-group><article-title>Characterization of extracellular spike waveforms recorded in wallaby primary visual cortex</article-title><source>Front Neurosci</source><year>2023</year><volume>17</volume><pub-id pub-id-type="pmcid">PMC10517629</pub-id><pub-id pub-id-type="pmid">37746137</pub-id><pub-id pub-id-type="doi">10.3389/fnins.2023.1244952</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>SH</given-names></name><name><surname>Almasi</surname><given-names>A</given-names></name><name><surname>Yunzab</surname><given-names>M</given-names></name><name><surname>Zehra</surname><given-names>S</given-names></name><name><surname>Hicks</surname><given-names>DG</given-names></name><name><surname>Kameneva</surname><given-names>T</given-names></name><name><surname>Ibbotson</surname><given-names>MR</given-names></name><name><surname>Meffin</surname><given-names>H</given-names></name></person-group><article-title>Analysis of extracellular spike waveforms and associated receptive fields of neurons in cat primary visual cortex</article-title><source>The Journal of Physiology</source><year>2021</year><volume>599</volume><fpage>2211</fpage><lpage>38</lpage><pub-id pub-id-type="pmid">33501669</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slomowitz</surname><given-names>E</given-names></name><name><surname>Styr</surname><given-names>B</given-names></name><name><surname>Vertkin</surname><given-names>I</given-names></name><name><surname>Milshtein-Parush</surname><given-names>H</given-names></name><name><surname>Nelken</surname><given-names>I</given-names></name><name><surname>Slutsky</surname><given-names>M</given-names></name><name><surname>Slutsky</surname><given-names>I</given-names></name></person-group><article-title>Interplay between population firing stability and single neuron dynamics in hippocampal networks ed SB Nelson</article-title><source>eLife</source><year>2015</year><volume>4</volume><elocation-id>e04378</elocation-id><pub-id pub-id-type="pmcid">PMC4311497</pub-id><pub-id pub-id-type="pmid">25556699</pub-id><pub-id pub-id-type="doi">10.7554/eLife.04378</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname><given-names>CE</given-names></name></person-group><article-title>A mathematical theory of communication</article-title><source>The Bell System Technical Journal</source><year>1948</year><volume>27</volume><fpage>379</fpage><lpage>423</lpage></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schoenberg</surname><given-names>IJ</given-names></name></person-group><article-title>Contributions to the problem of approximation of equidistant data by analytic functions. Part B. On the problem of osculatory interpolation. A second class of analytic approximation formulae</article-title><source>Quart Appl Math</source><year>1946</year><volume>4</volume><fpage>112</fpage><lpage>41</lpage></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stratton</surname><given-names>P</given-names></name><name><surname>Cheung</surname><given-names>A</given-names></name><name><surname>Wiles</surname><given-names>J</given-names></name><name><surname>Kiyatkin</surname><given-names>E</given-names></name><name><surname>Sah</surname><given-names>P</given-names></name><name><surname>Windels</surname><given-names>F</given-names></name></person-group><article-title>Action Potential Waveform Variability Limits Multi-Unit Separation in Freely Behaving Rats</article-title><source>PLOS ONE</source><year>2012</year><volume>7</volume><elocation-id>e38482</elocation-id><pub-id pub-id-type="pmcid">PMC3373584</pub-id><pub-id pub-id-type="pmid">22719894</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0038482</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><article-title>Large-scale recording of neuronal ensembles</article-title><source>Nat Neurosci</source><year>2004</year><volume>7</volume><fpage>446</fpage><lpage>51</lpage><pub-id pub-id-type="pmid">15114356</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>G</given-names></name><name><surname>Ray</surname><given-names>E</given-names></name><name><surname>Yoon</surname><given-names>H-J</given-names></name><name><surname>Genovese</surname><given-names>S</given-names></name><name><surname>Choi</surname><given-names>YS</given-names></name><name><surname>Lee</surname><given-names>M-K</given-names></name><name><surname>Şahin</surname><given-names>S</given-names></name><name><surname>Yan</surname><given-names>Y</given-names></name><name><surname>Ahn</surname><given-names>H-Y</given-names></name><name><surname>Bandodkar</surname><given-names>AJ</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><etal/></person-group><article-title>A bioresorbable peripheral nerve stimulator for electronic pain block</article-title><source>Science Advances</source><year>2022</year><volume>8</volume><elocation-id>eabp9169</elocation-id><pub-id pub-id-type="pmcid">PMC9534494</pub-id><pub-id pub-id-type="pmid">36197971</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.abp9169</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seufert</surname><given-names>L</given-names></name><name><surname>Elmahmoudy</surname><given-names>M</given-names></name><name><surname>Theunis</surname><given-names>C</given-names></name><name><surname>Lienemann</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Mohammadi</surname><given-names>M</given-names></name><name><surname>Boda</surname><given-names>U</given-names></name><name><surname>Carnicer-Lombarte</surname><given-names>A</given-names></name><name><surname>Kroon</surname><given-names>R</given-names></name><name><surname>Persson</surname><given-names>POÅ</given-names></name><name><surname>Rahmanudin</surname><given-names>A</given-names></name><etal/></person-group><article-title>Stretchable Tissue-Like Gold Nanowire Composites with Long-Term Stability for Neural Interfaces</article-title><source>Small</source><year>2024</year><comment>n/a</comment><elocation-id>2402214</elocation-id><pub-id pub-id-type="pmid">38944890</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoo</surname><given-names>J-C</given-names></name><name><surname>Han</surname><given-names>TH</given-names></name></person-group><article-title>Fast Normalized Cross-Correlation</article-title><source>Circuits Syst Signal Process</source><year>2009</year><volume>28</volume><fpage>819</fpage><lpage>43</lpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>EN</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Mitra</surname><given-names>PP</given-names></name></person-group><article-title>Multiple neural spike train data analysis: state-of-the-art and future challenges</article-title><source>Nat Neurosci</source><year>2004</year><volume>7</volume><fpage>456</fpage><lpage>61</lpage><pub-id pub-id-type="pmid">15114358</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname><given-names>S</given-names></name><name><surname>Judy</surname><given-names>JW</given-names></name><name><surname>Marković</surname><given-names>D</given-names></name></person-group><article-title>Spike Sorting: The First Step in Decoding the Brain: The first step in decoding the brain</article-title><source>IEEE Signal Processing Magazine</source><year>2012</year><volume>29</volume><fpage>124</fpage><lpage>43</lpage></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewicki</surname><given-names>MS</given-names></name></person-group><article-title>A review of methods for spike sorting: the detection and classification of neural action potentials</article-title><source>Network</source><year>1998</year><volume>9</volume><fpage>R53</fpage><pub-id pub-id-type="pmid">10221571</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>Cogill</surname><given-names>S</given-names></name><name><surname>Bhatti</surname><given-names>A</given-names></name><name><surname>Luo</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Nahavandi</surname><given-names>S</given-names></name></person-group><article-title>A review on cluster estimation methods and their application to neural spike data</article-title><source>J Neural Eng</source><year>2018</year><volume>15</volume><elocation-id>031003</elocation-id><pub-id pub-id-type="pmid">29498353</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ludwig</surname><given-names>KA</given-names></name><name><surname>Miriani</surname><given-names>RM</given-names></name><name><surname>Langhals</surname><given-names>NB</given-names></name><name><surname>Joseph</surname><given-names>MD</given-names></name><name><surname>Anderson</surname><given-names>DJ</given-names></name><name><surname>Kipke</surname><given-names>DR</given-names></name></person-group><article-title>Using a Common Average Reference to Improve Cortical Neuron Recordings From Microelectrode Arrays</article-title><source>Journal of Neurophysiology</source><year>2008</year><volume>101</volume><elocation-id>1679</elocation-id><pub-id pub-id-type="pmcid">PMC2666412</pub-id><pub-id pub-id-type="pmid">19109453</pub-id><pub-id pub-id-type="doi">10.1152/jn.90989.2008</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Keefer</surname><given-names>E</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name></person-group><chapter-title>Noise Characterization, Modeling, and Reduction for In Vivo Neural Recording</chapter-title><source>Advances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc</publisher-name><year>2009</year><volume>22</volume></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Donaldson</surname><given-names>N</given-names></name><name><surname>Winter</surname><given-names>J</given-names></name></person-group><article-title>Multiple-electrode nerve cuffs for low-velocity and velocity-selective neural recording</article-title><source>Med Biol Eng Comput</source><year>2004</year><volume>42</volume><fpage>634</fpage><lpage>43</lpage><pub-id pub-id-type="pmid">15503964</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Schuettler</surname><given-names>M</given-names></name><name><surname>Clarke</surname><given-names>C</given-names></name><name><surname>Donaldson</surname><given-names>N</given-names></name></person-group><article-title>The theory of velocity selective neural recording: a study based on simulation</article-title><source>Med Biol Eng Comput</source><year>2012</year><volume>50</volume><fpage>309</fpage><lpage>18</lpage><pub-id pub-id-type="pmid">22362024</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuettler</surname><given-names>M</given-names></name><name><surname>Donaldson</surname><given-names>N</given-names></name><name><surname>Seetohul</surname><given-names>V</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name></person-group><article-title>Fibre-selective recording from the peripheral nerves of frogs using a multi-electrode cuff</article-title><source>J Neural Eng</source><year>2013</year><volume>10</volume><elocation-id>036016</elocation-id><pub-id pub-id-type="pmid">23640008</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metcalfe</surname><given-names>BW</given-names></name><name><surname>Chew</surname><given-names>DJ</given-names></name><name><surname>Clarke</surname><given-names>CT</given-names></name><name><surname>de Donaldson N</surname><given-names>N</given-names></name><name><surname>Taylor</surname><given-names>JT</given-names></name></person-group><article-title>A new method for spike extraction using velocity selective recording demonstrated with physiological ENG</article-title><source>Rat Journal of Neuroscience Methods</source><year>2015</year><volume>251</volume><fpage>47</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">25983203</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koh</surname><given-names>RGL</given-names></name><name><surname>Nachman</surname><given-names>AI</given-names></name><name><surname>Zariffa</surname><given-names>J</given-names></name></person-group><article-title>Classification of naturally evoked compound action potentials in peripheral nerve spatiotemporal recordings</article-title><source>Sci Rep</source><year>2019</year><volume>9</volume><elocation-id>11145</elocation-id><pub-id pub-id-type="pmcid">PMC6668407</pub-id><pub-id pub-id-type="pmid">31366940</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-47450-8</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Donaldson</surname><given-names>N</given-names></name><name><surname>Grego</surname><given-names>T</given-names></name><name><surname>Lancashire</surname><given-names>H</given-names></name><name><surname>Prager</surname><given-names>J</given-names></name><name><surname>Granger</surname><given-names>N</given-names></name><name><surname>Metcalfe</surname><given-names>B</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name></person-group><source>A Multielectrode Nerve Cuff for Chronic Velocity Selective Recording in a sheep model</source><conf-name>2023 45th Annual International Conference of the IEEE Engineering in Medicine &amp; Biology Society (EMBC) 2023 45th Annual International Conference of the IEEE Engineering in Medicine &amp; Biology Society (EMBC)</conf-name><year>2023</year><fpage>1</fpage><lpage>4</lpage></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klus</surname><given-names>J</given-names></name><name><surname>Boys</surname><given-names>JA</given-names></name><name><surname>Serrano</surname><given-names>RRM</given-names></name><name><surname>Malliaras</surname><given-names>GG</given-names></name><name><surname>Carnicer-Lombarte</surname><given-names>A</given-names></name></person-group><article-title>Dataset for Development of novel signal and spike velocity analysis tools in peripheral nerve cuffs</article-title><year>2024</year><pub-id pub-id-type="doi">10.6084/m9.figshare.27687309</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Simulation of nerve signals using a synthetic nerve cuff model.</title><p>a) Schematic of the implanted nerve cuff electrode setup for recording action potential propagation in peripheral nerves. The cuff encompasses a section of the nerve with two electrode sites positioned 2 mm apart, allowing for the detection of efferent and afferent spikes, each representing distinct signal directions within the nerve bundle. b) Simulated nerve velocity traces demonstrating a range of spike properties. Top row: Representative spike waveforms illustrating different simulated spike amplitudes and conduction velocities. Middle rows: Simulated proximal (blue) and distal (yellow) electrode recordings, each composed of distinct spike events (Spike #1, Spike #2, Spike #3) combined with background noise to mimic real nerve recording conditions, and how these are superimposed showing spike alignment differences between the two recording sites (Δt), caused by the simulated time delay in recorded signals due to varying conduction velocities. Bottom row: two velocity analysis tools tested in this study: cross-correlation analysis of recorded trace segments, where the correlation between recordings is compared at different time delays; and analysis of spike within the trace, where the delay between spikes across recordings is compared.</p></caption><graphic xlink:href="EMS200710-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Effect of spike properties on cross-correlation analysis.</title><p>(a–d) Simulated proximal (blue) and distal (yellow) electrode traces illustrating nerve signals with different spike characteristics: single low-amplitude spike (a), two low-amplitude spikes (b), single high-amplitude spike (c), and two high-amplitude spikes (d). (e) Noise-only signal. (f–j) Corresponding cross-correlation plots for each condition (a–e), showing correlation over time delay. In signals with multiple spikes, the additive effect of spikes increases the cross-correlation magnitude (b, g). Higher amplitude spikes create more pronounced peaks due to their multiplicative effect (c, h). Combined effects of multiple and high-amplitude spikes produce both additive and multiplicative impacts on cross-correlation (d, i). Noise produces no distinct peaks, with correlation values fluctuating around the mean (e, j). Correlation coefficient zero has been offset for easier comparison across graphs.</p></caption><graphic xlink:href="EMS200710-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Cross-correlation analysis of signal detection under varying spike amplitude and signal window lengths in noisy environments.</title><p>(a–d) Simulated nerve signals with different spike amplitudes: high-amplitude spikes at 7.2*RMS of noise (a, b), low-amplitude spikes at 1.2*RMS of noise (c), and no spikes as a control (d). (e–h) Addition of noise to each condition in (a–d), with the noisy signals used to evaluate the effect of noise on spike detection. No noise added in (e) as a control. (i–l) Cross-correlation plots for each signal in (e–h) using a 100 ms window. High-amplitude spikes (7.2*RMS) produce a distinct peak in the cross-correlation, even in noisy conditions (j), whereas low-amplitude spikes (1.2*RMS) are obscured by noise, resulting in a flat cross-correlation pattern similar to the noise-only condition. (m–o) Analysis of detectability over extended time windows. (m) Simulated signal with spike amplitude of 1.2*RMS of noise over 10 s. Inset highlights spikes within a shorter interval for clarity. (n) Corresponding signal with noise added. (o) Cross-correlation results over a range of window widths, showing that increasing the window length from 1,000 ms to 20,000 ms allows produces a higher correlation peak (black arrow). (p) Plot of correlation peak values as a function of window length for spikes with different amplitudes. Higher-amplitude spikes require shorter windows to yield higher amplitude correlation peaks.</p></caption><graphic xlink:href="EMS200710-f003"/></fig><fig id="F4" position="float"><label>Figure 1</label><caption><title>Spike velocity estimation method performance.</title><p>(a–c) Diagrams summarising peak detection and velocity estimation scenarios. Dashed lines represent analogue signals. Orange circles represent digital sampled signals, which can result in incorrect velocity estimations across the two peaks. Green squares represent upsampled trace through interpolation, which can decrease the impact of these inaccuracies. (a) Real signal with correct delay (Δt) and velocity measurement. (b) Sampled signals, where true peaks (left) or false peaks (centre, right) may be detected due to sampling rate, leading to potentially erroneous velocity estimates. (c) Interpolated signals allowing for more precise detection of peak delay (Δt) for improved velocity estimation. (d–g) Spike detection and velocity error rates for different signal processing methods across RMS thresholds (stepped at 0.05 increments), comparing peak velocity in sampled signals (d), sinc-interpolated signals (e), spline-interpolated signals (f), and cross-correlation coefficient velocity estimation on sampled signals (g). (h) Comparison of rates for each method at a 4*RMS spike detection threshold. (i–l) Histograms representing magnitude of velocity estimation error of spikes for different methods at a 4*RMS threshold, divided into error categories based on deviation from ground truth, with (i) showing errors for sampled signals, (j) for sinc interpolation, (k) for cubic spline interpolation, and (l) for cross-correlation coefficient estimation. Error groups are colour graded from smaller errors (more orange) to larger, more detrimental errors (more purple), the latter of which includes direction flipping (&lt;-100% error, e.g. sensory misinterpreted as motor) and infinite velocity errors (zero time delay). In panels (d-l) A: True Spike, True Velocity (correctly detected spikes with velocity estimates within ±40% of the true value), B: True Spike, False Velocity (correctly detected spikes but with incorrect velocity estimates), C: Missed Spike (true spikes that were not detected), D: False Spike (detected spikes that did not correspond to true spikes). A key for these is also provided in the figure.</p></caption><graphic xlink:href="EMS200710-f004"/></fig><fig id="F5" position="float"><label>Figure 2</label><caption><title>Histograms of magnitude of velocity estimation error of spikes across velocities and methods</title><p>(a) Rates of velocity error magnitude for sampled signal with peak velocity estimation, (b) sinc-interpolated signal with peak velocity estimation, (c) cubic spline-interpolated signal with peak velocity estimation, and (d) sampled signal with cross-correlation coefficient velocity estimation. Each row represents a different performance when method is applied to spikes of ground truth velocity: 1, 5, 10, 30, 60, and 120 m/s. Error groups are colour graded from smaller errors (more orange) to larger, more detrimental errors (more purple), the latter of which includes direction flipping (&lt;-100% error, e.g. sensory misinterpreted as motor) and infinite velocity errors (zero time delay).</p></caption><graphic xlink:href="EMS200710-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title><italic>In vivo</italic> application of cross-correlation velocity analysis.</title><p>a) Diagram and picture of experimental setup. An ultraconformable parylene-C cuff device is implanted into the median, radial and ulnar nerves innervating the forearm of a rat. b) Recorded traces (top) and cross-correlation heatmap plot (middle) for a proximal and distal electrode in an ulnar nerve cuff for a low SNR activity recording. Cross-correlation heatmap plot is generated with an averaging window of 5 seconds. Lead / lag values correspond to efferent activity (+2 ms to 0 ms) and afferent activity (-2 ms to 0 ms). Plots for cross-correlations at t = 2.5 s, 10 s, and 17.5 s are also provided (bottom). c) Recorded traces and cross-correlation heatmap plot in a median nerve cuff recording high SNR activity. d) Recorded traces and cross-correlation heatmap plots for t = 4.8 to 5.2 s from the same recording used in panel (b), with a range of averaging windows used. Coloured arrowheads indicate cross-correlation values used in panel (e). e) Cross-correlation plots for t = 5 s from heatmap plots in (d). Distinct horizontal bands (d) and peaks (e) can be seen to emerge with longer averaging windows. Transition from grayscale to orange colour scheme in all heatmap plots occurs at the 2*RMS threshold in cross-correlation. This same threshold is indicated by a dashed line in cross-correlation plots in panel (b) (bottom).</p></caption><graphic xlink:href="EMS200710-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title><italic>In vivo</italic> application of spike velocity analysis.</title><p>a) Recorded traces from proximal and distal cuff electrodes showing spike activity (top). Detected spikes using 4*RMS threshold of trace amplitude for distal and proximal cuff traces, as well as spikes detected simultaneously on both (co-detected) (bottom). b-e) Histogram quantification of spike intervals between co-detected spikes for Sampled signal + Peak velocity (b), Sinc interpolation + Peak velocity (c), Spline interpolation + Peak velocity (d), and Sampled signal + CrossCoeff velocity (e). Histogram bins have a width of 0.1 ms. Within the smallest lead/lag bin (-0.05 to +0.05 ms), spikes with exactly 0 ms lead/lag are highlighted in red. These correspond to spikes with a velocity calculated as infinite.</p></caption><graphic xlink:href="EMS200710-f007"/></fig></floats-group></article>