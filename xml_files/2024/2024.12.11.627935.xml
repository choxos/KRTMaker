<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS201949</article-id><article-id pub-id-type="doi">10.1101/2024.12.11.627935</article-id><article-id pub-id-type="archive">PPR953244</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>RegVelo: gene-regulatory-informed dynamics of single cells</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Wang</surname><given-names>Weixu</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Hu</surname><given-names>Zhiyuan</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Weiler</surname><given-names>Philipp</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Mayes</surname><given-names>Sarah</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Lange</surname><given-names>Marius</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Jingye</given-names></name><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Xue</surname><given-names>Zhengyuan</given-names></name><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A9">9</xref></contrib><contrib contrib-type="author"><name><surname>Sauka-Spengler</surname><given-names>Tatjana</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A10">10</xref><xref ref-type="aff" rid="A11">11</xref><xref ref-type="corresp" rid="CR1">+</xref></contrib><contrib contrib-type="author"><name><surname>Theis</surname><given-names>Fabian J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="corresp" rid="CR1">+</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institute of Computational Biology, Computational Health Center, Helmholtz Munich, Munich, Germany</aff><aff id="A2"><label>2</label>TUM School of Life Sciences Weihenstephan, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02kkvpp62</institution-id><institution>Technical University of Munich</institution></institution-wrap>, <country country="DE">Germany</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01q496a73</institution-id><institution>MRC Weatherall Institute of Molecular Medicine</institution></institution-wrap>, Radcliffe Department of Medicine, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap>; <city>Oxford</city>, <country country="GB">United Kingdom</country></aff><aff id="A4"><label>4</label>Medical Research Institute, Frontier Science Center for Immunology and Metabolism, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/033vjfk17</institution-id><institution>Wuhan University</institution></institution-wrap>; <city>Wuhan</city>, <country country="CN">China</country></aff><aff id="A5"><label>5</label>School of Computation, Information and Technology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02kkvpp62</institution-id><institution>Technical University of Munich</institution></institution-wrap>, <city>Munich</city>, <country country="DE">Germany</country></aff><aff id="A6"><label>6</label>Department of Biosystems Science and Engineering, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zürich</institution></institution-wrap>, <city>Basel</city>, <country country="CH">Switzerland</country></aff><aff id="A7"><label>7</label>Institute for Systems Genetics, NYU Grossman School of Medicine, New York, NY, USA</aff><aff id="A8"><label>8</label>Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0190ak572</institution-id><institution>New York University</institution></institution-wrap>, <city>New York</city>, <state>NY</state>, <country country="US">USA</country></aff><aff id="A9"><label>9</label>Institute of Translational Genomics, Helmholtz Munich, Germany</aff><aff id="A10"><label>10</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04bgfm609</institution-id><institution>Stowers Institute for Medical Research</institution></institution-wrap>, <city>Kansas City</city>, <state>MO</state>, <country country="US">USA</country></aff><aff id="A11"><label>11</label>MRC WIMM Centre for Computational Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01q496a73</institution-id><institution>MRC Weatherall Institute of Molecular Medicine</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap>, <city>Oxford</city>, <country country="GB">United Kingdom</country></aff><author-notes><corresp id="CR1">
<label>+</label>Correspondence to <email>TSauka-Spengler@stowers.org</email>,  <email>fabian.theis@helmholtz-munich.de</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>18</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>11</day><month>12</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nd/4.0/">CC BY-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">RNA velocity has emerged as a popular approach for modeling cellular change along the phenotypic landscape but routinely omits regulatory interactions between genes. Conversely, methods that infer gene regulatory networks (GRNs) do not consider the dynamically changing nature of biological systems. To integrate these two currently disconnected fields, we present RegVelo, an end-to-end dynamic, interpretable, and actionable deep learning model that learns a joint model of splicing kinetics and gene regulatory relationships and allows us to perform in silico perturbation predictions. When applied to datasets of the cell cycle, human hematopoiesis, and murine pancreatic endocrinogenesis, RegVelo demonstrates superior predictive power for interactions and perturbation simulations, for example, compared to methods that focus solely on dynamics or GRN inference. To leverage RegVelo’s full potential, we studied the dynamics of zebrafish neural crest development and underlying regulatory mechanisms using our Smart-seq3 dataset and shared gene expression and chromatin accessibility measurements. Using RegVelo’s in silico perturbation predictions, validated by CRISPR/Cas9-mediated knockout and single-cell Perturb-seq, we establish transcription factor <italic>tfec</italic> as an early driver and <italic>elf1</italic> as a novel regulator of pigment cell fate and propose a gene-regulatory circuit involving <italic>tfec</italic> and <italic>elf1</italic> interactions via the toggle-switch model.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Single-cell assays provide novel insight into the intricate processes of cell differentiation at a high resolution<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref></sup>. Waddington’s landscape<sup><xref ref-type="bibr" rid="R4">4</xref></sup> conceptualizes the underlying phenotypic landscape with valleys and branching ridges, symbolizing potential cell states, along which differentiation trajectories unfold. However, building a concrete model of the gene regulatory network (GRN) and dynamics of a cell along this landscape is a major challenge in computational single-cell biology. Such a model would provide mechanistic insight and enable in silico predictions of dynamic effects of gene knockouts (KOs), thereby, informing wet lab experiments to uncover novel biological findings. Existing computational methods either recover cellular trajectories from single-cell measurements to align cells along their developmental paths<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup> while ignoring gene regulatory relationships, or they infer GRNs but omit cell dynamics.</p><p id="P3">Pseudotime<sup><xref ref-type="bibr" rid="R7">7</xref>–<xref ref-type="bibr" rid="R11">11</xref></sup> and RNA velocity<sup><xref ref-type="bibr" rid="R12">12</xref>–<xref ref-type="bibr" rid="R14">14</xref></sup> are the two most widely used concepts for reconstructing cell trajectories: pseudotime orders cells along the differentiation path but requires specifying the root state of the system, routinely assumes unidirectional differentiation, and lacks kinetic information to simulate cellular dynamics; RNA velocity attempts to overcome these limitations through a bottom-up, mechanistic model that describes dynamic changes in spliced mRNA. This approach provides estimates of the instantaneous cellular state change to study state transitions<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> and allows to simulate cell state changes. However, despite its power in studying cellular dynamics<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref></sup>, RNA velocity relies on restrictive modeling assumptions such as gene independence and constant gene transcription rates<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref></sup>, thereby omitting, among other processes, transcriptional regulation underlying cell differentiation.</p><p id="P4">Computational advances in single-cell RNA sequencing (scRNA-seq) have introduced numerous methods for inferring gene regulatory networks (GRNs)<sup><xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R22">22</xref></sup>, and orthogonal data views such as scATAC-seq provide epigenetic priors<sup><xref ref-type="bibr" rid="R23">23</xref>–<xref ref-type="bibr" rid="R27">27</xref></sup>. Currently, analyses leverage GRNs in three main ways: (1) network metrics quantify gene importance<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>, (2) activities of modules help study cellular identity through more refined cell state clusters<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup> or changes along developmental paths<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, and (3) in silico gene expression perturbations predict the corresponding effects on the state identity<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>. However, these analyses primarily rely on methods that do not learn or predict cellular dynamics or only link network components with cellular dynamics in a post-hoc fashion<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. The single-cell community, thus, requires models that map gene regulation to cellular dynamics, to elucidate how GRNs orchestrate dynamic cellular processes.</p><p id="P5">To address this research and knowledge gap, we present RegVelo (Regulatory Velocity), a method to infer transcriptome-wide splicing dynamics coupled through gene regulation. RegVelo harnesses advancements in deep generative modeling to infer kinetic parameters and latent time by leveraging shared information across cells and genes<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. Compared to our earlier work veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup> and previous other models<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R28">28</xref>–<xref ref-type="bibr" rid="R30">30</xref></sup>, we employ a prior GRN-informed neural network to couple gene dynamics and predict transcription rates based on regulator expression, thereby modeling transcription as a time- and regulation-dependent process. The resulting model is a nonlinear genome-wide dynamic differential equation parametrizable and learnable at scale in contrast to the single-gene closed-form dynamic systems traditionally employed. Our model provides a continuous velocity vector field, assesses the uncertainty of cellular state change along differentiation processes, and facilitates regulon or regulation-wise network perturbation simulation to associate cell fate decisions with gene regulatory mechanisms.</p><p id="P6">When applied to simulated data and cell cycle datasets, RegVelo’s velocity and latent time inference outperforms competing methods that employ less faithful models of transcription dynamics<sup><xref ref-type="bibr" rid="R28">28</xref>–<xref ref-type="bibr" rid="R31">31</xref></sup>; on datasets of human hematopoiesis and mouse pancreatic endocrinogenesis, RegVelo’s velocity inference entailed more consistent fate mapping and identification of putative driver genes compared to scVelo<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. By combining our inference paradigm with CellRank 2’s model-agnostic framework<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, we correctly predicted the effects of network perturbations on cell fate decisions and identified gene regulatory circuitry underlying lineage-specific events. Finally, by applying RegVelo to zebrafish neural crest formation, we fully recapitulated and faithfully predicted cell fate priming and key lineage drivers. Our model identified <italic>tfec</italic> as an early key transcriptional regulator controlling pigment cell formation and discovered a previously unknown pigment lineage driver, <italic>elf1</italic>, via in silico perturbation. We validated these predictions using in vivo perturbation experiments, demonstrating excellent accordance and significant improvements over existing perturbation prediction models.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Learning gene regulation informed cellular dynamics</title><p id="P7">RegVelo is a Bayesian deep generative model to describe cellular dynamics that takes unspliced and spliced abundances as input and outputs a cell and gene-specific latent time, the posterior distribution of velocities, and a gene regulatory network (GRN) representing transcriptional regulation. RegVelo finds these estimates by modeling unspliced and spliced RNA readouts for each gene in each cell using kinetic and neural network parameters describing dynamic transcription, splicing, degradation, latent time, and a GRN. Specifically, our model takes into account that upstream regulators control the transcription of target genes<sup><xref ref-type="bibr" rid="R32">32</xref></sup>, an important aspect of biological processes ignored by existing models. GRNs traditionally describe these regulatory mechanisms, allowing us to model non-constant, GRN-informed transcription rates. Combined with the remaining rates and GRN, we thereby model the developmental landscape and align cells along it.</p><p id="P8">RegVelo represents the GRN as a weight matrix, parametrized by a shallow neural network to estimate transcription rates for each gene in each cell. Each entry of the GRN matrix describes the effect of a regulator on the transcription of its targets: positive values describe activation, negative values repression, and zero entries indicate the absence of a regulatory relationship. During model training, we update the GRN parameters to infer the transcriptional dynamics of each gene in a data-driven fashion. At the same time, we constrain the GRN weights by prior knowledge of gene regulation using a penalty function; RegVelo allows prior information on gene regulation curated from single-cell multi-omics experiments<sup><xref ref-type="bibr" rid="R33">33</xref></sup> or public gene regulation databases<sup><xref ref-type="bibr" rid="R34">34</xref></sup>. In general, GRN inference often faces two limitations: erroneous a priori estimated GRNs and the need to account for sparsity. Initial GRN estimates are imperfect due to the inference from noisy data or incomplete understanding of the regulatory mechanisms of biological systems, and sparsity is a common assumption in GRN inference<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R35">35</xref></sup> based on studies of real biological systems<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. To address these challenges, RegVelo improves initial GRN estimates by learning new potential regulatory interactions and incorporates priors in the parameter estimation that impose sparsity constraints either through a sparse prior network or L1-regularizing the Jacobian matrix of the dynamical system to impose smoothness of the dynamics (<xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P9">RegVelo incorporates cellular dynamic estimates by first encoding unspliced (<italic>u</italic>) and spliced RNA (<italic>s</italic>) readouts into posterior parameters of a low dimensional latent variable - the <italic>cell representation</italic> - with a neural network. An additional neural network takes samples of this <italic>cell representation</italic> as input to parameterize gene-wise latent time as in our previous model veloVI. We then model splicing dynamics with ordinary differential equations (ODEs) specified by a base transcription <italic>b</italic> and GRN weight matrix <italic>W</italic>, describing transcription and inferred by a shallow neural network, constant splicing and degradation rate parameters <italic>β</italic> and <italic>γ</italic>, respectively, and estimated cell and gene-specific latent times (<xref ref-type="fig" rid="F1">Figure 1a</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). Importantly, existing methods for inferring RNA velocity consider a set of decoupled one-dimensional ODEs for which analytic solutions exist, but RegVelo relies on the single, high-dimensional ODE
<disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mtable columnalign="right"><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
that is now coupled through gene regulation-informed transcription
<disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>W</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>g</italic> indicates the gene and <italic>h</italic> is a non-linear activation function (<xref ref-type="sec" rid="S12">Methods</xref>). We predict the gene and cell-specific spliced and unspliced abundances using a parallelizable ODE solver<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, as this new system does not pose an analytic solution anymore; compared to previous approaches, we solve all gene dynamics at once instead of sequentially for each gene independently of all others. The forward simulation of the ODE solver allows for computing the likelihood function encompassing all neural network and kinetic parameters (<xref ref-type="fig" rid="F1">Figure 1a</xref>). We assume that the predicted spliced and unspliced abundances are the expected value of the Gaussian likelihood of the observed dataset and use gradient-based optimization to update all parameters (<xref ref-type="sec" rid="S12">Methods</xref>). After optimization, we define cell-gene-specific velocities as splicing velocities based on the estimated splicing and degradation rates and predicted spliced and unspliced abundance. Overall, RegVelo allows sampling predicted readouts and velocities from the learned posterior distribution.</p><p id="P10">RegVelo outputs parameter estimates including the inferred GRN, latent time, and the posterior velocity distribution, allowing us to quantify intrinsic and extrinsic cell uncertainty (<xref ref-type="fig" rid="F1">Figure 1b</xref>): intrinsic uncertainty captures uncertainty of the cell state change along the phenotypic manifold approximated by the first-order direction, while extrinsic uncertainty reflects uncertainty in future cell states<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. RegVelo generalizes our previous model veloVI by explicitly incorporating a GRN, thereby offering a more sophisticated and realistic model of Waddington’s epigenetic landscape (<xref ref-type="fig" rid="F1">Figure 1b</xref>). As such, RegVelo models the dynamics of a system of gene regulatory interactions that impose constraints and drive cell development, rather than merely modeling gene splicing<sup><xref ref-type="bibr" rid="R13">13</xref></sup> or mapping cells across different time points via expression similarity<sup><xref ref-type="bibr" rid="R40">40</xref></sup>. Moreover, using different gene regulatory systems, RegVelo can generate velocity samples from the respective posterior distributions. By comparing velocity vector fields of perturbed regulatory systems, RegVelo also directly links gene regulation to cellular dynamics.</p></sec><sec id="S4"><title>Adding regulatory constraints enhances inference of cell cycle dynamics</title><p id="P11">Inference of transcriptional dynamics is a challenging task and difficult to evaluate as ground truth kinetic rates and state changes usually do not exist. To assess RegVelo’s ability to correctly infer cellular dynamics and gene regulation, nonetheless, we benchmarked it across a range of simulated and real-world datasets. First, we benchmarked our model on simulated data for which ground truth rates and latent time exist and found that RegVelo consistently outperformed competing methods (Supplementary Notes 1 and 2).</p><p id="P12">Next, we turned to a cell cycle dataset as a real-world setting where we could robustly approximate the correct differentiation history and direction from fluorescence markers. Fluorescent ubiquitination-based cell-cycle indicator (FUCCI) U2OS cells undergo clear unidirectional transitions during the cell cycle, moving from the G1 to S to G2M phase, and yield a protein-derived cell-cycle score as a proximal measure of ground truth time (<xref ref-type="fig" rid="F1">Figure 1c</xref>)<sup><xref ref-type="bibr" rid="R39">39</xref></sup>. After confirming that RegVelo recovered the underlying dynamics faithfully, we investigated the inferred GRN next (<xref ref-type="fig" rid="F1">Figure 1d</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). Importantly, we did not provide a prior-informed GRN as an initial estimate to RegVelo but used a fully connected network where each gene interacts with every other gene, instead - a choice that allowed us to quantify RegVelo’s ability to infer gene regulation in an unbiased manner. To preprocess nascent and mature mRNA, we followed our previous approaches for RNA velocity inference and provided our generative model with gene expression smoothed by first order over cellular neighborhoods (<xref ref-type="sec" rid="S12">Methods</xref>)</p><p id="P13">We verified that RegVelo accurately recovered the overall direction of the cell cycle by comparing the extrapolated future states of cells with prior knowledge on state transitions. Additionally, we confirmed that the inferred velocity field was consistent, which is desirable given the unidirectional nature of the underlying process. Specifically, we relied on the cross-boundary correctness (CBC) score<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup> that quantifies how faithfully a vector field aligns with known state transitions, <italic>i.e</italic>., G1 to S, and S to G2M phase in our scenario (<xref ref-type="fig" rid="F1">Figure 1d,e</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1a</xref>). Indeed, RegVelo achieved a comparatively high score (CBC=0.864 out of 1), high velocity consistency (0.873 out of 1), and its estimated latent time correlated highly with the FUCCI score used as ground truth (Spearman correlation = 0.683; possible values between -1 and 1). Turning to the RegVelo-inferred GRN, we focused on the most central part of the estimated network, identifying the main regulators TGIF1 and ETV1 among the most connected factors, and their top targets included cell cycle progression-related genes like <italic>BUB1</italic><sup><xref ref-type="bibr" rid="R41">41</xref></sup>, <italic>TFDP1</italic><sup><xref ref-type="bibr" rid="R42">42</xref></sup>, and <italic>TOP2A</italic><sup><xref ref-type="bibr" rid="R43">43</xref></sup> (<xref ref-type="fig" rid="F1">Figure 1d</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). To consistently verify RegVelo’s ability to identify biologically correct regulons from the transcriptome data, we first curated a list of putative targets of cell cycle-related TFs<sup><xref ref-type="bibr" rid="R44">44</xref></sup> from the ChIP-Atlas database<sup><xref ref-type="bibr" rid="R45">45</xref></sup> as ground truth; the ChIP-Atlas integrates ChIP-seq, ATAC-seq and Bisulfite-seq experiments at large scale to offer epigenetic insight. Our method yielded highly concordant results, quantified by edge prediction performance and the correlation between the predicted regulation coefficient and the ChIP-Atlas binding score (<xref ref-type="fig" rid="F1">Figure 1d</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1b</xref>; <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P14">Existing methods for inferring splicing dynamics do not consider regulatory information, and approaches that estimate GRNs ignore cellular dynamics. To assess how combining the two aspects with RegVelo compares to methods focussing on a single facet, we applied our previous inference schemes veloVI and scVelo’s<sup><xref ref-type="bibr" rid="R13">13</xref></sup> <italic>EM</italic> model, and the GRN inference models CellOracle<sup><xref ref-type="bibr" rid="R25">25</xref></sup>, GRNBoost<sup><xref ref-type="bibr" rid="R46">46</xref></sup>, and Pearson correlation. Whereas veloVI and scVelo assume constant rates, recent extensions like UniTVelo<sup><xref ref-type="bibr" rid="R28">28</xref></sup>, VeloVAE<sup><xref ref-type="bibr" rid="R29">29</xref></sup>, TFvelo<sup><xref ref-type="bibr" rid="R31">31</xref></sup>, and cell2fate<sup><xref ref-type="bibr" rid="R30">30</xref></sup> try to model transcription as a time-dependent process. We, thus, also benchmarked against these velocity methods. Overall, RegVelo outperformed the other velocity methods in terms of CBC and latent time inference; among the methods that inferred the correct direction, RegVelo also had the highest velocity consistency score, showing that its velocity vector field aligned best with the ground-truth direction of the cell cycle (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1a</xref>). To further assess whether proximal cells on the phenotypic manifold have similar latent times, we calculated the local consistency of inferred latent time for RegVelo compared to veloVI. RegVelo showed significantly better local latent time consistency than veloVI (two-sided Welch’s <italic>t</italic>-test, <italic>P</italic> &lt; 1 × 10<sup>−10</sup>), indicating that RegVelo gives smoother latent time estimates (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1c</xref>). In terms of GRN inference, RegVelo outperformed competing approaches both on edge and regulation coefficient prediction (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1b</xref>).</p><p id="P15">To confirm that the observed improvement of RegVelo over other methods is indeed related to incorporating gene regulation, we tested to what extent alterations to the estimated network influenced the inferred dynamics. To assess the influence of the GRN in general, we predicted splicing dynamics without any regulatory relationships present, and to mimic spurious gene-gene interactions, we randomly reconnected genes in RegVelo’s network (<xref ref-type="sec" rid="S12">Methods</xref>). As expected, both scenarios led to a lower CBC score and latent time correlation (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 1d</xref>), highlighting that incorporating gene regulation improves cellular dynamic inference.</p><p id="P16">These results on both simulation and real data demonstrate RegVelo’s ability to correctly and consistently infer cellular dynamics and gene regulation more faithfully than competing methods.</p></sec><sec id="S5"><title>Regulatory-constrained dynamic inference accurately recovers lineage formation in pancreatic endocrinogenesis</title><p id="P17">RegVelo is a generative model that couples cellular dynamics with regulatory networks. We can, thus, perform in silico counterfactual inference to test the cellular response upon unseen perturbations of a TF in the regulatory network: for a trained RegVelo model, we ignore regulatory effects of the TF by removing all its downstream targets from the GRN, <italic>i.e</italic>., depleting the regulon, and generate the perturbed velocity vector field (<xref ref-type="fig" rid="F2">Figure 2a</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). The dissimilarity between the original and perturbed cell velocities - the perturbation effect score - reflects the local changes on each cell induced by perturbations; we quantify this score with cosine dissimilarity (<xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P18">RNA velocity describes a high dimensional vector field representing cellular change along the phenotypic manifold but lacks interpretability and quantifiable measures of the long-term cell behavior. We recently proposed CellRank<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> to bridge this gap by leveraging gene expression and an estimated vector field to model cell state transitions through Markov chains and infer terminal cell states. For each terminal state identified, CellRank calculates the probability of a cell transitioning to this state - the fate probability - that allows us to predict the cell’s future state. By combining RegVelo’s generative model with CellRank, we connect gene regulation with both local cell dynamics and long-term cell fate decisions, and how they change upon in silico perturbations. In the context of our perturbation analyses, we compare CellRank’s prediction of cell fate probabilities for the original and perturbed vector fields, to find enrichment (increased cell fate probability) or depletion (decreased cell fate probability) effects towards terminal states (<xref ref-type="fig" rid="F2">Figure 2a</xref>).</p><p id="P19">To highlight how our model elucidates cellular dynamics by incorporating gene regulation, we applied RegVelo to a pancreatic endocrine development scRNA-seq dataset<sup><xref ref-type="bibr" rid="R47">47</xref></sup>. To guide RegVelo’s inference of the underlying cellular dynamics, we estimated a prior GRN by scanning for motifs within candidate cis-regulatory elements (CREs) and integrating gene expression and peak accessibility information with Pando<sup><xref ref-type="bibr" rid="R24">24</xref></sup> to define the prior GRN estimate (<xref ref-type="sec" rid="S12">Methods</xref>). For this GRN construction, we relied on a multiome dataset of paired ATAC and gene expression of the same system at embryonic days 14.5 and 15.5<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.</p><p id="P20">Passing RegVelo’s inferred velocity field to CellRank, we delineated the cycling population of ductal cells and predicted all four terminal states, namely Alpha, Beta, Delta, and Epsilon cells<sup><xref ref-type="bibr" rid="R47">47</xref></sup> (<xref ref-type="fig" rid="F2">Figure 2b,c</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). We specifically explored how these lineages form, predicting that some Epsilon cells become progenitors of Alpha cells, which is consistent with current reports<sup><xref ref-type="bibr" rid="R47">47</xref>–<xref ref-type="bibr" rid="R49">49</xref></sup> (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 2a</xref>). We identified two states based on fate probabilities that divide the Epsilon cell population: state A expressed Alpha cell-specific genes highly (<italic>Pou6f2</italic><sup><xref ref-type="bibr" rid="R50">50</xref></sup>, <italic>Irx1</italic><sup><xref ref-type="bibr" rid="R51">51</xref></sup>, and <italic>Smarca1</italic><sup><xref ref-type="bibr" rid="R52">52</xref></sup>), and state B <italic>Neurog3</italic>, consistent with Neurogenin3 activity-dependent Epsilon cell genesis<sup><xref ref-type="bibr" rid="R53">53</xref></sup> (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 2b</xref>; <xref ref-type="sec" rid="S12">Methods</xref>).<sup><xref ref-type="bibr" rid="R53">53</xref></sup> Similar to our analyses of the cell cycle data, we deleted or shuffled the learned GRN to generate new vector fields to verify the utility of combining transcriptional dynamics with gene regulation; both alterations led to the loss of identified terminal states (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 2c</xref>). An additional indication for the GRN’s importance is that our previous methods veloVI and scVelo achieved a lower terminal state identification (TSI) score<sup><xref ref-type="bibr" rid="R16">16</xref></sup> that quantifies how accurately a method identifies terminal states (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 2d</xref>; <xref ref-type="sec" rid="S12">Methods</xref>).</p></sec><sec id="S6"><title>RegVelo disentangles ductal and epsilon cell dynamics in pancreatic endocrinogenesis through in silico perturbations</title><p id="P21">Following our analysis of cell maturation, we investigated how to interpret the role of gene regulation in the cycling population of ductal cells with RegVelo. By correlating gene expression with a cell cycling phase score inferred from prior knowledge on cycling markers, we identified <italic>E2f1</italic> as the highest-ranked gene (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3a,b</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). To predict the cell set related to E2f1 functions, we removed the E2f1 regulon from the GRN and used cosine dissimilarity to compare the vector fields before and after perturbation (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3c</xref>). We thereby identified a ductal cell subpopulation exhibiting large change that overlaps mostly with the S-phase and, thus, the stage influenced most by <italic>E2f1</italic><sup><italic>54</italic></sup> (Fisher exact test, <italic>P</italic> &lt; 1 × 10<sup>−10</sup>; <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3d</xref>). Importantly, this perturbation effect score does not simply reflect <italic>E2f1</italic> expression, as Ngn3 high EP cells express <italic>E2f1</italic> at a higher level than ductal cells (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3d</xref>). Moreover, gene ontology (GO) enrichment analysis suggests that the predicted E2f1 downstream targets mainly enrich the cell cycling phase transition-related pathway (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3e</xref>), aligning with previous findings that E2f1 is a cell cycling regulator<sup><xref ref-type="bibr" rid="R55">55</xref></sup>. These findings highlight that the RegVelo-predicted perturbation effects score can help elucidate and identify the role of different cell states and pathways.</p><p id="P22">We explored the <italic>E2f1</italic> regulon network further to investigate whether RegVelo could recover known E2f1 downstream targets that contribute to cell cycle regulation. As a first step, we validated that the inferred gene regulatory network is identifiable and robust under different runs of RegVelo (Pearson correlation &gt; 0.95; <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3f</xref>). We then used the prior GRN as a baseline to compare the RegVelo-inferred ductal cell GRN performance when predicting E2f1 targets (<xref ref-type="sec" rid="S12">Methods</xref>). Using E2f1 ChIP-seq results from the ChIP-Atlas database as ground truth, RegVelo’s GRN showed significant improvement over the prior GRN in predicting E2f1 targets (two-sided Welch’s <italic>t</italic>-test, <italic>P</italic> &lt; 1 × 10<sup>−10</sup>; <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3g</xref>). Focusing on the top 20 predicted targets, we recovered eight cycling-related genes, including <italic>Cdt1</italic><sup><xref ref-type="bibr" rid="R56">56</xref></sup>, <italic>Uhrf1</italic><sup><xref ref-type="bibr" rid="R57">57</xref></sup>, <italic>Stmn1</italic><sup><xref ref-type="bibr" rid="R58">58</xref></sup>, <italic>Id2</italic><sup><xref ref-type="bibr" rid="R59">59</xref></sup>, <italic>Mcm6</italic>, and <italic>Mcm7</italic><sup><xref ref-type="bibr" rid="R60">60</xref></sup>. The Pando-based prior GRN, however, did not include key cell cycling modulators such as <italic>Hells</italic> and <italic>Cenpk</italic> as E2f1 targets, whereas the RegVelo-inferred GRN correctly predicted them among the top downstream effectors (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 3h</xref>). Recent experimental results validate these connections<sup><xref ref-type="bibr" rid="R61">61</xref>,<xref ref-type="bibr" rid="R62">62</xref></sup>. In summary, RegVelo accurately infers cellular dynamics and gene regulation, enabling the prediction of perturbation effects.</p><p id="P23">Next, we used RegVelo to understand the perturbation effects of TFs on cell fate decisions. This analysis required us to ensure that RegVelo gives stable cell fate probability prediction to avoid stochastic effects caused by random parameter initialization, for example. To verify robustness, we measured the correlation of velocities or cell fate probabilities between pairs of estimates from different runs of the model (<xref ref-type="sec" rid="S12">Methods</xref>). RegVelo scored a high mean correlation and low variance, implying that RegVelo has high identifiability on cell fate prediction (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 4a</xref>). Next, we quantified the perturbation effect of each TF regulon and validated its stability over multiple model fits for each lineage (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 4b</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). Having verified RegVelo’s robust inference, we reasoned that the TFs corresponding to the biggest depletion effects after in silico perturbation pose putative drivers of the specific lineage. Using this perturbation simulation-based ranking of putative lineage drivers, RegVelo accurately predicted known drivers in the four lineages, including Smarca1<sup><xref ref-type="bibr" rid="R52">52</xref></sup>, Arx<sup><xref ref-type="bibr" rid="R63">63</xref></sup> in the Alpha, Pdx1<sup><xref ref-type="bibr" rid="R64">64</xref></sup>, Mnx1<sup><xref ref-type="bibr" rid="R65">65</xref></sup> in the Beta, Hhex<sup><xref ref-type="bibr" rid="R66">66</xref></sup> in the Delta lineage (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 4c</xref>) and achieved an overall high driver ranking performance, evaluated via the AUROC (AUROC=0.95; <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P24">We further focused on the poorly understood process of Epsilon cell differentiation and observed that our in silico screening predicted Neurod2 as one of the putative drivers of Epsilon cell differentiation (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 4c</xref>). Previous studies have found that pancreatic cells transiently expressed <italic>Neurod2</italic> during pancreatic endocrinogenesis<sup><xref ref-type="bibr" rid="R67">67</xref></sup> and suggested the role of <italic>Neurod2</italic> in Epsilon cell conformation<sup><xref ref-type="bibr" rid="R48">48</xref></sup>. To uncover the potential mechanisms of <italic>Neurod2</italic> in orchestrating Epsilon cell differentiation, we employed RegVelo’s generic circuit screening feature to perturb each downstream target of Neurod2 and predict the outcomes of these perturbations on Epsilon differentiation. According to these results, perturbation of the Neurod2-<italic>Rfx6</italic> regulation contributes the most to the maturation of Epsilon cells (<xref ref-type="fig" rid="F2">Figure 2d</xref>), an observation consistent with recent studies highlighting the importance of this regulation<sup><xref ref-type="bibr" rid="R48">48</xref></sup>. Perturbing the Rfx6 regulon suggests its involvement in Beta and Epsilon cell differentiation, an observation supported by previous experimental studies<sup><xref ref-type="bibr" rid="R68">68</xref></sup> (<xref ref-type="fig" rid="F2">Figure 2e</xref>).</p></sec><sec id="S7"><title>RegVelo recovers regulatory motifs governing cell fate decisions in hematopoietic differentiation</title><p id="P25">While previous RNA velocity models successfully recovered the general mechanisms of pancreatic endocrine development, the same methods did not provide insight into gene regulation, could not predict perturbation effects, and failed altogether when applied to hematopoietic datasets. The erroneous inference of cell dynamics primarily arises from the assumption of constant transcription rates, which does not hold true in the dynamic regulation processes during hematopoiesis<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R69">69</xref>,<xref ref-type="bibr" rid="R70">70</xref></sup>. As RegVelo does not model transcription as constant, we hypothesized that our proposed model would not face the same limitation and, additionally, inform on gene regulatory processes during hematopoiesis. Further, hematopoiesis is a well-studied system, offering an opportunity to further validate our TF perturbation predictions based on the literature.</p><p id="P26">To apply RegVelo to a hematopoiesis dataset including five distinct lineages<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (<xref ref-type="fig" rid="F3">Figure 3a</xref>), we first curated a prior GRN, relying on two orthogonal resources to mitigate the effect of incompleteness: as a first estimate, we used a publicly available GRN inferred from single-nucleus ATAC and gene expression measurements of bone marrow mononuclear cells with <italic>Dictys</italic><sup><xref ref-type="bibr" rid="R26">26</xref></sup>. We then extended this representation with an additional GRN curated from human hematopoiesis ChIP-seq datasets from the UniBind database<sup><xref ref-type="bibr" rid="R71">71</xref></sup> to obtain our final prior GRN. After feeding this GRN into our standard RegVelo workflow and passing the estimated vector field to CellRank, the resulting fate probabilities correctly described the known lineage commitment and hierarchy of hematopoiesis and allowed us to recover all five terminal states and recapitulate known state transitions faithfully (<xref ref-type="fig" rid="F3">Figure 3b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 5a</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). We also observed a change in RegVelo’s intrinsic estimation uncertainty from high in progenitor cells (MEP and GMP) to low in terminal states (<xref ref-type="fig" rid="F3">Figure 3c</xref>), consistent with the fact that mature cells do not change their identity. Having validated RegVelo’s ability to correctly model cellular change along the phenotypic manifold, we analyzed in silico perturbation predictions and the recovered GRN, next.</p><p id="P27">Deletion of the GATA1 regulon, a well-known master regulator of the megakaryocyte-erythroid progenitor (MEP) lineage<sup><xref ref-type="bibr" rid="R72">72</xref></sup>, results in RegVelo-predicted depletion effects in erythrocytes and enrichment effects in monocytes. Similarly, deleting the master regulator of the granulocyte-monocyte progenitor (GMP) lineage<sup><xref ref-type="bibr" rid="R73">73</xref></sup>, the SPI1 regulon, led to enrichment effects in the erythrocyte branch. RegVelo’s GRN also included the toggle switch motif of SPI1 and GATA1, consistent with previous experimental studies<sup><xref ref-type="bibr" rid="R74">74</xref>,<xref ref-type="bibr" rid="R75">75</xref></sup>. At the same time, RegVelo accurately predicted GATA1 downstream effectors directly influencing the hemoglobin gene expression, aligning with previous experimental findings on the <italic>GATA1</italic> downstream regulatory network<sup><xref ref-type="bibr" rid="R76">76</xref></sup> (<xref ref-type="fig" rid="F3">Figure 3d</xref>).</p><p id="P28">To show that RegVelo provides insight beyond the capability of competing methods, we benchmarked the inferred cellular dynamics compared to veloVI and scVelo (<xref ref-type="sec" rid="S12">Methods</xref>). Following CellRank 2’s workflow<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, we used the log2 ratio of the CBC scores as a quantitative metric for evaluating velocity inference and observed that RegVelo outperformed scVelo in 5 out of 6 cell state transitions. Although veloVI shows an overall comparable CBC score of forward cell state transition to RegVelo, it results in lower CBC scores of backward cell state transition, indicating an incorrect backflow in the veloVI vector field (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 5b,c</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). To assess the effect of model regularization, we compared the results of unregularized and J-L1 regularized RegVelo estimates. The regularization led to improved cell state transition predictions, indicating that increased model sparsity improves dynamic inference, consistent with previous studies on NeuralODE models<sup><xref ref-type="bibr" rid="R77">77</xref></sup>.</p><p id="P29">Using cell-cell transition probabilities computed with CellRank to infer terminal states, RegVelo was the only method to recover all five terminal states (TSI = 0.95), and it significantly outperformed the other methods (one-sided Welch’s <italic>t</italic>-test: RegVelo vs. veloVI, <italic>P</italic> = 1.59 1 × 10<sup>−5</sup>; RegVelo vs. scVelo: <italic>P</italic> = 2.23 1 × 10<sup>−5</sup>; <xref ref-type="fig" rid="F3">Figure 3a,b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 6a</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). As an extension of veloVI, we specifically compared RegVelo inference results to veloVI’s predictions: first, we examined how robust each method’s velocity or latent time estimations were under different runs. Overall, RegVelo’s estimates were more stable and associated with a higher consistency compared to veloVI (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 6b</xref>). Next, compared to RegVelo’s dynamically decreasing intrinsic estimation uncertainty, veloVI’s inference resulted in high intrinsic uncertainty in every cell type (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 6c</xref>). Finally, the predicted cell fate probabilities of veloVI and scVelo violated known transitions (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 6d</xref>).</p><p id="P30">Estimating fate probabilities with CellRank based on RegVelo’s vector field allows us to identify putative drivers by correlating them with gene expression<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. We employed this strategy to investigate whether incorporating gene regulation in the splicing model leads to better identification of known genes associated with lineage priming compared to classical models that omit gene regulation (<xref ref-type="sec" rid="S12">Methods</xref>). To do so, we first curated a list of known markers of the lineages to compare it to the predictions of each method. Next, we ranked genes using different velocity methods and assessed how well the ranked genes matched the sets of known markers. Here, we focused on the monocyte and erythroid lineages, as they represent two distinct branches, characterized by different markers. Compared to competing methods, using RegVelo’s velocity estimates as input for CellRank achieved the best ranking for both the monocyte and erythroid lineage (<xref ref-type="fig" rid="F3">Figure 3e</xref>). Notably, either by ranking according to perturbation simulation or by using CellRank with RegVelo estimated velocities, RegVelo outperformed dynamo with respect to driver TF prediction on both lineages (<xref ref-type="sec" rid="S12">Methods</xref>), even though the method has access to metabolic labeling information (<xref ref-type="fig" rid="F3">Figure 3f</xref>).</p><p id="P31">The analysis of the hematopoietic system with RegVelo highlighted our model’s capability to accurately recover lineage hierarchy and regulatory connections, outperforming competing approaches including those with access to more rich data such as metabolic labels.</p></sec><sec id="S8"><title>RegVelo screens TF knockout effects for cell fate decisions in zebrafish</title><p id="P32">Neural crest (NC) cells contribute a broad range of derivative cell types to functionally distinct tissues and organs, including bone, cartilage and connective components of the craniofacial skeleton, the majority of the body’s pigment cells, and elements of the peripheral nervous system. Deciphering dynamic programs that control neural crest formation holds promise of understanding vertebrate evolution, developmental disorders, and neural-crest-derived cancers<sup><xref ref-type="bibr" rid="R78">78</xref>–<xref ref-type="bibr" rid="R80">80</xref></sup>. Based on our promising in silico validation experiments on the cell cycle, pancreatic endocrinogenesis, and hematopoiesis, we hypothesized that RegVelo could be more generally used to combine high-throughput single-cell transcriptomic readouts with GRN priors into an interpretable, dynamic, and actionable model of neural crest formation. To decode the complex regulatory dynamics underlying neural crest development, we employed Smart-seq3<sup><xref ref-type="bibr" rid="R81">81</xref></sup> to profile 1,180 neural crest cells and their derivatives at seven time points, achieving a median coverage of 7,791 genes per cell (<xref ref-type="fig" rid="F4">Figure 4a,b</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 7a,b</xref>). We then applied RegVelo with a prior GRN inferred with SCENIC+<sup><xref ref-type="bibr" rid="R23">23</xref></sup> based on a matched single-cell multiome dataset<sup><xref ref-type="bibr" rid="R82">82</xref></sup> (<xref ref-type="fig" rid="F4">Figure 4a</xref>; <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P33">As the general state transitions and differentiation order of neural crest development are known, we confirmed that RegVelo adheres to the established differentiation hierarchy before relying on RegVelo’s in silico perturbation scheme to identify lineage regulators. Indeed, RegVelo demonstrated highly accurate dynamic inference as it allowed us to correctly identify all terminal states, namely post-otic migratory neural crest (mNC hox34), non-hox facial mesenchymal, second pharyngeal arch (arch2), and pigment cells (<xref ref-type="fig" rid="F4">Figure 4c,d</xref>). Additionally, the RegVelo-inferred latent time showed a positive correlation with the actual developmental stages (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 7c,d</xref>), and accurately placed the non-hox neural plate border (NPB nohox) cell state at the start of the developmental process<sup><xref ref-type="bibr" rid="R83">83</xref></sup> (<xref ref-type="fig" rid="F4">Figure 4c</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 7c</xref>). Taken together, these findings verify the high fidelity of RegVelo’s velocity inference compared to other methods (<xref ref-type="fig" rid="F4">Figure 4d</xref>).</p><p id="P34">To systematically identify putative lineage drivers based on in silico regulon perturbation, we followed our previous analyses to quantify perturbation effects of cell differentiation towards the four terminal states (<xref ref-type="sec" rid="S12">Methods</xref>). RegVelo accurately predicted the perturbation effects of known drivers of neural crest derivatives, including key regulons of the pigment (mitfa<sup><xref ref-type="bibr" rid="R84">84</xref></sup>, sox10<sup><xref ref-type="bibr" rid="R85">85</xref></sup>) and mesenchymal (sox9b<sup><xref ref-type="bibr" rid="R86">86</xref></sup>, nr2f2<sup><xref ref-type="bibr" rid="R87">87</xref></sup>, twist1b<sup><xref ref-type="bibr" rid="R88">88</xref></sup>) lineages (<xref ref-type="fig" rid="F4">Figure 4e</xref>).</p><p id="P35">As RegVelo allows us to simulate perturbed dynamics <italic>de novo</italic>, we were able to identify lineage drivers expressed at the beginning of a trajectory but not in the terminal states, while correlation-based methods tended to overlook the same genes (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 7e</xref>; <xref ref-type="sec" rid="S12">Methods</xref>). For instance, neural plate border and delaminating neural crest cells (early states during NC formation) highly expressed the cranial mesenchymal lineage drivers, <italic>ets1</italic><sup><xref ref-type="bibr" rid="R89">89</xref></sup>, <italic>nr2f5</italic><sup><xref ref-type="bibr" rid="R87">87</xref></sup>, <italic>sox9b</italic><sup><xref ref-type="bibr" rid="R90">90</xref></sup>, and <italic>twist1b</italic><sup><xref ref-type="bibr" rid="R91">91</xref></sup> that were significantly downregulated in cells at the terminal states (log<sub>2</sub> FC &lt; 0, <italic>P</italic> &lt; 0.001; <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 7e-g</xref>). While RegVelo correctly predicted these genes as drivers of the mesenchymal lineage, a correlation-based analysis with the classical CellRank workflow and in silico perturbation approach by dynamo<sup><xref ref-type="bibr" rid="R22">22</xref></sup> erroneously identified them as putative drivers of post-otic migratory neural crest development (mNC hox34) (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 8a-c</xref>). Finally, our RegVelo-based workflow ranked these genes consistently higher than the correlation-based approach (<xref ref-type="fig" rid="F4">Figure 4f</xref>).</p><p id="P36">Advances in single-cell Perturb-seq have enabled precise testing of transcription factor function through targeted knockouts in living organisms<sup><xref ref-type="bibr" rid="R92">92</xref></sup>. Using this approach, we validated RegVelo’s predictions of TF knockout with our improved CRISPR/Cas9 and direct capture Perturb-seq workflow<sup><xref ref-type="bibr" rid="R80">80</xref></sup> (<xref ref-type="fig" rid="F4">Figure 4a,g</xref>): we designed two to four chemically modified single guide RNAs<sup><xref ref-type="bibr" rid="R93">93</xref></sup> to target each TF (<italic>tfec, mitfa, bhlhe40, tfeb, elf1, nr2f2</italic>, and <italic>nr2f5</italic>) to maximize the knockout efficiency and computed the in vivo perturbation effects, defined as the MELD likelihood scores of lineage changes between wild type and mutant embryos, where a score lower than 0.5 indicates depletion (<xref ref-type="sec" rid="S12">Methods</xref>). Regarding the known factors, we found the experimental results consistent with the computational predictions. For instance, the in vivo knockout of the top pigment driver, <italic>mitfa</italic><sup><xref ref-type="bibr" rid="R84">84</xref></sup>, resulted in pigment lineage depletion (lineage-specific median MELD likelihood = 0.3354), while knocking out the cranial ectomesenchymal driver <italic>nr2f2</italic><sup><xref ref-type="bibr" rid="R94">94</xref></sup> depleted mesenchymal cells as predicted by RegVelo (lineage-specific median MELD likelihood = 0.47, <xref ref-type="fig" rid="F4">Figure 4h</xref>). We next systematically examined the in silico knockout performance using the in vivo Perturb-seq data.</p><p id="P37">To evaluate the overall performance of RegVelo’s perturbation simulation, we extended our seven-TF Perturb-seq data with an additional complementary Perturb-seq dataset<sup><xref ref-type="bibr" rid="R80">80</xref></sup> to define a joint panel of 14 single-TF and 8 multiple-TF knockouts and its downstream cell type depletion effects as a notion of ground truth. Next, we evaluated model performance by simulating single or multiple TF knockouts to compute the Spearman correlation between the predicted depletion score and the experimental derived depletion likelihood and compared it to dynamo<sup><xref ref-type="bibr" rid="R22">22</xref></sup> and CellOracle<sup><xref ref-type="bibr" rid="R25">25</xref></sup> that employ either only dynamic modeling or GRN inference (<xref ref-type="sec" rid="S12">Methods</xref>). For the single-TF knockout scenario, RegVelo predictions resulted in a nearly 2-fold improvement (mean Spearman correlation of 0.35) over the other two methods (Spearman correlation &lt; 0.17; <xref ref-type="fig" rid="F4">Figure 4i</xref>), and we observed a similar trend for the multiple-TF knockout experiment (average Spearman correlation of 0.60 vs. 0.22; <xref ref-type="fig" rid="F4">Figure 4i</xref>).</p><p id="P38">Overall, having established that RegVelo correctly and robustly infers the dynamic cellular change of known zebrafish neural crest development, we sought to employ our framework to identify novel regulatory relationships driving this embryonic developmental process.</p></sec><sec id="S9"><title>tfec regulates pigment cell development as an early driver</title><p id="P39">Previous studies have established the differentiation programs of pigment progenitor cells into iridophores, melanophores, and xanthophores at later developmental stages<sup><xref ref-type="bibr" rid="R95">95</xref>,<xref ref-type="bibr" rid="R96">96</xref></sup>. However, the initial specification of the pigment lineage within the migratory neural crest remains unresolved. We, thus, turned to the trained neural crest RegVelo model to identify putative drivers and found <italic>bhlhe40, tfec</italic>, and <italic>mitfa</italic><sup><xref ref-type="bibr" rid="R97">97</xref></sup> ranked as the top three genes (<xref ref-type="fig" rid="F5">Figure 5a</xref>), and the known pigment lineage<sup><xref ref-type="bibr" rid="R98">98</xref></sup> markers <italic>cdkn1ca</italic> and <italic>atp6ap2</italic> among the top positively regulated targets of tfec (<xref ref-type="fig" rid="F5">Figure 5b,c</xref>). Additionally, other target genes of the tfec regulon, such as <italic>lrmda</italic> and <italic>psen2</italic>, were enriched in pathways of melanocyte differentiation (adjusted <italic>P</italic> = 0.004; <xref ref-type="fig" rid="F5">Figure 5c</xref>). We, thus, hypothesized that the tfec transcription factor contributes to early pigment cell fate priming and turned to orthogonal computational and experimental approaches for validation.</p><p id="P40">Single-cell transcriptomic analysis of both our Smart-seq3 dataset and a published multiome dataset<sup><xref ref-type="bibr" rid="R82">82</xref></sup> identified <italic>tfec</italic> as the earliest expressed basic helix-loop-helix (bHLH) TF, preceding the precursor driver <italic>mitfa</italic> and others such as <italic>tfeb</italic> and <italic>bhlhe40</italic> (<xref ref-type="fig" rid="F5">Figure 5d,e</xref>). Targets of tfec in RegVelo’s GRN and targets of the known pigment lineage drivers mitfa, tfeb, and bhlhe40 largely overlapped, implying redundant functions of drivers in pigment lineage specification (<xref ref-type="fig" rid="F5">Figure 5f</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9a</xref>). Additionally, our Perturb-seq experiment showed profound depletion effects for <italic>tfec</italic> knockouts compared to <italic>mitfa</italic> in both early and late pigment lineages (two-sided paired Wilcoxon test, <italic>P</italic> &lt; 1 × 10<sup>−12</sup>; <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9b</xref>). In fact, only the simultaneous knockout of <italic>mitfa, tfec</italic>, and <italic>tfeb</italic> produced a significant phenotype of pigment depletion in 2-days-post-fertilization embryos compared to the single-gene knockouts<sup><xref ref-type="bibr" rid="R99">99</xref></sup> (<xref ref-type="fig" rid="F5">Figure 5g</xref>). We performed two experiments with no phenotype (pigmented), weak phenotype (some pigmentation), and strong phenotype (no pigmentation) embryos. Experiment 1 (experiment 2) included 35 (44) control and 0 (0) knockout embryos without a phenotype, 1 (4) control and 4 (17) knockout embryos with weak phenotype, and 0 (0) control and 43 (28) knockout embryos with a strong phenotype (Chi-square test of independence, <italic>P</italic> &lt; 1 × 10<sup>−10</sup> (experiment 1) and <italic>P</italic> &lt; 1 × 10<sup>−10</sup> (experiment 2)).</p><p id="P41">To understand the regulatory relationships of our newly identified pigment lineage driver, tfec, we investigated its upstream regulators by leveraging the multiome-ATAC data<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. We used the base-resolution contribution scores derived from the convolutional neural network models<sup><xref ref-type="bibr" rid="R82">82</xref></sup> trained and interpreted by ChromBPNet<sup><xref ref-type="bibr" rid="R100">100</xref></sup> which indicated the putative TF binding instances (<xref ref-type="sec" rid="S12">Methods</xref>). The master regulator of NC development, Sox10, is essential for pigment lineage specification<sup><xref ref-type="bibr" rid="R85">85</xref></sup> - a fact that we accurately rediscovered through our RegVelo predictions (<xref ref-type="fig" rid="F5">Figure 5a</xref>). Our ChromBPNet-based analysis identified Sox10 binding sites in the upstream <italic>cis-</italic>regulatory element of <italic>tfec</italic> and, this, further supported this fact (<xref ref-type="fig" rid="F5">Figure 5h</xref>).</p><p id="P42">Overall, our experimental validations and orthogonal computational approaches support RegVelo’s prediction that <italic>tfec</italic> acts downstream of sox10 and implies that tfec specifies the fate of pigment cell lineages ahead of other pigment specification TFs from the bHLH family, such as mitfa, tfeb, and bhlhe40.</p></sec><sec id="S10"><title>RegVelo identifies an early pigment lineage driver, elf1, together with its regulatory context</title><p id="P43">In addition to traditionally recognized bHLH factors, RegVelo ranked elf1, a TF from the erythroblast transformation specific (ETS) family, among the top ten putative regulators of pigment fate decisions (<xref ref-type="fig" rid="F5">Figure 5a</xref> and <xref ref-type="fig" rid="F6">Figure 6a,b</xref>). We again relied on our in vivo Perturb-seq data as well as whole-mount mRNA in situ hybridization by hybrid chain reactions (HCR)<sup><xref ref-type="bibr" rid="R101">101</xref></sup> to verify this predicted association. Indeed, the Perturb-seq analysis revealed a significant depletion effect in the pigment lineage upon <italic>elf1</italic> knockout (<xref ref-type="fig" rid="F6">Figure 6b</xref>), and HCR showed decreased pigment cells in <italic>elf1-</italic>knockout embryos in both cranial and post-otic regions, verifying <italic>elf1</italic> functioning in pigment lineage specification at all axial levels (<xref ref-type="fig" rid="F6">Figure 6c</xref>). Moreover, <italic>elf1</italic> knockouts were enriched for mesenchymal fates (facial mesenchyme, the first and second pharyngeal arches), accompanied by downregulation of <italic>mitfa</italic> and <italic>sox10</italic>, suggesting that elf1 represses the migratory states and mesenchymal fates (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9c</xref>).</p><p id="P44">To decipher the regulatory mechanism of elf1, we investigated its downstream targets, next. By integrating chromatin accessibility profiles and ChromBPNet’s contribution scores, we identified the ETS TF binding sites upstream of <italic>fli1a</italic><sup><xref ref-type="bibr" rid="R82">82</xref></sup>, <italic>pmp22a</italic><sup><xref ref-type="bibr" rid="R102">102</xref></sup>, <italic>arl6ip1</italic><sup><xref ref-type="bibr" rid="R103">103</xref></sup>, <italic>hmgn2</italic><sup><xref ref-type="bibr" rid="R104">104</xref></sup>, and the novel pigment lineage marker <italic>cited1</italic> (<xref ref-type="fig" rid="F6">Figure 6d,e</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9d,e</xref>). Based on the Perturb-seq data, we confirmed through differential expression analysis that the target genes <italic>pmp22a</italic> and <italic>cited1</italic> were significantly differentially expressed in the <italic>elf1</italic>-knockout pigment lineage, while the <italic>fli1a</italic> expression was upregulated in <italic>elf1-</italic>knockout neural crest and derivative cells, suggesting a compensatory mechanism (adjusted <italic>P</italic> &lt; 0.002; <xref ref-type="fig" rid="F6">Figure 6e,f</xref>). This indicated these genes as direct candidate targets downstream of elf1. We further screened generic circuits with RegVelo using in silico knockouts to assess the effect of perturbing downstream regulatory connections of elf1 on pigment differentiation. This screening identified <italic>fli1a</italic> and <italic>pmp22a</italic> downstream of <italic>elf1</italic> as top perturbed factors, revealing potential regulatory mechanisms linking <italic>elf1</italic> to downstream pathways of neural crest migration (<xref ref-type="fig" rid="F6">Figure 6g</xref>).</p><p id="P45">Finally, we sought to identify the core subnetwork of pigment fate priming (<xref ref-type="fig" rid="F6">Figure 6h</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9a</xref>): comparing the expression of targets ordered by RegVelo’s latent time revealed a clear bifurcation between pigment and mesenchymal fate with elf1 targets upregulated in the pigment lineage, and pro-mesenchymal ETS TFs upregulated correctly in the mesenchymal lineage<sup><xref ref-type="bibr" rid="R82">82</xref></sup> (<xref ref-type="fig" rid="F6">Figure 6h</xref>), again implying elf1’s active role in fate decision towards pigment cells. To further establish regulatory relationships of <italic>elf1</italic>, we identified putative TF binding sites of mitfa and tfec present in <italic>elf1</italic>’s enhancer regions (<xref ref-type="fig" rid="F6">Figure 6i</xref>) and found that <italic>elf1</italic> expression was downregulated in tfec knockouts (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9f</xref>). Upstream <italic>cis</italic>-regulatory elements of both <italic>elf1</italic> and <italic>fli1a</italic> included ETS factor binding sites, and the <italic>fli1a</italic> knockouts resulted in the upregulation of <italic>elf1</italic> (<xref ref-type="fig" rid="F6">Figure 6d,i</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 9g</xref>).</p><p id="P46">Based on these findings, we have identified a core module within RegVelo’s complex GRN, represented as the following subnetwork: the early pigment driver tfec activates the pro-pigment TF <italic>elf1</italic>, and elf1 and pro-mesenchymal ETS TFs suppress each other to drive the neural crest cell fate bifurcation into pigment and mesenchymal fates, following a toggle switch model<sup><xref ref-type="bibr" rid="R105">105</xref></sup>.</p></sec></sec><sec id="S11" sec-type="discussion"><title>Discussion</title><p id="P47">We have presented RegVelo, a novel variational inference framework for learning RNA velocity as well as the underlying regulatory network jointly from single-cell gene expression data. The step from decoupled single gene models to a fully integrated dynamic model by explicitly incorporating gene regulation makes our method compare favorably to previous methods on dynamic inferences; we found significant improvements on simulated and real datasets in terms of velocity estimation, latent time compared to velocity models, and GRN inference compared to static network inference approaches. Notably, the forward simulation based on our learned gene regulatory dynamics provides a simple virtual cell<sup><xref ref-type="bibr" rid="R106">106</xref></sup><italic>-</italic>style downstream analysis to decipher regulatory mechanisms in cell fate decision behavior.</p><p id="P48">In particular, we recovered murine differentiation trajectories and regulatory mechanisms during pancreatic endocrinogenesis: for the ductal cell cycling process, we accurately predicted drivers and their regulatory effects, and faithfully described lineage conformations by in silico simulation. We also showcased dynamic inference on a human hematopoiesis dataset where previous RNA velocity methods failed or performed worse even with access to more rich information like metabolic labels, recovered the toggle-switch network motif between GATA1 and SPI1 (PU.1), and illustrated, using RegVelo’s perturbation scheme, how these genes relate to the erythroid and monocyte-fate decisions.</p><p id="P49">While most ETS factors have pro-mesenchymal bias in zebrafish cranial neural crest<sup><xref ref-type="bibr" rid="R82">82</xref></sup>, RegVelo led us to report elf1 as an exception that terminates migration and promotes pigment fates. Our finding is consistent with the DNA-binding anti-cooperativity of ELF1 caused by an electrostatic repulsion mechanism, in contrast to FLI1 and ETS1<sup><xref ref-type="bibr" rid="R107">107</xref></sup>. Moreover, our finding also aligns with the classic theory of cell fate decisions that two transcriptional programs compete to drive bifurcation events<sup><xref ref-type="bibr" rid="R108">108</xref></sup>. In the zebrafish system, we speculate that the ETS family TF Elf1 directly and competitively binds the same TF binding site of other ETS factors and, thus, can take a contradictory role against these other factors, supporting the bifurcation mechanism at the regulatory level. Our newly found driver for the pigment lineage, elf1, has also been reported as the intermediate-state marker in melanoma<sup><xref ref-type="bibr" rid="R109">109</xref></sup>, where the tumor cell states intermediate or neural crest-like, mesenchyme-like, and melanoblast-like were reported to mirror normal cell states in the neural crest cellular trajectories<sup><xref ref-type="bibr" rid="R110">110</xref></sup>. Future studies can investigate whether elf1 is involved in a shared regulatory circuitry between neural crest fate decisions and melanoma. Overall, our systematic in silico and in vivo TF knockout datasets serve as valuable resources for studying cranial neural crest development and relevant disease, as well as for benchmarking the accuracy of knockout simulation algorithms.</p><p id="P50">As an end-to-end dynamic, interpretable, and actionable model, RegVelo distinguishes itself from other studies that focus on interpreting cell dynamics through gene regulation and often require nonlinear models like support vector machines or variational autoencoders to predict RNA velocity from the transcriptome<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R111">111</xref>,<xref ref-type="bibr" rid="R112">112</xref></sup>. RegVelo offers significant advantages over these methods in three aspects: (1) These approaches depend on predefined cellular velocity estimates<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R111">111</xref>,<xref ref-type="bibr" rid="R112">112</xref></sup> from models ignoring regulatory events<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref></sup>. In contrast, RegVelo simultaneously learns gene regulation and cellular velocity. (2) RegVelo integrates prior knowledge about GRN structure learned from various modalities, such as chromatin accessibility, by incorporating gene regulation into velocity estimation. (3) Previous models for estimating splicing dynamics predict perturbation effects by manually activating or suppressing gene expression<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R111">111</xref></sup>, where the output represents the immediate perturbed direction of each cell. Importantly, classical RNA velocity approaches study completely decoupled systems, thereby ignoring gene-gene dependencies, and, thus, they cannot predict perturbation effects. RegVelo, however, encodes perturbation by directly changing the underlying regulatory circuits and simulating gene expression dynamics under the perturbed regulatory system. This forward simulation allows for the prediction of nonlinear perturbation effects over latent time rather than focusing only on the immediate first-order direction, which misses long-term consequences. We demonstrated RegVelo’s ability to predict such long-term effects of regulators by successfully recovering early-expressed lineage drivers in zebrafish neural crest cell development. Notably, we used in vivo perturbation experiments to validate the TF perturbation effect prediction across four lineages. Our results demonstrated a significant improvement over existing dynamics-based perturbation prediction methods and our GRN-infused hybrid model holds promise to be more robust on out-of-distribution data than purely data-based generative models<sup><xref ref-type="bibr" rid="R113">113</xref></sup>.</p><p id="P51">RegVelo stands as the first model to extend the currently employed RNA velocity model from a pure de novo discovery tool for trajectory inference into a simulator for gene regulatory dynamics but leaves room for future extensions. The deep integration between RegVelo and CellRank offers a causal mechanism linking gene regulation and changes to cell fate decisions, as opposed to a merely correlation-based approach. Meanwhile, as an extension of veloVI, introducing prior information on gene regulation and model regularization, RegVelo leads to better identifiability on several downstream statistics compared to veloVI. However, in a more general modeling scenario, in particular in complex or understudied systems, proper accurate prior information on gene regulation is unfeasible as a rich literature background is lacking or epigenetic information for scATAC-seq, for example, is sparse or does not exist. As shown, RegVelo can mitigate the effect of a poor prior, but we anticipate that incorporating additional types of prior information, such as pseudotime, real time, or the number of lineages, regularizes the model and thereby improves the inference of gene regulatory dynamics further. While this incorporation may contravene its inherent characteristics as an unsupervised trajectory inference tool, RegVelo also serves as a simulator of transcriptional regulation, providing insights into gene regulation and cell fate priming that are far more valuable than merely recapitulating the overall trajectory.</p><p id="P52">Recent experimental advances have enabled the measurement of various modalities. Built upon veloVI, RegVelo is a flexible model that can easily generalize to additional modalities to overcome current limitations in model formulation and assumptions. For example, incorporating metabolic labeling data or in vivo time-resolved scRNA-seq data like Zman-seq<sup><xref ref-type="bibr" rid="R114">114</xref></sup> enables the development of new differential equations to describe transcriptional regulation and infer cell-specific kinetic rates, such as degradation<sup><xref ref-type="bibr" rid="R22">22</xref></sup>. Similarly, cross-linking immunoprecipitation (CLIP) and Deamination Adjacent to RNA modification Target (DART) sequencing may allow for estimating cell-specifc splicing rates. The two protocols have provided insights into RNA binding protein (RBP)-RNA interactions at the single-molecule level<sup><xref ref-type="bibr" rid="R115">115</xref>,<xref ref-type="bibr" rid="R116">116</xref></sup> and combining such post-translational gene-gene interactions can improve the regulatory modeling among different molecules. Moreover, while RegVelo models transcription in a context-specific manner, we and other existing frameworks typically assume that gene expression depends on the abundance of upstream RNA regulators rather than protein levels - integrating ribosome profiling data enables modeling the translation process and quantifying the protein activity of regulators which enables a more nuanced estimation of transcription rates for target genes<sup><xref ref-type="bibr" rid="R117">117</xref></sup>. Finally, extending the biophysical model of splicing kinetics beyond mRNA toward chromatin and protein dynamics will lead to a more complete and accurate description of the underlying process. How to correctly incorporate these alternative views is unclear or not yet possible, though, as the data types differ from transcriptomic count data, and shared measurements in the same cell do not yet exist.</p><p id="P53">Overall, RegVelo innovates transcriptome-wide dynamic modeling from pure trajectory inference to uncovering causal mechanisms involved during cell fate decisions. With this flexible model as a prototype, we expect future extensions by incorporating additional regulatory layers at different molecular levels, ultimately moving towards a more comprehensive and interpretable model capable of simulating and predicting cell behavior and responses even more accurately.</p></sec><sec id="S12" sec-type="methods"><title>Methods</title><sec id="S13"><title>RegVelo model specification</title><p id="P54">Approaches for inferring RNA velocity models describe splicing dynamics through biophysical models like systems of ordinary differential equations (ODEs)<sup><xref ref-type="bibr" rid="R118">118</xref></sup>. Such models describe the transcription of precursor (unspliced) RNA <italic>u</italic> at rate <italic>α</italic>, followed by splicing into mature (spliced) mRNA <italic>s</italic> with rate <italic>β</italic>; spliced mRNA degrades at a rate <italic>γ</italic>, manifesting in the first-order approximation of a chemical master equation for gene <italic>g</italic> as
<disp-formula id="FD3"><label>(1)</label><mml:math id="M3"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the indicator function and <italic>t</italic><sub><italic>s</italic></sub> is a switch time. Throughout this work, we assume <italic>N</italic><sub>C</sub> cells and <italic>N</italic><sub>C</sub> genes.</p><p id="P55">Previously, we have devised two different parameter inference schemes based on either Expectation-Maximization (EM)<sup><xref ref-type="bibr" rid="R13">13</xref></sup> or variational inference (VI)<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. In these frameworks, we assumed gene transcription during an induction phase (<italic>t</italic> &lt; <italic>t</italic><sub><italic>s</italic></sub>), followed by a repression phase (<italic>t</italic> &lt; <italic>t</italic><sub><italic>s</italic></sub>). Although this dynamical modeling paradigm has enabled the recovery of novel biological insight<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, both models neglect gene-gene dependencies and assume a piecewise constant transcription rate for each gene, thereby overlooking the dynamic changes in the transcription rate itself. Biological systems fulfill these assumptions only approximately<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R119">119</xref></sup>, however, and exhibit more complex dynamics<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>, instead.</p><p id="P56">Upstream regulators govern gene transcription, a process neglected so far. To include these non-linear dynamics in our model of transcriptional dynamics, we define gene- and cell-specific transcription rates <italic>α</italic><sub><italic>gn</italic></sub> that we parametrize with a neural network <italic>α</italic>. In this setup, we assume that mature mRNA of upstream regulators and a gene-specific base transcription rate describe the transcription rate via
<disp-formula id="FD4"><label>(2)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>h</italic> is a nonlinear activation function, <inline-formula><mml:math id="M6"><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the <italic>n</italic>-th sample, and <italic>b</italic><sub><italic>g</italic></sub> ∈ ℝ and <inline-formula><mml:math id="M7"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the base transcription rate and gene regulatory network (GRN) weight matrix, respectively.</p><p id="P57">The GRN weight matrix represents gene regulation, informed by a prior gene regulation graph <italic>G</italic>, curated from public datasets like cistrome<sup><xref ref-type="bibr" rid="R34">34</xref></sup> or learned from single-cell, bulk epigenetic, or multiome sequencing data through GRN inference methods<sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>. We represent the prior regulation graph <italic>G</italic> as a binary, skeleton matrix that encodes the interactions between transcripton factors (TFs) and target genes and provide two strategies for learning GRN structures from these priors: hard and soft constrained inference. In the case of hard constraints, <italic>G</italic> restricts the non-zero entries of the weight matrix <italic>W</italic> to edges present in the prior graph, <italic>i.e</italic>.,
<disp-formula id="FD5"><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo> </mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>ω</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo> </mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext>otherwise</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="P58">Conversely, for soft constraints, we allow learning new connections regularized by the prior graph <italic>G</italic> with
<disp-formula id="FD6"><label>(3)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mtext>prior </mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>;</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>‖</mml:mo><mml:mi>W</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>‖</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
to favor TF-target connections present in the prior; ⊙ denotes the Hadamard product, <italic>i.e</italic>., element-wise product operation. The soft constraint, thus, allows for correcting missing links in the prior gene regulation graph.</p><p id="P59">In a realistic biological system, cells often undergo several internal orthogonal processes simultaneously like cell cycle versus differentiation, for example. In such cases, using a single latent time and a deterministic ODE system fails to model these biological processes jointly. Additionally, determining the number of biological processes and modeling them requires some prior information. Thus, similar to scVelo<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, we estimate gene-specific latent times <italic>t</italic><sub><italic>g</italic></sub> and aim to identify a unique latent time axis for each gene, combined with a global regulatory function to best describe the observed data.</p><p id="P60">The velocity function, defined by (1) and (2), governs cell state evolution, inducing a continuous vector field <inline-formula><mml:math id="M10"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Given an initial condition (<italic>u</italic><sub>0</sub>, <italic>s</italic><sub>0</sub>), we simulate dynamics along each gene-specific latent time axis to estimate the integrated value for each gene and each cell as
<disp-formula id="FD7"><label>(4)</label><mml:math id="M11"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p><p id="P61">We simulate these state solutions for each gene efficiently through a parallelized numerical integration solver dopri5 implemented in the <italic>torchode</italic><sup><xref ref-type="bibr" rid="R37">37</xref></sup> Python package.</p></sec><sec id="S14"><title>Model assumptions</title><p id="P62">We assume multiple time axes, representing different biological processes, but time-independent regulatory principles, <italic>i.e</italic>., a constant GRN weight matrix <italic>W</italic> - a modeling choice that allows us to couple multiple gene dynamics. Similar to scVelo<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, we assume an initial gene expression of <italic>u</italic>(<italic>t</italic><sub>0</sub>) = <italic>s</italic>(<italic>t</italic><sub>0</sub>) = 0 at <italic>t</italic><sub>0</sub> = 0 and that each gene is on the same time scale. Here, we follow scVelo and veloVI and set <italic>t</italic><sub>max</sub> = 20. Lastly, we define the nonlinear activation function <italic>h</italic> in (2) as the softplus function
<disp-formula id="FD8"><mml:math id="M12"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
thus assuming that TFs predict the transcription rate of target genes based on additive effects.</p></sec><sec id="S15"><title>RegVelo generative process</title><p id="P63">As described above, we assume each gene has a specific latent time. We have already established in recent work that the inferred, gene-specific latent times have a low-rank structure, implying that we can generate the latent time matrix from multiple independent components that control cell dynamics<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. Therefore, our model does not only couple genes through a shared regulatory principle encoded by <italic>W</italic> but also, like veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, ties the gene-specific latent time via a local low-dimensional latent variable.</p><p id="P64">For each cell, we draw a low-dimensional latent variable <italic>z</italic> from an isotropic Gaussian, <italic>i.e</italic>.,
<disp-formula id="FD9"><mml:math id="M13"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>I</italic><sub><italic>d</italic></sub> denotes the <italic>d</italic>-dimensional identity matrix. Here, we use <italic>d</italic> =10 dimensions throughout this study. We define the gene-specific latent time as a function of this latent variable defined by
<disp-formula id="FD10"><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
with <inline-formula><mml:math id="M15"><mml:mrow><mml:mi>T</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> parametrized by a fully connected neural network. Utilizing the time information, we derive the state solution for each cell and gene through (4). Finally, we assume that the conditional normal distributions parametrized by <italic>θ</italic>
<disp-formula id="FD11"><mml:math id="M16"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mi>u</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
generates the observed data. Here, <italic>θ</italic> includes transcriptional regulation (<italic>W</italic>, <italic>b</italic>), kinetic parameters (<italic>β, γ</italic>), and neural network parameters.</p><p id="P65">Like veloVI, we consider the observed data {(<italic>s</italic><sup>(<italic>n</italic>)</sup>, <italic>u</italic><sup>(<italic>n</italic>)</sup>) |<italic>n</italic> ∈ {1,…,<italic>N</italic><sub><italic>C</italic></sub>}} as nearest-neighbor smoothed expression data, which is also used as input for scVelo. RegVelo, like veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, assumes that the smoothed spliced and unspliced abundances have been min-max scaled to the unit interval [0,1], independently for each gene. We also assume that the smoothed expression, representing an average of random variables, follows a sampling distribution centered on a mean value and is approximately normal.</p></sec><sec id="S16"><title>RegVelo inference</title><p id="P66">RegVelo aims to estimate the following parameters: (1) point estimates of kinetic parameters, including gene regulation weights summarized in the GRN matrix, base transcription, degradation, and splicing rate constants; (2) point estimates of the parameters of all neural networks; (3) a posterior distribution over the latent variable <italic>z</italic>, to model the underlying dynamic process. We use variational inference to approximate the posterior distribution and estimate all other parameters by maximizing the evidence lower bound (ELBO)<sup><xref ref-type="bibr" rid="R38">38</xref></sup>. Consequently, we model RNA velocity probabilistically by calculating it as a function of the variational posterior distribution of latent variables.</p></sec><sec id="S17"><title>Variational posterior</title><p id="P67">We introduce the variational distribution <italic>q<sub>ϕ</sub></italic> parametrized by a neural network with parameter set <italic>ϕ</italic> to approximate the evidence function log <italic>p<sub>θ</sub></italic>(<italic>u</italic>,<italic>s</italic>)
<disp-formula id="FD12"><label>(5)</label><mml:math id="M17"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mtext>ELBO</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>KL</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
by maximizing the ELBO. We assume independent samples, allowing us to factorize the distribution <italic>q<sub>ϕ</sub></italic>(<italic>z</italic> | <italic>u</italic>,<italic>s</italic>) and <italic>p</italic><sub>θ ;</sub>(<italic>u</italic>,<italic>s</italic> |<italic>z</italic>) as
<disp-formula id="FD13"><mml:math id="M18"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></sec><sec id="S18"><title>Dynamics regularization</title><p id="P68">RegVelo solves the dynamics through a numerical integrator, as the kinetic process is too complex to solve analytically. Avoiding poorly conditioned dynamics improves the accuracy of numerical integration<sup><xref ref-type="bibr" rid="R120">120</xref></sup>. Therefore, we add penalties on the regularity of the velocity function <inline-formula><mml:math id="M19"><mml:mrow><mml:mi>F</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to ensure smoothness.</p><p id="P69">Here, we define the regularity as the total derivative of the velocity function <italic>F</italic> with respect to time,<italic>i.e</italic>.,
<disp-formula id="FD14"><mml:math id="M20"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
using the chain rule and with <italic>x</italic> = (<italic>u</italic>,<italic>s</italic>) and the Jacobian matrix <italic>J</italic> (<italic>x</italic>). To simplify the dynamics, we regularize the Jacobian matrix and velocity field to encourage small values: we use L2 regularization to penalize large entries of velocity entries, promoting a more regular vector field, and L1 regularization to penalize large entries in the Jacobian matrix to foster sparse gene regulation. Therefore, we define the regularization terms
<disp-formula id="FD15"><label>(6)</label><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>Jacobian </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mo>∥</mml:mo></mml:mstyle><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>sigmoid</mml:mtext><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:msub><mml:mo>∥</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD16"><label>(7)</label><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>velocity </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>‖</mml:mo><mml:mo> </mml:mo><mml:mtext>softplus</mml:mtext><mml:mo> </mml:mo><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mo>‖</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where, diag and sigmoid denote the operator to convert a vector into a diagonal matrix and the sigmoid activation function, respectively, and º the operator to apply a scalar function component-wise. As the complexity of gene dynamics in our model stems primarily from gene regulation, we only regularize the Jacobian matrix and the unspliced RNA velocity to focus on aspects directly influenced by regulation.</p><p id="P70">Further, assuming that upstream regulators govern each gene transcription fully, we penalize large values of base transcription <italic>b</italic> with
<disp-formula id="FD17"><label>(8)</label><mml:math id="M23"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>base</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
to keep the transcription rate near zero when upstream regulation effects diminish, <italic>i.e</italic>., <italic>W</italic><sub><italic>s</italic></sub> = 0. We fixed <italic>b</italic>* <italic>=</italic> 10 in this model. Finally, we define the dynamic regularization loss function as the sum of <italic>L</italic><sub>Jacobian</sub>, <italic>L</italic><sub>velocity</sub> and <italic>L</italic><sub>base</sub>.</p></sec><sec id="S19"><title>RegVelo’s objective function</title><p id="P71">Combining (3), (5), (6), (7) and (8), our objective includes the three parts
<disp-formula id="FD18"><mml:math id="M24"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>ELBO</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="6em"/><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mtext>prior</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>;</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>prior</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>regularization</mml:mtext></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="6em"/><mml:mo>+</mml:mo><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>Jacobian</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>velocity</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>base</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>dynamics</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>regularization</mml:mtext></mml:mrow></mml:munder><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
with tunable hyperparameters λ<sub>1</sub> and λ<sub>2</sub>: λ<sub>1</sub> controls the strengths of adding prior knowledge and λ<sub>2</sub> governs the strengths of the L1 regularization of the Jacobian; increasing λ<sub>2</sub> promotes greater sparsity in the learned GRN. By default, we set λ<sub>1</sub> = 1 and λ<sub>2</sub> = 0.</p></sec><sec id="S20"><title>Network architecture and optimization</title><p id="P72">All neural networks are fully connected feedforward networks, with ReLU activation functions for hidden layers and softplus-transformations of the last layer to enforce non-negative kinetic parameters. We initialize the weight matrix <italic>W</italic> as a zero matrix, kinetic parameters, including splicing and degradation rates, as a constant values, and base transcription <italic>b</italic> and all neural network parameters through the default implementation in PyTorch (<monospace>torch.nn.init.xavier_uniform_</monospace>); following veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, we initialize a unit splicing rate and estimate degradation based on a steady-state assumption. We use stochastic gradients along with the AdamW optimizer<sup><xref ref-type="bibr" rid="R121">121</xref></sup> to optimize the loss function.</p></sec></sec><sec id="S21"><title>Downstream tasks</title><sec id="S22"><title>Fitted abundance value</title><p id="P73">Let <italic>u</italic>* (<italic>n</italic>) and <italic>s</italic>* (<italic>n</italic>) be the random variable representing posterior predicted abundance values for unspliced and spliced RNA in cell <italic>n</italic>, respectively. We denote their posterior distribution by <italic>p</italic>(<italic>u</italic>*(<italic>n</italic>) | <italic>u</italic><sup>(<italic>n</italic>)</sup>, <italic>s</italic><sup>(<italic>n</italic>)</sup> and <italic>p</italic>(<italic>s</italic>*(<italic>n</italic>) | <italic>u</italic><sup>(<italic>n</italic>)</sup>, <italic>s</italic><sup>(<italic>n</italic>)</sup> and define as
<disp-formula id="FD19"><mml:math id="M25"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>z</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>z</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p><p id="P74">The fitted values for unspliced and spliced abundances are the means of these posterior distributions, <italic>i.e</italic>., <inline-formula><mml:math id="M26"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M27"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. We estimate the mean value by sampling from the posterior distribution and taking the average.</p></sec><sec id="S23"><title>Gene-wise latent time</title><p id="P75">We compute latent time for each gene and cell as <inline-formula><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and estimate the expectation value by Monte Carlo sampling<sup><xref ref-type="bibr" rid="R122">122</xref></sup>, where we sample from the posterior distribution of <italic>z</italic><sup>(<italic>n</italic>)</sup> before calculating the average value of <italic>T</italic>(<italic>z</italic><sup>(<italic>n</italic>)</sup>)<italic>g</italic>.</p></sec><sec id="S24"><title>RNA velocity</title><p id="P76">We define the velocity of a specific gene in a particular cell as the function depending on the latent variable <italic>z</italic><sup>(<italic>n</italic>)</sup>. To sample the velocity from the latent posterior distribution, we
<list list-type="order" id="L1"><list-item><p id="P77">Sample <italic>z</italic><sup>(<italic>n</italic>)</sup> from <italic>q<sub>ϕ</sub></italic> (<italic>z</italic><sup>(<italic>n</italic>)</sup> | <italic>u</italic><sup>(<italic>n</italic>)</sup>, <italic>z</italic><sup>(<italic>n</italic>)</sup>),</p></list-item><list-item><p id="P78">Calculate the latent time <italic>t</italic><sub><italic>ng</italic></sub> <italic>=T(z</italic><sup>(<italic>n</italic>)</sup>)<italic>g</italic>,</p></list-item><list-item><p id="P79">Compute velocity in gene <italic>g</italic> and cell <italic>n</italic> using
<disp-formula id="FD20"><mml:math id="M29"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
</p></list-item></list></p><p id="P80">These steps provide velocity samples from the posterior predictive velocity distribution.</p></sec><sec id="S25"><title>Velocity uncertainty estimation</title><p id="P81">As a variational inference-based model, veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup> defines an intrinsic uncertainty method to quantify uncertainty in each cell through sampling velocity vectors from the posterior distribution and calculate the variance of the cosine similarity of the samples; as an extension of veloVI, RegVelo follows the same approach.</p></sec><sec id="S26"><title>Representing the underlying GRN</title><p id="P82">The gene regulation function (2) describes the regulation of unspliced RNA abundance of upstream regulators. We approximate the gene regulation function in the neighborhood of a specific <italic>s</italic><sub><italic>n</italic></sub> by first-order Taylor expansion
<disp-formula id="FD21"><mml:math id="M30"><mml:mrow><mml:mo> </mml:mo><mml:mtext>softplus</mml:mtext><mml:mo> </mml:mo><mml:mo>∘</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mtext>softplus</mml:mtext><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>sigmoid</mml:mtext><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P83">The coefficient of the first-order term denotes the strength of linear regulation. We define the GRN for cell <italic>n</italic> as
<disp-formula id="FD22"><mml:math id="M31"><mml:mrow><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>sigmoid</mml:mtext><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P84">To define cell type-specific GRNs, let 𝒮(<italic>c</italic>) denote the set of cells of type <italic>c</italic>
<disp-formula id="FD23"><mml:math id="M32"><mml:mrow><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>sigmoid</mml:mtext><mml:mo>∘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p></sec><sec id="S27"><title>Simulation of perturbation effects</title><p id="P85">RegVelo generates cell dynamics based on gene regulation. By modifying the learned GRN in a trained RegVelo model, we simulate the in silico perturbed dynamics. Assuming we want to perturb the function of the TF <italic>l</italic> in a system, we mask the corresponding column of the weight matrix to generate a perturbed weight matrix
<disp-formula id="FD24"><mml:math id="M33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext> if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="P86">The perturbed weight matrix defines a new velocity function for numerical integration and induces a perturbed velocity υ*. We systematically compare the perturbed velocity with the original fitted velocity υ using the following metrics:</p></sec><sec id="S28"><title>Local perturbation effects</title><p id="P87">We define the perturbation effects on each cell by computing the cosine dissimilarity
<disp-formula id="FD25"><mml:math id="M34"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p></sec><sec id="S29"><title>Cell fate perturbation effects</title><p id="P88">We quantify the perturbation effects on cell fate decisions by passing the different velocity estimates to the typical CellRank<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> workflow: using the VelocityKernel in CellRank<sup><xref ref-type="bibr" rid="R15">15</xref></sup> and assuming <italic>m</italic> terminal states, we define the original cell fate probability matrix <inline-formula><mml:math id="M35"><mml:mrow><mml:mtext>Π</mml:mtext><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and perturbed probability matrix <inline-formula><mml:math id="M36"><mml:mrow><mml:msup><mml:mtext>Π</mml:mtext><mml:mo>∗</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where each row represents a cell, and each column represents a terminal state. We can formulate the cell fate perturbation effects for the <italic>k</italic>-th terminal state as the <italic>t</italic>-test statistics
<disp-formula id="FD26"><mml:math id="M37"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Π</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Π</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mfrac><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
with sample means of fate probabilities toward the <italic>k</italic>-th terminal state <inline-formula><mml:math id="M38"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Π</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M39"><mml:mrow><mml:mover accent="true"><mml:mi>Π</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:msub><mml:mo>.</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the pooled variance <italic>S</italic><sup><xref ref-type="bibr" rid="R2">2</xref></sup> of the cell fate probabilities. To further quantify the depletion likelihood of each TF to the terminal state <italic>k</italic>, we used the normalized Mann-Whitney <italic>U</italic> statistic
<disp-formula id="FD27"><mml:math id="M40"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mtext>d</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munderover></mml:mstyle></mml:mrow></mml:mstyle><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>Π</mml:mtext><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mtext>Π</mml:mtext><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where 𝕀 (Π(<italic>n</italic>) &gt; Π*(<italic>n</italic>*)) denotes the indicator function
<disp-formula id="FD28"><mml:math id="M41"><mml:mrow><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Π</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msup><mml:mtext>Π</mml:mtext><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="2em"/><mml:mtext>if</mml:mtext><mml:mspace width="2em"/><mml:mtext>Π</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msup><mml:mtext>Π</mml:mtext><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="2em"/><mml:mtext>if</mml:mtext><mml:mspace width="2em"/><mml:mtext>Π</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:msup><mml:mtext>Π</mml:mtext><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="P89">This statistic quantifies the probability that, in the predicted perturbation case, the cells will have lower cell fate probabilities toward the terminal state <italic>k</italic> than in the original unperturbed case. To intuitively compare the perturbation effect across lineages, we define the depletion score Δ<sub>d</sub> by rescaling the depletion likelihood
<disp-formula id="FD29"><mml:math id="M42"><mml:mrow><mml:msub><mml:mtext>Δ</mml:mtext><mml:mtext>d</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mtext>d</mml:mtext></mml:msub></mml:mrow></mml:math></disp-formula>
to indicate the perturbation effect when masking the TF <italic>l</italic> regulon in the cell dynamics. Δ<sub>d</sub> &gt; 0 indicates enrichment effects on the <italic>k</italic>-th terminal state. Δ<sub>d</sub> &lt; 0 indicates depletion effects on the <italic>k</italic>-th terminal state.</p></sec></sec><sec id="S30"><title>Benchmarking metrics</title><sec id="S31"><title>Velocity inference benchmark</title><p id="P90">We assess inferred velocities based on the average Pearson correlation between the ground truth and predicted gene velocity.</p></sec><sec id="S32"><title>Latent time prediction benchmark</title><p id="P91">We define latent time of a cell as the mean value of its gene-specific latent times. Following, we calculate the Spearman correlation between predicted and ground truth cell latent times.</p></sec><sec id="S33"><title>GRN inference benchmark</title><p id="P92">We benchmarked the GRN inference based on the area under the receiver operator characteristic curve (AUROC) using a set of ground truth TF-target connections <italic>E</italic>* with scikit learn’s <monospace>roc_auc_score</monospace> function<sup><xref ref-type="bibr" rid="R123">123</xref></sup>. Specifically, we defined the ROC curve using the following procedure:
<list list-type="order" id="L2"><list-item><p id="P93">Rank all possible TF-target pairs (<italic>j</italic>,  <italic>k</italic>) based on the absolute value of their predicted edge weight <italic>W</italic><sub><italic>j</italic>,  <italic>k</italic></sub> in the inferred GRN.</p></list-item><list-item><p id="P94">For the TF-target pair (<italic>j</italic>,  <italic>k</italic>),  we define the ground truth label <italic>y</italic> (<italic>j</italic>,  <italic>k</italic>) as
<disp-formula id="FD30"><mml:math id="M43"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext> if</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∉</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p></list-item><list-item><p id="P95">For thresholds <italic>τ</italic> ∈ [<italic>τ</italic><sub><italic>min</italic></sub>,  <italic>τ</italic><sub><italic>max</italic></sub> ], we define the true positive and false positive rates based on the estimator
<disp-formula id="FD31"><mml:math id="M44"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∣</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext> if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p></list-item></list></p><p id="P96">Here, we chose
<disp-formula id="FD32"><mml:math id="M45"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>min </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>max </mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>G</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p></sec><sec id="S34"><title>Parameter identifiability</title><p id="P97">Variational inference is sensitive to the parameter initialization because the ELBO is a nonconvex objective function<sup><xref ref-type="bibr" rid="R124">124</xref></sup>. We, thus, ensured the stability of estimates like the velocity, latent time, or gene regulatory network under different initialization by measuring the correlation of the estimates for each cell across multiple model runs. Here, we ran each probabilistic model overall five times and relied on Pearson correlation for all estimates except latent time where we computed the Spearman correlation to account for the ranked nature of the feature.</p></sec><sec id="S35"><title>Velocity consistency</title><p id="P98">We expect the inferred vector field to be coherent in a uni-directional trajectory such as the cell cycle. We quantify a consistency score<sup><xref ref-type="bibr" rid="R13">13</xref></sup> <italic>ζ</italic> for each cell <italic>n</italic> as the mean correlation of its velocity <italic>υ</italic><sup>(<italic>n</italic>)</sup> with its neighboring cell velocities, <italic>i.e</italic>.,
<disp-formula id="FD33"><mml:math id="M46"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mtext>corr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where 𝒩(<italic>n</italic>) indicates the neighborhood of cell <italic>n</italic> and corr the Pearson correlation.</p></sec><sec id="S36"><title>Cross-boundary correctness</title><p id="P99">Predicted cell state transitions need to align with ground truth cell state changes. Assuming we know the correct transition from a source cluster 𝒞<sub><italic>A</italic></sub> to target cluster 𝒞<sub><italic>B</italic></sub>,  we use the cross-boundary correctness (CBC) score<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup> to evaluate if our velocities align with the correct direction.</p><p id="P100">To compute the CBC score, we first identify the boundary between 𝒞<sub><italic>A</italic></sub> as 𝒞<sub><italic>B</italic></sub> as the set of all cells in 𝒞<sub><italic>A</italic></sub> with at least one neighbor in 𝒞<sub><italic>B</italic></sub>
<disp-formula id="FD34"><mml:math id="M47"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mtext>A</mml:mtext></mml:msub><mml:mo>∣</mml:mo><mml:mo>∃</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mtext>B</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P101">We then define the heuristic velocity <inline-formula><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>h</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of observation <italic>n</italic> ∈ C<sub><italic>A</italic></sub> as
<disp-formula id="FD35"><mml:math id="M49"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>h</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∩</mml:mo></mml:mstyle><mml:msub><mml:mi>C</mml:mi><mml:mtext>B</mml:mtext></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∩</mml:mo></mml:mstyle><mml:msub><mml:mi>C</mml:mi><mml:mtext>B</mml:mtext></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P102">Following, we calculated the CBC score as the Pearson correlation between the inferred velocity <italic>υ</italic><sup>(<italic>n</italic>)</sup> and heuristic velocity <inline-formula><mml:math id="M50"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>h</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This score assesses the forward transition accuracy; we denote it as CBC<sup>(f)</sup>(<italic>n</italic>).</p><p id="P103">This definition of the CBC score only quantifies if the velocity of boundary 𝒞<sub><italic>A</italic></sub> cells correctly points to their target state but fails to capture 𝒞<sub><italic>B</italic></sub> observations pointing toward their ancestor state. To quantify this incorrect flow, we consider the heuristic velocity from 𝒞<sub><italic>A</italic></sub> to 𝒞<sub><italic>B</italic></sub> and defined the backward CBC score CBC<sup>(b)</sup>(<italic>n</italic>) as
<disp-formula id="FD36"><mml:math id="M51"><mml:mrow><mml:msup><mml:mrow><mml:mtext>CBC</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>b</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>corr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>h</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
with Pearson correlation corr.</p></sec><sec id="S37"><title>Terminal state identification</title><p id="P104">CellRank<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> infers terminal states based on state change estimates combined with Markov chain theory. To benchmark different trajectory inference methods we rely on CellRank 2’s terminal state identification<sup><xref ref-type="bibr" rid="R16">16</xref></sup> (TSI) score that quantifies how faithfully a method allows the recovery of terminal states with increasing number of macrostates that represent regions of the phenotypic manifold that cells are unlikely to leave. Given the ground-truth dynamics, CellRank recovers all terminal states of a given system and one terminal state for each macrostate considered.</p><p id="P105">We quantified TSI performance through the TSI score introduced by CellRank 2<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. First, we used CellRank’s VelocityKernel <italic>κ</italic> to estimate cell-cell transition probabilities based on the inferred RNA velocities and subsequently defined macrostates and identified terminal states. We represented the predicted terminal states as the macrostate with stability<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> exceeding the threshold <italic>τ</italic>. Then, for each kernel matrix built upon the velocity estimates, we considered the step function <italic>f</italic><sub><italic>κ</italic></sub> that maps the number of macrostates to the number of correctly predicted terminal states. Considering <italic>m</italic> terminal states, an optimal method identifies terminal states according to
<disp-formula id="FD37"><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>opt </mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="P106">Based on these definitions, we calculated the TSI score as the area under the curve <italic>f</italic><sub><italic>κ</italic></sub> relative to the area under the curve <italic>f</italic><sub>opt.</sub>. We calculated the TSI score for thresholds <italic>τ</italic> taken from 20 evenly spaced values of the unit interval, <inline-formula><mml:math id="M53"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Finally, we relied on a one-sided Welch’s t-test to identify the significantly best TSI performance.</p></sec><sec id="S38"><title>Gene ranking score</title><p id="P107">Each approach for inferring cellular dynamics allows identifying and ranking potential lineage-associated genes of every lineage with CellRank<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> or, to compare to competing approaches, by relying on least action path (LAP) analysis<sup><xref ref-type="bibr" rid="R22">22</xref></sup>. To assess this ranking, we curated a list of known lineage markers and regulators<sup><xref ref-type="bibr" rid="R125">125</xref>,<xref ref-type="bibr" rid="R126">126</xref></sup> that an optimal method would rank the highest. Therefore, following the CellRank 2 method comparison workflow<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, we evaluated the performance of each method as follows: first, consider a lineage, a set of known lineage-associated genes <italic>D</italic>, and a method <italic>m r</italic><sup>(<italic>m</italic>)</sup>(<italic>g</italic>). Each method <italic>m</italic> assigns a ranking to a gene <italic>g</italic> ∈ <italic>G</italic>, denoted by <italic>r</italic><sup>(<italic>m</italic>)</sup>(<italic>g</italic>), and, for each threshold T ∈ {1,…, |<italic>G</italic>|}, we counted how many lineage-associated genes rank among the top <italic>T</italic> genes with
<disp-formula id="FD38"><mml:math id="M54"><mml:mrow><mml:msup><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mtext>T</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mtext>T</mml:mtext><mml:mo>∧</mml:mo><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P108">Next, to quantitatively evaluate the rankings, for each method <italic>m</italic>, we computed the area under the curve
<disp-formula id="FD39"><mml:math id="M55"><mml:mrow><mml:mtext>AUC</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mtext>T</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mtext>T</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
</p><p id="P109">Since an optimal method ranks the lineage-associated genes highest, its AUC* is
<disp-formula id="FD40"><mml:math id="M56"><mml:mrow><mml:msup><mml:mrow><mml:mtext>AUC</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P110">Finally, we evaluate the performance of methods relative to an optimal ranking through
<disp-formula id="FD41"><mml:math id="M57"><mml:mrow><mml:msub><mml:mrow><mml:mtext>AUC</mml:mtext></mml:mrow><mml:mrow><mml:mtext>rel</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>AUC</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mtext>AUC</mml:mtext></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p></sec><sec id="S39"><title>Evaluating the impact of the GRN on dynamics inference</title><p id="P111">We developed two baseline models based on a pre-trained RegVelo model to assess the significance of GRNs in velocity inference. We created the first baseline, the <italic>random GRN</italic> model, by shuffling the estimated GRN from the pre-trained RegVelo model and used it as input for a new model. We retrained the original and new model but kept the GRN fixed. This approach allows assessing how the regulatory network affects the model’s cellular velocity and latent time estimates.</p><p id="P112">In the second baseline model, the <italic>remove GRN</italic> model, we removed all regulatory influences. As with the first baseline, we fixed the modified GRN and trained the model until convergence. This model served as a control to evaluate the impact of entirely omitting regulatory information on velocity inference.</p><p id="P113">We quantified the performance of these baseline models compared to the original RegVelo model by calculating the CBC score and the Spearman correlation of latent time estimates with ground truth. To gain statistical significance, we repeated this process 30 times for each model and used the Wilcoxon signed-rank test to compare the original model with each baseline, <italic>i.e</italic>., original vs. random GRN and original vs. removed GRN. This evaluation allowed us to determine the critical role that GRNs play in accurately modeling cellular dynamics.</p></sec><sec id="S40"><title>Robustness to prior GRN estimates</title><p id="P114">RegVelo relies on a prior gene regulatory graph, and since this prior knowledge is usually inaccurate, the method must be robust to such imperfections. To assess the robustness of our method to inaccuracies in prior gene regulatory graphs, we utilized dyngen-simulated datasets<sup><xref ref-type="bibr" rid="R127">127</xref></sup> as described in the Datasets section. Following, we generated corrupted prior gene regulatory graphs by randomly replacing different fractions of existing gene regulations with nonexistent ones based on the original gene regulation graph used in the dyngen simulations.</p><p id="P115">We simulated five levels of corrupted fractions {0.2,0.4,0.6,0.8,1.0}, each generating five different corrupted prior graphs to account for corruption randomness. We ran RegVelo with each of these corrupted prior graphs and evaluated performance based on the AUROC score of the inferred GRN, and velocity and latent time correlation. We used these metrics to determine how well RegVelo maintained accuracy and reliability despite the corruption in the prior knowledge.</p></sec></sec><sec id="S41"><title>Quantifying perturbation effects</title><sec id="S42"><title>Dynamo-based perturbation prediction</title><p id="P116">To perform perturbation prediction with dynamo<sup><xref ref-type="bibr" rid="R22">22</xref></sup>, we followed the corresponding tutorial provided in the Python package’s documentation. In the first step, dynamo estimates cell velocities; we used <monospace>dynamo.tl.dynamics</monospace> to estimate kinetic rates and used <monospace>dynamo.tl.reduceDimension</monospace> to perform the dimensional reduction. Next, we used <monospace>dynamo.tl.cell_velocities</monospace> with argument <monospace>basis=‘pca’</monospace> to project cell velocities to the PCA space. We further learned a vector field function based on this projection with <monospace>dynamo.vf.VectorField</monospace> with argument <monospace>basis=‘pca’</monospace>.</p><p id="P117">Dynamo provides two methods to simulate perturbation effects: <italic>KO</italic> or <italic>expression perturbation</italic>. For <italic>KO</italic>-based perturbation simulation, the method directly removes the regulation of the TF through masking the Jacobian matrix and generates a perturbed vector field. Following our CellRank-based quantification of cell fate probabilities, we first used the dynamo-inferred velocities in the typical CellRank workflow. We further used <monospace>dynamo.pd.KO</monospace> with argument <monospace>store_vf_ko=True</monospace> to predict the velocities after perturbing a certain TF and quantified the corresponding perturbed cell fate probabilities. Finally, we used Pearson correlation to assess the change in cell fate probabilities towards each lineage to quantify the perturbation score.</p><p id="P118">For <italic>expression perturbation-</italic>based simulations, dynamo estimates perturbation effects by simulating perturbed gene expression and calculating the perturbation shift matrix, corresponding to the difference between the perturbed and the original gene expression. We computed the perturbation shift matrix on each cell through <monospace>dynamo.pd.perturbation</monospace> and quantified the perturbation score on each cell as the inner product between the perturbation shift and velocity matrices. Finally, we calculated the average perturbation score within each terminal cell type.</p></sec><sec id="S43"><title>CellOracle-based perturbation prediction</title><p id="P119">To perform perturbation prediction with CellOracle<sup><xref ref-type="bibr" rid="R25">25</xref></sup>, we followed the tool’s tutorial: after defining the oracle object with <monospace>oracle = celloracle.Oracle()</monospace>, we injected the base gene regulatory graph via <monospace>oracle.import_TF_data</monospace>, calculated the PCA representation through <monospace>oracle.perform_PCA</monospace> and performed gene expression imputation with <monospace>oracle.knn_imputation</monospace>. Next, we estimated a GRN for each cell type with <monospace>oracle.get_links</monospace> and set the regularization parameter of Bayesian ridge regression <monospace>alpha=10</monospace> to prevent overfitting during GRN inference. Finally, we filtered edges of the GRNs with <monospace>links.filter_links</monospace> and fitted the GRNs for perturbation simulation by <monospace>oracle.fit_GRN_for_simulation</monospace>.</p><p id="P120">To perform TF perturbation simulations with CellOracle, the method requires a pseudotime-based reference vector field defined in 2D space. We used <monospace>Gradient_calculator</monospace> to calculate the reference gradient based on a pseudotime or latent time inferred by velocity models. We then defined grid points with <monospace>gradient.calculate_p_mass</monospace> and <monospace>gradient.calculate_mass_filter</monospace> and projected the reference gradient onto the grid points using <monospace>gradient.calculate_gradient</monospace>. For each TF, <monospace>oracle.simulate_shift</monospace> simulated the shift vector, and <monospace>oracle.estimate_transition_prob</monospace> estimated the cell transition probability matrix; we relied on <monospace>n_neighbors=30</monospace> neighbors and calculated the shift matrix in PCA space with <monospace>oracle.calculate_embedding_shift</monospace>. Next, we calculated the inner product between the perturbed shift vectors and reference velocity vectors in 2D space with <monospace>calculate_inner_product</monospace> and <monospace>calculate_digitized_ip</monospace>. Finally, we calculated the perturbation score within each lineage using <monospace>get_negative_PS_p_value</monospace>.</p></sec></sec><sec id="S44"><title>Datasets</title><sec id="S45"><title>General processing</title><p id="P121">We conducted all analyses using Scanpy<sup><xref ref-type="bibr" rid="R128">128</xref></sup> and scVelo<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, using default parameters unless specified otherwise. We applied scVelo to filter out genes expressed in fewer than ten cells in the spliced and unspliced counts before normalizing their gene expression. If not stated otherwise, we selected the top 1000 highly variable genes (HVGs) based on gene dispersion parameters. We performed these filtering and normalization steps using <monospace>scvelo.pp.filter_and_normalize</monospace>. Next, we computed the top 30 PCA components and constructed a nearest-neighbor graph with 30 neighbors using <monospace>scanpy.tl.pca</monospace> and <monospace>scanpy.pp.neighbors</monospace>, respectively. We then calculated first-order moment matrices as smoothed spliced and unspliced gene expression on the nearest neighbor graph using <monospace>scvelo.pp.moments</monospace>. All velocity models take these moment matrices as input.</p><p id="P122">We applied gene-wise min-max scaling to preprocess both spliced and unspliced counts. Following the preprocessing employed by scVelo<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and veloVI<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, we applied scVelo’s deterministic model and kept genes with a positive coefficient of determination <italic>R</italic><sup>2</sup>&gt;0 for further RNA velocity inference because RegVelo’s spliced equation with positive kinetic parameters <italic>β</italic> and <italic>γ</italic> implies a correlation between spliced and unspliced read counts; negative <italic>R</italic><sup>2</sup> values indicate poor model fit, suggesting the gene may not be informative for dynamical analysis. However, even if some transcription factors (TFs) do not meet the velocity gene selection criteria, their regulatory functions remain crucial for understanding broader gene regulation during differentiation. Therefore, we retained all TFs contained in the highly variable gene set unless specified otherwise.</p><p id="P123">We downloaded lists of TFs for humans and mice from the cisTarget database of the SCENIC software<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>, and for zebrafish, we retrieved the corresponding information from the AnimalTFDB v4.0 database<sup><xref ref-type="bibr" rid="R129">129</xref></sup>. Finally, if not specified otherwise, we used the <italic>soft constraint</italic> mode to allow RegVelo to learn new edges in the GRN.</p></sec><sec id="S46"><title>Trajectory inference benchmark</title><p id="P124">We inputted all velocity estimations into the typical CellRank<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> workflow for downstream analyses. To compare velocity estimations, we used only CellRank’s VelocityKernel to compute the transition matrix for macrostates estimation. Otherwise, we combined the VelocityKernel and ConnectivityKernel with weights 0.8 and 0.2, respectively, as shown in the CellRank tutorials. To benchmark trajectory inference performance, we used the CBC score provided by the kernel method <monospace>cbc</monospace> and the TSI score supplied by the GPCCA estimator <monospace>tsi</monospace><sup><xref ref-type="bibr" rid="R16">16</xref></sup>; the Benchmarking metrics section provides the relevant details.</p></sec><sec id="S47"><title>Driver gene analysis</title><p id="P125">For each velocity-based method, we rely on CellRank to infer lineage-associated genes, following the tutorials for the VelocityKernel. Further, we computed terminal states and their corresponding fate probabilities using the GPCCA estimator. We used the <monospace>compute_lineage_drivers</monospace> function to identify genes that correlate with specific lineages.</p><p id="P126">To identify putative cell cycle activation-related drivers, we utilized cell cycle markers to compute cell cycle scores CCS for the G1, G2/M, and S phases by applying <monospace>scvelo.tl.score_genes_cell_cycle</monospace>. We defined the cell cycle score through
<disp-formula id="FD42"><mml:math id="M58"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mtext>S</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mtext>S</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mtext>S</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mtext>S</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mrow><mml:mtext>G2/M</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mrow><mml:mtext>G2/M</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mrow><mml:mtext>G2/M</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow><mml:mrow><mml:mtext>G2/M</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p><p id="P127">Finally, we calculated Pearson correlations between the expression levels of all TFs and this score to identify potential cell cycle regulators.</p></sec><sec id="S48"><title>Perturbation screening</title><p id="P128">We simulated regulon knock-outs for each TF to identify lineage drivers through perturbation screening and estimated the resulting perturbed vector fields. After obtaining these perturbed velocities, we incorporated the perturbed and original velocities into the canonical CellRank workflow.</p><p id="P129">We used the GPCCA estimator<sup><xref ref-type="bibr" rid="R130">130</xref></sup> to calculate fate probabilities and compare these probabilities with Pearson correlation, allowing us to quantify the effect of each perturbation on the lineages. To ensure the robustness of these perturbation predictions, we ran RegVelo five times, each with a different initialization for the perturbation simulations. Finally, after assessing the effects of perturbation on each gene and terminal state, we averaged the results from all five runs to obtain the final prediction.</p></sec><sec id="S49"><title>Benchmarking related methods</title><p id="P130">We followed the provided tutorials for each velocity method<sup><xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup> to infer cell velocities. For scVelo, we first used <monospace>scvelo.tl.recover_dynamics</monospace> to estimate kinetic parameters and applied <monospace>scvelo.tl.velocity</monospace> with argument <monospace>mode=“dynamical”</monospace> to calculate velocities. For UniTVelo, we estimated velocities with <monospace>unitvelo.run_model</monospace> with the argument <monospace>FIT_OPTION=“1”</monospace>. In the case of VeloVAE, we initialized the model using <monospace>velovae.VAE</monospace> with argument <monospace>dim_z=10</monospace>, then used <monospace>velovae.train</monospace> to estimate velocities. We also ran a full Bayesian VeloVAE model with rate prior set as <monospace>‘alpha’: (0, 1.0), ‘beta’: (0, 0.5); ‘gamma’: (0, 0.5)</monospace>, and initialized the model with additional argument <monospace>full_vb=True</monospace>.</p><p id="P131">For TFVelo, we estimated the velocities with <monospace>TFvelo.tl.recover_dynamics</monospace>. We then extracted the estimated GRN from <monospace>adata.varm[‘fit_weights_final’]</monospace>, and used this GRN for the subsequent GRN benchmark. For cell2fate, we first applied <monospace>cell2fate.utils.get_max_modules</monospace> to estimate the number of modules, and estimated velocities through a <monospace>cell2fate.Cell2fate_DynamicalModel</monospace> model, trained with the <monospace>train()</monospace> method.</p><p id="P132">We followed the provided tutorials for each GRN inference method<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R46">46</xref>,<xref ref-type="bibr" rid="R131">131</xref></sup>. For CellOracle, we used the <monospace>fit_All_genes</monospace> function to compute the GRN, and for GRNBoost2, we used the <monospace>arboreto.algo.grnboost2</monospace> function to calculate the GRN. Importantly, GRNBoost2 does not estimate gene self-regulation but Pearson correlation always assigns self-regulation to every gene. To make the approach comparable to our method, we followed a previous GRN inference benchmark<sup><xref ref-type="bibr" rid="R132">132</xref></sup> and removed all edges corresponding to self-regulation from the predicted and ground truth GRNs when calculating the AUROC score. Since spliceJAC requires pre-defined cell cluster information as input, we first ran <monospace>scanpy.tl.leiden</monospace> to find cell clusters, before applying <monospace>splicejac.tl.estimate_jacobian</monospace> for GRN estimation.</p></sec><sec id="S50"><title>Cell cycling dataset</title><p id="P133">After training the RegVelo model and estimating velocities, we calculated the CBC score with the ground truth differentiation directions, including G1 phase to S phase and S phase to G2/M phase; the original studies provided the phase label information.</p><p id="P134">We calculated the velocity consistency score using <monospace>scvelo.tl.velocity_confidence</monospace>. To further validate our results, we used the fluorescent ubiquitination-based cell-cycle indicator (FUCCI) derived score<sup><xref ref-type="bibr" rid="R39">39</xref></sup> as the proximal ground truth of cell cycling time and correlated it with inferred cell latent time using Spearman correlation.</p></sec><sec id="S51"><title>Evaluating GRN inference</title><p id="P135">To evaluate GRN predictions through our AUROC score, we first defined the proximal ground truth GRN for the regulators by retrieving ground truth edges from ChIP-Atlas<sup><xref ref-type="bibr" rid="R133">133</xref></sup>, this resource provides putative binding scores of TF-target pairs derived from ChIP-seq datasets across different cell lines. We set the links with a MACS2<sup><xref ref-type="bibr" rid="R134">134</xref>,<xref ref-type="bibr" rid="R135">135</xref></sup> score greater than 500 as the proximal ground truth links; this stringent significance threshold, which corresponds to a q-value less than 10<sup>−50<xref ref-type="bibr" rid="R45">45</xref>,<xref ref-type="bibr" rid="R133">133</xref></sup>, ensures that our defined proximal ground truth links are reliable.</p><p id="P136">To calculate the AUROC score for each TF, we followed our pipeline outlined in the Bechnmark metrics section. To provide a comprehensive evaluation, we used the mean AUROC score across TFs with more than 50 targets in the cycling dataset to benchmark the GRN prediction.</p></sec><sec id="S52"><title>Pancreatic endocrinogenesis</title><p id="P137">To infer the gene regulatory graph as prior knowledge for RegVelo, we began by utilizing the 10x multiome pancreatic endocrine datasets<sup><xref ref-type="bibr" rid="R48">48</xref></sup> of the same mouse line (Ngn3-Venus fusion) and the same embryonic stages (E14.5 and E15.5) to the scRNA-seq dataset used in the scVelo study<sup><xref ref-type="bibr" rid="R47">47</xref></sup>. We then applied Pando<sup><xref ref-type="bibr" rid="R24">24</xref></sup> to these 10x multiome datasets to infer the GRN with its default preprocessing and parameter settings.</p></sec><sec id="S53"><title>Prior GRN definition</title><p id="P138">Pando’s GRN inference consists of two steps: first, it scans for motifs in candidate cis-regulatory element (CRE) regions on the genome with the <monospace>find_motifs</monospace> function. Second, it infers the GRN by integrating gene expression and peak accessible information using the <monospace>infer_grn</monospace> function. The first step requires TF-motif binding information and position weight matrices (PSM). Here, we used the mouse_pwms_v2 dataset, which collects mouse motifs from the CIS-BP database and corresponding PSMs, from the R package chromVARmotifs<sup><xref ref-type="bibr" rid="R136">136</xref></sup> to provide this information. We inferred the prior GRN estimate through XGBoost<sup><xref ref-type="bibr" rid="R137">137</xref></sup> and used Signac<sup><xref ref-type="bibr" rid="R138">138</xref></sup> to link peaks with genes during the second step. We binarized the constructed GRN, <italic>i.e</italic>., set weights of nonzero edges to 1 and 0 otherwise; we used this binary graph as the prior gene regulatory graph for RegVelo.</p></sec><sec id="S54"><title>Downstream analysis</title><p id="P139">We inputted the estimated velocity into the downstream CellRank workflow, used eight macrostates, and defined “Alpha”, “Beta”, “Delta”, and “Epsilon” as the terminal states.</p></sec><sec id="S55"><title>Epsilon cell substate identification</title><p id="P140">We defined sub-clusters in Epsilon cells by first subsetting to the annotated Epsilon cells from the pancreatic endocrine dataset. We then computed PCA embedding of this subset and constructed a neighborhood graph using 30 PCs and 30 neighbors with <monospace>scanpy.tl.pca</monospace> and <monospace>scanpy.pp.neighbors</monospace> functions. Next, we identified the sub-clusters using the Leiden algorithm (<monospace>scanpy.tl.leiden</monospace>). We defined the sub-cluster with the highest average alpha cell fate probabilities as State A (<xref ref-type="supplementary-material" rid="SD3">Supplementary Fig. 2b</xref>). To further characterize both sub-clusters, we used the Wilcoxon rank-sum test to identify differentially expressed genes.</p></sec><sec id="S56"><title>Human hematopoiesis</title><p id="P141">We conducted all analyses on the dataset preprocessed by the original study<sup><xref ref-type="bibr" rid="R22">22</xref></sup>. All other preprocessing followed our standard preprocessing pipeline.</p></sec><sec id="S57"><title>Prior GRN inference</title><p id="P142">We curated prior gene regulatory graphs from two sources: putative gene regulation based on multi-omics datasets and experimental ChIP-seq datasets. We used a publicly available putative GRN inferred by the multiome GRN inference model <italic>Dictys</italic> on multi-omics bone marrow mononuclear cells<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. Since this putative GRN may be incomplete, we also curated a GRN from human hematopoiesis ChIP-seq datasets of the UniBind database<sup><xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R71">71</xref></sup>. By merging both GRNs, we created a prior gene regulatory graph for RegVelo input.</p><p id="P143">We ran RegVelo with <italic>soft constraints</italic>, with unregularized (λ<sub>2</sub> = 0) and regularized (λ<sub>2</sub> = 1) settings for comparison. We inputted the estimated velocity into the downstream CellRank workflow to compute seven macrostates and defined “Mon”, “Bas”, “Ery”, “Meg” and “Neu” as the terminal states.</p></sec><sec id="S58"><title>Method comparison</title><p id="P144">We compared all velocity estimations with generic trajectory inference benchmark procedures, using the PCA representation as the input to calculate the CBC score. We calculated the forward CBC score and backward CBC score for each method by the kernel method <monospace>cbc</monospace>, with ground-truth transitions: “HSC” to “GMP-like”, “HSC” to “MEP-like”, “GMP-like” to “Mon”, “MEP-like” to “Ery”, “MEP-like” to “Meg” and “MEP-like” to “Bas”. We further used Welch’s <italic>t</italic>-test to assess if the log ratio of CBC score of the regularized RegVelo model and the other model including unregularized RegVelo, scVelo, and veloVI models was significantly higher than zero.</p><p id="P145">To compare how RegVelo and veloVI predicted uncertainty in terminal states of the human hematopoiesis dataset, we first calculated the median uncertainty in progenitor cells (HSC, MEP-like, and GMP-like) and normalized the terminal state uncertainties based on this median. We then calculated the log<sub>2</sub> ratio of the normalized uncertainties between veloVI and RegVelo. We applied Welch’s <italic>t</italic>-test to assess whether veloVI’s uncertainty was significantly higher than RegVelo’s in terminal states.</p><p id="P146">To evaluate the estimated gene rankings, for each system that we analyzed, we manually compiled a list of known driver TFs from the literature for each lineage (<xref ref-type="supplementary-material" rid="SD3">Supplementary Tables 1</xref> and <xref ref-type="supplementary-material" rid="SD3">2</xref>). For lineage-associated genes, we curated genes from CellMarker 2.0<sup><xref ref-type="bibr" rid="R126">126</xref></sup> and other relevant literature<sup><xref ref-type="bibr" rid="R125">125</xref></sup>.</p></sec><sec id="S59"><title>Dynamo-based analysis</title><p id="P147">To predict the drivers using dynamo, we strictly followed the analysis pipeline provided by the tool’s tutorial<sup><xref ref-type="bibr" rid="R22">22</xref></sup>. We calculated moment matrices using dynamo-inferred neighbor graph and group <monospace>label=“time”</monospace>. Following, we used the dynamo function <monospace>dynamo.tl.dynamics</monospace> to estimate cell velocities with arguments <monospace>group=“time”</monospace>, <monospace>one_shot_method=“sci_fate”</monospace>, <monospace>model=“deterministic”</monospace>.</p><p id="P148">With the stable fixed points given by the dynamo tutorials, we identified putative lineage drivers using dynamo’s least action path analysis. Firstly, we projected the dynamo velocity field onto the PCA space with the function <monospace>dynamo.tl.cell_velocities</monospace> with <monospace>basis=“pca”</monospace> and learned a vector field function based on this projection via the function <monospace>dynamo.vf.VectorField</monospace> with <monospace>basis=“pca”</monospace>. Next, we defined the terminal states as the 30 nearest neighbors computed in UMAP space of each stable fixed point using the function <monospace>dynamo.tools.utils.nearest_neighbors</monospace>. We computed the least actions path starting from each cell in the HSC cluster to each cell in the clusters labeled “Mon” or “Ery” with <monospace>dynamo.pd.least_action</monospace>. We further identified the genes correlated with the path using <monospace>dynamo.pd.GeneTrajectory</monospace> and ranked the lineage-associated genes with <monospace>dynamo.vf.rank_genes</monospace>.</p></sec><sec id="S60"><title>Zebrafish neural crest development</title><sec id="S61"><title>Fish husbandry and Smart-seq3 single-cell RNA-Seq</title><p id="P149">Animal experiments complied with UK Home Office protocols under the Animals (Scientific Procedures) Act 1986, and followed the Guide for the Care and Use of Laboratory Animals<sup><xref ref-type="bibr" rid="R139">139</xref></sup>. All vertebrate animal research was conducted at Oxford University Biomedical Services. Adult fish care followed established protocols, and embryos were staged using standard methods under an Olympus dissecting stereomicroscope<sup><xref ref-type="bibr" rid="R140">140</xref></sup>.</p><p id="P150">We generated Smart-seq3 data to complement the 10x multiome data used to recontrust the cranial NC GRN<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. Embryos were harvested by crossing zebrafish lines Gt(foxd3-mCherry)<sup>ct110R</sup> and Gt(foxd3-Citrine)ct110<sup>141</sup>, incubating to the desired stages, and dissociating with Liberase TM (Roche) for 25 minutes at 32°C. Cell suspension was filtered through 100-µm strainers (PluriSelect), and stained with 1-3 µg/ml DAPI. Live Citrine-positive (Citrine+Cherry-) and double-positive (Citrine+Cherry+) single cells were isolated using fluorescence-activated cell sorting (FACS) on a Sony MA900 instrument.</p><p id="P151">To generate full-transcript-length, deep scRNA-Seq data, we prepared the Smart-seq3 libraries following the protocol<sup><xref ref-type="bibr" rid="R81">81</xref></sup>. During FACS, cells were sorted into individual wells containing 3-µl lysis buffer dispensed by the MANTIS liquid handler (FORMULATRIX). The lysis buffer consisted of 5% Polyethylene Glycol 8000 (Sigma), 0.1% Triton X-100 (Sigma), 0.5 U/µl RNAse inhibitor (Takara), 0.5 µM OligoT<sub>30</sub>VN (IDT), 0.5 mM/each dNTPs (Thermo Fisher) and nuclease-free water (Thermo Fisher). Note that these concentrations reflect their concentrations in the 4-µl reverse transcription reaction. The plates were briefly centrifuged, quickly frozen on dry ice and stored at -80°C. In brief, the plates of sorted cells were transferred on dry ice from -80°C, incubated at 72°C for 10 min, and cooled down to 4°C. Quickly, 1 µl/well reverse transcription master mix containing 25 mM Tris-HCl pH8 (Invitrogen), 30 mM NaCl (Invitrogen), 2.5 mM MgCl<sub>2</sub> (Invitrogen), 1 mM GTP (Thermo Fisher), 8 mM DTT (Thermo Fisher), 0.5 U/µl RNAse inhibitor (Takara), 2 µM TSO (IDT), 2 U/µl Maxima H-minus (Life Technologies) was added. The reverse transcription program was 42°C 90 min, 10x (50°C 2 min, 42°C 2 min), 85°C 5 min and 4°C hold. MANTIS added 6 µl/well PCR mix containing 1x KAPA HiFi HotStart buffer, 0.3 mM/each dNTPs, 0.5 mM MgCl<sub>2</sub>, 0.5 µM forward primer, 0.1 µM reverse primer and 1 U/µl polymerase (Roche). The PCR program was 98°C 3 min, 23x (98°C 20 s, 65°C 30 s, 72°C 4 min), 85°C 5 min and 4°C hold. These cDNA samples were cleaned up by 0.6:1 AMPure XP beads and relocated into 384-well plates using FxP (Beckman Coulter), quantified by Quant-iT PicoGreen (Invitrogen) on CLARIOstar (BMG Labtech), quality checked by TapeStation 4200 and High Sensitivity D5000 assays (Agilent) and normalized to 0.3 ng/µl using MANTIS. Next, 150 pg/µl cDNA was tagmented by adding 0.5 µl Smart-seq3 in-house Tagmentation buffer (40 mM Tris-HCl pH7.5, 20 mM MgCl<sub>2</sub>, 20% Dimethylformamide and UltraPure water in 4x buffer), 0.08 µl Amplicon Tagmentation Mix (Illumina) and UltraPure water for a total reaction volume of 2 µl and incubating at 55°C for 10 min. The tagmentation was stopped by adding 0.5 μl of 0.2 % SDS and incubated at room temperature for 5 min. Then 1.5 µl Nextera index primer pairs and 3 µl PCR master mix (1x Phusion HF buffer, 0.2 mM/each dNTPs, 2 U/µl Phusion HF) were added to each well of the tagmentation product and the PCR program was 72°C 3 min, 98°C 3 min, 12x (98°C 10 s, 55°C 30 s, 72°C 30 s), 72°C 5 min and 4°C hold. The libraries were pooled, cleaned up by 0.6:1 AMPure XP beads and sequenced on NovaSeq for 150-bp paired end reads (Illumina).</p></sec><sec id="S62"><title>Zebrafish Smart-seq3 data analysis</title><p id="P152">To preprocess our Smart-seq3 data, fastq files for each Smart-seq3 pool library were merged into read 1, read 2, index 1, and index 2 four fastq files. Next, we applied zUMIs<sup><xref ref-type="bibr" rid="R142">142</xref></sup> to the fastq files with the expected barcodes file containing the Nextera v2 index combinations, the GRCz11 Ensembl 105 reference genome built by STAR v2.7.3a <sup><xref ref-type="bibr" rid="R143">143</xref></sup> and the parameters including barcode binning of 1, no automatic barcode detection, and the minimum number of reads per cell of 0.</p></sec><sec id="S63"><title>Dynamic inference via RegVelo</title><p id="P153">We used the ultra-deep full-length Smart-seq3 scRNA-seq dataset during neural crest cell development for RegVelo implementation. We first filtered out genes expressing fewer than ten cells in spliced and unspliced matrices. To fully model the transcription regulation dynamics, we selected the top 8,000 genes for further downstream analysis.</p><p id="P154">We utilized the neural crest GRN<sup><xref ref-type="bibr" rid="R82">82</xref></sup> built by SCENIC+ using the 10x multiome datasets as the input for RegVelo. After training models, we inputted inferred velocity estimations into the CellRank workflow, proceeded with eight macrostates and defined “facial mesenchyme”, “pharyngeal arch 2”, “mNC hox34” and “pigment” as the terminal states in this system.</p></sec><sec id="S64"><title>Driver gene prediction benchmarking</title><p id="P155">Besides our canonical lineage driver identification through TF expression via CellRank<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, we also correlated TF activity with cell fate probabilities to rank TFs.</p><p id="P156">To quantify TF activity in zebrafish datasets with SCENIC+’s inferred TF regulon, we used AUCell<sup><xref ref-type="bibr" rid="R17">17</xref></sup> to score each TF-regulon activity within each cell through <monospace>AUCell_calcAUC.</monospace> Following, we calculated the correlation of each regulon activity with cell fate probabilities and ranked the genes according to their correlation coefficients within each lineage. Finally, we evaluated the identified putative drivers in mNC head mesenchymal and Pigment lineage using classical drivers as ground truth (<xref ref-type="supplementary-material" rid="SD3">Supplementary Table 1</xref>).</p></sec><sec id="S65"><title>Perturbation effects prediction and benchmarking</title><p id="P157">We applied dynamo and CellOracle on the zebrafish dataset following the generic steps described in the Quantifying perturbation effect section. When incorporating dynamo inferred velocities into the CellRank workflow, we computed two transition matrices using the VelocityKernel and ConnectivityKernel and combined them with 0.8 and 0.2 weights, respectively; we computed eight macrostates and defined “facial mesenchyme”, “pharyngeal arch 2”, “mNC hox34” and “pigment” as the terminal states.</p><p id="P158">The CellOracle perturbation analysis required information on a base GRN and pseudotime; we used the SCENIC+-inferred GRN<sup><xref ref-type="bibr" rid="R82">82</xref></sup> as the base GRN structure. For pseudotime estimates, we estimated pseudotime with scVelo in an unsupervised manner, using <monospace>scvelo.tl.recover_dynamics</monospace> and <monospace>scvelo.tl.velocity</monospace> to estimate kinetics, followed by <monospace>scvelo.tl.latent_time</monospace> to estimate the latent time for each cell.</p></sec><sec id="S66"><title>In vivo Perturb-seq of zebrafish neural crest development</title><p id="P159">To systematically validate RegVelo’s predicted perturbation effects, we implemented CRISPR/Cas9 knockouts and Perturb-seq as previously described<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. Our Perturb-seq dataset on zebrafish neural crest development included knockouts of seven regulons: <italic>tfec, mitfa, bhlhe40, tfeb, elf2, nr2f2</italic>, and <italic>nr2f5</italic>. For benchmarking, we combined this dataset with an additional one<sup><xref ref-type="bibr" rid="R82">82</xref></sup>, resulting in 22 conditions: 14 single-gene, 5 two-gene, and 3 multi-gene knockouts. We generated F<sub>0</sub> knockout crispants by injecting the mixture of 250 ng/µl single guide RNAs (sgRNAs), 3.36 µM EnGen Cas9, and 0.05% Phenol red into 1-cell-stage embryos from crosses of <italic>Gt(foxd3-Citrine)</italic><sup><italic>ct110</italic></sup> and wild-type lines. At the 21-somite stage, foxd3-Citrine-positive cells were isolated by flow cytometry. Gene expression and CRISPR libraries were prepared according to the CG000510 Chromium NextGEM Single Cell 5’ v2 CRISPR User Guide (Rev B, 10x Genomics) and sequenced on NextSeq and NovaSeq platforms (Illumina).</p></sec><sec id="S67"><title>Quantification of in vivo perturbation effects</title><p id="P160">The zebrafish Perturb-seq data were processed following an established workflow<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. Briefly, raw data were preprocessed with CellRanger using SC5P-R2 chemistry, aligning reads to the reference genome that incorporated mCherry and Citrine genes along with GRCz11 Ensembl 105. Cellular genotypes were assigned based on sgRNA counts, with ambient RNA contamination and doublets removed.</p><p id="P161">Cell clustering was performed using Seurat, and cell state annotations were enhanced by integrating multiome-gene expression (GEX) data with reciprocal PCA (RPCA)<sup><xref ref-type="bibr" rid="R144">144</xref></sup>. Neural crest clusters were isolated for further clustering and visualized using the PHATE method<sup><xref ref-type="bibr" rid="R145">145</xref></sup>. Perturbation effects were quantified using MELD<sup><xref ref-type="bibr" rid="R146">146</xref></sup> by comparing each knockout condition to the non-targeting control. Latent time was inferred from the multiome dataset<sup><xref ref-type="bibr" rid="R82">82</xref></sup> via RPCA and averaging latent time of neighboring cells. Within specific lineages, cells were categorized into early and late stages based on median latent time. MELD then calculated depletion-enrichment likelihoods on the 0-1 scale, with late-stage cells’ average likelihood providing a measure of short-term lineage-specific effects for each knockout.</p></sec><sec id="S68"><title>TF binding site prediction</title><p id="P162">To predict the TF binding sites, we used the interpretation of previously trained deep learning models<sup><xref ref-type="bibr" rid="R82">82</xref></sup> by ChromBPNet<sup><xref ref-type="bibr" rid="R100">100</xref></sup>, de novo motif discovery results<sup><xref ref-type="bibr" rid="R82">82</xref></sup> predicted by TFmodisco-lite<sup><xref ref-type="bibr" rid="R100">100</xref></sup> and hit calling results<sup><xref ref-type="bibr" rid="R82">82</xref></sup> by Finemo<sup><xref ref-type="bibr" rid="R100">100</xref></sup>. For visualization, we used Signac<sup><xref ref-type="bibr" rid="R138">138</xref></sup> to plot the pseudobulk chromatin accessibility tracks of the multiome ATAC data, and used the WashU Epigenome Browser<sup><xref ref-type="bibr" rid="R147">147</xref></sup> to visualize the ChromBPNet profile contribution scores, which indicated the base-resolution importance of DNA sequences for chromatin accessibility.</p></sec><sec id="S69"><title>Whole-mount hybridization chain reaction (HCR) and phenotypic check</title><p id="P163">To visualize the mRNA in situ, we applied HCR<sup><xref ref-type="bibr" rid="R101">101</xref></sup> targeting <italic>elf1</italic> mRNA in zebrafish embryos by following the ‘In situ HCR v3.0 protocol’ for whole-mount zebrafish larvae from Molecular Instruments. Hybridized embryos were embedded in 1% low-melting point agarose and imaged with confocal microscopes (Zeiss). To check the phenotypes of wild-type and knockout embryos, we performed live imaging with MVX10 stereomicroscope (Olympus).</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary notes</label><media xlink:href="EMS201949-supplement-Supplementary_notes.pdf" mimetype="application" mime-subtype="pdf" id="d116aAcIbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary tables</label><media xlink:href="EMS201949-supplement-Supplementary_tables.pdf" mimetype="application" mime-subtype="pdf" id="d116aAcIcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Figures</label><media xlink:href="EMS201949-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d116aAcIdB" position="anchor"/></supplementary-material></sec></body><back><ack id="S72"><title>Acknowledgments</title><p>People</p><p>We thank all members of the Theis and Sauka-Spengler laboratories for helpful discussions. W.W. thanks Dr. Xiaojie Qiu for his feedback on RegVelo concerning implementation and benchmarking aspects, A. Palma and M. Lienen for helpful discussions about parallel ODE solvers and neural ODE models, D. Klein for insights into pancreatic endocrine development and L. Kummerle for discussing RegVelo perturbation benchmark results. We thank the MRC WIMM Flow Cytometry Facility, MRC WIMM Advanced Single Cell OMICS Facility, MRC WIMM Centre for Computational Biology, MRC WIMM and Stowers Institute Sequencing Facilities, and Wolfson Imaging Centre for their help and technical support in the zebrafish study part. Z.H. thanks the HPC core facility of the Medical Research Institute at Wuhan University for technical support. Scientific illustrations shown in <xref ref-type="fig" rid="F4">Figure 4a</xref> were created by Uta Mackensen.</p><sec id="S73"><title>Funding</title><p>This work was co-funded by the European Union (ERC, DeepCell - 101054957), the Wellcome Leap ΔTissue Program (9E8E84F7-8991-4D4A-A9EC), and received funding from the European Union’s Horizon 2022 HORIZON research and innovation programme under Grant Agreement No.101057775. F.J.T. acknowledges support from the German Federal Ministry of Education and Research (BMBF) through the HOPARL project (grant number 031L0289A). M.L. further acknowledges financial support by the DFG through the Graduate School of QBM (GSC 1006) and by the Joachim Herz Foundation when employed by the Technical University of Munich and Helmholtz Munich, and through an EMBO Postdoctoral Fellowship. This work was also supported by the Wellcome Trust Award # 215615/Z/19/Z (Z.H., S.M. and T.S.S.) and Stowers Institute for Medical Research institutional support to T.S.S‥ For all support via EU funding, the views and opinions expressed are those of the authors only and do not necessarily reflect those of the European Union or the European Research Council. Neither the European Union nor the granting authority can be held responsible for them.</p></sec></ack><sec id="S70" sec-type="data-availability"><title>Data availability</title><p id="P164">The cell cycle, human hematopoiesis, and pancreatic endocrinologist data presented and used in this study are publicly available via the original publications; we provide additional access to each of these datasets and the zebrafish data via a figshare collection at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/account/home#/projects/226860">https://figshare.com/account/home#/projects/226860</ext-link>. The zebrafish data is available at <ext-link ext-link-type="uri" xlink:href="https://research.stowers.org/compbio/ucsc_cellbrowser/">https://research.stowers.org/compbio/ucsc_cellbrowser/</ext-link>.</p></sec><sec id="S71" sec-type="data-availability"><title>Code availability</title><p id="P165">RegVelo is released under the BSD-3-Clause license, with code available at <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/regvelo">https://github.com/theislab/regvelo</ext-link>. Code to reproduce the results in the paper can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/regvelo_reproducibility">https://github.com/theislab/regvelo_reproducibility</ext-link>.</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P166">Author’s contributions</p><p id="P167">W.W., Z.H. and P.W. contributed equally. W.W., P.W., M.L., F.J.T. conceptualized the study, and Z.H., T.S.-S. conceptualized the zebrafish study design. W.W. designed and implemented RegVelo with contributions from P.W. and M.L. Z.H. and S.M. performed wet-lab experiments involving zebrafish. W.W., Z.H., P.W. designed and implemented analysis methods with contributions from J.W. and Z.X. T.S.-S. and F.J.T. supervised the work. P.W., W.W., Z.H., T.S.-S. and F.J.T. wrote the manuscript. All authors read and approved the final paper.</p></fn><fn fn-type="conflict" id="FN2"><p id="P168">Competing interests</p><p id="P169">F.J.T. consults for Immunai Inc., CytoReason Ltd, Cellarity, BioTuring Inc., and Genbio.AI Inc., and has an ownership interest in Dermagnostix GmbH and Cellarity. The remaining authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pijuan-Sala</surname><given-names>B</given-names></name><name><surname>Griffiths</surname><given-names>JA</given-names></name><name><surname>Guibentif</surname><given-names>C</given-names></name><name><surname>Hiscock</surname><given-names>TW</given-names></name><name><surname>Jawaid</surname><given-names>W</given-names></name><name><surname>Calero-Nieto</surname><given-names>FJ</given-names></name><name><surname>Mulas</surname><given-names>C</given-names></name><name><surname>Ibarra-Soria</surname><given-names>X</given-names></name><name><surname>Tyser</surname><given-names>RCV</given-names></name><name><surname>Ho</surname><given-names>DLL</given-names></name><etal/></person-group><article-title>A single-cell molecular map of mouse gastrulation and early organogenesis</article-title><source>Nature</source><year>2019</year><volume>566</volume><fpage>490</fpage><lpage>495</lpage><pub-id pub-id-type="pmcid">PMC6522369</pub-id><pub-id pub-id-type="pmid">30787436</pub-id><pub-id pub-id-type="doi">10.1038/s41586-019-0933-9</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vento-Tormo</surname><given-names>R</given-names></name><name><surname>Efremova</surname><given-names>M</given-names></name><name><surname>Botting</surname><given-names>RA</given-names></name><name><surname>Turco</surname><given-names>MY</given-names></name><name><surname>Vento-Tormo</surname><given-names>M</given-names></name><name><surname>Meyer</surname><given-names>KB</given-names></name><name><surname>Park</surname><given-names>J-E</given-names></name><name><surname>Stephenson</surname><given-names>E</given-names></name><name><surname>Polański</surname><given-names>K</given-names></name><name><surname>Goncalves</surname><given-names>A</given-names></name><etal/></person-group><article-title>Single-cell reconstruction of the early maternal-fetal interface in humans</article-title><source>Nature</source><year>2018</year><volume>563</volume><fpage>347</fpage><lpage>353</lpage><pub-id pub-id-type="pmcid">PMC7612850</pub-id><pub-id pub-id-type="pmid">30429548</pub-id><pub-id pub-id-type="doi">10.1038/s41586-018-0698-6</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litviňuková</surname><given-names>M</given-names></name><name><surname>Talavera-López</surname><given-names>C</given-names></name><name><surname>Maatz</surname><given-names>H</given-names></name><name><surname>Reichart</surname><given-names>D</given-names></name><name><surname>Worth</surname><given-names>CL</given-names></name><name><surname>Lindberg</surname><given-names>EL</given-names></name><name><surname>Kanda</surname><given-names>M</given-names></name><name><surname>Polanski</surname><given-names>K</given-names></name><name><surname>Heinig</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>M</given-names></name><etal/></person-group><article-title>Cells of the adult human heart</article-title><source>Nature</source><year>2020</year><volume>588</volume><fpage>466</fpage><lpage>472</lpage><pub-id pub-id-type="pmcid">PMC7681775</pub-id><pub-id pub-id-type="pmid">32971526</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2797-4</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Waddington</surname><given-names>CH</given-names></name></person-group><source>The Strategy of the Genes</source><publisher-name>Routledge</publisher-name><year>2014</year><edition>1st</edition></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>A comparison of single-cell trajectory inference methods</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>547</fpage><lpage>554</lpage><pub-id pub-id-type="pmid">30936559</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Hamey</surname><given-names>FK</given-names></name><name><surname>Plass</surname><given-names>M</given-names></name><name><surname>Solana</surname><given-names>J</given-names></name><name><surname>Dahlin</surname><given-names>JS</given-names></name><name><surname>Göttgens</surname><given-names>B</given-names></name><name><surname>Rajewsky</surname><given-names>N</given-names></name><name><surname>Simon</surname><given-names>L</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title><source>Genome Biol</source><year>2019</year><volume>20</volume><fpage>59</fpage><pub-id pub-id-type="pmcid">PMC6425583</pub-id><pub-id pub-id-type="pmid">30890159</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title><source>Nat Methods</source><year>2016</year><volume>13</volume><fpage>845</fpage><lpage>848</lpage><pub-id pub-id-type="pmid">27571553</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendall</surname><given-names>SC</given-names></name><name><surname>Davis</surname><given-names>KL</given-names></name><name><surname>Amir</surname><given-names>E-AD</given-names></name><name><surname>Tadmor</surname><given-names>MD</given-names></name><name><surname>Simonds</surname><given-names>EF</given-names></name><name><surname>Chen</surname><given-names>TJ</given-names></name><name><surname>Shenfeld</surname><given-names>DK</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name></person-group><article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title><source>Cell</source><year>2014</year><volume>157</volume><fpage>714</fpage><lpage>725</lpage><pub-id pub-id-type="pmcid">PMC4045247</pub-id><pub-id pub-id-type="pmid">24766814</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Chawla</surname><given-names>R</given-names></name><name><surname>Pliner</surname><given-names>HA</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="pmcid">PMC5764547</pub-id><pub-id pub-id-type="pmid">28825705</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setty</surname><given-names>M</given-names></name><name><surname>Kiseliovas</surname><given-names>V</given-names></name><name><surname>Levine</surname><given-names>J</given-names></name><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Mazutis</surname><given-names>L</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name></person-group><article-title>Characterization of cell fate probabilities in single-cell data with Palantir</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>451</fpage><lpage>460</lpage><pub-id pub-id-type="pmcid">PMC7549125</pub-id><pub-id pub-id-type="pmid">30899105</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0068-4</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Street</surname><given-names>K</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Fletcher</surname><given-names>RB</given-names></name><name><surname>Das</surname><given-names>D</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title><source>BMC Genomics</source><year>2018</year><volume>19</volume><fpage>477</fpage><pub-id pub-id-type="pmcid">PMC6007078</pub-id><pub-id pub-id-type="pmid">29914354</pub-id><pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Soldatov</surname><given-names>R</given-names></name><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Braun</surname><given-names>E</given-names></name><name><surname>Hochgerner</surname><given-names>H</given-names></name><name><surname>Petukhov</surname><given-names>V</given-names></name><name><surname>Lidschreiber</surname><given-names>K</given-names></name><name><surname>Kastriti</surname><given-names>ME</given-names></name><name><surname>Lönnerberg</surname><given-names>P</given-names></name><name><surname>Furlan</surname><given-names>A</given-names></name><etal/></person-group><article-title>RNA velocity of single cells</article-title><source>Nature</source><year>2018</year><volume>560</volume><fpage>494</fpage><lpage>498</lpage><pub-id pub-id-type="pmcid">PMC6130801</pub-id><pub-id pub-id-type="pmid">30089906</pub-id><pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergen</surname><given-names>V</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Peidli</surname><given-names>S</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Generalizing RNA velocity to transient cell states through dynamical modeling</article-title><source>Nat Biotechnol</source><year>2020</year><volume>38</volume><fpage>1408</fpage><lpage>1414</lpage><pub-id pub-id-type="pmid">32747759</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Weiler</surname><given-names>P</given-names></name><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>D</given-names></name><name><surname>Hong</surname><given-names>J</given-names></name><name><surname>Streets</surname><given-names>A</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling of transcriptional dynamics for RNA velocity analysis in single cells</article-title><source>Nat Methods</source><year>2024</year><volume>21</volume><fpage>50</fpage><lpage>59</lpage><pub-id pub-id-type="pmcid">PMC10776389</pub-id><pub-id pub-id-type="pmid">37735568</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01994-w</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Bergen</surname><given-names>V</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Setty</surname><given-names>M</given-names></name><name><surname>Reuter</surname><given-names>B</given-names></name><name><surname>Bakhti</surname><given-names>M</given-names></name><name><surname>Lickert</surname><given-names>H</given-names></name><name><surname>Ansari</surname><given-names>M</given-names></name><name><surname>Schniering</surname><given-names>J</given-names></name><name><surname>Schiller</surname><given-names>HB</given-names></name><etal/></person-group><article-title>CellRank for directed single-cell fate mapping</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>159</fpage><lpage>170</lpage><pub-id pub-id-type="pmcid">PMC8828480</pub-id><pub-id pub-id-type="pmid">35027767</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01346-6</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiler</surname><given-names>P</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name><name><surname>Theis</surname><given-names>F</given-names></name></person-group><article-title>CellRank 2: unified fate mapping in multiview single-cell data</article-title><source>Nat Methods</source><year>2024</year><pub-id pub-id-type="pmcid">PMC11239496</pub-id><pub-id pub-id-type="pmid">38871986</pub-id><pub-id pub-id-type="doi">10.1038/s41592-024-02303-9</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>González-Blas</surname><given-names>CB</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Imrichova</surname><given-names>H</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Rambow</surname><given-names>F</given-names></name><name><surname>Marine</surname><given-names>J-C</given-names></name><name><surname>Geurts</surname><given-names>P</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><etal/></person-group><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>1083</fpage><lpage>1086</lpage><pub-id pub-id-type="pmcid">PMC5937676</pub-id><pub-id pub-id-type="pmid">28991892</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>H</given-names></name><name><surname>Kiryu</surname><given-names>H</given-names></name><name><surname>Furusawa</surname><given-names>C</given-names></name><name><surname>Ko</surname><given-names>MSH</given-names></name><name><surname>Ko</surname><given-names>SBH</given-names></name><name><surname>Gouda</surname><given-names>N</given-names></name><name><surname>Hayashi</surname><given-names>T</given-names></name><name><surname>Nikaido</surname><given-names>I</given-names></name></person-group><article-title>SCODE: an efficient regulatory network inference algorithm from single-cell RNA-Seq during differentiation</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>2314</fpage><lpage>2321</lpage><pub-id pub-id-type="pmcid">PMC5860123</pub-id><pub-id pub-id-type="pmid">28379368</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btx194</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Specht</surname><given-names>AT</given-names></name><name><surname>Li</surname><given-names>J</given-names></name></person-group><article-title>LEAP: constructing gene co-expression networks for single-cell RNA-sequencing data using pseudotime ordering</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>764</fpage><lpage>766</lpage><pub-id pub-id-type="pmcid">PMC5860270</pub-id><pub-id pub-id-type="pmid">27993778</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btw729</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>TE</given-names></name><name><surname>Stumpf</surname><given-names>MPH</given-names></name><name><surname>Babtie</surname><given-names>AC</given-names></name></person-group><article-title>Gene Regulatory Network Inference from Single-Cell Data Using Multivariate Information Measures</article-title><source>Cell Syst</source><year>2017</year><volume>5</volume><fpage>251</fpage><lpage>267</lpage><elocation-id>e3</elocation-id><pub-id pub-id-type="pmcid">PMC5624513</pub-id><pub-id pub-id-type="pmid">28957658</pub-id><pub-id pub-id-type="doi">10.1016/j.cels.2017.08.014</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Rahimzamani</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Durham</surname><given-names>T</given-names></name><name><surname>McFaline-Figueroa</surname><given-names>JL</given-names></name><name><surname>Saunders</surname><given-names>L</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Kannan</surname><given-names>S</given-names></name></person-group><article-title>Inferring Causal Gene Regulatory Networks from Coupled Single-Cell Expression Dynamics Using Scribe</article-title><source>Cell Syst</source><year>2020</year><volume>10</volume><fpage>265</fpage><lpage>274</lpage><elocation-id>e11</elocation-id><pub-id pub-id-type="pmcid">PMC7223477</pub-id><pub-id pub-id-type="pmid">32135093</pub-id><pub-id pub-id-type="doi">10.1016/j.cels.2020.02.003</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Martin-Rufino</surname><given-names>JD</given-names></name><name><surname>Weng</surname><given-names>C</given-names></name><name><surname>Hosseinzadeh</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>D</given-names></name><name><surname>Pogson</surname><given-names>AN</given-names></name><name><surname>Hein</surname><given-names>MY</given-names></name><name><surname>Hoi Joseph Min</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><etal/></person-group><article-title>Mapping transcriptomic vector fields of single cells</article-title><source>Cell</source><year>2022</year><volume>185</volume><fpage>690</fpage><lpage>711</lpage><elocation-id>e45</elocation-id><pub-id pub-id-type="pmcid">PMC9332140</pub-id><pub-id pub-id-type="pmid">35108499</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.12.045</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bravo González-Blas</surname><given-names>C</given-names></name><name><surname>De Winter</surname><given-names>S</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Hecker</surname><given-names>N</given-names></name><name><surname>Matetovici</surname><given-names>I</given-names></name><name><surname>Christiaens</surname><given-names>V</given-names></name><name><surname>Poovathingal</surname><given-names>S</given-names></name><name><surname>Wouters</surname><given-names>J</given-names></name><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><article-title>SCENIC+: single-cell multiomic inference of enhancers and gene regulatory networks</article-title><source>Nat Methods</source><year>2023</year><volume>20</volume><fpage>1355</fpage><lpage>1367</lpage><pub-id pub-id-type="pmcid">PMC10482700</pub-id><pub-id pub-id-type="pmid">37443338</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01938-4</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fleck</surname><given-names>JS</given-names></name><name><surname>Jansen</surname><given-names>SMJ</given-names></name><name><surname>Wollny</surname><given-names>D</given-names></name><name><surname>Zenk</surname><given-names>F</given-names></name><name><surname>Seimiya</surname><given-names>M</given-names></name><name><surname>Jain</surname><given-names>A</given-names></name><name><surname>Okamoto</surname><given-names>R</given-names></name><name><surname>Santel</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Camp</surname><given-names>JG</given-names></name><etal/></person-group><article-title>Inferring and perturbing cell fate regulomes in human brain organoids</article-title><source>Nature</source><year>2023</year><volume>621</volume><fpage>365</fpage><lpage>372</lpage><pub-id pub-id-type="pmcid">PMC10499607</pub-id><pub-id pub-id-type="pmid">36198796</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05279-8</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamimoto</surname><given-names>K</given-names></name><name><surname>Stringa</surname><given-names>B</given-names></name><name><surname>Hoffmann</surname><given-names>CM</given-names></name><name><surname>Jindal</surname><given-names>K</given-names></name><name><surname>Solnica-Krezel</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>SA</given-names></name></person-group><article-title>Dissecting cell identity via network inference and in silico gene perturbation</article-title><source>Nature</source><year>2023</year><volume>614</volume><fpage>742</fpage><lpage>751</lpage><pub-id pub-id-type="pmcid">PMC9946838</pub-id><pub-id pub-id-type="pmid">36755098</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05688-9</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Trasanidis</surname><given-names>N</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Dong</surname><given-names>G</given-names></name><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Bauer</surname><given-names>DE</given-names></name><name><surname>Pinello</surname><given-names>L</given-names></name></person-group><article-title>Dictys: dynamic gene regulatory network dissects developmental continuum with single-cell multiomics</article-title><source>Nat Methods</source><year>2023</year><volume>20</volume><fpage>1368</fpage><lpage>1378</lpage><pub-id pub-id-type="pmid">37537351</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>Q</given-names></name><name><surname>Duren</surname><given-names>Z</given-names></name></person-group><article-title>Inferring gene regulatory networks from single-cell multiome data using atlas-scale external data</article-title><source>Nat Biotechnol</source><year>2024</year><pub-id pub-id-type="pmid">38609714</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>M</given-names></name><name><surname>Qiao</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name></person-group><article-title>UniTVelo: temporally unified RNA velocity reinforces single-cell trajectory inference</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><elocation-id>6586</elocation-id><pub-id pub-id-type="pmcid">PMC9633790</pub-id><pub-id pub-id-type="pmid">36329018</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-34188-7</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Blaauw</surname><given-names>D</given-names></name><name><surname>Welch</surname><given-names>JD</given-names></name></person-group><article-title>Bayesian inference of RNA velocity from multi-lineage single-cell data</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="doi">10.1101/2022.07.08.499381</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aivazidis</surname><given-names>A</given-names></name><name><surname>Memi</surname><given-names>F</given-names></name><name><surname>Kleshchevnikov</surname><given-names>V</given-names></name><name><surname>Clarke</surname><given-names>B</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Bayraktar</surname><given-names>O</given-names></name></person-group><article-title>Model-based inference of RNA velocity modules improves cell fate prediction</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1101/2023.08.03.551650</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="regulation"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Pan</surname><given-names>X</given-names></name><name><surname>Yuan</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>H-B</given-names></name></person-group><article-title>TFvelo: gene regulation inspired RNA velocity estimation</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><elocation-id>1387</elocation-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>SA</given-names></name><name><surname>Jolma</surname><given-names>A</given-names></name><name><surname>Campitelli</surname><given-names>LF</given-names></name><name><surname>Das</surname><given-names>PK</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name><name><surname>Albu</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Weirauch</surname><given-names>MT</given-names></name></person-group><article-title>The Human Transcription Factors</article-title><source>Cell</source><year>2018</year><volume>172</volume><fpage>650</fpage><lpage>665</lpage><pub-id pub-id-type="pmid">29425488</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>LaFave</surname><given-names>LM</given-names></name><name><surname>Earl</surname><given-names>AS</given-names></name><name><surname>Chiang</surname><given-names>Z</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Ding</surname><given-names>J</given-names></name><name><surname>Brack</surname><given-names>A</given-names></name><name><surname>Kartha</surname><given-names>VK</given-names></name><name><surname>Tay</surname><given-names>T</given-names></name><etal/></person-group><article-title>Chromatin Potential Identified by Shared Single-Cell Profiling of RNA and Chromatin</article-title><source>Cell</source><year>2020</year><volume>183</volume><fpage>1103</fpage><lpage>1116</lpage><elocation-id>e20</elocation-id><pub-id pub-id-type="pmcid">PMC7669735</pub-id><pub-id pub-id-type="pmid">33098772</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.056</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="regulation"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Ortiz</surname><given-names>JA</given-names></name><name><surname>Taing</surname><given-names>L</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><name><surname>Lee</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Shin</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>SS</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Lei</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Cistrome: an integrative platform for transcriptional regulation studies</article-title><source>Genome Biol</source><year>2011</year><volume>12</volume><elocation-id>R83</elocation-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Pyne</surname><given-names>S</given-names></name><name><surname>Pietrzak</surname><given-names>S</given-names></name><name><surname>Halberg</surname><given-names>S</given-names></name><name><surname>McCalla</surname><given-names>SG</given-names></name><name><surname>Siahpirani</surname><given-names>AF</given-names></name><name><surname>Sridharan</surname><given-names>R</given-names></name><name><surname>Roy</surname><given-names>S</given-names></name></person-group><article-title>Inference of cell type-specific gene regulatory networks on cell lineages from single cell omic datasets</article-title><source>Nat Commun</source><year>2023</year><volume>14</volume><elocation-id>3064</elocation-id><pub-id pub-id-type="pmcid">PMC10224950</pub-id><pub-id pub-id-type="pmid">37244909</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-38637-9</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C-H</given-names></name><name><surname>Zheng</surname><given-names>R</given-names></name><name><surname>Tokheim</surname><given-names>C</given-names></name><name><surname>Dong</surname><given-names>X</given-names></name><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Wan</surname><given-names>C</given-names></name><name><surname>Tang</surname><given-names>Q</given-names></name><name><surname>Brown</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><etal/></person-group><article-title>Determinants of transcription factor regulatory range</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>2472</elocation-id><pub-id pub-id-type="pmcid">PMC7235260</pub-id><pub-id pub-id-type="pmid">32424124</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-16106-x</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lienen</surname><given-names>M</given-names></name><name><surname>Günnemann</surname><given-names>S</given-names></name></person-group><article-title>torchode: A Parallel ODE Solver for PyTorch</article-title><year>2022</year><pub-id pub-id-type="doi">10.48550/ARXIV.2210.12375</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><article-title>Auto-Encoding Variational Bayes</article-title><year>2013</year><pub-id pub-id-type="doi">10.48550/ARXIV.1312.6114</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahdessian</surname><given-names>D</given-names></name><name><surname>Cesnik</surname><given-names>AJ</given-names></name><name><surname>Gnann</surname><given-names>C</given-names></name><name><surname>Danielsson</surname><given-names>F</given-names></name><name><surname>Stenström</surname><given-names>L</given-names></name><name><surname>Arif</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Le</surname><given-names>T</given-names></name><name><surname>Johansson</surname><given-names>F</given-names></name><name><surname>Schutten</surname><given-names>R</given-names></name><etal/></person-group><article-title>Spatiotemporal dissection of the cell cycle with single-cell proteogenomics</article-title><source>Nature</source><year>2021</year><volume>590</volume><fpage>649</fpage><lpage>654</lpage><pub-id pub-id-type="pmid">33627808</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiebinger</surname><given-names>G</given-names></name><name><surname>Shu</surname><given-names>J</given-names></name><name><surname>Tabaka</surname><given-names>M</given-names></name><name><surname>Cleary</surname><given-names>B</given-names></name><name><surname>Subramanian</surname><given-names>V</given-names></name><name><surname>Solomon</surname><given-names>A</given-names></name><name><surname>Gould</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Berube</surname><given-names>P</given-names></name><etal/></person-group><article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title><source>Cell</source><year>2019</year><volume>176</volume><fpage>928</fpage><lpage>943</lpage><elocation-id>e22</elocation-id><pub-id pub-id-type="pmcid">PMC6615720</pub-id><pub-id pub-id-type="pmid">30849376</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.026</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>SS</given-names></name><name><surname>McKeon</surname><given-names>F</given-names></name></person-group><article-title>Kinetochore localization of murine Bub1 is required for normal mitotic timing and checkpoint response to spindle damage</article-title><source>Cell</source><year>1997</year><volume>89</volume><fpage>727</fpage><lpage>735</lpage><pub-id pub-id-type="pmid">9182760</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bandara</surname><given-names>LR</given-names></name><name><surname>Lam</surname><given-names>EW</given-names></name><name><surname>Sørensen</surname><given-names>TS</given-names></name><name><surname>Zamanian</surname><given-names>M</given-names></name><name><surname>Girling</surname><given-names>R</given-names></name><name><surname>La Thangue</surname><given-names>NB</given-names></name></person-group><article-title>DP-1: a cell cycle-regulated and phosphorylated component of transcription factor DRTF1/E2F which is functionally important for recognition by pRb and the adenovirus E4 orf 6/7 protein</article-title><source>EMBO J</source><year>1994</year><volume>13</volume><fpage>3104</fpage><lpage>3114</lpage><pub-id pub-id-type="pmcid">PMC395201</pub-id><pub-id pub-id-type="pmid">8039504</pub-id><pub-id pub-id-type="doi">10.1002/j.1460-2075.1994.tb06609.x</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>CF</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Barisic</surname><given-names>M</given-names></name><name><surname>Kalitsis</surname><given-names>P</given-names></name><name><surname>Hudson</surname><given-names>DF</given-names></name></person-group><article-title>Topoisomerase IIα is essential for maintenance of mitotic chromosome structure</article-title><source>Proc Natl Acad Sci U S A</source><year>2020</year><volume>117</volume><fpage>12131</fpage><lpage>12142</lpage><pub-id pub-id-type="pmcid">PMC7275761</pub-id><pub-id pub-id-type="pmid">32414923</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2001760117</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogata</surname><given-names>H</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Fujibuchi</surname><given-names>W</given-names></name><name><surname>Bono</surname><given-names>H</given-names></name><name><surname>Kanehisa</surname><given-names>M</given-names></name></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title><source>Nucleic Acids Res</source><year>1999</year><volume>27</volume><fpage>29</fpage><lpage>34</lpage><pub-id pub-id-type="pmcid">PMC148090</pub-id><pub-id pub-id-type="pmid">9847135</pub-id><pub-id pub-id-type="doi">10.1093/nar/27.1.29</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>Z</given-names></name><name><surname>Ohta</surname><given-names>T</given-names></name><name><surname>Miura</surname><given-names>F</given-names></name><name><surname>Oki</surname><given-names>S</given-names></name></person-group><article-title>ChIP-Atlas 2021 update: a data-mining suite for exploring epigenomic landscapes by fully integrating ChIP-seq, ATAC-seq and Bisulfite-seq data</article-title><source>Nucleic Acids Res</source><year>2022</year><volume>50</volume><fpage>W175</fpage><lpage>W182</lpage><pub-id pub-id-type="pmcid">PMC9252733</pub-id><pub-id pub-id-type="pmid">35325188</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac199</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Aibar Santos</surname><given-names>S</given-names></name><name><surname>Bravo González-Blas</surname><given-names>C</given-names></name><name><surname>Simm</surname><given-names>J</given-names></name><name><surname>Moreau</surname><given-names>Y</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><article-title>GRNBoost2 and Arboreto: efficient and scalable inference of gene regulatory networks</article-title><source>Bioinformatics</source><year>2019</year><volume>35</volume><fpage>2159</fpage><lpage>2161</lpage><pub-id pub-id-type="pmid">30445495</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastidas-Ponce</surname><given-names>A</given-names></name><name><surname>Tritschler</surname><given-names>S</given-names></name><name><surname>Dony</surname><given-names>L</given-names></name><name><surname>Scheibner</surname><given-names>K</given-names></name><name><surname>Tarquis-Medina</surname><given-names>M</given-names></name><name><surname>Salinno</surname><given-names>C</given-names></name><name><surname>Schirge</surname><given-names>S</given-names></name><name><surname>Burtscher</surname><given-names>I</given-names></name><name><surname>Böttcher</surname><given-names>A</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><etal/></person-group><article-title>Comprehensive single cell mRNA profiling reveals a detailed roadmap for pancreatic endocrinogenesis</article-title><source>Development</source><year>2019</year><volume>146</volume><pub-id pub-id-type="pmid">31160421</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>D</given-names></name><name><surname>Palla</surname><given-names>G</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Piran</surname><given-names>Z</given-names></name><name><surname>Gander</surname><given-names>M</given-names></name><name><surname>Meng-Papaxanthos</surname><given-names>L</given-names></name><name><surname>Sterr</surname><given-names>M</given-names></name><name><surname>Bastidas-Ponce</surname><given-names>A</given-names></name><name><surname>Tarquis-Medina</surname><given-names>M</given-names></name><etal/></person-group><article-title>Mapping cells through time and space with moscot</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1101/2023.05.11.540374</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>X-X</given-names></name><name><surname>Qiu</surname><given-names>W-L</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>Y-C</given-names></name><name><surname>He</surname><given-names>M-Y</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>L-C</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Sequential progenitor states mark the generation of pancreatic endocrine lineages in mice and humans</article-title><source>Cell Res</source><year>2021</year><volume>31</volume><fpage>886</fpage><lpage>903</lpage><pub-id pub-id-type="pmcid">PMC8324815</pub-id><pub-id pub-id-type="pmid">33692492</pub-id><pub-id pub-id-type="doi">10.1038/s41422-021-00486-w</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bohuslavova</surname><given-names>R</given-names></name><name><surname>Fabriciova</surname><given-names>V</given-names></name><name><surname>Lebrón-Mora</surname><given-names>L</given-names></name><name><surname>Malfatti</surname><given-names>J</given-names></name><name><surname>Smolik</surname><given-names>O</given-names></name><name><surname>Valihrach</surname><given-names>L</given-names></name><name><surname>Benesova</surname><given-names>S</given-names></name><name><surname>Zucha</surname><given-names>D</given-names></name><name><surname>Berkova</surname><given-names>Z</given-names></name><name><surname>Saudek</surname><given-names>F</given-names></name><etal/></person-group><article-title>ISL1 controls pancreatic alpha cell fate and beta cell maturation</article-title><source>Cell Biosci</source><year>2023</year><volume>13</volume><fpage>53</fpage><pub-id pub-id-type="pmcid">PMC9999528</pub-id><pub-id pub-id-type="pmid">36899442</pub-id><pub-id pub-id-type="doi">10.1186/s13578-023-01003-9</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baron</surname><given-names>M</given-names></name><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Wolock</surname><given-names>SL</given-names></name><name><surname>Faust</surname><given-names>AL</given-names></name><name><surname>Gaujoux</surname><given-names>R</given-names></name><name><surname>Vetere</surname><given-names>A</given-names></name><name><surname>Ryu</surname><given-names>JH</given-names></name><name><surname>Wagner</surname><given-names>BK</given-names></name><name><surname>Shen-Orr</surname><given-names>SS</given-names></name><name><surname>Klein</surname><given-names>AM</given-names></name><etal/></person-group><article-title>A Single-Cell Transcriptomic Map of the Human and Mouse Pancreas Reveals Inter- and Intra-cell Population Structure</article-title><source>Cell Syst</source><year>2016</year><volume>3</volume><fpage>346</fpage><lpage>360</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC5228327</pub-id><pub-id pub-id-type="pmid">27667365</pub-id><pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duvall</surname><given-names>E</given-names></name><name><surname>Benitez</surname><given-names>CM</given-names></name><name><surname>Tellez</surname><given-names>K</given-names></name><name><surname>Enge</surname><given-names>M</given-names></name><name><surname>Pauerstein</surname><given-names>PT</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Baek</surname><given-names>S</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Smith</surname><given-names>JP</given-names></name><name><surname>Sheffield</surname><given-names>NC</given-names></name><etal/></person-group><article-title>Single-cell transcriptome and accessible chromatin dynamics during endocrine pancreas development</article-title><source>Proc Natl Acad Sci U S A</source><year>2022</year><volume>119</volume><elocation-id>e2201267119</elocation-id><pub-id pub-id-type="pmcid">PMC9245718</pub-id><pub-id pub-id-type="pmid">35733248</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2201267119</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heller</surname><given-names>RS</given-names></name><name><surname>Jenny</surname><given-names>M</given-names></name><name><surname>Collombat</surname><given-names>P</given-names></name><name><surname>Mansouri</surname><given-names>A</given-names></name><name><surname>Tomasetto</surname><given-names>C</given-names></name><name><surname>Madsen</surname><given-names>OD</given-names></name><name><surname>Mellitzer</surname><given-names>G</given-names></name><name><surname>Gradwohl</surname><given-names>G</given-names></name><name><surname>Serup</surname><given-names>P</given-names></name></person-group><article-title>Genetic determinants of pancreatic epsilon-cell development</article-title><source>Dev Biol</source><year>2005</year><volume>286</volume><fpage>217</fpage><lpage>224</lpage><pub-id pub-id-type="pmid">16122727</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shan</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>WH</given-names></name></person-group><article-title>Deregulated expression of E2F-1 induces S-phase entry and leads to apoptosis</article-title><source>Mol Cell Biol</source><year>1994</year><volume>14</volume><fpage>8166</fpage><lpage>8173</lpage><pub-id pub-id-type="pmcid">PMC359355</pub-id><pub-id pub-id-type="pmid">7969153</pub-id><pub-id pub-id-type="doi">10.1128/mcb.14.12.8166</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>W</given-names></name><name><surname>Giangrande</surname><given-names>PH</given-names></name><name><surname>Nevins</surname><given-names>JR</given-names></name></person-group><article-title>E2Fs link the control of G1/S and G2/M transcription</article-title><source>EMBO J</source><year>2004</year><volume>23</volume><fpage>4615</fpage><lpage>4626</lpage><pub-id pub-id-type="pmcid">PMC533046</pub-id><pub-id pub-id-type="pmid">15510213</pub-id><pub-id pub-id-type="doi">10.1038/sj.emboj.7600459</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xing</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Mei</surname><given-names>Y</given-names></name><name><surname>Yamamoto</surname><given-names>K</given-names></name><name><surname>Mak</surname><given-names>TW</given-names></name><name><surname>You</surname><given-names>H</given-names></name></person-group><article-title>Regulation of cell cycle progression by forkhead transcription factor FOXO3 through its binding partner DNA replication factor Cdt1</article-title><source>Proc Natl Acad Sci U S A</source><year>2012</year><volume>109</volume><fpage>5717</fpage><lpage>5722</lpage><pub-id pub-id-type="pmcid">PMC3326503</pub-id><pub-id pub-id-type="pmid">22451935</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1203210109</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tien</surname><given-names>AL</given-names></name><name><surname>Senbanerjee</surname><given-names>S</given-names></name><name><surname>Kulkarni</surname><given-names>A</given-names></name><name><surname>Mudbhary</surname><given-names>R</given-names></name><name><surname>Goudreau</surname><given-names>B</given-names></name><name><surname>Ganesan</surname><given-names>S</given-names></name><name><surname>Sadler</surname><given-names>KC</given-names></name><name><surname>Ukomadu</surname><given-names>C</given-names></name></person-group><article-title>UHRF1 depletion causes a G2/M arrest, activation of DNA damage response and apoptosis</article-title><source>Biochem J</source><year>2011</year><volume>435</volume><fpage>175</fpage><lpage>185</lpage><pub-id pub-id-type="pmcid">PMC3291200</pub-id><pub-id pub-id-type="pmid">21214517</pub-id><pub-id pub-id-type="doi">10.1042/BJ20100840</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname><given-names>CI</given-names></name><name><surname>Atweh</surname><given-names>GF</given-names></name></person-group><article-title>The role of stathmin in the regulation of the cell cycle</article-title><source>J Cell Biochem</source><year>2004</year><volume>93</volume><fpage>242</fpage><lpage>250</lpage><pub-id pub-id-type="pmid">15368352</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lasorella</surname><given-names>A</given-names></name><name><surname>Iavarone</surname><given-names>A</given-names></name><name><surname>Israel</surname><given-names>MA</given-names></name></person-group><article-title>Id2 specifically alters regulation of the cell cycle by tumor suppressor proteins</article-title><source>Mol Cell Biol</source><year>1996</year><volume>16</volume><fpage>2570</fpage><lpage>2578</lpage><pub-id pub-id-type="pmcid">PMC231247</pub-id><pub-id pub-id-type="pmid">8649364</pub-id><pub-id pub-id-type="doi">10.1128/mcb.16.6.2570</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>C</given-names></name><name><surname>Stillman</surname><given-names>B</given-names></name></person-group><article-title>Persistent initiation of DNA replication and chromatin-bound MCM proteins during the cell cycle in cdc6 mutants</article-title><source>Genes Dev</source><year>1997</year><volume>11</volume><fpage>3375</fpage><lpage>3386</lpage><pub-id pub-id-type="pmcid">PMC316796</pub-id><pub-id pub-id-type="pmid">9407030</pub-id><pub-id pub-id-type="doi">10.1101/gad.11.24.3375</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>SC</given-names></name><name><surname>Benavente</surname><given-names>CA</given-names></name></person-group><article-title>Chromatin remodeling protein HELLS is upregulated by inactivation of the RB-E2F pathway and is nonessential for osteosarcoma tumorigenesis</article-title><source>Oncotarget</source><year>2018</year><volume>9</volume><fpage>32580</fpage><lpage>32592</lpage><pub-id pub-id-type="pmcid">PMC6135688</pub-id><pub-id pub-id-type="pmid">30220967</pub-id><pub-id pub-id-type="doi">10.18632/oncotarget.25953</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Cheng</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><etal/></person-group><article-title>CENPK orchestrates ovarian cancer progression via GOLPH3-Mediated activation of mTOR signaling</article-title><source>Mol Cell Endocrinol</source><year>2024</year><volume>589</volume><elocation-id>112253</elocation-id><pub-id pub-id-type="pmid">38670220</pub-id></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collombat</surname><given-names>P</given-names></name><name><surname>Hecksher-Sørensen</surname><given-names>J</given-names></name><name><surname>Krull</surname><given-names>J</given-names></name><name><surname>Berger</surname><given-names>J</given-names></name><name><surname>Riedel</surname><given-names>D</given-names></name><name><surname>Herrera</surname><given-names>PL</given-names></name><name><surname>Serup</surname><given-names>P</given-names></name><name><surname>Mansouri</surname><given-names>A</given-names></name></person-group><article-title>Embryonic endocrine pancreas and mature beta cells acquire alpha and PP cell phenotypes upon Arx misexpression</article-title><source>J Clin Invest</source><year>2007</year><volume>117</volume><fpage>961</fpage><lpage>970</lpage><pub-id pub-id-type="pmcid">PMC1839241</pub-id><pub-id pub-id-type="pmid">17404619</pub-id><pub-id pub-id-type="doi">10.1172/JCI29115</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>T</given-names></name><name><surname>McKenna</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Reichert</surname><given-names>M</given-names></name><name><surname>Nguyen</surname><given-names>J</given-names></name><name><surname>Singh</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>C</given-names></name><name><surname>Pannikar</surname><given-names>A</given-names></name><name><surname>Doliba</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><etal/></person-group><article-title>Pdx1 maintains β cell identity and function by repressing an α cell program</article-title><source>Cell Metab</source><year>2014</year><volume>19</volume><fpage>259</fpage><lpage>271</lpage><pub-id pub-id-type="pmcid">PMC3950964</pub-id><pub-id pub-id-type="pmid">24506867</pub-id><pub-id pub-id-type="doi">10.1016/j.cmet.2013.12.002</pub-id></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>FC</given-names></name><name><surname>Brissova</surname><given-names>M</given-names></name><name><surname>Powers</surname><given-names>AC</given-names></name><name><surname>Pfaff</surname><given-names>S</given-names></name><name><surname>Wright</surname><given-names>CVE</given-names></name></person-group><article-title>Inactivating the permanent neonatal diabetes gene Mnx1 switches insulin-producing β-cells to a δ-like fate and reveals a facultative proliferative capacity in aged β-cells</article-title><source>Development</source><year>2015</year><volume>142</volume><fpage>3637</fpage><lpage>3648</lpage><pub-id pub-id-type="pmcid">PMC4647212</pub-id><pub-id pub-id-type="pmid">26534984</pub-id><pub-id pub-id-type="doi">10.1242/dev.126011</pub-id></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>McKenna</surname><given-names>LB</given-names></name><name><surname>Bogue</surname><given-names>CW</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name></person-group><article-title>The diabetes gene Hhex maintains δ-cell differentiation and islet function</article-title><source>Genes Dev</source><year>2014</year><volume>28</volume><fpage>829</fpage><lpage>834</lpage><pub-id pub-id-type="pmcid">PMC4003275</pub-id><pub-id pub-id-type="pmid">24736842</pub-id><pub-id pub-id-type="doi">10.1101/gad.235499.113</pub-id></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cota</surname><given-names>P</given-names></name><name><surname>Saber</surname><given-names>L</given-names></name><name><surname>Taskin</surname><given-names>D</given-names></name><name><surname>Jing</surname><given-names>C</given-names></name><name><surname>Bastidas-Ponce</surname><given-names>A</given-names></name><name><surname>Vanheusden</surname><given-names>M</given-names></name><name><surname>Shahryari</surname><given-names>A</given-names></name><name><surname>Sterr</surname><given-names>M</given-names></name><name><surname>Burtscher</surname><given-names>I</given-names></name><name><surname>Bakhti</surname><given-names>M</given-names></name><etal/></person-group><article-title>NEUROD2 function is dispensable for human pancreatic β cell specification</article-title><source>Front Endocrinol</source><year>2023</year><volume>14</volume><elocation-id>1286590</elocation-id><pub-id pub-id-type="pmcid">PMC10634430</pub-id><pub-id pub-id-type="pmid">37955006</pub-id><pub-id pub-id-type="doi">10.3389/fendo.2023.1286590</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soyer</surname><given-names>J</given-names></name><name><surname>Flasse</surname><given-names>L</given-names></name><name><surname>Raffelsberger</surname><given-names>W</given-names></name><name><surname>Beucher</surname><given-names>A</given-names></name><name><surname>Orvain</surname><given-names>C</given-names></name><name><surname>Peers</surname><given-names>B</given-names></name><name><surname>Ravassard</surname><given-names>P</given-names></name><name><surname>Vermot</surname><given-names>J</given-names></name><name><surname>Voz</surname><given-names>ML</given-names></name><name><surname>Mellitzer</surname><given-names>G</given-names></name><etal/></person-group><article-title>Rfx6 is an Ngn3-dependent winged helix transcription factor required for pancreatic islet cell development</article-title><source>Development</source><year>2010</year><volume>137</volume><fpage>203</fpage><lpage>212</lpage><pub-id pub-id-type="pmcid">PMC2799156</pub-id><pub-id pub-id-type="pmid">20040487</pub-id><pub-id pub-id-type="doi">10.1242/dev.041673</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barile</surname><given-names>M</given-names></name><name><surname>Imaz-Rosshandler</surname><given-names>I</given-names></name><name><surname>Inzani</surname><given-names>I</given-names></name><name><surname>Ghazanfar</surname><given-names>S</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Guibentif</surname><given-names>C</given-names></name><name><surname>Göttgens</surname><given-names>B</given-names></name></person-group><article-title>Coordinated changes in gene expression kinetics underlie both mouse and human erythroid maturation</article-title><source>Genome Biol</source><year>2021</year><volume>22</volume><fpage>197</fpage><pub-id pub-id-type="pmcid">PMC8258993</pub-id><pub-id pub-id-type="pmid">34225769</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02414-y</pub-id></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiler</surname><given-names>P</given-names></name><name><surname>Van den Berge</surname><given-names>K</given-names></name><name><surname>Street</surname><given-names>K</given-names></name><name><surname>Tiberi</surname><given-names>S</given-names></name></person-group><article-title>A Guide to Trajectory Inference and RNA Velocity</article-title><source>Methods Mol Biol</source><year>2023</year><volume>2584</volume><fpage>269</fpage><lpage>292</lpage><pub-id pub-id-type="pmid">36495456</pub-id></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puig</surname><given-names>RR</given-names></name><name><surname>Boddie</surname><given-names>P</given-names></name><name><surname>Khan</surname><given-names>A</given-names></name><name><surname>Castro-Mondragon</surname><given-names>JA</given-names></name><name><surname>Mathelier</surname><given-names>A</given-names></name></person-group><article-title>UniBind: maps of high-confidence direct TF-DNA interactions across nine species</article-title><source>BMC Genomics</source><year>2021</year><volume>22</volume><fpage>482</fpage><pub-id pub-id-type="pmcid">PMC8236138</pub-id><pub-id pub-id-type="pmid">34174819</pub-id><pub-id pub-id-type="doi">10.1186/s12864-021-07760-6</pub-id></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwasaki</surname><given-names>H</given-names></name><name><surname>Mizuno</surname><given-names>S-I</given-names></name><name><surname>Wells</surname><given-names>RA</given-names></name><name><surname>Cantor</surname><given-names>AB</given-names></name><name><surname>Watanabe</surname><given-names>S</given-names></name><name><surname>Akashi</surname><given-names>K</given-names></name></person-group><article-title>GATA-1 converts lymphoid and myelomonocytic progenitors into the megakaryocyte/erythrocyte lineages</article-title><source>Immunity</source><year>2003</year><volume>19</volume><fpage>451</fpage><lpage>462</lpage><pub-id pub-id-type="pmid">14499119</pub-id></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>HM</given-names></name><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Voso</surname><given-names>MT</given-names></name><name><surname>Hohaus</surname><given-names>S</given-names></name><name><surname>Gonzalez</surname><given-names>DA</given-names></name><name><surname>Glass</surname><given-names>CK</given-names></name><name><surname>Zhang</surname><given-names>DE</given-names></name><name><surname>Tenen</surname><given-names>DG</given-names></name></person-group><article-title>Neutrophils and monocytes express high levels of PU.1 (Spi-1) but not Spi-B</article-title><source>Blood</source><year>1995</year><volume>85</volume><fpage>2918</fpage><lpage>2928</lpage><pub-id pub-id-type="pmid">7742552</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Iwama</surname><given-names>A</given-names></name><name><surname>Yu</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Mueller</surname><given-names>BU</given-names></name><name><surname>Narravula</surname><given-names>S</given-names></name><name><surname>Torbett</surname><given-names>BE</given-names></name><name><surname>Orkin</surname><given-names>SH</given-names></name><name><surname>Tenen</surname><given-names>DG</given-names></name></person-group><article-title>PU.1 inhibits GATA-1 function and erythroid differentiation by blocking GATA-1 DNA binding</article-title><source>Blood</source><year>2000</year><volume>96</volume><fpage>2641</fpage><lpage>2648</lpage><pub-id pub-id-type="pmid">11023493</pub-id></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nerlov</surname><given-names>C</given-names></name><name><surname>Querfurth</surname><given-names>E</given-names></name><name><surname>Kulessa</surname><given-names>H</given-names></name><name><surname>Graf</surname><given-names>T</given-names></name></person-group><article-title>GATA-1 interacts with the myeloid PU.1 transcription factor and represses PU.1-dependent transcription</article-title><source>Blood</source><year>2000</year><volume>95</volume><fpage>2543</fpage><lpage>2551</lpage><pub-id pub-id-type="pmid">10753833</pub-id></element-citation></ref><ref id="R76"><label>76</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horak</surname><given-names>CE</given-names></name><name><surname>Mahajan</surname><given-names>MC</given-names></name><name><surname>Luscombe</surname><given-names>NM</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Weissman</surname><given-names>SM</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name></person-group><article-title>GATA-1 binding sites mapped in the beta-globin locus by using mammalian chIp-chip analysis</article-title><source>Proc Natl Acad Sci U S A</source><year>2002</year><volume>99</volume><fpage>2924</fpage><lpage>2929</lpage><pub-id pub-id-type="pmcid">PMC122449</pub-id><pub-id pub-id-type="pmid">11867748</pub-id><pub-id pub-id-type="doi">10.1073/pnas.052706999</pub-id></element-citation></ref><ref id="R77"><label>77</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aliee</surname><given-names>H</given-names></name><name><surname>Richter</surname><given-names>T</given-names></name><name><surname>Solonin</surname><given-names>M</given-names></name><name><surname>Ibarra</surname><given-names>I</given-names></name><name><surname>Theis</surname><given-names>F</given-names></name><name><surname>Kilbertus</surname><given-names>N</given-names></name></person-group><article-title>Sparsity in continuous-depth neural networks</article-title><source>arXiv [csLG]</source><year>2022</year><pub-id pub-id-type="doi">10.48550/ARXIV.2210.14672</pub-id></element-citation></ref><ref id="R78"><label>78</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edens</surname><given-names>BM</given-names></name><name><surname>Stundl</surname><given-names>J</given-names></name><name><surname>Urrutia</surname><given-names>HA</given-names></name><name><surname>Bronner</surname><given-names>ME</given-names></name></person-group><article-title>Neural crest origin of sympathetic neurons at the dawn of vertebrates</article-title><source>Nature</source><year>2024</year><volume>629</volume><fpage>121</fpage><lpage>126</lpage><pub-id pub-id-type="pmcid">PMC11391089</pub-id><pub-id pub-id-type="pmid">38632395</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07297-0</pub-id></element-citation></ref><ref id="R79"><label>79</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Morgunova</surname><given-names>E</given-names></name><name><surname>Naqvi</surname><given-names>S</given-names></name><name><surname>Goovaerts</surname><given-names>S</given-names></name><name><surname>Bader</surname><given-names>M</given-names></name><name><surname>Koska</surname><given-names>M</given-names></name><name><surname>Popov</surname><given-names>A</given-names></name><name><surname>Luong</surname><given-names>C</given-names></name><name><surname>Pogson</surname><given-names>A</given-names></name><name><surname>Swigut</surname><given-names>T</given-names></name><etal/></person-group><article-title>DNA-guided transcription factor cooperativity shapes face and limb mesenchyme</article-title><source>Cell</source><year>2024</year><volume>187</volume><fpage>692</fpage><lpage>711</lpage><elocation-id>e26</elocation-id><pub-id pub-id-type="pmcid">PMC10872279</pub-id><pub-id pub-id-type="pmid">38262408</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2023.12.032</pub-id></element-citation></ref><ref id="R80"><label>80</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Sauka-Spengler</surname><given-names>T</given-names></name></person-group><article-title>Cellular plasticity in the neural crest and cancer</article-title><source>Curr Opin Genet Dev</source><year>2022</year><volume>75</volume><elocation-id>101928</elocation-id><pub-id pub-id-type="pmid">35749971</pub-id></element-citation></ref><ref id="R81"><label>81</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagemann-Jensen</surname><given-names>M</given-names></name><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>Ramsköld</surname><given-names>D</given-names></name><name><surname>Hendriks</surname><given-names>G-J</given-names></name><name><surname>Larsson</surname><given-names>AJM</given-names></name><name><surname>Faridani</surname><given-names>OR</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name></person-group><article-title>Single-cell RNA counting at allele and isoform resolution using Smart-seq3</article-title><source>Nat Biotechnol</source><year>2020</year><volume>38</volume><fpage>708</fpage><lpage>714</lpage><pub-id pub-id-type="pmid">32518404</pub-id></element-citation></ref><ref id="R82"><label>82</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Mayes</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Santos-Pereira</surname><given-names>JM</given-names></name><name><surname>Theis</surname><given-names>F</given-names></name><name><surname>Sauka-Spengler</surname><given-names>T</given-names></name></person-group><article-title>Single-cell multi-omics, spatial transcriptomics and systematic perturbation decode circuitry of neural crest fate decisions</article-title><source>bioRxiv</source><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.09.17.613303</pub-id></element-citation></ref><ref id="R83"><label>83</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rocha</surname><given-names>M</given-names></name><name><surname>Singh</surname><given-names>N</given-names></name><name><surname>Ahsan</surname><given-names>K</given-names></name><name><surname>Beiriger</surname><given-names>A</given-names></name><name><surname>Prince</surname><given-names>VE</given-names></name></person-group><article-title>Neural crest development: insights from the zebrafish</article-title><source>Dev Dyn</source><year>2020</year><volume>249</volume><fpage>88</fpage><lpage>111</lpage><pub-id pub-id-type="pmcid">PMC7273345</pub-id><pub-id pub-id-type="pmid">31591788</pub-id><pub-id pub-id-type="doi">10.1002/dvdy.122</pub-id></element-citation></ref><ref id="R84"><label>84</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Opdecamp</surname><given-names>K</given-names></name><name><surname>Nakayama</surname><given-names>A</given-names></name><name><surname>Nguyen</surname><given-names>MT</given-names></name><name><surname>Hodgkinson</surname><given-names>CA</given-names></name><name><surname>Pavan</surname><given-names>WJ</given-names></name><name><surname>Arnheiter</surname><given-names>H</given-names></name></person-group><article-title>Melanocyte development in vivo and in neural crest cell cultures: crucial dependence on the Mitf basic-helix-loop-helix-zipper transcription factor</article-title><source>Development</source><year>1997</year><volume>124</volume><fpage>2377</fpage><lpage>2386</lpage><pub-id pub-id-type="pmid">9199364</pub-id></element-citation></ref><ref id="R85"><label>85</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aoki</surname><given-names>Y</given-names></name><name><surname>Saint-Germain</surname><given-names>N</given-names></name><name><surname>Gyda</surname><given-names>M</given-names></name><name><surname>Magner-Fink</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>Y-H</given-names></name><name><surname>Credidio</surname><given-names>C</given-names></name><name><surname>Saint-Jeannet</surname><given-names>J-P</given-names></name></person-group><article-title>Sox10 regulates the development of neural crest-derived melanocytes in Xenopus</article-title><source>Dev Biol</source><year>2003</year><volume>259</volume><fpage>19</fpage><lpage>33</lpage><pub-id pub-id-type="pmid">12812785</pub-id></element-citation></ref><ref id="R86"><label>86</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spokony</surname><given-names>RF</given-names></name><name><surname>Aoki</surname><given-names>Y</given-names></name><name><surname>Saint-Germain</surname><given-names>N</given-names></name><name><surname>Magner-Fink</surname><given-names>E</given-names></name><name><surname>Saint-Jeannet</surname><given-names>J-P</given-names></name></person-group><article-title>The transcription factor Sox9 is required for cranial neural crest development in Xenopus</article-title><source>Development</source><year>2002</year><volume>129</volume><fpage>421</fpage><lpage>432</lpage><pub-id pub-id-type="pmid">11807034</pub-id></element-citation></ref><ref id="R87"><label>87</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okeke</surname><given-names>C</given-names></name><name><surname>Paulding</surname><given-names>D</given-names></name><name><surname>Riedel</surname><given-names>A</given-names></name><name><surname>Paudel</surname><given-names>S</given-names></name><name><surname>Phelan</surname><given-names>C</given-names></name><name><surname>Teng</surname><given-names>CS</given-names></name><name><surname>Barske</surname><given-names>L</given-names></name></person-group><article-title>Control of cranial ectomesenchyme fate by Nr2f nuclear receptors</article-title><source>Development</source><year>2022</year><volume>149</volume><pub-id pub-id-type="pmcid">PMC10114104</pub-id><pub-id pub-id-type="pmid">36367707</pub-id><pub-id pub-id-type="doi">10.1242/dev.201133</pub-id></element-citation></ref><ref id="R88"><label>88</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soo</surname><given-names>K</given-names></name><name><surname>O’Rourke</surname><given-names>MP</given-names></name><name><surname>Khoo</surname><given-names>P-L</given-names></name><name><surname>Steiner</surname><given-names>KA</given-names></name><name><surname>Wong</surname><given-names>N</given-names></name><name><surname>Behringer</surname><given-names>RR</given-names></name><name><surname>Tam</surname><given-names>PPL</given-names></name></person-group><article-title>Twist function is required for the morphogenesis of the cephalic neural tube and the differentiation of the cranial neural crest cells in the mouse embryo</article-title><source>Dev Biol</source><year>2002</year><volume>247</volume><fpage>251</fpage><lpage>270</lpage><pub-id pub-id-type="pmid">12086465</pub-id></element-citation></ref><ref id="R89"><label>89</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Kam</surname><given-names>RKT</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Du</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>G</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><etal/></person-group><article-title>The proto-oncogene transcription factor Ets1 regulates neural crest development through histone deacetylase 1 to mediate output of bone morphogenetic protein signaling</article-title><source>J Biol Chem</source><year>2015</year><volume>290</volume><fpage>21925</fpage><lpage>21938</lpage><pub-id pub-id-type="pmcid">PMC4571947</pub-id><pub-id pub-id-type="pmid">26198637</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M115.644864</pub-id></element-citation></ref><ref id="R90"><label>90</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Y-L</given-names></name><name><surname>Willoughby</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Crump</surname><given-names>JG</given-names></name><name><surname>Wilson</surname><given-names>C</given-names></name><name><surname>Miller</surname><given-names>CT</given-names></name><name><surname>Singer</surname><given-names>A</given-names></name><name><surname>Kimmel</surname><given-names>C</given-names></name><name><surname>Westerfield</surname><given-names>M</given-names></name><name><surname>Postlethwait</surname><given-names>JH</given-names></name></person-group><article-title>A pair of Sox: distinct and overlapping functions of zebrafish sox9 co-orthologs in craniofacial and pectoral fin development</article-title><source>Development</source><year>2005</year><volume>132</volume><fpage>1069</fpage><lpage>1083</lpage><pub-id pub-id-type="pmid">15689370</pub-id></element-citation></ref><ref id="R91"><label>91</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>A</given-names></name><name><surname>Crump</surname><given-names>JG</given-names></name></person-group><article-title>Bmps and id2a act upstream of Twist1 to restrict ectomesenchyme potential of the cranial neural crest</article-title><source>PLoS Genet</source><year>2012</year><volume>8</volume><elocation-id>e1002710</elocation-id><pub-id pub-id-type="pmcid">PMC3349740</pub-id><pub-id pub-id-type="pmid">22589745</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002710</pub-id></element-citation></ref><ref id="R92"><label>92</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Replogle</surname><given-names>JM</given-names></name><name><surname>Norman</surname><given-names>TM</given-names></name><name><surname>Xu</surname><given-names>A</given-names></name><name><surname>Hussmann</surname><given-names>JA</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Cogan</surname><given-names>JZ</given-names></name><name><surname>Meer</surname><given-names>EJ</given-names></name><name><surname>Terry</surname><given-names>JM</given-names></name><name><surname>Riordan</surname><given-names>DP</given-names></name><name><surname>Srinivas</surname><given-names>N</given-names></name><etal/></person-group><article-title>Combinatorial single-cell CRISPR screens by direct guide RNA capture and targeted sequencing</article-title><source>Nat Biotechnol</source><year>2020</year><volume>38</volume><fpage>954</fpage><lpage>961</lpage><pub-id pub-id-type="pmcid">PMC7416462</pub-id><pub-id pub-id-type="pmid">32231336</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-0470-y</pub-id></element-citation></ref><ref id="R93"><label>93</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pelea</surname><given-names>O</given-names></name><name><surname>Mayes</surname><given-names>S</given-names></name><name><surname>Ferry</surname><given-names>QRV</given-names></name><name><surname>Fulga</surname><given-names>TA</given-names></name><name><surname>Sauka-Spengler</surname><given-names>T</given-names></name></person-group><article-title>Specific Modulation of CRISPR Transcriptional Activators through RNA-Sensing Guide RNAs in Mammalian Cells and Zebrafish Embryos</article-title><source>eLife</source><year>2024</year><volume>12</volume><pub-id pub-id-type="doi">10.7554/eLife.87722.2</pub-id></element-citation></ref><ref id="R94"><label>94</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barske</surname><given-names>L</given-names></name><name><surname>Rataud</surname><given-names>P</given-names></name><name><surname>Behizad</surname><given-names>K</given-names></name><name><surname>Del Rio</surname><given-names>L</given-names></name><name><surname>Cox</surname><given-names>SG</given-names></name><name><surname>Crump</surname><given-names>JG</given-names></name></person-group><article-title>Essential role of Nr2f nuclear receptors in patterning the vertebrate upper jaw</article-title><source>Dev Cell</source><year>2018</year><volume>44</volume><fpage>337</fpage><lpage>347</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="pmcid">PMC5801120</pub-id><pub-id pub-id-type="pmid">29358039</pub-id><pub-id pub-id-type="doi">10.1016/j.devcel.2017.12.022</pub-id></element-citation></ref><ref id="R95"><label>95</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>LM</given-names></name><name><surname>Mishra</surname><given-names>AK</given-names></name><name><surname>Aman</surname><given-names>AJ</given-names></name><name><surname>Lewis</surname><given-names>VM</given-names></name><name><surname>Toomey</surname><given-names>MB</given-names></name><name><surname>Packer</surname><given-names>JS</given-names></name><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>McFaline-Figueroa</surname><given-names>JL</given-names></name><name><surname>Corbo</surname><given-names>JC</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>Thyroid hormone regulates distinct paths to maturation in pigment cell lineages</article-title><source>Elife</source><year>2019</year><volume>8</volume><pub-id pub-id-type="pmcid">PMC6588384</pub-id><pub-id pub-id-type="pmid">31140974</pub-id><pub-id pub-id-type="doi">10.7554/eLife.45181</pub-id></element-citation></ref><ref id="R96"><label>96</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howard</surname><given-names>AG</given-names><suffix>th</suffix></name><name><surname>Baker</surname><given-names>PA</given-names></name><name><surname>Ibarra-Garcia-Padilla</surname><given-names>R</given-names></name><name><surname>Moore</surname><given-names>JA</given-names></name><name><surname>Rivas</surname><given-names>LJ</given-names></name><name><surname>Tallman</surname><given-names>JJ</given-names></name><name><surname>Singleton</surname><given-names>EW</given-names></name><name><surname>Westheimer</surname><given-names>JL</given-names></name><name><surname>Corteguera</surname><given-names>JA</given-names></name><name><surname>Uribe</surname><given-names>RA</given-names></name></person-group><article-title>An atlas of neural crest lineages along the posterior developing zebrafish at single-cell resolution</article-title><source>Elife</source><year>2021</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC7886338</pub-id><pub-id pub-id-type="pmid">33591267</pub-id><pub-id pub-id-type="doi">10.7554/eLife.60005</pub-id></element-citation></ref><ref id="R97"><label>97</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>SL</given-names></name><name><surname>Nguyen</surname><given-names>AN</given-names></name><name><surname>Lister</surname><given-names>JA</given-names></name></person-group><article-title>mitfa is required at multiple stages of melanocyte differentiation but not to establish the melanocyte stem cell</article-title><source>Dev Biol</source><year>2011</year><volume>350</volume><fpage>405</fpage><lpage>413</lpage><pub-id pub-id-type="pmcid">PMC3040983</pub-id><pub-id pub-id-type="pmid">21146516</pub-id><pub-id pub-id-type="doi">10.1016/j.ydbio.2010.12.004</pub-id></element-citation></ref><ref id="R98"><label>98</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatarakis</surname><given-names>D</given-names></name><name><surname>Cang</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Sharma</surname><given-names>PP</given-names></name><name><surname>Karikomi</surname><given-names>M</given-names></name><name><surname>MacLean</surname><given-names>AL</given-names></name><name><surname>Nie</surname><given-names>Q</given-names></name><name><surname>Schilling</surname><given-names>TF</given-names></name></person-group><article-title>Single-cell transcriptomic analysis of zebrafish cranial neural crest reveals spatiotemporal regulation of lineage decisions during development</article-title><source>Cell Rep</source><year>2021</year><volume>37</volume><elocation-id>110140</elocation-id><pub-id pub-id-type="pmcid">PMC8741273</pub-id><pub-id pub-id-type="pmid">34936864</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2021.110140</pub-id></element-citation></ref><ref id="R99"><label>99</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petratou</surname><given-names>K</given-names></name></person-group><article-title>Investigating gene regulatory networks underlying zebrafish pigment cell development</article-title><year>2016</year></element-citation></ref><ref id="R100"><label>100</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nair</surname><given-names>S</given-names></name><name><surname>Ameen</surname><given-names>M</given-names></name><name><surname>Sundaram</surname><given-names>L</given-names></name><name><surname>Pampari</surname><given-names>A</given-names></name><name><surname>Schreiber</surname><given-names>J</given-names></name><name><surname>Balsubramani</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>YX</given-names></name><name><surname>Burns</surname><given-names>D</given-names></name><name><surname>Blau</surname><given-names>HM</given-names></name><name><surname>Karakikes</surname><given-names>I</given-names></name><etal/></person-group><article-title>Transcription factor stoichiometry, motif affinity and syntax regulate single-cell chromatin dynamics during fibroblast reprogramming to pluripotency</article-title><source>bioRxivorg</source><year>2023</year><elocation-id>2023.10.04.560808</elocation-id></element-citation></ref><ref id="R101"><label>101</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>HMT</given-names></name><name><surname>Schwarzkopf</surname><given-names>M</given-names></name><name><surname>Fornace</surname><given-names>ME</given-names></name><name><surname>Acharya</surname><given-names>A</given-names></name><name><surname>Artavanis</surname><given-names>G</given-names></name><name><surname>Stegmaier</surname><given-names>J</given-names></name><name><surname>Cunha</surname><given-names>A</given-names></name><name><surname>Pierce</surname><given-names>NA</given-names></name></person-group><article-title>Third-generation in situ hybridization chain reaction: multiplexed, quantitative, sensitive, versatile, robust</article-title><source>Development</source><year>2018</year><volume>145</volume><pub-id pub-id-type="pmcid">PMC6031405</pub-id><pub-id pub-id-type="pmid">29945988</pub-id><pub-id pub-id-type="doi">10.1242/dev.165753</pub-id></element-citation></ref><ref id="R102"><label>102</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagedorn</surname><given-names>L</given-names></name><name><surname>Suter</surname><given-names>U</given-names></name><name><surname>Sommer</surname><given-names>L</given-names></name></person-group><article-title>P0 and PMP22 mark a multipotent neural crest-derived cell type that displays community effects in response to TGF-beta family factors</article-title><source>Development</source><year>1999</year><volume>126</volume><fpage>3781</fpage><lpage>3794</lpage><pub-id pub-id-type="pmid">10433908</pub-id></element-citation></ref><ref id="R103"><label>103</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H-Y</given-names></name><name><surname>Dai</surname><given-names>E-S</given-names></name><name><surname>Liu</surname><given-names>J-T</given-names></name><name><surname>Tu</surname><given-names>C-T</given-names></name><name><surname>Yang</surname><given-names>T-C</given-names></name><name><surname>Tsai</surname><given-names>H-J</given-names></name></person-group><article-title>The embryonic expression patterns and the knockdown phenotypes of zebrafish ADP-ribosylation factor-like 6 interacting protein gene</article-title><source>Dev Dyn</source><year>2009</year><volume>238</volume><fpage>232</fpage><lpage>240</lpage><pub-id pub-id-type="pmid">19097054</pub-id></element-citation></ref><ref id="R104"><label>104</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eliason</surname><given-names>S</given-names></name><name><surname>Su</surname><given-names>D</given-names></name><name><surname>Pinho</surname><given-names>F</given-names></name><name><surname>Sun</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Sweat</surname><given-names>M</given-names></name><name><surname>Venugopalan</surname><given-names>SR</given-names></name><name><surname>He</surname><given-names>B</given-names></name><name><surname>Bustin</surname><given-names>M</given-names></name><etal/></person-group><article-title>HMGN2 represses gene transcription via interaction with transcription factors Lef-1 and Pitx2 during amelogenesis</article-title><source>J Biol Chem</source><year>2022</year><volume>298</volume><elocation-id>102295</elocation-id><pub-id pub-id-type="pmcid">PMC9418915</pub-id><pub-id pub-id-type="pmid">35872015</pub-id><pub-id pub-id-type="doi">10.1016/j.jbc.2022.102295</pub-id></element-citation></ref><ref id="R105"><label>105</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>T</given-names></name><name><surname>Burrage</surname><given-names>K</given-names></name></person-group><article-title>Stochastic models for regulatory networks of the genetic toggle switch</article-title><source>Proc Natl Acad Sci U S A</source><year>2006</year><volume>103</volume><fpage>8372</fpage><lpage>8377</lpage></element-citation></ref><ref id="R106"><label>106</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunne</surname><given-names>C</given-names></name><name><surname>Roohani</surname><given-names>Y</given-names></name><name><surname>Rosen</surname><given-names>Y</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Roed</surname><given-names>M</given-names></name><name><surname>Alexandrov</surname><given-names>T</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name><name><surname>Brennan</surname><given-names>P</given-names></name><name><surname>Burkhardt</surname><given-names>DB</given-names></name><etal/></person-group><article-title>How to build the virtual cell with artificial intelligence: Priorities and opportunities</article-title><source>arXiv [q-bioQM]</source><year>2024</year><pub-id pub-id-type="pmid">39672099</pub-id></element-citation></ref><ref id="R107"><label>107</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madison</surname><given-names>BJ</given-names></name><name><surname>Clark</surname><given-names>KA</given-names></name><name><surname>Bhachech</surname><given-names>N</given-names></name><name><surname>Hollenhorst</surname><given-names>PC</given-names></name><name><surname>Graves</surname><given-names>BJ</given-names></name><name><surname>Currie</surname><given-names>SL</given-names></name></person-group><article-title>Electrostatic repulsion causes anticooperative DNA binding between tumor suppressor ETS transcription factors and JUN-FOS at composite DNA sites</article-title><source>J Biol Chem</source><year>2018</year><volume>293</volume><fpage>18624</fpage><lpage>18635</lpage><pub-id pub-id-type="pmcid">PMC6290139</pub-id><pub-id pub-id-type="pmid">30315111</pub-id><pub-id pub-id-type="doi">10.1074/jbc.RA118.003352</pub-id></element-citation></ref><ref id="R108"><label>108</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soldatov</surname><given-names>R</given-names></name><name><surname>Kaucka</surname><given-names>M</given-names></name><name><surname>Kastriti</surname><given-names>ME</given-names></name><name><surname>Petersen</surname><given-names>J</given-names></name><name><surname>Chontorotzea</surname><given-names>T</given-names></name><name><surname>Englmaier</surname><given-names>L</given-names></name><name><surname>Akkuratova</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Haring</surname><given-names>M</given-names></name><name><surname>Dyachuk</surname><given-names>V</given-names></name><etal/></person-group><article-title>Spatiotemporal structure of cell fate decisions in murine neural crest</article-title><source>Science</source><year>2019</year><volume>364</volume><pub-id pub-id-type="pmid">31171666</pub-id></element-citation></ref><ref id="R109"><label>109</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aiello-Couzo</surname><given-names>NM</given-names></name><name><surname>Kang</surname><given-names>Y</given-names></name></person-group><article-title>A bridge between melanoma cell states</article-title><source>Nat Cell Biol</source><year>2020</year><volume>22</volume><fpage>913</fpage><lpage>914</lpage><pub-id pub-id-type="pmid">32753670</pub-id></element-citation></ref><ref id="R110"><label>110</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kulesa</surname><given-names>PM</given-names></name><name><surname>Kasemeier-Kulesa</surname><given-names>JC</given-names></name><name><surname>Teddy</surname><given-names>JM</given-names></name><name><surname>Margaryan</surname><given-names>NV</given-names></name><name><surname>Seftor</surname><given-names>EA</given-names></name><name><surname>Seftor</surname><given-names>REB</given-names></name><name><surname>Hendrix</surname><given-names>MJC</given-names></name></person-group><article-title>Reprogramming metastatic melanoma cells to assume a neural crest cell-like phenotype in an embryonic microenvironment</article-title><source>Proc Natl Acad Sci U S A</source><year>2006</year><volume>103</volume><fpage>3752</fpage><lpage>3757</lpage><pub-id pub-id-type="pmcid">PMC1450149</pub-id><pub-id pub-id-type="pmid">16505384</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0506977103</pub-id></element-citation></ref><ref id="R111"><label>111</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>King</surname><given-names>WC</given-names></name><name><surname>Hwang</surname><given-names>A</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>Single-cell transcriptomic deep velocity field learning with neural ordinary differential equations</article-title><source>Sci Adv</source><year>2022</year><volume>8</volume><elocation-id>eabq3745</elocation-id><pub-id pub-id-type="pmcid">PMC9710871</pub-id><pub-id pub-id-type="pmid">36449617</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.abq3745</pub-id></element-citation></ref><ref id="R112"><label>112</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>R</given-names></name><name><surname>Wu</surname><given-names>AP</given-names></name><name><surname>Mudide</surname><given-names>A</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name></person-group><article-title>Causal gene regulatory analysis with RNA velocity reveals an interplay between slow and fast transcription factors</article-title><source>Cell Syst</source><year>2024</year><volume>15</volume><fpage>462</fpage><lpage>474</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="pmid">38754366</pub-id></element-citation></ref><ref id="R113"><label>113</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>scGen predicts single-cell perturbation responses</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>715</fpage><lpage>721</lpage><pub-id pub-id-type="pmid">31363220</pub-id></element-citation></ref><ref id="R114"><label>114</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirschenbaum</surname><given-names>D</given-names></name><name><surname>Xie</surname><given-names>K</given-names></name><name><surname>Ingelfinger</surname><given-names>F</given-names></name><name><surname>Katzenelenbogen</surname><given-names>Y</given-names></name><name><surname>Abadie</surname><given-names>K</given-names></name><name><surname>Look</surname><given-names>T</given-names></name><name><surname>Sheban</surname><given-names>F</given-names></name><name><surname>Phan</surname><given-names>TS</given-names></name><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Zwicky</surname><given-names>P</given-names></name><etal/></person-group><article-title>Time-resolved single-cell transcriptomics defines immune trajectories in glioblastoma</article-title><source>Cell</source><year>2024</year><volume>187</volume><fpage>149</fpage><lpage>165</lpage><elocation-id>e23</elocation-id><pub-id pub-id-type="pmid">38134933</pub-id></element-citation></ref><ref id="R115"><label>115</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramanathan</surname><given-names>M</given-names></name><name><surname>Porter</surname><given-names>DF</given-names></name><name><surname>Khavari</surname><given-names>PA</given-names></name></person-group><article-title>Methods to study RNA-protein interactions</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>225</fpage><lpage>234</lpage><pub-id pub-id-type="pmcid">PMC6692137</pub-id><pub-id pub-id-type="pmid">30804549</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0330-1</pub-id></element-citation></ref><ref id="R116"><label>116</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brannan</surname><given-names>KW</given-names></name><name><surname>Chaim</surname><given-names>IA</given-names></name><name><surname>Marina</surname><given-names>RJ</given-names></name><name><surname>Yee</surname><given-names>BA</given-names></name><name><surname>Kofman</surname><given-names>ER</given-names></name><name><surname>Lorenz</surname><given-names>DA</given-names></name><name><surname>Jagannatha</surname><given-names>P</given-names></name><name><surname>Dong</surname><given-names>KD</given-names></name><name><surname>Madrigal</surname><given-names>AA</given-names></name><name><surname>Underwood</surname><given-names>JG</given-names></name><etal/></person-group><article-title>Robust single-cell discovery of RNA targets of RNA-binding proteins and ribosomes</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>507</fpage><lpage>519</lpage><pub-id pub-id-type="pmcid">PMC8148648</pub-id><pub-id pub-id-type="pmid">33963355</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01128-0</pub-id></element-citation></ref><ref id="R117"><label>117</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozadam</surname><given-names>H</given-names></name><name><surname>Tonn</surname><given-names>T</given-names></name><name><surname>Han</surname><given-names>CM</given-names></name><name><surname>Segura</surname><given-names>A</given-names></name><name><surname>Hoskins</surname><given-names>I</given-names></name><name><surname>Rao</surname><given-names>S</given-names></name><name><surname>Ghatpande</surname><given-names>V</given-names></name><name><surname>Tran</surname><given-names>D</given-names></name><name><surname>Catoe</surname><given-names>D</given-names></name><name><surname>Salit</surname><given-names>M</given-names></name><etal/></person-group><article-title>Single-cell quantification of ribosome occupancy in early mouse development</article-title><source>Nature</source><year>2023</year><volume>618</volume><fpage>1057</fpage><lpage>1064</lpage><pub-id pub-id-type="pmcid">PMC10307641</pub-id><pub-id pub-id-type="pmid">37344592</pub-id><pub-id pub-id-type="doi">10.1038/s41586-023-06228-9</pub-id></element-citation></ref><ref id="R118"><label>118</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Köstler</surname><given-names>WJ</given-names></name><name><surname>Molotski</surname><given-names>N</given-names></name><name><surname>Tsai</surname><given-names>JM</given-names></name><name><surname>Krauthgamer</surname><given-names>R</given-names></name><name><surname>Jacob-Hirsch</surname><given-names>J</given-names></name><name><surname>Rechavi</surname><given-names>G</given-names></name><name><surname>Soen</surname><given-names>Y</given-names></name><name><surname>Jung</surname><given-names>S</given-names></name><name><surname>Yarden</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Coupled pre-mRNA and mRNA dynamics unveil operational strategies underlying transcriptional responses to stimuli</article-title><source>Mol Syst Biol</source><year>2011</year><volume>7</volume><fpage>529</fpage><pub-id pub-id-type="pmcid">PMC3202801</pub-id><pub-id pub-id-type="pmid">21915116</pub-id><pub-id pub-id-type="doi">10.1038/msb.2011.62</pub-id></element-citation></ref><ref id="R119"><label>119</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>Y</given-names></name><name><surname>Duan</surname><given-names>J</given-names></name><name><surname>Schmitz</surname><given-names>DA</given-names></name><name><surname>Sakurai</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Hon</surname><given-names>GC</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name></person-group><article-title>Blastocyst-like structures generated from human pluripotent stem cells</article-title><source>Nature</source><year>2021</year><volume>591</volume><fpage>620</fpage><lpage>626</lpage><pub-id pub-id-type="pmid">33731924</pub-id></element-citation></ref><ref id="R120"><label>120</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finlay</surname><given-names>C</given-names></name><name><surname>Jacobsen</surname><given-names>J-H</given-names></name><name><surname>Nurbekyan</surname><given-names>L</given-names></name><name><surname>Oberman</surname><given-names>AM</given-names></name></person-group><article-title>How to train your neural ODE: the world of Jacobian and kinetic regularization</article-title><year>2020</year><pub-id pub-id-type="doi">10.48550/ARXIV.2002.02798</pub-id></element-citation></ref><ref id="R121"><label>121</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loshchilov</surname><given-names>I</given-names></name><name><surname>Hutter</surname><given-names>F</given-names></name></person-group><article-title>Decoupled weight decay regularization</article-title><year>2017</year><pub-id pub-id-type="doi">10.48550/ARXIV.1711.05101</pub-id></element-citation></ref><ref id="R122"><label>122</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>A</given-names></name></person-group><chapter-title>Monte Carlo Sampling Methods</chapter-title><source>Handbooks in Operations Research and Management Science Handbooks in operations research and management science</source><publisher-name>Elsevier</publisher-name><year>2003</year><fpage>353</fpage><lpage>425</lpage></element-citation></ref><ref id="R123"><label>123</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Müller</surname><given-names>A</given-names></name><name><surname>Nothman</surname><given-names>J</given-names></name><name><surname>Louppe</surname><given-names>G</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine Learning in Python</article-title><year>2012</year></element-citation></ref><ref id="R124"><label>124</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Kucukelbir</surname><given-names>A</given-names></name><name><surname>McAuliffe</surname><given-names>JD</given-names></name></person-group><article-title>Variational inference: A review for statisticians</article-title><source>J Am Stat Assoc</source><year>2017</year><volume>112</volume><fpage>859</fpage><lpage>877</lpage></element-citation></ref><ref id="R125"><label>125</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merryweather-Clarke</surname><given-names>AT</given-names></name><name><surname>Atzberger</surname><given-names>A</given-names></name><name><surname>Soneji</surname><given-names>S</given-names></name><name><surname>Gray</surname><given-names>N</given-names></name><name><surname>Clark</surname><given-names>K</given-names></name><name><surname>Waugh</surname><given-names>C</given-names></name><name><surname>McGowan</surname><given-names>SJ</given-names></name><name><surname>Taylor</surname><given-names>S</given-names></name><name><surname>Nandi</surname><given-names>AK</given-names></name><name><surname>Wood</surname><given-names>WG</given-names></name><etal/></person-group><article-title>Global gene expression analysis of human erythroid progenitors</article-title><source>Blood</source><year>2011</year><volume>117</volume><fpage>e96</fpage><lpage>e108</lpage><pub-id pub-id-type="pmid">21270440</pub-id></element-citation></ref><ref id="R126"><label>126</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Bai</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>K</given-names></name><name><surname>Ou</surname><given-names>Q</given-names></name><etal/></person-group><article-title>CellMarker 2.0: an updated database of manually curated cell markers in human/mouse and web tools based on scRNA-seq data</article-title><source>Nucleic Acids Res</source><year>2023</year><volume>51</volume><fpage>D870</fpage><lpage>D876</lpage><pub-id pub-id-type="pmcid">PMC9825416</pub-id><pub-id pub-id-type="pmid">36300619</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac947</pub-id></element-citation></ref><ref id="R127"><label>127</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Deconinck</surname><given-names>L</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>Spearheading future omics analyses using dyngen, a multi-modal simulator of single cells</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>3942</fpage><pub-id pub-id-type="pmcid">PMC8225657</pub-id><pub-id pub-id-type="pmid">34168133</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-24152-2</pub-id></element-citation></ref><ref id="R128"><label>128</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><fpage>15</fpage><pub-id pub-id-type="pmcid">PMC5802054</pub-id><pub-id pub-id-type="pmid">29409532</pub-id><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id></element-citation></ref><ref id="R129"><label>129</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W-K</given-names></name><name><surname>Chen</surname><given-names>S-Y</given-names></name><name><surname>Gan</surname><given-names>Z-Q</given-names></name><name><surname>Zhang</surname><given-names>Y-Z</given-names></name><name><surname>Yue</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>M-M</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Guo</surname><given-names>A-Y</given-names></name></person-group><article-title>AnimalTFDB 4.0: a comprehensive animal transcription factor database updated with variation and expression annotations</article-title><source>Nucleic Acids Res</source><year>2023</year><volume>51</volume><fpage>D39</fpage><lpage>D45</lpage><pub-id pub-id-type="pmcid">PMC9825474</pub-id><pub-id pub-id-type="pmid">36268869</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac907</pub-id></element-citation></ref><ref id="R130"><label>130</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reuter</surname><given-names>B</given-names></name><name><surname>Fackeldey</surname><given-names>K</given-names></name><name><surname>Weber</surname><given-names>M</given-names></name></person-group><article-title>Generalized Markov modeling of nonreversible molecular kinetics</article-title><source>J Chem Phys</source><year>2019</year><volume>150</volume><elocation-id>174103</elocation-id><pub-id pub-id-type="pmid">31067901</pub-id></element-citation></ref><ref id="R131"><label>131</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bocci</surname><given-names>F</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name><name><surname>Nie</surname><given-names>Q</given-names></name></person-group><article-title>spliceJAC: transition genes and state-specific gene regulation from single-cell transcriptome data</article-title><source>Mol Syst Biol</source><year>2022</year><volume>18</volume><elocation-id>e11176</elocation-id><pub-id pub-id-type="pmcid">PMC9627675</pub-id><pub-id pub-id-type="pmid">36321549</pub-id><pub-id pub-id-type="doi">10.15252/msb.202211176</pub-id></element-citation></ref><ref id="R132"><label>132</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pratapa</surname><given-names>A</given-names></name><name><surname>Jalihal</surname><given-names>AP</given-names></name><name><surname>Law</surname><given-names>JN</given-names></name><name><surname>Bharadwaj</surname><given-names>A</given-names></name><name><surname>Murali</surname><given-names>TM</given-names></name></person-group><article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title><source>Nat Methods</source><year>2020</year><volume>17</volume><fpage>147</fpage><lpage>154</lpage><pub-id pub-id-type="pmcid">PMC7098173</pub-id><pub-id pub-id-type="pmid">31907445</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0690-6</pub-id></element-citation></ref><ref id="R133"><label>133</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oki</surname><given-names>S</given-names></name><name><surname>Ohta</surname><given-names>T</given-names></name><name><surname>Shioi</surname><given-names>G</given-names></name><name><surname>Hatanaka</surname><given-names>H</given-names></name><name><surname>Ogasawara</surname><given-names>O</given-names></name><name><surname>Okuda</surname><given-names>Y</given-names></name><name><surname>Kawaji</surname><given-names>H</given-names></name><name><surname>Nakaki</surname><given-names>R</given-names></name><name><surname>Sese</surname><given-names>J</given-names></name><name><surname>Meno</surname><given-names>C</given-names></name></person-group><article-title>ChIP-Atlas: a data-mining suite powered by full integration of public ChIP-seq data</article-title><source>EMBO Rep</source><year>2018</year><volume>19</volume><pub-id pub-id-type="pmcid">PMC6280645</pub-id><pub-id pub-id-type="pmid">30413482</pub-id><pub-id pub-id-type="doi">10.15252/embr.201846255</pub-id></element-citation></ref><ref id="R134"><label>134</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaspar</surname><given-names>JM</given-names></name></person-group><article-title>Improved peak-calling with MACS2</article-title><source>bioRxiv</source><year>2018</year><pub-id pub-id-type="doi">10.1101/496521</pub-id></element-citation></ref><ref id="R135"><label>135</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Meyer</surname><given-names>CA</given-names></name><name><surname>Eeckhoute</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>DS</given-names></name><name><surname>Bernstein</surname><given-names>BE</given-names></name><name><surname>Nusbaum</surname><given-names>C</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Brown</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><etal/></person-group><article-title>Model-based analysis of ChIP-Seq (MACS</article-title><source>Genome Biol</source><year>2008</year><volume>9</volume><elocation-id>R137</elocation-id><pub-id pub-id-type="pmcid">PMC2592715</pub-id><pub-id pub-id-type="pmid">18798982</pub-id><pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id></element-citation></ref><ref id="R136"><label>136</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schep</surname><given-names>AN</given-names></name><name><surname>Wu</surname><given-names>B</given-names></name><name><surname>Buenrostro</surname><given-names>JD</given-names></name><name><surname>Greenleaf</surname><given-names>WJ</given-names></name></person-group><article-title>chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>975</fpage><lpage>978</lpage><pub-id pub-id-type="pmcid">PMC5623146</pub-id><pub-id pub-id-type="pmid">28825706</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4401</pub-id></element-citation></ref><ref id="R137"><label>137</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>T</given-names></name><name><surname>Guestrin</surname><given-names>C</given-names></name></person-group><source>XGBoost</source><conf-name>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (ACM)</conf-name><year>2016</year><pub-id pub-id-type="doi">10.1145/2939672.2939785</pub-id></element-citation></ref><ref id="R138"><label>138</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Srivastava</surname><given-names>A</given-names></name><name><surname>Madad</surname><given-names>S</given-names></name><name><surname>Lareau</surname><given-names>CA</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Single-cell chromatin state analysis with Signac</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>1333</fpage><lpage>1341</lpage><pub-id pub-id-type="pmcid">PMC9255697</pub-id><pub-id pub-id-type="pmid">34725479</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01282-5</pub-id></element-citation></ref><ref id="R139"><label>139</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Westerfield</surname><given-names>M</given-names></name></person-group><source>The Zebrafish Book: A Guide for the Laboratory Use of Zebrafish (Danio Rerio)</source><publisher-name>University of Oregon Press</publisher-name><year>2000</year></element-citation></ref><ref id="R140"><label>140</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimmel</surname><given-names>CB</given-names></name><name><surname>Ballard</surname><given-names>WW</given-names></name><name><surname>Kimmel</surname><given-names>SR</given-names></name><name><surname>Ullmann</surname><given-names>B</given-names></name><name><surname>Schilling</surname><given-names>TF</given-names></name></person-group><article-title>Stages of embryonic development of the zebrafish</article-title><source>Dev Dyn</source><year>2005</year><volume>203</volume><fpage>253</fpage><lpage>310</lpage><pub-id pub-id-type="pmid">8589427</pub-id></element-citation></ref><ref id="R141"><label>141</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochgreb-Hagele</surname><given-names>T</given-names></name><name><surname>Bronner</surname><given-names>ME</given-names></name></person-group><article-title>A novel FoxD3 gene trap line reveals neural crest precursor movement and a role for FoxD3 in their specification</article-title><source>Dev Biol</source><year>2013</year><volume>374</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC3553214</pub-id><pub-id pub-id-type="pmid">23228892</pub-id><pub-id pub-id-type="doi">10.1016/j.ydbio.2012.11.035</pub-id></element-citation></ref><ref id="R142"><label>142</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parekh</surname><given-names>S</given-names></name><name><surname>Ziegenhain</surname><given-names>C</given-names></name><name><surname>Vieth</surname><given-names>B</given-names></name><name><surname>Enard</surname><given-names>W</given-names></name><name><surname>Hellmann</surname><given-names>I</given-names></name></person-group><article-title>zUMIs - A fast and flexible pipeline to process RNA sequencing data with UMIs</article-title><source>Gigascience</source><year>2018</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC6007394</pub-id><pub-id pub-id-type="pmid">29846586</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giy059</pub-id></element-citation></ref><ref id="R143"><label>143</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Schlesinger</surname><given-names>F</given-names></name><name><surname>Drenkow</surname><given-names>J</given-names></name><name><surname>Zaleski</surname><given-names>C</given-names></name><name><surname>Jha</surname><given-names>S</given-names></name><name><surname>Batut</surname><given-names>P</given-names></name><name><surname>Chaisson</surname><given-names>M</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics</source><year>2012</year><volume>29</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC3530905</pub-id><pub-id pub-id-type="pmid">23104886</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id></element-citation></ref><ref id="R144"><label>144</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>MJ</given-names></name><name><surname>Wilk</surname><given-names>AJ</given-names></name><name><surname>Darby</surname><given-names>C</given-names></name><name><surname>Zager</surname><given-names>M</given-names></name><etal/></person-group><article-title>Integrated analysis of multimodal single-cell data</article-title><source>Cell</source><year>2021</year><volume>184</volume><fpage>3573</fpage><lpage>3587</lpage><elocation-id>e29</elocation-id><pub-id pub-id-type="pmcid">PMC8238499</pub-id><pub-id pub-id-type="pmid">34062119</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id></element-citation></ref><ref id="R145"><label>145</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moon</surname><given-names>KR</given-names></name><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Gigante</surname><given-names>S</given-names></name><name><surname>Burkhardt</surname><given-names>DB</given-names></name><name><surname>Chen</surname><given-names>WS</given-names></name><name><surname>Yim</surname><given-names>K</given-names></name><name><surname>van den Elzen</surname><given-names>A</given-names></name><name><surname>Hirn</surname><given-names>MJ</given-names></name><name><surname>Coifman</surname><given-names>RR</given-names></name><etal/></person-group><article-title>Visualizing structure and transitions in high-dimensional biological data</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>1482</fpage><lpage>1492</lpage><pub-id pub-id-type="pmcid">PMC7073148</pub-id><pub-id pub-id-type="pmid">31796933</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0336-3</pub-id></element-citation></ref><ref id="R146"><label>146</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burkhardt</surname><given-names>DB</given-names></name><name><surname>Stanley</surname><given-names>JS</given-names><suffix>3rd</suffix></name><name><surname>Tong</surname><given-names>A</given-names></name><name><surname>Perdigoto</surname><given-names>AL</given-names></name><name><surname>Gigante</surname><given-names>SA</given-names></name><name><surname>Herold</surname><given-names>KC</given-names></name><name><surname>Wolf</surname><given-names>G</given-names></name><name><surname>Giraldez</surname><given-names>AJ</given-names></name><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Krishnaswamy</surname><given-names>S</given-names></name></person-group><article-title>Quantifying the effect of experimental perturbations at single-cell resolution</article-title><source>Nat Biotechnol</source><year>2021</year><volume>39</volume><fpage>619</fpage><lpage>629</lpage><pub-id pub-id-type="pmcid">PMC8122059</pub-id><pub-id pub-id-type="pmid">33558698</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-00803-5</pub-id></element-citation></ref><ref id="R147"><label>147</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>D</given-names></name><name><surname>Hsu</surname><given-names>S</given-names></name><name><surname>Purushotham</surname><given-names>D</given-names></name><name><surname>Sears</surname><given-names>RL</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name></person-group><article-title>WashU Epigenome Browser update 2019</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>W158</fpage><lpage>W165</lpage><pub-id pub-id-type="pmcid">PMC6602459</pub-id><pub-id pub-id-type="pmid">31165883</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkz348</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>RegVelo models dynamics of cells and their underlying gene regulatory networks (GRNs) jointly.</title><p><bold>a</bold>. RegVelo encodes the unspliced and spliced abundance of scRNA-seq data into the cell representation through a neural network and feeds the cell representation into a decoder neural network, which outputs a cell-gene-specific latent time. Simultaneously, a prior gene regulatory graph curated from orthogonal data sources like ATAC-seq, multiome measurements, or databases guides a transcription predictor neural network. During training, this network refines and learns gene regulatory relationships, encoding each cell’s (<italic>n</italic>) and gene’s (<italic>g</italic>) transcription rate (<italic>α<sub>ng</sub></italic>). Combined with the additionally estimated splicing and degradation rates <italic>β</italic> and <italic>γ</italic>, respectively, the model defines coupled gene dynamics and employs a parallel, high-dimensional ODE solver<sup><xref ref-type="bibr" rid="R37">37</xref></sup> to estimate and predict dynamic gene expression. The forward simulation allows for defining a likelihood function encompassing all neural network and kinetic parameters, optimized in an end-to-end fashion using stochastic variational inference<sup><xref ref-type="bibr" rid="R38">38</xref></sup>. <bold>b</bold>. As a Bayesian generative model, the variational inference formulation quantifies the uncertainty of velocity estimation<sup><xref ref-type="bibr" rid="R14">14</xref></sup> (top), and coupling gene dynamics with gene regulation allows us to characterize the underlying GRN of the phenotypic space (bottom). <bold>c</bold>. UMAP representation of a cell cycle dataset of 1146 U2OS-FUCCI cells<sup><xref ref-type="bibr" rid="R39">39</xref></sup>, colored by the FUCCI-derived cell-cycle score; the black arrow indicates the ground-truth transition direction. <bold>d</bold>. The UMAP representation colored by the RegVelo-inferred latent time and overlaid with the corresponding velocity stream and inference metrics (left; CBC: cross-boundary correctness; conf.: confidence; corr: correlation). We indicate the top two regulators (orange dots) and cell cycle-related genes (red arrows) in the fitted GRN (right). <bold>e</bold>. Conceptualization of five metrics to evaluate RegVelo’s inferred velocities, latent time, and GRN: the CBC quantifies how accurately inferred velocities recapitulate known cell state transitions, velocity consistency evaluates the coherence of velocities within neighboring cells, the latent time analysis assesses how well inferred latent times align with the ground truth, and comparing predicted gene regulatory edges to know relationships evaluates the GRN inference (TF: transcriptional factors; GEX: gene expression; <xref ref-type="sec" rid="S12">Methods</xref>).</p></caption><graphic xlink:href="EMS201949-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Perturbation simulation quantifies genetic regulation effects on cell fate decisions in pancreatic endocrinogenesis.</title><p><bold>a</bold>. As an inference model that incorporates gene regulatory mechanisms, RegVelo can simulate the dynamics resulting from in silico perturbations by masking regulons to mute the functions of the corresponding TFs. Comparing velocity differences for each cell quantifies local perturbation effects, and passing the original and perturbed velocity estimations into the typical CellRank workflow<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> quantifies cellular fates, where changes in cell fates identify perturbation effects (<xref ref-type="sec" rid="S12">Methods</xref>). Box plots are schematics indicating the median (center line), interquartile range (hinges), and whiskers at 1.5x interquartile range. <bold>b</bold>. UMAP embedding of 3696 pancreatic endocrinogenesis cells, colored by cell type according to the original study and the RegVelo-inferred velocity stream (left), and the terminal states predicted by CellRank using RegVelo’s velocity field (right). <bold>c</bold>. The number of correctly identified terminal states compared to the number of specified macrostates indicates how faithfully a method recovers known biology with CellRank; different colors and line styles indicate different methods. <bold>d</bold>. Cell fate perturbation effects estimated from <italic>Neurod2</italic> regulon perturbation simulation (left), and the corresponding ten <italic>Neurod2</italic>-targets affected most in the Epsilon lineage. <bold>e</bold>. Cell fate perturbation effects estimated from <italic>Rfx6</italic> regulon perturbation simulation.</p></caption><graphic xlink:href="EMS201949-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Inferring regulatory dynamics during human hematopoiesis differentiation.</title><p><bold>a</bold>. Force-directed layout embedding (FLE) of 1947 human hematopoietic stem and progenitor cells (HSPCs), colored according to original cell type annotation (HSC: hematopoietic stem cell; Meg: megakaryocyte; Ery: erythrocyte; Bas: basophil; Neu: neutrophil; Mon: monocyte; MEP-like: megakaryocyte and erythrocyte progenitor-like; GMP-like: granulocyte and monocyte progenitor-like). <bold>b</bold>. Combining the RegVelo state change estimates with CellRank to infer terminal states recovers all five terminal states (left). The number of correctly identified terminal states compared to the number of specified macrostates highlights that RegVelo performs optimally and outperforms competing methods (right; <xref ref-type="sec" rid="S12">Methods</xref>) <bold>c</bold>. FLE of HSPCs colored by RegVelo-inferred intrinsic uncertainty and terminal states (top; <xref ref-type="sec" rid="S12">Methods</xref>), and its uncertainty compared to veloVI in each terminal state based on a log-transformed ratio (bottom; <xref ref-type="sec" rid="S12">Methods</xref>). Box plots indicate the median (center line), interquartile range (hinges), and 1.5x interquartile range (whiskers) (<italic>N</italic> = 30 cells). <bold>d</bold>: FLE embedding colored by RegVelo’s cell-specific perturbation effect in the erythroid and monocyte lineage after deleting the GATA1 (left) and SPI1 (right) regulon, and the core regulatory subnetwork surrounding the predicted toggle-switch between GATA1 and SPI1 (middle). <bold>e</bold>. Ranking of known lineage-associated genes for the erythroid and monocyte lineages using different methods with the CellRank workflow (<xref ref-type="sec" rid="S12">Methods</xref>). <bold>f</bold>. AUROC of predicting lineage drivers for erythroid and monocyte cells (PS: perturbation simulation; CR: CellRank; <italic>N</italic> = 3 trained models each).</p></caption><graphic xlink:href="EMS201949-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>RegVelo uncovers key regulators of cell fate decisions during zebrafish neural crest development.</title><p><bold>a</bold>. Schematic of the experimental design for time-resolved single-cell gene expression and multimodal assays and in vivo Perturb-seq to capture neural crest cell development (ss: somite stage; h: hour post fertilization; mut: mutant). Box plots indicate the median (center line), interquartile range (hinges), and 1.5x interquartile range (whiskers); the shown box plots are schematics. <bold>b</bold>,<bold>c</bold>. UMAP embedding of 697 neural crest cells from Smart-seq3 dataset colored by cell states (b) and known initial and terminal states (c) (NPB, neural plate border; dNC, delaminating neural crest; mNC, migratory neural crest; mes, mesenchyme; arch2, second pharyngeal arch). <bold>d</bold>. We plot the number of identified terminal states against the number of macrostates specified (top) and the terminal state identification (TSI) score using RegVelo (blue), veloVI (orange), and scVelo (green) (<italic>N</italic> = 20; two-sided Welch’s <italic>t</italic>-test, <italic>P</italic> &lt; 0.001). Error bars correspond to 95% confidence intervals. Line styles and colors indicate different methods. <bold>e</bold>. RegVelo-predicted cell fate perturbation effects of known lineage drivers. We used a student’s t-test to assess the significance of the perturbation effects on mNC head mesenchymal or pigment lineages. <bold>f</bold>. AUROC of lineage driver prediction for facial mesenchymal and pigment lineage specification based on RegVelo’s perturbation simulation (PS), or CellRank using gene expression (GEX) or gene activity (GA) of TFs. <bold>g</bold>. PHATE embedding of 39,453 neural crest development cells from the joint Perturb-seq datasets with terminal states colored. <bold>h</bold>. PHATE embedding colored by in vivo <italic>nr2f2</italic> perturbation score quantified by MELD, Only cells with MELD likelihood scores in the top 20% (&gt;0.8 quantile) or bottom 20% (&lt;0.2 quantile) are colored; others are shown in grey. (<italic>N</italic> =834 cells including both control and <italic>nr2f2</italic> knockout) <bold>i</bold>. Benchmark of in silico perturbation effect prediction using RegVelo, dynamo, and CellOracle (<italic>N</italic> = 3 trained RegVelo models; one-sided Welch’s <italic>t</italic>-test, <italic>P</italic> = 0.0004 for single knock out and <italic>P</italic> = 0.00015 for multiple knockout).</p></caption><graphic xlink:href="EMS201949-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>tfec regulates pigment cell development as an early driver.</title><p><bold>a</bold>. Identification of top putative driver TFs of the pigment lineage through RegVelo’s in silico simulation, highlighting known pigment drivers in red (left). The PHATE embeddings visualize the MELD likelihood, indicating the pigment lineage depletion in <italic>tfec</italic> and <italic>mitfa</italic> knockouts (right). <bold>b)</bold> The top 10 positive regulated tfect targets predicted by RegVelo and ranked by inferred weights (left). Violin plot of top target gene expression in in vivo Perturb-seq dataset (right; <italic>N</italic> = 779 cells; one-sided Welch’s <italic>t</italic>-test, <italic>P</italic> = 0.02 for <italic>cdkn1ca, P</italic> = 3.44 × 10<sup>−8</sup> for <italic>atp6ap2</italic>). <bold>c</bold>. Gene ontology network analysis of RegVelo-predicted targets. <bold>d</bold>. Expression patterns of representative bHLH factors in the pigment lineage within our Smart-seq3 data along developmental stages. <bold>e</bold>. Gene expression patterns from multiome data of representative bHLH factors in the pigment lineage over latent time as computed by original study<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. <bold>f</bold>. Bar plots present the regulons with the highest Jaccard index in RegVelo inferred GRN, indicating shared target genes with the mitfa(+) and tfec(+) enhancer-driven regulons and implying potential redundancy among tfec, mitfa, bhlhe40, and tfeb factors highlighted in red. <bold>g</bold>. Contrast images illustrate the albino phenotype in F<sub>0</sub> crispants after 36 hours past fertilization (hpf), following the triple knockout of <italic>tfec;mitfa;tfeb</italic>, without, with weak, and with strong phenotype (Chi-square test of independence, <italic>P</italic> &lt; 1 × 10<sup>−10</sup> (experiment 1) and <italic>P</italic> &lt; 1 × 10<sup>−10</sup> (experiment 2)). <bold>h</bold>. The enhancer candidate upstream of <italic>tfec</italic> contains TF binding motifs for Sox10, indicated by the ChromBPNet-predicted contribution score. This enhancer candidate is mildly accessible in migratory neural crest cells and more accessible in the pigment lineage, indicated by the ATAC peak signals.</p></caption><graphic xlink:href="EMS201949-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>RegVelo identifies an early pigment lineage driver, <italic>elf1</italic>, together with its regulatory context.</title><p><bold>a</bold>. Cell fate perturbation effects estimated from elf1 regulon knockout simulation. <bold>b</bold>. PHATE embedding colored by in-vivo <italic>elf1</italic> perturbation scores quantified by MELD. <bold>c</bold>. HCR demonstrates a reduction in <italic>mitfa</italic>-expressing pigment lineage in <italic>elf1</italic> crispants compared to the wild-type embryo at 21 ss. <bold>d</bold>. Putative target genes <italic>fli1a, pmp22a</italic>, and <italic>cited1</italic> downstream of elf1, based on chromatin accessibility of <italic>cis</italic>-regulatory element candidates (top left track plots), the cluster-specific gene expression (top right violin plots), and the highlighted ETS TF binding instances (bottom). <bold>e</bold>. Violin plots show the expression of top targets genes between control and <italic>elf1</italic> knockout for the pigment cell lineage in the in vivo Perturb-seq dataset (<italic>N</italic> = 157 cells) (adjusted <italic>P</italic> =2.4 × 10<sup>−10</sup> for <italic>pmp22a, P</italic> =0.02 for <italic>cited1</italic>, by edgeR). <bold>f</bold>. Violin plot of <italic>fli1a</italic> gene expression in Perturb-seq dataset (<italic>N</italic> = 779 cells) of all neural crest cells in two conditions (adjusted <italic>P</italic> = 0.004, by limma DE test). <bold>g</bold>. The top ten RegVelo-predicted targets of <italic>elf1</italic> affected most in the pigment lineage. <bold>h</bold>. RegVelo’s predictions suggest that a toggle-switch circuitry governs the cell fate decision between the pigment and mesenchymal lineages (top). We visualize the branching point and highlight the balance between these gene regulatory programs via the log<sub>2</sub>-fold change of the average expression levels of all fli1a targets versus all elf1 targets in each cell (x-axis) along the cell differentiation latent time inferred by RegVelo (y-axis). <bold>i</bold>. Two candidate <italic>cis-</italic>regualtory elements of <italic>elf1</italic> contain the TF binding instances of bHLH family TFs and ETS family TFs.</p></caption><graphic xlink:href="EMS201949-f006"/></fig></floats-group></article>