<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199511</article-id><article-id pub-id-type="doi">10.1101/2024.10.15.618423</article-id><article-id pub-id-type="archive">PPR926298</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Unveiling the Functional Connectivity of Astrocytic Networks with AstroNet, a Graph Reconstruction Algorithm Coupled to Image Processing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Zonca</surname><given-names>L.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">#</xref></contrib><contrib contrib-type="author"><name><surname>Bellier</surname><given-names>F.C.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Milior</surname><given-names>G.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Aymard</surname><given-names>P.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Visser</surname><given-names>J.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Rancillac</surname><given-names>A.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Rouach</surname><given-names>N.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Holcman</surname><given-names>D.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><aff id="A1"><label>1</label>Applied Mathematics and Computational Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03mxktp47</institution-id><institution>IBENS</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0dhs15</institution-id><institution>Ecole Normale Supérieure, PSL University</institution></institution-wrap>, <city>Paris</city>, <country country="FR">France</country></aff><aff id="A2"><label>2</label>Neuroglial Interactions in Cerebral Physiology and Pathologies, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01mvzn566</institution-id><institution>Center for Interdisciplinary Research in Biology</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04ex24z53</institution-id><institution>Collège de France</institution></institution-wrap>, CNR UMR 7241, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vjkv261</institution-id><institution>INSERM</institution></institution-wrap> U1050, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013cjyk83</institution-id><institution>PSL</institution></institution-wrap>, <city>Paris</city>, <country country="FR">France</country></aff><aff id="A3"><label>3</label>Churchill College, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <postal-code>CB30DS</postal-code><country country="GB">UK</country></aff></contrib-group><author-notes><corresp id="CR1">Corresponding author: <email>david.holcman@ens.fr</email> Co-corresponding <email>lou.zonca@gmail.com</email>
</corresp><fn fn-type="present-address" id="FN1"><label>#</label><p id="P1">Present address: Center for Brain and Cognition, University Pompeu Fabra, Barcelona, Spain.</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>19</day><month>10</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>17</day><month>10</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Astrocytes form extended intercellular networks, displaying complex calcium activity. However, the specific organization of these astrocytic networks and the precise extent of their functional connectivity in different brain areas remain unexplored. To unveil the functional architecture of astrocytic networks, we developed, using a data-driven methodology, a novel algorithm called AstroNet that uses two-photon calcium imaging to map temporal correlations in activation events among neighboring astrocytes. Our approach involves reconstructing functional astrocytic networks by organizing individual astrocyte activation events chronologically. This chronological order creates activity paths that enable the extraction of local astrocyte functional correlations. Ultimately, by tallying the occurrences of direct co-activations between pairs of cells along these pathways, we construct a graph that mirrors the underlying astro-cyte functional network. By applying this method to two distinct brain regions (CA1 hippocampus and motor cortex), we identified notable differences in local network organizations in sub-regions of around 20-40 astrocytes. Specifically, the cortex exhibited a lower connectivity, while astrocytes in the hippocampus displayed stronger connections. Moreover, we found that in both regions, astrocytic networks consist of smaller, tightly connected sub-networks embedded within a larger, more loosely connected one. Altogether, our innovative method enables the identification of activation paths among astrocytes, facilitates the characterization of local network functional connectivity, and quantifies distinct connectivity patterns among astrocytes from different brain regions. This approach sheds light on the heterogeneous functional organization of astrocytic networks within the brain, pointing to region-specific astrocyte connectivity.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P3">Glial cells form intricate networks interconnected by gap junctions [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>], facilitating the exchange of ions and small molecules. Among these glial cells, astrocytes play a crucial role in various functions [<xref ref-type="bibr" rid="R3">3</xref>, <xref ref-type="bibr" rid="R4">4</xref>], including the regulation of potassium flows during neuronal activity [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R6">6</xref>], ensuring metabolic needs, influencing the formation of synapses, and modulating neuronal circuit activity [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R8">8</xref>]. At the morphological level, astrocytes establish contact with hundreds of neurons and interact with hundreds (in cortical columns) to thousands (in the hippocampus) of other astrocytes [<xref ref-type="bibr" rid="R1">1</xref>]. Despite this extensive structural connectivity, little is known about the motifs of astrocyte calcium signaling at the network level and their specific paths during spontaneous activity.</p><p id="P4">In neuronal networks, signal transmission occurs through chemical synapses, initiating a chain of events leading to the propagation of action potentials. However, in astroglial networks, only a subset of astrocytes are activated following a calcium burst initiated in an astrocyte [<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R12">12</xref>]. Thus the principles governing the extent and synchronization of calcium activity within astroglial networks remain unclear. We here posit that the activated network’s path could serve as a basis for reconstructing synchronized astrocytes belonging to a preferentially connected network. This hypothesis provides a potential avenue for understanding the selective activation patterns in astrocytic networks during various physiological processes.</p><p id="P5">Calcium imaging analysis has unveiled recurrent activations within neuronal networks [<xref ref-type="bibr" rid="R13">13</xref>], including Up-Down state activity [<xref ref-type="bibr" rid="R14">14</xref>]. These networks can range in size, from a few cells in cultured environments [<xref ref-type="bibr" rid="R13">13</xref>], to extensive populations exceeding millions in brain slices or in-vivo settings [<xref ref-type="bibr" rid="R15">15</xref>]. In contrast, much less is known about such recurrent activity in astrocytes, particularly regarding the local connectivity patterns. Reconstructing connectivity in dissociated cultured neurons has leveraged spike dynamics sorting during spontaneous activity and numerical simulations [<xref ref-type="bibr" rid="R16">16</xref>]. Techniques like constructing correlation matrices for place cells in maze-running mice [<xref ref-type="bibr" rid="R17">17</xref>], or using calcium fluorescence imaging with statistical inference to discern precise spike timings between neurons and reconstruct networks [<xref ref-type="bibr" rid="R18">18</xref>], have been successful in the neuronal domain. Meanwhile, studies have tracked individual neurons across multiple sessions using spatial and temporal metrics [<xref ref-type="bibr" rid="R19">19</xref>]. Calcium bursting events in neurons and astrocytes can now be simulated effectively [<xref ref-type="bibr" rid="R20">20</xref>], and recent advances in image segmentation have disentangled both astrocytic and neurotransmitter fluorescence dynamics at single-cell and population levels [<xref ref-type="bibr" rid="R21">21</xref>]. While a segmentation method has been developed to study calcium bursting events in astrocytes [<xref ref-type="bibr" rid="R20">20</xref>], it falls short in extracting causal relationships between neighboring cells and reconstructing local network connectivity. Astrocytic connectivity plays a key role in shaping calcium wave signaling and propagation across networks, as highlighted by [<xref ref-type="bibr" rid="R12">12</xref>]. Given that astrocytes can stabilize neuronal firing rates through calcium waves and direct regulation of ionic concentrations, high levels of astrocytic connectivity may help prevent excessive neuronal synchronization, as suggested by [<xref ref-type="bibr" rid="R22">22</xref>]. Notably, three-dimensional simulations of astrocyte networks by [<xref ref-type="bibr" rid="R23">23</xref>] revealed the existence of astrocyte hubs, which are connected to over 75% of the network, underscoring the potential for astrocytes to act as central regulators within the brain’s signaling architecture. In this study, we analyzed the spontaneous activation patterns exhibited by astrocytes, as revealed by calcium fluorescent imaging using GCaMP6f in acute slices of mice. We present here a computational approach to reconstruct Astrocyte networks and extract connectivity properties from correlated calcium events between Regions of Interest (ROI). With a microscopy field of view (40x), we evaluate a region of 150 ∗ 150<italic>μm</italic><sup>2</sup>, showing tens of visible astrocytes. This sample is in principle sufficiently to reflect broader astrocytes network activity. Additionally, this approach could be used to reconstruct astrocytic networks from calcium events recorded in-vivo using for example miniscope (one-photon) technology. Through the development of a computational method and algorithm called AstroNet, we used time series data from two-photon calcium imaging of astrocytes to reconstruct local network organizations (see <xref ref-type="fig" rid="F1">Fig.1</xref>). Our analysis involves examining calcium activity in dozens of astrocytes across various recording sessions spanning a few minutes. Following the segmentation and time ordering of astrocytic calcium bursts, we mapped the temporal causal correlation between successively activated astrocytes into paths, revealing levels of connectivity. This critical step enabled the construction of a local astrocytic network structure represented in a graph. We applied this method to recover astrocytic connectivities in the hippocampus (CA1 area) and the motor cortex (CTX). Finally, we derived various statistics associated with these graphs, such as the number of connected astrocytes, the count of highly connected astrocytes (hubs), and the properties of the connectivity matrices of these two regions, reflecting local functional connectivity.</p></sec><sec id="S2" sec-type="results"><label>1</label><title>Results</title><p id="P6">How astrocytes organize and communicate in network remains unclear, we thus developed a computational approach to reconstruct the local astrocyte functional network based on the assumption that two consecutive calcium events occurring in two neighboring astrocytes reflect a local interaction or communication. There are few calcium events at the same time, as such events last several hundreds of milliseconds, and the size of the network is of the order of tens of astrocytes maximum in the field of view. This direct activation is a form of communication, possibly through gap junctions, relying on calcium-induced-calcium-release process [<xref ref-type="bibr" rid="R12">12</xref>]. The overall reconstruction of the astrocytic network relies on this assumption. Thus to reconstruct the local astrocyte network functional connectivity, we first identified the position of active astrocytes displaying calcium signaling detected in brain slices via the selective expression of the GCaMP6 genetically-encoded calcium indicator. Given that GCaMP expression may leave only a very small fraction of astrocytes unlabeled, it is difficult to evaluate here the potential consequences of invisible (unlabeled) astrocytes. However, this should not influence significantly the network statistics we extracted here. In addition to unlabeled astrocytes in the network, there could be ROIs for which the calcium fluorescent signal never passes the activation threshold (see <xref ref-type="sec" rid="S23">Methods section 3.3.2</xref>). These ROIs are discarded and we consider that there are not significant contributors to the spread of calcium signals within the network. This hypothesis is at the basis of the present reconstruction method.</p><p id="P7">From each active astrocyte ROI, we extracted the individual fluorescence time-series. We then segmented these time-series into calcium bursting events. A calcium event in a ROI (<xref ref-type="sec" rid="S21">method section 3.3</xref>), is counted here when the amplitude exceeds the standard deviation of the completely inactive periods computed along the calcium fluorescence signal, after we removed a moving baseline. The results are segmented events that last few seconds (<xref ref-type="supplementary-material" rid="SD1">fig. S2</xref>). This pipeline (<xref ref-type="fig" rid="F1">Fig. 1</xref>) is used to reveal the unknown underlying network dynamics (<xref ref-type="fig" rid="F1">Fig. 1A-B</xref>). Briefly, the ROIs are detected by averaging over time light intensity of the whole recording session and then finding the active regions of the image, corresponding to the most luminous ones (<xref ref-type="fig" rid="F1">Fig. 1C1-C2</xref> and <xref ref-type="sec" rid="S14">Methods</xref>). We then extract the average calcium time-series for each ROI and segment them to detect the activation events by extracting local calcium peaks (<xref ref-type="fig" rid="F1">Fig. 1C3-C5</xref>). To define sequences of activation, that we call co-activation paths, we segment the recording session into <italic>N</italic> subperiods (<xref ref-type="fig" rid="F1">Fig. 1D1</xref>) and identify the active ROIs within each subsection. To extract the co-activations paths (<xref ref-type="fig" rid="F1">Fig. 1D2</xref>), we order the individual activation peaks in time, to construct a sequence (path) from the first activated astrocyte to the last one present in the subsection. Finally, the ensemble of co-activation paths are used to construct a graph which represents the functional connectivity of the underlying astrocytic network (<xref ref-type="fig" rid="F1">Fig. 1D3</xref>), where each node of the graph is an astrocyte and an edge between two nodes (astrocytes) <italic>A</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub> carries a weight equal to the number of times they were consecutively activated in the recording section.</p><sec id="S3"><label>1.1</label><title>From astrocytic burst detection to co-activation paths</title><p id="P8">Astrocytes exhibit spontaneous calcium activity [<xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R20">20</xref>] (<xref ref-type="supplementary-material" rid="SD1">movie SI1</xref>) leading to the successive activation of various neighboring cells. In order to study whether these successive activations follow a repetitive order over realizations, we extracted from the calcium time-series the successive activated astrocytes that define a co-activation path. To do so, the first step is to extract and to segment the individual activity of each astrocyte (<xref ref-type="supplementary-material" rid="SD1">Fig. S1A</xref>). Due to the calcium baseline fluctuation (<xref ref-type="supplementary-material" rid="SD1">Fig. S1B-C</xref>), we first corrected these slow fluctuations (<xref ref-type="supplementary-material" rid="SD1">Fig. S1D-E</xref> and see <xref ref-type="sec" rid="S14">Methods</xref>) to extract the individual astrocytes dynamics (<xref ref-type="supplementary-material" rid="SD1">Fig. S1F-G</xref>).</p><p id="P9">Once the individual dynamics have been identified, we collected the sequential activated astrocytes, to build the co-activation path. To this end, we segmented each recording session in <italic>N</italic> subperiods (<xref ref-type="fig" rid="F2">Fig. 2A-C</xref>). Within each of these subperiods, activated astrocytes are ordered following the time of their main activation peak (<xref ref-type="fig" rid="F2">Fig. 2D</xref>). This procedure allows to construct the activation path followed during this subperiod (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). Finally, we obtain <italic>N</italic> activation paths per recording session, that we used to reconstruct the graph of the astrocytic network (as described in the following section). Interestingly, the reconstruction procedure turns out to be relativity independent of the number <italic>N</italic> of subperiods chosen as shown in <xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref> (see <xref ref-type="sec" rid="S10">sections 1.3</xref> and <xref ref-type="sec" rid="S30">Methods 3.7</xref> for details).</p><p id="P10">When we applied this reconstruction procedure, although we detected a similar number of astrocytes in both regions (CA1 and CTX), we reported fewer activated astrocytes within subperiods in the CTX (7.28±4.81, <xref ref-type="fig" rid="F2">Fig. 2F</xref>, yellow <italic>n</italic> = 8 slices) than in the hippocampus (11.98±10.46, purple, <italic>n</italic> = 9 slices, stars always indicate 2-sample Kolmogorov-Smirnov tests with ∗ 0.05 ≥ <italic>p</italic> ≥ 0.01, ∗∗ 0.01 &gt; <italic>p</italic> ≥ 0.001, ∗ ∗ ∗ 0.001 &gt; <italic>p</italic>). Similarly, the path length defined as the sum of the distances between consecutive astrocytes on the path is shortest in the cortex (2.63±2.14 mm, <xref ref-type="fig" rid="F2">Fig. 2G</xref>) than in CA1 with 4.72±5.00 mm. Finally, we evaluated the active area, defined as the surface of the convex hull of all activated astrocytes within each subperiod. The area follows the same trend (CTX 0.23±0.14 mm<sup>2</sup> and CA1 0.32±0.26 mm<sup>2</sup>, <xref ref-type="fig" rid="F2">Fig. 2H</xref>). At this stage, we can conclude that the co-activation paths, that represent the spatio-temporal flow of information between connected astrocytes, already reveal clear differences in the local functional astrocytic network structure between the two regions.</p></sec><sec id="S4"><label>1.2</label><title>From co-activation paths to graph reconstruction</title><p id="P11">After collecting all the co-activation paths in a given recording session, we counted the number of times <italic>n</italic><sub><italic>ij</italic></sub>, a calcium activation in ROI <italic>j</italic> occurs just after the one in ROI <italic>i</italic> (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). This procedure allows to construct a connectivity matrix <italic>C</italic> = (<italic>n</italic><sub><italic>i</italic>,<italic>j</italic></sub>)<sub><italic>i</italic>,<italic>j</italic>∈[1,<italic>nROIs</italic>]</sub> between all pairs of ROIs in the network (<xref ref-type="fig" rid="F3">Fig. 3B</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>). We thus extracted one connectivity matrix (or graph) for each recording session. This matrix captures the local functional network organization from which we will be able to extract statistics such as the most active and/or most connected ROIs (see below).</p><p id="P12">We then used this connectivity matrix to compare the level of local connectivity in the two regions CTX and CA1 area of the hippocampus, where one representative session per region is shown in <xref ref-type="fig" rid="F3">Fig. 3B</xref>. A first estimation of the overall level of connectivity can be assessed from the pairwise Pearson correlation between the astrocytes’ signals over the entire session (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, left). To further quantify the correlation level between all ROIs, we constructed a correlation curve for each recording session by counting the proportion of ROIs that have at least one correlation higher than a specific threshold <italic>T</italic><sub><italic>C</italic></sub> that we vary between 0 and 1 (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, right). The closer to the top left corner is the curve, the more globally connected the astrocyte network is. We computed the area under the curve and obtained <italic>AUC</italic> = 0.56±0.07 for the CTX and 0.70 ± 0.04 for the HPC thus revealing that the local astrocytic networks are more connected in the CA1 area of the hippocampus (<xref ref-type="fig" rid="F3">Fig. 3D</xref>, purple), than in the CTX (yellow).</p><sec id="S5"><label>1.2.1</label><title>Connection strength within the networks: number of direct neighbors</title><p id="P13">To further quantify the network connectivity, we counted the number of direct neighboring astrocytes of a given astrocyte/ROI, i.e. the number of other ROIs with which it has a direct connection. This number is the classical node degree (<italic>deg</italic>) in a graph (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, upper). We found that the CTX is characterized by a smallest mean degree (i.e. the smallest number of direct neighbors) with <italic>deg</italic> = 11.95 ± 5.52, number of slices <italic>n</italic> = 8), while the CA1 astrocytes are more connected with <italic>deg</italic> = 20.34 ± 13.33, <italic>n</italic> = 9). Interestingly, the distributions of node degrees (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, lower) confirm that trend: CA1 astrocytes have mostly a high connectivity level (45% of the ROIs have a degree ≥ 30, purple distribution), while 37.5% of the CTX ROIs have a connectivity degree lower than 11 (yellow). To conclude, these results support different levels of astrocytic network connectivities, higher in CA1 and lower in the motor cortex, as was previously reported for other regions (Hippocampus vs somatosensory cortex) based on connexin expression level [<xref ref-type="bibr" rid="R1">1</xref>].</p><p id="P14">However, to further investigate how the functional astrocytic networks obtained by AstroNet differ from the quantification of physical connections made by diffusion through gap junctions, we use a pipette filled with biocytin. We found that the size of the astroglial networks in the hippocampus and in the cortex was not that different (<xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>), indicating that the calcium correlation network that we reconstruct differs from the sole passive diffusion. Possibly another mechanism is responsible for the difference in astrocyte network activity that we uncover with the AstroNet reconstruction.</p></sec><sec id="S6"><label>1.2.2</label><title>Hub astrocytes and highly connected sub-network components</title><p id="P15">To further evaluate the level of astrocytic connectivity, we decided in each graph, to focus on astrocytes with high connectivity level. We previously showed hetergeneous distributions, where some astrocytes were more connected than others (yellow subnetwork in <xref ref-type="fig" rid="F3">Fig. 3B</xref> and <xref ref-type="fig" rid="F4">Fig. 4B</xref>, upper). The nodes of these highly connected subgraphs can be considered as hub astrocytes, i.e. astrocytes that are participating in almost all activation events of the local network. We choose to count astrocytes that participate in at least 60% of events (Threshold <italic>T</italic><sub><italic>HC</italic></sub> = 0.6 ∗ 2<italic>N</italic> for undirected graph, where 2<italic>N</italic> is the maximal strength of an edge). We found that the CA1 area of the hippocampus has more hub astrocytes, with an average of 5.78 ± 8.35, or 17 ± 24%, purple (<xref ref-type="fig" rid="F4">Fig. 4B</xref> lower, purple)) compared to the cortex which is the less connected (3.63 ± 2.70 representing 28 ± 24%, yellow). We note that, although the absolute number of hub astrocytes is higher in CA1 compared to CTX, the proportions are reversed. This suggests that, in the less connected motor cortex, there is a larger proportion of astrocytes that need to participate in most activation events, however, in total the network remains sparser and less connected as we consistently saw with all the different features that we computed. Finally, the functional relevance of these hub astrocytes remain an open question, they could simply emerge as a consequence of extreme statistics of randomly connected networks [<xref ref-type="bibr" rid="R23">23</xref>] or could have a genetic origin, a question that should be further investigated.</p></sec><sec id="S7"><label>1.2.3</label><title>Transition probabilities between astrocytes</title><p id="P16">To further quantify the overall level of connectivity, we computed the distribution of the edges weights <italic>n</italic><sub><italic>ij</italic></sub> within each graph (<xref ref-type="fig" rid="F4">Fig. 4C</xref>, lower). These weights can be understood as the transition probability from ROI <italic>i</italic> to <italic>j</italic>, i.e. the probability that if ROI <italic>i</italic> is activated, then <italic>j</italic> will be the next one. These values are also the components of matrix <italic>C</italic>, (<xref ref-type="fig" rid="F4">Fig. 4C</xref> upper) and they differ significantly between the regions: again, the strongest weights are found in the CA1 area of the hippocampus (4.00 ± 4.19, purple), while the CTX has the lowest weights (1.57 ± 3.04, yellow), confirming once again the strongest connectivity in the CA1 hippocampus area.</p></sec><sec id="S8"><label>1.2.4</label><title>Astrocytic network sparsity</title><p id="P17">Conversely, we can also quantify the strength of the astrocytic network, by evaluating its sparsity, which is defined as the percentage of zeroes in the matrix <italic>C</italic> (<xref ref-type="fig" rid="F4">Fig. 4C</xref>, upper). By definition, <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mspace width="0.2em"/><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>n</italic><sub><italic>zeros</italic></sub>(<italic>C</italic>) is the number of zeroes, normalized by the size of the network <inline-formula><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, i.e. the number of ROIs that have been detected in a recording session. We found that CA1 hippocampal area has a lower sparsity (<xref ref-type="fig" rid="F4">Fig. 4D</xref> 0.41 ± 0.41, purple) than the CTX (0.55 ± 0.41, yellow). However, in both cases we found two equally distributed subgroups, one characterized by sparse connectivity and the other one by dense connections. This disparity is reflected in the wide distributions of <xref ref-type="fig" rid="F4">Fig. 4D</xref> and the lower significance of the statistical test results. At this stage, this intra-region difference remains unclear. To conclude, despite this variability, the sparsity analysis brings complementary information about the network compared to degree and hub analysis performed above. Furthermore, it confirms the trend seen all along that the functional connectivity is stronger in the CA1 hippocampus area than in the motor cortex.</p></sec><sec id="S9"><label>1.2.5</label><title>Statistics for two consecutively activated astrocytes</title><p id="P18">We computed the distribution of distances between each directly connected pair of astrocytes. This distribution is obtained from the length of the arrow connecting these two astrocytes in the co-activation paths. We found that the average distance is larger in CA1 (<xref ref-type="fig" rid="F4">Fig.4E</xref>, purple, 430 ± 7.98 <italic>μ</italic>m) than in the CTX (418 ± 10.34 <italic>μ</italic>m). The distributions reveal two major differences between CTX (yellow) and CA1 (purple): there is a peak in CA1 for short paths steps (&lt; 200<italic>um</italic>), which is absent in the case of the CTX, indicating a higher density of close neighbors with direct co-activations. A second peak in the CA1 distribution is situated at longer path steps (~ 600 − 700<italic>um</italic>), also absent in the CTX indicating long-range direct connections. On the contrary, the distribution of CTX paths steps is more peaked at the medium lengths (~ 200 − 500<italic>um</italic>), showing local variation of territories of astrocyte between CTX and CA1.</p><p id="P19">In parallel, we computed the duration of these consecutive steps (<xref ref-type="fig" rid="F4">Fig. 4F</xref>), i.e. the time delay between the activation peak of astrocyte <italic>i</italic> and astrocyte <italic>j</italic> (the two extremities of the arrow). The distributions of these durations are well fitted by a power law of the form <italic>y</italic> = <italic>Ax</italic><sup>−<italic>a</italic></sup>, where <italic>A</italic> and <italic>a</italic> are parameters to be fitted. We found a significantly faster decay in the CA1 hippocampal area (<italic>y</italic> = 0.099<italic>x</italic><sup>−1.79</sup>, purple) compared to the CTX (<italic>y</italic> = 0.14<italic>x</italic><sup>−1.18</sup>, yellow). Finally, we summarize the main network quantification results in <xref ref-type="table" rid="T1">Table 1</xref></p></sec></sec><sec id="S10"><label>1.3</label><title>Stability analysis of network reconstruction</title><sec id="S11"><label>1.3.1</label><title>Convergence of the network parameters</title><p id="P20">To ensure that the graph reconstruction and analysis of the astrocytic network from the calcium time series is stable, we developed a convergence analysis, which consists in computing various network properties while varying the number of subperiods <italic>N</italic> ∈ ⟦1, 20⟧. These network properties are: the mean and variance of the graph’s node degree, the mean path length, the number of hub astrocytes, the active area per subsection and the number of active ROI per subsection (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). Interestingly, after we ran the AstroNet pipeline analysis for increasing <italic>N</italic> (<xref ref-type="sec" rid="S30">Methods section 3.7</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>), we obtained a convergence towards the final value already after <italic>N</italic> = 5 in most cases. Indeed, for <italic>N</italic> too small, there is not enough paths to reconstruct a robust graph, as soon as <italic>N</italic> is big enough, the networks properties do not depend on the value of <italic>N</italic> (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). At this stage, we concluded that with <italic>N</italic> = 10, the AstroNet algorithm provided a robust reconstruction of the underlying astrocytic network.</p></sec><sec id="S12"><label>1.3.2</label><title>Stability of the astrocytic network revealed by a time-lapse analysis</title><p id="P21">To investigate the stability of the astrocyte networks obtained with AstroNet over a period of few minutes, we conducted a time-lapse analysis. We reconstructed and compared the network reconstructions at two different times separated by 5 minutes (see <xref ref-type="sec" rid="S30">methods section 3.7</xref>): we recorded successively at the same position in the same slice (<xref ref-type="fig" rid="F5">Fig. 5A</xref>, timepoint 1, upper and timepoint 2, lower) for 5 min intervals, and then built and compared the reconstructed graphs of the local network for the two timepoints (<xref ref-type="fig" rid="F5">Fig. 5B</xref>) with their corresponding connectivity matrices (<xref ref-type="fig" rid="F5">Fig.5C</xref>). <xref ref-type="fig" rid="F5">Fig. 5A-D</xref> shows the results for one example in CA1, we show other graphs both in the CTX (yellow, n=2) and CA1 (purple, n=6) in <xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>.</p><p id="P22">To quantify the variations in the global correlation between the two timepoints t1 and t2, we compared the correlation curves between the two timepoints (<xref ref-type="fig" rid="F5">Fig. 5D</xref>) by computing the differences between the AUC of both curves for all pairs of recordings. We found that, for all pairs, the difference was small (<xref ref-type="fig" rid="F5">Fig. 5E</xref>, 0.10 ± 0.08). Furthermore, to quantify the differences in the reconstructed graphs, we computed the Structural Similarity Index Measure (SSIM) between the connectivity matrices of timepoints t1 and t2 for all pairs of time-lapse recordings (<xref ref-type="fig" rid="F5">Fig. 5F</xref>) and obtained 0.36 ± 0.13. We found that in most recordings the SSIM index is higher than 0.4, indicating a strong similarity [<xref ref-type="bibr" rid="R24">24</xref>]. Finally, we extracted the same statistical properties of paths and network that we computed in the previous section, revealing the proportion and number of hub astrocytes, mean node degree, mean active area, mean path length and number of active astrocytes for each pair of recordings (<xref ref-type="fig" rid="F5">Fig. 5G-H</xref>): we found that in most cases it remains stable from timepoint 1 to timepoint 2 specifically in the CA1 region. In CTX recordings, we report more variability in the mentioned parameters. This variability could originate from the different level of activity between the two timepoints that we observed.</p><p id="P23">The present results show that the reconstructed graphs are stable over time and that AstroNet is able to account for this property.</p></sec></sec></sec><sec id="S13" sec-type="discussion"><label>2</label><title>Discussion</title><p id="P24">We presented here a method for the reconstruction of local astrocytic functional networks from recordings of spontaneous calcium activity. This pipeline relies on detecting astrocytic bursting times within the field of view (size 100 <italic>μ</italic>m by 100 <italic>μ</italic>m), where calcium fluorescence signals were recorded, and ordering them as they are sequentially activated (see <xref ref-type="fig" rid="F2">Fig. 2</xref>). The outcome of our approach is a collection of paths between astrocytes and a graph representing the local astrocytic functional network, encompassing 20 to 40 connected astrocytes. Interestingly, although astrocytes located at the periphery of the field of view may have connections outside of it and we may thus underestimate their connectivity level, most astrocytes are well within the image and therefore counterbalance this possible underestimation when it comes to extracting statistics for the whole astrocyte population. Thus, this sampling group of astrocytes is sufficient to reveal several statistics showing for example that there are fewer active astrocytes in the CTX compared to CA1 (7.28 ± 4.81 vs 11.98 ± 10.46 respectively).</p><p id="P25">The presented method and algorithms allowed us to extract various statistical properties of the astrocytic functional network, such as the degree of connectivity (number of direct neighbors), identification of the strongest connections across the network, identification of hub astrocytes, and the derivation of transition probability matrices to quantify path statistics.</p><p id="P26">The present algorithm complements softwares such as AQuA [<xref ref-type="bibr" rid="R21">21</xref>] that quantifies the ROI of calcium and neurotransmitter activity in fluorescence imaging datasets but does not reconstruct the underlying network. The new preliminary BioRxiv version called AQuA2, posted during the present submission, does allow for ROI segmentation, similar to AstroNet (see <xref ref-type="supplementary-material" rid="SD1">SI</xref> for a comparison), but does not integrate the astrocyte network reconstruction and connectivity quantification, which is the main focus of AstroNet.</p><p id="P27">Many software tools exist for the analysis calcium activity in both glial and neuronal cells, including GECI-quant [<xref ref-type="bibr" rid="R25">25</xref>], Suite2P [<xref ref-type="bibr" rid="R26">26</xref>], LC Pro [<xref ref-type="bibr" rid="R27">27</xref>], CaSCaDE [<xref ref-type="bibr" rid="R28">28</xref>], CaImAn [<xref ref-type="bibr" rid="R29">29</xref>], and STARDUST [<xref ref-type="bibr" rid="R30">30</xref>]. While LC Pro and STARDUST are more glia-focused, making them better suited for analyzing astrocyte-specific calcium signals, other tools like Suite2P and CaImAn are primarily designed for neuronal calcium signals and are not inherently tailored for astrocyte connectivity analysis. However, unlike the approach introduced in AstroNet, none of these tools provide direct estimation of astrocyte functional connectivity. AstroNet is specifically optimized for detecting and quantifying astrocyte calcium signal correlations, including spatio-temporal relationships that reflect network connectivity. In a different direction, identifying sub-graphs with stronger connectivity enabled differentiation between types of networks, from highly connected small worlds [<xref ref-type="bibr" rid="R31">31</xref>] to more uniformly connected structures, as measured by the sparsity of local connections (<xref ref-type="fig" rid="F4">Fig. 4</xref>).</p><p id="P28">Using this computational pipeline, we compared astrocytic connections within two different brain regions: the motor cortex (CTX), and the hippocampus (CA1). We reported differences in the connectivities of the local astrocytic networks, with the hippocampus displaying the highest density of connections (mean degree of connectivity ≈ 20) and the cortex the lowest (≈ 12) (see <xref ref-type="table" rid="T1">Table 1</xref>). The higher variability in CA1 compared to CTX indicate that the different parameters we extracted (<xref ref-type="table" rid="T1">Table 1</xref>) are more preserved across slices in the CTX. Similarly, we reported here larger distributions in CA1 for the extracted statistics (<xref ref-type="fig" rid="F4">Fig. 4A-C and E</xref>) compared to the CTX. These differences were also reflected in the global correlation levels between astrocyte time-series (<xref ref-type="fig" rid="F3">Fig. 3D</xref>) and the number of highly connected astrocytes (hub astrocytes), averaging 3.6 in the cortex vs 5.8 in CA1 (<xref ref-type="fig" rid="F3">Fig. 3B</xref>, yellow structures, and <xref ref-type="fig" rid="F4">Fig. 4B</xref>, left). While the role of GABAergic hub neurons in orchestrating synchrony in developing hippocampal networks has been established [<xref ref-type="bibr" rid="R32">32</xref>], the function of hub astrocytes remains unclear.</p><p id="P29">In conclusion, distinct brain regions appear to have specific astrocytic connectivities characterized by their degree of connectivity, overall connectivity, or the presence of highly connected sub-regions. These results may reflect the reported heterogeneity in gap junction channel abundance (connexin expression) and/or permeability, indicative of anatomical connectivity [<xref ref-type="bibr" rid="R33">33</xref>]. It could also reflect differences in astrocyte number and morphology, as the hippocampus, with its diverse astrocyte morphologies, contains a high number of astrocytes compared, for example, to the somatosensory cortex, where astrocytes are more uniformly distributed. Additionally, we found that the mean path length (total path distance between the first and the last activated astrocytes, <xref ref-type="fig" rid="F2">Fig. 2</xref>) was higher in the CA1 hippocampal area, averaging at 4.7mm compared to only 2.6mm in the cortex (<xref ref-type="table" rid="T1">Table 1</xref>).</p><p id="P30">The present approach allows us to quantify the local level of connectivity from spontaneous calcium transients in astrocytes, addressing the growing need to decode astrocyte signaling and its relevance to brain function [<xref ref-type="bibr" rid="R34">34</xref>]. While the method does not detect strictly repeating activation paths (no deterministic causal sequences), a high correlation was observed between specific subgroups of neighboring astrocytes that were more connected to each other than the others, despite their similar distances (<xref ref-type="fig" rid="F3">Fig. 3B</xref>, yellow subgraphs, and <xref ref-type="fig" rid="F4">Fig. 4B</xref>). This result suggests a direct mechanism of activation between these specific astrocytes. Dendritic or neuronal activity is much faster than astrocytic calcium dynamics, thus it is unlikely that the long paths we found here that are usually recurrent (coming back to the same astrocytes) and lasting up to a few seconds could be the results of co-activated neurons. Relying solely on passive diffusion through gap junctions would predict a uniform co-activation pattern, which our analysis disproves. The local enriched connectivity reported here raises questions about how this information can clarify neuron–glia interactions in specific networks [<xref ref-type="bibr" rid="R35">35</xref>]. The present analysis is based on soma calcium events and disregard protrusion-based activity, which would require a more refined analysis.</p><p id="P31">Finally, it is worth noting that this pipeline could also be applied to analyze neuronal fluorescent imaging. Parameters related to time and space scales can be adjusted to fit cell signals at various time-scales. The modularity of the implemented method also allows for the use of any sub-section of the signal. For instance, it is possible to use calcium activation times as an input for the graph reconstruction method, yielding graphs of local neuronal connectivity for a relatively slow signal compared to spiking activity. Differences in the structure of these graphs could provide quantification of local changes occurring at an intermediate scale between single-cell analysis and wider brain areas. Additionally, the present approach could be generalized to in vivo one-photon imaging, allowing the tracking of ROIs in freely behaving animals. The most challenging step in this case would be ROI detection due to the coarse resolution of one-photon imaging.</p></sec><sec id="S14" sec-type="methods"><label>3</label><title>Methods</title><p id="P32">The method section is organized as follows: we first recall the experimental settings used to collect calcium fluorescence recordings in the two brain regions. Second, we describe the image processing steps used to detect the astrocytic ROIs and extract segmented time-series. Third, we introduce the signal processing steps to extract the astrocytes activation events. Then, we introduce our algorithm to reconstruct astrocytic networks based on consecutive calcium burst co-activation sequences. Finally, we describe the stability analysis and corresponding time-lapse experiments.</p><sec id="S15"><label>3.1</label><title>Experimental protocol</title><sec id="S16"><label>3.1.1</label><title>Ethics on Animal manipulation</title><p id="P33">All experiments were performed according to European Community Council Directives of 01/01/2013 (2010/63/EU) and of the French ethic committee (ethics approval delivered by the French ministry of higher education, research and innovation). Experiments were carried out using the GFAP-CreERT2-GCaMP6f transgenic mouse line expressing the GCaMP6f calcium indicator in astrocytes. This mouse line was obtained by crossing the GFAP-creERT2 line with the Cre-dependent B6J.Cg-Gt(ROSA)26Sortm95.1(CAG-GCaMP6f)Hze/MwarJ transgenic mouse line (referred as Ai95(RCL-GCaMP6f)-D (C57BL/6J)), expressing a floxed-STOP cassette blocking transcription of the fast calcium indicator GCaMP6f (The Jackson Laboratory, Stock No: 028865), and which were previously characterized [<xref ref-type="bibr" rid="R36">36</xref>]. Tamoxifen (10 mg/ml in corn oil, Sigma) was injected intra-peritoneally (100 mg/kg body weight) during four consecutive days at around postnatal day 30 and experiments were performed at least three weeks after the last injection. Mice of both genders were used at postnatal days 50 to 60, and were housed under standard conditions with ad libitum access to food and water.</p></sec><sec id="S17"><label>3.1.2</label><title>Two-Photon calcium imaging</title><p id="P34">Acute transverse hippocampal slices (300-400 <italic>μ</italic>m) were prepared as previously described [<xref ref-type="bibr" rid="R37">37</xref>] from 50-60 days-old mice from WT (C57BL6) mice. GCaMP6f mice aged 50-60 days were decapitated, and their brains were rapidly extracted and submerged in cold (0-4°C) slicing artificial cerebrospinal fluid (aCSF) containing (in mM): 119 NaCl, 2.5 KCl; 2.5 CaCl2, 26.2 NaHCO3, 1 NaH2PO4, 1.3 MgSO4, 11 D-glucose (pH = 7.35). This solution was saturated with a gas mixture of 95% O2 and 5% CO2. Coronal brain slices, 400 <italic>μm</italic> thick, were cut using a vibratome (VT1200S; Leica) targeting slices around Bregma 0 mm for cortical recordings, and around Bregma -1.7 mm for hippocampal recordings. Slices were then transferred to a continuously oxygenated (95% O2–5% CO2) holding chamber containing aCSF for at least 1h before recording.</p><p id="P35">Slices were transferred to the recording chamber mounted on an Axio Examiner Z1 microscope (Carl Zeiss) equipped with a two-photon system (3i, Intelligent Imaging and Chameleon laser, Coherent) and were perfused with ACSF at a rate of 4 ml/min. Experiments were performed in the presence of picrotoxin (100 <italic>μ</italic>M) and a cut was made between CA1 and CA3 to prevent recurrent electrical activity between the two regions. Astrocytes expressing AAV GCaMP6f were excited at 920 nm and fluorescence detected after a 525/40 emission filter and a 580 nm dichroic mirror. Water-immersion objectives of either 20x, NA 1.0 or 40x NA 1.0 (Carl Zeiss) were used. Images were acquired at 3 Hz through a 40× water immersion objective (NA 0.95, Olympus). Images were pre-processed off-line with Slidebook imaging software (3i) by applying a median filter.</p><sec id="S18"><title>Astroglial gap-junction coupling</title><p id="P36">To visualize astroglial networks, biocytin (7 mg/ml, Sigma) was included in the intracellular solution, allowing it to diffuse throughout the network over 20 minutes. The slices were then fixed overnight in 4% paraformaldehyde (PFA), followed by incubation in phosphate-buffered saline (PBS) containing 1% gelatin and 1% Triton X-100 (PGT 1%). Visualization was achieved using Alexa Fluor 555-conjugated strep-tavidin (1:300 in PGT1%, Invitrogen). After several PBS washes, the slices were mounted in Fluoromount-G (Southern Biotechnology) and examined using a confocal laser-scanning microscope (Leica DMI6000 Inverted SP5) equipped with a 20×/0.75NA objective. Z-stacks of consecutive confocal images were captured at 0.5 <italic>μm</italic> intervals using a 561 nm Diode-pumped solid-state (DPSS) laser controlled by LAS AF software (Leica). Cell counting was performed with ImageJ software.</p></sec><sec id="S19"><title>Data acquisition</title><p id="P37">We acquired data under standardized conditions with a scanning rate of 3 Hz, at a depth of 50 microns below the surface, with consistent laser power. Changing the laser power could destabilize astrocytes excitation. This standardization is essential for ensuring the reproducibility of the present datasets. We used 5 min recordings and performed the analysis on the entire recordings that we further split into 10 subperiods for the network reconstruction analysis (<xref ref-type="sec" rid="S25">section 3.4</xref>). Our recordings and codes are available on Zenodo, github and on the lab’s website <ext-link ext-link-type="uri" xlink:href="http://www.BioNewMetrics.org">www.BioNewMetrics.org</ext-link>, see below.</p></sec></sec></sec><sec id="S20"><label>3.2</label><title>Principle of spontaneous calcium activity in astrocytes</title><p id="P38">Calcium spontaneous activity in astrocytes is generated by calcium-induced-calcium-release (CICR) from the endoplasmic reticulum (ER) triggered by the opening of Ryanodin receptors (RyRs) and/or IP3-receptors [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R38">38</xref>, <xref ref-type="bibr" rid="R2">2</xref>]. The up-stream signaling can be generated by neuronal activity or random calcium events with IP3 transients in astrocytes. Once calcium ions are present in the cytoplasm, they can either be pumped back into the ER or diffuse to the neighboring astrocytes through gap junctions. These calcium transients generate a bumped shape in fluorescent time-series <inline-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<italic>t</italic>), recorded in a region of interest (ROI) around astrocyte <italic>A</italic><sub><italic>k</italic></sub>. We build the present pipeline based on the hypothesis that calcium transients can be detected at a time <italic>t</italic><sub><italic>k</italic></sub> in a given epoch by detecting the global maximum (within this epoch) of the calcium fluorescence intensity for a time series. In an epoch going from 0 to time T, this is given by: <disp-formula id="FD2"><label>(2)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.2em"/><mml:munder><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:munder><mml:mspace width="0.2em"/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P39">Network events consist of ordered time sequences (min(<italic>t</italic><sub>1</sub>, ..<italic>t</italic><sub><italic>m</italic></sub>), .., max(<italic>t</italic><sub>1</sub>, ..<italic>t</italic><sub><italic>m</italic></sub>)) among detected astrocytes. The difference between two consecutive time points <inline-formula><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for two astrocytes <italic>i, j</italic> presenting a consecutive calcium burst, reflects calcium signal propagating from astrocyte <italic>i</italic> to <italic>j</italic>.</p></sec><sec id="S21"><label>3.3</label><title>Astrocyte detection and events segmentation</title><sec id="S22"><label>3.3.1</label><title>ROI detection</title><p id="P40">The ROI detection requires two steps: <list list-type="order" id="L1"><list-item><p id="P41"><bold>Signal summation and normalization</bold>. To detect the position of all active astrocytes in each recorded session, we sum all frames over time, resulting in a combined image <italic>I</italic><sub><italic>sum</italic></sub>, that we normalize as follows: <disp-formula id="FD3"><label>(3)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p id="P42">Thus pixel values <italic>I</italic><sub><italic>norm</italic></sub> are now in the [0, <xref ref-type="bibr" rid="R1">1</xref>] range.</p></list-item><list-item><p id="P43"><bold>Image binarization</bold>. To account for the heterogeneity of the luminous intensity in the image (due to the laser’s position), we use an adaptive threshold <italic>T</italic><sub><italic>adapt</italic></sub> obtained with the built-in MATLAB function <italic>adaptthresh</italic> with a threshold parameter <italic>T</italic> = 0.5. We then binarize the normalized summed image <italic>I</italic><sub><italic>norm</italic></sub> with this threshold <italic>T</italic><sub><italic>adapt</italic></sub>. Finally, we remove all detected ROIs that are too small to be an astrocyte soma (smaller than a size <italic>T</italic><sub><italic>min</italic></sub> = 30 pixels). This allows us to filter artifactual detections due to the presence of noise in the recordings. All the remaining regions are kept as potential ROIs. The threshold values <italic>T</italic> and <italic>T</italic><sub><italic>min</italic></sub> are input parameters of the method and can be adjusted for each type of recordings.</p></list-item></list></p></sec><sec id="S23"><label>3.3.2</label><title>Calcium signal extraction and baseline correction</title><p id="P44">From each detected astrocyte <italic>a</italic>, we extract the temporal fluorescent signal by averaging the intensity over all pixels in the ROI (<xref ref-type="supplementary-material" rid="SD1">SI Fig. S1A</xref>) at each time frame <italic>t</italic> from the normalized data. To treat high resolution imaging, we can use a spatial down-sampling parameter, as explained in the <xref ref-type="supplementary-material" rid="SD1">SI</xref>. We obtain an activation time-series denoted <italic>s</italic><sup><italic>a</italic></sup>(<italic>t</italic>) (<xref ref-type="supplementary-material" rid="SD1">Fig. S1B</xref>) for each astrocyte ROI <italic>a</italic>. We kept active astrocytes for which the calcium dynamics has a variation greater than 10% over time, compared to their mean value ⟨<italic>s</italic><sup><italic>a</italic></sup>⟩.</p><p id="P45">We segmented the time-series to detect the calcium activation events and extracted their characteristics by correcting slow fluctuations of the baseline (<xref ref-type="supplementary-material" rid="SD1">SI Fig. S1C-E</xref>), that can vary from one ROI to the next, as well as the noise intensity of each signal. This correction is made in several steps: <list list-type="order" id="L2"><list-item><p id="P46"><bold>Peak detection</bold>. Calcium peaks in the fluorescent signal are detected using the built-in MATLAB function <italic>findpeaks</italic> with a minimal amplitude <italic>minDepth</italic> = 0.1 (<xref ref-type="supplementary-material" rid="SD1">Fig. S1C</xref>, purple dots).</p></list-item><list-item><p id="P47"><bold>Baseline signal outside of peaks</bold>. We recover the baseline fluctuations of the signal, from the time intervals during which astrocyte <italic>a</italic> is inactive (<xref ref-type="supplementary-material" rid="SD1">Fig. S1D</xref>, red curve). To do so, we remove the duration Δ<italic>t</italic><sub><italic>ev</italic></sub> = 10s before and 1.5Δ<italic>t</italic><sub><italic>ev</italic></sub> = 15s after each detected peak leading to an incomplete output signal <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic>), only defined outside of the activation periods, i.e. <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic><sub><italic>inact</italic></sub> = <italic>s</italic><sup><italic>a</italic></sup>(<italic>t</italic><sub><italic>inact</italic></sub>)), where the timepoints <italic>t</italic><sub><italic>inact</italic></sub> are left after removing the activation periods. The function <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic>) is not defined during the activation periods.</p></list-item><list-item><p id="P48"><bold>Complete baseline reconstruction</bold>. To construct a global baseline signal <italic>b</italic><sup><italic>a</italic></sup>(<italic>t</italic>) for each astrocyte <italic>a</italic> over the entire time series, we fitted the signal <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic>) obtained from the previous step, with a smoothing spline (with smoothing parameter <italic>p</italic><sub><italic>smooth</italic></sub> = 7.10 − 5) using the MATLAB fitting tool (<xref ref-type="supplementary-material" rid="SD1">Fig. S1E</xref>, black curve). This procedure allows to define the baseline <italic>b</italic><sup><italic>a</italic></sup>(<italic>t</italic>) for all times.</p></list-item><list-item><p id="P49"><bold>Corrected calcium signal</bold>. The corrected signal (<xref ref-type="supplementary-material" rid="SD1">SI Fig. S1F</xref>, dark green curve) is obtained by subtracting the baseline <italic>b</italic><sup><italic>a</italic></sup> from the activation time-series <italic>s</italic><sup><italic>a</italic></sup>, leading to <inline-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p id="P50">The resting value of signal <inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<italic>t</italic>) is now zero (<xref ref-type="supplementary-material" rid="SD1">Fig. S1F</xref>, solid black line). This signal is used to segment and extract calcium event statistics, as described in the next paragraph.</p></sec><sec id="S24"><label>3.3.3</label><title>Signal segmentation and statistics extraction</title><p id="P51">We segment the corrected signal <inline-formula><mml:math id="M9"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as follows: <list list-type="order" id="L3"><list-item><p id="P52"><bold>Event threshold definition</bold>. An event is detected if <inline-formula><mml:math id="M10"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> reaches a threshold <italic>T</italic><sub><italic>e</italic></sub> (<xref ref-type="supplementary-material" rid="SD1">SI Fig. S1F</xref> dotted black line) defined as <italic>T</italic><sub><italic>e</italic></sub> = <italic>min</italic>(4.5<italic>σ</italic><sup><italic>a</italic></sup>, <italic>T</italic><sub><italic>high</italic></sub>) where <italic>σ</italic><sup><italic>a</italic></sup> is the empirical standard deviation of the signal outside of peaks <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic>) and <italic>T</italic><sub><italic>high</italic></sub> = 0.08 is an fixed value chosen empirically to avoid too high event thresholds. This can happen when the signal outside of peaks <italic>r</italic><sup><italic>a</italic></sup>(<italic>t</italic>), is defined on very few timepoints (i.e. for a very active astrocyte) and thus its empirical standard deviation would not be very representative of the actual noise of its signal. In all other cases the empirical variance <italic>σ</italic><sup><italic>a</italic></sup> is a good estimate of the noise amplitude of the signal.</p></list-item><list-item><p id="P53"><bold>Event detection</bold>. An event is detected at time <italic>t</italic><sub><italic>d</italic></sub> if <inline-formula><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> reaches the threshold <italic>T</italic><sub><italic>e</italic></sub> that we defined in the previous point. Then, the beginning of the event is set as the last time <italic>t</italic><sub><italic>i</italic></sub> &lt; <italic>t</italic><sub><italic>d</italic></sub> where <inline-formula><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (i.e. at the baseline). The event end is defined as the next time <italic>t</italic><sub><italic>e</italic></sub> <italic>&gt; t</italic><sub><italic>d</italic></sub> when the signal is back at its baseline value i.e. <inline-formula><mml:math id="M13"><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> with <italic>t</italic><sub><italic>e</italic></sub> <italic>&gt; t</italic><sub><italic>d</italic></sub>.</p></list-item><list-item><p id="P54"><bold>Events statistics extraction</bold>. The signal is then segmented into events (<xref ref-type="supplementary-material" rid="SD1">SI Fig. S1G</xref>, blue) and inter-events (dark orange) from which we extract the durations <italic>d</italic> (blue), the amplitudes <italic>α</italic> (black), the inter-event durations <italic>i</italic><sub><italic>e</italic></sub> (dark orange), the event frequencies <italic>f</italic> (red) and also the number of peaks <italic>n</italic><sub><italic>p</italic></sub> per event (light orange). This is done for every ROI.</p></list-item></list></p></sec></sec><sec id="S25"><label>3.4</label><title>Reconstruction of the local astrocyte network</title><p id="P55">We detail here the procedure that allows us to construct the connectivity graph between the detected astrocytes from the consecutive sequences of calcium events. This network reconstruction is based on the segmentation of the recordings in <italic>N</italic> subperiods over the whole time of the recording used to identify the calcium co-activation paths between astrocytes for each subperiod. This collection of <italic>N</italic> co-activation paths is then concatenated to build the global connectivity graph with estimated weighted edges for the whole recording session. We detail theses steps in the following sections.</p><sec id="S26"><label>3.4.1</label><title>Detection of the co-activation paths</title><p id="P56">The recording sessions are first segmented into <italic>N</italic> subperiods of equal duration (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). We then study the co-activation dynamics within each subperiod as follows: <list list-type="order" id="L4"><list-item><p id="P57"><bold>Detection of the astrocytes activated during the subperiod</bold> <italic>n</italic> ∈ ⟦1, <italic>N</italic> <bold>]</bold>. An astrocyte <italic>a</italic> is considered active during the subperiod <italic>n</italic> if there is at least one time <italic>t</italic> in the subperiod <italic>n</italic> for which <inline-formula><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>T</italic><sub><italic>e</italic></sub> is the event threshold defined in the previous section.</p></list-item><list-item><p id="P58"><bold>Estimation of the activation order during the subperiod</bold> <italic>n</italic>. We order the activated astrocytes with respect to the time of their main activation peak during the subperiod <italic>n</italic> (<xref ref-type="fig" rid="F2">Fig. 2D</xref>, the colored dots indicate the main peak for each astrocyte’s signal within the subperiod).</p></list-item><list-item><p id="P59"><bold>Co-activation path reconstruction</bold>. The co-activation path is obtained iteratively by joining the ordered astrocytes by arrows pointing toward the next activated astrocyte, going from the first activated to the last one (2E, red to yellow arrows). A such path is obtained for each subperiod, i.e. for one recording session we obtain <italic>N</italic> activation paths.</p></list-item></list></p></sec><sec id="S27"><label>3.4.2</label><title>Constructing a connectivity graph</title><p id="P60">A graph is an ensemble of <italic>n</italic><sub><italic>a</italic></sub> nodes connected by weighted edges. The present graph construction procedure is based on the concatenation of the co-activation paths described in the previous sub-section. Specifically, each astrocyte ROI <italic>a</italic> constitutes a node of the graph. The edge weights are then extracted from the co-activation paths in two ways leading to a directed or an undirected graph: <list list-type="order" id="L5"><list-item><p id="P61"><bold>Directed graph:</bold> built by adding the value +1 to the edge weight <italic>n</italic><sub><italic>i</italic>,<italic>j</italic></sub> of the connectivity matrix <italic>C</italic>, each time there is a direct arrow from astrocyte <italic>i</italic> to astrocyte <italic>j</italic> in the collection of co-activation paths obtained above. This leads to an asymmetric matrix of size (<italic>n</italic><sub><italic>ROIs</italic></sub> × <italic>n</italic><sub><italic>ROIs</italic></sub>) (where <italic>n</italic><sub><italic>ROIs</italic></sub> is the total number of active ROIs in the recording session). Each value is between 0 (no connection between this pair) and <italic>N</italic> (strongest connection). The result is an asymmetric connectivity matrix of the graph.</p></list-item><list-item><p id="P62"><bold>Undirected graph:</bold> the procedure is similar, except that we add +1 to both <italic>n</italic><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>n</italic><sub><italic>j</italic>,<italic>i</italic></sub> regardless of the direction of the arrow each time astrocytes <italic>i</italic> and <italic>j</italic> are directly connected by an arrow in a path. This results in a symmetric matrix of size (<italic>n</italic><sub><italic>ROIs</italic></sub> × <italic>n</italic><sub><italic>ROIs</italic></sub>), where each value is between 0 and 2<italic>N</italic> (<xref ref-type="fig" rid="F3">Fig. 3B</xref>).</p></list-item></list></p><p id="P63">To conclude, we obtain a connectivity graph <italic>G</italic> = (<italic>A, C</italic>), where <italic>A</italic> is the ensemble of vertices (i.e the atrocytes ROIs) and <italic>C</italic> is the connectivity matrix. In summary: <list list-type="order" id="L6"><list-item><p id="P64">The ensemble of nodes associated to detected astrocytes are <inline-formula><mml:math id="M15"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p id="P65">The connectivity matrix <inline-formula><mml:math id="M16"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> counts the number of times edge <italic>i</italic> → <italic>j</italic> is activated in an event.</p></list-item></list></p><p id="P66">We define the probability density matrix from the connectivity matrix by dividing each coefficient by the sum of the coefficient in a given raw.</p></sec></sec><sec id="S28"><label>3.5</label><title>Pearson correlation analysis</title><p id="P67">The global correlation analysis (<xref ref-type="fig" rid="F3">Fig. 3C-D</xref>) is performed using the Matlab built in function <italic>corr</italic>. This function computes the pairwise Pearson correlation coefficient between each pair of signals (i.e. for each ROI). The Pearson correlation coefficient <italic>ρ</italic> between two time-series <italic>X</italic> and <italic>Y</italic> is defined as <disp-formula id="FD4"><label>(4)</label><mml:math id="M17"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M18"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> denotes the average value of <italic>X</italic>.</p></sec><sec id="S29"><label>3.6</label><title>Highly connected subgraph and hub astrocytes detection</title><p id="P68">We can define a subgraph (<italic>G</italic><sub><italic>max</italic></sub>, <italic>C</italic>) that contains only the most connected nodes (see <xref ref-type="fig" rid="F3">Fig. 3B</xref>, yellow subgraph). This is the subgraph where all edge weights <italic>n</italic><sub><italic>ij</italic></sub> are higher than the threshold <italic>T</italic><sub><italic>HC</italic></sub>. Here we show the statistics for <italic>T</italic><sub><italic>HC</italic></sub> = 0.6 max(<italic>C</italic>) i.e <italic>n</italic><sub><italic>ij</italic></sub> = 12 in the case of the non-oriented graph (see <xref ref-type="fig" rid="F3">Fig. 3B</xref>, yellow subgraphs, and <xref ref-type="fig" rid="F4">Fig. 4B</xref>). Subgraphs of any connectivity level could be extracted by varying the value of <italic>T</italic><sub><italic>HC</italic></sub> which is an input parameter in the function <italic>activGraph</italic> that constructs the graphs and gets its statistics (<xref ref-type="supplementary-material" rid="SD1">SI, section 1.5</xref>). The hub astrocytes are the nodes of the highly connected subgraph, i.e. the ones connected to at least 60% of the network (i.e. of degree <italic>d</italic> ≥ <italic>T</italic><sub><italic>HC</italic></sub>).</p></sec><sec id="S30"><label>3.7</label><title>Stability analysis</title><sec id="S31"><label>3.7.1</label><title>Effect of the number of subsections on the graph reconstruction</title><p id="P69">To guarantee the stability of the network construction algorithm, we studied how the choice of the number of subsections <italic>N</italic> affects the graph’s properties. To do so, we varied the number <italic>N</italic> of subsections and ran the whole pipeline. Specifically, we ran the entire AstroNet pipeline for all the available recordings from the two brain regions with <italic>N</italic> ∈ ⟦0, 20⟧. We then plotted several extracted features that quantify the network organization vs the value of <italic>N</italic>. These features are: mean node degree, variance of node degree, mean path length, number of hub astrocytes, active area per subperiod and number of active astrocytes per subperiod. We obtained one curve per recording, for each observed parameter vs the values of <italic>N</italic> (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>).</p></sec><sec id="S32"><label>3.7.2</label><title>Time-lapse analysis for network reconstruction stability</title><p id="P70">To test the stability over time of AstroNet, we recorded in the same region, two successive recordings of 5 min, with a resting period of also 5 min, while the slice incubated in ACSF oxygenated with later closed.</p><p id="P71">To detect all active ROIs, we concatenated the two recordings and ran the ROI detection step. To quantify the changes between the two recordings, we computed the difference between the area under the curves (AUC) of the global correlation curves of both recordings. To compare the network structure, we used and computed the Structural Similarity Index Measure (SSIM) [<xref ref-type="bibr" rid="R39">39</xref>] between the two connectivity matrices (<xref ref-type="fig" rid="F5">Fig. 5C, F</xref>). The SSIM offers a trade-off between direct difference measurements such as Euclidian distance or Mean Squared Error (MSE), and indirect ones such as correlation [<xref ref-type="bibr" rid="R24">24</xref>]. A SSIM of 1 means total similarity and 0 total difference. Using this measure for matrix comparison, an SSIM greater than 0.4 is considered as a strong similarity [<xref ref-type="bibr" rid="R24">24</xref>].</p></sec></sec><sec id="S33"><label>3.8</label><title>AstroNet MATLAB toolbox</title><p id="P72">AstroNet is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/13889962">https://zenodo.org/records/13889962</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/louzonca/NetConstruct">https://github.com/louzonca/NetConstruct</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.bionewmetrics.org">www.bionewmetrics.org</ext-link>. The pipeline (described in 1), is modular made of independent functions for each of the steps. This allows to process only part of the pipeline at a time. For example, one could provide time-series of any type of cellular activation (e.g. neuronal patch clamp or MEA recordings or calcium time series of various types of cells) and start AstroNet at the segmentation step (<xref ref-type="fig" rid="F1">Fig. 1C5</xref>) to extract the local functional network properties. The contents, scripts and functions are described in the <xref ref-type="supplementary-material" rid="SD1">SI (section 1)</xref>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary information</label><media xlink:href="EMS199511-supplement-Supplementary_information.pdf" mimetype="application" mime-subtype="pdf" id="d11aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S34"><title>Acknowledgments</title><p>LZ was supported by Fondation pour la Recherche Medicale (FRM FDT202012010690). DH is supported by ANR AstroXcite, Memolife and the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (No 882673). NR is supported by ANR (AstroXcite) and Memolife.</p></ack><fn-group><fn fn-type="conflict" id="FN2"><p id="P73"><bold>Competing interests</bold></p><p id="P74">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giaume</surname><given-names>C</given-names></name><name><surname>Koulakoff</surname><given-names>A</given-names></name><name><surname>Roux</surname><given-names>L</given-names></name><name><surname>Holcman</surname><given-names>D</given-names></name><name><surname>Rouach</surname><given-names>N</given-names></name></person-group><article-title>Astroglial networks: a step further in neuroglial and gliovascular interactions</article-title><source>Nature Reviews Neuroscience</source><year>2010</year><volume>11</volume><issue>2</issue><fpage>87</fpage><lpage>99</lpage><pub-id pub-id-type="pmid">20087359</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dallérac</surname><given-names>G</given-names></name><name><surname>Zapata</surname><given-names>J</given-names></name><name><surname>Rouach</surname><given-names>N</given-names></name></person-group><article-title>Versatile control of synaptic circuits by astrocytes: where, when and how?</article-title><source>Nature Reviews Neuroscience</source><year>2018</year><volume>19</volume><issue>12</issue><fpage>729</fpage><lpage>743</lpage><pub-id pub-id-type="pmid">30401802</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verkhratsky</surname><given-names>A</given-names></name><name><surname>Kettenmann</surname><given-names>H</given-names></name></person-group><article-title>Calcium signalling in glial cells</article-title><source>Trends in neurosciences</source><year>1996</year><volume>19</volume><issue>8</issue><fpage>346</fpage><lpage>352</lpage><pub-id pub-id-type="pmid">8843604</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kettenmann</surname><given-names>H</given-names></name><name><surname>Verkhratsky</surname><given-names>A</given-names></name></person-group><article-title>Neuroglia: the 150 years after</article-title><source>Trends in neurosciences</source><year>2008</year><volume>31</volume><issue>12</issue><fpage>653</fpage><lpage>659</lpage><pub-id pub-id-type="pmid">18945498</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sibille</surname><given-names>J</given-names></name><name><surname>Dao Duc</surname><given-names>K</given-names></name><name><surname>Holcman</surname><given-names>D</given-names></name><name><surname>Rouach</surname><given-names>N</given-names></name></person-group><article-title>The neuroglial potassium cycle during neurotransmission: Role of kir4.1 channels</article-title><source>PLoS Computational Biology</source><year>2015</year><month>March</month><volume>11</volume><pub-id pub-id-type="pmcid">PMC4380507</pub-id><pub-id pub-id-type="pmid">25826753</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004137</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breslin</surname><given-names>K</given-names></name><name><surname>Wade</surname><given-names>JJ</given-names></name><name><surname>Wong-Lin</surname><given-names>K</given-names></name><name><surname>Harkin</surname><given-names>J</given-names></name><name><surname>Flanagan</surname><given-names>B</given-names></name><name><surname>Van Zalinge</surname><given-names>H</given-names></name><name><surname>Hall</surname><given-names>S</given-names></name><name><surname>Walker</surname><given-names>M</given-names></name><name><surname>Verkhratsky</surname><given-names>A</given-names></name><name><surname>McDaid</surname><given-names>L</given-names></name></person-group><article-title>Potassium and sodium microdomains in thin astroglial processes: A computational model study</article-title><source>PLoS Computational Biology</source><year>2018</year><volume>14</volume><issue>5</issue><elocation-id>e1006151</elocation-id><pub-id pub-id-type="pmcid">PMC5979043</pub-id><pub-id pub-id-type="pmid">29775457</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006151</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poskanzer</surname><given-names>KE</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><article-title>Astrocytic regulation of cortical up states</article-title><source>Proceedings of the National Academy of Sciences</source><year>2011</year><volume>108</volume><issue>45</issue><fpage>18453</fpage><lpage>18458</lpage><pub-id pub-id-type="pmcid">PMC3215035</pub-id><pub-id pub-id-type="pmid">22027012</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1112378108</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poskanzer</surname><given-names>KE</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><article-title>Astrocytes regulate cortical state switching in vivo</article-title><source>Proceedings of the National Academy of Sciences</source><year>2016</year><volume>113</volume><issue>19</issue><fpage>E2675</fpage><lpage>E2684</lpage><pub-id pub-id-type="pmcid">PMC4868485</pub-id><pub-id pub-id-type="pmid">27122314</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1520759113</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rusakov</surname><given-names>DA</given-names></name><name><surname>Bard</surname><given-names>L</given-names></name><name><surname>Stewart</surname><given-names>MG</given-names></name><name><surname>Henneberger</surname><given-names>C</given-names></name></person-group><article-title>Diversity of astroglial functions alludes to subcellular specialisation</article-title><source>Trends in neurosciences</source><year>2014</year><volume>37</volume><issue>4</issue><fpage>228</fpage><lpage>242</lpage><pub-id pub-id-type="pmid">24631033</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>K</given-names></name><name><surname>Bard</surname><given-names>L</given-names></name><name><surname>Reynolds</surname><given-names>JP</given-names></name><name><surname>King</surname><given-names>C</given-names></name><name><surname>Jensen</surname><given-names>TP</given-names></name><name><surname>Gourine</surname><given-names>AV</given-names></name><name><surname>Rusakov</surname><given-names>DA</given-names></name></person-group><article-title>Time-resolved imaging reveals heterogeneous landscapes of nanomolar ca2+ in neurons and astroglia</article-title><source>Neuron</source><year>2015</year><volume>88</volume><issue>2</issue><fpage>277</fpage><lpage>288</lpage><pub-id pub-id-type="pmcid">PMC4622934</pub-id><pub-id pub-id-type="pmid">26494277</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.043</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y-W</given-names></name><name><surname>Gordleeva</surname><given-names>S</given-names></name><name><surname>Tang</surname><given-names>X</given-names></name><name><surname>Shih</surname><given-names>P-Y</given-names></name><name><surname>Dembitskaya</surname><given-names>Y</given-names></name><name><surname>Semyanov</surname><given-names>A</given-names></name></person-group><article-title>Morphological profile determines the frequency of spontaneous calcium events in astrocytic processes</article-title><source>Glia</source><year>2019</year><volume>67</volume><issue>2</issue><fpage>246</fpage><lpage>262</lpage><pub-id pub-id-type="pmid">30565755</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Semyanov</surname><given-names>A</given-names></name><name><surname>Henneberger</surname><given-names>C</given-names></name><name><surname>Agarwal</surname><given-names>A</given-names></name></person-group><article-title>Making sense of astrocytic calcium signals — from acquisition to interpretation</article-title><source>Nature Reviews Neuroscience</source><year>2020</year><volume>21</volume><fpage>551</fpage><lpage>564</lpage><pub-id pub-id-type="pmid">32873937</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><article-title>From the neuron doctrine to neural networks</article-title><source>Nature reviews neuroscience</source><year>2015</year><volume>16</volume><issue>8</issue><fpage>487</fpage><lpage>497</lpage><pub-id pub-id-type="pmid">26152865</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cossart</surname><given-names>R</given-names></name><name><surname>Aronov</surname><given-names>D</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><article-title>Attractor dynamics of network up states in the neocortex</article-title><source>Nature</source><year>2003</year><volume>423</volume><issue>6937</issue><fpage>283</fpage><lpage>288</lpage><pub-id pub-id-type="pmid">12748641</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>JP</given-names></name><name><surname>Zheng</surname><given-names>K</given-names></name><name><surname>Rusakov</surname><given-names>DA</given-names></name></person-group><article-title>Multiplexed calcium imaging of single-synapse activity and astroglial responses in the intact brain</article-title><source>Neuroscience letters</source><year>2019</year><volume>689</volume><fpage>26</fpage><lpage>32</lpage><pub-id pub-id-type="pmcid">PMC6335263</pub-id><pub-id pub-id-type="pmid">29908948</pub-id><pub-id pub-id-type="doi">10.1016/j.neulet.2018.06.024</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stetter</surname><given-names>O</given-names></name><name><surname>Battaglia</surname><given-names>D</given-names></name><name><surname>Soriano</surname><given-names>J</given-names></name><name><surname>Geisel</surname><given-names>T</given-names></name></person-group><article-title>Model-free reconstruction of excitatory neuronal connectivity from calcium imaging signals</article-title><source>PLoS Computational Biology</source><year>2012</year><elocation-id>e1002653</elocation-id><pub-id pub-id-type="pmcid">PMC3426566</pub-id><pub-id pub-id-type="pmid">22927808</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002653</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villette</surname><given-names>V</given-names></name><name><surname>Malvache</surname><given-names>A</given-names></name><name><surname>Tressard</surname><given-names>T</given-names></name><name><surname>Dupuy</surname><given-names>N</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name></person-group><article-title>Internally recurring hippocampal sequences as a population template of spatiotemporal information</article-title><source>Neuron</source><year>2015</year><volume>88</volume><issue>2</issue><fpage>357</fpage><lpage>366</lpage><pub-id pub-id-type="pmcid">PMC4622933</pub-id><pub-id pub-id-type="pmid">26494280</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.052</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishchencko</surname><given-names>Y</given-names></name><name><surname>Vogelstein</surname><given-names>JT</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><article-title>A bayesian approach for inferring neuronal connectivity from calcium fluorescent imaging data</article-title><source>The Annals of Applied Statistics</source><year>2011</year><fpage>1229</fpage><lpage>1261</lpage></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname><given-names>KG</given-names></name><name><surname>Grieco</surname><given-names>SF</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Nie</surname><given-names>Q</given-names></name></person-group><article-title>Tracking longitudinal population dynamics of single neuronal calcium signal using scout</article-title><source>Cell reports methods</source><year>2022</year><volume>2</volume><issue>5</issue><elocation-id>100207</elocation-id><pub-id pub-id-type="pmcid">PMC9142684</pub-id><pub-id pub-id-type="pmid">35637911</pub-id><pub-id pub-id-type="doi">10.1016/j.crmeth.2022.100207</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savtchenko</surname><given-names>LP</given-names></name><name><surname>Bard</surname><given-names>L</given-names></name><name><surname>Jensen</surname><given-names>TP</given-names></name><name><surname>Reynolds</surname><given-names>JP</given-names></name><name><surname>Kraev</surname><given-names>I</given-names></name><name><surname>Medvedev</surname><given-names>N</given-names></name><name><surname>Stewart</surname><given-names>MG</given-names></name><name><surname>Henneberger</surname><given-names>C</given-names></name><name><surname>Rusakov</surname><given-names>DA</given-names></name></person-group><article-title>Disentangling astroglial physiology with a realistic cell model in silico</article-title><source>Nature communications</source><year>2018</year><volume>9</volume><issue>1</issue><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmcid">PMC6120909</pub-id><pub-id pub-id-type="pmid">30177844</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-05896-w</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>DelRosso</surname><given-names>NV</given-names></name><name><surname>Vaidyanathan</surname><given-names>TV</given-names></name><name><surname>Cahill</surname><given-names>MK</given-names></name><name><surname>Reitman</surname><given-names>ME</given-names></name><name><surname>Pittolo</surname><given-names>S</given-names></name><name><surname>Mi</surname><given-names>X</given-names></name><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Poskanzer</surname><given-names>KE</given-names></name></person-group><article-title>Accurate quantification of astrocyte and neurotransmitter fluorescence dynamics for single-cell and population-level physiology</article-title><source>Nature neuroscience</source><year>2019</year><volume>22</volume><issue>11</issue><fpage>1936</fpage><lpage>1944</lpage><pub-id pub-id-type="pmcid">PMC6858541</pub-id><pub-id pub-id-type="pmid">31570865</pub-id><pub-id pub-id-type="doi">10.1038/s41593-019-0492-2</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenk</surname><given-names>K</given-names></name><name><surname>Satuvuori</surname><given-names>E</given-names></name><name><surname>Lallouette</surname><given-names>J</given-names></name><name><surname>Ladrón-de Guevara</surname><given-names>A</given-names></name><name><surname>Berry</surname><given-names>H</given-names></name><name><surname>Hyttinen</surname><given-names>JA</given-names></name></person-group><article-title>A computational model of interactions between neuronal and astrocytic networks: The role of astrocytes in the stability of the neuronal firing rate</article-title><source>Frontiers in computational neuroscience</source><year>2020</year><volume>13</volume><fpage>92</fpage><pub-id pub-id-type="pmcid">PMC6987305</pub-id><pub-id pub-id-type="pmid">32038210</pub-id><pub-id pub-id-type="doi">10.3389/fncom.2019.00092</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenk</surname><given-names>K</given-names></name><name><surname>Genocchi</surname><given-names>B</given-names></name><name><surname>Barros</surname><given-names>MT</given-names></name><name><surname>Hyttinen</surname><given-names>JA</given-names></name></person-group><article-title>Larger connection radius increases hub astrocyte number in a 3-d neuron–astrocyte network model</article-title><source>IEEE Transactions on Molecular, Biological and Multi-Scale Communications</source><year>2021</year><volume>7</volume><issue>2</issue><fpage>83</fpage><lpage>88</lpage></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ipin~a</surname><given-names>IP</given-names></name><name><surname>Kehoe</surname><given-names>PD</given-names></name><name><surname>Kringelbach</surname><given-names>M</given-names></name><name><surname>Laufs</surname><given-names>H</given-names></name><name><surname>Iban~ez</surname><given-names>A</given-names></name><name><surname>Deco</surname><given-names>G</given-names></name><name><surname>Perl</surname><given-names>YS</given-names></name><name><surname>Tagliazucchi</surname><given-names>E</given-names></name></person-group><article-title>Modeling regional changes in dynamic stability during sleep and wakefulness</article-title><source>NeuroImage</source><year>2020</year><volume>215</volume><elocation-id>116833</elocation-id><pub-id pub-id-type="pmcid">PMC7894985</pub-id><pub-id pub-id-type="pmid">32289454</pub-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116833</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venugopal</surname><given-names>S</given-names></name><name><surname>Srinivasan</surname><given-names>R</given-names></name><name><surname>Khakh</surname><given-names>BS</given-names></name></person-group><article-title>Geciquant: Semi-automated detection and quantification of astrocyte intracellular ca 2+ signals monitored with gcamp6f</article-title><source>Computational glioscience</source><year>2019</year><fpage>455</fpage><lpage>470</lpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Packer</surname><given-names>A</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><article-title>Suite2p: A fast, distributed pipeline for large-scale calcium imaging</article-title><source>bioRxiv</source><year>2016</year></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>M</given-names></name><name><surname>Qian</surname><given-names>X</given-names></name><name><surname>Charbel</surname><given-names>C</given-names></name><name><surname>Ledoux</surname><given-names>J</given-names></name><name><surname>Parker</surname><given-names>JC</given-names></name><name><surname>Taylor</surname><given-names>MS</given-names></name></person-group><article-title>Automated region of interest analysis of dynamic ca2+ signals in image sequences</article-title><source>American Journal of Physiology-Cell Physiology</source><year>2012</year><volume>303</volume><issue>3</issue><fpage>C236</fpage><lpage>C243</lpage><pub-id pub-id-type="pmcid">PMC3423022</pub-id><pub-id pub-id-type="pmid">22538238</pub-id><pub-id pub-id-type="doi">10.1152/ajpcell.00016.2012</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agarwal</surname><given-names>A</given-names></name><name><surname>Wu</surname><given-names>P-H</given-names></name><name><surname>Hughes</surname><given-names>EG</given-names></name><name><surname>Fukaya</surname><given-names>M</given-names></name><name><surname>Tischfield</surname><given-names>MA</given-names></name><name><surname>Langseth</surname><given-names>AJ</given-names></name><name><surname>Wirtz</surname><given-names>D</given-names></name><name><surname>Bergles</surname><given-names>DE</given-names></name></person-group><article-title>Transient opening of the mitochondrial permeability transition pore induces microdomain calcium transients in astrocyte processes</article-title><source>Neuron</source><year>2017</year><volume>93</volume><issue>3</issue><fpage>587</fpage><lpage>605</lpage><pub-id pub-id-type="pmcid">PMC5308886</pub-id><pub-id pub-id-type="pmid">28132831</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.034</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giovannucci</surname><given-names>A</given-names></name><name><surname>Friedrich</surname><given-names>J</given-names></name><name><surname>Gunn</surname><given-names>P</given-names></name><name><surname>Kalfon</surname><given-names>J</given-names></name><name><surname>Brown</surname><given-names>BL</given-names></name><name><surname>Koay</surname><given-names>SA</given-names></name><name><surname>Taxidis</surname><given-names>J</given-names></name><name><surname>Najafi</surname><given-names>F</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name><etal/></person-group><article-title>Caiman an open source tool for scalable calcium imaging data analysis</article-title><source>elife</source><year>2019</year><volume>8</volume><elocation-id>e38173</elocation-id><pub-id pub-id-type="pmcid">PMC6342523</pub-id><pub-id pub-id-type="pmid">30652683</pub-id><pub-id pub-id-type="doi">10.7554/eLife.38173</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Dai</surname><given-names>Y</given-names></name><name><surname>Lefton</surname><given-names>KB</given-names></name><name><surname>Holy</surname><given-names>TE</given-names></name><name><surname>Papouin</surname><given-names>T</given-names></name></person-group><article-title>Stardust: a pipeline for the unbiased analysis of astrocyte regional calcium dynamics</article-title><source>bioRxiv</source><year>2024</year><pub-id pub-id-type="pmcid">PMC11417172</pub-id><pub-id pub-id-type="pmid">39276355</pub-id><pub-id pub-id-type="doi">10.1016/j.xpro.2024.103305</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubinov</surname><given-names>M</given-names></name><name><surname>Sporns</surname><given-names>O</given-names></name></person-group><article-title>Complex network measures of brain connectivity: Uses and interpretations</article-title><source>NeuroImage</source><year>2010</year><volume>52</volume><issue>3</issue><fpage>1059</fpage><lpage>1069</lpage><comment>Computational Models of the Brain</comment><pub-id pub-id-type="pmid">19819337</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonifazi</surname><given-names>P</given-names></name><name><surname>Goldin</surname><given-names>M</given-names></name><name><surname>Picardo</surname><given-names>MA</given-names></name><name><surname>Jorquera</surname><given-names>I</given-names></name><name><surname>Cattani</surname><given-names>A</given-names></name><name><surname>Bianconi</surname><given-names>G</given-names></name><name><surname>Represa</surname><given-names>A</given-names></name><name><surname>Ben-Ari</surname><given-names>Y</given-names></name><name><surname>Cossart</surname><given-names>R</given-names></name></person-group><article-title>Gabaergic hub neurons orchestrate synchrony in developing hippocampal networks</article-title><source>Science</source><year>2009</year><volume>326</volume><issue>5958</issue><fpage>1419</fpage><lpage>1424</lpage><pub-id pub-id-type="pmid">19965761</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazaud</surname><given-names>D</given-names></name><name><surname>Capano</surname><given-names>A</given-names></name><name><surname>Rouach</surname><given-names>N</given-names></name></person-group><article-title>The many ways astroglial connexins regulate neurotransmission and behavior</article-title><source>Glia</source><year>2021</year><volume>69</volume><issue>11</issue><fpage>2527</fpage><lpage>2545</lpage><pub-id pub-id-type="pmid">34101261</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy-Royal</surname><given-names>C</given-names></name><name><surname>Ching</surname><given-names>S</given-names></name><name><surname>Papouin</surname><given-names>T</given-names></name></person-group><article-title>A conceptual framework for astrocyte function</article-title><source>Nature neuroscience</source><year>2023</year><volume>26</volume><issue>11</issue><fpage>1848</fpage><lpage>1856</lpage><pub-id pub-id-type="pmcid">PMC10990637</pub-id><pub-id pub-id-type="pmid">37857773</pub-id><pub-id pub-id-type="doi">10.1038/s41593-023-01448-8</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haim</surname><given-names>LB</given-names></name><name><surname>Rowitch</surname><given-names>DH</given-names></name></person-group><article-title>Functional diversity of astrocytes in neural circuit regulation</article-title><source>Nature Reviews Neuroscience</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>31</fpage><lpage>41</lpage><pub-id pub-id-type="pmid">27904142</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madisen</surname><given-names>L</given-names></name><name><surname>Garner</surname><given-names>AR</given-names></name><name><surname>Shimaoka</surname><given-names>D</given-names></name><name><surname>Chuong</surname><given-names>AS</given-names></name><name><surname>Klapoetke</surname><given-names>NC</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Van Der Bourg</surname><given-names>A</given-names></name><name><surname>Niino</surname><given-names>Y</given-names></name><name><surname>Egolf</surname><given-names>L</given-names></name><name><surname>Monetti</surname><given-names>C</given-names></name><etal/></person-group><article-title>Transgenic mice for intersectional targeting of neural sensors and effectors with high specificity and performance</article-title><source>Neuron</source><year>2015</year><volume>85</volume><issue>5</issue><fpage>942</fpage><lpage>958</lpage><pub-id pub-id-type="pmcid">PMC4365051</pub-id><pub-id pub-id-type="pmid">25741722</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.02.022</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pannasch</surname><given-names>U</given-names></name><name><surname>Freche</surname><given-names>D</given-names></name><name><surname>Dallérac</surname><given-names>G</given-names></name><name><surname>Ghézali</surname><given-names>G</given-names></name><name><surname>Escartin</surname><given-names>C</given-names></name><name><surname>Ezan</surname><given-names>P</given-names></name><name><surname>Cohen-Salmon</surname><given-names>M</given-names></name><name><surname>Benchenane</surname><given-names>K</given-names></name><name><surname>Abudara</surname><given-names>V</given-names></name><name><surname>Dufour</surname><given-names>A</given-names></name><etal/></person-group><article-title>Connexin 30 sets synaptic strength by controlling astroglial synapse invasion</article-title><source>Nature neuroscience</source><year>2014</year><volume>17</volume><issue>4</issue><fpage>549</fpage><lpage>558</lpage><pub-id pub-id-type="pmid">24584052</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chever</surname><given-names>O</given-names></name><name><surname>Dossi</surname><given-names>E</given-names></name><name><surname>Pannasch</surname><given-names>U</given-names></name><name><surname>Derangeon</surname><given-names>M</given-names></name><name><surname>Rouach</surname><given-names>N</given-names></name></person-group><article-title>Astroglial networks promote neuronal coordination</article-title><source>Science signaling</source><year>2016</year><month>January</month><volume>9</volume><pub-id pub-id-type="pmid">26758214</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>W</given-names></name></person-group><article-title>Image quality assessment: from error measurement to structural similarity</article-title><source>IEEE transactions on image processing</source><year>2004</year><volume>13</volume><fpage>600</fpage><lpage>613</lpage><pub-id pub-id-type="pmid">15376593</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>AstroNet pipeline.</title><p><bold>A</bold>. Schematic of an astrocyte network, connected through gap junctions. <bold>B</bold>. Schematic showing a hidden network path of sequentially activated astrocytes. <bold>C</bold>. Image processing steps: C1-movies are acquired from GCaMP6f Ca<sup>2+</sup> signaling. C2-construction of an adaptive threshold for the segmentation step based on background luminosity. C3-Detecting all astrocytes (ROIs) with their characteristic shapes using a binarization on the sum of all images (over time). C4-Extracting the Ca<sup>2+</sup> signals from astrocytic ROI. C5-Time-series segmentation into activation events and quiet inter-event periods (pink crosses highlight the peaks of the example events situated between the vertical dotted lines)4. <bold>D</bold>. Network reconstruction: D1-Ca<sup>2+</sup> recording segmentation into subperiods (vertical dashed lines). D2- Activation path reconstruction for each subperiod. D3-Reconstruction of an astrocyte network from the recurrence direct co-activations of astrocytes.</p></caption><graphic xlink:href="EMS199511-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>From astrocytic segmentation to co-activation paths detection.</title><p><bold>A</bold>. Detection of astrocytes ROIs (colored surfaces) obtained from single recordings. <bold>B</bold>. Time-series extracted from the detected astrocytes (color coded). <bold>C</bold>. Recording segmentation into <italic>N</italic> = 10 subperiods. <bold>D</bold>. Calcium time-series of individual ROIs (colored curves), ordered by their first peak time (colored dots) in one subperiod. <bold>E</bold>. Activation times (E.1-E.2) appearing in the field of view to reconstruct the activation path (red to yellow arrows). Output (E.N): one path is a collection of arrows indicating astrocyte activation order for one subperiod. <bold>F-H</bold>. Number of active astrocytes, paths length (sum of arrows lengths) and active area (surface of the convex hull of active astrocytes) for all subperiods in the CTX (yellow) and CA1 area of the hippocampus (purple).</p></caption><graphic xlink:href="EMS199511-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Astrocyte functional network reconstruction.</title><p><bold>A</bold>. Collecting activation paths from all the subperiods of a recording allows to evaluate the edges weights. <bold>B</bold>. Examples of reconstructed graphs, color coded according to the edges connectivity strength, showing two subgraphs with different connectivity levels: one much stronger (yellow edges) than the other (red edges). The size of the strongly connected yellow subgraph can vary from one region to the next (left, CTX vs right, CA1). <bold>C</bold>. Pairwise correlation matrix between all astrocytes time-series for one recording. <bold>D</bold>. Correlation analysis applied to the two regions: a faster decay reveals a less correlated network.</p></caption><graphic xlink:href="EMS199511-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Statistics of the functional astrocytic network.</title><p><bold>A</bold>. Mean node degree (number of direct neighbors): schematic of the count of neighbors for one astrocyte (upper) and distribution (lower) in the CTX (yellow) and CA1 (purple). <bold>B</bold>. Number of hub astrocytes (highly connected: yellow upper graph) and violin plots for the two regions (lower). <bold>C</bold>. Transition probability matrix between nodes: connectivity matrix (upper, from the CA1), the color indicates the connection strength and distribution of edges weights between nodes (lower). <bold>D</bold>. Sparsity value (i.e. proportion of zeros in the connectivity matrix) for the two regions. <bold>E</bold>. Distribution of the length of paths steps in <italic>μ</italic>m. <bold>F</bold>. Distribution of path steps durations in seconds with power law fit (dotted lines), inset on short times (black dotted rectangle).</p></caption><graphic xlink:href="EMS199511-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Stability of AstroNet pipeline based on time-lapse experiments.</title><p><bold>A</bold>. Recording at timepoint t1 (upper) and timepoint t2 (lower) overlayed with the detected ROIs recorded from calcium imaging in a CA1 slice. <bold>B</bold>. Reconstructed graphs at time t1 (upper) and t2 (lower). <bold>C</bold>. Corresponding connectivity matrices. <bold>D</bold>. Correlation curves at t1 (light purple) and t2 (deep purple). <bold>E</bold>. Difference between the AUC at t1 and t2 (absolute value) for the n=2 CTX slices (yellow) and n=6 CA1 slices (purple). <bold>F</bold>. SSIM between the connectivity matrices at t1 and t2. <bold>G</bold>. Graph features at t1 (left points) vs t2 (right points): from left to right: Proportion of hub ROIs, number of hub ROIs, Mean node degree. <bold>H</bold>. Activation path features at t1 vs t2: from left to right, Mean active area (<italic>μm</italic><sup>2</sup>), Mean path length (<italic>μm</italic>) and number of active astrocytes.</p></caption><graphic xlink:href="EMS199511-f005"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Summary of network connectivity parameters (<xref ref-type="fig" rid="F2">Figs. 2</xref> &amp; <xref ref-type="fig" rid="F4">4</xref>).</title></caption><table frame="hsides" rules="all"><thead><tr><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Brain Regions</th><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000;border-right: 1px solid #000000"># Active nodes</th><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000;border-right: 1px solid #000000"># Hub nodes</th><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Mean degree</th><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Path length<break/>(mm)</th><th valign="top" align="left" style="border-top: 1px solid #ffffff;border-bottom: 1px solid #000000">Active area<break/>(mm<sup>2</sup>)</th></tr></thead><tbody><tr><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">CTX<break/>CA1</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">7.28 ± 4.81<break/>11.98 ± 10.46</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">3.63 ± 2.70<break/>5.78 ± 8.35</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">11.95 ± 5.52<break/>20.34 ± 13.33</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">2.63 ± 2.14<break/>4.72 ± 5.00</td><td valign="top" align="left" style="border-bottom: 1px solid #000000">0.23 ± 0.14<break/>0.32 ± 0.26</td></tr></tbody></table></table-wrap></floats-group></article>