<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS201752</article-id><article-id pub-id-type="doi">10.1101/2024.12.04.626757</article-id><article-id pub-id-type="archive">PPR950658</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Rational engineering of allosteric protein switches by <italic>in silico</italic> prediction of domain insertion sites</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wolf</surname><given-names>Benedict</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Shehu</surname><given-names>Pegi</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Brenker</surname><given-names>Luca</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>von Bachmann</surname><given-names>Anna</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kroell</surname><given-names>Ann-Sophie</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Southern</surname><given-names>Nicholas</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Holderbach</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Eigenmann</surname><given-names>Joshua</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Aschenbrenner</surname><given-names>Sabine</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mathony</surname><given-names>Jan</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref><xref ref-type="fn" rid="FN1">✝</xref></contrib><contrib contrib-type="author"><name><surname>Niopek</surname><given-names>Dominik</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref><xref ref-type="fn" rid="FN1">✝</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institute of Pharmacy and Molecular Biotechnology (IPMB), Faculty of Engineering Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/038t36y30</institution-id><institution>Heidelberg University</institution></institution-wrap>, <city>Heidelberg</city>, <postal-code>69120</postal-code>, <country country="DE">Germany</country></aff><aff id="A2"><label>2</label>Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05n911h24</institution-id><institution>Technical University of Darmstadt</institution></institution-wrap>, <city>Darmstadt</city>, <postal-code>64287</postal-code>, <country country="DE">Germany</country></aff><author-notes><corresp id="CR1">
<label>*</label>To whom correspondence should be addressed</corresp><fn id="FN1"><label>✝</label><p id="P1">Equal senior authors</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>07</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>04</day><month>12</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Domain insertion engineering is a powerful approach to juxtapose otherwise separate biological functions, resulting in proteins with new-to-nature activities. A prominent example are switchable protein variants, created by receptor domain insertion into effector proteins. Identifying suitable, allosteric sites for domain insertion, however, typically requires extensive screening and optimization.</p><p id="P3">We present ProDomino, a novel machine learning pipeline to rationalize domain recombination, trained on a semi-synthetic protein sequence dataset derived from naturally occurring intradomain insertion events. ProDomino robustly identifies domain insertion sites in proteins of biotechnological relevance, which we experimentally validated in <italic>E. coli</italic> and human cells. Finally, we employed light- and chemically regulated receptor domains as inserts and demonstrate the rapid, model-guided creation of potent, single-component opto- and chemogenetic protein switches. These include novel CRISPR-Cas9 and -Cas12a variants for inducible genome engineering in human cells. Our work enables one-shot domain insertion engineering and substantially accelerates the design of customized allosteric proteins.</p></abstract></article-meta></front><body><p id="P4">Domains are structural and functional subunits of proteins<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. The rearrangement of existing domains into new combinations is a major source of evolutionary innovation<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. While individual domains are by definition structurally and functionally conserved, they naturally occur in various protein contexts<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref></sup>. Artificial recombination of protein domains has proven to be a powerful method for engineering novel proteins with properties not found in nature (<xref ref-type="fig" rid="F1">Fig. 1a</xref>)<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R5">5</xref></sup>. To achieve not only a physical connection but also an effective functional coupling of two naturally separated protein domains, one particularly powerful strategy is to insert a domain into a selected site of another. If successful, this results in a tight structural and functional co-dependence of the fused domains. This engineering strategy has great potential for the development of sensitive biosensors and novel molecular machines, as best exemplified by engineered, allosteric protein switches<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup>. More specifically, the insertion of a photoreceptor or ligand-binding domain (LBD) into an acceptor protein of choice can yield switchable proteins whose activity is regulated by light or small molecules. In these cases, a trigger-mediated conformational change of the receptor domain is propagated to the acceptor protein, thereby activating or deactivating it, as previously shown by us and others<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R9">9</xref></sup>.</p><p id="P5">Progress in the field of engineering allosteric protein effectors is, however, largely hampered by the difficulty of identifying suitable domain insertion sites in effector proteins, as a naive domain fusion usually results in permanent impairment of the structural and functional integrity of one or both domains<sup><xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R12">12</xref></sup>. In addition, while the few sites in a protein that tolerate domain insertion are often promiscuous with respect to the type of insert domain, several studies have shown that their rational inference or computational prediction is challenging<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R13">13</xref></sup>. Although surface-exposed flexible loops are often considered promising insertion sites, experimental screens have shown that only a fraction of these loops actually tolerate domain integration and that secondary structure elements in turn can sometimes accept insertions surprisingly well<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>. Finally, even the application of simple, basic constraints such as surface exposure are prone to misguided selection of insertion sites, likely due to our limited understanding of conformational ensembles and structural features that confer protein activity in the native, cellular environment.</p><p id="P6">The main limitation in identifying sites suitable for domain fusion is the scarcity of informative data, as experimental domain insertion datasets are cumbersome to generate and exist only for few proteins. While we and others have trained random forests and similar machine learning algorithms on insertion mutagenesis datasets, these relatively simple models are unable to generalize to unrelated protein families and are therefore not suitable for actually guiding domain insertion engineering<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref></sup>. Protein language models (PLMs) on the other hand, have revolutionized protein engineering by enabling accurate prediction of protein structure<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> or functional properties<sup><xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R19">19</xref></sup> based on feature-rich representations and have been successfully applied to various protein engineering and design tasks<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref></sup>. However, until now, these data-intensive algorithms have not been applicable to the problem of domain insertion engineering due to the lack of suitable training data.</p><p id="P7">In this study, we developed a robust deep learning-based approach to guide the engineering of protein domain recombination. Instead of relying on sparse experimental data, we constructed a large protein dataset consisting of semi-synthetic sequences inspired by naturally occurring intradomain insertion events. This diverse dataset enabled us to train ProDomino (<bold>pro</bold>tein <bold>dom</bold>ain <bold>in</bold>sertion <bold>o</bold>ptimizer), a powerful model for predicting domain insertion sites in effector proteins. Utilizing ESM-2-derived protein sequence representations as model inputs in combination with a novel masking strategy, we were able to fine-tune the sensitivity and selectivity of the pipeline to achieve accurate insertion site prediction in proteins evolutionarily unrelated to the training data. Applying ProDomino, we inferred insertion sites for several proteins with success rates of around 80% as validated by experiments in <italic>E. coli</italic> and human cells. Finally, by inserting receptor domains responsive to blue light or chemical inducers, we demonstrated the direct, model-based engineering of several switchable effector proteins of biotechnological and biomedical relevance. These include two common antibiotic resistance-mediating enzymes as well as the widely employed genome editors CRISPR-Cas9 and -Cas12a. Our pipeline enables the creation of switchable, allosteric effector proteins and paves the way for domain recombination engineering at scale.</p><sec id="S1" sec-type="results"><title>Results</title><sec id="S2"><title>Curating an artificial domain insertion dataset with information on insertion tolerance and intradomain communication</title><p id="P8">The use of <italic>in silico</italic> approaches to identify domain insertion sites in proteins is currently limited by the lack of sufficiently large and diverse datasets. We sought to create a new dataset informative towards insertion tolerance and domain-domain communication by focusing on proteins in which domains are tightly coupled at the structural and functional level.</p><p id="P9">We speculated that “intradomain insertions” that occur in natural proteins at low frequency, i.e. cases in which one domain has been evolutionarily acquired by another domain, resulting in hybrid domain architectures, may provide the information we seek for domain recombination engineering. In contrast, conventional head-to-tail domain concatenations may not carry the same information, as they are expected to be much less structurally constrained, and these domains may rather act as functionally independent entities.</p><p id="P10">Towards curating a dataset of intradomain insertions, we employed CATH-Gene3D domain annotations, which are defined as structural superfamilies<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>, from Interpro<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>. These were filtered for proteins, in which one domain annotation is interrupted by that of a second domain, thus representing cases in which the N- and C-terminal part of a domain A are separated by a second domain B (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). The remaining sequences were intersected with UniRef50<sup><xref ref-type="bibr" rid="R26">26</xref></sup> to limit pairwise sequence identities to a maximum of 50%, resulting in a final dataset of 174,872 sequences across the tree of life.</p><p id="P11">The curated set includes 202 distinct insert domain superfamilies and 168 unique parent domain types, most of which occur only as either insert or parent. Interestingly, the promiscuity of both insert and parent domains differs significantly between superfamilies (<xref ref-type="fig" rid="F1">Fig. 1c</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>). For example, the P-loop NTPase domain serves as a parent domain in combination with 13 different insert superfamilies. The most promiscuous insert domain, in turn, is the PDZ superfamily (<xref ref-type="fig" rid="F1">Fig. 1d</xref>), which occurs in combination with 11 different parents. The majority of domains, however, is represented only in combination with one or two other domains (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>). The size distributions of the parent and insert domains differ only slightly, with median sequence lengths of ~160 and ~120 amino acids, respectively, whereas the length of the entire parent proteins is more diverse (<xref ref-type="fig" rid="F1">Fig. 1e</xref>). The relative insertion site within the parent domains is bimodally distributed, presumably because insertions in the middle of a domain are more likely to severely disrupt its function (<xref ref-type="fig" rid="F1">Fig. 1f</xref>). Relative to the fulllength parent proteins, the insertion site distribution shows a C-terminal bias, a trend previously observed in the context of a much smaller dataset (<xref ref-type="fig" rid="F1">Fig. 1f</xref>)<sup><xref ref-type="bibr" rid="R27">27</xref></sup>.</p><p id="P12">Of note, no major differences were observed between the overall domain frequencies in the CATH-Gene3D database and their representation as inserts or parents in our dataset (<xref ref-type="fig" rid="F1">Figure 1g-j</xref>), suggesting that intradomain insertions are a universal phenomenon across the protein landscape and not restricted to specific domain superfamilies. Similarly, the analysis of residues surrounding domain insertion sites, split by CATH classes, did not reveal any significant enrichment of insertion site-specific sequence motifs (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2</xref>). In summary, intradomain insertions are a widespread natural phenomenon, resulting in a diverse dataset with no apparent bias towards specific domain classes.</p></sec><sec id="S3"><title>ProDomino accurately predicts domain insertion tolerance</title><p id="P13">Using this dataset as a basis, we trained machine learning models for the prediction of domain insertion sites in proteins. Details on model training and optimization are provided in <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>. In brief, we artificially removed the insert domains from the sequences in our dataset. We then assigned the corresponding positions as positive labels (insertion tolerant), whereas all other positions were assigned negative labels (unknown). We compared several sequence encoding strategies, including simple one-hot encodings and ESM-2-derived embeddings (<xref ref-type="fig" rid="F2">Fig. 2b</xref>), as well as model architectures ranging from smaller multi-layer perceptrons to large transformer models (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3</xref>)<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. Moreover, we employed different dataset splits, either a random split (“random”), a split based on domain classes (“interpro”) or a highly strict split using only single representatives per class (“single”) (<xref ref-type="fig" rid="F2">Fig 2c</xref>). Finally, during loss computation, we optionally employed a positional masking strategy to account for imbalances within the dataset (<xref ref-type="fig" rid="F2">Fig 2d</xref>). Using ESM-2 sequence embeddings in combination with the very strict, “single” split and the masking strategy enabled us to train a performant predictor named ProDomino, well-capable of generalizing beyond the domain insertions observed in the training dataset (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>).</p><p id="P14">Analysis of ProDomino predictions revealed the absence of any preference for specific secondary structure motifs (<xref ref-type="fig" rid="F2">Fig. 2e</xref>). When examining selected proteins with available structure information, no strong bias towards surface exposure or sequence conservation was found (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 4</xref>). Most importantly, the true insertion sites were correctly identified and high scoring positions occurred at frequencies consistent with previous experimental findings (<xref ref-type="fig" rid="F2">Fig. 2f-g</xref>)<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>. Notably, the predictive stringency of the model can be fine-tuned over a wide range by varying the number of training steps (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 5</xref>). Longer training regimes led to stricter classification, i.e. fewer peaks with high scores, but also lowered the overall sensitivity.</p><p id="P15">To benchmark ProDomino on experimental data, we focused on the bacterial transcription factor AraC, which we had comprehensively screened for domain insertion tolerance in a previous study<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. Remarkably, ProDomino predicted high insertion scores predominantly for experimentally validated insertion sites and correctly identified sequence stretches that did not tolerate insertions (<xref ref-type="fig" rid="F2">Fig. 2h</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6, 7</xref>), as indicated by a large area under the receiver operator characteristic (AUROC) of 0.84 (<xref ref-type="fig" rid="F2">Fig. 2i</xref>). As expected, model performance varied depending on how long the model had been trained, as indicated by a significant drop after 3000 training steps (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6, 7</xref>). We therefore decided to use ProDomino in its 1,500 training step version.</p><p id="P16">Finally, we had previously identified two allosteric sites in AraC, i.e. at position I113 and S170, that resulted in potent light-dependent protein switches upon insertion of the <italic>Avena sativa</italic> LOV2 photoreceptor domain (<italic>As</italic>LOV2) (<xref ref-type="fig" rid="F2">Fig. 2h-j</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6, 7</xref>)<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. ProDomino successfully predicted both regions as the two major peaks with high insertion scores, indicating its potential to identify not only insert-tolerating, but actually allosteric surface sites in proteins (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 7</xref>).</p></sec><sec id="S4"><title>ProDomino identifies allosteric insertion sites in enzymes mediating antibiotics resistance</title><p id="P17">Having validated ProDomino on available experimental domain insertion data, we intended to apply it for engineering switchable single-chain protein effectors. As a starting point, we applied ProDomino to two commonly used enzymes mediating antibiotic resistance in mammalian cells and bacteria, namely puromycin acetyltransferase (PAC) and chloramphenicol acetyltransferase (CAT) (<xref ref-type="fig" rid="F3">Fig. 3a, b</xref>). The highest insertion scores were predicted around E83 (PAC) and K136 (CAT), both located at surface sites in or adjacent to α-β connecting loops (<xref ref-type="fig" rid="F3">Fig. 3c-d</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 8</xref>). We introduced the <italic>As</italic>LOV2 photosensory domain behind the corresponding residues and experimentally evaluated the activity of the resulting hybrid PAC-LOV2 and CAT-LOV2 proteins (<xref ref-type="fig" rid="F3">Fig. 3e</xref>).</p><p id="P18">PAC activity was assessed by expression in HEK293T cells, followed by treatment with puromycin and illumination of samples with blue light or incubation in the dark for 48 h. Excitingly, microscopy revealed that cells expressing the PAC-LOV2 hybrid showed wild-type-like puromycin tolerance when incubated in the dark, but died under illumination within 48 h, indicating potent, light-mediated inhibition of PAC (<xref ref-type="fig" rid="F3">Fig. 3f</xref>). In contrast, control samples expressing no PAC or wild-type PAC died or survived the puromycin treatment, respectively, regardless of illumination (<xref ref-type="fig" rid="F3">Fig. 3f</xref>).</p><p id="P19">Complementarily, we evaluated the behavior of two CAT-LOV2 hybrids only differing in their inter-domain linker sequences, by measuring cell growth of <italic>E. coli</italic> cultures supplemented with chloramphenicol and incubated under light and dark conditions. Again, both hybrid enzymes acted as highly potent, light-dependent kill switches, with a 20-fold difference in optical density of the respective cultures between dark and light growth conditions (<xref ref-type="fig" rid="F3">Fig. 3g</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 9</xref>). Control cultures expressing wild-type CAT or no CAT at all grew normally or died in the presence of chloramphenicol, regardless of illumination. Finally, illuminating red fluorescent cells expressing the CAT-K136-GS-LOV2 variant on chloramphenicol agar plates with a blue light pattern restricted cell growth to non-illuminated plate areas, indicating precise spatial control of cell killing (<xref ref-type="fig" rid="F3">Fig. 3h</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 10</xref>).</p><p id="P20">Encouraged by the highly successful prediction of allosteric insertion sites in both enzymes, we selected several additional sequence positions with either high or low insertion scores to more globally validate ProDomino’s accuracy (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 11</xref>). To avoid overestimating model performance, we did not include the N- and C-terminal sites, as protein termini are expected to tolerate domain fusions rather well and it is not surprising that a model would pick up this trend. After insertion of the <italic>As</italic>LOV2 receptor or an inert PDZ domain at the selected positions within the PAC and CAT, we screened the resulting hybrid proteins using an MTT cell viability assay in mammalian cells or <italic>E. coli</italic> culture growth as readouts. Three out of four low scoring sites in PAC and five out of six low scoring sites in CAT did not tolerate domain insertions (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 11b, d</xref>). Similarly, most of the positively predicted sites resulted in active fusion proteins (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 11b, d</xref>). Domain insertion into PAC between S81 and A86, which represents the global prediction maximum, resulted in functional protein hybrids at all positions. Regions with moderate scores (S101-P121), in turn, resulted in lower antibiotic resistance, indicating reduced PAC activity (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 11b</xref>). In the same line, two out of three CAT positions with high insertion scores tolerated PDZ and/or LOV2 fusion (S27/T36, K136/G137). Intriguingly, the only false positive position (A161/N162) is located at the interface of CAT monomers in the homo-trimeric CAT complex; however, no information about the trimeric state of the CAT enzyme was provided to ProDomino. Re-running the prediction by entering a trimeric CAT sequence, i.e. an artificial concatemer of three CAT sequences, resulted in an insertion prediction trace without the false positive peak at A161/N162 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 12</xref>).</p><p id="P21">Overall, experiments confirmed model prediction in 78% of cases, even when consecutive, insertion-tolerant sites were counted as a single hit, with a particularly high success rate for positive predictions. Together, these findings indicate that ProDomino is well suited to guide receptor insertion engineering, enabling straightforward creation of optogenetic effector proteins.</p></sec><sec id="S5"><title>Creating opto- and chemogenetic single-chain CRISPR genome editors</title><p id="P22">To assess the performance of ProDomino on complex, multi-domain proteins uniting various functionalities, we finally applied it to infer allosteric sites in CRISPR-Cas nucleases, the workhorses for genome engineering. We started with the most widely used CRISPR effector, Cas9 from <italic>Streptococcus pyogenes,</italic> and first compared our insertion site predictions with a previously reported, experimental transposon insertion dataset. Intriguingly, despite considerable overlap between the literature data and our model prediction, as indicated by an AUROC of 0.71 (<xref ref-type="fig" rid="F4">Fig. 4a, b</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. 13, 14</xref>)<sup><xref ref-type="bibr" rid="R28">28</xref></sup>, ProDomino predicted several regions in Cas9 with high insertion scores that, were not among the top hits of the previously published dataset (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 15</xref>). To dissect this apparent discrepancy, we inserted the <italic>As</italic>LOV2 at four of these “conflicting” sites into a catalytically impaired d(ead)Cas9. We then expressed the resulting dCas9-LOV2 hybrids, fused to a VPR transactivator, with a luciferase reporter and a promoter-targeting sgRNA in HEK293T cells. Samples were then incubated under blue light or in the dark for 48 h, followed by luciferase assay (<xref ref-type="fig" rid="F4">Fig. 4c</xref>). In line with our predictions, all four dCas9-LOV2 hybrids strongly induced luciferase expression in the dark at levels comparable to the wild-type dCas9-VPR control, indicating high insertion tolerance. Excitingly, three of the four variants were highly photosensitive, resulting in high or low luciferase activity in the dark or light, respectively. A dCas9/VPR control without the LOV2 insert showed potent reporter activation, independent of illumination (<xref ref-type="fig" rid="F4">Fig. 4c</xref>).</p><p id="P23">Finally, we sought to apply ProDomino to engineer a switchable, single-chain CRISPR-Cas12a, starting from the <italic>Moraxella bovoculi (Mb)</italic> ortholog<sup><xref ref-type="bibr" rid="R29">29</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>, with the goal of rendering it responsive to light or a clinically relevant drug. Ligand-activated, single-chain Cas12a switches would have various potential applications in biotechnology and biomedicine but were thus-far difficult to create.</p><p id="P24">We passed the <italic>Mb</italic>Cas12a sequence through our ProDomino pipeline. Insertion probability scores across the sequence showed a much more rugged shape with multiple maxima, as compared to previous predictions (<xref ref-type="fig" rid="F4">Fig. 4d-f</xref>). This suggests Cas12a to be rather promiscuous in its tolerance to domain fusion. We decided to first test several high scoring regions for PDZ insertion tolerance and additionally included eight randomly selected low scoring sites as controls. To assess insertion tolerance, we employed a reporter assay in HEK293T cells in which catalytically active Cas12a interferes with luciferase expression via targeted reporter plasmid cleavage. Remarkably, all tested Cas12a hybrids that were predicted to be functional by ProDomino mediated strong reporter knockdown that was in most cases comparable in efficiency to the wild-type nuclease (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 16a, b</xref>). In contrast, 50 % of the Cas12a-PDZ hybrids based on low scoring sites turned out to be dysfunctional, with the remainder still tolerating the insertion (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 16c</xref>). These observations underscore that ProDomino is highly reliable in predicting sites for domain fusion, while low scores are not always accurate, at least regarding general domain tolerance.</p><p id="P25">Next, we selected the two most active hybrid variants carrying insertions at K487 and N1153 for downstream engineering of switchable Cas12a. K487 is located at the interface between the NUC and REC lobes, whereas N1153 is located in the catalytic RuvC domain (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 17</xref>)<sup><xref ref-type="bibr" rid="R29">29</xref></sup>. We replaced the PDZ domain at these sites with the <italic>As</italic>LOV2 photosensor and tested the resulting hybrids by targeting the endogenous <italic>RUNX</italic> and <italic>VEGFA</italic> loci under light and dark conditions. The Cas12a-LOV2 hybrid based on the N1153 insertion site showed potent, light-dependent genome editing, with a 3-fold reduction in Cas12a activity in the light condition, as validated by T7 Endonuclease I (T7E1) assay and deep amplicon sequencing (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 18</xref>).</p><p id="P26">Finally, we sought to enable the control of the allosteric Cas12a variant with a clinically relevant drug instead of light, while also inverting the mode of action from trigger-impaired to trigger-activated. To this end, we employed a circularly permuted variant of the human glucocorticoid receptor 2 (GR2) LBD<sup><xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R32">32</xref></sup> that adopts a compact fold in the presence of its ligand cortisol. This is in contrast to the light-dependent unfolding characteristic of <italic>As</italic>LOV2. Following GR2 insertion at K487 or N1153, we expressed the Cas12a-GR2 hybrids in HEK293T cells and targeted multiple genomic loci, or alternatively a luciferase cleavage reporter. We observed potent, cortisol-induced gene editing at all target sites for both insertion variants (<xref ref-type="fig" rid="F4">Fig. 4g-I</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 19</xref>). Remarkably, the N1153 insertion variant showed editing frequencies around 70% of the wild-type enzyme in presence of the ligand, while editing in the absence of cortisol dropped to levels approaching the detection limit (<xref ref-type="fig" rid="F4">Fig. 4g-I</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 19</xref>). Control samples expressing wild-type Cas12a showed potent gene editing (InDel frequencies around 50-70%), irrespective of the chemical trigger.</p><p id="P27">Collectively, these data demonstrate the power of ProDomino for engineering allosteric variants of complex proteins and showcase Cas12a-GR2 hybrids as potent switches for controlling genome editing in human cells.</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P28">We introduced ProDomino, a powerful computational model for the prediction of domain recombination and low-N engineering of allosteric protein switches. Key to our approach was the novel semi-synthetic domain insertion dataset, which enabled us to train models capable of generalizing beyond the training data<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>. The training objective differed significantly from machine learning approaches common to protein engineering problems, due to the lack of true negative samples in our case. As a result, for the problem to be successfully addressed, we could not fully rely on conventional model performance metrics but observed that it was critical to benchmark our model on real-world experimental data early on to refine the training regime (<xref ref-type="fig" rid="F2">Fig 2c-d, h</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. 6, 7</xref>). We found that positional masking in combination with relatively short training regimes could effectively compensate for imbalances in the dataset, resulting in successful training of a predictive model: ProDomino. Our thorough experimental validation on four proteins from three structurally and evolutionarily unrelated families highlighted the predictive capabilities of ProDomino.</p><p id="P29">A particularly notable success of ProDomino has been its ability to guide the engineering of switchable effector proteins, which we believe will enable future research and hold great potential for applications in research and biomedicine. The resulting effector variants exhibited robust response to the chemical or light input, without any further optimization. Our engineered genome editors enabled tight control of gene targeting with dynamic regulation ranges unmet thus-far for single-chain, allosteric CRISPR-Cas switches. The Cas12a receptor hybrids in particular are the first inducible variants of <italic>Mb</italic>Cas12a and even the first single-chain switches for any Cas12a ortholog, greatly enhancing the versatility of on-demand inducible CRISPR genome editing.</p><p id="P30">We envision that ProDomino, in combination with recently developed methods for the <italic>de novo</italic> design of state-switching protein domains<sup>33,<xref ref-type="bibr" rid="R33">34</xref></sup>, could even support the engineering of switchable effectors based on entirely artificial and customized receptors.</p><p id="P31">Finally, as a personal note, we would like to mention that the experimental data presented here, from the cloning of all switchable protein candidates through the entire experimental validation including the establishment of various different assays, was acquired within only ~6 months upon completion of model training. This represents a major acceleration as compared to our previous protein switch engineering efforts, which often took many months to succeed even for a single, small effector protein. Taken together, we are convinced that ProDomino will enable scientists to more effectively engineer allosteric proteins in the future.</p></sec><sec id="S7" sec-type="methods"><title>Methods</title><sec id="S8"><title>Dataset generation</title><p id="P32">To generate a domain insertion dataset derived from natural protein sequences, the Interpro database<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup> was downloaded and filtered for CATH domains. These entries were intersected with UniRef50<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, which was pre-filtered for proteins &lt;2048 amino acids in length. The dataset was subsequently scanned for domain annotations located within another domain annotation, resulting in a total of 174,872 protein entries (intradomain insertions).</p><p id="P33">To generate datasets for model training, protein sequences were further processed by deleting the annotated insert domain sequence (parent_only). The data was then split in a 70:20:10 ratio to generate training, validation and test sets using three alternative approaches as follows. First, data was split randomly, i.e. 50% sequence identity cutoff. Second as an alternative, the dataset was split by CATH superfamily, meaning that members of a particular parent-insert domain superfamily combination only occur in the same set, i.e. either the training, validation or test set. This ensures that the model is only validated on previously unseen protein topologies. Third, only a single example of each parent-insert domain combination was included in the data split. This strictest approach resulted in training and validation sets consisting of only 174 and 46 highly diverse protein sequences, respectively. A common intersected test set was constructed to allow side-by-side comparison of models trained using all three data splitting strategies.</p></sec><sec id="S9"><title>Generation of sequence embeddings</title><p id="P34">Sequence embeddings were generated by passing the amino acid sequences of all parent_only proteins in the dataset through ESM-2<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. We used the 3 billion parameter version of ESM-2, which results in embeddings with a depth of 2,560 dimensions. As a baseline, we created one-hot encodings of the sequences using all canonical amino acids.</p></sec><sec id="S10"><title>Model architecture and training</title><p id="P35">All models were implemented in pytorch 2.1.0 and trained using pytorch lightning 2.3.0. As decoder, we implemented a two-layer perceptron with ReLU activation units. As an alternative, we also implemented BERT-style transformers with 36.7 million and 146 million parameters, respectively<sup><xref ref-type="bibr" rid="R35">35</xref></sup>. The Adam optimizer was used for training with default settings and a learning rate of 1e-5<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. All models were trained on the ESM-2-derived sequence embeddings. The task was to predict, for each sequence position, whether domain insertions are tolerated or not, as evaluated by cross-entropy loss. Since domain boundaries cannot always be resolved accurately, and experimental results showed that stretches of consecutive amino acids often allow insertions, we included the two amino acids adjacent to an insertion site as additional positive labels. To account for the ambiguity of most unknown positions, we implemented sequence-specific masking. In each iteration, the known positive insertion site with its adjacent residues and one randomly selected site (negative label) were used to update the parameters in the model.</p><p id="P36">Model training and analyses was performed either on a local high-performance computer equipped with two 24 GB Nvidia RTX 4090 GPUs and 128 GB RAM, or on the BwForHelix Cluster on a single A100 or A40 GPU with up to 80 GB RAM.</p></sec><sec id="S11"><title>Sequence conservation, SASA and secondary structure prediction</title><p id="P37">To correlate model predictions with sequence conservation, multiple sequence alignments were computed for selected proteins using MMseq2 with parameters and databases as in colabfold<sup><xref ref-type="bibr" rid="R37">37</xref>,38</sup>. Solvent accessible surface area (SASA) was calculated using the Biopython implementation of the Shrake-Rupley algorithm with default settings<sup><xref ref-type="bibr" rid="R39">39</xref></sup>. Secondary structure prediction was performed using S4pred<sup><xref ref-type="bibr" rid="R40">40</xref></sup>.</p></sec><sec id="S12"><title>Validation against published datasets</title><p id="P38">Previously published experimental domain insertion data for AraC<sup><xref ref-type="bibr" rid="R10">10</xref></sup> and Cas9<sup><xref ref-type="bibr" rid="R28">28</xref></sup> were compared with the ProDomino predictions. For AraC, all positions with positive enrichment scores for at least one of the five inser domains previously screened experimentally<sup><xref ref-type="bibr" rid="R10">10</xref></sup> were considered insertion permissive, while all other positions were labeled as negative. For the Cas9 transposon insertion data, the same threshold was applied, but all positions for which no experimental data was available were marked as unknown.</p></sec><sec id="S13"><title>Molecular cloning</title><p id="P39">The plasmids generated and used in this study are listed in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref> and annotated plasmid maps of the lead constructs are provided as Genbank files. The amino acid sequences of the relevant proteins and domains are listed in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>. All constructs were generated by either standard restriction ligation cloning or Golden Gate assembly<sup>41</sup>. Insertion variants were generated by opening the plasmid encoding the parent protein at the insertion site by PCR, while insert domains were amplified using primers encoding the required linkers as 5’-overhangs. Oligonucleotides were purchased from Merck and double-stranded DNA fragments were ordered from Integrated DNA Technologies. PCRs were performed using Q5 Hot Start high-fidelity DNA polymerase (New England Biolabs) according to the manufacturer’s protocol. PCR products were analyzed by agarose gel electrophoresis followed by excision of the correct bands and DNA was purified using the QIAquick gel extraction kit (Qiagen). Restriction digests, ligations and one-pot Golden Gate reactions were performed using enzymes and buffers purchased from New England Biolabs and Thermo Fisher Scientific. Chemically competent TOP10 <italic>E. coli</italic> cells (Thermo Fisher Scientific) were transformed with the assembled constructs. Finally, plasmid DNA was purified using the QIAprep Spin Miniprep or Plasmid Plus Midi kit (Qiagen). All constructs were verified by Sanger sequencing using Microsynth Seqlab.</p><p id="P40">The <italic>Renilla</italic> luciferase expressing plasmid was obtained from Promega. pCAG-hMb3Cas12a- NLS(nucleoplasmin)-3xHA (RTW2500) was a gift from Joseph Bondy-Denomy &amp; Keith Joung &amp; Benjamin Kleinstiver (Addgene plasmid #115142; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene:115142">http://n2t.net/addgene:115142</ext-link>; RRID:Addgene_115142). The CAG promoter present in this construct was replaced by a CMV promoter via Golden Gate cloning and the CMV-driven Cas12a vector was used for all experiments in this study.</p></sec><sec id="S14"><title>Blue light setups</title><p id="P41">A custom-built LED setup was used to illuminate bacterial liquid cultures. The samples were illuminated by eight high-power LEDs (type CREE XP-E D5-15; emission peak ≈460 nm; emission angle ≈130°; LEDTECH.DE) at a wavelength of ~460 nm. The LEDs were mounted on an aluminum plate and microtiter plates were illuminatedfrom above at a distance of ~30 cm in a conventional shaking incubator (Minitron, Infors). The LEDs were connected to a switching mode power supply (Manson; HCS-3102) and the current was adjusted so that samples were constantly illuminated with a light intensity of 50 μmol m-2 s-1.</p><p id="P42">For illumination of the agar plates, another setup consisting of an array of 96 blue LEDs (LB T64G-AACB-59-Z484-20-R33Z, Osram, emission peak 469 nm, viewing angle 30°, Mouser Electronics) mounted on a circuit board and powered by a switching mode power supply (Manson; HCS-3102) was used. The plates were continuously illuminated at an intensity of 15 μmol m-2 s-1 in an incubator at 37°C.</p><p id="P43">The setup for mammalian cell illumination was similar. Plates were placed in a humidified cell culture incubator (Eppendorf) and illuminated from below through the transparent well-plate bottom as we were working with adherent cells. A replicate control plate was incubated in the same incubator but kept in the dark. The power supply was connected to a Raspberry Pi running a custom Python script that maintained an illumination duty cycle of 5 s of light followed by 10 s darkness. Light intensity was set to 30 μmol m-2 s-1.</p></sec><sec id="S15"><title>Cell culture</title><p id="P44">HEK293T cells were cultured in 1xDMEM without phenol red (Thermo Fisher Scientific) supplemented with 10% (v/v) bovine fetal calf serum (Thermo Fisher Scientific), 2 mM L-glutamine, 100 U/mL penicillin and 100 μg/mL streptomycin (all Thermo Fisher Scientific). Cells were grown at 37°C and 5% CO2 in a humidified incubator and passaged at a cell density below 80%. The cell line was authenticated prior to use and regularly tested for mycoplasma contamination.</p></sec><sec id="S16"><title>Puromycin resistance assay</title><p id="P45">HEK293T cells were seeded in 96-well plates at a density of 12,500 cells per well. The next day, cells were transfected using Lipofectamine 2000 (Thermo Fisher Scientific) according to the manufacturer’s protocol. 100 ng of each PAC fusion protein encoding construct or respective control plasmids encoding only wild-type PAC or eGFP (as negative control) were transfected per well in triplicates. 16 hours post-transfection, the cells were challenged with 5 μg/mL puromycin. 72 hours post-transfection, the samples were tested for cell viability using the MTT Cell Proliferation Assay Kit (Cayman Chemicals) according to the manufacturer’s protocol.</p><p id="P46">For the microscopy assay, cells were transfected identically, but puromycin was added at a concentration of 10 μg/mL 24 h post transfection. Images were captured 72 h post-transfection using a Keyence BZ-9000 microscope.</p></sec><sec id="S17"><title>Chloramphenicol resistance assay</title><p id="P47">Chemically competent TOP10 <italic>E. coli</italic> were transformed with plasmids encoding a constitutively expressed chloramphenicol acetyltransferase or insertion variants thereof and an ampicillin resistance cassette as a selection marker. Glycerol stocks were prepared from single colonies. Pre-cultures were inoculated from the glycerol stocks and incubated overnight at 37°C and 220 rpm in LB media supplemented with ampicillin at a concentration of 100 μg/mL. The next day, main cultures were prepared in technical triplicates in 96-well plates. 200 μl of LB media supplemented with 100 μg/mL ampicillin and the indicated concentration of chloramphenicol were inoculated with 4 μl of the pre-cultures and incubated at 37 °C and 220 rpm. For blue light experiments, two identical culture plates were prepared, one of which was illuminated with blue light. The second plate (control) was kept in the same incubator but covered from illumination. Samples were incubated for 7 hours, followed by measurement of OD600 in a Tecan infinite 200 plate reader.</p></sec><sec id="S18"><title>Photomask experiment</title><p id="P48">TOP10 <italic>E. coli</italic> cells were co-transformed with a construct expressing the respective CAT-LOV2 fusion or an empty backbone as control together with a second kanamycin-resistant plasmid encoding an arabinose-inducible mRFP for better visualization. Cells were plated on LB agar, supplemented with ampicillin (100 μg/mL) and kanamycin (50 μg/mL). Pre-cultures were incubated in LB media supplemented with the same antibiotics at 37°C and 220 rpm. The illumination experiment was performed in 5 cm Petri dishes on LB agar supplemented with ampicillin (100 μg/mL) and kanamycin (50 μg/mL). A pre-culture was diluted 1:50 with warm top agar (0.6% LB-agar) containing 16 mM arabinose and 25 μg/mL chloramphenicol and poured onto the agar plate. The Petri dish was placed on an LED array and illuminated from below for 20 hours while incubating at 37°C. Images were acquired under UV light.</p></sec><sec id="S19"><title>Luciferase assays</title><p id="P49">HEK293T cells were seeded in 96-well plates at a density of 12,500 cells/well. To characterize d<italic>Sp</italic>Cas9/VPR-LOV2 hybrids, cells were transfected with a total of 100 ng DNA using Lipofectamine 3000 (Thermo Fisher Scientific) according to the manufacturer’s protocol 24 hours after seeding. Specifically, the transfected DNA consisted of 20 ng of a firefly luciferase reporter preceded by 13 TetO sites, 20 ng of a construct encoding a <italic>Renilla</italic> luciferase and a TetO targeting sgRNA, and 40 ng of a construct encoding the respective dCas9-VPR variant. DNA was topped up to 100 ng using pBluescript as an empty stuffer plasmid. Experiments were performed in two replicates, one of which was kept in the dark, whereas the other was illuminated with blue light starting six hours after transfection. At 48 hours post-transfection, cells were lysed and firefly and <italic>Renilla</italic> luciferase activity was measured in a plate reader (Tecan Infinite 200) using the Dual Glo Luciferase Assay System (Promega). Injection of each luciferase substrate was followed by a 2 s settling time and 8 s signal integration. Finally, firefly luciferase photon counts were normalized to <italic>Renilla</italic> luciferase photon counts.</p><p id="P50">To test for domain insertion tolerance in <italic>Mb</italic>Cas12a, cells were transfected using Lipofectamine 2000 (Thermo Fisher Scientific). For the PDZ domain insertion screen, a total of 200 ng DNA per well was transfected, consisting of (i) 10 ng <italic>Renilla</italic> luciferase reporter plasmid, (ii) 20 ng firefly luciferase reporter construct, (iii) 85 ng sgRNA encoding construct and (iv) 85 ng of a plasmid expressing the respective <italic>Mb</italic>Cas12a variant. For the GR2 insertion experiments, only 10 ng of the <italic>Mb</italic>Cas12a encoding plasmid were used, respectively, and the transfection mix was topped up with a stuffer plasmid to a total of 200 ng of DNA. Transfections were performed in triplicates. One replicate of all samples was treated with 333 μM cortisol starting 2 hours post-transfection, while the control replicate was treated with DMSO (solvent) at the same time point. At 48 h post-transfection, luciferase activity was measured as described above.</p></sec><sec id="S20"><title>Gene editing of endogenous loci</title><p id="P51">HEK293T cells were seeded in 96-well plates at a density of 12,500 cells per well. For chemical activation, cells were transfected with (i) 100 ng of a construct expressing <italic>Mb</italic>Cas12a and (ii) 100 ng of a vector encoding the respective gRNA using Lipofectamine 2000 (Thermo Fisher Scientific) according to the manufacturer’s protocol. In case of LOV2-based experiments, a Cas12a:gRNA vector mass ratio of 3:1 was used instead. A non-targeting gRNA served as a negative control. Sequences of the gRNAs employed in this study are listed in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>. Blue light induction and cortisol treatment were performed as described in the luciferase assay section above.</p><p id="P52">At 72 h post-transfection, media was aspirated and cells were lysed using DirectPCR lysis reagent (PeqLab) supplemented with 200 μg/mL proteinase K (Roche Diagnostics). The target genomic locus was amplified with the primers listed in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 4</xref> using the Q5 Hot Start High-Fidelity Polymerase (NEB). Editing frequencies were assessed by T7E1 assay or targeted amplicon sequencing. T7E1 assays were performed as previously described<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. For targeted amplicon sequencing, dual barcode primers were used for PCR amplification. Amplicons were resolved on a 2%1x TBE agarose gel and bands of the expected size were excised and purified using the QIAquick Gel Extraction Kit (Qiagen). Illumina sequencing was performed using the GeneWiz amplicon sequencing service. NGS results were analyzed using Sabre (<ext-link ext-link-type="uri" xlink:href="https://github.com/najoshi/sabre">https://github.com/najoshi/sabre</ext-link>) and the CRISPresso 2.0 suite (<ext-link ext-link-type="uri" xlink:href="https://github.com/pinellolab/CRISPResso2">https://github.com/pinellolab/CRISPResso2</ext-link>)<sup><xref ref-type="bibr" rid="R43">43</xref></sup> to determine InDel frequencies at the targeted loci.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Note 1, Supplementary Figures 1-19, Supplementary Tables 1-4</label><media xlink:href="EMS201752-supplement-Supplementary_Note_1__Supplementary_Figures_1_19__Supplementary_Tables_1_4.pdf" mimetype="application" mime-subtype="pdf" id="d59aAcHbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary data file legend</label><media xlink:href="EMS201752-supplement-Supplementary_data_file_legend.pdf" mimetype="application" mime-subtype="pdf" id="d59aAcHcB" position="anchor"/></supplementary-material></sec></body><back><ack id="S21"><title>Acknowledgements</title><p>We thank all members of the Niopek lab and Mathony group for helpful discussions. The authors acknowledge support by the state of Baden-Württemberg through bwHPC and the German Research Foundation (DFG) through grant INST 35/1597-1 FUGG.</p><sec id="S22"><title>Funding</title><p>This work was supported by the European Union (ERC, DaVinci-Switches, project number 101041570). Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council Executive Agency. Neither the European Union nor the granting authority can be held responsible for them. D.N. is also grateful for funding by the Aventis Foundation.</p></sec></ack><sec id="S23" sec-type="data-availability"><title>Data availability</title><p id="P53">Additional information, including relevant amino acid sequences, targeted genomic loci and PCR primers for InDel quantification are provided in the supplementary information. Genbank files of DNA constructs are provided as <xref ref-type="supplementary-material" rid="SD2">supplementary data file</xref>. Important constructs will be shared on Addgene (Add gene ID: xxxx, xxxx). Additional data will be shared upon reasonable request.</p></sec><sec id="S24" sec-type="code-availability"><title>Code Availability</title><p id="P54">The ProDomino model is available on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/Niopek-Lab/ProDomino">https://github.com/Niopek-Lab/ProDomino</ext-link>.</p></sec><fn-group><fn id="FN2" fn-type="con"><p id="P55"><bold>Contributions</bold></p><p id="P56">B.W., J.M. and D.N. conceived the study, designed the experiments and interpreted the data. B.W. implemented the datasets and machine learning pipeline. P.S., L.B., J.E., S.H., S.A., A.B., N.S., A.K., and J.M. designed and performed experiments. D.N. secured funding. J.M. and D.N. jointly directed the work. B.W., J.M. and D.N. jointly wrote the manuscript with the support of all authors.</p></fn><fn id="FN3" fn-type="conflict"><p id="P57"><bold>Competing interests</bold></p><p id="P58">The authors declare no competing interest.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponting</surname><given-names>CP</given-names></name><name><surname>Russell</surname><given-names>RR</given-names></name></person-group><article-title>The Natural History of Protein Domains</article-title><source>Annu Rev Biophys Biomol Struct</source><year>2002</year><volume>31</volume><fpage>45</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">11988462</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marsh</surname><given-names>JA</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>How do proteins gain new domains?</article-title><source>Genome Biol</source><year>2010</year><volume>11</volume><fpage>126</fpage><pub-id pub-id-type="pmcid">PMC2926777</pub-id><pub-id pub-id-type="pmid">20630117</pub-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-7-126</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Apic</surname><given-names>G</given-names></name><name><surname>Russell</surname><given-names>RB</given-names></name></person-group><article-title>Domain Recombination: A Workhorse for Evolutionary Innovation</article-title><source>Sci Signal</source><year>2010</year><volume>3</volume><fpage>139</fpage><pub-id pub-id-type="pmid">20841565</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathony</surname><given-names>J</given-names></name><name><surname>Niopek</surname><given-names>D</given-names></name></person-group><article-title>Enlightening Allostery: Designing Switchable Proteins by Photoreceptor Fusion</article-title><source>Adv Biol</source><year>2021</year><volume>5</volume><elocation-id>2000181</elocation-id><pub-id pub-id-type="pmid">33107225</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostermeier</surname><given-names>M</given-names></name></person-group><article-title>Designing switchable enzymes</article-title><source>Curr Opin Struct Biol</source><year>2009</year><volume>19</volume><fpage>442</fpage><lpage>448</lpage><pub-id pub-id-type="pmcid">PMC2736331</pub-id><pub-id pub-id-type="pmid">19473830</pub-id><pub-id pub-id-type="doi">10.1016/j.sbi.2009.04.007</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dagliyan</surname><given-names>O</given-names></name><etal/></person-group><article-title>Engineering extrinsic disorder to control protein activity in living cells</article-title><source>Science</source><year>2016</year><volume>354</volume><fpage>1441</fpage><lpage>1444</lpage><pub-id pub-id-type="pmcid">PMC5362825</pub-id><pub-id pub-id-type="pmid">27980211</pub-id><pub-id pub-id-type="doi">10.1126/science.aah3404</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dagliyan</surname><given-names>O</given-names></name><name><surname>Hahn</surname><given-names>KM</given-names></name></person-group><article-title>Engineering proteins for allosteric control by light or ligands</article-title><source>Nat Protoc</source><year>2019</year><volume>14</volume><fpage>1863</fpage><lpage>1883</lpage><pub-id pub-id-type="pmcid">PMC6648709</pub-id><pub-id pub-id-type="pmid">31076662</pub-id><pub-id pub-id-type="doi">10.1038/s41596-019-0165-3</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plaper</surname><given-names>T</given-names></name><etal/></person-group><article-title>Designed allosteric protein logic</article-title><source>Cell Discov</source><year>2024</year><volume>10</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmcid">PMC10791696</pub-id><pub-id pub-id-type="pmid">38228615</pub-id><pub-id pub-id-type="doi">10.1038/s41421-023-00635-y</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bubeck</surname><given-names>F</given-names></name><etal/></person-group><article-title>Engineered anti-CRISPR proteins for optogenetic control of CRISPR– Cas9</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>924</fpage><lpage>927</lpage><pub-id pub-id-type="pmid">30377362</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathony</surname><given-names>J</given-names></name><name><surname>Aschenbrenner</surname><given-names>S</given-names></name><name><surname>Becker</surname><given-names>P</given-names></name><name><surname>Niopek</surname><given-names>D</given-names></name></person-group><article-title>Dissecting the Determinants of Domain Insertion Tolerance and Allostery in Proteins</article-title><source>Adv Sci</source><year>2023</year><volume>10</volume><fpage>28</fpage><pub-id pub-id-type="pmcid">PMC10558690</pub-id><pub-id pub-id-type="pmid">37562980</pub-id><pub-id pub-id-type="doi">10.1002/advs.202303496</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coyote-Maestas</surname><given-names>W</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Myers</surname><given-names>CL</given-names></name><name><surname>Schmidt</surname><given-names>D</given-names></name></person-group><article-title>Domain insertion permissibility-guided engineering of allostery in ion channels</article-title><source>Nat Commun</source><year>2019</year><volume>10</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC6336875</pub-id><pub-id pub-id-type="pmid">30655517</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-08171-0</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>KA</given-names></name><name><surname>McLaughlin</surname><given-names>RN</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Hot spots for allosteric regulation on protein surfaces</article-title><source>Cell</source><year>2011</year><volume>147</volume><fpage>1564</fpage><lpage>1575</lpage><pub-id pub-id-type="pmcid">PMC3414429</pub-id><pub-id pub-id-type="pmid">22196731</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2011.10.049</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coyote-Maestas</surname><given-names>W</given-names></name><etal/></person-group><article-title>Probing ion channel functional architecture and domain recombination compatibility by massively parallel domain insertion profiling</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><elocation-id>7114</elocation-id><pub-id pub-id-type="pmcid">PMC8654947</pub-id><pub-id pub-id-type="pmid">34880224</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-27342-0</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halabi</surname><given-names>N</given-names></name><name><surname>Rivoire</surname><given-names>O</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title><source>Cell</source><year>2009</year><volume>138</volume><fpage>774</fpage><lpage>86</lpage><pub-id pub-id-type="pmcid">PMC3210731</pub-id><pub-id pub-id-type="pmid">19703402</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2009.07.038</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abramson</surname><given-names>J</given-names></name><etal/></person-group><article-title>Accurate structure prediction of biomolecular interactions with AlphaFold 3</article-title><source>Nature</source><year>2024</year><volume>630</volume><fpage>493</fpage><lpage>500</lpage><pub-id pub-id-type="pmcid">PMC11168924</pub-id><pub-id pub-id-type="pmid">38718835</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07487-w</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title><source>Science</source><year>2023</year><volume>379</volume><fpage>1123</fpage><lpage>1130</lpage><pub-id pub-id-type="pmid">36927031</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rives</surname><given-names>A</given-names></name><etal/></person-group><article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title><source>Proc Natl Acad Sci</source><year>2021</year><volume>118</volume><elocation-id>e2016239118</elocation-id><pub-id pub-id-type="pmcid">PMC8053943</pub-id><pub-id pub-id-type="pmid">33876751</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Esvelt</surname><given-names>KM</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><article-title>Low-N protein engineering with data-efficient deep learning</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>389</fpage><lpage>396</lpage><pub-id pub-id-type="pmid">33828272</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bileschi</surname><given-names>ML</given-names></name><etal/></person-group><article-title>Using deep learning to annotate the protein universe</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>932</fpage><lpage>937</lpage><pub-id pub-id-type="pmid">35190689</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferruz</surname><given-names>N</given-names></name><name><surname>Schmidt</surname><given-names>S</given-names></name><name><surname>Höcker</surname><given-names>B</given-names></name></person-group><article-title>ProtGPT2 is a deep unsupervised language model for protein design</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><elocation-id>4348</elocation-id><pub-id pub-id-type="pmcid">PMC9329459</pub-id><pub-id pub-id-type="pmid">35896542</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-32007-7</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jendrusch</surname><given-names>M</given-names></name></person-group><article-title>AlphaDesign : A de novo protein design framework based on AlphaFold</article-title><year>2021</year><pub-id pub-id-type="doi">10.1101/2021.10.11.463937v1.full</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orengo</surname><given-names>CA</given-names></name><etal/></person-group><article-title>CATH - A hierarchic classification of protein domain structures</article-title><source>Structure</source><year>1997</year><volume>5</volume><fpage>1093</fpage><lpage>1109</lpage><pub-id pub-id-type="pmid">9309224</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>TE</given-names></name><etal/></person-group><article-title>Gene3D: Extensive prediction of globular domains in proteins</article-title><source>Nucleic Acids Res</source><year>2018</year><volume>46</volume><fpage>D435</fpage><lpage>D439</lpage><pub-id pub-id-type="pmcid">PMC5753360</pub-id><pub-id pub-id-type="pmid">29194501</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkx1187</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>P</given-names></name><etal/></person-group><article-title>InterProScan 5: genome-scale protein function classification</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>1236</fpage><lpage>1240</lpage><pub-id pub-id-type="pmcid">PMC3998142</pub-id><pub-id pub-id-type="pmid">24451626</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btu031</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paysan-Lafosse</surname><given-names>T</given-names></name><etal/></person-group><article-title>InterPro in 2022</article-title><source>Nucleic Acids Res</source><year>2023</year><volume>51</volume><fpage>D418</fpage><lpage>D427</lpage><pub-id pub-id-type="pmcid">PMC9825450</pub-id><pub-id pub-id-type="pmid">36350672</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac993</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzek</surname><given-names>BE</given-names></name><etal/></person-group><article-title>UniRef clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>926</fpage><lpage>932</lpage><pub-id pub-id-type="pmcid">PMC4375400</pub-id><pub-id pub-id-type="pmid">25398609</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btu739</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aroul-Selvam</surname><given-names>R</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Sasidharan</surname><given-names>R</given-names></name></person-group><article-title>Domain insertions in protein structures</article-title><source>J Mol Biol</source><year>2004</year><volume>338</volume><fpage>633</fpage><lpage>641</lpage><pub-id pub-id-type="pmcid">PMC2665287</pub-id><pub-id pub-id-type="pmid">15099733</pub-id><pub-id pub-id-type="doi">10.1016/j.jmb.2004.03.039</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oakes</surname><given-names>BL</given-names></name><etal/></person-group><article-title>Profiling of engineering hotspots identifies an allosteric CRISPR-Cas9 switch</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>646</fpage><lpage>651</lpage><pub-id pub-id-type="pmcid">PMC4900928</pub-id><pub-id pub-id-type="pmid">27136077</pub-id><pub-id pub-id-type="doi">10.1038/nbt.3528</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>L</given-names></name><etal/></person-group><article-title>An anti-CRISPR protein disables type V Cas12a by acetylation</article-title><source>Nat Struct Mol Biol</source><year>2019</year><volume>26</volume><fpage>308</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">30936526</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name><etal/></person-group><article-title>Three novel Cas12a orthologs with robust DNA cleavage activity suitable for nucleic acid detection</article-title><source>Gene</source><year>2023</year><volume>852</volume><elocation-id>147055</elocation-id><pub-id pub-id-type="pmid">36400115</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rihtar</surname><given-names>E</given-names></name><etal/></person-group><article-title>Chemically inducible split protein regulators for mammalian cells</article-title><source>Nat Chem Biol</source><year>2023</year><volume>19</volume><fpage>64</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">36163385</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenker</surname><given-names>L</given-names></name><etal/></person-group><article-title>A Versatile Anti-CRISPR Platform for Opto- and Chemogenetic Control of CRISPR-Cas9 and Cas12 across a Wide Range of Orthologs</article-title><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.11.25.625186</pub-id></element-citation></ref><ref id="R33"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>AB</given-names></name><name><surname>Akpinaroglu</surname><given-names>D</given-names></name><name><surname>Kelly</surname><given-names>M</given-names></name><name><surname>Kortemme</surname><given-names>T</given-names></name></person-group><article-title>Deep learning guided design of dynamic proteins</article-title><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.07.17.603962</pub-id></element-citation></ref><ref id="R34"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisanza</surname><given-names>SL</given-names></name><etal/></person-group><article-title>Multistate and functional protein design using RoseTTAFold sequence space diffusion</article-title><source>Nat Biotechnol</source><year>2024</year><pub-id pub-id-type="pmid">39322764</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>J</given-names></name><name><surname>Chang</surname><given-names>M-W</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Toutanova</surname><given-names>K</given-names></name></person-group><source>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</source><year>2019</year><comment>Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.04805">http://arxiv.org/abs/1810.04805</ext-link></comment></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><article-title>Adam: A Method for Stochastic Optimization</article-title><year>2017</year><pub-id pub-id-type="doi">10.48550/arXiv.1412.6980</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Söding</surname><given-names>J</given-names></name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive datasets</article-title><source>Nat Biotechnol</source><year>2017</year><volume>35</volume><fpage>1026</fpage><lpage>1028</lpage><pub-id pub-id-type="pmid">29035372</pub-id></element-citation></ref><ref id="R38"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirdita</surname><given-names>M</given-names></name><etal/></person-group><article-title>ColabFold: Making Protein folding accessible to all</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>679</fpage><lpage>682</lpage><pub-id pub-id-type="pmcid">PMC9184281</pub-id><pub-id pub-id-type="pmid">35637307</pub-id><pub-id pub-id-type="doi">10.1038/s41592-022-01488-1</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJA</given-names></name><etal/></person-group><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>1422</fpage><lpage>1423</lpage><pub-id pub-id-type="pmcid">PMC2682512</pub-id><pub-id pub-id-type="pmid">19304878</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moffat</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>DT</given-names></name></person-group><article-title>Increasing the accuracy of single sequence prediction methods using a deep semi-supervised learning framework</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><fpage>3744</fpage><lpage>3751</lpage><pub-id pub-id-type="pmcid">PMC8570780</pub-id><pub-id pub-id-type="pmid">34213528</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab491</pub-id></element-citation></ref><ref id="R41"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engler</surname><given-names>C</given-names></name><name><surname>Gruetzner</surname><given-names>R</given-names></name><name><surname>Kandzia</surname><given-names>R</given-names></name><name><surname>Marillonnet</surname><given-names>S</given-names></name></person-group><article-title>Golden gate shuffling: A one-pot DNA shuffling method based on type ils restriction enzymes</article-title><source>PLoS ONE</source><year>2009</year><volume>4</volume><elocation-id>e5553</elocation-id><pub-id pub-id-type="pmcid">PMC2677662</pub-id><pub-id pub-id-type="pmid">19436741</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0005553</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>MD</given-names></name><etal/></person-group><article-title>Optogenetic control of Neisseria meningitidis Cas9 genome editing using an engineered, light-switchable anti-CRISPR protein</article-title><source>Nucleic Acids Res</source><year>2021</year><volume>49</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC7969004</pub-id><pub-id pub-id-type="pmid">33330940</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkaa1198</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clement</surname><given-names>K</given-names></name><etal/></person-group><article-title>CRISPResso2 provides accurate and rapid genome editing sequence analysis</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>224</fpage><lpage>226</lpage><pub-id pub-id-type="pmcid">PMC6533916</pub-id><pub-id pub-id-type="pmid">30809026</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0032-3</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig 1</label><caption><title>Intradomain insertions are common in natural proteins.</title><p>a, Novel proteins can arise from the insertion of one domain into another. b, Strategy for generating a large domain insertion dataset of natural proteins. c, The number of unique domain superfamily combinations is shown for a given parent (left panel) or insert domain (right panel). Only the top five most promiscuous domains are shown. d, Alphafold2-generated structures of example proteins from the dataset with PDZ domain insertions. Insert domains are in green and parent proteins in blue. e, Length distribution of insert domains, parent domains (without the respective insert), and parent proteins in the dataset. Parent domains are defined as the annotated Interpro domains originally carrying the insert, while parent protein refers to the full-length protein without the insert. f, Distribution of relative insertion site positions within parent domains and parent proteins. g, The frequency of different CATH-GENE3D domain types at the “class” and “architecture” levels (according to the CATH hierarchy) within the whole CATH database are compared with the corresponding distribution of the insert and parent domains in our dataset.</p></caption><graphic xlink:href="EMS201752-f001"/></fig><fig id="F2" position="float"><label>Fig 2</label><caption><title>A machine learning model to infer domain insertion sites in proteins.</title><p>a, Schematic of the machine learning pipeline for protein insertion site prediction. b-d, Boxplots showing prediction scores for true positive (green) and negative labels (other positions, unknown; blue) on a test set. The performance of different models trained with different encoding strategies (b), on different dataset splits (random; Interpro, based on domain classes; single, one representative example per class) (c) or using positional masking (d) is shown (see <xref ref-type="supplementary-material" rid="SD1">Supplementary note 1</xref> for details). e, Boxplot of insertion scores predicted by the model variant trained on the “single” representative protein dataset split, grouped by secondary structures. The calculation is based on secondary structure predictions for the entire test set. b-e, Boxes represent the interquartile range (IQR) and the median is represented by a horizontal line. Whiskers extend to the 1.5-fold IQR or to the value of the smallest or largest predicted value. f-g, Exemplary predictions from the test set. The natural insertion sites are marked in green and the insert domain is colored accordingly in the protein structures. f, phosphoglycerate kinase (PDB IDs: 4NG4); g, Rvb1/Rvb2 heterohexamer (RuvB-like 1, PDB IDs: 5OAF). h, The insertion score for the bacterial transcription factor AraC is indicated for each amino acid position by a black line. Green positions indicate experimentally validated insertion tolerant sites<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. The domains and secondary structure elements of AraC are annotated. i, AUROC plot of the insertion site prediction for AraC. j, Insertion scores mapped onto the Alphafold-2-predicted AraC protein structure. h, j, Allosteric insertion sites, previously validated in experiments (I113 and S170), are indicated.</p></caption><graphic xlink:href="EMS201752-f002"/></fig><fig id="F3" position="float"><label>Fig 3</label><caption><title>ProDomino informs the engineering of light-controlled antibiotic resistances.</title><p>a, b, The insertion scores predicted by ProDomino are mapped onto the primary sequences of PAC (a) and CAT (b). Sites selected for experimental testing by domain insertion are marked with a purple line. c, d Insertion scores are mapped onto the crystal structures of PAC (c) and CAT (d). The selected insertion sites are indicated. PDB IDs: 7K0A, 1PD5. e, Scheme of light-regulated PAC/CAT function. f, Light control of puromycin resistance. HEK293T cells transfected with vectors encoding the respective PAC variants or a negative control expressing enhanced green fluorescent protein (eGFP, control) were treated with 10 μg/mL puromycin, starting 24 h post-transfection. Samples were incubated either in the dark or under blue light illumination for 72 hours post-transfection, followed by microscopy. g, Light-controlled <italic>E. coli</italic> culture growth. Bacteria were transformed with plasmids expressing the indicated CAT variant or an empty control plasmid. Liquid cultures were grown in the presence of 25 μg/mL chloramphenicol for 7 h, followed by assessment of cell density at 600 nm. Bars indicate means, error bars the standard deviation, and black dots individual data points from n=3 independent experiments. h, Spatial regulation of bacterial growth. <italic>E. coli</italic> expressing CAT-K136-LOV and monomeric red fluorescent protein (mRFP) were plated in top agar supplemented with 25 μg/mL chloramphenicol. During incubation at 37°C, the plates were illuminated through a photomask (top) and fluorescent cells were imaged under UV light (bottom).</p></caption><graphic xlink:href="EMS201752-f003"/></fig><fig id="F4" position="float"><label>Fig 4</label><caption><title>ProDomino confidently predicts potent opto- and chemogenetic Cas9 and Cas12a variants.</title><p><bold>a</bold>, <bold>d</bold>, Insertion scores predicted by ProDomino are mapped onto the primary sequences of Cas9 (<bold>a</bold>) or Cas12a (<bold>d</bold>). Selected high- and low scoring sites are marked in purple and gray, respectively. <bold>b</bold>,<bold>e</bold>,<bold>f</bold>, The insertion scores predicted by ProDomino are mapped onto experimentally resolved structures of Cas9 (<bold>b</bold>) and Cas12a (<bold>e,f</bold>). Insertion sites selected for experimental validation are indicated. PDB IDs: 4UN3, 6IV6. <bold>c</bold>, HEK293T cells were transfected with vectors encoding (i) the indicated Cas9/VPR-LOV hybrid variant (or Cas9/VPR as control), (ii) a TetO-targeting sgRNA together and a <italic>Renilla</italic> luciferase and (iii) a firefly luciferase preceded by multiple TetO repeats. Samples were incubated under blue light or in the dark for 48 h, followed by luciferase assay. <bold>g-i</bold>, HEK293T cells were transfected with vectors encoding (i) the indicated Cas12a-GR2 hybrid variant (or wild-type Cas12a as control), and (ii) a gRNA targeting the endogenous <italic>RUNX</italic> (<bold>g</bold>), <italic>GRIN2B</italic> (<bold>h</bold>) or <italic>VEGFA</italic> (<bold>i</bold>) locus. Samples were treated with cortisol or DMSO as indicated. 72 h post-transfection, InDel frequencies were assessed by NGS. <bold>c</bold>, <bold>g-i</bold>, Bars indicate means, error bars the standard deviation, and black dots individual data points from n=2 (<bold>h</bold>) or n=3 (<bold>c,g,i</bold>) independent experiments. Cor, cortisol.</p></caption><graphic xlink:href="EMS201752-f004"/></fig></floats-group></article>