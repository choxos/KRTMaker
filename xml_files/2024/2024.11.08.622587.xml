<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199979</article-id><article-id pub-id-type="doi">10.1101/2024.11.08.622587</article-id><article-id pub-id-type="archive">PPR937057</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A comprehensive representation of selection at loci with multiple alleles that allows complex forms of genotypic fitness</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7054-3268</contrib-id><name><surname>Vellnow</surname><given-names>Nikolas</given-names></name><email>nikolas.vellnow@tu-dortmund.de</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6609-4116</contrib-id><name><surname>Gossmann</surname><given-names>Toni I.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9093-2108</contrib-id><name><surname>Waxman</surname><given-names>David</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01k97gp34</institution-id><institution>TU Dortmund University</institution></institution-wrap>, Computational Systems Biology, Faculty of Biochemical and Chemical Engineering, <addr-line>Emil-Figge-Str. 66</addr-line>, <postal-code>44227</postal-code><city>Dortmund</city>, <country country="DE">Germany</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013q1eq08</institution-id><institution>Fudan University</institution></institution-wrap>, Centre for Computational Systems Biology, ISTBI, <addr-line>220 Handan Road</addr-line>, <city>Shanghai</city><postal-code>200433</postal-code>, <country country="CN">People’s Republic of China</country></aff><author-notes><corresp id="CR1">
<label>*</label>corresponding author: <email>toni.gossmann@tu-dortmund.de</email>, <email>davidwaxman@fudan.edu.cn</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>10</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>09</day><month>11</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Genetic diversity is central to the process of evolution. Both natural selection and random genetic drift are influenced by the level of genetic diversity of a population; selection acts on diversity while drift samples from it. At a given locus in a diploid population, each individual carries only two alleles, but the population as a whole can possess a much larger number of alleles, with the upper limit constrained by twice the population size. This allows for many possible types of homozygotes and heterozygotes. Moreover, there are biologically important loci, for example those related to the MHC complex, the ABO blood types, and cystic fibrosis, that exhibit a large number of alleles. Despite this, much of population genetic theory, and data analysis, are limited to considering biallelic loci. However, to the present, what is lacking is a flexible expression for the force of selection that allows an arbitrary number of alleles (and hence an arbitrary number of heterozygotes), along with a variety of forms of fitness. In this work, we remedy this absence by giving an analytical representation of the force of selection that emphasises the very different roles played by the diversity of the population, and the fitnesses of different genotypes. The result presented facilitates our understanding and applies in a variety of different situations involving multiple alleles. This includes situations where fitnesses are: additive, multiplicative, randomly fluctuating, frequency-dependent, and it allows fitnesses which involve explicit gene interactions, such as heterozygote advantage.</p></abstract><kwd-group><kwd>heterozygosity</kwd><kwd>genetic variation</kwd><kwd>microsatellites</kwd><kwd>evolutionary dynamics</kwd><kwd>balancing selection</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Genetic diversity plays a central role in evolutionary theory since it is the raw material that natural selection can act upon. In population genetics, it is usually measured at the level of single nucleotides or loci, with a focus on biallelic single nucleotide polymorphisms (SNPs) (<xref ref-type="bibr" rid="R25">Heyne et al., 2023</xref>). However, restricting the analysis of genetic diversity to biallelic loci may lead to biased population genomic inferences, if loci are indeed multiallelic. In a given diploid individual a biallelic locus can be in one of two homozygous states, or in one heterozygous state. However, in the population as a whole, when there are <italic>n</italic> possible alleles there can be <italic>n</italic> different homozygotes and <italic>n</italic>(<italic>n</italic> – 1)/2 different heterozygotes (<xref ref-type="bibr" rid="R17">Gillespie, 2004</xref>; <xref ref-type="bibr" rid="R23">Hartl and Clark, 1997</xref>). This genetic diversity, which is ultimately created by mutations, may be strongly elevated in mutational hotspots, i.e., genomic regions with high mutation rates (<xref ref-type="bibr" rid="R40">Nesta, Tafur, and Beck, 2021</xref>), that lead to multiple alleles continually segregating at the same locus. Furthermore, genetic diversity, in the form of multiple alleles, may be both selected for, and maintained by some form of balancing selection, such as heterozygous advantage or frequency-dependent selection (<xref ref-type="bibr" rid="R24">Hedrick, 2012</xref>; <xref ref-type="bibr" rid="R2">Ayala and Campbell, 1974</xref>). In general, it seems likely that in any population, some loci will have more than two alleles, and hence will have the additional genetic diversity that goes along with this, i.e., more than one possible heterozygote type.</p><p id="P3">Indeed, there are many empirical examples of multiple alleles occurring at biologically relevant loci. For example, the amylase gene, which is involved in the digestion of starch-rich foods, exhibits multiple copy number variations in dogs, pigs, geladas and humans (<xref ref-type="bibr" rid="R1">Axelsson et al., 2013</xref>; <xref ref-type="bibr" rid="R41">Ollivier et al., 2016</xref>; <xref ref-type="bibr" rid="R44">Paudel et al., 2013</xref>; <xref ref-type="bibr" rid="R3">Caldon et al., 2024</xref>; <xref ref-type="bibr" rid="R45">Perry et al., 2007</xref>). Other examples, with sometimes <italic>hundreds</italic> of alleles include the major histocompatibility complex (MHC) involved in vertebrate immunity (<xref ref-type="bibr" rid="R47">Radwan et al., 2020</xref>), the ABO blood types (<xref ref-type="bibr" rid="R60">Yamamoto, 2021</xref>), and single locus genetic diseases like cystic fibrosis (<xref ref-type="bibr" rid="R51">Sharma and Cutting, 2020</xref>). In general, we may expect loci involved in the interaction between parasites and hosts to have a particularly high allelic richness since the dynamic of host-parasite co-evolution is thought to lead to the maintenance of many alleles via balancing selection (<xref ref-type="bibr" rid="R11">Ebert and Fields, 2020</xref>; <xref ref-type="bibr" rid="R9">Cornetti et al., 2024</xref>). Furthermore, the self-incompatibility locus in flowering plants is known to have an extremely high allelic richness (<xref ref-type="bibr" rid="R55">Takayama and Isogai, 2005</xref>), a phenomenon that is thought to be caused by strong negative frequency-dependent selection (<xref ref-type="bibr" rid="R59">Wright, 1939</xref>; <xref ref-type="bibr" rid="R61">Yokoyama and Nei, 1979</xref>; <xref ref-type="bibr" rid="R6">Charlesworth, Vekemans, et al., 2005</xref>).</p><p id="P4">Recent methodological advances in the field of genome sequencing and genome analysis have made the consideration of multiple alleles much more practical. In order to reliably detect alleles segregating at low frequencies (e.g., &lt; 0.05) it is necessary to sequence at very high depth (<xref ref-type="bibr" rid="R19">Gossmann and Waxman, 2022</xref>). Performing <italic>whole genome sequencing</italic> at such a high sequencing depth used to be prohibitively expensive but is now affordable by many researchers. Such deep sequencing will make the detection of rare alleles, and therefore the study of loci with multiple alleles, possible. We also expect that many loci, previously thought to be biallelic, will be discovered to be multiallelic when subject to deep sequencing. However, population genetic theory mostly focuses on biallelic loci, e.g. when using Watterson’s <italic>θ</italic> or Tajima’s <italic>D</italic> (<xref ref-type="bibr" rid="R57">Watterson, 1975</xref>; <xref ref-type="bibr" rid="R54">Tajima, 1989</xref>), and many genomics tools, and the associated software, assume (as indicated by their default settings) the presence of only two alleles (<xref ref-type="bibr" rid="R4">Campbell et al., 2016</xref>). Therefore, focusing on population genetic studies in scenarios with more than two alleles is clearly needed.</p><p id="P5">Here, we present a framework for the force of selection that can incorporate an arbitrary number of alleles, different forms of genotypic fitness, and which clearly differentiates the different roles played by genetic diversity and genotypic fitness. This framework allows the inclusion of interesting selection regimes, e.g. frequency-dependent selection, and gives insights into how the interplay between diversity and fitness is influenced by such selection regimes.</p><sec id="S2"><title>Motivation from a simple model</title><p id="P6">A very basic form of diversity is the genetic variation which exists at a single locus, and in what follows we shall often use <italic>diversity</italic> and <italic>variation</italic> as synonymous terms. Generally, natural selection acts on (biallelic or multiallelic) variation within a population and generates changes within the population. In addition to this, random genetic drift samples amongst existing variation within a population, and produces random changes. Thus both natural selection and random genetic drift only operate when there is variation within a population. This basic observation suggests that there may be a connection between the mathematical representation of these two distinct evolutionary ‘forces’ - selection and drift, which both vanish in the absence of variation. In this work we shall establish this connection by co-opting an expression involving population variability, that appears in formulae for random genetic drift, to obtain a compact formula for the selective force when there are multiple alleles.</p><p id="P7">For the simplest model involving a locus with two alleles, the connection between selection and drift can be readily seen, as we now show.</p><p id="P8">Consider a randomly mating diploid population with discrete generations, where a single biallelic locus is subject to multiplicative selection. Let <italic>x</italic> denote the frequency of a focal allele at the locus in a given generation. By the beginning of the next generation we have (<xref ref-type="bibr" rid="R17">Gillespie, 2004</xref>) that:
<list list-type="simple" id="L1"><list-item><label>(i)</label><p id="P9">selection contributes the amount <italic>sx</italic>(1 – <italic>x</italic>) to the change in frequency, where <italic>s</italic> is a selection coefficient associated with the focal allele (we have assumed |<italic>s</italic>| ≪ 1),</p></list-item><list-item><label>(ii)</label><p id="P10">random genetic drift contributes an amount <italic>x</italic>(1 – <italic>x</italic>)/(2<italic>N</italic>) to the variance of the frequency, where N is the population size<sup><xref ref-type="fn" rid="FN1">1</xref></sup>.</p></list-item></list></p><p id="P11">We note that these effects, from selection and drift, both contain an <italic>identical function of frequency,</italic> namely <italic>x</italic>(1 – <italic>x</italic>), which vanishes in the absence of variation (at <italic>x</italic> = 0 and <italic>x</italic> = 1). This shows a common dependency of these evolutionary forces on a basic measure of diversity of the population at the locus, namely <italic>x</italic>(1 – <italic>x</italic>).</p><p id="P12">We use the case above with two alleles to motivate a question that leads to a formula for selection at a locus with multiple alleles:</p><disp-quote id="Q1"><p id="P13">When there are more than two alleles at a locus, do the effects of natural selection and random genetic drift have a common dependence on the diversity of the population?</p></disp-quote><p id="P14">To answer this question, we first establish the model that we shall use.</p></sec><sec id="S3"><title>Model</title><p id="P15">We adopt a Wright-Fisher model for a population of diploid individuals in which there is an equal sex ratio and no sexual dimorphism. Generations are discrete, and labelled by <italic>t</italic> = 0, 1, 2,…. At the start of a generation there are <italic>N</italic> adult individuals in the population. The life cycle is:
<list list-type="simple" id="L2"><list-item><label>(i)</label><p id="P16">reproduction of adults by random mating, with all adults making the same very large contribution to the number of offspring, independent of parental genotype;</p></list-item><list-item><label>(ii)</label><p id="P17">death of all adults;</p></list-item><list-item><label>(iii)</label><p id="P18">offspring subject to selection at a single unlinked locus with <italic>n</italic> different alleles;</p></list-item><list-item><label>(iv)</label><p id="P19">non-selective thinning of the population to N individuals - who constitute the adults of the next generation.</p></list-item></list></p><p id="P20">There is no restriction on the number of alleles at the locus, so that <italic>n</italic> can have the values 2, 3, 4, …, and we label the <italic>j</italic>’th allele as <italic>B<sub>j</sub></italic>, with <italic>j</italic> = 1, 2, …, <italic>n</italic>.</p><p id="P21">To describe the population, we use an n component column vector, <bold>X</bold>(<italic>t</italic>), whose <italic>j</italic>’th element, <italic>X<sub>j</sub></italic>(<italic>t</italic>), is the frequency of allele <italic>B<sub>j</sub></italic> in adults, at the start of generation <italic>t</italic>, immediately prior to reproduction.</p><p id="P22">We take the <italic>B<sub>i</sub>B<sub>j</sub></italic> genotype to have a fitness proportional to 1 + <italic>A<sub>i,j</sub></italic>, i.e.,
<disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtext>fitness</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>of</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext>genotype</mml:mtext><mml:mspace width="1em"/><mml:mo>∝</mml:mo><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p><p id="P23">The quantity <italic>A<sub>i,j</sub></italic> is a measure of the selection acting on the <italic>B<sub>i</sub>B<sub>j</sub></italic> genotype<sup><xref ref-type="fn" rid="FN2">2</xref></sup>, and could be described as the ‘fitness effect’ of this genotype</p><p id="P24">In what follows we shall use <bold>A</bold> to denote the <italic>n</italic> × <italic>n</italic> matrix whose (<italic>i, j</italic>) element is <italic>A<sub>i,j</sub></italic>. Assuming the absence of genomic imprinting or other epigenetic phenomena (<xref ref-type="bibr" rid="R46">Peters, 2014</xref>) we have <italic>A<sub>i,j</sub></italic> = <italic>A<sub>j,i</sub>,</italic> i.e., the matrix <bold>A</bold> is <italic>symmetric.</italic></p></sec><sec id="S4"><title>Notation</title><p id="P25">For convenience we present here the remainder of the notation that we will use in the rest of this work.</p><p id="P26">Generally, the vector of allele frequencies at any time <italic>t</italic>, namely <bold>X</bold>(<italic>t</italic>), is a random variable with the properties of being non-negative and normalised to unity in the sense that <italic>X<sub>j</sub></italic>(<italic>t</italic>) ≥ 0 and <inline-formula><mml:math id="M2"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. We write realisations (or non-random examples) of <bold>X</bold>(<italic>t</italic>) as <bold>x</bold> and these are also non-negative and normalised to unity.</p><p id="P27">With a <italic>T</italic> superscript denoting the transpose of a matrix, we use the notation where:
<list list-type="bullet" id="L3"><list-item><p id="P28"><italic>δ<sub>i,j</sub></italic> denotes a Kronecker delta, which takes the value 1 when the indices <italic>i</italic> and <italic>j</italic> are equal, and is zero otherwise</p></list-item><list-item><p id="P29"><bold>F</bold> denotes an <italic>n</italic> component column vector with all elements 1:</p></list-item></list>
<disp-formula id="FD2"><label>(2)</label><mml:math id="M3"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula>
<list list-type="bullet" id="L4"><list-item><p id="P30"><bold>I</bold> denotes the <italic>n</italic> × <italic>n</italic> identity matrix</p></list-item><list-item><p id="P31"><bold>V</bold>(<bold>x</bold>) denotes an <italic>n</italic> × <italic>n</italic> matrix which depends on the vector <bold>x</bold>, and has elements given by</p></list-item></list>
<disp-formula id="FD3"><label>(3)</label><mml:math id="M4"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext></mml:math></disp-formula></p></sec><sec id="S5"><title>Dynamics of the model</title><p id="P32">The frequency of <italic>all</italic> alleles in generation <italic>t</italic> + 1, i.e., after reproduction, selection and number thinning have occurred in generation <italic>t</italic>, can be written in the form of the single equation
<disp-formula id="FD4"><label>(4)</label><mml:math id="M5"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>ξ</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P33">where <bold>X</bold>(<italic>t</italic>), <bold>D</bold>(<bold>X</bold>(<italic>t</italic>)) and <bold><italic>ξ</italic></bold>(<italic>t</italic>) are all <italic>n</italic> component column vectors. The quantities <bold>D</bold>(<bold>X</bold>(<italic>t</italic>)) and <bold><italic>ξ</italic></bold>(<italic>t</italic>) can be called ‘evolutionary forces’ since they both change <bold>X</bold>(<italic>t</italic>). They arise from natural selection and random genetic drift, respectively.</p><p id="P34">To describe <xref ref-type="disp-formula" rid="FD4">Eq. (4)</xref> in greater detail, we begin with the force of genetic drift, namely the vector <bold><italic>ξ</italic></bold>(<italic>t</italic>), with elements <italic>ξ<sub>j</sub></italic>(<italic>t</italic>). For any realisation of <bold>X</bold>(<italic>t</italic>), the expected value of <bold><italic>ξ</italic></bold>(<italic>t</italic>) over replicate populations vanishes, and we write this as <italic>E</italic> [<bold><italic>ξ</italic></bold>(<italic>t</italic>)|<bold>X</bold>(<italic>t</italic>) = <bold>x</bold>] = <bold>0</bold>.</p><p id="P35">The variance-covariance matrix of <bold><italic>ξ</italic></bold>(<italic>t</italic>), conditional on <bold>X</bold>(<italic>t</italic>) = <bold>x</bold>, is given approximately<sup><xref ref-type="fn" rid="FN3">3</xref></sup> by
<disp-formula id="FD5"><label>(5)</label><mml:math id="M6"><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>ξ</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>ξ</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P36">where the matrix <bold>V</bold>(<bold>x</bold>) of <xref ref-type="disp-formula" rid="FD3">Eq. (3)</xref> enters - see <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref> for details. Thus the (<italic>i, j</italic>) element of the variance-covariance matrix of <bold><italic>ξ</italic></bold>(<italic>t</italic>) is given by <italic>E</italic>[<italic>ξ</italic><sub><italic>i</italic></sub>(<italic>t</italic>)<italic>ξ</italic><sub><italic>j</italic></sub>(<italic>t</italic>)|<bold>X</bold>(<italic>t</italic>) = <bold>x</bold>] ≃ <italic>V<sub>i,j</sub></italic>(<bold>x</bold>)/(2<italic>N</italic>).</p><p id="P37">When there are multiple alleles, the matrix <bold>V</bold>(<bold>x</bold>) in <xref ref-type="disp-formula" rid="FD5">Eq. (5)</xref> explicitly exposes the dependence of genetic drift on the diversity of the population. The only time <bold>V</bold>(<bold>x</bold>) vanishes (has all elements zero) is when a single allele is at a frequency of unity (and all other alleles are at zero frequency).</p><p id="P38">Consider now the selective force in <xref ref-type="disp-formula" rid="FD4">Eq. (4)</xref>, namely <bold>D</bold>(<bold>X</bold>(<italic>t</italic>)). There are different ways to write <bold>D</bold>(<bold>x</bold>) but in <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref> we show that it can be compactly written as
<disp-formula id="FD6"><label>(6)</label><mml:math id="M7"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">Ax</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">Ax</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1.5em"/><mml:mtext>general</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>case</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P39">In this representation of <bold>D</bold>(<bold>x</bold>) we see the presence of the matrix <bold>A</bold>, which is associated with genotypic fitness - see <xref ref-type="disp-formula" rid="FD1">Eq. (1)</xref>. We also see the matrix <bold>V</bold>(<bold>x</bold>), which naturally emerged as the feature of random genetic drift that exposed its dependence on the population’s diversity. Evidently, the matrix <bold>V</bold>(<bold>x</bold>) also plays a key role in the form of the evolutionary force of selection. This connection is even clearer under the continuous time, continuous state, diffusion approximation of <xref ref-type="disp-formula" rid="FD4">Eq. (4)</xref>, which says that over a small time interval <italic>dt,</italic> the change in frequencies, <italic>d</italic><bold>X</bold>, arises from the sum of effects of selective and drift forces. With <bold>D</bold>(<bold>x</bold>) ≃ <bold>V</bold>(<bold>x</bold>)<bold>Ax</bold> and omitting <italic>t</italic> arguments, the diffusion approximation of <xref ref-type="disp-formula" rid="FD4">Eq. (4)</xref> takes the form
<disp-formula id="FD7"><label>(7)</label><mml:math id="M8"><mml:mrow><mml:mi>d</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi><mml:mi>X</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mi>d</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p id="P40">where we have introduced the effective population size, <italic>N<sub>e</sub></italic>, and also the column vector <bold>W</bold> ≡ <bold>W</bold>(<italic>t</italic>) that has random elements, representing the stochasticity of genetic drift. Thus the same frequency-dependent matrix, <bold>V</bold>(<bold>X</bold>) appears in the terms arising from selection and drift in <xref ref-type="disp-formula" rid="FD7">Eq. (7)</xref> and it is natural to generally associate this matrix with a description of <italic>diversity</italic> of the population.</p><p id="P41">With <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref> or <xref ref-type="disp-formula" rid="FD7">Eq. (7)</xref>, we have an answer to the question in the Introduction:</p><disp-quote id="Q2"><p id="P42">When there are multiple alleles, selection and drift have a common dependence on the diversity of the population which, when allele frequencies are given by x, is described by <bold>V</bold>(<bold>x</bold>).</p></disp-quote></sec><sec id="S6"><title>Special cases of D(<bold>x</bold>)</title><p id="P43">We next explore some special cases of the selective force given in <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref>.</p></sec><sec id="S7"><title>Additive selection</title><p id="P44">Under additive selection, the <italic>B<sub>i</sub>B<sub>j</sub></italic> genotype has a fitness proportional to 1 + <italic>A<sub>i,j</sub></italic> = 1 + <italic>s<sub>i</sub></italic> + <italic>s<sub>j</sub></italic> where <italic>s<sub>i</sub></italic> is a selection coefficient associated with allele <italic>B<sub>i</sub></italic>. With <bold>s</bold> an <italic>n</italic> component column vector whose <italic>i</italic>’th element is <bold>s</bold><sub><italic>i</italic></sub>, we have
<disp-formula id="FD8"><label>(8)</label><mml:math id="M9"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>s</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P45">and under additive selection we can write the matrix <bold>A</bold> as
<disp-formula id="FD9"><label>(9)</label><mml:math id="M10"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:msup><mml:mtext mathvariant="bold">F</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>s</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P46">because its elements are precisely given by <italic>A<sub>i,j</sub></italic> = <italic>s<sub>i</sub></italic> + <italic>s<sub>j</sub></italic>.</p><p id="P47">Given that <bold>x</bold> represents a column vector of possible allele frequencies, it has the property <inline-formula><mml:math id="M11"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, which can be written as <bold>F</bold><sup><italic>T</italic></sup><bold>x</bold> = 1, and this leads to <bold>V</bold>(<bold>x</bold>)<bold>F</bold> being a vector with all elements zero (using <xref ref-type="disp-formula" rid="FD3">Eq. (3)</xref>). Thus
<disp-formula id="FD10"><label>(10)</label><mml:math id="M12"><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">Ax</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mtext mathvariant="bold">sF</mml:mtext></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext><mml:msup><mml:mtext mathvariant="bold">s</mml:mtext><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P48">Also we have
<disp-formula id="FD11"><label>(11)</label><mml:math id="M13"><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">Ax</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext mathvariant="bold">s</mml:mtext><mml:msup><mml:mtext mathvariant="bold">F</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext><mml:msup><mml:mtext mathvariant="bold">s</mml:mtext><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mtext mathvariant="bold">s</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P49">These lead to
<disp-formula id="FD12"><label>(12)</label><mml:math id="M14"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mtext mathvariant="bold">s</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1.5em"/><mml:mtext>additive</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>selection</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P50">In the special case of <italic>n</italic> = 2 alleles, with <italic>s</italic><sub>1</sub> = <italic>s</italic>, <italic>s</italic><sub>2</sub> = 0, and writing <italic>x</italic> = <italic>x</italic><sub>1</sub>, we obtain a selective force on the frequency of allele <italic>B</italic><sub>1</sub> of <italic>D</italic><sub>1</sub>(<bold>x</bold>) = <italic>sx</italic>(1 – <italic>x</italic>)/ (1 + 2<italic>sx</italic>).</p></sec><sec id="S8"><title>Multiplicative selection</title><p id="P51">Under multiplicative selection, the <italic>B<sub>i</sub>B<sub>j</sub></italic> genotype has a fitness proportional to 1+<italic>A<sub>i,j</sub></italic> = (1 + <italic>s<sub>i</sub></italic>) (1 + <italic>s<sub>j</sub></italic>) and again we shall refer to <italic>s<sub>i</sub></italic> as the selection coefficient associated with allele <italic>B<sub>i</sub></italic>. In this case, again using <xref ref-type="disp-formula" rid="FD8">Eq. (8)</xref>, we can write
<disp-formula id="FD13"><label>(13)</label><mml:math id="M15"><mml:mrow><mml:mtext mathvariant="bold">A</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext mathvariant="bold">FF</mml:mtext></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P52">We then have <bold>V</bold>(<bold>x</bold>)<bold>Ax</bold> = <bold>V</bold>(<bold>x</bold>)<bold>s</bold> (1 + <bold>s</bold><sup><italic>T</italic></sup><bold>x</bold>) and 1 + <bold>x</bold><sup><italic>T</italic></sup><bold>Ax</bold> = (1 + <bold>s</bold><sup><italic>T</italic></sup><bold>x</bold>)<sup>2</sup> and hence
<disp-formula id="FD14"><label>(14)</label><mml:math id="M16"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mtext mathvariant="bold">s</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1.5em"/><mml:mtext>multiplicative</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>selection</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P53">In the special case of <italic>n</italic> = 2 alleles, with <italic>s</italic><sub>1</sub> = <italic>s</italic>, <italic>s</italic><sub>2</sub> = 0, and writing <italic>x</italic> = <italic>x</italic><sub>1</sub>, we obtain a selective force on the frequency of allele <italic>B</italic><sub>1</sub> of <italic>D</italic><sub>1</sub>(<bold>x</bold>) = <italic>sx</italic>(1 – <italic>x</italic>)/ (1 + <italic>sx</italic>).</p></sec><sec id="S9"><title>Heterozygote advantage</title><p id="P54">We next consider one of the simplest forms of selection that acts genuinely at the level of genotypes, and cannot be devolved to properties of individual alleles. This is selection where all heterozygotes have a common fitness advantage of σ relative to all homozygotes. That is
<disp-formula id="FD15"><label>(15)</label><mml:math id="M17"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P55">This corresponds to
<disp-formula id="FD16"><label>(16)</label><mml:math id="M18"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P56">Using this result in <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref> yields
<disp-formula id="FD17"><label>(17)</label><mml:math id="M19"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>σ</mml:mi><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mtext mathvariant="bold">T</mml:mtext></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1.5em"/><mml:mtext>heterozygote</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>selection</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P57">In the special case of <italic>n</italic> = 2 alleles, and writing <italic>x = x</italic><sub>1</sub>, we obtain a selective force on the frequency of allele <italic>B</italic><sub>1</sub> of D<sub>1</sub>(<bold>x</bold>) = <italic>σx</italic>(1 – <italic>x</italic>)(1 — 2<italic>x</italic>)/ [1 + 2<italic>σx</italic>(1 – <italic>x</italic>)].</p></sec><sec id="S10"><title>Fluctuating selection</title><p id="P58">We consider the situation where fitnesses randomly change (<xref ref-type="bibr" rid="R28">Huerta-Sanchez, Durrett, and Bustamante, 2008</xref>; <xref ref-type="bibr" rid="R20">Gossmann, Waxman, and Eyre-Walker, 2014</xref>), from one generation to the next, due, for example, to random environmental effects on the population. Here we give one example based on <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref>. Assuming fitnesses are not correlated over time, it is then appropriate to directly average over the fluctuating fitnesses. The standard way of proceeding, <italic>as far as the selective force is concerned</italic> (we do not consider the change in the variance of allelic effects), is to first expand the selective force to second order in selection coefficients, and then average the result (<xref ref-type="bibr" rid="R29">Jensen and Pollak, 1969</xref>). Here, we shall interpret the analogue of selection coefficients as the elements of the matrix <bold>A</bold>, that appears in <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref>, and we will expand <bold>D</bold>(<bold>x</bold>) to second order in <bold>A</bold>. This leads to <bold>D</bold>(<bold>x</bold>) ≃ <bold>V</bold>(<bold>x</bold>)<bold>Ax</bold> – <bold>V</bold>(<bold>x</bold>) <bold>Ax</bold> (<bold>x</bold><sup><italic>T</italic></sup><bold>Ax</bold>).</p><p id="P59">As an illustrative example, we take
<disp-formula id="FD18"><label>(18)</label><mml:math id="M20"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mi>λ</mml:mi></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></disp-formula></p><p id="P60">where the <italic>Z<sub>i,j</sub></italic> are, for all <italic>i</italic> and <italic>j</italic>, independent normal random variables with mean zero and variance one, while <italic>λ</italic> is a measure of variance of fitness effects. The form of <italic>A<sub>i,j</sub></italic> adopted in <xref ref-type="disp-formula" rid="FD18">Eq. (18)</xref> ensures that <italic>A<sub>i,j</sub></italic> = <italic>A<sub>j,i</sub>.</italic> It also leads to the mean value of <bold>A</bold> vanishing (the average effect of selection on any genotype is zero) which we write as <bold>Ā</bold> = <bold>0</bold>. Furthermore with <italic>A<sub>i,j</sub></italic> given by <xref ref-type="disp-formula" rid="FD18">Eq. (18)</xref>, to calculate the average of <bold>D</bold>(<bold>x</bold>), we require knowledge of the average of <italic>A<sub>i,j</sub>A<sub>k,l</sub></italic> for arbitrary <italic>i</italic>, <italic>j</italic>, <italic>k</italic> and <italic>l.</italic> This is given by
<disp-formula id="FD19"><label>(19)</label><mml:math id="M21"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></disp-formula></p><p id="P61">and using this result leads to<sup><xref ref-type="fn" rid="FN4">4</xref></sup>
<disp-formula id="FD20"><label>(20)</label><mml:math id="M22"><mml:mover accent="true"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>A</mml:mi><mml:mi>x</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">Ax</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext mathvariant="bold">V</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P62">In the special case of <italic>n</italic> = 2 alleles, and writing <italic>x = x</italic><sub>1</sub>, we obtain an averaged selective force on allele <italic>B</italic><sub>1</sub> of <inline-formula><mml:math id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>x</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="S11"><title>Frequency dependent selection</title><p id="P63">We can model negative frequency-dependent selection by allowing the fitness of a genotype to depend on the genotype’s frequency, such that the fitness is a <italic>decreasing function</italic> of genotype frequency. This results in the matrix of fitness effects, <bold>A</bold>, becoming <bold>A</bold>(<bold>x</bold>), where <bold>x</bold> can be thought of as the vector of current allele frequencies. The <italic>B<sub>i</sub>B<sub>j</sub></italic> genotype now has a fitness proportional to 1 + <italic>A<sub>i,j</sub></italic>(<bold>x</bold>) and we take
<disp-formula id="FD21"><label>(21)</label><mml:math id="M24"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></disp-formula></p><p id="P64">where <italic>c</italic> is a constant<sup><xref ref-type="fn" rid="FN5">5</xref></sup> that lies in the range 0 ≤ <italic>c</italic> &lt; 1.</p><p id="P65">Since we can write <bold>A</bold>(<bold>x</bold>) = – <italic>c</italic>xx<sup><italic>T</italic></sup>, the form of the selective force following from <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref> is
<disp-formula id="FD22"><label>(22)</label><mml:math id="M25"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mtext mathvariant="bold">x</mml:mtext><mml:mi>T</mml:mi></mml:msup><mml:mtext mathvariant="bold">x</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P66">In the special case of <italic>n</italic> = 2 alleles, and writing <italic>x = x</italic><sub>1</sub>, we obtain a selective force on the frequency of allele <italic>B</italic><sub>1</sub> of <inline-formula><mml:math id="M26"><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></inline-formula></p></sec><sec id="S12"><title>Illustrations of the dynamics</title><p id="P67">To illustrate the dynamics that naturally arises from our framework in some interesting cases, we calculated allele frequency trajectories numerically. The detailed scripts are available as a github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/NikolasVellnow/selection_multiallelic">https://github.com/NikolasVellnow/selection_multiallelic</ext-link>). In particular, for a locus with n = 3 alleles, we calculated three pairs of frequency trajectories, for a number of different scenarios, over 5 × 10<sup>3</sup> generations. In each pair of trajectories, one was deterministic and the other stochastic, corresponding to population sizes of infinity and 10<sup>3</sup>, respectively.</p><p id="P68">In the results we present, the finite (but large) number of generations we consider has the consequence that the deterministic trajectories closely approach, but never actually reach the end point they would ultimately achieve. In what follows, we shall make statements about ‘achieving fixation’ or ‘achieving a stable polymorphism’ that should be interpreted to hold to an accuracy of machine precision (1 part in 10<sup>14</sup>).</p><p id="P69">Furthermore, to aid visualisation of the trajectories given in the figures of this section, we have included a coloured planar triangular region, that all trajectories are confined to lie in (as a consequence of their three allele frequencies summing to unity at all times).</p><p id="P70">For <xref ref-type="fig" rid="F1">Figure 1</xref>, we proceeded by first calculating the dynamics with a randomly generated set of fitness effects, based on a normal distribution, as given in <xref ref-type="disp-formula" rid="FD18">Eq. (18)</xref>. The set of fitness values was generated just once, at the beginning of the simulation, and was then used throughout. We simulated a scenario where three populations had the starting allele frequencies (0.50, 0.25, 0.25), (0.25, 0.50, 0.25), and (0.25, 0.25, 0.50). We observe that the deterministic end point of the three populations may depend on the initial frequencies (see <xref ref-type="fig" rid="F1">Figure 1</xref>). The populations with starting frequencies (0.50, 0.25, 0.25), (0.25, 0.50, 0.25) both reached the end point (0.5595, 0.4405, 0). This end point, under deterministic dynamics, is a stable polymorphism, where alleles <italic>B</italic><sub>1</sub> and <italic>B</italic><sub>2</sub> are maintained in the population while allele <italic>B</italic><sub>3</sub> is lost. By contrast, the population with the starting frequencies (0.25, 0.25, 0.50) reached the end point (0, 0, 1), corresponding to fixation of allele <italic>B</italic><sub>3</sub>.</p><p id="P71">In <xref ref-type="fig" rid="F2">Figure 2</xref> we illustrate the dynamics when fitnesses are additive (<xref ref-type="disp-formula" rid="FD9">Eq. 9</xref>). For this, we simulated a scenario where three populations had the starting allele frequencies (0.70, 0.15, 0.15), (0.15, 0.07, 0.15), and (0.15, 0.15, 0.70). The set of fitness values was calculated from the allelic selection coefficients (0.01, 0.03, 0.06) which were then used throughout. In this case, whether following deterministic or stochastic trajectories, allele <italic>B</italic><sub>3</sub> reached fixation in all three pairs of populations, independent of the starting frequencies (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p><p id="P72">In <xref ref-type="fig" rid="F3">Figure 3</xref> we give an example of a type of balancing selection. We calculated the dynamics for frequency-dependent selection (<xref ref-type="disp-formula" rid="FD21">Eq. 21</xref>). We simulated a scenario with three populations, that had the starting allele frequencies (0.70, 0.15, 0.15), (0.15, 0.70, 0.15), and (0.15, 0.15, 0.70), where the strength of frequency-dependent selection was <italic>c</italic> = 0.05. The set of fitness values was updated every generation, based on the current allele frequencies (cf. <xref ref-type="disp-formula" rid="FD21">Eq. (21)</xref>). Here, all three populations, following a deterministic trajectory, reached the same stable polymorphism, that had the intermediate end point frequencies (1/3, 1/3, 1/3), independent of the starting frequencies (see <xref ref-type="fig" rid="F3">Figure 3</xref>). All populations following a stochastic trajectory drifted around the point (1/3, 1/3, 1/3) and, over the time of simulation, exhibited a polymorphism that included all alleles (<xref ref-type="fig" rid="F3">Figure 3</xref>)</p><p id="P73">To calculate diverse cases of fitness, it is only necessary to change the form of the matrix <bold>A</bold>(<bold>x</bold>), and decide if it is calculated only once, at the beginning of the simulation, or whether it has to be updated after each generation (e.g., as in the case of frequency-dependent selection). This highlights the flexibility with which our framework can implement different forms of selection on multiallelic loci.</p></sec></sec><sec id="S13" sec-type="discussion"><title>Discussion</title><p id="P74">In this work we have presented a generalised framework to model multiallelic genetic diversity that incorporates complex forms of selection. We provide detailed scripts as <xref ref-type="supplementary-material" rid="SD1">supplemental material</xref> to this manuscript, which allow interested researchers to tailor this powerful population genetic framework to their specific research questions. Our approach not only allows the incorporation of complex forms of selection, that act at the level of genotypes, but most importantly, it may be applied when there are an arbitrary number of alleles. Therefore, unlike many treatments that assume biallelic loci, our approach can incorporate additional alleles that may be at (very) low frequencies. This is in particular relevant when: (i) the genetic diversity of a single locus is very high and many alleles exist (<xref ref-type="bibr" rid="R47">Radwan et al., 2020</xref>; <xref ref-type="bibr" rid="R60">Yamamoto, 2021</xref>; <xref ref-type="bibr" rid="R51">Sharma and Cutting, 2020</xref>) or (ii) the effective population size at a particular locus is very high (<xref ref-type="bibr" rid="R18">Gossmann, Woolfit, and Eyre-Walker, 2011</xref>; <xref ref-type="bibr" rid="R52">Smith and Haigh, 1974</xref>; <xref ref-type="bibr" rid="R5">Charlesworth, Morgan, and Charlesworth, 1993</xref>).</p><p id="P75">The comprehensive form for the deterministic force of selection, that we have presented in this work, can be integrated into a broader framework involving stochastic variation. It is possible that in a multiallelic sample (many) alleles segregate at low frequencies and for these alleles stochastic effects play a pronounced role. Rare alleles are more likely to be lost, due to random fluctuations in allele frequencies, than relatively common alleles. With multiple alleles, allele frequency changes due to drift can also result in complex fluctuations. Since there are more alleles, the overall variance in allele frequencies across generations can be higher than in a simple two-allele system. In loci with many alleles, genetic drift should gradually reduce the overall genetic diversity over many generations (<xref ref-type="bibr" rid="R30">Kimura, 1955</xref>; <xref ref-type="bibr" rid="R34">Latter and Novitski, 1969</xref>). However, in larger populations or populations with balancing selection (such as heterozygote advantage or frequency-dependent selection), genetic diversity may be maintained despite the random effects of drift (<xref ref-type="bibr" rid="R31">Kimura and Crow, 1964</xref>; <xref ref-type="bibr" rid="R35">Lewontin, Ginzburg, and Tuljapurkar, 1978</xref>; <xref ref-type="bibr" rid="R53">Spencer and Marks, 1988</xref>). Discovering alleles that may contribute to such processes is dependent on correct identification of the total genetic variation at a given genetic locus. Our approach can help in the understanding of the tight interplay between increased mutations, drift and the action of balancing selection. An example, where only certain types of allelic combinations lead to a heterosis effect, could be straightforwardly modelled within our framework.</p><p id="P76">Since our model allows the incorporation of complex forms of selection, which act at the level of the genotype, it can be used to study a wide range of questions. For this, it is only necessary to define the matrix of fitness effects, <bold>A</bold>(<bold>x</bold>), in accordance with the specific research question. For instance, we think that the interesting model used by Haasl and Payseur, in which they considered genotypic fitness to be dependent on the length of the microsatellite allele at a focal locus (<xref ref-type="bibr" rid="R22">Haasl and Payseur, 2013</xref>; <xref ref-type="bibr" rid="R21">Haasl, Johnson, and Payseur, 2014</xref>), could also be modelled as a special case of our framework. Furthermore, arbitrarily complex forms of incomplete dominance could also be modelled.</p><p id="P77">There are some direct spin-offs from the general framework that we have presented. For example, it exposes relations between the selective forces arising from different forms of fitness. Consider the selective forces in <xref ref-type="disp-formula" rid="FD17">Eqs. (17)</xref>, <xref ref-type="disp-formula" rid="FD20">(20)</xref>, and <xref ref-type="disp-formula" rid="FD22">(22)</xref>, that arise, respectively, from fitnesses that act on heterozygotes, or are fluctuating, or that lead to negative frequency-dependent selection. While all these forms of fitness are different, the selective forces that arise all have very similar forms. In particular all three expressions for the force are of the form –<italic>κ</italic><bold>V</bold>(<bold>x</bold>)x, where <italic>κ</italic> depends on <bold>x</bold> but has a purely numerical value (it is not a vector or matrix). This means all three selective forces push allele frequencies in precisely the same ‘direction’, but by different amounts, because the coefficient, <italic>κ</italic>, generally has different forms and different values in the three cases.</p><p id="P78">There are a number of practical concerns that we wish to highlight when obtaining data on genetic diversity at loci with many alleles. First, obtaining low frequency variants from population genetic data, by pooling data, requires deep sampling to obtain alleles that are segregating at low frequencies. For example, even at 500X coverage the probability of observing a variant that segregates with a frequency of 0.1 percent (e.g. a new mutant in a diploid population of 500 individuals) is less than 50% (see <xref ref-type="fig" rid="F4">Figure 4a</xref>). So depending on the expected population size it might be necessary to sequence a pooled sample at an enormous coverage. However, sequencing costs have dropped substantially in recent years and therefore deep sequencing may now allow testing of more complex scenarios of selection, due to the identification of rare genetic variants at multiallelic sites.</p><p id="P79">Second, incorporating low frequency variants is also crucial when considering time-series experiments since this would allow much improved resolution over time (i.e., avoiding the omission of allele frequency trajectories because they appear hidden at certain time points). This is potentially relevant for evolve and re-sequencing experiments (<xref ref-type="bibr" rid="R49">Schlötterer et al., 2015</xref>) or when tracing strains in metagenomic samples over time (<xref ref-type="bibr" rid="R15">Faust et al., 2015</xref>; <xref ref-type="bibr" rid="R27">Hildebrand, Moitinho-Silva, et al., 2019</xref>; <xref ref-type="bibr" rid="R26">Hildebrand, Gossmann, et al., 2021</xref>). However, if low-frequency variation is omitted, e.g., as a consequence of a threshold (<xref ref-type="bibr" rid="R19">Gossmann and Waxman, 2022</xref>), then the allele-frequencies of the remaining (above threshold) alleles might be misleading (see <xref ref-type="fig" rid="F4">Figure 4b</xref>). In time-series experiments this may lead to “jumps” that can be misidentified as signatures of rapid change (e.g. selection). In general, as observation thresholds are to be expected due to sampling effects alone (see <xref ref-type="fig" rid="F4">Figure 4a</xref>) it is evident that much diversity and evolutionary dynamics may be missed because it occurs below the threshold (<xref ref-type="fig" rid="F4">Figure 4b</xref>).</p><p id="P80">Third, if SNPs are considered in a population-wide sample, then in principle a single base position can have four alleles, at most. However, we would expect selection to act at a level of DNA sequences that segregate together and are rarely broken up by recombination events (<xref ref-type="bibr" rid="R58">Williams, 1966</xref>), e.g., at the level of haplotypes (<xref ref-type="bibr" rid="R7">Clark, 2004</xref>; <xref ref-type="bibr" rid="R14">Fariello et al., 2013</xref>), or whole genes (<xref ref-type="bibr" rid="R8">Colbran, Ramos-Almodovar, and Mathieson, 2023</xref>), which will lead to a higher number of alleles. Furthermore, when studying epigenetic variation we can expect an even higher diversity of epialleles because there are more combinations of epigenetic modifications possible than there are unmodified nucleobases (<xref ref-type="bibr" rid="R36">Liu and Zhong, 2024</xref>; <xref ref-type="bibr" rid="R33">Kosel et al., 2024</xref>). Considering population genetic models with an arbitrary number of alleles is therefore not only realistic, but potentially very important, in order to capture all potential targets of selection (<xref ref-type="bibr" rid="R43">Overall and Waxman, 2024</xref>). While it is possible to obtain haplotype information from short read sequencing data (<xref ref-type="bibr" rid="R16">Garrison and Marth, 2012</xref>), a better resolution of haplotypes and potential epimarks can be reached when third generation sequencing technologies are applied, such as PacBio (<xref ref-type="bibr" rid="R48">Rhoads and Au, 2015</xref>) or Oxford Nanopore (<xref ref-type="bibr" rid="R56">Wang et al., 2021</xref>). A general approach to obtain complex haplotypes might be to use barcoding approaches from long range sequencing data (<xref ref-type="bibr" rid="R50">Sedlazeck et al., 2018</xref>).</p><p id="P81">Fourth, low frequency variation from a population genetic sample might be more difficult to obtain when individuals are sampled, which is not uncommon for vertebrate or other multicellular species. Individual based sampling depth potentially will need to be moderate to identify heterozygous sites, but would then need to be scaled up with the number of individuals tested (see <xref ref-type="fig" rid="F4">Figure 4a</xref>). However, often bioinformatic pipelines take population-wide signatures of polymorphic sites into account to filter out supposed sequencing errors (<xref ref-type="bibr" rid="R38">McKenna et al., 2010</xref>; <xref ref-type="bibr" rid="R32">Korneliussen, Albrechtsen, and Nielsen, 2014</xref>), which potentially leads to the wrong classification of rare or previously unknown variation. On the other hand, somatic mutations can be mislabeled as germline mutations (<xref ref-type="bibr" rid="R10">Dou et al., 2018</xref>; <xref ref-type="bibr" rid="R37">Lupski, 2013</xref>; <xref ref-type="bibr" rid="R42">Oota, 2020</xref>). Because somatic variation does not propagate to subsequent generations, time-series experiments may be used to identify such types of genetic variation, and therefore may help to accurately identify germline mutations segregating at low frequencies.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Appendices</label><media xlink:href="EMS199979-supplement-Appendices.pdf" mimetype="application" mime-subtype="pdf" id="d59aAcCbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S14"><title>Acknowledgments</title><p>This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme grant agreement No. 947636.</p></ack><sec id="S15" sec-type="data-availability"><title>Data availability</title><p id="P82">All scripts are available in the github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/NikolasVellnow/selection_multiallelic">https://github.com/NikolasVellnow/selection_ multiallelic</ext-link></p></sec><fn-group><fn id="FN1"><label>1</label><p id="P83">We work within the framework of ideal Wright-Fisher model, which depends on the census population size, <italic>N</italic>, and not the effective population size, <italic>N<sub>e</sub>.</italic> However, incorporation of <italic>N<sub>e</sub></italic> into this model is possible (<xref ref-type="bibr" rid="R62">Zhao, Gossmann, and Waxman, 2016</xref>).</p></fn><fn id="FN2"><label>2</label><p id="P84">The <italic>A<sub>i,j</sub></italic> may depend on allele frequencies, in which case selection is <italic>frequency dependent,</italic> and in generation <italic>t</italic> the <italic>A<sub>i,j</sub></italic> will depend on <bold>X</bold>(<italic>t</italic>). In what follows we shall treat the <italic>A<sub>i,j</sub></italic> as constants, unless we state otherwise.</p></fn><fn id="FN3"><label>3</label><p id="P85">The approximation neglects the effect of selection on the right hand side of <xref ref-type="disp-formula" rid="FD5">Eq. (5)</xref> (<xref ref-type="bibr" rid="R13">Ewens, 2004</xref>).</p></fn><fn id="FN4"><label>4</label><p>The model adopted for fluctuating selection, where <italic>A<sub>i,j</sub></italic> is given by <xref ref-type="disp-formula" rid="FD18">Eq. (18)</xref>, leads to a simple result for the averaged force of selection, in terms of one parameter, λ, along with the matrix <bold>V</bold>(<bold>x</bold>) and vector <bold>x</bold> - both in unaltered form. However, the model has the feature that the variance of fitness effects of homozygotes is <italic>twice</italic> that of heterozygotes <inline-formula><mml:math id="M27"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mtext>, but </mml:mtext><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mtext> for </mml:mtext><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></fn><fn id="FN5"><label>5</label><p id="P86">A more general form of negative frequency-dependent selection is given by <italic>A<sub>i,j</sub></italic>(<bold>x</bold>) = – <italic>c<sub>i,j</sub>x<sub>i</sub>x<sub>j</sub></italic> with <italic>c<sub>i,j</sub></italic> = <italic>c<sub>j,i</sub></italic> and 0 ≤ <italic>c<sub>i,j</sub></italic> &lt; 1.</p></fn><fn id="FN6" fn-type="con"><p id="P87"><bold>Author contributions</bold></p><p id="P88">All three authors contributed to the conception of this work. DW carried out the mathematical analysis in consultation with NV and TIG. NV conducted the simulations, in consultation with TIG and DW. All three authors drafted and finalized the manuscript.</p></fn><fn id="FN7" fn-type="conflict"><p id="P89"><bold>Declaration of competing interest</bold></p><p id="P90">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Axelsson</surname><given-names>Erik</given-names></name><etal/></person-group><article-title>The Genomic Signature of Dog Domestication Reveals Adaptation to a Starch-Rich Diet</article-title><source>Nature</source><year>2013</year><month>Mar</month><volume>495</volume><issue>7441</issue><fpage>360</fpage><lpage>364</lpage><comment>ISSN: 1476-4687</comment><pub-id pub-id-type="pmid">23354050</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayala</surname><given-names>Francisco J</given-names></name><name><surname>Campbell</surname><given-names>Cathryn A</given-names></name></person-group><article-title>Frequency-Dependent Selection</article-title><source>Annual Review of Ecology and Systematics</source><year>1974</year><volume>5</volume><fpage>115</fpage><lpage>138</lpage><comment>ISSN: 0066-4162. JSTOR: 2096883</comment></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caldon</surname><given-names>Matteo</given-names></name><etal/></person-group><article-title>Gelada Genomes Highlight Events of Gene Flow, Hybridisation and Local Adaptation That Track Past Climatic Changes</article-title><source>Molecular Ecology</source><year>2024</year><volume>n/a</volume><issue>n/a</issue><elocation-id>e17514</elocation-id><comment>ISSN: 1365-294X</comment><pub-id pub-id-type="pmid">39206888</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname><given-names>Ian M</given-names></name><etal/></person-group><article-title>Multiallelic Positions in the Human Genome: Challenges for Genetic Analyses</article-title><source>Human mutation</source><year>2016</year><month>Mar</month><volume>37</volume><issue>3</issue><fpage>231</fpage><lpage>234</lpage><comment>ISSN: 1059-7794</comment><pub-id pub-id-type="pmcid">PMC4752396</pub-id><pub-id pub-id-type="pmid">26670213</pub-id><pub-id pub-id-type="doi">10.1002/humu.22944</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlesworth</surname><given-names>B</given-names></name><name><surname>Morgan</surname><given-names>MT</given-names></name><name><surname>Charlesworth</surname><given-names>D</given-names></name></person-group><article-title>The Effect of Deleterious Mutations on Neutral Molecular Variation</article-title><source>Genetics</source><year>1993</year><month>Aug</month><volume>134</volume><issue>4</issue><fpage>1289</fpage><lpage>1303</lpage><comment>ISSN: 0016-6731</comment><pub-id pub-id-type="pmcid">PMC1205596</pub-id><pub-id pub-id-type="pmid">8375663</pub-id><pub-id pub-id-type="doi">10.1093/genetics/134.4.1289</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlesworth</surname><given-names>Deborah</given-names></name><name><surname>Vekemans</surname><given-names>Xavier</given-names></name><etal/></person-group><article-title>Plant Self-Incompatibility Systems: A Molecular Evolutionary Perspective</article-title><source>New Phytologist</source><year>2005</year><volume>168</volume><issue>1</issue><fpage>61</fpage><lpage>69</lpage><comment>ISSN: 1469-8137</comment><pub-id pub-id-type="pmid">16159321</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>Andrew G</given-names></name></person-group><article-title>The Role of Haplotypes in Candidate Gene Studies</article-title><source>Genetic Epidemiology</source><year>2004</year><volume>27</volume><issue>4</issue><fpage>321</fpage><lpage>333</lpage><comment>ISSN: 1098-2272</comment><pub-id pub-id-type="pmid">15368617</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colbran</surname><given-names>Laura L</given-names></name><name><surname>Ramos-Almodovar</surname><given-names>Fabian C</given-names></name><name><surname>Mathieson</surname><given-names>Iain</given-names></name></person-group><article-title>A Gene-Level Test for Directional Selection on Gene Expression</article-title><source>Genetics</source><year>2023</year><month>June</month><volume>224</volume><issue>2</issue><elocation-id>iyad060</elocation-id><comment>ISSN: 1943-2631</comment><pub-id pub-id-type="pmcid">PMC10213495</pub-id><pub-id pub-id-type="pmid">37036411</pub-id><pub-id pub-id-type="doi">10.1093/genetics/iyad060</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornetti</surname><given-names>Luca</given-names></name><etal/></person-group><article-title>Long-Term Balancing Selection for Pathogen Resistance Maintains Trans-Species Polymorphisms in a Planktonic Crustacean</article-title><source>Nature Communications</source><year>2024</year><month>June</month><volume>15</volume><issue>1</issue><fpage>5333</fpage><comment>ISSN: 2041-1723</comment><pub-id pub-id-type="pmcid">PMC11193740</pub-id><pub-id pub-id-type="pmid">38909039</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-49726-8</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dou</surname><given-names>Yanmei</given-names></name><etal/></person-group><article-title>Detecting Somatic Mutations in Normal Cells</article-title><source>Trends in Genetics</source><year>2018</year><month>July</month><volume>34</volume><issue>7</issue><fpage>545</fpage><lpage>557</lpage><comment>ISSN: 0168-9525</comment><pub-id pub-id-type="pmcid">PMC6029698</pub-id><pub-id pub-id-type="pmid">29731376</pub-id><pub-id pub-id-type="doi">10.1016/j.tig.2018.04.003</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebert</surname><given-names>Dieter</given-names></name><name><surname>Fields</surname><given-names>Peter D</given-names></name></person-group><article-title>Host–Parasite Co-Evolution and Its Genomic Signature</article-title><source>Nature Reviews Genetics</source><year>2020</year><month>Dec</month><volume>21</volume><issue>12</issue><fpage>754</fpage><lpage>768</lpage><comment>ISSN: 1471-0064</comment><pub-id pub-id-type="pmid">32860017</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>Merran</given-names></name><name><surname>Hastings</surname><given-names>NAJ</given-names></name><name><surname>Peacock</surname><given-names>Brian</given-names></name></person-group><source>Statistical Distributions</source><publisher-loc>New York, NY</publisher-loc><publisher-name>John Wiley &amp; Sons Inc</publisher-name><year>1993</year><month>June</month><edition>Subsequent Edition</edition><comment>ISSN: 978-0-471-55951-1</comment></element-citation></ref><ref id="R13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ewens</surname><given-names>Warren J</given-names></name></person-group><source>Mathematical Population Genetics 1: Theoretical Introduction</source><edition>2nd ed</edition><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><year>2004</year><month>Jan</month><comment>ISSN: 978-0-387-20191-7. 2004 Edition</comment></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fariello</surname><given-names>Maria Inès</given-names></name><etal/></person-group><article-title>Detecting Signatures of Selection Through Haplotype Differentiation Among Hierarchically Structured Populations</article-title><source>Genetics</source><year>2013</year><month>Mar</month><volume>193</volume><issue>3</issue><fpage>929</fpage><lpage>941</lpage><comment>ISSN: 1943-2631</comment><pub-id pub-id-type="pmcid">PMC3584007</pub-id><pub-id pub-id-type="pmid">23307896</pub-id><pub-id pub-id-type="doi">10.1534/genetics.112.147231</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faust</surname><given-names>Karoline</given-names></name><etal/></person-group><article-title>Metagenomics Meets Time Series Analysis: Unraveling Microbial Community Dynamics</article-title><source>Current Opinion in Microbiology. Environmental Microbiology • Extremophiles</source><year>2015</year><month>June</month><volume>25</volume><fpage>56</fpage><lpage>66</lpage><comment>ISSN: 1369-5274</comment><pub-id pub-id-type="pmid">26005845</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>Erik</given-names></name><name><surname>Marth</surname><given-names>Gabor</given-names></name></person-group><article-title>Haplotype-Based Variant Detection from Short-Read Sequencing</article-title><year>2012</year><month>July</month><elocation-id>arXiv: 1207.3907</elocation-id><pub-id pub-id-type="doi">10.48550/arXiv.1207.3907</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>John H H</given-names></name></person-group><source>Population Genetics: A Concise Guide</source><publisher-loc>Baltimore, Md</publisher-loc><publisher-name>Johns Hopkins University Press</publisher-name><year>2004</year><month>Aug</month><edition>2nd ed</edition><comment>ISBN: 978-0-8018-8009-4</comment></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gossmann</surname><given-names>Toni I</given-names></name><name><surname>Woolfit</surname><given-names>Megan</given-names></name><name><surname>Eyre-Walker</surname><given-names>Adam</given-names></name></person-group><article-title>Quantifying the Variation in the Effective Population Size Within a Genome</article-title><source>Genetics</source><year>2011</year><month>Dec</month><volume>189</volume><issue>4</issue><fpage>1389</fpage><lpage>1402</lpage><comment>ISSN: 1943-2631</comment><pub-id pub-id-type="pmcid">PMC3241429</pub-id><pub-id pub-id-type="pmid">21954163</pub-id><pub-id pub-id-type="doi">10.1534/genetics.111.132654</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gossmann</surname><given-names>Toni I</given-names></name><name><surname>Waxman</surname><given-names>David</given-names></name></person-group><article-title>Correcting Bias in Allele Frequency Estimates Due to an Observation Threshold: A Markov Chain Analysis</article-title><source>Genome Biology and Evolution</source><year>2022</year><month>Apr</month><volume>14</volume><issue>4</issue><elocation-id>evac047</elocation-id><comment>ISSN: 1759-6653</comment><pub-id pub-id-type="pmcid">PMC9016752</pub-id><pub-id pub-id-type="pmid">35349695</pub-id><pub-id pub-id-type="doi">10.1093/gbe/evac047</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gossmann</surname><given-names>Toni I</given-names></name><name><surname>Waxman</surname><given-names>David</given-names></name><name><surname>Eyre-Walker</surname><given-names>Adam</given-names></name></person-group><article-title>Fluctuating Selection Models and Mcdonald-Kreitman Type Analyses</article-title><source>PLOS ONE</source><year>2014</year><month>Jan</month><volume>9</volume><issue>1</issue><elocation-id>e84540</elocation-id><comment>ISSN: 1932-6203</comment><pub-id pub-id-type="pmcid">PMC3883665</pub-id><pub-id pub-id-type="pmid">24409303</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0084540</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haasl</surname><given-names>Ryan J</given-names></name><name><surname>Johnson</surname><given-names>Ross C</given-names></name><name><surname>Payseur</surname><given-names>Bret A</given-names></name></person-group><article-title>The Effects of Microsatellite Selection on Linked Sequence Diversity</article-title><source>Genome Biology and Evolution</source><year>2014</year><month>June</month><volume>6</volume><issue>7</issue><fpage>1843</fpage><pub-id pub-id-type="pmcid">PMC4122932</pub-id><pub-id pub-id-type="pmid">25115009</pub-id><pub-id pub-id-type="doi">10.1093/gbe/evu134</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haasl</surname><given-names>Ryan J</given-names></name><name><surname>Payseur</surname><given-names>Bret A</given-names></name></person-group><article-title>Microsatellites as Targets of Natural Selection</article-title><source>Molecular Biology and Evolution</source><year>2013</year><month>Feb</month><volume>30</volume><issue>2</issue><fpage>285</fpage><lpage>298</lpage><comment>ISSN: 1537-1719</comment><pub-id pub-id-type="pmcid">PMC3548306</pub-id><pub-id pub-id-type="pmid">23104080</pub-id><pub-id pub-id-type="doi">10.1093/molbev/mss247</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hartl</surname><given-names>Daniel L</given-names></name><name><surname>Clark</surname><given-names>Andrew G</given-names></name></person-group><chapter-title>Principles of Population Genetics</chapter-title><person-group person-group-type="author"><name><surname>Hartl</surname><given-names>Daniel L</given-names></name></person-group><edition>Third edition</edition><publisher-loc>Harvard Univ., Cambridge, MA, USA</publisher-loc><publisher-name>Sinauer Associates, Inc</publisher-name><year>1997</year><comment>ISBN: 0-87893-306-9</comment></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>Philip W</given-names></name></person-group><article-title>What Is the Evidence for Heterozygote Advantage Selection?</article-title><source>Trends in Ecology &amp; Evolution</source><year>2012</year><month>Dec</month><volume>27</volume><issue>12</issue><fpage>698</fpage><lpage>704</lpage><comment>ISSN: 0169-5347</comment><pub-id pub-id-type="pmid">22975220</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heyne</surname><given-names>HO</given-names></name><etal/></person-group><article-title>Mono- and Biallelic Variant Effects on Disease at Biobank Scale</article-title><source>Nature</source><year>2023</year><month>Jan</month><volume>613</volume><issue>7944</issue><fpage>519</fpage><pub-id pub-id-type="pmcid">PMC9849130</pub-id><pub-id pub-id-type="pmid">36653560</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05420-7</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname><given-names>Falk</given-names></name><name><surname>Gossmann</surname><given-names>Toni I</given-names></name><etal/></person-group><article-title>Dispersal Strategies Shape Persistence and Evolution of Human Gut Bacteria</article-title><source>Cell Host &amp; Microbe</source><year>2021</year><month>July</month><volume>29</volume><issue>7</issue><fpage>1167</fpage><lpage>1176</lpage><elocation-id>e9</elocation-id><comment>ISSN: 1931-3128</comment><pub-id pub-id-type="pmcid">PMC8288446</pub-id><pub-id pub-id-type="pmid">34111423</pub-id><pub-id pub-id-type="doi">10.1016/j.chom.2021.05.008</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname><given-names>Falk</given-names></name><name><surname>Moitinho-Silva</surname><given-names>Lucas</given-names></name><etal/></person-group><article-title>Antibiotics-Induced Monodominance of a Novel Gut Bacterial Order</article-title><source>Gut</source><year>2019</year><month>Oct</month><volume>68</volume><issue>10</issue><fpage>1781</fpage><lpage>1790</lpage><comment>ISSN: 0017-5749, 1468-3288</comment><pub-id pub-id-type="pmcid">PMC6839795</pub-id><pub-id pub-id-type="pmid">30658995</pub-id><pub-id pub-id-type="doi">10.1136/gutjnl-2018-317715</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huerta-Sanchez</surname><given-names>Emilia</given-names></name><name><surname>Durrett</surname><given-names>Rick</given-names></name><name><surname>Bustamante</surname><given-names>Carlos D</given-names></name></person-group><article-title>Population Genetics of Polymorphism and Divergence Under Fluctuating Selection</article-title><source>Genetics</source><year>2008</year><month>Jan</month><volume>178</volume><issue>1</issue><fpage>325</fpage><lpage>337</lpage><comment>ISSN: 1943-2631</comment><pub-id pub-id-type="pmcid">PMC2206081</pub-id><pub-id pub-id-type="pmid">17947441</pub-id><pub-id pub-id-type="doi">10.1534/genetics.107.073361</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>Louis</given-names></name><name><surname>Pollak</surname><given-names>Edward</given-names></name></person-group><article-title>Random Selective Advantages of a Gene in a Finite Population</article-title><source>Journal of Applied Probability</source><year>1969</year><volume>6</volume><issue>1</issue><fpage>19</fpage><lpage>37</lpage><comment>ISSN: 0021-9002. JSTOR: 3212274</comment><pub-id pub-id-type="doi">10.2307/3212274</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>Motoo</given-names></name></person-group><article-title>Random Genetic Drift in Multi-Allelic Locus</article-title><source>Evolution</source><year>1955</year><volume>9</volume><issue>4</issue><fpage>419</fpage><lpage>435</lpage><comment>ISSN: 0014-3820. JSTOR: 2405476</comment><pub-id pub-id-type="doi">10.2307/2405476</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>Motoo</given-names></name><name><surname>Crow</surname><given-names>James F</given-names></name></person-group><article-title>The Number of Alleles That Can Be Maintained in a Finite Population</article-title><source>Genetics</source><year>1964</year><month>Apr</month><volume>49</volume><issue>4</issue><fpage>725</fpage><lpage>738</lpage><comment>ISSN: 0016-6731</comment><pub-id pub-id-type="pmcid">PMC1210609</pub-id><pub-id pub-id-type="pmid">14156929</pub-id><pub-id pub-id-type="doi">10.1093/genetics/49.4.725</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korneliussen</surname><given-names>Thorfinn Sand</given-names></name><name><surname>Albrechtsen</surname><given-names>Anders</given-names></name><name><surname>Nielsen</surname><given-names>Rasmus</given-names></name></person-group><article-title>ANGSD: Analysis of Next Generation Sequencing Data</article-title><source>BMC Bioinformatics</source><year>2014</year><month>Nov</month><volume>15</volume><issue>1</issue><fpage>356</fpage><comment>ISSN: 1471-2105</comment><pub-id pub-id-type="pmcid">PMC4248462</pub-id><pub-id pub-id-type="pmid">25420514</pub-id><pub-id pub-id-type="doi">10.1186/s12859-014-0356-4</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosel</surname><given-names>Brinja</given-names></name><etal/></person-group><article-title>Evolved Readers of 5-Carboxylcytosine CpG Dyads Reveal a High Versatility of the Methyl-CpG-Binding Domain for Recognition of Noncanonical Epigenetic Marks</article-title><source>Angewandte Chemie International Edition</source><year>2024</year><volume>63</volume><issue>17</issue><elocation-id>e202318837</elocation-id><comment>ISSN: 1521-3773</comment><pub-id pub-id-type="pmid">38284298</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latter</surname><given-names>BDH</given-names></name><name><surname>Novitski</surname><given-names>CE</given-names></name></person-group><article-title>Selection in Finite Populations with Multiple Alleles I. Limits to Directional Selection</article-title><source>Genetics</source><year>1969</year><month>Aug</month><volume>62</volume><issue>4</issue><fpage>859</fpage><pub-id pub-id-type="pmcid">PMC1212322</pub-id><pub-id pub-id-type="pmid">17248464</pub-id><pub-id pub-id-type="doi">10.1093/genetics/62.4.859</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewontin</surname><given-names>RC</given-names></name><name><surname>Ginzburg</surname><given-names>LR</given-names></name><name><surname>Tuljapurkar</surname><given-names>SD</given-names></name></person-group><article-title>HETEROSIS AS AN EXPLANATION FOR LARGE AMOUNTS OF GENIC POLYMORPHISM</article-title><source>Genetics</source><year>1978</year><month>Jan</month><volume>88</volume><issue>1</issue><fpage>149</fpage><lpage>169</lpage><comment>ISSN: 1943-2631</comment><pub-id pub-id-type="pmcid">PMC1213786</pub-id><pub-id pub-id-type="pmid">17248790</pub-id><pub-id pub-id-type="doi">10.1093/genetics/88.1.149</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Jie</given-names></name><name><surname>Zhong</surname><given-names>Xuehua</given-names></name></person-group><article-title>Epiallelic Variation of Non-Coding RNA Genes and Their Phenotypic Consequences</article-title><source>Nature Communications</source><year>2024</year><month>Feb</month><volume>15</volume><issue>1</issue><fpage>1375</fpage><comment>ISSN: 2041-1723</comment><pub-id pub-id-type="pmcid">PMC10867003</pub-id><pub-id pub-id-type="pmid">38355746</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-45771-5</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lupski</surname><given-names>James R</given-names></name></person-group><article-title>Genome Mosaicism—One Human, Multiple Genomes</article-title><source>Science</source><year>2013</year><month>July</month><volume>341</volume><issue>6144</issue><fpage>358</fpage><lpage>359</lpage><pub-id pub-id-type="pmid">23888031</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>Aaron</given-names></name><etal/></person-group><article-title>The Genome Analysis Toolkit: A MapReduce Framework for Analyzing next-Generation DNA Sequencing Data</article-title><source>Genome Research</source><year>2010</year><month>Sept</month><volume>20</volume><issue>9</issue><fpage>1297</fpage><lpage>1303</lpage><comment>ISSN: 1088-9051, 1549-5469</comment><pub-id pub-id-type="pmcid">PMC2928508</pub-id><pub-id pub-id-type="pmid">20644199</pub-id><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nagylaki</surname><given-names>Thomas</given-names></name></person-group><source>Introduction to Theoretical Population Genetics</source><edition>1st ed</edition><publisher-loc>Berlin Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><year>1992</year><month>June</month><comment>ISBN: 978-3-540-53344-3</comment></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nesta</surname><given-names>Alex V</given-names></name><name><surname>Tafur</surname><given-names>Denisse</given-names></name><name><surname>Beck</surname><given-names>Christine R</given-names></name></person-group><article-title>Hotspots of Human Mutation</article-title><source>Trends in Genetics</source><year>2021</year><month>Aug</month><volume>37</volume><issue>8</issue><fpage>717</fpage><lpage>729</lpage><comment>ISSN: 0168-9525</comment><pub-id pub-id-type="pmcid">PMC8366565</pub-id><pub-id pub-id-type="pmid">33199048</pub-id><pub-id pub-id-type="doi">10.1016/j.tig.2020.10.003</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ollivier</surname><given-names>Morgane</given-names></name><etal/></person-group><article-title>Amy2B Copy Number Variation Reveals Starch Diet Adaptations in Ancient European Dogs</article-title><source>Royal Society Open Science</source><year>2016</year><month>Nov</month><volume>3</volume><issue>11</issue><elocation-id>160449</elocation-id><pub-id pub-id-type="pmcid">PMC5180126</pub-id><pub-id pub-id-type="pmid">28018628</pub-id><pub-id pub-id-type="doi">10.1098/rsos.160449</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oota</surname><given-names>Satoshi</given-names></name></person-group><article-title>Somatic Mutations – Evolution within the Individual</article-title><source>Methods. RNA-Seq: Methods and Applications</source><year>2020</year><month>Apr</month><volume>176</volume><fpage>91</fpage><lpage>98</lpage><comment>ISSN: 1046-2023</comment><pub-id pub-id-type="pmid">31711929</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overall</surname><given-names>ADJ</given-names></name><name><surname>Waxman</surname><given-names>D</given-names></name></person-group><article-title>Influence of Selection on the Probability of Fixation at a Locus with Multiple Alleles</article-title><source>BMC Genomics</source><year>2024</year><month>Aug</month><volume>25</volume><issue>1</issue><fpage>819</fpage><comment>ISSN: 1471-2164</comment><pub-id pub-id-type="pmcid">PMC11365252</pub-id><pub-id pub-id-type="pmid">39215209</pub-id><pub-id pub-id-type="doi">10.1186/s12864-024-10733-0</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paudel</surname><given-names>Yogesh</given-names></name><etal/></person-group><article-title>Evolutionary Dynamics of Copy Number Variation in Pig Genomes in the Context of Adaptation and Domestication</article-title><source>BMC Genomics</source><year>2013</year><month>July</month><volume>14</volume><issue>1</issue><fpage>449</fpage><comment>ISSN: 1471-2164</comment><pub-id pub-id-type="pmcid">PMC3716681</pub-id><pub-id pub-id-type="pmid">23829399</pub-id><pub-id pub-id-type="doi">10.1186/1471-2164-14-449</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perry</surname><given-names>George H</given-names></name><etal/></person-group><article-title>Diet and the Evolution of Human Amylase Gene Copy Number Variation</article-title><source>Nature Genetics</source><year>2007</year><month>Oct</month><volume>39</volume><issue>10</issue><fpage>1256</fpage><lpage>1260</lpage><comment>ISSN: 1546-1718</comment><pub-id pub-id-type="pmcid">PMC2377015</pub-id><pub-id pub-id-type="pmid">17828263</pub-id><pub-id pub-id-type="doi">10.1038/ng2123</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname><given-names>Jo</given-names></name></person-group><article-title>The Role of Genomic Imprinting in Biology and Disease: An Expanding View</article-title><source>Nature Reviews Genetics</source><year>2014</year><month>Aug</month><volume>15</volume><issue>8</issue><fpage>517</fpage><lpage>530</lpage><comment>ISSN: 1471-0064</comment><pub-id pub-id-type="pmid">24958438</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radwan</surname><given-names>Jacek</given-names></name><etal/></person-group><article-title>Advances in the Evolutionary Understanding of MHC Polymorphism</article-title><source>Trends in Genetics</source><year>2020</year><month>Apr</month><volume>36</volume><issue>4</issue><fpage>298</fpage><lpage>311</lpage><comment>ISSN: 0168-9525</comment><pub-id pub-id-type="pmid">32044115</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhoads</surname><given-names>Anthony</given-names></name><name><surname>Au</surname><given-names>Kin Fai</given-names></name></person-group><article-title>PacBio Sequencing and Its Applications</article-title><source>Genomics, Proteomics &amp; Bioinformatics</source><year>2015</year><month>Oct</month><volume>13</volume><issue>5</issue><fpage>278</fpage><lpage>289</lpage><comment>ISSN: 1672-0229</comment><pub-id pub-id-type="pmcid">PMC4678779</pub-id><pub-id pub-id-type="pmid">26542840</pub-id><pub-id pub-id-type="doi">10.1016/j.gpb.2015.08.002</pub-id></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlotterer</surname><given-names>C</given-names></name><etal/></person-group><article-title>Combining Experimental Evolution with Next-Generation Sequencing: A Powerful Tool to Study Adaptation from Standing Genetic Variation</article-title><source>Heredity</source><year>2015</year><month>May</month><volume>114</volume><issue>5</issue><fpage>431</fpage><lpage>440</lpage><comment>ISSN: 1365-2540</comment><pub-id pub-id-type="pmcid">PMC4815507</pub-id><pub-id pub-id-type="pmid">25269380</pub-id><pub-id pub-id-type="doi">10.1038/hdy.2014.86</pub-id></element-citation></ref><ref id="R50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sedlazeck</surname><given-names>Fritz J</given-names></name><etal/></person-group><article-title>Piercing the Dark Matter: Bioinformatics of Long-Range Sequencing and Mapping</article-title><source>Nature Reviews Genetics</source><year>2018</year><month>June</month><volume>19</volume><issue>6</issue><fpage>329</fpage><lpage>346</lpage><comment>ISSN: 1471-0064</comment><pub-id pub-id-type="pmid">29599501</pub-id></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>N</given-names></name><name><surname>Cutting</surname><given-names>GR</given-names></name></person-group><article-title>The Genetics and Genomics of Cystic Fibrosis</article-title><source>Journal of Cystic Fibrosis. ECFS Cystic Fibrosis Research</source><year>2020</year><month>Mar</month><volume>19</volume><fpage>S5</fpage><lpage>S9</lpage><comment>ISSN: 1569-1993</comment><pub-id pub-id-type="pmcid">PMC8008819</pub-id><pub-id pub-id-type="pmid">31879237</pub-id><pub-id pub-id-type="doi">10.1016/j.jcf.2019.11.003</pub-id></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JM</given-names></name><name><surname>Haigh</surname><given-names>J</given-names></name></person-group><article-title>The Hitch-Hiking Effect of a Favourable Gene</article-title><source>Genetical Research</source><year>1974</year><month>Feb</month><volume>23</volume><issue>1</issue><fpage>23</fpage><lpage>35</lpage><pub-id pub-id-type="pmid">4407212</pub-id></element-citation></ref><ref id="R53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>HG</given-names></name><name><surname>Marks</surname><given-names>RW</given-names></name></person-group><article-title>The Maintenance of Single-Locus Polymorphism. I. Numerical Studies of a Viability Selection Model</article-title><source>Genetics</source><year>1988</year><month>Oct</month><volume>120</volume><issue>2</issue><fpage>605</fpage><lpage>613</lpage><comment>ISSN: 0016-6731</comment><pub-id pub-id-type="pmcid">PMC1203537</pub-id><pub-id pub-id-type="pmid">3197961</pub-id><pub-id pub-id-type="doi">10.1093/genetics/120.2.605</pub-id></element-citation></ref><ref id="R54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname><given-names>F</given-names></name></person-group><article-title>Statistical Method for Testing the Neutral Mutation Hypothesis by DNA Polymorphism</article-title><source>Genetics</source><year>1989</year><month>Nov</month><volume>123</volume><issue>3</issue><fpage>585</fpage><lpage>595</lpage><comment>ISSN: 0016-6731</comment><pub-id pub-id-type="pmcid">PMC1203831</pub-id><pub-id pub-id-type="pmid">2513255</pub-id><pub-id pub-id-type="doi">10.1093/genetics/123.3.585</pub-id></element-citation></ref><ref id="R55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takayama</surname><given-names>Seiji</given-names></name><name><surname>Isogai</surname><given-names>Akira</given-names></name></person-group><article-title>SELF-INCOMPATIBILITY IN PLANTS</article-title><source>Annual Review of Plant Biology</source><year>2005</year><month>June</month><volume>56</volume><fpage>467</fpage><lpage>489</lpage><comment>ISSN: 1543-5008, 1545-2123</comment><pub-id pub-id-type="pmid">15862104</pub-id></element-citation></ref><ref id="R56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Yunhao</given-names></name><etal/></person-group><article-title>Nanopore Sequencing Technology, Bioinformatics and Applications</article-title><source>Nature Biotechnology</source><year>2021</year><month>Nov</month><volume>39</volume><issue>11</issue><fpage>1348</fpage><lpage>1365</lpage><comment>ISSN: 1546-1696</comment><pub-id pub-id-type="pmcid">PMC8988251</pub-id><pub-id pub-id-type="pmid">34750572</pub-id><pub-id pub-id-type="doi">10.1038/s41587-021-01108-x</pub-id></element-citation></ref><ref id="R57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watterson</surname><given-names>GA</given-names></name></person-group><article-title>On the Number of Segregating Sites in Genetical Models without Recombination</article-title><source>Theoretical Population Biology</source><year>1975</year><month>Apr</month><volume>7</volume><issue>2</issue><fpage>256</fpage><lpage>276</lpage><comment>ISSN: 0040-5809</comment><pub-id pub-id-type="pmid">1145509</pub-id></element-citation></ref><ref id="R58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>George Christopher</given-names></name></person-group><source>Adaptation and Natural Selection: A Critique of Some Current Evolutionary Thought</source><publisher-name>Princeton University Press</publisher-name><year>1966</year><comment>ISBN: 978-0-691-18550-7</comment></element-citation></ref><ref id="R59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>Sewall</given-names></name></person-group><article-title>The Distribution of Self-Sterility Alleles in Populations</article-title><source>Genetics</source><year>1939</year><month>June</month><volume>24</volume><issue>4</issue><fpage>538</fpage><pub-id pub-id-type="pmcid">PMC1209052</pub-id><pub-id pub-id-type="pmid">17246937</pub-id><pub-id pub-id-type="doi">10.1093/genetics/24.4.538</pub-id></element-citation></ref><ref id="R60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname><given-names>Fumiichiro</given-names></name></person-group><article-title>Molecular Genetics and Genomics of the ABO Blood Group System</article-title><source>Annals of Blood 6.0</source><year>2021</year><month>Sept</month><comment>ISSN: 2521-361X</comment><pub-id pub-id-type="doi">10.21037/aob-20-71</pub-id></element-citation></ref><ref id="R61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yokoyama</surname><given-names>S</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Population Dynamics of Sex-Determining Alleles in Honey Bees and Self-Incompatibility Alleles in Plants</article-title><source>Genetics</source><year>1979</year><month>Mar</month><volume>91</volume><issue>3</issue><fpage>609</fpage><lpage>626</lpage><comment>ISSN: 0016-6731</comment><pub-id pub-id-type="pmcid">PMC1216853</pub-id><pub-id pub-id-type="pmid">17248901</pub-id><pub-id pub-id-type="doi">10.1093/genetics/91.3.609</pub-id></element-citation></ref><ref id="R62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Lei</given-names></name><name><surname>Gossmann</surname><given-names>Toni I</given-names></name><name><surname>Waxman</surname><given-names>David</given-names></name></person-group><article-title>A Modified Wright–Fisher Model That Incorporates Ne: A Variant of the Standard Model with Increased Biological Realism and Reduced Computational Complexity</article-title><source>Journal of Theoretical Biology</source><year>2016</year><month>Mar</month><volume>393</volume><fpage>218</fpage><lpage>228</lpage><comment>ISSN: 0022-5193</comment><pub-id pub-id-type="pmid">26796316</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><caption><title>Significance statement</title></caption><p>Genetic diversity is a cornerstone of evolutionary processes, influencing both natural selection and genetic drift. While many biologically significant loci, like those associated with the MHC complex, ABO blood types, and cystic fibrosis, contain a large number of alleles, population genetics often simplifies analysis to biallelic loci. This study provides a new, flexible framework to quantify the force of selection in populations with an arbitrary number of alleles. This approach broadens our understanding of complex genetic scenarios, including those involving additive, multiplicative, and frequency-dependent fitness, as well as heterozygote advantage. This advancement enables more nuanced modeling of real-world evolutionary dynamics across diverse biological contexts.</p></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Allele frequency trajectories for the case of a single randomly generated set of fitness effects</bold> for <italic>n</italic> = 3 alleles, with frequencies <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub> and <italic>x</italic><sub>3</sub>. Three pairs of trajectories are plotted, each starting from a common point (blue dot). In each pair, one trajectory is deterministic (magenta) and is appropriate to an infinite population, while the other is stochastic (black), and is appropriate to a population of size <italic>N</italic> = 10<sup>3</sup>. The trajectories were run for a total of 5 × 10<sup>3</sup> generations. End points of deterministic trajectories are given by red dots.</p></caption><graphic xlink:href="EMS199979-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Allele frequency trajectories for the case of additive fitness</bold>, for <italic>n</italic> = 3 alleles, with frequencies <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub> and <italic>x</italic><sub>3</sub>. Three pairs of trajectories are plotted, each starting from a common point (blue dot). In each pair, one trajectory is deterministic (magenta) and is appropriate to an infinite population, while the other is stochastic (black), and is appropriate to a population of size <italic>N</italic> = 10<sup>3</sup>. The trajectories were run for a total of 5 × 10<sup>3</sup> generations, with the common end point of all deterministic trajectories given by the red dot.</p></caption><graphic xlink:href="EMS199979-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>Allele frequency trajectories for the case of negative frequency-dependent selection</bold> for <italic>n</italic> = 3 alleles, with frequencies <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub> and <italic>x</italic><sub>3</sub>. Three pairs of trajectories are plotted, each starting from a common point (blue dot). In each pair, one trajectory is deterministic (magenta) and is appropriate to an infinite population, while the other is stochastic (black), and is appropriate to a population of size <italic>N</italic> = 10<sup>3</sup>. The trajectories were run for a total of 5 × 10<sup>3</sup> generations, and the common end point of all deterministic trajectories is given by the red dot.</p></caption><graphic xlink:href="EMS199979-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>Illustration of observation thresholds in the analysis of multiallelic trajectories.</bold> (a) Probability to detect a genetic variant at a given frequency assuming different levels of sequencing coverage. This applies to pooled samples. (b) Shown are the exact allele frequency trajectories (red), and those after applying a 5% threshold (blue) for a locus with ten alleles and an arbitrarily chosen scheme of selection. The threshold (i) sets allele frequencies below 5% to zero and (ii) normalizes frequency so that they sum up to unity resulting in the ‘steps’ in the blue curves.</p></caption><graphic xlink:href="EMS199979-f004"/></fig></floats-group></article>