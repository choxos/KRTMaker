<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS200890</article-id><article-id pub-id-type="doi">10.1101/2024.11.22.624881</article-id><article-id pub-id-type="archive">PPR944989</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Linking Brain and Behavior States in Zebrafish Larvae Locomotion using Hidden Markov Models</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Dommanget-Kott</surname><given-names>Mattéo</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Fernandez-de-Cossio-Diaz</surname><given-names>Jorge</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Coraggioso</surname><given-names>Monica</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Bormuth</surname><given-names>Volker</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Monasson</surname><given-names>Rémi</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Debrégeas</surname><given-names>Georges</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">†</xref></contrib><contrib contrib-type="author"><name><surname>Cocco</surname><given-names>Simona</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR2">‡</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01c2cjg59</institution-id><institution>Institut de Biologie Paris-Seine (IBPS)</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01ghvgs84</institution-id><institution>Laboratoire Jean Perrin</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02en5vm52</institution-id><institution>Sorbonne Université</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap>, <country country="FR">France</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05f82e368</institution-id><institution>Université Paris Cité</institution></institution-wrap>, <country country="FR">France</country></aff><aff id="A3"><label>3</label>Laboratory of Physics of the Ecole Normale Supérieure, CNRS UMR 8023 PSL Research, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02en5vm52</institution-id><institution>Sorbonne Université</institution></institution-wrap>, Université de Paris, <country country="FR">France</country></aff><aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03xjwb503</institution-id><institution>Université Paris-Saclay</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap>, CEA, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/058rvd314</institution-id><institution>Institut de Physique Théorique</institution></institution-wrap>, <postal-code>91191</postal-code>, <city>Gif-sur-Yvette</city>, <country country="FR">France</country> (Dated: November 22, 2024)</aff><author-notes><corresp id="CR1"><label>†</label>Correspondence: <email>georges.debregeas@sorbonne-universite.fr</email>
</corresp><corresp id="CR2"><label>‡</label> Correspondence: <email>simona.cocco@phys.ens.fr</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>25</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>22</day><month>11</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Understanding how collective neuronal activity in the brain orchestrates behavior is a central question in integrative neuroscience. Addressing this question requires models that can offer a unified interpretation of multimodal data. In this study, we jointly examine video-recordings of zebrafish larvae freely exploring their environment and calcium imaging of the Anterior Rhombencephalic Turning Region (ARTR) circuit, which is known to control swimming orientation, recorded <italic>in vivo</italic> under tethered conditions. We show that both behavioral and neural data can be accurately modeled using a Hidden Markov Model (HMM) with three hidden states. In the context of behavior, the hidden states correspond to leftward, rightward, and forward swimming. The HMM robustly captures the key statistical features of the swimming motion, including bout-type persistence and its dependence on bath temperature, while also revealing inter-individual phenotypic variability. For neural data, the three states correspond to left- and right-lateral activation of the ARTR circuit, known to govern the selection of left vs. right reorientation, and a balanced state, which likely corresponds to the behavioral forward state. To further unify the two analysis, we exploit the generative nature of the HMM, using the neural sequences to generate synthetic trajectories whose statistical properties are similar to the behavioral data. Overall, this work demonstrates how state-space models can be used to link neuronal and behavioral data, providing insights into the mechanisms of self-generated action.</p></abstract><kwd-group><kwd>zebrafish</kwd><kwd>Hidden Markov Model</kwd><kwd>behavior</kwd><kwd>spontaneous neural activity</kwd><kwd>ARTR</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>I</label><title>Introduction</title><p id="P2">Animal behavior unfolds as a structured sequence of stereotyped motor actions, much like language. Understanding behavior thus requires identifying the vocabulary, <italic>i.e</italic>. the elementary behavioral units, and characterizing the corresponding grammar, <italic>i.e</italic>. their relative organization in time [<xref ref-type="bibr" rid="R1">1</xref>]. Uncovering this underlying structure is non-trivial. Over the last decade, numerous approaches have been proposed, building on the rapid development of data-driven computational methods. State-space models, in particular, appear to be well adapted, as they offer an unsupervised approach to sparse high-dimensional data into discrete states, while simultaneously unveiling their temporal structure. These include various implementations of Hidden Markov Models (HMMs) [<xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R5">5</xref>] and other statistical models [<xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R8">8</xref>].</p><p id="P3">Since behavior is driven by the brain activity, one expects the behavioral structure to be reflected in the spontaneous brain dynamics in the form of a sequence of discrete ”brain states” - defined as metastable patterns of activity [<xref ref-type="bibr" rid="R9">9</xref>]. Neural activity can, as behavioral data, be parsed to uncover neural states and their temporal sequences [<xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R12">12</xref>]. In general, however, behavioral or neuronal data are analyzed separately, as these experiments are typically conducted independently, limiting our ability to bridge the two processes. In contrast, a common modeling framework, when applied to both behavior and spontaneous neural activity, could help uncover a shared organizational structure linking self-generated neuronal dynamics and behavior.</p><p id="P4">Our model behavior is the spontaneous navigation of zebrafish larvae (see [<xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R13">13</xref>–<xref ref-type="bibr" rid="R15">15</xref>]), which consists of discrete swimming bouts lasting ∼ 100 ms and triggered at ∼ 1 - 2 Hz. In previous studies the categorization of bouts was carried out independently of the examination of their temporal organization. In Marques <italic>et al</italic>. [<xref ref-type="bibr" rid="R16">16</xref>], the authors used PCA-based automatic segmentation to distinguish 13 different bout types, a number that they found sufficient to encompass the entire behavioral repertoire of the animal, including hunting, escape, social behavior, etc. However, in more constrained conditions when the fish merely explore its environment [<xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R23">23</xref>], a simple 3-state categorization is sufficient to describe their trajectories. In this case, the bouts are labeled as either forward, left-turn or right-turn based on the value of bout-induced body reorientation. The selection of these various bout types depends on sensory cues, resulting in the animal’s capacity to ascend light [<xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R20">20</xref>] or temperature [<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R24">24</xref>–<xref ref-type="bibr" rid="R26">26</xref>] gradients.</p><p id="P5">Importantly, the neural circuit that controls the orientation of bouts has been identified as the anterior rhombencephalic turning region (ARTR), a bilaterally distributed circuit located in the anterior hindbrain. Using combined calcium imaging and motor nerve recordings, it was shown that the triggering of leftward and rightward bouts are correlated with increased activity on the corresponding side of the ARTR [<xref ref-type="bibr" rid="R18">18</xref>].</p><p id="P6">To characterize the behavioral and neural activities and their possible relationship, we hereafter re-analyze video recordings of freely swimming animals and ARTR recordings, performed at various water temperature, using Hidden Markov Models (HMM). First, we show that for the behavioral data, this approach provides an unbiased and therefore more consistent method of bout-type labeling compared to simple thresholding techniques as used in earlier studies. We further use the HMM inferred parameters to demonstrate and quantify inter-individual variability in exploratory kinematics. We then apply a similar 3-states HMM to the ARTR recordings performed in paralyzed tethered fish, leading to the generation of synthetic neuronal-based swimming sequences. Finally, we compare the statistical structure of these synthetic trajectories with real ones to assess the consistency of the results across both behavioral and neural data.</p></sec><sec id="S2" sec-type="results"><label>II</label><title>Results</title><sec id="S3"><label>A</label><title>Data</title><p id="P7">The behavioral data used in the present article comes from a publication that examined the kinematic of free exploration in zebrafish larvae [<xref ref-type="bibr" rid="R22">22</xref>]. The experimental design (<xref ref-type="fig" rid="F1">Fig.1a</xref>) enables recording the trajectories of multiple freely swimming larvae aged 5-7 days at temperatures of 18°C, 22°C, 26°C, 30°C, and 33°C. At each temperature, the trajectories of multiple fish are combined into a single dataset, and a set of kinematic parameters is extracted at each bout n, such as the angular change <italic>δθ<sub>n</sub></italic> in heading direction, the time elapsed since the previous bout and the traveled distance (see <xref ref-type="sec" rid="S19">Material and Methods sec. IV A</xref>). Water temperature was found to systematically impact the statistics of navigation, leading to qualitatively different trajectories as illustrated in <xref ref-type="fig" rid="F1">Figure 1b</xref>. As the temperature increases, trajectories tend to become more winding and erratic. We have also reanalyzed a second dataset of long-trajectories for 18 fish tracked individually for over two hours at 26° C, in order to assess inter-individual variability (see <xref ref-type="sec" rid="S19">Material and Methods sec. IV A</xref>).</p><p id="P8">The neural data comes from another publication in which the spontaneous activity of the <italic>Anterior Rhomben-cephalic Turning Region</italic> (ARTR) [<xref ref-type="bibr" rid="R27">27</xref>] (<xref ref-type="fig" rid="F1">Fig.1e</xref>) was recorded from 5-7 days old immobilized larvae expressing the calcium indicator GCaMP6f, using light-sheet functional imaging. Several neural recordings (3-10) for each one of the five temperatures (from 18°C to 33°C (<xref ref-type="fig" rid="F1">Fig.1b</xref>)) were analyzed. The fluorescence signal of each neuron was further deconvolved to estimate an approximate spike train (see <xref ref-type="sec" rid="S20">Material and Methods sec. IV B</xref>).</p></sec><sec id="S4"><label>B</label><title>Modeling of behavior</title><sec id="S5"><label>1</label><title>Markov Models</title><p id="P9">The distribution of reorientation angles after each bout, shown in <xref ref-type="fig" rid="F1">Figure 1d</xref>, appears to be trimodal, suggesting a classification of the bouts in 3 types: forward (<italic>F</italic>), left-turn (<italic>L</italic>) and right-turn (<italic>R</italic>). In practice, this categorization is generally carried out by thresholding the distribution of re-orientation angles. Denoting the state of swim bout <italic>n</italic> by <italic>s<sub>n</sub></italic> we have:</p><disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mtext> if </mml:mtext><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mtext> if </mml:mtext><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mtext>  if </mml:mtext><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula><p id="P10">The use of the same threshold (in absolute value) to detect left and right turns relies on the hypothesis that zebrafish larvae, as a group, have no preferred direction (<italic>a.k.a</italic>.. non-handedness). As the exact value of <italic>δθ</italic><sub>0</sub> has minimal qualitative impact on the results of the Markov Chains, we adopt the same value <italic>δθ</italic><sub>0</sub> = 10° as in [<xref ref-type="bibr" rid="R22">22</xref>]; notice that <italic>δθ</italic>0 is the same across all temperatures to avoid introducing ad hoc, temperature-dependent biases. An example of the classification of states along a swimming trajectory is presented in <xref ref-type="fig" rid="F2">Figure 2b</xref>.</p><p id="P11">Once the bout types are identified, we define a dynamical model for the trajectories … → <italic>s<sub>n–1</sub></italic> → <italic>s<sub>n</sub></italic> → <italic>s<sub>n+1</sub></italic> → … using a three-states Markov Chain (MC). Informally, the sequence of states (associated with the 3 different bout types) is described by the probabilistic automaton in <xref ref-type="supplementary-material" rid="SD1">Figure S3a</xref>. In this model, after each bout <italic>n</italic>, a new state <italic>s</italic><sub><italic>n</italic>+1</sub> is drawn randomly, conditioned only on <italic>s<sub>n</sub></italic> (and not on previous states). The transition probabilities between states, <italic>P</italic> (<italic>s</italic> = <italic>s<sub>n</sub></italic> → <italic>s′</italic> = <italic>s<sub>n</sub></italic>+1), are estimated by counting the numbers # of occurrences of the transitions s → s′ along the trajectories:</p><disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>#</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>#</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>#</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>#</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula><p id="P12">with <italic>s,s</italic>′ ∈ {F,L,R}. 0 The top right eigenvector of the 3 × 3 transition matrix gives access to the stationary probabilities <italic>P (s)</italic> of the 3 states. These probabilities are in excellent agreement with the frequencies of states estimated through direct counting (difference &lt; 0.003 across all bout types and temperatures).</p></sec><sec id="S6"><label>2</label><title>Hidden Markov Model</title><p id="P13">We then turn to an agnostic categorization method, where states are inferred rather than <italic>a priori</italic> assigned. To do so, we consider a three-states Hidden Markov Model (HMM), see <xref ref-type="supplementary-material" rid="SD1">Figure 2a</xref>. Unlike MC, HMM makes a clear distinction between the observations (here the reorientation angles <italic>δθ<sub>n</sub></italic> treated as ‘symbols’) and the states of the system (here <italic>s<sub>n</sub></italic>, which are not directly accessible from the knowledge of <italic>δθ<sub>n</sub></italic>, in contradistinction with the key assumption underlying MC). The HMM is defined by:
<list list-type="bullet" id="L1"><list-item><p id="P14">The transition probabilities <italic>P</italic> (<italic>s</italic> → <italic>s</italic>′) between the hidden states. We enforce the non-handedness by imposing that
<disp-formula id="FD3"><mml:math id="M3"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></list-item><list-item><p id="P15">This in turn ensures that steady state bout probability is left-right symmetric (<italic>P</italic>(<italic>L</italic>) = <italic>P</italic> (<italic>R</italic>)).</p></list-item><list-item><p id="P16">The emission probabilities, <italic>E</italic> (<italic>δθ</italic>|<italic>s</italic>), relate the observations <italic>δθ</italic> to the hidden states s. For the forward state, we choose normally distributed reorientation angle emission distributions, centered in zero: <italic>E</italic>(<italic>δθ</italic>|<italic>F</italic>) = <italic>𝒩</italic>(<italic>δθ</italic>;0, σ). For turn states, we use Gamma distributed reorientation angles, with a positive or negative sign according to whether the state is Left or Right: <italic>E</italic>(<italic>δθ</italic>|<italic>L</italic>) = Γ(+<italic>δθ</italic>; α, <italic>θ</italic>) and <italic>E</italic> (<italic>δθ</italic>|<italic>R</italic>) = Γ(-<italic>δθ</italic>; α, <italic>θ</italic>), constraining <italic>α</italic> &gt; 1. Again, we ensured non-handedness by enforcing the same parameters for the left and right emission distribution. See <xref ref-type="sec" rid="S21">Material and Methods sec. IV C</xref> for details about the validation of these emission distributions.</p></list-item><list-item><p id="P17">A probability distribution for the initial state at the beginning of a trajectory.</p></list-item></list></p><p id="P18">We train HMM models for each dataset using the Baum-Welch algorithm, with a custom Julia [<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R29">29</xref>] implementation (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZebrafishHMM2023/ZebrafishHMM2023.jl/tree/bioRxiv">https://github.com/ZebrafishHMM2023/ZebrafishHMM2023.jl/tree/bioRxiv</ext-link>).</p></sec></sec><sec id="S7"><label>C</label><title>State classification and behavioral persistence</title><sec id="S8"><label>1</label><title>Statistics of bout states</title><p id="P19">Since the Markov Chain inferred from thresholded data (MC, <xref ref-type="supplementary-material" rid="SD1">Fig.S3a</xref>) and the Hidden Markov Model (HMM, <xref ref-type="fig" rid="F2">Fig.2a</xref>) share the same internal behavioral states, we can directly compare these two models and thus examine the impact of the labeling methods.</p><p id="P20">As illustrated with an example trajectory at 22°C in <xref ref-type="fig" rid="F2">Figure 2b</xref>, MC and HMM labeling can differ significantly. MC-inferred sequences often exhibit multiple alternations between Forwards and Turns when the bouts reorientation angles are near the threshold, while for the same sequence, the HMM tends to consistently label these bouts as Turns. These differences result in a reclassification of approximately 60% of Forward bouts into Turning bouts at 22°C (<xref ref-type="supplementary-material" rid="SD1">Fig.S3e</xref>).</p><p id="P21">The HMM yields a relatively modest dependence of bout-type usage on temperature (see <xref ref-type="supplementary-material" rid="SD1">Fig.S3b</xref>). In contrast, the hard-threshold classification method used in MC lead to a systematic and pronounced increase in the fraction of turning bouts with rising temperature. This strong temperature dependence, previously reported in Le Goc et al. [<xref ref-type="bibr" rid="R22">22</xref>], may have thus been overestimated, as it partly reflects the ad-hoc assumption of a fixed (temperature-independent) threshold <italic>δθ</italic><sub>0</sub>. Conversely, the HMM approach infers a gradual widening of the forward bouts angular distribution with increasing temperature that effectively corresponds to an increase in the angular threshold (see <xref ref-type="supplementary-material" rid="SD1">Fig.S2c-e</xref>).</p></sec><sec id="S9"><label>2</label><title>Bout streaks and persistence</title><p id="P22">We further assessed how bout-type persistence, defined as the tendency to execute similar bouts in succession, depends on the chosen classification model. We start by describing trajectories as a series of streaks of similar bouts (forward, leftward or rightward), and then characterize the streak length distribution. For all bout types and models, the probability of observing a streak of <italic>ℓ</italic> consecutive bouts of the same type decays exponentially, <italic>P</italic> (<italic>ℓ</italic>) <italic>∝</italic> <italic>e</italic><sup>-<italic>ℓ</italic>/<italic>ℓ</italic><sub>1</sub></sup>, with <italic>ℓ</italic><sub>1</sub> defining the characteristic streak length (<xref ref-type="fig" rid="F2">Fig.2c</xref>). For turning bouts, we found <inline-formula><mml:math id="M4"><mml:msubsup><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1.4</mml:mn></mml:math></inline-formula> bouts while <inline-formula><mml:math id="M5"><mml:msubsup><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0.9</mml:mn></mml:math></inline-formula> bouts at 22°C. Compared to MC, HMM-based labeling thus yield much longer turning streaks. In contrast, we find no significant difference in characteristic forward-streak length between HMM and MC. As temperature increases, we observe for both models that the characteristic streak length decreases (particularly for forward bouts, see <xref ref-type="fig" rid="F1">Fig.1b</xref>).</p><p id="P23">Within the Markov or Hidden Markov Model frameworks, the average length <italic>ℓ</italic><sub>1</sub>(<italic>s</italic>) of a streak of bouts of type <italic>s</italic> is related to the probability <italic>P</italic>(<italic>s</italic> → <italic>s</italic>) of remaining in the same state through the simple relation <italic>ℓ</italic><sub>1</sub>(<italic>s</italic>) = −1/ ln <italic>P</italic> (<italic>s</italic> → <italic>s</italic>). To distinguish the effects on bout-type persistence due to the presence of memory from the mere consequences of single-state frequencies, we introduce a null model, in which the transition probabilities are simply given by these frequencies, <italic>i.e.</italic> <italic>P</italic> (<italic>s</italic> → <italic>s</italic>′) = <italic>P</italic> (<italic>s</italic>′). In this null model without any memory, the average length of type-<italic>s</italic> bouts is simply <italic>ℓ</italic>0(<italic>s</italic>) = −1/ ln <italic>P</italic>(<italic>s</italic>). The ratio <italic>ℓ</italic><sub>1</sub>(<italic>s</italic>)/<italic>ℓ</italic>0(<italic>s</italic>) is an estimator of the (relative) contribution of behavioral memory to bout-type persistence.</p><p id="P24">Results for this memory-induced persistence are shown in <xref ref-type="fig" rid="F2">Figure 2d</xref> for the Markov (MC) and Hidden Markov (HMM) Models. The MC and HMM methods yield comparable outcomes for turning bouts at low temperature. However, HMM-based analysis further reveals a persistence for forward bouts at lower temperatures (<xref ref-type="fig" rid="F2">Fig.2d</xref>), while this effect is absent in the MC model. Here again, this absence of forward persistence, previously reported in Karpenko et al. [<xref ref-type="bibr" rid="R20">20</xref>], is likely due to the mis-labeling associated with the hard-threshold method. Interestingly, such persistence effects vanish at higher temperatures, where the transition matrix becomes uniform (<xref ref-type="supplementary-material" rid="SD1">Fig.S3c,d</xref>), and all bouts become equiprobable (<italic>P</italic>(<italic>F</italic>) ≈ <italic>P</italic>(<italic>L</italic>) ≈ <italic>P</italic>(<italic>R</italic>)). One thus expect more erratic trajectories at higher temperatures, which is consistent with our observations (see <xref ref-type="fig" rid="F1">Fig.1b</xref>).</p></sec><sec id="S10"><label>3</label><title>Consistency of the MC and HMM descriptions of behavior</title><p id="P25">Taken together, the results above suggest that the Hidden Markov Model better captures persistence in reorientation by labeling bouts with small reorientation angles based on context. This leads to a more flexible and thus stable classification than the hard-thresholding method. However, given the absence of a ground truth, it remains unclear whether the labeling produced by the Hidden Markov Models is more accurate than the one produced by the standard threshold-based approaches.</p><p id="P26">One way to address this question is to examine to what extent each of these methods are self-consistent, <italic>i.e.</italic> guarantees that the inferred labeled sequences are truly markovian such that the bout type at a given time only depends on the type of the preceding bout. It has been previously noted that the hard-thresholding methods lead to significant non-markovianity. In particular, in a transition <italic>T</italic><sub>1</sub> → <italic>F</italic> → <italic>T</italic><sub>2</sub> with <italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub> ∈ {<italic>L, R</italic>}, the two turning bouts tend to have the same orientation (<italic>T</italic><sub>1</sub> = <italic>T</italic><sub>2</sub>). This means that the memory of orientation T<sub>1</sub> is maintained during the forward bout, in violation of the Markovian assumption. This observation lead to propose a 4-state Markov system comprising two independent Markov chains, independently controlling the forward-turn bout transitions, and directional left-right bout transitions (see <xref ref-type="supplementary-material" rid="SD1">Fig.S4b</xref> for a diagram of this 4-state model) [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R22">22</xref>].</p><p id="P27">Given that our 3-state Hidden Markov Model (HMM) re-labels numerous Forward bouts as Turn bouts, we ask whether this new classification might alleviate this non-Markovianity issue, such that the ad hoc 4-state model might no longer be needed. We thus propose a new test of Markovian violation specifically designed for our use case, that we apply to both the HMM and MC models.</p><p id="P28">We introduce the <italic>stubbornness factor</italic> <italic>f<sub>q</sub></italic> to empirically assess the tendency of larvae to retain their orientation after a sequence of q intermediary forward bouts (<xref ref-type="supplementary-material" rid="SD1">Fig.S4b</xref>, <xref ref-type="sec" rid="S22">Materials and Methods sec. IV D</xref>):
<disp-formula id="FD4"><label>(3)</label><mml:math id="M6"><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula>
with <inline-formula><mml:math id="M7"><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>}</mml:mo><mml:mtext> and </mml:mtext><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mo>⋯</mml:mo><mml:mo>→</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mi>q</mml:mi></mml:munder><mml:mtext>. </mml:mtext></mml:math></inline-formula></p><p id="P29">Owing to the loss of orientational memory after a forward bout, a non-handed 3-state Markovian model should have <italic>f<sub>q</sub></italic> = 1 for <italic>q</italic> ≥ 1 (<xref ref-type="sec" rid="S23">Materials and Methods sec. IV E</xref>). On the other hand, <italic>f<sub>q</sub></italic>=0 is a measurement of directional persistence during uninterrupted sequences of turning bouts.</p><p id="P30">We found that most of the memory effects captured by the HMM occur at <italic>q</italic> = 0, and that the <italic>stubbornness</italic> reaches <italic>f<sub>q</sub></italic> ≈ 1 for <italic>q</italic> ≥ 1, suggesting that the HMM-inferred bout sequences are quasi-markovian. In comparison, and for lower temperatures, the thresholded MC classification displays lower persistence at <italic>q</italic> = 0 but higher <italic>stubbornness</italic> at <italic>q</italic> = 1 as seen on <xref ref-type="fig" rid="F2">Figure 2e-f</xref> (and less significantly at <italic>q</italic> = 2, see <xref ref-type="supplementary-material" rid="SD1">Fig.S4d</xref>). This suggests that the thresholded labeling leads to Markov violation primarily due to the mislabeling of turn bouts as forward bouts during turning streaks, as anticipated in the previous section and illustrated on <xref ref-type="fig" rid="F2">Figure 2b</xref>. As this <italic>stubbornness</italic> is mostly significant at <italic>q</italic> = 1, we expect that most mislabelings are one-off errors.</p><p id="P31">In summary, previous works using a ad hoc threshold to classify bouts had dismissed 3-states Markov models because the resulting sequences were non-markovian. We found that by using an unsupervised method to simultaneously label the data and infer a Markov Model, we could unveiled previously underestimated memory effects in zebrafish reorientation statistics. Our results suggest that the apparent non-markovianity reported in previous studies was mainly caused by the mislabeling of turning bouts as forward bouts during sequences of consecutive turns. The HMM seems to be a clear improvement, identifying quasi-Markovian 3-state sequences and providing a more robust representation of the swimming dynamics.</p></sec></sec><sec id="S11"><label>D</label><title>Behavioral phenotyping from long individual fish trajectories</title><p id="P32">As HMM provides an unbiased quantification of the behavior, we now ask whether the approach is accurate enough to detect behavioral differences between specimen (inter-individual variability) and whether it can enable the unambiguous identification of each animal.</p><p id="P33">In the preceding sections, the dataset used to infer the models comprised trajectories from multiple fish, as the different individuals swimming together during a given assay could not be distinguished. To address the question of individuality, we used additional experiments reported in Le Goc <italic>et al</italic>. [<xref ref-type="bibr" rid="R22">22</xref>], in which individual fish were tracked at 26°C (see <xref ref-type="sec" rid="S19">Materials and Methods IV A</xref>). A total of 18 fish were recorded for over 2 hours.</p><p id="P34">We first split the 2h-long recorded sequence of each individual fish into smaller periods (chunks) of ≈ 12 minutes each, and trained an HMM on each of these chunks (see diagram in <xref ref-type="fig" rid="F3">Figure 3a-b</xref>). For each fish, the parameters of these HMMs exhibit significant variability (as shown by the vertical error bars in <xref ref-type="fig" rid="F3">Figure 3c</xref>). This variability between the different chunks reflects both intra-individual (temporal) variability and, to a lesser extent, inference uncertainty due to the limited sampling of the HMM (see <xref ref-type="supplementary-material" rid="SD1">Fig.S5</xref>). We then also trained a single HMM on the entire dataset of a single fish (the “global” HMM). <xref ref-type="fig" rid="F3">Figure 3c</xref> compares selected parameters of the global HMM for each fish, against the average parameters over several HMMs trained on the chunk trajectories (see <xref ref-type="supplementary-material" rid="SD1">Fig.S5</xref> for all parameters). There is a clear trend between the global HMM and the average behavior of the chunk HMMs. Therefore, although a fish exhibits variability during a long sequence of bouts, the variability between distinct fish is larger.</p><p id="P35">These results suggest that the HMM models can be used to distinguish different fish from observations of their bout sequences. To test this hypothesis, we split the trajectories of each fish into a training and a withheld test set. After training the HMM on the train set for a particular fish, we computed the likelihood of all fish trajectories in the test set, and compared them. For 14 out of the 18 fish, the test set that yield the maximum likelihood rightly identifies the fish used to train the HMM (<xref ref-type="fig" rid="F3">Fig.3d</xref>). This finding suggests that the HMM captures behavioral parameters which are distinctive enough to discriminate between different fish. Given the large variability exhibited by a single fish, one expects this discriminative ability to increase with the duration of the training sequences. To quantify this, we further evaluated the likelihoods of subsets of the test fish trajectories, and recorded the number of times that the maximum likelihood HMM corresponded to the correct fish (<xref ref-type="fig" rid="F3">Figure 3e</xref>). Even when withholding 80% of the sequence, we were able to correctly identify 10 out of the 18 fish. These results suggest that individual fish exhibit variable but distinctive behavior which can be captured by the HMM.</p></sec><sec id="S12"><label>E</label><title>Modeling of neural data</title><p id="P36">The selection of turning bouts orientation in zebrafish is known to be controlled by a small bilaterally distributed circuit in the anterior hindbrain, called <italic>Anterior Rhombencephalic Turning Region</italic> (ARTR). This circuit displays self-sustained alternating activity between its left- and right-lateral sub-population, with a period of the order of tens of seconds (<xref ref-type="fig" rid="F1">Fig.1e</xref>). The animal tends to execute left turns when the left ARTR is active while the right ARTR is inactive (and vice versa for right turns) [<xref ref-type="bibr" rid="R18">18</xref>].</p><p id="P37">In contrast, no specific circuit has yet been identified for the selection of turn vs forward bouts. The hypothesis that two distinct circuits are involved in bout-type selection is consistent with the 4 states Markovian model of navigation, in which two independent Markov chains drive the two selection processes. However, the 3-states Markovian model supported by the HMM analysis suggests that the same circuit (ARTR) could drive the selection of all 3 bout-types.</p><p id="P38">In order to test this hypothesis, we re-analyzed the ARTR recordings reported in Wolf <italic>et al</italic>. [<xref ref-type="bibr" rid="R27">27</xref>] using a 3-state HMM (<xref ref-type="fig" rid="F4">Fig.4a</xref>). We posit an independent neural model for the activity of the N recorded neurons, yielding, for each state, the emission probability:
<disp-formula id="FD5"><label>(4)</label><mml:math id="M8"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle></mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula>
where (<italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub>,… <italic>σ</italic><sub>N</sub>) is a neuronal configuration, <italic>s</italic> is the hidden state, and <inline-formula><mml:math id="M9"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> is the local field representing the effective excitability of neuron <italic>i</italic> in state <italic>s</italic>. The model thus includes 3 × <italic>N</italic> parameters <inline-formula><mml:math id="M10"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula>, associated 0 to each neuron and each hidden states. Notice that for the neural HMM, the non-handedness of the behavioral HMM is not enforced.</p><p id="P39">The distribution of fields <inline-formula><mml:math id="M11"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> for the 3 hidden states, shown in <xref ref-type="fig" rid="F4">Fig.4a</xref>, are used to assign labels to the three states (see <xref ref-type="sec" rid="S24">Materials and Methods IV F</xref>). Consistent with our current understanding of the ARTR function for turn selection, the state with large values of the fields on the left and smaller values of the fields on the contralateral side is labeled ”left” (and vice versa for ”right”). The third state exhibits similar distributions of fields for neurons on the left and right side of the ARTR, and is labeled forward in analogy with behavior. The ARTR activity is thus modeled as a sequence of left-right-forward states.</p><p id="P40">With this classification, the forward state corresponds to a low mean neuronal activity of both the left (<italic>m<sub>L</sub></italic>) and right (<italic>m<sub>R</sub></italic>) sides of the ARTR, while turning states are associated with large activity on the ipsilateral side of the ARTR (left state : <italic>m<sub>L</sub></italic> &gt; <italic>m<sub>R</sub></italic>, right state : <italic>m<sub>L</sub></italic> &lt; <italic>m<sub>R</sub></italic>, see <xref ref-type="fig" rid="F4">Fig.4b-d</xref>).</p><p id="P41">This model accurately captures the mean activity of each neuron (<xref ref-type="fig" rid="F4">Fig.4f</xref>), as well as the pairwise correlations between contralateral neurons. However, ipsilateral pairwise correlations are not as well reproduced, showing lower covariance in the generated data (<xref ref-type="fig" rid="F4">Fig.4f</xref>). This mismatch presumably comes from the fact that the activities of neurons within a state are uncorrelated in our emission probabilities, while recurrent interactions in the ARTR circuit produce correlations. These would be better modeled with emission probabilities including effective interactions between neurons [<xref ref-type="bibr" rid="R27">27</xref>].</p></sec><sec id="S13"><label>F</label><title>Comparison of Behavior and Neuronal HMMs</title><p id="P42">In the preceding sections, we demonstrated that both the reorientation behavior and the neuronal activity of the <italic>Anterior Rhombencephalic Turning Region</italic> (ARTR) can be effectively modeled using three-state Hidden Markov Models (HMMs). However, it remains unclear whether the three states identified in the Behavioral HMM (B-HMM) directly correspond to those inferred in the Neuronal HMM (N-HMM).</p><p id="P43">Unfortunately, there is currently no publicly available dataset offering simultaneous recordings of freely swimming larvae kinematics and neuronal activity, which would enable direct comparison of B-HMM and N-HMM states for individual bouts. Current research addressing this question largely relies on experimental paradigms where larvae are either paralyzed with electrophysiological recording of motor nerve signals (fictive swimming preparations)[<xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R31">31</xref>], or head-embedded with a free-moving tail (head tethered preparations)[<xref ref-type="bibr" rid="R32">32</xref>–<xref ref-type="bibr" rid="R35">35</xref>]. In fictively swimming preparations, whilst the classification of left-vs-right bouts is feasible based on the asymmetric nature of the motor command, such experiments lack the level of precision required to discriminate forward-vs-turning bouts [<xref ref-type="bibr" rid="R18">18</xref>]. On the other hand, head tethered preparations allow forward-left-right bout classification [<xref ref-type="bibr" rid="R32">32</xref>, <xref ref-type="bibr" rid="R34">34</xref>], but typically rely on visual stimuli to elicit behavior [<xref ref-type="bibr" rid="R32">32</xref>–<xref ref-type="bibr" rid="R35">35</xref>] as the spontaneous sequence of bouts is strongly disrupted in comparison with freely swimming contexts [<xref ref-type="bibr" rid="R36">36</xref>].</p><p id="P44">We hereafter propose to circumvent these experimental challenges by comparing the statistical structures of the reorientation sequences inferred from the two datasets presented in sections II A and II E. The transition probabilities <italic>P</italic> (<italic>s<sub>n</sub></italic> → <italic>s<sub>n+1</sub></italic>) obtained from B-HMM and N-HMM at all recorded temperatures are shown in <xref ref-type="fig" rid="F5">Fig.5b</xref>. Comparison of these transition rates require to first correct them for differences in sampling rates. Indeed, neural transition rates are computed from neuronal recordings performed at ∼ 6Hz (depending on the dataset, see Materials and Methods IV B), while for behavior, the sequences are divided into swim bouts triggered at an average rate of ∼ 1Hz, depending on the temperature.</p><p id="P45">To bridge the gap between neuronal and behavioral datasets, one needs to estimate how the behavior is subsampled from the neuronal activity. To do so, we computed the distribution of sojourn times Δ<italic>t<sub>s</sub></italic> of all three states in both B-HMM and N-HMM, where Δ<italic>t<sub>s</sub></italic> = <italic>t<sub>k</sub></italic> - <italic>t</italic><sub>1</sub> is the duration of a sequence (<italic>s</italic><sub>1</sub>, …, <italic>s<sub>k</sub></italic>) of <italic>k</italic> consecutive states <italic>s</italic> observed at times (<italic>t</italic><sub>1</sub>, …, <italic>t<sub>k</sub></italic>). We found the neuronal sojourn times to be significantly longer than the behavioral so journ times (<xref ref-type="fig" rid="F5">Fig.5a</xref>). The optimal temporal scaling factor <italic>f<sub>N/B</sub></italic> for which the distribution of neuronal so journ times matches the distribution of behavioral sojourn times (see <xref ref-type="sec" rid="S25">Materials and Methods IV G</xref>) was <italic>f<sub>N/B</sub></italic> ≈ 0.44. Interestingly, this value appears to be consistent with findings from Dunn <italic>et al</italic>. [<xref ref-type="bibr" rid="R18">18</xref>], which reported the mean interbout interval for fictive swimming to be 0.41 times slower than for freely swimming.</p><p id="P46">Using this temporal re-scaling factor, we find that the transition probabilities <italic>P</italic> (<italic>s<sub>n</sub></italic> → <italic>s<sub>n+1</sub></italic>) for behavior and ARTR models are similar (RMSE = 0.1, see <xref ref-type="fig" rid="F5">Fig.5b</xref>), indicating that the behavioral and neuronal state sequences share similar underlying structures. This is remarkable as the number and meaning of the neuronal internal states were not a priori fixed, but entirely assigned by N-HMM after training.</p><p id="P47">This result supports our hypothesis that the ARTR not only governs the selection between rightward and leftward turning bouts, but also controls the bout-type selection, forward vs turn. To test this claim further, we analyzed in more detail the statistics of trajectories in the bout space inferred from the ARTR dynamics and from behavioral data. We specifically examined the bout sequences leading to a change in orientation, such as transitions from <italic>L</italic> to <italic>R</italic> and vice-versa. Such orientational switches can be either direct, e.g. <italic>L</italic> → <italic>R</italic>, or may include an intermediate forward bout, <italic>L</italic> → <italic>F</italic> → <italic>R</italic> (<xref ref-type="fig" rid="F5">Fig.5c</xref>). Using the ARTR signal, we found that the second path is strongly favored as evidenced by the the fact that <inline-formula><mml:math id="M12"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. A comparable value of this ratio is observed in the behavioral data (<xref ref-type="fig" rid="F5">Fig.5d</xref>), indicating that fish indeed tend to execute a forward bout when changing orientation. This statistical bias would be difficult to understand under the standard model that posit the existence of independent neural circuits governing orientation and bout-type selection, respectively. In contrast, in our model, it emerges naturally from the the phase space structure of the ARTR dynamics as shown in <xref ref-type="fig" rid="F4">Figure 4c</xref> and <xref ref-type="fig" rid="F5">Figure 5c</xref>. The L-Shaped distribution of {<italic>m<sub>l</sub></italic>, <italic>m<sub>R</sub></italic>} constrains the Left-to-right (or Right-to-Left) trajectories to pass through a symmetrical, low activity state, thus favoring intermediate forward bouts.</p></sec><sec id="S14"><label>G</label><title>Generation of synthetic behavior with the neural model</title><p id="P48">Until now, we compared neuronal and behavioral data by examining only the short-scale statistical structures of the HMM-inferred state sequences. We now wish to test whether it is possible to compare full trajectories by leveraging the generative nature of the HMM. Specifically, we use the N-HMM model to generate long synthetic trajectories and compare their statistics with those of freely swimming fish. This approach allows us to assess whether the N-HMM, when combined with appropriate scaling and behavioral parameters, can reproduce the complex statistical properties of exploration at various temperatures.</p><sec id="S15"><label>1</label><title>Generation of synthetic neural and reorientation trajectories</title><p id="P49">As stochastic processes, Hidden Markov Models (HMMs) can be sampled to generate new sequences of internal states. Following the previous section II F, we hypothesize that the internal states of a Neural HMM (N-HMM) match the behavioral internal states, after proper temporal rescaling. Therefore, we expect that it should be possible to generate artificial swim trajectories from the N-HMMs.</p><p id="P50">Using the N-HMMs associated to individual fish recordings, we started by generating synthetic temporal sequences of neural states <inline-formula><mml:math id="M13"><mml:msubsup><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>. We then sampled the behavioral distribution of inter-bout intervals <italic>δt<sub>n</sub></italic>, rescaled by the scaling factor <italic>f<sub>N/B</sub></italic> ≈ 0.44 obtained in the previous section II F. This simulates a stochastic bout-initiation process with the correct temporal characteristics, yielding synthetic sequences of bout internal states <italic>b<sub>n</sub></italic> for the behavior. For each state, we then sample the emission probability <italic>E</italic>(<italic>δθ<sub>n</sub></italic>|<italic>b<sub>n</sub></italic>) associated to the Behavioral HMM (B-HMM) inferred from all fish data to get a realization of the reorientation angle <italic>δ</italic><italic>θ<sub>n</sub></italic> (<xref ref-type="fig" rid="F6">Fig. 6d</xref>). As expected, the distribution of these angles is in very good agreement with the ones observed in the behavioral data (<xref ref-type="fig" rid="F6">Fig. 6a</xref>).</p><p id="P51">We further characterize the trajectories using the Mean Square Reorientation (MSR) after <italic>q</italic> bouts:
<disp-formula id="FD6"><label>(5)</label><mml:math id="M14"><mml:mtext>MSR</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math></disp-formula>
where the average is taken across all times and all trajectories.</p><p id="P52"><xref ref-type="fig" rid="F6">Figure 6b</xref> shows the values of M<italic><sub>q</sub></italic> obtained from N-HMM-generated trajectories at different temperatures (see <xref ref-type="supplementary-material" rid="SD1">Fig.S7</xref> for the remaining temperatures), as well as the MSR directly obtained from multiple-fish trajectories and long single-fish trajectories (only at 26°C).</p><p id="P53">We first notice that long individual fish trajectories at 26°C display large variability in MSR(q) values, compatible with the presence of fish-to-fish variability. This variability is washed out for the multiple-fish dataset (since individual trajectories are combined) providing a averaged MSR(<italic><sub>q</sub></italic>) for each temperature. Interestingly, the MSR for the long sequences of individual animals significantly differ from the MSR obtained from multiple-fish trajectories. This could be due to differences in experimental conditions, and in particular the effects of collective vs. isolated navigation [<xref ref-type="bibr" rid="R22">22</xref>].</p><p id="P54">N-HMM-generated trajectories have a MSR distribution compatible and encompassing the behavioral data in their variability. Such large variability is expected from the large fluctuations in neural brain states. Some trajectories generated with N-HMM show anomalously large angular persistence (see <xref ref-type="supplementary-material" rid="SD1">Fig.S7a</xref>), which may correspond to brain states where the <italic>Anterior Rhomben-cephalic Turning Region</italic> (ARTR) displays no left-right alternating behavior. This is expected, as the N-HMMs were established from spontaneous activity recordings of immobilized fish which were not constrained to swim-like behaviors. In Fig. 6c, we summarized and compared the results for the Mean Square Reorientation after 10 bouts, MSR(<italic>q</italic> = 10), for all temperatures. We found, consistently across temperatures, that the MSR of behavioral data are comprised within the one-standard-deviation confidence interval of N-HMM-generated trajectories.</p><p id="P55">As we show in the <xref ref-type="supplementary-material" rid="SD1">Appendix 1</xref>, the MSR of HMM-generated trajectories can be decomposed as the sum of a purely diffusive contribution, associated to the variance of bout angles, and of terms arising from time-correlations in bout type selection along a trajectory (see <xref ref-type="supplementary-material" rid="SD1">Eq. (A.28)</xref>). The increase of bout-angle variance with temperature is sufficient to explain the increasing trend of the mean MSR with temperature observed in <xref ref-type="fig" rid="F6">Figure 6c</xref> (see <xref ref-type="supplementary-material" rid="SD1">Fig.S7</xref>).</p></sec><sec id="S16"><label>2</label><title>Generation of synthetic 2D trajectories</title><p id="P56">For the sake of completeness, we also used the N-HMM model to generate full synthetic 2D trajectories. To do so, for each bout state identified with the procedure reported above, we sampled an inter-bout interval duration <italic>δt<sub>n</sub></italic> and traveled distance <italic>d<sub>n</sub></italic> from their experimental distributions. We then reconstructed the coordinates of the virtual fish after <italic>k</italic> bouts, (<italic>x<sub>k</sub>, y<sub>k</sub></italic>), through <disp-formula id="FD7"><label>(6)</label><mml:math id="M15"><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M16"><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the orientation angle of the fish at bout <italic>i</italic>, constructed as the cumulative sum of reorientation angles at previous bouts. An example trajectory is shown in <xref ref-type="fig" rid="F6">Fig. 6g</xref>, and is qualitatively similar to the experimental counterpart recorded at the same temperature.</p><p id="P57">For comparison, we show synthetic trajectories generated from behavioral HMM. In practice, we expanded on the B-HMM introduced in <xref ref-type="sec" rid="S6">section II B 2</xref> by adding two new emission distributions corresponding to <italic>δt<sub>n</sub></italic> and <italic>d<sub>n</sub></italic>. As done previously, the HMMs were first trained only on the re-orientation angles <italic>δθ<sub>n</sub></italic>, before learning the emission distributions for <italic>δt<sub>n</sub></italic> and <italic>d<sub>n</sub></italic>. We then plot the corresponding trajectories using <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref>, which are qualitatively similar to the N-HMM-generated ones, as illustrated by an example in <xref ref-type="fig" rid="F6">Fig.6f</xref>. The similarity is quantified by the comparison of the distributions of bout angles, inter-bout duration intervals and traveled distances, see <xref ref-type="fig" rid="F6">Fig.6f</xref>.</p><p id="P58">We report in F<xref ref-type="supplementary-material" rid="SD1">igure S7e-h</xref>, the outcome of an intermediate generative model, in which 2D swim trajectories are generated from experimental neural recordings. This is done by first identifying neural states from the recordings using the Viterbi algorithm, emiting inter-bout intervals using the same procedure as described above, and then feeding the resulting state sequences through the B-HMM.</p></sec></sec></sec><sec id="S17" sec-type="Discussion"><label>III</label><title>Discussion</title><p id="P59">With the advancement of video-tracking and brain recording methods, behavioral neuroscience has changed radically in the last decade. It is now possible to study in great details animal behavior in unconstrained naturalistic conditions [<xref ref-type="bibr" rid="R37">37</xref>–<xref ref-type="bibr" rid="R39">39</xref>], while new recording methods give access to extended circuit activity encompassing several brain regions. Such experiments produce vast amounts of high-dimensional data, requiring automated yet robust and interpretable analysis methods.</p><p id="P60">An essential task is the identification of behavioral or neural states from the segmentation of the recorded time series, in order to extract low-dimensional representations that are easier to interpret. However, no definitive procedure exists for selecting the optimal number of states or for defining valid labeling criteria. This choice typically depends on available observables and involves a compromise between interpretability and accuracy of representation.</p><p id="P61">In our case, the difficulty stems from three main factors: (i) the dependence of swim bout kinematics with bath temperature, (ii) the inter-individual variability, and (iii) the overlapping distributions of reorientation angles for distinct bout types, in particular at low temperatures. Because they can accommodate such overlaps while taking into account the temporal regularities in the bout sequences, Hidden Markov Models (HMMs) are ideally suited for such a task. They are easily interpretable as the dynamics between the different internal states is described by a Markovian process. This makes HMM a powerful alternative to deep-learning-based methods, whose predictive power comes at the cost of interpretability.</p><p id="P62">In this study, we successfully applied a three-state HMM to parse behavioral and neural time series associated with exploratory dynamics. We showed that for behavioral data, HMM provided a less biased and more consistent method for bout-type labeling compared to standard threshold-based Markov Chain (MC) methods used in earlier studies.</p><p id="P63">This robustness proved essential as we investigated the effect of bath temperature on navigation. Zebrafish being cold-blooded animals, the water temperature is expected to directly affect muscle efficiency, leading to a systematic increase in the amplitude of reorientation elicited by bouts as temperature rises. When using hard-threshold-based MC methods, this may lead to a systematic but artifactual increase in the fraction of bouts labeled as turns with temperature. With HMM, this physiological effect of temperature is naturally accounted for through an adaptive adjustment of the effective threshold angle between turn and forward bouts. With this unbiased labeling, we found that the fractions of forward and turn bouts were only weakly dependent on temperature, in contrast with previously published analysis [<xref ref-type="bibr" rid="R22">22</xref>]. The primary effect of temperature of rising temperature is to progressively decrease bout-type persistence, i.e. the tendency of the animal to chain similar bouts. Interestingly, we found that all three bout types, and not just turns as previously reported, exhibit comparable persistence.</p><p id="P64">HMMs also demonstrated remarkable sensitivity to individual phenotypic variability. Inter- and intraindividual variability are ubiquitous traits of animal behavior [<xref ref-type="bibr" rid="R40">40</xref>, <xref ref-type="bibr" rid="R41">41</xref>] and are necessary to ensure a trade-off between flexibility and adaptability to changing environmental demands and robustness in neural development [<xref ref-type="bibr" rid="R42">42</xref>, <xref ref-type="bibr" rid="R43">43</xref>]. In Le Goc <italic>et al</italic>. [<xref ref-type="bibr" rid="R22">22</xref>], inter-individual differences were demonstrated on the same dataset using multiple kinematic parameters (including inter-bout interval, forward travel distance or reorientation amplitude). In contrast, our study shows that HMM can identify individual fish solely based on the dynamics of bout-type sequences. Moreover, HMM provides explicit likelihood evaluation for bout sequences for various individual-specific models, providing a quantitative measure of phenotypic proximity between animals or across time.</p><p id="P65">Since our approach is based on gait phenotyping and is independent of image features, it is compatible with low-resolution videos (in which only the animal’s position and orientation can be accessed) while still keeping versatility, reliability, and fast execution. This opens new opportunities for studying phenotypic variation in swimming behavior, potentially uncovering subtle effects on behavior of genetic, developmental, or environmental cues. This ability to precisely capture behavioral variability might also prove fruitful in order to explore the neural basis of individuality.</p><p id="P66">The fact that the fish directional dynamics can be-described by a three-state Markovian sequence, suggests that bout-type selection is likely governed by a single circuit, with the ARTR being the most plausible candidate. Since its discovery in 2012 [<xref ref-type="bibr" rid="R30">30</xref>], the ARTR has been viewed as a direction-selection hub, controlling lateralized behaviors such as tail flick and ocular saccade orientation [<xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R44">44</xref>]. It also responds to lateralized visual stimuli, including binocular contrast and whole-field lateral motion [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R44">44</xref>].</p><p id="P67">In the present study, we showed that a three states HMM can accurately describe ARTR neuronal data, and that this model is structurally and temporally similar to behaviorally-trained HMMs. This result suggests that the ARTR may also govern forward bout selection, unifying the control of all directional bout types within a single circuit. This interpretation is reinforced by the generation of synthetic, neuronally driven swimming sequences that closely matched the statistics of observed trajectories.</p><p id="P68">Bout-type persistence, as observed in behavioral assays, is mirrored in the slow sequential exploration of the three hidden states identified in neural recordings of
the ARTR. Although the HMM enables the identification of these neuronal states, they provide no interpretation of how they emerge from interactions among the ARTR neuronal population. In fact, our implementation of HMM assumes the activity of neurons to be independent of each other when conditioned to a state.</p><p id="P69">In a recent study, we trained data-driven graphical models (Ising model) on ARTR activity sequences [<xref ref-type="bibr" rid="R27">27</xref>]. The Ising model uses activity patterns to learn the interactions between neurons but, unlike HMM, it ignores any temporal information in the data. Interestingly, the inferred Ising models tended to display three metastable states, two with high activity on either side and one ”equilibrated” state with intermediate, balanced activity on both sides, consistent with the three hidden states found with HMM. This convergence underlines the compplementary strengths of state-space and energy-based models in elucidating neural dynamics. While the former might enable capturing the temporal structure in collective neural activity, the latter offer insights into the underlying network interactions driving these states, and how metastability emerges within neural populations.</p><p id="P70">The exact mechanism through which the ARTR controls bout selection remains unclear. However, our findings suggest that ARTR subpopulations (right and left) might inhibit contraversive bouts (<italic>i.e.</italic> when the left side is active, it suppresses rightward turns, favoring leftward swim). In the equilibrated state, both inhibitory signals suppress turn bouts, leaving forward movement as the only option. Such a motor suppression mechanism is consistent with observations by Dunn <italic>et al</italic>. [<xref ref-type="bibr" rid="R18">18</xref>], which showed a continuous relationship between the lateral difference in the ARTR activity and the mean reorientation angle of the executed bout. While our model strongly supports this hypothesis, definitive experimental validation is required.</p><p id="P71">Last of all, to facilitate the accessibility and adoption of Hidden Markov Model (HMM) formalism for analyzing behavioral sequences, we provide a comprehensive and instructive Python tutorial (<ext-link ext-link-type="uri" xlink:href="https://github.com/EmeEmu/IBIO-Banyuls2023-Python">https://github.com/EmeEmu/IBIO-Banyuls2023-Python</ext-link>). This tutorial can be adapted for specific datasets or used as a resource for broader educational goals.</p></sec><sec id="S18" sec-type="materials | methods"><label>IV</label><title>Materials and Methods</title><sec id="S19"><label>A</label><title>Behavioral Datasets</title><p id="P72">The behavioral dataset used in the present study is derived from Le Goc <italic>et al</italic>. [<xref ref-type="bibr" rid="R22">22</xref>], and can be accessed directly at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.3r2280ggw">https://doi.org/10.5061/dryad.3r2280ggw</ext-link>. This dataset comprises spontaneous swimming trajectories of 5 to 7 dpf zebrafish larvae, collected at controlled bath temperatures of 18°C, 22°C, 26°C, 30°C, and 33°C. A camera was used to continuously record the swimming behavior of the fish within an arena of 100×45×4.5mm<sup>3</sup> for 30 minutes at 25 frames/second. To eliminate border effects, a Region of Interest (ROI) was defined at a distance of 5mm from the arena’s walls. Fish that swam outside the defined tracking ROI were considered lost, and a new trajectory was initiated upon their re-entry into the ROI. The identity of the fish is thus lost each time it exits the ROI. Therefore, the dataset contains a varying number of fish trajectories, ranging from 532 to 1513 trajectories across the different temperatures (mean = 1148). Individual trajectories were tracked offline using the open-source FastTrack software [<xref ref-type="bibr" rid="R45">45</xref>], and were then discretized into sequences of swimming bouts.</p><p id="P73">Each trajectory consists of a sequence of swim bouts, spanning from 9 to 748 bouts per trajectory (mean=60, distributions shown in <xref ref-type="supplementary-material" rid="SD1">Fig.S1a</xref>). From this extensive dataset, we primarily utilized the re-orientation angles, defined as the difference between the heading direction at bout <italic>n</italic> + 1 and the heading direction at bout <italic>n</italic>:
<disp-formula id="FD8"><label>(7)</label><mml:math id="M17"><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></disp-formula> (a graphical illustration of this definition can be found in <xref ref-type="fig" rid="F1">Fig.1c</xref>). This parameter encapsulates the angular change between consecutive bouts, providing insight into the fish’s ability to modify its orientation during swimming.</p><p id="P74">We also used the interbout interval <italic>δt<sub>n</sub></italic> = <italic>t<sub>n+1</sub></italic> - <italic>t<sub>n</sub></italic> representing the elapsed time between 2 consecutive bouts, and the traveled distance <inline-formula><mml:math id="M18"><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:math></inline-formula>.</p><p id="P75">On top of these multi-fish trajectories, we used in <xref ref-type="sec" rid="S11">sections II D</xref> and <xref ref-type="sec" rid="S14">II G</xref> a second dataset from Le Goc <italic>et al</italic>.</p><p id="P76">[<xref ref-type="bibr" rid="R22">22</xref>] consisting in single-fish recordings. For this dataset, each fish (N=18) is placed alone in the arena at 26°C, and is recorded for 2 hours. With this experimental paradigm, the identity of the fish is conserved across trajectories, even when the fish leaves and re-enters the ROI.</p></sec><sec id="S20"><label>B</label><title>Neuronal Datasets</title><p id="P77">The neuronal dataset used in the present study is derived from Wolf <italic>et al</italic>. [<xref ref-type="bibr" rid="R27">27</xref>], and can be accessed directly at <ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/Debregeas/ZF_ARTR_thermo">https://gin.g-node.org/Debregeas/ZF_ ARTR_thermo</ext-link>. This dataset contains 32 one-photon Light-Sheet Microscopy recordings of spontaneous brain activity, for 13 zebrafish larvae (5 to 7 dpf) at 18°C, 22°C, 26°C, 30°C, and 33°C. It focuses on neurons from the <italic>Anterior Rhombencephalic Turning Region</italic> (ARTR), with ∼ 300 neurons (mean 307, std 119), recorded during ∼ 20min (mean 23, std 4 min) at ∼ 6Hz (mean 5.9, std 2.1 Hz).</p></sec><sec id="S21"><label>C</label><title>Emission of reorientation angles in the Hidden Markov Model</title><p id="P78">To validate the hypothesis that the re-orientation angles can be modeled using normal and gamma distributions, we compared the distribution of the data with a Gaussian Mixture Model (GMM) and a Gaussian&amp;Gamma Mixture Model: <disp-formula id="FD9"><mml:math id="M19"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mi>𝒩</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mtext>Γ</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mtext>Γ</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> where <italic>w<sub>F</sub></italic> +<italic>w<sub>L</sub></italic>+<italic>w<sub>R</sub></italic> = 1, and <italic>w<sub>F</sub></italic>, <italic>w<sub>L</sub></italic>, and <italic>w<sub>R</sub></italic> denote the weights for forward, left, and right states, respectively.</p><p id="P79">Using Quantile-Quantile (QQ) plots, we show that this last mixture model accurately reproduces the observed distribution of <italic>δθ<sub>n</sub></italic> in the data, and is much better than a GMM, especially in the tails of the distributions (<xref ref-type="supplementary-material" rid="SD1">Fig. S2a</xref>). We also confirmed that, once trained, the emission distributions do indeed match the observed reorientation distributions (<xref ref-type="supplementary-material" rid="SD1">Fig. S2b-c</xref>).</p></sec><sec id="S22"><label>D</label><title><italic>Stubbornness</italic> factor</title><p id="P80">The <italic>stubbornness</italic> factor <italic>f<sub>q</sub></italic> is a measurement of the animal’s preference towards turning in the same direction over changing direction, after <italic>q</italic> intermediary forward bouts (<xref ref-type="supplementary-material" rid="SD1">Fig.S4c</xref>), as defined in (3).</p><p id="P81">It can be computed from a sequence of classified bouts <italic>b<sub>n</sub></italic> by first identifying and counting the q-plets <italic>T</italic><sub>1</sub> → <italic>F<sup>q</sup></italic> → <italic>T<sub>2</sub></italic> where <italic>T<sub>1</sub></italic> = <italic>T<sub>2</sub></italic> and where <italic>T<sub>1</sub></italic> ≠ <italic>T<sub>2</sub></italic>: <disp-formula id="FD10"><label>(8)</label><mml:math id="M20"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mtext>#</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>≠</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mtext>#</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula> and then computing their ratio: <disp-formula id="FD11"><label>(9)</label><mml:math id="M21"><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>≠</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P82">In practice, this ratio has a physical interpretation only for long sequences of bouts where N<sub>=</sub> &gt;&gt; 1 and <italic>N</italic><sub>≠</sub> &gt;&gt; 1. As the trajectories in our dataset can be quite short (<xref ref-type="supplementary-material" rid="SD1">Fig. S1a</xref>), we compute <italic>f<sub>q</sub></italic> from all trajectories at a specific temperature, increasing the chance of observing a high number of stubborn (<italic>N</italic><sub>=</sub>) and non-stubborn (N<sub>≠</sub>) trajectories.</p><p id="P83">By considering that the probability of a given q-plet is stubborn follows a binomial distribution (𝔼(<italic>N</italic><sub>=</sub>) = <italic>pN</italic> and 𝔼(<italic>N</italic><sub>≠</sub>) = (1 – <italic>p</italic>)<italic>N</italic> with <italic>N</italic> = <italic>N</italic><sub>=</sub> + <italic>N</italic><sub>≠</sub>), we can evaluate the uncertainty in <italic>stubbornness</italic> as: <disp-formula id="FD12"><label>(10)</label><mml:math id="M22"><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mo>≠</mml:mo></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>≠</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>≠</mml:mo></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P84">It is to be noted that these uncertainties are conservative estimates, as there exits a bias inherent to the dataset. Indeed, a very stubborn fish will tend to stay longer within the Region Of Interest (ROI) of the camera, leading to longer trajectories and therefore weighing more on the final result. Hence, it is unclear whether a <italic>stubbornness</italic> factor <italic>f<sub>q</sub></italic> = 1 ± 0.2 is truly significant (as suggested by the estimated error bars on <xref ref-type="supplementary-material" rid="SD1">Fig.S4d</xref>).</p><p id="P85">Furthermore, as the stubbornness factor is computed from all trajectories (and thus all fish) at a particular temperature, it represents an average behavior rather than an individual fish.</p></sec><sec id="S23"><label>E</label><title><italic>Stubbornness</italic> factor and 3-state Markov Chain</title><p id="P86">The <italic>stubbornness</italic> factor can be defined directly from the transition matrix.</p><p id="P87"><italic>For q</italic> = 0, calculations are simple: <disp-formula id="FD13"><label>(11)</label><mml:math id="M23"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P88"><italic>For q</italic> ≥ 1, the <italic>stubbornness</italic> factor is defined from the transition matrix as: <disp-formula id="FD14"><mml:math id="M24"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> with <italic>S<sub>L,q</sub></italic> the probability of a trajectory which starts and ends with a left bout, <italic>W<sub>L,q</sub></italic> the probability of a trajectory which starts with a left bout and ends with a right bout, and <italic>S<sub>R,q</sub></italic> <italic>W<sub>R,q</sub></italic> their symmetrical opposites.</p><p id="P89">For a 3-state model, the forward-forward bout probability cancels out, giving: <disp-formula id="FD15"><mml:math id="M25"><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula> and with our non-handedness hypothesis: <italic>P</italic>(<italic>L</italic>) = <italic>P</italic>(<italic>R</italic>),</p><p id="P90"><italic>P</italic>(<italic>L</italic>→<italic>F</italic>) = <italic>P</italic>(<italic>R</italic>→<italic>F</italic>), and <italic>P</italic>(<italic>F</italic> →<italic>L</italic>) = <italic>P</italic>(<italic>F</italic> →<italic>R</italic>), yielding: <disp-formula id="FD16"><label>(12)</label><mml:math id="M26"><mml:msub><mml:mi>f</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>∀</mml:mo><mml:mi>q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula></p></sec><sec id="S24"><label>F</label><title>Labeling of states in the neuronal Hidden Markov Model</title><p id="P91">The internal states of the Hidden Markov Models (HMMs) trained from neuronal activity are not <italic>a priory</italic> assigned to the Left, Right and Forward labels, and must therefore be re-ordered post-training.</p><p id="P92">We expect a certain symmetry in the system, where neurons in the left side of the ARTR will be more active during a Left state (and vice versa). Hence, we can use the excitability <inline-formula><mml:math id="M27"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> of neuron <italic>i</italic> in each internal state <italic>s</italic>, as defined in the emission distribution of the HMM (see <xref ref-type="disp-formula" rid="FD5">Eq. 4</xref>). We define the lateralized excitability: <disp-formula id="FD17"><label>(13)</label><mml:math id="M28"><mml:mtext>Δ</mml:mtext><mml:msup><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℒ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℜ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M29"><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> is the standard logistic function, and <italic>L</italic> and <italic>R</italic> are the sets of neurons located respectively in the left and right side of the ARTR. We thus label the HMM states such that <disp-formula id="FD18"><label>(14)</label><mml:math id="M30"><mml:mtext>Δ</mml:mtext><mml:msup><mml:mi>h</mml:mi><mml:mi>L</mml:mi></mml:msup><mml:mo>&gt;</mml:mo><mml:mtext>Δ</mml:mtext><mml:msup><mml:mi>h</mml:mi><mml:mi>F</mml:mi></mml:msup><mml:mo>&gt;</mml:mo><mml:mtext>Δ</mml:mtext><mml:msup><mml:mi>h</mml:mi><mml:mi>R</mml:mi></mml:msup></mml:math></disp-formula> with <italic>F</italic>, <italic>L</italic>, and <italic>R</italic> the Forward, Left and Right internal states.</p></sec><sec id="S25"><label>G</label><title>Temporal re-scaling</title><p id="P93">To find the temporal re-scaling factor <italic>f<sub>N/B</sub></italic> between behavioral and neuronal models, we first compute the distributions of sojourn times Δ<italic>t<sub>s</sub></italic> for all states <italic>s</italic> ∈ {<italic>F, L,R</italic>} in both behavioral and neuronal Hidden Markov Models.</p><p id="P94">We then find the optimal re-scaling factor <italic>f<sub>N/B</sub></italic> for which the combined distributions <inline-formula><mml:math id="M31"><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>F</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>L</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M32"><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>L</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> are as close to each other as possible : <disp-formula id="FD19"><label>(15)</label><mml:math id="M33"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:munder><mml:mtext>RMSE</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>⋅</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>Q</italic>(<italic>D</italic>) is the quantiles of a distribution <italic>D</italic>, and RMSE(x,y) is the Root Mean Squared Error between vectors x and y (see <xref ref-type="supplementary-material" rid="SD1">Fig.S6a</xref>).</p><p id="P95">For Markov chains, the transition matrix <italic>P</italic> = <italic>P</italic> (<italic>s<sub>n</sub></italic> = <italic>s</italic> → <italic>s<sub>n</sub></italic>+1 = <italic>s</italic>′) represents the probability of transitioning in one step from state <italic>s</italic> to state <italic>s</italic>′. The transition probability <italic>s</italic> → <italic>s</italic>′ in <italic>k</italic> ∈ ℕ<sub>1</sub> steps <italic>P</italic>(<italic>s<sub>n</sub></italic> = <italic>s</italic> → <italic>s<sub>n</sub>+<sub>k</sub></italic> = <italic>s′</italic>) is then the matrix power <italic>P</italic> <italic><sup>k</sup></italic>.</p><p id="P96">In order to apply the temporal re-scaling <italic>f<sub>N/B</sub></italic> between behavioral and neuronal models, we can thus compute the re-scaled transition matrix : <disp-formula id="FD20"><label>(16)</label><mml:math id="M34"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>⌊</mml:mo><mml:mfrac><mml:mi>ν</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:msubsup></mml:math></disp-formula> where <italic>P<sub>n</sub></italic> is the transition matrix inferred from neuronal data recorded at a frequency <italic>ν</italic> Hz.</p></sec><sec id="S26"><label>H</label><title>Mean Square Reorientation</title><p id="P97">To characterize the orientational diffusivity of the trajectories, we use the Mean Square Reorientation (MSR) accumulated after <italic>q</italic> bouts, as defined in <xref ref-type="disp-formula" rid="FD6">equation (5)</xref> [<xref ref-type="bibr" rid="R20">20</xref>].</p><p id="P98">For infinitely large datasets with no left-right bias, we expect a centered distribution of reorientation angles 〈<italic>δθ<sub>n</sub></italic>〉<italic><sub>n</sub></italic> = 0. However, this is not the case, particularly for the neuronal dataset where experimental limitations can induce strong biases. In particular, two of those limitations are due to the one-sided illumination in our Light Sheet Fluorescence Microscope [<xref ref-type="bibr" rid="R46">46</xref>]. First, due to scattering, the illumination beam is not uniform left-right across the brain, which can induce biases in the detection of neurons and their activity. Second, the non-uniform perception of light by the zebrafish larvae can elicit a phototaxis response, which is known to bias the activity of the <italic>Anterior Rhombencephalic Turning Region</italic> (ARTR) [<xref ref-type="bibr" rid="R44">44</xref>].</p><p id="P99">Since a non-zero bias can result in a distortion of the MSR (see <xref ref-type="supplementary-material" rid="SD1">Appendix 1</xref>), the MSR is computed from <inline-formula><mml:math id="M35"><mml:mi>δ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> instead of <italic>δθ<sub>n</sub></italic>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Appendices</label><media xlink:href="EMS200890-supplement-Appendices.pdf" mimetype="application" mime-subtype="pdf" id="d8aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S27"><title>Acknowledgements</title><p>We acknowledge the following funding:
<table-wrap id="T1" position="anchor" orientation="portrait"><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" style="border-left: solid-thin">Author</th><th align="left" valign="middle">Funder</th></tr></thead><tbody><tr><td align="left" valign="middle" style="border-left: solid-thin">M. DK.</td><td align="left" valign="middle">École Doctorale Frontiére de l’Innovation en Recherche et Education - Programme Bettencourt</td></tr><tr><td align="left" valign="middle" style="border-left: solid-thin">J. FdCD.</td><td align="left" valign="middle">Université PSL, AI Junior Fellow program</td></tr><tr><td align="left" valign="middle" style="border-left: solid-thin">M. C.</td><td align="left" valign="middle">European Union, Horizon 2020 Programme (H2020 MSCA ITN Project SmartNets GA-860949)</td></tr><tr><td align="left" valign="middle" style="border-left: solid-thin">V. B.</td><td align="left" valign="middle">European Research Council (ERC) under the European Union’s Horizon 2020 research innovation program grant agreement number 715980</td></tr><tr><td align="left" valign="middle" style="border-left: solid-thin">R. M., G. D., S. C.</td><td align="left" valign="middle">Locomat ANR-21-CE16-0037</td></tr></tbody></table></table-wrap>
</p></ack><sec id="S28" sec-type="data-availability"><title>Data and Code availability</title><p id="P100">All the data and code used in the present article are available under GNU General Public License version 3 at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZebrafishHMM2023/ZebrafishHMM2023_CodeAndData/tree/bioRxiv">https://github.com/ZebrafishHMM2023/ZebrafishHMM2023_CodeAndData/tree/bioRxiv</ext-link>.</p><p id="P101">The custom Julia implementation of Hidden Markov Model used is available under MIT License at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZebrafishHMM2023/ZebrafishHMM2023.jl/tree/bioRxiv">https://github.com/ZebrafishHMM2023/ZebrafishHMM2023.jl/tree/bioRxiv</ext-link>.</p><p id="P102">We also provide two tutorials for the use of Hidden Markov Models for behavioral sequence analysis. The first one was created for the Cogmaster ”Machine learning for cognitive science” course, and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CoccoMonassonLab/ZebrafishHMM">https://github.com/CoccoMonassonLab/ZebrafishHMM</ext-link>. The second one was created for the i-Bio Summer School ”Advanced Computational Analysis for Behavioral and Neurophysiological Recordings” held in Banyuls-sur-Mer in the summer of 2023, and is available under GNU General Public License version 3 at <ext-link ext-link-type="uri" xlink:href="https://github.com/EmeEmu/IBIO-Banyuls2023-Python">https://github.com/EmeEmu/IBIO-Banyuls2023-Python</ext-link>.</p></sec><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tinbergen</surname><given-names>N</given-names></name></person-group><source>The study of instinct</source><publisher-name>Pygmalion Press, an imprint of Plunkett Lake Press</publisher-name><year>2020</year></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiltschko</surname><given-names>AB</given-names></name><name><surname>Johnson</surname><given-names>MJ</given-names></name><name><surname>Iurilli</surname><given-names>G</given-names></name><name><surname>Peterson</surname><given-names>RE</given-names></name><name><surname>Katon</surname><given-names>JM</given-names></name><name><surname>Pashkovski</surname><given-names>SL</given-names></name><name><surname>Abraira</surname><given-names>VE</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Datta</surname><given-names>SR</given-names></name></person-group><article-title>Mapping sub-second structure in mouse behavior</article-title><source>Neuron</source><year>2015</year><volume>88</volume><elocation-id>1121</elocation-id><pub-id pub-id-type="pmcid">PMC4708087</pub-id><pub-id pub-id-type="pmid">26687221</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.031</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mueller</surname><given-names>JM</given-names></name><name><surname>Ravbar</surname><given-names>P</given-names></name><name><surname>Simpson</surname><given-names>JH</given-names></name><name><surname>Carlson</surname><given-names>JM</given-names></name></person-group><article-title>Drosophila melanogaster grooming possesses syntax with distinct rules at different temporal scales</article-title><source>PLoS computational biology</source><year>2019</year><volume>15</volume><elocation-id>e1007105</elocation-id><pub-id pub-id-type="pmcid">PMC6594582</pub-id><pub-id pub-id-type="pmid">31242178</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007105</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>T</given-names></name><name><surname>Bjorness</surname><given-names>T</given-names></name><name><surname>Greene</surname><given-names>R</given-names></name><name><surname>You</surname><given-names>Y-J</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name></person-group><article-title>The geometry of locomotive behavioral states in c. elegans</article-title><source>PloS one</source><year>2013</year><volume>8</volume><elocation-id>e59865</elocation-id><pub-id pub-id-type="pmcid">PMC3610905</pub-id><pub-id pub-id-type="pmid">23555813</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0059865</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tao</surname><given-names>L</given-names></name><name><surname>Ozarkar</surname><given-names>S</given-names></name><name><surname>Beck</surname><given-names>JM</given-names></name><name><surname>Bhandawat</surname><given-names>V</given-names></name></person-group><article-title>Statistical structure of locomotion and its modulation by odors</article-title><source>Elife</source><year>2019</year><volume>8</volume><elocation-id>e41235</elocation-id><pub-id pub-id-type="pmcid">PMC6361587</pub-id><pub-id pub-id-type="pmid">30620334</pub-id><pub-id pub-id-type="doi">10.7554/eLife.41235</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>S</given-names></name><name><surname>Nichols</surname><given-names>A</given-names></name><name><surname>Blei</surname><given-names>D</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><article-title>Hierarchical recurrent state space models reveal discrete and continuous dynamics of neural activity in c. elegans</article-title><source>bioRxiv</source><year>2019</year><pub-id pub-id-type="doi">10.1101/621540</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>GJ</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name></person-group><article-title>Predictability and hierarchy in drosophila behavior</article-title><source>Proceedings of the National Academy of Sciences</source><year>2016</year><volume>113</volume><elocation-id>11943</elocation-id><pub-id pub-id-type="pmcid">PMC5081631</pub-id><pub-id pub-id-type="pmid">27702892</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1607601113</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>RE</given-names></name><name><surname>Linderman</surname><given-names>S</given-names></name><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Wee</surname><given-names>CL</given-names></name><name><surname>Song</surname><given-names>E</given-names></name><name><surname>Herrera</surname><given-names>KJ</given-names></name><name><surname>Miller</surname><given-names>A</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>Probabilistic models of larval zebrafish behavior reveal structure on many scales</article-title><source>Current Biology</source><year>2020</year><volume>30</volume><fpage>70</fpage><pub-id pub-id-type="pmcid">PMC6958995</pub-id><pub-id pub-id-type="pmid">31866367</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2019.11.026</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breakspear</surname><given-names>M</given-names></name></person-group><article-title>enDynamic models of large-scale brain activity</article-title><source>Nat Neurosci</source><year>2017</year><volume>20</volume><fpage>340</fpage><pub-id pub-id-type="pmid">28230845</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazzucato</surname><given-names>L</given-names></name><name><surname>Fontanini</surname><given-names>A</given-names></name><name><surname>La Camera</surname><given-names>G</given-names></name></person-group><article-title>Dynamics of multistable states during ongoing and evoked cortical activity</article-title><source>Journal of Neuroscience</source><year>2015</year><volume>35</volume><elocation-id>8214</elocation-id><comment><ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/35/21/8214.full.pdf">https://www.jneurosci.org/content/35/21/8214.full.pdf</ext-link></comment><pub-id pub-id-type="pmcid">PMC4444543</pub-id><pub-id pub-id-type="pmid">26019337</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4819-14.2015</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>AJ</given-names></name><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Abeysuriya</surname><given-names>R</given-names></name><name><surname>Becker</surname><given-names>R</given-names></name><name><surname>Nobre</surname><given-names>AC</given-names></name><name><surname>Woolrich</surname><given-names>MW</given-names></name></person-group><article-title>Task-evoked dynamic network analysis through hidden markov modeling</article-title><source>Frontiers in neuroscience</source><year>2018</year><volume>12</volume><fpage>603</fpage><pub-id pub-id-type="pmcid">PMC6121015</pub-id><pub-id pub-id-type="pmid">30210284</pub-id><pub-id pub-id-type="doi">10.3389/fnins.2018.00603</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Saxena</surname><given-names>S</given-names></name></person-group><source>Inference of neural dynamics using switching recurrent neural networks</source><conf-name>The Thirty-eighth Annual Conference on Neural Information Processing Systems</conf-name><year>2024</year></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>de Polavieja</surname><given-names>GG</given-names></name></person-group><article-title>Zebrafish behavior: opportunities and challenges</article-title><source>Annual review of neuroscience</source><year>2017</year><volume>40</volume><fpage>125</fpage><pub-id pub-id-type="pmid">28375767</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyers</surname><given-names>JR</given-names></name></person-group><article-title>Zebrafish: development of a vertebrate model organism</article-title><source>Current Protocols Essential Laboratory Techniques</source><year>2018</year><volume>16</volume><fpage>e19</fpage></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bollmann</surname><given-names>JH</given-names></name></person-group><article-title>The zebrafish visual system: from circuits to behavior</article-title><source>Annual review of vision science</source><year>2019</year><volume>5</volume><fpage>269</fpage><pub-id pub-id-type="pmid">31525146</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marques</surname><given-names>JC</given-names></name><name><surname>Lackner</surname><given-names>S</given-names></name><name><surname>Félix</surname><given-names>R</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name></person-group><article-title>Structure of the zebrafish locomotor repertoire revealed with unsupervised behavioral clustering</article-title><source>Current Biology</source><year>2018</year><volume>28</volume><fpage>181</fpage><pub-id pub-id-type="pmid">29307558</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>Navigational strategies underlying phototaxis in larval zebrafish</article-title><source>Frontiers in Systems Neuroscience</source><year>2014</year><volume>8</volume><pub-id pub-id-type="pmcid">PMC3971168</pub-id><pub-id pub-id-type="pmid">24723859</pub-id><pub-id pub-id-type="doi">10.3389/fnsys.2014.00039</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>TW</given-names></name><name><surname>Mu</surname><given-names>Y</given-names></name><name><surname>Narayan</surname><given-names>S</given-names></name><name><surname>Randlett</surname><given-names>O</given-names></name><name><surname>Naumann</surname><given-names>EA</given-names></name><name><surname>Yang</surname><given-names>C-T</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name></person-group><article-title>Brain-wide mapping of neural activity controlling zebrafish exploratory locomotion</article-title><source>Elife</source><year>2016</year><volume>5</volume><elocation-id>e12741</elocation-id><pub-id pub-id-type="pmcid">PMC4841782</pub-id><pub-id pub-id-type="pmid">27003593</pub-id><pub-id pub-id-type="doi">10.7554/eLife.12741</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horstick</surname><given-names>EJ</given-names></name><name><surname>Bayleyen</surname><given-names>Y</given-names></name><name><surname>Sinclair</surname><given-names>JL</given-names></name><name><surname>Burgess</surname><given-names>HA</given-names></name></person-group><article-title>Search strategy is regulated by somatostatin signaling and deep brain photoreceptors in zebrafish</article-title><source>BMC biology</source><year>2017</year><volume>15</volume><fpage>1</fpage><pub-id pub-id-type="pmcid">PMC5267475</pub-id><pub-id pub-id-type="pmid">28122559</pub-id><pub-id pub-id-type="doi">10.1186/s12915-016-0346-2</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Karpenko</surname><given-names>S</given-names></name><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Lafaye</surname><given-names>J</given-names></name><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><article-title>From behavior to circuit modeling of light-seeking navigation in zebrafish larvae</article-title><source>eLife</source><publisher-name>eLife Sciences Publications, Ltd</publisher-name><year>2020</year><volume>9</volume><elocation-id>e52882</elocation-id><pub-id pub-id-type="pmcid">PMC6989119</pub-id><pub-id pub-id-type="pmid">31895038</pub-id><pub-id pub-id-type="doi">10.7554/eLife.52882</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horstick</surname><given-names>EJ</given-names></name><name><surname>Bayleyen</surname><given-names>Y</given-names></name><name><surname>Burgess</surname><given-names>HA</given-names></name></person-group><article-title>Molecular and cellular determinants of motor asymmetry in zebrafish</article-title><source>Nature Communications</source><year>2020</year><volume>11</volume><elocation-id>1170</elocation-id><pub-id pub-id-type="pmcid">PMC7054361</pub-id><pub-id pub-id-type="pmid">32127541</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-14965-y</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Lafaye</surname><given-names>J</given-names></name><name><surname>Karpenko</surname><given-names>S</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><article-title>Thermal modulation of Zebrafish exploratory statistics reveals constraints on individual behavioral variability</article-title><source>BMC Biology</source><year>2021</year><volume>19</volume><fpage>208</fpage><pub-id pub-id-type="pmcid">PMC8456632</pub-id><pub-id pub-id-type="pmid">34548084</pub-id><pub-id pub-id-type="doi">10.1186/s12915-021-01126-w</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barabási</surname><given-names>DL</given-names></name><name><surname>Schuhknecht</surname><given-names>GF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>Functional neuronal circuits emerge in the absence of developmental activity</article-title><source>Nature Communications</source><year>2024</year><volume>15</volume><fpage>364</fpage><pub-id pub-id-type="pmcid">PMC10774424</pub-id><pub-id pub-id-type="pmid">38191595</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-44681-2</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haesemeyer</surname><given-names>M</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>A brain-wide circuit model of heat-evoked swimming behavior in larval zebrafish</article-title><source>Neuron</source><year>2018</year><volume>98</volume><fpage>817</fpage><pub-id pub-id-type="pmcid">PMC5985529</pub-id><pub-id pub-id-type="pmid">29731253</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2018.04.013</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haesemeyer</surname><given-names>M</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>A brain-wide circuit model of heat-evoked swimming behavior in larval zebrafish</article-title><source>Neuron</source><year>2018</year><volume>98</volume><fpage>817</fpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palieri</surname><given-names>V</given-names></name><name><surname>Paoli</surname><given-names>E</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Haesemeyer</surname><given-names>M</given-names></name><name><surname>Grunwald Kadow</surname><given-names>I</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><article-title>The preoptic area and dorsal habenula jointly support homeostatic navigation in larval zebrafish</article-title><source>Curr Biol</source><year>2024</year><volume>3</volume><fpage>34</fpage><pub-id pub-id-type="pmcid">PMC10849091</pub-id><pub-id pub-id-type="pmid">38211586</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2023.12.030</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Le Goc</surname><given-names>G</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name><name><surname>Cocco</surname><given-names>S</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name></person-group><article-title>Emergence of time persistence in a data-driven neural network model</article-title><source>eLife</source><year>2023</year><volume>12</volume><elocation-id>e79541</elocation-id><pub-id pub-id-type="pmcid">PMC10171858</pub-id><pub-id pub-id-type="pmid">36916902</pub-id><pub-id pub-id-type="doi">10.7554/eLife.79541</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezanson</surname><given-names>J</given-names></name><name><surname>Edelman</surname><given-names>A</given-names></name><name><surname>Karpinski</surname><given-names>S</given-names></name><name><surname>Shah</surname><given-names>VB</given-names></name></person-group><article-title>Julia: A fresh approach to numerical computing</article-title><source>SIAM review</source><year>2017</year><volume>59</volume><fpage>65</fpage><pub-id pub-id-type="doi">10.1137/141000671</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalle</surname><given-names>G</given-names></name></person-group><article-title>Hiddenmarkovmodels.jl: generic, fast and reliable state space modeling</article-title><source>Journal of Open Source Software</source><year>2024</year><volume>9</volume><elocation-id>6436</elocation-id><pub-id pub-id-type="doi">10.21105/joss.06436</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><article-title>Brain-wide neuronal dynamics during motor adaptation in zebrafish</article-title><year>2012</year><volume>485</volume><fpage>471</fpage><elocation-id>22622571</elocation-id><pub-id pub-id-type="pmcid">PMC3618960</pub-id><pub-id pub-id-type="pmid">22622571</pub-id><pub-id pub-id-type="doi">10.1038/nature11057</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>K-H</given-names></name><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Dunn</surname><given-names>TW</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>Spinal Projection Neurons Control Turning Behaviors in Zebrafish</article-title><year>2013</year><volume>23</volume><elocation-id>1566</elocation-id><pub-id pub-id-type="pmcid">PMC3752323</pub-id><pub-id pub-id-type="pmid">23910662</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2013.06.044</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petrucco</surname><given-names>L</given-names></name><name><surname>Lavian</surname><given-names>H</given-names></name><name><surname>Wu</surname><given-names>YK</given-names></name><name><surname>Svara</surname><given-names>F</given-names></name><name><surname>Štih</surname><given-names>V</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><article-title>Neural dynamics and architecture of the heading direction circuit in zebrafish</article-title><year>2023</year><volume>26</volume><fpage>765</fpage><pub-id pub-id-type="pmcid">PMC10166860</pub-id><pub-id pub-id-type="pmid">37095397</pub-id><pub-id pub-id-type="doi">10.1038/s41593-023-01308-5</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Portugues</surname><given-names>R</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name></person-group><article-title>Whole-Brain Activity Maps Reveal Stereotyped</article-title><source>Distributed Networks for Visuomotor Behavior</source><year>2014</year><volume>81</volume><fpage>1328</fpage><elocation-id>24656252</elocation-id><pub-id pub-id-type="pmcid">PMC4448760</pub-id><pub-id pub-id-type="pmid">24656252</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2014.01.019</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dragomir</surname><given-names>EI</given-names></name><name><surname>Štih</surname><given-names>V</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><article-title>Evidence accumulation during a sensorimotor decision task revealed by whole-brain imaging</article-title><year>2020</year><volume>23</volume><fpage>85</fpage><pub-id pub-id-type="pmid">31792463</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Severi</surname><given-names>KE</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name><name><surname>Marques</surname><given-names>JC</given-names></name><name><surname>O’Malley</surname><given-names>DM</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name></person-group><article-title>Neural control and modulation of swimming speed in the larval zebrafish</article-title><year>2014</year><volume>83</volume><fpage>692</fpage><elocation-id>25066084</elocation-id><pub-id pub-id-type="pmcid">PMC4126853</pub-id><pub-id pub-id-type="pmid">25066084</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.032</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Karpenko</surname><given-names>S</given-names></name></person-group><source>Naviguer avec la lumière : Du comportement aux circuits neuronaux chez la larve de poisson zèbre</source><year>2020</year></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>AE</given-names></name><name><surname>De Bivort</surname><given-names>B</given-names></name></person-group><article-title>Ethology as a physical science</article-title><source>Nature Physics</source><year>2018</year><volume>14</volume><fpage>653</fpage></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname><given-names>TD</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name><name><surname>Murthy</surname><given-names>M</given-names></name></person-group><article-title>Quantifying behavior to understand the brain</article-title><source>Nature neuroscience</source><year>2020</year><volume>23</volume><elocation-id>1537</elocation-id><pub-id pub-id-type="pmcid">PMC7780298</pub-id><pub-id pub-id-type="pmid">33169033</pub-id><pub-id pub-id-type="doi">10.1038/s41593-020-00734-z</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname><given-names>A</given-names></name></person-group><article-title>The what, how, and why of naturalistic behavior</article-title><source>Current opinion in neurobiology</source><year>2022</year><volume>74</volume><elocation-id>102549</elocation-id><pub-id pub-id-type="pmcid">PMC9273162</pub-id><pub-id pub-id-type="pmid">35537373</pub-id><pub-id pub-id-type="doi">10.1016/j.conb.2022.102549</pub-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Honegger</surname><given-names>K</given-names></name><name><surname>de Bivort</surname><given-names>B</given-names></name></person-group><article-title>Stochasticity, individuality and behavior</article-title><source>Current Biology</source><year>2018</year><volume>28</volume><elocation-id>R8</elocation-id><pub-id pub-id-type="pmid">29316423</pub-id></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shaw</surname><given-names>AK</given-names></name></person-group><article-title>Causes and consequences of individual variation in animal movement</article-title><source>Movement ecology</source><year>2020</year><volume>8</volume><fpage>12</fpage><pub-id pub-id-type="pmcid">PMC7027015</pub-id><pub-id pub-id-type="pmid">32099656</pub-id><pub-id pub-id-type="doi">10.1186/s40462-020-0197-x</pub-id></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hiesinger</surname><given-names>PR</given-names></name><name><surname>Hassan</surname><given-names>BA</given-names></name></person-group><article-title>The evolution of variability and robustness in neural development</article-title><source>Trends in Neurosciences</source><year>2018</year><volume>41</volume><fpage>577</fpage><pub-id pub-id-type="pmid">29880259</pub-id></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sridhar</surname><given-names>G</given-names></name><name><surname>Vergassola</surname><given-names>M</given-names></name><name><surname>Marques</surname><given-names>JC</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Costa</surname><given-names>AC</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name></person-group><article-title>Uncovering multiscale structure in the variability of larval zebrafish navigation</article-title><source>Proceedings of the National Academy of Sciences</source><year>2024</year><volume>121</volume><elocation-id>e2410254121</elocation-id><pub-id pub-id-type="pmcid">PMC11588111</pub-id><pub-id pub-id-type="pmid">39546569</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2410254121</pub-id></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Dubreuil</surname><given-names>AM</given-names></name><name><surname>Bertoni</surname><given-names>T</given-names></name><name><surname>Böhm</surname><given-names>UL</given-names></name><name><surname>Bormuth</surname><given-names>V</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Karpenko</surname><given-names>S</given-names></name><name><surname>Hildebrand</surname><given-names>DG</given-names></name><name><surname>Bianco</surname><given-names>IH</given-names></name><name><surname>Monasson</surname><given-names>R</given-names></name><etal/></person-group><article-title>Sensorimotor computation underlying phototaxis in zebrafish</article-title><source>Nature communications</source><year>2017</year><volume>8</volume><fpage>651</fpage><pub-id pub-id-type="pmcid">PMC5608914</pub-id><pub-id pub-id-type="pmid">28935857</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-00310-3</pub-id></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallois</surname><given-names>B</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name></person-group><article-title>Fasttrack: an open-source software for tracking varying numbers of deformable objects</article-title><source>PLoS computational biology</source><year>2021</year><volume>17</volume><elocation-id>e1008697</elocation-id><pub-id pub-id-type="pmcid">PMC7904165</pub-id><pub-id pub-id-type="pmid">33571205</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008697</pub-id></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panier</surname><given-names>T</given-names></name><name><surname>Romano</surname><given-names>S</given-names></name><name><surname>Olive</surname><given-names>R</given-names></name><name><surname>Pietri</surname><given-names>T</given-names></name><name><surname>Sumbre</surname><given-names>G</given-names></name><name><surname>Candelier</surname><given-names>R</given-names></name><name><surname>Debrégeas</surname><given-names>G</given-names></name></person-group><article-title>Fast functional imaging of multiple brain regions in intact zebrafish larvae using Selective Plane Illumination Microscopy</article-title><source>Frontiers in Neural Circuits</source><year>2013</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC3620503</pub-id><pub-id pub-id-type="pmid">23576959</pub-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00065</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Behavioral and Neuronal Datasets</title><p><bold>(a)</bold> Overview of the experimental setup: Zebrafish larvae are free to move in a tank that is kept at a desired constant temperature by a Peltier module. An imaging system records images of the fish from above at a rate of 25 frames per second. The upper right panel provides a close-up view of a larva in a raw image. Adapted from Le Goc <italic>et al</italic>. [<xref ref-type="bibr" rid="R22">22</xref>]. <bold>(b)</bold> Example trajectories of zebrafish larvae in 2D space at various temperatures. Each point represents a swim bout, with the color indicating the corresponding re-orientation angle defined in panel c. The trajectories’ starting points are denoted by black arrows. <bold>(c)</bold> Description of the convention used for the reorientation angle (<italic>δθ<sub>n</sub></italic>) between two consecutive swim bouts (<italic>n</italic> and <italic>n</italic> + 1). <bold>(d)</bold> Distribution of re-orientation angles (<italic>δθ<sub>n</sub></italic>) for each ambient temperature. The grayed-out area corresponds to the re-orientation angles classified as forward bouts by thresholds at ±10°. <bold>(e)</bold> Diagram of the <italic>Anterior Rhombencephalic Turning Region</italic> (ARTR) in larval zebrafish. Adapted from Wolf <italic>et al</italic>. [<xref ref-type="bibr" rid="R27">27</xref>]. <bold>(f)</bold> Example ARTR activity at 22°C. Top : Raster plot of neurons located in the left and right ARTR (blue and red respectively). Bottom : Mean activity mL and mR of neurons in the left and right ARTR. <bold>(g)</bold> Mean activities (<italic>m<sub>L</sub></italic>, <italic>m<sub>R</sub></italic>) of the ARTR for all recordings in the dataset. The blue contour line represents 90% of the joint distribution.</p></caption><graphic xlink:href="EMS200890-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>3-state Markov Chain and Hidden Markov Model - Memory effects emerge from better labeling</title><p><bold>(a)</bold> Diagram illustrating the 3-state Hidden Markov Model (HMM) with emissions modeled as a normal distribution for Forward bouts, and gamma distributions for Turning bouts. Example emission distributions where taken at 26°C. <bold>(b)</bold> Differences in labeling between Markov Chain (MC) and HMM for an example trajectory at 22°C. Each point represents a swim bout, with the left color corresponding to the labeling according to the manual threshold used in MC, and right color indicating the HMM labeling using the Viterbi algorithm. Top: Trajectory in 2D space. Bottom: Evolution of the reorientation angle <italic>δθ<sub>n</sub></italic> for this trajectory, with the dashed lines representing the threshold <italic>δθ</italic><sub>0</sub> = ±10°. <bold>(c)</bold> Probability <italic>P</italic>(<italic>ℓ</italic>) of observing a streak of <italic>ℓ</italic> consecutive forward bouts (black) or <italic>ℓ</italic> consecutive turning bouts in the same direction (pink), for MC (circles) and HMM (triangles), measured from data at 22°C. Inset: Temperature dependence of the exponential decay characteristic length (<italic>ℓ</italic><sub>1</sub>). Dotted line: theoretical persistence length computed from the transition matrix, <italic>ℓ</italic><sub>1</sub>(<italic>s</italic>) = −1/ln <italic>P</italic>(<italic>s</italic> → <italic>s</italic>). <bold>(d)</bold> Ratio of the observed persistence length <italic>ℓ</italic><sub>1</sub> and the persistence expected in a no-memory null model, <italic>ℓ</italic><sub>0</sub> vs. temperature. Forward bouts: <italic>s</italic> = <italic>F</italic>, black; turning bouts: <italic>s</italic> ∈ <italic>L, R</italic>, pink. <bold>(e)</bold> Temperature dependence of the <italic>stubbornness</italic> factor at <italic>q</italic> = 0 intermediary Forward bouts <inline-formula><mml:math id="M36"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula> This factor is interpreted as a measurement of directional persistence during sequences of turning bouts. <bold>(f)</bold> Temperature dependence of the <italic>stubbornness</italic> factor at <italic>q</italic> = 1 intermediary Forward bouts <inline-formula><mml:math id="M37"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula> This factor is interpreted as a measurement of directional memory after one forward bout, which for a 3-state model is a second order non-Markovianity· <bold>(e-f)</bold> The width of the shaded curves represent the estimated error in <italic>stubbornness</italic> factor from aggregated fish data (see <xref ref-type="sec" rid="S22">Materials and Methods IV D</xref>).</p></caption><graphic xlink:href="EMS200890-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>Fish identification from long trajectories</title><p><bold>(a)</bold> Diagram describing the dataset. Trajectories from 18 fish recorded over 2-hour sessions, were each is split into 10 chunks (mean = 9.5 ± 0.5 trajectories per chunk) <bold>(b)</bold> Example trajectories for fish 1. <bold>(c)</bold> HMM parameters inferred from all the trajectories of a fish (referred to as global), compared with the HMM parameters trained on chunks of that fish’s trajectories· Only four HMM parameters are shown for clarity : the steady state probability of forward turns <italic>P</italic>(<italic>F</italic>), the transition probabilities for forward-forward <italic>P</italic>(<italic>F</italic> → <italic>F</italic>), turn-turn in the same direction <italic>P</italic>(<italic>T</italic><sub>1</sub> → <italic>T</italic><sub>2</sub>|<italic>T</italic><sub>1</sub> = <italic>T</italic><sub>2</sub>), and turn-turn in opposite direction <italic>P</italic>(<italic>T</italic><sub>1</sub> → <italic>T</italic><sub>2</sub>|<italic>T</italic><sub>1</sub> ≠ <italic>T</italic><sub>2</sub>) (see <xref ref-type="supplementary-material" rid="SD1">FigS5</xref> for all parameters). Each dot represents a fish, and the error bars correspond to the standard error of the mean· Points labeled in red correspond to fish misidentified in panel d. <bold>(d)</bold> Confusion matrix between data coming from fish i and HMM trained on fish j. The relative likelihood <inline-formula><mml:math id="M38"><mml:mi>r</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext> data </mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mtext> model </mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext> data </mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mtext> model </mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> is used to evaluate which fish identity is most likely according to each model (indicated with black stars for correctly identified fish, and red stars for misidentification). <bold>(e)</bold> Number of correctly identified fish determined from model likelihood when only a fraction <italic>f</italic> of the test data is used for identification. The shaded area indicates the standard deviation across 100 trials. In each trial, the data trajectories of each fish were randomly split into train and test sets (50%).</p></caption><graphic xlink:href="EMS200890-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>3-state Hidden Markov Model (HMM) describes ARTR neuronal statistics</title><p><bold>(a)</bold> Diagram illustrating the 3-state Hidden Markov Model (HMM) with emissions described as independent models of the ARTR neuronal population, see <xref ref-type="disp-formula" rid="FD5">Eq. (4)</xref>. Distributions of fields <inline-formula><mml:math id="M39"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> are shown for all recorded fish for neurons in the left and right ARTR (in blue and red respectively). <bold>(b)</bold> Example ARTR activity (see <xref ref-type="fig" rid="F1">Fig. 1f</xref>) classified with the 3-state HMM. Blue and red lines represent the mean activity of neurons in the left (<italic>m<sub>L</sub></italic>) and right (<italic>m<sub>R</sub></italic>) ARTR, respectively. <bold>(c)</bold> HMM classification in the (<italic>m<sub>L</sub></italic>, <italic>m<sub>R</sub></italic>) space. Dots represent neuronal configurations taken from the example recording in panel b. Solid lines represent 90% of the distributions for all recordings combined. <bold>(d)</bold> Distributions of <italic>m<sub>L</sub></italic> – <italic>m<sub>R</sub></italic> for each hidden state and all recordings combined. e-f Comparison of empirical and HMM-generated neuronal statistics for all recordings combined. <bold>(e)</bold> Mean activity 〈<italic>σ<sub>i</sub></italic>〉 of neuron <italic>i</italic>. <bold>(f)</bold> Covariance Cov(<italic>σ<sub>i</sub></italic>, <italic>σ<sub>j</sub></italic>) of neurons <italic>i</italic> and <italic>j</italic> on opposite sides (left plot) and on the same sides (right plot) of the ARTR.</p></caption><graphic xlink:href="EMS200890-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Behavior vs. Neuronal temporal structure</title><p><bold>(a)</bold> Distribution of forward and turn sojourn times for the behavior (black) and neuronal data before (orange) and after temporal re-scaling (magenta). A single re-scaling factor is used for forward and turning states, for all temperatures, and for all recordings. <bold>(b)</bold> Comparison of behavior and neuronal state-transition probabilities <italic>P</italic>(<italic>s<sub>n</sub></italic> → <italic>s<sub>n+1</sub></italic>), before (left plot) and after (right plot) temporal re-scaling. Each dot represents a single transition probability at a given temperature. For neuronal state-transition, the mean and standard error of the mean for all recordings at specific temperatures are shown. <bold>(c)</bold> Diagram showing two possible transition trajectories between left and right states in ARTR mean-activity space. Transitions through the forward state are more probable (see panel d). <bold>(d)</bold> Distributions of <inline-formula><mml:math id="M40"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> the behavior (black) and neuronal data before (orange) and after temporal re-scaling (magenta), with all temperatures combined. These distributions are depicted as standard box plots (median and quartiles), as well as outlier points lying further than 1.5× the inter-quartile range from the median.</p></caption><graphic xlink:href="EMS200890-f005"/></fig><fig id="F6" position="float"><label>Fig. 6</label><caption><title>Generative ability of HMM models and trajectory reconstruction</title><p><bold>(a)</bold> Distribution of bout angles <italic>δθ<sub>n</sub></italic> for the aggregated multiple-fish trajectories (gray), generated trajectories from Behavioral Hidden Markov Models (B-HMM ; black), and generated trajectories from Neuronal Hidden Markov Models (N-HMM ; blue), at 22°C. <bold>(b)</bold> Mean Square Reorientation (MSR) accumulated after <italic>q</italic> bouts for aggregated multiple-fish trajectories (grey), shuffled aggregated multiple-fish trajectories (red dashed), single-fish long trajectories (green), and trajectories generated from N-HMM (blue). For both long and N-HMM-generated tra jectories, the mean and standard deviation over all individual fish are shown (respectively with a solid line and filled band). (see <xref ref-type="supplementary-material" rid="SD1">Fig.S7</xref> for individual trajectories and all temperatures) <bold>(c)</bold> Bar plot for the MSR at <italic>q</italic> = 10 bouts, with mean (horizontal bars) and standard deviation (vertical bars). <bold>(d)</bold> Diagram explaining the conversion from N-HMM generated state sequences to swim trajectories. The N-HMM is first sampled to generate a sequence of forward, left, right internal states. Time is then re-scaled using the scaling factor identified in <xref ref-type="fig" rid="F5">Fig 5</xref>, and bout sequences are sampled 100 times based on the interbout interval distribution. A swim trajectory is constructed for each bout sequence by sampling the bout distances <italic>d<sub>n</sub></italic> and inter-bout intervals <italic>δt<sub>n</sub></italic> emission distributions in the B-HMM. <bold>(e)</bold> Distribution of inter-bout intervals <italic>δt<sub>n</sub></italic> and bout distances <italic>d<sub>n</sub></italic> for the aggregated multiple-fish trajectories (gray), generated trajectories from B-HMM (black), and generated trajectories from N-HMM (blue), at 22°C. <bold>(f)</bold> Example trajectory generated from B-HMM at 26°C. Point color corresponds to bout type (left, right, forward), and point size corresponds to inter-bout interval. <bold>(g)</bold> Same as panel f for a N-HMM-generated trajectory at 26°C.</p></caption><graphic xlink:href="EMS200890-f006"/></fig></floats-group></article>