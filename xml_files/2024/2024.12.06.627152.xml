<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS201929</article-id><article-id pub-id-type="doi">10.1101/2024.12.06.627152</article-id><article-id pub-id-type="archive">PPR952886</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title><italic>DemoTape</italic>: Computational demultiplexing of targeted single-cell sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Borgsmüller</surname><given-names>Nico</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kuipers</surname><given-names>Jack</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Gawron</surname><given-names>Johannes</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Roncador</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Pohly</surname><given-names>Marcel</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Acar</surname><given-names>Erkin</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lan Do</surname><given-names>Thi Huong</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Reisenauer</surname><given-names>Stefanie</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Feldkamp</surname><given-names>MirjamJudith</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Beisel</surname><given-names>Christian</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zenz</surname><given-names>Thorsten</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Moor</surname><given-names>Andreas</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biosystems Science and Engineering, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zurich</institution></institution-wrap>, <postal-code>4056</postal-code><city>Basel</city>, <country country="CH">Switzerland</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/002n09z45</institution-id><institution>SIB Swiss Institute of Bioinformatics</institution></institution-wrap>, <postal-code>4056</postal-code><city>Basel</city>, <country country="CH">Switzerland</country></aff><aff id="A3"><label>3</label>Department of Medical Oncology and Hematology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01462r250</institution-id><institution>University Hospital</institution></institution-wrap> and <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02crff812</institution-id><institution>University of Zurich</institution></institution-wrap>, <postal-code>8006</postal-code><city>Zurich</city>, <country country="CH">Switzerland</country></aff><author-notes><corresp id="CR1"><label>*</label>Correspondence: <email>niko.beerenwinkel@bsse.ethz.ch</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>18</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>10</day><month>12</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Background</title><p id="P1">Single-cell sequencing can provide novel insights into the understanding and treatment of diseases. In cancer, for example, intratumor heterogeneity is a major cause of treatment resistance and relapse. Although technological progress has substantially increased the throughput of sequenced cells, single-cell sequencing remains cost and labor-intensive. Multiplexing, i.e., the pooling and subsequent joint preparation and sequencing of samples, followed by a demultiplexing step, is a common practice to reduce expenses and confounding batch effects, especially in single-cell RNA sequencing.</p></sec><sec id="S2"><title>Results</title><p id="P2">Here, we introduce <italic>demoTape,</italic> a computational demultiplexing method for targeted single-cell DNA sequencing (scDNA-seq) data based on a distance metric between individual cells at single-nucleotide polymorphisms loci. To validate <italic>demoTape,</italic> we sequence three B-cell lymphoma patients separately and multiplexed on the Tapestri platform. We find similar genotypes, clones, and evolutionary histories in all three samples when comparing the individual with the demultiplexed samples. Using the three individually sequenced samples, we simulate multiplexed ground truth data and show that <italic>demoTape</italic> outperforms state-of-the-art demultiplexing methods designed for RNA sequencing data. Additionally, we demonstrate through downsampling that the inferred clonal composition remained largely stable for samples with fewer cells despite the inevitable loss in resolution of low-frequency clones.</p></sec><sec id="S3"><title>Conclusions</title><p id="P3">Multiplexing and subsequent genotype-based demultiplexing of scDNA-seq will reduce costs and workload, eventually allowing the sequencing of more samples. This will open new possibilities and accelerate the investigation of biological questions where cellular heterogeneity on the genomic level plays a crucial role.</p></sec></abstract><kwd-group><kwd>targeted single-cell DNA sequencing</kwd><kwd>single-cell DNA panel sequencing</kwd><kwd>genotype-based demultiplexing</kwd><kwd>distance-based demultiplexing</kwd><kwd>Tapestri platform</kwd><kwd>intratumor heterogeneity</kwd></kwd-group></article-meta></front><body><sec id="S4" sec-type="intro"><label>1</label><title>Introduction</title><p id="P4">With the advent of high-throughput sequencing technologies, DNA and RNA data increased steadily in quality and quantity. The rapid decrease in cost and labor per sequenced sample has enabled the deciphering of thousands of human genomes [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>] and hundreds of mammalian species [<xref ref-type="bibr" rid="R3">3</xref>]. With the development of droplet-based microfluidic systems, it is now possible to sequence thousands of single cells at reasonable cost and in reasonable time [<xref ref-type="bibr" rid="R4">4</xref>, <xref ref-type="bibr" rid="R5">5</xref>] and, additionally study multiomics questions at single-cell resolution.</p><p id="P5">The increase in data led to a better understanding of diseases with genomic origin. Especially in cancer, intratumor heterogeneity (ITH) was identified as a key factor driving clonal evolution and causing treatment resistance [<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R7">7</xref>]. In B-cells, for example, single-cell data revealed that therapeutic pressure increased the complexity of the clonal composition, resulting in treatment resistance [<xref ref-type="bibr" rid="R8">8</xref>]. Accordingly, various methods were proposed to infer the clonal composition within a tumor, initially from bulk [<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>] and, with increasing resolution, from single-cell DNA sequencing (scDNA-seq) data [<xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R13">13</xref>].</p><p id="P6">Although the quantity of single-cell data increased overall, the focus has mainly been on RNA data [<xref ref-type="bibr" rid="R14">14</xref>]. scDNA-seq is more cost- and labor-intensive as it relies on amplifying the DNA molecules per cell above the detection threshold, making especially whole-exome and whole-genome sequencing expensive [<xref ref-type="bibr" rid="R15">15</xref>]. Novel, target-based approaches like the Tapestri platform [<xref ref-type="bibr" rid="R16">16</xref>] amplify only a panel of predefined sites and sequence these in thousands of cells with high accuracy [<xref ref-type="bibr" rid="R17">17</xref>].</p><p id="P7">In general, the information content of a sequencing experiment grows with the number of cells analyzed, but it eventually saturates. Consequently, it is common practice in scRNA-seq to pool (multiplex) multiple samples for joint preparation and sequencing, leading to fewer cells per sample but also decreased expenses and batch effects [<xref ref-type="bibr" rid="R18">18</xref>]. For subsequent demultiplexing, i.e., separating cells into their original samples, approaches relying on cell hashing via biochemical assays are often utilized [<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>] but also computational tools using single-nucleotide polymorphisms (SNPs) as sample markers can be used [<xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>]. However, genotype-based demultiplexing of scRNA-seq data is challenging due to the sparse SNP data, as SNP inference relies strongly on sufficient expression levels [<xref ref-type="bibr" rid="R23">23</xref>]. scDNA-seq data, in contrast, allows the reliable calling of SNPs which should be sufficient to tell multiplexed patients with distinct SNP profiles apart. Doing so without additional preparation steps and chemicals would reduce the cost and time required per sample. However, droplet-based approaches like the Tapestri platform tend to produce cell doublets (two cells sequenced together) which might distort the called SNPs and hamper the correct assignment of cells to patients [<xref ref-type="bibr" rid="R24">24</xref>].</p><p id="P8">Here, we introduce <italic>demoTape,</italic> a computational demultiplexing method for targeted scDNA-seq data based on the genotype distance between individual cells. Specifically, <italic>demoTape</italic> uses a novel distance metric based on the read counts at SNP loci, leveraging the deep read coverage at the targeted sites. To validate <italic>demoTape,</italic> we sequenced three B-cell lymphoma patients (one mantel cell lymphoma and two marginal zone lymphomas) separately and multiplexed on the Tapestri platform with a custom DNA target panel. Using these data, we demonstrate that <italic>demoTape</italic> outperforms state-of-the-art scRNA-seq methods in accuracy and that the inferred clonal composition remains largely stable when decreasing the number of cells. We then applied <italic>demoTape</italic> to the multiplexed sample, assigning cells back to patients and confirming the assignment through clonal, patient-specific SNPs.</p></sec><sec id="S5" sec-type="results"><label>2</label><title>Results</title><sec id="S6"><label>2.1</label><title>Overview of <italic>demoTape</italic> and the sequencing data of three lymphoma patients</title><p id="P9">To computationally demultiplex pooled samples from a joint sequencing run, <italic>demoTape</italic> requires a matrix containing the read counts at all called SNP loci and the number of multiplexed samples as input. First, <italic>demoTape</italic> calculates the pairwise distances between all cells based on the observed reads, creates a cell dendrogram through hierarchical agglomerative clustering, and uses this dendrogram to determine initial clusters. Next, it identifies clusters corresponding to doublets from different samples, checks these for plausibility, and increases the cluster number if not enough plausible doublet clusters are identified. Finally, it merges added clusters (if any) until the cluster number equals the number of pooled samples (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). <xref ref-type="sec" rid="S15">Section 5.1</xref> describes <italic>demoTape</italic> in greater detail.</p><p id="P10">To assess the performance of <italic>demoTape,</italic> We sequenced three lymphoma patient samples individually (S1, S2, and S3) and multiplexed (MS1) on the Tapestri platform (<xref ref-type="sec" rid="S18">Section 5.4</xref>). After processing and applying default filters (<xref ref-type="sec" rid="S19">Section 5.5</xref>), S1 contained 3732 cells and 52 SNPs, S2 contained 7911 cells and 37 SNPs, S3 contained 3677 cells and 40 SNPs, and MS1 contained 4314 cells and 84 SNPs (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). In total, 20 SNPs were called in all four samples, and 2, 1, and 3 SNPs were called only in S1, S2, and S3, respectively. MS1 contained 15 SNPs not called in the individual samples, out of which 13 showed a low variant allele frequency (VAF), i.e., the average VAF at that locus, weighted by the read depth per cell, was less than 20 %. The average VAF of the remaining two SNPs detected only in MS1 were 42 % and 50 %.</p><p id="P11">Using the separately sequenced samples, we generated computationally multiplexed samples with known ground truth, allowing direct evaluation of <italic>demoTape.</italic> Additionally, we downsampled the cells of the individual samples to assess the effect on the inferred clonal composition. Finally, we analyzed and compared the individual samples with the multiplexed one and assigned the demultiplexed clusters to patients (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p></sec><sec id="S7"><label>2.2</label><title>Distance-based multiplexing is reliable on simulated data</title><p id="P12">To simulate multiplexed samples with known ground truth, we sampled single cells from S1, S2, and S3, generated doublets consisting of cells from different samples, and filtered loci and cells of the synthetic multiplexed sample (see <xref ref-type="sec" rid="S16">Section 5.2</xref>). In total, we simulated 48 datasets with different mixing ratios and doublet rates and repeated each simulation 30 times. As even mixing ratios cannot be assumed, along with equal ratios of 33:33:33% we simulated all possible combinations of the uneven ratios of 20:40:40% (three combinations), 20:30:50% (six combinations), and 10:30:60% (six combinations). For all mixing ratios, we also simulated doublets with rates of 10, 20, and 30%. As no methods tailored explicitly at scDNA-seq exist, to the best of our knowledge, we ran souporcell [<xref ref-type="bibr" rid="R22">22</xref>], scSplit [<xref ref-type="bibr" rid="R21">21</xref>], and Vireo [<xref ref-type="bibr" rid="R25">25</xref>] for comparison, three state-of-the-art methods for demultiplexing scRNA-seq data based on genotypes. We evaluated the accuracy of cell assignments, i.e., the fraction of cells assigned to the correct sample or, for doublets, to a general doublet cluster, using the V-measure [<xref ref-type="bibr" rid="R26">26</xref>]. We used a general doublet cluster instead of the three specific ones (S1+S2, S1+S3, and S1+S2) for a fair comparison, as scSplit only infers doublets but not their composition.</p><p id="P13">In all simulated cases, except the ones with even mixing ratios, Vireo performed worst, mainly resulting from a large fraction of cells that Vireo could not assign to any sample or doublet. With even mixing rations, scSplit performed worst and second worst in all other cases. <italic>DemoTape</italic> and souporcell performed equally well with V-measures close to 1, indicating nearly perfect demultiplexing, for even mixing ratios or slightly uneven mixing ratios of 20:40:40%, independent of the simulated doublets. In all cases, <italic>demoTape</italic> performed slightly better; the median V-measure difference between the two methods was smaller or equal to 0.01 (<xref ref-type="fig" rid="F2">Fig. 2a and b</xref>). In simulation scenarios with 20:30:50% and 10:30:60% mixing ratios, <italic>demoTape</italic> outperformed souporcell (<xref ref-type="fig" rid="F2">Fig. 2c and d</xref>). Especially at high doublet rates, souporcells V-measure decreased to 0.9 (10:30:60% mixing ratio with 30% doublets), whereas <italic>demoTape’s</italic> demultiplexing remained accurate with a median V-measure of over 0.995.</p><p id="P14">Our simulations showed that <italic>demoTape</italic> outperformed the scRNA-seq methods, achieving the highest demultiplexing accuracy on all simulated datasets. For all simulated datasets, its median V-measure was above 0.981, and its average V-measure was 0.958.</p></sec><sec id="S8"><label>2.3</label><title>Clonal information remains consistent with smaller cell numbers</title><p id="P15">To assess the effect of the cell number on the inferred clonal composition, we downsampled the number of cells in S1, S2, and S3 without replacement from the total number of cells to 2000, 1000, and 500 cells; for S2 (7911 cells), we additionally downsampled the cell number to 4000 cells. We repeated each downsampling ten times. Then, we processed the downsampled datasets, filtered uninformative, i.e., germline, SNPs (<xref ref-type="sec" rid="S14">Section 5</xref>), and ran the three state-of-the-art scDNA-seq clustering methods SCG [<xref ref-type="bibr" rid="R11">11</xref>], BnpC [<xref ref-type="bibr" rid="R12">12</xref>], and COMPASS [<xref ref-type="bibr" rid="R13">13</xref>]. SCG and BnpC infer clusters with their corresponding genotype profile and outperformed other scDNA-seq clustering methods in a recently published benchmarking study [<xref ref-type="bibr" rid="R27">27</xref>]. COMPASS has been designed especially for Tapestri data and infers a mutation tree, where nodes represent clusters with a certain genotype profile, and cells are assigned to these nodes. We ran SCG and COMPASS with doublet rates of 8 and 25 %, the former being the value reported by MissionBio, and the latter being close to the observed rate in MS1. BnpC does not model doublets explicitly. To measure the effect of the downsampling on the inferred clusters, we applied the three clustering methods ten times to each complete sample, containing all cells, and took the inferred clusters as ground truth. Then, we calculated the average adjusted Rand index (ARI) [<xref ref-type="bibr" rid="R28">28</xref>] between the clusters inferred from the downsampled and the complete datasets, for each clustering method, where higher values indicate a higher similarity.</p><p id="P16">For S1, the number of reported SNPs decreased steadily from 18 in the complete sample to an average of 6 in samples with 500 cells, with the highest decrease from 13 to seven appearing from 1000 to 500 cells (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). The median number of inferred clusters was relatively stable at three (±0.5) for BnpC and between one and two for SCG, independent of the doubled rate (<xref ref-type="fig" rid="F3">Fig. 3D</xref>). Remarkably, the median number of clusters inferred by SCG on the full dataset was 1 and 1.5 (8 and 25% doublets, respectively), indicating that SCG was unable to identify meaningful clusters. On the complete sample, SCG’s median ARI was 0.8/0.4 (8/25 % doublets), and BnpC’s was 0.66, revealing a low clustering consistency when run multiple times on the same data (<xref ref-type="fig" rid="F3">Fig. 3G</xref>). The unchanged ARI of 0.8 for SCG runs with 8% doublets was due to the inference of only one cluster in most runs (especially in 8/10 ground truth runs), except for 500 cells, where 2 clusters were inferred (ARI = 0.2). For SCG runs with 25 % doublets, 1.5 clusters were inferred on the complete sample, but only one cluster in most subsample runs, leading to an ARI of 0.5. BnpCs ARI decreased steadily with smaller sample sizes to 0.18 (500 cells). COMPASS, in contrast, always inferred the same six clusters on the complete sample (ARI = 1), a median of six clusters on samples with 2000 cells (ARI = 0.86/0.92, for 8/25 % doublets), and five and three clusters for 1000 and 500 cells, respectively. Accordingly, its ARI also declined, with the highest decrease occurring at 500 cells (0.55/0.66 to 0, for 8/25 % doublets).</p><p id="P17">In patient S2, fewer informative SNPs were reported, although more cells were sequenced. Of the 15 SNPs reported in the complete sample, 12 were found in the samples with 4000 cells and six in the samples with 500 cells (<xref ref-type="fig" rid="F3">Fig. 3B</xref>). Here, equally high decreases (three reported SNPs fewer) occurred when changing the sample size from the complete sample to 4000 cells and from 1000 to 500 cells. Again, the median number of clusters inferred by SCG on the complete sample was one and remained between one and three on smaller sample sizes (<xref ref-type="fig" rid="F3">Fig. 3E</xref>), resulting in ARI values below 0.6 in all runs (<xref ref-type="fig" rid="F3">Fig. 3F</xref>). BnpC inferred five clusters (median) on the complete sample and four on samples with fewer cells, except for 4000 cells, where the median cluster number was 2.5. Its ARI declined from an initial 0.68 to 0.13 for 4000 cells and remained low (&lt;0.1) for smaller sample sizes. COMPASS inferred five clusters on the complete sample and reported, when run with a doublet rate of 25 %, the same number for all sample sizes, except for 500 cells, where it dropped to three. Running COMPASS with 8 % doublets resulted in higher variations in the cluster number, ranging from four to 5.5 (median) for all sample sizes greater than 500 cells and three for samples with 500 cells. On the complete sample, its ARI was 1.0/0.99 (doublet rate) again, decreasing steadily with a smaller sample size. For 8 % doublets, it remained high (0.95) for 4000 cells, decreased to 0.61 for 1000 cells, and then to 0.16 for 500 cells. For 25 % doublets, it remained around 0.75 for 1000, 2000, and 4000 cells and decreased to 0.16 for 500 cells.</p><p id="P18">For S3, 14 SNPs were reported in the complete sample, and the highest decrease from eleven to seven SNPs appeared between 1000 and 500 cells (<xref ref-type="fig" rid="F3">Fig. 3G</xref>). In most downsampled datasets, at least one additional SNP, filtered in the complete sample, was reported, indicating uncertain SNPs with filtering values close to the chosen thresholds. On the complete sample, BnpC inferred three and SCG three/four clusters (8/25 % doublets), decreasing to two with fewer cells (&lt;2000) (<xref ref-type="fig" rid="F3">Fig. 3H</xref>). COMPASS, in contrast, inferred eight/nine clusters on the complete sample (8/25% doublets), seven on samples with 1000 and 2000 cells, and three on the samples with 500 cells. With a relatively steady and low number of inferred clusters, SCG’s ARI dropped from an initial 0.80 to 0.60 for 1000 and 0.55 for 500 cells. BnpC inferred the most stable clusters, leading to an ARI above 0.95 for runs with more than 500 cells and an ARI of 0.84 for 500 cells. Relative to the decreasing number of clusters inferred by COMPASS, its ARI decreased from 0.95 to 0.66 for 2000 cells and to 0.53 for 500 cells, for 8 % doublets, and from 0.83 for the complete sample to 0.71 for 2000, 0.62 for 1000, and 0.36 for 500 cells. In contrast to S1 and S2, COMPASS inferred a variable number of clusters on the complete sample (ARI ≠ 1).</p><p id="P19">In summary, our simulations demonstrated that the number of reported SNPs, inferred clusters, and ARI decreased with fewer cells, as expected. However, the number of inferred clusters remained relatively stable with decreasing sample sizes above 500 cells. BnpC and SCG could distinguish only between a few clusters, if at all, likely clustering the cells into healthy and cancer cells. COMPASS inferred more subtle clonal structures, which remained less well preserved with smaller sample sizes, leading to a higher decrease in its ARI. Additionally, we found no clear trend between the two used doublet rates for SCG and COMPASS.</p></sec><sec id="S9"><label>2.4</label><title>Successful demultiplexing reveals a high doublet rate</title><p id="P20">When applied to the multiplexed sample MS1 (<xref ref-type="fig" rid="F4">Fig. 4B</xref>), <italic>demoTape</italic> inferred one cluster with 944 (blue, 22 %), one with 1302 (yellow, 30%), and one with 966 (green, 22%) cells. Accordingly, 25% of the cells were assigned to doublet clusters, marked in <xref ref-type="fig" rid="F4">Figure 4B</xref> by two colors in the bars indicating the cluster assignment. 25 % represents a lower bound for the overall doublet rate, as it does not account for doublets of two cells from the same cluster. By assuming the same doublet rate for cells within clusters, the estimated total doublet rate is around 50 %.</p><p id="P21">Visual inspection of the VAF heatmap showed a clear separation of the data into three blocks, corresponding to the inferred clusters. Especially SNPs called in just one sample correlated clearly with the inferred clusters. For example, at chr1:3638674 (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, first column/SNP), a homozygous SNP (VAF ≈ 1: red) was called in the yellow cluster and a wildtype genotype (VAF ≈ 0: white) in the blue and green clusters. In the doublet clusters containing cells from the yellow clone, heterozygous SNPs (VAF ≈ 0.5: orange) were called in most cells, whereas in the doublet cluster without cells from the yellow clone (i.e., only green and blue cells), wildtype genotypes were called predominantly.</p><p id="P22">By evaluating the presence of patient-specific SNPs (<xref ref-type="fig" rid="F4">Fig. 4A</xref>; S1: 22 SNPs, S2: 7 SNPs, S3: 10 SNPs) in the inferred clusters in MS1, we identified the blue cluster as S1 (MS1:S1), the yellow one as S2 (MS1:S2), and the green one as S3 (MS1:S3). When comparing the SNPs reported from the individual samples with the demultiplexed ones, most SNPs were detected in both samples (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). Counter-intuitively, more unique SNPs were reported in the demultiplexed samples (5, 9, and 7 for MS1:S1, MS2:S2, and MS3:S3, respectively). The main reason for this is that more SNPs are reported initially in the individual samples, leading to more SNPs within close genomic proximity, which are subsequently filtered as they are likely sequencing artifacts.</p></sec><sec id="S10"><label>2.5</label><title>SNP profiles enable the assignment of demultiplexed clusters to patients</title><p id="P23">If multiplexing is applied in practice to save labor and expenses, individually sequenced samples are generally not available. Accordingly, either additional matched SNP data per patient or a combinatorial approach are necessary to assign the demultiplexed clusters back to patients. For matched SNP data, patient-specific SNPs from any source, e.g., from SNP assay, scRNA-seq data, or whole-exome/genome bulk sequencing, can be used as long as enough patient-specific SNPs overlap with the multiplexed data to assign clusters unambiguously to patients. For combinatorial demultiplexing, careful experimental design [<xref ref-type="bibr" rid="R29">29</xref>], relying on splitting and multiplexing the samples according to specific patterns, is required. Here, we used patient-specific SNPs derived from (1) SNP arrays and (2) matched scRNA-seq data (see <xref ref-type="sec" rid="S20">Section 5.6</xref>) to assign the demultiplexed clusters to patients.</p><p id="P24">First, we defined all loci as relevant that were reported after demultiplexing in the individual clusters MS1:S1, MS1:S2, and MS1:S3 or in the multiplexed sample MS1. To obtain the VAF information at all loci, also wildtype ones, we reran the SNP filtering of the demultiplexed clusters but included all relevant loci. Next, we obtained the SNP profiles for the clusters by averaging the VAFs over all cells and excluded SNPs with similar VAF in all scDNA-seq data (VAF &gt;95 %, VAF &lt;5 %, or VAF 45–55%), as they are uninformative for distinguishing between clusters.</p><p id="P25">Next, we identified the loci from the SNP arrays and scRNA-seq data that overlap with the cluster SNP profiles, resulting in 37 SNPs overlapping with the scRNA-seq data (<xref ref-type="fig" rid="F4">Fig. 4D</xref>) and seven with the SNP arrays (<xref ref-type="fig" rid="F4">Fig. 4F</xref>). Based on these loci, we calculated the normalized Euclidean distance between between all pairs of SNP profiles and iteratively, starting with the smallest distance, assigned the cluster to the patient SNP profile with the lowest distance, excluding that cluster and patient profile from further assignments afterward.</p><p id="P26">The SNP profiles derived from scRNA-seq data and SNP arrays were sufficient to assign the demultiplexed samples unambiguously back to patients. The distance matrices of the scRNA-seq data (<xref ref-type="fig" rid="F4">Fig. 4E</xref>) and SNP array (<xref ref-type="fig" rid="F4">Fig. 4G</xref>) profiles showed clearly that cluster MS1:S1 is closest to S1, cluster MS1:S2 closest to S2, and cluster MS1:S3 closest to S3. Even the assignment of cluster MS3:S3 to S3 based on scRNA-seq is distinct, although the scRNA-seq profile of S3 contains 21 missing values.</p></sec><sec id="S11"><label>2.6</label><title>Comparison of single and multiplexed samples</title><p id="P27">To compare the called SNPs and downstream analysis between the demultiplexed and the individually sequenced data, we reran the filtering for each demultiplexed cluster separately, filtered uninformative SNPs (<xref ref-type="sec" rid="S19">Section 5.5</xref>), and inferred the evolutionary history of each sample using COMPASS.</p><p id="P28">The VAF heatmaps of S1 and MS1:1 were similar in large parts: 12 out of 17 informative SNPs reported in S1 were also reported in MS1:S1, and three SNPs detected in MS1:S1 were absent in S1 (<xref ref-type="fig" rid="F5">Fig. 5A</xref>). Accordingly, the inferred event trees also showed similar structures, differing mainly in the placement of SNPs chr6:106534484 and chr15:93545223. In S1, chr6:106534484 was an early cancer event present in all cancer cells, and chr15:93545223 defined a cancer clone (<xref ref-type="fig" rid="F5">Fig. 5B</xref>). In MS1:S1, in contrast, chr6:106534484 was only present in a cancer subpopulation, and chr15:93545223 was present in all cells, hence, likely being a germline event (<xref ref-type="fig" rid="F5">Fig. 5C</xref>). All other differences resulted from SNPs not called in one of the samples. Except for SNP chr6:106534484, both trees contained four cancer clones, and the relative clone sizes were also similar, where applicable (chr16:28944230: 12/13%; chr13:103498499 8/8%; chr6:106534484 20/23% for S1/MS1:S1, respectively).</p><p id="P29">In S2 and MS1:S2, we also observed similar genotype heatmaps and tree structures: nine out of eleven informative SNPs found in S1 intersected with the SNPs reported in MS1:2, which contained four informative SNPs not found in S2 (<xref ref-type="fig" rid="F5">Fig. 5D</xref>). The inferred trees showed similar evolutionary trajectories, differing only in the placement of SNPs chr11:108213903 and chr15:93545223, as well as SNPs unique to one of the samples. In S2, chr15:93545223 was inferred as a germline SNP and chr11:108213903 defined a cancer subclone (<xref ref-type="fig" rid="F5">Fig. 5E</xref>), whereas in MS1:S2, both SNPs were initial cancer-forming events present in all cancer cells (<xref ref-type="fig" rid="F5">Fig. 5F</xref>). The size of comparable cancer clones was again similar: 13/17% for chr16:28944230, 36/31 % for chr11:108213903, and 9/7% for chr13:103498499, respectively for S2/MS1:S2.</p><p id="P30">Out of 14 informative SNPs detected in S3, ten overlapped with the SNPs of MS1:S3, and MS1:S3 contained five SNPs not reported in S3 (<xref ref-type="fig" rid="F5">Fig. 5G</xref>). Besides the SNPs unique to only one of the samples, the inferred trees varied only in the SNP chr6:106534419. In S3, it was placed in the same event node with two SNPs on chromosome 11 (<xref ref-type="fig" rid="F5">Fig. 5H</xref>), whereas in MS1:S3, the two chromosome-11 SNPs occurred before chr6:106534419 (<xref ref-type="fig" rid="F5">Fig. 5I</xref>). The only node directly comparable in size contained the SNP chr16:28944230, where the relative sizes were 16/18 % for S3/MS1:S3.</p><p id="P31">Overall, the SNPs and trees of the individual and demultiplexed samples overlapped widely for all three samples. The individually sequenced and multiplexed samples missed a similar amount of informative SNPs present in their counterpart, the inferred trees shared a similar structure, and comparable clones were alike in size. It is apparent from the VAF heatmaps that differences in the reported SNPs originated not from technical variations but from the filtering steps, as all SNP loci were covered in the individually sequenced and the demultiplexed samples. Instead, the differences resulted from SNPs classified as uninformative germline SNPs in one of the samples but passed the filtering thresholds in the other. Visual inspection of the VAF heatmaps and the inferred trees revealed that not all germline SNPs were filtered (e.g., <xref ref-type="fig" rid="F5">Fig. 5A</xref>: chr7:148504716).</p></sec></sec><sec id="S12" sec-type="discussion"><label>3</label><title>Discussion</title><p id="P32">Recent technological advances enable the DNA sequencing of thousands of individual cells, providing a snapshot of the DNA of the sequenced tissue at single-cell resolution. However, scDNA-seq is still labor- and cost-intensive, hampering its widespread use. In this work, we introduce <italic>demoTape,</italic> a computational distance-based demultiplexing approach for targeted scDNA-seq data. Multiplexing allows the preparation and sequencing of multiple samples jointly, decreasing the expenses and working hours required per sample. First, we sequenced three samples individually and used these to simulate datasets with known ground truth. <italic>DemoTape</italic> outperformed state-of-the-art scRNA-seq methods and demultiplexed the cells with high accuracy. When downsampling the number of cells in each of the three individual samples, the clustering consistency decreased for the three applied clustering algorithms, as expected. However, the number of SNPs, clusters, and ARI remained relatively constant for samples with at least 1000 cells and decreased highest from 1000 to 500 cells. Accordingly, these findings suggest avoiding multiplexing samples such that the number of cells per sample drops to 500. With the currently achieved average cell numbers of 5000 to 6000 cells per run [<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R31">31</xref>] and doublet rates between 8 and 25 %, this suggests that three or four samples can readily be multiplexed, but multiplexing more than five samples may not be advisable.</p><p id="P33">We multiplexed, sequenced, and analyzed the three samples jointly. Surprisingly, the demultiplexing revealed that 25 % of the non-empty sequenced droplets were doublets with cells from different samples. By assuming the same rate for doublets within each sample, the total doublet rate would be around 50 %. Next, we successfully assigned the inferred clusters to the original samples, using SNPs called in matched scRNA-seq samples or SNP-array data, demonstrating the practicality of the multiplexing approach. Finally, we compared the clonal compositions and inferred SNP trees of the demultiplexed samples with the individual ones, finding a high consistency between the genotypes and tree structures for all three samples. However, more precise filtering of germline SNPs while retaining somatic SNPs remains an open challenge, as VAF distributions were rather noisy, with varying noise levels per SNP/amplicon.</p><p id="P34">Similar to approaches for the computational demultiplexing of scRNA-seq data like souporcell or scSplit, <italic>demoTape</italic> is based on the data-inherent SNPs and renders additional biochemical assays redundant. However, the underlying input data varies greatly: scRNA-seq data does not amplify the sequenced molecules and covers only SNPs in expressed genes, making it sparse and noisy. Additionally, the widely used 10x Genomics protocols sequence only the 3’ or 5’ ends of genes, leading to even sparser data. scDNA-seq data, in contrast, is smaller in size and covers most target sites, resulting in distinct genotype profiles per cell and sample. Using our proposed cell distance, these can be used to calculate distances between SNP profiles, enabling accurate and fast demultiplexing of targeted scDNA-seq data. Cardielloe <italic>et al.</italic> [<xref ref-type="bibr" rid="R32">32</xref>] recently showed that genotype-based demultiplexing of scRNA-seq data works for non-human organisms, and so should also apply to scDNA-seq with even higher accuracy. The expansion of genotype-based demultiplexing of single cells to species beyond humans and data modalities beyond RNA enables the investigation of broader questions requiring large amounts of data.</p><p id="P35">The high number of doublets led to a loss of 25 % of the data, which, depending on the number of sequenced cells and the mixing ratio, could bias the downstream analysis and hamper accurate inference of the clonal composition. Given that we know the clonal composition of the individual samples (e.g., through clustering methods like the ones applied here), doublets could be split and reassigned to clones from different samples. However, this would correct the size of the inferred clones only; clones missed due to small size could not be recovered by this approach. When run multiple times on the complete sample, SCG and BnpC inferred a low number of clusters, likely distinguishing only between healthy and cancer cells, and these clusters were also inconsistent for two out of three samples. COMPASS inferred more clusters, possibly identifying cancer subpopulations better, but in one out of three samples, the inferred clusters were also inconsistent between runs on the complete sample. These findings suggest that methods designed especially for targeted scDNA-seq data are superior to general ones but still leave room for improvement, and further method development remains highly desirable. For example, one could use the noise profiles from our multiplexing experiment, where it is easy to distinguish between true SNPs and background noise based on the individually sequenced samples, and integrate these rates into the clustering methods. It became apparent that the filtering thresholds in the data processing play a crucial role in the quality and quantity of the reported SNPs. For downsampled and demultiplexed samples, for example, to account for the smaller sample size, we changed the minimum frequency for SNP loci to be reported (from 1% of cells to 50 cells). A systematic evaluation of the filtering thresholds remains open. Our study suggests that the data quality would benefit from fine-tuned thresholds and additional filters, likely also easing downstream analysis and preventing false positives, easing the future use of targeted scDNA-seq.</p></sec><sec id="S13" sec-type="conclusions"><label>4</label><title>Conclusions</title><p id="P36">In summary, we introduced <italic>demoTape,</italic> an accurate demultiplexing approach for targeted scDNA-seq data based on the distance between cellular VAFs. When applied, <italic>demoTape</italic> revealed that the clonal composition is mainly retained despite the lower cell number. Multiplexing without additional biochemical assays increases throughput and reduces the working time and costs required per sample, possibly promoting its broader use. Especially for genetic diseases like cancer, more DNA-seq data at single-cell resolution offers great potential to understand the mechanisms underlying carcinogenesis and to adjust patient treatment according to personal genotype profiles.</p></sec><sec id="S14" sec-type="methods"><label>5</label><title>Methods</title><p id="P37">This section describes the demultiplexing algorithm and the simulation experiments in detail, followed by an overview of the patient samples obtained and their processing and a summary of the software implementation.</p><sec id="S15"><label>5.1</label><title>Computational demultiplexing of samples</title><p id="P38">Given a sequenced and processed multiplexed sample containing cells from <italic>s</italic> individual samples, for demultiplexing <italic>demoTape</italic> requires the read count matrix <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℕ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <italic>n</italic> is the number of cells and <italic>m</italic> is the number of SNP sites. Each <italic>x<sub>ij</sub></italic> = (<italic>a<sub>ij</sub></italic>, <italic>r<sub>ij</sub></italic>, <italic>t<sub>ij</sub></italic>) contains the read count <italic>a<sub>ij</sub></italic> supporting the alternative allele, the read count <italic>r<sub>ij</sub></italic> supporting the reference allele, and the total read count <italic>t<sub>ij</sub></italic> = <italic>a<sub>ij</sub></italic> + <italic>r<sub>ij</sub></italic> in cell <italic>i</italic> at site <italic>j</italic>. <italic>X</italic> can be generated from the Loom or H5 files that are part of the Tapestri pipeline output after filtering these with the Mosaic software package [<xref ref-type="bibr" rid="R33">33</xref>].</p><p id="P39">By modeling the read counts with a binomial distribution and assuming that they are i.i.d. per site, we can define the likelihood for cell <italic>i</italic> as <disp-formula id="FD1"><label>(1)</label><mml:math id="M2"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p id="P40">The likelihood is maximal at <disp-formula id="FD2"><label>(2)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the observed variant allele frequency (VAF) in cell <italic>i</italic> at site <italic>j</italic>.</p><p id="P41">As distance between two cells <italic>i</italic> and <italic>i</italic>′ we define their log-likelihood ratio in a separate versus a joint binomial model. Specifically, we consider the ratio between the maximum likelihood given that the read counts per cell are samples from independent VAFs <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math></inline-formula>, and the maximum likelihood give that the read counts for both cells are sampled from a joint VAF <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This quantity is small if <inline-formula><mml:math id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math></inline-formula> are similar and increases with differences in the VAFs. The log-likelihood distance is defined as <disp-formula id="FD3"><label>(3)</label><mml:math id="M10"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&amp;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P42">To normalize the distance to values between 0 and 1, we divide it by the maximal possible distance between two cells <disp-formula id="FD4"><label>(4)</label><mml:math id="M11"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mi>log</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math></disp-formula> where all reads in one cell support the alternative while all reads in the other cells support the reference allele, or vice versa. Accordingly, the normalized distance between two cells is <disp-formula id="FD5"><label>(5)</label><mml:math id="M12"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P43"><italic>DemoTape</italic> calculates the pairwise distance between all cells and applies hierarchical agglomerative clustering (HAC) with Ward’s linkage [<xref ref-type="bibr" rid="R34">34</xref>] to generate a dendrogram. Next, <italic>demoTape</italic> cuts the dendrogram such that <inline-formula><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> clusters <italic>k</italic> = {1, 2,..., <italic>n<sub>s</sub></italic>} are defined, representing <italic>s</italic> individual samples and <inline-formula><mml:math id="M14"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> doublet clusters. The doublet clusters contain sequences obtained from two distinct samples, i.e., two cells encapsulated in the same droplet due to a technical error. The generated cluster assignment can be represented as a vector <italic>c</italic> ∈ <italic>k<sup>n</sup></italic>, where <italic>c<sub>i</sub></italic> is the assigned cluster of cell <italic>i</italic>. To identify which clusters correspond to doublets and which to individual samples, <italic>demoTape</italic> defines a cluster profile matrix <inline-formula><mml:math id="M15"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℕ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. First, the average read depth and VAF weighted by the read depth is calculated for each cluster <italic>k</italic> at each position <italic>j</italic>: <disp-formula id="FD6"><label>(6)</label><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> <disp-formula id="FD7"><label>(7)</label><mml:math id="M17"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where [·] is the indicator function, which is 1 if the expression inside the brackets is true and 0 otherwise. Using these values, the cluster profiles are then defined as <disp-formula id="FD8"><label>(8)</label><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where ⌊·⌋ is the result of rounding to the nearest integer.</p><p id="P44">Next, <italic>demoTape</italic> creates profiles of all <inline-formula><mml:math id="M19"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> hypothetical doublet clusters <italic>d</italic> = {(1, 2), (1,3),..., (<italic>n<sub>s</sub></italic> – 1, <italic>n<sub>s</sub></italic>)}, where <inline-formula><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> indicates the two clusters <inline-formula><mml:math id="M21"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> forming the hypothetical doublet cluster <italic>d<sub>i</sub>.</italic> Doublet cluster profiles <inline-formula><mml:math id="M23"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℕ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are computed according to equations <xref ref-type="disp-formula" rid="FD6">6</xref>, <xref ref-type="disp-formula" rid="FD7">7</xref>, and <xref ref-type="disp-formula" rid="FD8">8</xref> by averaging over all cells assigned to the two clusters <italic>d</italic><sub><italic>i</italic>,1</sub> and <italic>d</italic><sub><italic>i</italic>,2</sub>.</p><p id="P45">Given the <italic>n<sub>s</sub></italic> inferred cluster profiles and the <italic>n<sub>d</sub></italic> hypothetical doublet cluster profiles, <italic>demoTape</italic> calculates the distance matrix <italic>Y</italic> ∈ [0, 1]<sup><italic>n<sub>s</sub></italic>×<italic>n<sub>d</sub></italic></sup> between the profiles using Equation (5), where <italic>y<sub>i,j</sub></italic> is the distance between the cluster profile <inline-formula><mml:math id="M24"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and the hypothetical doublet cluster profile <inline-formula><mml:math id="M25"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Distances between cluster <italic>i</italic> and hypothetical doublet clusters including <italic>i</italic>, e.g., between cluster 1 and the hypothetical doublet cluster (1, 2), are set to 1 as doublet clusters cannot include themselves. Additionally, <italic>y·,<sub>j</sub></italic> is set to 1 if the distance between clusters <italic>d</italic><sub><italic>j</italic>,1</sub> and <italic>d</italic><sub><italic>j</italic>,2</sub> is very small (&lt;0.05), indicating that <italic>d</italic><sub><italic>j</italic>,1</sub> and <italic>d</italic><sub><italic>j</italic>,2</sub> are clones from the same sample, inferred through an insufficient cutting of the dendrogram. Accordingly, <italic>demoTape</italic> can only demultiplex samples that differ by an average distance greater than 0.05, a hyperparameter changeable by the user, as its unable to differentiate between samples and clonal structures within a sample otherwise.</p><p id="P46"><italic>DemoTape</italic> then identifies <italic>n<sub>d</sub></italic> doublet clusters according to the following procedure (<xref ref-type="boxed-text" rid="BX1">Algorithm 1</xref>): First, <italic>demoTape</italic> takes the smallest distance <inline-formula><mml:math id="M26"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> between the cluster and hypothetical doublet cluster profiles, indicating that the inferred cluster <italic>k<sub>i</sub></italic> is likely a doublet cluster composed of clusters <italic>d</italic><sub><italic>j</italic>,1</sub> and <italic>d</italic><sub><italic>j</italic>,2</sub>. To assess if this is true or if the tree cutting generated insufficient clusters, e.g., due to a high distance between two clones within a sample, <italic>demoTape</italic> investigates the homozygous SNP and wildtype loci in the three considered clusters, as these are particularly informative about true doublets (see <xref ref-type="sec" rid="S9">Section 2.4</xref>). Given a VAF cutoff <italic>α</italic> to define homozygous and wildtype loci, e.g., <italic>α</italic> = 0.05, <italic>demoTape</italic> defines loci in individual sample clusters as homozygous if the VAF is ≥ 1 – <italic>α</italic><sup>2</sup> and as wildtype if the VAF is ≤ <italic>α</italic>. Accordingly, loci in doublet clusters are defined as homozygous if the VAF is ≥ 1 – <italic>α</italic><sup>2</sup> and as wildtype if the VAF &lt; <italic>α</italic><sup>2</sup>. Wildtype and homozygous SNP loci in a doublet cluster require also wildtype/homozygous SNP loci in both individual sample clusters, respectively, since reads from both samples are aggregated and would otherwise lead to an intermediate VAF. Similarly, homozygous SNPs in just one individual sample cannot result in a homozygous SNP in the doublet cluster. Therefore, <italic>demoTape</italic> counts if all wildtype/homozygous SNP loci in the doublet cluster are also wildtype/homozygous SNP loci in the two individual sample clusters, if all homozygous SNP loci in both individual sample clusters are also homozygous in the doublet cluster, and if loci that are homozygous in just one individual sample cluster are neither a wildtype nor a homozygous SNP in the doublet cluster. If this is true for all but maximum one site, allowing some uncertainty, <italic>demoTape</italic> assumes <italic>k<sub>i</sub></italic> to be a true doublet cluster (function HomozygousSitesMismatch in <xref ref-type="boxed-text" rid="BX1">Algorithm 1</xref>). In that case, <italic>demoTape</italic> removes the rows <italic>i</italic>, <italic>d</italic><sub><italic>j</italic>,1</sub>, and <italic>d</italic><sub><italic>j</italic>,2</sub>, and all columns where <italic>d</italic><sub>.,1</sub> = <italic>k<sub>i</sub></italic> or <italic>d</italic><sub>.,2</sub> = <italic>k<sub>i</sub></italic> from <italic><bold>Y</bold></italic>, and proceeds identifying the next doublet. In case of insufficient clusters, <italic>demoTape</italic> increases the number of clusters generated through dendrogram cutting by one, recalculates <italic><bold>Y</bold></italic> accordingly, and repeats the procedure.</p><p id="P47">If the number of clusters was not increased, the remaining <italic>s</italic> clusters are the demultiplexed samples. Otherwise, an additional step is required to merge single clusters until <italic>demoTape</italic> obtains <italic>s</italic> clusters. For this, <italic>demoTape</italic> merges the two clusters with the closest distance whose merging does not conflict with the inferred doublet clusters. A conflict exists if any <italic>d</italic><sub><italic>i</italic>,1</sub> = <italic>d</italic><sub><italic>i</italic>,2</sub> or <italic>d<sub>i</sub></italic> = <italic>d<sub>j</sub></italic> through the merge, i.e., if a doublet becomes a single cluster or two doublet clusters become identical. If <italic>demoTape</italic> cannot merge two clusters without a conflict, it merges the two closest single clusters and removes the obsolete doublet cluster.</p></sec><sec id="S16"><label>5.2</label><title>Simulation of multiplexed samples</title><p id="P48">To generate multiplexed samples with known ground truth, we sampled cells without replacement from the patient samples S1, S2, and S3 according to the mixing ratio. If sites were not sequenced in one or two patients, we set their genotypes to missing values (3) in the corresponding cells. In all simulation runs, we sampled (1 + <italic>δ</italic>)× 3677 cells, where 3677 is the smallest number of sequenced cells in S1, S2, and S3, and <italic>δ</italic> is the doublet rate to simulate. To generate doublets, we chose two patients with probabilities proportional to the mixing ratio and subsampled one cell per patient from the previously sampled cells. For each doublet, we generated the data per locus as following: If the same genotype was called in both cells, we assigned this genotype to the doublet. If one cell had a missing value, we assigned the genotype of the other cell. In any other case, we assigned a heterozygous genotype. As total read depth, alternative allele read depth, reference allele read depth, and genotype quality (GQ), we took the rounded mean of the two cells. Subsequently, we applied the Mosaic filters on the subsampled cells and doublets, treating them as one sample.</p><boxed-text id="BX1" position="anchor" orientation="portrait"><caption><title>Algorithm 1: Identification of doublet clusters</title></caption><p id="P49"><bold>Input</bold> : Genotype matrix <italic><bold>X</bold></italic> (size: <italic>n</italic> cells × <italic>m</italic> sites × 3 read count values), cell dendrogram <italic>Z</italic>, sample number <italic>s</italic></p><p id="P50"><bold>Output</bold>: Set of doublet cluster ids <italic>s<sub>d</sub></italic></p><p id="P51">1 <italic>s<sub>d</sub></italic> ← ∅</p><p id="P52">2 <inline-formula><mml:math id="M27"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="P53">3 <bold>while</bold> <inline-formula><mml:math id="M28"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <bold>do</bold></p><p id="P54">4   <italic>c</italic> ← Vector(size: <italic>n</italic>) from cutting <italic><bold>Z</bold></italic> to obtain <italic>n<sub>s</sub></italic> clusters    // cell assignments</p><p id="P55">5   <italic><bold>X</bold><sup>p</sup></italic> ← Matrix(size: <italic>n<sub>s</sub></italic> × <italic>m</italic> × 3) according to <xref ref-type="disp-formula" rid="FD8">Eq. 8</xref>   // cluster profiles</p><p id="P56">6   <inline-formula><mml:math id="M29"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="P57">7   <italic>d</italic> ← Matrix(size: <italic>n<sub>d</sub></italic> × 2)   // hypothetical doublet clusters</p><p id="P58">8   <italic>idx</italic> ← 1</p><p id="P59">9   <bold>for</bold> <italic>i</italic> ← 1 <bold>to</bold> <italic>n<sub>s</sub></italic> <bold>do</bold></p><p id="P60">10    <bold>for</bold> <italic>j</italic> ← (<italic>i</italic> + 1) to <italic>n<sub>s</sub></italic> <bold>do</bold></p><p id="P61">11     <italic>d</italic><sub><italic>idx</italic>,1</sub> ← <italic>i</italic></p><p id="P62">12     <italic>d</italic><sub><italic>idx</italic>,2</sub> ← <italic>j</italic></p><p id="P63">13     <italic>idx</italic> ← <italic>idx</italic> + 1</p><p id="P64">14    <bold>end</bold></p><p id="P65">15   <bold>end</bold></p><p id="P66">16   <italic><bold>X</bold><sup>d</sup></italic> ← Matrix(size: <italic>n<sub>d</sub></italic> × <italic>m</italic> × 3) according to <xref ref-type="disp-formula" rid="FD8">Eq. 8</xref> // hyp. doublet cluster profiles</p><p id="P67">17   <italic><bold>Y</bold></italic> ← Matrix(size: <italic>n<sub>s</sub></italic> × <italic>n<sub>d</sub></italic>)</p><p id="P68">18   <bold>for</bold> <italic>i</italic> ← 1 <bold>to</bold> <italic>n<sub>s</sub></italic> <bold>do</bold></p><p id="P69">19    <bold>for</bold> <italic>j</italic> ← 1 <bold>to</bold> <italic>n<sub>d</sub></italic> <bold>do</bold></p><p id="P70">20     <bold>if</bold> <italic>i</italic> = <italic>d</italic><sub><italic>j</italic>,1</sub> ∨ <italic>i</italic> = <italic>d</italic><sub><italic>j</italic>,2</sub> <bold>then</bold></p><p id="P71">21      <italic>y<sub>i,j</sub></italic> ← ∞</p><p id="P72">22     <bold>else if</bold> <inline-formula><mml:math id="M30"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mi>P</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> <bold>then</bold></p><p id="P73">23      <italic>y<sub>i,j</sub></italic> ← ∞</p><p id="P74">24     <bold>else</bold></p><p id="P75">25      <inline-formula><mml:math id="M31"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>j</mml:mi><mml:mi>d</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> according to Eq. 5</p><p id="P76">26     <bold>end</bold></p><p id="P77">27    <bold>end</bold></p><p id="P78">28   <bold>end</bold></p><p id="P79">29   <bold>for</bold> <italic>1</italic> <bold>to</bold> <inline-formula><mml:math id="M32"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <bold>do</bold></p><p id="P80">30    <italic>i<sub>min</sub></italic>, <italic>j<sub>min</sub></italic> ← row and column index of min <italic><bold>Y</bold></italic></p><p id="P81">31    <bold>if</bold> HomozygousSitesMismatch(<italic>i<sub>min</sub></italic>, <italic>d</italic><sub><italic>j<sub>min</sub></italic>,1</sub>: <italic>d</italic><sub><italic>j<sub>min</sub></italic>,2</sub>) ≤ <italic>1</italic> // See text</p><p id="P82">32    <bold>then</bold></p><p id="P83">33     <italic>s<sub>d</sub></italic> ← <italic>s<sub>d</sub></italic> U {<italic>i<sub>min</sub></italic>}</p><p id="P84">34     <bold><italic>Y</italic></bold> ← <italic><bold>Y</bold><sub>i</sub></italic>, remove rows <italic>i<sub>min</sub></italic>, <italic>d</italic><sub><italic>j<sub>min</sub></italic>,1</sub>, <italic>d</italic><sub><italic>j<sub>min</sub></italic>,2</sub></p><p id="P85">35    <italic><bold>Y</bold></italic> ← <bold><italic>Y</italic></bold><sub>.,<italic>j</italic></sub> remove columns where <italic>d</italic><sub><italic>j</italic>,1</sub> = <italic>i<sub>min</sub></italic> ∨ <italic>d</italic><sub><italic>j</italic>,2</sub> = <italic>i<sub>min</sub></italic></p><p id="P86">36    <bold>else</bold></p><p id="P87">37     <italic>s<sub>d</sub></italic> ← ∅</p><p id="P88">38     <italic>n<sub>s</sub></italic> ← <italic>n<sub>s</sub></italic> + 1</p><p id="P89">39     <bold>break</bold></p><p id="P90">40    <bold>end</bold></p><p id="P91">41   <bold>end</bold></p><p id="P92">42 <bold>end</bold></p></boxed-text></sec><sec id="S17"><label>5.3</label><title>Patient sample collection</title><p id="P93">Patients with diffuse large B-cell lymphoma were recruited at the University Hospital Zurich and voluntarily provided informed consent to participate in the study without receiving compensation (Ethical Approval: Zurich, Switzerland, 2019-01744). The samples used in this study consisted of sections obtained from fresh-frozen lymph node biopsies from the diagnostic procedure.</p></sec><sec id="S18"><label>5.4</label><title>Targeted single-cell DNA sequencing</title><p id="P94">Cells of three samples were thawed, resuspended and washed with RPMI (Gibco) supplemented with 10 % fetal bovine serum (Gibco). Debris and aggregates were removed using a 40 μm cell strainer (Corning) and cells were counted with a K2 Cellometer and ViaStain AOPI Staining solution (Nexcelom Bioscience). 0.5 to 1 × 10<sup>6</sup> cells per sample were pooled, pelleted and resuspended in 1 <italic>mL</italic> CSB (Cell Staining Buffer, Biolegend). After an additional centrifugation step, cells were resuspended in 50 μ<italic>L</italic> CSB and counted (Nexcelom Bioscience K2 Cellometer). 1 to 1.5 × 10<sup>6</sup> cells were then labeled with TotalSeq-D Heme Oncology Cocktail (Biolegend) according to the Mission Bio Tapestri protocol with the following adjustments: The lyophylized TotalSeq-D antibodies were resuspended in 120 μ<italic>L</italic> CSB. 50 μ<italic>L</italic> of the reconstituted TotalSeq-D cocktail were added to the blocked cell pool. After labeling, the cells were washed three times in 14 <italic>mL</italic> and two times in 1 <italic>mL</italic>, and finally filtered (40 μ<italic>m</italic> cell strainer, Corning). 100 × 10<sup>3</sup> cells were used for encapsulation in the Tapestri instrument and further processed for single-cell DNA-seq according to Mission Bio’s guidelines (v2 reagents). Tapestri single-cell DNA libraries were sequenced with an Illumina NovaSeq 6000 system. The target panel of 533 amplicons, covering 99 genes, was designed to capture known SNPs and copy-number-variations across a wide set of B-cell lymphoma types and implemented with Mission Bio’s Tapestri Designer.</p></sec><sec id="S19"><label>5.5</label><title>Single cell DNA data processing</title><p id="P95">We processed all samples with the Mission Bio Tapestri DNA pipeline (v2.0.2) with default parameters and filtered the data using Mosaic with default parameters. After demultiplexing MS1, we selected the cells assigned to each cluster and applied the Mosaic filtering on only these cells with default parameters, except for the minMutated filter, which we set to an absolute value of 50 cells instead of 1 % of the cells. We also set the minMutated filter to 50 cells for the downsampling simulations, due to the decreased sample size.</p><p id="P96">For the comparison between the multiplexed and individually sequenced samples and for the downsampling simulations, we filtered the inferred SNPs further to obtain only SNPs informative of the cancer, i.e., exclude germline SNPs and technical artifacts. If in 99% of all cells the VAF was &gt;0.95 or &lt;0.05, SNPs were considered as homozygous germlines or false positives, respectively. To exclude heterozygous germline SNPs or technical artifact, we assume that their VAF is symmetrically distributed around 0.5. We tested for symmetry with a FWER corrected two-sided Kolmogorov–Smirnov test (<italic>α</italic> = 0.01), taking all VAF values 0 &lt; VAF &lt; 0.5 as the first distribution, and 1 – (0.5 &gt; VAF &gt; 1) as the second distribution.</p><p id="P97">For the clustering analysis, we ran COMPASS v1.1 (<monospace>--nchains 1 --chainlength 50000 --CNV 0 --doubletrate <italic>δ</italic></monospace>), <monospace>BnpC v1.0 (-n 1 -r 120 -pp 1 1 -ap 1 1 -cup 0)</monospace>, and SCG (py3 branch: <monospace>num_clusters: 20, model: doublet, alpha_prior: [(1-<italic>δ</italic>)/<italic>δ</italic>, 1]; --max-iters 100000</monospace>). For the comparison between the multiplexed and individually sequenced samples, we ran COMPASS with parameters <monospace>--nchains 4 --chainlength 50000 --CNV 1 --doubletrate 0.25</monospace>. To visualize trees inferred with COMPASS, we concatenated low-frequency nodes with less than 5 % of cells attached by excluding low-frequency leaf nodes and concatenating internal nodes with just one outgoing edge with their descending nodes. If neither was applicable for a low-frequency node, we concatenated it with its parent node if the parent had just one outgoing edge (i.e., the low-frequency node was the only child node) or retained the node otherwise.</p></sec><sec id="S20"><label>5.6</label><title>Single-cell RNA sequencing and data processing</title><p id="P98">Cells were thawed, resuspended and washed with RPMI (Invitrogen) supplemented with penicillin/streptomycin (Invitrogen), L-glutamine (Invitrogen), and 10 % fetal calf serum (FCS, Gibco) (RPMI-FCS) to remove DMSO. Fc-receptors were blocked by adding Human TruStain FcX (Biolegend). Cells were then stained with TotalSeq-C (Biolegend) hash antibodies (1.25 μ<italic>gmL</italic><sup>−1</sup>) for 30 <italic>min</italic> at 4 °<italic>C</italic>, washed 3x in Cell Staining Buffer (Biolegend). Cells were then pooled and stained with TotalSeq-C Human Universal Cocktail (Biolegend) for 30 <italic>min</italic> at 4 °<italic>C</italic>, washed 3x in Cell Staining Buffer and processed using the 5’ HT Single Cell GEX and VDJ v2 platform (10x Genomics) according to manufacturer’s recommendations. Sequencing libraries were prepared following the manufacturer’s recommendations (10x Genomics). Final libraries were pooled and sequenced on an Illumina NovaSeq NovaSeq 6000 system, followed by demultiplexing, FASTQ conversion, and alignment to GRCh38 with the Cell Ranger multi pipeline (v7.0.0, 10x Genomics). Cells with fewer than 500 UMIs, fewer than 250 genes, more than 10% mitochondrial UMIs, with failed antibody library preparation (0 antibody UMI counts in more than 50 % of antibodies), or cells that were part of antibody aggregates (isotype control counts above 3 median absolute deviations) were excluded. Doublets were removed based on three complementary approaches; hash-oligos (hashedDrops() from scran [<xref ref-type="bibr" rid="R35">35</xref>]), SNP profiles and doublet simulation (scDblFinder [<xref ref-type="bibr" rid="R36">36</xref>]). Finally, we clustered cells and called SNPs per cluster using souporcell [<xref ref-type="bibr" rid="R22">22</xref>] (v2.0), and used Picard’s [<xref ref-type="bibr" rid="R37">37</xref>] LiftoverVcf to lift the genome coordinates of the RNA SNPs to GRCh37, matching the DNA coordinates. The scRNA-seq patient data was obtained from multiple sequencing runs with different patients multiplexed in each: S1 was included in one, S2 in eleven, and S3 in two multiplexed sequencing runs.</p></sec><sec id="S21"><label>5.7</label><title>Implementation</title><p id="P99"><italic>DemoTape</italic> is implemented in Python and requires the read counts at all target loci in Loom file format and the number of multiplexed samples as input. Additional SNP profiles obtained from scRNA-seq, SNP assays, or WES/WGS DNA-seq are required to assign the demultiplexed clusters to patients. The pipelines for simulating and downsampling data, and a full analysis and demultiplexing pipeline that takes as input the loom files generated by the Mission Bio Tapestri DNA pipeline, were implemented in Snakemake.</p></sec></sec></body><back><ack id="S22"><title>Acknowledgments</title><p>This work was supported by the European Union’s Horizon 2020 Research and Innovation Program under the Marie Sklodowska-Curie CONTRA grant agreement No. 766030, the European Research Council (ERC) agreement No. 609883, and the LOOP Zurich INTeRCePT project.</p></ack><sec id="S23" sec-type="data-availability"><label>6</label><title>Data and code availability</title><p id="P100">scDNA-seq and scRNA-seq data of the three lymphoma patients are available upon request from <email>thorsten.zenz@usz.ch</email> and <email>niko.beerenwinkel@bsse.ethz.ch</email> according to the data sharing policy of the INTeRCePT consortium (in preparation by the consortium).</p><p id="P101">All original code has been deposited at <ext-link ext-link-type="uri" xlink:href="https://github.com/cbg-ethz/demoTape">https://github.com/cbg-ethz/demoTape</ext-link> and is publicly available.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P102"><bold>Author contributions</bold></p><p id="P103">Conceptualization, N.Be., J.K, and A.M.; Methodology, N.Bo.; Software, N.Bo.; Validation, N.Bo. and J.G.; Formal Analysis, N.Bo.; Investigation, C.B., T.D., M.J.F, M.P., M.R., and S.R.; Resources, C.B., N.Be., M.R., and T.Z.; Data Curation, N.Bo. and J.G.; Writing - Original Draft, N.Bo.; Writing - Review &amp; Editing, N.Be., N.Bo., J.G., J.K. and M.P.; Visualization, N.B.; Supervision, N.Be.; Funding Acquisition, N.Be. and T.Z.; Project administration: T.Z.</p></fn><fn id="FN2" fn-type="conflict"><p id="P104"><bold>Declaration of interests</bold></p><p id="P105">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>Kyle</given-names></name><etal/></person-group><article-title>The Cancer Genome Atlas Pan-Cancer analysis project</article-title><source>Nature Genetics</source><year>2013</year><volume>45</volume><fpage>1113</fpage><lpage>1120</lpage><pub-id pub-id-type="pmcid">PMC3919969</pub-id><pub-id pub-id-type="pmid">24071849</pub-id><pub-id pub-id-type="doi">10.1038/ng.2764</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auton</surname><given-names>Adam</given-names></name><etal/></person-group><article-title>A global reference for human genetic variation</article-title><source>Nature</source><year>2015</year><volume>526</volume><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="pmcid">PMC4750478</pub-id><pub-id pub-id-type="pmid">26432245</pub-id><pub-id pub-id-type="doi">10.1038/nature15393</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christmas</surname><given-names>Matthew J</given-names></name><etal/></person-group><article-title>Evolutionary constraint and innovation across hundreds of placental mammals</article-title><source>Science</source><year>2023</year><volume>380</volume><elocation-id>eabn3943</elocation-id><pub-id pub-id-type="pmcid">PMC10250106</pub-id><pub-id pub-id-type="pmid">37104599</pub-id><pub-id pub-id-type="doi">10.1126/science.abn3943</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazutis</surname><given-names>Linas</given-names></name><name><surname>Gilbert</surname><given-names>John</given-names></name><name><surname>Ung</surname><given-names>W Lloyd</given-names></name><name><surname>Weitz</surname><given-names>David A</given-names></name><name><surname>Griffiths</surname><given-names>Andrew D</given-names></name><name><surname>Heyman</surname><given-names>John A</given-names></name></person-group><article-title>Single-cell analysis and sorting using droplet-based microfluidics</article-title><source>Nature Protocols</source><year>2013</year><volume>8</volume><fpage>870</fpage><lpage>891</lpage><pub-id pub-id-type="pmcid">PMC4128248</pub-id><pub-id pub-id-type="pmid">23558786</pub-id><pub-id pub-id-type="doi">10.1038/nprot.2013.046</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matula</surname><given-names>Kinga</given-names></name><name><surname>Rivello</surname><given-names>Francesca</given-names></name><name><surname>Huck</surname><given-names>Wilhelm TS</given-names></name></person-group><article-title>Single-Cell Analysis Using Droplet Microflu-idics</article-title><source>Advanced Biosystems</source><year>2020</year><volume>4</volume><elocation-id>1900188</elocation-id><pub-id pub-id-type="pmid">32293129</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramón y Cajal</surname><given-names>Santiago</given-names></name><name><surname>Sesé</surname><given-names>Marta</given-names></name><name><surname>Capdevila</surname><given-names>Claudia</given-names></name><name><surname>Aasen</surname><given-names>Trond</given-names></name><name><surname>De Mattos-Arruda</surname><given-names>Leticia</given-names></name><name><surname>Diaz-Cano</surname><given-names>Salvador J</given-names></name><name><surname>Hernández-Losa</surname><given-names>Javier</given-names></name><name><surname>Castellví</surname><given-names>Josep</given-names></name></person-group><article-title>Clinical implications of intratumor heterogeneity: challenges and opportunities</article-title><source>Journal of Molecular Medicine</source><year>2020</year><volume>98</volume><fpage>161</fpage><lpage>177</lpage><pub-id pub-id-type="pmcid">PMC7007907</pub-id><pub-id pub-id-type="pmid">31970428</pub-id><pub-id pub-id-type="doi">10.1007/s00109-020-01874-2</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marusyk</surname><given-names>Andriy</given-names></name><name><surname>Janiszewska</surname><given-names>Michalina</given-names></name><name><surname>Polyak</surname><given-names>Kornelia</given-names></name></person-group><article-title>Intratumor Heterogeneity: The Rosetta Stone of Therapy Resistance</article-title><source>Cancer Cell</source><year>2020</year><volume>37</volume><fpage>471</fpage><lpage>484</lpage><pub-id pub-id-type="pmcid">PMC7181408</pub-id><pub-id pub-id-type="pmid">32289271</pub-id><pub-id pub-id-type="doi">10.1016/j.ccell.2020.03.007</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Shaojun</given-names></name><etal/></person-group><article-title>Longitudinal single-cell profiling reveals molecular heterogeneity and tumor-immune evolution in refractory mantle cell lymphoma</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><fpage>2877</fpage><pub-id pub-id-type="pmcid">PMC8128874</pub-id><pub-id pub-id-type="pmid">34001881</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-22872-z</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshwar</surname><given-names>Amit G</given-names></name><name><surname>Vembu</surname><given-names>Shankar</given-names></name><name><surname>Yung</surname><given-names>Christina K</given-names></name><name><surname>Jang</surname><given-names>Gun Ho</given-names></name><name><surname>Stein</surname><given-names>Lincoln</given-names></name><name><surname>Morris</surname><given-names>Quaid</given-names></name></person-group><article-title>PhyloWGS: Reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title><source>Genome Biology</source><year>2015</year><volume>16</volume><fpage>35</fpage><pub-id pub-id-type="pmcid">PMC4359439</pub-id><pub-id pub-id-type="pmid">25786235</pub-id><pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miura</surname><given-names>Sayaka</given-names></name><name><surname>Vu</surname><given-names>Tracy</given-names></name><name><surname>Deng</surname><given-names>Jiamin</given-names></name><name><surname>Buturla</surname><given-names>Tiffany</given-names></name><name><surname>Oladeinde</surname><given-names>Olumide</given-names></name><name><surname>Choi</surname><given-names>Jiyeong</given-names></name><name><surname>Kumar</surname><given-names>Sudhir</given-names></name></person-group><article-title>Power and pitfalls of computational methods for inferring clone phylogenies and mutation orders from bulk sequencing data</article-title><source>Scientific Reports</source><year>2020</year><volume>10</volume><fpage>3498</fpage><pub-id pub-id-type="pmcid">PMC7044161</pub-id><pub-id pub-id-type="pmid">32103044</pub-id><pub-id pub-id-type="doi">10.1038/s41598-020-59006-2</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>Andrew</given-names></name><etal/></person-group><article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title><source>Nature Methods</source><year>2016</year><volume>13</volume><fpage>573</fpage><lpage>576</lpage><pub-id pub-id-type="pmid">27183439</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borgsmüller</surname><given-names>Nico</given-names></name><name><surname>Bonet</surname><given-names>Jose</given-names></name><name><surname>Marass</surname><given-names>Francesco</given-names></name><name><surname>Gonzalez-Perez</surname><given-names>Abel</given-names></name><name><surname>Lopez-Bigas</surname><given-names>Nuria</given-names></name><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name></person-group><article-title>BnpC: Bayesian non-parametric clustering of single-cell mutation profiles</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>4854</fpage><lpage>4859</lpage><pub-id pub-id-type="pmcid">PMC7750970</pub-id><pub-id pub-id-type="pmid">32592465</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa599</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sollier</surname><given-names>Etienne</given-names></name><name><surname>Kuipers</surname><given-names>Jack</given-names></name><name><surname>Takahashi</surname><given-names>Koichi</given-names></name><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><name><surname>Jahn</surname><given-names>Katharina</given-names></name></person-group><article-title>COMPASS: joint copy number and mutation phylogeny reconstruction from amplicon single-cell sequencing data</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><fpage>4921</fpage><pub-id pub-id-type="pmcid">PMC10427627</pub-id><pub-id pub-id-type="pmid">37582954</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-40378-8</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>Valentine</given-names></name><name><surname>Vento-Tormo</surname><given-names>Roser</given-names></name><name><surname>Teichmann</surname><given-names>Sarah A</given-names></name></person-group><article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title><source>Nature Protocols</source><year>2018</year><volume>13</volume><fpage>599</fpage><lpage>604</lpage><pub-id pub-id-type="pmid">29494575</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gawad</surname><given-names>Charles</given-names></name><name><surname>Koh</surname><given-names>Winston</given-names></name><name><surname>Quake</surname><given-names>Stephen R</given-names></name></person-group><article-title>Single-cell genome sequencing: current state of the science</article-title><source>Nature Reviews Genetics</source><year>2016</year><volume>17</volume><fpage>175</fpage><lpage>188</lpage><pub-id pub-id-type="pmid">26806412</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pellegrino</surname><given-names>Maurizio</given-names></name><etal/></person-group><article-title>High-throughput single-cell DNA sequencing of acute myeloid leukemia tumors with droplet microfluidics</article-title><source>Genome Research</source><year>2018</year><volume>28</volume><fpage>1345</fpage><lpage>1352</lpage><pub-id pub-id-type="pmcid">PMC6120635</pub-id><pub-id pub-id-type="pmid">30087104</pub-id><pub-id pub-id-type="doi">10.1101/gr.232272.117</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Haochen</given-names></name><etal/></person-group><article-title>Application of high-throughput single-nucleus DNA sequencing in pancreatic cancer</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><fpage>749</fpage><pub-id pub-id-type="pmcid">PMC9918733</pub-id><pub-id pub-id-type="pmid">36765116</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-36344-z</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Yulong</given-names></name><name><surname>Xu</surname><given-names>Siwen</given-names></name><name><surname>Wen</surname><given-names>Zebin</given-names></name><name><surname>Gao</surname><given-names>Jinyu</given-names></name><name><surname>Li</surname><given-names>Shuang</given-names></name><name><surname>Weissman</surname><given-names>Sherman M</given-names></name><name><surname>Pan</surname><given-names>Xinghua</given-names></name></person-group><article-title>Sample-multiplexing approaches for single-cell sequencing</article-title><source>Cellular and Molecular Life Sciences</source><year>2022</year><volume>79</volume><fpage>466</fpage><pub-id pub-id-type="pmcid">PMC11073057</pub-id><pub-id pub-id-type="pmid">35927335</pub-id><pub-id pub-id-type="doi">10.1007/s00018-022-04482-0</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoeckius</surname><given-names>Marlon</given-names></name><name><surname>Zheng</surname><given-names>Shiwei</given-names></name><name><surname>Houck-Loomis</surname><given-names>Brian</given-names></name><name><surname>Hao</surname><given-names>Stephanie</given-names></name><name><surname>Yeung</surname><given-names>Bertrand Z</given-names></name><name><surname>Mauck</surname><given-names>William M</given-names></name><name><surname>Smibert</surname><given-names>Peter</given-names></name><name><surname>Satija</surname><given-names>Rahul</given-names></name></person-group><article-title>Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title><source>Genome Biology</source><year>2018</year><volume>19</volume><fpage>224</fpage><pub-id pub-id-type="pmcid">PMC6300015</pub-id><pub-id pub-id-type="pmid">30567574</pub-id><pub-id pub-id-type="doi">10.1186/s13059-018-1603-1</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGinnis</surname><given-names>Christopher S</given-names></name><etal/></person-group><article-title>MULTI-seq: sample multiplexing for single-cell RNA sequencing using lipid-tagged indices</article-title><source>Nature Methods</source><year>2019</year><volume>16</volume><fpage>619</fpage><lpage>626</lpage><pub-id pub-id-type="pmcid">PMC6837808</pub-id><pub-id pub-id-type="pmid">31209384</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0433-8</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Jun</given-names></name><etal/></person-group><article-title>Genotype-free demultiplexing of pooled single-cell RNA-seq</article-title><source>Genome Biology</source><year>2019</year><volume>20</volume><fpage>290</fpage><pub-id pub-id-type="pmcid">PMC6921391</pub-id><pub-id pub-id-type="pmid">31856883</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1852-7</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heaton</surname><given-names>Haynes</given-names></name><name><surname>Talman</surname><given-names>Arthur M</given-names></name><name><surname>Knights</surname><given-names>Andrew</given-names></name><name><surname>Imaz</surname><given-names>Maria</given-names></name><name><surname>Gaffney</surname><given-names>Daniel J</given-names></name><name><surname>Durbin</surname><given-names>Richard</given-names></name><name><surname>Hemberg</surname><given-names>Martin</given-names></name><name><surname>Lawniczak</surname><given-names>Mara KN</given-names></name></person-group><article-title>Souporcell: robust clustering of single-cell RNA-seq data by genotype without reference genotypes</article-title><source>Nature Methods</source><year>2020</year><volume>17</volume><fpage>615</fpage><lpage>620</lpage><pub-id pub-id-type="pmcid">PMC7617080</pub-id><pub-id pub-id-type="pmid">32366989</pub-id><pub-id pub-id-type="doi">10.1038/s41592-020-0820-1</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>Lukas M</given-names></name><name><surname>Hippen</surname><given-names>Ariel A</given-names></name><name><surname>Hickey</surname><given-names>Peter F</given-names></name><name><surname>Berrett</surname><given-names>Kristofer C</given-names></name><name><surname>Gertz</surname><given-names>Jason</given-names></name><name><surname>Doherty</surname><given-names>Jennifer Anne</given-names></name><name><surname>Greene</surname><given-names>Casey S</given-names></name><name><surname>Hicks</surname><given-names>Stephanie C</given-names></name></person-group><article-title>Genetic demultiplexing of pooled single-cell RNA-sequencing samples in cancer facilitates effective experimental design</article-title><source>GigaScience</source><year>2021</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC8458035</pub-id><pub-id pub-id-type="pmid">34553212</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giab062</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Datlinger</surname><given-names>Paul</given-names></name><name><surname>Rendeiro</surname><given-names>André F</given-names></name><name><surname>Boenke</surname><given-names>Thorina</given-names></name><name><surname>Senekowitsch</surname><given-names>Martin</given-names></name><name><surname>Krausgruber</surname><given-names>Thomas</given-names></name><name><surname>Barreca</surname><given-names>Daniele</given-names></name><name><surname>Bock</surname><given-names>Christoph</given-names></name></person-group><article-title>Ultra-high-throughput single-cell RNA sequencing and perturbation screening with combinatorial fluidic indexing</article-title><source>Nature Methods</source><year>2021</year><volume>18</volume><fpage>635</fpage><lpage>642</lpage><pub-id pub-id-type="pmcid">PMC7612019</pub-id><pub-id pub-id-type="pmid">34059827</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01153-z</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Yuanhua</given-names></name><name><surname>McCarthy</surname><given-names>Davis J</given-names></name><name><surname>Stegle</surname><given-names>Oliver</given-names></name></person-group><article-title>Vireo: Bayesian demultiplexing of pooled singlecell RNA-seq data without genotype reference</article-title><source>Genome Biology</source><year>2019</year><volume>20</volume><fpage>273</fpage><pub-id pub-id-type="pmcid">PMC6909514</pub-id><pub-id pub-id-type="pmid">31836005</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1865-2</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>Andrew</given-names></name><name><surname>Hirschberg</surname><given-names>Julia</given-names></name></person-group><source>V-Measure: A Conditional Entropy-Based External Cluster Evaluation Measure</source><conf-name>Proceedings of the 2007 Joint Conference on Empirical Methods in Natural Language Processing and Computational Natural Language Learning (EMNLP-CoNLL)</conf-name><year>2007</year><person-group person-group-type="editor"><name><surname>Eisner</surname><given-names>Jason</given-names></name></person-group><conf-loc>Prague, Czech Republic</conf-loc><conf-sponsor>Association for Computational Linguistics</conf-sponsor><fpage>410</fpage><lpage>420</lpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>Rituparna</given-names></name><name><surname>Mallory</surname><given-names>Xian</given-names></name></person-group><article-title>Assessing the Performance of Methods for Cell Clustering from Single-cell DNA Sequencing Data</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="pmcid">PMC10597505</pub-id><pub-id pub-id-type="pmid">37824596</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1010480</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubert</surname><given-names>Lawrence</given-names></name><name><surname>Arabie</surname><given-names>Phipps</given-names></name></person-group><article-title>Comparing partitions</article-title><source>Journal of Classification</source><year>1985</year><volume>2</volume><fpage>193</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1007/BF01908075</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gawron</surname><given-names>Johannes</given-names></name><name><surname>Cunha</surname><given-names>Luis</given-names></name><name><surname>Borgsmueller</surname><given-names>Nico</given-names></name><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name></person-group><article-title>Robust and cost-efficient single-cell sequencing through combinatorial pooling</article-title><source>bioRxiv</source><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.11.22.624460</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morita</surname><given-names>Kiyomi</given-names></name><etal/></person-group><article-title>Clonal evolution of acute myeloid leukemia revealed by high-throughput single-cell genomics</article-title><source>Nature Communications</source><year>2020</year><volume>11</volume><fpage>5327</fpage><pub-id pub-id-type="pmcid">PMC7577981</pub-id><pub-id pub-id-type="pmid">33087716</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-19119-8</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miles</surname><given-names>Linde A</given-names></name><etal/></person-group><article-title>Single-cell mutation analysis of clonal evolution in myeloid malignancies</article-title><source>Nature</source><year>2020</year><volume>587</volume><fpage>477</fpage><lpage>482</lpage><pub-id pub-id-type="pmcid">PMC7677169</pub-id><pub-id pub-id-type="pmid">33116311</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2864-x</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardiello</surname><given-names>Joseph F</given-names></name><name><surname>Araus</surname><given-names>Alberto Joven</given-names></name><name><surname>Giatrellis</surname><given-names>Sarantis</given-names></name><name><surname>Helsens</surname><given-names>Clement</given-names></name><name><surname>Simon</surname><given-names>András</given-names></name><name><surname>Leigh</surname><given-names>Nicholas D</given-names></name></person-group><article-title>Evaluation of genetic demultiplexing of single-cell sequencing data from model species</article-title><source>Life Science Alliance</source><year>2023</year><volume>6</volume><pub-id pub-id-type="pmcid">PMC10192724</pub-id><pub-id pub-id-type="pmid">37197983</pub-id><pub-id pub-id-type="doi">10.26508/lsa.202301979</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="web"><collab>Mission Bio</collab><source>Mosaic</source><year>2020</year><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/MissionBio/mosaic">https://github.com/MissionBio/mosaic</ext-link></comment></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>Joe H</given-names><suffix>Jr</suffix></name></person-group><article-title>Hierarchical Grouping to Optimize an Objective Function</article-title><source>Journal of the American Statistical Association</source><year>1963</year><volume>58</volume><fpage>236</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1080/01621459.1963.10500845</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title><source>F1000Research</source><year>2016</year><volume>5</volume><pub-id pub-id-type="pmcid">PMC5112579</pub-id><pub-id pub-id-type="pmid">27909575</pub-id><pub-id pub-id-type="doi">10.12688/f1000research.9501.2</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Germain</surname><given-names>PL</given-names></name><name><surname>Lun</surname><given-names>A</given-names></name><name><surname>Garcia Meixide</surname><given-names>C</given-names></name><name><surname>Macnair</surname><given-names>W</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Doublet identification in single-cell sequencing data using scDblFinder</article-title><source>F1000Research</source><year>2022</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC9204188</pub-id><pub-id pub-id-type="pmid">35814628</pub-id><pub-id pub-id-type="doi">10.12688/f1000research.73600.1</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="web"><collab>Broad Institute</collab><source>Picard Tools</source><comment><ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link></comment></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of <italic>demoTape</italic> and conducted experiments.</title><p><bold>A)</bold> Given a read count matrix and the number of pooled samples, <italic>demoTape</italic> calculates pairwise distances between cells based on the observed reads, applies hierarchical agglomerative clustering to obtain cell clusters, and calculates corresponding read count profiles per cluster. Next, <italic>demoTape</italic> computes profiles for hypothetical doublets and uses these to identify potential doublet clusters. If not enough doublet clusters are identified, the cluster number is increased. Subsequently, the remaining clusters are aggregated to match the number of pooled samples. <bold>B)</bold> We sequenced the DNA of three patients individually and multiplexed on the Tapestri platform. Next, we synthetically multiplexed cells from the patient samples to benchmark the accuracy of <italic>demoTape</italic> and downsampled the number of cells in the patient samples to evaluate the effect of having fewer available cells per sample on the downstream analysis. Finally, we applied <italic>demoTape</italic> to the multiplexed sample, compared the results to the individual patient samples, and assigned demultiplexed clusters back to patients.</p></caption><graphic xlink:href="EMS201929-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>V-measure of the genotype-based demultiplexing methods <italic>demoTape,</italic> scSplit, souporcell, and Vireo on simulated data from three samples, for different mixing ratios and doublet rates of 10, 20, and 30%. Each box summarizes 30 simulations. The mixing ratios varied from uniform 33:33:33% (<bold>A</bold>), to slightly uneven 20:40:40% (<bold>B</bold>), to uneven 20:30:50% (<bold>C</bold>), to highly uneven 10:30:60% (<bold>D</bold>).</p></caption><graphic xlink:href="EMS201929-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Results of the downsampling simulations (<italic>n</italic> = 10 per sample size) for patients S1 (first row), S2 (second row), and S3 (third row). The first column (<bold>A</bold>, <bold>D</bold>, and <bold>G</bold>) shows the number of reported SNPs and the overlap of smaller sample size runs with the complete sample. The second column (<bold>B</bold>, <bold>E</bold>, and <bold>H</bold>) indicates the number of inferred clusters, and the third column (<bold>C</bold>, <bold>F</bold>, and <bold>I</bold>) the Adjusted Rand Index (ARI) of the clustering algorithms BnpC, SCG, and COMPASS. As ground truth for the ARI calculation, we used the clusters inferred on the complete data containing all cells (last value on the x-axis). Higher ARI values indicate a higher clustering consistency.</p></caption><graphic xlink:href="EMS201929-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Overview of the multiplexed sample and the demultiplexed cluster-patient assignment.</title><p><bold>A</bold> Venn diagram of the SNPs called in the three individually sequenced samples (S1, blue; S2, yellow; S3, green) and the multiplexed sample (MS1, violet). <bold>B</bold> VAF heatmap of MS1. The colored bars on the left indicate the inferred patient and doublet clusters. <bold>C</bold> Venn diagrams of the SNPs called in the three individually sequenced samples and the respective demultiplexed samples MS1:S1, MS1:S2, and MS1:S3. <bold>D</bold> VAF heatmap of the SNPs overlapping between the demultiplexed scDNA-seq clusters (averaged over all cells) and the matched, patient-specific scRNA-seq data (averaged over multiple samples). <bold>E</bold> Pair-wise normalized Euclidean distance between scDNA-seq cluster and scRNA-seq patient SNP profiles per patient. Profiles from the same patient are closer together. <bold>F</bold> VAF heatmap displaying the overlap between the demultiplexed scDNA-seq clusters (average) and the matched, patient-specific SNP array data. G Pairwise normalized Euclidean distance between scDNA-seq SNPs and SNP array profiles per patient. Profiles from the same patient are closer together.</p></caption><graphic xlink:href="EMS201929-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Comparison of the individual samples (S1, S2, S3) with the demultiplexed clusters of the pooled sample (MS1).</title><p><bold>A</bold>) VAF heatmap for S1 (light blue) and MS1:S1 (dark blue) and the corresponding event trees for S1 (<bold>B</bold>) and MS1:S1 (<bold>C</bold>). <bold>D</bold>) VAF heatmap for S2 (light yellow) and MS1:S2 (dark yellow) and the corresponding events trees (<bold>E</bold>) and (<bold>F</bold>), respectively. <bold>G</bold>) VAF heatmap for S3 (light green) and MS1:S3 (dark green) and the corresponding event trees <bold>H</bold> and <bold>I</bold>, respectively. The green and red column colors above the VAF heatmaps indicate whether the SNP was reported in the corresponding sample. Event trees were inferred with COMPASS. Yellow boxes indicate SNPs placed at different nodes in the tree topology between the two samples. Red asterisks indicate SNPs reported here but not in the corresponding sample. HOM = homozygous SNP.</p></caption><graphic xlink:href="EMS201929-f005"/></fig></floats-group></article>