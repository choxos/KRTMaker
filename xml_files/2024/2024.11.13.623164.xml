<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS203662</article-id><article-id pub-id-type="doi">10.1101/2024.11.13.623164</article-id><article-id pub-id-type="archive">PPR940437</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">4</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Improved model building for cryo-EM maps using local attention and 3D rotary position embedding</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Su</surname><given-names>Baoquan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Kun</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Peng</surname><given-names>Zhenling</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Amunts</surname><given-names>Alexey</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Jianyi</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>MOE Frontiers Science Center for Nonlinear Expectations, State Key Laboratory of Cryptography and Digital Economy Security, Research Center for Mathematics and Interdisciplinary Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0207yh398</institution-id><institution>Shandong University</institution></institution-wrap>, <city>Qingdao</city><postal-code>266237</postal-code>, <country country="CN">China</country></aff><aff id="A2"><label>2</label>School of Life Science, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05hfa4n20</institution-id><institution>Westlake University</institution></institution-wrap>, <city>Hangzhou</city><postal-code>310030</postal-code>, <country country="CN">China</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00pd74e08</institution-id><institution>University of Münster</institution></institution-wrap>, <addr-line>Schlossplatz 8</addr-line>, <postal-code>48143</postal-code><city>Münster</city>, <country country="DE">Germany</country></aff><aff id="A4"><label>4</label>Department of Structural Biochemistry, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vpj4s62</institution-id><institution>Max Planck Institute of Molecular Physiology</institution></institution-wrap>, <addr-line>Otto-Hahn-Str. 11</addr-line>, <postal-code>44227</postal-code><city>Dortmund</city>, <country country="DE">Germany</country></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding authors: JY (<email>yangjy@sdu.edu.cn</email>), AA (<email>alexey.amunts@gmail.com”alexey.amunts@gmail.com</email>), ZP (<email>zhenling@email.sdu.edu.cn</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>11</day><month>03</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>10</day><month>03</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Constructing atomic models from cryogenic electron microscopy (cryo-EM) density maps is essential for interpreting molecular mechanisms. In this study, we present CryFold, an approach for <italic>de novo</italic> model building for cryo-EM maps, leveraging recent advancements in AlphaFold2 (<xref ref-type="bibr" rid="R1">1</xref>) to improve the state-of-the-art method ModelAngelo (<xref ref-type="bibr" rid="R2">2</xref>). To accommodate the cryo-EM map information, CryFold replaces the global attention mechanism in AlphaFold2 with local attention, which is further enhanced by a novel 3D rotary position embedding. CryFold produces more complete models, reduces the resolution requirement, and accelerates the modeling. The application of CryFold to three new maps with unknown structure demonstrates its ability to accurately distinguish between paralog sequences in noisy regions, detect previously uncharacterized proteins with unknown functions, precisely compartmentalize the map to isolate non-protein components, and improve the modeling of conformational changes. A particular case includes a 104-protein complex that has been modeled within a few hours, and a minor conformational change of a single protein domain has been detected at the periphery when models from two different maps were compared. CryFold stands as an accurate method currently available for model building of proteins in cryo-EM structure determination. The source code and model parameters are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SBQ-1999/CryFold">https://github.com/SBQ-1999/CryFold</ext-link>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">With the advent of direct electron detectors, single-particle cryo-EM has become the primary method for resolving biomolecular structures (<xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R5">5</xref>). A critical step in cryo-EM structure determination is the construction of atomic models from 3D density maps. The pace of model deposition derived from cryo-EM maps in the Protein Data Bank (PDB) has increased by two orders of magnitude, from 67 in 2012 to 5788 in 2024 (<xref ref-type="bibr" rid="R6">6</xref>). The exponential growth has been driven by advances in automation of data collection and processing (<xref ref-type="bibr" rid="R7">7</xref>), accessible software and web platforms empowering broader adoption (<xref ref-type="bibr" rid="R8">8</xref>), and community efforts to further democratize and improve cryo-EM methodologies (<xref ref-type="bibr" rid="R9">9</xref>), including the use of artificial intelligence (AI).</p><p id="P3">Previously, model building relied heavily on manual efforts, involving fitting homology models generated by tools like I-TASSER (<xref ref-type="bibr" rid="R10">10</xref>) into the density maps using graphic software, such as <italic>Coot</italic> (<xref ref-type="bibr" rid="R11">11</xref>) or Isolde (<xref ref-type="bibr" rid="R12">12</xref>). The process of generating a 3D reconstruction involves averaging thousands of non-identical particle projections, resulting in cryo-EM maps that consist of regions with variable resolutions. Consequently, areas with higher flexibility or partial occupancy are more challenging to interpret with precision. For instance, it took around six months to develop modeling and refinement protocols to build a model for the cryo-EM map (EMD-2566, overall resolution 3.2 Å) of the large subunit from the yeast mitoribosome with 13 new proteins (<xref ref-type="bibr" rid="R4">4</xref>). This was the first fully refined cryo-EM model of an asymmetric object that also illustrated cryo-EM’s power in resolving structures of large complexes isolated from native sources, where not all protein sequences are known, marking a turning point in structural biology <sup>5</sup>. Today, individual components of complexes are routinely identified directly from the density maps, revealing novel regulatory pathways. In our hands, it led to the description of biochemical connection between biogenesis and fatty acid and iron-sulfur synthesis (<xref ref-type="bibr" rid="R13">13</xref>), evolutionary mechanisms for gene transfer from organelles to the nucleus (<xref ref-type="bibr" rid="R14">14</xref>), identification of gene splitting (<xref ref-type="bibr" rid="R15">15</xref>) and even the discovery of a new type of translational frameshift (<xref ref-type="bibr" rid="R16">16</xref>).</p><p id="P4">The amino acid sequence can be inferred directly from the side-chain densities, allowing for searches of protein-sequence databases (<xref ref-type="bibr" rid="R17">17</xref>). Tools like <italic>FindMySequence</italic>, which uses main-chain information to fit predicted residue-type probabilities, can query sequence databases of user’s choice (<xref ref-type="bibr" rid="R18">18</xref>). However, due to the labor-intensive nature of the process, many deposited PDB structures contain errors, limiting their biological interpretations (<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>). This is particularly true when reliable reference structures are unavailable or when dealing with density maps at resolutions lower than 4 Å. As a result, model building becomes a bottleneck, highlighting the necessity of automating this process.</p><p id="P5">Several methods have been developed to derive atomic structures from cryo-EM density maps. These can be categorized into two groups: traditional and utilizing deep learning. Traditional model-building methods include Pathwalking (<xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>), Buccaneer (<xref ref-type="bibr" rid="R23">23</xref>), EM-Fold (<xref ref-type="bibr" rid="R24">24</xref>), Rosetta (<xref ref-type="bibr" rid="R25">25</xref>), MAINMAST (<xref ref-type="bibr" rid="R26">26</xref>), Phenix (<xref ref-type="bibr" rid="R27">27</xref>). In Pathwalking and MAINMAST, constructing all-atom structures from density maps is treated as a minimization problem, solved using optimization algorithms. Rosetta and EM-Fold first deduce fragment structures from the density map and assemble them using Monte Carlo sampling.</p><p id="P6">Deep learning-based methods encompass DeepMainmast (<xref ref-type="bibr" rid="R28">28</xref>), EMBuild (<xref ref-type="bibr" rid="R29">29</xref>), CR-I-TASSER (<xref ref-type="bibr" rid="R30">30</xref>), DeepTracer (<xref ref-type="bibr" rid="R31">31</xref>), ModelAngelo (<xref ref-type="bibr" rid="R2">2</xref>), Cryo2Struct (<xref ref-type="bibr" rid="R32">32</xref>). These approaches typically start by applying a deep network to detect the backbone structure from the density map. They diverge in their subsequent strategies for constructing all-atom models. For instance, DeepMainmast and EMBuild fit predicted structure models to the backbone to create all-atom structures. CR-I-TASSER integrates backbone information into I-TASSER’s (<xref ref-type="bibr" rid="R10">10</xref>) classical assembly simulations to generate all-atom models. DeepTracer connects backbone atoms by solving the traveling salesman problem before adding side-chain atoms for the complete structure. ModelAngelo, regarded as state of the art, uses predicted amino acid probabilities, refines backbone atoms with a graph-based network and constructs the all-atom model through Invariant Point Attention, followed by Hidden Markov Model (HMM)-based sequence correction. Cryo2Struct employs HMM and Viterbi algorithms to align the input sequences with predicted ones to build the all-atom structure. By incorporating components of protein structure prediction framework, current methods have achieved more accurate results in interpreting density maps (<xref ref-type="bibr" rid="R33">33</xref>).</p><p id="P7">Recently, a breakthrough came from deep learning based structure predictors, such as AlphaFold2 (AF2) (<xref ref-type="bibr" rid="R1">1</xref>), RoseTTAFold (<xref ref-type="bibr" rid="R34">34</xref>) and trRosetta (<xref ref-type="bibr" rid="R35">35</xref>), which also contributed to the awarding of the 2024 Nobel Prize in Chemistry. We reasoned that accuracy and the resolution limit in protein model building, especially for the state-of-the-art method ModelAngelo, could be further extended by taking advantage of the recent advances. We thus developed CryFold. Tests on cryo-EM maps of multi protein complexes with unknown components demonstrate the robustness of CryFold for automated model building with high speed and accuracy.</p><sec id="S2"><title>Overview of the CryFold approach</title><p id="P8">CryFold takes as input a cryo-EM density map and the amino acid sequences of the target proteins, following a two-step process for building atomic structures (<xref ref-type="fig" rid="F1">Fig. 1</xref>). In the first step, a 3D convolution-based network, specifically a U-Net (<xref ref-type="bibr" rid="R36">36</xref>), is employed to predict the positions of Cα atoms from the density map. Due to GPU memory limitations, the map is cropped into smaller patches (64×64×64), which are later combined to reconstruct the original size. The second step generates all-atom structures using novel transformer network adapted from AF2 (<xref ref-type="bibr" rid="R1">1</xref>). The all-atom positions are post-processed using a method similar to that used in ModelAngelo (<xref ref-type="bibr" rid="R2">2</xref>). CryFold incorporates a recycling mechanism, allowing for three iterative refinements of predictions like AF2 (<xref ref-type="bibr" rid="R1">1</xref>), and we introduced key modifications in the encoder and decoder to fully exploit the structural information present in the density map. The encoder, which we call Cryformer, transforms the density map into the node representation and the edge representation. The decoder, namely Structure Module, generates all-atom positions from these improved representations.</p><p id="P9">Two key differences distinguish the CryFold network (denoted by Cry-Net) from the AF2 network: an enhanced transformer and the local attention. Cry-Net features an enhanced transformer that incorporates 3D rotary position embedding (<italic>3D</italic>-<italic>RoPE</italic>). Originally, RoPE was used to process 1D sequences (<xref ref-type="bibr" rid="R37">37</xref>). Here we extend it to a node position encoding in 3D space (see <xref ref-type="sec" rid="S21">Methods</xref> and Supplementary S2.4). 3D-RoPE effectively encodes the positional information of each node into all attention calculations, making the attention score to decay with increasing distance between nodes. This design takes advantage of the spatial constraints inherent in the density map. The local attention in Cry-Net is realized through the improved edge representation (see <xref ref-type="sec" rid="S21">Methods</xref>). Instead of an all-against-all approach, Cry-Net employs an all-against-<italic>k</italic> strategy, where <italic>k</italic> represents the number of spatial neighbors for each node. This adjustment once again capitalizes on the spatial restraints provided by the density map, which are usually unavailable in traditional structure prediction. These features enable efficient training of a deeper network.</p><p id="P10">The post-processing procedure, adapted from ModelAngelo, is outlined as follows. The initial all-atom structure is obtained from Cry-Net, and any segments with fewer than four residues are trimmed (referred to as <italic>model_net</italic>). The amino acid type for each residue in model_net is assigned as the class with the highest probability output from Cry-Net. HMM profile is derived from the predicted probability distribution by Cry-Net and aligned with the input amino acid sequence. The amino acid types of residues in the Cry-Net structure (prior to trimming) are then corrected according to this alignment, producing another structure denoted as <italic>model_fix</italic>. Finally, residues that do not match the input sequence are pruned, producing <italic>model_prune</italic>, the default model used for assessment unless otherwise specified.</p></sec><sec id="S3"><title>Quality of the model building for 1-4 Å resolution maps</title><p id="P11">To benchmark CryFold, we first tested it against 177 maps of resolution better than 4 Å from ModelAngelo. The specific metrics for performance evaluation are introduced in Supplementary Information S1. For objective comparison, the ModelAngelo models for these maps were downloaded from the website given in its paper (<xref ref-type="bibr" rid="R2">2</xref>). For new maps, atomic models were generated locally using the version v0.2.3, which has higher accuracy to other versions in our tests.</p><p id="P12">While both CryFold and ModelAngelo perform well when the map resolution is better than 3 Å (<xref ref-type="fig" rid="F2">Fig. 2A</xref>, indicated by points in the upper right corner), CryFold’s advantages become evident as the map resolution decreases below 3 Å. Notably, with a higher completeness rate, CryFold also generates more accurate structures, as indicated by Cα RMSD (0.310 Å vs 0.334 Å) and backbone RMSD (0.338 Å vs 0.375 Å) (<xref ref-type="fig" rid="F2">Fig. 2E</xref>).</p><p id="P13">Completeness is closely linked to backbone recall and amino acid accuracy. A decline in either of these metrics results in reduced completeness. To further investigate this relationship, we calculated backbone recall and amino acid accuracy for the intermediate models (model_net and model_fix). CryFold achieves a backbone recall in model_net of 97.17% vs. 94.37% of ModelAngelo (<xref ref-type="fig" rid="F2">Fig. 2G</xref>). If segments less than 4 residues are retained, this parameter increases by 0.87% and 2.0% for CryFold and ModelAngelo, respectively. The smaller increase for CryFold might reflect that the structures generated by our network are less fragmented.</p><p id="P14">Additionally, CryFold exhibits a higher amino acid accuracy before pruning (in both model_net and model_fix, <xref ref-type="fig" rid="F2">Fig. 2G</xref>), and the two methods show comparable accuracy after pruning (in model_prune, <xref ref-type="fig" rid="F2">Fig. 2D</xref>). The amino acid accuracy for the model generated by Cry-Net (model_net) is 73.14%, compared to 58.54% for ModelAngelo. This indicates that our network possesses a stronger ability to assign amino acid types, likely due to the enhanced transformer architecture. The HMM-based correction from ModelAngelo performs well, improving amino acid accuracy in model_fix to 87.09% for CryFold and 84.67% for ModelAngelo. In summary, CryFold shows high backbone recall and amino acid accuracy, contributing to the overall completeness.</p><p id="P15">We also analyzed the accuracy of predicted structures based on the Q-scores (<xref ref-type="bibr" rid="R38">38</xref>) of residues in the deposited structures. The Q-score reflects the consistency between the map density and the atomic structure, with higher values typically indicating better local resolution. <xref ref-type="fig" rid="F2">Fig. 2C</xref> plots the backbone RMSD and the completeness of models built by CryFold and ModelAngelo against the deposited Q-scores. When the Q-score is less than 0 or greater than 0.6, CryFold models exhibit lower backbone RMSD. For other Q-score ranges, the RMSDs of both methods are comparable. In terms of completeness, CryFold outperforms ModelAngelo when the Q-score is below 0.6.</p><p id="P16">In addition to Q-scores, we also calculated the MolProbity scores (<xref ref-type="bibr" rid="R39">39</xref>) and EMRinger (<xref ref-type="bibr" rid="R40">40</xref>) metrics. The former reflects the geometric validity of the protein models, while the latter indicates the degree of agreement between the protein side chains and the density map. CryFold achieves better model quality than ModelAngelo while having a higher level of completeness (MolProbity scores 3.56 vs. 3.69, EMRinger 3.02 vs. 2.90). Detailed results can be found in <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>.</p><p id="P17">Next, we compared the number of true positives (TPs) in the structures generated by both methods. A residue is classified as a TP if a corresponding deposited residue exists within 3 Å. Both methods have 309,401 common TPs, with backbone RMSD values of 0.28 Å and 0.33 Å for CryFold and ModelAngelo, respectively (<xref ref-type="fig" rid="F2">Fig. 2F</xref>). Additionally, CryFold identifies 31,736 TPs that ModelAngelo misses, contributing to its higher completeness. These residues generally correspond to lower-resolution areas, as indicated by their lower Q-scores (0.47) and higher backbone RMSD (0.77 Å, <xref ref-type="fig" rid="F2">Fig. 2E</xref>). In contrast, ModelAngelo identifies only 8,980 TPs (with a backbone RMSD of 0.87 Å) that are missed by CryFold. This data reinforces CryFold’s advantage in constructing atomic structures for lower-resolution maps/regions.</p></sec><sec id="S4"><title>CryFold extends the map resolution limit for structure construction</title><p id="P18">Our tests indicate that CryFold exhibits slightly lower backbone precision compared to ModelAngelo (<xref ref-type="fig" rid="F2">Fig. 2B</xref>), which may stem from CryFold’s ability to construct structures in lower-resolution regions (see below), which are often absent in deposited structures and classified as false positives during evaluation. For instance, in the cryo-EM structure of the <italic>type III-E CRISPR Craspase gRAMP-crRNA complex</italic> (PDB ID: 7Y82, EMD-33678; green cartoon and gray surface in <xref ref-type="fig" rid="F3">Fig. 3A</xref>), residues 1041-1380 are largely absent in both the deposited structure (green cartoon in <xref ref-type="fig" rid="F3">Fig. 3A</xref>) and the ModelAngelo model (magenta cartoon in <xref ref-type="fig" rid="F3">Fig. 3A</xref>). The structures for these regions are modeled by CryFold (blue cartoon in <xref ref-type="fig" rid="F3">Fig. 3A, B</xref>) but classified as false positives, resulting in a lower precision than ModelAngelo (88.8% vs 99.8%). However, these residues are modeled with high confidence (&gt;70, see the next section). We also submitted the domain sequence to AlphaFold3 (<xref ref-type="bibr" rid="R41">41</xref>) (AF3) for structure prediction, yielding a high confidence score (AF3 confidence score &gt; 0.8). Structure superimposition indicates that the AF3 model closely resembles the CryFold model (TM-score 0.86, RMSD 2.07 Å; <xref ref-type="fig" rid="F3">Fig. 3C</xref>). This cross-validation supports the correctness of the CryFold model for the missing residues.</p><p id="P19">The above phenomenon is not isolated, and we have observed it in numerous cases, potentially impacting overall backbone precision. On average, the CryFold models for the 177 maps include approximately 75,000 new residues predicted with high confidence (&gt; 60, see <xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>) absent in deposited structures. All structures generated by CryFold are available for download at <ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/CryFold">https://yanglab.qd.sdu.edu.cn/CryFold</ext-link>.</p></sec><sec id="S5"><title>Evaluation of residue confidence scores</title><p id="P20">CryFold provides a reliable estimation of model accuracy through a per-residue confidence score, similar to the confidence scores available in protein structure prediction. This score is derived from the predicted FAPE loss (see <xref ref-type="sec" rid="S21">Methods</xref>). The confidence score ranges from 0 to 100; a higher score indicating lower FAPE loss and a more confident prediction. This score is stored in the B-factor field of the mmCIF file. We analyzed the correlation between the confidence scores of all residues in 177 predicted structures generated by CryFold and their backbone RMSDs (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). Generally, a higher residue confidence score correlates with a lower backbone RMSD. In <xref ref-type="fig" rid="F4">Fig. 4B and 4C</xref>, we illustrate two examples colored by their respective confidence scores. Notably, CryFold assigns lower confidence scores to loop regions, which tend to be more flexible and exhibit lower resolution in density maps.</p></sec><sec id="S6"><title>Map masking improves backbone precision</title><p id="P21">Another factor contributing to CryFold’s lower precision is the absence of automatic map masking. Map masking is typically used to exclude regions of low resolution or those unrelated to the structures of interest (e.g., membrane or solvent). We evaluated the impact of map masking on a set of 70 maps from the 177 high-resolution maps, for which both the original and masked maps are available from EMDB (<xref ref-type="bibr" rid="R42">42</xref>). The average backbone precision for structures built by CryFold increased from 86.0% (using the original map) to 90.7% (using the masked map). While most cases show no significant difference between the original and the masked maps (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>), some examples demonstrate improved backbone precision with masked maps. For instance, for the map EMD-33306, the backbone precision improved from 25.2% to 97.1% after masking (<xref ref-type="supplementary-material" rid="SD1">Fig. S2E</xref>). However, map masking can sometimes result in incomplete atomic structures (<xref ref-type="supplementary-material" rid="SD1">Fig. S2F</xref>). Nonetheless, our package provides an optional argument to accept masked maps for expert users.</p></sec><sec id="S7"><title>Benchmarking performance at 4-7 Å resolution maps</title><p id="P22">Next, we assessed the performance of CryFold at lower resolution range. We tested 104 maps with resolutions of 4-7 Å (<xref ref-type="fig" rid="F5">Fig. 5A-C</xref>). As expected, the accuracy is lower compared to high-resolution maps. Nevertheless, CryFold builds relatively complete models (&gt;50% completeness) for approximately 40% of the tested maps. CryFold generally constructs more complete models than ModelAngelo (backbone recall 43.0% vs. 25.8%; completeness 36.8% vs 23.6%) while maintaining similar accuracy (amino acid accuracy 86.6% vs. 85.3%; backbone RMSD 0.777 Å vs 0.905 Å). An example is given in <xref ref-type="fig" rid="F6">Fig. 6A</xref> to illustrate the performance on low-resolution maps.</p></sec><sec id="S8"><title>Performance on a non-redundant set of maps</title><p id="P23">The above test maps were collected based on the release date (i.e., after the training maps), without control of sequence redundancy to the training maps. To investigate this issue, the 281 test maps (from both the high-resolution and the low-resolution test sets) are compared with the training maps at a 40% sequence identity threshold, resulting a non-redundant set of 101 maps (75 and 26 from the high-resolution and the low-resolution test sets, respectively).</p><p id="P24">The performance of CryFold is listed in <xref ref-type="supplementary-material" rid="SD1">Table S4</xref>. Surprisingly, the CryFold models for the non-redundant maps are more complete than the redundant maps (completeness 74% vs. 66%). By dividing these maps into two subsets according to their resolutions, we can see that sequence redundancy does not affect the high-resolution maps (completeness 83% vs. 84%). However, the model completeness for the non-redundant low-resolution maps is higher than the full test set (50% vs. 37%). This is because, before removing redundancy, there were 32 poor models in the low-resolution dataset, where the completeness of the CryFold models were below 20%. Only three such models were retained in the non-redundant set, resulting in higher completeness. In summary, these results indicate that the key factor impacting CryFold’s performance is the map resolution rather than the sequence similarity to the training data.</p></sec><sec id="S9"><title>Model accuracy in Stage 1 and Stage 2</title><p id="P25">CryFold works in two stages (see <xref ref-type="fig" rid="F1">Fig. 1</xref>), predicting Cα atoms in Stage 1 and all atoms in Stage 2. We compare the results of CryFold and ModelAngelo in the Stage 1 predictions (see <xref ref-type="supplementary-material" rid="SD1">Fig. S3B-D</xref> Stage 1). CryFold shows higher recall than ModelAngelo at the expense of lower precision and higher RMSD (backbone recall 99.0% vs. 98.4%; backbone precision 75.5% vs. 90.4%; Cα RMSD 0.729 Å vs. 0.640 Å). This is because CryFold returns much more number of candidate Cα atoms than ModelAngelo (on average 8770 vs. 4677 per map), resulting lower precision and higher RMSD at this stage. However, most false Cα atoms are successfully filtered out by the network Cry-Net at Stage 2, which can be seen from increased precision from 75.5% to 95.8%.</p><p id="P26">As shown in <xref ref-type="supplementary-material" rid="SD1">Fig. S3E-G</xref>, we compare the MolProbity scores (<xref ref-type="bibr" rid="R39">39</xref>) and EMRinger (<xref ref-type="bibr" rid="R40">40</xref>) of atomic models constructed by CryFold and ModelAngelo. CryFold achieves slightly better model quality than ModelAngelo (MolProbity scores 3.66 vs. 3.76, EMRinger 2.45 vs. 2.40). The MolProbity scores for both methods are not ideal, which may be related to the models constructed by deep learning methods not undergoing a relaxation step. Here, structures with MolProbity scores &gt;4 (about 21 models) were further relaxed using the refine module in trRosetta (<xref ref-type="bibr" rid="R35">35</xref>), resulting in new models with improved MolProbity scores to 2.1 (see <xref ref-type="supplementary-material" rid="SD1">Fig. S3F</xref>).</p><p id="P27">Finally, we compare CryFold and ModelAngelo on the intermediate models (model_net) without any post-processing. The results (see <xref ref-type="supplementary-material" rid="SD1">Fig. S3H</xref>) show that CryFold has a higher backbone recall (95.5% vs. 89.7%) and higher amino acid accuracy (65.9% vs. 51.3%). This demonstrates the superiority of the Cry-Net in constructing atom positions and recognizing amino acid types.</p></sec><sec id="S10"><title>Comparison with other methods that use additional constraints</title><p id="P28">We further compare CryFold with two recent methods that incorporate additional constraints, including CryoFold (<xref ref-type="bibr" rid="R43">43</xref>) and DeepMainmast (<xref ref-type="bibr" rid="R28">28</xref>). CryoFold is a method for predicting protein complex structures, utilizing density maps, multiple sequence alignments (MSAs), and homologous structure templates. DeepMainmast constructs complex structures from density maps by deep learning and predicted structures from AF2.</p><p id="P29">At the time of this study, CryoFold was not open-source; however, a web server was available at <ext-link ext-link-type="uri" xlink:href="https://cryonet.ai/cryofold">https://cryonet.ai/cryofold</ext-link>. We manually submitted density maps and protein sequences to the CryoFold web server for modeling, which took an average of approximately 2 hours per target in our tests. To streamline testing, we randomly selected 25 density maps from the above non-redundant dataset, spanning resolutions of 2.2-4.2 Å, for comparison with CryoFold.</p><p id="P30">CryFold demonstrates competitive performance relative to CryoFold (average completeness: 80.8% vs. 81.5%; amino acid accuracy: 93.1% vs. 91.7%; backbone RMSD: 0.406 Å vs. 0.436 Å). Owing to additional constraints from MSAs and templates (it remains unknown if homologous templates were excluded or not), CryoFold slightly outperforms in completeness for most samples (<xref ref-type="supplementary-material" rid="SD1">Fig. S4A</xref>). However, CryFold exhibits greater stability in completeness, with a lower standard deviation (22.3% vs. 25.0%).</p><p id="P31">The DeepMainmast protocol comprises two components. The first, DeepMainmast(base), constructs models using <italic>de novo</italic> main-chain tracing guided by deep learning. The second integrates the DeepMainmast(base) model with structure predictions from AF2. Modeling a target with DeepMainmast typically requires several hours. For convenience, we referenced the data from the original DeepMainmast paper (<xref ref-type="bibr" rid="R28">28</xref>), which includes results for 20 protein complexes. To eliminate bias from similar targets in our training dataset, we excluded complexes sharing over 40% sequence identity with the training set, yielding a final set of 17 protein complexes. The results of the other three protein complexes are highlighted in blue in <xref ref-type="supplementary-material" rid="SD1">Table S8</xref>. Additionally, we found that using the original density map (EMD-5495) directly as input for CryFold yields very poor results. This may be related to the fact that EMD-5495 was released early (in 2012) with high background noises. So we preprocessed EMD-5495 in the same way as ModelAngelo and then used it as input for CryFold.</p><p id="P32">We first compare CryFold with DeepMainmast(base), which a fair comparison given their identical input information. <xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref> indicates that CryFold outperforms DeepMainmast(base) for almost all complexes (completeness: 83% vs. 64%; amino acid accuracy: 93% vs. 83%; TM-score: 0.77 vs. 0.63). When compared to the full DeepMainmast protocol, CryFold remains competitive (completeness: 83% vs. 87%; amino acid accuracy: 93% vs. 96%; TM-score: 0.77 vs. 0.92).</p><p id="P33">Note that TM-score may not be an appropriate metric for evaluating CryFold, as it relies on density maps and protein sequences for structure construction, which can lead to incomplete predictions for map regions with poor resolution. In contrast, methods like AF2 generate full-length models for all residues in a complex, regardless of map resolution.</p><p id="P34">To summarize, the comparisons above demonstrate that CryFold remains competitive with CryoFold and DeepMainmast, despite the additional constraints utilized by these methods. We intentionally avoided incorporating additional constraints into CryFold to prioritize ease of use and efficiency. As a result, CryFold is expected to be several times faster than both methods. Nevertheless, enhancing model building for density maps with poor resolution, potentially by integrating predicted structure models, could be beneficial. We defer such improvements to future developments of CryFold.</p></sec><sec id="S11"><title>Sensitivity analysis of CryFold to hyperparameters</title><p id="P35">CryFold has many hyperparameters during the inference phase. Here, we analyze two key hyperparameters: the prediction threshold for the classification network in Stage 1 (denoted as <italic>t</italic>) and the number of recycling rounds in Stage 2 (denoted as <italic>n</italic>). In the default settings of CryFold, <italic>t</italic> is set to 0.6 and <italic>n</italic> to 3. We performed tests to evaluate the effects of varying these parameters.</p><p id="P36">As illustrated in <xref ref-type="supplementary-material" rid="SD1">Fig. S6A</xref>, reducing <italic>t</italic> and <italic>n</italic> affects the completeness, with <italic>n</italic> having a stronger impact on the completeness. This suggests that recycling effectively enhances the model completeness. Additionally, when lowering the Stage 1 threshold to <italic>t</italic> = 0.4, the backbone precision remains largely unaffected (see <xref ref-type="supplementary-material" rid="SD1">Fig. S6B</xref>), indicating that CryFold effectively filters out false positives generated in Stage 1.</p><p id="P37">We also tested the impact of randomly rotating and translating density maps. We fed the transformed density map into CryFold. Then, the models output by CryFold are aligned with the native models using US-align (<xref ref-type="bibr" rid="R44">44</xref>) for comparison. The results were interesting: appropriate rotation and translation can improve model quality (see <xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>), although models built from the original and the transformed maps remain broadly similar. These data demonstrate the robustness of CryFold.</p></sec><sec id="S12"><title>Ablating CryFold components to assess drivers of performance</title><p id="P38">First, we checked how much improvement is introduced by the <italic>L</italic><sub>2</sub> regularization with simulated density maps (i.e., in <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>). For the convenience of the experiment, we arranged three configurations of U-Net for study: the default version (CryFold Stage 1), CF with <italic>L</italic><sub>2</sub> loss (CryFold Stage 1 without a pre-training process, see <xref ref-type="supplementary-material" rid="SD1">Supplementary Information S2.2</xref>), and CF w/o <italic>L</italic><sub>2</sub> loss (neither a pre-training process nor <italic>L</italic><sub>2</sub> loss constraints). <xref ref-type="fig" rid="F7">Fig. 7A, and 7B</xref> show that the models at Stage 1 become worse after removing the pre-training process (backbone recall 99.0% vs. 97.0%; backbone precision 75.5% vs. 70.5%; Cα RMSD 0.729 Å vs. 0.852 Å ). Removing the <italic>L</italic><sub>2</sub> regularization has a slight impact on performance (backbone recall 97.0% vs. 96.3%; backbone precision 70.5% vs. 71.2%; Cα RMSD 0.852 Å vs. 0.854 Å ).</p><p id="P39">To investigate the contributions of different components to CryFold, we conducted ablation experiments on the 177 high-resolution maps. Four configurations of its network, Cry-Net, were assessed: the default version (18-layer Cryformer), a version without node and edge attention, a version without sequence input, and a version without 3D rotary position embedding (3D-RoPE). These experiments evaluate the impact of network depth, sequence information, and 3D-RoPE on performance. Metrics included amino acid accuracy and all-atom RMSD, calculated against the deposited structures (<xref ref-type="fig" rid="F7">Fig. 7C</xref>). The default model achieved 0.506 Å all-atom RMSD and 73.1% amino acid accuracy. The RMSD increased slightly for shallower networks and the version without sequence input, while amino acid accuracy dropped significantly, especially for the version lacking sequence input. The configuration without 3D-RoPE exhibited the most substantial differences, with an increased all-atom RMSD of 0.341 Å and a 26.4% decrease in amino acid accuracy. Notably, the loss curve for the ablation experiment without 3D-RoPE displayed oscillations during training (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>), suggesting that this encoding is crucial for the effective training of Cry-Net.</p></sec><sec id="S13"><title>Running time and GPU memory usage</title><p id="P40">We evaluated CryFold’s running time as a function of protein length on the 177 high-resolution maps using a single GPU (A100, ~15G memory) (<xref ref-type="supplementary-material" rid="SD1">Fig. S8A</xref>). The running time increases linearly with protein length. CryFold can build a structure of approximately 40,000 residues in about 3.5 hours. CryFold allows users to balance GPU memory and running time. By default, CryFold processes 300 residues at a time, using ~13 GB of GPU memory. An additional ~1 GB of memory is required for every 100 extra residues. <xref ref-type="supplementary-material" rid="SD1">Fig. S8B</xref> illustrates the running time for the PDB entry 8FNV (&gt;9,000 residues) under three configurations. Increasing GPU memory by 1.6 times (from 15GB to 24GB) results in acceleration of the speed by 1.5 times (from 44 minutes to 30 minutes). This linear relationship can be generalized to proteins of any length. In additional tests, the accuracy of predicted models remains consistent with increased crop size.</p></sec><sec id="S14"><title>Case studies to assess model completeness, protein identification and conformational changes</title><p id="P41">We showcase the advanced capabilities of CryFold with four complementary examples, each addressing a distinct and challenging aspect of modern macromolecular modeling (<xref ref-type="fig" rid="F6">Fig. 6</xref>). They are introduced below in details.</p><sec id="S15"><label>1</label><title>Handling low-resolution regions within maps</title><p id="P42">An illustrative low-resolution example is provided in <xref ref-type="fig" rid="F6">Fig. 6A</xref>, comparing models generated by CryFold and ModelAngelo. The case involves an open state of <italic>kainate receptor GluK2</italic> (PDB ID: 9B36) with 4.3 Å resolution. CryFold successfully constructs structures for 81.2% of the residues, achieving 0.45 Å backbone RMSD. In contrast, ModelAngelo constructs structures for 72.6% residues, achieving 0.53 Å backbone RMSD. Due to the lower resolution in the peripheral regions of the density map, ModelAngelo encountered difficulties during modeling. However, CryFold constructed relatively complete atomic models for these regions (<xref ref-type="fig" rid="F6">Fig. 6A</xref>). In addition, CryFold takes less time than ModelAngelo for the modeling (0.28h vs 0.81h). This example clearly demonstrates CryFold’s superior modeling capability and efficiency for handling low-resolution regions within maps.</p></sec><sec id="S16"><label>2</label><title>Resolving compositional heterogeneity by identifying closely related isoforms within a noisy map</title><p id="P43">To illustrate CryFold’s precision in distinguishing closely related sequences, we selected a challenging case from photosynthesis involving light harvesting. This process is mediated by pigment-protein light-harvesting complexes (Lhc) which function as antennas around catalytic reaction centers, converting photons into chemical energy (<xref ref-type="bibr" rid="R45">45</xref>). These Lhc proteins have been conserved across eukaryotic photosynthetic organisms for billions of years (<xref ref-type="bibr" rid="R46">46</xref>). In the structure of a plant photosystem, the antenna consists of four Lhca proteins (<xref ref-type="bibr" rid="R47">47</xref>, <xref ref-type="bibr" rid="R48">48</xref>). However, wild-type plants have been reported to contain additional isoforms with higher energy chlorophylls (<xref ref-type="bibr" rid="R49">49</xref>), and studies suggest extra Lhca dimers (<xref ref-type="bibr" rid="R50">50</xref>), supported by <italic>in vitro</italic> reconstitution (<xref ref-type="bibr" rid="R51">51</xref>, <xref ref-type="bibr" rid="R52">52</xref>). We purified photosystem I from a marine angiosperm in the Mediterranean and reconstructed its 3D structure. No reference protein database was used for this modeling. Compared to canonical models from pea and maize (<xref ref-type="bibr" rid="R53">53</xref>, <xref ref-type="bibr" rid="R54">54</xref>), we observed an additional Lhca regulatory dimer with unknown sequences (<xref ref-type="fig" rid="F6">Fig. 6B</xref>).</p><p id="P44">These unidentified chains are located in a region with 3.0-4.0 Å resolution (<xref ref-type="fig" rid="F6">Fig. 6C</xref>). Despite the short length (~200 residues) and high similarity (&gt;75% identity) with other isoforms, CryFold generated an atomic model for these new chains without any reference protein database. This enabled us to match the sequences within genomic data and identify them among a family of over ten highly similar proteins. Specifically, these chains were identified as Lhca1 and Lhca4 isoforms. Furthermore, this performance also underscores CryFold’s ability to segment cryo-EM maps, focusing only on protein regions even with multiple cofactors present, as well as noisy density (<xref ref-type="fig" rid="F6">Fig. 6C,D</xref>). Specifically, the map region for the two newly identified proteins includes more than 40 non-protein cofactors such as chlorophyll a, chlorophyll b, lutein, violaxanthin, and β-carotene, as well as various lipids distributed on different sides of the heterodimer that dominate the cryo-EM density (<xref ref-type="fig" rid="F6">Fig. 6D</xref>). The calculation took 1.3 hours on an A800 GPU.</p><p id="P45">To assess the quality of the assignments, we used the sequences of the newly identified Lhca-UNK1 and Lhca-UNK2 proteins, along with their interacting chains, as input to AF3 (<xref ref-type="bibr" rid="R41">41</xref>). The AF3 model is relatively accurate (ranking score: 0.71) and has an overall fold consistent with CryFold’s model (<xref ref-type="supplementary-material" rid="SD1">Fig. S9</xref>). However, the positions of the newly identified proteins are shifted, probably because the predicted interfaces with other interacting chains in the AF3 model have low accuracy (pTM: 0.37 and 0.3). This experiment illustrates the superior capability of CryFold over pure structure modeling.</p></sec><sec id="S17"><label>3</label><title>Detecting new proteins in multi-component complexes</title><p id="P46">Another challenge in protein modeling for complex organisms is determining the identity of previously uncharacterized proteins directly from the cryo-EM map. CryFold is able to address this challenge iteratively without extra model training. Specifically, an initial set of sequences, which can be completely random or part of the sequences related to the density map, can be fed into CryFold. The HMM profiles generated by CryFold are then compared with the sequences in the sequence database related to the density map (e.g., can be easily download from the UniProt database by organism information, or just use the whole UniProt database if nothing is known). Successfully matched sequences are added into the initial sequence set. CryFold is run again with the updated set of sequences. This iterative process continues until no new sequences are identified. The final set of sequences represents all sequences related to the density map. Once the sequence database is prepared, this process becomes fully automated and requires no manual intervention. This enables for the automatic search of sequences within the density map from a vast sequence database, thereby constructing atomic models. The prerequisite for this process to work is that the provided sequence database must encompass all protein sequences in the density map. Given the rapid development of the genome sequencing projects, this assumption is not difficult to meet. We can use this function to identify unknown or missing subunits that human experts failed to build.</p><p id="P47">We tested CryFold’s ability to tackle this using an unpublished reconstruction of another photosynthetic complex with multiple chains from a brown alga. In this example, CryFold identified and modeled 22 proteins, six of which had not been previously characterized (<xref ref-type="fig" rid="F6">Fig. 6E</xref>). Additionally, two universally conserved chains exhibited fully resolved extensions of 71 and 99 residues, effectively doubling the original size of each protein in the core complex; indicating potential functional relevance (<xref ref-type="fig" rid="F6">Fig. 6F</xref>). None of the newly modeled sections had not been identified before, nor had the new chains been predicted to be part of the complex. CryFold’s ability to detect new proteins and structural extensions within intricate cryo-EM data demonstrates its efficiency, with calculations taking only 1.1 hours on an A800 GPU.</p></sec><sec id="S18"><label>4</label><title>Capturing minor conformational changes in a mega-Dalton complex</title><p id="P48">To explore CryFold’s sensitivity to subtle conformational changes, we used a mitochondrial supercomplex functioning as a respirasome, with a mass of 1.8 MDa, in which only one protein displayed a slight rotation (<xref ref-type="bibr" rid="R16">16</xref>). First, CryFold generated an atomic model from the map of the native source, constructing the 104-protein complex in 5.6 hours, with half of the chains being species-specific (<xref ref-type="fig" rid="F6">Fig. 6G</xref>). Compared to ModelAngelo, CryFold provided higher completeness in lower resolution regions of the map (<xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>). To further assess CryFold’s precision, we classified two maps and found a subtle 15 Å movement in a single peripheral domain of a protein. This minor motion was resolved in two conformations within the 261 × 296 Å supercomplex. The resolution in the area of this conformational shift is 3.0-4.0 Å. CryFold’s ability to capture such minor structural variations demonstrates its effectiveness for investigating dynamic biological particles and targeting structural regulation.</p></sec><sec id="S19"><label>5</label><title>Performance on a large protein-nucleic acid complex</title><p id="P49">Finally, we tested if CryFold works for large-scale biological macromolecules. As a representative example, we used the human mitoribosome, which has over 80 protein chains and a large overall dimensions of 307 × 287 × 286 Å <sup>51</sup>. Although CryFold does not currently model nucleic acids, it successfully segmented the heterogeneous density, where one-third corresponds to nucleic acids <sup>52</sup>. Notably, 78 out of 87 protein chains were modeled with &gt;80% completeness (<xref ref-type="supplementary-material" rid="SD1">Fig. S11</xref>). This example demonstrates that CryFold effectively handles large-scale structures containing significant amounts of nucleic acids.</p></sec></sec></sec><sec id="S20" sec-type="discussion"><title>Discussion</title><p id="P50">In this study, we demonstrate the advanced capabilities of CryFold in addressing complex challenges in macromolecular modeling through a novel local-attention network and 3D rotary position embedding. CryFold increases the accuracy and completeness of automated built protein models while reducing the execution time and requirement for map resolution. Tests on large complexes show identification of previously unknown proteins that could not be revealed by other automated tools or predicted. For most tested maps, it constructs models with over 80% completeness, including for protein complexes with nucleic acids, and previously missing residues could be modeled. Through specific examples, we illustrate CryFold’s applications in addressing challenging tasks of modern macromolecular modeling. They include: successfully resolving low-resolution map regions, identifying closely related isoforms within noisy maps, detecting novel proteins in multi-component complexes even without a well-established protein database, and capturing subtle conformational changes within large protein assemblies. CryFold also goes beyond simple structural modeling by segmenting maps with multiple cofactors. Together, these results underscore CryFold’s ability to tackle a variety of complex challenges in macromolecular modeling in a more time-efficient manner. The versatility, cost-efficiency and precision, mark CryFold as a valuable tool for high-throughput macromolecular modeling and functional analysis of dynamic biological assemblies.</p><p id="P51">Although CryFold leverages deep learning to reduce resolution requirements, modeling at low resolution remains challenging. This difficulty stems from the inability to accurately identify protein side chains in low-resolution regions. The challenge arises from the heterogeneous nature of cryo-EM data: stable residues are well-resolved (reflected in high-resolution areas), whereas dynamic regions appear blurred (reflected in low-resolution areas). One potential solution for low-resolution regions is to represent them with an ensemble of conformations rather than a single fixed structure. CryoFold (<xref ref-type="bibr" rid="R55">55</xref>) serves as a good example of using molecular dynamics simulations to address this issue. Additionally, CryFold can incorporate MDFF (<xref ref-type="bibr" rid="R56">56</xref>) during the post-processing stage, which is a method for flexible fitting of density maps using molecular dynamics. These enhancements will be explored in future work.</p></sec><sec id="S21" sec-type="methods"><title>Methods</title><sec id="S22"><title>Training and test data</title><sec id="S23"><title>Training set and validation set</title><p id="P52">In order to train our method and compare with ModelAngelo(<xref ref-type="bibr" rid="R2">2</xref>), we constructed the training dataset with the same setting used in ModelAngelo. Specifically, the training set consists of 6422 EMDB (<xref ref-type="bibr" rid="R42">42</xref>) cryo-EM density maps released before April 1, 2022 with resolution better than 4Å and paired structures in PDB (<xref ref-type="bibr" rid="R6">6</xref>). The full training set was used to train an initial model. The model was used to filter the training dataset based on the precision (&gt;0.5) of the predicted Cα atoms. After filtering, there are 5731 remaining map-model pairs, of which 10% are randomly selected for validation and 90% for training.</p></sec><sec id="S24"><title>High-resolution test set</title><p id="P53">The test dataset we used consists of 177 high-resolution (better than 4 Å) maps from ModelAngelo(<xref ref-type="bibr" rid="R2">2</xref>) (released between April 1, 2022 and February 9, 2023).</p></sec><sec id="S25"><title>Low-resolution test set</title><p id="P54">To test the performance of CryFold on low-resolution maps, we collected another set of maps with lower resolution. We first obtained 135 maps with resolutions 4-7 Å, which were released between January 1, 2024 and June 1, 2024 (about two years after the training data). Among these maps, ModelAngelo failed to build atomic structures for 31 maps (the program did not respond for a long time or encountered errors during the process). Therefore, the final low-resolution test dataset consists of 104 maps with resolutions 4-7 Å. The number of residues in these maps ranges from 250 to 17520 (3461 residues on average).</p></sec><sec id="S26"><title>Non-redundant test set</title><p id="P55">To investigate if there is any issue of data leakeage or not, we construct a non-redundant set here. Specifically, if the test density map and the training density map have at least one pair of protein chains with over 40% sequence identity, we will remove it from the test dataset. Additionally, the test dataset is clustered internally based on 40% sequence identity. After applying the above steps, out of 281 map-model pairs, 101 map-model pairs are retained.</p></sec></sec><sec id="S27"><title>CryFold algorithm</title><p id="P56">CryFold builds the atomic structure from the cryo-EM density map and amino acid sequence information through two major steps (see <xref ref-type="fig" rid="F1">Fig. 1</xref>). The first step predicts the Cα atom positions using U-Net(<xref ref-type="bibr" rid="R36">36</xref>); The second step builds all-atom positions using an enhanced transformer network Cry-Net. They are described in details below.</p><sec id="S28"><title>Step 1: Predict the Cα atom positions using U-Net</title><p id="P57">We train a 3D convolutional neural network to predict the Cα atom positions of all residues in the density map, which are represented by the Cα atoms coordinates. The convolutional neural network adopts the U-Net architecture(<xref ref-type="bibr" rid="R36">36</xref>). A detailed architecture can be found in the supporting <xref ref-type="supplementary-material" rid="SD1">Fig. S12</xref>. The input to the network is the cropped density map, with each box size being 64×64×64. The shapes of the network outputs (i.e., <italic>y</italic><sup><italic>pred</italic></sup> and <italic>ŷ</italic><sup><italic>pred</italic></sup> in <xref ref-type="fig" rid="F1">Fig. 1</xref>) are the same as the original map but the value in each voxel (i.e., each cube 1×1×1) is the probability of containing a Cα atom (obtained through a sigmoid layer). The difference between <italic>y</italic><sup><italic>pred</italic></sup> and <italic>ŷ</italic><sup><italic>pred</italic></sup> is that their corresponding labels are slightly different; the label for the former is a hard label, while the label for the latter is a soft label. Here, <italic>y</italic><sup><italic>pred</italic></sup> is used as the final output of the U-Net.</p><p id="P58">The loss function for U-Net(<xref ref-type="bibr" rid="R36">36</xref>) consists of the focal loss (<xref ref-type="bibr" rid="R57">57</xref>) (<italic>FC</italic>) and <italic>L</italic><sub>2</sub> distance loss (<italic>L</italic><sub>2</sub>) as follows:<disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>y</italic><sup><italic>pred</italic></sup> and <italic>ŷ</italic><sup><italic>pred</italic></sup> are both predicted probability density maps for Cα atoms. <italic>y</italic><sup><italic>true</italic></sup> represents the map labeled by the positions of the real Cα atoms, in which a value of 1/0 indicates the presence/absence of a Cα atom; <italic>ŷ</italic><sup><italic>true</italic></sup> represents the simulated Cα probability density map, which is calculated the deposited Cα atom coordinates as follows(<xref ref-type="bibr" rid="R58">58</xref>): <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>‖</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:msup><mml:mo>‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>J</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>x</italic> is a grid point, <italic>t</italic> represents the coordinates of the Cα atoms, and <italic>J</italic> represents the set of all Cα atoms in the deposited structure; <italic>d</italic><sub><italic>0</italic></sub> represents a normalization factor (3 Å here). If the distance from the grid point <italic>x</italic> to the nearest Cα atom is <italic>d</italic><sub><italic>0</italic></sub>, the probability value for the grid point will be <italic>1/e</italic>. We combine both losses, aiming for the network to learn rich information from the density map.</p><p id="P59">The Cα atom coordinates predicted above are refined through the mean-shift algorithm(<xref ref-type="bibr" rid="R26">26</xref>, <xref ref-type="bibr" rid="R59">59</xref>). The initial Cα atom coordinates with a probability value above 0.6 are selected first. Then the coordinates for each of the selected Cα atom are updated as the weighted linear sum of its neighboring Cα atoms within 1.7Å (including itself). After this update, the neighboring Cα atoms are removed because the Van der Waals radius of a carbon atom is 1.7Å. Such refinement is necessary because the real coordinates are continuous while the predicted ones from the density maps are discrete. After the refinement, we obtain a set of predicted Cα atoms (the total number of Cα atoms is denoted by <italic>r</italic>).</p></sec><sec id="S29"><title>Step 2: Build all-atom positions using Cry-Net</title><p id="P60">Inspired by AlpahFold2, we designed a transformer network to build all-atom positions using a transformer network (named Cry-Net) from the input density map, the input sequences and the predicted Cα atoms. Cry-Net consists of two transformer-based modules. The first one is called Cryformer (see the lower panel of <xref ref-type="fig" rid="F1">Fig. 1</xref>, and <xref ref-type="supplementary-material" rid="SD1">Fig. S13A</xref>) and the second one is called Structure Module (see the lower panel of <xref ref-type="fig" rid="F1">Fig. 1</xref>, and <xref ref-type="supplementary-material" rid="SD1">Fig. S14</xref>). Cry-Net iteratively updates two key representations of the protein structure: <italic>node representation</italic> and <italic>edge representation</italic> (correspond to the single representation and the pair representation in AF2, respectively), which are introduced below.</p></sec></sec><sec id="S30"><title>Node representation</title><p id="P61">The node representation (<italic>r</italic>×<italic>c, r</italic> is the number of predicted Cα atoms, <italic>c</italic> is the number of channels) is constructed from the predicted Cα atoms and the density map as follows. A cubic box with size 17×17×17 Å<sup>3</sup> centered at each of the <italic>r</italic> predicted Cα atoms is cropped from the density map first. Then to extract information from the density map and reduce the dimensionality, a convolutional neural network (CNN) is used to convert the density map in each cubic box into <italic>c</italic> channels. The architecture of this CNN is the same as the encoder module in U-Net(<xref ref-type="bibr" rid="R36">36</xref>) (<italic>i</italic>.<italic>e</italic>., <xref ref-type="supplementary-material" rid="SD1">Fig. S12A</xref>).</p></sec><sec id="S31"><title>Edge representation</title><p id="P62">The edge representation (<italic>k</italic>×<italic>r</italic>×<italic>c</italic>) is constructed similarly, measuring the relationship between neighboring nodes (<italic>k</italic> is the number of nearest neighbors considered). For each edge, a rectangular box with size 3×3×12 Å<sup>3</sup> is cropped from the density map. The Cα atom is located at the center of the bottom box (<italic>i</italic>.<italic>e</italic>., the 3×3 square) and the direction of the box is the same as the edge vector. Finally, another convolutional neural network (with kernel size 3×3×1) is used to convert the density map in each rectangular box into <italic>c</italic> channels.</p><p id="P63">Note that the above representations are different with the ones used in AF2. The representations here are constructed from the density map guided by the predicted Cα atoms (inspired by ModelAngelo); rather than from multiple sequence alignment (MSA) and homologous templates in AF2. In addition, the edge representation (called pair representation in AF2) is a square matrix (<italic>r</italic>×<italic>r</italic>) in AF2; while a non-square matrix (<italic>k</italic>×<italic>r</italic>) here. This is because the density map already provides rich structure information and we only need to consider the <italic>k</italic>-nearest neighbors rather than all nodes.</p><p id="P64">The input and output of Cry-Net in the <italic>n</italic>-th iteration are defined by the following equation: <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>T</italic><sup>(<italic>n</italic>)</sup> ∈ <sup>~ <italic>r</italic>×3×4</sup> is the backbone frame (N, Cα, C) at the <italic>n</italic>-th step, <italic>V</italic> is the density map, <italic>S</italic> ∈ <sup>~ <italic>r</italic>×1280</sup> is the sequence embedding from the protein language model ESM-2(<xref ref-type="bibr" rid="R60">60</xref>), α ∈ <sup>~ <italic>r</italic>×7×2</sup> is the sine and cosine encoding of the three backbone and up to four side-chain torsion angles, <italic>A</italic> ∈ <sup>~ <italic>r</italic>×20</sup> is the probability vector for the 20 types of amino acids, <italic>P</italic> ∈ <sup>~ <italic>r</italic></sup> is the confidence score of each node, <italic>E</italic> ∈ <sup>~ <italic>r</italic>×<italic>k</italic></sup> is a binary vector indicating whether each node is sequentially adjacent to its <italic>k</italic> nearest neighbors or not, and <italic>M</italic> ∈ <sup>~ <italic>r</italic></sup> is the probability of a node being a true residue.</p></sec><sec id="S32"><title>Cryformer</title><p id="P65">The Cryformer module consists of a total of 18 blocks with non-shared weights, as shown in <xref ref-type="supplementary-material" rid="SD1">Fig. S13A</xref>. The key difference between Cryformer and the Evoformer in AF2 is the concentration on local attention rather than global attention. This is reflected by the number of neighbors considered (i.e., the parameter <italic>k</italic>). Evoformer will be equivalent to Cryformer when <italic>k</italic> equals to the total number of nodes (i.e., <italic>k</italic>=<italic>r</italic>). The key components of Cryformer are described below.</p><sec id="S33"><title>Sequence attention</title><p id="P66">This layer incorporates the protein sequence information into the node features with a gated cross-attention mechanism (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Information S2.3, Algorithm S1</xref>). The node representations are queries, and the sequence embeddings from a pre-trained protein language model (<italic>i</italic>.<italic>e</italic>., ESM-2(<xref ref-type="bibr" rid="R60">60</xref>)) are keys and values.</p></sec><sec id="S34"><title>Node attention</title><p id="P67">As shown in <xref ref-type="supplementary-material" rid="SD1">Fig. S13B</xref>, the node attention updates the representation of a given node based on self-attention on the node and its <italic>k</italic> nearest neighbors, with the information of edge representations serving as bias. As the depth of this network increases, it can collect information from more nodes, resulting in a larger receptive field. It is worth noting that this node attention will be equivalent to the row-wise gated self-attention in AF2 when <italic>k</italic> equals to <italic>r</italic>.</p></sec><sec id="S35"><title>Transition and outer product</title><p id="P68">Inspired by AlphaFold3(<xref ref-type="bibr" rid="R41">41</xref>), The transition layer uses the SwiGLU(<xref ref-type="bibr" rid="R61">61</xref>) instead of ReLU(<xref ref-type="bibr" rid="R62">62</xref>) to update the node and edge features. It uses the non-linear activation function to enrich the representation of the two types of features. The outer product layer updates the edge features based on the node features. It incorporates the node features of two adjacent nodes into the edge features.</p></sec><sec id="S36"><title>Edge attention</title><p id="P69">As shown in <xref ref-type="supplementary-material" rid="SD1">Fig. S13C</xref>, the edge attention updates the edge representation through self-attention mechanism. The information of edge <italic>ij</italic> is aggregated from the information of all edges connected to node <italic>i</italic> and all edges connected to node <italic>j</italic>. The edge attention can be seen as a special type of the node attention, according to the Whitney graph isomorphism theorem (<xref ref-type="supplementary-material" rid="SD1">Fig. S15</xref>). In addition, it is worth mentioning that when <italic>k</italic>=<italic>r</italic>, the edge attention is equivalent to applying AF2’s row and column attentions simultaneously.</p></sec><sec id="S37"><title><italic>3D Rotary Position Embedding</italic> (3D-RoPE)</title><p id="P70">3D-RoPE is not an independent component. Originally, RoPE(<xref ref-type="bibr" rid="R37">37</xref>) was used to process 1D sequences. We extend it to a node position encoding in 3D space. It is inserted into the node attention as a multiplicative positional encoding. It elegantly encodes the position information of each node into the attention calculations. The attention score will decay when the distance between two nodes increases. Please refer to the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information S2.4</xref> for more detailed description about 3D-RoPE.</p></sec><sec id="S38"><title>Amino acid probability for each node</title><p id="P71">In order to generate all-atom positions, we try to assign each node to one of the 20 possible amino acids. This is done by using the information from the density map of each node (i.e., the original node representation), the information from neighboring nodes (i.e., the updated node representation) and the sequence information (obtained from the sequence attention in Cryformer). A separate MLP is trained to generate the amino acid probability vectors for all nodes (i.e., <italic>A</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S16</xref>). Ablation experiments indicate that removing the information of neighboring nodes (i.e., no node attention and edge attention) or removing the sequence information will affect the subsequent determination of amino acid identity.</p></sec></sec><sec id="S39"><title>Structure Module</title><p id="P72">The Structure Module here (see <xref ref-type="supplementary-material" rid="SD1">Fig. S14</xref>) is largely similar to the one in AF2 but with a few key differences (detailed below). It predicts the backbone frame (i.e., <italic>T</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>) as well as the backbone and side-chain torsion angles (i.e., <italic>α</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>), using the updated node and edge representations from Cryformer. The Structure Module consists of 7 blocks with shared weights. Two types of attention mechanisms are used in this module (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Information S2.3 and Algorithm S2</xref>).</p><p id="P73">The first one is a self-attention mechanism applied to the node features (similar to the node attention in Cryformer). Given the constraints from the density map, the attention is restricted to each node and its <italic>k</italic> nearest neighbors (rather than all other nodes in AF2).</p><p id="P74">In addition, the position information between nodes is introduced into the attention mechanism using 3D-RoPE, ensuring that the attention score incorporates position information.</p><p id="P75">The second type of attention is the Invariant Point Attention (IPA) from AF2. It is conducted on the backbone frames and is invariant under global Euclidean transformations. Like the first type of attention, the attention is restricted to a node and its <italic>k</italic> neighboring nodes (rather than all others in AF2).</p><p id="P76">Cry-Net will be run iteratively to improve its output. During training, 0-2 rounds of iterations are performed. Only the backbone frame is iterated. During inference, two rounds of iterations are performed. The reason for choosing <italic>n</italic>=2 here is to keep a balance between computational cost and performance. No significant improvement in the network output was observed when more rounds of iterations are performed.</p><p id="P77">Finally, all-atom positions for each node are then generated using the predicted backbone frame, the backbone and side-chain torsion angles, as well as the predicted amino acid type (the amino acid type with the maximum probability). This calculation is done using the function <italic>frames_and_literature_positions_to_atom14_pos</italic> in the AF2 script <italic>all_atom</italic>.<italic>py</italic>.</p><p id="P78">The predicted all-atom positions are postprocessed to connect the unordered nodes into chains of amino acid sequences. This is done by using the heuristic algorithm in ModelAngelo(<xref ref-type="bibr" rid="R2">2</xref>). Intuitively, it connects nodes by minimizing the total length of peptide bond, based on the fact that the C-N distance in a peptide bond is less than 1.4 Å. Profile-sequence-based alignments between the predicted sequence profiles (i.e., <italic>A</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>) and the input sequences are further employed to correct the sequence assignment. Inspired by AF2, recycling is also used here by replacing the predicted Cα atoms in the first step by the ones from the postprocessed structure. Three rounds of recycling are used in this work.</p></sec><sec id="S40"><title>The loss function for Cry-Net</title><p id="P79">The loss function here can be written as: <disp-formula id="FD4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mspace width="0.2em"/><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>multi</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>single</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula> <disp-formula id="FD5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>multi</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>C</mml:mtext><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1.3</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>FAPE</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.025</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>pFAPE</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>existence</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="FD6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>single</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>atom</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>torsion</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>attention</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>violation</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.3</mml:mn><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>aa</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>edge</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula> where the overall <italic>Loss</italic><sub>2</sub> can be divided into <italic>L</italic><sub>single</sub> (single-step loss) and <italic>L</italic><sub>multi</sub> (multi-step loss). The single-step loss is the final loss output after passing through 7 structure modules, while the multi-step loss is calculated 7 times within the 7 structure modules and averaged. They are described in detail below.</p><p id="P80"><italic>L</italic><sub><italic>atom</italic></sub> is the all-atom RMSD. It calculates the RMSD loss of all atoms on the main chain and side chain, which can be written as:<disp-formula id="FD7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>atom</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>r</mml:mi></mml:munderover><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula> where <italic>r</italic> represents the total number of residues, <italic>n</italic><sub><italic>i</italic></sub> represents the number of atoms in the <italic>i</italic>-th residue, <italic>x</italic><sub><italic>ij</italic></sub> represents the atomic coordinates of the <italic>j</italic>-th atom in the <italic>i</italic>-th residue, and <italic>d</italic> represents the <italic>d</italic>-th dimension of the 3D coordinates.</p><p id="P81"><italic>L</italic><sub>torsion</sub> is the L<sub>2</sub> distance between the torsion angles of the network output (i.e., <italic>α</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>) and the torsion angles of the deposited model. It is the same as the torsion angle loss defined in AF2.</p><p id="P82"><italic>L</italic><sub>attention</sub> is the classification loss when the nodes attend to the amino acids in the sequence. The calculation of this loss is the focal loss(<xref ref-type="bibr" rid="R57">57</xref>). The purpose of this loss is to ensure that each node can correctly match each amino acid in the sequence.</p><p id="P83"><italic>L</italic><sub>violation</sub> penalizes unreasonable bond angles and bond lengths in the model. It imposes certain constraints on the model’s output to ensure that the model’s output has ideal bond angles and lengths. The definition of this loss is the same as AF2.</p><p id="P84"><italic>L</italic><sub>aa</sub> represents the amino acid classification loss. This loss calculates the focal loss by comparing the twenty-dimensional amino acid probability vector (i.e., <italic>A</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>) and the one-hot vector corresponding to the amino acid identity in the deposited structure. The main purpose of this loss is to assign an amino acid identity to each node.</p><p id="P85"><italic>L</italic><sub>edge</sub> represents the edge classification loss. The edge classification is based on whether there is a connection between two nodes in the sequence. If there is a connection, we want them to be classified as neighbors. Specifically, this loss calculates the focal loss between <italic>E</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref> and the classification corresponding to the edge.</p><p id="P86"><italic>L</italic><sub>Cα</sub> is only the RMSD loss of Cα atoms. Its definition is similar to the all-atom RMSD (i.e., <italic>n</italic><sub><italic>i</italic></sub><italic>=1</italic> in <xref ref-type="disp-formula" rid="FD7">Eq. 7</xref>).</p><p id="P87"><italic>L</italic><sub>FAPE</sub> comes from AF2, which plays a role in updating the backbone frame. It can be written as:<disp-formula id="FD8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>∘</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>∘</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:msup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula><disp-formula id="FD9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <italic>T</italic><sub><italic>i</italic></sub> represents the <italic>i</italic>-th backbone frame (i.e., <italic>T</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>). <italic>t</italic><sub><italic>j</italic></sub> represents the coordinates of the <italic>j</italic>-th Cα atom. Both <italic>d</italic><sub><italic>clamp</italic></sub> and <italic>Z</italic> are taken as 10 Å here.</p><p id="P88"><italic>L</italic><sub>pFAPE</sub> is a simple regression loss. It calculates the mean squared error (MSE) loss between the predicted FAPE loss for each residue (i.e., <italic>P</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>) and the actual FAPE loss (i.e., <xref ref-type="disp-formula" rid="FD9">Eq. 9</xref>). It is worth noting that in the post-processing, <italic>P</italic> will be normalized to a confidence score between 0 and 100 as the final confidence score.</p><p id="P89"><italic>L</italic><sub>existence</sub> represents the residue existence loss. Each residue can be classified into two classes: artificially added (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Information S2.5</xref>) and naturally occurring. This loss calculates the focal loss between <italic>M</italic> in <xref ref-type="disp-formula" rid="FD3">Eq. 3</xref> and the corresponding one-hot vector of the residue class.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Materials</label><media xlink:href="EMS203662-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d20aAcDbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S42"><title>Acknowledgements</title><p>We would like to thank K. Jamali and S.H.W. Scheres for their kind help in the benchmark of ModelAngelo; S. Caffarri, A. Naschberger, R. Sobotka, and F. Wu for help with the structural studies. This work is supported by the Ministry of Science and Technology of the People’s Republic of China (2024YFA0916901), the National Natural Science Foundation of China (NSFC T2225007, T2222012, 32430063), the Fundamental Research Funds for the Central Universities, European Research Council (ERC-805230), and Westlake Visiting Professor Fellowship to AA.</p></ack><sec id="S41" sec-type="data-availability"><title>Software availability</title><p id="P90">The source code and model parameters are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SBQ-1999/CryFold/">https://github.com/SBQ-1999/CryFold/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/CryFold/">https://yanglab.qd.sdu.edu.cn/CryFold/</ext-link></p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><etal/></person-group><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><year>2021</year><volume>596</volume><issue>7873</issue><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="pmcid">PMC8371605</pub-id><pub-id pub-id-type="pmid">34265844</pub-id><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jamali</surname><given-names>K</given-names></name><etal/></person-group><article-title>Automated model building and protein identification in cryo-EM maps</article-title><source>Nature</source><year>2024</year><volume>628</volume><issue>8007</issue><fpage>450</fpage><lpage>457</lpage><pub-id pub-id-type="pmcid">PMC11006616</pub-id><pub-id pub-id-type="pmid">38408488</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07215-4</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakane</surname><given-names>T</given-names></name><etal/></person-group><article-title>Single-particle cryo-EM at atomic resolution</article-title><source>Nature</source><year>2020</year><volume>587</volume><issue>7832</issue><fpage>152</fpage><lpage>156</lpage><pub-id pub-id-type="pmcid">PMC7611073</pub-id><pub-id pub-id-type="pmid">33087931</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2829-0</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><etal/></person-group><article-title>Structure of the yeast mitochondrial large ribosomal subunit</article-title><source>Science</source><year>2014</year><volume>343</volume><issue>6178</issue><fpage>1485</fpage><lpage>1489</lpage><pub-id pub-id-type="pmcid">PMC4046073</pub-id><pub-id pub-id-type="pmid">24675956</pub-id><pub-id pub-id-type="doi">10.1126/science.1249410</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kühlbrandt</surname><given-names>W</given-names></name></person-group><article-title>Biochemistry. The resolution revolution</article-title><source>Science</source><year>2014</year><volume>343</volume><issue>6178</issue><fpage>1443</fpage><lpage>1444</lpage><pub-id pub-id-type="pmid">24675944</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burley</surname><given-names>SK</given-names></name><etal/></person-group><article-title>RCSB Protein Data Bank (RCSB.org): delivery of experimentally-determined PDB structures alongside one million computed structure models of proteins from artificial intelligence/machine learning</article-title><source>Nucleic Acids Research</source><year>2023</year><volume>51</volume><issue>D1</issue><fpage>D488</fpage><lpage>D508</lpage><pub-id pub-id-type="pmcid">PMC9825554</pub-id><pub-id pub-id-type="pmid">36420884</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac1077</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chua</surname><given-names>EYD</given-names></name><etal/></person-group><article-title>Better, Faster, Cheaper: Recent Advances in Cryo-Electron Microscopy</article-title><source>Annu Rev Biochem</source><year>2022</year><volume>91</volume><fpage>1</fpage><lpage>32</lpage><pub-id pub-id-type="pmcid">PMC10393189</pub-id><pub-id pub-id-type="pmid">35320683</pub-id><pub-id pub-id-type="doi">10.1146/annurev-biochem-032620-110705</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de la Rosa-Trevin</surname><given-names>JM</given-names></name><etal/></person-group><article-title>EMhub: a web platform for data management and on-the-fly processing in scientific facilities</article-title><source>Acta Crystallogr D Struct Biol</source><year>2024</year><pub-id pub-id-type="pmcid">PMC11544427</pub-id><pub-id pub-id-type="pmid">39373194</pub-id><pub-id pub-id-type="doi">10.1107/S2059798324009471</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>DI</given-names></name><name><surname>Subramaniam</surname><given-names>S</given-names></name><name><surname>Abrescia</surname><given-names>NG</given-names></name></person-group><article-title>The democratization of cryo-EM</article-title><source>Nat Methods</source><year>2016</year><volume>13</volume><issue>8</issue><fpage>607</fpage><lpage>608</lpage><pub-id pub-id-type="pmcid">PMC10720754</pub-id><pub-id pub-id-type="pmid">27467721</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3946</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><etal/></person-group><article-title>The I-TASSER Suite: protein structure and function prediction</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><issue>1</issue><fpage>7</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC4428668</pub-id><pub-id pub-id-type="pmid">25549265</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3213</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emsley</surname><given-names>P</given-names></name><name><surname>Lohkamp</surname><given-names>B</given-names></name><name><surname>Scott</surname><given-names>WG</given-names></name><name><surname>Cowtan</surname><given-names>K</given-names></name></person-group><article-title>Features and development of Coot</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>2010</year><volume>66</volume><issue>Pt 4</issue><fpage>486</fpage><lpage>501</lpage><pub-id pub-id-type="pmcid">PMC2852313</pub-id><pub-id pub-id-type="pmid">20383002</pub-id><pub-id pub-id-type="doi">10.1107/S0907444910007493</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname><given-names>TI</given-names></name></person-group><article-title>ISOLDE: a physically realistic environment for model building into low-resolution electron-density maps</article-title><source>Acta Crystallogr D Struct Biol</source><year>2018</year><volume>74</volume><issue>Pt 6</issue><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="pmcid">PMC6096486</pub-id><pub-id pub-id-type="pmid">29872003</pub-id><pub-id pub-id-type="doi">10.1107/S2059798318002425</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>A</given-names></name><etal/></person-group><article-title>Structures of the human mitochondrial ribosome in native states of assembly</article-title><source>Nat Struct Mol Biol</source><year>2017</year><volume>24</volume><issue>10</issue><fpage>866</fpage><lpage>869</lpage><pub-id pub-id-type="pmcid">PMC5633077</pub-id><pub-id pub-id-type="pmid">28892042</pub-id><pub-id pub-id-type="doi">10.1038/nsmb.3464</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muhleip</surname><given-names>A</given-names></name><etal/></person-group><article-title>ATP synthase hexamer assemblies shape cristae of Toxoplasma mitochondria</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><issue>1</issue><fpage>120</fpage><pub-id pub-id-type="pmcid">PMC7785744</pub-id><pub-id pub-id-type="pmid">33402698</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-20381-z</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muhleip</surname><given-names>A</given-names></name><etal/></person-group><article-title>Structural basis of mitochondrial membrane bending by the I-II-III(2)-IV(2) supercomplex</article-title><source>Nature</source><year>2023</year><volume>615</volume><issue>7954</issue><fpage>934</fpage><lpage>938</lpage><pub-id pub-id-type="pmcid">PMC10060162</pub-id><pub-id pub-id-type="pmid">36949187</pub-id><pub-id pub-id-type="doi">10.1038/s41586-023-05817-y</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wú</surname><given-names>F</given-names></name><etal/></person-group><article-title>Structure of the II2-III2-IV2 mitochondrial supercomplex from the parasite Perkinsus marinus</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.2005.2025.595893</elocation-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>A</given-names></name><etal/></person-group><article-title>Tools for macromolecular model building and refinement into electron cryo-microscopy reconstructions</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>2015</year><volume>71</volume><issue>Pt 1</issue><fpage>136</fpage><lpage>153</lpage><pub-id pub-id-type="pmcid">PMC4304694</pub-id><pub-id pub-id-type="pmid">25615868</pub-id><pub-id pub-id-type="doi">10.1107/S1399004714021683</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chojnowski</surname><given-names>G</given-names></name><etal/></person-group><article-title>findMySequence: a neural-network-based approach for identification of unknown proteins in X-ray crystallography and cryo-EM</article-title><source>IUCrJ</source><year>2022</year><volume>9</volume><issue>Pt 1</issue><fpage>86</fpage><lpage>97</lpage><pub-id pub-id-type="pmcid">PMC8733886</pub-id><pub-id pub-id-type="pmid">35059213</pub-id><pub-id pub-id-type="doi">10.1107/S2052252521011088</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wlodawer</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Dauter</surname><given-names>Z</given-names></name></person-group><article-title>High-Resolution Cryo-EM Maps and Models: A Crystallographer’s Perspective</article-title><source>Structure</source><year>2017</year><volume>25</volume><issue>10</issue><fpage>1589</fpage><lpage>1597</lpage><elocation-id>e1581</elocation-id><pub-id pub-id-type="pmcid">PMC5657611</pub-id><pub-id pub-id-type="pmid">28867613</pub-id><pub-id pub-id-type="doi">10.1016/j.str.2017.07.012</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Thorn</surname><given-names>V</given-names></name><name><surname>Thorn</surname><given-names>A</given-names></name></person-group><article-title>Errors in structural biology are not the exception</article-title><source>Acta Crystallogr D Struct Biol</source><year>2023</year><volume>79</volume><issue>Pt 3</issue><fpage>206</fpage><lpage>211</lpage><pub-id pub-id-type="pmcid">PMC9986796</pub-id><pub-id pub-id-type="pmid">36876430</pub-id><pub-id pub-id-type="doi">10.1107/S2059798322011901</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Baldwin</surname><given-names>PR</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name><name><surname>Baker</surname><given-names>ML</given-names></name></person-group><article-title>De Novo modeling in cryo-EM density maps with Pathwalking</article-title><source>J Struct Biol</source><year>2016</year><volume>196</volume><issue>3</issue><fpage>289</fpage><lpage>298</lpage><pub-id pub-id-type="pmcid">PMC5118137</pub-id><pub-id pub-id-type="pmid">27436409</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2016.06.004</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>MR</given-names></name><name><surname>Rees</surname><given-names>I</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name><name><surname>Chiu</surname><given-names>W</given-names></name><name><surname>Baker</surname><given-names>ML</given-names></name></person-group><article-title>Constructing and validating initial Calpha models from subnanometer resolution density maps with pathwalking</article-title><source>Structure</source><year>2012</year><volume>20</volume><issue>3</issue><fpage>450</fpage><lpage>463</lpage><pub-id pub-id-type="pmcid">PMC3307788</pub-id><pub-id pub-id-type="pmid">22405004</pub-id><pub-id pub-id-type="doi">10.1016/j.str.2012.01.008</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowtan</surname><given-names>K</given-names></name></person-group><article-title>The Buccaneer software for automated model building. 1. Tracing protein chains</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>2006</year><volume>2</volume><issue>Pt 9</issue><fpage>1002</fpage><lpage>1011</lpage><pub-id pub-id-type="pmid">16929101</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindert</surname><given-names>S</given-names></name><etal/></person-group><article-title>EM-fold: De novo folding of alpha-helical proteins guided by intermediate-resolution electron microscopy density maps</article-title><source>Structure</source><year>2009</year><volume>17</volume><issue>7</issue><fpage>990</fpage><lpage>1003</lpage><pub-id pub-id-type="pmcid">PMC3760413</pub-id><pub-id pub-id-type="pmid">19604479</pub-id><pub-id pub-id-type="doi">10.1016/j.str.2009.06.001</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>RY</given-names></name><etal/></person-group><article-title>De novo protein structure determination from near-atomic-resolution cryo-EM maps</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><issue>4</issue><fpage>335</fpage><lpage>338</lpage><pub-id pub-id-type="pmcid">PMC4435692</pub-id><pub-id pub-id-type="pmid">25707029</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3287</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name></person-group><article-title>De novo main-chain modeling for EM maps using MAINMAST</article-title><source>Nature Communications</source><year>2018</year><volume>9</volume><issue>1</issue><pub-id pub-id-type="pmcid">PMC5915429</pub-id><pub-id pub-id-type="pmid">29691408</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-04053-7</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Afonine</surname><given-names>PV</given-names></name><name><surname>Sobolev</surname><given-names>OV</given-names></name></person-group><article-title>A fully automatic method yielding initial models from high-resolution cryo-electron microscopy maps</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><issue>11</issue><fpage>905</fpage><lpage>908</lpage><pub-id pub-id-type="pmcid">PMC6214191</pub-id><pub-id pub-id-type="pmid">30377346</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0173-1</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Prasad</surname><given-names>D</given-names></name><name><surname>Nakamura</surname><given-names>T</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name></person-group><article-title>DeepMainmast: integrated protocol of protein structure modeling for cryo-EM with deep learning and structure prediction</article-title><source>Nat Methods</source><year>2024</year><volume>21</volume><issue>1</issue><fpage>122</fpage><lpage>131</lpage><pub-id pub-id-type="pmid">38066344</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Cao</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>SY</given-names></name></person-group><article-title>Model building of protein complexes from intermediate-resolution cryo-EM maps with deep learning-guided automatic assembly</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><issue>1</issue><elocation-id>4066</elocation-id><pub-id pub-id-type="pmcid">PMC9279371</pub-id><pub-id pub-id-type="pmid">35831370</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-31748-9</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Freddolino</surname><given-names>PL</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><article-title>CR-I-TASSER: assemble protein structures from cryo-EM density maps using deep convolutional neural networks</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><issue>2</issue><fpage>195</fpage><lpage>204</lpage><pub-id pub-id-type="pmcid">PMC8852347</pub-id><pub-id pub-id-type="pmid">35132244</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01389-9</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfab</surname><given-names>J</given-names></name><name><surname>Phan</surname><given-names>NM</given-names></name><name><surname>Si</surname><given-names>D</given-names></name></person-group><article-title>DeepTracer for fast de novo cryo-EM protein structure modeling and special studies on CoV-related complexes</article-title><source>Proc Natl Acad Sci U S A</source><year>2021</year><volume>118</volume><issue>2</issue><pub-id pub-id-type="pmcid">PMC7812826</pub-id><pub-id pub-id-type="pmid">33361332</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2017525118</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giri</surname><given-names>N</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name></person-group><article-title>De novo atomic protein structure modeling for cryoEM density maps using 3D transformer and HMM</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><issue>1</issue><elocation-id>5511</elocation-id><pub-id pub-id-type="pmcid">PMC11217428</pub-id><pub-id pub-id-type="pmid">38951555</pub-id><pub-id pub-id-type="doi">10.1038/s41467-024-49647-6</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Taluja</surname><given-names>M</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name></person-group><article-title>DiffModeler: large macromolecular structure modeling for cryo-EM maps using a diffusion model</article-title><source>Nat Methods</source><year>2024</year><pub-id pub-id-type="pmid">39433880</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baek</surname><given-names>M</given-names></name><etal/></person-group><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title><source>Science</source><year>2021</year><volume>373</volume><issue>6557</issue><fpage>871</fpage><lpage>876</lpage><pub-id pub-id-type="pmcid">PMC7612213</pub-id><pub-id pub-id-type="pmid">34282049</pub-id><pub-id pub-id-type="doi">10.1126/science.abj8754</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>Z</given-names></name><etal/></person-group><article-title>The trRosetta server for fast and accurate protein structure prediction</article-title><source>Nature Protocols</source><year>2021</year><pub-id pub-id-type="pmid">34759384</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Fischer</surname><given-names>P</given-names></name><name><surname>Brox</surname><given-names>T</given-names></name></person-group><source>U-Net: Convolutional Networks for Biomedical Image Segmentation</source><publisher-name>Springer International Publishing</publisher-name><year>2015</year><fpage>234</fpage><lpage>241</lpage></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>J</given-names></name><etal/></person-group><article-title>RoFormer: Enhanced transformer with Rotary Position Embedding</article-title><source>Neurocomputing</source><year>2024</year><volume>568</volume><elocation-id>127063</elocation-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pintilie</surname><given-names>G</given-names></name><etal/></person-group><article-title>Measurement of atom resolvability in cryo-EM maps with Q-scores</article-title><source>Nature Methods</source><year>2020</year><volume>17</volume><issue>3</issue><fpage>328</fpage><lpage>334</lpage><pub-id pub-id-type="pmcid">PMC7446556</pub-id><pub-id pub-id-type="pmid">32042190</pub-id><pub-id pub-id-type="doi">10.1038/s41592-020-0731-1</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>IW</given-names></name><etal/></person-group><article-title>MolProbity: all-atom contacts and structure validation for proteins and nucleic acids</article-title><source>Nucleic Acids Res</source><year>2007</year><volume>35</volume><fpage>W375</fpage><lpage>383</lpage><comment>Web Server issue</comment><pub-id pub-id-type="pmcid">PMC1933162</pub-id><pub-id pub-id-type="pmid">17452350</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkm216</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barad</surname><given-names>BA</given-names></name><etal/></person-group><article-title>EMRinger: side chain–directed model and map validation for 3D cryo-electron microscopy</article-title><source>Nature Methods</source><year>2015</year><volume>12</volume><issue>10</issue><fpage>943</fpage><lpage>946</lpage><pub-id pub-id-type="pmcid">PMC4589481</pub-id><pub-id pub-id-type="pmid">26280328</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3541</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abramson</surname><given-names>J</given-names></name><etal/></person-group><article-title>Accurate structure prediction of biomolecular interactions with AlphaFold 3</article-title><source>Nature</source><year>2024</year><pub-id pub-id-type="pmcid">PMC11168924</pub-id><pub-id pub-id-type="pmid">38718835</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07487-w</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>J</given-names></name><etal/></person-group><article-title>EMDB—the Electron Microscopy Data Bank</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><issue>D1</issue><fpage>D456</fpage><lpage>D465</lpage><pub-id pub-id-type="pmcid">PMC10767987</pub-id><pub-id pub-id-type="pmid">37994703</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkad1019</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Kui Xu</surname><given-names>Z-ED</given-names></name><name><surname>Xing</surname><given-names>Zhang</given-names></name><name><surname>Xin</surname><given-names>You</given-names></name><name><surname>Pan</surname><given-names>Li</given-names></name><name><surname>Nan</surname><given-names>Liu</given-names></name><name><surname>Muzhi</surname><given-names>Dai</given-names></name><name><surname>Chuangye</surname><given-names>Yan</given-names></name><name><surname>Nieng</surname><given-names>Yan</given-names></name><name><surname>Hong-Wei</surname><given-names>Wang</given-names></name><name><surname>Sen-Fang</surname><given-names>Sui</given-names></name><name><surname>Qiangfeng Cliff</surname><given-names>Zhang</given-names></name></person-group><article-title>Protein complex structure determination by structure prediction with cryo-EM density map constraints</article-title><year>2024</year><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/kuixu/cryofold">https://github.com/kuixu/cryofold</ext-link></comment></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Shine</surname><given-names>M</given-names></name><name><surname>Pyle</surname><given-names>AM</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><article-title>US-align: universal structure alignments of proteins, nucleic acids, and macromolecular complexes</article-title><source>Nature Methods</source><year>2022</year><volume>19</volume><issue>9</issue><fpage>1109</fpage><lpage>1115</lpage><pub-id pub-id-type="pmid">36038728</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>N</given-names></name></person-group><article-title>Plant photosystem I design in the light of evolution</article-title><source>Structure</source><year>2009</year><volume>17</volume><issue>5</issue><fpage>637</fpage><lpage>650</lpage><pub-id pub-id-type="pmid">19446520</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>N</given-names></name></person-group><article-title>Functional organization of a plant Photosystem I: evolution of a highly efficient photochemical machine</article-title><source>Plant Physiol Biochem</source><year>2008</year><volume>46</volume><issue>3</issue><fpage>228</fpage><lpage>237</lpage><pub-id pub-id-type="pmid">18272382</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><name><surname>Ben-Shem</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>N</given-names></name></person-group><article-title>Solving the structure of plant photosystem I--biochemistry is vital</article-title><source>Photochem Photobiol Sci</source><year>2005</year><volume>4</volume><issue>12</issue><fpage>1011</fpage><lpage>1015</lpage><pub-id pub-id-type="pmid">16307115</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><name><surname>Drory</surname><given-names>O</given-names></name><name><surname>Nelson</surname><given-names>N</given-names></name></person-group><article-title>The structure of a plant photosystem I supercomplex at 3.4 A resolution</article-title><source>Nature</source><year>2007</year><volume>447</volume><issue>7140</issue><fpage>58</fpage><lpage>63</lpage><pub-id pub-id-type="pmid">17476261</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wientjes</surname><given-names>E</given-names></name><name><surname>Oostergetel</surname><given-names>GT</given-names></name><name><surname>Jansson</surname><given-names>S</given-names></name><name><surname>Boekema</surname><given-names>EJ</given-names></name><name><surname>Croce</surname><given-names>R</given-names></name></person-group><article-title>The role of Lhca complexes in the supramolecular organization of higher plant photosystem I</article-title><source>J Biol Chem</source><year>2009</year><volume>284</volume><issue>12</issue><fpage>7803</fpage><lpage>7810</lpage><pub-id pub-id-type="pmcid">PMC2658074</pub-id><pub-id pub-id-type="pmid">19139095</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M808395200</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lucinski</surname><given-names>R</given-names></name><name><surname>Schmid</surname><given-names>VH</given-names></name><name><surname>Jansson</surname><given-names>S</given-names></name><name><surname>Klimmek</surname><given-names>F</given-names></name></person-group><article-title>Lhca5 interaction with plant photosystem I</article-title><source>FEBS Lett</source><year>2006</year><volume>580</volume><issue>27</issue><fpage>6485</fpage><lpage>6488</lpage><pub-id pub-id-type="pmid">17107674</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storf</surname><given-names>S</given-names></name><name><surname>Jansson</surname><given-names>S</given-names></name><name><surname>Schmid</surname><given-names>VH</given-names></name></person-group><article-title>Pigment binding, fluorescence properties, and oligomerization behavior of Lhca5, a novel light-harvesting protein</article-title><source>J Biol Chem</source><year>2005</year><volume>280</volume><issue>7</issue><fpage>5163</fpage><lpage>5168</lpage><pub-id pub-id-type="pmid">15563470</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storf</surname><given-names>S</given-names></name><name><surname>Stauber</surname><given-names>EJ</given-names></name><name><surname>Hippler</surname><given-names>M</given-names></name><name><surname>Schmid</surname><given-names>VH</given-names></name></person-group><article-title>Proteomic analysis of the photosystem I light-harvesting antenna in tomato (Lycopersicon esculentum</article-title><source>Biochemistry</source><year>2004</year><volume>43</volume><issue>28</issue><fpage>9214</fpage><lpage>9224</lpage><pub-id pub-id-type="pmid">15248779</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>X</given-names></name><etal/></person-group><article-title>Structure of the maize photosystem I supercomplex with light-harvesting complexes I and II</article-title><source>Science</source><year>2018</year><volume>360</volume><issue>6393</issue><fpage>1109</fpage><lpage>1113</lpage><pub-id pub-id-type="pmid">29880686</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amunts</surname><given-names>A</given-names></name><name><surname>Toporik</surname><given-names>H</given-names></name><name><surname>Borovikova</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>N</given-names></name></person-group><article-title>Structure determination and improved model of plant photosystem I</article-title><source>J Biol Chem</source><year>2010</year><volume>285</volume><issue>5</issue><fpage>3478</fpage><lpage>3486</lpage><pub-id pub-id-type="pmcid">PMC2823434</pub-id><pub-id pub-id-type="pmid">19923216</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M109.072645</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shekhar</surname><given-names>M</given-names></name><etal/></person-group><article-title>CryoFold: Determining protein structures and data-guided ensembles from cryo-EM density maps</article-title><source>Matter</source><year>2021</year><volume>4</volume><issue>10</issue><fpage>3195</fpage><lpage>3216</lpage><pub-id pub-id-type="pmcid">PMC9302471</pub-id><pub-id pub-id-type="pmid">35874311</pub-id><pub-id pub-id-type="doi">10.1016/j.matt.2021.09.004</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trabuco</surname><given-names>LG</given-names></name><name><surname>Villa</surname><given-names>E</given-names></name><name><surname>Schreiner</surname><given-names>E</given-names></name><name><surname>Harrison</surname><given-names>CB</given-names></name><name><surname>Schulten</surname><given-names>K</given-names></name></person-group><article-title>Molecular dynamics flexible fitting: A practical guide to combine cryo-electron microscopy and X-ray crystallography</article-title><source>Methods</source><year>2009</year><volume>49</volume><issue>2</issue><fpage>174</fpage><lpage>180</lpage><pub-id pub-id-type="pmcid">PMC2753685</pub-id><pub-id pub-id-type="pmid">19398010</pub-id><pub-id pub-id-type="doi">10.1016/j.ymeth.2009.04.005</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>TY</given-names></name><name><surname>Goyal</surname><given-names>P</given-names></name><name><surname>Girshick</surname><given-names>R</given-names></name><name><surname>He</surname><given-names>K</given-names></name><name><surname>Dollar</surname><given-names>P</given-names></name></person-group><article-title>Focal Loss for Dense Object Detection</article-title><source>IEEE transactions on pattern analysis and machine intelligence</source><year>2020</year><volume>42</volume><issue>2</issue><fpage>318</fpage><lpage>327</lpage></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>T</given-names></name><etal/></person-group><article-title>All-atom RNA structure determination from cryo-EM maps</article-title><source>Nature Biotechnology</source><year>2024</year><pub-id pub-id-type="pmid">38396075</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Terashi</surname><given-names>G</given-names></name><name><surname>Kihara</surname><given-names>D</given-names></name></person-group><article-title>CryoREAD: de novo structure modeling for nucleic acids in cryo-EM maps using deep learning</article-title><source>Nature Methods</source><year>2023</year><volume>20</volume><issue>11</issue><fpage>1739</fpage><lpage>1747</lpage><pub-id pub-id-type="pmcid">PMC10841814</pub-id><pub-id pub-id-type="pmid">37783885</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-02032-5</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title><year>2023</year><volume>379</volume><issue>6637</issue><fpage>1123</fpage><lpage>1130</lpage><pub-id pub-id-type="pmid">36927031</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shazeer</surname><given-names>N</given-names></name></person-group><article-title>GLU Variants Improve Transformer</article-title><source>arXiv e-prints</source><year>2020</year><elocation-id>arXiv:2002.05202</elocation-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Glorot</surname><given-names>X</given-names></name><name><surname>Bordes</surname><given-names>A</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name></person-group><source>Deep Sparse Rectifier Neural Networks</source><person-group person-group-type="editor"><name><surname>Geoffrey</surname><given-names>G</given-names></name><name><surname>David</surname><given-names>D</given-names></name><name><surname>Miroslav</surname><given-names>D</given-names></name></person-group><conf-name>Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics</conf-name><conf-sponsor>PMLR, Proceedings of Machine Learning Research</conf-sponsor><year>2011</year><fpage>315</fpage><lpage>323</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Overall architecture of CryFold.</title><p>Two major steps are employed to build all-atom structure from a cryo-EM density map and the amino acid sequences of the target proteins. In the first step (with purple background), the input density map is fed into a 3D convolution-based network U-Net to predict the Cα atom positions. The map is first cropped continuously into boxes of size 64×64×64, which are then processed by U-Net and combined at the end. The final U-Net output <italic>y</italic><sup><italic>pred</italic></sup> is of the same size to the input map and the value in each voxel is the probability of containing a Cα atom, which is refined by the mean-shift algorithm. In the second step (with green background), all-atom positions are predicted using a local attention network (Cry-Net) from the amino acid sequence and the predicted Cα atom. The initial node and edge representations are first fetched from density map guided by the predicted Cα atom positions. They are then fed into the Cryformer together with the sequence embedding from ESM-2. The updated representations are then decoded into all-atom structure using the Structure Module, followed by a post-processing step. The parameters <italic>r, k</italic> and <italic>c</italic> are the numbers of predicted Cα atoms, neighbors considered and channels, respectively.</p></caption><graphic xlink:href="EMS203662-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Comparison between CryFold and ModelAngelo on the test set of 177 high-resolution maps.</title><p>(A) Head-to-head comparison based on the completeness. (B) Violin plots of the backbone recall and the backbone precision. (C) Backbone RMSD and completeness plotted as a function of the Q-scores of the deposited structures. (D) Head-to-head comparison of the amino acid accuracy. (E) Bar plots comparing the average RMSDs of Cα atoms and backbone atoms. The sizes of the sets of true positive residues (<italic>all, common, exclusive</italic>) are shown in (F). (F) Venn diagram showing the numbers of true positive residues predicted by both methods. (G) Backbone recall and amino acid accuracy for the intermediate models.</p></caption><graphic xlink:href="EMS203662-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>An example of how CryFold has a more complete model compared to the deposited structure.</title><p>(A) The gray surface is the density map EMD-33678 (reported resolution 2.83Å). The green/gray cartoon is the deposited structure (PDB ID: 7Y82); the blue cartoon is the CryFold model, the magenta cartoon is the ModelAngelo model, and the orange cartoon is the AF3 model for the unmodeled regions in the deposited structure. (B) The blue cartoon is the modeling of the absent residues 1041-1380 in the deposited structure by CryFold and the gray surface is the corresponding density map. (C) An enlarged view of the red box in (A).</p></caption><graphic xlink:href="EMS203662-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>Correlation analysis between CryFold confidence score and backbone RMSD.</title><p>(A) Confidence score bin size is 6, and the error bars represent the 99% confidence interval of the mean on a per-residue basis. (B-C) CryFold models colored by confidence score for the maps EMD-28080 (b, PDB ID: 8EFD, reported resolution 3. 8Å) and EMD-33678 (c, PDB ID: 7Y82, reported resolution 2.83 Å).</p></caption><graphic xlink:href="EMS203662-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Comparison of CryFold and ModelAngelo on 104 test maps with resolutions between 4-7 Å.</title><p>(A) Head-to-head comparison of the completeness. (B) Violin plots of backbone recall, backbone precision, and amino acid accuracy. (C) Bar plot of the main-chain atom RMSD.</p></caption><graphic xlink:href="EMS203662-f005"/></fig><fig id="F6" position="float"><label>Fig. 6</label><caption><title>Capabilities of CryFold with four complementary examples.</title><p>(A) Modelling at low-resolution regions showing comparison between the deposited model PDB ID: 9B36 (grey cartoon, left), the CryFold model (blue cartoon, middle), and the ModelAngelo model (purple cartoon, right) with corresponding closeup views. The density map EMD-44129 (reported resolution 4.29 Å) is shown in transparent. (B) Detection of isoforms from a noisy map is shown with a plant Photosystem I, where CryFold modelled two additional proteins (right) compared to the maize complex (left, PDB: 5ZJI). (C) CryFold identified two specific isoforms in the noisy map region with 3.0-4.0 Å resolution (transparent surface) from ten candidates with over 75% sequence identity. (D) The same map region colored by local resolution, showing the ability of CryFold to segment the density, as a major fraction is contributed by various cofactors. (E) Identification of six new proteins (green) in a 22-protein photosystem complex, shown with their corresponding map densities. (F) Two substantially extended proteins identified by CryFold in the same complex (right) compared to the canonical models (left). (G) The CryFold model of the mitochondrial respirasome II2-III<sub>2</sub> -IV2 (<xref ref-type="bibr" rid="R16">16</xref>) (grey) with 52 out of 104 proteins that were not reported in other complexes (red). Six of these proteins are shown with their densities and compared with the ModelAngelo in <xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>. (H) Two distinct conformations (blue and yellow in close-up views) of a single protein (RIP1) in the 104-protein supercomplex modelled by CryFold in two classes.</p></caption><graphic xlink:href="EMS203662-f006"/></fig><fig id="F7" position="float"><label>Fig. 7</label><caption><title>Results of ablation study.</title><p>The experiments for (A-B) are conducted on the non-redundant test set. We mainly studied CryFold Stage 1 under three configurations. (A) is a violin plot regarding backbone recall/precision. (B) is a bar chart for the Cα RMSD. (C) The experiments on 177 high-resolution maps. Left is the all-atom RMSD. Right is the amino acid accuracy. The mean is indicated by the center point. The error bar is calculated based on the 95% percentile interval.</p></caption><graphic xlink:href="EMS203662-f007"/></fig></floats-group></article>