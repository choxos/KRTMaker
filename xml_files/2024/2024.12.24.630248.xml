<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS202376</article-id><article-id pub-id-type="doi">10.1101/2024.12.24.630248</article-id><article-id pub-id-type="archive">PPR959243</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Isopeptor: a tool for detecting intramolecular isopeptide bonds in protein structures</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Costa</surname><given-names>Francesco</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Barringer</surname><given-names>Rob</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Riziotis</surname><given-names>Ioannis</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Andreeva</surname><given-names>Antonina</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Bateman</surname><given-names>Alex</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><aff id="A1"><label>1</label>European Molecular Biology Laboratory, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02catss52</institution-id><institution>European Bioinformatics Institute (EMBL-EBI)</institution></institution-wrap>, <addr-line>Wellcome Genome Campus</addr-line>, Hinxton. <postal-code>CB10 1SD</postal-code>. <country country="GB">UK</country></aff><aff id="A2"><label>2</label>School of Biochemistry, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0524sp257</institution-id><institution>University of Bristol</institution></institution-wrap>, <addr-line>University Walk</addr-line>, <city>Bristol</city>. <postal-code>BS8 1TD</postal-code>. <country country="GB">UK</country></aff></contrib-group><pub-date pub-type="nihms-submitted"><day>17</day><month>01</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>25</day><month>12</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Motivation</title><p id="P1">Intramolecular isopeptide bonds contribute to the structural stability of proteins, and have primarily been identified in domains of bacterial fibrillar adhesins and pili. At present, there is no systematic method available to detect them in newly determined molecular structures. This can result in mis-annotations and incorrect modelling.</p></sec><sec id="S2"><title>Results</title><p id="P2">Here, we present Isopeptor, a computational tool designed to predict the presence of intramolecular isopeptide bonds in experimentally determined structures. Isopeptor utilizes structure-guided template matching via the Jess software, combined with a logistic regression classifier that incorporates Root Mean Square Deviation (RMSD) and relative solvent accessible area (rASA) as key features. The tool demonstrates a recall of 1.0 and a precision of 0.95 when tested on a Protein Data Bank (PDB) subset of domains known to contain intramolecular isopeptide bonds that have been deposited with incorrectly modelled geometries. Isopeptor’s python-based implementation supports integration into bioinformatics workflows, enabling early detection and prediction of isopeptide bonds during protein structure modelling.</p></sec></abstract><kwd-group><kwd>Isopeptide bond</kwd><kwd>Protein stability</kwd><kwd>Template matching</kwd><kwd>PDB</kwd><kwd>Structural Bioinformatics</kwd></kwd-group></article-meta></front><body><sec id="S3" sec-type="intro"><title>Introduction</title><p id="P3">Intramolecular isopeptide bonds typically form between lysine and asparagine/aspartate residues, catalyzed by a nearby aspartate or glutamate (<xref ref-type="bibr" rid="R4">Kang and Baker, 2011</xref>). When found in β-sandwich folds, they occur in CnaA-like domains (linking β-strands of opposing β-sheets) and CnaB-like domains (linking adjacent β-strands of the same β-sheet). These bonds stabilize bacterial surface proteins against various stresses, increasing their thermal, mechanical and proteolytic resistance (<xref ref-type="bibr" rid="R4">Kang &amp; Baker, 2011</xref>). While biologically important, their detection has previously relied on bioinformatic analyses of CnaA-like and CnaB-like families, biophysical investigations and manual structure annotation during the building of models. In cases where researchers have built models without additional biophysical or bioinformatic context, intramolecular isopeptide bonds have not been modelled, leading to inaccurate depositions in the PDB (<xref ref-type="fig" rid="F1">Figure.1</xref>). Isopeptor is a sequence-independent method that combines geometry-based template matching and machine learning to enable the automated identification of isopeptide bonds in large protein structure databases.</p></sec><sec id="S4" sec-type="methods"><title>Methods</title><sec id="S5"><title>Dataset Creation</title><p id="P4">To develop Isopeptor, we compiled a curated training positive dataset consisting of 140 high confidence isopeptide bonds from the PDB through literature search and adopting a geometric template-based scan on the entire PDB (<xref ref-type="bibr" rid="R1">Barker and Thornton, 2003</xref>; <xref ref-type="bibr" rid="R7">Piehl and Burley, 2024</xref>). In some cases, we identified the presence of probable isopeptide bonds that were not correctly modelled in the deposited structure. For structures that were deposited with structure factor files and unmodelled intramolecular isopeptide bonds, structures were readjusted to fit an isopeptide bond to the electron density map using Molrep, Refmac and COOT (<xref ref-type="bibr" rid="R10">Vagin and Teplyakov, 1997</xref>; <xref ref-type="bibr" rid="R6">Murshudov <italic>et al</italic>., 2011</xref>; <xref ref-type="bibr" rid="R2">Emsley and Cowtan, 2004</xref>) within the CCP4i2 software suite (<xref ref-type="bibr" rid="R8">Potterton <italic>et al</italic>., 2018</xref>). Where necessary, we also defined the amino group of the isopeptide bond to belong to the N<sub>Z</sub> of the lysine. We retained models demonstrating high resolution diffraction data (≤ 2.5Å) and excluded mutant structures lacking catalytic residues, or with catalytic residues demonstrating atypical geometries, such as the SpaC isopeptide bond from <italic>Lactobacillus rhamnosus</italic> (PDB ID: 6M48). For test purposes, we retained 19 isopeptide bond structures with incorrectly modelled geometries from high resolution PDB structures (i.e. uncorrected models with resolution ≤2.5 Å).</p><p id="P5">We also created a negative control dataset of 1,606 very high resolution (≤ 1.5Å) proteins of Eukaryotic origin from the PDB. We selected Eukaryote proteins because they do not (to our knowledge) present intramolecular isopeptide bonds, to minimise the risk of false negatives. Structures were chosen from 30% sequence identity PDB clusters (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>) on 04/12/2024 to acquire a diverse range of proteins, excluding structures shorter than 80 amino acids. We split the negative dataset into two sets consisting of 75% of the initial dataset for training purposes and 25% of it to complement the positive test dataset.</p></sec><sec id="S6"><title>Template Matching</title><p id="P6">Jess is a program that enables structure-guided identification of target protein structures using customised templates consisting of three-dimensional atomic coordinates. We tested six template sets for the Lys-Asn-Asp, Lys-Asp-Glu, and Lys-Asn-Glu triads that characterise intramolecular isopeptide bonds (see <xref ref-type="supplementary-material" rid="SD1">Supplementary table.1</xref>).</p><p id="P7">The Jess output provides the Root Mean Square Deviation (RMSD) between templates and matching atoms. We used each set of templates to scan both negative and positive training datasets and considered only template matches with the lowest RMSD for each target group of residues. Additionally, we prohibited matches between templates and targets from the positive dataset sharing sequence identity above 30%. To achieve this, the pairwise sequence identity was obtained by aligning the sequences surrounding each isopeptide bond (20 amino acids upstream and downstream from the first and last residues of the triad forming the intramolecular isopeptide bond) with the <italic>align_optimal</italic> function from the python package Biotite (package version: 1.3.0, python version: 3.12.2) (<xref ref-type="bibr" rid="R5">Kunzmann and Hamacher, 2018</xref>). These settings have been adopted in all subsequent template scans.</p><p id="P8">We compared the performances of each template set by looking at the RMSD histogram overlaps between positive and negative distributions. We manually verified that entries from the negative set with a low RMSD did not contain any isopeptide bond by analysing their electron density maps. We found that templates from set III and set VI (<xref ref-type="supplementary-material" rid="SD1">supplementary table 1</xref>) are the best for discriminating between positives and negatives: with 0 and 2 entries overlapping between positive and negative RMSD distributions, respectively. We decided to adopt set VI templates because they contain less atoms, enabling a quicker computation.</p></sec><sec id="S7"><title>Feature Engineering and Classification</title><p id="P9">Isopeptor employs a logistic regression model to classify template matches. We trained the model on the training dataset using two features: 1. RMSD with the closest template (excluding template-matches with sequence identity above 30%) from set VI and 2. Relative Accessible Solvent Area (rASA) was incorporated into the model to assess how buried the matching residues are within the hydrophobic core, a known requirement for the formation of intramolecular isopeptide bonds (<xref ref-type="bibr" rid="R4">Kang and Baker, 2011</xref>). The rASA calculation was performed with the <italic>sasa</italic> function from the Biotite python package (version 0.39.0) with the <italic>point_number</italic> parameter set to 500. Rost and Sander maximum surface accessible values were used to calculate the rASA (<xref ref-type="bibr" rid="R9">Rost and Sander, 1994</xref>). The logistic regression model was developed using the <italic>LogisticRegression</italic> function from the Scikit-learn python package (version 1.3.0) with default parameters (<ext-link ext-link-type="uri" xlink:href="https://scipy.org/">https://scipy.org/</ext-link>).</p></sec><sec id="S8"><title>Implementation</title><p id="P10">Isopeptor is implemented in python and can be accessed via the command line, through a python API or via a Google Colaboratory implementation (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb">https://colab.research.google.com/github/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb</ext-link>). Source code is hosted on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/isopeptor">https://github.com/FranceCosta/isopeptor</ext-link>) and can be installed via the python package installation manager PIP.</p></sec></sec><sec id="S9" sec-type="results"><title>Results</title><sec id="S10"><title>Validation</title><p id="P11">We used the entire set of intramolecular isopeptide bond-containing structures for the generation of the template dataset and subsequent training of the logistic regression classifier, as the positive dataset was not large enough for a training/test split (comprising only 28 clusters after 30% sequence identity clustering). For this reason, the performance of Isopeptor’s predictive model was evaluated on the test set of structures containing incorrectly modelled intramolecular isopeptide bonds (representing potential use cases where undetected isopeptide bonds are flagged by Isopeptor during protein structure modelling) and Eukaryotic depositions lacking intramolecular isopeptide bonds.</p><p id="P12">Isopeptor was applied to this test set, correctly predicting all 19 isopeptide bonds with a probability above the decision threshold of 0.5, showing a recall of 1.0 and a precision of 0.95, indicating the presence of a low rate of false positives.</p></sec><sec id="S11"><title>Quality assessment metrics</title><p id="P13">We employed two metrics to assess the geometric quality of predicted isopeptide bonds: the bond length Z-score and the Kernel Density Estimations (KDE) likelihood of dihedral angles, calculated with the Scikit learn python package. The bond length Z-score represents the difference, expressed as the number of standard deviations, with the average isopeptide bond length. We define as outliers those values exceeding a Z-score of 4. We determined combinations of allowed dihedral angles by employing 6 different KDE models: one model for each of the three combinations of dihedral angles pairs (pseudo phi-pseudo psi, pseudo omega-pseudo psi, pseudo omega-pseudo phi) and the two isopeptide bond types (CnaA-like and CnaB-like). Given each KDE distribution, values outside the 95th percentile of the angles distribution from our dataset are defined as outliers.</p></sec></sec><sec id="S12" sec-type="discussion"><title>Discussion</title><p id="P14">Isopeptor represents a significant advance in the computational detection and validation of intramolecular isopeptide bonds in protein structures. By combining structure-guided template matching with machine learning classification, our tool achieves high precision and recall on experimentally determined structures with incorrectly modelled or un-modelled intramolecular isopeptide bonds. The integration of geometric quality assessment metrics provides valuable guidance for structure refinement, particularly in challenging cases involving low-resolution data. Its implementation as a python package enables the integration into existing structural biology workflows. We anticipate that Isopeptor will facilitate the identification and correct modeling of these important structural features, ultimately contributing to our understanding of protein stability mechanisms in bacterial surface proteins, and future protein folds that contain intramolecular isopeptide bonds. Future updates to the package will implement direct CIF input file parsing (currently handled by a CIF to PDB conversion step), to enable the parsing of very large protein structures.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary information</label><media xlink:href="EMS202376-supplement-Supplementary_information.pdf" mimetype="application" mime-subtype="pdf" id="d41aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Funding</title><p>This work was supported by the UKRI Biotechnology and Biological Sciences Research Council [BB/X012492/1] and EMBL core funds, and by a UKRI Engineering and Physical Sciences Research Council Impact Accelerator Account (grant number EP/X525674/1).</p></ack><sec id="S14" sec-type="data-availability"><title>Data availability</title><p id="P15">The code to reproduce all data analysis performed in the publication is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/Isopeptor_development/">https://github.com/FranceCosta/Isopeptor_development/</ext-link>. The dataset of intramolecular isopeptide bond-containing structures is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/Isopeptor_development/blob/main/data/tables/20241209_isopeptideBonds.csv">https://github.com/FranceCosta/Isopeptor_development/blob/main/data/tables/20241209_isopeptideBonds.csv</ext-link> while manually remodelled structures are found at: <ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/Isopeptor_development/tree/main/data/PDB_bad_bonds_check_reassigned">https://github.com/FranceCosta/Isopeptor_development/tree/main/data/PDB_bad_bonds_check_reassigned</ext-link>. All other data are available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/14532222">https://zenodo.org/records/14532222</ext-link>.</p><p id="P16">The method can be accessed via google colab: <ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb">https://github.com/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb</ext-link> or run locally following the instructions provided at: <ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/isopeptor">https://github.com/FranceCosta/isopeptor</ext-link>.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P17"><bold>Author contributions</bold></p><p id="P18">Francesco Costa (Conceptualization [equal], Data curation [equal], Formal analysis [equal], Software [lead], Visualization [lead], Writing—original draft [equal]), Rob Barringer (Conceptualization [equal], Data curation [equal], Formal analysis [lead], Writing—review &amp; editing [equal]), Ioannis Riziotis (Methodology [equal], Conceptualization [equal], Writing—review &amp; editing [equal]), Antonina Andreeva (Conceptualization [equal], Data curation [equal], Formal analysis [equal], Writing—original draft [equal]) and Alex Bateman (Conceptualization [equal], Funding acquisition [lead], Project administration [lead], Supervision [equal], Writing—original draft [equal], Writing—review &amp; editing [equal])</p></fn><fn id="FN2"><p id="P19"><bold>Availability and implementation</bold>: Isopeptor is implemented in python and can be accessed via the command line, through a python API or via a Google Colaboratory implementation (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb">https://colab.research.google.com/github/FranceCosta/Isopeptor_development/blob/main/notebooks/Isopeptide_finder.ipynb</ext-link>). Source code is hosted on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/FranceCosta/isopeptor">https://github.com/FranceCosta/isopeptor</ext-link>) and can be installed via the python package installation manager PIP.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barker</surname><given-names>JA</given-names></name><name><surname>Thornton</surname><given-names>JM</given-names></name></person-group><article-title>An algorithm for constraint-based structural template matching: application to 3D templates with statistical analysis</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1644</fpage><lpage>1649</lpage><pub-id pub-id-type="pmid">12967960</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emsley</surname><given-names>P</given-names></name><name><surname>Cowtan</surname><given-names>K</given-names></name></person-group><article-title>Coot: model-building tools for molecular graphics</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>2004</year><volume>60</volume><fpage>2126</fpage><lpage>2132</lpage><pub-id pub-id-type="pmid">15572765</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>HJ</given-names></name><etal/></person-group><article-title>Stabilizing Isopeptide Bonds Revealed in Gram-Positive Bacterial Pilus Structure</article-title><source>Science</source><year>2007</year><volume>318</volume><fpage>1625</fpage><lpage>1628</lpage><pub-id pub-id-type="pmid">18063798</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>HJ</given-names></name><name><surname>Baker</surname><given-names>EN</given-names></name></person-group><article-title>Intramolecular isopeptide bonds: protein crosslinks built for stress?</article-title><source>Trends in Biochemical Sciences</source><year>2011</year><volume>36</volume><fpage>229</fpage><lpage>237</lpage><pub-id pub-id-type="pmid">21055949</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunzmann</surname><given-names>P</given-names></name><name><surname>Hamacher</surname><given-names>K</given-names></name></person-group><article-title>Biotite: a unifying open source computational biology framework in Python</article-title><source>BMC Bioinformatics</source><year>2018</year><volume>19</volume><fpage>346</fpage><pub-id pub-id-type="pmcid">PMC6167853</pub-id><pub-id pub-id-type="pmid">30285630</pub-id><pub-id pub-id-type="doi">10.1186/s12859-018-2367-z</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murshudov</surname><given-names>GN</given-names></name><etal/></person-group><article-title>REFMAC 5 for the refinement of macromolecular crystal structures</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>2011</year><volume>67</volume><fpage>355</fpage><lpage>367</lpage><pub-id pub-id-type="pmcid">PMC3069751</pub-id><pub-id pub-id-type="pmid">21460454</pub-id><pub-id pub-id-type="doi">10.1107/S0907444911001314</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piehl</surname><given-names>DW</given-names></name><name><surname>Burley</surname><given-names>SK</given-names></name></person-group><article-title>Parallel delivery of experimentally determined structures and computed structure models at RCSB protein data bank (RCSB PDB, RCSB.ORG)</article-title><source>Biophysical Journal</source><year>2024</year><volume>123</volume><fpage>280a</fpage></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potterton</surname><given-names>L</given-names></name><etal/></person-group><article-title>CCP 4 i 2: the new graphical user interface to the CCP 4 program suite</article-title><source>Acta Crystallogr D Struct Biol</source><year>2018</year><volume>74</volume><fpage>68</fpage><lpage>84</lpage><pub-id pub-id-type="pmcid">PMC5947771</pub-id><pub-id pub-id-type="pmid">29533233</pub-id><pub-id pub-id-type="doi">10.1107/S2059798317016035</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rost</surname><given-names>B</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name></person-group><article-title>Conservation and prediction of solvent accessibility in protein families</article-title><source>Proteins</source><year>1994</year><volume>20</volume><fpage>216</fpage><lpage>226</lpage><pub-id pub-id-type="pmid">7892171</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vagin</surname><given-names>A</given-names></name><name><surname>Teplyakov</surname><given-names>A</given-names></name></person-group><article-title>MOLREP: an Automated Program for Molecular Replacement</article-title><source>J Appl Crystallogr</source><year>1997</year><volume>30</volume><fpage>1022</fpage><lpage>1025</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure. 1</label><caption><title>PDB depositions of intramolecular isopeptide bond domain structures over the years.</title><p>Isopeptide bonds were not modelled into deposited structures until 2007, after Kang <italic>et al</italic>.’s discovery of intramolecular isopeptide bonds (<xref ref-type="bibr" rid="R3">Kang <italic>et al</italic>., 2007</xref>). A number of intramolecular isopeptide bond domain structures have been deposited without a modelled intramolecular isopeptide bond, or with bond geometries that do not fit the electron density map. A case of an unassigned isopeptide bond in a structure deposited prior to their discovery is shown (a. PDB ID: 1AMX) along with examples of correctly and incorrectly assigned isopeptide bond geometries (b. PDB ID:7K1U and c. PDB ID:2X9Y respectively), with their electron density maps (structural renderings generated with PyMol v3.1.1 <ext-link ext-link-type="uri" xlink:href="https://pymol.org/">https://pymol.org/</ext-link>).</p></caption><graphic xlink:href="EMS202376-f001"/></fig><fig id="F2" position="float"><label>Figure. 2</label><caption><title>Isopeptor workflow.</title><p>1. Jess-based template scan is used to detect potential isopeptide bond signatures in target protein structures. A total of 140 templates coming from high quality structures are used for this purpose (labelled atoms are those included in the templates). Input structures can be in either PDB or CIF format. 2. If a site on the target protein structure matches with multiple templates, only the template-site match with the lowest RMSD is retained. 3. rASA is calculated. 4. Both RMSD with the closest template and rASA are taken as input by the logistic regression model for isopeptide bond classification which outputs a probability. 5. An optional final step is used to evaluate the geometry of isopeptide bonds. Two metrics are used to compare the parameters with the dataset of high quality structures: bond length Z-score and Kernel Density Estimate likelihood of dihedral angles. In the example shown, residues from site “S1” are predicted to form an intramolecular isopeptide bond but their geometry is sub-optimal. The output consists of a list of detected isopeptide bond signatures, each associated with an isopeptide bond probability and attributed to a topology (CnaA-like or CnaB-like) which is assigned depending on the topology of the closest template. The output can be stored in a tab-separated table. The image was generated with Drawio (<ext-link ext-link-type="uri" xlink:href="https://app.diagrams.net/">https://app.diagrams.net/</ext-link>). Structure renderings were generated with PyMol version 3.1.1 (<ext-link ext-link-type="uri" xlink:href="https://www.pymol.org/">https://www.pymol.org/</ext-link>). The structure shown is PDB ID: 2X9Y, positions 447-625.</p></caption><graphic xlink:href="EMS202376-f002"/></fig></floats-group></article>