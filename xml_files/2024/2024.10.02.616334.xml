<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199213</article-id><article-id pub-id-type="doi">10.1101/2024.10.02.616334</article-id><article-id pub-id-type="archive">PPR919531</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Reference-free variant calling with local graph construction with ska lo (SKA)</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Derelle</surname><given-names>Romain</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Madon</surname><given-names>Kieran</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hellewell</surname><given-names>Joel</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Rodríguez-Bouza</surname><given-names>Víctor</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Arinaminpathy</surname><given-names>Nimalan</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Lalvani</surname><given-names>Ajit</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Croucher</surname><given-names>Nicholas J.</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Harris</surname><given-names>Simon R.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Lees</surname><given-names>John A.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Chindelevitch</surname><given-names>Leonid</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>NIHR Health Protection Research Unit in Respiratory Infections, National Heart and Lung Institute, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap>, <city>London</city>, <postal-code>W21PG</postal-code>, <country country="GB">UK</country></aff><aff id="A2"><label>2</label>European Molecular Biology Laboratory, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02catss52</institution-id><institution>European Bioinformatics Institute</institution></institution-wrap>, <addr-line>Wellcome Genome Campus</addr-line>, <city>Hinxton</city>, <country country="GB">UK</country></aff><aff id="A3"><label>3</label>MRC Centre for Global Infectious Disease Analysis, Department of Infectious Disease Epidemiology, School of Public Health, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap>, <city>London</city>, <postal-code>W12 0BZ</postal-code>, <country country="GB">UK</country></aff><aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0456r8d26</institution-id><institution>Bill and Melinda Gates Foundation</institution></institution-wrap>, <addr-line>62 Buckingham Gate</addr-line>, Westminster, <city>London</city>, <postal-code>SW1E 6AJ</postal-code></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding authors: <email>r.derelle@imperial.ac.uk</email>, <email>l.chindelevitch@imperial.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>05</day><month>10</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>10</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The study of genomic variants is increasingly important for public health surveillance of pathogens. Traditional variant calling methods from whole-genome sequencing data rely on reference-based alignment, which can introduce biases and require significant computational resources. Alignment-free and reference-free approaches offer an alternative by leveraging k-mer-based methods, but existing implementations often suffer from sensitivity limitations, particularly in high mutation density genomic regions. Here, we present ska lo, a graph-based algorithm that aims to identify variants between pathogen whole-genome sequencing data by traversing a coloured De Bruijn graph and building variant groups (ie, sets of variant combinations). Through in-silico benchmarking and real-world dataset analyses, we demonstrate that ska lo achieves high sensitivity in SNP calls while also enabling the detection of insertions and deletions, as well as SNP positioning on a reference genome for recombination analyses. These findings highlight ska lo as a simple, fast and effective tool for pathogen genomic epidemiology, extending the range of reference-free variant calling approaches. ska lo is freely available as part of the SKA program (<ext-link ext-link-type="uri" xlink:href="https://github.com/bacpop/ska.rust">https://github.com/bacpop/ska.rust</ext-link>).</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The study of genomic variations plays a central role in public health surveillance, enabling scientists to trace the evolution of pathogens, predict antimicrobial resistance, and monitor the spread of infectious diseases (<xref ref-type="bibr" rid="R23">Simon R. Harris et al. 2010</xref>; <xref ref-type="bibr" rid="R36">Quick et al. 2016</xref>; <xref ref-type="bibr" rid="R1">Armstrong et al. 2019</xref>). These insights are critical for designing effective interventions and controlling outbreaks as demonstrated by the recent COVID-19 pandemic (<xref ref-type="bibr" rid="R10">Cyranoski 2021</xref>; <xref ref-type="bibr" rid="R39">Stockdale et al. 2023</xref>). Traditionally, the detection of genomic variants from whole-genome sequencing (WGS) data relies on aligning sequencing reads to a reference genome. While effective, its accuracy is highly dependent on the choice of the reference genome (<xref ref-type="bibr" rid="R4">Stephen J. Bush et al. 2020</xref>; <xref ref-type="bibr" rid="R43">Valiente-Mullor et al. 2021</xref>; <xref ref-type="bibr" rid="R7">Colquhoun et al. 2021</xref>), and is controlled by a large set of threshold parameters that require technical expertise to be optimised and, in some cases, species-specific customization (<xref ref-type="bibr" rid="R3">S. J. Bush 2021</xref>). Despite the declining costs of WGS, the technical complexity and computational cost of bioinformatic approaches such as read-alignment have limited the expansion of genomic surveillance programs, particularly in resource-limited settings where it is needed most.</p><p id="P3">Alignment-free and reference-free variant-calling approaches emerged over a decade ago as alternatives to traditional reference-based pipelines, offering simple and fast solutions for analysing WGS data but have so far failed to gain significant traction due to their lower sensitivity (but see <xref ref-type="sec" rid="S15">Discussion</xref>). An alignment-free algorithm typically consists of reducing WGS data to k-mers and storing them in data structures that allow direct variant calling. One of these data structures is the split k-mer, whereby k-mers are subdivided into two smaller k-mers surrounding a middle base (<xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>). Single nucleotide polymorphisms (SNPs) are then called by comparing the middle-bases of surrounding k-mers shared by different samples, allowing ultra-fast SNP identification in reference-free mode. This approach has been implemented in the programs kSNP (<xref ref-type="bibr" rid="R21">Hall and Nisbet 2023</xref>; <xref ref-type="bibr" rid="R19">Gardner and Hall 2013</xref>), DiscoSNP (<xref ref-type="bibr" rid="R42">Uricaru et al. 2015</xref>) and SKA (command <styled-content style="color: #38761D">ska align</styled-content>) (Derelie et al. 2024; <xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>). However, its sensitivity depends on the conservation of surrounding k-mers between samples, which can be compromised by the presence of multiple SNPs within k nucleotides in a single sample (multiple nucleotide polymorphism, hereafter abbreviated to MNP) or variants occurring within k nucleotides across samples (hereafter referred to as ‘overlapping variants’). For these reasons, split k-mer analyses are typically limited to closely related genomes (<xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>; <xref ref-type="bibr" rid="R34">Moore et al. 2024</xref>; <xref ref-type="bibr" rid="R13">Derelle et al. 2024</xref>). Alternatively, the sets of split k-mers in each sample can be mapped one by one onto a reference genome to avoid the loss of SNPs associated with overlapping variants (command <styled-content style="color: #38761D">ska map</styled-content>). The second main data structure is the assembly graph, in which overlapping k-mers form a directed graph that is traversed to identify bubbles. Variants, including SNPs and others, are called by comparing the paths within each bubble, as implemented for example in Cortex (<xref ref-type="bibr" rid="R25">Iqbal, Turner, and McVean 2013</xref>), DiscoSNP++ (<xref ref-type="bibr" rid="R35">Peterlongo et al. 2017</xref>), Kmer2SNP (<xref ref-type="bibr" rid="R28">Li, Patel, and Lin 2022</xref>), MALVA (<xref ref-type="bibr" rid="R12">Denti et al. 2019</xref>) and KAGE (<xref ref-type="bibr" rid="R20">Grytten, Dagestad Rand, and Sandve 2022</xref>), all primarily designed for analyses of diploid genomes. While this approach enables the detection of MNPs, it theoretically remains susceptible to sensitivity loss due to overlapping variants, as only samples sharing k-mers with the bubble paths are typed for the corresponding SNPs.</p><p id="P4">Notably, both of these reference-free data structures share a fundamental similarity in the variant calling process: in split k-mer analysis, the two surrounding k-mers serve as local reference points for SNP detection, just as the entry and exit nodes of graph bubbles function as anchors for identifying variants in assembly graphs. Here, we introduce <styled-content style="color: #38761D">ska lo</styled-content>, a new command of the SKA toolkit (<xref ref-type="bibr" rid="R13">Derelle et al. 2024</xref>), that extends the assembly graph a step further by considering all variant paths located between any given set of entry and exit nodes (hereafter referred to as ’variant groups’). In doing so, <styled-content style="color: #38761D">ska lo</styled-content> is able to recover nucleotides in samples that are not part of individual SNP bubbles and is therefore less affected by overlapping variants in highly polymorphic regions. SNPs are also extracted from MNPs but with some limitations. Finally, it can position SNPs on a reference genome to conduct recombination analyses. <styled-content style="color: #38761D">ska lo</styled-content> also identifies insertions and deletions (‘indels’) using graph bubbles as structural markers to detect these variations. (<xref ref-type="bibr" rid="R13">Derelle et al. 2024</xref>). In this study we provide a summary of the algorithm, discuss its limitations, and evaluate its performance using in-silico benchmarks and real-world datasets, including outbreak and within-strain sequencing datasets.</p></sec><sec id="S2" sec-type="materials | methods"><title>Materials and methods</title><sec id="S3"><title>Algorithm description</title><p id="P5"><styled-content style="color: #38761D">ska lo</styled-content> is a multi-core command of the SKA program (SKA v0.4; <ext-link ext-link-type="uri" xlink:href="https://github.com/bacpop/ska.rust">https://github.com/bacpop/ska.rust</ext-link>), whose name stands for ’SKA left over’. As with other SNP-calling SKA commands, it takes as input a multi-sample split k-mer file, which contains all split k-mers of size ‘k’ extracted from assemblies or read data. Its algorithm can be divided into five steps, as summarized in <xref ref-type="fig" rid="F1">Figure 1</xref>:</p><p id="P6">Step 1: <styled-content style="color: #38761D">ska lo</styled-content> converts each split k-mer into two overlapping k-mers of size k-1, considering both forward and reverse-complement sequences. The combination of all overlapping k-mers constitutes a coloured De Bruijn graph in which nodes are k-mers of size k-1 and edges, which connect pairs of consecutive k-mers, are labelled (coloured) by the sample sets in which the two consecutive (k-1)-mers are found. <styled-content style="color: #38761D">ska lo</styled-content> then identifies entry nodes (nodes leading to two or more paths whose edges contain non-identical sample sets) and exit nodes (their reverse-complements) in the graph; the portion of the graph between an entry node and its corresponding exit node is referred to as a bubble. The graph is finally compacted by shortening paths between entry and exit nodes.</p><p id="P7">Step 2: the graph is traversed from each entry node using a recursive function taking as parameter a maximal recursive depth (d=4 by default). A variant group is then identified when at least two paths start from the same entry node and end at the same exit node. These can represent single graph bubbles of SNPs or indels, or correspond to multiple interconnected bubbles being traversed, generating a combination of variants. In high variant density regions, large variant groups would theoretically represent all variant combinations observed in the sample set.</p><p id="P8">Step 3: <styled-content style="color: #38761D">ska lo</styled-content> infers indels from variant groups having two paths and one of these paths corresponding to at most 2(k-1) nucleotides. Since indels are represented in both forward and reverse-complement orientations in the graph, they need to be deduplicated. Additionally, different insert sizes can be inferred for a given indel. Under the assumption that the shortest inserts are correct, these variant groups are sorted by the combined length of their paths and processed in increasing order. An indel is then validated if none of its surrounding k-mers have been found in an already validated indel, it corresponds to a non-ambiguous indel (ie, both variants are uniquely present in at least one sample) and its proportion of missing samples is below a threshold ‘m’ (m=0.1 by default). A variant call format (VCF) file is finally created, containing the different insert variants and their distribution among samples.</p><p id="P9">Step 4: <styled-content style="color: #38761D">ska lo</styled-content> then infers SNPs from each variant group by collecting the nucleotide column following each entry node in the pseudo-alignment of its paths. To ensure that paths are correctly aligned, variant groups are filtered to keep only paths of the most common length, which removes those containing an indel. However, paths of the same length can still be misaligned if one includes both an insertion and a deletion of the same size. To address this, <styled-content style="color: #38761D">ska lo</styled-content> discards paths containing at least ‘n’ indel surrounding k-mers recorded at the previous step (n=2 by default). As with indels, SNPs are represented in forward and reverse-complement in the graph, so need to be deduplicated. A given SNP might also be present in different variant groups, particularly in high-density variant regions, since variant groups are identified from each entry node. Since <styled-content style="color: #38761D">ska lo</styled-content> seeks to recover SNPs with their most complete set of samples, variant groups are sorted by the ratio of the number of paths to their length and processed in decreasing order. A SNP is then validated if it meets the same criteria as for indels: none of its surrounding k-mers have been found in an already validated SNP, it does not solely differ by an ambiguous nucleotide, and its proportion of missing samples is below ‘m’. Finally, <styled-content style="color: #38761D">ska lo</styled-content> outputs a SNP alignment for this sample set.</p><p id="P10">Step 5 (optional): if the user provides a reference genome, <styled-content style="color: #38761D">ska lo</styled-content> maps SNPs onto it, generating both a VCF file and a pseudo-genome alignment. Briefly, <styled-content style="color: #38761D">ska lo</styled-content> attempts to position variant groups on the reference genome and infers SNP locations accordingly (see <xref ref-type="supplementary-material" rid="SD3">Supplementary Methods for details</xref>). Variant groups that cannot be mapped are discarded, and their SNPs are excluded from the SNP alignment, VCF file, and pseudo-genome.</p></sec><sec id="S4"><title>Limitations of the algorithm</title><p id="P11">First, the removal of paths containing an indel can lead to <styled-content style="color: #38761D">ska lo</styled-content> missing SNPs. Any SNP located within k-1 nucleotides of an indel will always be missed since these will necessarily be located on the same path. In addition, the presence of an indel in a variant group will increase the fraction of missing samples of its SNPs since the sample set of the indel path is discarded. The other source of missed SNPs are MNPs. Since SNPs are identified among filtered variant groups through the presence of entry nodes, <styled-content style="color: #38761D">ska lo</styled-content> is only able to identify the first SNP and last SNP (in reverse-complement) of each MNP, meaning that internal SNPs, if any, are missed. There is, however, an exception to this: if an internal SNP is also present in another sample, its position will be ‘revealed’ and the SNP inferred (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 1</xref>).</p><p id="P12">Second, <styled-content style="color: #38761D">ska lo</styled-content> can also produce erroneous calls. Its SNP-calling relies on the assumption that entry nodes among paths of equal length all correspond to SNPs. However, alternative variants can also preserve path lengths, such as micro-inversions or two undetected indels (i.e., within k-1 nucleotides) of equal length and opposite effect (i.e. one insertion and one deletion). Notably, in such cases, <styled-content style="color: #38761D">ska lo</styled-content> generates only two spurious SNPs, following the same logic as for MNPs. Finally, in highly polymorphic regions, complex variant groups might be incompletely identified if the recursive function fails to identify all paths. In such a case, the variant groups composed of these orphan paths can produce independent SNPs if their surrounding k-mers have not yet been visited, thereby creating duplicate SNPs. However, one of the two duplicates will necessarily have a proportion of missing data of at most 0.5, and setting the parameter ‘m’ above this value will discard these spurious SNPs.</p></sec><sec id="S5"><title>In-silico 20-samples benchmark</title><p id="P13">We first simulated an outbreak phylogeny of 20 isolates using Transphylo v1.4.10 (<xref ref-type="bibr" rid="R15">Xavier Didelot et al. 2017</xref>) with <italic>S. pneumoniae</italic> simulation parameters provided in (<xref ref-type="bibr" rid="R13">Derelle et al. 2024</xref>). Branch lengths of the phylogenetic tree were scaled up by different factors to simulate larger divergences using the same topology. Genomic variants were then simulated using phastSim (<xref ref-type="bibr" rid="R11">De Maio et al. 2022</xref>) for each of these modified phylogenies starting from the ATCC 700669 genome (NC_011900.1) at the root. phastSim parameters were set to generate on average one short indel (1-10bp) every 10 SNPs and one long indel (200bp) every 100 SNPs. The numbers of SNPs varied from 265 to 234,585. For each 20-sample dataset (ie, each level of divergence), the expected SNP alignment was reconstructed based on the tabular output of phastSim using a custom Python script. Simulated genomes generated by phastSim were then analysed by variant callers, and their SNP alignments were compared to the corresponding expected SNP alignments to infer true and false positive SNPs using compareALI v0.2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/rderelle/compareALI">https://github.com/rderelle/compareALI</ext-link>). Accession number of the strain SP264 genome was NZ_CP155532.1. OrthoANI values, a variation of the average nucleotide identities (ANI) (<xref ref-type="bibr" rid="R44">Yoon et al. 2017</xref>), were calculated using the online tool <ext-link ext-link-type="uri" xlink:href="https://www.ezbiocloud.net/tools/ani">https://www.ezbiocloud.net/tools/ani</ext-link> The versions of variant callers were: Snippy v4.6.0 (<ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link>), SKA v0.4 (<xref ref-type="bibr" rid="R13">Derelle et al. 2024</xref>), parsnp2 v2.0.6 (<xref ref-type="bibr" rid="R26">Kille et al. 2024</xref>). Unless specified, ska lo was run with a maximum proportion of missing data of 0.1 (m=0.1). The phylogenetic trees, phastSim command-line parameters, phastSim simulated files, expected SNP alignments, and variant caller outputs have been deposited in Zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/14863014">https://zenodo.org/records/14863014</ext-link>).</p></sec><sec id="S6"><title>In-silico Mtb indel benchmark</title><p id="P14">Each pair of genomes was composed of the original root genome and the same genome mutated with 100 insertions of random sequences (random lengths between 1 and 10 nucleotides or fixed lengths for long insertions) at random genomic positions, in 10 replicates. The following constraints were imposed on insertions: (i) to not be located within 100bp from another insertion and (ii), for insertions of more than 1 nucleotide, the nucleotides corresponding to the extremities of the inserted sequences should be different to the nucleotides located on the opposite flanking insertion site. The latter constraint allows a unique alignment of these inserted sequences, which greatly facilitates their identification from read-alignment and ska lo outputs, making precise benchmarking possible. True positive indels were identified using the following two criteria: the insertion should have an exact match to one of the inserted sequences (forward or reverse-complement) and the original genome should display the alternative variant (i.e., no insertion at a position not treated as missing data). The Python scripts used to run this benchmark, along with the original genome assemblies, are available in the Zenodo file mentioned above.</p></sec><sec id="S7"><title>Analyses of the <italic>S. aureus</italic> outbreak dataset</title><p id="P15">Accession numbers of sequencing data were retrieved from <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/SKASaureusSKAalign">https://microreact.org/proiect/SKASaureusSKAalign</ext-link>. The accession number of the reference genome used in these analyses was NZ_CDLR01000001.1 (strain SASCBU26). SNP alignment and polymorphic positions inferred by Snippy were extracted from the ‘clean full’ genome alignment using a custom python script.</p></sec><sec id="S8"><title>Within-strain analyses of <italic>S. pneumoniae</italic> PMEN2</title><p id="P16">Accession numbers of sequencing data and years of collection were retrieved from the <xref ref-type="supplementary-material" rid="SD1">supplementary data files</xref> of (<xref ref-type="bibr" rid="R8">Nicholas J. Croucher et al. 2014</xref>). Accession numbers of the reference genomes were CP002176.1 (strain 670-6B) and NC_011900.1 (strain ATCC 700669). The detection and removal of recombination tracks was performed using Gubbins v3.3.1 (<xref ref-type="bibr" rid="R9">N. J. Croucher et al. 2015</xref>). We used IQ-TREE v2.3.6 (<xref ref-type="bibr" rid="R33">Minh et al. 2020</xref>) for additional phylogenetic inferences. Root-to-tip analyses were performed using BactDating v1.1 with tree rooting using its initRoot function (<xref ref-type="bibr" rid="R14">Xavier Didelot et al. 2018</xref>). The clustering information distances used in the multidimensional scaling analysis were calculated using TreeDist v2.9.1 (<xref ref-type="bibr" rid="R38">Smith 2022</xref>).</p></sec><sec id="S9"><title>Efficiency measurements</title><p id="P17">Runtime and memory consumption measurements were performed on a MacBook Air laptop equipped with a M2 processor and 8 GB of RAM memory.</p></sec></sec><sec id="S10" sec-type="results"><title>Results</title><sec id="S11"><title>Performance of ska lo SNP-calling in simulated benchmarks</title><p id="P18">To assess the performance of <styled-content style="color: #38761D">ska lo</styled-content> SNP calling, we built an in-silico benchmark using the genome of <italic>Streptococcus pneumoniae</italic> ATCC 700669 and a fixed phylogeny to generate sets of 20 genomes with increasing number of simulated variants (SNPs, short and long indels). These sets of genomes were analysed using the genome-aligner parsnp2, the popular read-alignment pipeline Snippy, and the k-mer based methods <styled-content style="color: #38761D">ska align</styled-content>, <styled-content style="color: #38761D">ska map</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content> - all using a split k-mer size of 41. SNP alignments were trimmed to only retain variants not differing solely by an ambiguous nucleotide and positions with a maximum of 10% of missing data, considering ambiguous nucleotides as missing. The precision of variant callers was found to be above 0.99 in all cases except for parsnp2 at low SNP-densities using SP264 genome as reference (all values are provided in <xref ref-type="supplementary-material" rid="SD1">Supplementary data</xref>).</p><p id="P19">When using the simulated genome ‘1’ as a reference for variant calling, parsnp2 showed maximal sensitivity at low SNP densities due to the use of full genome assemblies without rearrangement, but declined significantly at higher SNP densities (<xref ref-type="fig" rid="F2">Figure 2A</xref>). Snippy maintained relatively constant sensitivity (~0.97) across datasets, while <styled-content style="color: #38761D">ska map</styled-content> exhibited slightly lower sensitivity (~0.94 at low SNP densities) due to its use of short k-mers and a sharp drop at medium SNP densities due to its inability to detect MNPs. Using a closely related genome (SP264 strain; OrthoANI of 99.95% with the ATCC 700669 genome) as the reference reduced the sensitivity of all reference-based methods (e.g., ~0.95 for Snippy), highlighting the impact of reference genome selection on reference-based variant calling.</p><p id="P20">Among reference-free methods, <styled-content style="color: #38761D">ska align</styled-content> matched <styled-content style="color: #38761D">ska map</styled-content> sensitivity at low SNP densities but dropped more sharply at medium densities, limited by both MNPs and overlapping variants. In contrast, <styled-content style="color: #38761D">ska lo</styled-content> achieved higher sensitivity (~0.96) at low and medium SNP densities. This advantage stems from <styled-content style="color: #38761D">ska lo</styled-content>’s larger detection range of unique sequences, required for the identification of SNPs, spanning 2k-1 nucleotides compared to the k nucleotides of split k-mers. At this k-mer size, <styled-content style="color: #38761D">ska lo</styled-content> sensitivity matches or exceeds that of Snippy depending on the reference genome. <styled-content style="color: #38761D">ska lo</styled-content> also retained higher sensitivity at higher SNP densities compared to the other SKA commands as it accommodates MNPs and overlapping variants.</p><p id="P21">Investigating the influence of <styled-content style="color: #38761D">ska lo</styled-content> parameters, the maximum recursive depth for the graph traversal has no impact on the detection of SNPs at low and medium SNP-densities but higher values can further enhance <styled-content style="color: #38761D">ska lo</styled-content> performance at high SNP densities (<xref ref-type="fig" rid="F2">Figure 2B</xref>). Despite this, <styled-content style="color: #38761D">ska lo</styled-content> remains unsuitable for the analysis of highly divergent genomes (ie, at the species level), with sensitivity still lower than that of Snippy and high computational costs associated with large graphs and their extensive traversal. The distribution of missing samples per SNP in a high-density dataset illustrates how effectively <styled-content style="color: #38761D">ska lo</styled-content>, run with the default maximum fraction of missing samples (m=0.1) or m=0.5, accommodates MNPs and overlapping variants compared to <styled-content style="color: #38761D">ska align</styled-content> (<xref ref-type="fig" rid="F2">Figure 2C</xref>). However, removing SNP filtering based on missing data (m=1) resulted in a large number of SNPs at high fractions of missing samples, some of which may represent duplicate SNPs (see ‘Limitations’ section). It also significantly lowered the number of SNPs without missing samples, indicating that the sorting of variant groups before SNP calling can be improved.</p><p id="P22">We finally evaluated <styled-content style="color: #38761D">ska lo</styled-content> performance with SNP positioning on a reference genome, in which non-positioned SNPs are discarded. Considering low and medium SNP densities, <styled-content style="color: #38761D">ska lo</styled-content> sensitivity remained mostly unchanged when using the simulated genome ‘1’ as reference but dropped to that of Snippy when using the SP264 genome as reference (<xref ref-type="supplementary-material" rid="SD1">Supplementary data</xref>). Finally, we used the original ATCC 700669 genome as reference to compare genomic positions of SNPs inferred by <styled-content style="color: #38761D">ska lo</styled-content> to the simulated ground truth. The percentage of SNPs correctly positioned gradually decreased with variant density, from 100% to 97.6% (<xref ref-type="supplementary-material" rid="SD2">Supplementary figure S2</xref>). While this level of accuracy seems adequate for analysing SNP distribution across the genome (e.g., detecting recombination events), it might be insufficient for the accurate identification of known SNPs at specific genomic positions.</p></sec><sec id="S12"><title>Performances of ska lo indel-calling in simulated benchmarks</title><p id="P23">Assessing the performance of <styled-content style="color: #38761D">ska lo</styled-content> in indel calling within the previous benchmark is challenging, as indels can be inferred differently depending on the nucleotides surrounding the insert site. Even when considering all indels detected by <styled-content style="color: #38761D">ska lo</styled-content> as true positives, the percentage of inferred indels relative to the total number of simulated indels declined significantly at medium variant densities, with no noticeable impact of the maximum recursive depth threshold (<xref ref-type="fig" rid="F3">Figure 3A</xref>). This decline occurs because, unlike in <styled-content style="color: #38761D">ska lo</styled-content> SNP-calling, indels are excluded from variant groups, and their detection is therefore influenced by overlapping variants.</p><p id="P24">We then fully evaluated the accuracy of <styled-content style="color: #38761D">ska lo</styled-content> indel-calling in a low diversity setting by designing a second benchmark composed of pairs of <italic>Mycobacterium tuberculosis</italic> (Mtb) genomes differing by 100 randomly introduced synthetic insertions in 10 replicates. The insertion sites were selected to ensure that only a single possible indel could be inferred (see <xref ref-type="sec" rid="S2">Methods</xref>), allowing us to identify false negative and false positive indels. These genome pairs were derived from assemblies representing different Mtb lineages, spanning increasing phylogenetic distances from the H37Rv reference genome, ranging from lineage 4.9 (strain H37Rv) to lineage 1, with sequence divergence below 0.001 SNPs per site. We compared <styled-content style="color: #38761D">ska lo</styled-content> indel inference using k-mer sizes of 21, 41 and 61 to that of Snippy.</p><p id="P25"><styled-content style="color: #38761D">ska lo</styled-content> missed on average 3 insertions out of 100 at k=21 and 2 insertions out of 100 at k=41 and k=61, a sensitivity level similar to that observed with Snippy (<xref ref-type="fig" rid="F3">Figure 3B</xref>). Importantly, <styled-content style="color: #38761D">ska lo</styled-content> did not produce any false positive indel in any of these analyses, as opposed to Snippy which generated a number of false positives increasing with the genomic divergence to the reference genome. Accuracy to detect large indels, ranging from 100bp to 5kb, were only assessed for <styled-content style="color: #38761D">ska lo</styled-content> as these variants cannot be identified by standard read-alignment pipelines for which variant detection is limited by the read length (<xref ref-type="bibr" rid="R17">Ezewudo et al. 2018</xref>). <styled-content style="color: #38761D">ska lo</styled-content> was able to detect the longest insertions of 5kb, and displayed similar sensitivities to those observed with short insertions (<xref ref-type="fig" rid="F3">Figure 3C</xref>). Three false positive indels were detected in all these analyses. However, manual inspection revealed that these actually corresponded to simulated insertions with longer than expected insert sizes, indicating that <styled-content style="color: #38761D">ska lo</styled-content> correctly identified the insertion events but failed to identify the shortest possible inserts.</p></sec><sec id="S13"><title>Variant calling in an outbreak setting</title><p id="P26">To evaluate how <styled-content style="color: #38761D">ska lo</styled-content> performs with real-world data, we first reanalysed a dataset of 55 <italic>Staphylococcus aureus</italic> samples from a study investigating an outbreak in a special care baby unit (<xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>; <xref ref-type="bibr" rid="R6">Coll et al. 2017</xref>; <xref ref-type="bibr" rid="R22">Simon R. Harris et al. 2013</xref>). Sequencing reads were analysed using Snippy, <styled-content style="color: #38761D">ska align</styled-content>, <styled-content style="color: #38761D">ska map</styled-content>, and <styled-content style="color: #38761D">ska lo</styled-content>, with k-mer sizes of 21 and 41. The reference genome used for reference-based calls corresponded to one of the 55 samples for which long-read sequencing had been performed. Only variants not differing solely by an ambiguous nucleotide and positions with a maximum of 10% of missing data were considered for the SKA commands. For Snippy, we used SNPs corresponding to the core-genome alignment and filtered indels inferred from each sample.</p><p id="P27">Snippy identified 92 SNPs in this dataset, <styled-content style="color: #38761D">ska align</styled-content> and <styled-content style="color: #38761D">ska map</styled-content> both produced 86 SNPs at both k-mer sizes, and <styled-content style="color: #38761D">ska lo</styled-content> identified 90 SNPs at k=21 and 92 SNPs at k=41 (<xref ref-type="table" rid="T1">Table 1</xref>). Running <styled-content style="color: #38761D">ska lo</styled-content> with SNP positioning on the reference genome produced the same results at both k-mer sizes, indicating that all variants were positioned. The comparison of VCF files produced by Snippy and <styled-content style="color: #38761D">ska lo</styled-content> at k=41 showed that 91 of the 92 SNPs were common to both tools. The single SNP identified only by Snippy was located next to a large unmapped genomic region and susceptible to misalignment errors (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure S3</xref>). The SNP exclusively detected by <styled-content style="color: #38761D">ska lo</styled-content> was shared by three samples forming a monophyletic group (position 1356572; samples “E” from (<xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>; <xref ref-type="bibr" rid="R6">Coll et al. 2017</xref>; <xref ref-type="bibr" rid="R22">Simon R. Harris et al. 2013</xref>)) and was inferred by Snippy but excluded from the core alignment due to the presence of missing data. As noted in (<xref ref-type="bibr" rid="R24">S. R. Harris 2018</xref>; <xref ref-type="bibr" rid="R6">Coll et al. 2017</xref>; <xref ref-type="bibr" rid="R22">Simon R. Harris et al. 2013</xref>), two MNPs were unexpectedly present in this low-diversity dataset—both composed of two SNPs separated by less than 10 nucleotides—accounting for the four-SNP difference between <styled-content style="color: #38761D">ska lo</styled-content> and the two other SKA commands at k=21. Increasing the k-mer size to 41 enabled <styled-content style="color: #38761D">ska lo</styled-content> to resolve more repeats, thanks to its larger detection range compared to split k-mers, and to identify two additional SNPs. Overall, these results align with the findings from the 20-isolate benchmark analyses at low SNP densities. Finally, Snippy inferred 18 indels across all samples, while <styled-content style="color: #38761D">ska lo</styled-content> inferred 13 and 19 indels at k-mer sizes 21 and 41, respectively. The comparison of the genomic sequences surrounding Snippy-identified indels and the sequences of bubble paths present in the <styled-content style="color: #38761D">ska lo</styled-content> indel vcf file at k=41 allowed us to identify 17 commonly inferred indels. Snippy inferred an additional 1bp insertion (position 50 in sample P14/B), while <styled-content style="color: #38761D">ska lo</styled-content> inferred two additional large deletions (55bp and 227bp, shared by samples HD and HT, and sample P25, respectively).</p><p id="P28">The analysis of the 55-samples skf file generated with k=41 took 3 seconds, 5 seconds, and 14 seconds for <styled-content style="color: #38761D">ska align</styled-content>, <styled-content style="color: #38761D">ska map</styled-content>, and <styled-content style="color: #38761D">ska lo</styled-content> respectively, with memory usages of 3.5 GB, 3.5 GB, and 1.7 GB. When using two CPUs, <styled-content style="color: #38761D">ska lo</styled-content> runtime decreased to 11 seconds. Factoring in the time required for skf file creation (8.4 minutes on 1 CPU), the runtime increase for <styled-content style="color: #38761D">ska lo</styled-content> remained relatively modest.</p></sec><sec id="S14"><title>Within-strain phylogenetic analyses</title><p id="P29">Phylogenetic reconstructions at the strain level usually involve the detection and removal of recombination events using a reference genome (<xref ref-type="bibr" rid="R9">N. J. Croucher et al. 2015</xref>; <xref ref-type="bibr" rid="R16">X. Didelot and Wilson 2015</xref>). For this set of analyses, we used 170 <italic>Streptococcus pneumoniae</italic> PMEN2 isolates, many of which represented a nationwide outbreak of multidrug-resistant disease in Iceland (<xref ref-type="bibr" rid="R8">Nicholas J. Croucher et al. 2014</xref>). Sequencing reads were analysed using Snippy, <styled-content style="color: #38761D">ska map</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content>, both using a k-mer size of 21.</p><p id="P30">Using the <italic>S. pneumoniae</italic> 670-6B genome as reference genome, as in (<xref ref-type="bibr" rid="R8">Nicholas J. Croucher et al. 2014</xref>), Snippy and <styled-content style="color: #38761D">ska map</styled-content> identified 23,469 and 11,950 SNPs respectively. <styled-content style="color: #38761D">ska lo</styled-content>, using a maximum fraction of missing data per position of 0.4, identified 17,548 SNPs, of which 1,048 could not be positioned. Despite these differences, the detection of recombination tracts by Gubbins revealed similar patterns (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure S4</xref>), and produced similar numbers of filtered SNPs: 2,320, 2,234 and 2,280 filtered SNPs for Snippy, <styled-content style="color: #38761D">ska map</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content>, respectively. Among these, 1,990 polymorphic positions were shared by all three variant callers (<xref ref-type="supplementary-material" rid="SD2">Supplementary figure S5</xref>). In the absence of an objective ground truth, we relied on the concordance of these filtered SNPs with the assumption of a molecular clock to assess their accuracy. Root-to-tip analyses based on Gubbins final trees and trees produced by IQ-TREE under the GTR model revealed <styled-content style="color: #38761D">ska lo</styled-content> dataset having the strongest temporal signal (R<sup>2</sup> = 0.66 in both cases; <xref ref-type="fig" rid="F4">Figure 4A</xref>), followed by <styled-content style="color: #38761D">ska map</styled-content> (R<sup>2</sup> = 0.61 and 0.62), then Snippy (R<sup>2</sup> = 0.46 and 0.5; <xref ref-type="supplementary-material" rid="SD2">Supplementary figure S6</xref>). However, the estimated date of the most recent common ancestor (MRCA) for this group of isolates was similar across all three analyses. Removing the SNP filtering based on missing data (m=1) increased the number of SNPs identified by <styled-content style="color: #38761D">ska lo</styled-content> (20,093 SNPs of which 2,114 not positioned; 2,550 filtered SNPs after Gubbins analysis), but was associated with a notable weakening of the temporal signal (<xref ref-type="supplementary-material" rid="SD2">Supplementary figure S6</xref>). This result highlights again the presence of spurious SNPs generated by <styled-content style="color: #38761D">ska lo</styled-content> at high fractions of missing samples when analysing high SNP-density regions, and the need to keep the value for this parameter below 0.5.</p><p id="P31">To test the practical limits of the variant callers, we repeated these analyses using a more distant reference genome (<italic>S. pneumoniae</italic> ATCC 700669; OrthoANI of 98.52% with the 670-6B genome). Here, the filtered SNP sets obtained after Gubbins analyses differed significantly among the three variant callers, with Snippy, <styled-content style="color: #38761D">ska map</styled-content>, and <styled-content style="color: #38761D">ska lo</styled-content> yielding 3,291, 2,082, and 2,040 filtered SNPs, respectively, and only 1,537 polymorphic positions in common (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure S7</xref>). The large number of filtered SNPs from Snippy was likely due to misalignment errors caused by the distant reference genome (<xref ref-type="bibr" rid="R18">Falconer et al. 2022</xref>; <xref ref-type="bibr" rid="R45">Yoshimura et al. 2019</xref>), which resulted in phylogenetic inferences that deviated greatly from those obtained using the 670-6B genome (<xref ref-type="fig" rid="F4">Figure 4B</xref>) and weaker temporal signal (R<sup>2</sup> = 0.25 and 0.29; <xref ref-type="supplementary-material" rid="SD2">Supplementary figure S8</xref>). In contrast, alignment-free callers <styled-content style="color: #38761D">ska map</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content> produced phylogenetic trees that were more consistent between the two sets of analyses and retained stronger temporal signals (R<sup>2</sup> = 0.45 and 0.58 for <styled-content style="color: #38761D">ska map</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content> respectively). This observation was particularly evident for inferences based on <styled-content style="color: #38761D">ska lo</styled-content> SNPs, as the topologies from the two analyses were nearly identical. The minimal impact of the reference genome on <styled-content style="color: #38761D">ska lo</styled-content>-based phylogenetic analyses might be attributed to the fact that <styled-content style="color: #38761D">ska lo</styled-content> is also a reference-free caller that only subsequently maps SNPs to the reference genome in bulk, thereby preserving their relative distribution along the genome (average length of mapped variant groups of ~150 bp; <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure S9</xref>).</p><p id="P32">In terms of efficiency, <styled-content style="color: #38761D">ska lo</styled-content> took 34 seconds (27 seconds using 2 CPUs) and used 2.4 GB of memory to infer SNPs and indels from the 170-samples skf file and position SNPs on the 670-6B reference genome. In comparison, <styled-content style="color: #38761D">ska map</styled-content> took 17 seconds and required 7.6 GB of memory.</p></sec></sec><sec id="S15" sec-type="discussion"><title>Discussion</title><p id="P33">In this study, we introduced <styled-content style="color: #38761D">ska lo</styled-content>, a graph-based approach derived from split k-mer files to address some of the limitations of existing reference-free methods in detecting SNPs. <styled-content style="color: #38761D">ska lo</styled-content> proved effective in both benchmark and real-world data analyses, demonstrating its capability as a reference-free variant caller. Our results highlight once again the importance of reference genome choice in alignment-based variant calling. <styled-content style="color: #38761D">ska lo</styled-content> performs similarly to Snippy when the reference genome is closely related to the studied isolates, as seen in the <italic>S. aureus</italic> outbreak analysis. However, when the reference genome is more distantly related to them, as in the within-strain analyses of <italic>S. pneumoniae,</italic> its reference-free mode avoids alignment errors and reference bias. Finally, It is important to note that higher performance metrics do not necessarily translate into better results. In the analysis of the <italic>S. aureus</italic> outbreak, read-alignment and <styled-content style="color: #38761D">ska align</styled-content> SNP inferences led to phylogenies with identical topology (<xref ref-type="bibr" rid="R24">Harris, 2018</xref>), and all root-to-tip analyses based on the <italic>S. pneumoniae</italic> dataset produced similar MCRA dates. It remains to be determined whether the improvement in sensitivity provided by <styled-content style="color: #38761D">ska lo</styled-content> can lead to better biological or epidemiological insights, with existing SKA commands already performing well as demonstrated by recent studies (<xref ref-type="bibr" rid="R31">Mäklin et al. 2022</xref>; <xref ref-type="bibr" rid="R5">Chew et al. 2023</xref>; <xref ref-type="bibr" rid="R30">Maechler et al. 2023</xref>).</p><p id="P34">We identified three practical limitations of <styled-content style="color: #38761D">ska lo</styled-content>. First and foremost, its usage should be limited to within-strain analyses and lower diversity datasets. At higher divergences, <styled-content style="color: #38761D">ska lo</styled-content> simplistic logic struggles with high variant densities, resulting in relatively low sensitivity. Notably, our benchmark was particularly unrealistic at high SNP densities, as it only accounted for SNPs and indels as sources of genomic variation. If gene duplications, lateral gene transfers, and recombination events were included (ref dynamic genome bacteria), its sensitivity drop might be even more pronounced. For these reasons, we recommend partitioning WGS datasets into low-genomic-diversity groups, such as lineages, strains of serotypes, using MLST schemes (<xref ref-type="bibr" rid="R41">Uelze et al. 2020</xref>) or PopPunk (<xref ref-type="bibr" rid="R27">Lees et al. 2019</xref>). Please note that a pipeline integrating SKA and PopPunk has recently been proposed to facilitate these steps (<xref ref-type="bibr" rid="R32">McHugh et al. 2024</xref>). Second, <styled-content style="color: #38761D">ska lo</styled-content> produces spurious SNPs at high fractions of missing samples when highly polymorphic regions are analysed. While this artifact can be mitigated by setting the maximum fraction of missing data parameter below 0.5, it also limits confident inference to SNPs in the core genome. Finally, the accuracy of <styled-content style="color: #38761D">ska lo</styled-content> SNP positioning on a reference genome decreases with variant density. Without further validation, we recommend against using <styled-content style="color: #38761D">ska lo</styled-content> SNP genomic positions to test for the presence or absence of specific variants (e.g., SNPs causing antibiotic resistance in Mycobacterium tuberculosis (<xref ref-type="bibr" rid="R40">The, CRyPTIC Consortium 2022</xref>)).</p><p id="P35">In line with the SKA toolkit, <styled-content style="color: #38761D">ska lo</styled-content> offers a fast and simple-to-use solution for reference-free variant calling. The main parameter controlling its behaviour, the maximum recursive depth for graph traversal, has been set sufficiently high to handle any WGS dataset for which the tool was designed out of the box. Its development reflects an ongoing wave of simple, fast, and accurate k-mer-based programs designed to facilitate and democratize bioinformatics analyses (<xref ref-type="bibr" rid="R2">Bray et al. 2016</xref>; <xref ref-type="bibr" rid="R29">Lu et al. 2022</xref>; <xref ref-type="bibr" rid="R27">Lees et al. 2019</xref>).</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary data</label><media xlink:href="EMS199213-supplement-Supplementary_data.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d2aAcEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary figures</label><media xlink:href="EMS199213-supplement-Supplementary_figures.docx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.wordprocessingml.document" id="d2aAcEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary methods</label><media xlink:href="EMS199213-supplement-Supplementary_methods.docx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.wordprocessingml.document" id="d2aAcEdB" position="anchor"/></supplementary-material></sec></body><back><ack id="S16"><title>Acknowledgements</title><p>RD, KM and AL were supported by the NIHR Health Protection Research Unit in Respiratory Infections, in partnership with the UK Health Security Agency [NIHR200927]. JAL, JH and VRB were supported by the European Molecular Biology Laboratory. NC. and LC acknowledge funding from the MRC Centre for Global Infectious Disease Analysis (reference MR/R015600/1), jointly funded by the UK Medical Research Council (MRC) and the UK Foreign, Commonwealth &amp; Development Office (FCDO), under the MRC/FCDO Concordat agreement and are also part of the EDCTP2 programme supported by the European Union.</p></ack><fn-group><fn id="FN1" fn-type="conflict"><p id="P36"><bold>Conflict of Interest</bold></p><p id="P37">The authors declare that there are no conflicts of interest.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armstrong</surname><given-names>GL</given-names></name><name><surname>MacCannell</surname><given-names>DR</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Carleton</surname><given-names>HA</given-names></name><name><surname>Neuhaus</surname><given-names>EB</given-names></name><name><surname>Bradbury</surname><given-names>RS</given-names></name><name><surname>Posey</surname><given-names>JE</given-names></name><name><surname>Gwinn</surname><given-names>M</given-names></name></person-group><article-title>Pathogen Genomics in Public Health</article-title><source>The New England Journal of Medicine</source><year>2019</year><volume>381</volume><issue>26</issue><fpage>2569</fpage><lpage>80</lpage><pub-id pub-id-type="pmcid">PMC7008580</pub-id><pub-id pub-id-type="pmid">31881145</pub-id><pub-id pub-id-type="doi">10.1056/NEJMsr1813907</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>Near-Optimal Probabilistic RNA-Seq Quantification</article-title><source>Nature Biotechnology</source><year>2016</year><volume>34</volume><issue>5</issue><fpage>525</fpage><lpage>27</lpage><pub-id pub-id-type="pmid">27043002</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>SJ</given-names></name></person-group><article-title>Generalizable Characteristics of False-Positive Bacterial Variant Calls</article-title><source>Microbial Genomics</source><year>2021</year><volume>7</volume><issue>8</issue><pub-id pub-id-type="pmcid">PMC8549357</pub-id><pub-id pub-id-type="pmid">34346861</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000615</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>Stephen J</given-names></name><name><surname>Foster</surname><given-names>Dona</given-names></name><name><surname>Eyre</surname><given-names>David W</given-names></name><name><surname>Clark</surname><given-names>Emily L</given-names></name><name><surname>De Maio</surname><given-names>Nicola</given-names></name><name><surname>Shaw</surname><given-names>Liam P</given-names></name><name><surname>Stoesser</surname><given-names>Nicole</given-names></name><name><surname>Peto</surname><given-names>Tim EA</given-names></name><name><surname>Crook</surname><given-names>Derrick W</given-names></name><name><surname>Sarah Walker</surname><given-names>A</given-names></name></person-group><article-title>Genomic Diversity Affects the Accuracy of Bacterial Single-Nucleotide Polymorphism-calling Pipelines</article-title><source>GigaScience</source><year>2020</year><volume>9</volume><issue>2</issue><elocation-id>giaa007</elocation-id><pub-id pub-id-type="pmcid">PMC7002876</pub-id><pub-id pub-id-type="pmid">32025702</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giaa007</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chew</surname><given-names>Ka Up</given-names></name><name><surname>Achik</surname><given-names>Rosemini</given-names></name><name><surname>Osman</surname><given-names>Nurul Hudaa</given-names></name><name><surname>Octavia</surname><given-names>Sophie</given-names></name><name><surname>Teo</surname><given-names>Jeanette WP</given-names></name></person-group><article-title>Genomic Epidemiology of Human Candidaemia Isolates in a Tertiary Hospital</article-title><source>Microbial Genomics</source><year>2023</year><volume>9</volume><issue>7</issue><pub-id pub-id-type="pmcid">PMC10438824</pub-id><pub-id pub-id-type="pmid">37440287</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.001047</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coll</surname><given-names>Francese</given-names></name><name><surname>Harrison</surname><given-names>Ewan M</given-names></name><name><surname>Toleman</surname><given-names>Michelle S</given-names></name><name><surname>Reuter</surname><given-names>Sandra</given-names></name><name><surname>Raven</surname><given-names>Kathy E</given-names></name><name><surname>Blane</surname><given-names>Beth</given-names></name><name><surname>Palmer</surname><given-names>Beverley</given-names></name><etal/></person-group><article-title>Longitudinal Genomic Surveillance of MRSA in the UK Reveals Transmission Patterns in Hospitals and the Community</article-title><source>Science Translational Medicine</source><year>2017</year><volume>9</volume><issue>413</issue><elocation-id>eaak9745</elocation-id><pub-id pub-id-type="pmcid">PMC5683347</pub-id><pub-id pub-id-type="pmid">29070701</pub-id><pub-id pub-id-type="doi">10.1126/scitranslmed.aak9745</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colquhoun</surname><given-names>Rachel M</given-names></name><name><surname>Hall</surname><given-names>Michael B</given-names></name><name><surname>Lima</surname><given-names>Leandro</given-names></name><name><surname>Roberts</surname><given-names>Leah W</given-names></name><name><surname>Malone</surname><given-names>Kerri M</given-names></name><name><surname>Hunt</surname><given-names>Martin</given-names></name><name><surname>Letcher</surname><given-names>Brice</given-names></name><etal/></person-group><article-title>Pandora: Nucleotide-Resolution Bacterial Pan-Genomics with Reference Graphs</article-title><source>Genome Biology</source><year>2021</year><volume>22</volume><issue>1</issue><fpage>267</fpage><pub-id pub-id-type="pmcid">PMC8442373</pub-id><pub-id pub-id-type="pmid">34521456</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02473-1</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croucher</surname><given-names>Nicholas J</given-names></name><name><surname>Hanage</surname><given-names>William P</given-names></name><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>McGee</surname><given-names>Lesley</given-names></name><name><surname>van der Linden</surname><given-names>Mark</given-names></name><name><surname>de Lencastre</surname><given-names>Herminia</given-names></name><name><surname>Sá-Leão</surname><given-names>Raquel</given-names></name><etal/></person-group><article-title>Variable Recombination Dynamics during the Emergence, Transmission and ‘Disarming’ of a Multidrug-Resistant Pneumococcal Clone</article-title><source>BMC Biology</source><year>2014</year><volume>12</volume><issue>1</issue><fpage>49</fpage><pub-id pub-id-type="pmcid">PMC4094930</pub-id><pub-id pub-id-type="pmid">24957517</pub-id><pub-id pub-id-type="doi">10.1186/1741-7007-12-49</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croucher</surname><given-names>NJ</given-names></name><name><surname>Page</surname><given-names>AJ</given-names></name><name><surname>Connor</surname><given-names>TR</given-names></name><name><surname>Delaney</surname><given-names>AJ</given-names></name><name><surname>Keane</surname><given-names>JA</given-names></name><name><surname>Bentley</surname><given-names>SD</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name><name><surname>Harris</surname><given-names>SR</given-names></name></person-group><article-title>Rapid Phylogenetic Analysis of Large Samples of Recombinant Bacterial Whole Genome Sequences Using Gubbins</article-title><source>Nucleic Acids Research</source><year>2015</year><volume>43</volume><issue>3</issue><fpage>e15</fpage><pub-id pub-id-type="pmcid">PMC4330336</pub-id><pub-id pub-id-type="pmid">25414349</pub-id><pub-id pub-id-type="doi">10.1093/nar/gku1196</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cyranoski</surname><given-names>David</given-names></name></person-group><article-title>Alarming COVID Variants Show Vital Role of Genomic Surveillance</article-title><source>Nature</source><year>2021</year><volume>589</volume><issue>7842</issue><fpage>337</fpage><lpage>38</lpage><pub-id pub-id-type="pmid">33452508</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>Nicola</given-names></name><name><surname>Boulton</surname><given-names>William</given-names></name><name><surname>Weilguny</surname><given-names>Lukas</given-names></name><name><surname>Walker</surname><given-names>Conor R</given-names></name><name><surname>Turakhia</surname><given-names>Yatish</given-names></name><name><surname>Corbett-Detig</surname><given-names>Russell</given-names></name><name><surname>Goldman</surname><given-names>Nick</given-names></name></person-group><article-title>phastSim: Efficient Simulation of Sequence Evolution for Pandemic-Scale Datasets</article-title><source>PLoS Computational Biology</source><year>2022</year><volume>18</volume><issue>4</issue><elocation-id>e1010056</elocation-id><pub-id pub-id-type="pmcid">PMC9094560</pub-id><pub-id pub-id-type="pmid">35486906</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1010056</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denti</surname><given-names>Luca</given-names></name><name><surname>Previtali</surname><given-names>Marco</given-names></name><name><surname>Bernardini</surname><given-names>Giulia</given-names></name><name><surname>Schönhuth</surname><given-names>Alexander</given-names></name><name><surname>Bonizzoni</surname><given-names>Paola</given-names></name></person-group><article-title>MALVA: Genotyping by Mapping-Free ALlele Detection of Known VAriants</article-title><source>iScience</source><year>2019</year><month>August</month><volume>18</volume><fpage>20</fpage><lpage>27</lpage><pub-id pub-id-type="pmcid">PMC6664100</pub-id><pub-id pub-id-type="pmid">31352182</pub-id><pub-id pub-id-type="doi">10.1016/j.isci.2019.07.011</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derelle</surname><given-names>Romain</given-names></name><name><surname>von Wachsmann</surname><given-names>Johanna</given-names></name><name><surname>Mäklin</surname><given-names>Tommi</given-names></name><name><surname>Hellewell</surname><given-names>Joel</given-names></name><name><surname>Russell</surname><given-names>Timothy</given-names></name><name><surname>Laivani</surname><given-names>Ajit</given-names></name><name><surname>Chindelevitch</surname><given-names>Leonid</given-names></name><name><surname>Croucher</surname><given-names>Nicholas J</given-names></name><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>Lees</surname><given-names>John A</given-names></name></person-group><article-title>Seamless, Rapid, and Accurate Analyses of Outbreak Genomic Data Using Split K-Mer Analysis</article-title><source>Genome Research</source><year>2024</year><volume>34</volume><issue>10</issue><fpage>1661</fpage><lpage>73</lpage><pub-id pub-id-type="pmcid">PMC11529842</pub-id><pub-id pub-id-type="pmid">39406504</pub-id><pub-id pub-id-type="doi">10.1101/gr.279449.124</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname><given-names>Xavier</given-names></name><name><surname>Croucher</surname><given-names>Nicholas J</given-names></name><name><surname>Bentley</surname><given-names>Stephen D</given-names></name><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>Wilson</surname><given-names>Daniel J</given-names></name></person-group><article-title>Bayesian Inference of Ancestral Dates on Bacterial Phylogenetic Trees</article-title><source>bioRxiv</source><year>2018</year><comment>bioRxiv</comment><pub-id pub-id-type="pmcid">PMC6294524</pub-id><pub-id pub-id-type="pmid">30184106</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky783</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname><given-names>Xavier</given-names></name><name><surname>Fraser</surname><given-names>Christophe</given-names></name><name><surname>Gardy</surname><given-names>Jennifer</given-names></name><name><surname>Colijn</surname><given-names>Caroline</given-names></name></person-group><article-title>Genomic Infectious Disease Epidemiology in Partially Sampled and Ongoing Outbreaks</article-title><source>Molecular Biology and Evolution</source><year>2017</year><volume>34</volume><issue>4</issue><fpage>997</fpage><lpage>1007</lpage><pub-id pub-id-type="pmcid">PMC5850352</pub-id><pub-id pub-id-type="pmid">28100788</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msw275</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didelot</surname><given-names>X</given-names></name><name><surname>Wilson</surname><given-names>DJ</given-names></name></person-group><article-title>ClonalFrameML: Efficient Inference of Recombination in Whole Bacterial Genomes</article-title><source>PLoS Computational Biology</source><year>2015</year><volume>11</volume><issue>2</issue><elocation-id>e1004041</elocation-id><pub-id pub-id-type="pmcid">PMC4326465</pub-id><pub-id pub-id-type="pmid">25675341</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004041</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ezewudo</surname><given-names>Matthew</given-names></name><name><surname>Borens</surname><given-names>Amanda</given-names></name><name><surname>Chiner-Oms</surname><given-names>Álvaro</given-names></name><name><surname>Miotto</surname><given-names>Paolo</given-names></name><name><surname>Chindelevitch</surname><given-names>Leonid</given-names></name><name><surname>Starks</surname><given-names>Angela M</given-names></name><name><surname>Hanna</surname><given-names>Debra</given-names></name><etal/></person-group><article-title>Integrating Standardized Whole Genome Sequence Analysis with a Global Mycobacterium Tuberculosis Antibiotic Resistance Knowledgebase</article-title><source>Scientific Reports</source><year>2018</year><volume>8</volume><issue>1</issue><elocation-id>15382</elocation-id><pub-id pub-id-type="pmcid">PMC6194142</pub-id><pub-id pub-id-type="pmid">30337678</pub-id><pub-id pub-id-type="doi">10.1038/s41598-018-33731-1</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falconer</surname><given-names>Caitlin</given-names></name><name><surname>Cuddihy</surname><given-names>Thom</given-names></name><name><surname>Beatson</surname><given-names>Scott A</given-names></name><name><surname>Paterson</surname><given-names>David L</given-names></name><name><surname>Harris</surname><given-names>Patrick NA</given-names></name><name><surname>Forde</surname><given-names>Brian M</given-names></name></person-group><article-title>Systematic Benchmarking of ‘all-in-One’ Microbial SNP Calling Pipelines</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="doi">10.1101/2022.05.05.487569</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>Shea N</given-names></name><name><surname>Hall</surname><given-names>Barry G</given-names></name></person-group><article-title>When Whole-Genome Alignments Just Won’t Work: kSNP v2 Software for Alignment-Free SNP Discovery and Phylogenetics of Hundreds of Microbial Genomes</article-title><source>PloS One</source><year>2013</year><volume>8</volume><issue>12</issue><elocation-id>e81760</elocation-id><pub-id pub-id-type="pmcid">PMC3857212</pub-id><pub-id pub-id-type="pmid">24349125</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0081760</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grytten</surname><given-names>Ivar</given-names></name><name><surname>Rand</surname><given-names>Knut Dagestad</given-names></name><name><surname>Sandve</surname><given-names>Geir Kjetil</given-names></name></person-group><article-title>KAGE: Fast Alignment-Free Graph-Based Genotyping of SNPs and Short Indels</article-title><source>Genome Biology</source><year>2022</year><volume>23</volume><issue>1</issue><fpage>209</fpage><pub-id pub-id-type="pmcid">PMC9531401</pub-id><pub-id pub-id-type="pmid">36195962</pub-id><pub-id pub-id-type="doi">10.1186/s13059-022-02771-2</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>Barry G</given-names></name><name><surname>Nisbet</surname><given-names>Jeremiah</given-names></name></person-group><article-title>Building Phylogenetic Trees From Genome Sequences With kSNP4</article-title><source>Molecular Biology and Evolution</source><year>2023</year><volume>40</volume><issue>11</issue><pub-id pub-id-type="pmcid">PMC10640685</pub-id><pub-id pub-id-type="pmid">37948764</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msad235</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>Cartwright</surname><given-names>Edward JP</given-names></name><name><surname>Estée Török</surname><given-names>M</given-names></name><name><surname>Holden</surname><given-names>Matthew TG</given-names></name><name><surname>Brown</surname><given-names>Nicholas M</given-names></name><name><surname>Ogilvy-Stuart</surname><given-names>Amanda L</given-names></name><name><surname>Ellington</surname><given-names>Matthew J</given-names></name><etal/></person-group><article-title>Whole-Genome Sequencing for Analysis of an Outbreak of Meticillin-Resistant Staphylococcus Aureus: A Descriptive Study</article-title><source>The Lancet Infectious Diseases</source><year>2013</year><volume>13</volume><issue>2</issue><fpage>130</fpage><lpage>36</lpage><pub-id pub-id-type="pmcid">PMC3556525</pub-id><pub-id pub-id-type="pmid">23158674</pub-id><pub-id pub-id-type="doi">10.1016/S1473-3099(12)70268-2</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>Feil</surname><given-names>Edward J</given-names></name><name><surname>Holden</surname><given-names>Matthew TG</given-names></name><name><surname>Quail</surname><given-names>Michael A</given-names></name><name><surname>Nickerson</surname><given-names>Emma K</given-names></name><name><surname>Chantratita</surname><given-names>Narisara</given-names></name><name><surname>Gardete</surname><given-names>Susana</given-names></name><etal/></person-group><article-title>Evolution of MRSA during Hospital Transmission and Intercontinental Spread</article-title><source>Science</source><year>2010</year><volume>327</volume><issue>5964</issue><fpage>469</fpage><lpage>74</lpage><pub-id pub-id-type="pmcid">PMC2821690</pub-id><pub-id pub-id-type="pmid">20093474</pub-id><pub-id pub-id-type="doi">10.1126/science.1182395</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>SR</given-names></name></person-group><article-title>SKA: Split Kmer Analysis Toolkit for Bacterial Genomic Epidemiology</article-title><source>bioRxiv</source><year>2018</year><pub-id pub-id-type="doi">10.1101/453142</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iqbal</surname><given-names>Zamin</given-names></name><name><surname>Turner</surname><given-names>Isaac</given-names></name><name><surname>McVean</surname><given-names>Gil</given-names></name></person-group><article-title>High-Throughput Microbial Population Genomics Using the Cortex Variation Assembler</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>2</issue><fpage>275</fpage><lpage>76</lpage><pub-id pub-id-type="pmcid">PMC3546798</pub-id><pub-id pub-id-type="pmid">23172865</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts673</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kille</surname><given-names>Bryce</given-names></name><name><surname>Nute</surname><given-names>Michael G</given-names></name><name><surname>Huang</surname><given-names>Victor</given-names></name><name><surname>Kim</surname><given-names>Eddie</given-names></name><name><surname>Phillippy</surname><given-names>Adam M</given-names></name><name><surname>Treangen</surname><given-names>Todd J</given-names></name></person-group><article-title>Parsnp 2.0: Scalable Core-Genome Alignment for Massive Microbial Datasets</article-title><source>Bioinformatics (Oxford, England)</source><year>2024</year><volume>40</volume><issue>5</issue><pub-id pub-id-type="pmcid">PMC11128092</pub-id><pub-id pub-id-type="pmid">38724243</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btae311</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lees</surname><given-names>John A</given-names></name><name><surname>Harris</surname><given-names>Simon R</given-names></name><name><surname>Tonkin-Hill</surname><given-names>Gerry</given-names></name><name><surname>Gladstone</surname><given-names>Rebecca A</given-names></name><name><surname>Lo</surname><given-names>Stephanie W</given-names></name><name><surname>Weiser</surname><given-names>Jeffrey N</given-names></name><name><surname>Corander</surname><given-names>Jukka</given-names></name><name><surname>Bentley</surname><given-names>Stephen D</given-names></name><name><surname>Croucher</surname><given-names>Nicholas J</given-names></name></person-group><article-title>Fast and Flexible Bacterial Genomic Epidemiology with PopPUNK</article-title><source>Genome Research</source><year>2019</year><volume>29</volume><issue>2</issue><fpage>304</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC6360808</pub-id><pub-id pub-id-type="pmid">30679308</pub-id><pub-id pub-id-type="doi">10.1101/gr.241455.118</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Yanbo</given-names></name><name><surname>Patel</surname><given-names>Hardip</given-names></name><name><surname>Lin</surname><given-names>Yu</given-names></name></person-group><article-title>Kmer2SNP: Reference-Free Heterozygous SNP Calling Using K-Mer Frequency Distributions</article-title><source>Methods in Molecular Biology (Clifton, NJ)</source><year>2022</year><volume>2493</volume><fpage>257</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">35751820</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Rincon</surname><given-names>N</given-names></name><name><surname>Wood</surname><given-names>DE</given-names></name><name><surname>Breitwieser</surname><given-names>FP</given-names></name><name><surname>Pockrandt</surname><given-names>C</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name></person-group><article-title>Metagenome Analysis Using the Kraken Software Suite</article-title><source>Nature Protocols</source><year>2022</year><volume>17</volume><issue>12</issue><fpage>2815</fpage><lpage>39</lpage><pub-id pub-id-type="pmcid">PMC9725748</pub-id><pub-id pub-id-type="pmid">36171387</pub-id><pub-id pub-id-type="doi">10.1038/s41596-022-00738-y</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maechler</surname><given-names>Friederike</given-names></name><name><surname>Weber</surname><given-names>Anna</given-names></name><name><surname>Schwengers</surname><given-names>Oliver</given-names></name><name><surname>Schwab</surname><given-names>Frank</given-names></name><name><surname>Denkel</surname><given-names>Luisa</given-names></name><name><surname>Behnke</surname><given-names>Michael</given-names></name><name><surname>Gastmeier</surname><given-names>Petra</given-names></name><name><surname>Kola</surname><given-names>Axel</given-names></name></person-group><article-title>Split K-Mer Analysis Compared to cgMLST and SNP-Based Core Genome Analysis for Detecting Transmission of Vancomycin-Resistant Enterococci: Results from Routine Outbreak Analyses across Different Hospitals and Hospitals Networks in Berlin, Germany</article-title><source>Microbial Genomics</source><year>2023</year><volume>9</volume><issue>1</issue><pub-id pub-id-type="pmcid">PMC9973845</pub-id><pub-id pub-id-type="pmid">36748706</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000937</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mäklin</surname><given-names>Tommi</given-names></name><name><surname>Thorpe</surname><given-names>Harry A</given-names></name><name><surname>Pöntinen</surname><given-names>Anna K</given-names></name><name><surname>Gladstone</surname><given-names>Rebecca A</given-names></name><name><surname>Shao</surname><given-names>Yan</given-names></name><name><surname>Pesonen</surname><given-names>Maiju</given-names></name><name><surname>McNally</surname><given-names>Alan</given-names></name><etal/></person-group><article-title>Strong Pathogen Competition in Neonatal Gut Colonisation</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="pmcid">PMC9715557</pub-id><pub-id pub-id-type="pmid">36456554</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-35178-5</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McHugh</surname><given-names>Martin P</given-names></name><name><surname>Horsfield</surname><given-names>Samuel T</given-names></name><name><surname>von Wachsmann</surname><given-names>Johanna</given-names></name><name><surname>Toussaint</surname><given-names>Jacqueline</given-names></name><name><surname>Pettigrew</surname><given-names>Kerry A</given-names></name><name><surname>Czarniak</surname><given-names>Elzbieta</given-names></name><name><surname>Evans</surname><given-names>Thomas J</given-names></name><etal/></person-group><article-title>Integrated Population Clustering and Genomic Epidemiology with PopPIPE</article-title><source>bioRxiv</source><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.12.05.626978</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>Bui Quang</given-names></name><name><surname>Schmidt</surname><given-names>Heiko A</given-names></name><name><surname>Chernomor</surname><given-names>Olga</given-names></name><name><surname>Schrempf</surname><given-names>Dominik</given-names></name><name><surname>Woodhams</surname><given-names>Michael D</given-names></name><name><surname>von Haeseler</surname><given-names>Arndt</given-names></name><name><surname>Lanfear</surname><given-names>Robert</given-names></name></person-group><article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title><source>Molecular Biology and Evolution</source><year>2020</year><volume>37</volume><issue>5</issue><fpage>1530</fpage><lpage>34</lpage><pub-id pub-id-type="pmcid">PMC7182206</pub-id><pub-id pub-id-type="pmid">32011700</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>Matthew P</given-names></name><name><surname>Laager</surname><given-names>Mirjam</given-names></name><name><surname>Ribeca</surname><given-names>Paolo</given-names></name><name><surname>Didelot</surname><given-names>Xavier</given-names></name></person-group><article-title>KmerAperture: Retaining K-Mer Synteny for Alignment-Free Extraction of Core and Accessory Differences between Bacterial Genomes</article-title><source>PLoS Genetics</source><year>2024</year><volume>20</volume><issue>4</issue><elocation-id>e1011184</elocation-id><pub-id pub-id-type="pmcid">PMC11101094</pub-id><pub-id pub-id-type="pmid">38683871</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1011184</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peterlongo</surname><given-names>Pierre</given-names></name><name><surname>Riou</surname><given-names>Chloé</given-names></name><name><surname>Drezen</surname><given-names>Erwan</given-names></name><name><surname>Lemaitre</surname><given-names>Claire</given-names></name></person-group><article-title>DiscoSnp++: De Novo Detection of Small Variants from Raw Unassembled Read Set(s)</article-title><source>bioRxiv</source><year>2017</year><pub-id pub-id-type="doi">10.1101/209965</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quick</surname><given-names>Joshua</given-names></name><name><surname>Loman</surname><given-names>Nicholas J</given-names></name><name><surname>Duraffour</surname><given-names>Sophie</given-names></name><name><surname>Simpson</surname><given-names>Jared T</given-names></name><name><surname>Severi</surname><given-names>Ettore</given-names></name><name><surname>Cowley</surname><given-names>Lauren</given-names></name><name><surname>Bore</surname><given-names>Joseph Akoi</given-names></name><etal/></person-group><article-title>Real-Time, Portable Genome Sequencing for Ebola Surveillance</article-title><source>Nature</source><year>2016</year><volume>530</volume><issue>7589</issue><fpage>228</fpage><lpage>32</lpage><pub-id pub-id-type="pmcid">PMC4817224</pub-id><pub-id pub-id-type="pmid">26840485</pub-id><pub-id pub-id-type="doi">10.1038/nature16996</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>Martin R</given-names></name></person-group><article-title>Information Theoretic Generalized Robinson-Foulds Metrics for Comparing Phylogenetic Trees</article-title><source>Bioinformatics (Oxford, England)</source><year>2021</year><volume>37</volume><issue>14</issue><fpage>2077</fpage><lpage>78</lpage><pub-id pub-id-type="pmid">34254995</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>Martin R</given-names></name></person-group><article-title>Robust Analysis of Phylogenetic Tree Space</article-title><source>Systematic Biology</source><year>2022</year><volume>71</volume><issue>5</issue><fpage>1255</fpage><lpage>70</lpage><pub-id pub-id-type="pmcid">PMC9366458</pub-id><pub-id pub-id-type="pmid">34963003</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syab100</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stockdale</surname><given-names>Jessica E</given-names></name><name><surname>Susvitasari</surname><given-names>Kurnia</given-names></name><name><surname>Tupper</surname><given-names>Paul</given-names></name><name><surname>Sobkowiak</surname><given-names>Benjamin</given-names></name><name><surname>Mulberry</surname><given-names>Nicola</given-names></name><name><surname>da Silva</surname><given-names>Anders Gonçalves</given-names></name><name><surname>Watt</surname><given-names>Anne E</given-names></name><etal/></person-group><article-title>Genomic Epidemiology Offers High Resolution Estimates of Serial Intervals for COVID-19</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>4830</elocation-id><pub-id pub-id-type="pmcid">PMC10415581</pub-id><pub-id pub-id-type="pmid">37563113</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-40544-y</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><collab>The, CRyPTIC Consortium</collab><article-title>Genome-Wide Association Studies of Global Mycobacterium Tuberculosis Resistance to 13 Antimicrobials in 10,228 Genomes Identify New Resistance Mechanisms</article-title><source>PLoS Biology</source><year>2022</year><volume>20</volume><issue>8</issue><elocation-id>e3001755</elocation-id><pub-id pub-id-type="pmcid">PMC9363015</pub-id><pub-id pub-id-type="pmid">35944070</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3001755</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uelze</surname><given-names>Laura</given-names></name><name><surname>Grützke</surname><given-names>Josephine</given-names></name><name><surname>Borowiak</surname><given-names>Maria</given-names></name><name><surname>Hammerl</surname><given-names>Jens Andre</given-names></name><name><surname>Juraschek</surname><given-names>Katharina</given-names></name><name><surname>Deneke</surname><given-names>Carlus</given-names></name><name><surname>Tausch</surname><given-names>Simon H</given-names></name><name><surname>Malorny</surname><given-names>Burkhard</given-names></name></person-group><article-title>Typing Methods Based on Whole Genome Sequencing Data</article-title><source>One Health Outlook</source><year>2020</year><volume>2</volume><issue>1</issue><fpage>3</fpage><pub-id pub-id-type="pmcid">PMC7993478</pub-id><pub-id pub-id-type="pmid">33829127</pub-id><pub-id pub-id-type="doi">10.1186/s42522-020-0010-1</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uricaru</surname><given-names>R</given-names></name><name><surname>Rizk</surname><given-names>G</given-names></name><name><surname>Lacroix</surname><given-names>V</given-names></name><name><surname>Quillery</surname><given-names>E</given-names></name><name><surname>Plantard</surname><given-names>O</given-names></name><name><surname>Chikhi</surname><given-names>R</given-names></name><name><surname>Lemaitre</surname><given-names>C</given-names></name><name><surname>Peterlongo</surname><given-names>P</given-names></name></person-group><article-title>Reference-Free Detection of Isolated SNPs</article-title><source>Nucleic Acids Research</source><year>2015</year><volume>43</volume><issue>2</issue><fpage>e11</fpage><pub-id pub-id-type="pmcid">PMC4333369</pub-id><pub-id pub-id-type="pmid">25404127</pub-id><pub-id pub-id-type="doi">10.1093/nar/gku1187</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valiente-Mullor</surname><given-names>Carlos</given-names></name><name><surname>Beamud</surname><given-names>Beatriz</given-names></name><name><surname>Ansari</surname><given-names>Ivan</given-names></name><name><surname>Francés-Cuesta</surname><given-names>Carlos</given-names></name><name><surname>García-González</surname><given-names>Neris</given-names></name><name><surname>Mejia</surname><given-names>Lorena</given-names></name><name><surname>Ruiz-Hueso</surname><given-names>Paula</given-names></name><name><surname>González-Candelas</surname><given-names>Fernando</given-names></name></person-group><article-title>One Is Not Enough: On the Effects of Reference Genome for the Mapping and Subsequent Analyses of Short-Reads</article-title><source>PLoS Computational Biology</source><year>2021</year><volume>17</volume><issue>1</issue><elocation-id>e1008678</elocation-id><pub-id pub-id-type="pmcid">PMC7870062</pub-id><pub-id pub-id-type="pmid">33503026</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008678</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>Seok-Hwan</given-names></name><name><surname>Ha</surname><given-names>Sung-Min</given-names></name><name><surname>Lim</surname><given-names>Jeongmin</given-names></name><name><surname>Kwon</surname><given-names>Soonjae</given-names></name><name><surname>Chun</surname><given-names>Jongsik</given-names></name></person-group><article-title>A Large-Scale Evaluation of Algorithms to Calculate Average Nucleotide Identity</article-title><source>Antonie van Leeuwenhoek</source><year>2017</year><volume>110</volume><issue>10</issue><fpage>1281</fpage><lpage>86</lpage><pub-id pub-id-type="pmid">28204908</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshimura</surname><given-names>Dai</given-names></name><name><surname>Kajitani</surname><given-names>Rei</given-names></name><name><surname>Gotoh</surname><given-names>Yasuhiro</given-names></name><name><surname>Katahira</surname><given-names>Katsuyuki</given-names></name><name><surname>Okuno</surname><given-names>Miki</given-names></name><name><surname>Ogura</surname><given-names>Yoshitoshi</given-names></name><name><surname>Hayashi</surname><given-names>Tetsuya</given-names></name><name><surname>Itoh</surname><given-names>Takehiko</given-names></name></person-group><article-title>Evaluation of SNP Calling Methods for Closely Related Bacterial Isolates and a Novel High-Accuracy Pipeline: BactSNP</article-title><source>Microbial Genomics</source><year>2019</year><volume>5</volume><issue>5</issue><pub-id pub-id-type="pmcid">PMC6562250</pub-id><pub-id pub-id-type="pmid">31099741</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000261</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Schematic representation of <styled-content style="color: #38761D">ska lo</styled-content> analysis of WGS data.</title><p>The circled numbers correspond to the algorithm’s steps as described in the main text, except for the optional step 5 (SNP positioning), which is omitted due to space constraints. The numbering next to the sequences represents their names. The graph’s orange and red nodes represent entry and exit nodes, respectively. In this example, the WGS dataset consisted of 10 samples, containing three SNPs and one indel, with split k-mers extracted using k = 7. ska lo inferred three SNPs (highlighted by rectangles in the path pseudo-alignment), while the indel was detected but not inferred as its fraction of missing data was 0.4.</p></caption><graphic xlink:href="EMS199213-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Benchmarking of SNP-callers.</title><p><bold>A:</bold> Sensitivities observed using two different reference genomes for reference-based callers. The vertical dotted lines marking the lineage-strain and strain-species boundaries correspond to average nucleotide diversities of 0.0005 and 0.005 respectively. Please note the log-scale on the x-axes, and that values obtained for the reference-free callers (<styled-content style="color: #38761D">ska align</styled-content> and <styled-content style="color: #38761D">ska lo</styled-content>) are identical in these two plots. Insets show sensitivities at lowest SNP-densities. <bold>B:</bold> Variation of <styled-content style="color: #38761D">ska lo</styled-content> maximum recursive depth parameter in benchmark analyses (default value is d=4). Inset shows sensitivities at lowest SNP-densities. <bold>C:</bold> Distribution of missing samples per SNP observed with the benchmark dataset of 49,732 simulated SNPs. <styled-content style="color: #38761D">ska lo</styled-content> was run with a maximum proportion of missing data ‘m’ of 0.1 (as in <xref ref-type="fig" rid="F2">Figure 2</xref> and <xref ref-type="fig" rid="F3">3B</xref>), 0.5 and 1, and <styled-content style="color: #38761D">ska align</styled-content> with m=1. In this dataset, ground truth SNPs have 0 or 1 missing sample.</p></caption><graphic xlink:href="EMS199213-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Benchmarkings of <styled-content style="color: #38761D">ska lo</styled-content> indel-calling.</title><p><bold>A:</bold> Percentage of inferred indels relative to the total number of simulated indels in the 20-isolate benchmark. The lines for maximum recursive depths of 4 and 6 are indistinguishable. <bold>B:</bold> False positive and false negative indels in the detection of short simulated insertions by Snippy and <styled-content style="color: #38761D">ska lo</styled-content> using genomes from different Mtb lineages. <bold>C:</bold> False negative indels in the detection of large simulated insertions by <styled-content style="color: #38761D">ska lo</styled-content> using the H37Rv genome. The different colours indicate different insert sizes, ranging from 100 to 5000 nucleotides. Error bars represent the standard deviations over 10 replicates</p></caption><graphic xlink:href="EMS199213-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title><italic>S. pneumoniae</italic> PMEN2 isolates analyses.</title><p>A: BacDating root-to-tip analysis based on a tree obtained using IQ-TREE under the GTR model and Gubbins filtered SNP set produced by <styled-content style="color: #38761D">ska lo</styled-content> (genome 670-6B as reference). B: Multidimensional scaling analysis of phylogenetic trees based on clustering information distances (<xref ref-type="bibr" rid="R37">Smith 2021</xref>). For each variant caller and each reference genome, five trees were generated using IQ-TREE under the GTR model to account for the uncertainty in phylogenetic inferences. The dashed ellipse circles all trees based on <styled-content style="color: #38761D">ska lo</styled-content> filtered SNPs.</p></caption><graphic xlink:href="EMS199213-f004"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Number of variants inferred from the S. aureus outbreak dataset by Snippy and the three SKA commands. For the SKA commands, the left and right values were obtained with k-mer sizes of 21 and 41 respectively.</title></caption><table frame="box" rules="all"><thead><tr><th align="center" valign="middle" style="border-top: hidden; border-left: hidden"/><th align="center" valign="middle">Snippy</th><th align="center" valign="middle">ska align</th><th align="center" valign="middle">ska map</th><th align="center" valign="middle">ska lo</th></tr></thead><tbody><tr><td align="center" valign="middle">number of SNPs</td><td align="center" valign="middle">92</td><td align="center" valign="middle">86 / 86</td><td align="center" valign="middle">86 / 86</td><td align="center" valign="middle">90 / 92</td></tr><tr><td align="center" valign="middle">number of indels</td><td align="center" valign="middle">18</td><td align="center" valign="middle">–</td><td align="center" valign="middle">–</td><td align="center" valign="middle">13 / 19</td></tr></tbody></table></table-wrap></floats-group></article>