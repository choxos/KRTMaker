<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS200046</article-id><article-id pub-id-type="doi">10.1101/2024.11.11.618478</article-id><article-id pub-id-type="archive">PPR938171</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>GHT-SELEX demonstrates unexpectedly high intrinsic sequence specificity and complex DNA binding of many human transcription factors</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Jolma</surname><given-names>Arttu</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Hernandez-Corchado</surname><given-names>Aldo</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Yang</surname><given-names>Ally W.H.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Fathi</surname><given-names>Ali</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Laverty</surname><given-names>Kaitlin U.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Brechalov</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Razavi</surname><given-names>Rozita</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Albu</surname><given-names>Mihai</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zheng</surname><given-names>Hong</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><collab>The Codebook Consortium <contrib-group><contrib contrib-type="author"><collab>Principal investigators (steering committee) <contrib-group><contrib contrib-type="author"><name><surname>Bucher</surname><given-names>Philipp</given-names></name></contrib><contrib contrib-type="author"><name><surname>Deplancke</surname><given-names>Bart</given-names></name></contrib><contrib contrib-type="author"><name><surname>Fornes</surname><given-names>Oriol</given-names></name></contrib><contrib contrib-type="author"><name><surname>Grau</surname><given-names>Jan</given-names></name></contrib><contrib contrib-type="author"><name><surname>Grosse</surname><given-names>Ivo</given-names></name></contrib><contrib contrib-type="author"><name><surname>Hughes</surname><given-names>Timothy R.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Jolma</surname><given-names>Arttu</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kolpakov</surname><given-names>Fedor A.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kulakovskiy</surname><given-names>Ivan V.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Makeev</surname><given-names>Vsevolod J.</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Analysis Centers <contrib-group><contrib contrib-type="author"><collab>University of Toronto (Data production and analysis): <contrib-group><contrib contrib-type="author"><name><surname>Albu</surname><given-names>Mihai</given-names></name></contrib><contrib contrib-type="author"><name><surname>Barazandeh</surname><given-names>Marjan</given-names></name></contrib><contrib contrib-type="author"><name><surname>Brechalov</surname><given-names>Alexander</given-names></name></contrib><contrib contrib-type="author"><name><surname>Deng</surname><given-names>Zhenfeng</given-names></name></contrib><contrib contrib-type="author"><name><surname>Fathi</surname><given-names>Ali</given-names></name></contrib><contrib contrib-type="author"><name><surname>Jolma</surname><given-names>Arttu</given-names></name></contrib><contrib contrib-type="author"><name><surname>Hu</surname><given-names>Chun</given-names></name></contrib><contrib contrib-type="author"><name><surname>Hughes</surname><given-names>Timothy R.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Lambert</surname><given-names>Samuel A.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Laverty</surname><given-names>Kaitlin U.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Patel</surname><given-names>Zain M.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Pour</surname><given-names>Sara E.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Razavi</surname><given-names>Rozita</given-names></name></contrib><contrib contrib-type="author"><name><surname>Salnikov</surname><given-names>Mikhail</given-names></name></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Ally W.H.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Yellan</surname><given-names>Isaac</given-names></name></contrib><contrib contrib-type="author"><name><surname>Zheng</surname><given-names>Hong</given-names></name></contrib></contrib-group></collab></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Institute of Protein Research (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Kulakovskiy</surname><given-names>Ivan V.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Meshcheryakov</surname><given-names>Georgy</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>EPFL, École polytechnique fédérale de Lausanne (Data production and analysis): <contrib-group><contrib contrib-type="author"><name><surname>Ambrosini</surname><given-names>Giovanna</given-names></name></contrib><contrib contrib-type="author"><name><surname>Deplancke</surname><given-names>Bart</given-names></name></contrib><contrib contrib-type="author"><name><surname>Gralak</surname><given-names>Antoni J.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Inukai</surname><given-names>Sachi</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kribelbauer-Swietek</surname><given-names>Judith F.</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Martin Luther University Halle-Wittenberg (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Grau</surname><given-names>Jan</given-names></name></contrib><contrib contrib-type="author"><name><surname>Grosse</surname><given-names>Ivo</given-names></name></contrib><contrib contrib-type="author"><name><surname>Plescher</surname><given-names>Marie-Luise</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Sirius University of Science and Technology (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Bucher</surname><given-names>Philipp</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kolpakov</surname><given-names>Fedor</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Biosoft.Ru (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Yevshin</surname><given-names>Ivan</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Faculty of Bioengineering and Bioinformatics, Lomonosov Moscow State University (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Gryzunov</surname><given-names>Nikita</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kozin</surname><given-names>Ivan</given-names></name></contrib><contrib contrib-type="author"><name><surname>Nikonov</surname><given-names>Mikhail</given-names></name></contrib><contrib contrib-type="author"><name><surname>Nozdrin</surname><given-names>Vladimir</given-names></name></contrib><contrib contrib-type="author"><name><surname>Zinkevich</surname><given-names>Arsenii</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Institute of Organic Chemistry and Biochemistry (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Faltejskova</surname><given-names>Katerina</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Max Planck Institute of Biochemistry (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Kravchenko</surname><given-names>Pavel</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Swiss Institute for Bioinformatics (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Bucher</surname><given-names>Philipp</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>University of British Columbia (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Fornes</surname><given-names>Oriol</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Vavilov Institute of General Genetics (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Abramov</surname><given-names>Sergey</given-names></name></contrib><contrib contrib-type="author"><name><surname>Boytsov</surname><given-names>Alexandr</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kamenets</surname><given-names>Vasilii</given-names></name></contrib><contrib contrib-type="author"><name><surname>Makeev</surname><given-names>Vsevolod J.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Penzar</surname><given-names>Dmitry</given-names></name></contrib><contrib contrib-type="author"><name><surname>Vlasov</surname><given-names>Anton</given-names></name></contrib><contrib contrib-type="author"><name><surname>Vorontsov</surname><given-names>Ilya E.</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>McGill University (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Hernandez-Corchado</surname><given-names>Aldo</given-names></name></contrib><contrib contrib-type="author"><name><surname>Najafabadi</surname><given-names>Hamed S.</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Memorial Sloan Kettering (Data production and analysis): <contrib-group><contrib contrib-type="author"><name><surname>Laverty</surname><given-names>Kaitlin U.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Morris</surname><given-names>Quaid</given-names></name></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><collab>Cincinnati Children’s Hospital (Data analysis): <contrib-group><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Xiaoting</given-names></name></contrib><contrib contrib-type="author"><name><surname>Weirauch</surname><given-names>Matthew T.</given-names></name></contrib></contrib-group></collab></contrib></contrib-group></collab></contrib><contrib contrib-type="author"><name><surname>Kulakovskiy</surname><given-names>Ivan V.</given-names></name><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Najafabadi</surname><given-names>Hamed S.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">**</xref></contrib><contrib contrib-type="author"><name><surname>Hughes</surname><given-names>Timothy R.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="corresp" rid="CR1">**</xref></contrib></contrib-group><aff id="A1"><label>1</label>Donnelly Centre, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>University of Toronto</institution></institution-wrap>, <city>Toronto</city>, <postal-code>ON M5S 3E1</postal-code>, <country country="CA">Canada</country></aff><aff id="A2"><label>2</label>Department of Human Genetics, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01pxwe438</institution-id><institution>McGill University</institution></institution-wrap>, <city>Montréal</city>, <postal-code>QC H3A 0C7</postal-code>, <country country="CA">Canada</country></aff><aff id="A3"><label>3</label>Victor P. Dahdaleh Institute of Genomic Medicine, Montréal, QC H3A 0G1, Canada</aff><aff id="A4"><label>4</label>Department of Molecular Genetics, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>University of Toronto</institution></institution-wrap>, <city>Toronto</city>, <postal-code>ON M5S 1A8</postal-code>, <country country="CA">Canada</country></aff><aff id="A5"><label>5</label>Sloan Kettering Institute, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02yrq0923</institution-id><institution>Memorial Sloan Kettering Cancer Center</institution></institution-wrap>, <city>New York, NY</city><postal-code>10065</postal-code>, <country country="US">USA</country></aff><aff id="A6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05ermrg42</institution-id><institution>Vavilov Institute of General Genetics</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qrfxd25</institution-id><institution>Russian Academy of Sciences</institution></institution-wrap>, <postal-code>119991</postal-code>, <city>Moscow</city>, Russia and Institute of Protein Research, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qrfxd25</institution-id><institution>Russian Academy of Sciences</institution></institution-wrap>, <postal-code>142290</postal-code>, <city>Pushchino</city>, <country country="RU">Russia</country></aff><aff id="A7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05ermrg42</institution-id><institution>Vavilov Institute of General Genetics</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05qrfxd25</institution-id><institution>Russian Academy of Sciences</institution></institution-wrap>, <postal-code>119991</postal-code>, <city>Moscow</city>, <country country="RU">Russia</country></aff><author-notes><corresp id="CR1"><label>**</label><email>hamed.najafabadi@mcgill.ca</email> and <email>t.hughes@utoronto.ca</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>13</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>11</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><title>Summary</title><p id="P1">A long-standing challenge in human regulatory genomics is that transcription factor (TF) DNA-binding motifs are short and degenerate, while the genome is large. Motif scans therefore produce many false-positive binding site predictions. By surveying 179 TFs across 25 families using &gt;1,500 cyclic <italic>in vitro</italic> selection experiments with fragmented, naked, and unmodified genomic DNA – a method we term GHT-SELEX (Genomic HT-SELEX) – we find that many human TFs possess much higher sequence specificity than anticipated. Moreover, genomic binding regions from GHT-SELEX are often surprisingly similar to those obtained <italic>in vivo</italic> (i.e. ChIP-seq peaks). We find that comparable specificity can also be obtained from motif scans, but performance is highly dependent on derivation and use of the motifs, including accounting for multiple local matches in the scans. We also observe alternative engagement of multiple DNA-binding domains within the same protein: long C2H2 zinc finger proteins often utilize modular DNA recognition, engaging different subsets of their DNA binding domain (DBD) arrays to recognize multiple types of distinct target sites, frequently evolving via internal duplication and divergence of one or more DBDs. Thus, contrary to conventional wisdom, it is common for TFs to possess sufficient intrinsic specificity to independently delineate cellular targets.</p></abstract><kwd-group><kwd>DNA binding specificity</kwd><kwd>Transcription factor</kwd><kwd>TF</kwd><kwd>Transcription factor binding site</kwd><kwd>Position weight matrix</kwd><kwd>PWM</kwd><kwd>ChIP-Seq</kwd><kwd>HT-SELEX</kwd><kwd>GHT-SELEX</kwd><kwd>SELEX</kwd><kwd>Modular binding</kwd><kwd>C2H2 zinc finger</kwd><kwd>C2H2</kwd><kwd>RCADEEM</kwd><kwd>MAGIX</kwd><kwd>Codebook</kwd><kwd>Gene regulation</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The DNA-binding sequence preference of a Transcription Factor (TF) is typically referred to as a motif, and is most commonly modeled as a position weight matrix (PWM), which describes the relative preference of the TF for each base in the binding site<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. In human, TF binding motifs are generally short and flexible; PWMs are typically 8-14 bases long<sup><xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R4">4</xref></sup>, and multiple bases can be tolerated at many positions<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup>. Thus, a typical TF PWM scan with default parameters yields over a million potential binding sites in the 3-billion-base human genome, often with multiple high-scoring matches per gene. Very few of the potential target sites are utilized in cells<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, however, and the actual number of bound sites, as measured by ChIP-seq<sup><xref ref-type="bibr" rid="R8">8</xref>–<xref ref-type="bibr" rid="R10">10</xref></sup> or other assays<sup><xref ref-type="bibr" rid="R11">11</xref></sup> is typically much lower than the number of motif matches.</p><p id="P3">This deficit in specificity has been resolved conceptually by the widespread cooperative binding and synergy among TFs<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R13">13</xref></sup>, and evidence that the chromatin landscape generally dominates TF binding site selection<sup><xref ref-type="bibr" rid="R30">30</xref></sup>, such that TF motif matches only determine binding within permissible regions. In the latter model, only a special class of “pioneer” TFs can access target sequences to control the local chromatin. Indeed, some TFs have been shown to have high inherent specificity: for example, CTCF binds the majority of its strongest motif matches in the genome<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, and repositions the surrounding nucleosomes<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. PRDM9, which controls recombination hotspots, has been reported to independently specify roughly half of its binding sites in the genome<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. Another possible explanation for the generally low apparent specificity of TF motifs, however, is that PWMs are inaccurate, or are used inappropriately, or that the PWM model is fundamentally flawed<sup><xref ref-type="bibr" rid="R17">17</xref></sup>. PWMs are often derived from a non-comprehensive set of bound vs. unbound sequences, and there is ongoing controversy regarding the best methods for derivation, underlying representation, and scanning of TF motifs<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>, as well as the impact of DNA shape<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, dependencies among base positions<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>, multimeric binding<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup>, and lower-affinity binding sites<sup><xref ref-type="bibr" rid="R23">23</xref></sup>.</p><p id="P4">Many human TFs still lack binding motifs, and prominent among them are hundreds of C2H2 zinc finger (C2H2-zf) proteins<sup><xref ref-type="bibr" rid="R24">24</xref></sup>. These proteins recognize DNA sequences that approximate a concatenation of the three or four base specificities of their sequential constituent C2H2-zf domains<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>. Different C2H2-zf proteins can bind very different motifs due to both the malleability of the individual C2H2-zf domains and rearrangement of the individual C2H2-zf domains<sup><xref ref-type="bibr" rid="R27">27</xref></sup>. An enigmatic feature of the C2H2-zf proteins is their theoretical capacity to recognize very long sequences: the median number of C2H2-zf domains in human TFs is 11, which could contact up to 33 DNA bases, much more than would be needed to specifically recognize even a single target site in the genome, on average. Indeed, C2H2-zf proteins often use only a subset of their DBDs to contact DNA, and whether and how frequently human C2H2-zf proteins utilize different segments of the C2H2-zf domain array to bind different sequences has also been a long-standing question. In a well-studied example, CTCF binding sites appear to reflect a constitutive “core”, bound by fingers 4-7 of the 11 C2H2-zf domain array, flanked by sequences that are bound by alternative usage of upstream and/or downstream C2H2-zf domains<sup><xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R29">29</xref></sup>. Analysis of the DNA-binding of C2H2-zf proteins to the genome is also complicated by the fact that they often bind repeat elements such as endogenous retroelements<sup><xref ref-type="bibr" rid="R30">30</xref></sup>, and thus the target site similarity is derived both from DNA recognition and the shared ancestry of the binding sites. The limited resolution of ChIP-seq (&gt;100bp) presents a related hindrance. These confounding factors, however, can be ameliorated by incorporating information about the bases that are likely preferred at each position of the binding site, as predicted by a C2H2-zf “recognition code” that relates the C2H2-zf amino acid sequences to their binding preferences. These machine learning-based predictions can assist in identifying the most plausible protein-DNA interactions in such cases, as our earlier work demonstrated<sup><xref ref-type="bibr" rid="R31">31</xref></sup>.</p><p id="P5">Here, we describe GHT-SELEX (Genomic DNA HT-SELEX), a novel implementation of the HT-SELEX<sup><xref ref-type="bibr" rid="R32">32</xref></sup> method for identification of the sequence specificity of DNA-binding proteins. HT-SELEX is a high-throughput implementation of SELEX (Systematic Evolution of Ligands by EXponential enrichment)<sup><xref ref-type="bibr" rid="R33">33</xref></sup>, using multi-cycle, automated affinity capture of protein-bound DNA in microwell plates, coupled to multiplexed Illumina sequencing. HT-SELEX utilizes random-sequence DNA, while GHT-SELEX is instead performed with fragmented human genomic DNA, and uses an associated new statistical analysis method, MAGIX (Model-based Analysis of Genomic Intervals with eXponential enrichment). GHT-SELEX is conceptually similar to Affinity-seq<sup><xref ref-type="bibr" rid="R16">16</xref></sup> and DAP-seq<sup><xref ref-type="bibr" rid="R34">34</xref></sup>, but it incorporates multiple selection cycles, and is thus related to earlier genomic SELEX approaches that utilized Sanger sequencing<sup><xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R36">36</xref></sup>. The use of barcoding, magnetic affinity beads and laboratory automation makes it possible to run GHT-SELEX in parallel with hundreds of samples. We developed GHT-SELEX in the context of the Codebook consortium project<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, which was aimed primarily at analysis of 332 uncharacterized putative TFs (together with 61 control TFs), and provides comparison data from several other platforms for the same set of TFs (HT-SELEX, ChIP-seq, Protein Binding Microarrays<sup><xref ref-type="bibr" rid="R38">38</xref></sup>, and SMiLE-seq<sup><xref ref-type="bibr" rid="R39">39</xref></sup>). We successfully applied GHT-SELEX to 179 human TFs, most of which are poorly characterized, thus providing a major expansion in the number of human TF motifs. For dozens of TFs, including some that are considered well-characterized, GHT-SELEX peaks correspond with <italic>in vivo</italic> binding (measured by ChIP-seq) much more accurately than current models would suggest. GHT-SELEX is particularly effective for C2H2-zf proteins, and shows that they often use alternative subsets of their C2H2-zf domains to engage with different genomic target sites. We explore both explanations and ramifications of these observations.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Development and testing of GHT-SELEX</title><p id="P6">GHT-SELEX combines the principles of previous genomic DNA selection protocols<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup> with HT-SELEX, a method that has been applied successfully to hundreds of human TFs and is compatible with robotics<sup><xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup>. We developed GHT-SELEX (<xref ref-type="fig" rid="F1">Figure 1A</xref>) to run in parallel with HT-SELEX, in the context of the Codebook project. The intended purpose, initially, was to create a DNA library that contains sufficient representation of long repeat sequences that are common in the human genome (e.g. transposons and endogenous retroelements): we reasoned that the difficulty of obtaining long motifs expected for C2H2-zf proteins may be due to the scarcity of long binding sites in a random pool, since representation of any sequence would decrease exponentially with its length. The GHT-SELEX DNA pool used in this study was produced by nonspecific enzymatic fragmentation of HEK293 DNA to fragments with a median length of ~64 bp. HEK293 DNA was chosen for compatibility with ChIP-seq data generated simultaneously (see accompanying manuscript<sup><xref ref-type="bibr" rid="R41">41</xref></sup>), and the length of the DNA was chosen to mimic standard HT-SELEX procedures and provide relatively high resolution.</p><p id="P7">We initially tested GHT-SELEX on the Codebook control proteins. Thirty of the controls represented a sampling of well-studied TFs with different classes of DBDs, most of which were previously analyzed using the independent <italic>in vitro</italic> SMiLE-seq platform<sup><xref ref-type="bibr" rid="R39">39</xref></sup>. An additional 31 controls were C2H2-zf proteins for which published ChIP-seq data yielded motifs<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. At the outset, we assumed that GHT-SELEX would yield continuous read coverage across the genome, given conventional estimates of up to a million PWM hits per TF<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, such that the data could be analyzed directly for enriched motifs among the reads. Indeed, examination of individual mapped reads revealed that they usually accumulate at sites in which all reads overlap with what appears to be a motif match (<xref ref-type="fig" rid="F1">Figure 1B</xref>). Remarkably, it also became apparent that GHT-SELEX data typically has a strong resemblance to ChIP-seq data, forming strong peaks found sparsely across the genome. <xref ref-type="fig" rid="F1">Figure 1C</xref> shows raw read density for four control TFs, comparing GHT-SELEX to ChIP-seq, and also to target site predictions based on existing and newly-derived (see below) PWM models for the TFs. This observation prompted us to analyze the data as peaks, instead of raw reads.</p><p id="P8">Peak calling from the GHT-SELEX data with conventional algorithms is confounded by the fact that different peaks have very different enrichment ratios across the cycles, presumably due to varying affinity of the TF for different sites, the overall increase in motif occurrences in the pool over the successive cycles, and simultaneous reduction in pool complexity, with the strongest binding sites dominating later cycles. As a consequence, enrichment information is distributed across the read cycles, with weaker peaks first appearing and disappearing, and the strongest peaks dominating in the later cycles. To adapt to these issues, we developed an analytical framework that capitalizes on the added information gained from multiple SELEX cycles (<xref ref-type="fig" rid="F2">Figure 2A</xref>; see <xref ref-type="sec" rid="S10">Methods</xref> for details). The approach relies on a statistical method that explicitly models the exponential growth of TF-bound genomic regions over the SELEX cycles, which leads to a progressively higher proportion of TF-bound fragments and depletion of relative to genomic background. The fragment abundances, in turn, are modeled as latent variables that determine the number of observed reads through a Poisson process. This hierarchical Bayesian model enables the integration of information across different selection cycles, experiments, and batches, to calculate an estimated enrichment coefficient (<xref ref-type="fig" rid="F2">Figure 2B</xref>). We refer to this approach as MAGIX (<underline>M</underline>odel-based <underline>A</underline>nalysis of <underline>G</underline>enomic <underline>I</underline>ntervals with e<underline>X</underline>ponential enrichment).</p><p id="P9">Among the 61 control proteins, 40 were deemed as successful on GHT-SELEX (see below and accompanying manuscripts<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R43">43</xref></sup> for a description of how success was determined). Analysis of the data for the 40 successful controls by MAGIX resulted in between 13 and 137,718 peaks (median 19,400) with enrichment coefficient exceeding 5% FDR (see <xref ref-type="sec" rid="S10">Methods</xref>). There is a clear enrichment of the motif occurrences for the corresponding TFs within the peaks, with the number of strong PWM hits, on average, declining rapidly at ~50 bp from peak centre, consistent with the DNA fragment size (<xref ref-type="fig" rid="F2">Figure 2C</xref>; similar plots for all TFs analyzed are shown in <xref ref-type="supplementary-material" rid="SD1">Document S1</xref>). In addition, higher PWM scores (which would, in theory, predict higher relative affinity) are clearly associated with a higher GHT-SELEX enrichment coefficient (see below), suggesting that the GHT-SELEX/MAGIX is quantitative to some degree.</p></sec><sec id="S4"><title>Application of GHT-SELEX to the Codebook TF set</title><p id="P10">We next performed GHT-SELEX and, in parallel, HT-SELEX using fragmented genomic DNA and random 40N ligands (<xref ref-type="supplementary-material" rid="SD3">Table S1</xref>), respectively, to assess DNA binding activity of 331 poorly characterized putative human TFs, as part of the Codebook project. We analyzed individual TFs with up to three types of constructs, and up to three protein expression strategies (two types of <italic>in vitro</italic> transcription–translation reactions, and expression in HEK293 cells, see <xref ref-type="sec" rid="S10">Methods</xref>). Several experimental variables were modulated over the course of the experiments, resulting in improvement of success rates, particularly for TFs with long C2H2-zf domain arrays (see <xref ref-type="sec" rid="S10">Methods</xref> and <xref ref-type="supplementary-material" rid="SD4">Table S2</xref>). For each TF, the constructs contained the full sequence of a representative isoform, or either all or a subset of its predicted DBDs. In total, we analyzed 1,315 constructs encompassing the 61 control TFs and 331 of the 332 putative TFs in the Codebook set of poorly characterized proteins. With these constructs we performed 1,534 GHT-SELEX and 1,578 HT-SELEX experiments (see <xref ref-type="sec" rid="S10">Methods</xref> and <xref ref-type="supplementary-material" rid="SD5">Table S3</xref>).</p><p id="P11">In separate parts of the Codebook project, this same set of proteins was analyzed using ChlP-seq, Protein Binding Microarrays<sup><xref ref-type="bibr" rid="R38">38</xref></sup>, and SMiLE-seq<sup><xref ref-type="bibr" rid="R39">39</xref></sup>, as described in the accompanying manuscripts<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R41">41</xref>,<xref ref-type="bibr" rid="R44">44</xref></sup>. We gauged the success of each TF in each experiment, including the GHT-SELEX experiments, largely based on whether similar DNA-binding motifs (i.e. PWMs) were obtained from different types of experiments, with all data types considered in aggregate by a team of expert curators. This process produced a list of “approved” experiments, as described in an accompanying study<sup><xref ref-type="bibr" rid="R43">43</xref></sup>. Selection of a single PWM for each TF for subsequent analyses is described in accompanying study<sup><xref ref-type="bibr" rid="R37">37</xref></sup>. The PWM selections incorporated those generated from all data types. PWMs and logos are available in accompanying study<sup><xref ref-type="bibr" rid="R37">37</xref></sup> and online at <ext-link ext-link-type="uri" xlink:href="https://codebook.ccbr.utoronto.ca">https://codebook.ccbr.utoronto.ca</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://mex.autosome.org">https://mex.autosome.org</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://cisbp.ccbr.utoronto.ca45">https://cisbp.ccbr.utoronto.ca45</ext-link>.</p><p id="P12">In total, 139 previously uncharacterized Codebook TFs had at least one “approved” GHT-SELEX experiment (i.e., were successful in GHT-SELEX), of which 131 were also approved in HT-SELEX, 108 in ChIP-seq, and 102 in all three (<xref ref-type="fig" rid="F3">Figure 3A</xref> and <xref ref-type="supplementary-material" rid="SD5">Table S3</xref>). The 139 were comprised mainly of C2H2-zf proteins, which are prevalent in the Codebook set (<xref ref-type="fig" rid="F3">Figure 3B</xref>). In contrast, 163 of the putative TFs did not yield motifs in any of these assays, suggesting that they either do not bind DNA with sequence specificity, or require post-translational modifications or cofactors. In particular, only two of 49 proteins tested that lacked a known DBD yielded an approved experiment in GHT-SELEX (discussed in greater detail in the accompanying studies<sup><xref ref-type="bibr" rid="R37">37</xref></sup>). Including the control TFs, 24 types of DBDs were present among the approved experiments (<xref ref-type="fig" rid="F3">Figure 3B</xref>), illustrating that the method can capture motif-containing genomic target site locations of diverse TF types.</p></sec><sec id="S5"><title>Unexpectedly high overlap between TF binding to the genome <italic>in vitro</italic> and <italic>in vivo</italic></title><p id="P13">GHT-SELEX analyzed with MAGIX, like ChIP-seq, produces peaks with a continuum of enrichment coefficient values and other associated statistics. Across both Codebook TFs and controls, there are typically a relatively small number of peaks with exceptionally high MAGIX enrichment coefficient values (hundreds to thousands), but we did not observe bimodal distributions that would imply a natural threshold which could be used to discriminate “bound” from “unbound” loci (examples in <xref ref-type="fig" rid="F4">Figure 4A</xref>; distributions for all TFs in <xref ref-type="supplementary-material" rid="SD1">Document S1</xref>). We also examined the correspondence between GHT-SELEX/MAGIX peaks, ChIP-seq peaks, and PWM scores, focusing on the 137 TFs for which both ChIP-seq and GHT-SELEX data were available (101 Codebook TFs and 36 controls). In most cases, there was a much higher overlap with ChIP-seq peaks and high PWM scores among the highest-scoring GHT-SELEX/MAGIX peaks (examples are shown in <xref ref-type="fig" rid="F4">Figure 4A</xref>, and plots for all TFs in <xref ref-type="supplementary-material" rid="SD1">Document S1</xref>). We did not, however, identify a specific peak enrichment coefficient or significance value across all experiments that uniformly corresponds to high enrichment of PWM hits, or the probability of overlap with ChIP-seq peaks.</p><p id="P14">Lack of a universal enrichment coefficient threshold across all experiments could be accounted for by TF-specific parameters in both GHT-SELEX and ChIP-seq assays, including different binding kinetics for both sequence-specific and nonspecific DNA binding, the effective concentration of the TFs, and the ability of the TFs to compete or cooperate with nucleosomes and other cofactors <italic>in vivo.</italic> Given that these parameters are unobserved and difficult to estimate from the data available, we implemented a simple scheme to draw thresholds on both peak sets: by sequentially taking equal numbers of highest scoring peaks on a TF-specific basis, we identified the peak number that maximizes the Jaccard statistic of overlap between the GHT-SELEX/MAGIX peaks and ChIP-seq peaks (<xref ref-type="fig" rid="F4">Figure 4B</xref>).</p><p id="P15">This approach yielded a very striking result, which is that for many TFs, a peak number can be identified with a surprisingly high Jaccard value (Jaccard median 0.1117) (<xref ref-type="fig" rid="F4">Figure 4C,D</xref> and <xref ref-type="supplementary-material" rid="SD6">Table S4</xref>), indicating that the TF intrinsically (i.e. independently) specifies many of the <italic>in vivo</italic> binding sites above the threshold selected. Peak overlap is a demanding statistic, because random expectation (i.e. from choosing genomic regions at random) is near zero, as only a miniscule fraction of the genome is covered by the peaks in either data type, and both experimental variation and noise in generation of peaks will lead to fluctuation of the rank order of peaks, even for replicates. Indeed, this result is not obtained from permuted peak positions, or permuted experiments (i.e. mismatched TFs) (after permutation, Jaccard median 0.0073; Wilcoxon p=2.6x10<sup>-38</sup>) (<xref ref-type="fig" rid="F4">Figure 4D</xref>). The peak numbers yielding these high Jaccard values are often relatively low, and correspond to a wide range of ChIP-seq p-value thresholds and MAGIX enrichment coefficient values (<xref ref-type="supplementary-material" rid="SD6">Table S4</xref>).</p><p id="P16">Overall, this outcome contrasts with traditional expectation, which is that individual TF would normally not be able to independently specify their DNA targets in the genome<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. We note that many of the TFs with highest Jaccard maxima are uncharacterized C2H2-zf proteins with long (and intuitively specific) motifs: Among those with Jaccard &gt; 0.1, 78% are C2H2-zf proteins (57 out of 73), vs 42% (27 out of 64) for those with Jaccard below 0.1, and overall, the median Jaccard value for C2H2-zf proteins is 0.1582, vs. 0.0616 for non-C2H2-zf proteins (Wilcoxon p=5.14x10<sup>-8</sup>). CTCF, a control protein that is known to possess large number of genomic target sites, unusually high specificity and ability to control nucleosome positions<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R15">15</xref></sup>, is among those with high Jaccard values, although it is not the highest scoring in this dataset. Counterintuitively, high Jaccard maxima were also obtained for a subset of TFs with relatively short motifs, including NFKB1, GABPA, NACC2, and several CXXC proteins, such as CXXC4 and KDM2A, that mainly bind CG dinucleotides, as expected<sup><xref ref-type="bibr" rid="R46">46</xref></sup> (<xref ref-type="fig" rid="F5">Figure 5A</xref>).</p></sec><sec id="S6"><title>Multiple explanations for high sequence specificity observed in GHT-SELEX</title><p id="P17">We next asked whether PWM predictions across the genome could achieve a level of correspondence to ChIP-seq that we obtained with GHT-SELEX/MAGIX. To do this, we performed a similar maximization of the overlap score (Jaccard) as described above for GHT-SELEX and ChIP-seq, here sweeping through PWM scores (i.e. using PWMs to predict and score “peaks” in the genome; see <xref ref-type="sec" rid="S10">Methods</xref> for details). Remarkably, on average, the overlap between PWM predictions and ChIP-seq peaks is similar to that for GHT-SELEX/MAGIX and ChIP-seq peaks (<xref ref-type="fig" rid="F5">Figure 5A</xref>, <xref ref-type="supplementary-material" rid="SD6">Table S4</xref>), and the numbers of peaks at which the maximum Jaccard was obtained is also typically similar (<xref ref-type="fig" rid="F5">Figure 5B</xref>). The slightly higher Jaccard for PWMs in some cases may be due to the simple PWM models smoothing experimental noise in the GHT-SELEX. In some cases, however, this explanation seems implausible; for example, in several instances, very small PWMs (e.g. that of CXXC4, which is mainly a single CG dinucleotide) yielded higher overlap with ChIP-seq peak locations than GHT-SELEX did.</p><p id="P18">To our knowledge, such strong ability of PWMs to predict <italic>in vivo</italic> binding sites, over a large set of TFs, is unprecedented. We attribute two main sources. First, the PWMs used in these analyses were selected from a panel of hundreds to thousands of candidate PWMs, specifically choosing those that performed best across numerous test statistics and several data types. The Jaccard statistics against ChIP-seq and GHT-SELEX were among the selection criteria. Thus, lower maximal Jaccard scores – often vastly lower - are obtained from virtually all other PWMs. Hence, in addition to optimizing the thresholds, part of the explanation for the high Jaccard values we obtained lies in the derivation of the PWM itself.</p><p id="P19">The second apparent source of performance increase is the PWM scanning and scoring method. For some TFs, scoring a DNA fragment using the sum of predicted affinity scores over a sequence window (i.e. the sum of the PWM probability scores at individual positions, rather than the log-odds that is output by most PWM scanning tools) results in considerably higher maximum Jaccard value than taking the maximum or sum of log-odds PWM scores (which are generally thought to represent binding energy<sup><xref ref-type="bibr" rid="R47">47</xref>,<xref ref-type="bibr" rid="R48">48</xref></sup>) (<xref ref-type="fig" rid="F5">Figure 5C</xref>). Sum-of-affinity scoring presumably reflects the cooperation of multiple adjacent binding sites, traditionally referred to as “avidity”<sup><xref ref-type="bibr" rid="R49">49</xref></sup>. The effect is most striking for a subset of TFs that bind short or repetitive sequences, including CG dinucleotides and poly-A stretches (<xref ref-type="fig" rid="F5">Figure 5D</xref>, but it also appears to underpin the specificity of NACC2 and ZNF48, which have unique, non-repetitive motifs (<xref ref-type="fig" rid="F5">Figure 5E</xref>). Points above the diagonal in <xref ref-type="fig" rid="F5">Figure 5A</xref>, where PWM prediction shows higher overlap with ChIP than the GHT-SELEX, may therefore represent the impact of TF binding sites over a larger window influencing ChIP-seq but not GHT-SELEX (we performed the PWM scans with a 200 bp window, while the GHT-SELEX fragments are only ~65 bp). For example, scanning 200-base windows with the short CG motif for CXXC4 may be better suited for detection of CpG islands (which dominate the CXXC4 binding sites<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, in which the CG dinucleotides will be distributed over a large region (by definition ≥200 bp).</p><p id="P20">These analyses indicate that PWMs can often predict <italic>in vivo</italic> TF binding sites as effectively as actual measurements of binding to the genome made with GHT-SELEX. <xref ref-type="fig" rid="F1">Figure 1C</xref> illustrates the increase in correspondence between PWM predictions and ChIP-seq peaks that can be achieved with carefully-selected PWMs and improved scanning procedures. There are, however, many TFs in which no PWM could be derived that rivals GHT-SELEX data in correspondence of ChIP-seq peaks (those below the diagonal in <xref ref-type="fig" rid="F5">Figure 5A</xref>). These TFs are almost entirely proteins with a long array of C2H2-zf domains, which we examine more closely in the next section.</p></sec><sec id="S7"><title>Alternate usage of C2H2-zf domains within large arrays</title><p id="P21">The expansive collection of GHT-SELEX, HT-SELEX, and ChIP-seq data for C2H2-zf proteins provided an opportunity to examine the long-standing issue of usage of individual C2H2-zf domains within large arrays. Anecdotally, we observed many instances where the motifs detected for C2H2-zf proteins were much shorter than expected based on the number of C2H2-zf domains, as well as examples in which multiple distinct motifs emerged, suggesting that the TFs might use partial subsets of their DBD array to engage DNA at different locations. Proving differential engagement of the specific C2H2-zf domains is challenging, however, due to low statistical power (there are many possible C2H2-zf domain sub-arrays, and a limited number of highly enriched peaks) and the fact that the genome is highly non-random and repeat-rich. To minimize the impact of these issues, we developed a new method that utilizes the C2H2-zf recognition code to assess which sets of C2H2-zf domains are likely to be engaged at any individual binding sites. We call this method RCADEEM (Recognition Code-Assisted Discovery of regulatory Elements by Expectation-Maximization) (see <xref ref-type="sec" rid="S10">Methods</xref> for details). <xref ref-type="fig" rid="F6">Figure 6A</xref> shows a schematic, and the results of applying RCADEEM to CTCF, illustrating that it produces a “core” motif recognized by fingers 4-7 at all sites, and alternative usage of flanking C2H2-zf domains in a subset of sites, very similar to the differential usage of CTCF C2H2-zfs domains that has been previously described<sup><xref ref-type="bibr" rid="R28">28</xref></sup>.</p><p id="P22">We applied RCADEEM to all 120 C2H2-zf proteins for which we had approved data from GHT-SELEX (<xref ref-type="supplementary-material" rid="SD6">Table S4</xref>). We applied RCADEEM on GHT-SELEX data and separately, if available, on HT-SELEX and ChIP-seq; for GHT-SELEX and ChIP-seq, we applied it both with and without repeat sequences (i.e. removing any peaks that overlap with the UCSC Repeatmasker track). In total, we obtained RCADEEM predictions for 86 of them (<xref ref-type="supplementary-material" rid="SD6">Table S4</xref>), all of which are available via the web resources accompanying this paper (<ext-link ext-link-type="uri" xlink:href="https://codebook.ccbr.utoronto.ca/">https://codebook.ccbr.utoronto.ca/</ext-link>). (For the remaining 34, the algorithm did not converge, suggesting that the sequence preferences of the protein do not closely follow the recognition code, and thus cannot be analyzed in this way). Most of the 86 displayed what appears to represent alternative usage of segments of the C2H2-zf domain array on different DNA molecules (e.g. different genomic loci) within the same experiment. We manually classified the apparent C2H2-zf domain usage into the following categories, examples of which are shown in <xref ref-type="fig" rid="F6">Figure 6B-F</xref>, while <xref ref-type="fig" rid="F6">Figure 6G</xref> provides an overview of the descriptors and other properties of each of the C2H2-zf proteins. 1) <italic>Canonical (30 instances)</italic> follows the baseline assumption that a TF always uses the same set of C2H2-zf domains to recognize sites that can be described with a single PWM. 2) <italic>Core with extensions (24 instances),</italic> where all sites share a sequence motif bound by a subset of the C2H2-zf domains, which is supplemented by recognition of flanking sequences by adjacent C2H2-zf domains at some binding sites. 3) <italic>Finger shift (14 instances),</italic> where the TF recognizes a range of tiled target sites by binding with variable subsets of adjacent C2H2-zf domains. 4) <italic>Multiple DBDs (32 instances),</italic> in which subsets of the C2H2-zf domain array appear to function as independent DBDs. The last three binding modes are not mutually exclusive. For example, ZNF471 displays both multiple DBDs and core with extensions with one of the DBDs (<xref ref-type="fig" rid="F6">Figure 6F</xref>), while the long finger shift in ZNF665 (<xref ref-type="fig" rid="F6">Figure 6D</xref>) leads effectively to multiple DBDs, as the target sites of most N-terminal and C-terminal ends do not overlap with each other. <xref ref-type="supplementary-material" rid="SD6">Table S4</xref> lists the annotations for all 86 proteins.</p></sec><sec id="S8"><title>Evolution of C2H2-zf protein DNA-binding specificities via internal duplication</title><p id="P23">In the RCADEEM outputs, different segments of a C2H2-zf domain array (i.e., different DNA binding regions of the protein) are often predicted to bind similar yet distinct sets of sequences. For example, ZNF775 (<xref ref-type="fig" rid="F6">Figure 6E</xref>) binds two types of sites that contain a shared GNWGAA consensus, followed by either TTT or GCA trinucleotides. RCADEEM predicts that these two sites are recognized by C2H2-zf domain arrays 1-4 and 5-8, respectively. Indeed, arrays 1-4 and 5-8, as well as 9-11, are homologous, on the basis of sequence identity (visualized at <ext-link ext-link-type="uri" xlink:href="https://codebook.ccbr.utoronto.ca/details.php?TF=ZNF775">https://codebook.ccbr.utoronto.ca/details.php?TF=ZNF775</ext-link>), suggesting that they arose from duplications. All three arrays are present in mammals as distant as the Tasmanian devil, indicating that the duplications predate divergence from marsupials, and have since been conserved. The cellular and physiological functions of this protein are unknown, to our knowledge, but this degree of sequence conservation suggests a conserved role across mammals.</p><p id="P24">Another example is ZNF721: RCADEEM indicates that it has three DNA-binding modes, with related but distinct motifs (<xref ref-type="fig" rid="F7">Figure 7A</xref>), corresponding to homologous C2H2-zf domain arrays containing fingers 6-13, 12-16, and 18-22 (<xref ref-type="fig" rid="F7">Figure 7B</xref>). The distinct sequence preferences of the duplicated ZNF721 arrays are supported by experimental data for partial “DBD1” and “DBD2” constructs, corresponding roughly to the first and second half of the full array, which recognize largely distinct subsets of the genomic sites bound by full length TF in GHT-SELEX (<xref ref-type="fig" rid="F7">Figure 7A</xref>) and prefer almost entirely distinct 10-mers in HT-SELEX (<xref ref-type="fig" rid="F7">Figure 7C</xref>). The function of ZNF721 has not been determined, but sequences recognized by the first (6-13) and third (18-22) duplicated C2H2-zf domain arrays of ZNF721 are found in the highly numerous Alpha repeats, which are fast-evolving elements found at primate centromeres<sup><xref ref-type="bibr" rid="R50">50</xref></sup>. ZNF721 itself is present only in primates. ZNF721 also binds thousands of unique loci outside known repeat elements, and associates physically with TRIM28/KAP1<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, suggesting a role in gene silencing or heterochromatin formation.</p><p id="P25">To survey the prevalence of internal duplication of C2H2-zf domains, we compared all pairs of individual human C2H2-zf domains occurring in the same protein and found that 185 human C2H2-zf proteins (~25%) contain at least one pair of C2H2-zf domains that differ by 3 or fewer edits (substitutions, deletions or insertions; <xref ref-type="supplementary-material" rid="SD8">Table S6</xref>), suggesting that they are derived from recent duplications. Furthermore, as in ZNF775 and ZNF721, there are 140 proteins with apparent internal C2H2-zf domain array duplications, defined as two (or more) adjacent C2H2-zf domains (i.e. an array) related to a second such array with two (or more) C2H2-zf domains, with 5 or fewer edits per C2H2-zf domain. Based on recognition code predictions, C2H2-zf domain arrays within internal array duplications have more diverged sequence specificities from each other than individually duplicated C2H2-zf domains (<xref ref-type="fig" rid="F7">Figure 7D</xref>, <xref ref-type="supplementary-material" rid="SD8">Table S6</xref>). The prevalence and diversification of internal C2H2-zf domain array duplications suggest that they are a common modality for evolution of novel functional roles for this large class of proteins.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P26">GHT-SELEX assays direct and unassisted binding of a single TFs to the unmodified and unchromatinized genome <italic>in vitro,</italic> revealing surprisingly specific intrinsic sequence preferences for many human TFs. The assay, and the associated MAGIX analysis pipeline, offers several technical advantages over alternatives, including smaller fragment size and compatibility with the same instrumentation used for HT-SELEX. GHT-SELEX data are often more similar to ChIP-seq data than conventional wisdom would suggest it should be<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>, indicating that, for an apparently large subset of TFs, chromatin and cofactors have less critical influence on where binding occurs. This same observation implies that this subset of individual TFs may have greater ability to overcome the chromatin state than is commonly believed. This apparent discrepancy with expectation can be explained partly by technical shortcomings in previous PWM-based genome scans, which are based on PWMs derived from other methods. HT-SELEX and other <italic>in vitro</italic> approaches utilizing random sequence are powerful in that they are unbiased in terms of sequence composition<sup><xref ref-type="bibr" rid="R52">52</xref></sup>, but they are inherently limited in sequence length and context that can be surveyed. ChIP-seq is invaluable because it can assay binding within cells, but it does not inherently discern direct, indirect, and non-specific binding. Thus, PWMs derived from ChIP-seq and other <italic>in vivo</italic> approaches are influenced by factors other than the TF, in addition to the biased sequence content of the genome. GHT-SELEX provides a powerful intermediate that can resolve ambiguities of both motif discovery and PWM scanning, and thus provides data that complements both ChIP-seq and <italic>in vitro</italic> assays that utilize random sequences.</p><p id="P27">GHT-SELEX is particularly effective with C2H2-zf proteins, and, together with RCADEEM, has an unprecedented ability to both obtain and dissect <italic>in vitro</italic> the multiple binding modes that are uniquely characteristic of this family, and inherently more difficult to represent as a single PWM. The existence of multiple binding modes also provides a potential explanation for the large number of C2H2-zf domains in each protein. In at least some cases, these large arrays derive from internal duplications of segments of the C2H2-zf domain arrays, possibly facilitating generation of evolutionary novelty via duplication and divergence.</p><p id="P28">In contrast to the C2H2-zf family, the most well-studied TFs tend to be in the TF classes such as homeodomain, bHLH, bZIP, nuclear receptor and Sox TFs, because they are the most strongly conserved and often dictate specific biological processes (e.g. morphogenesis, body plan, lineage specification, etc.)<sup><xref ref-type="bibr" rid="R24">24</xref></sup>. Our study included some of these TFs (e.g. LEUTX, BATF2, RARA and SRY), and they displayed only limited overlap between GHT-SELEX and ChIP-seq peaks, indicating that many of them cannot independently specify <italic>in vivo</italic> binding locations and hence target genes. It has long been known that TFs controlling chromatin in yeast are largely distinct from those that regulate specific pathways<sup><xref ref-type="bibr" rid="R24">24</xref></sup>; we speculate that a similar division may exist in human and other animals.</p><p id="P29">GHT-SELEX data, together with the larger Codebook dataset, provides an extensive new dataset of TF motifs (i.e. PWMs), encompassing most putative TFs currently lacking them. Accompanying papers provide a thorough analysis of the results of this project, which underscore many challenges and benefits of accurate motif representations. Representation of TF sequence specificity remains an open challenge, more than four decades after the introduction of the standard PWM model<sup><xref ref-type="bibr" rid="R53">53</xref></sup>. More accurate representations of large and complex binding sites, in particular for C2H2-zf proteins, could be useful for a variety of purposes, including attributing deep learning filters to individual TFs. Finally, we propose that obtaining data from GHT-SELEX for additional TFs with “known” motifs and genomic binding sites from ChIP-seq will produce a more detailed view of their intrinsic DNA binding abilities, and how this intrinsic ability dictates TF-genome interactions in living cells.</p></sec><sec id="S10" sec-type="methods"><title>Methods</title><sec id="S11"><title>TFs and constructs</title><p id="P30">Selection of TFs, design of constructs for gene synthesis, and expression vectors are described in accompanying study<sup><xref ref-type="bibr" rid="R37">37</xref></sup>. Sequences and other information are available as described below in <xref ref-type="sec" rid="S25">Data Availability</xref>.</p></sec><sec id="S12"><title>Protein production</title><p id="P31">We used three protein expression systems, which we refer to in <xref ref-type="supplementary-material" rid="SD3">Table S1</xref> and below as <italic>Lysate, IVT,</italic> and <italic>eGFP-IVT,</italic> respectively. The <italic>Lysate</italic> system employed recombinant HEK293 cells, created in the accompanying study<sup><xref ref-type="bibr" rid="R41">41</xref></sup>, and in a previous study<sup><xref ref-type="bibr" rid="R42">42</xref></sup>, which express eGFP-tagged full-length proteins from a Tet-inducible promoter (plasmid backbones pTH13195<sup><xref ref-type="bibr" rid="R42">42</xref></sup> and pTH12027). We induced expression by Doxycycline treatment for 24 hours prior to harvest, confirmed via fluorescent microscopy. Whole cell lysates were then harvested from a 10cm plate (~10 million cells) for each line using 1 ml of lysis buffer (50 mM Tris-Cl at pH 7.4 containing 150 mM NaCl and 1% Triton X-100), supplemented with protease-inhibitor cocktail (Roche cOmplete mini, 04693159001), as described previously<sup><xref ref-type="bibr" rid="R32">32</xref></sup>. Each of the SELEX cycles used 50 ul of lysate. <italic>IVT</italic> used an <italic>in vitro</italic> transcription-translation reaction (PURExpress In Vitro Protein Synthesis Kit, NEB, Cat# E6800L) to express T7-driven, GST-tagged proteins (either full-length or DBDs) (plasmid backbone pTH6838<sup><xref ref-type="bibr" rid="R45">45</xref></sup>). <italic>eGFP-IVT</italic> employs the TNT SP6 High-Yield Wheat Germ Protein Expression System (Promega, Cat# L3260) to express SP6-driven, eGFP-tagged proteins (either full-length or DBDs) (plasmid backbone pTH16505, an SP6-promoter driven, N-terminal eGFP-tagged bacterial expression vector, modified from pF3A–eGFP <sup><xref ref-type="bibr" rid="R39">39</xref></sup> to contain AscI and SbfI restriction sites after the eGFP. For <italic>IVT</italic> and <italic>eGFP-IVT</italic> production systems, we performed reactions according to kit instructions, but using a smaller volume: 7.5ul of <italic>IVT</italic> or 5ul of <italic>eGFP-IVT</italic> reaction sample was used in each binding reaction of each SELEX cycle.</p></sec><sec id="S13"><title>GHT-SELEX and HT-SELEX library preparation</title><p id="P32">We fragmented HEK293 genomic DNA (Genscript, USA; Cat. No. M00094) for 45 minutes using NEBNext dsDNA Fragmentase enzyme mix (NEB, M0348S), and then performed a size selection step to reduce the amounts of fragments larger than 200 bp. In the size selection we added 0.9X volume of bead suspension (magnetic SPRI beads, supplied with the kit, NEB, E7103S) to the fragmented DNA, mixed the reaction for a minute, and then removed the large DNA fragment bound beads with a magnet, after which we diluted the supernatant 5X with water, followed by purification with a PCR purification kit (NEB, T1030S), to recover fragments as small as 25 bp. Next the fragments were converted to an Illumina sequencing compatible library using NEBNext® Ultra™ II DNA Library Prep kit (NEB: E7103S) and NEB E7350 adapters. After adapter ligation, we purified the library with PCR purification kit (NEB, T1030S) and then amplified it for five PCR cycles to convert the partially single stranded adapter flanks to fully double stranded DNA, to increase the amount of the product and reduce the amount of methylated cytosine residues in the initial library. The ninety-six (96) HT-SELEX ligands were prepared as described<sup><xref ref-type="bibr" rid="R54">54</xref></sup>, with the exception that the reverse primer was replaced with a primer (5’ CTGGAGTTCAGACGTGTGCTCTTCCGATCT 3’), that does not contain a T7 promoter sequence, and that HT-SELEX ligands differ from each other by containing a well-specific variable region that flanks the randomized 40 bases indicated in the name of the experiments (e.g. AA40NCCAGTG contains 40-bases flanked by AA and CCAGTG sequences and Illumina adapter sequences). All primers and library preparation schemes are given in <xref ref-type="supplementary-material" rid="SD3">Table S1</xref>.</p></sec><sec id="S14"><title>HT-SELEX and GHT-SELEX</title><p id="P33">We modified protocols from a previously-described HT-SELEX procedure<sup><xref ref-type="bibr" rid="R32">32</xref></sup>. HT-SELEX and the GHT-SELEX ligands contain the same flanking constant regions and thus there were no differences in the selections or sequencing library preparations. We conducted the magnetic bead washing operations below using a Biotek 405TS plate washer fitted with a magnetic carrier. We performed 21 different batches of SELEX, which varied in some technical respects in order to accommodate the three protein production systems and to implement improvements developed during the study (See <xref ref-type="supplementary-material" rid="SD4">Table S2</xref> for description of conditions used in each experimental batch). Protein immobilization was carried out in buffers based either on Lysis buffer (150 mM NaCl and 1% Triton X100 in Tris-Cl, pH 8) or Low stringency binding buffer (LSBB)(140 mM KCl, 5 mM NaCl, 1 mM K2HPO4, 2 mM MgSO4, 100 μM EGTA, 1 mM ZnSO4 and 0.1% Tween20 in 20 mM HEPES-HCl (pH 7). All DNA-protein reactions used LSBB. For GST-tagged proteins, we used glutathione magnetic beads (Sigma-Aldrich G0924-1ML), and for GFP-protein immobilization, we used GFP-Trap Magnetic Agarose” (Chromotek, gtma-100) for initial batches, and Anti-GFP antibody (ab290, Abcam) immobilized to Protein G Mag Sepharose® Xtra (Cytiva, 28-9670-70) for later batches, as the latter showed higher success rate. All selections used 1μl of the magnetic bead slurry, a volume that in majority of the cases, according to manufacturers’ information, contains excess protein binding capacity but is still visible in microwell plates allowing quality control of the washing steps.</p><sec id="S15"><title>SELEX process</title><p id="P34">All of the protocols (described in <xref ref-type="supplementary-material" rid="SD4">Table S2</xref>) followed these general steps: 1) Affinity beads and 96-well plates were blocked with BSA for 15 minutes; 2) Beads and plates were washed to remove unbound BSA; 3) Protein was immobilized into beads for 1h on a shaker; 4) Beads were washed to remove nonspecific proteins and carryover DNA; 5) Protein coated beads were incubated with DNA ligand for 1h to allow the proteins to bind their target sites; 6) Unbound and weakly bound DNA ligands were removed with extensive washing; 7) DNA ligands were eluted by suspending the beads into heat elution buffer (0.4 μM forward and reverse primers, 1 mM EDTA and 1% Tween 20 in 10 mM Tris-Cl, pH 8) transferring the suspension into a conical PCR plate and heat treating it in a PCR machine using a program that cycled between temperatures of 98 and 60°C, in order to denature the proteins and DNA, use convection to drive the DNA into the solution, and to hybridize DNA to the amplification primers; 8) Bead suspension obtained from heat elution was used as template in PCR and qPCR reactions; 9) An additional DNA amplification cycle was performed with 2X more primers and dNTPs to ensure that majority of the ligands are in fully double-stranded state and 10) For batches YWO through YWS, we performed an additional step in which the double-stranded ligands were treated with mung bean nuclease to digest single stranded DNA such as primers or unpaired bases within selection ligands. In each mung bean nuclease reaction, the pH of the solution (PCR reaction) was first lowered by addition of 1:10 volume of 100 mM acetic acid, followed by addition of 1ul (0.75 units) of the enzyme and incubation for one hour at 37°C.</p></sec></sec><sec id="S16"><title>Sequencing</title><p id="P35">Samples were prepared for sequencing by performing a PCR reaction that indexes each sample and its selection cycle with a unique combination of i7 and i5 barcodes, followed by a double stranding reaction with primers that target regions of DNA outside indices (<xref ref-type="supplementary-material" rid="SD3">Table S1</xref>). Following this step, DNA libraries were pooled, purified with a PCR purification kit (NEB, T1030S), and then subjected to Illumina sequencing with 60bp reads at 3M reads per sample (Donnelly Centre sequencing core facility).</p></sec><sec id="S17"><title>HT- and GHT-SELEX read processing and mapping</title><p id="P36">HT-SELEX reads were filtered by Phred quality score (Q &gt;= 30 in at least 90% of bases). GHT-SELEX reads were parsed with Trimmomatic<sup><xref ref-type="bibr" rid="R55">55</xref></sup> to remove the constant regions from genomic fragments that were shorter than the sequencing read length (options: ILLUMINACLIP:CustomAdapters.fa:2:5:5, LEADING:3, TRAILING:3 MINLEN:25). The custom adapters in the fasta file were AGATCGGAAGAGCACACGTCTGAACTCCAG and AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTTA. For GHT-SELEX, we mapped trimmed reads to the human genome build hg38 with bowtie2 (options: --very- sensitive, --no-unal). The mapped reads were further filtered using Samtools (options: - F 1548, version 1.20)<sup><xref ref-type="bibr" rid="R56">56</xref></sup>.</p></sec><sec id="S18"><title>MAGIX statistical framework</title><p id="P37">At the core of MAGIX is a generative model that explicitly connects the enrichment of TF-bound genomic intervals to the fragment counts observed across GHT-SELEX cycles. MAGIX, models how TF-bound intervals progressively occupy a higher proportion of selected fragments pool in each cycle relative to genomic background. These fragment proportions, in turn, are treated as latent variables in the model that, together with a sample-specific library size factor, determine the number of observed reads through a Poisson process. Consider the genomic interval <italic>j</italic>∈[1,<italic>G</italic>], where <italic>G</italic> is the total number of unique genomic intervals that we are modeling. Assume that fragments originating from interval <italic>j</italic> have a starting abundance of <italic>a<sub>j</sub></italic> in the library. We also assume an exponential enrichment for the fragments, that in each cycle of SELEX, the abundance of these fragments changes by a factor of <italic>e<sup>bj</sup></italic>, where <italic>b<sub>j</sub></italic> is the log fold-change in abundance per cycle (referred to as <italic>enrichment coefficient</italic>), conceptually associated with biophysical parameters such as binding energies. Therefore, at cycle <italic>t</italic>, the abundance of the fragment originating from interval <italic>j</italic> is given by: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P38">For convenience, we work with the logarithm of abundance, <italic>y<sub>j</sub></italic>=log <italic>f<sub>j</sub></italic>, transforming the exponential equation above to a linear equation as follows: <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> which can be seen as the linear multiplication of a feature vector <inline-formula><mml:math id="M3"><mml:mrow><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.2em"/><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> [for all the samples <italic>i</italic> (and across different cycles) corresponding to the TF of interest, and the interval-specific parameters <inline-formula><mml:math id="M4"><mml:mrow><mml:mrow><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p id="P39">We note that to accurately model the enrichment of each fragment per cycle, other factors also need to be taken into consideration, such as background or batch effects, and therefore, the linear equation above needs to be fitted not only to the samples that correspond to the TF of interest, but also samples from other experiments. We embed these dependencies in a design matrix <italic><bold>X</bold></italic>∈ℝ<sup><italic>N×K</italic></sup>, where <italic>N</italic> is the total number of samples and <italic>K</italic> is the number of variables to consider, including an intercept term (whose coefficient will correspond to log <italic>a<sub>j</sub></italic> above), a term for the SELEX cycle <italic>t</italic> (variable for the samples corresponding to a same TF), and other terms for batch and background effects. In addition to the variables included in <italic><bold>X</bold></italic>, the abundance of each fragment in each sample depends on a sample-specific scaling factor that is often referred to as the library size. Assume that this library effect, for each sample <italic>i</italic>∈[1,<italic>N</italic>], is the scaling factor <italic>s<sub>i</sub></italic> (in logarithmic scale). Therefore: <disp-formula id="FD3"><mml:math id="M5"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>y</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext>y</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula> Here, <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> corresponds to the expected logarithm of the abundance of interval <italic>j</italic> in sample <italic>i</italic>, <bold>x</bold><sub><italic>i</italic></sub>∈ℝ<italic><sup>K</sup></italic> is a vector representing the <italic>i</italic>’th row of the design matrix <bold>X</bold> (i.e., the sample-level variables for sample <italic>i</italic>), and <bold>β</bold><sub>j</sub>∈ℝ<sup><italic>K</italic></sup> is an interval-specific vector of coefficients for the <italic>K</italic> variables included in the model.</p><p id="P40">We note that the equation above does not have a unique solution. For example, any Δ<bold>β</bold> can be added to <bold>β</bold><sub><italic>j</italic></sub>, followed by subtraction of <bold>XΔβ</bold> from <bold>s</bold>, without any change in <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mstyle><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: <disp-formula id="FD4"><mml:math id="M8"><mml:mrow><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">s</mml:mtext></mml:mstyle><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi>Δ</mml:mi><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P41">Therefore, to make the model identifiable, we limit <bold>β</bold><sub><italic>j</italic></sub> so that Σ<sub><italic>j</italic>∈[1,<italic>G</italic>]</sub><bold>β</bold><sub><italic>j</italic></sub>=<bold>0</bold>, where <bold>0</bold> is the zero vector of length <italic>K.</italic> This constraint is also useful since it means that, across all <italic>G</italic> intervals, the mean of each coefficient in <inline-formula><mml:math id="M9"><mml:mrow><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle></mml:mrow></mml:math></inline-formula>, including the coefficient for the SELEX cycle, is zero; in other words, the enrichment per cycle for each interval is calculated relative to the mean of all <italic>G</italic> intervals.</p><p id="P42">To incorporate the experimental noise in the logarithm of the abundance of interval <italic>j</italic> in sample <italic>i</italic> (i.e. building the real distribution of <italic>y<sub>ij</sub></italic>), we modeled it as a Gaussian random variable whose mean is given by <inline-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (the linear model above) with a sample-specific variance <inline-formula><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>: <disp-formula id="FD5"><mml:math id="M12"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P43">To complete the Bayesian framework, we also assume a multivariate Gaussian prior for <bold>β</bold><sub><italic>j</italic></sub>: <disp-formula id="FD6"><mml:math id="M13"><mml:mrow><mml:mrow><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi>𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mn mathvariant="bold">0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mstyle><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P44">Here, <bold>Σ</bold>, the covariance matrix of the prior distribution, is shared across all intervals. Altogether, the equations above form the following Bayesian model: <disp-formula id="FD7"><mml:math id="M14"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi>𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mn mathvariant="bold">0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mtext>U</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>~</mml:mo><mml:mtext>U</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P45">Assuming that the values for <italic>y<sub>ij</sub></italic> are directly observed, we can obtain the maximum a posteriori (MAP) estimates of the parameters <bold>β</bold><sub><italic>j</italic></sub> (for <italic>j</italic>∈[1,<italic>G</italic>]), <bold>s</bold>, and <inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (for <italic>i</italic>∈[1, <italic>N</italic>]) through a block coordinate descent algorithm, as previously described<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.</p><p id="P46">The prior covariance matrix <bold>Σ</bold> is a hyper-parameter that is obtained using an empirical Bayes approach. More specifically, we first obtain the maximum likelihood estimate (MLE) of the parameters <bold>β</bold><sub><italic>j</italic></sub>, <italic>s<sub>i</sub></italic>, and <inline-formula><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> without assuming any prior on <bold>β</bold><sub><italic>j</italic></sub>, and then estimate the values of <italic>σ</italic><sub><italic>βk</italic></sub><sup>2</sup>, the variance of each element <italic>k</italic> in <bold>β</bold><sub><italic>j</italic></sub>, using the MLE solutions of all <bold>β</bold><sub><italic>j</italic></sub> coefficients. The covariance matrix <bold>Σ</bold> is then constructed as <bold>Σ</bold>=diag(<italic>σ</italic><sub><italic>β</italic>1</sub><sup>2</sup>,..., <italic>σ</italic><sub><italic>βK</italic></sub><sup>2</sup>).</p><p id="P47">We note, however, that the log-abundance values <italic>y<sub>ij</sub></italic>‘s are not directly observable in GHT-SELEX data. Instead, we observe <italic>m<sub>ij</sub></italic>, the count of reads mapping to interval <italic>j</italic> in sample <italic>i</italic> (see <bold>HT- and GHT-SELEX read processing and mapping</bold>). This parameter adds another step to the framework, leading to the following hierarchical Bayesian model: <disp-formula id="FD8"><mml:math id="M17"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:mn mathvariant="bold">0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mtext>U</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>~</mml:mo><mml:mtext>U</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">β</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>~</mml:mo><mml:mi>𝒩</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P48">Here, <italic>y</italic><sup>*</sup><sub><italic>ij</italic></sub> is the logarithm of the true abundance of fragment <italic>j</italic> in sample <italic>i,</italic> which is latent. We obtain the MAP estimates of the parameters <bold>β</bold><sub><italic>j</italic></sub> (for <italic>j</italic>∈[1,<italic>G</italic>]), <italic>s<sub>i</sub></italic>, and <inline-formula><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (for <italic>i</italic>∈[1,<italic>N</italic>|) using an expectation maximization (EM) algorithm, in which at each E-step we obtain the expected value of each <italic>y</italic>*<sub><italic>ij</italic></sub> given the observed read count <italic>m<sub>ij</sub></italic> and the current model parameters, followed by re-estimation of the model parameters in the M-step, similar to a previous method established for EM optimization of Poisson-lognormal models<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.</p></sec><sec id="S19"><title>Identifying GHT-SELEX peaks with MAGIX</title><p id="P49">The statistical framework described above calculates, for each genomic interval, the rate of enrichment across GHT-SELEX cycles. To identify GHT-SELEX peaks, we used this framework along with the procedure described below to systematically examine all genomic intervals and identify regions with the highest signal (peaks). First, we binned the entire human genome (build hg38) into ~13M non-overlapping intervals of 200 bp and then, for each TF, calculated the read count profiles of these intervals across the GHT-SELEX cycles and replicates. Counts were obtained using bedtools multicov (version 2.30.0)<sup><xref ref-type="bibr" rid="R57">57</xref></sup>. These read count profiles were used as the input to MAGIX to obtain an enrichment coefficient for each 200 bp interval (while controlling for batch effects by including batch-specific pooled controls and variables in the design matrix). Next, the top 200,000 regions with the highest enrichment coefficients were selected as candidate intervals for peak refinement.</p><p id="P50">To refine the peak coordinates, we first merged any adjacent candidate intervals, and then calculated the base pair-resolution read count coverage profile across each merged interval (and sum of all GHT-SELEX cycles). The position with the highest read coverage was selected as the candidate peak summit. The read counts overlapping the ±100 bp around the summits were computed, which were used as input to the MAGIX statistical inference component (above) to recalculate enrichment coefficients, while reusing the library sizes and the empirical hyperparameters estimated from the analysis of all 13M genomic intervals, without re-optimization. For each candidate peak, we also calculated a P-value, representing the statistical significance of the enrichment coefficient (null hypothesis is that the enrichment coefficient is zero). To do so, we obtained maximum likelihood estimate of the model coefficients for each coefficient (i.e., ignoring the prior distributions), and performed a likelihood ratio test (LRT) against a reduced model in which the enrichment coefficient was restricted to zero.</p><p id="P51">To calculate empirical FDRs for the peaks, we first obtained negative peaks by repeating the procedure described above but inverting the cycle labels. In other words, we obtained depleted peaks, relative to the pool, instead of enriched peaks. Then, we calculate the FDR as the fraction of depleted peaks relative to enriched peaks for each coefficient value. The source code for MAGIX is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/csglab/MAGIX">https://github.com/csglab/MAGIX</ext-link>.</p></sec><sec id="S20"><title>Selection of thresholds for peak sets</title><p id="P52">We sorted the GHT-SELEX peaks by their MAGIX score (enrichment coefficient, or as named in the peaks BED files, <italic>coefficient.br,</italic> which estimates cycle enrichment). Similarly, we sorted the merged ChIP-seq peaks by P-value. Then, for different values of N (between 100 and the total number of peaks), we took the top N peaks for both peaks sets and calculated the Jaccard index (= O/(2N-O), in which O is the intersection of peaks). To eliminate the error in the cases when one peak in a set overlaps with multiple peaks in another set, we used the average of the overlaps for the intersection (i.e. O=(O1+O2)/2, in which O1 is the number of peaks in set1 overlapping with any peaks in the set2 and vice versa). The value of N that yielded the maximum Jaccard value was identified, and the threshold for each peak set taken as that which yielded this maximum N. The same process was applied to compare PWM-predicted binding sites and ChIP-seq peaks.</p></sec><sec id="S21"><title>Comparing PWM scoring methods</title><p id="P53">To create <italic>in silico</italic> predicted binding sites for a TF, we first scanned the genome using the generated PWM (see the Codebook overview manuscript for the details on PWM selection), using MOODS<sup><xref ref-type="bibr" rid="R58">58</xref></sup> with a p-value threshold of 0.0001. We then merged the clusters of PWM hits with a distance less than 200bp between neighboring hits, since this is the median length of ChIP-seq fragments, and the task is predicting in vivo binding sites; this length is also consistent with the MAGIX bin size. Singleton PWM hits and boundary hits were also expanded to have a width of at least 200bp. The clusters of PWM hits were re-scored using sum-of-affinity (i.e. with PWM log-odds scores at each base converted to linear/probability space, prior to calculation of the sum) and maximum-affinity methods, by either applying a sum or maximum, respectively, over the PWM scores of the cluster members. The resulting sites were sorted by their new score and processed through the same optimization procedure described above for peaks, to maximize their overlap with ChIP-seq peaks.</p></sec><sec id="S22"><title>Modeling alternative C2H2-zf binding modes with RCADEEM</title><p id="P54">RCADEEM uses a hidden Markov model (HMM) to represent multiple, alternative DNA-binding motifs, each corresponding to the binding preference of a C2H2-zf array. Briefly, the DNA sequences (e.g., GHT-SELEX peaks) are modeled as sequences generated from a discrete Markov process with hidden states that include a background state (<italic>S</italic><sub>0</sub>) and <italic>M</italic> motif states <italic>S<sub>m</sub></italic> (<italic>m</italic>∈[1,<italic>M</italic>]). The background state, with marginal probability π<sub>0</sub>, emits each nucleotide <italic>n</italic> with probability <italic>b</italic><sub>0</sub>(<italic>n</italic>) (Σ<sub>n</sub><italic>b</italic><sub>0</sub>(<italic>n</italic>)=1). The background state can transition to itself (i.e., consecutive DNA nucleotides can be generated from the background state) with probability <italic>a</italic><sub>0,0</sub>, or to each motif state <italic>S<sub>m</sub></italic> (<italic>m</italic>∈[1,<italic>M</italic>]) with probability <italic>a</italic><sub>0,<italic>m</italic></sub> (<italic>a</italic><sub>0,0</sub>+Σ<sub>m</sub><italic>a</italic><sub>0,<italic>m</italic></sub>=1). Each motif <italic>m</italic>, with marginal probability π<sub><italic>m</italic></sub>, generates a sequence of length <italic>l<sub>m</sub></italic>, with each nucleotide <italic>n</italic> at position <italic>i</italic> emitted with probability <italic>b<sub>m,i</sub></italic>(<italic>n</italic>) (Σ<sub>n</sub><italic>b<sub>m,i</sub></italic>(<italic>n</italic>)=1 ∀<italic>m</italic>∈[1,<italic>M</italic>], <italic>i</italic>∈[1,<italic>I<sub>m</sub></italic>]). Note that, for each <italic>m</italic>∈[1,<italic>M</italic>], the values <italic>b<sub>m,i</sub></italic>(<italic>n</italic>) form a position-specific frequency matrix (PFM, i.e. the exponential of the classical log-odds PWM) with width <italic>l<sub>m</sub></italic>, which is fixed to be 3 times the number of zinc finger domains in the array represented by motif <italic>m</italic>, as each zinc finger domain binds to three nucleotides. Finally, each motif state <italic>S<sub>m</sub></italic> transitions to the background state with probability <italic>a</italic><sub>m,0</sub>=1.</p><p id="P55">We start the model by including the motifs representing all possible consecutive zinc finger domain arrays<sup><xref ref-type="bibr" rid="R50">50</xref></sup>. We initialize the emission probabilities <italic>b<sub>m,i</sub></italic>(<italic>n</italic>) for each motif <italic>m</italic> using the PFM predicted for the associated zinc finger array by a previously created C2H2-zf recognition code<sup><xref ref-type="bibr" rid="R51">51</xref></sup>—this recognition code is a machine learning model that, given the sequence of a zinc finger array, predicts the expected binding preference. The HMM parameters, including all marginal state probabilities, state transition probabilities, and emission probabilities are then optimized via expectation maximization using Baum–Welch algorithm. Then, each of the optimized PFMs are tested for (i) enrichment of the motif in actual sequences compared to dinucleotide-shuffled sequences, and <italic>(ii)</italic> similarity to the original recognition code-predicted PFM. To achieve (<italic>i</italic>), for each position <italic>x</italic> in each DNA sequence <italic>k</italic>, we calculate <italic>γ<sub>k,x</sub></italic>(<italic>S<sub>m</sub></italic>), the probability that it was generated from motif state <italic>S<sub>m</sub></italic>, using the forward-backward algorithm. The motif score for DNA sequence <italic>k</italic> is then calculated as Σ<sub><italic>x</italic></sub><italic>γ<sub>k,x</sub></italic>(<italic>S<sub>m</sub></italic>)/<italic>l<sub>m</sub></italic>, representing the expected number of times the state <italic>S<sub>m</sub></italic> is seen in sequence <italic>k</italic>. For each motif <italic>m</italic>, these scores are calculated both for actual GHT-SELEX peak sequences and their dinucleotide-shuffled version. Then, the top 100 sequences with the largest scores for each motif are tested to see whether they are enriched in the motif compared to shuffled sequences (Fisher’s exact test, FDR≤0.01). Motifs that do not pass this cutoff are removed from the model. To achieve (<italic>ii</italic>), each HMM-optimized PFM is first converted to log-scale (representing a PWM), followed by calculation of Pearson correlation of the PWM entries with those predicted by the recognition code. Pearson correlations are then converted using Fisher transformation in order to calculate a P-value, followed by removal of motifs that do not pass the FDR cut-off ≤0.01. The remaining motifs are then used to reconstruct a smaller HMM, similar to the procedure described above, followed by another round of EM optimization. This procedure is repeated until all motifs pass the cut-offs for enrichment in GHT-SELEX sequences while maintaining significant similarity to the original recognition code-predicted sequences.</p><p id="P56">To visualize the binding modes predicted by RCADEEM, the resulting PWMs are used to identify their best match in each of the input sequences using AffiMx<sup><xref ref-type="bibr" rid="R52">52</xref></sup>. Then, for each sequence, the PWM with the highest weighted HMM score on the best match is kept as the predicted binding mode. To align the sequences, offsets are calculated based on the corresponding C2H2-zf domains (<xref ref-type="fig" rid="F6">Figures 6A-F</xref>). C2H2-zf proteins were categorized based on their alternative usage of C2H2-zf domains (i.e., Multiple DBDs, Finger shift, Canonical, and Core with extensions; <xref ref-type="fig" rid="F6">Figure 6</xref>) through an expert-curated evaluation (<xref ref-type="supplementary-material" rid="SD7">Table S5</xref>). To make a motif model for each binding mode, we manually selected representative peaks corresponding to each biding mode over the 2000 GHT-SELEX peaks with the highest enrichment coefficient. The sequence (already aligned by RCADEEM) and C2H2-zf domain array coordinates of these peaks were used to create PFMs. The resulting PFMs for those C2H2-zf TFs are available in <xref ref-type="supplementary-material" rid="SD2">Document S2</xref> and online at <ext-link ext-link-type="uri" xlink:href="https://cisbp.ccbr.utoronto.ca">https://cisbp.ccbr.utoronto.ca</ext-link><sup><xref ref-type="bibr" rid="R45">45</xref></sup>. The logos, coordinates, selected sequences, annotated sequence heatmaps, and associated metadata are available online at <ext-link ext-link-type="uri" xlink:href="https://codebook.ccbr.utoronto.ca">https://codebook.ccbr.utoronto.ca</ext-link>. The source code for RCADEEM is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/csglab/RCADEEM">https://github.com/csglab/RCADEEM</ext-link>.</p></sec><sec id="S23"><title>Comparison of C2H2 DBDs</title><p id="P57">C2H2 DBD similarities were compared by pairwise alignment with Needleman-Wunsch algorithm, as implemented in R-package Biostrings and counting substitutions, insertions and unmatched flanking bases as edits. DNA-binding functionality scores and predicted motif similarity for the DBDs were analyzed as described previously<sup><xref ref-type="bibr" rid="R59">59</xref></sup>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Document S1</label><media xlink:href="EMS200046-supplement-Supplementary_Document_S1.pdf" mimetype="application" mime-subtype="pdf" id="d5aAcEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Document S2</label><media xlink:href="EMS200046-supplement-Supplementary_Document_S2.gz" mimetype="application" mime-subtype="gzip" id="d5aAcEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Table S1</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplementary Table S2</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary Table S3</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S3.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEfB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>Supplementary Table S4</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S4.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEgB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>Supplementary Table S5</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S5.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEhB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD8"><label>Supplementary Table S6</label><media xlink:href="EMS200046-supplement-Supplementary_Table_S6.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d5aAcEiB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD9"><label>Supplementary Tables and Documents</label><media xlink:href="EMS200046-supplement-Supplementary_Tables_and_Documents.pdf" mimetype="application" mime-subtype="pdf" id="d5aAcEjB" position="anchor"/></supplementary-material></sec></body><back><ack id="S24"><title>Acknowledgements</title><p>We thank the IT Group of the Institute of Computer Science at Halle University for computational resources, Maximilian Biermann for valuable technical support, Gherman Novakovsky for providing feedback, Berat Dogan for testing earlier versions of RCADEEM, and Debashish Ray for assistance with database depositions.</p><p>This work was supported by the following: <list list-type="bullet" id="L3"><list-item><p>Canadian Institutes of Health Research (CIHR) grants FDN-148403, PJT-186136, PJT-191768, and PJT-191802, and NIH grant R21HG012258 to T.R.H.</p></list-item><list-item><p>CIHR grant PJT-191802 to T.R.H. and H.S.N.</p></list-item><list-item><p>Natural Sciences and Engineering Research Council of Canada (NSERC) grant RGPIN-2018-05962 to H.S.N.</p></list-item><list-item><p>Russian Science Foundation grant 20-74-10075 to I.V.K.</p></list-item><list-item><p>Russian Science Foundation grant 24-14-20031 to F.A.K.</p></list-item><list-item><p>Swiss National Science Foundation grant (no. 310030_197082) to B.D.</p></list-item><list-item><p>Marie Sklodowska-Curie (no. 895426) and EMBO long-term (1139-2019) fellowships to J.F.K.</p></list-item><list-item><p>NIH grants R01HG013328 and U24HG013078 to M.T.W., T.R.H., and Q.M.</p></list-item><list-item><p>NIH grants R01AR073228, P30AR070549, and R01AI173314 to M.T.W.</p></list-item><list-item><p>NIH grant P30CA008748 partially supported Q.M.</p></list-item><list-item><p>Canada Research Chairs funded by CIHR to T.R.H. and H.S.N.</p></list-item><list-item><p>Ontario Graduate Scholarships to K.U.L and I.Y.</p></list-item><list-item><p>A.J. was supported by Vetenskapsrådet (Swedish Research Council) Postdoctoral Fellowship (2016-00158)</p></list-item><list-item><p>The Billes Chair of Medical Research at the University of Toronto to T.R.H.</p></list-item><list-item><p>EPFL Center for Imaging</p></list-item><list-item><p>Institutional funding from EPFL</p></list-item><list-item><p>Resource allocations from the Digital Research Alliance of Canada</p></list-item></list></p></ack><sec id="S25" sec-type="data-availability"><title>Data Availability</title><p id="P58">The sequencing raw data for the HT-SELEX and GHT-SELEX experiments have been deposited into the SRA database under identifiers PRJEB61115 (HT-SELEX) and PRJEB76622 (GHT-SELEX). Additionally, genomic interval information generated for the GHT-SELEX, has been deposited into GEO under accession GSE278858. The entire Codebook data structure, with many accessory files and browsable results at is available at <ext-link ext-link-type="uri" xlink:href="https://codebook.ccbr.utoronto.ca">https://codebook.ccbr.utoronto.ca</ext-link>. Larger collection of motifs generated for these experiments in an accompanying study<sup><xref ref-type="bibr" rid="R43">43</xref></sup> can be browsed at mex.autosome.org. Source codes for MAGIX and RCADEEM are available from Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/csglab/MAGIX">https://github.com/csglab/MAGIX</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/csglab/RCADEEM">https://github.com/csglab/RCADEEM</ext-link>).</p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name></person-group><article-title>Determining the specificity of protein-DNA interactions</article-title><source>Nat Rev Genet</source><year>2010</year><volume>11</volume><fpage>751</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">20877328</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>A</given-names></name><etal/></person-group><article-title>JASPAR 2018: update of the open-access database of transcription factor binding profiles and its web framework</article-title><source>Nucleic Acids Res</source><year>2018</year><volume>46</volume><elocation-id>D1284</elocation-id><pub-id pub-id-type="pmcid">PMC5753243</pub-id><pub-id pub-id-type="pmid">29140473</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkx1126</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernard</surname><given-names>B</given-names></name><name><surname>Thorsson</surname><given-names>V</given-names></name><name><surname>Rovira</surname><given-names>H</given-names></name><name><surname>Shmulevich</surname><given-names>I</given-names></name></person-group><article-title>Increasing coverage of transcription factor position weight matrices through domain-level homology</article-title><source>PLoS One</source><year>2012</year><volume>7</volume><elocation-id>e42779</elocation-id><pub-id pub-id-type="pmcid">PMC3428306</pub-id><pub-id pub-id-type="pmid">22952610</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0042779</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>SA</given-names></name><etal/></person-group><article-title>Similarity regression predicts evolution of transcription factor sequence specificity</article-title><source>Nat Genet</source><year>2019</year><volume>51</volume><fpage>981</fpage><lpage>989</lpage><pub-id pub-id-type="pmid">31133749</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wunderlich</surname><given-names>Z</given-names></name><name><surname>Mirny</surname><given-names>LA</given-names></name></person-group><article-title>Different gene regulation strategies revealed by analysis of binding motifs</article-title><source>Trends Genet</source><year>2009</year><volume>25</volume><fpage>434</fpage><lpage>40</lpage><pub-id pub-id-type="pmcid">PMC3697852</pub-id><pub-id pub-id-type="pmid">19815308</pub-id><pub-id pub-id-type="doi">10.1016/j.tig.2009.08.003</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>ZM</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><article-title>Global properties of regulatory sequences are predicted by transcription factor recognition mechanisms</article-title><source>Genome Biol</source><year>2021</year><volume>22</volume><fpage>285</fpage><pub-id pub-id-type="pmcid">PMC8496038</pub-id><pub-id pub-id-type="pmid">34620190</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02503-y</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name></person-group><article-title>Applied bioinformatics for the identification of regulatory elements</article-title><source>Nat Rev Genet</source><year>2004</year><volume>5</volume><fpage>276</fpage><lpage>87</lpage><pub-id pub-id-type="pmid">15131651</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valouev</surname><given-names>A</given-names></name><etal/></person-group><article-title>Genome-wide analysis of transcription factor binding sites based on ChIP-Seq data</article-title><source>Nat Methods</source><year>2008</year><volume>5</volume><fpage>829</fpage><lpage>34</lpage><pub-id pub-id-type="pmcid">PMC2917543</pub-id><pub-id pub-id-type="pmid">19160518</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.1246</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marinov</surname><given-names>GK</given-names></name><name><surname>Kundaje</surname><given-names>A</given-names></name><name><surname>Park</surname><given-names>PJ</given-names></name><name><surname>Wold</surname><given-names>BJ</given-names></name></person-group><article-title>Large-Scale Quality Analysis of Published ChIP-seq Data</article-title><source>G3 (Bethesda)</source><year>2013</year><pub-id pub-id-type="pmcid">PMC3931556</pub-id><pub-id pub-id-type="pmid">24347632</pub-id><pub-id pub-id-type="doi">10.1534/g3.113.008680</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Consortium, E.P</collab><etal/></person-group><article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title><source>Nature</source><year>2020</year><volume>583</volume><fpage>699</fpage><lpage>710</lpage><pub-id pub-id-type="pmcid">PMC7410828</pub-id><pub-id pub-id-type="pmid">32728249</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2493-4</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rhee</surname><given-names>HS</given-names></name><name><surname>Pugh</surname><given-names>BF</given-names></name></person-group><article-title>Comprehensive Genome-wide Protein-DNA Interactions Detected at Single-Nucleotide Resolution</article-title><source>Cell</source><year>2011</year><volume>147</volume><fpage>1408</fpage><lpage>19</lpage><pub-id pub-id-type="pmcid">PMC3243364</pub-id><pub-id pub-id-type="pmid">22153082</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2011.11.013</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>HK</given-names></name><name><surname>Prescott</surname><given-names>SL</given-names></name><name><surname>Wysocka</surname><given-names>J</given-names></name></person-group><article-title>Ever-Changing Landscapes: Transcriptional Enhancers in Development and Evolution</article-title><source>Cell</source><year>2016</year><volume>167</volume><fpage>1170</fpage><lpage>1187</lpage><pub-id pub-id-type="pmcid">PMC5123704</pub-id><pub-id pub-id-type="pmid">27863239</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2016.09.018</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zinzen</surname><given-names>RP</given-names></name><name><surname>Girardot</surname><given-names>C</given-names></name><name><surname>Gagneur</surname><given-names>J</given-names></name><name><surname>Braun</surname><given-names>M</given-names></name><name><surname>Furlong</surname><given-names>EE</given-names></name></person-group><article-title>Combinatorial binding predicts spatio-temporal cis-regulatory activity</article-title><source>Nature</source><year>2009</year><volume>462</volume><fpage>65</fpage><lpage>70</lpage><pub-id pub-id-type="pmid">19890324</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>TH</given-names></name><etal/></person-group><article-title>Analysis of the vertebrate insulator protein CTCF-binding sites in the human genome</article-title><source>Cell</source><year>2007</year><volume>128</volume><fpage>1231</fpage><lpage>45</lpage><pub-id pub-id-type="pmcid">PMC2572726</pub-id><pub-id pub-id-type="pmid">17382889</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2006.12.048</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Sinha</surname><given-names>M</given-names></name><name><surname>Peterson</surname><given-names>CL</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name></person-group><article-title>The insulator binding protein CTCF positions 20 nucleosomes around its binding sites across the human genome</article-title><source>PLoS Genet</source><year>2008</year><volume>4</volume><elocation-id>e1000138</elocation-id><pub-id pub-id-type="pmcid">PMC2453330</pub-id><pub-id pub-id-type="pmid">18654629</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000138</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname><given-names>M</given-names></name><etal/></person-group><article-title>Affinity-seq detects genome-wide PRDM9 binding sites and reveals the impact of prior chromatin modifications on mammalian recombination hotspot usage</article-title><source>Epigenetics Chromatin</source><year>2015</year><volume>8</volume><fpage>31</fpage><pub-id pub-id-type="pmcid">PMC4562113</pub-id><pub-id pub-id-type="pmid">26351520</pub-id><pub-id pub-id-type="doi">10.1186/s13072-015-0024-6</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgunova</surname><given-names>E</given-names></name><etal/></person-group><article-title>Two distinct DNA sequences recognized by transcription factors represent enthalpy and entropy optima</article-title><source>Elife</source><year>2018</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC5896879</pub-id><pub-id pub-id-type="pmid">29638214</pub-id><pub-id pub-id-type="doi">10.7554/eLife.32963</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><article-title>DNA binding sites: representation and discovery</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>16</fpage><lpage>23</lpage><pub-id pub-id-type="pmid">10812473</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohs</surname><given-names>R</given-names></name><etal/></person-group><article-title>The role of DNA shape in protein-DNA recognition</article-title><source>Nature</source><year>2009</year><volume>461</volume><fpage>1248</fpage><lpage>53</lpage><pub-id pub-id-type="pmcid">PMC2793086</pub-id><pub-id pub-id-type="pmid">19865164</pub-id><pub-id pub-id-type="doi">10.1038/nature08473</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Ruan</surname><given-names>S</given-names></name><name><surname>Pandey</surname><given-names>M</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><article-title>Improved models for transcription factor binding site identification using nonindependent interactions</article-title><source>Genetics</source><year>2012</year><volume>191</volume><fpage>781</fpage><lpage>90</lpage><pub-id pub-id-type="pmcid">PMC3389974</pub-id><pub-id pub-id-type="pmid">22505627</pub-id><pub-id pub-id-type="doi">10.1534/genetics.112.138685</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><etal/></person-group><article-title>DNA-dependent formation of transcription factor pairs alters their binding specificity</article-title><source>Nature</source><year>2015</year><volume>527</volume><fpage>384</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">26550823</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horton</surname><given-names>CA</given-names></name><etal/></person-group><article-title>Short tandem repeats bind transcription factors to tune eukaryotic gene expression</article-title><source>Science</source><year>2023</year><volume>381</volume><elocation-id>eadd1250</elocation-id><pub-id pub-id-type="pmid">37733848</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kribelbauer</surname><given-names>JF</given-names></name><name><surname>Rastogi</surname><given-names>C</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name></person-group><article-title>Low-Affinity Binding Sites and the Transcription Factor Specificity Paradox in Eukaryotes</article-title><source>Annu Rev Cell Dev Biol</source><year>2019</year><volume>35</volume><fpage>357</fpage><lpage>379</lpage><pub-id pub-id-type="pmcid">PMC6787930</pub-id><pub-id pub-id-type="pmid">31283382</pub-id><pub-id pub-id-type="doi">10.1146/annurev-cellbio-100617-062719</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>SA</given-names></name><etal/></person-group><article-title>The Human Transcription Factors</article-title><source>Cell</source><year>2018</year><volume>175</volume><fpage>598</fpage><lpage>599</lpage><pub-id pub-id-type="pmid">30290144</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolfe</surname><given-names>SA</given-names></name><name><surname>Nekludova</surname><given-names>L</given-names></name><name><surname>Pabo</surname><given-names>CO</given-names></name></person-group><article-title>DNA recognition by Cys2His2 zinc finger proteins</article-title><source>Annu Rev Biophys Biomol Struct</source><year>2000</year><volume>29</volume><fpage>183</fpage><lpage>212</lpage><pub-id pub-id-type="pmid">10940247</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klug</surname><given-names>A</given-names></name></person-group><article-title>The discovery of zinc fingers and their applications in gene regulation and genome manipulation</article-title><source>Annu Rev Biochem</source><year>2010</year><volume>79</volume><fpage>213</fpage><lpage>31</lpage><pub-id pub-id-type="pmid">20192761</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stubbs</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Caetano-Anolles</surname><given-names>D</given-names></name></person-group><article-title>Function and Evolution of C2H2 Zinc Finger Arrays</article-title><source>Subcell Biochem</source><year>2011</year><volume>52</volume><fpage>75</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">21557079</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakahashi</surname><given-names>H</given-names></name><etal/></person-group><article-title>A genome-wide map of CTCF multivalency redefines the CTCF code</article-title><source>Cell Rep</source><year>2013</year><volume>3</volume><fpage>1678</fpage><lpage>1689</lpage><pub-id pub-id-type="pmcid">PMC3770538</pub-id><pub-id pub-id-type="pmid">23707059</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2013.04.024</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kieffer-Kwon</surname><given-names>KR</given-names></name><etal/></person-group><article-title>Interactome maps of mouse gene regulatory domains reveal basic principles of transcriptional regulation</article-title><source>Cell</source><year>2013</year><volume>155</volume><fpage>1507</fpage><lpage>20</lpage><pub-id pub-id-type="pmcid">PMC3905448</pub-id><pub-id pub-id-type="pmid">24360274</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2013.11.039</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Najafabadi</surname><given-names>HS</given-names></name><etal/></person-group><article-title>C2H2 zinc finger proteins greatly expand the human regulatory lexicon</article-title><source>Nat Biotechnol</source><year>2015</year><pub-id pub-id-type="pmid">25690854</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Najafabadi</surname><given-names>HS</given-names></name><name><surname>Albu</surname><given-names>M</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><article-title>Identification of C2H2-ZF binding preferences from ChIP-seq data using RCADE</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>2879</fpage><lpage>81</lpage><pub-id pub-id-type="pmcid">PMC4547615</pub-id><pub-id pub-id-type="pmid">25953800</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btv284</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><etal/></person-group><article-title>Multiplexed massively parallel SELEX for characterization of human transcription factor binding specificities</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><fpage>861</fpage><lpage>73</lpage><pub-id pub-id-type="pmcid">PMC2877582</pub-id><pub-id pub-id-type="pmid">20378718</pub-id><pub-id pub-id-type="doi">10.1101/gr.100552.109</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuerk</surname><given-names>C</given-names></name><name><surname>Gold</surname><given-names>L</given-names></name></person-group><article-title>Systematic evolution of ligands by exponential enrichment: RNA ligands to bacteriophage T4 DNA polymerase</article-title><source>Science</source><year>1990</year><volume>249</volume><fpage>505</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">2200121</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Malley</surname><given-names>RC</given-names></name><etal/></person-group><article-title>Cistrome and Epicistrome Features Shape the Regulatory DNA Landscape</article-title><source>Cell</source><year>2016</year><volume>165</volume><fpage>1280</fpage><lpage>1292</lpage><pub-id pub-id-type="pmcid">PMC4907330</pub-id><pub-id pub-id-type="pmid">27203113</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2016.04.038</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>BS</given-names></name><name><surname>Shtatland</surname><given-names>T</given-names></name><name><surname>Brown</surname><given-names>D</given-names></name><name><surname>Gold</surname><given-names>L</given-names></name></person-group><article-title>Libraries for genomic SELEX</article-title><source>Nucleic Acids Res</source><year>1997</year><volume>25</volume><fpage>781</fpage><lpage>6</lpage><pub-id pub-id-type="pmcid">PMC146522</pub-id><pub-id pub-id-type="pmid">9016629</pub-id><pub-id pub-id-type="doi">10.1093/nar/25.4.781</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimmermann</surname><given-names>B</given-names></name><name><surname>Bilusic</surname><given-names>I</given-names></name><name><surname>Lorenz</surname><given-names>C</given-names></name><name><surname>Schroeder</surname><given-names>R</given-names></name></person-group><article-title>Genomic SELEX: a discovery tool for genomic aptamers</article-title><source>Methods</source><year>2010</year><volume>52</volume><fpage>125</fpage><lpage>32</lpage><pub-id pub-id-type="pmcid">PMC2954320</pub-id><pub-id pub-id-type="pmid">20541015</pub-id><pub-id pub-id-type="doi">10.1016/j.ymeth.2010.06.004</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><etal/></person-group><article-title>Perspectives on Codebook: sequence specificity of uncharacterized human transcription factors</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.11.11.622097</elocation-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>MF</given-names></name><etal/></person-group><article-title>Compact, universal DNA microarrays to comprehensively determine transcription-factor binding site specificities</article-title><source>Nat Biotechnol</source><year>2006</year><volume>24</volume><fpage>1429</fpage><lpage>35</lpage><pub-id pub-id-type="pmcid">PMC4419707</pub-id><pub-id pub-id-type="pmid">16998473</pub-id><pub-id pub-id-type="doi">10.1038/nbt1246</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isakova</surname><given-names>A</given-names></name><etal/></person-group><article-title>SMiLE-seq identifies binding motifs of single and dimeric transcription factors</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>316</fpage><lpage>322</lpage><pub-id pub-id-type="pmid">28092692</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><etal/></person-group><article-title>DNA-Binding Specificities of Human Transcription Factors</article-title><source>Cell</source><year>2013</year><volume>152</volume><fpage>327</fpage><lpage>39</lpage><pub-id pub-id-type="pmid">23332764</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Razavi</surname><given-names>R</given-names></name><etal/></person-group><article-title>Extensive binding of uncharacterized human transcription factors to genomic dark matter</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.11.11.622123</elocation-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitges</surname><given-names>FW</given-names></name><etal/></person-group><article-title>Multiparameter functional diversity of human C2H2 zinc finger proteins</article-title><source>Genome Res</source><year>2016</year><volume>26</volume><fpage>1742</fpage><lpage>1752</lpage><pub-id pub-id-type="pmcid">PMC5131825</pub-id><pub-id pub-id-type="pmid">27852650</pub-id><pub-id pub-id-type="doi">10.1101/gr.209643.116</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vorontsov</surname><given-names>IE</given-names></name><etal/></person-group><article-title>Cross-platform DNA motif discovery and benchmarking to explore binding specificities of poorly studied human transcription factors</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.11.11.619379</elocation-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gralak</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Identification of methylation-sensitive human transcription factors using meSMiLE-seq</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.11.11.619598</elocation-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weirauch</surname><given-names>MT</given-names></name><etal/></person-group><article-title>Determination and inference of eukaryotic transcription factor sequence specificity</article-title><source>Cell</source><year>2014</year><volume>158</volume><fpage>1431</fpage><lpage>43</lpage><pub-id pub-id-type="pmcid">PMC4163041</pub-id><pub-id pub-id-type="pmid">25215497</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2014.08.009</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birke</surname><given-names>M</given-names></name><etal/></person-group><article-title>The MT domain of the proto-oncoprotein MLL binds to CpG-containing DNA and discriminates against methylation</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>958</fpage><lpage>65</lpage><pub-id pub-id-type="pmcid">PMC100340</pub-id><pub-id pub-id-type="pmid">11842107</pub-id><pub-id pub-id-type="doi">10.1093/nar/30.4.958</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Fields</surname><given-names>DS</given-names></name></person-group><article-title>Specificity, free energy and information content in protein-DNA interactions</article-title><source>Trends Biochem Sci</source><year>1998a</year><volume>23</volume><fpage>109</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">9581503</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weirauch</surname><given-names>MT</given-names></name><etal/></person-group><article-title>Evaluation of methods for modeling transcription factor sequence specificity</article-title><source>Nat Biotechnol</source><year>2013</year><volume>31</volume><fpage>126</fpage><lpage>34</lpage><pub-id pub-id-type="pmcid">PMC3687085</pub-id><pub-id pub-id-type="pmid">23354101</pub-id><pub-id pub-id-type="doi">10.1038/nbt.2486</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuznetsov</surname><given-names>VA</given-names></name></person-group><article-title>Mathematical Modeling of Avidity Distribution and Estimating General Binding Properties of Transcription Factors from Genome-Wide Binding Profiles</article-title><source>Methods Mol Biol</source><year>2017</year><volume>1613</volume><fpage>193</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">28849563</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexandrov</surname><given-names>I</given-names></name><name><surname>Kazakov</surname><given-names>A</given-names></name><name><surname>Tumeneva</surname><given-names>I</given-names></name><name><surname>Shepelev</surname><given-names>V</given-names></name><name><surname>Yurov</surname><given-names>Y</given-names></name></person-group><article-title>Alpha-satellite DNA of primates: old and new families</article-title><source>Chromosoma</source><year>2001</year><volume>110</volume><fpage>253</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">11534817</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huttlin</surname><given-names>EL</given-names></name><etal/></person-group><article-title>Architecture of the human interactome defines protein communities and disease networks</article-title><source>Nature</source><year>2017</year><volume>545</volume><fpage>505</fpage><lpage>509</lpage><pub-id pub-id-type="pmcid">PMC5531611</pub-id><pub-id pub-id-type="pmid">28514442</pub-id><pub-id pub-id-type="doi">10.1038/nature22366</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Boer</surname><given-names>CG</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name></person-group><article-title>Hold out the genome: a roadmap to solving the cis-regulatory code</article-title><source>Nature</source><year>2024</year><volume>625</volume><fpage>41</fpage><lpage>50</lpage><pub-id pub-id-type="pmid">38093018</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Schneider</surname><given-names>TD</given-names></name><name><surname>Gold</surname><given-names>L</given-names></name><name><surname>Ehrenfeucht</surname><given-names>A</given-names></name></person-group><article-title>Use of the ‘Perceptron’ algorithm to distinguish translational initiation sites in E. coli</article-title><source>Nucleic Acids Res</source><year>1982</year><volume>10</volume><fpage>2997</fpage><lpage>3011</lpage><pub-id pub-id-type="pmcid">PMC320670</pub-id><pub-id pub-id-type="pmid">7048259</pub-id><pub-id pub-id-type="doi">10.1093/nar/10.9.2997</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laverty</surname><given-names>KU</given-names></name><etal/></person-group><article-title>PRIESSTESS: interpretable, high-performing models of the sequence and structure preferences of RNA-binding proteins</article-title><source>Nucleic Acids Res</source><year>2022</year><volume>50</volume><fpage>e111</fpage><pub-id pub-id-type="pmcid">PMC9638913</pub-id><pub-id pub-id-type="pmid">36018788</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac694</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolger</surname><given-names>AM</given-names></name><name><surname>Lohse</surname><given-names>M</given-names></name><name><surname>Usadel</surname><given-names>B</given-names></name></person-group><article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>2114</fpage><lpage>20</lpage><pub-id pub-id-type="pmcid">PMC4103590</pub-id><pub-id pub-id-type="pmid">24695404</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The Sequence Alignment/Map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC2723002</pub-id><pub-id pub-id-type="pmid">19505943</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>841</fpage><lpage>2</lpage><pub-id pub-id-type="pmcid">PMC2832824</pub-id><pub-id pub-id-type="pmid">20110278</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korhonen</surname><given-names>J</given-names></name><name><surname>Martinmaki</surname><given-names>P</given-names></name><name><surname>Pizzi</surname><given-names>C</given-names></name><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name></person-group><article-title>MOODS: fast search for position weight matrix matches in DNA sequences</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>3181</fpage><lpage>2</lpage><pub-id pub-id-type="pmcid">PMC2778336</pub-id><pub-id pub-id-type="pmid">19773334</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp554</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Najafabadi</surname><given-names>HS</given-names></name><etal/></person-group><article-title>Non-base-contacting residues enable kaleidoscopic evolution of metazoan C2H2 zinc finger DNA binding</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><fpage>167</fpage><pub-id pub-id-type="pmcid">PMC5588721</pub-id><pub-id pub-id-type="pmid">28877740</pub-id><pub-id pub-id-type="doi">10.1186/s13059-017-1287-y</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korhonen</surname><given-names>JH</given-names></name><name><surname>Palin</surname><given-names>K</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name></person-group><article-title>Fast motif matching revisited: high-order PWMs, SNPs and indels</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>514</fpage><lpage>521</lpage><pub-id pub-id-type="pmid">28011774</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcais</surname><given-names>G</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group><article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>764</fpage><lpage>70</lpage><pub-id pub-id-type="pmcid">PMC3051319</pub-id><pub-id pub-id-type="pmid">21217122</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btr011</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of GHT-SELEX.</title><p><bold>A.</bold> Schematic of GHT-SELEX, showing parallels with HT-SELEX. <bold>B.</bold> Example of read accumulation over a TF motif match for NFKB1. <bold>C.</bold> Genomic binding for four positive control TFs on a genomic region showing (top to bottom) PWM scanning scores (moving average of affinity scores, from MOODS<sup><xref ref-type="bibr" rid="R60">60</xref></sup> scan in linear domain, using a window of size 200bp) for literature (Ref) PWMs and Codebook PWMs, followed by read coverage signal observed in GHT-SELEX and ChIP-seq.</p></caption><graphic xlink:href="EMS200046-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>MAGIX method for interpretation of GHT-SELEX data.</title><p><bold>A.</bold> A brief overview of the statistical framework of the generative model of MAGIX. Open circles, closed circles, and the diamonds represent latent variables, observed variables, and deterministic computations, respectively. <italic>s<sub>i</sub></italic>: library size for sample <italic>i</italic>; <bold>x</bold><sub><italic>i</italic></sub>: vector of sample-level variables for sample <italic>i</italic>, including an intercept term and a term for the SELEX cycle, in addition to other terms for batch and background effects; <bold>β</bold><sub><italic>j</italic></sub>: vector of model coefficients for interval <italic>j</italic>; <italic>m<sub>ij</sub></italic>: number of observed reads mapping to interval <italic>j</italic> in sample <italic>i</italic>. See <xref ref-type="sec" rid="S10">Methods</xref> for description of other variables. <bold>B.</bold> Example of actual read count data for CTCF over five replicates of four cycles, illustrating enrichment patterns, fitted coefficients (right), and estimated library sizes (bottom). <bold>C.</bold> Distribution of PWM hits for the top-ranked TF PWM (highest AUROC on GHT-peaks as determined by accompanying study<sup><xref ref-type="bibr" rid="R43">43</xref></sup>) within the 5,000 highest scoring MAGIX peaks. PWM hits were identified with MOODS<sup><xref ref-type="bibr" rid="R60">60</xref></sup> (P &lt; 0.0001). Solid red lines represent the mean PWM hit position within MAGIX peaks and dashed lines represent one standard deviation about the mean.</p></caption><graphic xlink:href="EMS200046-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Analysis of 331 Codebook proteins and 61 control TFs using GHT-SELEX.</title><p><bold>A.</bold> Venn diagram displays the number of TFs with approved experiments in GHT-SELEX, HT-SELEX, and ChIP-seq for all Codebook TFs (left) and control TFs (right) assayed with GHT- and HT-SELEX. <bold>B.</bold> Bar chart shows the number of TFs with at least one approved GHT-SELEX experiment, categorized based by DBD type. C2H2-zf proteins and those with an unknown DBD (at the beginning of the project) are inset due to large numbers.</p></caption><graphic xlink:href="EMS200046-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Correspondence between GHT-SELEX and ChIP-seq peaks.</title><p><bold>A.</bold> Enrichment of ChIP-seq peaks and PWM hits within MAGIX peaks, for two example control TFs. The top 75,000 MAGIX peaks are sorted by their MAGIX enrichment coefficient (purple, left y-axis). Orange line shows the proportion of peaks (in a sliding window of 500 peaks over the ranked peaks, with a step size of 50) that overlap with a ChIP-seq peak (at MACS threshold P &lt; 0.001). Black line shows the AUROC for PWM affinity scores (calculated by AffiMx<sup><xref ref-type="bibr" rid="R52">52</xref></sup>) of MAGIX peaks in the same window vs. 500 random genomic sites. <bold>B.</bold> Illustration of peak number optimization (for CTCF as an example). <bold>C.</bold> Histogram of the optimal values of N (peak count) for the 137 TFs that have both GHT-SELEX and ChIP-seq peaks. D. Histogram of optimal Jaccard values, compared to the maximum Jaccard for mismatched TFs (i.e. between GHT-SELEX for one TF and ChIP-seq for a randomly selected TF).</p></caption><graphic xlink:href="EMS200046-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>High quality PWMs often predict <italic>in vivo</italic> binding sites as effectively as GHT-SELEX peaks.</title><p><bold>A.</bold> Scatter plot of optimal Jaccard value between GHT-SELEX peaks and ChIP-seq peaks (x-axis) vs. optimal Jaccard value between PWM-predicted sites and ChIP-seq peaks (y-axis), for all 137 TFs (dots). <bold>B.</bold> Scatter plot of optimal N (peak number) for the same peak set comparisons shown in (<bold>A</bold>). <bold>C.</bold> Scatter plot showing optimal Jaccard value between PWM-predicted sites and ChIP-seq peaks, for maximum-affinity PWM scoring and sum-of-affinities PWM scoring. Points (TFs) are scaled based on the optimal number of peaks (in the sum scoring), and the color reflects the fraction of binding sites comprised of multiple PWM hits. <bold>D.</bold> Scatter plot of the improvement in the optimal Jaccard value associated with sum-of-affinities PWM scoring vs. information content of the PWM. Points’ size and color are the same as panel (<bold>C</bold>). <bold>E.</bold> Examples of four TFs with multiple motif matches within a single ChIP-seq peak.</p></caption><graphic xlink:href="EMS200046-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Alternative engagement of individual C2H2-zf domains at genomic binding sites inferred from the recognition code.</title><p><bold>A.</bold> RCADEEM applied to CTCF. <italic>Middle</italic> panel displays the top 2,000 nonrepetitive GHT-SELEX peaks. White vertical bars indicate the region that is expected to contact the DNA based on the assumption that each of the C2H2-zf domains define three contiguous bases. <italic>Left</italic> panel indicates which C2H2-zf domains are inferred to engage each DNA sequence, which is used to determine the row order in the figure. <italic>Right</italic> panel shows motifs for the major sub-sites, derived from base frequencies in the sequence alignment. <bold>B-F,</bold> Top 2,000 non-repeat peak sequences, as in (<bold>A</bold>), for representative TFs with different binding modes, as described in the main text. Above each is shown the sequence logo for the single representative Codebook PWM (<italic>top</italic>) and a motif generated by RCADEEM that represents all the observed sequences (<italic>bottom</italic>). <bold>G.</bold> Number of occurrences of each category among all 86 C2H2-zf proteins for which RCADEEM yielded a significant outcome; note that a TF might appear in multiple or no categories.</p></caption><graphic xlink:href="EMS200046-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>Evolution of C2H2-zf protein DNA-binding specificities through internal duplication of DBDs and DBD arrays.</title><p><bold>A.</bold> RCADEEM results for the pool of top 500 peaks from full-length ZNF721 and two DBD constructs, after removing peaks that overlap repeats. The construct in which the peak was observed is indicated on the left. <bold>B.</bold> Similarity of C2H2-zf domains of ZNF721 (based on the number of mismatches in the global alignment). Apparent duplicated arrays are encircled by blue border (i.e. syntenic duplications), while single pairs that may also be duplicates are circled in red. <bold>C.</bold> Scatterplots of the HT-SELEX <italic>k</italic>t-mer scores<sup><xref ref-type="bibr" rid="R61">61</xref></sup> (relative counts) across the three ZNF721 constructs <bold>D.</bold> Comparison of average per-base similarity (correlation of nucleotide frequency) in PWMs predicted by the recognition code, for those present in duplicated arrays vs. those duplicated as individual C2H2-zf domains, with duplicated C2H2-zf domains taken as pairs that are separated from each other by 5 or less edits. DBD pairs have been filtered to contain only combinations where both DBDs are likely to have retained their ability to bind DNA (have DNA binding functionality score<sup><xref ref-type="bibr" rid="R59">59</xref></sup> &gt;0.5). Error bars show standard error of the mean.</p></caption><graphic xlink:href="EMS200046-f007"/></fig></floats-group></article>