<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199905</article-id><article-id pub-id-type="doi">10.1101/2024.10.31.621290</article-id><article-id pub-id-type="archive">PPR934348</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Quantifying the nuclear localisation of fluorescently tagged proteins</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1288-7185</contrib-id><name><surname>Hurbain</surname><given-names>Julien</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9933-4016</contrib-id><name><surname>ten Wolde</surname><given-names>Pieter Rein</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7489-8587</contrib-id><name><surname>Swain</surname><given-names>Peter S.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>AMOLF, Science Park 104, Amsterdam 1098 XG, The Netherlands</aff><aff id="A2"><label>2</label>School of Biological Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01nrxwf90</institution-id><institution>University of Edinburgh</institution></institution-wrap>, <addr-line>C.H. Waddington Building - Max Born Crescent</addr-line>, <city>Edinburgh</city><postal-code>EH9 3BF</postal-code>, <country country="GB">United Kingdom</country></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author. <email>peter.swain@ed.ac.uk</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>08</day><month>11</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>11</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Cells are highly dynamic, continually responding to intra- and extracellular signals. Monitoring and measuring the response to these signals at the single-cell level is challenging. Signal transduction is fast, but reporters for downstream gene expression are typically slow, requiring fluorescent proteins to be expressed and to mature. An alternative is to fluorescently tag and then monitor the intracellular locations of transcription factors and other effectors. These proteins move in or out of the nucleus in minutes, after upstream signalling modifies their state of phosphorylation. Although such approaches are being used increasingly, there is no consensus on how to quantify the nuclear and cytoplasmic localisation of these proteins.Using budding yeast, we developed a convolutional neural network that quantifies nuclear localisation from fluorescence and, optionally, bright-field images. Focusing on the cellular response to changing glucose, we generated ground-truth data using strains with both a transcription factor and a nuclear protein tagged with fluorescent markers. We then showed that the neural network based approach outperformed seven published methods, particularly when predicting single-cell time series, which are key to determining how cells respond and adapt. Collectively, our results are conclusive — using machine learning to automatically determine the appropriate image processing consistently outperforms ad hoc methods. Adopting such methods promises to both improve the accuracy and, with transfer learning, the consistency of single-cell analyses.</p></abstract><kwd-group><kwd>Transcription factor localisation</kwd><kwd>convolutional neural network</kwd><kwd>cellular stress</kwd><kwd>microscopic images</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Cells continually have to respond and adapt to changes in their environment. These changes are typically detected and relayed via signal transduction networks, which activate or deactivate transcription factors, leading to altered gene expression (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). In eukaryotes, changes in their activation state can cause the transcription factors to either enter or exit the nucleus (<xref ref-type="bibr" rid="R49">Vandromme <italic>et al</italic>., 1996</xref>). Examples in mammalian cells include NF-<italic>κ</italic>B (<xref ref-type="bibr" rid="R25">Hoffmann <italic>et al</italic>., 2002</xref>; <xref ref-type="bibr" rid="R47">Tay <italic>et al</italic>., 2010</xref>) and p53 (<xref ref-type="bibr" rid="R31">Lahav <italic>et al</italic>., 2004</xref>) and at least tens of transcription factors translocate in budding yeast (<xref ref-type="bibr" rid="R7">Conrad <italic>et al</italic>., 2014</xref>).</p><p id="P3">Monitoring these transcription factors as they translocate is a versatile method to characterise how cells respond to changes in their environment or intracellular state. It can be applied to single cells, to time-varying environments and to dynamic cellular responses, and has a time resolution of minutes, much closer to that of the underlying signal transduction than reporters of gene expression.</p><p id="P4">For budding yeast, following the nuclear translocation of transcription factors and other proteins involved in regulating transcription has become a standard way to visualise and characterise stress responses over time. For example, the high-osmolarity glycerol (HOG) MAP kinase is often monitored to investigate hyper-osmotic stress (<xref ref-type="bibr" rid="R24">Hersen <italic>et al</italic>., 2008</xref>; <xref ref-type="bibr" rid="R36">Mettetal <italic>et al</italic>., 2008</xref>). Whereas a fall in extracellular glucose generates nuclear entry of both Msn2 (<xref ref-type="bibr" rid="R27">Jacquet <italic>et al</italic>., 2003</xref>; <xref ref-type="bibr" rid="R23">Hao <italic>et al</italic>., 2013</xref>), a master regulator of the general stress response (<xref ref-type="bibr" rid="R12">Gasch <italic>et al</italic>., 2000</xref>; <xref ref-type="bibr" rid="R6">Causton <italic>et al</italic>., 2001</xref>), and of Dot6 (<xref ref-type="bibr" rid="R13">Gasch <italic>et al</italic>., 2017</xref>; <xref ref-type="bibr" rid="R19">Granados <italic>et al</italic>., 2018</xref>), a repressor of ribosome biogenesis (<xref ref-type="bibr" rid="R34">Lippman and Broach, 2009</xref>). Simultaneously Mig1 (<xref ref-type="bibr" rid="R2">Bendrioua <italic>et al</italic>., 2014</xref>; <xref ref-type="bibr" rid="R33">Lin <italic>et al</italic>., 2015</xref>), a glucose-sensing specialist and a repressor of regulons for metabolising other sugars (<xref ref-type="bibr" rid="R7">Conrad <italic>et al</italic>., 2014</xref>), exits the nucleus (<xref ref-type="fig" rid="F1">Fig. 1B</xref>).</p><p id="P5">Although all the approaches developed use fluorescent-protein tags to identify transcription factors, they differ in how they quantify their intracellular localisation (<xref ref-type="fig" rid="F1">Fig. 1C</xref>). To avoid generating strains with a second fluorophore marking the nucleus, measuring the spatial homogeneity of the transcription factor’s fluorescence signal is often used as a proxy for nuclear localisation — a cytoplasmic transcription factor generates a fluorescence spread more equally over the cell than one concentrated in the nucleus (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). Nevertheless, there is no consensus on how to measure spatial inhomogeneity, with at least seven different methods proposed for transcription factors in yeast alone (<xref ref-type="table" rid="T1">Table 1</xref>).</p><p id="P6">We set out to evaluate the different methods, comparing these approaches with one that we developed using a convolutional neural network (<xref ref-type="bibr" rid="R16">Goodfellow <italic>et al</italic>., 2016</xref>), as well as with an older standard for measuring spatial inhomogeneities: Hu moments (<xref ref-type="bibr" rid="R26">Hu, 1962</xref>; <xref ref-type="bibr" rid="R39">Nasrudin <italic>et al</italic>., 2021</xref>). These moments use the moments of inertia treating the fluorescence values within a cell as masses.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Finding transcription-factor localisation from a nuclear marker</title><p id="P7">We generated time-lapse single-cell data with both a fluorescent transcription factor, tagged with GFP, and a fluorescent nuclear marker, the Nhp6a gene tagged with mCherry (<xref ref-type="bibr" rid="R21">Hansen <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="R19">Granados <italic>et al</italic>., 2018</xref>) (<xref ref-type="fig" rid="F2">Fig. 2A</xref>). The Nhp6a protein remodels nucleosomes (<xref ref-type="bibr" rid="R45">Ruone <italic>et al</italic>., 2003</xref>). We used the ALCATRAS microfluidic device to grow and trap cells (<xref ref-type="bibr" rid="R8">Crane <italic>et al</italic>., 2014</xref>) and the BABY algorithm (<xref ref-type="bibr" rid="R43">Pietsch <italic>et al</italic>., 2023</xref>) to segment and track these cells over time from time-lapse, bright-field images.</p><p id="P8">To identify the nucleus from the mCherry images, we used Otsu thresholding (<xref ref-type="bibr" rid="R40">Otsu, 1979</xref>). Just as there is no consensus on the optimal way to measure the localisation of transcription factors, there is none too on how to determine the nucleus’s location (<xref ref-type="bibr" rid="R27">Jacquet <italic>et al</italic>., 2003</xref>; <xref ref-type="bibr" rid="R10">Duveau <italic>et al</italic>., 2024</xref>; <xref ref-type="bibr" rid="R32">Li <italic>et al</italic>., 2018</xref>). In contrast to transcription factors, however, the fluorescence from a nuclear marker is consistently bright over both time and extracellular conditions (<xref ref-type="fig" rid="F1">Fig. 1C</xref>), and we found little difference between most methods (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>), all of which threshold the image in some way (<xref ref-type="bibr" rid="R29">Kapur <italic>et al</italic>., 1985</xref>; <xref ref-type="bibr" rid="R28">Johannsen and Bille, 1982</xref>; <xref ref-type="bibr" rid="R3">Bernsen, 1986</xref>; <xref ref-type="bibr" rid="R41">Parker, 2010</xref>). We chose Otsu thresholding because it has no parameters; it does though require a bimodal distribution of pixel fluorescence intensities (<xref ref-type="bibr" rid="R14">Goh <italic>et al</italic>., 2018</xref>) and so a sufficiently bright nuclear marker. These conditions were satisfied in our experiments. With the nucleus identified, we defined, following <xref ref-type="bibr" rid="R10">Duveau <italic>et al</italic>. (2024)</xref>, the degree of nuclear localisation as <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mtext>nuc</mml:mtext></mml:msub><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mtext>cell</mml:mtext></mml:mrow></mml:msub><mml:mo>〉</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>I</italic><sub>nuc</sub> represents the pixel intensities in the nucleus and <italic>I</italic><sub>cell</sub> those for the whole cell, including the nucleus (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). The most relevant quantity for predicting gene expression is however the nuclear concentration ⟨<italic>I</italic><sub>nuc</sub>⟩, the total fluorescence in the nucleus divided by its area. We can recover this concentration from the localisation by multiplying by ⟨<italic>I</italic><sub>cell</sub>⟩, the mean cellular fluorescence, which is commonly measured.</p><p id="P9">Applying our workflow to cells in different carbon sources, we typically found a tri-modal distribution of the level of nuclear localisation (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). The largest mode corresponds to cells with a high nuclear concentration of transcription factor; the middle node to cells with a low nuclear concentration; and the lowest mode, based on visual inspection of the images, either to poorly segmented cells, such as those overlapping the edges of an image, or to cells actively dividing with consequently an imperfectly identified nucleus. We therefore consider cells with predominantly cytoplasmic transcription factors to have 1.15 &lt; <italic>𝓁</italic> &lt; 1.65 and cells with predominantly nuclear transcription factors to have 𝓁 &gt; 1.65.</p></sec><sec id="S4"><title>A convolutional neural network to predict nuclear localisation</title><p id="P10">We developed a convolutional neural network (<xref ref-type="bibr" rid="R16">Goodfellow <italic>et al</italic>., 2016</xref>) to predict nuclear localisation from segmented fluorescence images of tagged transcription factors (<xref ref-type="fig" rid="F2">Fig. 2D</xref>). The network comprises three layers and a fully connected layer (<xref ref-type="supplementary-material" rid="SD1">Fig. S2A</xref>) and maps microscopy images of a single cell to one continuous value, the predicted level of nuclear localisation. As inputs, we used the maximum projection of fluorescence images taken at five Z sections and, although not required, the maximum projection of the corresponding five bright-field images. Such bright-field images are readily available and improved accuracy because the nucleus can sometimes be partly seen in bright-field (<xref ref-type="bibr" rid="R1">Adjavon, 2022</xref>). We used the nuclear Nhp6a-mCherry marker only to establish a ground-truth data for training; the corresponding images were not used as network inputs. After training, using data from the transcription factors Msn2, Dot6, and Mig1, the network had an accuracy of 95% (<xref ref-type="supplementary-material" rid="SD1">Fig. S2B</xref>). Excluding data from one specific transcription factor while training but not while testing neither substantially nor consistently affected performance (<xref ref-type="supplementary-material" rid="SD1">Fig. S2C</xref>). For instance, removing data from Msn2 while training does not always lead to poor performance while testing with that data.</p></sec><sec id="S5"><title>Comparing different methods</title><p id="P11">With the nuclear marker determining the ground-truth level of nuclear localisation, we compared the various methods using three transcription factors that respond to extracellular glucose (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). Two of these enter the nucleus in low glucose while the other exits (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). A difficulty is that each method makes predictions over a different numerical range because each has its own way of characterising spatial inhomogeneity. We therefore plotted the log<sub>2</sub> ratio of the method’s predicted value to the ground-truth level of nuclear localisation and centred the results by subtracting each method’s mean ratio (non-centred results are in <xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). Accurate methods should have a tight, symmetric distribution.</p><p id="P12">The neural network performed best. Although having a skewness comparable to other approaches (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>), it had the lowest standard deviation and highest consistency over the three transcription factors. Plotting the predicted localisation versus the ground truth (<xref ref-type="fig" rid="F3">Fig. 3B</xref>), the neural network’s results tightly followed the <italic>y</italic> = <italic>x</italic> line (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>), and both its correlation and mutual information with the ground truth were highest (<xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>). Unlike the other methods, as it is the only one trained to do so, we can also directly interpret its predictions as estimates of <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>.</p><p id="P13">Although the neural network’s performance is perhaps unsurprising, being the only method benefiting from the training data, it is useful to quantify how much better it is over the alternatives. To this end, we investigated time-series — the focus of multiple studies (<xref ref-type="bibr" rid="R2">Bendrioua <italic>et al</italic>., 2014</xref>; <xref ref-type="bibr" rid="R5">Cai <italic>et al</italic>., 2008</xref>; <xref ref-type="bibr" rid="R10">Duveau et al., 2024</xref>; <xref ref-type="bibr" rid="R17">Goulev et al., 2017</xref>; <xref ref-type="bibr" rid="R18">Granados et al., 2017</xref>, <xref ref-type="bibr" rid="R19">2018</xref>; <xref ref-type="bibr" rid="R20">Hansen and O’shea, 2013</xref>; <xref ref-type="bibr" rid="R23">Hao et al., 2013</xref>; <xref ref-type="bibr" rid="R24">Hersen <italic>et al</italic>., 2008</xref>; <xref ref-type="bibr" rid="R33">Lin <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="R36">Mettetal <italic>et al</italic>., 2008</xref>; <xref ref-type="bibr" rid="R43">Pietsch <italic>et al</italic>., 2023</xref>). The results further highlight how improved the predictions can be.</p></sec><sec id="S6"><title>The neural network’s predictions best capture dynamic single-cell responses</title><p id="P14">The variation in how individual cells respond and its information often manifests neither in the response at a given moment in time nor in the long-time limit, but in the dynamical trajectory of the response over time (<xref ref-type="bibr" rid="R48">Tostevin and Ten Wolde, 2009</xref>; <xref ref-type="bibr" rid="R19">Granados <italic>et al</italic>., 2018</xref>). In constant glucose (<xref ref-type="fig" rid="F4">Fig. 4</xref>), both Msn2 and Dot6 transiently enter the nucleus (<xref ref-type="bibr" rid="R9">Dalal <italic>et al</italic>., 2014</xref>), impeding straightforward averaging, which would obscure such behaviour. Almost all cells responded however when we removed extracellular glucose, with Msn2 entering the nucleus on average faster than Dot6.</p><p id="P15">Applying the methods to our data, we saw substantial differences even in predicting the mean nuclear translocation over time (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). Although all methods identified the cells as responding to the drop in extracellular glucose, shown by a peak in the time series, some had difficulty when the transcription factors were predominately in the nucleus, with higher errors for Msn2 and Dot6 after glucose drops and for Mig1 before. Only the neural network’s predictions had low errors both at each time point (<xref ref-type="fig" rid="F4">Fig. 4C</xref>) and for each single-cell time series (<xref ref-type="fig" rid="F4">Fig. 4D</xref>).</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P16">Our study shows that machine learning, through the convolutional neural network we developed, consistently outperforms <italic>ad hoc</italic> approaches, particularly for single-cell time series. Such time series best characterise individual responses (<xref ref-type="bibr" rid="R38">Murugan <italic>et al</italic>., 2021</xref>).</p><p id="P17">Although neural networks require training data, so too do <italic>ad hoc</italic> approaches because without such data these approaches cannot be validated. The difference lies in the quantity of training data, but with microfluidic technology, generating sufficient data is possible in a single experiment, as we demonstrated here. Additionally, the quality of the approach can be continually improved by adding more images to the training data, such as from different microscopes, imaging protocols, strains, or species. Even better, a network trained in one laboratory will likely need much less data to be re-trained for another, with the promise to improve the consistency of signal-cell analyses broadly.</p><p id="P18">Single-cell data is often noisy, and a poor choice of signal can further reduce the signal-to-noise ratio, confounding analyses. For nuclear translocations at least, we have shown that using machine learning to identify the signal, through optimising the image processing required, is one way to gain accuracy and with it, no doubt, greater biological insight for the future.</p></sec><sec id="S8" sec-type="methods"><title>Methods</title><sec id="S9"><title>Strains</title><p id="P19">Details of all strains are given in <xref ref-type="bibr" rid="R19">Granados <italic>et al</italic>. 2018</xref> (<xref ref-type="bibr" rid="R19">Granados <italic>et al</italic>., 2018</xref>). We grew cells in synthetic complete (SC) medium at 30° C either supplemented with either 2%, 1% glucose or with no additional carbon source, denoted 0% glucose.</p></sec><sec id="S10"><title>Cell preparation and loading ALCATRAS</title><p id="P20">We used overnight cultures in a 30°<italic>C</italic> incubator under agitation to generate mid-log cells which we diluted in fresh SC medium to an optical density of 0.1 and then incubated for a further three hours before loading into a microfluidic device. To expose different strains to the same extracellular conditions, we used a multi-chamber version of ALCATRAS (<xref ref-type="bibr" rid="R8">Crane <italic>et al</italic>., 2014</xref>). Prior to loading, the ALCATRAS chambers were pre-filled with growth medium supplemented with 0.05% bovine serum albumin to facilitate cell loading and reduce cell clumping.</p></sec><sec id="S11"><title>Time-lapse microscopy</title><p id="P21">Our microscope is a Nikon Ti Eclipse, optimized for imaging GFP, mCherry, and Cy5 fluorescence, as well as bright-field transmission. For GFP, we used a Chroma dual-band filter set (59022) with an excitation range of 452-490 nm, centered at 470 nm, a beam splitter range of 496-548 nm, and an emission filter at 535/30 nm (520-550 nm range). The mCherry imaging shared the dual-band filter set for GFP, with an excitation range of 554-558 nm (centered at 556 nm), a beam splitter range of 595-677 nm, and an emission filter at 632/60 nm. Finally, for Cy5 imaging we used an excitation filter at 620/60 nm (590-650 nm, centered at 620 nm), a 660 nm longpass dichroic, and a 665 nm longpass emission filter. For Cy5 and bright-field transmission, the microscope had a white LED with a broad-spectrum range, and for fluorescence imaging, an OptoLED light source from Cairn Research.</p><p id="P22">The objective was a Nikon 60× oil-immersion lens with a numerical aperture (NA) of 1.4, using Nikon F2 immersion oil. Imaging was captured with a Teledyne Prime 95b sCMOS camera, with an 11 <italic>µ</italic>m pixel size, 16-bit dynamic range, 1×1 binning, gain of 1, and air cooling at -15°C. Exposure time for imaging was set at 30 ms, with images captured every five minutes for 150 time points, i.e., 12.5 hours. We acquired bright-field and fluorescence images at five Z-sections spaced by 0.6 <italic>µ</italic>m, but in a single focal plane for the Cy5 channel. Both the microfluidic device and the media were kept at 30°<italic>C</italic> inside an incubation chamber (Okolabs). Nikon’s Perfect Focus System maintained consistent focus.</p><p id="P23">We used fluigent pressure-driven system to control the flow of media. We applied carbon stress after six hours by switching the flow rate of either 2% or 1% glucose medium from 9 <italic>µ</italic>L/min to 1 <italic>µ</italic>L/min and the flow rate of 0% glucose medium from 1 <italic>µ</italic>L/min to 9 <italic>µ</italic>L/min. Slowly flowing medium did not enter the chamber containing cells and was re-directed to waste. We used Cy5 dye in the 0% glucose medium to confirm media switches. Media were supplemented with 0.05% of bovine serum albumin (BSA) to facilitate cell loading and reduce cell clumping.</p></sec><sec id="S12"><title>Image segmentation</title><p id="P24">To segment and track cells, we used BABY (<xref ref-type="bibr" rid="R43">Pietsch <italic>et al</italic>., 2023</xref>) and the aliby Python pipeline (<xref ref-type="bibr" rid="R37">Muñoz González, 2023</xref>).</p><p id="P25">To identify nuclear pixels, we used Otsu thresholding on single-cell images after applying a Gaussian blur (<xref ref-type="bibr" rid="R15">Gonzalez, 2009</xref>). Alternative methods, which we also tested, are in <xref ref-type="table" rid="T2">Table 2</xref>.</p><p id="P26">We estimated mutual information with the nearest-neighbour approach (<xref ref-type="bibr" rid="R30">Kraskov <italic>et al</italic>., 2004</xref>; <xref ref-type="bibr" rid="R44">Ross, 2014</xref>).</p></sec><sec id="S13"><title>Constructing and training the neural network</title><p id="P27">The neural network has three convolutional layers (<xref ref-type="supplementary-material" rid="SD1">Fig. S2A</xref>). The first two comprise convolutions followed by Relu activation functions and then maximum pooling. The third layer is similar but with no maximum pooling and its output is flattened into a one-dimensional array. The final, i.e., fully-connected, layer combines a linear and Relu function.</p><p id="P28">For training (<xref ref-type="supplementary-material" rid="SD1">Fig. S2B</xref>), we used mean square error as the loss function and the Adam optimiser. The training data comprised ≈ 180, 000 single-cell images shuffled with a proportion of 90% for training and 10% for testing from an experiment with a switch of extracellular glucose from 2% to 0%. We used a batch size of 64 and a CUDA implementation of the network to increase speed (<xref ref-type="bibr" rid="R11">Garland <italic>et al</italic>., 2008</xref>). After some exploration, we chose a learning rate of 0.001 with a linear learning-rate scheduler of ratio 0.5 over 50 epochs. To compute accuracy, we used a nuclear localisation of 1.65 and above to define cells with a localised, nuclear transcription factor.</p><p id="P29">For all coding, we used Python and the Pytorch with CUDA package.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Materials</label><media xlink:href="EMS199905-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d35aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S14"><title>Acknowledgments</title><p>The authors thank Ivan B. N. Clark for his help in performing the experiments. This work is part of the Dutch Research Council (NWO) and was performed at the research institute AMOLF and the University of Edinburgh. This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation program (Grant Agreement No. 885065). PSS gratefully acknowledges support from the BBSRC (grant number BB/W006545/1).</p></ack><sec id="S15" sec-type="data-availability"><title>Data &amp; code availability</title><p id="P30">Codes and reduced data used in this work can be found at : <ext-link ext-link-type="uri" xlink:href="https://git.ecdf.ed.ac.uk/v1jhurba/neunet-nucloc.git">https://git.ecdf.ed.ac.uk/v1jhurba/neunet-nucloc.git</ext-link>. The full dataset set with its corresponding code is available at : <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7488/ds/7820">https://doi.org/10.7488/ds/7820</ext-link>.</p></sec><fn-group><fn fn-type="conflict" id="FN1"><p id="P31"><bold>Competing interests</bold></p><p id="P32">No competing interest is declared.</p></fn><fn fn-type="con" id="FN2"><p id="P33"><bold>Author contributions statement</bold></p><p id="P34">JH and PSS conceived the research; PRtW and PSS helped interpret the results and provided expertise on the methods.</p><p id="P35">JH developed the neural network, performed the simulations and experiments, and wrote the manuscript’s first draft. All authors reviewed and edited the manuscript.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Adjavon</surname><given-names>D-YA</given-names></name></person-group><source>Computational analysis of single-cell dynamics: protein localisation, cell cycle, and metabolic adaptation</source><publisher-name>Ph.D. thesis, University of Edinburgh</publisher-name><year>2022</year></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendrioua</surname><given-names>L</given-names></name><etal/></person-group><article-title>Yeast AMP-activated protein kinase monitors glucose concentration changes and absolute glucose levels</article-title><source>J Biol Chem</source><year>2014</year><volume>289</volume><issue>18</issue><fpage>12863</fpage><lpage>12875</lpage><pub-id pub-id-type="pmcid">PMC4007474</pub-id><pub-id pub-id-type="pmid">24627493</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M114.547976</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Bernsen</surname><given-names>J</given-names></name></person-group><source>Dynamic thresholding of grey-level images</source><year>1986</year><fpage>125l</fpage><lpage>1255</lpage></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bodvard</surname><given-names>K</given-names></name><etal/></person-group><article-title>Continuous light exposure causes cumulative stress that affects the localization oscillation dynamics of the transcription factor msn2p</article-title><source>Biochimica et Biophysica Acta - Molecular Cell Research</source><year>2011</year><volume>1813</volume><fpage>358</fpage><lpage>366</lpage><pub-id pub-id-type="pmid">21167216</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>L</given-names></name><etal/></person-group><article-title>Frequency-modulated nuclear localization bursts coordinate gene regulation</article-title><source>Nature</source><year>2008</year><volume>455</volume><fpage>485</fpage><lpage>490</lpage><pub-id pub-id-type="pmcid">PMC2695983</pub-id><pub-id pub-id-type="pmid">18818649</pub-id><pub-id pub-id-type="doi">10.1038/nature07292</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Causton</surname><given-names>HC</given-names></name><etal/></person-group><article-title>Remodeling of yeast genome expression in response to environmental changes</article-title><source>Mol Biol Cell</source><year>2001</year><volume>12</volume><issue>2</issue><fpage>323</fpage><lpage>337</lpage><pub-id pub-id-type="pmcid">PMC30946</pub-id><pub-id pub-id-type="pmid">11179418</pub-id><pub-id pub-id-type="doi">10.1091/mbc.12.2.323</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conrad</surname><given-names>M</given-names></name><etal/></person-group><article-title>Nutrient sensing and signaling in the yeast saccharomyces cerevisiae</article-title><source>FEMS Microbiol Rev</source><year>2014</year><volume>38</volume><issue>2</issue><fpage>254</fpage><lpage>299</lpage><pub-id pub-id-type="pmcid">PMC4238866</pub-id><pub-id pub-id-type="pmid">24483210</pub-id><pub-id pub-id-type="doi">10.1111/1574-6976.12065</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crane</surname><given-names>MM</given-names></name><etal/></person-group><article-title>A microfluidic system for studying ageing and dynamic single-cell responses in budding yeast</article-title><source>PLoS ONE</source><year>2014</year><volume>9</volume><pub-id pub-id-type="pmcid">PMC4065030</pub-id><pub-id pub-id-type="pmid">24950344</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0100042</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalal</surname><given-names>CK</given-names></name><etal/></person-group><article-title>Pulsatile dynamics in the yeast proteome</article-title><source>Curr Biol</source><year>2014</year><volume>24</volume><issue>18</issue><fpage>2189</fpage><lpage>2194</lpage><pub-id pub-id-type="pmcid">PMC4203654</pub-id><pub-id pub-id-type="pmid">25220054</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2014.07.076</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duveau</surname><given-names>F</given-names></name><etal/></person-group><article-title>Yeast cell responses and survival during periodic osmotic stress are controlled by glucose availability</article-title><source>eLife</source><year>2024</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC10990491</pub-id><pub-id pub-id-type="pmid">38568203</pub-id><pub-id pub-id-type="doi">10.7554/eLife.88750</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garland</surname><given-names>M</given-names></name><etal/></person-group><article-title>Parallel compyting experiences with cuda</article-title><source>IEEE micro</source><year>2008</year><volume>28</volume><fpage>13</fpage><lpage>27</lpage></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gasch</surname><given-names>AP</given-names></name><etal/></person-group><article-title>Genomic expression programs in the response of yeast cells to environmental changes</article-title><source>Mol Biol Cell</source><year>2000</year><volume>11</volume><issue>12</issue><fpage>4241</fpage><lpage>4257</lpage><pub-id pub-id-type="pmcid">PMC15070</pub-id><pub-id pub-id-type="pmid">11102521</pub-id><pub-id pub-id-type="doi">10.1091/mbc.11.12.4241</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gasch</surname><given-names>AP</given-names></name><etal/></person-group><article-title>Single-cell rna sequencing reveals intrinsic and extrinsic regulatory heterogeneity in yeast responding to stress</article-title><source>PLoS Biology</source><year>2017</year><volume>15</volume><pub-id pub-id-type="pmcid">PMC5746276</pub-id><pub-id pub-id-type="pmid">29240790</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.2004050</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goh</surname><given-names>TY</given-names></name><etal/></person-group><article-title>Performance analysis of image thresholding: Otsu technique</article-title><source>Measurement: Journal of the International Measurement Confederation</source><year>2018</year><volume>114</volume><fpage>298</fpage><lpage>307</lpage></element-citation></ref><ref id="R15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gonzalez</surname><given-names>RC</given-names></name></person-group><source>Digital image processing</source><publisher-name>Pearson education india</publisher-name><year>2009</year></element-citation></ref><ref id="R16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Goodfellow</surname><given-names>I</given-names></name><etal/></person-group><source>Deep learning</source><publisher-name>MIT press</publisher-name><year>2016</year></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulev</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Nonlinear feedback drives homeostatic plasticity in H2O2 stress response</article-title><source>eLife</source><year>2017</year><volume>6</volume><elocation-id>e23971</elocation-id><pub-id pub-id-type="pmcid">PMC5438251</pub-id><pub-id pub-id-type="pmid">28418333</pub-id><pub-id pub-id-type="doi">10.7554/eLife.23971</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granados</surname><given-names>AA</given-names></name><etal/></person-group><article-title>Distributing tasks via multiple input pathways increases cellular survival in stress</article-title><source>eLife</source><year>2017</year><volume>6</volume><elocation-id>e21415</elocation-id><pub-id pub-id-type="pmcid">PMC5464774</pub-id><pub-id pub-id-type="pmid">28513433</pub-id><pub-id pub-id-type="doi">10.7554/eLife.21415</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granados</surname><given-names>AA</given-names></name><etal/></person-group><article-title>Distributed and dynamic intracellular organization of extracellular information</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2018</year><volume>115</volume><fpage>6088</fpage><lpage>6093</lpage><pub-id pub-id-type="pmcid">PMC6003323</pub-id><pub-id pub-id-type="pmid">29784812</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1716659115</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname><given-names>AS</given-names></name><name><surname>O’shea</surname><given-names>EK</given-names></name></person-group><article-title>Promoter decoding of transcription factor dynamics involves a trade-off between noise and control of gene expression</article-title><source>Molecular systems biology</source><year>2013</year><volume>9</volume><issue>1</issue><fpage>704</fpage><pub-id pub-id-type="pmcid">PMC4039373</pub-id><pub-id pub-id-type="pmid">24189399</pub-id><pub-id pub-id-type="doi">10.1038/msb.2013.56</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname><given-names>AS</given-names></name><etal/></person-group><article-title>High-throughput microfluidics to control and measure signaling dynamics in single yeast cells</article-title><source>Nature Protocols</source><year>2015</year><volume>10</volume><fpage>1181</fpage><lpage>1197</lpage><pub-id pub-id-type="pmcid">PMC4593625</pub-id><pub-id pub-id-type="pmid">26158443</pub-id><pub-id pub-id-type="doi">10.1038/nprot.2015.079</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>N</given-names></name><name><surname>O’Shea</surname><given-names>EK</given-names></name></person-group><article-title>Signal-dependent dynamics of transcription factor translocation controls gene expression</article-title><source>Nature Structural and Molecular Biology</source><year>2012</year><volume>19</volume><fpage>31</fpage><lpage>40</lpage><pub-id pub-id-type="pmcid">PMC3936303</pub-id><pub-id pub-id-type="pmid">22179789</pub-id><pub-id pub-id-type="doi">10.1038/nsmb.2192</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>N</given-names></name><etal/></person-group><article-title>Tunable signal processing through modular control of transcription factor translocation</article-title><source>Science</source><year>2013</year><volume>339</volume><issue>6118</issue><fpage>460</fpage><lpage>464</lpage><pub-id pub-id-type="pmcid">PMC3746486</pub-id><pub-id pub-id-type="pmid">23349292</pub-id><pub-id pub-id-type="doi">10.1126/science.1227299</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hersen</surname><given-names>P</given-names></name><etal/></person-group><article-title>Signal processing by the HOG MAP kinase pathway</article-title><source>Proc Nat Acad Sci USA</source><year>2008</year><volume>105</volume><issue>20</issue><fpage>7165</fpage><lpage>7170</lpage><pub-id pub-id-type="pmcid">PMC2386076</pub-id><pub-id pub-id-type="pmid">18480263</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0710770105</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>A</given-names></name><etal/></person-group><article-title>The i<italic>κ</italic>b-nf-<italic>κ</italic>b signaling module: temporal control and selective gene activation</article-title><source>science</source><year>2002</year><volume>298</volume><issue>5596</issue><fpage>1241</fpage><lpage>1245</lpage><pub-id pub-id-type="pmid">12424381</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>M-K</given-names></name></person-group><article-title>Visual pattern recognition by moment invariant</article-title><source>IRE transaction on information theory</source><year>1962</year><fpage>179</fpage><lpage>187</lpage></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquet</surname><given-names>M</given-names></name><etal/></person-group><article-title>Oscillatory nucleocytoplasmic shuttling of the general stress response transcriptional activators msn2 and msn4 in saccharomyces cerevisiae</article-title><source>Journal of Cell Biology</source><year>2003</year><volume>161</volume><fpage>497</fpage><lpage>505</lpage><pub-id pub-id-type="pmcid">PMC2172953</pub-id><pub-id pub-id-type="pmid">12732613</pub-id><pub-id pub-id-type="doi">10.1083/jcb.200303030</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Johannsen</surname><given-names>G</given-names></name><name><surname>Bille</surname><given-names>J</given-names></name></person-group><source>A threshold selection method using information measures</source><conf-name>ICPR’82</conf-name><year>1982</year><fpage>140</fpage><lpage>143</lpage></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapur</surname><given-names>JN</given-names></name><etal/></person-group><article-title>A new method for gray-level picture thresholding using the entropy of the histogram</article-title><year>1985</year></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kraskov</surname><given-names>A</given-names></name><etal/></person-group><article-title>Estimating mutual information</article-title><source>Physical Review E - Statistical Physics, Plasmas, Fluids, and Related Interdisciplinary Topics</source><year>2004</year><volume>69</volume><fpage>16</fpage><pub-id pub-id-type="pmid">15244698</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahav</surname><given-names>G</given-names></name><etal/></person-group><article-title>Dynamics of the p53-mdm2 feedback loop in individual cells</article-title><source>Nature genetics</source><year>2004</year><volume>36</volume><issue>2</issue><fpage>147</fpage><lpage>150</lpage><pub-id pub-id-type="pmid">14730303</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S</given-names></name><etal/></person-group><article-title>Control of nongenetic heterogeneity in growth rate and stress tolerance of saccharomyces cerevisiae by cyclic amp-regulated transcription factors</article-title><source>PLoS Genetics</source><year>2018</year><volume>14</volume><pub-id pub-id-type="pmcid">PMC6241136</pub-id><pub-id pub-id-type="pmid">30388117</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007744</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Combinatorial gene regulation by modulation of relative pulse timing</article-title><source>Nature</source><year>2015</year><volume>527</volume><issue>7576</issue><fpage>54</fpage><lpage>58</lpage><pub-id pub-id-type="pmcid">PMC4870307</pub-id><pub-id pub-id-type="pmid">26466562</pub-id><pub-id pub-id-type="doi">10.1038/nature15710</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippman</surname><given-names>SI</given-names></name><name><surname>Broach</surname><given-names>JR</given-names></name></person-group><article-title>Protein kinase A and TORC1 activate genes for ribosomal biogenesis by inactivating repressors encoded by Dot6 and its homolog Tod6</article-title><source>Proc Nat Acad Sci USA</source><year>2009</year><volume>106</volume><issue>47</issue><fpage>19928</fpage><lpage>19933</lpage><pub-id pub-id-type="pmcid">PMC2775034</pub-id><pub-id pub-id-type="pmid">19901341</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0907027106</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Logg</surname><given-names>K</given-names></name><etal/></person-group><article-title>Investigations on light-induced stress in fluorescence microscopy using nuclear localization of the transcription factor msn2p as a reporter</article-title><source>FEMS Yeast Research</source><year>2009</year><volume>9</volume><fpage>875</fpage><lpage>884</lpage><pub-id pub-id-type="pmid">19566686</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mettetal</surname><given-names>JT</given-names></name><etal/></person-group><article-title>The frequency dependence of osmo-adaptation in Saccharomyces cerevisiae</article-title><source>Science</source><year>2008</year><volume>319</volume><issue>5862</issue><fpage>482</fpage><lpage>484</lpage><pub-id pub-id-type="pmcid">PMC2916730</pub-id><pub-id pub-id-type="pmid">18218902</pub-id><pub-id pub-id-type="doi">10.1126/science.1151582</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Muñoz González</surname><given-names>AF</given-names></name></person-group><source>Phenotyping single cells of Saccharomyces cerevisiae using an end-to-end analysis of high-content time-lapse microscopy</source><publisher-name>Ph.D. thesis, University of Edinburgh</publisher-name><year>2023</year></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murugan</surname><given-names>A</given-names></name><etal/></person-group><article-title>Roadmap on biology in time varying environments</article-title><source>Phys Biol</source><year>2021</year><volume>18</volume><issue>4</issue><elocation-id>041502</elocation-id><pub-id pub-id-type="pmcid">PMC8652373</pub-id><pub-id pub-id-type="pmid">33477124</pub-id><pub-id pub-id-type="doi">10.1088/1478-3975/abde8d</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nasrudin</surname><given-names>MW</given-names></name><etal/></person-group><source>Moment invariants technique for image analysis and its applications: A review</source><publisher-name>IOP Publishing Ltd</publisher-name><year>2021</year><volume>1962</volume></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N</given-names></name></person-group><article-title>A threshold selection method from gray-level histograms</article-title><source>IEEE Transactions on Systrems, Man, and Cybernetics</source><year>1979</year><volume>SMC-9</volume><fpage>62</fpage><lpage>66</lpage></element-citation></ref><ref id="R41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>JR</given-names></name></person-group><source>Algorithms for image processing and computer vision</source><publisher-name>John Wiley &amp; Sons</publisher-name><year>2010</year></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petrenko</surname><given-names>N</given-names></name><etal/></person-group><article-title>Noise and interlocking signaling pathways promote distinct transcription factor dynamics in response to different stresses</article-title><source>Molecular Biology of the Cell</source><year>2013</year><volume>24</volume><fpage>2045</fpage><lpage>2057</lpage><pub-id pub-id-type="pmcid">PMC3681706</pub-id><pub-id pub-id-type="pmid">23615444</pub-id><pub-id pub-id-type="doi">10.1091/mbc.E12-12-0870</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pietsch</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Determining growth rates from bright-field images of budding cells through identifying overlaps</article-title><source>eLife</source><year>2023</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC10371227</pub-id><pub-id pub-id-type="pmid">37417869</pub-id><pub-id pub-id-type="doi">10.7554/eLife.79812</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>BC</given-names></name></person-group><article-title>Mutual information between discrete and continuous data sets</article-title><source>PLoS ONE</source><year>2014</year><volume>9</volume><pub-id pub-id-type="pmcid">PMC3929353</pub-id><pub-id pub-id-type="pmid">24586270</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0087357</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruone</surname><given-names>S</given-names></name><etal/></person-group><article-title>Multiple nhp6 molecules are required to recruit spt16-pob3 to form yfact complexes and to reorganize nucleosomes</article-title><source>J Biol Chem</source><year>2003</year><volume>278</volume><issue>46</issue><fpage>45288</fpage><lpage>45295</lpage><pub-id pub-id-type="pmid">12952948</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sunnåker</surname><given-names>M</given-names></name><etal/></person-group><article-title>Automatic generation of predictive dynamic models reveals nuclear phosphorylation as the key msn2 control mechanism</article-title><year>2013</year><pub-id pub-id-type="pmid">23716718</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tay</surname><given-names>S</given-names></name><etal/></person-group><article-title>Single-cell nf-κb dynamics reveal digital activation and analogue information processing</article-title><source>Nature</source><year>2010</year><volume>466</volume><issue>7303</issue><fpage>267</fpage><lpage>271</lpage><pub-id pub-id-type="pmcid">PMC3105528</pub-id><pub-id pub-id-type="pmid">20581820</pub-id><pub-id pub-id-type="doi">10.1038/nature09145</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tostevin</surname><given-names>F</given-names></name><name><surname>Ten Wolde</surname><given-names>PR</given-names></name></person-group><article-title>Mutual information between input and output trajectories of biochemical networks</article-title><source>Phys Rev Lett</source><year>2009</year><volume>102</volume><issue>21</issue><elocation-id>218101</elocation-id><pub-id pub-id-type="pmid">19519137</pub-id></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandromme</surname><given-names>M</given-names></name><etal/></person-group><article-title>Regulation of transcription factor localization : fine-tuning of gene expression</article-title><year>1996</year><pub-id pub-id-type="pmid">8851662</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Detecting and quantifying the nuclear translocation of transcription factors.</title><p>(A) A schematic showing a transcription factor entering the nucleus, regulating gene expression, and so cellular physiology through the proteins synthesised. <italic>Signal</italic><sup><italic>out</italic></sup> and <italic>Signal</italic><sup><italic>in</italic></sup> are the extracellular and intracellular signals that generate active transcription factor. (B) The responses of three transcription factors in budding yeast to changes in extracellular glucose. Msn2 is the master regulator of the general stress response; Dot6 is a repressor of ribosome biogenesis; and Mig1 represses regulons for metabolising alternative sugars to glucose. Scale bar = 4<italic>µm</italic>. (C) Seven methods to quantify the localisation of transcription factors. Left and right images show Msn2-GFP in a single cell. We indicate the pixels used by each method with colours, those with higher fluorescence in red and those with lower in blue. Areas and 2D Gaussian use ensembles of pixels. The first Hu moment, <italic>η</italic><sub>1</sub>, is a function of the pixels intensities at positions <italic>x</italic> and <italic>y</italic>. Scale bar = 1<italic>µm</italic>. (B-C) Images in non-carbon stress are for 2% glucose; those in carbon stress are for 0% glucose.</p></caption><graphic xlink:href="EMS199905-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Estimating the nuclear localisation and preparing images for analysis by a neural network.</title><p>Scale bar = 4<italic>µm</italic>. (A) Our pipeline for preparing images for analysis. Cells grow stably between two pillars in the ALCATRAS microfluidic device (<xref ref-type="bibr" rid="R8">Crane <italic>et al</italic>., 2014</xref>), which has hundreds of these traps. Using the BABY algorithm (<xref ref-type="bibr" rid="R43">Pietsch <italic>et al</italic>., 2023</xref>), we segment single cells from the bright-field images and find the pixels corresponding to these cells in the fluorescence images. With Otsu thresholding of the image of the nuclear protein Nhp6a-mCherry, we determine the pixels in the nucleus. For each cell, we therefore have a bright-field image, a fluorescence image showing the intracellular fluorescence from a tagged transcription factor, and a binary image identifying the nuclear pixels. (B) A schematic showing the definition of nuclear localisation, <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>. (C) The distribution of nuclear localisation typically has three peaks. We show the distribution for Msn2-GFP combining images from a time-lapse experiment where we switched extracellular glucose from 2% to 0%. The images are from just before and after the switch. (D) The convolutional neural network has three layers and predicts nuclear localisation using the maximum projection over Z stacks of both fluorescence and bright-field images as inputs.</p></caption><graphic xlink:href="EMS199905-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>The neural-network approach best identifies nuclear localisation from among the different methods.</title><p>(A) The neural network has the tightest distribution of errors when comparing predictions to the ground-truth level of nuclear localisation found from the Nhp6A-mCherry marker. Data are for Msn2-GFP, Dot6-GFP, and Mig1-GFP from cells in a step from 1% to 0% extracellular glucose. We plot the log<sub>2</sub> of the predicted to the ground-truth value and subtracted the mean over all cells, so that each method has an identical mean of zero. For the approach of Bodvard <italic>et al</italic>. (<xref ref-type="bibr" rid="R4">Bodvard <italic>et al</italic>., 2011</xref>), we ensured all values are positive by incrementing each by one. (B) Plotting the neural network’s prediction against the ground-truth level of nuclear localisation shows a tight linear relationship. The shading indicates numbers of cells on a <italic>log</italic><sub>10</sub> scale, with zero cells in black. The corresponding plots for the other methods are in <xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>.</p></caption><graphic xlink:href="EMS199905-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>The neural network best predicts single-cell time-series of nuclear localisation.</title><p>(A) The ground-truth time series of nuclear localisation for cells experiencing a drop in glucose from 1% to 0% after six hours of growth. Each row represents a single cell with the shading showing the normalised degree of nuclear localisation. For Msn2, <italic>n</italic> = 233; for Dot6, <italic>n</italic> = 360; for Mig1, <italic>n</italic> = 341. (B) The predicted mean level of nuclear localisation over all cells at each time point varies between the different methods (predictions for individual cells are in <xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). The grey curve corresponding to the neural network is so close to the ground truth that it is often obscured. We normalised each prediction to be between zero and one. For Petrenko <italic>et al</italic>.’s method (<xref ref-type="bibr" rid="R42">Petrenko <italic>et al</italic>., 2013</xref>), we inverted their prediction so that it behaves similarly to the others. (C-D) The root mean square error is defined as the root mean square of the difference between the ground-truth nuclear localisation and that identified by the method. (C) The root mean square errors at each time point for all cells. (D) The distributions of root mean square errors for each cell’s entire time series — each cell is tracked during the experiment. The root mean square error is calculated based on the predictions made at every time point where the cell is present. This process is repeated for each cell, resulting in a distribution of root mean square error values. Results for Msn2 are on the left and for Mig1 on the right.</p></caption><graphic xlink:href="EMS199905-f004"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Methods to quantify the nuclear localisation of transcription factors from single-cell fluorescence images. n the left and for Mig1 on the right.</title></caption><table frame="box" rules="groups"><thead><tr><th valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">Name</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Method</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Reference</th></tr></thead><tbody><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #ffffff"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #ffffff"/></tr><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #ffffff"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #ffffff"/></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Petrenko</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Mean of the pixels with the 20% highest intensities</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R42">Petrenko <italic>et al</italic>. 2013</xref> (<xref ref-type="bibr" rid="R42">Petrenko <italic>et al.</italic>, 2013</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Sunnåker</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Coefficient of variation of the pixel intensities</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R46">Sunnåker <italic>et al.</italic> 2013</xref><break/>(<xref ref-type="bibr" rid="R46">Sunnåker <italic>et al.</italic>, 2013</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Logg</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Ratio of the mean of the three highest pixels to the mean of the remaining<break/>pixels</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R35">Logg <italic>et al.</italic> 2009</xref> (<xref ref-type="bibr" rid="R35">Logg <italic>et al.</italic>, 2009</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Granados</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Ratio of the mean of the five highest pixels intensities to the median of the<break/>remaining pixels</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R19">Granados <italic>et al.</italic> 2018</xref><break/>(<xref ref-type="bibr" rid="R19">Granados <italic>et al.</italic>, 2018</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Bodvard</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Ratio of the median value of a smoothed Gaussian centred on the brightest<break/>pixel over the median of the remaining pixels</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R4">Bodvard <italic>et al.</italic> 2011</xref> (<xref ref-type="bibr" rid="R4">Bodvard<italic>et al.</italic>, 2011</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Cai Hao</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Difference of the mean of the five brightest pixels and the mean of the remaining pixels</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R5">Cai <italic>et al</italic>. 2008</xref> (<xref ref-type="bibr" rid="R5">Cai <italic>et al</italic>., 2008</xref>)<break/><xref ref-type="bibr" rid="R22">Hao <italic>et al</italic>. 2012</xref> (<xref ref-type="bibr" rid="R22">Hao and O’Shea, 2012</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Hu moments</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">First invariant moment <italic>η</italic><sub>1</sub></td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R26">Hu, M.-K. 1962</xref> (<xref ref-type="bibr" rid="R26">Hu, 1962</xref>)<break/><xref ref-type="bibr" rid="R39">Nasrudin <italic>et al</italic>. 2021</xref> (<xref ref-type="bibr" rid="R39">Nasrudin <italic>et al.</italic>, 2021</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Neural network</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Prediction by a regression convolutional neural network</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">This study</td></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><title>Image-processing methods to identify pixels in the nucleus from fluorescence images of a nuclear marker.</title></caption><table frame="box" rules="groups"><thead><tr><th valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">Name</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Method</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000">Reference</th></tr></thead><tbody><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #ffffff"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000"/><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #ffffff"/></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Ostu</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Global thresholding</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R40">Otsu N. 1978</xref> (<xref ref-type="bibr" rid="R40">Otsu, 1979</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Kapur</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Entropy thresholding</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R29">Kapur et al. 1985</xref> (<xref ref-type="bibr" rid="R29">Kapur <italic>et al.</italic>, 1985</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Johannsen</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Entropy thresholding</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R28">Johannsen et al. 1982</xref><break/>(<xref ref-type="bibr" rid="R28">Johannsen and Bille, 1982</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Bernsen</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Local thresholding</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R3">Bernsen J. 1986</xref> (<xref ref-type="bibr" rid="R3">Bernsen, 1986</xref>)</td></tr><tr><td valign="top" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Contrast</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000">Local thresholding</td><td valign="top" align="left" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000"><xref ref-type="bibr" rid="R41">Parker J. R. 2010</xref> (<xref ref-type="bibr" rid="R41">Parker, 2010</xref>)</td></tr></tbody></table></table-wrap></floats-group></article>