<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS199210</article-id><article-id pub-id-type="doi">10.1101/2024.10.01.615771</article-id><article-id pub-id-type="archive">PPR919654</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Sciphy: A Bayesian phylogenetic framework using sequential genetic lineage tracing data</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Seidel</surname><given-names>Sophie</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Zwaans</surname><given-names>Antoine</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Regalado</surname><given-names>Samuel</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Choi</surname><given-names>Junhong</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Shendure</surname><given-names>Jay</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Stadler</surname><given-names>Tanja</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biosystems Science and Engineering, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zürich</institution></institution-wrap>, <postal-code>CH-4058</postal-code><city>Basel</city>, <country country="CH">Switzerland</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/002n09z45</institution-id><institution>Swiss Institute of Bioinformatics</institution></institution-wrap>, <postal-code>CH-1015</postal-code><city>Lausanne</city>, <country country="CH">Switzerland</country></aff><aff id="A3"><label>3</label>Department of Genome Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>University of Washington</institution></institution-wrap>, <city>Seattle, WA</city>, <country country="US">USA</country></aff><aff id="A4"><label>4</label>Developmental Biology Program, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02yrq0923</institution-id><institution>Memorial Sloan Kettering Cancer Center</institution></institution-wrap>, <city>New York, NY</city>, <country country="US">USA</country></aff><aff id="A5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/006w34k90</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap>, <city>Seattle, WA</city>, <country country="US">USA</country></aff><aff id="A6"><label>6</label>Seattle Hub for Synthetic Biology, Seattle, WA, USA</aff><aff id="A7"><label>7</label>Brotman Baty Institute for Precision Medicine, Seattle, WA, USA</aff><aff id="A8"><label>8</label>Allen Discovery Center for Cell Lineage Tracing, Seattle, WA, USA</aff><author-notes><corresp id="CR1">
<label>*</label>For correspondence: <email>sophie.seidel@bsse.ethz.ch,tanja</email>. <email>stadler@bsse.ethz.ch</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>05</day><month>10</month><year>2024</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>10</month><year>2024</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">CRISPR-based lineage tracing offers a promising avenue to decipher single cell lineage trees, especially in organisms that are challenging for microscopy. A recent advancement in this domain is lineage tracing based on sequential genome editing, which not only records genetic edits but also the order in which they occur. To capitalize on this enriched data, we introduce SciPhy, a simulation and inference tool integrated within the BEAST 2 framework. SciPhy utilizes a Bayesian phylogenetic approach to estimate time-scaled phylogenies and cell population parameters. After validating SciPhy using simulations, we apply it to lineage tracing data obtained from a monoclonal culture of HEK293T cells for which we estimate time-scaled trees together with cell proliferation rates. We compare SciPhy to the lineage reconstruction based on a widely used clustering method, UPGMA, and find that the UPGMA-reconstructed lineage trees differ from SciPhy trees in some key aspects of tree structure; in particular, SciPhy trees stand out for their later estimated cell division times. In addition, SciPhy reports uncertainty as well as proliferation rates, neither of which are available within a UPGMA analysis. This study showcases the application of advanced phylogenetic and phylodynamic tools to explore and quantify cell lineage trees, laying the groundwork for enhanced and confident analyses to decode the complexities of biological development in multicellular organisms. SciPhy’s codebase is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/azwaans/SciPhy">https://github.com/azwaans/SciPhy</ext-link>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The interplay between cell division, cell death and differentiation is at the core of the development of all multicellular organisms. Tracing cell populations and their lineage relationships via DNA-based molecular recording has recently emerged as a powerful approach to study this complex process (<xref ref-type="bibr" rid="R34">VanHorn and Morris (2021)</xref>). Amongst the wide range of technologies that have been developed to record such lineage information into the genome, approaches that rely on CRISPR-Cas9 have stood out for their ability to generate stochastic, heritable indels in genetic barcodes during development and proliferation (<xref ref-type="bibr" rid="R24">McKenna et al. (2016)</xref>; <xref ref-type="bibr" rid="R25">McKenna and Gagnon (2019)</xref>; <xref ref-type="bibr" rid="R6">Chan et al. (2019)</xref>; <xref ref-type="bibr" rid="R20">He et al. (2022)</xref>; <xref ref-type="bibr" rid="R5">Bowling et al. (2020)</xref>; <xref ref-type="bibr" rid="R1">Alemany et al. (2018)</xref>; <xref ref-type="bibr" rid="R32">Spanjaard et al. (2018)</xref>). However, the reliance of early versions of this approach on <italic>unordered indels</italic> as characters, together with the short time window for the recording process, limit the reconstruction of highly resolved cell ‘lineage trees’ (see Glossary, Tab. 1) (<xref ref-type="bibr" rid="R23">Loveless et al. (2021)</xref>; <xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>).</p><p id="P3">Recent work (<xref ref-type="bibr" rid="R23">Loveless et al. (2021)</xref>, <xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>) addresses some of these limitations by introducing prime-editing based recording systems resulting in <italic>ordered insertions</italic> that enable lineage tracing over prolonged periods of time. These methods rely on sequential insertions of nucleotide sequences at target sites mediated by the prime editor and prime editing guide RNA (pegRNA) (<xref ref-type="bibr" rid="R2">Anzalone et al. (2019)</xref>), where each insertion step at a target site has a twofold effect: (1) deactivation of that site and (2) activation of a following site for a subsequent editing step. This property not only ensures the irreversible accumulation of edits to a constant number of targets, but also provides a record of the order of all editing events, encoded in the relative direction of edits within the target. These new lineage tracing technologies have the potential to enable the reconstruction of accurate, highly resolved single cell lineage trees.</p><p id="P4">However, the reconstruction of lineage trees using such data to date <xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>; <xref ref-type="bibr" rid="R23">Loveless et al. (2021)</xref> has relied on UPGMA (Unweighted Pair Group Method with Arithmetic Mean, <bold><italic>Sokal et al. (1963</italic></bold>)) in tandem with custom distance metrics. This approach is agnostic to specific properties of the editing process, such as variable propensities of introducing particular inserts and variable edit insertion rates (see Glossary, Tab. 1). Further, UPGMA, being a clustering method based on pairwise distance metrics, only leverages pairwise distances between combinations of edits per cell, ignoring all higher order information (<xref ref-type="bibr" rid="R16">Felsenstein (2004)</xref>). In contrast, Bayesian phylogenetic inference frameworks developed for unordered edit lineage tracing data (<xref ref-type="bibr" rid="R28">Seidel and Stadler (2022)</xref>) enable the estimation of lineage trees with cell division times (see Glossary, Tab. 1) by relying on mechanistic models of barcode generation. This approach was shown to provide accurate lineage reconstruction, attributed to the ability to explicitly incorporate <italic>a priori</italic> knowledge of both the editing process as well as the experimental conditions under which traced cell populations were studied.</p><p id="P5">In this article, we derive a time-dependent mechanistic model of sequential insertion based editing (ordered inserts) for lineage tracing data. We implement this model into a new inference framework, coined ‘SciPhy’ <bold>S</bold>equential <bold>C</bold>as-9 <bold>I</bold>nsertion based <bold>Phy</bold>logenetics, made available in Bayesian inference software BEAST 2 (<xref ref-type="bibr" rid="R4">Bouckaert et al. (2014)</xref>), which uses a Markov Chain Monte Carlo framework to jointly estimate time-scaled lineage trees (see Glossary, <xref ref-type="table" rid="T1">Tab. 1</xref>) and editing dynamics. Additionally, the integration of our model in BEAST 2 makes phylodynamic analyses of single cell population dynamics directly accessible to the community.</p><p id="P6">We showcase the versatility of our validated framework with a comprehensive analysis of a lineage tracing dataset derived from a monoclonal (see Glossary, <xref ref-type="table" rid="T1">Tab. 1</xref>) culture of HEK293T cells (<xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>). Our analysis reveals that complex editing dynamics govern the recording process in the dataset and estimate the growth rates of the cell populations over time. We highlight significant differences in our lineage tree estimates compared with those obtained using the UPGMA clustering method. Together, our explorations of the dataset underline that the choice of lineage reconstruction method has crucial implications on both the cellular relationships and growth dynamics inferred using sequential lineage tracing data.</p></sec><sec id="S2" sec-type="results"><title>Results</title><p id="P7">We introduced a mechanistic editing model and likelihood calculation for prime-editing based lineage tracing data with sequential editing as the core component of SciPhy (<xref ref-type="fig" rid="F5">Fig. 5</xref>). This model assumes that stably integrated barcodes accumulate edits sequentially and irreversibly at a constant rate, reflecting the Cas9 nicking rate. Subsequent pegRNA-mediated insertions at the nicked sites occur with varying probabilities. We derived a phylogenetic likelihood to calculate the probability of observing a specific barcode alignment given a phylogeny and SciPhy parameters. Details of the model, its parameterisation, and Bayesian inference implementation in BEAST 2 are in <xref ref-type="sec" rid="S7">Methods and Materials</xref>.</p><sec id="S3"><title>In-silico validation</title><p id="P8">We validated our Bayesian method, SciPhy, using well-calibrated simulations (<xref ref-type="bibr" rid="R11">Dawid (1982)</xref>), to ensure that it draws samples from the correct posterior distribution. This process involved simulating trees and a set of edited barcodes for each cell, and using them as input data to estimate the editing parameters under the SciPhy model. For each of the simulations, editing parameters were drawn from distributions chosen to be representative of a broad range of realistic editing dynamics. These same distributions are in turn used as priors in the inference (see <xref ref-type="sec" rid="S7">Methods</xref> for details).</p><p id="P9">We calculated the coverage for each editing model parameter, defined as the fraction of datasets for which SciPhy inferred a 95% highest posterior density (HPD) interval containing the true (simulation) parameter. The coverages for all parameters fall within the expected range (<xref ref-type="bibr" rid="R26">Mendes et al. (2024)</xref>) (<xref ref-type="supplementary-material" rid="SD1">Supplementary table 5)</xref>, demonstrating that our method is correctly implemented.</p><p id="P10">In addition, we plotted the simulated (true) parameters against the estimated parameters (<xref ref-type="fig" rid="F2">Fig. 2</xref>) to investigate the inference power of our method across a range of parameter values. The correlation for the editing rate (Pearson’s correlation coefficient on the median estimates R=0.99, 95 % confidence interval 0.995,0.998]) and the insertion probabilities (Pearson’s correlation coefficient on the median estimates R=0.98, 95% confidence interval [0.978, 0.982]) confirms that SciPhy is able to extract meaningful signal from the data.</p></sec><sec id="S4"><title>Phylodynamic analysis of monoclonal expansion</title><p id="P11">We analyze a dataset where DNA Typewriter was used to trace lineage in a 25-day monoclonal expansion of HEK293T cells (<xref ref-type="fig" rid="F3">Fig. 3, A</xref>). Filtering of the data was performed as previously (<xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>, see <xref ref-type="sec" rid="S7">Methods</xref> for details). Using SciPhy, we conducted a phylodynamic analysis to estimate the lineage tree, editing dynamics of the DNA Typewriter tapes as well as the growth dynamics of the sampled population of cells (see <xref ref-type="sec" rid="S7">Methods</xref> for details).</p><p id="P12">We estimated the editing model parameters of SciPhy for this dataset, namely the overall insertion probabilities and an editing rate for each tape construct. Our estimates reveal that there is substantial variation in the insertion probabilities between different inserts (<xref ref-type="fig" rid="F3">Fig. 3, B</xref>). Notably, the ‘CAT’ insert emerged as the most probable, with a probability of 16%, whereas the least probable insert, ‘GCG’, had a probability of less than 1%. Although this phenomenon, which could be due to differential expression of integrated pegRNAs or differential efficiencies for various hexamers, was documented in the initial publication (<xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>), the UPGMA tree building method used there did not take it into account. Under the SciPhy model, we infer that when an insert is introduced, there is approximately a 50% chance that it will be one of the four most prevalent inserts (CAT, CCG, GCC, ATA). Consequently, these particular edits have a high chance of being introduced concurrently in otherwise independent lineages. In contrast with UPGMA, SciPhy can take this process into account by modelling these insert probabilities, potentially avoiding the reconstruction of false lineage relationships.</p><p id="P13">In addition to insertion probabilities, we also estimate an editing rate or clock rate for each target synthetically integrated into the genomic DNA, referred to as ‘DNA Tape’, or ‘tape’ for short, which denotes the rate at which inserts are introduced at target sites within that tape (<xref ref-type="fig" rid="F3">Fig. 3, C</xref>). Our estimates reveal clock rates of around 0.15 d<sup>−1</sup> for the majority of tapes. This rate corresponds to an average of 4 edits per tape over the entire experiment, a value that aligns with our dataset observations (see <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 1</xref>).</p><p id="P14">A point of interest is that all four of the truncated tapes, i.e. tapes with less than 5 target sites (see <xref ref-type="sec" rid="S7">Methods</xref> for details), were found to possess elevated clock rates (<xref ref-type="fig" rid="F3">Fig. 3, C</xref>, first 4 rates). Among these, the most truncated tape, ‘TTCACGTA’ —shortened to just two sites— had the highest rate. The observed pattern of editing rate ordering by tape length was unexpected under a null-model where all tapes have similar editing rates independent of tape length. We therefore asked whether early edits occur at a different rate from late edits. We compiled a dataset in which all tapes were shortened to length two and compared the estimated editing rates with those of the original data encompassing all sites (<xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 2</xref>). Interestingly, the 2x tape “TTCACGTA” is edited the fastest in both analyses, indicating that its elevated editing rate is not due to the first two edits occurring faster across tapes of any length. We then compared the 4x and the 5x tapes. In the analysis using all sites, the three highest editing rates among the 4x and 5x tapes were all 4x tapes. This result is statistically significant under the assumption of equal rate (p(k=3)=0.005, see <xref ref-type="sec" rid="S7">Methods</xref> for test details). However, in the analysis using only 2 sites, this order was lost, with only one 4x tape among the three tapes with fastest editing rates. This result was not statistically significant under the assumption of equal rates (p(k=1)=0.5). Therefore, given the editing rate estimates under SciPhy, the difference in editing rate between 4x tapes and 5x tapes may be due to a difference in editing speed across the last 2-3 sites. This difference could equally be caused by the fifth site being edited at a slower rate or the third and fourth sites in the 4x truncated barcodes acquiring edits at a faster rate.</p><p id="P15">Along with estimating the editing model, we studied the growth dynamics of the HEK293T cell population by fitting a birth-death-sampling model to the set of sequences. These sequences are a subsample of 1000 cells from a population reported to consist of approximately 1.2 * 10<sup>6</sup> cells <xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>. To incorporate this knowledge, we initially fixed the sampling proportion to 0.0008, assuming a constant population growth throughout the experiment. Under this model, we estimated a cell population growth rate between 0.42 and 0.47 days<sup>−1</sup>(95% highest posterior density (HPD) interval, see <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 10, C</xref>) “Sciphy + Fixed sampling”), corresponding to doubling times of 35 to 40 hours. This implies an average of ≈ 10<sup>5</sup> ± 10<sup>5</sup> (mean ±σ) cells at the end of the experiment under a model of exponential growth, which is an order of magnitude smaller than the reported 1.2 &lt; 10<sup>6</sup> cells. After confirming that this estimate was driven by the data in tape alignments (see <xref ref-type="supplementary-material" rid="SD1">Appendix Sampling from prior</xref>), we hypothesized that this disagreement may stem from a model misspecification, rather than signal in the data. Therefore, we relaxed two of the main assumptions made in our model separately: first, the assumption of constant growth over the experimental period and, second, the assumption that we have accurate knowledge of the true sampling proportion.</p><p id="P16">First, we ran the same analysis with piecewise constant birth and death rates allowed to vary every two days over the timeline of the experiment. The estimated growth rates imply a pattern where the median growth rate is highest during the first 2 days of the experiment, with a median growth rate of 1.69 d<sup>−1</sup> or doubling time of 9.6 hours (95% HPD of growth rate [0.57,2.76] d<sup>−1</sup>), and declines for 5 days after which it stabilizes around 0.3 d<sup>−1</sup> until the end of the experiment (see Appendix Fig. 9). Under this set of rates, the cell population grows to an expected size of ≈ 9 * 10<sup>5</sup> cells, closer to the observed 1.2 * 10<sup>6</sup> cells. However, the fast doubling time in the first days is unrealistic for HEK293T cell growth from a single cell. It should further be noted that a constant growth rate over the experimental period is not excluded under these results.</p><p id="P17">Second, we relaxed our assumption on accurate knowledge of the sampling proportion, by jointly estimating the sampling proportion along with the growth rate. In this analysis we inferred a growth rate between 0.49 and 0.58 days<sup>−1</sup>, or a doubling time that ranges between 28 and 33 hours (95% HPD interval, (<xref ref-type="fig" rid="F3">Fig.3, D</xref>). This doubling time is consistent with documentation for the HEK293T cell line from which these cells were derived <xref ref-type="bibr" rid="R3">Biodata (2024)</xref>, and leads to an average population size contained between 2.5 * 10<sup>5</sup> and 2.3 * 10<sup>6</sup> (95% HPD) after 25 days, which agrees with the reported 1.2 * 10<sup>6</sup> cells.</p><p id="P18">Interestingly, the inferred sampling proportion under the last model is approximately four to 16 times lower than initially assumed (95% HPD interval: [5.2×10<sup>−5</sup>, 2.2×10<sup>−4</sup>], <xref ref-type="fig" rid="F3">Fig. 3, E</xref>). Under the birth-death model parameterized for this analysis, a lower-than-expected sampling proportion may stem from measurement errors in estimating the total cell population size —potentially caused,e.g., by cell clumping during counting— or from non-uniform sampling, such as biases in cell selection, sequencing, or filtering. Given that the reported population size of 1.2 ù 10<sup>6</sup> cells was measured using both a haemocytometer and a cell counter, which should provide reliable counts, it is more plausible that biases in the sampling process led to this reduced estimate. In such cases, the inferred sampling proportion likely reflects an ‘effective’ sampling proportion, accounting for these underlying biases rather than the true biological sampling proportion.</p><p id="P19">Taken together, the three analyses presented here suggest that a model of constant growth adequately describes the population dynamics under study.</p></sec><sec id="S5"><title>Comparison to state-of-the-art</title><p id="P20">We next sought to compare the SciPhy posterior trees against current approaches that use UPGMA clustering which is a faster method but the reliance of its estimates is still unclear. To investigate whether both methods estimate similar ancestral relationships between cells, we compare the trees with respect to their topology. We employed the Robinson Foulds distance (<xref ref-type="bibr" rid="R27">Robinson and Foulds (1981)</xref>) to compute pairwise tree distances and visualize them in 4 coordinates (<xref ref-type="fig" rid="F4">Fig. 4A</xref> and <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 3, 4, and 5</xref>). Within the Robinson Foulds metric space, the UPGMA topology overlaps with SciPhy posterior tree estimates in all pairwise coordinates but the first two ((<xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 3</xref>), implying that both methods reconstruct similar relationships between cells. Due to the Robinson Foulds metric’s inherent constraints in distinguishing fine topological features, we proceeded to explore these patterns using the more discriminative Phylogenetic Information and Clustering Information distance metrics (<xref ref-type="bibr" rid="R29">Smith (2020)</xref>). For the Phylogenetic Information distance metric, we find that the UPGMA tree falls separate from our inferred set of posterior tree topologies (<xref ref-type="fig" rid="F4">Fig. 4 A</xref>,) in half of the pairwise coordinates (coordinates 1-2, 1-3, 1-4, <xref ref-type="fig" rid="F4">Fig. 4 A</xref> and see <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 5</xref>). Consistently, using the Clustering Information distance metric, we find that the UPGMA tree falls clearly separate or close to the periphery of our set of inferred trees in two out of 6 pairwise coordinates (coordinates 1-2, 1-4, (<xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 4</xref>)). Together, these results show that while overarching topological features are likely captured by both methods, SciPhy recovers distinct cellular relationships when looking at a finer resolution.</p><p id="P21">Next, we evaluated SciPhy, which is specifically designed to estimate time-scaled phylogenies, against UPGMA with respect to branch length inference. UPGMA produces trees with branches that are relative in length and not anchored to an absolute time scale. In contrast, SciPhy tree branches are calibrated in absolute time, as it incorporates the experiment’s duration into its phylodynamic model, thus providing a temporal reference for the branch lengths. For fair comparison, we adapted the UPGMA tree to include temporal information by scaling it in three different ways. First, we scale its root (the most recent common ancestor (MRCA) of all cells, and representing the timing of the first division event) to 25 days to match the experiment duration (labelled “UPGMA”). However, it is likely that this first division event happened after the start of the experiment. Therefore, we also scale the UPGMA root to the median root height of SciPhy trees (labelled “UPGMA root”). Finally, we also estimate branch lengths using SciPhy on the fixed UPGMA topology (labelled “UPGMA + SciPhy”).</p><p id="P22">Adopting a similar approach as before, but using the weighted Robinson Foulds distance that is sensitive to both tree topology and branch lengths, we observe that UPGMA trees diverge from trees in our posterior set in all pairwise coordinates (see <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 6</xref>). Given the topological similarities previously noted, this implies that UPGMA predicts branch lengths patterns distinct to those in trees from SciPhy’s posterior set.</p><p id="P23">To better show how the branch lengths differ, we display the total number of lineages through time (LTT) for each reconstructed phylogeny (<xref ref-type="fig" rid="F4">Fig. 4 B</xref>). Notably, SciPhy posterior trees display a slower increase in the number of lineages compared to UPGMA. For example, 500 lineages are reached after 5.5 days according to the UPGMA tree (5.7 days in the scaled UPGMA) but only after a median of 8.8 days (95% HPD interval of [8.0, 9.7]) days under SciPhy. Additionally, in the UPGMA tree, the final number of 1000 lineages is reached 1.1 (median, 95% HPD interval [0.31, 2.1]) days earlier compared to trees estimated by SciPhy. These distinctions result in the absence of overlap in LTT between the SciPhy tree posterior and the UPGMA tree for the majority of the experimental duration. Branch lengths are the key signal informing population dynamics in phylodynamic analyses. Observing the significant divergence in branch lengths estimated by UPGMA and SciPhy, we investigated the impact on growth rate estimates. We compared how the growth rate estimates differ based on the input trees used: (1) the posterior distribution of trees (“SciPhy”) (2) the UPGMA tree scaled to the full experimental duration (“UPGMA”), (3) the UPGMA tree scaled to the median root height of SciPhy trees “UPGMA root”) and (4) the UPGMA tree with SciPhy-estimated branch lengths (“UPGMA + SciPhy”) ((<xref ref-type="fig" rid="F4">Fig. 4 C</xref>). The median growth rate inferred on the fixed UPGMA trees (95% HPD interval of [0.54, 0.60] (2), [0.55, 0.60] (3) and [1.17,1.30] (4)) is higher than the one inferred under SciPhy. Notably, the growth rate inferred on the UPGMA topology with branch lengths scaled with SciPhy is the highest, leading to doubling times between 18.4 and 20.5 hours, which excludes reported values for this cell line.</p><p id="P24">Overall, these results highlight that our modelling framework results in differences in the estimated tree topologies between UPGMA and SciPhy trees, although the extent of these disparities is challenging to quantify. There are notable differences in the timing of the branching events, which can lead to qualitative differences in the estimated growth rates.</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P25">In this study, we introduced an editing model, edit sequence simulator and likelihood calculation tailored for lineage recordings based on sequential genome editing. We have packaged our model into ‘SciPhy’, which stands for <bold>S</bold>equential <bold>C</bold>as-9 <bold>I</bold>nsertion based <bold>Phy</bold>logenetics, and integrated it into the popular BEAST 2 Bayesian Phylogenetics framework. This integration empowers SciPhy users to specify complex editing dynamics, for example varying editing rates across DNA Tapes as done here or along tree branches (using e.g. relaxed clock models <xref ref-type="bibr" rid="R13">Drummond et al. (2006)</xref>, <xref ref-type="bibr" rid="R14">Drummond and Suchard (2010)</xref>) which was not done here. Additionally, it facilitates the adoption of more nuanced models of cell development, allowing for cell type dependent division and differentiation rates using multitype models <xref ref-type="bibr" rid="R37">Vaughan et al. (2014)</xref>; <xref ref-type="bibr" rid="R21">Kühnert et al. (2016)</xref> or permitting rate variations over time using piecewise-constant rates <xref ref-type="bibr" rid="R12">Drummond et al. (2005)</xref>; <xref ref-type="bibr" rid="R33">Stadler et al. (2013)</xref>. The BEAST 2 platform is increasingly attracting developers interested in contributing to single-cell related problems (<xref ref-type="bibr" rid="R28">Seidel and Stadler (2022)</xref>; <xref ref-type="bibr" rid="R7">Chen et al. (2022)</xref>; <xref ref-type="bibr" rid="R22">Lewinsohn et al. (2022)</xref>) and we foresee that the support for single-cell related analyses will continue to grow in the future.</p><p id="P26">Our evaluations of SciPhy on experimental datasets demonstrate its ability to capture complex editing dynamics, such as the presence of preferential insertions and editing rate variation between tapes, patterns that are prevalent in both sequential lineage datasets we analysed and those from other lineage tracing technologies <xref ref-type="bibr" rid="R10">Chow et al. (2021)</xref>; <xref ref-type="bibr" rid="R28">Seidel and Stadler (2022)</xref>; <xref ref-type="bibr" rid="R24">McKenna et al. (2016)</xref>; <xref ref-type="bibr" rid="R17">Feng et al. (2021)</xref>. SciPhy, being a mechanistic editing model can directly account for these factors and even use the signal from tapes being edited at different rates as signal for branch length estimation.</p><p id="P27">We compared SciPhy to the phylogenetic reconstruction method used on both previously published analyses, UPGMA clustering. UPGMA clustering does not account for preferential insertions nor different edit rates for different tapes. Comparing SciPhy to one UPGMA approach (<xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>), we find that some -but not all- aspects of the tree topology are captured in both SciPhy posterior trees and the UPGMA tree. Notably, the branch lengths are significantly different, which we showed impacts the downstream inference of the growth rate of the cell population. This is likely to also impact other parameters one may wish to estimate from cell phylogenies in the future, such as cell type differentiation rates. In the absence of a ground-truth lineage tree in this dataset, we cannot make conclusive statements about the correctness of either method. However, considering that SciPhy more accurately models the data generation process, we posit that it more effectively estimates the lineage tree, both with respect to the tree topology, cell division timings and downstream cell population estimates.</p><p id="P28">For the dataset analysed in our study, we used phylodynamic models to estimate the growth behaviour of cell populations based on SciPhy’s derived posterior distribution of timed trees. Applied to the study of HEK293T cells, this approach showed that sequential lineage tracing data alone contains signal for the growth rate characteristic of this cell line. The use of SciPhy allowed to extracted relevant and previously inaccessible insights from the lineage tracing data.</p><p id="P29">While SciPhy offers promising avenues, it has some limitations. The size of tree space scales exponentially with the number of cells and Bayesian MCMC methods searching tree space do not converge for trees with more than around 1000 tips. Even for a dataset with 1000 cells, Bayesian phylogenetic inference requires evaluating the likelihood in the range of billions of iterations to reach convergence. Thus, despite the likelihood calculation scaling linear with the number of tips, speed-ups of the likelihood calculation can bring large benefits. We have achieved considerable improvements on the runtime of individual computations of the likelihood with caching and multi-thread parallelisation, though the empirical data analysis still required ~15 days, and would benefit from a further reduction in run-time. For future improvements, we aim to further accelerate the likelihood calculation using software optimizations or approximations, and expedite convergence on large datasets by confining tree space.</p><p id="P30">Another limitation shared by most CRISPR-based lineage tracing data is that target or DNA Tape sequences are prone to dropout (in other words, not recovered in each cell), which SciPhy does not currently model. This dropout is a consequence of the technologies used to readout lineage recordings, such as single-cell RNA-seq, that result in loss of tape sequences for some cells. Current approaches often neglect cells with incomplete DNA Tape sets, resulting in data loss. Therefore, future work should integrate a dropout model accommodating tape absence such that data loss can be avoided.</p><p id="P31">Toward the goal of reconstructing more accurate lineage trees, many challenges remain. One of the pressing concerns is the refinement of experimental design to enhance the signal quality in lineage tracing data. Therefore, future studies could systematically compare the latest lineage tracing data generated with sequential genome editing against previous unordered methods, both with respect to the inference of the tree topology and the time estimates. As the field progresses, such comparisons could serve as essential benchmarks and guide experimental efforts.</p><p id="P32">Lineage recorders based on sequential genome editing present a notable advancement as they do not only include a number of edits but also the order in which they occur. With SciPhy, we present a model that directly captures and uses this detailed information which we expect to lead to improved tree reconstruction compared to commonly-used clustering tools. We see great promise that sequential lineage recorders which can co-track cellular signals <xref ref-type="bibr" rid="R8">Chen et al. (2024)</xref> will be developed in the future. In parallel, SciPhy can be expanded to inform about the timing of such recorded signalling events in addition to the single cell trees, leading to developmental insight in ever-greater detail.</p></sec><sec id="S7" sec-type="methods | materials"><title>Methods and Materials</title><sec id="S8"><title>Editing model for barcodes with ordered inserts</title><p id="P33">We present a model that captures the editing dynamics underlying the generation of sequential lineage tracing data using DNA recording systems such as the ones recently developed by <xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>; <xref ref-type="bibr" rid="R23">Loveless et al. (2021)</xref>. In these systems, cells carry stably integrated barcodes or “tapes”, which are contiguous arrays of CRISPR-Cas9 target sites. Within these tapes, target sites are sequentially made amenable to prime editing, resulting in the ordered accumulation of inserts. We consider an experimental setup starting with a single cell carrying several of these unedited tapes. As this cell and its offspring undergo proliferation, their tapes experience editing. At the end of the experiment, single cells are sampled and their tapes sequenced. Aligning sequenced tapes to their corresponding, unaltered tape reveals genetic modifications accumulated during the experiment. In the following, we detail the notations and assumptions we use to model this process.</p><p id="P34">Consider the following setup. Each cell carries <italic>k</italic> tapes that independently undergo editing. Each unedited tape is an array of N target sites, numbered from 1 to N. Each site can acquire a single insertion or edit, with M different inserts available.</p><p id="P35">Our model is defined as follows: <list list-type="order" id="L1"><list-item><p id="P36">Initially, only a tape’s first site is susceptible to editing. Subsequent sites are edited sequentially: editing at a site <italic>i</italic><sub>1&lt;<italic>i</italic>≤<italic>N</italic></sub> is only possible if its preceding site <italic>i</italic> − 1 is already edited.</p></list-item><list-item><p id="P37">Editing is a two-step process :</p><list list-type="alpha-lower" id="L2"><list-item><p id="P38">Step 1: The Cas9 prime editor introduces cuts at the target sites in a time-dependent manner at rate <italic>r</italic>, called the editing rate or clock rate. This means editing follows a bounded Poisson process which stops once <italic>N</italic> edits have occurred.</p></list-item><list-item><p id="P39">Step 2: pegRNA mediated insertions following cut events are instantaneous. The set Γ of <italic>M</italic> possible insertions is predefined and denoted as: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mtext>Γ</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P40">Given a cut event, the probability of adding insert <italic>γ</italic><sub><italic>i</italic></sub> is <italic>f</italic><sub><italic>i</italic></sub> (with <italic>η</italic> := (<italic>f</italic><sub>1</sub>, <italic>f</italic><sub>2</sub>, …, <italic>f</italic><sub><italic>M</italic></sub>)), allowing for some insertions to have higher probabilities than others. We additionally assume that insertions operate independently - an insertion at a previous site does not influence the insertion probability at the currently active site.</p></list-item></list></list-item><list-item><p id="P41">Editing of any target site is irreversible.</p></list-item></list></p><p id="P42">From the model definition, if follows that the number of edits introduced in each independent tape is Poisson distributed. However, the distribution of the total number of edits per cell is not guaranteed to show features of a classic, unimodal Poisson distribution, because it is also influenced by the shared ancestry of the sampled cell population and its growth patterns (see <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 7 and 8</xref>).</p><p id="P43">Formally, for an array of length N, this model of editing is a continuous time Markov chain on state space Ω of all possible insertions and parameters <italic>r, η</italic>. These states are all possible finite sequences of length <italic>n</italic> ≤ <italic>N</italic>, or n-tuples of ordered insertions, that we denote as: <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mtext>Γ,</mml:mtext></mml:mrow></mml:math></disp-formula></p><p id="P44">where subscript <italic>i</italic> denotes the insertion site in the tape, i.e. its order. Note that the empty tuple Ø represents the unedited state or starting state for all k tapes sampled per cell and the fully edited tape is an absorbing state of the Markov chain.</p><p id="P45">Let <italic>Y</italic><sub><italic>t</italic></sub> be the state of an array at time <italic>t</italic> after the start of the experiment. Given an array state <italic>Y</italic><sub><italic>t</italic></sub> = <italic>a</italic> and its state after a time interval Δ<italic>t, Y</italic><sub><italic>t</italic>+Δ<italic>t</italic></sub> = <italic>b</italic>, we denote the tuple of inserts added to <italic>a</italic> to result in <italic>b</italic> as <italic>c</italic>. Specifically, <italic>c</italic> represents the elements in b that are not in a, which can be expressed as <italic>c</italic> = <italic>b</italic>\<italic>a</italic>. The size of this tuple, denoted as |c|, corresponds to the number of inserts introduced between states a and b.</p></sec><sec id="S9"><title>Transition probabilities</title><p id="P46">We denote the transition probability between states a and b under the model introduced above as <italic>P</italic><sub><italic>a</italic>,<italic>b</italic></sub>(Δ<italic>t</italic>; <italic>η, r</italic>) = <italic>P</italic> (<italic>Y</italic><sub><italic>t</italic>+Δ<italic>t</italic></sub> = <italic>b</italic>; <italic>Y</italic><sub><italic>t</italic></sub> = <italic>a, η, r</italic>). In the following, we derive this transition probability. In step 1, we calculate the probability of introducing any |<italic>c</italic>| new edits. In step 2, we calculate the probability of introducing the particular inserts in c.</p><p id="P47"><bold>Step 1</bold> To derive the probability of introducing |c| edits, we distinguish two cases. In case 1, the number of new inserts |c| does not lead to saturation in the array (|<italic>a</italic>| + |<italic>c</italic>| = |<italic>b</italic>| &lt; <italic>N</italic>). Then, the probability of |c| = j editing events happening in time Δ<italic><sub>t</sub></italic> is given by the Poisson distribution (by model definition 2a):<disp-formula id="FD3"><mml:math id="M3"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>∗</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P48">In case 2, introducing |c| inserts leads to saturation of the array (|<italic>a</italic>| + |<italic>c</italic>| = |<italic>b</italic>| = <italic>N</italic>), i.e reaching position N in the tape. We calculate the probability of this event by targeting its complement, namely the probability of any fewer inserts being introduced (again, by assumption 2a): <disp-formula id="FD4"><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p id="P49">Combining both cases, the probability of introducing j edits in an array of length N assuming an editing rate <italic>r</italic> is: <disp-formula id="FD5"><label>(1)</label><mml:math id="M5"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>∗</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="8em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.2em"/><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mstyle displaystyle="true"><mml:mtext>Σ</mml:mtext></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>∗</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.4em"/><mml:mtext>otherwise</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P50"><bold>Step 2</bold> Let us assume that the |c| insertions having occurred from a to b are <inline-formula><mml:math id="M6"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>Γ</mml:mo></mml:mrow></mml:math></inline-formula>. The probability of inserting c conditional on |c| is the product of the individual insertion probabilities (by independence, see Assumption 2b):<disp-formula id="FD6"><label>(2)</label><mml:math id="M7"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mtext>Π</mml:mtext></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mtext>Π</mml:mtext></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mstyle displaystyle="true"><mml:mtext>Π</mml:mtext></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msubsup><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>𝟙</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p id="P51"><bold>Step 3</bold> Combining the steps above, the transition probability between any two states a and b in time interval Δ<italic>t</italic> given model parameters <italic>r</italic> and <italic>η</italic>, is obtained as follows (and as exemplified/described in <xref ref-type="fig" rid="F5">Fig. 5</xref>): <disp-formula id="FD7"><label>(3)</label><mml:math id="M8"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>;</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>;</mml:mo><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P52">where <italic>P</italic> (|<italic>c</italic>|; Δ<italic>t, r</italic>) was derived in Step 1 and <italic>P</italic> (<italic>c</italic>; |<italic>c</italic>|, <italic>η</italic>) in Step 2.</p></sec><sec id="S10"><title>Likelihood calculation</title><p id="P53">The editing model defined above can be used to calculate the likelihood of the model parameters (<italic>r, η</italic>) and the cell phylogeny <italic>T</italic> given the tape data <italic>D</italic> at the tips, <italic>Lik</italic>(<italic>r, η, tree</italic>; <italic>D</italic>) = <italic>P</italic> (<italic>D</italic>; <italic>r, η, tree</italic>). Let <italic>T</italic> be a tree with n tips and <italic>n</italic> − <italic>1</italic> internal nodes. Tho oldest of these nodes is the root node, being the most recent common ancestor of all sampled cells. Additionally, we introduce a stem branch preceding the root, connecting the root node to the start of the experiment, or origin node. We number the leaf nodes from 1, …, <italic>n</italic> arbitrarily, and the internal nodes from <italic>n</italic> + 1, …, 2<italic>n</italic> with increasing distance from the present. Each cell may have <italic>k</italic> tapes. Since we assume that tapes are edited independently from each other, we calculate the probability density of tape <italic>i</italic> given the tree and <italic>r, η</italic> separately for <italic>i</italic> = 1, …, <italic>k</italic>. The likelihood is then the product over the <italic>k</italic> probability densities. In what follows, we thus consider one particular tape.</p><p id="P54">We first obtain the sets of possible tape states at each internal node given the data at the tip nodes. The likelihood of the tree is then calculated by summing over all possible state transitions between the nodes. This summation is performed through dynamic programming, going from the leaf nodes toward the origin of the tree; the employed particular algorithm is Felsenstein’s pruning algorithm <xref ref-type="bibr" rid="R15">Felsenstein (1973)</xref>.</p><p id="P55">Hence, we first determine all possible states at internal nodes. We restate that editing is irreversible and ordered (model definitions 1, 3). Therefore, for any sequence at a leaf node, ancestors can only harbor either the same or fewer edits. For any leaf node <italic>m</italic>, let <italic>v</italic><sup><italic>m</italic></sup> be its tape with elements <inline-formula><mml:math id="M9"><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> where |<italic>v</italic><sup><italic>m</italic></sup>| is the number of edits in <italic>v</italic><sup><italic>m</italic></sup> as defined in the editing model section. The set of its possible ancestor tape states <italic>A</italic><sub><italic>m</italic></sub> is the set of all subsets of edits from <italic>v</italic><sup><italic>m</italic></sup>, akin to a power set on ordered tuples: <disp-formula id="FD8"><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>∅</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P56">For an internal node <italic>i</italic> of tree <italic>T</italic>, it follows that the set of possible states <italic>A</italic><sub><italic>i</italic></sub> is the intersection of possible states of its two children nodes <italic>k</italic> and j, <italic>A</italic><sub><italic>k</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub> (note that for the leaves, we initialize with all possible ancestor states). This is a result of editing being irreversible (assumption 3): an edit present in one child node but not the other cannot have been present in their parent node. Conversely, an edit present in both children nodes, can either have been present in the parent node or have been acquired by both children independently, therefore it should be included in the set of possible states. Consequently, the possible state set for node <italic>i, A</italic><sub><italic>i</italic></sub> is obtained as the intersection of the possible states of its children’s <italic>k, j, A</italic><sub><italic>k</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub>, recursively up the tree: <disp-formula id="FD9"><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mstyle displaystyle="true"><mml:mo>∩</mml:mo></mml:mstyle><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula></p><p id="P57">noting that the leaves are initialize with all possible ancestor states.</p><p id="P58">Given the possible states at the internal nodes, we calculate the probability density <italic>P</italic> (<italic>D</italic> |<italic>T</italic>, <italic>r, η, A</italic><sub>2<italic>n</italic></sub>) of the tape data given the tree and model parameters following notations in (<xref ref-type="bibr" rid="R28">Seidel and Stadler (2022)</xref>). To match assumption 1, we assume the unedited state at the origin node <italic>A</italic><sub>2<italic>n</italic></sub> = {Ø)}.<disp-formula id="FD10"><label>(4)</label><mml:math id="M12"><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P59">The transition probabilities from every parent node <italic>π</italic><sub><italic>i</italic></sub> to its child node <italic>i</italic> along their connecting branch with length <italic>τ</italic><sub><italic>i</italic></sub> are calculated using Eq. (3). Remember that <italic>A</italic><sub><italic>i</italic></sub> is the set of all possible states at node <italic>i</italic>. Any specific state within <italic>A</italic><sub><italic>i</italic></sub> is denoted as <italic>a</italic><sub><italic>i</italic></sub>. To account for all possible transitions, we sum the probabilities over all possible states at each internal node of the tree. <disp-formula id="FD11"><label>(5)</label><mml:math id="M13"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>…</mml:mo><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munderover><mml:mstyle displaystyle="true"><mml:mtext>Π</mml:mtext></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P60">Using Felsenstein’s pruning algorithm, we ‘move the summations down the tree as far as possible’ (<xref ref-type="bibr" rid="R16">Felsenstein (2004)</xref>), meaning we perform the summations recursively up the tree, saving computations: <disp-formula id="FD12"><label>(6)</label><mml:math id="M14"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mtext>Π</mml:mtext></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>𝟙</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mo>⋯</mml:mo><mml:mo>×</mml:mo><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>𝟙</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P61">As stated above, this calculation of <italic>P</italic> (<italic>D</italic> |<italic>T</italic>, <italic>r, η, A</italic><sub>2<italic>n</italic></sub>) is performed for each tape. Multiplying the resulting probability densities for each tape leads the targeted likelihood function.</p><p id="P62">For a set of <italic>k</italic> tapes, where every tape is of length N on a tree with <italic>n</italic> tips, we perform n-1 operations to calculate the set of ancestral states at every internal node. Performing the intersection at an internal node scales with the size of the set, N. Hence, computing the ancestral states scales in O(knN).</p><p id="P63">Additionally, for each of the k tapes, we calculate the transition probabilities at every one of the n-1 internal nodes. At each node, we consider a maximum of (N+1)x(N+1) potential state transitions. Hence, our likelihood computations without optimization scales in O(knN<sup>2</sup>) (In current technologies N is relatively small, <italic>N</italic> ≈ 5). Note that the computation over the different k tapes is conveniently an ‘embarrassingly parallel’ problem.</p><p id="P64">Overall, the calculation is polynomial in the size of the input, <italic>O</italic>(<italic>knN</italic> + <italic>knN</italic><sup>2</sup>) = <italic>O</italic>(<italic>knN</italic><sup>2</sup>). For a fixed <italic>N</italic> and <italic>k</italic>, the runtime scales linearly with the number of tips in the tree, meaning the number of cells in the dataset.</p></sec><sec id="S11"><title>Implementation</title><p id="P65">We implement the above editing model alongside an edit sequence simulator based on the feast package <xref ref-type="bibr" rid="R36">Vaughan (2024b</xref>) and a likelihood calculation in JAVA as a package for the software BEAST 2. BEAST 2 performs phylogenetic inference by using Markov Chain Monte Carlo (MCMC) to quantify the posterior distribution of the lineage tree and model parameters given a set of tape sequence alignments. During the MCMC, tree operators modify the tree to explore all possible topologies that could explain the data. As some of these changes are local, the likelihood for subtrees that are not modified remains unchanged. We make use of that property by implementing caching, where the likelihoods for subtrees are saved at each internal node to further speed up calculations (3.5-fold speed up on a personal computer running OSX on Intel(R) Core(TM) i5 Dual-Core @2.30Ghz). Additional speed-up is achieved by computing the likelihood for each tape alignment in parallel, which is easily achieved with existing components in BEAST 2 that support threading. These software optimizations lead to an overall 8-fold speed up relative to the naive implementation for an analysis involving 1000 sequences using 6 computing cores on the <ext-link ext-link-type="uri" xlink:href="https://scicomp.ethz.ch/wiki/Euler">“Euler”</ext-link> scientific computing cluster.</p></sec><sec id="S12"><title>Validation</title><p id="P66">We employed well-calibrated simulations (<xref ref-type="bibr" rid="R11">Dawid (1982)</xref>) to ensure the correct implementation of our Bayesian method SciPhy. We further used this simulation setup to assess the amount of information in the simulated data regarding parameters of our model.</p><p id="P67">We simulated 100 phylogenetic trees under a birth-death sampling model (<xref ref-type="bibr" rid="R33">Stadler et al. (2013)</xref>) with parameters provided in <xref ref-type="table" rid="T2">Tab. 2</xref>. As tree inference is the primary functionality offered by the BEAST 2 platform (<xref ref-type="bibr" rid="R4">Bouckaert et al. (2014)</xref>), we decided not to test tree inference here but instead use the fixed simulated trees for inference analyses.</p><p id="P68">We simulated alignments of tapes along each of the 100 trees. Firstly, we drew the rate of edit introduction (or clock rate) and edit probabilities to generate 13 distinct edits from a defined distribution (<xref ref-type="table" rid="T3">Tab. 3</xref>). Then we simulated the editing process of 10 independent tapes along each phylogenetic tree under these parameters. The resulting alignments of tapes were then used as input data for SciPhy to infer the rate of edit introduction and edit probabilities, using the same distributions (i.e. <xref ref-type="table" rid="T3">Tab. 3</xref>) as a prior. Finally, we compared the 100 simulated (true) parameters with the estimated parameters.</p><p id="P69">We chose the distributions over the editing model parameters to be representative for a broad range of editing dynamics. The clock rate distribution was selected to result in between 1 to 8 insertions for the experiment duration. We used a Dirichlet distribution with a concentration parameter of 1.5 for drawing the edit probabilities. This allows most edits to occur at similar, low probabilities while a few edits could occur more frequently.</p><p id="P70">For each MCMC inference, SciPhy was run for 5 * 10<sup>7</sup> iterations to estimate the clock rate and edit probabilities, keeping all other parameters fixed to the truth (i.e. the value of the simulation). We used an ESS value of 200 as threshold to ensure convergence of the MCMC chains. We then discarded the inital 10% of the iterations as burn-in. Lastly, we calculated the coverage as the proportion of times the simulated (true) value fell within the estimated 95% HPD (define) interval.</p></sec><sec id="S13"><title>Phylodynamic analysis of HEK293T expansion</title><p id="P71">We use SciPhy for the analysis of the publicly available dataset (i.e. taken from <ext-link ext-link-type="uri" xlink:href="https://github.com/shendurelab/DNATickerTape">https://github.com/shendurelab/DNATickerTape</ext-link>, Supplementary_File_2_DataTableMOI19.csv) generated as described in (<xref ref-type="bibr" rid="R9">Choi et al. (2022)</xref>). This study uses genetic tapes that contain 5 target sites for insertion, where each insertion step consists of the introduction of a trinucleotide character. We process the tape sequences as follows. We first retain all 3257 cells containing all 13 most frequent tapes for sub-sequent analysis, as done before. Out of these 13 tapes, 3 (barcoded with ‘TTCCGTCA’,’TGGTTTTG’ and ‘TTCACGTA’) are found to possess less than the 5 original editable target sites, respectively 4 (‘TTCCGTCA’,’TGGTTTTG’) and 2 (‘TTCACGTA’) sites. We refer to these tapes as “truncated”. This procedure yields a dataset containing 19 different possible trinucleotide insertions. We create 3 random subsets of this data, each consisting of 1000 cells and perform phylodynamic analysis on each subset.</p><p id="P72">We use SciPhy to model the editing dynamics in this filtered dataset. We assume that each of the 13 tapes can accumulate edits at an independent rate, while insertion probabilities are shared across all tapes. We place prior distributions on the parameters of the editing model as described in <xref ref-type="table" rid="T4">table 4</xref>. As no quantitative information on the editing dynamics is available for this experimental setup, we use broad priors that capture a variety of experimentally plausible values (as in the validation part).</p><p id="P73">Being sampled from a monoclonal culture, cells are expected to undergo exponential growth and to not acquire any specific population structure. Consequently, we choose to infer the dynamics underlying the growth of this cell population using the birth-death sampling model for constant and piecewise constant rates (<xref ref-type="bibr" rid="R33">Stadler et al. (2013)</xref>). We set priors on the birth and death rate (4) that are very broad; leading for instance to between 12 and 2.5 * 10<sup>30</sup> cells at the time of sequencing. We additionally input known experimental parameters by setting the origin time to the experiment duration of 25 days and fixing the sampling proportion to 1000/1.2<italic>e</italic> 6 = 0.0008. In the piecewise constant analysis, rates were allowed to vary every 2 days, yielding a timeline of 13 epochs where an Ornstein-Uhlenbeck (OU) prior is applied to the birth and death rates, and where we apply a Log-normal(0.5, 0) hyperprior on parameters <italic>σ</italic> and <italic>ν</italic> of the OU process.</p><p id="P74">For each subset of the data, we run 3 MCMC chains for ~10<sup>9</sup> iterations. We assess convergence by confirming that the three chains are sampling the same stationary distribution, with an ESS value per chain &gt; 200 and visually in Tracer (<xref ref-type="bibr" rid="R4">Bouckaert et al. (2014)</xref>). We discard 10% burn-in and combine all 3 chains using LogCombiner (<xref ref-type="bibr" rid="R4">Bouckaert et al. (2014)</xref>).</p><p id="P75">To test whether the ordering of 4x and 5x tapes is unexpected under the assumption of equal editing rates for all tapes, we compute the probability of the observed (i.e. that k of the three tapes with the fastest editing rates are 4x tapes) using the hypergeometric distribution. We model the setup as follows: We have a total of 12 tapes (N=12), of which 3 tapes (K=3) have 4 sites and 9 tapes have 5 sites. If we draw the three tapes with the highest rates (n=3), we want to calculate <italic>p</italic>(<italic>k</italic>), the probability that k of these tapes are of type 4x. We do this using the standard hypergeometric distribution: <disp-formula id="FD13"><label>(7)</label><mml:math id="M15"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>K</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P76">The number of cells over time, conditional on the estimated trees and phylodynamic parameters, was estimated using a stochastic mapping algorithm <xref ref-type="bibr" rid="R18">Freyman and Höhna (2019)</xref> implemented in the BDMM-Prime package <xref ref-type="bibr" rid="R35">Vaughan (2024a</xref>). Tree and log files were subsampled to retain every 10<sup>7</sup>th state using LogCombiner, resulting in 350 states from which the cell population size was estimated.</p><p id="P77">To compare the UPGMA tree to SciPhy’s estimated trees, we use the R package TreeDist (<xref ref-type="bibr" rid="R30">Smith (2022)</xref>) to provide mappings of tree sets for four dimensions, pairwise. For this, we extract a random subsample of 650 trees inferred under SciPhy to calculate distances to the UPGMA topology. We do so using three metrics for topological comparisons, namely the Robinson Foulds distance, the Phylogenetc Information distance, and the Clustering Information distance. Further we employ one metric that also differences in branch lengths, namely the weighted Robinson Foulds metric. For each metric, the distances are mapped in lower dimensions using multidimensional scaling (<xref ref-type="bibr" rid="R19">Gower (1966)</xref>). For each of these mappings we choose the number of dimensions required to faithfully visualize tree distances based on the product of the trustworthiness and continuity metrics as described by <xref ref-type="bibr" rid="R30">Smith (2022)</xref>. For both mappings we find that 4 dimensions provide acceptable levels of distortion (trustworthiness x continuity &gt; 8.5).</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental-Materials</label><media xlink:href="EMS199210-supplement-Supplemental_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d35aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Acknowledgments</title><p>This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme grant agreement no. 101001077 (to T.S.) and the Paul G. Allen Family Foundation (to J.S.). The authors would like to thank François Bienvenu, Timothy G. Vaughan, Louis A. Du Plessis, Cecilia Valenzuela Agüi, Marcus Overwater, Nicola Mulberry and Ugnė Stolz for helpful discussions and feedback.</p></ack><sec id="S14" sec-type="data-availability"><title>Code availability</title><p id="P78">All code to reproduce the analyses is publicly available from <ext-link ext-link-type="uri" xlink:href="https://github.com/seidels/typewriter_analysis">https://github.com/seidels/typewriter_analysis</ext-link>.</p></sec><fn-group><fn id="FN1"><p id="P79"><bold>Declaration of Generative AI and AI-assisted technologies in the writing process</bold></p><p id="P80">During the preparation of this work the authors used the ChatGPT language model by OpenAI to refine the manuscript’s language. After using this tool, the authors reviewed and edited the content as needed and take full responsibility for the content of the publication.</p></fn><fn fn-type="con" id="FN2"><p id="P81"><bold>Authors’ contributions</bold></p><p id="P82">S.S.: conceptualisation, methodology, software, validation, formal analysis, investigation, data curation, writing—original draft, writing—review and editing, visualisation, project administration. A.Z.: conceptualisation, methodology, software, validation, formal analysis, investigation, data curation, writing—original draft, writing—review and editing, visualisation S.R.: data curation, writing—review and editing. J.C.: data curation, writing—review and editing. J.S.: writing—review and editing, supervision, funding acquisition. T.S.: conceptualisation, methodology, resources, writing—review and editing, supervision, funding acquisition.</p></fn><fn fn-type="conflict" id="FN3"><p id="P83"><bold>Competing interests</bold></p><p id="P84">The University of Washington has filed a patent application based on the DNA Typewriter system for sequential genome editing, in which J.C. and J.S. are listed as inventors. J.S. is on the scientific advisory board, a consultant and/or a cofounder of Adaptive Biotechnologies, Cajal Neuroscience, Camp4 Therapeutics, Guardant Health, Maze Therapeutics, Pacific Biosciences, Phase Genomics, Prime Medicine, Scale Biosciences, Somite Therapeutics and Sixth Street Capital. The remaining authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alemany</surname><given-names>A</given-names></name><name><surname>Florescu</surname><given-names>M</given-names></name><name><surname>Baron</surname><given-names>CS</given-names></name><name><surname>Peterson-Maduro</surname><given-names>J</given-names></name><name><surname>Van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Whole-organism clone tracing using single-cell sequencing</article-title><source>Nature</source><year>2018</year><volume>556</volume><issue>7699</issue><fpage>108</fpage><lpage>112</lpage><pub-id pub-id-type="pmid">29590089</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anzalone</surname><given-names>AV</given-names></name><name><surname>Randolph</surname><given-names>PB</given-names></name><name><surname>Davis</surname><given-names>JR</given-names></name><name><surname>Sousa</surname><given-names>AA</given-names></name><name><surname>Koblan</surname><given-names>LW</given-names></name><name><surname>Levy</surname><given-names>JM</given-names></name><name><surname>Chen</surname><given-names>PJ</given-names></name><name><surname>Wilson</surname><given-names>C</given-names></name><name><surname>Newby</surname><given-names>GA</given-names></name><name><surname>Raguram</surname><given-names>A</given-names></name><name><surname>Liu</surname><given-names>DR</given-names></name></person-group><article-title>Search-and-replace genome editing without double-strand breaks or donor DNA</article-title><source>Nature</source><year>2019</year><month>oct</month><volume>576</volume><issue>7785</issue><fpage>149</fpage><lpage>157</lpage><comment>2019 576:7785</comment><pub-id pub-id-type="pmcid">PMC6907074</pub-id><pub-id pub-id-type="pmid">31634902</pub-id><pub-id pub-id-type="doi">10.1038/s41586-019-1711-4</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Biodata</surname><given-names>S</given-names></name></person-group><source>HEK293T</source><publisher-name>cellosaurus</publisher-name><year>2024</year><comment><ext-link ext-link-type="uri" xlink:href="https://www.cellosaurus.org/CVCL_0063">https://www.cellosaurus.org/CVCL_0063</ext-link></comment></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname><given-names>R</given-names></name><name><surname>Heled</surname><given-names>J</given-names></name><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Vaughan</surname><given-names>T</given-names></name><name><surname>Wu</surname><given-names>CH</given-names></name><name><surname>Xie</surname><given-names>D</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>BEAST 2: a software platform for Bayesian evolutionary analysis</article-title><source>PLoS computational biology</source><year>2014</year><volume>10</volume><issue>4</issue><elocation-id>e1003537</elocation-id><pub-id pub-id-type="pmcid">PMC3985171</pub-id><pub-id pub-id-type="pmid">24722319</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003537</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bowling</surname><given-names>S</given-names></name><name><surname>Sritharan</surname><given-names>D</given-names></name><name><surname>Osorio</surname><given-names>FG</given-names></name><name><surname>Nguyen</surname><given-names>M</given-names></name><name><surname>Cheung</surname><given-names>P</given-names></name><name><surname>Rodriguez-Fraticelli</surname><given-names>A</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Yuan</surname><given-names>WC</given-names></name><name><surname>Fujiwara</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>BE</given-names></name><etal/></person-group><article-title>An engineered CRISPR-Cas9 mouse line for simultaneous readout of lineage histories and gene expression profiles in single cells</article-title><source>Cell</source><year>2020</year><volume>181</volume><issue>6</issue><fpage>1410</fpage><lpage>1422</lpage><pub-id pub-id-type="pmcid">PMC7529102</pub-id><pub-id pub-id-type="pmid">32413320</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.04.048</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>MM</given-names></name><name><surname>Smith</surname><given-names>ZD</given-names></name><name><surname>Grosswendt</surname><given-names>S</given-names></name><name><surname>Kretzmer</surname><given-names>H</given-names></name><name><surname>Norman</surname><given-names>TM</given-names></name><name><surname>Adamson</surname><given-names>B</given-names></name><name><surname>Jost</surname><given-names>M</given-names></name><name><surname>Quinn</surname><given-names>JJ</given-names></name><name><surname>Yang</surname><given-names>D</given-names></name><name><surname>Jones</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Molecular recording of mammalian embryogenesis</article-title><source>Nature</source><year>2019</year><volume>570</volume><issue>7759</issue><fpage>77</fpage><lpage>82</lpage><pub-id pub-id-type="pmcid">PMC7229772</pub-id><pub-id pub-id-type="pmid">31086336</pub-id><pub-id pub-id-type="doi">10.1038/s41586-019-1184-5</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Moravec</surname><given-names>JC</given-names></name><name><surname>Gavryushkin</surname><given-names>A</given-names></name><name><surname>Welch</surname><given-names>D</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Accounting for errors in data improves timing in single-cell cancer evolution</article-title><source>bioRxiv</source><year>2022</year><month>may</month><elocation-id>2021.03.17.435906</elocation-id><pub-id pub-id-type="pmcid">PMC9356729</pub-id><pub-id pub-id-type="pmid">35733333</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msac143</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Choi</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Nathans</surname><given-names>JF</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>W</given-names></name><name><surname>Hamazaki</surname><given-names>N</given-names></name><name><surname>Qiu</surname><given-names>C</given-names></name><name><surname>Lalanne</surname><given-names>JB</given-names></name><name><surname>Regalado</surname><given-names>S</given-names></name><etal/></person-group><article-title>Symbolic recording of signalling and cis-regulatory element activity to DNA</article-title><source>Nature</source><year>2024</year><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC11357993</pub-id><pub-id pub-id-type="pmid">39020177</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07706-4</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Minkina</surname><given-names>A</given-names></name><name><surname>Chardon</surname><given-names>FM</given-names></name><name><surname>Suiter</surname><given-names>CC</given-names></name><name><surname>Regalado</surname><given-names>SG</given-names></name><name><surname>Domcke</surname><given-names>S</given-names></name><name><surname>Hamazaki</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><etal/></person-group><article-title>A time-resolved, multi-symbol molecular recorder via sequential genome editing</article-title><source>Nature</source><year>2022</year><volume>608</volume><issue>7921</issue><fpage>98</fpage><lpage>107</lpage><pub-id pub-id-type="pmcid">PMC9352581</pub-id><pub-id pub-id-type="pmid">35794474</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04922-8</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chow</surname><given-names>KHK</given-names></name><name><surname>Budde</surname><given-names>MW</given-names></name><name><surname>Granados</surname><given-names>AA</given-names></name><name><surname>Cabrera</surname><given-names>M</given-names></name><name><surname>Yoon</surname><given-names>S</given-names></name><name><surname>Cho</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>TH</given-names></name><name><surname>Koulena</surname><given-names>N</given-names></name><name><surname>Frieda</surname><given-names>KL</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name><etal/></person-group><article-title>Imaging cell lineage with a synthetic digital recording system</article-title><source>Science</source><year>2021</year><volume>372</volume><issue>6538</issue><elocation-id>eabb3099</elocation-id><pub-id pub-id-type="pmid">33833095</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dawid</surname><given-names>AP</given-names></name></person-group><article-title>The well-calibrated bayesian</article-title><source>Journal of the American Statistical Association</source><year>1982</year><volume>77</volume><issue>379</issue><fpage>605</fpage><lpage>610</lpage></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Shapiro</surname><given-names>B</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><article-title>Bayesian Coalescent Inference of Past Population Dynamics from Molecular Sequences</article-title><source>Molecular Biology and Evolution</source><year>2005</year><month>may</month><volume>22</volume><issue>5</issue><fpage>1185</fpage><lpage>1192</lpage><pub-id pub-id-type="pmid">15703244</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Ho</surname><given-names>SYW</given-names></name><name><surname>Phillips</surname><given-names>MJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><article-title>Relaxed phylogenetics and dating with confidence</article-title><source>PLoS biology</source><year>2006</year><volume>4</volume><issue>5</issue><fpage>e88</fpage><pub-id pub-id-type="pmcid">PMC1395354</pub-id><pub-id pub-id-type="pmid">16683862</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name></person-group><article-title>Bayesian random local clocks, or one rate to rule them all</article-title><source>BMC biology</source><year>2010</year><volume>8</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC2949620</pub-id><pub-id pub-id-type="pmid">20807414</pub-id><pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Maximum Likelihood and Minimum-Steps Methods for Estimating Evolutionary Trees from Data on Discrete Characters</article-title><source>Systematic Biology</source><year>1973</year><month>sep</month><volume>22</volume><issue>3</issue><fpage>240</fpage><lpage>249</lpage></element-citation></ref><ref id="R16"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>Inferring phylogenies</source><year>2004</year><volume>664</volume></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>J</given-names></name><name><surname>Dewitt</surname><given-names>WS</given-names><suffix>III</suffix></name><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Simon</surname><given-names>N</given-names></name><name><surname>Willis</surname><given-names>AD</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names><suffix>IV</suffix></name></person-group><article-title>Estimation of cell lineage trees by maximum-likelihood phylogenetics</article-title><source>The annals of applied statistics</source><year>2021</year><volume>15</volume><issue>1</issue><fpage>343</fpage><pub-id pub-id-type="pmcid">PMC9387344</pub-id><pub-id pub-id-type="pmid">35990087</pub-id><pub-id pub-id-type="doi">10.1214/20-aoas1400</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freyman</surname><given-names>WA</given-names></name><name><surname>Höhna</surname><given-names>S</given-names></name></person-group><article-title>Stochastic Character Mapping of State-Dependent Diversification Reveals the Tempo of Evolutionary Decline in Self-Compatible Onagraceae Lineages</article-title><source>Systematic Biology</source><year>2019</year><month>may</month><volume>68</volume><issue>3</issue><fpage>505</fpage><lpage>519</lpage><pub-id pub-id-type="pmid">30476308</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gower</surname><given-names>JC</given-names></name></person-group><article-title>Some distance properties of latent root and vector methods used in multivariate analysis</article-title><source>Biometrika</source><year>1966</year><volume>53</volume><issue>3-4</issue><fpage>325</fpage><lpage>338</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Maynard</surname><given-names>A</given-names></name><name><surname>Jain</surname><given-names>A</given-names></name><name><surname>Gerber</surname><given-names>T</given-names></name><name><surname>Petri</surname><given-names>R</given-names></name><name><surname>Lin</surname><given-names>HC</given-names></name><name><surname>Santel</surname><given-names>M</given-names></name><name><surname>Ly</surname><given-names>K</given-names></name><name><surname>Dupré</surname><given-names>JS</given-names></name><name><surname>Sidow</surname><given-names>L</given-names></name><etal/></person-group><article-title>Lineage recording in human cerebral organoids</article-title><source>Nature methods</source><year>2022</year><volume>19</volume><issue>1</issue><fpage>90</fpage><lpage>99</lpage><pub-id pub-id-type="pmcid">PMC8748197</pub-id><pub-id pub-id-type="pmid">34969984</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01344-8</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name><name><surname>Vaughan</surname><given-names>TG</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Phylodynamics with Migration: A Computational Framework to Quantify Population Structure from Genomic Data</article-title><source>Molecular Biology and Evolution</source><year>2016</year><volume>33</volume><issue>8</issue><fpage>2102</fpage><lpage>2116</lpage><pub-id pub-id-type="pmcid">PMC4948704</pub-id><pub-id pub-id-type="pmid">27189573</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msw064</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewinsohn</surname><given-names>MA</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Müller</surname><given-names>NF</given-names></name><name><surname>Feder</surname><given-names>AF</given-names></name></person-group><article-title>State-dependent evolutionary models reveal modes of solid tumor growth</article-title><source>bioRxiv</source><year>2022</year><month>aug</month><elocation-id>2022.08.05.502978</elocation-id><pub-id pub-id-type="pmcid">PMC10089931</pub-id><pub-id pub-id-type="pmid">36894662</pub-id><pub-id pub-id-type="doi">10.1038/s41559-023-02000-4</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loveless</surname><given-names>TB</given-names></name><name><surname>Carlson</surname><given-names>CK</given-names></name><name><surname>Hu</surname><given-names>VJ</given-names></name><name><surname>Dentzel Helmy</surname><given-names>CA</given-names></name><name><surname>Liang</surname><given-names>G</given-names></name><name><surname>Ficht</surname><given-names>M</given-names></name><name><surname>Singhai</surname><given-names>A</given-names></name><name><surname>Liu</surname><given-names>CC</given-names></name></person-group><article-title>Molecular recording of sequential cellular events into DNA</article-title><source>bioRxiv</source><year>2021</year><fpage>2021</fpage><lpage>11</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Findlay</surname><given-names>GM</given-names></name><name><surname>Gagnon</surname><given-names>JA</given-names></name><name><surname>Horwitz</surname><given-names>MS</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>Whole-organism lineage tracing by combinatorial and cumulative genome editing</article-title><source>Science</source><year>2016</year><volume>353</volume><issue>6298</issue><elocation-id>aaf7907</elocation-id><pub-id pub-id-type="pmcid">PMC4967023</pub-id><pub-id pub-id-type="pmid">27229144</pub-id><pub-id pub-id-type="doi">10.1126/science.aaf7907</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Gagnon</surname><given-names>JA</given-names></name></person-group><article-title>Recording development with single cell dynamic lineage tracing</article-title><source>Development (Cambridge)</source><year>2019</year><month>jun</month><volume>146</volume><issue>12</issue><pub-id pub-id-type="pmcid">PMC6602349</pub-id><pub-id pub-id-type="pmid">31249005</pub-id><pub-id pub-id-type="doi">10.1242/dev.169730</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname><given-names>FK</given-names></name><name><surname>Bouckaert</surname><given-names>R</given-names></name><name><surname>Carvalho</surname><given-names>LM</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>How to validate a Bayesian evolutionary model</article-title><source>bioRxiv</source><year>2024</year><volume>2</volume><elocation-id>2024.02.11.579856</elocation-id><pub-id pub-id-type="doi">10.1101/2024.02.11.579856</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>DF</given-names></name><name><surname>Foulds</surname><given-names>LR</given-names></name></person-group><article-title>Comparison of phylogenetic trees</article-title><source>Mathematical biosciences</source><year>1981</year><volume>53</volume><issue>1-2</issue><fpage>131</fpage><lpage>147</lpage></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seidel</surname><given-names>S</given-names></name><name><surname>Stadler</surname><given-names>T</given-names></name></person-group><article-title>TiDeTree: a Bayesian phylogenetic framework to estimate single-cell trees and population dynamic parameters from genetic lineage tracing data</article-title><source>Proceedings of the Royal Society B</source><year>2022</year><volume>289</volume><issue>1986</issue><elocation-id>20221844</elocation-id><pub-id pub-id-type="pmcid">PMC9653226</pub-id><pub-id pub-id-type="pmid">36350216</pub-id><pub-id pub-id-type="doi">10.1098/rspb.2022.1844</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>MR</given-names></name></person-group><article-title>Information theoretic generalized Robinson–Foulds metrics for comparing phylogenetic trees</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><issue>20</issue><fpage>5007</fpage><lpage>5013</lpage><pub-id pub-id-type="pmid">32619004</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>MR</given-names></name></person-group><article-title>Robust analysis of phylogenetic tree space</article-title><source>Systematic Biology</source><year>2022</year><volume>71</volume><issue>5</issue><fpage>1255</fpage><lpage>1270</lpage><pub-id pub-id-type="pmcid">PMC9366458</pub-id><pub-id pub-id-type="pmid">34963003</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syab100</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Sokal</surname><given-names>RR</given-names></name><name><surname>Sneath</surname><given-names>PH</given-names></name><etal/></person-group><source>Principles of numerical taxonomy</source><year>1963</year><comment>Principles of numerical taxonomy</comment></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spanjaard</surname><given-names>B</given-names></name><name><surname>Hu</surname><given-names>B</given-names></name><name><surname>Mitic</surname><given-names>N</given-names></name><name><surname>Olivares-Chauvet</surname><given-names>P</given-names></name><name><surname>Janjuha</surname><given-names>S</given-names></name><name><surname>Ninov</surname><given-names>N</given-names></name><name><surname>Junker</surname><given-names>JP</given-names></name></person-group><article-title>Simultaneous lineage tracing and cell-type identification using CRISPR–Cas9-induced genetic scars</article-title><source>Nature biotechnology</source><year>2018</year><volume>36</volume><issue>5</issue><fpage>469</fpage><lpage>473</lpage><pub-id pub-id-type="pmcid">PMC5942543</pub-id><pub-id pub-id-type="pmid">29644996</pub-id><pub-id pub-id-type="doi">10.1038/nbt.4124</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>T</given-names></name><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Bonhoeffer</surname><given-names>S</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Birth–death skyline plot reveals temporal changes of epidemic spread in HIV and hepatitis C virus (HCV)</article-title><source>Proceedings of the National Academy of Sciences</source><year>2013</year><volume>110</volume><issue>1</issue><fpage>228</fpage><lpage>233</lpage><pub-id pub-id-type="pmcid">PMC3538216</pub-id><pub-id pub-id-type="pmid">23248286</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1207965110</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanHorn</surname><given-names>S</given-names></name><name><surname>Morris</surname><given-names>SA</given-names></name></person-group><article-title>Next-Generation Lineage Tracing and Fate Mapping to Interrogate Development</article-title><source>Developmental Cell</source><year>2021</year><month>jan</month><volume>56</volume><issue>1</issue><fpage>7</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">33217333</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vaughan</surname><given-names>T</given-names></name></person-group><source>BDMM-Prime Package</source><publisher-name>GitHub</publisher-name><year>2024</year><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/tgvaughan/BDMM-Prime">https://github.com/tgvaughan/BDMM-Prime</ext-link></comment></element-citation></ref><ref id="R36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vaughan</surname><given-names>T</given-names></name></person-group><source>Feast Package</source><publisher-name>GitHub</publisher-name><year>2024</year><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/tgvaughan/feast.git">https://github.com/tgvaughan/feast.git</ext-link></comment></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaughan</surname><given-names>TG</given-names></name><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Popinga</surname><given-names>A</given-names></name><name><surname>Welch</surname><given-names>D</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Efficient Bayesian inference under the structured coalescent</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>16</issue><fpage>2272</fpage><lpage>2279</lpage><pub-id pub-id-type="pmcid">PMC4207426</pub-id><pub-id pub-id-type="pmid">24753484</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btu201</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>SciPhy is a framework for phylogenetic and phylodynamic analysis of sequential edit lineage tracing data.</title><p>It implements a mechanistic model of sequential editing based recording systems (<bold>A</bold>), which enables their use for Bayesian phylodynamic inference in BEAST 2. These alignments are obtained following typical pipelines of genetic lineage tracing experiments: cells that harbour copies of the recording barcode accumulate insertions during growth (<bold>B</bold>). At the end of these experiments, single-cell sequencing generates barcode alignments (<bold>C</bold>), from which SciPhy can infer parameters of the recording system: the rate and probability at which different insertions are acquired.</p></caption><graphic xlink:href="EMS199210-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Validation results</title><p>Here we report the results of the in-silico validation for the editing rate (left) and the insertion probabilities (right) based on 100 simulations. For each panel, we plot the estimated posterior medians against the true values as black dots. The grey intervals denote the 95% highest posterior density interval around the median. The green line represents the performance of an ideal estimator.</p></caption><graphic xlink:href="EMS199210-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>SciPhy captures complex editing dynamics and infers developmental parameters</title><p><bold>A</bold> We apply SciPhy to data from monoclonal expansion of HEK293T cells harboring the DNA Typewriter recording system. We report SciPhy’s parameter estimates, namely the posterior distributions of the editing model parameters, namely the insertion probabilities (<bold>B</bold>) and the editing rates per day per tape (<bold>C</bold>). The error bars on the insertion probabilities indicate the 95% highest posterior density interval. Editing rates for truncated tapes are colored with darker shades and annotated with the corresponding number of sites (respectively 2, 4, and 5 sites). We report estimates of the cell population dynamics under the birth-death-sampling model, namely the growth rate (<bold>D</bold>) and the sampling proportion (<bold>E</bold>). In <bold>F</bold> we plot the time-scaled Maximum Clade Credibility (MCC) tree for 1000 cells and highlight a clade that is shown enlarged in <bold>G</bold>.We show a sub-clade of the MCC tree and highlight the posterior support in the node placement by the node thickness and the uncertainty, i.e. 95% HPD intervals, in the cell division time as grey shadings. We plot the alignment facing the tree tips.</p></caption><graphic xlink:href="EMS199210-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>The SciPhy posterior trees difer from the UPGMA tree in terms of topology and branch lengths and result in diferent estimates of the growth dynamics.</title><p>In <bold>A</bold>, we compare the SciPhy posterior tree set (green), including a summary tree, the MCC tree (black), to the UPGMA tree (red). We do so by calculating the Phylogenetic Information distance that captures topological distance between all pairs of trees. We use multidimensional scaling to project these distances into 4 dimensions. Here we show the results of the first coordinate against coordinates 2 to 4 from left to right. The remaining pairwise coordinate are shown in <xref ref-type="supplementary-material" rid="SD1">Appendix Fig. 4</xref>. In <bold>B</bold>), we plot the total number of lineages (y-axis) through time for each day (x-axis) for the SciPhy posterior tree set inferred under the constant birth-death-sampling model (green), the MCC trees, UPGMA (red), UPGMA with scaled root height, (orange) and UPGMA scaled using SciPhy (yellow). In <bold>C</bold> we compare the estimated growth rate(s) for each of these topologies.</p></caption><graphic xlink:href="EMS199210-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>General description of model components used to calculate transition probabilities in SciPhy.</title><p>An overview of SciPhy’s editing model for a tape with N=5 target sites and its parameters is shown in a). Target sites within tapes (rectangles in the tape) acquire inserts (colored boxes, inserts <italic>γ</italic><sub>1</sub> to <italic>γ</italic><sub><italic>M</italic></sub>) with probability <italic>f</italic><sub>1</sub> to <italic>f</italic><sub><italic>M</italic></sub> following Cas9 mediated nicks at rate r. Upon editing these sites are inactivated (grey boxes). b) is a toy example for the calculation of the transition probability for a tape acquiring 2 edits (<italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>3</sub>). In c) we showcase different scenarios for the calculation of the probability of a given number of inserts to be added into a tape, distinguishing between cases where a tape gets saturated with inserts (red arrows pointing to the right) or not (grey arrows pointing down).</p></caption><graphic xlink:href="EMS199210-f005"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Glossary Translation of phylogenetic terminology to cell biology terminology.</title></caption><table frame="hsides" rules="cols"><thead><tr style="border-bottom: solid thin"><th valign="middle" align="left">Phylogenetic Terms</th><th valign="middle" align="left">Cell Biology Terms</th></tr><tr><th valign="middle" align="left"/><th valign="middle" align="left"/></tr></thead><tbody><tr><td valign="top" align="left"/><td valign="top" align="left"/></tr><tr><td valign="top" align="left">Tree topology</td><td valign="top" align="left">Lineage tree</td></tr><tr><td valign="top" align="left">Clock rate</td><td valign="top" align="left">Edit insertion rate by prime editor (e.g. per hour)</td></tr><tr><td valign="top" align="left">Bifurcation, branching point</td><td valign="top" align="left">Cell division event</td></tr><tr><td valign="top" align="left">Branching time</td><td valign="top" align="left">Cell division time</td></tr><tr><td valign="top" align="left">Time-scaled tree</td><td valign="top" align="left">Lineage tree where branches are scaled in real time</td></tr><tr><td valign="top" align="left">Monophyletic</td><td valign="top" align="left">Monoclonal</td></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><title>Parameters used for simulating a phylogenetic tree under a birth-death sampling model.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top" align="left">Parameter</th><th valign="top" align="center">Value</th></tr></thead><tbody><tr><td valign="top" align="left">Birth rate</td><td valign="top" align="center">0.8</td></tr><tr><td valign="top" align="left">Death rate</td><td valign="top" align="center">0.2</td></tr><tr><td valign="top" align="left">Sampling proportion</td><td valign="top" align="center">0.003</td></tr><tr><td valign="top" align="left">Origin or experiment duration</td><td valign="top" align="center">25</td></tr></tbody></table></table-wrap><table-wrap id="T3" orientation="portrait" position="float"><label>Table 3</label><caption><title>Distributions for the editing model parameters used in the validation.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="middle" align="center">Parameter name</th><th valign="middle" align="center">Symbol</th><th valign="middle" align="center">Distribution</th><th valign="middle" align="center">HDI</th></tr></thead><tbody><tr><td valign="top" align="center">Clock rate</td><td valign="top" align="center"><italic>r</italic></td><td valign="top" align="center">Log-normal (<italic>μ</italic> = −2, <italic>σ</italic> = 0.5)</td><td valign="top" align="center">[0.03, 0.3]</td></tr><tr><td valign="top" align="center">Edit probabilities</td><td valign="top" align="center"><italic>f</italic><sub><italic>k</italic></sub></td><td valign="top" align="center">Dirichlet (<italic>α</italic> = 1.5)</td><td valign="top" align="center">[2e-4, 2e-1]</td></tr></tbody></table></table-wrap><table-wrap id="T4" orientation="portrait" position="float"><label>Table 4</label><caption><title>Priors used for analysis of the HEK293T dataset unsing SciPhy and the birth-death sampling model.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top" align="left">Parameter</th><th valign="top" align="center">Prior distribution</th><th valign="top" align="left">95% HDI</th></tr></thead><tbody><tr><td valign="top" align="left">Edit probabilities</td><td valign="top" align="center">Dirichlet (1.5)</td><td valign="top" align="left">[ 0.0038, 0.15 ]</td></tr><tr><td valign="top" align="left">Clock rate</td><td valign="top" align="center">Log-normal (-2, 0.5)</td><td valign="top" align="left">[ 0.06, 0.4 ]</td></tr><tr><td valign="top" align="left">Birth rate</td><td valign="top" align="center">Log-normal(-0.6,1)</td><td valign="top" align="left">[ 0.1, 2.8 ]</td></tr><tr><td valign="top" align="left">Death rate</td><td valign="top" align="center">Log-normal(-2, 1)</td><td valign="top" align="left">[ 0.06, 0.4 ]</td></tr><tr><td valign="top" align="left">Sampling proportion</td><td valign="top" align="center">0.0008</td><td valign="top" align="left">fixed</td></tr><tr><td valign="top" align="left">Sampling proportion</td><td valign="top" align="center">Log-normal(-7.4,1.2)</td><td valign="top" align="left">[0.00011,0.0045]</td></tr><tr><td valign="top" align="left">Origin or experiment duration</td><td valign="top" align="center">25</td><td valign="top" align="left">fixed</td></tr></tbody></table></table-wrap></floats-group></article>