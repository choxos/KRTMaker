<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS156314</article-id><article-id pub-id-type="doi">10.1101/2022.10.24.513476</article-id><article-id pub-id-type="archive">PPR563139</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Single-cell gene set enrichment analysis and transfer learning for functional annotation of scRNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Pellecchia</surname><given-names>Simona</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Viscido</surname><given-names>Gaetano</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Franchini</surname><given-names>Melania</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Gambardella</surname><given-names>Gennaro</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>University of Naples Federico II, Department of Chemical Materials and Industrial Engineering, 80125 Naples, Italy</aff><aff id="A2"><label>2</label>Telethon Institute of Genetics and Medicine, Pozzuoli, 80078 Naples, Italy</aff><aff id="A3"><label>3</label>University of Naples Federico II, Department of Electrical Engineering and Information Technologies, 80125 Naples, Italy</aff><author-notes><corresp id="CR1">
<label>*</label><bold>Correspondence:</bold> Corresponding Author, GG: <email>gambardella@tigem.it</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>28</day><month>10</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>25</day><month>10</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license><license><ali:license_ref>https://europepmc.org/downloads/openaccess</ali:license_ref><license-p>This preprint is made available via the <ext-link ext-link-type="uri" xlink:href="https://europepmc.org/downloads/openaccess">Europe PMC open access subset</ext-link>, for unrestricted research re-use and secondary analysis in any form or by any means with acknowledgement of the original preprint source.</license-p></license></permissions><abstract><p id="P1">Although an essential step, the functional annotation of cells often proves particularly challenging in the analysis of single-cell transcriptional data. Several methods have been developed to accomplish this task. However, in most cases, these rely on techniques initially developed for bulk RNA sequencing or simply make use of marker genes identified from cell clustering followed by supervised annotation. To overcome these limitations and automatise the process, we have developed two novel methods, the single-cell gene set enrichment analysis (scGSEA) and the single cell mapper (scMAP). scGSEA combines latent data representations and gene set enrichment scores to detect coordinated gene activity at single-cell resolution. scMAP uses transfer learning techniques to re-purpose and contextualise new cells into a reference cell atlas. Using both simulated and real datasets, we show that scGSEA effectively recapitulates recurrent patterns of pathways’ activity shared by cells from different experimental conditions. At the same time, we show that scMAP can reliably map and contextualise new single cell profiles on a breast cancer atlas we recently released. Both tools are provided in an effective and straightforward workflow providing a framework to determine cell function and significantly improve annotation and interpretation of scRNA-seq data.</p></abstract><kwd-group><kwd>single-cell transcriptomic</kwd><kwd>pathway analysis</kwd><kwd>cell classification</kwd><kwd>text-mining</kwd><kwd>transfer learning</kwd><kwd>non-negative matrix factorization</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Single-cell RNA sequencing (scRNA-seq) delivers unprecedented opportunities for measuring gene expression at genome-wide scale and single-cell resolution. It provides a cost-effective way to study cellular tissue composition (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref>), dynamic processes during cell developmental stages (<xref ref-type="bibr" rid="R6">6</xref>), or the role of transcriptional heterogeneity in pathological conditions and in response to treatments (<xref ref-type="bibr" rid="R7">7</xref>). Indeed, scRNA-seq is becoming the leading technique for transcriptome profiling with large atlases of cells now routinely released from labs worldwide (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R8">8</xref>). Although scRNA-seq confers the advantage of measuring gene expression at the granular resolution of individual cells, the data produced with this sequencing technique are extremely noisy and zero-inflated (<xref ref-type="bibr" rid="R9">9</xref>). This property arises from both the low amount of mRNA available in a single cell and the limited capture efficiency of the technology. Thus, computational tools initially built to analyse bulk RNA-seq are often inadequate for scRNA-seq, and ad-hoc tools need to be developed to address the peculiarities of single-cell data. The significant increase in scRNA-seq studies raised several computational challenges, such as the development of automatic methods for functional annotation of scRNA-seq helpful for cell type assignment or disease diagnosis.</p><p id="P3">In the last decade, a plethora of tools have been developed to summarize regulated gene expression profiles into simplified functional categories useful for the annotation and interpretation of bulk RNA-seq data (<xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R16">16</xref>). Among these, the gene set enrichment analysis (GSEA) (<xref ref-type="bibr" rid="R11">11</xref>) is probably the most used. GSEA is a statistical tool that aims to measure coordinated activity of <italic>a priori</italic> defined gene sets (<italic>i</italic>.<italic>e</italic>., pathway) starting from a ranked list of genes usually obtained from differential expression (DE) analysis. By aggregating individual DE genes into pathways, GSEA projects DE results in a robust and easily interpretable biological space where additional analytics tools can be later applied. Currently, the application of GSEA to single cell data remains challenging (<xref ref-type="bibr" rid="R17">17</xref>) and only few methods are currently available, but are not efficient (<xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R19">19</xref>). Therefore, there is an urgent need to develop novel computational methods capable of scoring the activity of a pathway within a reasonable time scale. On the other hand, the availability of large single-cell reference atlases comprising up to millions of cells across different species, conditions, tissues, or organs provides an unprecedented opportunity to use “re-purposing” techniques for the functional annotation of cells. Indeed, transfer learning (TL) techniques (<xref ref-type="bibr" rid="R20">20</xref>) are becoming increasing popular in the analysis of high-throughput -omics datasets including single-cell datasets (<xref ref-type="bibr" rid="R21">21</xref>–<xref ref-type="bibr" rid="R24">24</xref>). TL is a machine learning technique that uses joint embedding to integrate a query set of objects into a given reference and to contextualize them with the metadata associated with the reference elements.</p><p id="P4">Here, we present two novel ready-to-use pipelines tailored to scRNA-seq data that can be used to automatize cell functional annotation: scGSEA (single-cell gene set enrichment analysis) and scMAP (single-cell Mapper). scGSEA is a statistical framework for scoring coordinated gene activity in individual cells to automatically determine the pathways are active in a cell. scMAP is a TL algorithm to map a query set of cell transcriptional profiles on top of an existing reference atlas and contextualize the new data with the reference metadata. Both methods are based on non-negative matrix factorization (NMF) (<xref ref-type="bibr" rid="R25">25</xref>), a popular matrix decomposition method, that can be solved in a very computationally efficient manner (<xref ref-type="bibr" rid="R26">26</xref>). We validated scGSEA to identify pathway activity in both a simulated dataset and a real dataset comprising cells during various reprogramming stages (<xref ref-type="bibr" rid="R6">6</xref>) or drug treatment (<xref ref-type="bibr" rid="R27">27</xref>). We also tested the ability of scMAP in mapping novel sequenced cells from several conditions, including cells sequenced in different batches or another lab with a different sequencing technique. Both tools were developed in the framework of the gficf package (<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R28">28</xref>), an R package we recently developed for the normalization, visualization and clustering of single-cell data that takes advantage of text-mining approaches and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/gficf">https://github.com/gambalab/gficf</ext-link>.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Gifcf package overview</title><p id="P5">We recently introduced an R package named <italic>gficf</italic> useful for normalization of 3’ single-cell transcriptional data and the identification of biomarker genes across multiple experimental conditions or cell types (<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R28">28</xref>). Our tool builds on a data transformation model named Gene Frequency – Inverse Cell Frequency (<italic>i</italic>.<italic>e</italic>., gf-icf) derived from the Term Frequency - Inverse Document Frequency (<italic>i</italic>.<italic>e</italic>., tf-idf) approach. TF-IDF is a statistical measure extensively used in the fields of text analysis and machine learning applied to Natural Language Processing (NLP) for quantifying the relevance of a word (<italic>i</italic>.<italic>e</italic>., gene) in a document (<italic>i</italic>.<italic>e</italic>., cell) amongst a comprehensive collection of documents (<italic>i</italic>.<italic>e</italic>., scRNA-seq dataset) (<xref ref-type="bibr" rid="R29">29</xref>, <xref ref-type="bibr" rid="R30">30</xref>). When applying this model to scRNAseq data, the relevance of a gene increases proportionally to its expression in the cell but is offset by the frequency of the gene in the population of sequenced cells (<xref ref-type="bibr" rid="R28">28</xref>), so that only genes highly expressed in a small fraction of the cells are selected as the most relevant.</p><p id="P6">Briefly, the gf-icf pipeline (<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R28">28</xref>) starts from a set of single-cell transcriptional profiles and consists of the following steps: (<italic>i</italic>) cell quality control (QC) and filtering; (<italic>ii</italic>) rescaling of gene expression profiles of each cell to sum one (GF step) after raw count normalization (<xref ref-type="bibr" rid="R31">31</xref>); (<italic>iii</italic>) cross-cell normalization, to assign higher scores to rarely expressed genes than commonly expressed genes within each cell (ICF step); (<italic>iv</italic>) an L2 rescaling step to normalize gf-icf values; (<italic>v</italic>) linear dimensionality reduction of the data (<italic>i</italic>.<italic>e</italic>., PCA(<xref ref-type="bibr" rid="R32">32</xref>) or NMF(<xref ref-type="bibr" rid="R26">26</xref>)) to condense the complexity of the dataset into a lower-dimensional space (<italic>vi</italic>) non-linear dimensionality reduction (<italic>i</italic>.<italic>e</italic>., t-SNE (<xref ref-type="bibr" rid="R33">33</xref>) or UMAP (<xref ref-type="bibr" rid="R34">34</xref>)) of the data for its visualization and finally (<italic>vii</italic>) several downstream analyses including cell clustering and differential expression (<xref ref-type="bibr" rid="R9">9</xref>) (<xref ref-type="fig" rid="F1">Figure 1A</xref>). GF-ICF method is implemented as an open-source R package, freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/gficf">https://github.com/gambalab/gficf</ext-link>.</p><p id="P7">Here we updated the <italic>gf-icf</italic> package and implemented two novel functionalities: scGSEA and scMap.</p></sec><sec id="S4"><title>scGSEA for the reconstruction of pathway activity at single cell resolution</title><p id="P8">We aimed to construct a bioinformatic method that could measure the activity of an <italic>a priori</italic> defined collection of gene sets (<italic>i</italic>.<italic>e</italic>., pathways) at the single cell resolution. To this end, we developed a robust and fast single-cell Gene Set Enrichment Analysis (scGSEA) algorithm that takes advantage of the informative biological signals spreading across the latent factors of gene expression values obtained from non-negative matrix factorization (<xref ref-type="sec" rid="S7">Methods</xref>) (<xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R26">26</xref>). The scGSEA method starts from a set of single-cell expression profiles and a collection of gene sets and scores their cumulative expression (<italic>i</italic>.<italic>e</italic>., pathway activity) in each of the profiled cells and it is divided into three main steps (<xref ref-type="fig" rid="F1">Figure 1B</xref>). In the first step, we use NMF to decompose GF-ICF normalized data into two positive related matrices containing gene weights (<bold>W</bold>) and cell weights (<bold>H</bold>). Each column of <bold>W</bold> or row of <bold>H</bold> defines a factor representing complex biological processes that recur throughout the set of sequenced cells (<xref ref-type="bibr" rid="R35">35</xref>, <xref ref-type="bibr" rid="R36">36</xref>). While, at the same time, all features define the latent space amongst genes and cells. In the second step, we infer which biological processes each latent factor is associated with by performing GSEA (<xref ref-type="bibr" rid="R37">37</xref>) against each column of the <bold>W</bold> matrix. Since the values in each column of the <bold>W</bold> matrix are continuous weights describing the relative contribution of a gene in each inferred factor, a positive and significant value of the enrichment score (ES) for a specific pathway implies the factor is related to it. At the end of this step, the <bold>W</bold> matrix is transformed into a novel positive matrix <bold>P</bold> describing the pathways’ contribution in the form of normalized enrichment scores (NES) for each latent factor. Finally, in the third step, we infer the pathway’s activity level in each profiled cell by multiplying the <bold>P</bold> matrix reconstructed in step two with the <bold>H</bold> matrix obtained using the NMF method in step one. The rationale behind this last step is that each column of the matrix <bold>H</bold> describes the relative contribution of a cell across the factors. Thus, a cell with a high weight for a specific factor is assumed to share the phenotype or biological process related to that factor (<xref ref-type="bibr" rid="R36">36</xref>). Consequently, the activity level of a pathway in a cell can be computed as the weighted sum of the normalized pathway’s enrichment scores across the factors shared by the cell.</p><p id="P9">We performed simulations to assess the effectiveness of scGSEA in recapitulating the activity level of a pathway at single cell level (see methods for details). By using the splatter package (<xref ref-type="bibr" rid="R38">38</xref>) we generated a zero-inflated count dataset composed of 5,000 cells grouped in four distinct populations (<xref ref-type="fig" rid="F1">Figure 1C</xref>) through a gamma-Poisson distribution using parameters inferred from real dataset. Then, we assigned 24 overlapping gene sets of different sizes (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 01</xref>) to be exclusively expressed in each cluster (<italic>i</italic>.<italic>e</italic>., six specific gene sets per cluster). As shown in <xref ref-type="fig" rid="F1">Figure 1D</xref>, we found that scGSEA can identify in each group of cells the activity of the 6 specific simulated pathways with some of these correctly predicted active also in other groups of cells due to their partial overlap with other genes sets (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 01</xref>).</p><p id="P10">To demonstrate the reliability of the scGSEA method on a real dataset, we applied it to the cell reprogramming scRNA-seq data in Schiebinger et al. (<xref ref-type="bibr" rid="R6">6</xref>). This dataset comprises 251,203 single-cell transcriptional profiles collected at half-day intervals across 18 days of reprogramming by ectopic expression of OKSM (a.k.a. Oct4, Klf4, Sox2, and Myc) transcription factors. In this work, the authors constructed seven curated gene signatures to score cells as pluripotent-, epithelial-, trophoblast-, neural-, MEF-like and proliferative. Hence, we applied our scGSEA method to this dataset with these seven gene sets as the input. As shown in <xref ref-type="fig" rid="F1">Figure 1E-F</xref>, we found a high degree of correlation (avg. 0.8) between the predicted scGSEA pathway’s activity level and the pathway expression computed by Schiebinger et al. (<xref ref-type="bibr" rid="R6">6</xref>).</p><p id="P11">Next, we investigated whether we could use scGSEA scores to infer cell trajectories and reconstruct dynamics of the key pathways driving resistance to EGFR inhibitors in non-small-cell lung carcinoma (NSCLC). Several studies have suggested that acquired resistance mechanisms to EGFR inhibitors involve the compensatory activation of redundant signalling pathways that share effectors or downstream modulators of the EGFR signalling cascade, thus bypassing EGFR inhibition. Different pathways can serve as alternative routes for reactivation of signalling downstream of inhibited EGFR, including MET, IGF-1R, PI3K-AKT-mTOR, BRAF/RAS and Wnt signalling pathways (<xref ref-type="bibr" rid="R39">39</xref>–<xref ref-type="bibr" rid="R42">42</xref>), all able to sustain cell survival, proliferation, migration, and epithelial-mesenchymal transition (EMT).</p><p id="P12">Therefore, we downloaded the scRNA-seq dataset published by Aissa et al. (<xref ref-type="bibr" rid="R27">27</xref>) comprising 1,044 PC9 lung cells (<xref ref-type="fig" rid="F1">Figure 1G</xref>) that were subject to eleven days of consecutive erlotinib treatment and sequenced at six different time points (i.e., 0, 1, 2, 4, 9, and 11 days). We then applied scGSEA to score the activity of 50 MSigDB hallmark pathways (<xref ref-type="bibr" rid="R43">43</xref>) across the cells. The resulting scores were used as input to reconstruct the dynamic activity of these pathway by applying a pseudotime algorithm (<xref ref-type="bibr" rid="R44">44</xref>) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 02</xref>). As shown in <xref ref-type="fig" rid="F1">Figure 1H,I</xref> we found strong upregulation of EMT and Wnt b-catenin signalling pathways in erlotinib tolerant cells, while erlotinib tolerant cells showed a potent inhibition of genes related to cholesterol and fatty acid metabolism, as also reported by Aissa et al. (<xref ref-type="fig" rid="F1">Figure 1J,K</xref>).</p><p id="P13">These results show how scGSEA could recapitulate recurrent patterns of pathways’ activity shared by hundreds of thousands of cells from multiple conditions and during dynamic processes like cell reprogramming or drug treatments.</p></sec><sec id="S5"><title>Mapping a single cell transcriptional profile on a reference atlas</title><p id="P14">We aimed to construct a computational method that starting from the transcriptional state of a cell, could be integrated, and contextualized within a larger reference cell atlas by using the metadata associated to the reference cells. To this end, we developed scMAP (single-cell Mapper), a transfer learning algorithm that combines text mining data transformation and a k-nearest neighbours’ (KNN) classifier (methods) to map a query set of single-cell transcriptional profiles on top of a reference atlas. Our strategy consists of three main steps, as schematised in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 03</xref>: (i) we first normalize the query cell profiles with the GF-ICF method by using the ICF weights learned by the reference atlas; (ii) we then project normalized cell profiles to the NMF (or PC) sub-space of the reference atlas before mapping them onto its UMAP embedding space; (iii) finally, we use the KNN algorithm to contextualize mapped cells.</p><p id="P15">To test scMAP, we took advantage of the single-cell atlas of breast cancer we have recently released (<xref ref-type="bibr" rid="R7">7</xref>). This atlas comprises 35,276 individual cells from 32 breast cancer cell lines covering all four major breast tumour subtypes (<italic>i</italic>.<italic>e</italic>., LuminalA, LuminalB, Her2-positive and Basal Like). Hence, we first applied GF-ICF tool (<xref ref-type="bibr" rid="R28">28</xref>) on these cells to generate a reference UMAP embedding space from the either from the top 100 NMF factors (<xref ref-type="fig" rid="F2">Figure 2A</xref>) or the top 50 PC (<xref ref-type="fig" rid="F2">Figure 2B</xref>). Next, we used three approaches to test the accuracy of our method in correctly mapping the very cells in the breast cancer atlas. First, we used a cross-validation approach where we randomly divided the 35,276 single-cell transcriptional profiles in different proportions of training and test cells (<italic>i</italic>.<italic>e</italic>., from 10 to 90% of the cells in each cell line). With this approach, we use training cells to reconstruct the reference atlas and the remaining cells to measure the performances of the remapping algorithm. Second, we re-sequenced with the DROP-seq platform 1,683 cells of two cell lines included in the atlas and mapped the transcriptome of these cells onto it. Third, we tested our mapping strategy on 16,683 single cell transcriptional profiles from 11 cell lines included in the atlas but sequenced by other laboratories with 10X genomics platform (<xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R45">45</xref>). In all cases the performances of the mapping algorithm were tested by using either NMF or PCA as cell sub-space before remapping them into the UMAP embedding space. After remapping, the label of a cell was assigned using the closest 101 cells (<xref ref-type="bibr" rid="R7">7</xref>) (see methods).</p><p id="P16">As shown in <xref ref-type="fig" rid="F2">Figure 2C</xref>, the median cross-validation approach’s accuracy of the mapping algorithm was 97% when using NFM as cell sub-space and 99% when using PC as sub-space. However, with the cross-validation approach we always use cells sequenced in the same batch. Thus, to avoid this possible bias, we re-sequenced 306 and 1,377 cells of MDAMB468 and CAL51 cell lines, respectively (see methods). As shown in <xref ref-type="fig" rid="F2">Figure 2D</xref>, 96% of MDAMB468 and 97.3% for CAL51 cells were recognized and labelled correctly when using NFM as cell sub-space. While when using PC as subspace mapping accuracy was of 79.7% and 98.1% for MDAM468 and CAL51 respectively (<xref ref-type="fig" rid="F2">Figure 2E</xref>).</p><p id="P17">Next, we investigated whether the sequencing technology could affect the efficacy of the mapping algorithm. Thus, we started mapping into the reference breast cancer cell-line atlas 14,372 single cell transcriptomes sequenced using the 10x Chromium method from the MCF7 cell line and three subclones derived from it (<xref ref-type="bibr" rid="R45">45</xref>). Considering that KPL1 has been documented as an MCF7 derivative cell line (<xref ref-type="bibr" rid="R46">46</xref>, <xref ref-type="bibr" rid="R47">47</xref>), we found that 13,699 of the 14,372 cells (95.3%) were recognized correctly (<xref ref-type="fig" rid="F2">Figure 2F</xref>) when using NFM as subspace. Using PC instead of NFM as a cell sub-space, the total accuracy was of 94.2% (<xref ref-type="fig" rid="F2">Figure 2F</xref>). Finally, we mapped 2,311 single cell transcriptomes sequenced using the 10x Chromium method from eleven additional breast cell lines included in our atlas and published by Kinker et al. (<xref ref-type="bibr" rid="R8">8</xref>). <xref ref-type="fig" rid="F2">Figure 2G</xref> shows classification performance on these cells in terms of ROC (Receiver operating characteristic) curve with an AUC of 0.975. The AUC of the ROC curve was 0.876 when the PC subspace was used instead of NFM (<xref ref-type="fig" rid="F2">Figure 2H</xref>).</p><p id="P18">Overall, these analyses shows that the mapping approach and transfer learning strategy we developed provide reliable results with good accuracy.</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P19">Single-cell RNA-seq provides a cost-effective way to study cell composition of tissues (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref>), cell developmental stages (<xref ref-type="bibr" rid="R6">6</xref>), and to elucidate the role of transcriptional heterogeneity in pathological conditions or in response to drug treatments (<xref ref-type="bibr" rid="R7">7</xref>). Indeed, large atlases of cells with their relative associated metadata are now routinely released. However, computational methods for the reconstruction of pathway activity at single cell level useful for their annotation or to contextualize novel sequenced cells in an already available and annotated atlas of cells remain challenging.</p><p id="P20">Finding an effective way to capture coordinated gene activity at the single-cell level is crucial for single-cell data transformation and subsequent analyses. Such transformation allows representation of cellular state in terms of activity levels of biological processes (<italic>i</italic>.<italic>e</italic>., set of genes) rather than through the expression levels of individual genes. Thus, allowing the projection of single-cell data to a quickly biologically interpretable space in which analytic approaches can later be applied. For example, such representations could be used to detect within the same cell type shifts in the portion of cells exhibiting an altered biological process between two phenotypes of interest. Thus improving the identification of dysregulated signalling pathways across pathological conditions, otherwise identified from differential expression (<xref ref-type="bibr" rid="R31">31</xref>, <xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R52">52</xref>) or co-expression (<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R53">53</xref>–<xref ref-type="bibr" rid="R65">65</xref>) analyses that are still challenging for single cell datasets due to their zero-inflated nature (<xref ref-type="bibr" rid="R66">66</xref>–<xref ref-type="bibr" rid="R72">72</xref>).</p><p id="P21">Here, we introduced scGSEA, a novel efficient ready-to-use method that provides an effective and simple workflow for the measurement of pathway activity at single cell level. Our scGSEA takes advantage of the informative biological signals spreading across the colinearly optimized and additive collection of factors of gene expression values obtained from an NMF model. Indeed, when applied on bulk transcriptional datasets, NMF factors have already been shown to better capture patterns of coordinated gene activities compared to other matrix decomposition methods like SVD ranks or PCA components (<xref ref-type="bibr" rid="R36">36</xref>) Recently, NMF has been shown to greatly improve scRNA-seq data clustering and visualization thanks to its inbuilt ability to impute missing values and decompose data into additive parts (<xref ref-type="bibr" rid="R26">26</xref>). In applications, we demonstrated that our scGSEA has high accuracy in capturing coordinated gene activity at the single-cell level in both simulated and real dataset comprising hundreds of thousands of cells. However, scGSEA is a tool that leverages NMF expression latent factors to infer pathway activity at a single cell level. Thus, by design, it inherits both benefits and limitations of the NMF model. For example, a limit of this model, like other matrix decomposition techniques, is the choice of the exact number of factors to use. This choice can be made by either using a subjective approach like finding an inflection point in a curve of ranks against an objective (i.e., elbow plot) or with higher precision, but computationally demanding approaches, like jackstraw or k-fold cross-validation. However, when choosing the number of factors to use, to avoid information loss, it is advisable to adopt a cautious approach by selecting a higher number. Thus, we generally recommend using at least 100 NMF factors on a large dataset comprising more than 10,000 cells, otherwise 50 should suffice.</p><p id="P22">In this study we also presented scMAP, a transfer learning algorithm that combines text mining data transformation and the k-nearest neighbours’ algorithm to map a query set of cell transcriptional profiles on top of an existing cell atlas. Finding an effective way to “re-purpose” sequenced cells in an already annotated dataset of cells could be helpful in the study of different diseases. For example, we have already shown that we can use breast cancer cell lines for automatic cancer subtype classification starting from the single cell transcriptomic dataset of patient biopsies (<xref ref-type="bibr" rid="R7">7</xref>). Recently, it has also been shown that with transfer learning, we can use the knowledge of sensitive drugs for each cell line to predict the patient’s treatment once the patient’s cells were confidently mapped on the reference atlas (<xref ref-type="bibr" rid="R73">73</xref>). Here, we demonstrated our method has high accuracy in cell mapping even when we profile cells’ transcriptomes after several culture passages in a different batch or with a different sequencing technique. The proposed mapping method may be applicable in several scenarios; however, it is best suited when the query cells consist of cell types and experimental protocols close to the reference data. Finally, the number of shared genes between the query and reference cells can also impact mapping accuracy. We recommend using all available genes in the reference-building step to guarantee more extensive feature overlap between reference and query cells, which naturally increases the mapping quality.</p><p id="P23">In summary, we have updated our gficf R package with two novel functionalities, both useful for cell functional annotation. One allows to capture coordinated gene activity at the single-cell level, and another that can re-purpose newly sequenced cells into an already annotated reference dataset. Both tools are provided in an effective and straightforward workflow and are implemented in the framework of our open-source R package gficf available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/gficf">https://github.com/gambalab/gficf</ext-link>.</p></sec><sec id="S7" sec-type="methods"><title>Methods</title><sec id="S8"><title>Cell culture</title><p id="P24">MDAMB468 and CAL51 cell lines used in this study were obtained from commercial providers and cultured in ATCC recommended complete media at 37°C and 5% CO2.</p></sec><sec id="S9"><title>scRNA library preparation, sequencing and alignment</title><p id="P25">Single cell transcriptomic of the MDAMB468 and CAL51 cell lines were performed with DROP-seq technology (<xref ref-type="bibr" rid="R74">74</xref>) and library preparation as described in Gambardella et al. (<xref ref-type="bibr" rid="R7">7</xref>). scRNA libraries were sequenced with NovaSeq 6000 machine using an SP 100 cycles flow cell. Raw reads pre-processing was performed using Drop-seq tools v2.3.0 and following the Dropseq Core Computational Protocol reported at <ext-link ext-link-type="uri" xlink:href="http://mccarrolllab.org/dropseq">http://mccarrolllab.org/dropseq</ext-link>. Briefly, raw reads were first filtered to remove all read pairs with at least one base in their cell barcode or UMI with a quality score less than 10. Then read 2 was trimmed at the 5’ end to remove any TSO adapter sequence, and at the 3’ end to remove polyA tails. Filtered reads were then fed to STARsolo tool v2.7.10a (<ext-link ext-link-type="uri" xlink:href="https://github.com/cellgeni/STARsolo">https://github.com/cellgeni/STARsolo</ext-link>) to perform alignment, UMI deduplication and gene expression quantification. Hg38 human genome (primary assembly v40) downloaded from GENCODE (<xref ref-type="bibr" rid="R75">75</xref>) was used as a reference genome for read alignment. Only high depth cells with at least 2,500 UMI were retained and used to test our cell mapping tool. Alignment pipeline can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/dropseq">https://github.com/gambalab/dropseq</ext-link>.</p></sec><sec id="S10"><title>Single Cell Gene Set Enrichment Analysis (scGSEA)</title><p id="P26">To perform scGSEA, raw count matrix was first normalized with gficf package (<xref ref-type="bibr" rid="R28">28</xref>). Then, NMF was used to decompose gficf scores into two positive related matrices containing gene weights (<bold>W</bold>) and cell weights (<bold>H</bold>) where each column of <bold>W</bold> or row of <bold>H</bold> defines a latent actor <italic>f</italic><sub><italic>i</italic></sub>. Non-negative matrix factorization was performed by using the fast parallel implementation can be found in RcppML R package (<xref ref-type="bibr" rid="R26">26</xref>) available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zdebruine/RcppML">https://github.com/zdebruine/RcppML</ext-link>. Then gene set enrichment analysis was performed against each column of the <bold>W</bold> matrix using as input a pre-defined list of gene sets <italic>S =</italic> {<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>
<italic>… s</italic><sub><italic>n</italic></sub>}. GSEA was performed using the R package fgsea (<xref ref-type="bibr" rid="R37">37</xref>) available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ctlab/fgsea">https://github.com/ctlab/fgsea</ext-link>. At the end of this process, a novel matrix <bold>P</bold> with the same number of columns (<italic>i</italic>.<italic>e</italic>., factors) of <bold>W</bold> and with the number or rows equal to the number of inputs used gene set is obtained. Each element of <bold>P</bold><sub><italic>i,j</italic></sub> contains the normalized enrichment scores of the pathway <italic>s</italic><sub><italic>i</italic></sub> related to the factor <italic>f</italic><sub><italic>j</italic></sub>. Next, only positives and significant normalized enrichment scores with an FDR&lt;0.05 were retained while all the other elements of <bold>P</bold> are put to zero. Finally, since elements of <bold>P</bold> describe the pathways’ contribution in each latent factor, the pathway’s activity level in each profiled cell is computed as the weighted sum of the normalized pathway’s enrichment scores across the factors shared by the cell. This corresponds simply to the dot product of the <bold>P</bold> and <bold>H</bold> matrices. The described pipeline is implemented in the function scGSEA of the gficf package.</p></sec><sec id="S11"><title>Simulated scRNA-seq profiles and gene sets</title><p id="P27">Splatter R package (<xref ref-type="bibr" rid="R38">38</xref>) with default parameters was used to generate a zero-inflated count dataset composed of 5,000 cells and 1,000 genes with cells grouped in four distinct populations. Next, six gene sets were simulated to be exclusively expressed in each group of simulated cells (<italic>i</italic>.<italic>e</italic>., 6 gene sets x 4 groups of cells = 24 simulated gene sets). The 24 gene sets comprised 2,432 unique genes that we added to the simulated dataset generated with splatter. A zero-inflate Poisson distribution with success probability equal to 50% and lambada value of 10 was used to simulate the expression of a gene set in a specific set of cells. This to simulate a moderate dropout and a relatively low gene count expression for each gene set.</p></sec><sec id="S12"><title>Pseudo-time analisys</title><p id="P28">scGSEA method was run using as imput the 1,044 PC9 single cell transcriptional profiles and the 50 hallmarks gene sets (v2022.1) downloaded from MSigDB (<ext-link ext-link-type="uri" xlink:href="http://www.gsea-msigdb.org/gsea/msigdb">www.gsea-msigdb.org/gsea/msigdb</ext-link>). The obtained pathways’ activity matrix was used to run psupertime function of psupertime R package and infer the pseudo-time order of cells. Psupertime function was run with default parameters and using as labels their sequencing day (i.e., 0, 1, 2, 4, 9 or 11)</p></sec><sec id="S13"><title>Single Cell Mapper (scMAP)</title><p id="P29">UMAP embedding space of reference single cell breast cancer atlas was built from scratch with gficf package (<xref ref-type="bibr" rid="R28">28</xref>). Then, new sequenced cells were mapped on the reference breast cancer atlas following the strategy depicted in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 02</xref>. Briefly, scRNA-seq profiles are first normalized with <italic>gficf</italic> strategy but using the ICF weight learned on the reference atlas and then projected to the existing NMF (or PC) sub-space using gene loadings learned from the breast cancer atlas. These values are then used as input of the <italic>umap_transform</italic> function of <italic>uwot</italic> package, which uses the UMAP reference model to map the new cells into the reference UMAP space. Finally, the cell line of origin associated with each mapped cell was predicted by using k nearest-neighbour algorithm from KernelKnn package (<ext-link ext-link-type="uri" xlink:href="https://mlampros.github.io/KernelKnn">https://mlampros.github.io/KernelKnn</ext-link>). For all assignments k parameter was set to 101. Single cell mapping is implemented in the function scMAP of the gficf package.</p></sec><sec id="S14"><title>Public single-cell transcriptional dataset</title><p id="P30">The raw counts of the 35,276 single cell transcriptional profiles of the 32 breast cancer cell (<xref ref-type="bibr" rid="R7">7</xref>) used in this study were downloaded from figshare (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.15022698">https://doi.org/10.6084/m9.figshare.15022698</ext-link>). The 251,203 single-cell transcriptional profile from pluripotent stem cells (<xref ref-type="bibr" rid="R6">6</xref>) were obtained from GEO database with accession number GSE122662. The single cell transcriptional profiles of MCF7 cells and derived clones (<xref ref-type="bibr" rid="R45">45</xref>) were obtained from GEO database with accession number GSE114462. The 2,311 single cell the transcriptional profile across the eleven breast cancer cell lines (<xref ref-type="bibr" rid="R8">8</xref>) were obtained from GEO database with accession number GSE157220. PC9 lung cells were obtained from GEO database with accession number GSE149383 but only 1,044 cells with a total number of UMI greaten then 2,500 were used in this work.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS156314-supplement-Supplementary_Figures.docx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.wordprocessingml.document" id="d2aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Funding</title><p>This work was supported by the My First AIRC grant 23162 and by iPC project H2020 826121 and Fondazione Telethon.</p></ack><sec id="S16" sec-type="data-availability"><title>Code Availability</title><p id="P31">R package of gf-icf pipeline and examples of use are available at the following address <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/gficf">https://github.com/gambalab/gficf</ext-link>. While scripts to reproduce main figures and analyses are available at the following address <ext-link ext-link-type="uri" xlink:href="https://github.com/gambalab/scGSA_scMAP_manuscript">https://github.com/gambalab/scGSA_scMAP_manuscript</ext-link>.</p></sec><sec id="S17" sec-type="data-availability"><title>Data Availability</title><p id="P32">Single-cell RNA-seq of MDAMB468 and CAL51 cell lines can be found on the GEO database with accession number GSE214827.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P33"><bold>Author Contributions</bold></p><p id="P34">GG wrote the manuscript, conceived, and developed the tools, SP and GV performed NGS experiments while MF performed bioinformatics analysis.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaum</surname><given-names>N</given-names></name><name><surname>Karkanias</surname><given-names>J</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>May</surname><given-names>AP</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Wyss-Coray</surname><given-names>T</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Batson</surname><given-names>J</given-names></name><name><surname>Botvinnik</surname><given-names>O</given-names></name><name><surname>Chen</surname><given-names>MB</given-names></name><etal/></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title><source>Nature</source><year>2018</year><volume>562</volume><fpage>367</fpage><lpage>372</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Fei</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Lai</surname><given-names>S</given-names></name><name><surname>Saadatpour</surname><given-names>A</given-names></name><name><surname>Zhou</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Ye</surname><given-names>F</given-names></name><etal/></person-group><article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title><source>Cell</source><year>2018</year><volume>172</volume><fpage>1091</fpage><lpage>1107</lpage><elocation-id>e17</elocation-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almanzar</surname><given-names>N</given-names></name><name><surname>Antony</surname><given-names>J</given-names></name><name><surname>Baghel</surname><given-names>AS</given-names></name><name><surname>Bakerman</surname><given-names>I</given-names></name><name><surname>Bansal</surname><given-names>I</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name><name><surname>Beachy</surname><given-names>PA</given-names></name><name><surname>Berdnik</surname><given-names>D</given-names></name><name><surname>Bilen</surname><given-names>B</given-names></name><name><surname>Brownfield</surname><given-names>D</given-names></name><etal/></person-group><article-title>A single-cell transcriptomic atlas characterizes ageing tissues in the mouse</article-title><source>Nature</source><year>2020</year><volume>583</volume><fpage>590</fpage><lpage>595</lpage></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>Z</given-names></name><name><surname>Fei</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Ge</surname><given-names>W</given-names></name><etal/></person-group><article-title>Construction of a human cell landscape at single-cell level</article-title><source>Nature</source><year>2020</year><volume>581</volume><fpage>303</fpage><lpage>309</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Benoist</surname><given-names>C</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Bodenmiller</surname><given-names>B</given-names></name><name><surname>Campbell</surname><given-names>P</given-names></name><name><surname>Carninci</surname><given-names>P</given-names></name><name><surname>Clatworthy</surname><given-names>M</given-names></name><etal/></person-group><article-title>The Human Cell Atlas</article-title><source>Elife</source><year>2017</year><volume>6</volume><elocation-id>e27041</elocation-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiebinger</surname><given-names>G</given-names></name><name><surname>Shu</surname><given-names>J</given-names></name><name><surname>Tabaka</surname><given-names>M</given-names></name><name><surname>Cleary</surname><given-names>B</given-names></name><name><surname>Subramanian</surname><given-names>V</given-names></name><name><surname>Solomon</surname><given-names>A</given-names></name><name><surname>Gould</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Berube</surname><given-names>P</given-names></name><etal/></person-group><article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title><source>Cell</source><year>2019</year><volume>176</volume><fpage>928</fpage><lpage>943</lpage><elocation-id>e22</elocation-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambardella</surname><given-names>G</given-names></name><name><surname>Viscido</surname><given-names>G</given-names></name><name><surname>Tumaini</surname><given-names>B</given-names></name><name><surname>Isacchi</surname><given-names>A</given-names></name><name><surname>Bosotti</surname><given-names>R</given-names></name><name><surname>di Bernardo</surname><given-names>D</given-names></name></person-group><article-title>A single-cell analysis of breast cancer cell lines to study tumour heterogeneity and drug response</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><elocation-id>1714</elocation-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinker</surname><given-names>GS</given-names></name><name><surname>Greenwald</surname><given-names>AC</given-names></name><name><surname>Tal</surname><given-names>R</given-names></name><name><surname>Orlova</surname><given-names>Z</given-names></name><name><surname>Cuoco</surname><given-names>MS</given-names></name><name><surname>McFarland</surname><given-names>JM</given-names></name><name><surname>Warren</surname><given-names>A</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Roth</surname><given-names>JA</given-names></name><name><surname>Bender</surname><given-names>SA</given-names></name><etal/></person-group><article-title>Pan-cancer single-cell RNA-seq identifies recurring programs of cellular heterogeneity</article-title><source>Nat Genet</source><year>2020</year><volume>52</volume><fpage>1208</fpage><lpage>1218</lpage></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Slovin</surname><given-names>S</given-names></name><name><surname>Carissimo</surname><given-names>A</given-names></name><name><surname>Panariello</surname><given-names>F</given-names></name><name><surname>Grimaldi</surname><given-names>A</given-names></name><name><surname>Bouché</surname><given-names>V</given-names></name><name><surname>Gambardella</surname><given-names>G</given-names></name><name><surname>Cacchiarelli</surname><given-names>D</given-names></name></person-group><source>Single-Cell RNA Sequencing Analysis: A Step-by-Step Overview BT - RNA Bioinformatics</source><person-group person-group-type="editor"><name><surname>Picardi</surname><given-names>E</given-names></name></person-group><publisher-name>Springer US</publisher-name><publisher-loc>New York, NY</publisher-loc><year>2021</year><fpage>343</fpage><lpage>365</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi Jing</surname><given-names>L</given-names></name><name><surname>Fathiah Muzaffar Shah</surname><given-names>F</given-names></name><name><surname>Saberi Mohamad</surname><given-names>M</given-names></name><name><surname>Moorthy</surname><given-names>K</given-names></name><name><surname>Deris</surname><given-names>S</given-names></name><name><surname>Zakaria</surname><given-names>Z</given-names></name><name><surname>Napis</surname><given-names>S</given-names></name></person-group><article-title>A Review on Bioinformatics Enrichment Analysis Tools Towards Functional Analysis of High Throughput Gene Set Data</article-title><source>Curr Proteomics</source><year>2015</year><volume>12</volume><fpage>14</fpage><lpage>27</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc Natl Acad Sci U S A</source><year>2005</year><volume>102</volume><fpage>15545</fpage><lpage>50</lpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oron</surname><given-names>AP</given-names></name><name><surname>Jiang</surname><given-names>Z</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group><article-title>Gene set enrichment analysis using linear models and diagnostics</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>2586</fpage><lpage>2591</lpage></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camp</surname><given-names>JG</given-names></name><name><surname>Badsha</surname><given-names>F</given-names></name><name><surname>Florio</surname><given-names>M</given-names></name><name><surname>Kanton</surname><given-names>S</given-names></name><name><surname>Gerber</surname><given-names>T</given-names></name><name><surname>Wilsch-Bräuninger</surname><given-names>M</given-names></name><name><surname>Lewitus</surname><given-names>E</given-names></name><name><surname>Sykes</surname><given-names>A</given-names></name><name><surname>Hevers</surname><given-names>W</given-names></name><name><surname>Lancaster</surname><given-names>M</given-names></name><etal/></person-group><article-title>Human cerebral organoids recapitulate gene expression programs of fetal neocortex development</article-title><source>Proc Natl Acad Sci</source><year>2015</year><volume>112</volume><fpage>15672</fpage><lpage>15677</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>van de Geer</surname><given-names>SA</given-names></name><name><surname>de Kort</surname><given-names>F</given-names></name><name><surname>van Houwelingen</surname><given-names>HC</given-names></name></person-group><article-title>A global test for groups of genes: testing association with a clinical outcome</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>93</fpage><lpage>99</lpage></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S-Y</given-names></name><name><surname>Volsky</surname><given-names>DJ</given-names></name></person-group><article-title>PAGE: Parametric Analysis of Gene Set Enrichment</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>144</fpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><elocation-id>e133</elocation-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noureen</surname><given-names>N</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name></person-group><article-title>Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data</article-title><source>Elife</source><year>2022</year><volume>11</volume><elocation-id>e71994</elocation-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pont</surname><given-names>F</given-names></name><name><surname>Tosolini</surname><given-names>M</given-names></name><name><surname>Fournié</surname><given-names>JJ</given-names></name></person-group><article-title>Single-Cell Signature Explorer for comprehensive visualization of single cell signatures across scRNA-seq datasets</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><elocation-id>e133</elocation-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>González-Blas</surname><given-names>CB</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Imrichova</surname><given-names>H</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Rambow</surname><given-names>F</given-names></name><name><surname>Marine</surname><given-names>J-C</given-names></name><name><surname>Geurts</surname><given-names>P</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><etal/></person-group><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>1083</fpage><lpage>1086</lpage></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>SJ</given-names></name><name><surname>Yang</surname><given-names>Q</given-names></name></person-group><article-title>A Survey on Transfer Learning</article-title><source>IEEE Trans Knowl Data Eng</source><year>2010</year><volume>22</volume><fpage>1345</fpage><lpage>1359</lpage></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>Wu</surname><given-names>T-Y</given-names></name><name><surname>Wan</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>JYH</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name><name><surname>Wang</surname><given-names>YXR</given-names></name></person-group><article-title>scJoint integrates atlas-scale single-cell RNA-seq and ATAC-seq data with transfer learning</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>703</fpage><lpage>710</lpage></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Wamsley</surname><given-names>B</given-names></name><name><surname>Wei</surname><given-names>Y</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name></person-group><article-title>Integration and transfer learning of single-cell transcriptomes via cFIT</article-title><source>Proc Natl Acad Sci</source><year>2021</year><volume>118</volume><elocation-id>e2024383118</elocation-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Naghipourfar</surname><given-names>M</given-names></name><name><surname>Luecken</surname><given-names>MD</given-names></name><name><surname>Khajavi</surname><given-names>M</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Wagenstetter</surname><given-names>M</given-names></name><name><surname>Avsec</surname><given-names>Ž</given-names></name><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name><name><surname>Interlandi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Mapping single-cell data to reference atlases by transfer learning</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>121</fpage><lpage>130</lpage></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name><name><surname>Clark</surname><given-names>BS</given-names></name><name><surname>Sherman</surname><given-names>T</given-names></name><name><surname>Zibetti</surname><given-names>C</given-names></name><name><surname>Hu</surname><given-names>Q</given-names></name><name><surname>Sealfon</surname><given-names>R</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Qian</surname><given-names>J</given-names></name><name><surname>Colantuoni</surname><given-names>C</given-names></name><name><surname>Blackshaw</surname><given-names>S</given-names></name><etal/></person-group><article-title>Decomposing Cell Identity for Transfer Learning across Cellular Measurements, Platforms, Tissues, and Species</article-title><source>Cell Syst</source><year>2019</year><volume>8</volume><fpage>395</fpage><lpage>411</lpage><elocation-id>e8</elocation-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>DD</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name></person-group><article-title>Learning the parts of objects by non-negative matrix factorization</article-title><source>Nature</source><year>1999</year><volume>401</volume><fpage>788</fpage><lpage>791</lpage></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeBruine</surname><given-names>ZJ</given-names></name><name><surname>Melcher</surname><given-names>K</given-names></name><name><surname>Triche</surname><given-names>TJ</given-names></name></person-group><article-title>Fast and robust non-negative matrix factorization for single-cell experiments</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type="doi">10.1101/2021.09.01.458620</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aissa</surname><given-names>AF</given-names></name><name><surname>Islam</surname><given-names>ABMMK</given-names></name><name><surname>Ariss</surname><given-names>MM</given-names></name><name><surname>Go</surname><given-names>CC</given-names></name><name><surname>Rader</surname><given-names>AE</given-names></name><name><surname>Conrardy</surname><given-names>RD</given-names></name><name><surname>Gajda</surname><given-names>AM</given-names></name><name><surname>Rubio-Perez</surname><given-names>C</given-names></name><name><surname>Valyi-Nagy</surname><given-names>K</given-names></name><name><surname>Pasquinelli</surname><given-names>M</given-names></name><etal/></person-group><article-title>Single-cell transcriptional changes associated with drug tolerance and response to combination therapies in cancer</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>1</fpage><lpage>25</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambardella</surname><given-names>G</given-names></name><name><surname>di Bernardo</surname><given-names>D</given-names></name></person-group><article-title>A Tool for Visualization and Analysis of Single-Cell RNA-Seq Data Based on Text Mining</article-title><source>Front Genet</source><year>2019</year><volume>10</volume></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leskovec</surname><given-names>J</given-names></name><name><surname>Rajaraman</surname><given-names>A</given-names></name><name><surname>Ullman</surname><given-names>JD</given-names></name></person-group><source>Mining of Massive Datasets</source><publisher-name>Cambridge University Press</publisher-name><publisher-loc>Cambridge</publisher-loc><year>2014</year></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>SE</given-names></name><name><surname>Jones</surname><given-names>KS</given-names></name></person-group><article-title>Relevance weighting of search terms</article-title><source>J Am Soc Inf Sci</source><year>1976</year><volume>27</volume><fpage>129</fpage><lpage>146</lpage></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>K</given-names></name></person-group><article-title>LIII. On lines and planes of closest fit to systems of points in space</article-title><source>London, Edinburgh, Dublin Philos Mag J Sci</source><year>1901</year><volume>2</volume><fpage>559</fpage><lpage>572</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname><given-names>Laurens</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><article-title>Visualizing Data using t-SNE</article-title><source>J Mach Learn Res</source><year>2008</year><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Melville</surname><given-names>J</given-names></name></person-group><source>UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction</source><year>2018</year><comment>Prepr. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.03426">https://arxiv.org/abs/1802.03426</ext-link></comment></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>BS</given-names></name><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name><name><surname>Shiau</surname><given-names>F</given-names></name><name><surname>Cannon</surname><given-names>GH</given-names></name><name><surname>Davis-Marcisak</surname><given-names>E</given-names></name><name><surname>Sherman</surname><given-names>T</given-names></name><name><surname>Santiago</surname><given-names>CP</given-names></name><name><surname>Hoang</surname><given-names>TV</given-names></name><name><surname>Rajaii</surname><given-names>F</given-names></name><name><surname>James-Esposito</surname><given-names>RE</given-names></name><etal/></person-group><article-title>Single-Cell RNA-Seq Analysis of Retinal Development Identifies NFI Factors as Regulating Mitotic Exit and Late-Born Cell Specification</article-title><source>Neuron</source><year>2019</year><volume>102</volume><fpage>1111</fpage><lpage>1126</lpage><elocation-id>e5</elocation-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein-O’Brien</surname><given-names>GL</given-names></name><name><surname>Arora</surname><given-names>R</given-names></name><name><surname>Culhane</surname><given-names>AC</given-names></name><name><surname>Favorov</surname><given-names>AV</given-names></name><name><surname>Garmire</surname><given-names>LX</given-names></name><name><surname>Greene</surname><given-names>CS</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Ngom</surname><given-names>A</given-names></name><name><surname>Ochs</surname><given-names>MF</given-names></name><etal/></person-group><article-title>Enter the Matrix: Factorization Uncovers Knowledge from Omics</article-title><source>Trends Genet</source><year>2018</year><volume>34</volume><fpage>790</fpage><lpage>805</lpage></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korotkevich</surname><given-names>G</given-names></name><name><surname>Sukhov</surname><given-names>V</given-names></name><name><surname>Budin</surname><given-names>N</given-names></name><name><surname>Shpak</surname><given-names>B</given-names></name><name><surname>Artyomov</surname><given-names>MN</given-names></name><name><surname>Sergushichev</surname><given-names>A</given-names></name></person-group><article-title>Fast gene set enrichment analysis</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type="doi">10.1101/060012</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><fpage>174</fpage></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Jia</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>F</given-names></name><name><surname>Ma</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>B</given-names></name><name><surname>Wei</surname><given-names>X</given-names></name><name><surname>Tan</surname><given-names>C</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name></person-group><article-title>Analysis of bypass signaling in EGFR pathway and profiling of bypass genes for predicting response to anticancer EGFR tyrosine kinase inhibitors</article-title><source>Mol Biosyst</source><year>2012</year><volume>8</volume><fpage>2645</fpage><lpage>2656</lpage></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name><name><surname>Pei</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Ouyang</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><article-title>Emerging strategies to overcome resistance to third-generation EGFR inhibitors</article-title><source>J Hematol Oncol</source><year>2022</year><volume>15</volume><fpage>94</fpage></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>Z</given-names></name><name><surname>Han</surname><given-names>L</given-names></name><name><surname>Gong</surname><given-names>Y</given-names></name><name><surname>Xie</surname><given-names>C</given-names></name></person-group><article-title>Mechanisms and management of 3rd□generation EGFR□TKI resistance in advanced non□small cell lung cancer (Review)</article-title><source>Int J Oncol</source><year>2021</year><volume>59</volume><fpage>90</fpage></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Sun</surname><given-names>F</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name></person-group><article-title>Inhibition of Wnt/β-catenin pathway reverses multi-drug resistance and EMT in Oct4+/Nanog+ NSCLC cells</article-title><source>Biomed Pharmacother</source><year>2020</year><volume>127</volume><elocation-id>110225</elocation-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Birger</surname><given-names>C</given-names></name><name><surname>Thorvaldsdottir</surname><given-names>H</given-names></name><name><surname>Ghandi</surname><given-names>M</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name></person-group><article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title><source>Cell Syst</source><year>2015</year><volume>1</volume><fpage>417</fpage><lpage>425</lpage></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macnair</surname><given-names>W</given-names></name><name><surname>Gupta</surname><given-names>R</given-names></name><name><surname>Claassen</surname><given-names>M</given-names></name></person-group><article-title>psupertime: supervised pseudotime analysis for time-series single-cell RNA-seq data</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><fpage>i290</fpage><lpage>i298</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-David</surname><given-names>U</given-names></name><name><surname>Siranosian</surname><given-names>B</given-names></name><name><surname>Ha</surname><given-names>G</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Oren</surname><given-names>Y</given-names></name><name><surname>Hinohara</surname><given-names>K</given-names></name><name><surname>Strathdee</surname><given-names>CA</given-names></name><name><surname>Dempster</surname><given-names>J</given-names></name><name><surname>Lyons</surname><given-names>NJ</given-names></name><name><surname>Burns</surname><given-names>R</given-names></name><etal/></person-group><article-title>Genetic and transcriptional evolution alters cancer cell line drug response</article-title><source>Nature</source><year>2018</year><volume>560</volume><fpage>325</fpage><lpage>330</lpage></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demichelis</surname><given-names>F</given-names></name><name><surname>Greulich</surname><given-names>H</given-names></name><name><surname>Macoska</surname><given-names>JA</given-names></name><name><surname>Beroukhim</surname><given-names>R</given-names></name><name><surname>Sellers</surname><given-names>WR</given-names></name><name><surname>Garraway</surname><given-names>L</given-names></name><name><surname>Rubin</surname><given-names>MA</given-names></name></person-group><article-title>SNP panel identification assay (SPIA): a genetic-based assay for the identification of cell lines</article-title><source>Nucleic Acids Res</source><year>2008</year><volume>36</volume><fpage>2446</fpage><lpage>2456</lpage></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Capes-Davis</surname><given-names>A</given-names></name><name><surname>Theodosopoulos</surname><given-names>G</given-names></name><name><surname>Atkin</surname><given-names>I</given-names></name><name><surname>Drexler</surname><given-names>HG</given-names></name><name><surname>Kohara</surname><given-names>A</given-names></name><name><surname>MacLeod</surname><given-names>RAF</given-names></name><name><surname>Masters</surname><given-names>JR</given-names></name><name><surname>Nakamura</surname><given-names>Y</given-names></name><name><surname>Reid</surname><given-names>YA</given-names></name><name><surname>Reddel</surname><given-names>RR</given-names></name><etal/></person-group><article-title>Check your cultures! A list of cross-contaminated or misidentified cell lines</article-title><source>Int J Cancer</source><year>2010</year><volume>127</volume><fpage>1</fpage><lpage>8</lpage></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>McDavid</surname><given-names>A</given-names></name><name><surname>Yajima</surname><given-names>M</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Gersuk</surname><given-names>V</given-names></name><name><surname>Shalek</surname><given-names>AK</given-names></name><name><surname>Slichter</surname><given-names>CK</given-names></name><name><surname>Miller</surname><given-names>HW</given-names></name><name><surname>McElrath</surname><given-names>MJ</given-names></name><name><surname>Prlic</surname><given-names>M</given-names></name><etal/></person-group><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>278</fpage></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>550</fpage></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>43</volume><fpage>e47</fpage></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Silberstein</surname><given-names>L</given-names></name><name><surname>Scadden</surname><given-names>DT</given-names></name></person-group><article-title>Bayesian approach to single-cell differential expression analysis</article-title><source>Nat Meth</source><year>2014</year><volume>11</volume><fpage>740</fpage><lpage>742</lpage></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van den Berge</surname><given-names>K</given-names></name><name><surname>Perraudeau</surname><given-names>F</given-names></name><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Vert</surname><given-names>J-P</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Clement</surname><given-names>L</given-names></name></person-group><article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><fpage>24</fpage></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>M Deshpande</surname><given-names>T</given-names></name><name><surname>Pandey</surname><given-names>A</given-names></name><name><surname>Shyama</surname><given-names>S</given-names></name></person-group><article-title>Review: Breast cancer and etiology</article-title><source>Trends Med</source><year>2017</year><volume>17</volume><fpage>1</fpage><lpage>7</lpage></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambardella</surname><given-names>G</given-names></name><name><surname>Peluso</surname><given-names>I</given-names></name><name><surname>Montefusco</surname><given-names>S</given-names></name><name><surname>Bansal</surname><given-names>M</given-names></name><name><surname>Medina</surname><given-names>DL</given-names></name><name><surname>Lawrence</surname><given-names>N</given-names></name><name><surname>di Bernardo</surname><given-names>D</given-names></name></person-group><article-title>A reverse-engineering approach to dissect post-translational modulators of transcription factor’s activity from transcriptional data</article-title><source>BMC Bioinformatics</source><year>2015</year><volume>16</volume><fpage>1</fpage><lpage>9</lpage></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Sanguinetti</surname><given-names>G</given-names></name></person-group><article-title>Combining tree-based and dynamical systems for the inference of gene regulatory networks</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><fpage>1614</fpage><lpage>1622</lpage></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name></person-group><article-title>ppcor: An R Package for a Fast Calculation to Semi-partial Correlation Coefficients</article-title><source>Commun Stat Appl Methods</source><year>2015</year><volume>22</volume><fpage>665</fpage><lpage>674</lpage></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Aibar Santos</surname><given-names>S</given-names></name><name><surname>Bravo González-Blas</surname><given-names>C</given-names></name><name><surname>Simm</surname><given-names>J</given-names></name><name><surname>Moreau</surname><given-names>Y</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><article-title>GRNBoost2 and Arboreto: efficient and scalable inference of gene regulatory networks</article-title><source>Bioinformatics</source><year>2019</year><volume>35</volume><fpage>2159</fpage><lpage>2161</lpage></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Specht</surname><given-names>AT</given-names></name><name><surname>Li</surname><given-names>J</given-names></name></person-group><article-title>LEAP: constructing gene co-expression networks for single-cell RNA-sequencing data using pseudotime ordering</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>764</fpage><lpage>766</lpage></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>H</given-names></name><name><surname>Kiryu</surname><given-names>H</given-names></name><name><surname>Furusawa</surname><given-names>C</given-names></name><name><surname>Ko</surname><given-names>MSH</given-names></name><name><surname>Ko</surname><given-names>SBH</given-names></name><name><surname>Gouda</surname><given-names>N</given-names></name><name><surname>Hayashi</surname><given-names>T</given-names></name><name><surname>Nikaido</surname><given-names>I</given-names></name></person-group><article-title>SCODE: an efficient regulatory network inference algorithm from single-cell RNA-Seq during differentiation</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>2314</fpage><lpage>2321</lpage></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>TE</given-names></name><name><surname>Stumpf</surname><given-names>MPH</given-names></name><name><surname>Babtie</surname><given-names>AC</given-names></name></person-group><article-title>Gene Regulatory Network Inference from Single-Cell Data Using Multivariate Information Measures</article-title><source>Cell Syst</source><year>2017</year><volume>5</volume><fpage>251</fpage><lpage>267</lpage><elocation-id>e3</elocation-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papili Gao</surname><given-names>N</given-names></name><name><surname>Ud-Dean</surname><given-names>SMM</given-names></name><name><surname>Gandrillon</surname><given-names>O</given-names></name><name><surname>Gunawan</surname><given-names>R</given-names></name></person-group><article-title>SINCERITIES: inferring gene regulatory networks from time-stamped single cell transcriptional expression profiles</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>258</fpage><lpage>266</lpage></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez-Castillo</surname><given-names>M</given-names></name><name><surname>Blanco</surname><given-names>D</given-names></name><name><surname>Tienda-Luna</surname><given-names>IM</given-names></name><name><surname>Carrion</surname><given-names>MC</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name></person-group><article-title>A Bayesian framework for the inference of gene regulatory networks from time and pseudo-time series data</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>964</fpage><lpage>970</lpage></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woodhouse</surname><given-names>S</given-names></name><name><surname>Piterman</surname><given-names>N</given-names></name><name><surname>Wintersteiger</surname><given-names>CM</given-names></name><name><surname>Göttgens</surname><given-names>B</given-names></name><name><surname>Fisher</surname><given-names>J</given-names></name></person-group><article-title>SCNS: a graphical tool for reconstructing executable regulatory networks from single-cell genomic data</article-title><source>BMC Syst Biol</source><year>2018</year><volume>12</volume><fpage>59</fpage></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Rahimzamani</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Durham</surname><given-names>T</given-names></name><name><surname>McFaline-Figueroa</surname><given-names>JL</given-names></name><name><surname>Saunders</surname><given-names>L</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Kannan</surname><given-names>S</given-names></name></person-group><article-title>Inferring Causal Gene Regulatory Networks from Coupled Single-Cell Expression Dynamics Using Scribe</article-title><source>Cell Syst</source><year>2020</year><volume>10</volume><fpage>265</fpage><lpage>274</lpage><elocation-id>e11</elocation-id></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambardella</surname><given-names>G</given-names></name><name><surname>Moretti</surname><given-names>MNMN</given-names></name><name><surname>De Cegli</surname><given-names>R</given-names></name><name><surname>Cardone</surname><given-names>L</given-names></name><name><surname>Peron</surname><given-names>A</given-names></name><name><surname>Di Bernardo</surname><given-names>D</given-names></name></person-group><article-title>Differential network analysis for the identification of condition-specific pathway activity and regulation</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><fpage>1776</fpage><lpage>1785</lpage></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pratapa</surname><given-names>A</given-names></name><name><surname>Jalihal</surname><given-names>AP</given-names></name><name><surname>Law</surname><given-names>JN</given-names></name><name><surname>Bharadwaj</surname><given-names>A</given-names></name><name><surname>Murali</surname><given-names>TM</given-names></name></person-group><article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title><source>Nat Methods</source><year>2020</year><volume>17</volume><fpage>147</fpage><lpage>154</lpage></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>Y</given-names></name><name><surname>Thieffry</surname><given-names>D</given-names></name><name><surname>Cantini</surname><given-names>L</given-names></name></person-group><article-title>Evaluating the Reproducibility of Single-Cell Gene Regulatory Network Inference Algorithms</article-title><source>Front Genet</source><year>2021</year><volume>12</volume></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Mar</surname><given-names>JC</given-names></name></person-group><article-title>Evaluating methods of inferring gene regulatory networks highlights their lack of performance for single cell gene expression data</article-title><source>BMC Bioinformatics</source><year>2018</year><volume>19</volume><fpage>232</fpage></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aubin-Frankowski</surname><given-names>PC</given-names></name><name><surname>Vert</surname><given-names>JP</given-names></name></person-group><article-title>Gene regulation inference from single-cell RNA-seq data with linear differential equations and velocity inference</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>4774</fpage><lpage>4780</lpage></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Squair</surname><given-names>JW</given-names></name><name><surname>Gautier</surname><given-names>M</given-names></name><name><surname>Kathe</surname><given-names>C</given-names></name><name><surname>Anderson</surname><given-names>MA</given-names></name><name><surname>James</surname><given-names>ND</given-names></name><name><surname>Hutson</surname><given-names>TH</given-names></name><name><surname>Hudelle</surname><given-names>R</given-names></name><name><surname>Qaiser</surname><given-names>T</given-names></name><name><surname>Matson</surname><given-names>KJE</given-names></name><name><surname>Barraud</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Confronting false discoveries in single-cell differential expression</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><elocation-id>5692</elocation-id></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Nelson</surname><given-names>CE</given-names></name><name><surname>Nabavi</surname><given-names>S</given-names></name></person-group><article-title>Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data</article-title><source>BMC Bioinformatics</source><year>2019</year><volume>20</volume><fpage>40</fpage></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>255</fpage><lpage>261</lpage></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osorio</surname><given-names>D</given-names></name><name><surname>McGrail</surname><given-names>DJ</given-names></name><name><surname>Sahni</surname><given-names>N</given-names></name><name><surname>Yi</surname><given-names>SS</given-names></name></person-group><article-title>Drug combination prioritization for cancer treatment using single-cell RNA-seq based transfer learning</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="doi">10.1101/2022.04.06.487357</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Shekhar</surname><given-names>K</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Bialas</surname><given-names>AR</given-names></name><name><surname>Kamitaki</surname><given-names>N</given-names></name><name><surname>Martersteck</surname><given-names>EM</given-names></name><etal/></person-group><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Gonzalez</surname><given-names>JM</given-names></name><name><surname>Tapanari</surname><given-names>E</given-names></name><name><surname>Diekhans</surname><given-names>M</given-names></name><name><surname>Kokocinski</surname><given-names>F</given-names></name><name><surname>Aken</surname><given-names>BL</given-names></name><name><surname>Barrell</surname><given-names>D</given-names></name><name><surname>Zadissa</surname><given-names>A</given-names></name><name><surname>Searle</surname><given-names>S</given-names></name><etal/></person-group><article-title>GENCODE: The reference human genome annotation for The ENCODE Project</article-title><source>Genome Res</source><year>2012</year><volume>22</volume><fpage>1760</fpage><lpage>1774</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Single cell gene set enrichment analysis overview and performances.</title><p>(<bold>A</bold>) GFICF package overview. (<bold>B</bold>) Single cell gene set enrichment analysis pipeline. (<bold>C</bold>) UMAP plot of 5,000 simulated cells grouped in four distinct groups. (<bold>D</bold>) Reconstructed activity of 24 simulated pathways across the 5,000 cells in (C). In the heatmap pathways are along rows while simulated cells along columns. Cells are ordered according to their group of origin. (<bold>E</bold>) Comparison between scGSEA pathway scores and signature scores originally computed by Schiebinger et al. on 251,203 single-cell profiles collected during differentiation stages. First row shows original gene set scores computed by Schiebinger et al. using wot phyton package. Second row shows gene set scores computed with scGSEA tool in the gficf R package. Each column represents a different gene set. Scores were plotted on the original FLE (force-directed layout) coordinates published by Schiebinger et al. (<bold>F</bold>) Spearman Correlation Coefficient (SCC) between scGSEA scores and wot package signature scores across the 251,203 single-cell transcriptional profiles in (E). (<bold>G</bold>) UMAP representation of 1,044 cells subject to eleven days of consecutive erlotinib treatment. Cells are color-coded according to sequenced day (i.e., 0, 1, 2, 4, 9, and 11 days). Single cell transcriptional profiles were normalized with gficf package. (<bold>H</bold>) EMT activity scores against inferred cell pseudo-time using the activity scores of 50 hallmark gene sets downloaded from MSigDB. Cells are color-coded as in (G). (<bold>I-K</bold>) Same as (H) but for wnt, cholesterol and fatty acid pathways respectively.</p></caption><graphic xlink:href="EMS156314-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Single cell mapping accuracy evaluation.</title><p>(<bold>A</bold>) UMAP representation of 35,276 cells from 32 breast cancer cell-lines using as cell subspace NMF. Cells are color-coded according to their cell-line of origin. Single cell transcriptional profiles were normalized with gficf package. (<bold>B</bold>) Same as (A) but using PC as cell sub-space (<bold>C</bold>) Accuracy evaluation of mapping method using cross-validation approach using as cell sub-space either NMF (orange) or PCA (green). Each boxplot display accuracy distribution in classifying the 32 cell lines but using as a training set the percentage of cells indicated on the x-axis. Accuracy is defined as the number of correctly classified cells over the total number of mapped cells. (<bold>D</bold>) Left plot; mapping of the MDAMB468 and CAL51 cells after they were re-sequenced with drop-SEQ technology. Right plot; accuracy of the mapping method in classifying re-sequenced MDAMB468 and CAL51 cells. NMF cell subspace is used. (<bold>E</bold>) Same as (<bold>D</bold>) but using PC sub-space. (<bold>F</bold>) Accuracy evaluation of the mapping method on 14,372 single cell transcriptomes sequenced with 10x Chromium method for MCF7 parental (P) cell line and three derived subclones (C1,C2,C3) using as cell sub-space either NMF (left) or PCA (right). (<bold>G</bold>) Performance of the mapping method in classifying 2,311 single cell transcriptomes sequenced using the 10x Chromium method from eleven distinct breast cell lines cell. Performances are reported in terms ROC curve and AUC is also displayed. (<bold>H</bold>) Same as (G) but using PC cell sub-space.</p></caption><graphic xlink:href="EMS156314-f002"/></fig></floats-group></article>