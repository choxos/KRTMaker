<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157636</article-id><article-id pub-id-type="doi">10.1101/2022.11.22.517599</article-id><article-id pub-id-type="archive">PPR575326</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Rapid Real-time Squiggle Classification for Read Until Using RawMap</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Sadasivan</surname><given-names>Harisankar</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Wadden</surname><given-names>Jack</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Goliya</surname><given-names>Kush</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ranjan</surname><given-names>Piyush</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Dickson</surname><given-names>Robert P.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Blaauw</surname><given-names>David</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Das</surname><given-names>Reetuparna</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Narayanasamy</surname><given-names>Satish</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, 48109, USA</aff><aff id="A2"><label>2</label>Department of Internal Medicine, University of Michigan Medical School, Ann Arbor, 48109, USA</aff><author-notes><corresp id="CR1">
<label>*</label>Correspondence: <email>hariss@umich.edu</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>26</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>24</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">ReadUntil enables Oxford Nanopore Technology’s (ONT) sequencers to selectively sequence reads of target species in real-time. This enables efficient microbial enrichment for applications such as microbial abundance estimation and is particularly beneficial for metagenomic samples with a very high fraction of non-target reads (&gt; 99% can be human reads). However, read-until requires a fast and accurate software filter that analyzes a short prefix of a read and determines if it belongs to a microbe of interest (target) or not. The baseline Read Until pipeline uses a deep neural network-based basecaller called Guppy and is slow and inaccurate for this task (∼60% of bases sequenced are unclassified).</p><p id="P2">We present RawMap, an efficient CPU-only microbial species-agnostic Read Until classifier for filtering non-target human reads in the squiggle space. RawMap uses a Support Vector Machine (SVM), which is trained to distinguish human from microbe using non-linear and non-stationary characteristics of ONT’s squiggle output (continuous electrical signals). Compared to the baseline Read Until pipeline, RawMap is a 1327X faster classifier and significantly improves the sequencing time and cost, and compute time savings. We show that RawMap augmented pipelines reduce sequencing time and cost by ∼24% and computing cost by ∼22%. Additionally, since RawMap is agnostic to microbial species, it can also classify microbial species it is not trained on.</p><p id="P3">We also discuss how RawMap may be used as an alternative to the RT-PCR test for viral load quantification of SARS-CoV-2.</p></abstract><kwd-group><kwd>Read Until</kwd><kwd>Selective sequencing</kwd><kwd>Abundance estimation</kwd><kwd>Viral load</kwd><kwd>Metagenomics</kwd><kwd>Nanopore</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P4">Novel infections and pandemics are on the rise (<xref ref-type="bibr" rid="R25">Marani <italic>et al</italic>., 2021</xref>). In the context of the COVID-19 pandemic, changes to the human microbiome are increasingly understood as a biomarker (<xref ref-type="bibr" rid="R16">Kalantar-Zadeh <italic>et al</italic>., 2020</xref>; <xref ref-type="bibr" rid="R36">Villapol, 2020</xref>; <xref ref-type="bibr" rid="R44">Zuo <italic>et al</italic>., 2020</xref>) which can help in patient risk stratification and mitigate disease severity (<xref ref-type="bibr" rid="R38">Ward <italic>et al</italic>., 2021</xref>). Understanding the human microbiome can also provide additional benefits such as providing prophylactic and therapeutic tools to improve human health (<xref ref-type="bibr" rid="R3">Cho and Blaser, 2012</xref>) and thereby, increasing colonization resistance against infections (<xref ref-type="bibr" rid="R2">Buffie <italic>et al</italic>., 2015</xref>). Along with microbiome identification and quantification, viral load is another metric linked to COVID-19 disease severity and mortality and helps in risk stratification (<xref ref-type="bibr" rid="R9">Fajnzylber <italic>et al</italic>., 2020</xref>).</p><p id="P5">As a means to estimate the microbiome, DNA sequencing has immense potential to transform personalized healthcare through the early discovery and detection of diseases. Metagenomic abundance estimation (relative quantification of taxa) from long DNA reads is a less explored domain as we learn in <xref ref-type="sec" rid="S3">Section 2</xref>. Moreover, <bold>efficient enrichment and sequencing of microbial DNA from non-target rich metagenomic samples with unknown microbial constituents is an unsolved problem</bold>.</p><p id="P6">Oxford Nanopore Technology’s (ONT’s) portable long-read DNA sequencer, MinION, has a minimal operational and logistical footprint, and real-time capabilities, making it a unique candidate for this purpose (<xref ref-type="bibr" rid="R8">Edwards <italic>et al</italic>., 2019</xref>). Assays of SARS-CoV-2, Ebola, Zika, tuberculosis, and various other pathogens have been successfully conducted using MinION (<xref ref-type="bibr" rid="R37">Wang <italic>et al</italic>., 2020</xref>). Nanopore sequencers monitor the electrical signal fluctuations from a strand passing through a nanopore channel and decode the specific DNA/RNA sequence. Sequencing costs us both time and money. Flowcell washes and longer sequencing times degrade the quality of a flowcell over time. Replacing degraded flowcells and wet-lab reagents adds to sequencing cost. In order to reduce the sequencing and compute footprint, it is essential to ensure only target microbial reads are completely sequenced and non-target human reads are ejected. Finally, we show that the time saved in nanopore sequencing is cost saved in <xref ref-type="sec" rid="S26">Section 6.8</xref>.</p><p id="P7">Human samples can have a significant fraction of non-target reads – greater than 99% of total reads are non-target human reads in most clinical respiratory samples (<xref ref-type="bibr" rid="R42">Yang <italic>et al</italic>., 2019</xref>). Sequencing these non-target reads would otherwise be a waste of sequencing time and cost. Moreover, it is important to not miss target reads in order to accurately characterize the microbiome. Undetected target reads especially from a low-abundant species can offset the relative abundance. Hence, prior works choose to sequence all of the unclassified reads (Payne <italic>et al</italic>., 2020). We follow the same practice.</p><p id="P8">Selective Sequencing or Read Until (<xref ref-type="bibr" rid="R8">Edwards <italic>et al</italic>., 2019</xref>) is a digital enrichment protocol for molecule-by-molecule real-time sequencing of only the target reads in ONT sequencers. As a DNA fragment moves through a MinION nanopore, fluctuations in the pore’s electric current are decoded in real-time to provide active feedback to the pore. Target fragments of interest are sequenced, while fragments deemed non-target are ejected by reversing the pore bias voltage. Read Until saves sequencing time and cost, apart from compute time savings.</p><p id="P9">The state-of-the-art (baseline) Read Until pipeline, Readfish (<xref ref-type="bibr" rid="R29">Payne <italic>et al</italic>., 2020</xref>), sequences unclassified reads and iteratively updates the alignment index for read Until target classification. For microbiome abundance estimation, Readfish uses a software pipeline consisting of a basecaller (Guppy (<xref ref-type="bibr" rid="R39">Wick <italic>et al</italic>., 2019</xref>) is a deep neural network that decodes raw squiggle output from the sequencer to bases), an aligner (Minimap2 (<xref ref-type="bibr" rid="R22">Li, 2018</xref>) maps DNA read to the target genome using approximate string matching), and a metagenome classifier (Centrifuge (<xref ref-type="bibr" rid="R17">Kim <italic>et al</italic>., 2016</xref>) classifies the read into a taxonomic rank). However, Readfish has a two-fold performance problem – low throughput and accuracy (on small signal chunks) of the basecaller. Prior works have shown that real-time basecalling using deep neural networks cannot keep up with the throughput of the sequencer and this problem is amplified by the projected growth in future sequencing throughput (<xref ref-type="bibr" rid="R6">Dunn <italic>et al</italic>., 2021</xref>). Additionally, prior works have reported the inaccuracy of Guppy in basecalling small signal chunks (<xref ref-type="bibr" rid="R19">Kovaka <italic>et al</italic>., 2020</xref>; <xref ref-type="bibr" rid="R43">Zhang <italic>et al</italic>., 2021</xref>). We observe that this translates to 59.5% of the sequenced bases being unclassified (as shown in <xref ref-type="fig" rid="F2">Figure 2</xref>) in a 99:1 host: target sample with an average read length of 8.29 Kbases. We analyze and observe that these unclassified bases are basecalled with low Phred quality scores as shown in <xref ref-type="fig" rid="F1">Figure 1</xref> and hence, aligners like Minimap2 and BLAST are unable to align them.</p><p id="P10">We envision a portable, fast, and inexpensive diagnostic solution for the digital enrichment of the human microbiome and downstream applications including microbiome abundance estimation and viral load quantification. Our fast and accurate diagnostic solution can decentralize sequencing and democratize personalized healthcare. We propose an efficient CPU-only software solution to classify these low-quality read prefixes using RawMap, a squiggle space Read Until classifier. Our feature engineering enables RawMap to identify non-linear and non-stationary characteristics of a raw read prefix and distinguish the host from the target in a simple 3-D feature space with very low computational overhead. RawMap is also capable of identifying previously undetected microbial species and is offered as a “plug-and-play” solution without disrupting the baseline Read Until pipeline. Our proposed RawMap augmented pipeline 1 saves ∼24% sequencing time and cost whereas pipeline 2 saves ∼22% compute time. Our evaluations are performed with respect to a baseline Read Until pipeline on a 99:1 host: target sample with an average read length of 8.29 Kbases.</p><p id="P11">Additionally, we demonstrate how RawMap may be utilized to skip the expensive basecalling step and perform viral load quantification in a sample mix of human and SARS-CoV-2. In some settings, viral load is linked to disease severity and mortality and helps in risk stratification (<xref ref-type="bibr" rid="R9">Fajnzylber <italic>et al</italic>., 2020</xref>). Colorimetry-based Reverse Transcription-Polymerase Chain Reaction (RT-PCR) test is the most commonly used method for viral load quantification (<xref ref-type="bibr" rid="R14">Jacot <italic>et al</italic>., 2020</xref>). However, RT-PCR-based tests often have complex primer design, manufacture, and distribution steps (<xref ref-type="bibr" rid="R6">Dunn <italic>et al</italic>., 2021</xref>) and may have a significant number of false positives from various sources of contamination if the assay is not well-validated (<xref ref-type="bibr" rid="R4">Cohen and Kessel, 2020</xref>; <xref ref-type="bibr" rid="R34">Surkova <italic>et al</italic>., 2020</xref>). In the end, we present a case of using RawMap to skip the expensive basecalling step for sequencing-based viral load quantification.</p></sec><sec id="S2"><label>2</label><title>Related Work</title><p id="P12">Metagenomic data analysis and abundance estimation are well-studied for short reads (<xref ref-type="bibr" rid="R40">Wood and Salzberg, 2014</xref>; <xref ref-type="bibr" rid="R41">Wood <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="R24">Lu <italic>et al</italic>., 2017</xref>; <xref ref-type="bibr" rid="R13">Huson <italic>et al</italic>., 2007</xref>; <xref ref-type="bibr" rid="R31">Schaeffer <italic>et al</italic>., 2017</xref>; <xref ref-type="bibr" rid="R35">Truong <italic>et al</italic>., 2015</xref>) but that is not the case for long reads. MetaMaps (<xref ref-type="bibr" rid="R5">Dilthey <italic>et al</italic>., 2019</xref>) is a long-read abundance estimator it is resource hungry. Centrifuge (<xref ref-type="bibr" rid="R17">Kim <italic>et al</italic>., 2016</xref>) is resource efficient and works for both short and long reads. But, we observe that using Centrifuge alone does not produce sufficiently accurate results as discussed in <xref ref-type="sec" rid="S13">Section 5.1</xref>.</p><p id="P13">Read Until is an emerging domain of research. The first attempt at Read Until sequencing used a signal space technique called subsequence Dynamic Time Warping where a raw nanopore query signal is aligned to an in silico signal representation of a reference sequence (<xref ref-type="bibr" rid="R23">Loose <italic>et al</italic>., 2016</xref>). However, this method is not scalable to reference sequences larger than tens of kilobases as the runtime is quadratic in the reference length. SquiggleFilter (<xref ref-type="bibr" rid="R6">Dunn <italic>et al</italic>., 2021</xref>) (ASIC) and HARU (<xref ref-type="bibr" rid="R32">Shih <italic>et al</italic>., 2022</xref>) (FPGA) are hardware-accelerated Read Until solutions but their performance is optimal only for a small reference target (order of Kilobases) as they are constrained by the hardware’s small buffer size and hence, are not suited for abundance estimation of multiple target microbial references (typically millions of bases).</p><p id="P14">Readfish, the most widely adopted ReadUntil pipeline today (<xref ref-type="bibr" rid="R29">Payne <italic>et al</italic>., 2020</xref>), uses a basecaller followed by an aligner, Minimap2 to make a decision on a small chunk of data in the basecalled space. However, this method fails to bring out optimum savings as we find that a very high fraction of sequenced bases are from non-target reads as they get basecalled with low-quality scores and are hence, unintentionally sequenced. Additionally, the basecaller Guppy cannot meet the increasing throughput of the sequencer (<xref ref-type="bibr" rid="R6">Dunn <italic>et al</italic>., 2021</xref>).</p><p id="P15">UNCALLED (<xref ref-type="bibr" rid="R19">Kovaka <italic>et al</italic>., 2020</xref>) uses a probabilistic k-mer approximation from the signal space followed by alignment using BWA-MEM to identify target reads and perform metagenomic classification. However, we do not compare directly with UNCALLED because of two reasons. UNCALLED needs to know the constituents of the sample apriori to form the reference index for classification. This is not possible in situations where the target microbiome/infectious agent is unknown. UNCALLED cannot use a non-target (human genome in this case) reference because UNCALLED is shown to not scale to references above 100Mb and performs poorly on highly repetitive references. Secondly, UNCALLED’s k-mer approximation is directly dependent on a k-mer reference current model which is retired by ONT for all newer and future nanopore chemistries. Sigmap (<xref ref-type="bibr" rid="R43">Zhang <italic>et al</italic>., 2021</xref>) is another Read Until classifier in the signal space that detects events and does Minimap2-style (<xref ref-type="bibr" rid="R22">Li, 2018</xref>) chaining to attempt to map the read to a target. However, Sigmap also needs to know the constituents of the input sample apriori and creates an index which is ∼20 X the index size of UNCALLED for a single target.</p><p id="P16">SquiggleNet (<xref ref-type="bibr" rid="R1">Bao <italic>et al</italic>., 2021</xref>) is the only prior work that can classify long-reads of unseen microbial species. SquiggleNet uses a deep learning model. However, SquiggleNet is shown to be only as accurate as Guppy followed by Minimap2, and is slower (<xref ref-type="bibr" rid="R1">Bao <italic>et al</italic>., 2021</xref>). This does not solve our problem of accuracy and throughput.</p><p id="P17">The viral load has commonly been estimated from time-consuming wet-lab enriched tests (<xref ref-type="bibr" rid="R9">Fajnzylber <italic>et al</italic>., 2020</xref>; <xref ref-type="bibr" rid="R28">Pan <italic>et al</italic>., 2020</xref>). Recent efforts have focussed on direct sequencing from high throughput short read sequencers (<xref ref-type="bibr" rid="R12">Huang <italic>et al</italic>., 2019</xref>). However, there exists no prior work discussing viral load quantification from direct nanopore long-read sequencing, to the best of our knowledge.</p><p id="P18">Although the trends in pore occupancy with Read Until have been previously studied (<xref ref-type="bibr" rid="R29">Payne <italic>et al</italic>., 2020</xref>; <xref ref-type="bibr" rid="R19">Kovaka <italic>et al</italic>., 2020</xref>), Read Until resulting in reduced sequencing cost has not been quantitatively discussed before.</p></sec><sec id="S3"><label>3</label><title>Background and Motivation</title><sec id="S4"><label>3.1</label><title>Microbiome Abundance Estimation</title><p id="P19">Human lung microbiome is the aggregate of all microbiota that reside on or within lung tissue and biofluids. Characterizing the abundance of the human microbiome helps researchers to understand the health status of the human lung (<xref ref-type="bibr" rid="R33">Sommariva <italic>et al</italic>., 2020</xref>). Lung microbiota composition can be a biomarker of existing health conditions. Hence, the accuracy of microbiome abundance estimation is important. Species abundance as defined by Centrifuge (<xref ref-type="bibr" rid="R17">Kim <italic>et al</italic>., 2016</xref>) does not incorporate the variability of nanopore read lengths and ploidy (number of sets of chromosomes in a cell) of species. To fix this, we define cell number microbiome abundance of species j, <italic>A</italic><sub><italic>j</italic></sub> as follows: <disp-formula id="FD1"><mml:math id="M1"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:math></disp-formula> where <italic>B</italic><sub><italic>k</italic></sub> is the total number of bases that correspond to species k, <italic>l</italic><sub><italic>k</italic></sub> is the genomic reference length of species k, <italic>p</italic><sub><italic>k</italic></sub> is the ploidy of species k and S is the total number of species discovered, excluding the host.</p><p id="P20">For evaluation, in our case where the ground-truth abundance is known, the error in estimated abundance is quantified using two metrics: mean deviation and maximum deviation. <disp-formula id="FD2"><mml:math id="M2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:munderover><mml:mrow><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.3em"/><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>∀</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mi>S</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>e</italic><sub><italic>k</italic></sub> is the estimated abundance and <italic>g</italic><sub><italic>k</italic></sub> is the groundtruth abundance of species k.</p><p id="P21">As discussed, we do not need to sequence the human DNA to calculate microbiome abundance. It has been discovered that non-target human reads in most clinical respiratory samples can be greater than 99% (<xref ref-type="bibr" rid="R42">Yang <italic>et al</italic>., 2019</xref>). Hence, it would be ideal to discard the non-target reads and sequence the target microbial reads alone if it would help save sequencing time and cost.</p></sec><sec id="S5"><label>3.2</label><title>Nanopore Sequencing</title><p id="P22">Nanopore sequencing is a novel technology that enables direct, real-time analysis of long DNA or RNA fragments. As nucleic acids pass through a protein nanopore, electric current fluctuations are monitored and decoded to provide the specific DNA or RNA sequence. Long reads are better than short reads for whole genome assembly as they can span long repetitive regions and structural variations. In 2014, Oxford Nanopore Technologies (ONT) introduced the world’s first nanopore sequencer, the MinION - a portable, real-time, long-read, low-cost device weighing just 87g. MinION is used in a wide range of applications including single-cell sequencing, structural variant calling, gene expression analysis, assembly, detection of base modifications, and metagenomics. The assay of Ebola, Zika, tuberculosis, and various other pathogens has been successfully conducted using the MinION in the past (<xref ref-type="bibr" rid="R37">Wang <italic>et al</italic>., 2020</xref>). More recently, MinION has also been used by researchers worldwide to share sequenced SARS-CoV-2 data (<xref ref-type="bibr" rid="R26">Moore <italic>et al</italic>., 2020</xref>).</p></sec><sec id="S6"><label>3.3</label><title>Cost of nanopore sequencing</title><p id="P23">There are two components to the cost involved-sequencing and compute. The cost of sequencing includes flowcell cost and reagent cost. A MinION flowcell costs $475 and can sequence up to 50 Gigabases(Gb) on average during its lifetime. We estimate a fixed reagent cost of ∼$21 (with QIGEN’s QIAamp DNA Mini Kit for extraction, ONT’s SQK-RAD004 for library prep, and SQK-RBK004 for a 12-way barcoded run) per experiment, and a variable flowcell cost of ∼$6 per every hour of sequencing (based on estimated flowcell throughput of 0.59Gb/hr). Reduced time to answer means the flowcell may be used for other applications within its lifetime. ONT has defined a protocol for real-time selective sequencing, which we leverage to save pore-use time during a single run. Reduced pore-use time can lower flowcell costs incurred from a single run. We show that sequencing time saved is flowcell cost saved in <xref ref-type="sec" rid="S18">Section 6</xref>. For the sake of simplicity, we will refer to the variable flowcell-related cost as sequencing cost. Further, compute-related costs can stem from the costs of using cloud or shared computing resources.</p></sec><sec id="S7"><label>3.4</label><title>Read Until</title><p id="P24">Traditionally, selecting regions of interest from a sample involved significant time-consuming manipulations of DNA prior to sequencing: PCR, Cas-mediated enrichment, or hybridization capture (<xref ref-type="bibr" rid="R15">Kai <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="R7">Eckert <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="R10">Gilpatrick <italic>et al</italic>., 2020</xref>). ONT MinION is the first to implement a protocol for molecule-by-molecule real-time selective sequencing or Read Until (<xref ref-type="bibr" rid="R23">Loose <italic>et al</italic>., 2016</xref>). As a DNA fragment moves through the nanopore, the fluctuations in the pore electric current are decoded in real-time to provide active feedback to the pore. Fragments of interest are sequenced by default, while fragments deemed non-target are ejected by reversing the pore’s bias voltage. In cases like human lung microbiome abundance estimation, where there is very high contamination (host: microbe ratio of 99: 1), digital enrichment provides a simpler workflow and negates any need to deplete the host during sample preparation.</p><p id="P25">Previously, it has been shown that pores performing Read Until are only clogged temporarily (<xref ref-type="bibr" rid="R19">Kovaka <italic>et al</italic>., 2020</xref>). We extend this observation to show that sequencing time saved is cost saved in <xref ref-type="sec" rid="S18">Section 6</xref>.</p></sec><sec id="S8"><label>3.5</label><title>Read Until Pipeline</title><p id="P26">Our baseline, a two-stage pipeline for microbiome abundance estimation is derived from Readfish (<xref ref-type="bibr" rid="R29">Payne <italic>et al</italic>., 2020</xref>) but with minor modifications. Guppy is used for basecalling the squiggles. We customize Minimap2 for better accuracy as discussed in <xref ref-type="sec" rid="S12">Section 5</xref>. Centrifuge, a metagenomic classifier with a microbial and human index constructed from NCBI non-redundant nucleotide database operates on full-length basecalled reads. Centrifuge does the species-level classification and identifies those taxonomy IDs which get more than 0.005% reads assigned. Reference genomes corresponding to those species’ identified by Centrifuge are downloaded in real-time from the online RefSeq database to keep our memory footprint small. Subsequent read prefixes are mapped by Minimap2 on an expanding set of references generated from Centrifuge operating on full-length reads. If Minimap2 detects a non-target, the read is reversed. All unclassified reads from Minimap2 are sequenced so that Centrifuge can iteratively build the ‘refined index’ - an alignment index for Minimap2 constructed on-the-fly from a small set of target species detected by Centrifuge. In summary, Centrifuge, a low memory footprint, less accurate classifier is used to build a ‘refined index’ for the highly accurate mapper, Minimap2 to make Read Until decisions.</p></sec><sec id="S9"><label>3.6</label><title>Inefficiency of the baseline pipeline</title><p id="P27">The baseline Read Until pipeline cannot classify and detect 59.5% bases sequenced because they are basecalled with lower Phred quality scores as shown in <xref ref-type="fig" rid="F1">Fig. 1</xref> for a 99: 1 host: target sample with an average read length of 8.29Kb. Further, it is observed that low-quality reads translocate slowly at a median rate of 270 bases/s. We cannot eject the unclassified reads because Centrifuge needs them for building the refined index. The percentage of unclassified non-target bases (99% of 59.5%) sequenced is an even bigger problem for long reads as shown in <xref ref-type="fig" rid="F2">Fig. 2</xref>. Reducing these unclassified non-target bases would help reduce irrelevant data footprint, and improve time and cost savings. We realize that classification is a simpler and different task from basecalling. We engineer features from the squiggle space and classify the unmapped read prefixes.</p><p id="P28">With RawMap, we propose an efficient CPU-only solution to identify non-target reads missed by Guppy. RawMap does not alter the standard Read Until pipeline much, it is a “plug-and-play” solution which grabs information from the squiggle domain to classify a read prefix using a very efficient algorithm in a 3-D feature space. RawMap learns from the non-linear non-stationery characteristics of squiggles to identify microbes from host. Additionally, RawMap is microbial species-agnostic – it can classify microbial species it is not trained on.</p></sec></sec><sec id="S10"><label>4</label><title>Design</title><p id="P29">Our Read Until pipeline for abundance estimation is a modified version of the metagenomic enrichment pipeline (Payne <italic>et al</italic>., 2020) which uses Guppy for basecalling, Minimap2 for Read Until decisions, and Centrifuge for generating ‘refined index’, a set of species detected in the sample. Minimap2 classifies using the refined index of detected organisms’ genomes and instructs MinION to eject host reads. Centrifuge classifies Minimap2’s unclassified reads and detects organisms absent in the refined index. Additionally, we use Minimap2’s results on the read-prefixes for accurate abundance estimation (we can see that Minimap2 produces consistent accurate mappings above 450 bases in <xref ref-type="fig" rid="F6">Fig. 6</xref>).</p><p id="P30">However, there exists a problem of unclassified reads with Minimap2 because Guppy basecalled these reads poorly as indicated by their poor base quality scores in <xref ref-type="fig" rid="F1">Fig. 1</xref>. Basecalling is the complex process of translating raw nanopore signal to a base sequence and Guppy’s network is designed for this particular task. Classification is, however, a much simpler problem and utilizes global signal-level information which Guppy may not be focusing on. Therefore, we explore the raw nanopore data space for additional signal characteristics and engineer features out of it for the task of read classification.</p><p id="P31">Nanopore squiggles (raw data) are also very similar to EEG as they both are non-linear and non-stationary. Prior works have used Hjorth parameters to extract the time domain properties of non-stationary signals like brain EEG (<xref ref-type="bibr" rid="R11">Hjorth, 1970</xref>). It is known in the past that genomic sequences can be transformed into a phase signal representation to extract Hjorth parameters in order to classify metagenomic data (<xref ref-type="bibr" rid="R20">Kupková, 2014</xref>; <xref ref-type="bibr" rid="R21">Kupkova <italic>et al</italic>., 2017</xref>). This is based on the idea that the characteristic changes in the phase signal can identify one species from another. We extend this idea by modifying the Hjorth parameters to work on noisy squiggle space for Read Until to find characteristic current transitions in the read prefix to distinguish microbes from host.</p><sec id="S11"><label>4.1</label><title>RawMap augmented Read Until pipelines</title><p id="P32">We present RawMap, a direct squiggle-space microbial species-agnostic Read Until classifier for identifying target microbial reads. RawMap is a “plug-and-play” solution which may be plugged into the baseline Read Until pipeline as shown in <xref ref-type="fig" rid="F3">Fig. 3</xref>. In the proposed pipeline 1 with Read Until, RawMap is combined with Minimap2 for rapid microbiome abundance estimation. Here, Minimap2 acts as the primary classifier for target versus non-target while RawMap acts as a secondary classifier which identifies the non-target read-prefixes Minimap2 could not and instructs the MinION to eject them. We also demonstrate a very efficient solution with pipeline 2 in <xref ref-type="fig" rid="F4">Fig. 4</xref> where RawMap acts as a fast primary classifier that tries to reduce the workload for the compute-intensive Guppy. Guppy and Minimap2 are acting only on reads that RawMap classifies as target and lets through. There is also a secondary instance of RawMap fine-tuned to classify reads unclassified by Minimap2. We compare the benefits of each of these pipelines in <xref ref-type="sec" rid="S18">Section 6</xref>.</p><p id="P33">RawMap’s algorithm has three main components: signal pre-processing, feature extraction, and Support Vector Machine (SVM) based classification. Signal pre-processing normalizes the noisy nanopore signal, feature extraction calculates the modified Hjorth parameters and the SVM classifier does the target vs. host classification.</p></sec></sec><sec id="S12" sec-type="materials | methods"><label>5</label><title>Materials and Methods</title><sec id="S13"><label>5.1</label><title>Read Until baseline for abundance estimation</title><p id="P34">Similar to the recent work on adaptive sampling for metagenomic enrichment (<xref ref-type="bibr" rid="R29">Payne <italic>et al</italic>., 2020</xref>), we have a Read Until pipeline with Guppy for basecalling, Centrifuge for iteratively building the ‘refined index’ which consists of species detected and Minimap2 trying to map every read-prefix to this ‘refined index’. Unmapped reads are sequenced in full for Centrifuge to build the ‘refined index’. However, our baseline pipeline does not use Centrifuge for abundance estimation but has an additional final stage to do this because we find that a customized version of Minimap2 is better at abundance estimation than Centrifuge as shown in <xref ref-type="fig" rid="F5">Fig. 5</xref>. It is observed that the minimizer-based seeding in Minimap2 helps only with the speed of alignment and turning it off can improve the number of reads mapped without affecting the accuracy of mapping as in <xref ref-type="fig" rid="F6">Fig. 6</xref>. We turn off the minimizer-based seeding in Minimap2 by using the command line parameters ‘-w 1 -k 15’ during the construction of the ‘refined index’. This is referred to as customized Minimap2 or minimap2_custom.</p><p id="P35">In the last stage of the pipeline, we take batches of 1000 microbial read classifications from Minimap2 to calculate the cell number abundance. We sequence until the ‘refined index’ does not change and the estimated microbiome abundance does not deviate more than 5% on an average from the previous estimation for two successive iterations. For our experiments with Zymo microbial community standard, it is observed that we need to sequence until approximately 8000 target Zymo High Molecular Weight (HMW) reads (∼1X Zymo HMW coverage). For our evaluations, we stop pipelines 1 and 2 as soon as 8000 target Zymo reads were sequenced and identified.</p></sec><sec id="S14"><label>5.2</label><title>Implementing RawMap</title><p id="P36">We trim the first 2000 raw data samples to eliminate adapter stalls and non-informative adapter-barcode regions and then process the next 450 bases equivalent (∼6667 samples) of raw data. The median and Median Absolute Deviation (MAD) of this raw data are then calculated. Outliers are filtered out as follows: only raw data within a range of 5 MAD deviations from the median are considered for further processing. The filtered channel-scaled current values are then Median-Median Absolute Deviation (MED-MAD) normalized by the signal pre-processor. This squiggle segment y corresponding to 450 bases of a read is then mapped to a 3-D feature space using a modified version of Hjorth parameters by the feature extractor. It is observed that MED and median are robust to the outliers and hence, yield cleaner nanopore signals. The Hjorth parameters are modified by calculating the variance from MED and MAD instead of the originally used mean and standard deviation. We define modified Hjorth parameters as follows: <disp-formula id="FD3"><mml:math id="M3"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where y is the normalized raw data segment corresponding to 450 bases, y’ is the first-order difference of the signal and var is the modified variance.</p><p id="P37">Activity captures the signal power, mobility is the mean frequency and complexity is the change in frequency. The modified Hjorth parameters help us find a localized region where the microbial signals map to, as shown in <xref ref-type="fig" rid="F7">Fig. 7</xref>.</p><p id="P38">RawMap uses a Support Vector Machine (SVM) with a Radial Basis Function kernel. For pipeline 1, the SVM is trained on 6000 squiggles each of human and Zymo from a 50:50 barcoded run with 10-fold cross-validation to capture the non-linear and non-stationary characteristics of the nanopore squiggles. For RawMap to be tuned as a primary classifier for pipeline 2, 100K squiggles of each Zymo and human were used to capture the high variation in current characteristics. AUC was used as a scoring metric for model validation instead of accuracy and hyper-parameters were tuned using grid search.</p></sec><sec id="S15"><label>5.3</label><title>Configurations</title><p id="P39">For our Read Until baseline, we use the ONT recommended version of Minimap2, v2.17 for ONT long reads and we turn minimizers off for better classification accuracy. Guppy v4.0.11 in high-accuracy mode is used for basecalling and is invoked using ONT’s pyguppyclient server for Read Until. Centrifuge v1.0.4 with a human and microbial nucleotide (NT) index is used as explained under <xref ref-type="sec" rid="S9">Section 3.5</xref>. We further add the capability to calculate cell number abundance to Minimap2. RawMap is evaluated using a single-threaded execution on an Intel Xeon E5-2697 x86 processor. Guppy runs on NVIDIA GeForce GTX-1080.</p></sec><sec id="S16"><label>5.4</label><title>Wet-lab</title><p id="P40">All sequencing libraries were prepared using ONT’s Rapid Sequencing Kit (SQK-RAD004). We conduct two types of experiments: barcoded and unbarcoded. In our barcoded experiments, ONT’s Rapid Barcoding Kit (SQK-RBK004) is used for barcoding quantified host and target separately for ground truth abundance generation. The barcoded experiments are run with extracted human DNA from Coriell’s NA12878 and ZymoBIOMICS High Molecular Weight DNA Mock Microbial community (‘Zymo HMW’, cat #D6322). The non-barcoded experiment is run with HeLa human extracted genomic DNA (New England BioLabs, cat# N4006) and ZymoBiomics Microbial Community DNA Standard (‘Zymo’, cat# D6306).</p><p id="P41">Finally, we conduct an experiment to understand how Read Until damages the flowcell. For this, we divided a new high-quality flowcell into two equal sequencing regions: half the active pores sequencing full-length reads and the remaining half rejecting every read at 450bp. The pore status (control vs Read Until) is chosen in a checkerboard fashion and is fixed. The number of active pores is normalized to the number we started with for both sets. After 6.5 hours of sequencing, the flowcell is then washed and MUX-ed to the same set of sequencing pores as before. Comparing the percentage of active pores that recovered in both regions would tell us the damage caused by Read Until.</p><p id="P42">Additionally, the wet-lab protocol suggested for viral load quantification is ONT’s proposed Sequence Independent Single Primer Amplification (SISPA) pipeline (<xref ref-type="bibr" rid="R27">ONT, 2020</xref>) for metagenomic sequencing. Here, full-genome amplified RNA is reverse-transcribed and sequenced as cDNA. This protocol is independent of the viral species present and hence, universal.</p></sec><sec id="S17"><label>5.5</label><title>Definitions &amp; datasets</title><p id="P43">“Premix” refers to biologically mixing the prepared libraries of NA12878 and Zymo HMW prior to sequencing. “Premix”-ed sequencing runs have unique barcodes for Zymo HMW and HeLa. “Post-mix” refers to datasets sequenced independently from HeLa and Zymo and mixed digitally. “Zymo HMW-subset” is created by using only four out of eight different Zymo HMW species for training and the remaining four for testing.</p><p id="P44">We have 4 pre-mixed datasets (50:50: for training, 99:1:Run 1, 99:1: Run 2, and 99:1: Run 3). The zymo-HMW subset is from Run 1. We also have 2 post-mixed datasets (50:50: for training, and 99:1: for testing). We have 200K-1.4M reads in each of the datasets. Training and testing are always performed on different datasets, training on 50:50 and testing on 99:1.</p><p id="P45">Zymo and Hela datasets sequenced in our lab are available at DOI:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7349378">https://doi.org/10.5281/zenodo.7349378</ext-link>. The viral load quantification study is performed on 7K SARS-CoV-2 (<xref ref-type="bibr" rid="R30">R. Faria, 2020</xref>) and 105K human cDNA reads (Kim <italic>et al</italic>., 2020) which are already publicly available.</p></sec></sec><sec id="S18" sec-type="results"><label>6</label><title>Results</title><sec id="S19"><label>6.1</label><title>Read Until Benefits</title><p id="P46">The two proposed pipelines offer savings in terms of sequencing and compute time with respect to baseline Read Until pipeline. In <xref ref-type="sec" rid="S26">Section 6.8</xref>, we show that sequencing time saved directly translates to sequencing cost saved. Our proposed pipeline 1 yields the best sequencing time and cost savings with respect to baseline Read Until pipeline (∼24% of savings) as shown in <xref ref-type="fig" rid="F8">Fig. 8</xref>. Pipeline 2 performs slightly worse than pipeline 1 because of RawMap’s lower classification accuracy compared to Guppy followed by Minimap2.</p><p id="P47">Pipeline 2 is beneficial if compute time and cost is a concern (Cloud GPU instances are ∼10% costlier than their CPU counterparts). Pipeline 2 yields a 22% compute time savings compared to baseline and pipeline 1 (<xref ref-type="fig" rid="F9">Fig. 9</xref>). This is because non-target human reads are filtered out from the basecalling-aligning path by RawMap.</p><p id="P48">It is observed that we get higher Read Until benefits from longer average read lengths (<xref ref-type="fig" rid="F10">Fig. 10</xref>). The blue-dashed line depicts the maximum benefits attainable with a 100% accurate classifier with zero latency of compute. Additionally, Read Until also yields higher benefits when the host contamination is high i.e, when we are looking for a needle in a haystack (<xref ref-type="fig" rid="F11">Fig. 11</xref>).</p></sec><sec id="S20"><label>6.2</label><title>Untargeted classifier</title><p id="P49">In pipeline 1, RawMap complements Minimap2 and improves overall pipeline accuracy and sequencing time while it improves compute time in pipeline 2. Additionally, we also evaluated RawMap as an untargeted filter (capable of correctly detecting new microbial species RawMap is untrained on) as shown in <xref ref-type="fig" rid="F12">Fig. 12</xref>. Here, RawMap is freshly trained on a total of 12000 reads from four Zymo HMW species (Pseudomonas aeruginosa, Salmonella enterica, Enterococcus faecalis, and Listeria monocytogenes) and human from a 50:50 premixed barcoded sample. RawMap is then tested on 800K reads of both human and four other Zymo HMW species (Saccharomyces cerevisiae, Escherichia coli, Staphylococcus aureus, and Bacillus subtilis) from a new sequencing run of 99:1 premixed barcoded sample. The confusion matrix values obtained in this case are very close to when RawMap was trained on all 8 species (targeted classifier) of Zymo HMW and human as shown in <xref ref-type="fig" rid="F12">Fig. 12</xref>. Hence, RawMap can function both as a targeted and an untargeted (microbial species-agnostic) classifier. This is particularly advantageous for cases where we do not know the input constitution mix.</p></sec><sec id="S21"><label>6.3</label><title>Sensitivity to Wet-lab</title><p id="P50">However, RawMap seems to be sensitive to the wet-lab protocols followed. RawMap is retrained for a different set of wet-lab protocols (new extraction techniques and no barcodes). Without re-training, RawMap did not perform as expected on 100K reads from 99:1 post-mixed run of extracted HeLa and ZymoBiomics Microbial Community DNA Standard sequenced (purchased from differently extracted sources) as shown in <xref ref-type="fig" rid="F13">Fig. 13</xref>. This is because RawMap is trained to capture nuances in electrical signals of the host and target and the signal: noise ratio is a function of wet-lab protocols followed. However, as shown in <xref ref-type="fig" rid="F13">Fig. 13</xref>, RawMap produced good results when retrained on 12000 reads from 50:50 HeLa: Zymo non-barcoded post mixed run which used the same set of wet-lab protocols (differently extracted DNA and no barcodes) and tested on 200K reads as shown in <xref ref-type="fig" rid="F13">Fig. 13</xref>.</p></sec><sec id="S22"><label>6.4</label><title>Abundance estimation</title><p id="P51">We also observe that pipeline 1 produces more accurate abundance estimates than pipeline 2 while being faster than the baseline. We observe that pipeline 1 has an estimated cell number abundance with an average deviation of 8.97% and a maximum deviation of 24.8% from Zymo HMW’s ground truth. This is in line with what the baseline pipeline identified as shown in <xref ref-type="fig" rid="F14">Fig. 14</xref>. The difference is that pipeline 1 is faster than the baseline. Pipeline 2’s result is comparatively more erroneous because RawMap as the primary classifier consistently misses a certain fraction of reads which are viable for abundance.</p></sec><sec id="S23"><label>6.5</label><title>Compute efficiency</title><p id="P52">RawMap on a CPU is 1327X faster than Guppy-followed-by-Minimap2 which uses a GPU. This stems from the fact that RawMap is a highly efficient C++ program that performs a simple set of linear and statistical operations and hence, requires less compute compared to the deep neural network used in Guppy. <xref ref-type="fig" rid="F15">Fig. 15</xref> shows the insignificant compute burden introduced by RawMap on the baseline Read Until pipeline. This motivates the use of RawMap as the primary filter in our proposed pipeline 2 instead of Guppy followed by Minimap2.</p></sec><sec id="S24"><label>6.6</label><title>Training</title><p id="P53">RawMap uses a Support Vector Machine (SVM) with a Radial Basis Function (RBF) kernel as it gives the best AUC (as shown in <xref ref-type="fig" rid="F16">Fig. 16</xref>). AUC was used as a scoring metric for model validation and hyper-parameters were tuned using grid search. Additionally, we also tried both linear and RBF kernels, and 11 additional features from the EEG space including Petrosian and Higuchi fractal dimensions, Fischer information, Hurst exponent, third and fourth moments, windowed maximum, minimum, and median (size=10), absolute change and correlation as shown in <xref ref-type="fig" rid="F16">Fig. 16</xref>.</p></sec><sec id="S25"><label>6.7</label><title>Viral load quantification</title><p id="P54">We also demonstrate how pipeline 2 may be used for efficient viral (SARS-COV-2) detection and load quantification. Since the Zymo community standard is not representative of the virus, we re-train RawMap. RawMap is re-trained on a 50: 50 digital mix of target SARS-CoV-2 and human host cDNA (12K reads) and then tested on a digitally mixed 99:1 host: target mix (100K reads). RawMap correctly retained ∼89% of all SARS-CoV-2 reads while filtering out ∼95% of the human reads (<xref ref-type="fig" rid="F17">Fig. 17</xref>). Therefore, only a small fraction of human reads are sent to the compute-intensive step of Guppy basecalling. Minimap2 filters out the small number of additional human reads that RawMap missed. This translates to ∼14 viral copies in the test dataset if SARS-CoV-2 RNA is 30Kbp long and the average read length is 475 bases. If the volume of the wet-lab sample is available, the number of viral copies per <italic>μl</italic> can then be estimated. This demonstrates a pipeline for viral load quantification that is computationally less expensive, as we skip basecalling and alignment. If one prefers more accurate viral load estimation, pipeline 1 may be adopted. In the future, when a viral community standard is available, RawMap may also be re-trained to function as an untargeted classifier for virus versus host cDNA.</p></sec><sec id="S26"><label>6.8</label><title>Read Until’s effect on pore-life</title><p id="P55">We demonstrate that Read Until does not hurt the pore any more than normal sequencing does. There is no significant difference between the active number of channels between the control and the Read Until regions of the flowcell after washing followed by MUX-ing (at time marked with vertical dotted black line) as shown in <xref ref-type="fig" rid="F18">Fig. 18</xref>. The slightly higher active channels with Read Until pores is because of some channels getting temporarily unclogged from using Read Until as noted in prior works (<xref ref-type="bibr" rid="R19">Kovaka <italic>et al</italic>., 2020</xref>). Therefore, using Read Until (with reduced time to answer) will let us pack more useful work into the lifetime of a flowcell.</p><p id="P56">It should be noted that the Read Until benefits from experiments may depend on many factors including sample mix constitution, average read length, and capture time of the experiment. We provide an analytical model (explained in the <xref ref-type="supplementary-material" rid="SD1">Supplementary section</xref>) to help estimate the savings.</p></sec></sec><sec id="S27" sec-type="conclusions"><label>7</label><title>Conclusion</title><p id="P57">Reduced time to answer for microbiome abundance estimation is critical for clinical diagnostics and health-care. The baseline pipeline for ONT Read Until which uses Guppy basecaller is slow and does not yield optimum benefits as a large fraction of the sequenced bases are non-target in a non-target rich sample. RawMap is an efficient CPU-only microbial species-agnostic squiggle-space Read Until classifier that is developed as a “plug-and-play” solution to complement the baseline Read Until pipeline. We perform feature engineering to extract non-linear non-stationery characteristics out of ONT squiggles and learn the differences between human and microbe using a Support Vector Machine.</p><p id="P58">RawMap is 1327X faster than the state-of-the-art solution and improves the sequencing time and cost, and compute time benefits from using Read Until. We demonstrate two different pipelines to optimally utilize RawMap. RawMap as a secondary filter (pipeline 1) yields ∼24% sequencing time and cost savings whereas RawMap as a primary filter (pipeline 2) yields ∼22% compute time savings compared to the baseline Read Until pipeline. We also show that RawMap can serve as an untargeted filter (classify unseen species) with nearly the same accuracy. Additionally, We also present how RawMap may be utilized instead of RT-PCR tests for viral load quantification of SARS-CoV-2.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS157636-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdHbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S28"><label>8</label><title>Acknowledgement</title><p>This project was funded in part by D. Dan and Betty Kahn Foundation and NSF award 2030454. The following cell lines/DNA samples were obtained from the NIGMS Human Genetic Cell Repository at the Coriell Institute for Medical Research: [NA12878]. We thank ONT for the developer access to Guppy and Read Until. We would like to thank John Erb-Downward and Rishi Chanderraj from UM Medical School for their helpful input and feedback during various stages of the project. We express our sincere gratitude to Jenna Wiens from UM-CSE for helping us explore the machine learning aspect of the classifier. We also acknowledge Ashwin Bhat from Georgia Tech for the helpful discussions during the conception of the analytical model.</p></ack><sec id="S29" sec-type="data-availability"><title>Availability and implementation</title><p id="P59">Software is released with MIT License and available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/harisankarsadasivan/RawMap">https://github.com/harisankarsadasivan/RawMap</ext-link></p></sec><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bao</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Squigglenet: real-time, direct classification of nanopore signals</article-title><source>Genome biology</source><year>2021</year><volume>22</volume><issue>1</issue><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC8548853</pub-id><pub-id pub-id-type="pmid">34706748</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02511-y</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buffie</surname><given-names>CG</given-names></name><etal/></person-group><article-title>Precision microbiome reconstitution restores bile acid mediated resistance to clostridium difficile</article-title><source>Nature</source><year>2015</year><volume>517</volume><issue>7533</issue><fpage>205</fpage><lpage>208</lpage><pub-id pub-id-type="pmcid">PMC4354891</pub-id><pub-id pub-id-type="pmid">25337874</pub-id><pub-id pub-id-type="doi">10.1038/nature13828</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>I</given-names></name><name><surname>Blaser</surname><given-names>MJ</given-names></name></person-group><article-title>The human microbiome: at the interface of health and disease</article-title><source>Nature Reviews Genetics</source><year>2012</year><volume>13</volume><issue>4</issue><fpage>260</fpage><lpage>270</lpage><pub-id pub-id-type="pmcid">PMC3418802</pub-id><pub-id pub-id-type="pmid">22411464</pub-id><pub-id pub-id-type="doi">10.1038/nrg3182</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>AN</given-names></name><name><surname>Kessel</surname><given-names>B</given-names></name></person-group><article-title>False positives in reverse transcription pcr testing for sars-cov-2</article-title><source>medRxiv</source><year>2020</year></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dilthey</surname><given-names>AT</given-names></name><etal/></person-group><article-title>Strain-level metagenomic assignment and compositional estimation for long reads with metamaps</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC6624308</pub-id><pub-id pub-id-type="pmid">31296857</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-10934-2</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>T</given-names></name><etal/></person-group><source>Squigglefilter: An accelerator for portable virus detection</source><conf-name>MICRO-54: 54th Annual IEEE/ACM International Symposium on Microarchitecture</conf-name><year>2021</year><fpage>535</fpage><lpage>549</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eckert</surname><given-names>SE</given-names></name><etal/></person-group><article-title>Enrichment by hybridisation of long dna fragments for nanopore sequencing</article-title><source>Microbial genomics</source><year>2016</year><volume>2</volume><issue>9</issue><pub-id pub-id-type="pmcid">PMC5537632</pub-id><pub-id pub-id-type="pmid">28785419</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000087</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>HS</given-names></name><etal/></person-group><article-title>Real-time selective sequencing with rubric: Read until with basecall and reference-informed criteria</article-title><source>Scientific reports</source><year>2019</year><volume>9</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC6685950</pub-id><pub-id pub-id-type="pmid">31391493</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-47857-3</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fajnzylber</surname><given-names>J</given-names></name><etal/></person-group><article-title>Sars-cov-2 viral load is associated with increased disease severity and mortality</article-title><source>Nature communications</source><year>2020</year><volume>11</volume><issue>1</issue><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC7603483</pub-id><pub-id pub-id-type="pmid">33127906</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-19057-5</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilpatrick</surname><given-names>T</given-names></name><etal/></person-group><article-title>Targeted nanopore sequencing with cas9-guided adapter ligation</article-title><source>Nature biotechnology</source><year>2020</year><volume>38</volume><issue>4</issue><fpage>433</fpage><lpage>438</lpage><pub-id pub-id-type="pmcid">PMC7145730</pub-id><pub-id pub-id-type="pmid">32042167</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-0407-5</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hjorth</surname><given-names>B</given-names></name></person-group><article-title>Eeg analysis based on time domain properties</article-title><source>Electroencephalography and clinical neurophysiology</source><year>1970</year><volume>29</volume><issue>3</issue><fpage>306</fpage><lpage>310</lpage><pub-id pub-id-type="pmid">4195653</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>B</given-names></name><etal/></person-group><article-title>Illumina sequencing of clinical samples for virus detection in a public health laboratory</article-title><source>Scientific reports</source><year>2019</year><volume>9</volume><issue>1</issue><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC6800436</pub-id><pub-id pub-id-type="pmid">31628368</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-50827-4</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><etal/></person-group><article-title>Megan analysis of metagenomic data</article-title><source>Genome research</source><year>2007</year><volume>17</volume><issue>3</issue><fpage>377</fpage><lpage>386</lpage><pub-id pub-id-type="pmcid">PMC1800929</pub-id><pub-id pub-id-type="pmid">17255551</pub-id><pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacot</surname><given-names>D</given-names></name><etal/></person-group><article-title>Viral load of sars-cov-2 across patients and compared to other respiratory viruses</article-title><source>Microbes and infection</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7476607</pub-id><pub-id pub-id-type="pmid">32911086</pub-id><pub-id pub-id-type="doi">10.1016/j.micinf.2020.08.004</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kai</surname><given-names>S</given-names></name><etal/></person-group><article-title>Rapid bacterial identification by direct pcr amplification of 16s rrna genes using the minion™ nanopore sequencer</article-title><source>FEBS open bio</source><year>2019</year><volume>9</volume><issue>3</issue><fpage>548</fpage><lpage>557</lpage><pub-id pub-id-type="pmcid">PMC6396348</pub-id><pub-id pub-id-type="pmid">30868063</pub-id><pub-id pub-id-type="doi">10.1002/2211-5463.12590</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalantar-Zadeh</surname><given-names>K</given-names></name><etal/></person-group><article-title>Considering the effects of microbiome and diet on sars-cov-2 infection: nanotechnology roles</article-title><source>ACS nano</source><year>2020</year><volume>14</volume><issue>5</issue><fpage>5179</fpage><lpage>5182</lpage><pub-id pub-id-type="pmcid">PMC7197973</pub-id><pub-id pub-id-type="pmid">32356654</pub-id><pub-id pub-id-type="doi">10.1021/acsnano.0c03402</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><etal/></person-group><article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title><source>Genome research</source><year>2016</year><volume>26</volume><issue>12</issue><fpage>1721</fpage><lpage>1729</lpage><pub-id pub-id-type="pmcid">PMC5131823</pub-id><pub-id pub-id-type="pmid">27852649</pub-id><pub-id pub-id-type="doi">10.1101/gr.210641.116</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><etal/></person-group><article-title>The architecture of sars-cov-2 transcriptome</article-title><source>Cell</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7179501</pub-id><pub-id pub-id-type="pmid">32330414</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.04.011</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kovaka</surname><given-names>S</given-names></name><etal/></person-group><article-title>Targeted nanopore sequencing by real-time mapping of raw electrical signal with uncalled</article-title><source>BioRxiv</source><year>2020</year><pub-id pub-id-type="pmcid">PMC8567335</pub-id><pub-id pub-id-type="pmid">33257863</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-0731-9</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kupková</surname><given-names>K</given-names></name></person-group><article-title>Alignment-free visualization of metagenomic data by genomic signal processing</article-title><source>Complexity</source><year>2014</year><volume>100</volume><fpage>3</fpage></element-citation></ref><ref id="R21"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kupkova</surname><given-names>K</given-names></name><etal/></person-group><source>Reference-free identification of phage dna using signal processing on nanopore data</source><conf-name>2017 IEEE 17th International Conference on Bioinformatics and Bioengineering (BIBE)</conf-name><year>2017</year><fpage>101</fpage><lpage>105</lpage><conf-sponsor>IEEE</conf-sponsor></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><issue>18</issue><fpage>3094</fpage><lpage>3100</lpage><pub-id pub-id-type="pmcid">PMC6137996</pub-id><pub-id pub-id-type="pmid">29750242</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loose</surname><given-names>M</given-names></name><etal/></person-group><article-title>Real-time selective sequencing using nanopore technology</article-title><source>Nature methods</source><year>2016</year><volume>13</volume><issue>9</issue><fpage>751</fpage><pub-id pub-id-type="pmcid">PMC5008457</pub-id><pub-id pub-id-type="pmid">27454285</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3930</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>J</given-names></name><etal/></person-group><article-title>Bracken: estimating species abundance in metagenomics data</article-title><source>PeerJ Computer Science</source><year>2017</year><volume>3</volume><elocation-id>e104</elocation-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marani</surname><given-names>M</given-names></name><etal/></person-group><article-title>Intensity and frequency of extreme novel epidemics</article-title><source>Proceedings of the National Academy of Sciences</source><year>2021</year><volume>118</volume><issue>35</issue><elocation-id>e2105482118</elocation-id><pub-id pub-id-type="pmcid">PMC8536331</pub-id><pub-id pub-id-type="pmid">34426498</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2105482118</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>SC</given-names></name><etal/></person-group><article-title>Amplicon based minion sequencing of sars-cov-2 and metagenomic characterisation of nasopharyngeal swabs from patients with covid-19</article-title><source>medRxiv</source><year>2020</year></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><collab>ONT</collab><source>Metagenomic analysis of SARS-CoV-2 respiratory samples via Sequence-Independent Single Primer Amplification (SISPA) and nanopore sequencing</source><year>2020</year></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Viral load of sars-cov-2 in clinical samples</article-title><source>The Lancet infectious diseases</source><year>2020</year><volume>20</volume><issue>4</issue><fpage>411</fpage><lpage>412</lpage><pub-id pub-id-type="pmcid">PMC7128099</pub-id><pub-id pub-id-type="pmid">32105638</pub-id><pub-id pub-id-type="doi">10.1016/S1473-3099(20)30113-4</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payne</surname><given-names>A</given-names></name><etal/></person-group><article-title>Readfish enables targeted nanopore sequencing of gigabase-sized genomes</article-title><source>Nature Biotechnology</source><year>2020</year><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC7610616</pub-id><pub-id pub-id-type="pmid">33257864</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-00746-x</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faria</surname><given-names>RN</given-names></name></person-group><source>First cases of coronavirus disease (COVID-19) in Brazil, South America</source><year>2020</year></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaeffer</surname><given-names>L</given-names></name><etal/></person-group><article-title>Pseudoalignment for metagenomic read assignment</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><issue>14</issue><fpage>2082</fpage><lpage>2088</lpage><pub-id pub-id-type="pmcid">PMC5870846</pub-id><pub-id pub-id-type="pmid">28334086</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btx106</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shih</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>Efficient real-time selective genome sequencing on resource-constrained devices</article-title><source>arXiv preprint</source><year>2022</year><elocation-id>arXiv:2211.07340</elocation-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommariva</surname><given-names>M</given-names></name><etal/></person-group><article-title>The lung microbiota: role in maintaining pulmonary immune homeostasis and its implications in cancer development and therapy</article-title><source>Cellular and Molecular Life Sciences</source><year>2020</year><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC7326824</pub-id><pub-id pub-id-type="pmid">31974656</pub-id><pub-id pub-id-type="doi">10.1007/s00018-020-03452-8</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Surkova</surname><given-names>E</given-names></name><etal/></person-group><article-title>False-positive covid-19 results: hidden problems and costs</article-title><source>The Lancet Respiratory Medicine</source><year>2020</year><volume>8</volume><issue>12</issue><fpage>1167</fpage><lpage>1168</lpage><pub-id pub-id-type="pmcid">PMC7524437</pub-id><pub-id pub-id-type="pmid">33007240</pub-id><pub-id pub-id-type="doi">10.1016/S2213-2600(20)30453-7</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Truong</surname><given-names>DT</given-names></name><etal/></person-group><article-title>Metaphlan2 for enhanced metagenomic taxonomic profiling</article-title><source>Nature methods</source><year>2015</year><volume>12</volume><issue>10</issue><fpage>902</fpage><lpage>903</lpage><pub-id pub-id-type="pmid">26418763</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villapol</surname><given-names>S</given-names></name></person-group><article-title>Gastrointestinal symptoms associated with covid-19: impact on the gut microbiome</article-title><source>Translational Research</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7438210</pub-id><pub-id pub-id-type="pmid">32827705</pub-id><pub-id pub-id-type="doi">10.1016/j.trsl.2020.08.004</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>M</given-names></name><etal/></person-group><article-title>Nanopore targeted sequencing for the accurate and comprehensive detection of sars-cov-2 and other respiratory viruses</article-title><source>Small</source><year>2020</year><volume>16</volume><issue>32</issue><elocation-id>2002169</elocation-id><pub-id pub-id-type="pmcid">PMC7361204</pub-id><pub-id pub-id-type="pmid">32578378</pub-id><pub-id pub-id-type="doi">10.1002/smll.202002169</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>DV</given-names></name><etal/></person-group><article-title>The intestinal and oral microbiomes are robust predictors of covid-19 severity the main predictor of covid-19-related fatality</article-title><source>medRxiv</source><year>2021</year></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wick</surname><given-names>RR</given-names></name><etal/></person-group><article-title>Performance of neural network basecalling tools for oxford nanopore sequencing</article-title><source>Genome biology</source><year>2019</year><volume>20</volume><issue>1</issue><fpage>129</fpage><pub-id pub-id-type="pmcid">PMC6591954</pub-id><pub-id pub-id-type="pmid">31234903</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1727-y</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>DE</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title><source>Genome biology</source><year>2014</year><volume>15</volume><issue>3</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC4053813</pub-id><pub-id pub-id-type="pmid">24580807</pub-id><pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>DE</given-names></name><etal/></person-group><article-title>Improved metagenomic analysis with kraken 2</article-title><source>Genome biology</source><year>2019</year><volume>20</volume><issue>1</issue><fpage>257</fpage><pub-id pub-id-type="pmcid">PMC6883579</pub-id><pub-id pub-id-type="pmid">31779668</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1891-0</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>L</given-names></name><etal/></person-group><article-title>Metagenomic identification of severe pneumonia pathogens in mechanically-ventilated patients: a feasibility and clinical validity study</article-title><source>Respiratory research</source><year>2019</year><volume>20</volume><issue>1</issue><fpage>265</fpage><pub-id pub-id-type="pmcid">PMC6882222</pub-id><pub-id pub-id-type="pmid">31775777</pub-id><pub-id pub-id-type="doi">10.1186/s12931-019-1218-4</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><etal/></person-group><article-title>Real-time mapping of nanopore raw signals</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><issue>Supplement_1</issue><fpage>i477</fpage><lpage>i483</lpage><pub-id pub-id-type="pmcid">PMC8336444</pub-id><pub-id pub-id-type="pmid">34252938</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab264</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuo</surname><given-names>T</given-names></name><etal/></person-group><article-title>Alterations in gut microbiota of patients with covid-19 during time of hospitalization</article-title><source>Gastroenterology</source><year>2020</year><volume>159</volume><issue>3</issue><fpage>944</fpage><lpage>955</lpage><pub-id pub-id-type="pmcid">PMC7237927</pub-id><pub-id pub-id-type="pmid">32442562</pub-id><pub-id pub-id-type="doi">10.1053/j.gastro.2020.05.048</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><p>Unclassified reads from Guppy followed by Minimap2 have a lower mean Phred quality score compared to classified reads as seen in this probability density function of Phred quality scores.</p></caption><graphic xlink:href="EMS157636-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><p>59.5% of the total sequenced bases are unclassified in a 99:1 host:target sample with an average read length of 8.298Kb.</p></caption><graphic xlink:href="EMS157636-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><p>Proposed pipeline 1 with RawMap as a secondary filter classifying Minimap2-unclassified-reads, plugged-in after Guppy and Minimap2, yields best savings in sequencing time and cost for 99:1 sample with an average read length of 8.298 Kbases.</p></caption><graphic xlink:href="EMS157636-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><p>Proposed pipeline 2 with RawMap as the primary filter helps skip Guppy and Minimap2 for most of the non-target reads and offers best compute time savings.</p></caption><graphic xlink:href="EMS157636-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Customized Minimap2 with refined index is more accurate than Centrifuge for abundance estimation.</title></caption><graphic xlink:href="EMS157636-f005"/></fig><fig id="F6" position="float"><label>Fig. 6</label><caption><p>(a) Customized Minimap2 with refined index has better accuracy of mapping. (b) Customization helps us classify more reads compared to Minimap2.</p></caption><graphic xlink:href="EMS157636-f006"/></fig><fig id="F7" position="float"><label>Fig. 7</label><caption><p>Target(Zymo) squiggles are highly localized in the modified Hjorth space as shown in blue. For illustration, only 1000 feature vectors each of target and non-target are shown here.</p></caption><graphic xlink:href="EMS157636-f007"/></fig><fig id="F8" position="float"><label>Fig. 8</label><caption><title>Pipeline 1 saves ∼24% sequencing time and cost compared to the baseline Read Until pipeline.</title></caption><graphic xlink:href="EMS157636-f008"/></fig><fig id="F9" position="float"><label>Fig. 9</label><caption><p>Pipeline 2 yields 22% compute time savings compared to the baseline and pipeline 1 because we skip the expensive basecalling step for primary filtering.</p></caption><graphic xlink:href="EMS157636-f009"/></fig><fig id="F10" position="float"><label>Fig. 10</label><caption><title>Higher read lengths give better sequencing time and cost savings in a 99:1 host: microbial mix.</title></caption><graphic xlink:href="EMS157636-f010"/></fig><fig id="F11" position="float"><label>Fig. 11</label><caption><title>Higher host: target ratio yields better sequencing time and cost savings for an average read length of 8.29Kbases.</title></caption><graphic xlink:href="EMS157636-f011"/></fig><fig id="F12" position="float"><label>Fig. 12</label><caption><title>RawMap does untargeted classification as well as targeted classification.</title></caption><graphic xlink:href="EMS157636-f012"/></fig><fig id="F13" position="float"><label>Fig. 13</label><caption><title>RawMap can be customized for different wet-lab protocols by retraining.</title></caption><graphic xlink:href="EMS157636-f013"/></fig><fig id="F14" position="float"><label>Fig. 14</label><caption><title>Pipeline 1 and baseline produce the best abundance estimate well within the tolerance limit.</title></caption><graphic xlink:href="EMS157636-f014"/></fig><fig id="F15" position="float"><label>Fig. 15</label><caption><p>RawMap introduces negligible overhead compared to other components in the Read Until decision-making path for 450bp.</p></caption><graphic xlink:href="EMS157636-f015"/></fig><fig id="F16" position="float"><label>Fig. 16</label><caption><p>Pipeline 2 ROC: SVM with Radial Basis function kernel and three features yields the best base savings compared to a linear kernel and additional features.</p></caption><graphic xlink:href="EMS157636-f016"/></fig><fig id="F17" position="float"><label>Fig. 17</label><caption><p>(a)RawMap is good at classifying SARS-CoV-2 from human. (b) ROC for human vs SARS-CoV-2 classification.</p></caption><graphic xlink:href="EMS157636-f017"/></fig><fig id="F18" position="float"><label>Fig. 18</label><caption><p>Flowcell wear-out characteristics: Read Until does not clog pores any more than normal sequencing as evident from the equal percentage of active channels recovered after wash.</p></caption><graphic xlink:href="EMS157636-f018"/></fig></floats-group></article>