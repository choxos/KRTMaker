<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158592</article-id><article-id pub-id-type="doi">10.1101/2022.12.13.520181</article-id><article-id pub-id-type="archive">PPR584807</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Cell-type-specific co-expression inference from single cell RNA-sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Su</surname><given-names>Chang</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Xu</surname><given-names>Zichun</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Shan</surname><given-names>Xinning</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Cai</surname><given-names>Biao</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Hongyu</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Jingfei</given-names></name><xref ref-type="aff" rid="A2">b</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>a</label>Department of Biostatistics, Yale University</aff><aff id="A2"><label>b</label>Information Systems and Operations Management, Emory University</aff><author-notes><corresp id="CR1"><label>*</label>Co-corresponding authors</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>17</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>15</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The inference of gene co-expressions from microarray and RNA-sequencing data has led to rich insights on biological processes and disease mechanisms. However, the bulk samples analyzed in most studies are a mixture of different cell types. As a result, the inferred co-expressions are confounded by varying cell type compositions across samples and only offer an aggregated view of gene regulations that may be distinct across different cell types. The advancement of single cell RNA-sequencing (scRNA-seq) technology has enabled the direct inference of co-expressions in specific cell types, facilitating our understanding of cell-type-specific biological functions. However, the high sequencing depth variations and measurement errors in scRNA-seq data present significant challenges in inferring cell-type-specific gene co-expressions, and these issues have not been adequately addressed in the existing methods. We propose a statistical approach, CS-CORE, for estimating and testing cell-type-specific co-expressions, built on a general expression-measurement model that explicitly accounts for sequencing depth variations and measurement errors in the observed single cell data. Systematic evaluations show that most existing methods suffer from inflated false positives and biased co-expression estimates and clustering analysis, whereas CS-CORE has appropriate false positive control, unbiased co-expression estimates, good statistical power and satisfactory performance in downstream co-expression analysis. When applied to analyze scRNA-seq data from postmortem brain samples from Alzheimer’s disease patients and controls and blood samples from COVID-19 patients and controls, CS-CORE identified cell-type-specific co-expressions and differential co-expressions that were more reproducible and/or more enriched for relevant biological pathways than those inferred from other methods.</p></abstract><kwd-group><kwd>cell-type-specific analysis</kwd><kwd>expression-measurement model</kwd><kwd>gene co-expression network</kwd><kwd>sequencing depth</kwd><kwd>single cell RNA-seq</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">The past two decades have seen great advances in gene co-expression studies using microarrays and RNA sequencing technologies, leading to rich insights on biological processes and disease mechanisms (<xref ref-type="bibr" rid="R48">Zhang and Horvath, 2005</xref>; <xref ref-type="bibr" rid="R24">Mostafavi et al., 2018</xref>; <xref ref-type="bibr" rid="R16">Koplev et al., 2022</xref>). To date, most co-expression analyses have been performed on bulk samples that are a mixture of different cell types. As a result, the inferred networks are confounded with varying cell type compositions across samples and limited to an aggregated view of gene regulations that may differ considerably across cell types (<xref ref-type="bibr" rid="R11">Heintzman et al., 2009</xref>; <xref ref-type="bibr" rid="R33">Su et al., 2022</xref>). To infer cell-type-specific networks from bulk samples, cell sorting can be performed, but the techniques are tedious and subject to technical artifacts (<xref ref-type="bibr" rid="R2">Box et al., 2020</xref>).</p><p id="P3">With scRNA-seq technology such as droplet-based methods, gene expressions can now be measured in individual cells with annotated cell types (<xref ref-type="bibr" rid="R9">Hao et al., 2021</xref>), offering a great opportunity to construct cell-type-specific co-expression networks. However, such an analytical task is challenged by the unique characteristics of scRNA-seq data such as their high sequencing depth variations and measurement errors. For scRNA-seq data, the expression level of a specific gene is measured through the observed UMI (unique molecular identifier) count for this gene, and the sequencing depth of a cell is the sum of UMI counts across all genes. For a typical single cell experiment, there is substantial variation of sequencing depths across cells (e.g., 400 - 20,000) (<xref ref-type="bibr" rid="R7">Hafemeister and Satija, 2019</xref>; <xref ref-type="bibr" rid="R32">Sarkar and Stephens, 2021</xref>). As a result, gene co-expressions measured via correlations of UMI counts across cells can be seriously confounded by varying sequencing depths, resulting in inflated false positive findings in detecting co-expressed gene pairs. This confounding issue cannot be addressed using standard normalization strategies, as will be shown later. Besides varying sequencing depths, measurement errors in the UMI count data pose an additional challenge in inferring co-expression levels as the errors tend to attenuate correlation estimates with different degrees for genes with different expression levels.</p><p id="P4">Recent years have seen the developments of a number of methods to better capture co-expressions from scRNA-seq data than a simple normalization-based approach, including locCSN (<xref ref-type="bibr" rid="R41">Wang et al., 2021</xref>b), Noise Regularization (<xref ref-type="bibr" rid="R49">Zhang et al., 2021</xref>), Normalisr (<xref ref-type="bibr" rid="R41">Wang, 2021</xref>), propr (<xref ref-type="bibr" rid="R27">Quinn et al., 2017</xref>), and SpQN (<xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>). These methods consider novel association metrics or additional adjustments when inferring co-expressions from scRNA-seq data. However, the proposed procedures do not have rigorous justifications as they are not explicitly based on the underlying data generating mechanisms and do not appropriately account for measurement errors and varying sequencing depths across cells. Besides the above co-expression estimation methods, a recently proposed method called sc-transform (<xref ref-type="bibr" rid="R7">Hafemeister and Satija, 2019</xref>) estimates gene expression levels from scRNA-seq data by removing the effect of varying sequencing depths via negative binomial regressions. Although sctransform was not developed for co-expression estimation, one sensible approach is to calculate correlations of expression levels that have been adjusted for sequencing depths by sctransform; we refer to this approach as ρ-sctransform in our following discussion. As will be demonstrated later, the sequencing depth normalization in sctransform, designed to infer expression levels, can be inadequate in removing biases from sequencing variation and measurement errors when inferring co-expressions. In our systematic evaluations of different methods based on simulated and permuted real scRNA-seq data, we found that all the other methods, including ρ-sctransform, suffer from inflated type-I errors, varying degrees of estimation biases, reduced accuracy in detecting co-expressions, and potentially misleading results in downstream co-expression analysis such as clustering and principal component analysis.</p><p id="P5">Here, we present a statistical approach for estimating and testing co-expressions from scRNA-seq data, called CS-CORE (cell-type-specific co-expressions). Specifically, CS-CORE models the unobserved true gene expression levels as latent variables, linked to the observed UMI counts through a measurement model that accounts for both sequencing depth variations and measurement errors. Under this model, CS-CORE implements a fast and efficient iteratively re-weighted least squares approach for estimating the true correlations between underlying expression levels, together with a theoretically justified statistical test to assess whether two genes are independent. The proposed model in CS-CORE does not impose any distributional assumptions on the underlying expression levels and can flexibly accommodate single cell data generating mechanisms such as negative binomial distributed counts. Through systematic evaluations based on simulated and permuted real scRNA-seq data, we found that CS-CORE had proper type-I error control, unbiased co-expression estimates and increased statistical power compared with other methods. CS-CORE also had satisfactory performance in downstream co-expression analysis.</p><p id="P6">We evaluated the utility of CS-CORE by applying it to multiple scRNA-seq data sets including postmortem brain samples from Alzheimer’s disease patients and controls (<xref ref-type="bibr" rid="R19">Lau et al., 2020</xref>) and peripheral blood mononuclear cells (PBMC) of COVID-19 patients and controls (<xref ref-type="bibr" rid="R45">Wilk et al., 2020</xref>). For both diseases, CS-CORE identified co-expressions that were more reproducible across independent data sets and more enriched with known transcription factor-target gene pairs than other methods. Clustering analysis using results from CS-CORE extracted co-expressed and differentially co-expressed gene modules that were more strongly enriched for relevant cell-type-specific biological functions than those inferred from other methods, highlighting the potential of CS-CORE in characterizing cell-type-specific biological functions and uncovering novel disease-related cell-type-specific pathways.</p></sec><sec id="S2" sec-type="results"><label>2</label><title>Results</title><sec id="S3"><label>2.1</label><title>Overview of CS-CORE</title><p id="P7">We have <italic>n</italic> cells with the observation for cell <italic>i</italic>, <italic>i</italic> = 1, …, <italic>n</italic>, denoted by a vector (<italic>x</italic><sub><italic>i</italic>1</sub>,…, <italic>x<sub>ip</sub></italic>) corresponding to the observed UMI counts for <italic>p</italic> genes. We use <inline-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>to denote the sequencing depth of cell <italic>i</italic>, which is the sum of UMI counts across all genes in this cell. Let (z<sub>i1</sub>,…, <italic>z<sub>ip</sub>)</italic> denote the underlying expression levels from <italic>p</italic> genes in cell <italic>i</italic>, defined to be the number of molecules from each gene relative to the total number of molecules in a cell (<xref ref-type="bibr" rid="R32">Sarkar and Stephens, 2021</xref>). Assume that <disp-formula id="FD1"><label>(1)</label><mml:math id="M2"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>∑</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <italic>F<sub>p</sub></italic>(<bold><italic>μ</italic></bold>, <bold>∑</bold>) is an unknown nonnegative <italic>p</italic>-variate distribution with mean vector <inline-formula><mml:math id="M3"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></inline-formula> and covariance matrix <inline-formula><mml:math id="M4"><mml:mrow><mml:mi>∑</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.Here, <italic>x<sub>ij</sub></italic> is the UMI count of gene <italic>j</italic> in cell <italic>i</italic>, assumed to follow a Poisson measurement model (<xref ref-type="bibr" rid="R32">Sarkar and Stephens, 2021</xref>) depending on the underlying expression level <italic>z<sub>i</sub>j</italic> and sequencing depth <italic>s<sub>i</sub></italic>. This Poisson measurement model explicitly accounts for the sequencing depths and measurement errors. While a marginal expression-measurement model has been considered for modeling expression levels in bulk RNA-seq (<xref ref-type="bibr" rid="R29">Robinson et al., 2010</xref>; <xref ref-type="bibr" rid="R21">Love et al., 2014</xref>) and scRNA-seq data (<xref ref-type="bibr" rid="R39">Wang et al., 2018</xref>; <xref ref-type="bibr" rid="R7">Hafemeister and Satija, 2019</xref>; <xref ref-type="bibr" rid="R37">Townes et al., 2019</xref>), a joint expression-measurement model such as (<xref ref-type="disp-formula" rid="FD1">1</xref>) is needed to infer co-expressions. Under (<xref ref-type="disp-formula" rid="FD1">1</xref>), if <italic>z<sub>ij</sub></italic> follows a Gamma distribution, then <italic>x<sub>ij</sub></italic> follows a negative binomial distribution marginally.</p><p id="P8">We measure gene co-expressions by <bold>∑</bold><sub><italic>p</italic>×<italic>p</italic></sub>, which quantifies the correlation strength between the underlying expression levels. This definition of co-expression is precise and not biased by sequencing depth variations and measurement errors. Specifically, for any gene pair <inline-formula><mml:math id="M5"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we measure co-expression via their correlation <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p id="P9">Given UMI counts <inline-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and sequencing depths <inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula>, estimating the covariance matrix <bold>∑</bold><sub><italic>p</italic>×<italic>p</italic></sub> is a challenging task. Without placing distributional assumptions on <italic>F<sub>p</sub>,</italic> we propose a moment-based iteratively reweighted least squares (IRLS) estimation procedure, that is fast to implement and statistically efficient. For each pair <italic>(j,j</italic>’), we also develop a theoretically justified hypothesis testing procedure that evaluates the independence between their expression levels <italic>z<sub>ij</sub></italic> and <italic>z<sub>ij</sub>′</italic>. The test statistic can be easily computed using IRLS estimates, does not require any distributional assumptions on <italic>F<sub>p</sub></italic>, and follows a standard normal distribution under the null.</p><p id="P10">Details of the above estimation and testing procedures are given in <xref ref-type="sec" rid="S11">Section 4.1</xref>. In summary, CS-CORE takes UMI counts and sequencing depths across cells as input and estimates correlations of the underlying expression levels as well as <italic>p</italic>-values for testing independence between gene pairs, without needing parameter tuning. The procedure removes the confounding effects of varying sequencing depths and the bias from measurement errors when inferring co-expressions, is theoretically justified and fast to implement.</p></sec><sec id="S4"><label>2.2</label><title>CS-CORE has better control of false positive rates</title><p id="P11">To evaluate the performance of CS-CORE and illustrate the confounding effects from sequencing depth variations on other methods for independent gene pairs, we generated null data sets, where genes are not expected to co-express, by permuting the single nucleus RNA-seq (snRNA-seq) data from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> while making the sequencing depths across cells either constant or varying. Specifically, we normalized gene expressions (UMI counts) within each cell by its sequencing depth and, for each gene, we randomly permuted its normalized expression levels across cells. Then, we obtained UMI counts for each gene based on pre-specified sequencing depth of each cell (<xref ref-type="sec" rid="S13">Section 4.3</xref>). To examine effects of sequencing depth variations, we considered two settings with one set to observed sequencing depths in real data, which are highly variable, and one set to be constant across cells. This permutation procedure de-correlated gene expressions such that the average co-expression for each gene in the permuted data, calculated by averaging its co-expressions with all other genes, is expected to center around zero, regardless of sequencing depth variations.</p><p id="P12">We compared CS-CORE to other approaches, including locCSN (<xref ref-type="bibr" rid="R41">Wang et al., 2021</xref>b), Noise Regularization (<xref ref-type="bibr" rid="R49">Zhang et al., 2021</xref>), Normalisr (<xref ref-type="bibr" rid="R41">Wang, 2021</xref>), Pearson correlation, propr (<xref ref-type="bibr" rid="R27">Quinn et al., 2017</xref>), ρ-sctransform (<xref ref-type="bibr" rid="R7">Hafemeister and Satija, 2019</xref>), Spearman correlation and SpQN (<xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>) (<xref ref-type="sec" rid="S12">Section 4.2</xref>). Among these approaches, statistical tests for co-expressions are possible for Noise Regularization, Normalisr, Pearson correlation, ρ-sctransform and Spearman correlation.</p><p id="P13">For null data with high variations in sequencing depths, we found that co-expression estimates from most methods were biased with estimated average gene co-expressions different from zero (<xref ref-type="fig" rid="F1">Figure 1A</xref>). The amount of bias varied with the expression level with distinct patterns for different methods. Meanwhile, in null data with no sequencing depth variations, there were minimal biases for these methods (<xref ref-type="fig" rid="F1">Figure 1A</xref>), demonstrating that co-expression estimates can be biased by sequencing depth variations. By contrast, average co-expressions estimated by CS-CORE were unbiased and centered around zero, regardless of sequencing depth variations (<xref ref-type="fig" rid="F1">Figure 1A</xref>). We observed the same qualitative patterns in our experiments with simulated data (<xref ref-type="supplementary-material" rid="SD1">figure S2</xref>). One main cause of bias from other methods is no or inadequate adjustments of sequencing depth variations when measuring co-expressions, including the standard log transformations (e.g., Pearson, locCSN) and post-hoc adjustments (e.g., SpQN). We further illustrate this with additional simulations in <xref ref-type="supplementary-material" rid="SD1">figure S1</xref>.</p><p id="P14">We also considered statistical tests for co-expressions in the permuted data. As the null hypothesis of no co-expression is expected to hold after permutation, <italic>p</italic>-values for testing independence of gene pairs should follow the Uniform[0,1] distribution. We found that in null data with no variations in sequencing depths, most methods had well-controlled type-I errors as the Q-Q plots showed matching quantiles between empirical distributions of <italic>p</italic>-values and the uniform distribution (<xref ref-type="fig" rid="F1">Figure 1B</xref>). However, in null data with high variations in sequencing depths, Noise Regularization, Pearson and Spearman had inflated type I errors, demonstrating the confounding effects of sequencing depth variations (<xref ref-type="fig" rid="F1">Figure 1B</xref>). While Normalisr and ρ-sctransform had controlled type-I errors with sequencing depth variations, they had biases in estimating co-expressions (<xref ref-type="fig" rid="F2">Figure 2A</xref>). We also found that these two methods had reduced power in detecting co-expressions when compared to CS-CORE (Appendix, <xref ref-type="supplementary-material" rid="SD1">Figure S3</xref>).</p></sec><sec id="S5"><label>2.3</label><title>CS-CORE has better co-expression estimation and detection accuracy</title><p id="P15">We evaluated the accuracy of CS-CORE in estimating and detecting co-expressions and illustrated another issue often referred to as the mean-correlation bias (<xref ref-type="bibr" rid="R4">Crow et al., 2016</xref>; <xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>) in co-expression estimation. The mean-correlation bias is a separate issue from the confounding effect of varying sequencing depths. It arises, as measuring associations of the observed UMI counts, which profile the underlying expressions with measurement errors, tend to yield attenuated estimates due to the added errors. The amount of attenuation bias tends to decrease as the expression level increases (see <xref ref-type="sec" rid="S14">Section 4.4</xref>) and correlations tend to be more accurately estimated for highly expressed genes. As a result, highly expressed genes can appear more correlated as an artifact. This attenuation bias has also been noted in analyzing bulk RNA-seq data (<xref ref-type="bibr" rid="R31">Saccenti et al., 2020</xref>; <xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>), but it can be exacerbated by the shallow sequencing depths frequently seen in scRNA-seq data.</p><p id="P16">To demonstrate this, we simulated expression data for gene pairs with varying expression levels and a correlation of ρ = 0.5 following marginal negative binomial distributions (see <xref ref-type="sec" rid="S15">Section 4.5</xref>). For co-expressed gene pairs with a true correlation of 0.5, we found that correlation estimates from all other methods were inaccurate (<xref ref-type="fig" rid="F2">Figure 2A</xref>) with most methods severely underestimating co-expressions for genes with low or moderate expression levels. The correlation estimates also spuriously increased with expression levels for most methods. By contrast, CS-CORE could accurately estimate co-expressions (<xref ref-type="fig" rid="F2">Figure 2A</xref>) and was not subject to mean-correlation bias. This is because CS-CORE is based on an expression-measurement model and explicitly measures co-expressions using correlations of the underlying expression levels, free of measurement errors. The mean-correlation bias remained on data simulated with no variations in sequencing depths (<xref ref-type="supplementary-material" rid="SD1">figure S4</xref>), suggesting that the mean-correlation bias is a separate source of bias from varying sequencing depths. We further evaluated the co-expression detection accuracy in simulations with <italic>p</italic> = 500 where co-expressed pairs were set to those inferred from real data (see <xref ref-type="sec" rid="S15">Section 4.5</xref>). The precision-recall curves in <xref ref-type="fig" rid="F2">Figure 2B</xref> show that CS-CORE achieves the highest area-under-the-curve value.</p><p id="P17">Finally, we compared the computing time of different methods (<xref ref-type="fig" rid="F2">Figure 2C</xref>) under the simulation setting considered in <xref ref-type="fig" rid="F2">Figure 2B</xref>. It is seen that CS-CORE is highly computationally efficient as it uses a least squares estimation procedure. Specifically, CS-CORE was faster to implement than the state-of-the-art method, locCSN, which is based a local nonparametric test and ρ-sctransform, which requires fitting marginal negative binomial regressions using likelihood-based approaches. The computing time of CS-CORE is comparable to simple procedures such as Pearson and Spearman, as they both include a normalization step (see <xref ref-type="sec" rid="S12">Section 4.2</xref>).</p></sec><sec id="S6"><label>2.4</label><title>Other methods can lead to biased results in downstream coexpression analysis</title><p id="P18">Bias in estimating co-expressions can negatively impact important downstream co-expression analyses such as clustering and principal component analysis (PCA). To evaluate the performance of CS-CORE and other methods on such downstream analytical tasks, we simulated <italic>n</italic> = 2, 000 cells for <italic>p</italic> = 100 genes with varying expression levels and a co-expression matrix with four clusters (see <xref ref-type="sec" rid="S15">Section 4.5</xref> and <xref ref-type="supplementary-material" rid="SD1">S2</xref>). We estimated co-expression networks using CS-CORE and other methods, and compared them to the true co-expression network (<xref ref-type="fig" rid="F3">Figure 3A</xref>). In particular, when plotting the results from each method, we ordered the genes by applying hierarchical clustering to the estimated co-expression network. We found that CS-CORE was the only method that could accurately estimate co-expressions and be used to recover true clusters. The estimated co-expression networks and inferred cluster labels from other methods were strikingly inaccurate. These findings were further supported by evaluating the clustering accuracy (<xref ref-type="fig" rid="F3">Figure 3B</xref>), measured using adjusted Rand index, and the accuracy in estimating the top principal components (<xref ref-type="fig" rid="F3">Figure 3C</xref>), measured using subspace distance (<xref ref-type="bibr" rid="R5">Golub and Van Loan, 2013</xref>).</p><p id="P19">To highlight the mean-correlation bias, we computed the correlation between gene expression levels and estimated co-expression levels. As expression levels were randomly assigned independent of correlation strengths, the true correlation between gene expression and co-expression levels should be close to zero, as marked in <xref ref-type="fig" rid="F3">Figure 3D</xref>. However, we found that the co-expression levels estimated from locCSN, Pearson correlation, propr, ρ-sctransform and Spearman correlation were spuriously correlated with the mean expression level. One implication of this mean-correlation bias is that, as highly expressed genes often appear highly co-expressed with other genes as an artifact, clustering methods tend to incorrectly cluster genes with similar expression levels in a co-expression cluster and expression levels become falsely predictive of the network modules (<xref ref-type="fig" rid="F3">Figure 3E</xref>). In another data example, we demonstrated that this mean-correlation bias could also lead to spurious clustering structures on null data where genes are not co-expressed (<xref ref-type="supplementary-material" rid="SD1">figure S5</xref>).</p></sec><sec id="S7"><label>2.5</label><title>CS-CORE identified more reproducible and biologically relevant co-expressions from AD and control brain samples</title><p id="P20">We applied CS-CORE to a snRNA-seq data set collected from the prefrontal cortical regions of 12 Alzheimer’s disease (AD) patients and nine controls in <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref>. In particular, we focused our comparison with ρ-sctransform, as it gives the best overall performance in <xref ref-type="fig" rid="F1">Figure 1</xref>-<xref ref-type="fig" rid="F3">3</xref> and allows for statistical tests.</p><p id="P21">First, using samples from controls, we estimated the co-expression network among top 5,000 highly expressed genes in five major brain cell types including astrocyte (Ast), excitatory neuron (Ex), inhibitory neuron (In), oligodendrocyte (Oli) and microglia (Mic), and evaluated the reproducibility of identified co-expressions using two independent snRNA-seq data sets on prefrontal cortex from <xref ref-type="bibr" rid="R22">Mathys et al. (2019)</xref> and <xref ref-type="bibr" rid="R23">Morabito et al. (2021)</xref> (<xref ref-type="supplementary-material" rid="SD1">Section S3.3</xref>). <xref ref-type="fig" rid="F4">Figure 4A</xref> shows that the co-expressed gene pairs inferred by CS-CORE were more reproducible in <xref ref-type="bibr" rid="R22">Mathys et al. (2019)</xref> than those inferred by ρ-sctransform across different p-value cutoffs and cell types, suggesting CS-CORE has greater statistical power to detect true co-expression signals. We had similar observations for data from <xref ref-type="bibr" rid="R23">Morabito et al. (2021)</xref> (<xref ref-type="supplementary-material" rid="SD1">figure S6</xref>).</p><p id="P22">Next, by evaluating the overlap of co-expressed pairs with a database on known Transcription Factor(TF)-target gene pairs (<xref ref-type="bibr" rid="R8">Han et al., 2018</xref>), we found CS-CORE recovered more known TF-target pairs than ρ-sctransform from the inferred networks (<xref ref-type="fig" rid="F4">Figure 4B</xref>). Additionally, we extracted co-expressed gene modules by applying WGCNA (<xref ref-type="bibr" rid="R18">Langfelder and Horvath, 2008</xref>) on significantly co-expressed gene pairs, which were then evaluated using Gene Ontology (GO) enrichment analysis (<xref ref-type="bibr" rid="R46">Wu et al., 2021</xref>) (see <xref ref-type="supplementary-material" rid="SD1">Section S3.1</xref>). Our enrichment analysis used the 5,000 highly expressed genes as the background gene set, such that enrichment of any module is not attributed to its high expression levels. For microglia, the innate immune brain cells with a central role in the AD neuroinflammation mechanism (<xref ref-type="bibr" rid="R12">Heneka et al., 2015</xref>), clustering based on CS-CORE identified four modules strongly enriched for GO terms related to microglia’s functions, including defense response, chemical synaptic transmission, cytoplasmic translation and protein folding, respectively, while only two of these four functions were found enriched for modules inferred based on ρ-sctransform with less significant <italic>p</italic>-values and lower gene ratios (<xref ref-type="supplementary-material" rid="SD1">Tables S2, S3</xref>). In particular, <xref ref-type="fig" rid="F4">Figure 4C</xref> shows the estimated co-expression networks, with genes ordered by hierarchical clustering, on a subset of genes from the four GO terms. It is seen that CS-CORE accurately grouped genes into respective biological functions, with genes in the same GO function densely connected. By contrast, <italic>ρ</italic>-sctransform only partially recovered some gene modules and the estimated co-expressions are generally much weaker. Besides microglia, CS-CORE also identified gene modules that were enriched for cell-type-specific functions in astrocytes (synaptic signalling, protein folding, cellular response to hypoxia), inhibitory neurons (synaptic membrane) and oligodendrocytes (cell-cell signaling, cholesterol metabolic process), while these functions were either not or much less enriched for modules inferred based on ρ-sctransform (<xref ref-type="supplementary-material" rid="SD1">Table S2, S3</xref>). This further highlights the potential of CS-CORE in uncovering cell-type-specific biological pathways.</p><p id="P23">Finally, we constructed the differential co-expression network in microglia between AD patients and controls from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> to investigate the biological pathways dysreg-ulated in AD (see <xref ref-type="sec" rid="S16">Section 4.6</xref>). We applied clustering analysis to the differential network to extract gene modules that shared similar co-expression changes in AD and performed GO enrichment analysis. Clustering based on CS-CORE identified three differentially co-expressed gene modules enriched for cell-type-specific functional pathways that are implied in AD disease mechanisms, including protein folding (<xref ref-type="bibr" rid="R30">Roychaudhuri et al., 2009</xref>), synapse signaling transduction (Kamat et al., 2016), and protein kinase (toll-like receptors) signaling pathways (<xref ref-type="bibr" rid="R17">Landreth and Reed-Geaghan, 2009</xref>) (<xref ref-type="supplementary-material" rid="SD1">Table S4</xref>). In comparison, ρ-sctransform did not identify any differentially co-expressed module enriched with cell-type-specific biological or disease-related functions (<xref ref-type="supplementary-material" rid="SD1">Table S5</xref>).</p></sec><sec id="S8"><label>2.6</label><title>CS-CORE identified upregulated co-expressions in Interferon signalling pathway from COVID-19 blood samples</title><p id="P24">We applied CS-CORE to a scRNA-seq data set from human peripheral blood mononuclear cells (PBMC) of seven hospitalized patients with SARS-CoV-2 and six controls (<xref ref-type="bibr" rid="R45">Wilk et al., 2020</xref>) to identify biological pathways differentially regulated in COVID-19 patients.</p><p id="P25">Using samples from controls, we estimated cell-type-specific co-expressions among the top 5,000 highly expressed genes in five major immune cell types, including B cells, CD4 positive T cells, CD8 positive T cells, monocytes and natural killer (NK) cells. Using an independent scRNA-seq data set on PBMC (<xref ref-type="bibr" rid="R38">Unterman et al., 2022</xref>), we found that CS-CORE yielded a larger number of reproducible co-expressed gene pairs than ρ-sctransform across different <italic>p</italic>-value cutoffs and cell types (<xref ref-type="supplementary-material" rid="SD1">figure S7A</xref>). CS-CORE also uncovered more gene pairs that overlapped with known TF-target gene pairs and more gene modules with stronger cell-type-specific functional enrichment than ρ-sctransform across cell types through GO enrichment analysis (<xref ref-type="supplementary-material" rid="SD1">figure S7B, Tables S6-S10</xref>). For example, CS-CORE identified three co-expression modules enriched for the biological functions of B cells, including antigen processing via MHC Class II, adaptive immune response and response to inteferon-alpha (<xref ref-type="supplementary-material" rid="SD1">Table S6</xref>). In contrast, only one of these three functions was found enriched in a module inferred based on ρ-sctransform with a less significant <italic>p</italic>-value and a lower gene ratio (<xref ref-type="supplementary-material" rid="SD1">Table S9</xref>). Our results on PBMC again show that CS-CORE can recover biologically more meaningful co-expressions than other methods.</p><p id="P26">We next investigated cell-type-specific responses to SARS-CoV-2 viral infection in monocytes using a differential co-expression analysis similar to the one performed in the previous section between AD patients and controls. Clustering analysis revealed gene modules that share similar co-expression changes in monocytes in response to SARS-CoV-2. In particular, three gene modules inferred using co-expression estimates from CS-CORE were significantly enriched for immune responses based on GO enrichment analysis, including inflammatory response, virus defense response, and cellular stress response (<xref ref-type="supplementary-material" rid="SD1">Table S11</xref>). In contrast, <italic>ρ</italic>-sctransform only identified one gene module associated with virus defense response with much weaker enrichment signals (<xref ref-type="supplementary-material" rid="SD1">Table S12</xref>). In <xref ref-type="fig" rid="F5">Figure 5</xref>, we highlight a module identified by CS-CORE, which is enriched for the interferon signalling pathway (<xref ref-type="supplementary-material" rid="SD1">Table S13</xref>), a key immune signature in COVID-19 patients that has been demonstrated in multiple studies (<xref ref-type="bibr" rid="R1">Acharya et al., 2020</xref>; <xref ref-type="bibr" rid="R6">Hadjadj et al., 2020</xref>; <xref ref-type="bibr" rid="R20">Lee and Shin, 2020</xref>). While it is known that the expression levels of interferon-stimulated genes are upregulated in monocytes from COVID-19 patients, by comparing the CS-CORE estimates in monocytes between COVID-19 patients and controls, we identified upregulated co-expressions among interferon-stimulated genes, suggesting increased gene coordination in the interferon signalling pathway upon viral infection. We also found stronger co-expressions between genes in the interferon signaling and antigen presentation pathways among COVID-19 patients, suggesting stronger concerted immune responses between these two pathways. Finally, we note that this gene module also contains multiple known genes in the SARS-CoV-2 infection Reactome pathway, revealing cell-type-specific changes in co-expressions among known disease-related genes.</p></sec></sec><sec id="S9" sec-type="discussion"><label>3</label><title>Discussion</title><p id="P27">We developed a comprehensive statistical approach, CS-CORE, for estimating and testing cell-type-specific co-expressions based on scRNA-seq data. CS-CORE adopts a multivariate expression-measurement model for the observed UMI counts and a pair-wise IRLS method for estimation and testing. It does not place distributional assumptions on the underlying expression levels and can be implemented very efficiently to estimate and test co-expressions in a large network. We demonstrated the better performance of CS-CORE than other methods through both simulations and real data analyses.</p><p id="P28">Our work pointed to two potential sources of biases when inferring co-expressions from UMI counts. The first one is the varying sequencing depths across cells, which can lead to inflated false positive findings in detecting co-expressions, as a pair of independent genes may appear co-expressed as a result of the sequencing depth variations across cells. The second one is the error from the measurement process, causing the observed UMI counts to deviate from the underlying expression levels. Under the Poisson measurement model, this deviation is a function of both the expression level and the sequencing depth. When estimating the underlying co-expression level for a pair of genes, correlations between UMI counts tend to be biased towards zero as a result of the measurement errors. In our experiments, we observed such an attenuation bias in most methods we compared to, leading to inaccuracy and reduced power in estimating and detecting co-expressions. These two distinct sources of biases, when combined, cause serious issues in estimating and testing for co-expressions. As demonstrated in our analysis, no other methods can adequately address both. Our approach CS-CORE addresses them by explicitly modeling the measurement process, accounting for both varying sequencing depths and measurement errors, and estimates the first and second moments of the underlying multivariate expression model to produce estimates of co-expressions, without any specific distributional assumptions.</p><p id="P29">There has been recent work that makes cell-type-specific inferences from bulk samples leveraging cell type deconvolution techniques (<xref ref-type="bibr" rid="R14">Jin et al., 2021</xref>; <xref ref-type="bibr" rid="R41">Wang et al., 2021a</xref>). These work often aims to estimate cell-type-specific expressions and compositions in bulk samples (<xref ref-type="bibr" rid="R43">Wang et al., 2019</xref>; <xref ref-type="bibr" rid="R26">Newman et al., 2019</xref>; <xref ref-type="bibr" rid="R13">Jaakkola and Elo, 2021</xref>; <xref ref-type="bibr" rid="R3">Cai et al., 2022</xref>). In particular, a recent method CSNet (<xref ref-type="bibr" rid="R33">Su et al., 2022</xref>) focuses on estimating cell-type-specific co-expressions from bulk sample data. The rich bulk samples collected over past decades and the increasingly available scRNA-seq data together offer a great opportunity to integrate bulk samples and single cell data to draw cell-type-specific inferences of co-expressions. The proposed method CS-CORE provides a useful tool in developing methods for such integrative analyses.</p><p id="P30">In CS-CORE, we have assumed that gene expressions from cells of the same cell type follow the same distribution. This assumption may not hold when the cells are collected from individuals with different genetic, demographic and clinical characteristics. For example, there is a growing interest in studying the genetic basis of cell-type-specific gene expression and co-expression differences across individuals using single cell data, and such population level single cell data are becoming increasingly available (<xref ref-type="bibr" rid="R47">Young et al., 2021</xref>; <xref ref-type="bibr" rid="R25">Nathan et al., 2022</xref>). As an important next step, we plan to extend the CS-CORE framework to infer individualized cell-type-specific co-expression networks and to study the differences in gene co-expressions across genotypes and conditions, shedding light on individualized and context-specific biological functions and pathways.</p><p id="P31">In summary, the CS-CORE method introduced in this article is statistically sound and computationally efficient. Compared to the other methods, it generates more reproducible and biologically more relevant cell-type-specific co-expression networks across multiple scRNA-seq data sets. With the rapid increase of scRNA-seq studies, we believe that CS-CORE offers a powerful and robust statistical tool to infer cell-type-specific co-expression networks to characterize biological pathways and molecular mechanisms at the cell type level.</p></sec><sec id="S10" sec-type="methods"><label>4</label><title>Methods</title><sec id="S11"><label>4.1</label><title>CS-CORE method</title><p id="P32">Under the expression-measurement model defined in (<xref ref-type="disp-formula" rid="FD1">1</xref>), it holds that <inline-formula><mml:math id="M9"><mml:mrow><mml:mtext>𝔼</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>𝔼</mml:mtext><mml:mspace width="0.2em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula>. This motivates us to estimate <italic>μ<sub>j</sub></italic>’s and (<italic>σ<sub>jj</sub></italic>′)<sub><italic>p</italic>×<italic>p</italic></sub> via the following set of regression equations: <disp-formula id="FD2"><label>(2)</label><mml:math id="M10"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>ϵ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <italic>ϵ<sub>ij</sub></italic>, <italic>η<sub>ij</sub></italic>, and <inline-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>are independent and mean-zero error variables for all <italic>i</italic>, <italic>j</italic>, <inline-formula><mml:math id="M12"><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>. Specifically, given UMI counts <italic>x<sub>ij</sub></italic>’s and sequencing depths <italic>s<sub>i</sub></italic>’s, the mean parameter <italic>μ<sub>j</sub></italic> is estimated via <inline-formula><mml:math id="M13"><mml:mrow><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>μ</mml:mi></mml:msub><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>,where <italic>w<sub>ij</sub></italic> is the weight for cell <italic>i</italic> to be determined. Given the estimates <italic>μ^<sub>j</sub></italic>’s, we estimate <italic>σ<sub>jj</sub></italic> and <italic>σ<sub>jj</sub></italic> with <inline-formula><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>σ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M15"><mml:mrow><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mtext>g</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>σ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, respectively, where <italic>h<sub>ij</sub></italic> and <inline-formula><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are weights to be determined. These weighted least squares can be computed very efficiently.</p><p id="P33">In CS-CORE, we carefully select and update the weights via an IRLS procedure, such that the weighted least squares estimators are statistically efficient; see the detailed procedure in <xref ref-type="supplementary-material" rid="SD1">Algorithm S1</xref>. The most ideal weights, in terms of statistical efficiency, should be the reciprocal of the variances of the error variables in (<xref ref-type="disp-formula" rid="FD2">2</xref>). Hence, we set <inline-formula><mml:math id="M17"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo>ϵ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which is updated in each step of the IRLS estimation. The analytical forms of Var(<italic>η<sub>ij</sub></italic>) and Var <inline-formula><mml:math id="M18"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are difficult to derive as we do not place distributional assumptions on <italic>z<sub>ij</sub></italic>. Given weights <italic>w<sub>ij</sub></italic>’s for the mean parameter estimation, we set weights for variance and covariance estimation as <inline-formula><mml:math id="M19"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, respectively, which yield good performance in our experiments and the IRLS procedure typically converges within five iterations. In practice, we add a regularization step to the variance parameters <italic>σ<sub>jj</sub></italic>’s used in calculating the weights, as their estimates can be variable, leading to highly variable weights.</p><p id="P34">Next, we develop a statistical test to assess whether a gene pair have independent expression levels. Under model (<xref ref-type="disp-formula" rid="FD1">1</xref>) and when <italic>z<sub>jj</sub></italic> and <inline-formula><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are independent, <inline-formula><mml:math id="M22"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> Letting <inline-formula><mml:math id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be estimated with true <italic>µ<sub>j</sub></italic>’s, we define the test statistic <inline-formula><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> which can be calculated as <disp-formula id="FD3"><mml:math id="M25"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mi>∑</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mi>∑</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula> It then follows that <inline-formula><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under the null hypothesis that <italic>z<sub>ij</sub></italic> and <inline-formula><mml:math id="M27"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are independent. This result allows us to directly compute <italic>p</italic>-values by plugging in IRLS estimated <italic>µ<sub>j</sub></italic>’s and <italic>σ<sub>jj</sub></italic>’s, all of which are consistent weighted least squares estimators.</p></sec><sec id="S12"><label>4.2</label><title>Other co-expression estimation and testing methods using scRNA-seq data</title><p id="P35">We compared CS-CORE with eight other methods for inferring gene co-expression from single cell data, including locCSN (<xref ref-type="bibr" rid="R41">Wang et al., 2021</xref>b), Noise Regularization (<xref ref-type="bibr" rid="R49">Zhang et al., 2021</xref>), Normalisr (<xref ref-type="bibr" rid="R41">Wang, 2021</xref>), Pearson correlation, propr (<xref ref-type="bibr" rid="R27">Quinn et al., 2017</xref>), <italic>ρ</italic>-sctransform, Spearman correlation and SpQN (<xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>). The method locCSN was applied on log normalized data log(<italic>x<sub>ij</sub></italic>/<italic>s<sub>i</sub></italic> + 1) and computed with the Python implementation provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/xuranw/locCSN">https://github.com/xuranw/locCSN</ext-link>. While locCSN estimates one network per cell, we followed the authors’ instructions to aggregate cell-specific co-expressions into cell-type-specific co-expressions, as stated in Wang et al. (<xref ref-type="bibr" rid="R41">Wang et al., 2021</xref>b) that averaging provides stable estimates of the network structure. The method propr refers to <italic>ρ<sub>p</sub></italic> in <xref ref-type="bibr" rid="R27">Quinn et al. (2017)</xref> and was calculated with the R package ‘propR’ (v.4.2.6). For <italic>ρ</italic>-sctransform, we computed the residuals of sctransform using R package Seurat (v.4.0.3) and evaluated Pearson correlations between the residuals. The Spearman (Pearson) correlation was calculated on log normalized expression data using the R package ‘stats’ (v.4.1.3). Noise Regularization (<xref ref-type="bibr" rid="R49">Zhang et al., 2021</xref>) was implemented from <ext-link ext-link-type="uri" xlink:href="https://github.com/RuoyuZhang/NoiseRegularization">https://github.com/RuoyuZhang/NoiseRegularization</ext-link>, Normalisr (<xref ref-type="bibr" rid="R41">Wang, 2021</xref>) was computed with the Python implementation from <ext-link ext-link-type="uri" xlink:href="https://github.com/lingfeiwang/normalisr">https://github.com/lingfeiwang/normalisr</ext-link> (v.1.0.0) and SpQN (<xref ref-type="bibr" rid="R44">Wang et al., 2022</xref>) was computed with R package ‘SpQN’ (v.1.6.0).</p><p id="P36">Among the above eight methods, statistical tests for co-expressions are possible for Noise Regularization, Normalisr, Pearson correlation, <italic>ρ</italic>-sctransform and Spearman correlation. Specifically, test statistics for Noise regularization, Pearson, <italic>ρ</italic>-sctransform and Spearman were calculated as <inline-formula><mml:math id="M28"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> given the correlation estimate <italic>r</italic> and two-sided <italic>p</italic>-values were evaluated under the standard normal distribution. The <italic>p</italic>-values for Normalisr were computed using the online code provided for its implementation.</p></sec><sec id="S13"><label>4.3</label><title>Experiments with permuted scRNA-seq data</title><p id="P37">To generate null data sets from a given scRNA-seq data set with co-expression levels at or close to zero among all gene pairs while preserving gene expression levels, we first calculated normalized expression level for each gene <italic>j</italic> in cell <italic>i</italic>, written as <italic>y<sub>ij</sub></italic> = <italic>x<sub>ij</sub>/s<sub>i</sub></italic>. Then, for each gene <italic>j</italic>, we randomly permuted the normalized expressions <italic>(y<sub>ij</sub>)<sub>i=1,…,n</sub></italic> across n cells. After permutation, gene expressions were decorrelated and no gene pairs were expected to coexpress. Finally, the UMI count of gene <italic>j</italic> from cell <italic>i</italic> in the permuted data was calculated by sampling from Poisson <inline-formula><mml:math id="M29"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the normalized expression level after permutation and <italic>t<sub>i</sub></italic> is the desired sequencing depth in cell <italic>i</italic>. For the varying and constant sequencing depth settings in <xref ref-type="fig" rid="F1">Figure 1</xref>, we set <italic>t<sub>i</sub></italic> to the observed sequencing depth <italic>s<sub>i</sub></italic> and median(s<sub>1</sub>,…, <italic>s<sub>n</sub>),</italic> respectively.</p><p id="P38">For numerical results in <xref ref-type="fig" rid="F1">Figure 1</xref> and <xref ref-type="supplementary-material" rid="SD1">Figure S2</xref>, we used the snRNA-seq data from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> and selected excitatory neurons from control subjects. The distribution of sequencing depths is long-tailed with a median of 5,833 (<xref ref-type="supplementary-material" rid="SD1">Figure S8</xref>). We randomly sampled 1,000 cells and sampled 500 genes from the top 5,000 highly expressed genes with probabilities proportional to the inverse density of expression levels. This ensures that the sampled genes could cover the range of expression levels. In the x-axis of <xref ref-type="fig" rid="F1">Figure 1</xref>, we plotted expression levels at the scale of log<sub>10</sub>(<italic>µ<sub>j</sub></italic>) + 3.</p></sec><sec id="S14"><label>4.4</label><title>A simple illustration of the expression-level-dependent attenuation bias</title><p id="P39">To illustrate how errors from the Poisson measurement model in (<xref ref-type="disp-formula" rid="FD1">1</xref>) can bias co-expression estimates, we conduct a short analysis under a much simplified case that directly calculates Pearson correlations of UMI counts. The analysis is similar to that in <xref ref-type="bibr" rid="R44">Wang et al. (2022)</xref>, though <italic>s<sub>i</sub></italic> was not considered there. From (<xref ref-type="disp-formula" rid="FD1">1</xref>) and for genes <italic>j</italic>, <inline-formula><mml:math id="M31"><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> we have <disp-formula id="FD4"><label>(3)</label><mml:math id="M32"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>𝔼</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mtext>𝔼</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>𝔼</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mtext>CV</mml:mtext></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mtext>CV</mml:mtext></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where CV<italic><sub>j</sub></italic> is the coefficient of variation of gene <italic>j</italic> defined as <inline-formula><mml:math id="M33"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. To measure the true correlation <inline-formula><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the correlation based on UMI counts <italic>x<sub>ij</sub></italic> and <inline-formula><mml:math id="M35"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is always biased towards zero, as <inline-formula><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.2em"/><mml:mtext>when</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We refer to <italic>a<sub>ij</sub></italic>, derived under the Poisson measurement model in (<xref ref-type="disp-formula" rid="FD1">1</xref>), as the attenuation factor in this analysis.</p><p id="P40">When CV<italic><sub>j</sub></italic>’s are fixed, the attenuation factor <italic>a<sub>ij</sub></italic> is closer to 1 for highly expressed genes with a larger <italic>µ<sub>j</sub></italic>. Correspondingly, correlations are more accurately estimated for highly expressed genes and more attenuated for lowly expressed genes, assuming <italic>s<sub>i</sub></italic>’s do not vary across cells. Based on a real snRNA-seq data set from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref>, we indeed observed that the estimated <italic>a<sub>ij</sub></italic> approached 1 as the gene expression level increased (<xref ref-type="supplementary-material" rid="SD1">Figure S9</xref>). With <italic>s<sub>i</sub></italic>’s varying across cells, the UMI counts for a pair of genes across cells are not identically distributed. In this case, it is difficult to analytically demonstrate the combined effect of the attenuation bias and the varying sequencing depths on co-expression estimation.</p></sec><sec id="S15"><label>4.5</label><title>Simulating from the multivariate expression-measurement model</title><p id="P41">To simulate gene expression data from model (<xref ref-type="disp-formula" rid="FD1">1</xref>), we combine a marginal negative binomial model and a copula-based approach that can simulate multivariate count data following a pre-specified co-expression matrix.</p><p id="P42">We specified the distribution of true expression level <italic>z<sub>ij</sub></italic> to be Gamma(<italic>α<sub>j</sub>, β<sub>j</sub></italic>) where <italic>µ<sub>j</sub></italic> = <italic>α<sub>j</sub>β<sub>j</sub></italic> and <inline-formula><mml:math id="M37"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> correspond to the marginal mean and variance in (<xref ref-type="disp-formula" rid="FD1">1</xref>). Conditional on <italic>z<sub>ij</sub></italic>, we simulated counts <italic>x<sub>ij</sub></italic> from Poisson(<italic>s<sub>i</sub>z<sub>ij</sub></italic>) independently for cell <italic>i</italic> and gene <italic>j.</italic> Marginally, this Poisson-Gamma mixture is equivalent to a negative binomial model on <italic>x<sub>ij</sub></italic>, which is commonly used to model droplet-based single cell data (<xref ref-type="bibr" rid="R28">Risso et al., 2018</xref>; <xref ref-type="bibr" rid="R7">Hafemeister and Satija, 2019</xref>; <xref ref-type="bibr" rid="R35">Svensson, 2020</xref>; <xref ref-type="bibr" rid="R10">He et al., 2021</xref>). In our simulations, <italic>µ<sub>j</sub>, σ<sub>jj</sub></italic> and <italic>s<sub>i</sub></italic> are estimated or sampled from real data (see <xref ref-type="supplementary-material" rid="SD1">Section S2</xref>). Next, given a <italic>p</italic>×<italic>p</italic> correlation matrix <italic>R</italic>, we adopted a Gaussian copula to simulate correlated Gamma random variables (<xref ref-type="bibr" rid="R36">Tian et al., 2021</xref>; <xref ref-type="bibr" rid="R34">Sun et al., 2021</xref>). In particular, we first simulated samples (<italic>v</italic><sub><italic>i</italic>1</sub>,…, <italic>v<sub>ip</sub></italic>) from a multivariate normal distribution with mean 0 and correlation <italic>R</italic> and then computed <inline-formula><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Φ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where Φ(⋅) is the cumulative distribution function (CDF) of a standard normal distribution and <italic>F<sub>j</sub></italic>(⋅) is the CDF of Gamma(<italic>α<sub>j</sub>, β<sub>j</sub></italic>). In <xref ref-type="fig" rid="F2">Figure 2B</xref>, the matrix R was estimated from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> and in <xref ref-type="fig" rid="F3">Figure 3A</xref>, the modular matrix <italic>R</italic> was generated from a network model. These details can be found in <xref ref-type="supplementary-material" rid="SD1">Section S2</xref>.</p></sec><sec id="S16"><label>4.6</label><title>Differential co-expression analysis</title><p id="P43">For differential co-expression analysis, we first estimated co-expression networks from the disease and control groups separately. For the group with more cells, we randomly sampled a subset of cells such that the two groups had the same number of cells when estimating co-expressions. For each gene pair, we calculated the difference between co-expression estimates and assessed the statistical significance using a permutation test, where we randomly permuted the group labels 100 times and built a null distribution of differences in co-expressions. We then applied WGCNA (<xref ref-type="bibr" rid="R18">Langfelder and Horvath, 2008</xref>) to the significantly differentially co-expressed pairs (BH-adjusted <italic>p</italic>-values&lt;0.05) with the soft-thresholding power set to 1 and extracted differentially co-expressed modules.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>supplementary_materials</label><media xlink:href="EMS158592-supplement-supplementary_materials.pdf" mimetype="application" mime-subtype="pdf" id="d33aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S17"><label>6</label><title>Acknowledgements</title><p>Zhang’s research is supported by NSF DMS-2015190 and DMS-2210469. Cai’s research is supported in part by DOD W81XWH2110019. Su, Xu, Shan, and Zhao’s research is supported in part by NIH R01 GM134005 and R56 AG074015.</p></ack><sec id="S18" sec-type="data-availability"><label>5</label><title>Data Availability</title><p id="P44">All data used in this work are publicly available, and the description, accession numbers and links of each data set are in <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>. Codes that implement CS-CORE are covered by the MIT License and are available at GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChangSuBiostats/CS-CORE">https://github.com/ChangSuBiostats/CS-CORE</ext-link>.</p></sec><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acharya</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Gack</surname><given-names>MU</given-names></name></person-group><article-title>Dysregulation of type I interferon responses in COVID-19</article-title><source>Nature Reviews Immunology</source><year>2020</year><volume>20</volume><fpage>397</fpage><lpage>398</lpage><pub-id pub-id-type="pmcid">PMC7249038</pub-id><pub-id pub-id-type="pmid">32457522</pub-id><pub-id pub-id-type="doi">10.1038/s41577-020-0346-x</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Box</surname><given-names>A</given-names></name><name><surname>DeLay</surname><given-names>M</given-names></name><name><surname>Tighe</surname><given-names>S</given-names></name><name><surname>Chittur</surname><given-names>SV</given-names></name><name><surname>Bergeron</surname><given-names>A</given-names></name><name><surname>Cochran</surname><given-names>M</given-names></name><name><surname>Lopez</surname><given-names>P</given-names></name><name><surname>Meyer</surname><given-names>EM</given-names></name><name><surname>Saluk</surname><given-names>A</given-names></name><name><surname>Thornton</surname><given-names>S</given-names></name><etal/></person-group><article-title>Evaluating the effects of cell sorting on gene expression</article-title><source>Journal of biomolecular techniques: JBT</source><year>2020</year><volume>31</volume><fpage>100</fpage><pub-id pub-id-type="pmcid">PMC7497499</pub-id><pub-id pub-id-type="pmid">32982601</pub-id><pub-id pub-id-type="doi">10.7171/jbt.2020-3103-004</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Su</surname><given-names>C</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><article-title>Statistical Inference of Cell-type Proportions Estimated from Bulk Expression Data</article-title><source>arXiv preprint</source><year>2022</year><elocation-id>arXiv:2209.04038</elocation-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Ballouz</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name></person-group><article-title>Exploiting single-cell expression to characterize co-expression replicability</article-title><source>Genome biology</source><year>2016</year><volume>17</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="pmcid">PMC4862082</pub-id><pub-id pub-id-type="pmid">27165153</pub-id><pub-id pub-id-type="doi">10.1186/s13059-016-0964-6</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>GH</given-names></name><name><surname>Van Loan</surname><given-names>CF</given-names></name></person-group><source>Matrix computations</source><year>2013</year><publisher-name>JHU press</publisher-name></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadjadj</surname><given-names>J</given-names></name><name><surname>Yatim</surname><given-names>N</given-names></name><name><surname>Barnabei</surname><given-names>L</given-names></name><name><surname>Corneau</surname><given-names>A</given-names></name><name><surname>Boussier</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>N</given-names></name><name><surname>Péré</surname><given-names>H</given-names></name><name><surname>Charbit</surname><given-names>B</given-names></name><name><surname>Bondet</surname><given-names>V</given-names></name><name><surname>Chenevier-Gobeaux</surname><given-names>C</given-names></name><etal/></person-group><article-title>Impaired type I interferon activity and inflammatory responses in severe COVID-19 patients</article-title><source>Science</source><year>2020</year><volume>369</volume><fpage>718</fpage><lpage>724</lpage><pub-id pub-id-type="pmcid">PMC7402632</pub-id><pub-id pub-id-type="pmid">32661059</pub-id><pub-id pub-id-type="doi">10.1126/science.abc6027</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Normalization and variance stabilization of singlecell RNA-seq data using regularized negative binomial regression</article-title><source>Genome biology</source><year>2019</year><volume>20</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmcid">PMC6927181</pub-id><pub-id pub-id-type="pmid">31870423</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1874-1</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>H</given-names></name><name><surname>Cho</surname><given-names>J-W</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Yun</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Bae</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>CY</given-names></name><name><surname>Lee</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>E</given-names></name><etal/></person-group><article-title>TRRUST v2: an expanded reference database of human and mouse transcriptional regulatory interactions</article-title><source>Nucleic acids research</source><year>2018</year><volume>46</volume><fpage>D380</fpage><lpage>D386</lpage><pub-id pub-id-type="pmcid">PMC5753191</pub-id><pub-id pub-id-type="pmid">29087512</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkx1013</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names><suffix>III</suffix></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Lee</surname><given-names>MJ</given-names></name><name><surname>Wilk</surname><given-names>AJ</given-names></name><name><surname>Darby</surname><given-names>C</given-names></name><name><surname>Zager</surname><given-names>M</given-names></name><etal/></person-group><article-title>Integrated analysis of multimodal singlecell data</article-title><source>Cell</source><year>2021</year><volume>184</volume><fpage>3573</fpage><lpage>3587</lpage><pub-id pub-id-type="pmcid">PMC8238499</pub-id><pub-id pub-id-type="pmid">34062119</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>L</given-names></name><name><surname>Davila-Velderrain</surname><given-names>J</given-names></name><name><surname>Sumida</surname><given-names>TS</given-names></name><name><surname>Hafler</surname><given-names>DA</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><name><surname>Kulminski</surname><given-names>AM</given-names></name></person-group><article-title>NEBULA is a fast negative binomial mixed model for differential or co-expression analysis of large-scale multi-subject single-cell data</article-title><source>Nature Communications Biology</source><year>2021</year><volume>4</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC8155058</pub-id><pub-id pub-id-type="pmid">34040149</pub-id><pub-id pub-id-type="doi">10.1038/s42003-021-02146-6</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heintzman</surname><given-names>ND</given-names></name><name><surname>Hon</surname><given-names>GC</given-names></name><name><surname>Hawkins</surname><given-names>RD</given-names></name><name><surname>Kheradpour</surname><given-names>P</given-names></name><name><surname>Stark</surname><given-names>A</given-names></name><name><surname>Harp</surname><given-names>LF</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Lee</surname><given-names>LK</given-names></name><name><surname>Stuart</surname><given-names>RK</given-names></name><name><surname>Ching</surname><given-names>CW</given-names></name><etal/></person-group><article-title>Histone modifications at human enhancers reflect global cell-type-specific gene expression</article-title><source>Nature</source><year>2009</year><volume>459</volume><fpage>108</fpage><lpage>112</lpage><pub-id pub-id-type="pmcid">PMC2910248</pub-id><pub-id pub-id-type="pmid">19295514</pub-id><pub-id pub-id-type="doi">10.1038/nature07829</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heneka</surname><given-names>MT</given-names></name><name><surname>Carson</surname><given-names>MJ</given-names></name><name><surname>El Khoury</surname><given-names>J</given-names></name><name><surname>Landreth</surname><given-names>GE</given-names></name><name><surname>Brosseron</surname><given-names>F</given-names></name><name><surname>Feinstein</surname><given-names>DL</given-names></name><name><surname>Jacobs</surname><given-names>AH</given-names></name><name><surname>Wyss-Coray</surname><given-names>T</given-names></name><name><surname>Vitorica</surname><given-names>J</given-names></name><name><surname>Ransohoff</surname><given-names>RM</given-names></name><etal/></person-group><article-title>Neuroinflammation in Alzheimer’s disease</article-title><source>The Lancet Neurology</source><year>2015</year><volume>14</volume><fpage>388</fpage><lpage>405</lpage><pub-id pub-id-type="pmcid">PMC5909703</pub-id><pub-id pub-id-type="pmid">25792098</pub-id><pub-id pub-id-type="doi">10.1016/S1474-4422(15)70016-5</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaakkola</surname><given-names>MK</given-names></name><name><surname>Elo</surname><given-names>LL</given-names></name></person-group><article-title>Computational deconvolution to estimate cell typespecific gene expression from bulk data</article-title><source>NAR genomics and bioinformatics</source><year>2021</year><volume>3</volume><elocation-id>lqaa110</elocation-id><pub-id pub-id-type="pmcid">PMC7803005</pub-id><pub-id pub-id-type="pmid">33575652</pub-id><pub-id pub-id-type="doi">10.1093/nargab/lqaa110</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Lin</surname><given-names>D-Y</given-names></name><name><surname>Sun</surname><given-names>W</given-names></name></person-group><article-title>Cell-type-aware analysis of RNA-seq data</article-title><source>Nature Computational Science</source><year>2021</year><volume>1</volume><fpage>253</fpage><lpage>261</lpage><pub-id pub-id-type="pmcid">PMC8697413</pub-id><pub-id pub-id-type="pmid">34957416</pub-id><pub-id pub-id-type="doi">10.1038/s43588-021-00055-6</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamat</surname><given-names>PK</given-names></name><name><surname>Kalani</surname><given-names>A</given-names></name><name><surname>Rai</surname><given-names>S</given-names></name><name><surname>Swarnkar</surname><given-names>S</given-names></name><name><surname>Tota</surname><given-names>S</given-names></name><name><surname>Nath</surname><given-names>C</given-names></name><name><surname>Tyagi</surname><given-names>N</given-names></name></person-group><article-title>Mechanism of oxidative stress and synapse dysfunction in the pathogenesis of Alzheimer’s disease: understanding the therapeutics strategies</article-title><source>Molecular neurobiology</source><year>2016</year><volume>53</volume><fpage>648</fpage><lpage>661</lpage><pub-id pub-id-type="pmcid">PMC4470891</pub-id><pub-id pub-id-type="pmid">25511446</pub-id><pub-id pub-id-type="doi">10.1007/s12035-014-9053-6</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koplev</surname><given-names>S</given-names></name><name><surname>Seldin</surname><given-names>M</given-names></name><name><surname>Sukhavasi</surname><given-names>K</given-names></name><name><surname>Ermel</surname><given-names>R</given-names></name><name><surname>Pang</surname><given-names>S</given-names></name><name><surname>Zeng</surname><given-names>L</given-names></name><name><surname>Bankier</surname><given-names>S</given-names></name><name><surname>Di Narzo</surname><given-names>A</given-names></name><name><surname>Cheng</surname><given-names>H</given-names></name><name><surname>Meda</surname><given-names>V</given-names></name><etal/></person-group><article-title>A mechanistic framework for cardiometabolic and coronary artery diseases</article-title><source>Nature Cardiovascular Research</source><year>2022</year><volume>1</volume><fpage>85</fpage><lpage>100</lpage><pub-id pub-id-type="pmcid">PMC9583458</pub-id><pub-id pub-id-type="pmid">36276926</pub-id><pub-id pub-id-type="doi">10.1038/s44161-021-00009-1</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Landreth</surname><given-names>GE</given-names></name><name><surname>Reed-Geaghan</surname><given-names>EG</given-names></name></person-group><article-title>Toll-like receptors in Alzheimer’s disease</article-title><source>Toll-like receptors: Roles in infection and neuropathology</source><year>2009</year><fpage>137</fpage><lpage>153</lpage></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title><source>BMC bioinformatics</source><year>2008</year><volume>9</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC2631488</pub-id><pub-id pub-id-type="pmid">19114008</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lau</surname><given-names>S-F</given-names></name><name><surname>Cao</surname><given-names>H</given-names></name><name><surname>Fu</surname><given-names>AK</given-names></name><name><surname>IP</surname><given-names>NY</given-names></name></person-group><article-title>Single-nucleus transcriptome analysis reveals dysregulation of angiogenic endothelial cells and neuroprotective glia in Alzheimer’s disease</article-title><source>Proceedings of the National Academy of Sciences</source><year>2020</year><volume>117</volume><fpage>25800</fpage><lpage>25809</lpage><pub-id pub-id-type="pmcid">PMC7568283</pub-id><pub-id pub-id-type="pmid">32989152</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2008762117</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JS</given-names></name><name><surname>Shin</surname><given-names>E-C</given-names></name></person-group><article-title>The type I interferon response in COVID-19: implications for treatment</article-title><source>Nature Reviews Immunology</source><year>2020</year><volume>20</volume><fpage>585</fpage><lpage>586</lpage><pub-id pub-id-type="pmcid">PMC8824445</pub-id><pub-id pub-id-type="pmid">32788708</pub-id><pub-id pub-id-type="doi">10.1038/s41577-020-00429-3</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome biology</source><year>2014</year><volume>15</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC4302049</pub-id><pub-id pub-id-type="pmid">25516281</pub-id><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathys</surname><given-names>H</given-names></name><name><surname>Davila-Velderrain</surname><given-names>J</given-names></name><name><surname>Peng</surname><given-names>Z</given-names></name><name><surname>Gao</surname><given-names>F</given-names></name><name><surname>Mohammadi</surname><given-names>S</given-names></name><name><surname>Young</surname><given-names>JZ</given-names></name><name><surname>Menon</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Abdurrob</surname><given-names>F</given-names></name><name><surname>Jiang</surname><given-names>X</given-names></name><etal/></person-group><article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title><source>Nature</source><year>2019</year><volume>570</volume><fpage>332</fpage><lpage>337</lpage><pub-id pub-id-type="pmcid">PMC6865822</pub-id><pub-id pub-id-type="pmid">31042697</pub-id><pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morabito</surname><given-names>S</given-names></name><name><surname>Miyoshi</surname><given-names>E</given-names></name><name><surname>Michael</surname><given-names>N</given-names></name><name><surname>Shahin</surname><given-names>S</given-names></name><name><surname>Martini</surname><given-names>AC</given-names></name><name><surname>Head</surname><given-names>E</given-names></name><name><surname>Silva</surname><given-names>J</given-names></name><name><surname>Leavy</surname><given-names>K</given-names></name><name><surname>Perez-Rosendahl</surname><given-names>M</given-names></name><name><surname>Swarup</surname><given-names>V</given-names></name></person-group><article-title>Single-nucleus chromatin accessibility and transcriptomic characterization of Alzheimer’s disease</article-title><source>Nature Genetics</source><year>2021</year><volume>53</volume><fpage>1143</fpage><lpage>1155</lpage><pub-id pub-id-type="pmcid">PMC8766217</pub-id><pub-id pub-id-type="pmid">34239132</pub-id><pub-id pub-id-type="doi">10.1038/s41588-021-00894-z</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mostafavi</surname><given-names>S</given-names></name><name><surname>Gaiteri</surname><given-names>C</given-names></name><name><surname>Sullivan</surname><given-names>SE</given-names></name><name><surname>White</surname><given-names>CC</given-names></name><name><surname>Tasaki</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Taga</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>H-U</given-names></name><name><surname>Patrick</surname><given-names>E</given-names></name><name><surname>Komashko</surname><given-names>V</given-names></name><etal/></person-group><article-title>A molecular network of the aging human brain provides insights into the pathology and cognitive decline of Alzheimer’s disease</article-title><source>Nature neuroscience</source><year>2018</year><volume>21</volume><fpage>811</fpage><lpage>819</lpage><pub-id pub-id-type="pmcid">PMC6599633</pub-id><pub-id pub-id-type="pmid">29802388</pub-id><pub-id pub-id-type="doi">10.1038/s41593-018-0154-9</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nathan</surname><given-names>A</given-names></name><name><surname>Asgari</surname><given-names>S</given-names></name><name><surname>Ishigaki</surname><given-names>K</given-names></name><name><surname>Valencia</surname><given-names>C</given-names></name><name><surname>Amariuta</surname><given-names>T</given-names></name><name><surname>Luo</surname><given-names>Y</given-names></name><name><surname>Beynor</surname><given-names>JI</given-names></name><name><surname>Baglaenko</surname><given-names>Y</given-names></name><name><surname>Suliman</surname><given-names>S</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><etal/></person-group><article-title>Single-cell eQTL models reveal dynamic T cell state dependence of disease loci</article-title><source>Nature</source><year>2022</year><volume>606</volume><fpage>120</fpage><lpage>128</lpage><pub-id pub-id-type="pmid">35545678</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>AM</given-names></name><name><surname>Steen</surname><given-names>CB</given-names></name><name><surname>Liu</surname><given-names>CL</given-names></name><name><surname>Gentles</surname><given-names>AJ</given-names></name><name><surname>Chaudhuri</surname><given-names>AA</given-names></name><name><surname>Scherer</surname><given-names>F</given-names></name><name><surname>Khodadoust</surname><given-names>MS</given-names></name><name><surname>Esfahani</surname><given-names>MS</given-names></name><name><surname>Luca</surname><given-names>BA</given-names></name><name><surname>Steiner</surname><given-names>D</given-names></name><etal/></person-group><article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title><source>Nature biotechnology</source><year>2019</year><volume>37</volume><fpage>773</fpage><lpage>782</lpage><pub-id pub-id-type="pmcid">PMC6610714</pub-id><pub-id pub-id-type="pmid">31061481</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>TP</given-names></name><name><surname>Richardson</surname><given-names>MF</given-names></name><name><surname>Lovell</surname><given-names>D</given-names></name><name><surname>Crowley</surname><given-names>TM</given-names></name></person-group><article-title>propr: an R-package for identifying proportionally abundant features using compositional data analysis</article-title><source>Scientific reports</source><year>2017</year><volume>7</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC5701231</pub-id><pub-id pub-id-type="pmid">29176663</pub-id><pub-id pub-id-type="doi">10.1038/s41598-017-16520-0</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Perraudeau</surname><given-names>F</given-names></name><name><surname>Gribkova</surname><given-names>S</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Vert</surname><given-names>J-P</given-names></name></person-group><article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title><source>Nature Communications</source><year>2018</year><volume>9</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC5773593</pub-id><pub-id pub-id-type="pmid">29348443</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-02554-5</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="pmcid">PMC2796818</pub-id><pub-id pub-id-type="pmid">19910308</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roychaudhuri</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>M</given-names></name><name><surname>Hoshi</surname><given-names>MM</given-names></name><name><surname>Teplow</surname><given-names>DB</given-names></name></person-group><article-title>Amyloid β-protein assembly and Alzheimer disease</article-title><source>Journal of Biological Chemistry</source><year>2009</year><volume>284</volume><fpage>4749</fpage><lpage>4753</lpage><pub-id pub-id-type="pmcid">PMC3837440</pub-id><pub-id pub-id-type="pmid">18845536</pub-id><pub-id pub-id-type="doi">10.1074/jbc.R800036200</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saccenti</surname><given-names>E</given-names></name><name><surname>Hendriks</surname><given-names>MH</given-names></name><name><surname>Smilde</surname><given-names>AK</given-names></name></person-group><article-title>Corruption of the Pearson correlation coefficient by measurement error and its estimation bias, and correction under different error models</article-title><source>Scientific reports</source><year>2020</year><volume>10</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="pmcid">PMC6965177</pub-id><pub-id pub-id-type="pmid">31949233</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-57247-4</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkar</surname><given-names>A</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name></person-group><article-title>Separating measurement and expression models clarifies confusion in single-cell RNA sequencing analysis</article-title><source>Nature genetics</source><year>2021</year><volume>53</volume><fpage>770</fpage><lpage>777</lpage><pub-id pub-id-type="pmcid">PMC8370014</pub-id><pub-id pub-id-type="pmid">34031584</pub-id><pub-id pub-id-type="doi">10.1038/s41588-021-00873-4</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><article-title>Estimating cell-type-specific gene co-expression networks from bulk gene expression data with an application to Alzheimer’s disease</article-title><source>bioRxiv</source><year>2022</year></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>T</given-names></name><name><surname>Song</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>WV</given-names></name><name><surname>Li</surname><given-names>JJ</given-names></name></person-group><article-title>scDesign2: a transparent simulator that generates high-fidelity single-cell gene expression count data with gene correlations captured</article-title><source>Genome biology</source><year>2021</year><volume>22</volume><fpage>1</fpage><lpage>37</lpage><pub-id pub-id-type="pmcid">PMC8147071</pub-id><pub-id pub-id-type="pmid">34034771</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02367-2</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name></person-group><article-title>Droplet scRNA-seq is not zero-inflated</article-title><source>Nature Biotechnology</source><year>2020</year><volume>38</volume><fpage>147</fpage><lpage>150</lpage><pub-id pub-id-type="pmid">31937974</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name></person-group><article-title>ESCO: single cell expression simulation incorporating gene co-expression</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><fpage>2374</fpage><lpage>2381</lpage><pub-id pub-id-type="pmcid">PMC8388018</pub-id><pub-id pub-id-type="pmid">33624750</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab116</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Townes</surname><given-names>FW</given-names></name><name><surname>Hicks</surname><given-names>SC</given-names></name><name><surname>Aryee</surname><given-names>MJ</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>Feature selection and dimension reduction for single-cell RNA-Seq based on a multinomial model</article-title><source>Genome biology</source><year>2019</year><volume>20</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC6927135</pub-id><pub-id pub-id-type="pmid">31870412</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1861-6</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unterman</surname><given-names>A</given-names></name><name><surname>Sumida</surname><given-names>TS</given-names></name><name><surname>Nouri</surname><given-names>N</given-names></name><name><surname>Yan</surname><given-names>X</given-names></name><name><surname>Zhao</surname><given-names>AY</given-names></name><name><surname>Gasque</surname><given-names>V</given-names></name><name><surname>Schupp</surname><given-names>JC</given-names></name><name><surname>Asashima</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Cosme</surname><given-names>C</given-names></name><etal/></person-group><article-title>Single-cell multi-omics reveals dyssyn-chrony of the innate and adaptive immune system in progressive COVID-19</article-title><source>Nature communications</source><year>2022</year><volume>13</volume><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="pmcid">PMC8782894</pub-id><pub-id pub-id-type="pmid">35064122</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-27716-4</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>M</given-names></name><name><surname>Torre</surname><given-names>E</given-names></name><name><surname>Dueck</surname><given-names>H</given-names></name><name><surname>Shaffer</surname><given-names>S</given-names></name><name><surname>Murray</surname><given-names>J</given-names></name><name><surname>Raj</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name></person-group><article-title>Gene expression distribution deconvolution in single-cell RNA sequencing</article-title><source>Proceedings of the National Academy of Sciences</source><year>2018</year><volume>115</volume><fpage>E6437</fpage><lpage>E6446</lpage><pub-id pub-id-type="pmcid">PMC6048536</pub-id><pub-id pub-id-type="pmid">29946020</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1721085115</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name><name><surname>Devlin</surname><given-names>B</given-names></name></person-group><article-title>Bayesian estimation of cell type-specific gene expression with prior derived from single-cell data</article-title><source>Genome research</source><year>2021a</year><volume>31</volume><fpage>1807</fpage><lpage>1818</lpage><pub-id pub-id-type="pmcid">PMC8494232</pub-id><pub-id pub-id-type="pmid">33837133</pub-id><pub-id pub-id-type="doi">10.1101/gr.268722.120</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name></person-group><article-title>Single-cell normalization and association testing unifying CRISPR screen and gene co-expression analyses with Normalisr</article-title><source>Nature communications</source><year>2021</year><volume>12</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC8568964</pub-id><pub-id pub-id-type="pmid">34737291</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-26682-1</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Choi</surname><given-names>D</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name></person-group><article-title>Constructing local cell-specific networks from single-cell data</article-title><source>Proceedings of the National Academy of Sciences</source><year>2021b</year><volume>118</volume><pub-id pub-id-type="pmcid">PMC8713783</pub-id><pub-id pub-id-type="pmid">34903665</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2113178118</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Susztak</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC6342984</pub-id><pub-id pub-id-type="pmid">30670690</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Hicks</surname><given-names>SC</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name></person-group><article-title>Addressing the mean-correlation relationship in co-expression analysis</article-title><source>PLOS Computational Biology</source><year>2022</year><volume>18</volume><elocation-id>e1009954</elocation-id><pub-id pub-id-type="pmcid">PMC9009771</pub-id><pub-id pub-id-type="pmid">35353807</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009954</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilk</surname><given-names>AJ</given-names></name><name><surname>Rustagi</surname><given-names>A</given-names></name><name><surname>Zhao</surname><given-names>NQ</given-names></name><name><surname>Roque</surname><given-names>J</given-names></name><name><surname>Martinez-Colon</surname><given-names>GJ</given-names></name><name><surname>McKechnie</surname><given-names>JL</given-names></name><name><surname>Ivison</surname><given-names>GT</given-names></name><name><surname>Ranganath</surname><given-names>T</given-names></name><name><surname>Vergara</surname><given-names>R</given-names></name><name><surname>Hollis</surname><given-names>T</given-names></name><etal/></person-group><article-title>A single-cell atlas of the peripheral immune response in patients with severe COVID-19</article-title><source>Nature medicine</source><year>2020</year><volume>26</volume><fpage>1070</fpage><lpage>1076</lpage><pub-id pub-id-type="pmcid">PMC7382903</pub-id><pub-id pub-id-type="pmid">32514174</pub-id><pub-id pub-id-type="doi">10.1038/s41591-020-0944-y</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Hu</surname><given-names>E</given-names></name><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Guo</surname><given-names>P</given-names></name><name><surname>Dai</surname><given-names>Z</given-names></name><name><surname>Feng</surname><given-names>T</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>W</given-names></name><name><surname>Zhan</surname><given-names>L</given-names></name><etal/></person-group><article-title>clusterProfiler 4.0: A universal enrichment tool for interpreting omics data</article-title><source>The Innovation</source><year>2021</year><volume>2</volume><elocation-id>100141</elocation-id><pub-id pub-id-type="pmcid">PMC8454663</pub-id><pub-id pub-id-type="pmid">34557778</pub-id><pub-id pub-id-type="doi">10.1016/j.xinn.2021.100141</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>AM</given-names></name><name><surname>Kumasaka</surname><given-names>N</given-names></name><name><surname>Calvert</surname><given-names>F</given-names></name><name><surname>Hammond</surname><given-names>TR</given-names></name><name><surname>Knights</surname><given-names>A</given-names></name><name><surname>Panousis</surname><given-names>N</given-names></name><name><surname>Park</surname><given-names>JS</given-names></name><name><surname>Schwartzentruber</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Kundu</surname><given-names>K</given-names></name><etal/></person-group><article-title>A map of transcriptional heterogeneity and regulatory variation in human microglia</article-title><source>Nature genetics</source><year>2021</year><volume>53</volume><fpage>861</fpage><lpage>868</lpage><pub-id pub-id-type="pmcid">PMC7610960</pub-id><pub-id pub-id-type="pmid">34083789</pub-id><pub-id pub-id-type="doi">10.1038/s41588-021-00875-2</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>A General Framework for Weighted Gene Co-Expression Network Analysis</article-title><source>Statistical Applications in Genetics and Molecular Biology</source><year>2005</year><volume>4</volume><fpage>1</fpage><lpage>43</lpage><pub-id pub-id-type="pmid">16646834</pub-id></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Atwal</surname><given-names>GS</given-names></name><name><surname>Lim</surname><given-names>WK</given-names></name></person-group><article-title>Noise regularization removes correlation artifacts in single-cell RNA-seq data preprocessing</article-title><source>Patterns</source><year>2021</year><volume>2</volume><elocation-id>100211</elocation-id><pub-id pub-id-type="pmcid">PMC7961184</pub-id><pub-id pub-id-type="pmid">33748795</pub-id><pub-id pub-id-type="doi">10.1016/j.patter.2021.100211</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>Validation of CS-CORE using permuted snRNA-seq data from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref>. Results from permuted data with varying and constant sequencing depths are colored with light red and blue, respectively. (A) Scatter plots with fitted curves showing expression (x-axis) and average co-expression (y-axis) of each gene with co-expression estimated using locCSN, Noise Regularization, Normalisr, Pearson correlation, propr, p-sctransform, Spearman correlation, SpQN and CS-CORE. Average co-expressions are re-scaled by the maximum value to aid comparison. (B) Q-Q plots comparing p-values for testing co-expressions of gene pairs against Uniform(0,1) using six methods with statistical tests, including Noise Regularization, Normalisr, Pearson correlation, ρ-sctransform, Spearman correlation and CS-CORE.</p></caption><graphic xlink:href="EMS158592-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Validation of CS-CORE using simulated data, compared to locSCN, Noise Regularization, Normalisr, Pearson correlation, propr, p-sctransform, Spearman correlation and SpQN.</title><p>(A) Curve-fitted co-expression estimates against geometric mean expression levels on gene pairs simulated with a true correlation of 0.5 (5,000 genes and 1,000 cells). (B) Precision-recall curves evaluated using 500 genes, 5,000 cells and a sparse co-expression matrix estimated from real data. Cut-off values are based on <italic>p</italic>-values for CS-CORE, Noise Regularization, Normalisr, Pearson correlation, p-sctransform, Spearman correlation and absolute values of co-expression estimates for propr and SpQN, as they are not equipped with statistical tests; locCSN is excluded due to its extreme demand in computing time. (C) Running times evaluated under the same setting as in (B). locCSN is evaluated using 0.2% of the cells to reduce computing time. The simulations were run on an Intel Xeon Gold 6240 @ 2.60GHz with one node and 50GB memory. The error bars denote one standard deviation across 100 replications.</p></caption><graphic xlink:href="EMS158592-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Evaluation of CS-CORE in recovering clusters and principal components using simulated data, compared to locCSN, Noise Regularization, Normalisr, Pearson correlation, propr, <italic>ρ</italic>-sctransform, Spearman correlation and SpQN. (A) Heatmaps of true and estimated co-expression networks from simulations. When plotting results from each method, genes were ordered by applying hierarchical clustering to the estimated co-expression network and color coded by their true cluster labels. (B) Adjusted Rand index (ARI) between true clusters and clusters extracted from co-expression networks estimated using different methods. (C) Accuracy in recovering principal components, calculated using subspace distance (Golub and Van Loan, 2013) between the top four singular vectors of the true co-expression matrix and those of the estimated co-expression matrix. (D) Spearman correlations between the expression levels and estimated average co-expression levels of genes, with ground truth calculated from simulation settings marked with a dashed line. (E) ARI between clusters extracted from estimated co-expression networks and clusters extracted from clustering gene expression levels, with the true ARI calculated from parameters used in simulation settings marked with a dashed line. (B)-(E) were evaluated with 25 replications.</p></caption><graphic xlink:href="EMS158592-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Co-expression analysis using AD brain samples in <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref>. We used the cells in five major brain cell types from control subjects from <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> to estimate cell-type-specific co-expression networks. <bold>A.</bold> Ratio of the numbers of gene pairs that were identified as significant in both <xref ref-type="bibr" rid="R19">Lau et al. (2020)</xref> and <xref ref-type="bibr" rid="R22">Mathys et al. (2019)</xref> at specified <italic>p</italic>-value cutoffs between CS-CORE and <italic>ρ</italic>-sctransform. <bold>B.</bold> Ratio of the numbers of gene pairs that were identified as significant and overlapped with known TF-target gene pairs in the TRRUST database (<xref ref-type="bibr" rid="R8">Han et al., 2018</xref>) between CS-CORE and <italic>ρ</italic>-sctransform. <bold>C.</bold> Heatmaps of microglia-specific co-expression network estimates on genes from four GO terms on microglia’s functions with genes ordered by hierarchical clustering.</p></caption><graphic xlink:href="EMS158592-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>CS-CORE estimates in monocytes from control subjects and COVID-19 patients. Known interferon-stimulated genes are colored in red. Genes in the SARS-CoV-2 infection Reactome pathway are colored in brown. * is used to mark genes that belong to both gene sets. We performed a differential co-expression analysis on top 1,000 highly expressed genes in monocytes and obtained modules of genes that shared similar changes in co-expressions between cells from COVID-19 patients and controls. For a differentially co-expressed gene module enriched for the interferon signalling pathway, we focused on genes that had strong differential signals (sum of absolute differential co-expressions greater than the median) and visualized the co-expression network estimates in control subjects and COVID-19 patients.</p></caption><graphic xlink:href="EMS158592-f005"/></fig></floats-group></article>