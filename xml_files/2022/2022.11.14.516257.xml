<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157211</article-id><article-id pub-id-type="doi">10.1101/2022.11.14.516257</article-id><article-id pub-id-type="archive">PPR571838</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">4</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Cerebellar-driven cortical dynamics enable task acquisition, switching and consolidation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pemberton</surname><given-names>Joseph</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Chadderton</surname><given-names>Paul</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Costa</surname><given-names>Rui Ponte</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Computational Neuroscience Unit, Intelligent Systems Labs, Faculty of Engineering, University of Bristol, Bristol, United Kingdom</aff><aff id="A2"><label>2</label>Centre for Neural Circuits and Behaviour, Department of Physiology, Anatomy and Genetics, Medical Sciences Division, University of Oxford, Oxford, United Kingdom</aff><aff id="A3"><label>3</label>School of Physiology, Pharmacology and Neuroscience, Faculty of Life Sciences, University of Bristol, Bristol, United Kingdom</aff><author-notes><corresp id="CR1">
<label>*</label>For correspondence: <email>joe.pemberton@bristol.ac.uk</email>,<email>rui.costa@dpag.ox.ac.uk</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>17</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>14</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><title>Summary</title><p id="P1">To drive behavior, the cortex must bridge sensory cues with future outcomes. However, the principles by which cortical networks learn such sensory-behavioural transformations remain largely elusive. Here, we posit that the cerebellum assumes a crucial role in driving cortical dynamics, thereby enabling rapid and flexible task acquisition. We introduce a computational model of cerebellar networks which learn to drive cortical networks with task-outcome predictions. First, using sensorimotor tasks we show that cerebellar feedback in the presence of minimal cortical plasticity is suffcient for rapid task acquisition and multiple task switching. Next, we demonstrate that, when trained in working memory tasks, the cerebellum can also underlie the maintenance of cognitive-specific dynamics, explaining a range of optogenetic and behavioural observations. Finally, using our model we introduce a systems consolidation theory in which task information is gradually transferred from the cerebellum to the cortex. In summary, our findings suggest that cortico-cerebellar loops play a pivotal role in task acquisition, switching, and consolidation within the brain.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Learning to interact with the environment requires a continuous integration of fast-changing sensory cues with future behavioural outcomes. Growing evidence suggests that cortical dynamics integrate the task-specific information that is needed for such sensory-behavioural transformations<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref></sup>. One dominating view in the field assumes that cortical networks are themselves learnt or optimised leading to the rich dynamics required for task performance<sup><xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>. However, to help ensure a stable representation of the world, cortical plasticity must be kept under control and relatively weak<sup><xref ref-type="bibr" rid="R9">9</xref>–<xref ref-type="bibr" rid="R12">12</xref></sup>. This raises the question of how can the brain quickly acquire new task-specific dynamics in the presence of relatively fixed cortical connectivity.</p><p id="P3">One possible solution is to consider feedback loops that drive cortical dynamics<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. Computational studies have extended recurrent neural networks (RNNs) models of cortical networks (<xref ref-type="fig" rid="F1">Fig. 1A</xref>) to incorporate feedback loops for task acquisition. One type of feedback loop drives RNN dynamics by projecting the readout back to the RNN<sup><xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref></sup> (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). Building on this line of work, two recent theoretical studies have suggested that thalamo-cortical feedback can both prepare and control RNN dynamics to achieve flexible motor sequencing<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>. All of these studies assume that connectivity within the RNN itself remains fixed, thereby avoiding complex learning rules while being able to reuse RNN dynamics for different contexts<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. However, these approaches either assume a relatively simple feedback (i.e. a linear combination of RNN activity) or rely on theoretically optimal, but biologically implausible, derivations for the feedback signal. In particular, the possible role of more powerful, highly adaptable brain regions is often overlooked.</p><p id="P4">Here we focus on the feedback loop between two key brain regions, the cortex and <italic>the cerebellum</italic>. The cerebellum is a highly plastic system and is well placed to drive cortical dynamics via a set of stereotypical, but functionally separable cortico-cerebellar loops<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref></sup>. Indeed, an ever-growing array of clinical<sup><xref ref-type="bibr" rid="R22">22</xref></sup>, functional imaging<sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>, and optogenetic<sup><xref ref-type="bibr" rid="R25">25</xref>–<xref ref-type="bibr" rid="R27">27</xref></sup> studies support an important cerebellar contribution to cortical activity in both motor and non-motor domains. Recently, two hypotheses on the computational role of cortico-cerebellar loops have been put forward<sup><xref ref-type="bibr" rid="R28">28</xref>–<xref ref-type="bibr" rid="R31">31</xref></sup>. The first asserts that the cerebellum reinforces cortical-dependent goal-directed behaviour by appropriately steering or stabilising cortical states in real-time<sup><xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R29">29</xref></sup>. The second also promotes the cerebellum as a facilitator of goal-directed cortical transitions, but it does so indirectly via teaching signals which lead to cortical plasticity<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>. Whilst these two views may co-exist, it is the former that is well placed to operate under weakly plastic cortical networks. Moreover, the cerebellum acting as an instantaneous driver of cortical dynamics is in line with the fast activity-dependent cortico-cerebellar interactions that have been observed experimentally<sup><xref ref-type="bibr" rid="R25">25</xref>–<xref ref-type="bibr" rid="R27">27</xref></sup>.</p><p id="P5">Here we put forward a computational framework in which the cerebellum learns to rapidly steer and stabilise task-dependent cortical dynamics. We test this model on a variety of motor and non-motor tasks, proposing that the cerebellum is optimised to support task acquisition in the cortex. This reduces the burden of learning in cortical networks and allows a given cortical area to rapidly switch between different tasks. In line with this, we show that a strong cortical dependence on cerebellar feedback arises after learning, consistent with recent behavioural and optogenetic experiments. Finally, we use this model to put forward a cerebellar-to-cortical systems consolidation theory, in which quickly learnt task-specific information encoded by the cerebellum is gradually transferred to the cortex. Overall, we introduce a computationally and experimentally supported theory for cerebellar-supported task acquisition, switching and consolidation in the brain.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>A computational model of cerebellar-driven cortical dynamics for task acquisition</title><p id="P6">To study the role that cerebellar feedback can have in driving cortical dynamics during task acquisition, we explore different variants of cortical RNNs: without feedback (<xref ref-type="fig" rid="F1">Fig. 1A</xref>), with readout feedback (<xref ref-type="fig" rid="F1">Fig. 1B</xref>)<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> and with feedback provided by a cortico-cerebellar loop (<xref ref-type="fig" rid="F1">Fig. 1C</xref>). We introduce a model of cortico-cerebellar loops, in which a <italic>cortical</italic> RNN is reciprocally connected to a feedforward <italic>cerebellar</italic> network 𝒞. In our model, temporal RNN representations <bold>h</bold><sub><italic>t</italic></sub> are passed onto the cerebellar network to compute task-specific predictions <bold>c</bold><sub><italic>t</italic></sub>, which are then sent back to the same cortical RNN. The final model output <bold>z</bold><sub><italic>t</italic></sub> is then a linear readout of the RNN activity <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">z</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>rdt</mml:mtext></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>α</italic> denotes the cortical internal memory (or leak) of the RNN neurons, <italic>f</italic> (<italic>x</italic>) is the cortical activation function which is set as tanh(<italic>x</italic>). <italic>W</italic><sub><italic>hh</italic></sub>, <italic>W</italic><sub><italic>ih</italic></sub>, <italic>W</italic><sub><italic>𝒞h</italic></sub> are the recurrent, input, and cerebellar weights onto the RNN respectively, and <italic>W</italic><sub>rdt</sub> are the readout weights (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S1</xref> for a detailed schematic). For computational effciency and due to the relatively long duration of the tasks we train our model using a discrete approximation of a continuous RNN (see <xref ref-type="sec" rid="S12">Methods</xref>). To highlight the need for optimised network connectivity rather than inherent cortical memory mechanisms, in our experiments we generally focus on small <italic>α</italic> = 0.1 (see <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P7">The cerebellar feedback <bold>c</bold><sub><italic>t</italic></sub> is a feedforward computation <italic>C</italic> on the previous RNN activity <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>𝒞</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>PF</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mi>f</mml:mi><mml:mo>𝒞</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>MF</mml:mtext></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>W</italic><sub>MF</sub> represent the cerebellar (input) mossy fibre (MF) weights onto granule cells (GC) and <italic>W</italic><sub>PF</sub> the parallel fibre (PF) weights from GC to Purkinje cells (PC), here representing the output. Together, these constitute the main stages of processing in the cerebellum<sup><xref ref-type="bibr" rid="R33">33</xref>–<xref ref-type="bibr" rid="R35">35</xref></sup>. In general we model <italic>W</italic><sub>MF</sub> as highly divergent with an input/output ratio of 1:20 (see <xref ref-type="sec" rid="S12">Methods</xref>) and <italic>f</italic> <sup><italic>𝒞</italic></sup> (<italic>x</italic>) as a rectified linear function (ReLU), in line with the large numbers of cerebellar GCs and responses<sup><xref ref-type="bibr" rid="R36">36</xref>,<xref ref-type="bibr" rid="R37">37</xref></sup>. As we demonstrate in our results, and consistent with prior work, the dimensionality expansion and non-linearity at the GC layer enables better representations during learning.</p><p id="P8">We use biologically plausible gradient descent<sup><xref ref-type="bibr" rid="R38">38</xref></sup> to optimise cortical weights during the acquisition of a given task (<xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>). In particular, we minimise the temporal error <italic>E</italic><sub><italic>t</italic></sub> = <italic>ℰ</italic>(<bold>z</bold><sub><italic>t</italic></sub>, <bold>y</bold><sub><italic>t</italic></sub>), where <bold>y</bold><sub><italic>t</italic></sub> denotes the desired task outcome at time <italic>t</italic> and <italic>E</italic> is the task error function (see <xref ref-type="sec" rid="S12">Methods</xref>). These weights can all be optimised simultaneously during learning – we refer to this case as <italic>fully plastic</italic>. However, a key idea that we put forward in this study is that it is not the neocortex, but in fact the cerebellum, which acts as a key driver for task acquisition. For this reason we highlight the case in which RNN plasticity is constrained. In particular, we focus on conditions in which RNN plasticity is either absent – <italic>fixed RNN</italic> case, or in which plasticity is strictly limited to its input synapses (i.e. only <italic>W</italic><sub><italic>ih</italic></sub>, <italic>W</italic><sub><italic>𝒞h</italic></sub> in <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref> are plastic) – <italic>input plastic</italic> case. The latter case considers both plasticity at sensory and cerebello-cortical input during task acquisition, in line with experimental observations showing plasticity at cerebellar pathways to the cortex<sup><xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup>.</p><p id="P9">In contrast to cortical learning, the cerebellum is always optimised, through a separate but related cerebellar error <inline-formula><mml:math id="M3"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mo>𝒞</mml:mo></mml:msubsup></mml:math></inline-formula>. In line with classical models of the cerebellum<sup><xref ref-type="bibr" rid="R33">33</xref></sup> we assume that learning occurs at the parallel fibres <italic>W</italic><sub>PF</sub>, mediated by climbing fibre error signals, whilst mossy fibres inputs <italic>W</italic><sub>MF</sub> remain fixed. Like the cortical prediction error, the cerebellar error function depends on the desired task outcome <bold>y</bold>. However, as we will see later, it is advantageous for the cerebellum to provide predictions of future outcomes. To enable this we formulate a temporal cerebellar learning rule. In this rule the cerebellum learns by comparing its own past output within a predefined time-window <italic>τ</italic>, with current desired outcomes (<xref ref-type="fig" rid="F1">Fig. 1D</xref>), <inline-formula><mml:math id="M4"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mo>𝒞</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ℰ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> – behavioural timing-specific learning rule. This learning rule then predicts the need for temporally precise coordination between parallel fibre inputs and subsequent climbing fibre error signals to achieve plasticity, in line with experimental findings<sup><xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R41">41</xref>–<xref ref-type="bibr" rid="R45">45</xref></sup>. Therefore, it enables the cerebellum to predict future outcomes effectively, i.e. <bold>c</bold><sub><italic>t</italic></sub> <italic>≈</italic> <bold>y</bold><sub><italic>t</italic>+<italic>τ</italic></sub>. For our motor-based tasks we generally consider a cerebellar time window of <italic>τ ≈</italic> 150ms<sup><xref ref-type="bibr" rid="R32">32</xref></sup> and for the later cognitive tasks use longer windows <italic>τ ≈</italic> 600ms (see <xref ref-type="sec" rid="S12">Methods</xref>).</p></sec><sec id="S4"><title>Cerebellum learns to drive cortical dynamics during a line drawing task</title><p id="P10">To study the functional consequences of cortico-cerebellar loops we first test the model in a motor-based line drawing task. In this task the model receives one out of six cues at the beginning of the task and learns to either remain still or produce one out of five possible straight lines (<xref ref-type="fig" rid="F2">Fig. 2A</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). Feedback provided by desired outcomes (i.e. straight lines) is provided at each timestep. Consistent with behavioural studies on cerebellar patients<sup><xref ref-type="bibr" rid="R46">46</xref></sup>, we find that cerebellar feedback significantly improves learning of the task and final performance (<xref ref-type="fig" rid="F2">Fig. 2A,B</xref>). The ability for cerebellar feedback to facilitate learning does not depend on the degree of plasticity and internal memory in the cortical RNN (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). Interestingly, a fixed RNN with a plastic cerebellum achieves the same learning performance as a fully plastic or input plastic RNN. In contrast, when no feedback or a simple readout feedback is provided the network can fail to learn the task due to the leaky properties of RNNs (<xref ref-type="fig" rid="F2">Fig. 2B,C</xref>). Classical cerebellar models pose that the cerebellum can act as a direct controller of motor tasks<sup><xref ref-type="bibr" rid="R33">33</xref></sup>. To contrast this view with our model we also train an RNN with a direct cerebellar readout, which apart from the cortico-cerebellar feedback weights uses the same free network parameters, and find it insuffcient to learn the task (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. S1</xref> and <xref ref-type="supplementary-material" rid="SD1">S2</xref>).</p><p id="P11">Next, we study how two known cerebellar features: (i) a large number of granule cells and (ii) behavioural timing-specific plasticity rules contribute to task proficiency. We find that a combination of high numbers of granule cells with a learning rule with a non-zero temporal horizon, <italic>τ</italic>, result in better cerebellar learning (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S3</xref>), which in turn drives better cortical representations and overall task performance (<xref ref-type="fig" rid="F2">Fig. 2D</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. S3</xref>,<xref ref-type="supplementary-material" rid="SD1">S4</xref>). Moreover, because both the cortical RNN readout and cerebellar network are trained on the same desired outcome, we observe that cerebellar output effectively predicts cortical readout <italic>τ</italic> ms ahead (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). Our model thus provides a theory of how the cerebellum learns to predict upcoming movements<sup><xref ref-type="bibr" rid="R47">47</xref>,<xref ref-type="bibr" rid="R48">48</xref></sup>.</p><p id="P12">The advantage of a large number of granule cells has been well studied is likely due to better linear separability of its inputs<sup><xref ref-type="bibr" rid="R49">49</xref></sup>. However, what are the computational advantages of the cerebellum providing the cortical RNN with expected future outcomes? Due to RNN leakiness, sensory cues are rapidly forgotten. Therefore a high cerebellar <italic>τ</italic> gives the cerebellar network the ability to map RNN activity to desired outcomes early on in the task. Consistent with this we find that the predictive cerebellar output drives outcome-dependent RNN representations (<xref ref-type="fig" rid="F2">Fig. 2F,G</xref>). This result showing potent initial drive of cortical activity could provide a justification for the observed role of the cerebellum in movement initiation<sup><xref ref-type="bibr" rid="R50">50</xref>,<xref ref-type="bibr" rid="R51">51</xref></sup>.</p><p id="P13">Finally, to directly examine the role of cerebellar feedback on cortical dynamics, we inhibit - or “ablate” - cerebellar output (i.e. <bold>c</bold><sub><italic>t</italic></sub> = 0 in <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>) during different stages of the task. In each case we observe significant impairment in the model output which returns to baseline (<xref ref-type="fig" rid="F2">Fig. 2H-J</xref>). Moreover, this effect is most detrimental to task performance when ablation occurs at the start (<xref ref-type="fig" rid="F2">Fig. 2K</xref>). These findings are consistent with the observed freezing effect of cerebellar lesions on gait<sup><xref ref-type="bibr" rid="R52">52</xref></sup>. In line with both cortical and cerebellar networks working jointly to perform the task, we find that when the RNN is fully plastic cerebellar ablations have a significant but reduced impact on the cortical dynamics (<xref ref-type="fig" rid="F2">Fig. 2K,L</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S5</xref>). We also observe that the cortical RNN is particularly sensitive to the presence of noise in cerebellar output. When noise is added to its output it leads to irregular behaviour (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S6</xref>), in line with the classical motor symptoms of cerebellar ataxia<sup><xref ref-type="bibr" rid="R53">53</xref></sup>.</p><p id="P14">Taken together, this motor-based task highlights the computational benefits of training a cerebellar network to drive cortical dynamics, predicting that the cortex can critically depend on cerebellar feedback for successful task execution. Furthermore, we demonstrate that cerebellar plasticity can effectively replace the need for local cortical plasticity.</p></sec><sec id="S5"><title>Cerebellar-mediated task switching in cortical networks</title><p id="P15">We have shown that cortico-cerebellar loops can enable successful task learning with minimal cortical plasticity. This opens the possibility of reusing cortical networks across different contexts and behaviours.</p><p id="P16">To demonstrate the model’s ability to adapt and perform context-dependent task switching, we consider how models trained in the line-drawing task can be retrained to a curl-field variant<sup><xref ref-type="bibr" rid="R54">54</xref></sup>. In particular, we analyse how the cerebellar network can (i) successfully enable learning in a new task context and also (ii) rapidly revert, or <italic>switch</italic>, to a previously learned context.</p><p id="P17">As expected, when the new task context is introduced to the model, there is a steep increase in error before the model successfully learns the new task (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, left and middle). Notably, however, when the original task is reintroduced, the fixed RNN model recovers the initial dynamics significantly faster than the fully plastic model and more faithfully captures the behavioural data from macaque monkeys<sup><xref ref-type="bibr" rid="R54">54</xref></sup> (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, right). This relatively slow switching back suggests that the fully plastic RNN is more prone to forgetting the original task<sup><xref ref-type="bibr" rid="R9">9</xref></sup>.</p><p id="P18">We then asked how the cerebellar network might enable even faster task switching. In line with observed context-dependent activations<sup><xref ref-type="bibr" rid="R55">55</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup> and plasticity rules<sup><xref ref-type="bibr" rid="R57">57</xref></sup> in the cerebellum, we consider cerebellar PFs which are task-specific. The extent of task-specificity at PFs is modelled by the <italic>PF task overlap</italic>; full overlap (100%) would imply that the same exact PFs are used across task contexts, while zero overlap (0%) implies that a completely different set of PFs is used for each task respectively.</p><p id="P19">Our results show that the degree of PF task overlap predicts a tradeoff between the speed of learning the new task and the ability to rapidly switch back to the original task (<xref ref-type="fig" rid="F3">Fig. 3B</xref>). Specifically, whilst maximal PF task overlap is beneficial when a new task is introduced, rapid switching is favoured when distinct PFs are used. To highlight the ability to immediately switch back to the original task (zero-shot switch) we focus on the zero-overlap case. For the fixed RNN, but not the fully plastic RNN, the model achieves near-perfect switching to the original task (<xref ref-type="fig" rid="F3">Fig. 3C,D</xref>). Consistent with the need to learn a new task all models show a substantial change in the neuronal activity (<xref ref-type="fig" rid="F3">Fig. 3E</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S7A</xref>). However, we expect that models with minimal local cortical plasticity should result inminimal changes in the underlying dynamics of both tasks. To test this, we measure changes in the the covariance of the neuronal activity between the new task and the initial task (see <xref ref-type="sec" rid="S12">Methods</xref> and<sup><xref ref-type="bibr" rid="R58">58</xref></sup>). As predicted, only the models with reduced cortical plasticity show the minimal changes observed experimentally (<xref ref-type="fig" rid="F3">Fig. 3F</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S7B</xref>). On the other hand, for the fully plastic model the dynamics acquired after switching back to the initial task are significantly different to baseline (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S7C,D</xref>). This suggests that the fully plastic model learns a new solution to the initial task, explaining its relative slowness in switching.</p><p id="P20">Overall, we apply our models to demonstrate a cerebellar-driven solution to multi-task learning and task switching. We show that the underlying dynamics preserved by a fixed cortical RNN, supported by context-dependent cerebellar feedback, can support rapid behavioural changes whilst minimising forgetting of previously acquired task knowledge.</p></sec><sec id="S6"><title>Cerebellar temporal basis supports non-linear drawing task</title><p id="P21">Above we have modelled a case in which the cerebellum learns to drive cortical dynamics using a specific predictive time-window (namely <italic>τ</italic> = 150ms). However, a recent study has revealed a diversity of temporal plasticity windows to be at play in the cerebellum<sup><xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R59">59</xref></sup> (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). Such diversity of temporal windows may enable the cerebellum to learn a <italic>temporal basis</italic> for upcoming events, which may enhance the cerebellum’s ability to predict future outcomes.</p><p id="P22">To demonstrate the benefit of diversity in temporal windows we consider a more realistic (and challenging) variant of the line-drawing task in which the model is now trained to produce a digit-like output (<xref ref-type="fig" rid="F4">Fig. 4B</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). This task is selected so as to produce a non-linear and highly varied set of future desired outcomes and therefore the need for richer cerebellar predictions. In particular, we consider a cerebellar network which simultaneously learns with a range, or “temporal basis”, of time-windows <italic>τ</italic><sub><italic>i</italic></sub> ∈ [0ms, 250ms] such that its prediction effectively spans a relatively long window of upcoming desired outcomes (see <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P23">We find this heterogeneity of cerebellar time windows to enable both faster learning and higher performance thresholds (<xref ref-type="fig" rid="F4">Fig. 4B,C</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S8</xref>). As expected, when considering the simpler line-drawing task having multiple time windows does not improve learning (<xref ref-type="supplementary-material" rid="SD1">Fig. S8C</xref>). Moreover, in line with the results above, a fixed RNN achieves a performance comparable to the plastic RNN models across different degrees of internal memory in the cortical network (<xref ref-type="fig" rid="F4">Fig. 4D</xref>). When comparing the network performance across different numbers of granule cells and time-windows, we find that higher numbers of granule cells combined with multiple time-window learning achieves the best average learning performance (<xref ref-type="fig" rid="F4">Fig. 4E</xref>). Finally, as with the simpler line-drawing task, we find that cerebellar ablation is detrimental to the maintenance and development of these representations (<xref ref-type="fig" rid="F4">Fig. 4F-H</xref>) in a way that depends on the degree of cortical plasticity (<xref ref-type="fig" rid="F4">Fig. 4I</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S9</xref>).</p><p id="P24">These results suggest that the diversity of behavioural-specific learning windows observed experimentally in the cerebellum<sup><xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R59">59</xref></sup> improve behaviour when in the presence of more challenging task conditions.</p></sec><sec id="S7"><title>Cerebellar-driven cortical dynamics maintains beliefs in an evidence accumulation task</title><p id="P25">So far we have focused purely on motor-based tasks, but growing evidence strongly suggests that the cerebellum also plays important roles in functions that go beyond direct motor control<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R60">60</xref>,<xref ref-type="bibr" rid="R61">61</xref></sup>. To demonstrate this we model an evidence accumulation task that has been shown to be cerebellar-dependent<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. In this study Deverett et al.<sup><xref ref-type="bibr" rid="R26">26</xref></sup> showed that optogenetic inhibition of the cerebellar output nuclei disrupts the ability of mice to determine whether the left or right cheek received more air puffs over a period of time (<xref ref-type="fig" rid="F5">Fig. 5A</xref>). Unlike the previous tasks, here the desired outcome is only provided at the end of the task, making error-related signals highly sparse.</p><p id="P26">Similar to the motor tasks studied above, cerebellar feedback improves task learning relative to models without feedback or with readout feedback (<xref ref-type="fig" rid="F5">Fig. 5B</xref>). Moreover, a fixed RNN achieves performance comparable or even superior to the fully plastic models across a range of degrees of cortical internal memory (<xref ref-type="fig" rid="F5">Fig. 5C</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S10</xref>). These results suggest that weakly plastic cortical networks driven by the cerebellum may also be suffcient for learning cognitive-based tasks with sparse error information.</p><p id="P27">Next, our ablation analysis reveals strong similarities to the optogenetic observations by Deverett et al.<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. In particular, cerebellar ablation greatly impairs the model’s capacity to maintain and develop beliefs, mirroring the behavioural effects observed experimentally (<xref ref-type="fig" rid="F5">Fig. 5D</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S11</xref>). Indeed, using the same behavioural regression performed by Deverett et al.<sup><xref ref-type="bibr" rid="R26">26</xref></sup> (see <xref ref-type="sec" rid="S12">Methods</xref>), we show that cerebellar ablation in latter periods leads to a final choice in which information about previously seen inputs is greatly reduced (<xref ref-type="fig" rid="F5">Fig. 5E</xref>), in line with experimental findings. Because more information is effectively lost, we find that ablation near the end of the task has a particularly detrimental impact on task performance, consistent with behavioural observations (<xref ref-type="fig" rid="F5">Fig. 5F</xref>), and this leads to a sub-chance ability to perform “history-centric” trials which rely more on initial inputs (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S11</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). These ablation results also emphasize that even though the cerebellum is trained with teaching signals close to the end of the task, cerebellar predictions prove to be valuable earlier in the task (<xref ref-type="fig" rid="F5">Fig. 5F</xref>). Finally, to demonstrate that task performance also depends on cortical dynamics, we performed (partial) ablation to cortical RNN and observed similar behavioural deficits (<xref ref-type="supplementary-material" rid="SD1">Fig. S12A-C</xref>).</p><p id="P28">Given that cerebellar feedback is necessary to preserve information over time and avoid leaky cortical dynamics, we predicted that the behavioural effect of cerebellar ablation would depend on the timescale of the task and would weaken for shorter task durations. Indeed, we find that the performance effect of ablation increases as a function of task length (<xref ref-type="fig" rid="F5">Fig. 5G</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S13</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). Like in the previous motor-based tasks, our model predicts that cerebellar feedback is particularly helpful when in the presence of weak cortical plasticity (<xref ref-type="fig" rid="F5">Fig. 5G,H</xref>).</p><p id="P29">Overall, our model predicts that the proper maintenance of model selectivity depends critically on cerebellar feedback during evidence accumulation. Consistent with behavioural results, these effects are emphasised when cerebellar ablation occurs in the later stages of the task.</p></sec><sec id="S8"><title>Cerebellar feedback sustains cortical dynamics in a delayed association task</title><p id="P30">Next we aim to demonstrate that cerebellar networks can also effectively drive cortical dynamics in tasks with long delay periods, while capturing both neuronal and behavioural observations. To achieve this we model a delayed association task which was recently shown to dependent on cortico-cerebellar loops<sup><xref ref-type="bibr" rid="R25">25</xref></sup>. In this study mice were presented with one of two stimuli (left or right) followed by a delay period, after which they were trained to lick in the corresponding direction (<xref ref-type="fig" rid="F6">Fig. 6A</xref>, top). At the same time neural selectivity was recorded both in the anterior lateral motor cortex (ALM) - a working memory and planning region - as well as the cerebellar output nuclei (<xref ref-type="fig" rid="F6">Fig. 6A</xref>, bottom). Timed photoinhibition was used to reveal ALM selectivity to strongly depend on the cerebellar output nuclei, and vice versa.</p><p id="P31">To model this task we follow the same protocol used experimentally<sup><xref ref-type="bibr" rid="R25">25</xref></sup>, where one of two possible cues are presented followed by a delay period, after which the model makes a cue-based response (left or right; see <xref ref-type="sec" rid="S12">Methods</xref>). Given the lack of sensory or teaching information during the delay period the cortico-cerebellar network it is particularly vital in this task to sustain stimulus representations. It is important to note that a standard randomly initialised RNN is unlikely to achieve this property, since memories of previous inputs naturally decay in the absence of task-induced plasticity<sup><xref ref-type="bibr" rid="R19">19</xref></sup>.</p><p id="P32">We observe that cerebellar feedback consistently enables task acquisition (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S14</xref>), and identify a particularly interesting case when plasticity in the RNN is limited strictly to its input synapses (input plastic). In this case cerebellar feedback significantly improves cortical learning to reach near-perfect performance, whilst also enabling a high degree of stability in task selectivity throughout the delay period (<xref ref-type="fig" rid="F6">Fig. 6B-D</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S14</xref>). We speculated that for this task input plasticity is particularly important, because the cerebellum is required to sustain task-specific predictions in the RNN throughout the entire delay period. We verified this stronger cerebello-cortical drive by using concepts from control theory<sup><xref ref-type="bibr" rid="R62">62</xref></sup>. In particular, we can explicitly relate cerebello-cortical optimisation to a quantitative increase in the impact, or <italic>energy</italic>, of cerebellar feedback onto RNN activity (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S15</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). Moreover, the ability of the cerebellum to drive cortical dynamics should depend on the cortical network’s ability to express those dynamics. In line with this view our results show that (even untrained) cortical recurrent weights are important in maintaining cerebellar predictions over time (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S16</xref>).</p><p id="P33">Next, to demonstrate that the cerebellum helps drive task-specific dynamics in the cortical RNN we performed a simulated ablation in which the cerebellum is transiently removed during the delay period. Consistent with <italic>in vivo</italic> neural recordings<sup><xref ref-type="bibr" rid="R25">25</xref></sup>, we find that both cerebellar and cortical ablation drastically disrupts cortical task selectivity (<xref ref-type="fig" rid="F6">Fig. 6D</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S12D-F</xref>). We next show a similar effect in the model’s latent dynamics: using demixed principal component analysis<sup><xref ref-type="bibr" rid="R63">63</xref></sup> we observe that the choice component of the RNN’s population dynamics collapses rapidly during the ablation period, consistent with neural data (<xref ref-type="fig" rid="F6">Fig. 6E</xref>). As with the previous tasks, our model predicts that this effect depends on the degree of plasticity in the cortical RNN. In particular, a fully plastic RNN notably fails to capture the strong dependence on cerebellar feedback as observed experimentally (<xref ref-type="fig" rid="F6">Fig. 6F</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S17</xref>; compare with <xref ref-type="fig" rid="F6">Fig. 6D</xref>, bottom right). Indeed, we only observe an effect on performance consistent with experimental findings when cortical plasticity is limited (<xref ref-type="fig" rid="F6">Figs. 6F-I</xref>). Taken together our results suggest that the cerebellum, not the cortex, is the primary site of learning during the acquisition of this working memory task<sup><xref ref-type="bibr" rid="R25">25</xref></sup>.</p><p id="P34">Overall, these results demonstrate that our model can capture working memory tasks and the observed dependency of cortical dynamics on cerebellar input. Moreover, our model makes the prediction that the cerebellum is a key site of plasticity during acquisition of delayed association tasks.</p></sec><sec id="S9"><title>Cerebellar divergence decodes task-relevant signals from cortical memory</title><p id="P35">As mentioned, a prevalent feature in classical cerebellar theories is that the divergence provided by the granular layer enables a linear separation of similar inputs<sup><xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R64">64</xref></sup>. Whilst this has typically been studied using isolated models of the cerebellum, it has recently been suggested that this feature may be of relevance in the context of memories in the cortex which merge or “collapse” onto similar representations over time<sup><xref ref-type="bibr" rid="R65">65</xref></sup>.</p><p id="P36">We tested this in our model and observed that a large quantity of cerebellar granule cells is indeed particularly valuable when the initial stimulus is followed by a long delay (<xref ref-type="fig" rid="F6">Fig. 6J</xref>). In particular, our results show that as the signal-to-noise ratio (SNR) of the cortical RNN activity decreases over time, more granule cells are required to decode the stimulus from that activity (<xref ref-type="fig" rid="F6">Fig. 6K</xref>; see <xref ref-type="sec" rid="S12">Methods</xref>). The model therefore demonstrates that the cerebellum is uniquely placed to decode cortical representations whose task-relevant signals naturally weaken over time. This may explain recent experimental results which suggest the cerebellum is particularly important for tasks which induce long delay periods<sup><xref ref-type="bibr" rid="R66">66</xref></sup>.</p></sec><sec id="S10"><title>Cerebellar task knowledge can be consolidated in the cortex</title><p id="P37">In each of the previous tasks, cerebellar feedback is shown to mediate learning and the maintenance of task-specific cortical dynamics. However, the neocortex is known to encode long-term representations of tasks<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. This suggests a need for a “consolidation” period, during which the memory stored in the cerebellum may be transferred to cortical areas.</p><p id="P38">To demonstrate cerebellar-to-cortical systems consolidation in our model we develop consolidation-specific learning rules. To achieve consolidation we train cortical recurrent weights to mimic cerebellar input (see <xref ref-type="sec" rid="S12">Methods</xref>). In principle, this should be readily attainable, since the addition of cortico-cerebellar feedback itself can be interpreted as a low-rank modification of the RNN weights<sup><xref ref-type="bibr" rid="R67">67</xref></sup>. We also gradually decay the cerebellar-to-cortical input weights so that over training the cerebellum stops driving the cortical network, thereby giving full control of the task to the cortical RNN (<xref ref-type="fig" rid="F7">Fig. 7A</xref>).</p><p id="P39">We tested this computational theory of consolidation on the cortico-cerebellar models (input plastic condition) trained on the previous delayed association task (<xref ref-type="fig" rid="F6">Fig. 6D</xref>, top left). We consider two types of learning rule. The first is a simple biologically plausible rule, which depends on the ratio of cerebellar-to-cortical input and total RNN activity. Specifically, the recurrent weight <italic>w</italic><sub><italic>ij</italic></sub> from cortical neuron <italic>i</italic> to <italic>j</italic> evolves according to <inline-formula><mml:math id="M5"><mml:msup><mml:mtext>Δ</mml:mtext><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mspace width="0.2em"/><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mtext>c</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mi>k</mml:mi></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> where <inline-formula><mml:math id="M6"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mspace width="0.2em"/><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> is the <italic>j</italic>th row of <italic>W</italic><sub><italic>𝒞h</italic></sub> and the denominator a normalising factor, which may be computed by cortical interneurons<sup><xref ref-type="bibr" rid="R68">68</xref></sup>. For comparison we also consider a theoretically optimal (but biologically unrealistic) rule based on a least squares solution (see <xref ref-type="sec" rid="S12">Methods</xref>).</p><p id="P40">In both cases, we observe that the RNNs gradually learn to perform the task without the need for cerebellar input (<xref ref-type="fig" rid="F7">Fig. 7B,C</xref>). During this period, the cerebello-cortical weights decay gradually to zero, whilst relatively small but important weight modifications take place within the cortical RNN (<xref ref-type="fig" rid="F7">Fig. 7D</xref>). By construction of the learning rule, the cerebello-cortical activities throughout the consolidation period closely resemble, or “replay”, their original pre-consolidation values, and the RNN is eventually able to independently recreate the (pre-consolidation) cerebellar-dependent dynamics (<xref ref-type="fig" rid="F7">Fig. 7E,F</xref>). Such “replay” of task-dependent dynamics is consistent with experimental observations of cerebello-cortical interactions during sleep<sup><xref ref-type="bibr" rid="R69">69</xref></sup>.</p><p id="P41">We also find that a model with fixed RNN connectivity does not perform as well as the input plastic condition (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S18</xref>). This is likely due to better network stability when in the presence of the input plastic, compared to the purely fixed RNN (<xref ref-type="supplementary-material" rid="SD1">Figs. S17A,B</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S19</xref>). Related to this, we find that models which have not yet perfected the task exhibit worse performance after consolidation (<xref ref-type="fig" rid="F7">Fig. 7G</xref>).</p><p id="P42">In summary, the framework we introduce here suggest that the cortico-cerebellar loops may play an important role in systems consolidation by gradually transferring the rapidly learnt cerebellar knowledge to the cortex.</p></sec></sec><sec id="S11" sec-type="discussion"><title>Discussion</title><p id="P43">Growing experimental evidence suggests that cortico-cerebellar loops support behaviour, but their computational roles have remained unclear. Here we have introduced a systems-level modelling framework in which a feedforward cerebellar network receives the state of a cortical RNN and provides task-specific predictions in return. In our model, cerebellar feedback facilitates learning by shaping the underlying cortical dynamics during motor and cognitive tasks in a way that is consistent with both behavioural and optogenetic studies. Our work suggests that the cerebellum is a key site of learning in the brain, allowing for rapid context-switching of cortical dynamics that underlie behaviour. We finish by introducing a theory of cerebellar-to-cortical system consolidation, in which task-specific knowledge is gradually transferred to the cortical network.</p><p id="P44">Our model is related to previous network architectures in that it uses feedback to enhance neuronal representations and selectivity in an otherwise fixed RNN, thereby facilitating task-relevant downstream processes<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>. There is a growing interest in neuroscience on the role that feedback can play in cortical circuits. For example, two recent theoretical studies demonstrate how thalamic feedback implemented by cortico-thalamic loops can flexibly prepare and execute motor sequences<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>. We highlight two key computational differences in our work. First, in our model feedback is not derived by a linear function of the RNN (as usually done when using simple readout or thalamic networks), but from a divergent cerebellar-like feedforward network (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Second, our model incorporates behavioural timing-specific learning rules in line with experimental findings<sup><xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R41">41</xref>,<xref ref-type="bibr" rid="R43">43</xref>–<xref ref-type="bibr" rid="R45">45</xref></sup>. We show that these cerebellar features improve task-acquisition against a standard readout feedback architecture<sup><xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref></sup> (<xref ref-type="fig" rid="F2">Figs. 2</xref>, <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref>).</p><p id="P45">By retraining cortico-cerebellar networks in a novel task we propose a key role of the cerebellum in task switching (<xref ref-type="fig" rid="F3">Fig. 3</xref>). In particular, we show that cerebellar feedback may provide a solution to the problem of context-dependent adaptation, which requires (i) an ability to learn a new context but also (ii) an instant retrieval of appropriate response to previously learned contexts<sup><xref ref-type="bibr" rid="R70">70</xref>,<xref ref-type="bibr" rid="R71">71</xref></sup>. Interestingly, we observe that while recurrent cortical plasticity enables adaptation to a new task context there is catastrophic forgetting of the original context. This is at odds with well-known behaviour in the primate, and provides a computational explanation for why local modifications in the monkey cortex during motor adaptation appear to be limited<sup><xref ref-type="bibr" rid="R54">54</xref></sup>. In our model rapid task switching is achieved by context-specific activation of cerebellar parallel fibres. In future work it would be of interest to compare different mechanisms by which the cerebellum may realise context-dependent processing; for example, a recent study has suggested that dendritic gating via cerebellar interneurons may perform this role<sup><xref ref-type="bibr" rid="R72">72</xref></sup>. Moreover, recent observations suggest that the cerebellar-driven thalamus enables context-dependent responses in the cortex for movement initiation<sup><xref ref-type="bibr" rid="R51">51</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup> and cognitive tasks<sup><xref ref-type="bibr" rid="R73">73</xref></sup>. Indeed, our work suggests that fast context-switching is easier to incorporate in the relatively simple, divergent and rapidly learnable feedforward architecture of the cerebellum compared to the highly intricate cortical RNNs with weak plasticity.</p><p id="P46">There are a number of other well described cerebellar properties that would be of interest to study in the context of our framework. For example, incorporating the pontine, cerebellar and thalamic nuclei as intermediate filters<sup><xref ref-type="bibr" rid="R74">74</xref>,<xref ref-type="bibr" rid="R75">75</xref></sup>, enforcing sparse mossy fibre connectivity<sup><xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R76">76</xref></sup>, and considering synaptic plasticity driven primarily by long-term depression<sup><xref ref-type="bibr" rid="R32">32</xref></sup>, are all likely to offer important biological and computational insights.</p><p id="P47">A unifying model of the cortico-cerebellar loop, and indeed the cerebellum itself, must extend to non-motor tasks. Recent task-based fMRI studies have revealed functional diversity of the cerebellar cortex across a range of cognitive functions<sup><xref ref-type="bibr" rid="R23">23</xref></sup>. Our model inherently implies a high degree of heterogeneity – it suggests that different modules would be required to drive different parts of the cortex that in turn underlie different cognitive functions. In this study we modeled recent behavioural and optogenetic experimental observations<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup> which directly implicate the cerebellum in supporting cortical dynamics during evidence accumulation and delayed association tasks (<xref ref-type="fig" rid="F5">Figs. 5</xref> and <xref ref-type="fig" rid="F6">6</xref>). In particular, our results show that cortico-cerebellar interactions are enough to learn tasks with highly sparse teaching signals (i.e. only at the end of the task). Furthermore, the model predicts that the cerebellar influence becomes most pronounced during longer task durations (typically in the order of seconds). This phenomenon is attributed to both the preservation of task-specific dynamics through the cortico-cerebellar loop and the cerebellum’s intrinsic capacity, which is enhanced by its extensive hidden granular layer, to disentangle task-specific information from overlapping cortical dynamics. Significantly, we can best capture experimental observations in conditions in which RNN plasticity is limited, making the prediction that the cerebellum is the primary site of learning for these tasks. This provides an alternative to the commonly assumed view that cortical areas are optimised for specific tasks<sup><xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>.</p><p id="P48">In our model the cerebellum drives cortical dynamics based on prediction error signals that depend on the desired task outcome. In the case of the working memory tasks and in line with the experimental task setup, the desired outcome can be interpreted as a reward signal. Therefore, from this perspective, the cerebellum learns to predict future rewarding events. This is consistent with the growing literature showing that the cerebellum encodes reward-related signals<sup><xref ref-type="bibr" rid="R61">61</xref>,<xref ref-type="bibr" rid="R77">77</xref>,<xref ref-type="bibr" rid="R78">78</xref></sup> and receives projections from the reward system<sup><xref ref-type="bibr" rid="R79">79</xref></sup>. However, it remains to be tested exactly how the reward-predictive representations developed by our model compare to those found experimentally.</p><p id="P49">Here we have also introduced a theory of cerebello-cortical task consolidation. Our theory suggests that cerebellar and cortical learning may operate at different timescales: after an initial fast stage of learning driven by the cerebellum, a period of consolidation ensue in which the cortex gradually acquires task-specific knowledge encoded in the cerebellum (<xref ref-type="fig" rid="F7">Fig. 7</xref>). This view of systems task consolidation is in line with growing experimental evidence suggesting an important role of cerebellar-to-cortical task consolidation<sup><xref ref-type="bibr" rid="R69">69</xref>,<xref ref-type="bibr" rid="R80">80</xref>,<xref ref-type="bibr" rid="R81">81</xref></sup>. For example, Xu et al.<sup><xref ref-type="bibr" rid="R69">69</xref></sup> have observed similar replay-like cerebellar-to-cortical task-specific neuronal dynamics in awake and sleep. Such combination of fast and gradual learning is reminiscent of recent experimental results which suggest significantly faster timescales of plasticity in the hippocampus compared to the prefrontal cortex during a cognitive task<sup><xref ref-type="bibr" rid="R82">82</xref></sup>. Moreover, the consolidation period can be related to the idea that a task-optimised cerebellum can be utilised as a cortical teacher<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>. It is in principle possible for cerebellar-thalamo-cortical projections to support this dual role of the cerebellum as both a driver and teacher of cortical states. Indeed, anatomical evidence suggests that this could occur by providing “driving” and “teaching” input to basal and apical dendrites of cortical pyramidal cells, respectively<sup><xref ref-type="bibr" rid="R83">83</xref></sup>.</p><p id="P50">Our work highlights commonalities of cortico-cerebellar interactions in motor and cognitive tasks alike. However, it also suggests interesting differences. The first marked distinction relates to the increased significance of cerebellar-to-cortical (input) plasticity during pure working memory (<xref ref-type="fig" rid="F6">Fig. 6</xref>). This is in line with recent experimental evidence showing stronger plasticity at higher-order thalamo-cortical pathways<sup><xref ref-type="bibr" rid="R40">40</xref></sup>. Indeed, because of the need to sustain information during the delay period without sensory or teaching input, it is advantageous for the network to encode a point attractor-like state (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S17</xref>, left). Cerebello-cortical plasticity<sup><xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup> may thus enable greater <italic>controllability</italic> of cerebellar feedback to push the network to these states during working memory tasks, but less so in motor-based tasks<sup><xref ref-type="bibr" rid="R62">62</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S15</xref>).</p><p id="P51">Related to the point above, the second difference we highlight is about cerebello-cortical consolidation being more readily achieved when in the presence of networks with stable dynamics (cf. <xref ref-type="fig" rid="F7">Fig. 7</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S18</xref>). We speculate that unstable network dynamics make cerebellar-to-cortical consolidation less reliable. Therefore, we predict that while cerebellar-to-cortical systems consolidation might be possible for near perfected tasks which involve discrete stable representations (e.g. working memory tasks), for tasks which are not yet fully learned, or which require faster, more dynamic responses (as often required in the motor domain), cerebellar control is likely to be required throughout life.</p><p id="P52">To conclude, our work suggests that while the cortex encodes a stable model of the world, it is the cerebellum that allows for quick and flexible adaptation to new environmental conditions. This new cerebellar-guided knowledge can then be gradually consolidated in the cortex.</p></sec><sec id="S12" sec-type="methods" specific-use="web-only"><title>Methods</title><sec id="S13"><title>Model architecture and training</title><p id="P53">The complete dynamics of each model architecture that we consider (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S1</xref>; no feedback, readout feedback, cerebellar feedback, no feedback with cerebellar readout) are given in <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>. In all of our simulations we use a recurrent neural network (RNN) with 50 time-discrete units (see section below).</p><p id="P54">Unless otherwise stated, the feedforward cerebellar network contains a single hidden layer with 1000 units (granule cells), but other hidden layer sizes are also considered (<xref ref-type="fig" rid="F2">Figs. 2D</xref> and <xref ref-type="fig" rid="F4">4E</xref>). This yields a divergence from the cortical RNN to the cerebellar granular layer of 50:1000 = 1:20. The cerebellar output layer, which we interpret as Purkinje cells, on the other hand, mirrors the desired task outcome and is therefore of significantly lower dimensionality (3 in evidence accumulation task and 2 in all other tasks).</p><p id="P55">For each task simulation, network parameters are initialised as follows. The RNN input, recurrent and cerebellar feedback weights <italic>W</italic><sub><italic>ih</italic></sub>, <italic>W</italic><sub><italic>hh</italic></sub>, <italic>W</italic><sub><italic>𝒞h</italic></sub> are drawn from a uniform distribution <italic>W</italic> <sup>init</sup> ∼ <italic>𝒰</italic> (<italic>−a, a</italic>) where <inline-formula><mml:math id="M7"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>RNN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula>. The readout weights <italic>W</italic><sub>rdt</sub> and cerebellar weights, <italic>W</italic><sub>MF</sub>, <italic>W</italic><sub>PF</sub>, are initialised according to <italic>𝒰</italic>(<italic>−b</italic><sub><italic>k</italic></sub>, <italic>b</italic><sub><italic>k</italic></sub>) where <italic>b</italic><sub><italic>k</italic></sub> denotes the “kaiming bound” He et al.<sup><xref ref-type="bibr" rid="R84">84</xref></sup> (slope <inline-formula><mml:math id="M8"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt></mml:math></inline-formula>). The biases of the cortical readout are drawn from <inline-formula><mml:math id="M9"><mml:mi mathvariant="script">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>n</italic><sub>in</sub> denotes the input size of the layer. In line with existing models of cortical networks<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, in our model we do not obey Dale’s law and use a tanh activation function. In future work it would be of interest to test a variant of our model with explicit excitatory and inhibitory cortical populations. We conducted each task simulation with 5 random seeds for initialisation.</p><p id="P56">During the learning of a task model parameters are updated using gradient descent from the task error signal <italic>E</italic> = ∑<sub><italic>t</italic></sub> <italic>E</italic><sub><italic>t</italic></sub> with respect to to the model parameters (see section below). For each dataset each training session covers 1000 random examples, presented to the model in batch sizes of 10 which we call a “trial”. The test set (used after training) also covers 1000 randomly generated examples. When analysing the learned network dynamics (e.g. model output with and without cerebellar ablation) the model with the best validation error during training was selected. An ADAM optimiser<sup><xref ref-type="bibr" rid="R85">85</xref></sup> was used with initial learning rate <italic>η</italic> = 0.001 for the RNN (when plastic), readout and cerebellar network, except for the delayed association task for which we found an RNN learning rate of <italic>η</italic> = 0.0025 to provide more stable learning. The different plasticity constraints of the entire model - termed “fixed RNN”, “input plastic”, and “fully plastic” - are defined with respect to the cortical parameters of <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref> as follows. For the fixed RNN case, only the cortical readout weights <italic>W</italic><sub>rdt</sub> are learned. For the input plastic case, RNN input weights and <italic>W</italic><sub><italic>ih</italic></sub> and <italic>W</italic><sub><italic>𝒞h</italic></sub> are also learned. Finally, for the fully plastic case, the recurrent weight <italic>W</italic><sub><italic>hh</italic></sub> is also learned. In all of these cases the cerebellar “parallel fibres” <italic>W</italic><sub>PF</sub> are learned, whilst the “mossy fibres” <italic>W</italic><sub>MF</sub> remain constant, in line with mossy fibres synapses being (relatively) stable<sup><xref ref-type="bibr" rid="R33">33</xref>,<xref ref-type="bibr" rid="R86">86</xref></sup>.</p><p id="P57">In each of the considered tasks we report the change in error during and after training as a result of cerebellar feedback (<xref ref-type="fig" rid="F2">Figs. 2L</xref>,<xref ref-type="fig" rid="F4">4I</xref>,<xref ref-type="fig" rid="F5">5H</xref>,<xref ref-type="fig" rid="F6">6I</xref>,). The change in error during training is computed as the average difference in training error between the cerebellar feedback and no feedback models. The change in error after training is computed as the average difference in test error between a trained cerebellar feedback model, and a trained cerebellar feedback model subject to cerebellar ablation. As in the main results this cerebellar ablation after training may be transient. In particular, for the line drawing and digit drawing tasks we consider transient ablation during the middle period of the task, for the delayed association task we consider transient ablation as <xref ref-type="fig" rid="F6">Fig. 6D-G</xref>, and for the evidence accumulation task we consider full cerebellar ablation.</p><sec id="S14"><title>Continuous dynamics of RNN model</title><p id="P58">A continuous version of our RNN can be expressed as <disp-formula id="FD3"><label>(3)</label><mml:math id="M10"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mstyle><mml:mtext mathvariant="bold">x</mml:mtext></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mspace width="0.2em"/><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle><mml:mtext mathvariant="bold">z</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>rdt</mml:mtext></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>τ</italic><sub><italic>M</italic></sub> is the membrane time constant (not to be confused with the cerebellar time window <italic>τ</italic>), <italic>R</italic><sub><italic>m</italic></sub> is the membrane resistance, and <italic>f</italic> is the rate-based non-linearity which we set as <italic>f</italic> = tanh. Discretising <xref ref-type="disp-formula" rid="FD3">Eqs. 3</xref> with timesteps of Δ<italic>t</italic> yields equations in <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>, where <inline-formula><mml:math id="M11"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. Note that as in<sup><xref ref-type="bibr" rid="R38">38</xref></sup> we ignore the (1 <italic>− α</italic>)<italic>R</italic><sub><italic>m</italic></sub>. This simplifies notation and has no effect on dynamics if model weights are scaled accordingly. In general we use <italic>τ</italic><sub><italic>M</italic></sub> <italic>≈</italic> 20ms and Δ<italic>t</italic> = 50ms for the drawing tasks (<xref ref-type="fig" rid="F2">Figs. 2</xref>,<xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="fig" rid="F4">4</xref>) and a higher <italic>τ</italic><sub><italic>M</italic></sub> <italic>≈</italic> 90ms with Δ<italic>t</italic> = 200ms for the cognitive tasks (<xref ref-type="fig" rid="F5">Figs. 5</xref>,<xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>) in line with<sup><xref ref-type="bibr" rid="R6">6</xref></sup>). In both cases this gives us a cortical internal memory <italic>α</italic> = 0.1.</p></sec></sec><sec id="S15"><title>Cortical and cerebellar learning rules</title><p id="P59">When the desired task outcome <bold>y</bold><sub><italic>t</italic></sub> is provided the associated error is computed as <italic>E</italic><sub><italic>t</italic></sub> = <italic>ℰ</italic>(<bold>z</bold><sub><italic>t</italic></sub>, <bold>y</bold><sub><italic>t</italic></sub>) for the cortical network and <inline-formula><mml:math id="M12"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mo>𝒞</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ℰ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> for the cerebellar network, where <italic>E</italic> denotes the task error function (mean squared error and cross-entropy loss for regression and classification tasks respectively) and <italic>τ</italic> is the cerebellar time window. The error gradients for the readout and cerebellar weights <italic>W</italic><sub>rdt</sub>, <italic>W</italic><sub>PF</sub> can then be obtained locally with a simple delta-rule on the gradient of the error signal. That is, <disp-formula id="FD4"><label>(4)</label><mml:math id="M13"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>rdt</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>rdt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mtext>z</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>PF</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mi>t</mml:mi><mml:mo>𝒞</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>PF</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>E</mml:mi><mml:mo>𝒞</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mtext>c</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle><mml:mtext mathvariant="bold">G</mml:mtext></mml:mstyle><mml:msubsup><mml:mstyle><mml:mtext mathvariant="bold">C</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>⊤</mml:mo></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>η</italic> denotes the learning rate of the cortico-cerebellar network and <bold>GC</bold> denotes the hidden granule cell activity of the cerebellar network which is computed as <bold>GC</bold><sub><italic>t</italic></sub> = <italic>f</italic> <sup><italic>𝒞</italic></sup> (<italic>W</italic><sub>MF</sub><italic>f</italic> (<bold>h</bold><sub><italic>t−</italic>1</sub>)) (cf. <xref ref-type="disp-formula" rid="FD2">Eq. 2</xref>).</p><p id="P60">For the input/recurrent weights <italic>W</italic><sub><italic>ih</italic></sub>, <italic>W</italic><sub><italic>𝒞h</italic></sub>, <italic>W</italic><sub><italic>hh</italic></sub> - when plastic - obtaining error gradients is more diffcult as temporal dependencies need to be considered. To improve biological feasibility in this work we avoid backpropagation through time (BPTT) and instead use the eprop algorithm<sup><xref ref-type="bibr" rid="R38">38</xref></sup>. Details can be found in<sup><xref ref-type="bibr" rid="R38">38</xref></sup>, but the main idea is that BPTT can be approximated with a mixture of locally computed synaptic eligibility traces and current learning signal. Specifically, the error gradient for a given synapse <italic>w</italic><sub><italic>ji</italic></sub> from neuron <italic>i</italic> to <italic>j</italic> is computed as <disp-formula id="FD5"><label>(5)</label><mml:math id="M14"><mml:mtext>Δ</mml:mtext><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mi>t</mml:mi></mml:munder><mml:msubsup><mml:mi>L</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula> where for ease of notation we now use the superscript to denote timestep <italic>t</italic> and <inline-formula><mml:math id="M15"><mml:msubsup><mml:mi>L</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:math></inline-formula> is the neuron <italic>j</italic> learning signal (obtained by one-step backpropagation through space except for the cerebellar readout architecture in <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S1D</xref>). <inline-formula><mml:math id="M16"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math></inline-formula> is the synaptic eligibility trace of <italic>w</italic><sub><italic>ji</italic></sub> which is computed as defined recursively by <disp-formula id="FD6"><label>(6)</label><mml:math id="M17"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula> where <inline-formula><mml:math id="M18"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math></inline-formula> is initialised as zero. Note that the terms in <xref ref-type="disp-formula" rid="FD6">Eq. 6</xref> are locally available to the synapse. In the case of our network dynamics (<xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>), the eligibility trace is simply defined by <inline-formula><mml:math id="M19"><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, where <italic>a</italic><sub><italic>i</italic></sub> is the activation of the presynaptic neuron <italic>i</italic> (e.g. tanh(<italic>h</italic><sub><italic>i</italic></sub>) or <italic>c</italic><sub><italic>i</italic></sub>).</p><p id="P61">For all weights, the error gradients are accumulated across multiple examples (i.e. batch update) and timesteps before the weights themselves are updated.</p><sec id="S16"><title>Learning rules for cerebellar-to-cortical consolidation</title><p id="P62">A period of “consolidation” is considered for the trained models of the delayed association task (<xref ref-type="fig" rid="F7">Fig. 7</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S18</xref>). During this period the model is presented with further trials (batch size 10) of training data but without their associated targets. The forward dynamics of the model then run as normal (<xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>) but now we use a consolidation learning rule for the RNN weights. We consider both an optimal learning rule which uses the least-squares algorithm and also a simple biological learning rule.</p><p id="P63">We first present the optimal consolidation learning rule, since this motivates the biological rule. We want to change the recurrent (cortico-cortical) input to match the cerebellar-cortico input over the task. To this end we concatenate the time-dependent RNN activities <inline-formula><mml:math id="M20"><mml:mstyle><mml:mtext mathvariant="bold">H</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mo>⊕</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and cerebellar output activities <inline-formula><mml:math id="M21"><mml:mtext>C</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mo>⊕</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, where ⊕ denotes vector concatenation. We then set the change in recurrent weight Δ<sup>cons</sup> <italic>W</italic><sub><italic>hh</italic></sub> with <inline-formula><mml:math id="M22"><mml:msup><mml:mtext>Δ</mml:mtext><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>q</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup></mml:math></inline-formula> where <inline-formula><mml:math id="M23"><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:math></inline-formula> consolidation learning rate and <italic>F</italic> <sup>lsq</sup> is the least-squares solution <disp-formula id="FD7"><label>(7)</label><mml:math id="M24"><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mtext>lsq</mml:mtext></mml:mrow></mml:msup><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">H</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mtext>C</mml:mtext><mml:mo>.</mml:mo></mml:math></disp-formula> At the same time the cerebellar-cortical weights <italic>W</italic><sub><italic>𝒞h</italic></sub> decay according to <disp-formula id="FD8"><label>(8)</label><mml:math id="M25"><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M26"><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:math></inline-formula> is the rate of cerebellar-cortical decay. In the experiments shown we select <inline-formula><mml:math id="M27"><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula>.</p><p id="P64">For the biological learning rule, the cerebellar-cortical weight decays as in <xref ref-type="disp-formula" rid="FD8">Eq. 8</xref> but now the RNN weights are updated according to the ratio of cerebellar feedback against the whole population activity. That is, for the recurrent weight from neuron <italic>i</italic> to neuron <italic>j</italic> we have <disp-formula id="FD9"><label>(9)</label><mml:math id="M28"><mml:msup><mml:mi>Δ</mml:mi><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>cerebellar</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>input</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>total</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>RNN</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>activity</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mi>∑</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>f</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula> for arbitrary timestep <italic>t</italic> and where <inline-formula><mml:math id="M29"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math></inline-formula> denotes the <italic>j</italic>th row of the cerebellar-cortical weight <italic>W</italic><sub><italic>𝒞h</italic></sub>.</p><p id="P65">To demonstrate that <xref ref-type="disp-formula" rid="FD9">Eq. 9</xref> leads to changes in cortico-cortico input which are proportional to the cerebellar-cortical input, we see that the change in recurrent input to a given RNN neuron <italic>j</italic> at time <italic>t</italic> becomes <disp-formula id="FD10"><mml:math id="M30"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mspace width="0.2em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mspace width="0.2em"/></mml:munder><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>RNN</mml:mtext></mml:mrow></mml:munder><mml:mtext>Δ</mml:mtext><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>RNN</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mtext>RNN</mml:mtext></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mtext>RNN</mml:mtext></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>RNN</mml:mtext></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mspace width="0.2em"/></mml:munder></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P66">That is, we recover a solution (up to proportionality) to <xref ref-type="disp-formula" rid="FD7">Eq. 7</xref>. For this biological learning rule, to improve network stability, we found it beneficial to increase the RNN consolidation learning rate such that <inline-formula><mml:math id="M31"><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mtext>RNN</mml:mtext></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>cons</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:math></inline-formula> (where Δ<sup>cons</sup>
<italic>w</italic><sub><italic>ij</italic></sub> is accumulated over the whole sequence). This explains the initially faster learning (over the first few trials) for the biological learning rule (<xref ref-type="fig" rid="F7">Fig. 7F</xref>).</p><p id="P67">For this consolidation learning period a learning optimiser is not used (i.e. ADAM is not used). Note that these consolidation learning rules do not require information about the desired task outcome (i.e. target) and are in that sense unsupervised.</p></sec><sec id="S17"><title>Demixed principal component analysis</title><p id="P68">To study the response dynamics specific to task variables in the delayed association task (<xref ref-type="fig" rid="F6">Fig. 6</xref>) we perform demixed principal component analysis (dPCA)<sup><xref ref-type="bibr" rid="R63">63</xref></sup>. dPCA extracts low-dimensional components that explain maximum population variance constrained by task-specific variables. As a result we obtain principal components that are specific to task variables; in this case the task variable of interest is animal/model choice. The neural data we provide as input to dPCA is a three-dimensional array (<italic>n, s, t</italic>) with each dimension representing average neuronal activity (concatenated across animals/seeds), choice identity and time, respectively. dPCA is applied to the model representations (after learning) and neural data acquired in<sup><xref ref-type="bibr" rid="R25">25</xref></sup>.</p></sec></sec><sec id="S18"><title>Task details</title><sec id="S19"><label>1</label><title>Line drawing task</title><p id="P69">For the line drawing task, the model has to transform one of six possible 10-dimensional binary inputs <bold>x</bold> ∈ [0, <xref ref-type="bibr" rid="R1">1</xref>]<sup>10</sup> at timestep 1 into an associative “go” 2-dimensional line <bold>y</bold><sup>line</sup> (for five of the inputs) or a “no-go” stay at the origin (for one of the inputs). The starting point for each line is the origin, and the endpoints of each line are evenly spaced on the edge of the unit circle (see <xref ref-type="fig" rid="F2">Fig. 2A</xref>, black dashed line). The model learns to draw the line over 20 discrete timesteps, with the intermediate target points spaced evenly, i.e. for a line with endpoint <italic>y</italic><sub>end</sub> we have <inline-formula><mml:math id="M32"><mml:msup><mml:mstyle><mml:mtext mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>19</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>19</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>19</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>19</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p id="P70">For the stimulus timestep (timestep 1) as well as the remaining 19 timesteps, the model receives (through its <italic>W</italic><sub><italic>ih</italic></sub> connection) zero-mean Gaussian noise <italic>ξ</italic> ∼ <italic>N</italic> (0; 0.1<sup>2</sup>). Model errors are computed as the mean-squared error to the target response. Unless otherwise stated a cerebellar time window <italic>τ</italic> = 3 timesteps (<italic>≈</italic> 150ms when <italic>α</italic> = 0.1) is used. The prediction error across time delay <italic>t</italic><sub>0</sub> between cortical output and cerebellar (or cortical) output (<xref ref-type="fig" rid="F2">Fig. 2E</xref>) is computed as the cue/time average <inline-formula><mml:math id="M33"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">z</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>, where ||.|| is the Euclidean norm.</p><p id="P71">To analyse the effects of cerebellar ablation we consider partial cerebellar ablation at the start, middle, and end of the sequence (<xref ref-type="fig" rid="F2">Fig. 2h-k</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S5</xref>). The specific time windows of these ablation periods are timesteps [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R8">8</xref>–<xref ref-type="bibr" rid="R13">13</xref>, <xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R20">20</xref>] (inclusive), respectively.</p><sec id="S20"><title>Curl-ield variant</title><p id="P72">Once the models of the line drawing task are trained, we tested whether they could re-translate the same external inputs to a curl-field variant of the task (see e.g.<sup><xref ref-type="bibr" rid="R54">54</xref></sup>). For this we selected models with cortical internal memory <italic>α</italic> = 0.5, since we found this resulted in faster learning which was comparable to the presented experimental data<sup><xref ref-type="bibr" rid="R54">54</xref></sup>, but we find <italic>α</italic> = 0.1 (as presented in <xref ref-type="fig" rid="F2">Fig. 2</xref>) also learns but more slowly. Switching and learning this curl-field new task “context” involved retraining the models to new desired outcomes (central grey curves in <xref ref-type="fig" rid="F3">Fig. 3C</xref>).</p><p id="P73">Specifically, the curl-field target responses have the same end-point for each line (or same “no-go” zero cue), but intermediate target points now form a semi-ellipse between the origin and the respective end-point. Given the desired endpoint <inline-formula><mml:math id="M34"><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mrow><mml:mtext>end</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, this can be parameterised by <disp-formula id="FD11"><label>(10)</label><mml:math id="M35"><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mtext>end</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>cos</mml:mi><mml:mi>θ</mml:mi><mml:mi>cos</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>sin</mml:mi><mml:mi>θ</mml:mi><mml:mi>sin</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mtext>end</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>sin</mml:mi><mml:mi>θ</mml:mi><mml:mi>cos</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>cos</mml:mi><mml:mi>θ</mml:mi><mml:mi>sin</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M36"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the angle to the end point and <italic>t</italic> runs uniformly between 0 and <italic>π</italic> (or, for direction towards (<italic>x</italic><sub>end</sub>, <italic>y</italic><sub>end</sub>) as in our experiments, from <italic>π</italic> to 2<italic>π</italic>).</p><p id="P74">To test how context-dependent cerebellar processing could enable rapid task switching, we considered the extent to which parallel fibre (PF) weights are shared across task contexts. In particular, we label the percentage of PFs used for each context as the PF task overlap. For example, if the PF task overlap is 25%, then 25% of the PFs used for cerebellar processing apply to both task contexts, whilst 75% specifically apply (and are trained) to the current context. Before learning, the PFs which are not shared (i.e. only apply to the curl-field context) are initialised randomly as in the original line-drawing task.</p></sec><sec id="S21"><title>Neuronal activity and covariance during task switching</title><p id="P75">The change in activities and change in covariances (<xref ref-type="fig" rid="F3">Fig. 3D-F</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S7</xref>) are computed as in<sup><xref ref-type="bibr" rid="R58">58</xref></sup>. We record the RNN time-dependent activities (post non-linearity) given 1000 input examples in multiple periods: task 1 baseline, task 2 and task 1 switching (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). For the latter two periods these are recorded at their respective end, whilst we take two samples of the baseline period at its start and end. The change in activity between any two periods <italic>P</italic>1 and <italic>P</italic>2 is the average change in activity for a given neuron <italic>i</italic>, which is given by <disp-formula id="FD12"><label>(11)</label><mml:math id="M37"><mml:msubsup><mml:mtext>Δ</mml:mtext><mml:mrow><mml:mtext>act</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula> where <inline-formula><mml:math id="M38"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M39"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are the time-varying input-dependent activities of neuron <italic>i</italic> for periods <italic>P</italic>1, <italic>P</italic>2 respectively, and std<sub><italic>i</italic></sub> is the standard deviation of that neuron in the start of the task 1 baseline period. Here |.| denotes the average (absolute) difference in activity across timesteps and input examples.</p><p id="P76">For each period, we also compute the covariance matrix of the RNN population. The change in covariance between two sessions <inline-formula><mml:math id="M40"><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mtext>COV</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is then computed as 1 minus the Pearson correlation between their respective covariance matrices<sup><xref ref-type="bibr" rid="R58">58</xref></sup>.</p><p id="P77">For the task 2 and task 1 switching periods we report changes with respect to the start of the task 1 baseline period. To account for natural variability in the network and better compare to the neural data in<sup><xref ref-type="bibr" rid="R54">54</xref></sup>, we normalise the changes by taking away the changes observed within the baseline period itself. For example, the change in covariance in the task 2 period is <inline-formula><mml:math id="M41"><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Δ</mml:mi><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <italic>B</italic>1, <italic>B</italic>2, <italic>T</italic> 2 are the start of the task 1 baseline, end of task 1 baseline, and (end of) task 2 respectively. We apply the same normalisation to the reported experimental changes in the monkey M1 and PmD<sup><xref ref-type="bibr" rid="R54">54</xref></sup>; this normalisation leads to (average) near-zero change for the M1 activity and PmD (<xref ref-type="fig" rid="F3">Fig. 3F</xref>).</p><p id="P78">The number of training trials for training in task 2 shown in <xref ref-type="fig" rid="F3">Fig. 3A</xref> (500 trials) leads to good, but not perfect, performance. To demonstrate that the models can eventually perform task 2 to a close to perfect standard, the model outputs presented in <xref ref-type="fig" rid="F3">Fig. 3C</xref> underwent 1000 trials of training.</p></sec></sec><sec id="S22"><label>2</label><title>Digit drawing task</title><p id="P79">For the digit drawing task the inputs are the same as the 10-dimensional binary vectors used in the line drawing task, except now the model must draw an associative digit over 20 timesteps instead of line (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). The targets <bold>y</bold>
<sup>digit</sup> are constructed manually within the space [0, <xref ref-type="bibr" rid="R1">1</xref>]<sup>2</sup> and resemble the digits from 0 to 5 (inclusive). For exact implementation refer to the provided code (see below).</p><p id="P80">For the standard model with cerebellar feedback a cerebellar time window <italic>τ</italic> = 3 timesteps (<italic>≈</italic> 150ms when <italic>α</italic> = 0.1) is generally used. For the model using cerebellar feedback with a temporal basis, we model the cerebellum with a range of time windows, i.e. <italic>τ</italic> = {<italic>τ</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic></sub> for some distinct <italic>τ</italic><sub><italic>i</italic></sub> ≥ 0ms. In this task we consider <inline-formula><mml:math id="M42"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> with <italic>τ</italic><sub><italic>i</italic></sub> = <italic>i</italic> timesteps (i.e. 0-250ms), so that the final cerebellar output is a concatenation of task predictions which span over the proceeding 250ms period. Explicitly, after training we have cerebellar feedback, <inline-formula><mml:math id="M43"><mml:msub><mml:mtext>c</mml:mtext><mml:mi>t</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msubsup><mml:mo>⊕</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mtext>y</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where ⊕ denotes vector concatenation.</p><p id="P81">Zero-mean Gaussian noise <italic>ξ</italic> ∼ <italic>𝒩</italic> (0; 0.1<sup>2</sup>) is added to the input at each timestep. Model errors are computed as the mean-squared error to the target response.</p><p id="P82">To analyse the effects of cerebellar ablation we consider the same partial cerebellar ablation periods as in the line-drawing task. That is, we consider cerebellar ablation at the start, middle, and end of the sequence (<xref ref-type="fig" rid="F4">Fig. 4</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S9</xref>), which correspond to timesteps [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R8">8</xref>–<xref ref-type="bibr" rid="R13">13</xref>, <xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R20">20</xref>] (inclusive), respectively.</p></sec><sec id="S23"><label>3</label><title>Evidence accumulation task</title><p id="P83">In the evidence accumulation task the model receives 2-dimensional binary inputs (i.e. <bold>x</bold> ∈ [0, <xref ref-type="bibr" rid="R1">1</xref>]<sup>2</sup>) over a presentation period of <italic>T</italic> <sup>pres</sup> = 45 timesteps. A non-zero input can occur for at most one of the two dimensions; that is, <italic>x</italic><sub><italic>t</italic></sub> ∈ {(1 0)<sup>⊤</sup>, (0 1)<sup>⊤</sup>, (0 0)<sup>⊤</sup>}, where the rate of zero inputs <italic>x</italic><sub><italic>t</italic></sub> = (0 0)<sup>⊤</sup> defines the sparsity of input <italic>ρ</italic> (<italic>ρ</italic> = 0.7 in our simulations). After this presentation of input there is then a delay period of <italic>T</italic> <sup>del</sup> = 5 timesteps after which the model must classify at which dimension more non-zero input was received (or whether the number at each dimension was the same). That is, the desired outcome <italic>y</italic> takes one of three values which respectively correspond to more input in the first dimension, more input in the second dimension, or the same. This task resembles the experimental structure of<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, in which mice were trained to select the side of their whiskers which received more air puffs.</p><p id="P84">Zero-mean Gaussian noise <italic>ξ</italic> ∼ <italic>N</italic> (0; 0.1<sup>2</sup>) is added to the input at each timestep. Model errors are defined by the cross-entropy loss to the target response.. Model “belief” (<xref ref-type="fig" rid="F5">Figs 5D</xref> and <xref ref-type="supplementary-material" rid="SD1">S11</xref>) is defined as the model probability (obtained by applying a softmax on the readout) of the correct classification. Unless otherwise stated a cerebellar time window <italic>τ</italic> = 3 timesteps (<italic>≈</italic> 600ms when <italic>α</italic> = 0.1) is used. For both readout and cerebellar feedback models, we apply a softmax operation to the feedback returned to the RNN so as to bound its values between 0 and 1.</p><p id="P85">To analyse the effects of cerebellar ablation we consider full cerebellar ablation (for the entire sequence 1-50; see <xref ref-type="fig" rid="F5">Fig. 5D</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S11A-C</xref>, left) and also partial periods of ablation: at the start, middle, and end of the sequence (<xref ref-type="fig" rid="F5">Fig. 5E,F</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S11A-C</xref>, right). The specific time windows of these partial ablation periods are timesteps [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R45">45</xref>] (inclusive), respectively. To improve readability of our results, the mean error presented in the training curves for this task is smoothed using a Savitzky-Golay filter with window length 25 and polynomial order 3.</p><p id="P86">To compute the dependence of model choice on inputs over different temporal bins (<xref ref-type="fig" rid="F5">Fig. 5F</xref>), we follow the method in<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. In particular, we divide the presentation period evenly into 3 time windows - [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R31">31</xref>–<xref ref-type="bibr" rid="R45">45</xref>] - and fit the model choice according to a logistic regression model <disp-formula id="FD13"><label>(12)</label><mml:math id="M44"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>ŷ</italic> denotes the predicted model choice probability, <italic>S</italic> is the sigmoid logistic function, <italic>E</italic><sub><italic>i</italic></sub> = #<italic>R</italic><sub><italic>i</italic></sub> <italic>−</italic> #<italic>L</italic><sub><italic>i</italic></sub> is the different in the total number of ‘right’ and ‘left’ inputs in window <italic>i</italic>, and <italic>β</italic><sub><italic>i</italic></sub> is the respective weight on that window. <italic>ŷ</italic> is fitted to minimise the negative log likelihood of the observed model decisions. We present the normalised weights of each window <inline-formula><mml:math id="M45"><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p><sec id="S24"><title>History-centric cases</title><p id="P87">In line with<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, we observe cerebellar ablation to be particularly detrimental to input examples for which correct classification would depend on adequately maintaining past inputs (<xref ref-type="fig" rid="F5">Fig. 5E,F</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S11</xref>), which we refer to as “history-centric” examples. We define an input example as being history-centric if exposure only to the final third of the input sequence would lead strictly to the wrong answer. That is, examples (<bold>x</bold>, <italic>y</italic>) such that the “final-third target” <inline-formula><mml:math id="M46"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext>final</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>third</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is not equal to the desired outcome <inline-formula><mml:math id="M47"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext>final</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>third</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="S25"><title>Sub-second task lengths</title><p id="P88">To identify whether dependency on cerebellar feedback holds for shorter timescales, we consider cue presentation periods from 0.1 <italic>−</italic> 1s (<xref ref-type="fig" rid="F5">Fig. 5G</xref>). For these simulations there is no delay period and the sparsity of input is <italic>ρ</italic> = 0.5. We apply a finer time discretisation so that Δ<italic>t</italic> = 10ms; we redefine the cortical internal memory <italic>α</italic> and rescale the network parameters accordingly. The cerebellar network is trained with a time window <italic>τ</italic> = 3 timesteps in each case.</p></sec></sec><sec id="S26"><label>4</label><title>Delayed association task</title><p id="P89">In the delayed association task the model must associate one of two 10-dimensional binary inputs at timestep 1 to a desired binary response <italic>y</italic> at timestep <italic>T</italic>, where <italic>T</italic> is the sequence length or “delay” period<sup><xref ref-type="bibr" rid="R25">25</xref></sup>. We select <italic>T</italic> = 15 timesteps but also consider other lengths (<xref ref-type="fig" rid="F6">Fig. 6J</xref>). The task error (as presented in the main text) is defined at the end of the sequence. For stability, we train the network output 5 timesteps from the end of the sequence (timestep 10 onwards when <italic>T</italic> = 15).</p><p id="P90">Zero-mean Gaussian noise <italic>ξ</italic> ∼ <italic>𝒩</italic> (0; 0.1<sup>2</sup>) is added to the input at each timestep. Model errors are defined by the cross-entropy loss to the target response. Model “selectivity” is defined as the model output (readout) at the dimension of the correct classification (prior to the softmax operation). Unless otherwise stated a cerebellar time window <italic>τ</italic> = 3 timesteps (<italic>≈</italic> 600ms when <italic>α</italic> = 0.1) is used. For both readout and cerebellar feedback models, we apply a softmax operation to the feedback returned to the RNN so as to bound its values between 0 and 1.</p><p id="P91">To analyse the effects of cerebellar ablation we consider cerebellar ablation within a particular time window between timesteps 8-12 (inclusive) which approximately mirrors the timings in<sup><xref ref-type="bibr" rid="R25">25</xref></sup> (<xref ref-type="fig" rid="F6">Fig. 6D,E</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S17</xref>) and also partial ablation periods during the start, middle, and end of the sequence (<xref ref-type="fig" rid="F6">Fig. 6F</xref>). The specific time windows of these partial ablation periods are timesteps [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R11">11</xref>–<xref ref-type="bibr" rid="R15">15</xref>], respectively. To improve readability of our results, the mean error presented in the training curves for this task is smoothed using a Savitzky-Golay filter with window length 25 and polynomial order 3.</p><p id="P92">For this task we consider how the model evolves during a consolidation period (<xref ref-type="fig" rid="F7">Fig. 7</xref>). At the end of each consolidation trial we observe the model error (<xref ref-type="fig" rid="F7">Fig. 7B</xref>), activity (<xref ref-type="fig" rid="F7">Fig. 7E</xref>) and recurrent input (<xref ref-type="fig" rid="F7">Fig. 7F</xref>) over a test set of 1000 randomly generated examples. The activity here is the concatenation of activity in the cortical RNN and the hidden layer of the cerebellar network (over all examples and timesteps). We compute the cosine similarity between these activities and the initial activities prior to consolidation; for comparison we also the cosine similarity been the initial activities and a shuffed version of the initial activities (averaged over 100 samples). To analyse how the recurrent input changes we proceed as follows. At each timestep we consider the cortical RNN state <bold>h</bold> and cerebellar feedback <bold>c</bold>. We then compute the cosine similarity between <italic>W</italic><sub><italic>hh</italic></sub><bold>h</bold> and <inline-formula><mml:math id="M48"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo>+</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mtext>c</mml:mtext></mml:math></inline-formula>, where <inline-formula><mml:math id="M49"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:math></inline-formula> are the pre-consolidation RNN weights and cerebellar-cortical weights, respectively.</p></sec></sec><sec id="S27"><title>Control-theoretic estimation of cerebellar feedback</title><p id="P93">For the delayed association task we analyse cerebellar-to-cortical input from a control-theoretic point of view. In particular, we quantify the effect of plasticity in the pathway between the cerebellar network and cortical RNN (<italic>W</italic><sub><italic>𝒞</italic></sub><italic>h</italic>) on cortical activations by estimating the energy cerebellar feedback induces in RNN state space<sup><xref ref-type="bibr" rid="R62">62</xref></sup>. This level of energy reflects the potency of feedback onto the RNN: a low energy would reveal a suppressed RNN response, whereas a high energy would reveal an amplified response. We speculated that these two cases would arise from a non-optimised <italic>W</italic><sub><italic>𝒞⟨</italic></sub> and optimised <italic>W</italic><sub><italic>𝒞⟨</italic></sub>, respectively (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S15A</xref>).</p><p id="P94">As per Kao and Hennequin<sup><xref ref-type="bibr" rid="R62">62</xref></sup>, we compute the energy of cerebellar feedback through the <italic>controllability Gramian P</italic> associated with RNN dynamics. Informally, <italic>P</italic> describes the “intrinsic manifold” of the RNN and describes the directions in which the RNN is most (or least) likely to visit. Formally, given a direction <bold>v</bold> in state space, the average energy generated along direction <italic>v</italic> is <disp-formula id="FD14"><label>(13)</label><mml:math id="M50"><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">v</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mstyle><mml:mtext mathvariant="bold">v</mml:mtext></mml:mstyle><mml:mo>⊤</mml:mo></mml:msup><mml:mstyle><mml:mtext mathvariant="bold">P</mml:mtext><mml:mi>v</mml:mi></mml:mstyle><mml:mo>.</mml:mo><mml:mspace width="0.2em"/></mml:math></disp-formula></p><p id="P95">In general, the Gramian matrix <italic>P</italic> is only defined for linear systems. In this work we therefore generalise the notion of controllability for the non-linear RNN dynamics as defined in <xref ref-type="disp-formula" rid="FD1">Eq. 1</xref>. Here we use the noise covariance matrix ∑ in its place, which for linear systems is shown to be equivalent to the Gramian, ∑ = <italic>P</italic><sup><xref ref-type="bibr" rid="R62">62</xref></sup>. Explicitly, we compute ∑ as the time-course average covariance of RNN hidden activations <italic>h</italic><sub><italic>t</italic></sub> under noisy inputs which follow a Wiener process. That is, ∑ = 𝔼<sub><italic>t</italic></sub> [cov(<italic>H</italic><sub><italic>t</italic></sub>)] where <inline-formula><mml:math id="M51"><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi><mml:mi>N</mml:mi></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is a set of <italic>N</italic> samples of RNN states which each evolve according to <disp-formula id="FD15"><label>(14)</label><mml:math id="M52"><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">c</mml:mtext></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mspace width="0.2em"/><mml:mtext>Wiener</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>process</mml:mtext><mml:mspace width="0.2em"/></mml:math></disp-formula></p><p id="P96">In our experiments we use <italic>N</italic> = 500 samples and simulate <xref ref-type="disp-formula" rid="FD15">Eq. 14</xref>. To ignore intrinsic RNN transients that occur at the start of simulation, we discard the RNN states during the first 5 simulation timesteps when computing ∑. The energy generated from cerebellar feedback is then <italic>σ</italic>(<bold>h</bold><sup><italic>𝒞</italic></sup>) = (<bold>h</bold><sup><italic>𝒞</italic></sup>)<sup>⊤</sup>∑<bold>h</bold><sup><italic>𝒞</italic></sup>, where <inline-formula><mml:math id="M53"><mml:msup><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo>𝒞</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mtext>c</mml:mtext></mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mo>𝒞</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mtext>c</mml:mtext></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> is the normalised direction being driven by the cerebellum in RNN state space. We report the energy generated (during the noise dynamics of <xref ref-type="disp-formula" rid="FD15">Eq. 14</xref>) by cerebellar feedback at timestep 10, a time chosen strictly after the initial RNN transient phase (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. S15B</xref>). For comparison we compare this to the energy generated by 100 random sample directions <bold>v</bold> ∼ <italic>𝒩</italic> (0, <italic>I</italic>) where <italic>I</italic> is the identity matrix. To enable greater interpretability we then normalise these energies by its highest possible value max<sub>||<bold>v</bold>||=1</sub> <bold>v</bold><sup>⊤</sup>∑<bold>v</bold>; i.e. the input which elicits maximal amplification of RNN dynamics. This value can be computed as <bold>u</bold><sup>⊤</sup>∑<bold>u</bold> where <bold>u</bold> is the principal eigenvector of ∑.</p></sec><sec id="S28"><title>Cerebellum decodes low-signal cortical representations</title><p id="P97">For the delayed association task we discussed the need for a greater number of hidden cerebellar units (granule cells) to achieve good task performance (<xref ref-type="fig" rid="F6">Fig. 6J</xref>). In particular, we find that the number of granule cells (GCs) required is inversely proportional to the <italic>signal-to-noise</italic> (SNR) of the RNN hidden neurons.</p><p id="P98">To estimate SNR(RNN) in the models for the delayed association task (<xref ref-type="fig" rid="F6">Fig. 6K</xref>, left axis), we suppose that the activity population activity in the RNN can be divided into two components such that <italic>f</italic> (<bold>h</bold>) = <italic>ζ</italic> +<italic>ω</italic>, where <italic>ζ</italic> is a task-dependent component which depends on the current task condition <italic>s</italic> (i.e. left or right stimulus), and <italic>ω</italic> is a task agnostic component which does not depend on <italic>s</italic> (but instead depends on, for example, intrinsic RNN connectivity and noise). The SNR is then defined as the ratio of the variance of these two respective components: <inline-formula><mml:math id="M54"><mml:mi>SNR</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>RNN</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:math></inline-formula></p><p id="P99">We compute the variance of the task-agnostic component as the (average) variance of the population under the same task stimulus <italic>s</italic>, i.e. <inline-formula><mml:math id="M55"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>Var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>∣</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula>. Be equally calculating the total variance <inline-formula><mml:math id="M56"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>rnn</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">h</mml:mtext></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, the variance of the task-relevant component is then simply computed as the difference to the total variance, i.e. <inline-formula><mml:math id="M57"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>rnn</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. To determine the minimum number of granule cells required to decode the stimulus from the RNN activity (<xref ref-type="fig" rid="F6">Fig. 6K</xref>, right axis), we tested whether the cerebellar network could be trained to successfully discriminate the stimulus after 40 training sessions for varying quantities of granule cells (quantities as described below). The cerebellar network was deemed to successfully decode the stimulus if, for at least 4 of the 5 seeds, the average error during the last 4 training sessions was less than 5%.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS157211-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d21aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S29"><title>Acknowledgements</title><p>We would like to thank the Neural &amp; Machine Learning group, Ellen Boven, Aparna Suvrathan, James M Shine, Paul Dodson, Everton Agnes, Laureline Logiaco, Jake Stroud, James Bennett and Heike Stein for useful feedback. J.P. was funded by a EPSRC Doctoral Training Partnership award (EP/R513179/1), P.C. by the Wellcome Trust (209453/Z/17/Z) and R.P.C. by the Medical Research Council (MR/X006107/1), BBSRC (BB/X013340/1) and a ERC-UKRI Frontier Research Guarantee Grant (EP/Y027841/1). This work made use of the HPC system Blue Pebble at the University of Bristol, UK. We would like to thank Dr Stewart for a donation that supported the purchase of GPU nodes embedded in the Blue Pebble HPC system.</p></ack><sec id="S30" sec-type="data-availability"><title>Data and code availability</title><p id="P100">We used the PyTorch library for all neural network models. The code and respective simulated data used for our experiments is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/neuralml/ccLoops">https://github.com/neuralml/ccLoops</ext-link>.</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P101"><bold>Author contributions</bold></p><p id="P102">J.P. developed computational framework with guidance from R.P.C. J.P. performed all numerical and analytical work. J.P. and R.P.C. wrote the manuscript, with contributions from P.C. R.P.C supervised the project.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asaad</surname><given-names>Wael F</given-names></name><name><surname>Rainer</surname><given-names>Gregor</given-names></name><name><surname>Miller</surname><given-names>Earl K</given-names></name></person-group><article-title>Task-specific neural activity in the primate prefrontal cortex</article-title><source>Journal of neuro-physiology</source><year>2000</year><volume>84</volume><issue>1</issue><fpage>451</fpage><lpage>459</lpage><pub-id pub-id-type="pmid">10899218</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>Earl K</given-names></name><name><surname>Cohen</surname><given-names>Jonathan D</given-names></name></person-group><article-title>An integrative theory of prefrontal cortex function</article-title><source>Annual review of neuroscience</source><year>2001</year><volume>24</volume><issue>1</issue><fpage>167</fpage><lpage>202</lpage><pub-id pub-id-type="pmid">11283309</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanji</surname><given-names>Jun</given-names></name><name><surname>Hoshi</surname><given-names>Eiji</given-names></name></person-group><article-title>Role of the lateral prefrontal cortex in executive behavioral control</article-title><source>Physiological reviews</source><year>2008</year><volume>88</volume><issue>1</issue><fpage>37</fpage><lpage>57</lpage><pub-id pub-id-type="pmid">18195082</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansouri</surname><given-names>Farshad A</given-names></name><name><surname>Tanaka</surname><given-names>Keiji</given-names></name><name><surname>Buckley</surname><given-names>Mark J</given-names></name></person-group><article-title>Conflict-induced behavioural adjustment: a clue to the executive functions of the prefrontal cortex</article-title><source>Nature Reviews Neuroscience</source><year>2009</year><volume>10</volume><issue>2</issue><fpage>141</fpage><lpage>152</lpage><pub-id pub-id-type="pmid">19153577</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banerjee</surname><given-names>Abhishek</given-names></name><name><surname>Parente</surname><given-names>Giuseppe</given-names></name><name><surname>Teutsch</surname><given-names>Jasper</given-names></name><name><surname>Lewis</surname><given-names>Christopher</given-names></name><name><surname>Voigt</surname><given-names>Fabian F</given-names></name><name><surname>Helmchen</surname><given-names>Fritjof</given-names></name></person-group><article-title>Value-guided remapping of sensory cortex by lateral orbitofrontal cortex</article-title><source>Nature</source><year>2020</year><volume>585</volume><issue>7824</issue><fpage>245</fpage><lpage>250</lpage><pub-id pub-id-type="pmid">32884146</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>H Francis</given-names></name><name><surname>Yang</surname><given-names>Guangyu R</given-names></name><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></person-group><article-title>Reward-based training of recurrent neural networks for cognitive and value-based tasks</article-title><source>Elife</source><year>2017</year><volume>6</volume><elocation-id>e21492</elocation-id><pub-id pub-id-type="pmcid">PMC5293493</pub-id><pub-id pub-id-type="pmid">28084991</pub-id><pub-id pub-id-type="doi">10.7554/eLife.21492</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orhan</surname><given-names>A Emin</given-names></name><name><surname>Ma</surname><given-names>Wei Ji</given-names></name></person-group><article-title>A diverse range of factors affect the nature of neural representations underlying short-term memory</article-title><source>Nature neuroscience</source><year>2019</year><volume>22</volume><issue>2</issue><fpage>275</fpage><lpage>283</lpage><pub-id pub-id-type="pmid">30664767</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aoi</surname><given-names>Mikio C</given-names></name><name><surname>Mante</surname><given-names>Valerio</given-names></name><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name></person-group><article-title>Prefrontal cortex exhibits multidimensional dynamic encoding during decision-making</article-title><source>Nature Neuroscience</source><year>2020</year><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC7610668</pub-id><pub-id pub-id-type="pmid">33020653</pub-id><pub-id pub-id-type="doi">10.1038/s41593-020-0696-5</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>French</surname><given-names>Robert M</given-names></name></person-group><article-title>Catastrophic forgetting in connectionist networks</article-title><source>Trends in cognitive sciences</source><year>1999</year><volume>3</volume><issue>4</issue><fpage>128</fpage><lpage>135</lpage><pub-id pub-id-type="pmid">10322466</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klinzing</surname><given-names>Jens G</given-names></name><name><surname>Niethard</surname><given-names>Niels</given-names></name><name><surname>Born</surname><given-names>Jan</given-names></name></person-group><article-title>Mechanisms of systems memory consolidation during sleep</article-title><source>Nature neuroscience</source><year>2019</year><volume>22</volume><issue>10</issue><fpage>1598</fpage><lpage>1610</lpage><pub-id pub-id-type="pmid">31451802</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jedlicka</surname><given-names>Peter</given-names></name><name><surname>Tomko</surname><given-names>Matus</given-names></name><name><surname>Robins</surname><given-names>Anthony</given-names></name><name><surname>Abraham</surname><given-names>Wickliffe C</given-names></name></person-group><article-title>Contributions by metaplasticity to solving the catastrophic forgetting problem</article-title><source>Trends in Neurosciences</source><year>2022</year><pub-id pub-id-type="pmid">35798611</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flesch</surname><given-names>Timo</given-names></name><name><surname>Saxe</surname><given-names>Andrew</given-names></name><name><surname>Summerfield</surname><given-names>Christopher</given-names></name></person-group><article-title>Continual task learning in natural and artificial agents</article-title><source>Trends in Neurosciences</source><year>2023</year><pub-id pub-id-type="pmid">36682991</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>Larry</given-names></name><name><surname>Svoboda</surname><given-names>Karel</given-names></name></person-group><article-title>Brain-wide interactions between neural circuits</article-title><source>Current Opinion in Neurobiology</source><year>2020</year><volume>65</volume><issue>C</issue><pub-id pub-id-type="pmid">33357763</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaeger</surname><given-names>Herbert</given-names></name><name><surname>Haas</surname><given-names>Harald</given-names></name></person-group><article-title>Harnessing nonlinearity: Predicting chaotic systems and saving energy in wireless communication</article-title><source>science</source><year>2004</year><volume>304</volume><issue>5667</issue><fpage>78</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">15064413</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maass</surname><given-names>Wolfgang</given-names></name><name><surname>Joshi</surname><given-names>Prashant</given-names></name><name><surname>Sontag</surname><given-names>Eduardo D</given-names></name></person-group><article-title>Computational aspects of feedback in neural circuits</article-title><source>PLoS Comput Biol</source><year>2007</year><volume>3</volume><issue>1</issue><fpage>e165</fpage><pub-id pub-id-type="pmcid">PMC1779299</pub-id><pub-id pub-id-type="pmid">17238280</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020165</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sussillo</surname><given-names>David</given-names></name><name><surname>Abbott</surname><given-names>Larry F</given-names></name></person-group><article-title>Generating coherent patterns of activity from chaotic neural networks</article-title><source>Neuron</source><year>2009</year><volume>63</volume><issue>4</issue><fpage>544</fpage><lpage>557</lpage><pub-id pub-id-type="pmcid">PMC2756108</pub-id><pub-id pub-id-type="pmid">19709635</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2009.07.018</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Logiaco</surname><given-names>Laureline</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Escola</surname><given-names>Sean</given-names></name></person-group><article-title>Thalamic control of cortical dynamics in a model of flexible motor sequencing</article-title><source>Cell Reports</source><year>2021</year><volume>35</volume><issue>9</issue><elocation-id>109090</elocation-id><pub-id pub-id-type="pmcid">PMC8449509</pub-id><pub-id pub-id-type="pmid">34077721</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2021.109090</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kao</surname><given-names>Ta-Chu</given-names></name><name><surname>Sadabadi</surname><given-names>Mahdieh S</given-names></name><name><surname>Hennequin</surname><given-names>Guillaume</given-names></name></person-group><article-title>Optimal anticipatory control as a theory of motor preparation: A thalamo-cortical circuit model</article-title><source>Neuron</source><year>2021</year><volume>109</volume><issue>9</issue><fpage>1567</fpage><lpage>1581</lpage><pub-id pub-id-type="pmcid">PMC8111422</pub-id><pub-id pub-id-type="pmid">33789082</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2021.03.009</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maass</surname><given-names>Wolfgang</given-names></name><name><surname>Natschläger</surname><given-names>Thomas</given-names></name><name><surname>Markram</surname><given-names>Henry</given-names></name></person-group><article-title>Real-time computing without stable states: A new framework for neural computation based on perturbations</article-title><source>Neural computation</source><year>2002</year><volume>14</volume><issue>11</issue><fpage>2531</fpage><lpage>2560</lpage><pub-id pub-id-type="pmid">12433288</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Middleton</surname><given-names>Frank A</given-names></name><name><surname>Strick</surname><given-names>Peter L</given-names></name></person-group><article-title>Basal ganglia and cerebellar loops: motor and cognitive circuits</article-title><source>Brain research reviews</source><year>2000</year><volume>31</volume><issue>2-3</issue><fpage>236</fpage><lpage>250</lpage><pub-id pub-id-type="pmid">10719151</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramnani</surname><given-names>Narender</given-names></name></person-group><article-title>The primate cortico-cerebellar system: anatomy and function</article-title><source>Nature reviews neuroscience</source><year>2006</year><volume>7</volume><issue>7</issue><fpage>511</fpage><lpage>522</lpage><pub-id pub-id-type="pmid">16791141</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carlson</surname><given-names>Erik S</given-names></name><name><surname>Hunker</surname><given-names>Avery</given-names></name><name><surname>Sandberg</surname><given-names>Stefan G</given-names></name><name><surname>Locke</surname><given-names>Timothy M</given-names></name><name><surname>Geller</surname><given-names>Julianne</given-names></name><name><surname>Schindler</surname><given-names>Abigail</given-names></name><name><surname>Thomas</surname><given-names>Steven</given-names></name><name><surname>Darvas</surname><given-names>Martin</given-names></name><name><surname>Phillips</surname><given-names>Paul EM</given-names></name><name><surname>Zweifel</surname><given-names>Larry S</given-names></name></person-group><article-title>Catecholaminergic Innervation of the Lateral Nucleus of the Cerebellum Modulates Cognitive Behaviors</article-title><source>Journal of Neuroscience</source><year>2021</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/41/15/3512">https://www.jneurosci.org/content/early/2021/02/02/JNEUROSCI.2406-20.2021</ext-link> ISSN 0270-6474</comment><pub-id pub-id-type="pmcid">PMC8051686</pub-id><pub-id pub-id-type="pmid">33536201</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2406-20.2021</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>King</surname><given-names>Maedbh</given-names></name><name><surname>Hernandez-Castillo</surname><given-names>Carlos R</given-names></name><name><surname>Poldrack</surname><given-names>Russell A</given-names></name><name><surname>Ivry</surname><given-names>Richard B</given-names></name><name><surname>Diedrichsen</surname><given-names>Jörn</given-names></name></person-group><article-title>Functional boundaries in the human cerebellum revealed by a multi-domain task battery</article-title><source>Nature neuroscience</source><year>2019</year><volume>22</volume><fpage>1371</fpage><lpage>1378</lpage><pub-id pub-id-type="pmcid">PMC8312478</pub-id><pub-id pub-id-type="pmid">31285616</pub-id><pub-id pub-id-type="doi">10.1038/s41593-019-0436-x</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brissenden</surname><given-names>James A</given-names></name><name><surname>Tobyne</surname><given-names>Sean M</given-names></name><name><surname>Halko</surname><given-names>Mark A</given-names></name><name><surname>Somers</surname><given-names>David C</given-names></name></person-group><article-title>Stimulus-specific visual working memory representations in human cerebellar lobule VIIb/VIIIa</article-title><source>Journal of Neuroscience</source><year>2021</year><volume>41</volume><issue>5</issue><fpage>1033</fpage><lpage>1045</lpage><pub-id pub-id-type="pmcid">PMC7880273</pub-id><pub-id pub-id-type="pmid">33214320</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1253-20.2020</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>Zhenyu</given-names></name><name><surname>Davis</surname><given-names>Courtney</given-names></name><name><surname>Thomas</surname><given-names>Alyse M</given-names></name><name><surname>Economo</surname><given-names>Michael N</given-names></name><name><surname>Abrego</surname><given-names>Amada M</given-names></name><name><surname>Svoboda</surname><given-names>Karel</given-names></name><name><surname>De Zeeuw</surname><given-names>Chris I</given-names></name><name><surname>Li</surname><given-names>Nuo</given-names></name></person-group><article-title>A cortico-cerebellar loop for motor planning</article-title><source>Nature</source><year>2018</year><volume>563</volume><issue>7729</issue><fpage>113</fpage><pub-id pub-id-type="pmcid">PMC6212318</pub-id><pub-id pub-id-type="pmid">30333626</pub-id><pub-id pub-id-type="doi">10.1038/s41586-018-0633-x</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deverett</surname><given-names>Ben</given-names></name><name><surname>Kislin</surname><given-names>Mikhail</given-names></name><name><surname>Tank</surname><given-names>David W</given-names></name><name><surname>Wang</surname><given-names>Samuel S-H</given-names></name></person-group><article-title>Cerebellar disruption impairs working memory during evidence accumulation</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="pmcid">PMC6635393</pub-id><pub-id pub-id-type="pmid">31311934</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-11050-x</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chabrol</surname><given-names>Francois P</given-names></name><name><surname>Blot</surname><given-names>Antonin</given-names></name><name><surname>Mrsic-Flogel</surname><given-names>Thomas D</given-names></name></person-group><article-title>Cerebellar contribution to preparatory activity in motor neocortex</article-title><source>Neuron</source><year>2019</year><pub-id pub-id-type="pmcid">PMC6693889</pub-id><pub-id pub-id-type="pmid">31201123</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2019.05.022</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Nuo</given-names></name><name><surname>Mrsic-Flogel</surname><given-names>Thomas D</given-names></name></person-group><article-title>Cortico-cerebellar interactions during goal-directed behavior</article-title><source>Current opinion in neurobiology</source><year>2020</year><volume>65</volume><fpage>27</fpage><lpage>37</lpage><pub-id pub-id-type="pmcid">PMC7770085</pub-id><pub-id pub-id-type="pmid">32979846</pub-id><pub-id pub-id-type="doi">10.1016/j.conb.2020.08.010</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanaka</surname><given-names>Hirokazu</given-names></name><name><surname>Ishikawa</surname><given-names>Takahiro</given-names></name><name><surname>Lee</surname><given-names>Jongho</given-names></name><name><surname>Kakei</surname><given-names>Shinji</given-names></name></person-group><article-title>The Cerebro-Cerebellum as a Locus of Forward Model: A Review</article-title><source>Frontiers in Systems Neuroscience</source><year>2020</year><volume>14</volume><fpage>19</fpage><comment>ISSN 1662-5137</comment><pub-id pub-id-type="pmcid">PMC7160920</pub-id><pub-id pub-id-type="pmid">32327978</pub-id><pub-id pub-id-type="doi">10.3389/fnsys.2020.00019</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pemberton</surname><given-names>Joseph</given-names></name><name><surname>Boven</surname><given-names>Ellen</given-names></name><name><surname>Apps</surname><given-names>Richard</given-names></name><name><surname>Costa</surname><given-names>Rui Ponte</given-names></name></person-group><article-title>Cortico-cerebellar networks as decoupling neural interfaces</article-title><source>Advances in Neural Information Processing Systems</source><year>2021</year><volume>34</volume></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boven</surname><given-names>Ellen</given-names></name><name><surname>Pemberton</surname><given-names>Joseph</given-names></name><name><surname>Chadderton</surname><given-names>Paul</given-names></name><name><surname>Apps</surname><given-names>Richard</given-names></name><name><surname>Costa</surname><given-names>Rui Ponte</given-names></name></person-group><article-title>Cerebro-cerebellar networks facilitate learning through feedback decoupling</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="pmcid">PMC9813152</pub-id><pub-id pub-id-type="pmid">36599827</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-35658-8</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suvrathan</surname><given-names>Aparna</given-names></name><name><surname>Payne</surname><given-names>Hannah L</given-names></name><name><surname>Raymond</surname><given-names>Jennifer L</given-names></name></person-group><article-title>Timing rules for synaptic plasticity matched to behavioral function</article-title><source>Neuron</source><year>2016</year><volume>92</volume><issue>5</issue><fpage>959</fpage><lpage>967</lpage><pub-id pub-id-type="pmcid">PMC5165237</pub-id><pub-id pub-id-type="pmid">27839999</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2016.10.022</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>David</given-names></name></person-group><article-title>From Trinity College, Cambridge</article-title><source>J Physiol</source><year>1969</year><volume>202</volume><fpage>437</fpage><lpage>470</lpage></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Babadi</surname><given-names>Baktash</given-names></name><name><surname>Sompolinsky</surname><given-names>Haim</given-names></name></person-group><article-title>Sparseness and expansion in sensory representations</article-title><source>Neuron</source><year>2014</year><volume>83</volume><issue>5</issue><fpage>1213</fpage><lpage>1226</lpage><pub-id pub-id-type="pmid">25155954</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname><given-names>Ashok</given-names></name><name><surname>Harris</surname><given-names>Kameron Decker</given-names></name><name><surname>Axel</surname><given-names>Richard</given-names></name><name><surname>Sompolinsky</surname><given-names>Haim</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><article-title>Optimal degrees of synaptic connectivity</article-title><source>Neuron</source><year>2017</year><volume>93</volume><issue>5</issue><fpage>1153</fpage><lpage>1164</lpage><pub-id pub-id-type="pmcid">PMC5379477</pub-id><pub-id pub-id-type="pmid">28215558</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2017.01.030</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rössert</surname><given-names>Christian</given-names></name><name><surname>Solinas</surname><given-names>Sergio</given-names></name><name><surname>D’Angelo</surname><given-names>Egidio</given-names></name><name><surname>Dean</surname><given-names>Paul</given-names></name><name><surname>Porrill</surname><given-names>John</given-names></name></person-group><article-title>Model cerebellar granule cells can faithfully transmit modulated firing rate signals</article-title><source>Frontiers in cellular neuroscience</source><year>2014</year><volume>8</volume><fpage>304</fpage><pub-id pub-id-type="pmcid">PMC4195316</pub-id><pub-id pub-id-type="pmid">25352777</pub-id><pub-id pub-id-type="doi">10.3389/fncel.2014.00304</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadderton</surname><given-names>Paul</given-names></name><name><surname>Schaefer</surname><given-names>Andreas T</given-names></name><name><surname>Williams</surname><given-names>Stephen R</given-names></name><name><surname>Margrie</surname><given-names>Troy W</given-names></name></person-group><article-title>Sensory-evoked synaptic integration in cerebellar and cerebral cortical neurons</article-title><source>Nature Reviews Neuroscience</source><year>2014</year><volume>15</volume><issue>2</issue><fpage>71</fpage><lpage>83</lpage><pub-id pub-id-type="pmid">24434910</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bellec</surname><given-names>Guillaume</given-names></name><name><surname>Scherr</surname><given-names>Franz</given-names></name><name><surname>Subramoney</surname><given-names>Anand</given-names></name><name><surname>Hajek</surname><given-names>Elias</given-names></name><name><surname>Salaj</surname><given-names>Darjan</given-names></name><name><surname>Legenstein</surname><given-names>Robert</given-names></name><name><surname>Maass</surname><given-names>Wolfgang</given-names></name></person-group><article-title>A solution to the learning dilemma for recurrent networks of spiking neurons</article-title><source>Nature communications</source><year>2020</year><volume>11</volume><issue>1</issue><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmcid">PMC7367848</pub-id><pub-id pub-id-type="pmid">32681001</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-17236-y</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aumann</surname><given-names>TD</given-names></name></person-group><article-title>Cerebello-thalamic synapses and motor adaptation</article-title><source>The Cerebellum</source><year>2002</year><volume>1</volume><issue>1</issue><fpage>69</fpage><lpage>77</lpage><pub-id pub-id-type="pmid">12879975</pub-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Audette</surname><given-names>Nicholas J</given-names></name><name><surname>Bernhard</surname><given-names>Sarah M</given-names></name><name><surname>Ray</surname><given-names>Ajit</given-names></name><name><surname>Stewart</surname><given-names>Luke T</given-names></name><name><surname>Barth</surname><given-names>Alison L</given-names></name></person-group><article-title>Rapid plasticity of higher-order thalamocortical inputs during sensory learning</article-title><source>Neuron</source><year>2019</year><volume>103</volume><issue>2</issue><fpage>277</fpage><lpage>291</lpage><pub-id pub-id-type="pmcid">PMC10038228</pub-id><pub-id pub-id-type="pmid">31151774</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2019.04.037</pub-id></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Samuel S-H</given-names></name><name><surname>Denk</surname><given-names>Winfried</given-names></name><name><surname>Häusser</surname><given-names>Michael</given-names></name></person-group><article-title>Coincidence detection in single dendritic spines mediated by calcium release</article-title><source>Nature neuroscience</source><year>2000</year><volume>3</volume><issue>12</issue><fpage>1266</fpage><lpage>1273</lpage><pub-id pub-id-type="pmid">11100147</pub-id></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Medina</surname><given-names>Javier F</given-names></name><name><surname>Carey</surname><given-names>Megan R</given-names></name><name><surname>Lisberger</surname><given-names>Stephen G</given-names></name></person-group><article-title>The representation of time for motor learning</article-title><source>Neuron</source><year>2005</year><volume>45</volume><issue>1</issue><fpage>157</fpage><lpage>167</lpage><pub-id pub-id-type="pmid">15629710</pub-id></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shim</surname><given-names>Hyun Geun</given-names></name><name><surname>Jang</surname><given-names>Dong Cheol</given-names></name><name><surname>Lee</surname><given-names>Jaegeon</given-names></name><name><surname>Chung</surname><given-names>Geehoon</given-names></name><name><surname>Lee</surname><given-names>Sukchan</given-names></name><name><surname>Kim</surname><given-names>Yong Gyu</given-names></name><name><surname>Kim</surname><given-names>Sang Jeong</given-names></name><etal/></person-group><article-title>Long-term depression of intrinsic excitability accompanied by synaptic depression in cerebellar Purkinje cells</article-title><source>Journal of Neuroscience</source><year>2017</year><volume>37</volume><issue>23</issue><fpage>5659</fpage><lpage>5669</lpage><pub-id pub-id-type="pmcid">PMC6596474</pub-id><pub-id pub-id-type="pmid">28495974</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3464-16.2017</pub-id></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rowan</surname><given-names>Matthew JM</given-names></name><name><surname>Bonnan</surname><given-names>Audrey</given-names></name><name><surname>Zhang</surname><given-names>Ke</given-names></name><name><surname>Amat</surname><given-names>Samantha B</given-names></name><name><surname>Kikuchi</surname><given-names>Chikako</given-names></name><name><surname>Taniguchi</surname><given-names>Hiroki</given-names></name><name><surname>Augustine</surname><given-names>George J</given-names></name><name><surname>Christie</surname><given-names>Jason M</given-names></name></person-group><article-title>Graded control of climbing-fiber-mediated plasticity and learning by inhibition in the cerebellum</article-title><source>Neuron</source><year>2018</year><volume>99</volume><issue>5</issue><fpage>999</fpage><lpage>1015</lpage><pub-id pub-id-type="pmcid">PMC6206434</pub-id><pub-id pub-id-type="pmid">30122378</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2018.07.024</pub-id></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suvrathan</surname><given-names>Aparna</given-names></name></person-group><article-title>Beyond stdp—towards diverse and functionally relevant plasticity rules</article-title><source>Current opinion in neurobiology</source><year>2019</year><volume>54</volume><fpage>12</fpage><lpage>19</lpage><pub-id pub-id-type="pmid">30056261</pub-id></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanes</surname><given-names>Jerome N</given-names></name><name><surname>Dimitrov</surname><given-names>Bozhidar</given-names></name><name><surname>Hallett</surname><given-names>Mark</given-names></name></person-group><article-title>Motor learning in patients with cerebellar dysfunction</article-title><source>Brain</source><year>1990</year><volume>113</volume><issue>1</issue><fpage>103</fpage><lpage>120</lpage><pub-id pub-id-type="pmid">2302528</pub-id></element-citation></ref><ref id="R47"><label>[47]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamoto</surname><given-names>Kenji</given-names></name><name><surname>Kawato</surname><given-names>Mitsuo</given-names></name><name><surname>Kotosaka</surname><given-names>Shinya</given-names></name><name><surname>Kitazawa</surname><given-names>Shigeru</given-names></name></person-group><article-title>Encoding of movement dynamics by Purkinje cell simple spike activity during fast arm movements under resistive and assistive force fields</article-title><source>Journal of neurophysiology</source><year>2007</year><volume>97</volume><issue>2</issue><fpage>1588</fpage><lpage>1599</lpage><pub-id pub-id-type="pmid">17079350</pub-id></element-citation></ref><ref id="R48"><label>[48]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebner</surname><given-names>Timothy J</given-names></name><name><surname>Pasalar</surname><given-names>Siavash</given-names></name></person-group><article-title>Cerebellum Predicts the Future Motor State</article-title><source>Cerebellum (London, England)</source><year>2008</year><volume>7</volume><issue>4</issue><fpage>583</fpage><pub-id pub-id-type="pmcid">PMC2754147</pub-id><pub-id pub-id-type="pmid">18850258</pub-id><pub-id pub-id-type="doi">10.1007/s12311-008-0059-3</pub-id></element-citation></ref><ref id="R49"><label>[49]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lanore</surname><given-names>Frederic</given-names></name><name><surname>Cayco-Gajic</surname><given-names>N Alex</given-names></name><name><surname>Gurnani</surname><given-names>Harsha</given-names></name><name><surname>Coyle</surname><given-names>Diccon</given-names></name><name><surname>Silver</surname><given-names>R Angus</given-names></name></person-group><article-title>Cerebellar granule cell axons support high-dimensional representations</article-title><source>Nature Neuroscience</source><year>2021</year><volume>24</volume><issue>8</issue><fpage>1142</fpage><lpage>1150</lpage><pub-id pub-id-type="pmcid">PMC7611462</pub-id><pub-id pub-id-type="pmid">34168340</pub-id><pub-id pub-id-type="doi">10.1038/s41593-021-00873-x</pub-id></element-citation></ref><ref id="R50"><label>[50]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christie</surname><given-names>Jason M</given-names></name><name><surname>Gaffeld</surname><given-names>Michael A</given-names></name></person-group><article-title>The cerebellum encodes and influences the initiation and termination of discontinuous movements</article-title><source>bioRxiv</source><year>2021</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2021/06/24/2021.06.24.449622">https://www.biorxiv.org/content/early/2021/06/24/2021.06.24.449622</ext-link></comment><pub-id pub-id-type="pmcid">PMC9075950</pub-id><pub-id pub-id-type="pmid">35451957</pub-id><pub-id pub-id-type="doi">10.7554/eLife.71464</pub-id></element-citation></ref><ref id="R51"><label>[51]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dacre</surname><given-names>Joshua</given-names></name><name><surname>Colligan</surname><given-names>Matt</given-names></name><name><surname>Clarke</surname><given-names>Thomas</given-names></name><name><surname>Ammer</surname><given-names>Julian J</given-names></name><name><surname>Schiemann</surname><given-names>Julia</given-names></name><name><surname>Chamosa-Pino</surname><given-names>Victor</given-names></name><name><surname>Claudi</surname><given-names>Federico</given-names></name><name><surname>Harston</surname><given-names>J Alex</given-names></name><name><surname>Eleftheriou</surname><given-names>Constantinos</given-names></name><name><surname>Pakan</surname><given-names>Janelle MP</given-names></name><etal/></person-group><article-title>A cerebellar-thalamocortical pathway drives behavioral context-dependent movement initiation</article-title><source>Neuron</source><year>2021</year><pub-id pub-id-type="pmcid">PMC8315304</pub-id><pub-id pub-id-type="pmid">34146469</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2021.05.016</pub-id></element-citation></ref><ref id="R52"><label>[52]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fasano</surname><given-names>Alfonso</given-names></name><name><surname>Laganiere</surname><given-names>Simon E</given-names></name><name><surname>Lam</surname><given-names>Susy</given-names></name><name><surname>Fox</surname><given-names>Michael D</given-names></name></person-group><article-title>Lesions causing freezing of gait localize to a cerebellar functional network</article-title><source>Annals of neurology</source><year>2017</year><volume>81</volume><issue>1</issue><fpage>129</fpage><lpage>141</lpage><pub-id pub-id-type="pmcid">PMC5266642</pub-id><pub-id pub-id-type="pmid">28009063</pub-id><pub-id pub-id-type="doi">10.1002/ana.24845</pub-id></element-citation></ref><ref id="R53"><label>[53]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marsden</surname><given-names>Jonathan F</given-names></name></person-group><article-title>Cerebellar ataxia</article-title><source>Handbook of clinical neurology</source><year>2018</year><volume>159</volume><fpage>261</fpage><lpage>281</lpage><pub-id pub-id-type="pmid">30482319</pub-id></element-citation></ref><ref id="R54"><label>[54]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perich</surname><given-names>Matthew G</given-names></name><name><surname>Gallego</surname><given-names>Juan A</given-names></name><name><surname>Miller</surname><given-names>Lee E</given-names></name></person-group><article-title>A neural population mechanism for rapid learning</article-title><source>Neuron</source><year>2018</year><volume>100</volume><issue>4</issue><fpage>964</fpage><lpage>976</lpage><pub-id pub-id-type="pmcid">PMC6250582</pub-id><pub-id pub-id-type="pmid">30344047</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.030</pub-id></element-citation></ref><ref id="R55"><label>[55]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milak</surname><given-names>MS</given-names></name><name><surname>Bracha</surname><given-names>V</given-names></name><name><surname>Bloedel</surname><given-names>JR</given-names></name></person-group><article-title>Context-dependent modulation of cerebellar nuclear neurons related to the performance of specific movement segments</article-title><source>Soc Neurosci Abstr</source><year>1994</year><volume>20</volume><fpage>1746</fpage></element-citation></ref><ref id="R56"><label>[56]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahshahani</surname><given-names>Ladan</given-names></name><name><surname>King</surname><given-names>Maedbh</given-names></name><name><surname>Nettekoven</surname><given-names>Caroline</given-names></name><name><surname>Ivry</surname><given-names>Richard</given-names></name><name><surname>Diedrichsen</surname><given-names>Jörn</given-names></name></person-group><article-title>Selective recruitment: Evidence for task-dependent gating of inputs to the cerebellum</article-title><source>bioRxiv</source><year>2023</year><comment>2023-01</comment></element-citation></ref><ref id="R57"><label>[57]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogasawara</surname><given-names>Hideaki</given-names></name><name><surname>Doi</surname><given-names>Tomokazu</given-names></name><name><surname>Doya</surname><given-names>Kenji</given-names></name><name><surname>Kawato</surname><given-names>Mitsuo</given-names></name></person-group><article-title>Nitric oxide regulates input specificity of long-term depression and context dependence of cerebellar learning</article-title><source>PLoS Computational Biology</source><year>2007</year><volume>3</volume><issue>1</issue><fpage>e179</fpage><pub-id pub-id-type="pmcid">PMC1769409</pub-id><pub-id pub-id-type="pmid">17222054</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020179</pub-id></element-citation></ref><ref id="R58"><label>[58]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feulner</surname><given-names>Barbara</given-names></name><name><surname>Perich</surname><given-names>Matthew G</given-names></name><name><surname>Chowdhury</surname><given-names>Raeed H</given-names></name><name><surname>Miller</surname><given-names>Lee E</given-names></name><name><surname>Gallego</surname><given-names>Juan A</given-names></name><name><surname>Clopath</surname><given-names>Claudia</given-names></name></person-group><article-title>Small, correlated changes in synaptic connectivity may facilitate rapid motor learning</article-title><source>Nature communications</source><year>2022</year><volume>13</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC9440011</pub-id><pub-id pub-id-type="pmid">36056006</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-32646-w</pub-id></element-citation></ref><ref id="R59"><label>[59]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raymond</surname><given-names>Jennifer L</given-names></name><name><surname>Medina</surname><given-names>Javier F</given-names></name></person-group><article-title>Computational principles of supervised learning in the cerebellum</article-title><source>Annual review of neuroscience</source><year>2018</year><volume>41</volume><fpage>233</fpage><lpage>253</lpage><pub-id pub-id-type="pmcid">PMC6056176</pub-id><pub-id pub-id-type="pmid">29986160</pub-id><pub-id pub-id-type="doi">10.1146/annurev-neuro-080317-061948</pub-id></element-citation></ref><ref id="R60"><label>[60]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ito</surname><given-names>Masao</given-names></name></person-group><article-title>Control of mental activities by internal models in the cerebellum</article-title><source>Nature Reviews Neuroscience</source><year>2008</year><volume>9</volume><issue>4</issue><fpage>304</fpage><pub-id pub-id-type="pmid">18319727</pub-id></element-citation></ref><ref id="R61"><label>[61]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>Mark J</given-names></name><name><surname>Luo</surname><given-names>Liqun</given-names></name></person-group><article-title>Neocortex–cerebellum circuits for cognitive processing</article-title><source>Trends in neurosciences</source><year>2020</year><volume>43</volume><issue>1</issue><fpage>42</fpage><lpage>54</lpage><pub-id pub-id-type="pmcid">PMC6942222</pub-id><pub-id pub-id-type="pmid">31787351</pub-id><pub-id pub-id-type="doi">10.1016/j.tins.2019.11.002</pub-id></element-citation></ref><ref id="R62"><label>[62]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kao</surname><given-names>Ta-Chu</given-names></name><name><surname>Hennequin</surname><given-names>Guillaume</given-names></name></person-group><article-title>Neuroscience out of control: control-theoretic perspectives on neural circuit dynamics</article-title><source>Current opinion in neurobiology</source><year>2019</year><volume>58</volume><fpage>122</fpage><lpage>129</lpage><pub-id pub-id-type="pmid">31563084</pub-id></element-citation></ref><ref id="R63"><label>[63]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>Dmitry</given-names></name><name><surname>Brendel</surname><given-names>Wieland</given-names></name><name><surname>Constantinidis</surname><given-names>Christos</given-names></name><name><surname>Feierstein</surname><given-names>Claudia E</given-names></name><name><surname>Kepecs</surname><given-names>Adam</given-names></name><name><surname>Mainen</surname><given-names>Zachary F</given-names></name><name><surname>Qi</surname><given-names>Xue-Lian</given-names></name><name><surname>Romo</surname><given-names>Ranulfo</given-names></name><name><surname>Uchida</surname><given-names>Naoshige</given-names></name><name><surname>Machens</surname><given-names>Christian K</given-names></name></person-group><article-title>Demixed principal component analysis of neural population data</article-title><source>eLife</source><year>2016</year><volume>5</volume><pub-id pub-id-type="pmcid">PMC4887222</pub-id><pub-id pub-id-type="pmid">27067378</pub-id><pub-id pub-id-type="doi">10.7554/eLife.10989</pub-id></element-citation></ref><ref id="R64"><label>[64]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cayco-Gajic</surname><given-names>N Alex</given-names></name><name><surname>Silver</surname><given-names>R Angus</given-names></name></person-group><article-title>Re-evaluating circuit mechanisms underlying pattern separation</article-title><source>Neuron</source><year>2019</year><volume>101</volume><issue>4</issue><fpage>584</fpage><lpage>602</lpage><pub-id pub-id-type="pmcid">PMC7028396</pub-id><pub-id pub-id-type="pmid">30790539</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2019.01.044</pub-id></element-citation></ref><ref id="R65"><label>[65]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>Heike</given-names></name></person-group><article-title>Why Does the Neocortex Need the Cerebellum for Working Memory?</article-title><source>Journal of Neuroscience</source><year>2021</year><volume>41</volume><issue>30</issue><fpage>6368</fpage><lpage>6370</lpage><pub-id pub-id-type="pmcid">PMC8318082</pub-id><pub-id pub-id-type="pmid">34321336</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0701-21.2021</pub-id></element-citation></ref><ref id="R66"><label>[66]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Locke</surname><given-names>Timothy M</given-names></name><name><surname>Soden</surname><given-names>Marta E</given-names></name><name><surname>Miller</surname><given-names>Samara M</given-names></name><name><surname>Hunker</surname><given-names>Avery</given-names></name><name><surname>Knakal</surname><given-names>Cerise</given-names></name><name><surname>Licholai</surname><given-names>Julia A</given-names></name><name><surname>Dhillon</surname><given-names>Karn S</given-names></name><name><surname>Dirk Keene</surname><given-names>C</given-names></name><name><surname>Zweifel</surname><given-names>Larry S</given-names></name><name><surname>Carlson</surname><given-names>Erik S</given-names></name></person-group><article-title>Dopamine D1 Receptor–Positive Neurons in the Lateral Nucleus of the Cerebellum Contribute to Cognitive Behavior</article-title><source>Biological Psychiatry</source><year>2018</year><volume>84</volume><issue>6</issue><fpage>401</fpage><lpage>412</lpage><comment>ISSN 18732402. URL 10.1016/j.biopsych.2018.01.019</comment><pub-id pub-id-type="pmcid">PMC6072628</pub-id><pub-id pub-id-type="pmid">29478701</pub-id><pub-id pub-id-type="doi">10.1016/j.biopsych.2018.01.019</pub-id></element-citation></ref><ref id="R67"><label>[67]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schuessler</surname><given-names>Friedrich</given-names></name><name><surname>Mastrogiuseppe</surname><given-names>Francesca</given-names></name><name><surname>Dubreuil</surname><given-names>Alexis</given-names></name><name><surname>Ostojic</surname><given-names>Srdjan</given-names></name><name><surname>Barak</surname><given-names>Omri</given-names></name></person-group><article-title>The interplay between randomness and structure during learning in RNNs</article-title><source>Advances in neural information processing systems</source><year>2020</year><volume>33</volume><fpage>13352</fpage><lpage>13362</lpage></element-citation></ref><ref id="R68"><label>[68]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coultrip</surname><given-names>Robert</given-names></name><name><surname>Granger</surname><given-names>Richard</given-names></name><name><surname>Lynch</surname><given-names>Gary</given-names></name></person-group><article-title>A cortical model of winner-take-all competition via lateral inhibition</article-title><source>Neural networks</source><year>1992</year><volume>5</volume><issue>1</issue><fpage>47</fpage><lpage>54</lpage></element-citation></ref><ref id="R69"><label>[69]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Wei</given-names></name><name><surname>De Carvalho</surname><given-names>Felipe</given-names></name><name><surname>Jackson</surname><given-names>Andrew</given-names></name></person-group><article-title>Conserved population dynamics in the cerebro-cerebellar system between waking and sleep</article-title><source>Journal of Neuroscience</source><year>2022</year><volume>42</volume><issue>50</issue><fpage>9415</fpage><lpage>9425</lpage></element-citation></ref><ref id="R70"><label>[70]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>Richard F</given-names></name></person-group><article-title>Context-dependent adaptation of visually-guided arm movements and vestibular eye movements: role of the cerebellum</article-title><source>The Cerebellum</source><year>2003</year><volume>2</volume><issue>2</issue><fpage>123</fpage><lpage>130</lpage><pub-id pub-id-type="pmid">12880180</pub-id></element-citation></ref><ref id="R71"><label>[71]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heald</surname><given-names>James B</given-names></name><name><surname>Lengyel</surname><given-names>Máté</given-names></name><name><surname>Wolpert</surname><given-names>Daniel M</given-names></name></person-group><article-title>Contextual inference underlies the learning of sensorimotor repertoires</article-title><source>Nature</source><year>2021</year><volume>600</volume><issue>7889</issue><fpage>489</fpage><lpage>493</lpage><pub-id pub-id-type="pmcid">PMC8809113</pub-id><pub-id pub-id-type="pmid">34819674</pub-id><pub-id pub-id-type="doi">10.1038/s41586-021-04129-3</pub-id></element-citation></ref><ref id="R72"><label>[72]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sezener</surname><given-names>Eren</given-names></name><name><surname>Grabska-Barwinska</surname><given-names>Agnieszka</given-names></name><name><surname>Kostadinov</surname><given-names>Dimitar</given-names></name><name><surname>Beau</surname><given-names>Maxime</given-names></name><name><surname>Krishnagopal</surname><given-names>Sanjukta</given-names></name><name><surname>Budden</surname><given-names>David</given-names></name><name><surname>Hutter</surname><given-names>Marcus</given-names></name><name><surname>Veness</surname><given-names>Joel</given-names></name><name><surname>Botvinick</surname><given-names>Matthew</given-names></name><name><surname>Clopath</surname><given-names>Claudia</given-names></name><etal/></person-group><article-title>A rapid and efficient learning rule for biological neural circuits</article-title><source>bioRxiv</source><year>2021</year></element-citation></ref><ref id="R73"><label>[73]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>Kai</given-names></name><name><surname>Shine</surname><given-names>James M</given-names></name><name><surname>Cole</surname><given-names>Michael W</given-names></name><name><surname>Sorenson</surname><given-names>Evan</given-names></name></person-group><article-title>Thalamocortical contributions to cognitive task activity</article-title><source>Elife</source><year>2022</year><volume>11</volume><elocation-id>e81282</elocation-id><pub-id pub-id-type="pmcid">PMC9799971</pub-id><pub-id pub-id-type="pmid">36537658</pub-id><pub-id pub-id-type="doi">10.7554/eLife.81282</pub-id></element-citation></ref><ref id="R74"><label>[74]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uusisaari</surname><given-names>Marylka</given-names></name><name><surname>De Schutter</surname><given-names>Erik</given-names></name></person-group><article-title>The mysterious microcircuitry of the cerebellar nuclei</article-title><source>The Journal of physiology</source><year>2011</year><volume>589</volume><issue>14</issue><fpage>3441</fpage><lpage>3457</lpage><pub-id pub-id-type="pmcid">PMC3167109</pub-id><pub-id pub-id-type="pmid">21521761</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.2010.201582</pub-id></element-citation></ref><ref id="R75"><label>[75]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muscinelli</surname><given-names>Samuel</given-names></name><name><surname>Wagner</surname><given-names>Mark</given-names></name><name><surname>Litwin-Kumar</surname><given-names>Ashok</given-names></name></person-group><article-title>Optimal routing to cerebellum-like structures</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="pmcid">PMC10506727</pub-id><pub-id pub-id-type="pmid">37604889</pub-id><pub-id pub-id-type="doi">10.1038/s41593-023-01403-7</pub-id></element-citation></ref><ref id="R76"><label>[76]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alex Cayco-Gajic</surname><given-names>N</given-names></name><name><surname>Clopath</surname><given-names>Claudia</given-names></name><name><surname>Angus Silver</surname><given-names>R</given-names></name></person-group><article-title>Sparse synaptic connectivity is required for decorrelation and pattern separation in feedforward networks</article-title><source>Nature communications</source><year>2017</year><volume>8</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC5653655</pub-id><pub-id pub-id-type="pmid">29061964</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-01109-y</pub-id></element-citation></ref><ref id="R77"><label>[77]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>Mark J</given-names></name><name><surname>Kim</surname><given-names>Tony Hyun</given-names></name><name><surname>Savall</surname><given-names>Joan</given-names></name><name><surname>Schnitzer</surname><given-names>Mark J</given-names></name><name><surname>Luo</surname><given-names>Liqun</given-names></name></person-group><article-title>Cerebellar granule cells encode the expectation of reward</article-title><source>Nature</source><year>2017</year><volume>544</volume><issue>7648</issue><fpage>96</fpage><lpage>100</lpage><pub-id pub-id-type="pmcid">PMC5532014</pub-id><pub-id pub-id-type="pmid">28321129</pub-id><pub-id pub-id-type="doi">10.1038/nature21726</pub-id></element-citation></ref><ref id="R78"><label>[78]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kostadinov</surname><given-names>Dimitar</given-names></name><name><surname>Häusser</surname><given-names>Michael</given-names></name></person-group><article-title>Reward signals in the cerebellum: origins, targets, and functional implications</article-title><source>Neuron</source><year>2022</year><pub-id pub-id-type="pmid">35325616</pub-id></element-citation></ref><ref id="R79"><label>[79]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carta</surname><given-names>Ilaria</given-names></name><name><surname>Chen</surname><given-names>Christopher H</given-names></name><name><surname>Schott</surname><given-names>Amanda L</given-names></name><name><surname>Dorizan</surname><given-names>Schnaude</given-names></name><name><surname>Khodakhah</surname><given-names>Kamran</given-names></name></person-group><article-title>Cerebellar modulation of the reward circuitry and social behavior</article-title><source>Science</source><year>2019</year><volume>363</volume><issue>6424</issue><elocation-id>eaav0581</elocation-id><pub-id pub-id-type="pmcid">PMC6711161</pub-id><pub-id pub-id-type="pmid">30655412</pub-id><pub-id pub-id-type="doi">10.1126/science.aav0581</pub-id></element-citation></ref><ref id="R80"><label>[80]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canto</surname><given-names>Cathrin B</given-names></name><name><surname>Onuki</surname><given-names>Yoshiyuki</given-names></name><name><surname>Bruinsma</surname><given-names>Bastiaan</given-names></name><name><surname>van der Werf</surname><given-names>Ysbrand D</given-names></name><name><surname>De Zeeuw</surname><given-names>Chris I</given-names></name></person-group><article-title>The sleeping cerebellum</article-title><source>Trends in Neurosciences</source><year>2017</year><volume>40</volume><issue>5</issue><fpage>309</fpage><lpage>323</lpage><pub-id pub-id-type="pmid">28431742</pub-id></element-citation></ref><ref id="R81"><label>[81]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Zeeuw</surname><given-names>Chris I</given-names></name><name><surname>Canto</surname><given-names>Cathrin B</given-names></name></person-group><article-title>Sleep deprivation directly following eyeblink-conditioning impairs memory consolidation</article-title><source>Neurobiology of learning and memory</source><year>2020</year><volume>170</volume><elocation-id>107165</elocation-id><pub-id pub-id-type="pmcid">PMC7184677</pub-id><pub-id pub-id-type="pmid">31953233</pub-id><pub-id pub-id-type="doi">10.1016/j.nlm.2020.107165</pub-id></element-citation></ref><ref id="R82"><label>[82]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corrigan</surname><given-names>Benjamin W</given-names></name><name><surname>Gulli</surname><given-names>Roberto A</given-names></name><name><surname>Doucet</surname><given-names>Guillaume</given-names></name><name><surname>Roussy</surname><given-names>Megan</given-names></name><name><surname>Luna</surname><given-names>Rogelio</given-names></name><name><surname>Pradeepan</surname><given-names>Kartik S</given-names></name><name><surname>Sachs</surname><given-names>Adam J</given-names></name><name><surname>Martinez-Trujillo</surname><given-names>Julio C</given-names></name></person-group><article-title>Distinct neural codes in primate hippocampus and lateral prefrontal cortex during associative learning in virtual environments</article-title><source>Neuron</source><year>2022</year><pub-id pub-id-type="pmid">35561675</pub-id></element-citation></ref><ref id="R83"><label>[83]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anastasiades</surname><given-names>Paul G</given-names></name><name><surname>Collins</surname><given-names>David P</given-names></name><name><surname>Carter</surname><given-names>Adam G</given-names></name></person-group><article-title>Mediodorsal and ventromedial thalamus engage distinct L1 circuits in the prefrontal cortex</article-title><source>Neuron</source><year>2021</year><volume>109</volume><issue>2</issue><fpage>314</fpage><lpage>330</lpage><pub-id pub-id-type="pmcid">PMC7855187</pub-id><pub-id pub-id-type="pmid">33188733</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2020.10.031</pub-id></element-citation></ref><ref id="R84"><label>[84]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>He</surname><given-names>Kaiming</given-names></name><name><surname>Zhang</surname><given-names>Xiangyu</given-names></name><name><surname>Ren</surname><given-names>Shaoqing</given-names></name><name><surname>Sun</surname><given-names>Jian</given-names></name></person-group><source>Delving deep into rectifiers: Surpassing human-level performance on imagenet classification</source><conf-name>In Proceedings of the IEEE international conference on computer vision</conf-name><year>2015</year><fpage>1026</fpage><lpage>1034</lpage></element-citation></ref><ref id="R85"><label>[85]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>Diederik P</given-names></name><name><surname>Ba</surname><given-names>Jimmy</given-names></name></person-group><article-title>Adam: A method for stochastic optimization</article-title><source>arXiv preprint</source><year>2014</year><elocation-id>arXiv:1412.6980</elocation-id></element-citation></ref><ref id="R86"><label>[86]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albus</surname><given-names>James S</given-names></name></person-group><article-title>A theory of cerebellar function</article-title><source>Mathematical Biosciences</source><year>1971</year><volume>10</volume><issue>1</issue><fpage>25</fpage><lpage>61</lpage><comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/0025556471900514">http://www.sciencedirect.com/science/article/pii/0025556471900514</ext-link> ISSN 0025-5564</comment><pub-id pub-id-type="doi">10.1016/0025-5564(71)90051-4</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Schematic of cortical recurrent networks with different types of feedback.</title><p>(<bold>A</bold>) Model variant with <italic>no feedback:</italic> temporal external input (<italic>x</italic><sub><italic>t</italic></sub>) is fed to a cortical RNN (grey) and a linear readout layer (blue) produces the final model output (<italic>z</italic><sub><italic>t</italic></sub>). (<bold>B</bold>) Model variant with <italic>readout-only feedback:</italic> in this scheme there is a feedback loop in which the RNN also receives readout predictions as extra input<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>. (<bold>C</bold>) Model variant with <italic>cerebellar feedback:</italic> a copy of RNN activity (<italic>h</italic><sub><italic>t</italic></sub>) is sent to a (feedforward) cerebellar network 𝒞, which feedbacks to the cortical network its own cerebellar predictions (<italic>c</italic><sub><italic>t</italic></sub>). (<bold>D</bold>) A key property of our cerebellar network is that it learns via behavioural timing-specific learning rules, in line with experimental observations<sup><xref ref-type="bibr" rid="R32">32</xref></sup>. In this learning rule the error between the cerebellar prediction <italic>c</italic> and future behavioural outcomes <italic>y</italic> (150 ms) triggers plasticity via climbing fibers at the parallel fibre input of Purkinje cells.</p></caption><graphic xlink:href="EMS157211-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Cerebellum learns to drive cortical dynamics during a line drawing task.</title><p>(<bold>A</bold>) Given one of six possible stimuli at the first timestep the model must learn to draw a corresponding line (dotted black line) or remain still. Model output after training is shown for three model architectures with a fixed RNN. (<bold>B</bold>) Learning curves of models in A (same colour-coding). MSE denotes mean squared error. (<bold>C</bold>) Average training error across different levels of RNN internal memory (<italic>α</italic>) and plasticity (fixed RNN, input plastic and fully plastic) for the no feedback and cerebellar feedback models; arrow denotes cortical internal memory used in the other panels (<italic>α</italic> = 0.1). (<bold>D</bold>) Average training error of cortico-cerebellar model under varying numbers of granule cells and cerebellar temporal windows (<italic>τ</italic>). Orange arrow denotes default parameter choices. (<bold>E</bold>) Prediction error between cortical output and itself (gray) or cortical output and cerebellar output (orange) for different temporal delays. (<bold>F</bold>) Evolution of first (upper panel) and second (lower panel) principal components of cortical RNN for different stimuli, colour-coded as in (A) using small (<italic>τ</italic> = 0ms) and large (<italic>τ</italic> = 250ms) cerebellar time windows. (<bold>G</bold>) Variance across cues from both first and second PCs (cf. F) for different cerebellar temporal windows, <italic>τ</italic>. (<bold>H</bold>) Model output for different periods of cerebellar ablation (blue box represents period of ablation). (<bold>I</bold>) Output <italic>x</italic> and <italic>y</italic> coordinates of the lines drawn in H. (<bold>J</bold>) Average model error across all inputs for ablation periods in H,I. (<bold>K</bold>) Average error for different degrees of plasticity and ablation periods (left to right) as in H-J. (<bold>L</bold>) Average change in task error for models with versus without cerebellar feedback during (black) and after (blue) training for different degrees of cortical plasticity. All results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Context-dependent cerebellar feedback can enable multi-task learning and switching in the cortex.</title><p>(<bold>A</bold>) Training error of cortico-cerebellar models originally trained for line drawing (cf. <xref ref-type="fig" rid="F2">Fig. 2</xref>; <italic>α</italic> = 0.5). The models continue to execute the line-drawing task (left) before being trained on a novel curl-field variant of the task (middle) and then finally switch back to the original task (right). Data from behavioural experiments in macaque monkeys is reproduced here for comparison (bottom;<sup><xref ref-type="bibr" rid="R54">54</xref></sup>). (<bold>B</bold>) Average training error across different levels of parallel fibre (PF) task overlap for the different tasks for the fixed RNN (top) and fully plastic (bottom) models. Task periods colour-coded as in A. Arrows denote degree of PF task overlap used in A and C-F. (<bold>C</bold>) Model output for each of the three training periods defined in A for the zero-overlap condition; “zero-shot” output corresponds to the model output in the first trial when task 1 is reintroduced. (<bold>D</bold>) Model retention score for task 1. The retention score is computed as the error of task 1 during baseline over the error at the first trial after switching back to task 1. (<bold>E, F</bold>) Change in (E) activity and (F) covariance in the RNN population between task 1 (baseline) and after learning task 2. Mean changes in experimental data in F are reproduced (see <xref ref-type="sec" rid="S12">Methods</xref>) from neuronal recordings obtained from premotor (PMd) and primary motor (M1) cortices in macaque monkeys<sup><xref ref-type="bibr" rid="R54">54</xref></sup>. All results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Cerebellar temporal basis supports cortical dynamics of a non-linear digit drawing task.</title><p>(<bold>A</bold>) Schematic of cerebellar learning with a temporal basis. We consider multiple populations of Purkinje cells with different learning time windows <italic>τ</italic>. (<bold>B</bold>) Model output after training for different input examples of the digit drawing task (fixed RNN; <italic>α</italic> = 0.1). (<bold>C</bold>) Learning curves of models in B together with readout feedback model (blue). (<bold>D</bold>) Average training error across different levels of RNN cortical internal memory (<italic>α</italic>) and plasticity assumptions. (<bold>E</bold>) Performance of cerebellar feedback for different numbers of granule cells and and cerebellar time windows. Orange arrow indicates default parameter choices with a single cerebellar time window; red arrow indicates temporal basis model with multiple time-windows. (<bold>F</bold>) Model output under control and cerebellar ablation conditions for example inputs (digit 2 in upper panels and digit 4 in lower panels); dashed red line represents model output during and after ablation period. (<bold>G</bold>) Average model error across all inputs for control (left) and ablation (right) conditions. (<bold>H</bold>) Average error for different degrees of cortical plasticity and ablation periods (middle period illustrated in F,G). <bold>I</bold>, Average change in task error for models with versus without cerebellar feedback during (black) and after (blue) training across different degrees of cortical plasticity. All results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Cortico-cerebellar model mimics mouse behaviour during evidence accumulation task.</title><p>(<bold>A</bold>) Schematic of evidence accumulation task<sup><xref ref-type="bibr" rid="R26">26</xref></sup>: a random sequence of non-zero inputs (“air puffs”) is delivered in the leftward (-) or rightward (+) direction. The model must integrate this input and decide at the end of the task which side received more input overall. (<bold>B</bold>) Learning curves of models (fixed RNN; <italic>α</italic> = 0.1) without feedback (grey), with readout feedback (blue) and with cerebellar feedback (orange). (<bold>C</bold>) Change in average training error of the cortico-cerebellar model with respect to the no feedback model across different levels of cortical internal memory (<italic>α</italic>) and degrees of cortical plasticity. (<bold>D</bold>) Model beliefs over time without (orange) and with complete cerebellar ablation (purple) in model (upper panels) and data-derived behavioural model (lower panels) reproduced from Deverett et al.<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. Thin model lines represent one example seed. Belief <italic>P</italic> denotes model output probability. (<bold>E</bold>) Normalised regression weights at different periods of input presentation (cue) during control (upper) and ablation (lower) conditions for both model (orange line) and behavioural data (black line). (<bold>F</bold>) Model and data error under different ablation periods and degrees of cortical plasticity. (<bold>G</bold>) Average change in task error for models with versus without cerebellar feedback across different cue durations. (<bold>H</bold>) Average change in task error for models with versus without cerebellar feedback during and after training across different degrees of cortical plasticity. All model results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Cerebellar network sustains cortical dynamics during delayed association task in line with optogenetic experiments.</title><p>(<bold>A</bold>) (Top) Delayed association task; a sensory cue is presented followed by a delay and decision period<sup><xref ref-type="bibr" rid="R25">25</xref></sup>. (Bottom) The cortico-cerebellar loop models the interactions between a working memory region and a cognitive module of the cerebellum. (<bold>B</bold>) Learning curves of model without feedback (grey), readout feedback (blue) or cerebellar feedback (orange) for models with an input plastic RNN (<italic>α</italic> = 0.1). (<bold>C</bold>) Change in average training error of the cortico-cerebellar model with respect to the no feedback model across different levels of cortical internal memory (<italic>α</italic>) and degrees of plasticity in the cortical RNN. (<bold>D</bold>) Cue selectivity during the delay period without (left) and with cerebellar ablation (right; blue area denotes period of ablation and thin line shows control) in the model (upper panels) and optogenetic experiments (lower panels) reproduced from Gao et al.<sup><xref ref-type="bibr" rid="R25">25</xref></sup>. (<bold>E</bold>) First decision principal component (dPC) during the delay period without (left) and with (right) cerebellar ablation in the model (top) and in optogenetic experiments (bottom)<sup><xref ref-type="bibr" rid="R25">25</xref></sup>. (<bold>F</bold>) Cue selectivity during the delay period with cerebellar ablation when using the fully plastic RNN (cf. D). (<bold>G</bold>) Model error during cerebellar ablation (input plastic RNN; control error shown with dashed-dotted line). Dotted grey line denotes chance level. (<bold>H</bold>) Average error from cerebellar ablation at different points during the delay period and different degrees of cortical plasticity. (<bold>I</bold>) Average change in task error for models with versus without cerebellar feedback during and after training across different degrees of cortical plasticity. (<bold>J</bold>) Model error for different numbers of cerebellar granule cells (GCs) and delay period lengths in the delayed association task (fixed RNN; <italic>α</italic> = 0.1). (<bold>K</bold>) Signal-to-noise ratio (SNR) of RNN activities (left y-axis) and number of GCs needed to decode the stimulus from these activities (right y-axis). Results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>Cerebellum can mediate task consolidation in the cortex.</title><p>(<bold>A</bold>) Schematic of proposed theory of cerebellar-to-cortical task consolidation. During the initial learning phase (left), task representations are primarily driven by the cerebellum and RNN connectivity is not yet task-specialised. During the consolidation phase there is a period of cerebellar-to-cortical (CC) task information transfer (middle), whereby CC interaction drives plasticity in the cortical RNN. After consolidation (right), the RNN can operate effectively without the need for cerebellar input. The colour of the structures reflects the importance of each component throughout consolidation. (<bold>B</bold>) Model error in the delayed association task (<xref ref-type="fig" rid="F6">Fig. 6</xref>) throughout consolidation with (purple) and without (orange) cerebellar ablation. For reference an optimal consolidation model is also given (green). Dotted black line denotes chance. (<bold>C</bold>) Model selectivity with and without cerebellar ablation at different stages of the consolidation process; titles colour coded according to arrows in B. (<bold>D</bold>) Strength of the cerebellar-to-cortical weights (<italic>W</italic><sub><italic>𝒞h</italic></sub>; top), local cortical weights (<italic>W</italic><sub><italic>hh</italic></sub>; middle) and change in local cortical weights (Δ<italic>W</italic><sub><italic>hh</italic></sub>; bottom) over the period of consolidation. Strength and change is measured by the Euclidean norm. (<bold>E</bold>) Cosine similarity between cRNN (RNN and cerebellar network) activities before and during consolidation. (<bold>F</bold>) Cosine similarity between the learned recurrent input currents (generated locally in the cortical RNN) during consolidation and the total cortical input current (generated locally and by cerebellar-cortical input) in the pre-consolidation network. Similarity of the consolidation model is shown in orange and the optimal consolidation model in green. (<bold>G</bold>) Task error after the consolidation period for models with different initial degrees of performance prior to consolidation. Results are averaged over 5 different initial conditions. Error bars represent standard error of the mean.</p></caption><graphic xlink:href="EMS157211-f007"/></fig></floats-group></article>