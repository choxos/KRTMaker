<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158479</article-id><article-id pub-id-type="doi">10.1101/2022.12.10.519890</article-id><article-id pub-id-type="archive">PPR583189</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>SWAMPy: Simulating SARS-CoV-2 Wastewater Amplicon Metagenomes with Python</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8258-4673</contrib-id><name><surname>Boulton</surname><given-names>William</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN1">†</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5877-7945</contrib-id><name><surname>Rabia Fidan</surname><given-names>Fatma</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="fn" rid="FN1">†</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9862-5890</contrib-id><name><surname>Denise</surname><given-names>Hubert</given-names></name><xref ref-type="aff" rid="A5">5</xref><xref ref-type="fn" rid="FN2">‡</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9862-5890</contrib-id><name><surname>De Maio</surname><given-names>Nicola</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8486-2211</contrib-id><name><surname>Goldman</surname><given-names>Nick</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, Cambs. CB10 1SD, U.K</aff><aff id="A2"><label>2</label>Department of Computing Sciences, University of East Anglia, Norwich, NR4 7TJ, U.K</aff><aff id="A3"><label>3</label>Department of Biological Sciences, Middle East Technical University, 06800 Ankara, Turkey</aff><aff id="A4"><label>4</label>Cancer Dynamics Laboratory, Francis Crick Institute, London NW1 1AT, U.K</aff><aff id="A5"><label>5</label>UK Health Security Agency, Nobel House, London SW1P 3HX, U.K</aff><author-notes><corresp id="CR1">
<label>*</label>To whom correspondence should be addressed. <email>goldman@ebi.ac.uk</email></corresp><fn id="FN1" fn-type="equal"><label>†</label><p id="P1">The authors wish it to be known that these authors contributed equally.</p></fn><fn id="FN2" fn-type="present-address"><label>‡</label><p id="P2">Current address: Sensica Ltd., Exeter EX2 5DW, U.K.</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>14</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Motivation</title><p id="P3">Tracking SARS-CoV-2 variants through genomic sequencing has been an important part of the global response to the pandemic. As well as whole-genome sequencing of clinical samples, this surveillance effort has been aided by amplicon sequencing of wastewater samples, which proved effective in real case studies. Because of its relevance to public healthcare decisions, testing and benchmarking wastewater sequencing analysis methods is also crucial, which necessitates a simulator. Although metagenomic simulators exist, none are fit for the purpose of simulating the metagenomes produced through amplicon sequencing of wastewater.</p></sec><sec id="S2"><title>Results</title><p id="P4">Our new simulation tool, SWAMPy (Simulating SARS-CoV-2 Wastewater Amplicon Metagenomes with Python), is intended to provide realistic simulated SARS-CoV-2 wastewater sequencing datasets with which other programs that rely on this type of data can be evaluated and improved.</p></sec></abstract></article-meta></front><body><sec id="S3" sec-type="intro"><title>Introduction</title><p id="P5">Wastewater sequencing has proven useful in the genomic surveillance of SARS-CoV-2 and can provide a less-biased picture of the variants circulating in a population than clinical surveillance (<xref ref-type="bibr" rid="R1">1</xref>). Amplicon sequencing is the preferred method for this purpose since it is efficient in terms of cost, labour and time, and is well-suited for heavily contaminated samples — as may be found with biological samples collected for SARS-CoV-2 sequencing — thanks to its targeted nature (<xref ref-type="bibr" rid="R2">2</xref>). Such sequencing has typically been done via multiplex PCR using a pre-defined primer set with paired-end reads generated by an Illumina device (<xref ref-type="bibr" rid="R1">1</xref>).</p><p id="P6">A number of methods and software tools for wastewater SARS-CoV-2 sequencing data analysis are available such as SAM Refiner (<xref ref-type="bibr" rid="R3">3</xref>), COJAC (<xref ref-type="bibr" rid="R4">4</xref>), LCS (<xref ref-type="bibr" rid="R5">5</xref>) and Freyja (<xref ref-type="bibr" rid="R6">6</xref>). Evaluating the effectiveness of new methods on <italic>in vivo</italic> or <italic>in vitro</italic> samples is often difficult or impossible, for example because of the lack of availability of a wide range of real or synthetic samples and the costs of repeated experiments (<xref ref-type="bibr" rid="R7">7</xref>). However, simulated datasets can provide an efficient way of benchmarking new methods’ performances (<xref ref-type="bibr" rid="R8">8</xref>).</p><p id="P7">There is a specific set of features characteristic to data coming from wastewater amplicon sequencing. For example, it has been shown that there is a high variation in amplification across different amplicons of a given primer set, resulting in a variation in read depth across the genome (<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>). Moreover, wastewater data is expected to represent a mixture of different SARS-CoV-2 variants since the biological matter in the sample comes from multiple people, and will carry RNA degradation signatures resulting from the environmental exposure of the viral RNAs in sewage as well as PCR, sequencing library layout-specific and sequencing device-specific errors (<xref ref-type="bibr" rid="R9">9</xref>–<xref ref-type="bibr" rid="R11">11</xref>).</p><p id="P8">Existing standard metagenomic simulators do not attempt to capture all the characteristics seen in the amplicon sequencing protocols used for SARS-CoV-2 such as the ARTIC community protocols (<xref ref-type="bibr" rid="R12">12</xref>; <ext-link ext-link-type="uri" xlink:href="https://artic.network/ncov-2019">https://artic.network/ncov-2019</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://artic.network/resources/ncov/ncov-amplicon-v3.pdf">https://artic.network/resources/ncov/ncov-amplicon-v3.pdf</ext-link>) widely used to prepare samples for Illumina sequencing platforms. For example, InSilicoSeq (<xref ref-type="bibr" rid="R13">13</xref>) is intended to produce shotgun metagenomic sequences; and while Grinder (<xref ref-type="bibr" rid="R7">7</xref>) can simulate amplicon sequencing, it cannot be tuned to produce a bespoke amplicon distribution and does not produce realistic sequencing quality scores. The simulation tool ART (<xref ref-type="bibr" rid="R14">14</xref>) can also generate reads for amplicons, but only in equal proportions. Studies (<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R17">17</xref>) have demonstrated the need for a dedicated wastewater SARS-CoV-2 sequencing simulator. Each, however, performed its own simulations for its specific use case, with most simulators limited to simplified scenarios with uniform amplicon abundances and only read errors (e.g.<xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R16">16</xref>, <xref ref-type="bibr" rid="R18">18</xref>), or recreating the read-depth variation of one specific real experiment (e.g.<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R17">17</xref>). Both cases have drawbacks, either risking overfitting to one dataset, or omitting important characteristics of real life data such as PCR errors and variable amplicon abundances. <xref ref-type="table" rid="T1">Table 1</xref> shows a comparison of some of these simulation tools.</p><p id="P9">Our simulator, SWAMPy (<bold>S</bold>imulating SARS-CoV-2 <bold>W</bold>astewater <bold>A</bold>mplicon <bold>M</bold>etagenomes with <bold>Py</bold>thon), is intended to produce a realistic set of reads that might be generated through multiplex PCR of a wastewater sample, and sequenced by an Illumina sequencer. We model the following scenario: <list list-type="order" id="L1"><list-item><p id="P10">Different viral genomes coming from a human population contaminate wastewater systems, creating a mixture of virus variants which is then captured in a wastewater sample. At this stage, viral RNAs are exposed to RNA degradation and there is a variation in variant abundance in the mixture.</p></list-item><list-item><p id="P11">After sample collection, PCR amplification of whole viral genomes in segments using a pre-defined primer set results in an amplicon population. At this stage, amplicons gain PCR errors and there is further variation in amplicon abundance due to differential amplification success of the primers of a given primer-set.</p></list-item><list-item><p id="P12">These amplicons are then sequenced on an Illumina device, creating paired-end reads of a fixed length. At this stage, sequencing errors appear.</p></list-item></list>
</p></sec><sec id="S4" sec-type="methods"><title>Methods</title><p id="P13">The overall workflow of SWAMPy can be seen in <xref ref-type="fig" rid="F1">Fig.1</xref>. The four basic steps of our software pipeline are detailed as follows: <list list-type="order" id="L2"><list-item><p id="P14">Create an initial amplicon population</p></list-item><list-item><p id="P15">Simulate the number of DNA fragments (copies) per amplicon</p></list-item><list-item><p id="P16">Simulate high-frequency errors by mutating amplicons in the amplicon population</p></list-item><list-item><p id="P17">Simulate sequencing reads using ART</p></list-item></list></p><sec id="S5"><label>A</label><title>Create an initial amplicon population</title><p id="P18">The software assumes that the user has supplied a set of SARS-CoV-2 genomes, which we refer to as source genomes, and has selected a primer set among the supported primer sets in the program. The default primer set is ARTIC version 1. On the basis of this selection, amplicons are extracted from each genome as follows. First, we use Bowtie 2 (<xref ref-type="bibr" rid="R32">32</xref>) to align the primers (forward and reverse complement) to each virus genome to detect primer binding positions on the source genomes. Next, we slice the source genomes from the primer binding positions to obtain individual amplicons of each source genome, including the primer sequences. During the alignment step, some primers may not align well with the viral genome, and in those cases, the corresponding amplicon is not produced. While this is a strict penalty for primer misalignment, it approximates the observation that some amplicons can be dropped due to mutations in the target regions (<xref ref-type="bibr" rid="R33">33</xref>).</p></sec><sec id="S6"><label>B</label><title>Simulate numbers of copies per amplicon</title><p id="P19">To simulate numbers of copies per amplicon and genome, we offer two versions of a combined Multinomial and Dirichlet model. For either of these models, the user must supply three parameters: total target number of reads <italic>N</italic>, a vector of genome abundances <italic>p<sub>g</sub></italic> indexed over genomes <italic>g</italic>, and a Dirichlet parameter <italic>c</italic>. The choice of <italic>c</italic> roughly equates to a measure of sample quality: a higher value of <italic>c</italic> (e.g. 200) corresponds to high quality samples (roughly uniform abundances of amplicons between simulation runs) and a lower value (e.g. 10) to low quality samples (highly variable amplicon abundances between simulations, with higher rates of amplicon dropout). For the supported primer sets SWAMPy provides an experimentally derived prior on the amplicon proportions <italic>π<sub>a</sub></italic> indexed over amplicons <italic>a.</italic></p><p id="P20"><bold>Model 1</bold> (equal expected amplicon proportions across genomes): <list list-type="order" id="L3"><list-item><p id="P21">Sample genome read counts <italic>Ng</italic> from Multinomial(<italic>N, p<sub>g</sub></italic>)</p></list-item><list-item><p id="P22">Sample amplicon proportions <italic>p<sub>a</sub></italic> from Dirichlet (<italic>c</italic> × <italic>π<sub>a</sub></italic>) to be shared across all genomes</p></list-item><list-item><p id="P23">For each genome, sample numbers of reads per amplicon per genome as <italic>x<sub>a,g</sub>~</italic> Multinomial (<italic>N<sub>g</sub></italic>, <italic>p<sub>a</sub></italic>)</p></list-item></list></p><p id="P24"><bold>Model 2</bold> (different amplicon proportions across genomes): <list list-type="order" id="L4"><list-item><p id="P25">Sample genome read counts <italic>N<sub>g</sub></italic> from Multinomial (<italic>N</italic>,<italic>p<sub>g</sub></italic>)</p></list-item><list-item><p id="P26">For each genome, independently sample amplicon proportions <italic>p<sub>a</sub></italic>, <italic>g</italic> from Dirichlet(<italic>c</italic> × <italic>π<sub>a</sub></italic>)</p></list-item><list-item><p id="P27">For each genome, sample numbers of reads per amplicon per genome as <italic>x<sub>a,g</sub></italic> ~ Multinomial(<italic>N<sub>g</sub></italic>,<italic>p</italic><sub><italic>a,g</italic></sub>)</p></list-item></list></p><p id="P28">One subtlety in this process is that the numbers of reads do not account for amplicons dropped in the alignment step, which leads to some missing reads. For example, if the model assigns 100 reads to amplicon 1 in genome A, yet a mutation at the primer site of this amplicon causes it to drop out, then the total number of reads produced would be 100 fewer than expected. Hence the actual total number of reads may be less than the target, <italic>N</italic>.</p></sec><sec id="S7"><label>C</label><title>Add high-frequency errors</title><p id="P29">While we model sequencing error with standard bioinformatics tools, we developed a new model for the effects of RNA degradation, PCR mutations, and other library preparation artefacts, which we collectively refer to as high-frequency errors. We define high-frequency errors as non-naturally occurring insertions, deletions and substitutions that non-independently affect multiple reads. We further classify high-frequency errors as unique or recurrent with respect to their appearance across different source genomes in the mixture. Recurrent errors are the ones that are present in all source genomes in the simulated mixture, consistent with our observation of individual errors affecting multiple real wastewater sequencing experiments.</p><p id="P30">These might originate for example from genomic positions particularly susceptible to degradation, or context-dependent PCR errors (<xref ref-type="bibr" rid="R34">34</xref>, <xref ref-type="bibr" rid="R35">35</xref>). In contrast, unique high-frequency errors are present in only one of the genomes in the mixture, corresponding for example to PCR errors that are not context-dependent, and low-rate RNA degradation errors.</p><sec id="S8"><label>C.1</label><title>Sampling high-frequency errors</title><p id="P31">To simulate high-frequency errors in SWAMPy, we first create a table like that shown in <xref ref-type="table" rid="T2">Table 2</xref> containing all the sampled high-frequency errors to be introduced. <list list-type="order" id="L5"><list-item><p id="P32">The number of each type of error to be introduced is sampled from Poisson (<italic>L</italic> × <italic>R</italic>) where <italic>L =</italic> 29903 is the length of the Wuhan reference genome Wuhan-Hu-1 (<xref ref-type="bibr" rid="R36">36</xref>) and <italic>R</italic> is the error rate of the given type of error (insertion, deletion, or substitution, each either unique or recurrent). This Poisson distribution approximates the Binomial(<italic>L</italic>, <italic>R</italic>) distribution since error rates are typically low. Error rates are user-definable for each of the six types of error, with default values estimated from real wastewater experiments (see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>).</p></list-item><list-item><p id="P33">A genomic position for each error is sampled randomly without replacement from Wuhan-Hu-1. For unique errors, one of the source genomes is randomly assigned with sampling weights equal to the genome abundances in the mixture. Moreover, if more than one amplicon spans the previously determined error position, a unique error is assigned only one of them. Recurrent errors are assigned to all source genomes and overlapping amplicons.</p></list-item><list-item><p id="P34">An error length is assigned to each error. The error length is always 1 for substitutions, while for deletions it is sampled from a geometric distribution with parameter <italic>n</italic>; higher <italic>n</italic> will result in shorter deletions. For insertions, the error length is sampled from Uniform (<italic>m</italic>) where <italic>m</italic> is the maximum insertion length. Error length parameters <italic>n</italic> and <italic>m</italic> can be defined by the user, with their default values obtained from real data (see supplementary material).</p></list-item><list-item><p id="P35">An alternative allele is created for each error. For substitutions, it is a random single nucleotide that is different from the reference genome, and for insertions, it is a sequence of randomly sampled nucleotides of the previously determined error length.</p></list-item><list-item><p id="P36">A variant allele frequency, <italic>f</italic>, is sampled for each error from a Beta (<italic>α,β</italic>) distribution. The Beta distribution parameters are similarly user-definable, separately for unique and recurrent substitutions, insertions and deletions. Assigned VAF values are the expected VAF of the recurrent errors in the final mixture, while for unique errors, the expected value of the VAF in the final mixture will be the product of the assigned VAF <italic>f</italic> and the corresponding amplicon abundance <italic>π<sub>a</sub></italic>.</p></list-item></list></p></sec><sec id="S9"><label>C.2</label><title>Apply sampled errors to simulated amplicons</title><p id="P37">After we compile the table that contains all simulated errors, we process each source genome <italic>g</italic> and each amplicon <italic>a</italic> in the amplicon population that we previously created. For each <italic>a</italic>, <italic>g</italic>: <list list-type="order" id="L6"><list-item><p id="P38">Errors that affect genome <italic>g</italic> and amplicon <italic>a</italic> are selected from the error table.</p></list-item><list-item><p id="P39">Because simulated error positions are based on the Wuhan-Hu-1 reference and a variant amplicon in a wastewater sample may contain indels, the amplicon sequences are aligned to Wuhan-Hu-1 using Bowtie 2 (<xref ref-type="bibr" rid="R32">32</xref>) and the positions of the errors within the amplicon are determined.</p></list-item><list-item><p id="P40">For each error <italic>e</italic>, the number of reads in which <italic>e</italic> is present is determined by sampling a read count <italic>n<sub>e</sub></italic>from Binomial(<italic>x</italic><sub><italic>a</italic>,<italic>g</italic></sub>, <italic>f<sub>e</sub></italic>), where <italic>x</italic><sub><italic>a</italic>,<italic>g</italic></sub> is the total read count of amplicon <italic>a</italic> for genome <italic>g</italic> as described in <xref ref-type="sec" rid="S7">Section B</xref>, and <italic>f<sub>e</sub></italic> is the VAF of the error as determined in <xref ref-type="sec" rid="S9">Section C.1</xref>.</p></list-item><list-item><p id="P41">For each possible combination <italic>i</italic> of high-frequency errors affecting genome <italic>g</italic> and amplicon <italic>a</italic>, a read count <italic>n<sub>i</sub></italic> is randomly sampled respecting individual read counts of the errors. We make no attempt to simulate correlations among the errors on amplicons as simulating error inheritance for each amplicon is computationally too expensive and we assume errors on an amplicon are independent.</p></list-item><list-item><p id="P42">Finally, for each combination <italic>i</italic> of errors affecting <italic>a</italic> and <italic>g</italic>, a new corresponding modified amplicon sequence is created.</p></list-item></list></p></sec></sec><sec id="S10"><label>D</label><title>Simulate read sequencing using ART</title><p id="P43">To create a set of simulated paired-end Illumina reads from each amplicon, each with a given read count, we use the program ART (<xref ref-type="bibr" rid="R14">14</xref>). We use ART’s paired-end amplicon mode, as well as the noALN and maskN flags. These settings create 150bp paired-end reads, and faithfully transcribe any “N” characters appearing within the amplicons. We use a set of default error rates and quality score profiles tuned for the Illumina MiSeq V3 sequencer, though the ART package has options available for other platforms and read lengths. A full list of the flags used is in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p><p id="P44">Finally, we use a custom script based on ubiquitous bash utilities to concatenate all of the FASTQ read files, and shuffle their order to avoid potential biases in case any downstream application software can be influenced by read ordering.</p></sec></sec><sec id="S11" sec-type="results"><title>Results</title><p id="P45">The source code of our python implementation of SWAMPy, together with the program documentation and exemplar files is available under the GPL-v3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/goldman-gp-ebi/SWAMPy">https://github.com/goldman-gp-ebi/SWAMPy</ext-link>.</p><sec id="S12"><title>SWAMPy Implementation</title><p id="P46">SWAMPy takes as input a multi-FASTA file containing the SARS-CoV-2 variant genomes that will be present in the simulated wastewater sample, as well as a file that contains the relative abundances of these variants in the mixture. For ease of use, other input files (primer-set-specific sequence files, and primer-set-specific amplicon distribution files) were wrapped with a single --primer-set parameter which loads the corresponding input files for the specified primer set. As of December 2022, there are three supported primer sets: ARTIC V1, ARTIC V4 (<xref ref-type="bibr" rid="R12">12</xref>) and Nimagen V2 (<xref ref-type="bibr" rid="R37">37</xref>). There are many command line parameters that allows fine control of the program such as the parameter <italic>c</italic> that reflects the quality of the wastewater sample as described in <xref ref-type="sec" rid="S7">Section B</xref>, target number of simulated reads, and error rates, VAF and lengths of high-frequency errors as described in <xref ref-type="sec" rid="S9">Section C.1</xref>. The full list of command line interface arguments and their explanations are available on the GitHub wiki page: <ext-link ext-link-type="uri" xlink:href="https://github.com/goldman-gp-ebi/SWAMPy/wiki/CLI-arguments">https://github.com/goldman-gp-ebi/SWAMPy/wiki/CLI-arguments</ext-link>.</p><p id="P47">An example SWAMPy run takes 300 seconds to complete and reaches 700MB of max memory when run with default parameters (three SARS-CoV-2 variants and default error rates and 100,000 total read counts) on a single thread of an Intel Xeon Gold 6336Y 2.40GHz CPU.</p><p id="P48">SWAMPy produces five output files by default: <list list-type="bullet" id="L7"><list-item><p id="P49">FASTQ files of the simulated forward and reverse reads, matching Illumina standards</p></list-item><list-item><p id="P50">A table that shows the abundance of each wild-type amplicon after the randomness in amplicon copy number sampling (as described in <xref ref-type="sec" rid="S7">Section B</xref>) was applied</p></list-item><list-item><p id="P51">A VCF file that contains all the intended high-frequency errors from the error table described in <xref ref-type="sec" rid="S9">Section C.1</xref></p></list-item><list-item><p id="P52">A log file</p></list-item></list></p><p id="P53">Alignment images of simulation outputs illustrate that the major characteristics of wastewater data are present in the simulated data (<xref ref-type="fig" rid="F2">Fig. 2</xref>) such as overlapping amplicons, different kinds of errors and read depth variation across the genome.</p></sec><sec id="S13"><title>Use Case</title><p id="P54">We used SWAMPy to simulate 73 time points throughout the course of a hypothetical SARS-CoV-2 pandemic where the Alpha (B.1.1.7) variant starts out dominant before Delta (AY.4) rises in frequency and then Omicron (BA.1.1) emerges and takes over (<xref ref-type="fig" rid="F3">Fig. 3</xref>; see the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> for the SWAMPy options used; for the exact abundances at each time point, see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>). Then we used a downstream application program, Freyja, which is designed to detect SARS-CoV-2 variants and their relative abundances from sequencing data obtained from wastewater samples (<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R27">27</xref>, <xref ref-type="bibr" rid="R28">28</xref>). We observe that Freyja is quite successful in demixing the simulated data overall in this relatively complex scenario, though it sometimes inferred the presence of variants that are not specified in the simulated mixture potentially with high frequencies. This probably stems from some high-frequency errors in the simulated data as described in <xref ref-type="sec" rid="S8">Section C</xref>.</p></sec></sec><sec id="S14" sec-type="conclusions"><title>Conclusions</title><p id="P55">We have shown that SWAMPy is a viable simulation tool for SARS-CoV-2 wastewater metagenomes, building on the simulator ART but much better suited to the modelling challenges idiosyncratic to SARS-CoV-2 metagenomes such as high-frequency errors and irregular amplicon abundance profiles. Both of these models are based on real abundance and error data, from a large number of <italic>in vitro</italic> whole-genome amplicon sequencing experiments, detailed in the supplementary material. Compared with other metagenomic simulators, many of which support a range of complex features such as chimeric amplicons and shotgun metagenomic reads, SWAMPy aims to fill a niche created by metagenomic amplicon studies such as wastewater surveillance of SARS-CoV-2. This niche seems important given the disparity between features available in most general-purpose metagenomic simulators (<xref ref-type="table" rid="T1">Table 1</xref>) and the requirements of tools being developed for wastewater studies.</p><p id="P56">Our simulator supports two versions of the ARTIC protocol, which at present is the most prevalent sequencing protocol for SARS-CoV-2 metagenomes, and the Nimagen V2 protocol. We will strive to support future iterations of these, as well as new superseding protocols as they arise in the future. There are other areas where we hope to make improvements to modelling and usability, such as supporting a greater range of sequencing platforms, ensuring that amplicon dropout rates match closely with experimental findings and accounting for some additional parameters in high-frequency error models, which requires a deeper understanding of error mechanisms through controlled experiments.</p><p id="P57">We hope that this simulation tool will prove valuable by providing non-trivial test cases especially for strain-resolving SARS-CoV-2 metagenomics algorithms, and for creating control case data for researchers working on SARS-CoV-2 wastewater studies. Wastewater surveillance can provide a cheaper alternative to widespread sequencing of clinical SARS-CoV-2 samples, and it is our hope that through appropriate modelling and simulation of the processes involved in amplicon sequencing of wastewater, these data can be leveraged to their full potential in aiding public health.</p></sec><sec sec-type="supplementary-material" id="S15"><title>Supplementary</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS158479-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d20aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S16"><title>Acknowledgements</title><p>The authors thank Joshua Quick; members of the JBC-led Wastewater Genomics collaboration, in particular Terry Burke, Steve Paterson, Christopher Quince and Sébastien Raguideau; SWAMPy program testers Charlotte West, Lukas Weilguny, Sevim Seda Çokoglu, Kivilcim Başak Vural, Melih Yıldız and Gözde Atağ; and Mehmet Somel who supported this project.</p></ack><fn-group><fn id="FN3"><p id="P58"><bold>Availability:</bold> The code for this project is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/goldman-gp-ebi/SWAMPy">https://github.com/goldman-gp-ebi/SWAMPy</ext-link>. It can be installed on any Unix-based operating system and is available under the GPL-v3 license.</p></fn></fn-group><ref-list><title>Bibliography</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>Mathew R</given-names></name><name><surname>Wade</surname><given-names>Matthew J</given-names></name><name><surname>McIntyre-Nolan</surname><given-names>Shannon</given-names></name><name><surname>Bassano</surname><given-names>Irene</given-names></name><name><surname>Denise</surname><given-names>Hubert</given-names></name><name><surname>Bass</surname><given-names>David</given-names></name><name><surname>Bentley</surname><given-names>John</given-names></name><name><surname>Bunce</surname><given-names>Joshua T</given-names></name><name><surname>Grimsley</surname><given-names>Jasmine</given-names></name><name><surname>Hart</surname><given-names>Alwyn</given-names></name><name><surname>Hoffmann</surname><given-names>Till</given-names></name><etal/></person-group><article-title>Wastewater Monitoring of SARS-CoV-2 Variants in England: Demonstration Case Study for Bristol (Dec 2020-March 2021)</article-title><source>ePrints</source><year>2021</year><month>Apr</month><pub-id pub-id-type="doi">10.13140/RG.2.2.27215.00162</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hourdel</surname><given-names>Véronique</given-names></name><name><surname>Kwasiborski</surname><given-names>Aurelia</given-names></name><name><surname>Balière</surname><given-names>Charlotte</given-names></name><name><surname>Matheus</surname><given-names>Séverine</given-names></name><name><surname>Batéjat</surname><given-names>Christophe Frédéric</given-names></name><name><surname>Manuguerra</surname><given-names>Jean-Claude</given-names></name><name><surname>Vanhomwegen</surname><given-names>Jessica</given-names></name><name><surname>Caro</surname><given-names>Valérie</given-names></name></person-group><article-title>Rapid genomic characterization of SARS-CoV-2 by direct amplicon-based sequencing through comparison of MinION and Illumina iSeq100 ™ system</article-title><source>Frontiers in Microbiology</source><year>2020</year><month>Sep</month><volume>11</volume><elocation-id>571328</elocation-id><pub-id pub-id-type="pmcid">PMC7546329</pub-id><pub-id pub-id-type="pmid">33101244</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2020.571328</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gregory</surname><given-names>Devon A</given-names></name><name><surname>Wieberg</surname><given-names>Chris G</given-names></name><name><surname>Wenzel</surname><given-names>Jeff</given-names></name><name><surname>Lin</surname><given-names>Chung Ho</given-names></name><name><surname>Johnson</surname><given-names>Marc C</given-names></name></person-group><article-title>Monitoring SARS-CoV-2 populations in wastewater by amplicon sequencing and using the novel program SAM Refiner</article-title><source>Viruses</source><year>2021</year><month>Aug</month><volume>13</volume><elocation-id>1647</elocation-id><pub-id pub-id-type="pmcid">PMC8402658</pub-id><pub-id pub-id-type="pmid">34452511</pub-id><pub-id pub-id-type="doi">10.3390/v13081647</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahn</surname><given-names>Katharina</given-names></name><name><surname>Dreifuss</surname><given-names>David</given-names></name><name><surname>Topolsky</surname><given-names>Ivan</given-names></name><name><surname>Kull</surname><given-names>Anina</given-names></name><name><surname>Ganesanandamoorthy</surname><given-names>Pravin</given-names></name><name><surname>Fernandez-Cassi</surname><given-names>Xavier</given-names></name><name><surname>Bänziger</surname><given-names>Carola</given-names></name><name><surname>Devaux</surname><given-names>Alexander J</given-names></name><name><surname>Stachler</surname><given-names>Elyse</given-names></name><name><surname>Caduff</surname><given-names>Lea</given-names></name><name><surname>Cariti</surname><given-names>Federica</given-names></name><etal/></person-group><article-title>Early detection and surveillance of SARS-CoV-2 genomic variants in wastewater using COJAC</article-title><source>Nature Microbiology</source><year>2022</year><month>Jul</month><volume>7</volume><fpage>1151</fpage><lpage>1160</lpage><pub-id pub-id-type="pmcid">PMC9352586</pub-id><pub-id pub-id-type="pmid">35851854</pub-id><pub-id pub-id-type="doi">10.1038/s41564-022-01185-x</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valieris</surname><given-names>Renan</given-names></name><name><surname>Drummond</surname><given-names>Rodrigo D</given-names></name><name><surname>Defelicibus</surname><given-names>Alexandre</given-names></name><name><surname>Dias-Neto</surname><given-names>Emmanuel</given-names></name><name><surname>Rosales</surname><given-names>Rafael A</given-names></name><name><surname>da Silva</surname><given-names>Israel Tojal</given-names></name></person-group><article-title>A mixture model for determining SARS-CoV-2 variant composition in pooled samples</article-title><source>Bioinformatics</source><year>2022</year><month>Feb</month><volume>38</volume><fpage>1809</fpage><lpage>1815</lpage><pub-id pub-id-type="pmid">35104309</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karthikeyan</surname><given-names>Smruthi</given-names></name><name><surname>Levy</surname><given-names>Joshua I</given-names></name><name><surname>De Hoff</surname><given-names>Peter</given-names></name><name><surname>Humphrey</surname><given-names>Greg</given-names></name><name><surname>Birmingham</surname><given-names>Amanda</given-names></name><name><surname>Jepsen</surname><given-names>Kristen</given-names></name><name><surname>Farmer</surname><given-names>Sawyer</given-names></name><name><surname>Tubb</surname><given-names>Helena M</given-names></name><name><surname>Valles</surname><given-names>Tommy</given-names></name><name><surname>Tribelhorn</surname><given-names>Caitlin E</given-names></name><name><surname>Tsai</surname><given-names>Rebecca</given-names></name><etal/></person-group><article-title>Wastewater sequencing reveals early cryptic SARS-CoV-2 variant transmission</article-title><source>Nature</source><year>2022</year><month>Sep</month><volume>609</volume><fpage>101</fpage><lpage>108</lpage><pub-id pub-id-type="pmcid">PMC9433318</pub-id><pub-id pub-id-type="pmid">35798029</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05049-6</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angly</surname><given-names>Florent E</given-names></name><name><surname>Willner</surname><given-names>Dana</given-names></name><name><surname>Rohwer</surname><given-names>Forest</given-names></name><name><surname>Hugenholtz</surname><given-names>Philip</given-names></name><name><surname>Tyson</surname><given-names>Gene W</given-names></name></person-group><article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title><source>Nucleic Acids Research</source><year>2012</year><month>Jul</month><volume>40</volume><fpage>e94</fpage><pub-id pub-id-type="pmcid">PMC3384353</pub-id><pub-id pub-id-type="pmid">22434876</pub-id><pub-id pub-id-type="doi">10.1093/nar/gks251</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Escalona</surname><given-names>Merly</given-names></name><name><surname>Rocha</surname><given-names>Sara</given-names></name><name><surname>Posada</surname><given-names>David</given-names></name></person-group><article-title>A comparison of tools for the simulation of genomic next-generation sequencing data</article-title><source>Nature Reviews Genetics</source><year>2016</year><month>Jun</month><volume>17</volume><fpage>459</fpage><lpage>469</lpage><pub-id pub-id-type="pmcid">PMC5224698</pub-id><pub-id pub-id-type="pmid">27320129</pub-id><pub-id pub-id-type="doi">10.1038/nrg.2016.57</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turakhia</surname><given-names>Yatish</given-names></name><name><surname>De Maio</surname><given-names>Nicola</given-names></name><name><surname>Thornlow</surname><given-names>Bryan</given-names></name><name><surname>Gozashti</surname><given-names>Landen</given-names></name><name><surname>Lanfear</surname><given-names>Robert</given-names></name><name><surname>Walker</surname><given-names>Conor R</given-names></name><name><surname>Hinrichs</surname><given-names>Angie S</given-names></name><name><surname>Fernandes</surname><given-names>Jason D</given-names></name><name><surname>Borges</surname><given-names>Rui</given-names></name><name><surname>Slodkowicz</surname><given-names>Greg</given-names></name><name><surname>Weilguny</surname><given-names>Lukas</given-names></name><etal/></person-group><article-title>Stability of SARS-CoV-2 phylogenies</article-title><source>PLoS Genetics</source><year>2020</year><month>Nov</month><volume>16</volume><elocation-id>e1009175</elocation-id><pub-id pub-id-type="pmcid">PMC7721162</pub-id><pub-id pub-id-type="pmid">33206635</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009175</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacot</surname><given-names>Damien</given-names></name><name><surname>Pillonel</surname><given-names>Trestan</given-names></name><name><surname>Greub</surname><given-names>Gilbert</given-names></name><name><surname>Bertelli</surname><given-names>Claire</given-names></name></person-group><article-title>Assessment of SARS-CoV-2 genome sequencing: quality criteria and low-frequency variants</article-title><source>Journal of Clinical Microbiology</source><year>2021</year><volume>59</volume><elocation-id>e00944-21</elocation-id><pub-id pub-id-type="pmcid">PMC8451431</pub-id><pub-id pub-id-type="pmid">34319802</pub-id><pub-id pub-id-type="doi">10.1128/JCM.00944-21</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>Nicola</given-names></name><name><surname>Walker</surname><given-names>Conor</given-names></name><name><surname>Borges</surname><given-names>Rui</given-names></name><name><surname>Weilguny</surname><given-names>Lukas</given-names></name><name><surname>Slodkowicz</surname><given-names>Greg</given-names></name><name><surname>Goldman</surname><given-names>Nick</given-names></name></person-group><source>Issues with SARS-CoV-2 sequencing data</source><publisher-name>virological.org</publisher-name><year>2020</year><month>May</month><date-in-citation>accessed 10 Jul. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473">https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473</ext-link></comment></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyson</surname><given-names>John R</given-names></name><name><surname>James</surname><given-names>Phillip</given-names></name><name><surname>Stoddart</surname><given-names>David</given-names></name><name><surname>Sparks</surname><given-names>Natalie</given-names></name><name><surname>Wickenhagen</surname><given-names>Arthur</given-names></name><name><surname>Hall</surname><given-names>Grant</given-names></name><name><surname>Choi</surname><given-names>Ji Hyun</given-names></name><name><surname>Lapointe</surname><given-names>Hope</given-names></name><name><surname>Kamelian</surname><given-names>Kimia</given-names></name><name><surname>Smith</surname><given-names>Andrew D</given-names></name><name><surname>Prystajecky</surname><given-names>Natalie</given-names></name><etal/></person-group><article-title>Improvements to the ARTIC multiplex PCR method for SARS-CoV-2 genome sequencing using nanopore</article-title><source>bioRxiv</source><year>2020</year><month>Sep</month><pub-id pub-id-type="doi">10.1101/2020.09.04.283077</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gourlé</surname><given-names>Hadrien</given-names></name><name><surname>Karlsson-Lindsjö</surname><given-names>Oskar</given-names></name><name><surname>Hayer</surname><given-names>Juliette</given-names></name><name><surname>Bongcam-Rudloff</surname><given-names>Erik</given-names></name></person-group><article-title>Simulating Illumina metagenomic data with InSilicoSeq</article-title><source>Bioinformatics</source><year>2018</year><month>Jul</month><volume>35</volume><fpage>521</fpage><lpage>522</lpage><pub-id pub-id-type="pmcid">PMC6361232</pub-id><pub-id pub-id-type="pmid">30016412</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bty630</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Weichun</given-names></name><name><surname>Li</surname><given-names>Leping</given-names></name><name><surname>Myers</surname><given-names>Jason R</given-names></name><name><surname>Marth</surname><given-names>Gabor T</given-names></name></person-group><article-title>ART: a next-generation sequencing read simulator</article-title><source>Bioinformatics</source><year>2011</year><month>Dec</month><volume>28</volume><fpage>593</fpage><lpage>594</lpage><pub-id pub-id-type="pmcid">PMC3278762</pub-id><pub-id pub-id-type="pmid">22199392</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baaijens</surname><given-names>Jasmijn A</given-names></name><name><surname>Zulli</surname><given-names>Alessandro</given-names></name><name><surname>Ott</surname><given-names>Isabel M</given-names></name><name><surname>Nika</surname><given-names>Ioanna</given-names></name><name><surname>van der Lugt</surname><given-names>Mart J</given-names></name><name><surname>Petrone</surname><given-names>Mary E</given-names></name><name><surname>Alpert</surname><given-names>Tara</given-names></name><name><surname>Fauver</surname><given-names>Joseph R</given-names></name><name><surname>Kalinich</surname><given-names>Chaney C</given-names></name><name><surname>Vogels</surname><given-names>Chantal BF</given-names></name><name><surname>Breban</surname><given-names>Mallery I</given-names></name><etal/></person-group><article-title>Lineage abundance estimation for SARS-CoV-2 in wastewater using transcriptome quantification techniques</article-title><source>Genome Biology</source><year>2022</year><month>Nov</month><volume>23</volume><fpage>236</fpage><pub-id pub-id-type="pmcid">PMC9643916</pub-id><pub-id pub-id-type="pmid">36348471</pub-id><pub-id pub-id-type="doi">10.1186/s13059-022-02805-9</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gafurov</surname><given-names>Askar</given-names></name><name><surname>Baláž</surname><given-names>Andrej</given-names></name><name><surname>Amman</surname><given-names>Fabian</given-names></name><name><surname>Borsová</surname><given-names>Kristína</given-names></name><name><surname>Cabanová</surname><given-names>Viktória</given-names></name><name><surname>Klempa</surname><given-names>Boris</given-names></name><name><surname>Bergthaler</surname><given-names>Andreas</given-names></name><name><surname>Vinař</surname><given-names>Tomáš</given-names></name><name><surname>Brejová</surname><given-names>Brona</given-names></name></person-group><article-title>VirPool: model-based estimation of SARS-CoV-2 variant proportions in wastewater samples</article-title><source>BMC Bioinformatics</source><year>2022</year><month>Dec</month><volume>23</volume><fpage>551</fpage><pub-id pub-id-type="pmcid">PMC9761630</pub-id><pub-id pub-id-type="pmid">36536300</pub-id><pub-id pub-id-type="doi">10.1186/s12859-022-05100-3</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sapoval</surname><given-names>Nicolae</given-names></name><name><surname>Liu</surname><given-names>Yunxi</given-names></name><name><surname>Lou</surname><given-names>Esther G</given-names></name><name><surname>Hopkins</surname><given-names>Loren</given-names></name><name><surname>Ensor</surname><given-names>Katherine B</given-names></name><name><surname>Schneider</surname><given-names>Rebecca</given-names></name><name><surname>Stadler</surname><given-names>Lauren B</given-names></name><name><surname>Treangen</surname><given-names>Todd J</given-names></name></person-group><article-title>Enabling accurate and early detection of recently emerged SARS-CoV-2 variants of concern in wastewater</article-title><source>Nature Communications</source><year>2023</year><month>May</month><volume>14</volume><elocation-id>2834</elocation-id><pub-id pub-id-type="pmcid">PMC10191095</pub-id><pub-id pub-id-type="pmid">37198181</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-38184-3</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayikcioglu</surname><given-names>T</given-names></name><name><surname>Amirzadegan</surname><given-names>J</given-names></name><name><surname>Rand</surname><given-names>H</given-names></name><name><surname>Tesfaldet</surname><given-names>B</given-names></name><name><surname>Timme</surname><given-names>RE</given-names></name><name><surname>Pettengill</surname><given-names>JB</given-names></name></person-group><article-title>Performance of methods for SARS-CoV-2 variant detection and abundance estimation within mixed population samples</article-title><source>PeerJ</source><year>2023</year><month>Jan</month><volume>11</volume><elocation-id>e14596</elocation-id><pub-id pub-id-type="pmcid">PMC9884472</pub-id><pub-id pub-id-type="pmid">36721781</pub-id><pub-id pub-id-type="doi">10.7717/peerj.14596</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>Xuesong</given-names></name><name><surname>Yuan</surname><given-names>Jianying</given-names></name><name><surname>Shi</surname><given-names>Yujian</given-names></name><name><surname>Lu</surname><given-names>Jianliang</given-names></name><name><surname>Liu</surname><given-names>Binghang</given-names></name><name><surname>Li</surname><given-names>Zhenyu</given-names></name><name><surname>Chen</surname><given-names>Yanxiang</given-names></name><name><surname>Mu</surname><given-names>Desheng</given-names></name><name><surname>Zhang</surname><given-names>Hao</given-names></name><name><surname>Li</surname><given-names>Nan</given-names></name><name><surname>Yue</surname><given-names>Zhen</given-names></name><etal/></person-group><article-title>pIRS: Profile-based Illumina pair-end reads simulator</article-title><source>Bioinformatics</source><year>2012</year><month>Apr</month><volume>28</volume><issue>11</issue><fpage>1533</fpage><lpage>1535</lpage><pub-id pub-id-type="pmid">22508794</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McElroy</surname><given-names>Kerensa E</given-names></name><name><surname>Luciani</surname><given-names>Fabio</given-names></name><name><surname>Thomas</surname><given-names>Torsten</given-names></name></person-group><article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title><source>BMC Genomics</source><year>2012</year><month>Feb</month><volume>13</volume><issue>1</issue><fpage>74</fpage><pub-id pub-id-type="pmcid">PMC3305602</pub-id><pub-id pub-id-type="pmid">22336055</pub-id><pub-id pub-id-type="doi">10.1186/1471-2164-13-74</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>B</given-names></name><name><surname>Xuan</surname><given-names>L</given-names></name><name><surname>Cai</surname><given-names>K</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>C</given-names></name></person-group><article-title>NeSSM: a next-generation sequencing simulator for metagenomics</article-title><source>PLoS One</source><year>2013</year><month>Oct</month><volume>8</volume><issue>10</issue><elocation-id>e75448</elocation-id><pub-id pub-id-type="pmcid">PMC3790878</pub-id><pub-id pub-id-type="pmid">24124490</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0075448</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>Stephen</given-names></name><name><surname>Trost</surname><given-names>Brett</given-names></name><name><surname>Long</surname><given-names>Jeffrey R</given-names></name><name><surname>Pittet</surname><given-names>Vanessa</given-names></name><name><surname>Kusalik</surname><given-names>Anthony</given-names></name></person-group><article-title>A better sequence-read simulator program for metagenomics</article-title><source>BMC Bioinformatics</source><year>2014</year><month>Sep</month><volume>15</volume><fpage>S14</fpage><pub-id pub-id-type="pmcid">PMC4168713</pub-id><pub-id pub-id-type="pmid">25253095</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-15-S9-S14</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shcherbina</surname><given-names>Anna</given-names></name></person-group><article-title>FASTQSim: platform-independent data characterization and in silico read generation for NGS datasets</article-title><source>BMC Research Notes</source><year>2014</year><month>Aug</month><volume>7</volume><fpage>533</fpage><pub-id pub-id-type="pmcid">PMC4246604</pub-id><pub-id pub-id-type="pmid">25123167</pub-id><pub-id pub-id-type="doi">10.1186/1756-0500-7-533</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="web"><source>The Debian Project Apt</source><year>2023</year><date-in-citation>Accessed: 6 Jul. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://www.debian.org/doc/manuals/debian-reference/ch02.en.html">https://www.debian.org/doc/manuals/debian-reference/ch02.en.html</ext-link></comment></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="web"><collab>Anaconda Inc</collab><source>Conda</source><year>2023</year><date-in-citation>Accessed: 29 Jun. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://docs.conda.io/en/latest/">https://docs.conda.io/en/latest/</ext-link></comment></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Hietaniemi</surname><given-names>Jarkko</given-names></name></person-group><source>CPAN</source><year>2023</year><date-in-citation>Accessed: 6 Jul. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://www.cpan.org/">https://www.cpan.org/</ext-link></comment></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="web"><collab>Docker Inc</collab><source>Docker</source><year>2023</year><date-in-citation>Accessed: 29 Jun. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://www.docker.com">https://www.docker.com</ext-link></comment></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="web"><collab>The pip developers</collab><source>Pip</source><year>2023</year><date-in-citation>Accessed: 29 Jun. 2023</date-in-citation><comment><ext-link ext-link-type="uri" xlink:href="https://pip.pypa.io/en/stable/">https://pip.pypa.io/en/stable/</ext-link></comment></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatko</surname><given-names>Barton E</given-names></name><name><surname>Gardner</surname><given-names>Andrew F</given-names></name><name><surname>Ausubel</surname><given-names>Frederick M</given-names></name></person-group><article-title>Overview of nextgeneration sequencing technologies</article-title><source>Current Protocols in Molecular Biology</source><year>2018</year><volume>122</volume><fpage>e59</fpage><pub-id pub-id-type="pmcid">PMC6020069</pub-id><pub-id pub-id-type="pmid">29851291</pub-id><pub-id pub-id-type="doi">10.1002/cpmb.59</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kircher</surname><given-names>Martin</given-names></name><name><surname>Kelso</surname><given-names>Janet</given-names></name></person-group><article-title>High-throughput DNA sequencing — concepts and limitations</article-title><source>BioEssays</source><year>2010</year><volume>32</volume><fpage>524</fpage><lpage>536</lpage><pub-id pub-id-type="pmid">20486139</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Hongen</given-names></name></person-group><chapter-title>Overview of sequence data formats</chapter-title><person-group person-group-type="editor"><name><surname>Mathé</surname><given-names>Ewy</given-names></name><name><surname>Davis</surname><given-names>Sean</given-names></name></person-group><source>Statistical Genomics: Methods and Protocols</source><publisher-name>Springer New York</publisher-name><publisher-loc>New York, NY</publisher-loc><year>2016</year><fpage>3</fpage><lpage>17</lpage><comment>ISBN 978-1-4939-3578-9</comment><pub-id pub-id-type="doi">10.1007/978-1-4939-3578-9_1</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>Ben</given-names></name><name><surname>Salzberg</surname><given-names>Steven L</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nature Methods</source><year>2012</year><month>Apr</month><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="pmcid">PMC3322381</pub-id><pub-id pub-id-type="pmid">22388286</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheikh</surname><given-names>Aziz</given-names></name><name><surname>McMenamin</surname><given-names>Jim</given-names></name><name><surname>Taylor</surname><given-names>Bob</given-names></name><name><surname>Robertson</surname><given-names>Chris</given-names></name></person-group><article-title>SARS-CoV-2 Delta VOC in Scotland: demographics, risk of hospital admission, and vaccine effectiveness</article-title><source>The Lancet</source><year>2021</year><month>Jun</month><volume>397</volume><fpage>2461</fpage><lpage>2462</lpage><pub-id pub-id-type="pmcid">PMC8201647</pub-id><pub-id pub-id-type="pmid">34139198</pub-id><pub-id pub-id-type="doi">10.1016/S0140-6736(21)01358-1</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyerhans</surname><given-names>Andreas</given-names></name><name><surname>Vartanian</surname><given-names>Jean Pierre</given-names></name><name><surname>Wain-Hobson</surname><given-names>Simon</given-names></name></person-group><article-title>DNA recombination during PCR</article-title><source>Nucleic Acids Research</source><year>1990</year><month>Jul</month><volume>18</volume><fpage>1687</fpage><lpage>1691</lpage><pub-id pub-id-type="pmcid">PMC330584</pub-id><pub-id pub-id-type="pmid">2186361</pub-id><pub-id pub-id-type="doi">10.1093/nar/18.7.1687</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potapov</surname><given-names>Vladimir</given-names></name><name><surname>Ong</surname><given-names>Jennifer L</given-names></name></person-group><article-title>Examining sources of error in PCR by single-molecule sequencing</article-title><source>PLoS ONE</source><year>2017</year><month>Jan</month><volume>12</volume><elocation-id>e0169774</elocation-id><pub-id pub-id-type="pmcid">PMC5218489</pub-id><pub-id pub-id-type="pmid">28060945</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0169774</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Fan</given-names></name><name><surname>Zhao</surname><given-names>Su</given-names></name><name><surname>Yu</surname><given-names>Bin</given-names></name><name><surname>Chen</surname><given-names>Yan Mei</given-names></name><name><surname>Wang</surname><given-names>Wen</given-names></name><name><surname>Song</surname><given-names>Zhi Gang</given-names></name><name><surname>Hu</surname><given-names>Yi</given-names></name><name><surname>Tao</surname><given-names>Zhao Wu</given-names></name><name><surname>Tian</surname><given-names>Jun Hua</given-names></name><name><surname>Pei</surname><given-names>Yuan Yuan</given-names></name><name><surname>Yuan</surname><given-names>Ming Li</given-names></name><etal/></person-group><article-title>A new coronavirus associated with human respiratory disease in China</article-title><source>Nature</source><year>2020</year><month>Mar</month><volume>579</volume><fpage>265</fpage><pub-id pub-id-type="pmcid">PMC7094943</pub-id><pub-id pub-id-type="pmid">32015508</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2008-3</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coolen</surname><given-names>Jordy PM</given-names></name><name><surname>Wolters</surname><given-names>Femke</given-names></name><name><surname>Tostmann</surname><given-names>Alma</given-names></name><name><surname>van Groningen</surname><given-names>Lenneke FJ</given-names></name><name><surname>Bleeker-Rovers</surname><given-names>Chantal P</given-names></name><name><surname>Tan</surname><given-names>Edward CTH</given-names></name><name><surname>van der Geest-Blankert</surname><given-names>Nannet</given-names></name><name><surname>Hautvast</surname><given-names>Jeannine LA</given-names></name><name><surname>Hopman</surname><given-names>Joost</given-names></name><name><surname>Wertheim</surname><given-names>Heiman FL</given-names></name><name><surname>Rahamat-Langendoen</surname><given-names>Janette C</given-names></name></person-group><article-title>SARS-CoV-2 whole-genome sequencing using reverse complement PCR: for easy, fast and accurate outbreak and variant analysis</article-title><source>Journal of Clinical Virology</source><year>2021</year><month>Nov</month><volume>144</volume><fpage>1386</fpage><lpage>6532</lpage><pub-id pub-id-type="pmcid">PMC8487099</pub-id><pub-id pub-id-type="pmid">34619382</pub-id><pub-id pub-id-type="doi">10.1016/j.jcv.2021.104993</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>James T</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>Helga</given-names></name><name><surname>Winckler</surname><given-names>Wendy</given-names></name><name><surname>Guttman</surname><given-names>Mitchell</given-names></name><name><surname>Lander</surname><given-names>Eric S</given-names></name><name><surname>Getz</surname><given-names>Gad</given-names></name><name><surname>Mesirov</surname><given-names>Jill P</given-names></name></person-group><article-title>Integrative genomics viewer</article-title><source>Nature Biotechnology</source><year>2011</year><month>Jan</month><volume>29</volume><fpage>24</fpage><lpage>26</lpage><pub-id pub-id-type="pmcid">PMC3346182</pub-id><pub-id pub-id-type="pmid">21221095</pub-id><pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname><given-names>Petr</given-names></name><name><surname>Bonfield</surname><given-names>James K</given-names></name><name><surname>Liddle</surname><given-names>Jennifer</given-names></name><name><surname>Marshall</surname><given-names>John</given-names></name><name><surname>Ohan</surname><given-names>Valeriu</given-names></name><name><surname>Pollard</surname><given-names>Martin O</given-names></name><name><surname>Whitwham</surname><given-names>Andrew</given-names></name><name><surname>Keane</surname><given-names>Thomas</given-names></name><name><surname>McCarthy</surname><given-names>Shane A</given-names></name><name><surname>Davies</surname><given-names>Robert M</given-names></name><name><surname>Li</surname><given-names>Heng</given-names></name></person-group><article-title>Twelve years of SAMtools and BCFtools</article-title><source>GigaScience</source><year>2021</year><month>Feb</month><volume>10</volume><pub-id pub-id-type="pmcid">PMC7931819</pub-id><pub-id pub-id-type="pmid">33590861</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoler</surname><given-names>Nicholas</given-names></name><name><surname>Nekrutenko</surname><given-names>Anton</given-names></name></person-group><article-title>Sequencing error profiles of Illumina sequencing instruments</article-title><source>NAR Genomics and Bioinformatics</source><year>2021</year><month>Mar</month><volume>3</volume><elocation-id>lqab019</elocation-id><pub-id pub-id-type="pmcid">PMC8002175</pub-id><pub-id pub-id-type="pmid">33817639</pub-id><pub-id pub-id-type="doi">10.1093/nargab/lqab019</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delbue</surname><given-names>Serena</given-names></name><name><surname>D’Alessandro</surname><given-names>Sarah</given-names></name><name><surname>Signorini</surname><given-names>Lucia</given-names></name><name><surname>Dolci</surname><given-names>Maria</given-names></name><name><surname>Pariani</surname><given-names>Elena</given-names></name><name><surname>Bianchi</surname><given-names>Michele</given-names></name><name><surname>Fattori</surname><given-names>Stefania</given-names></name><name><surname>Modenese</surname><given-names>Annalisa</given-names></name><name><surname>Galli</surname><given-names>Cristina</given-names></name><name><surname>Eberini</surname><given-names>Ivano</given-names></name><name><surname>Ferrante</surname><given-names>Pasquale</given-names></name></person-group><article-title>Isolation of SARS-CoV-2 strains carrying a nucleotide mutation, leading to a stop codon in the orf 6 protein</article-title><source>Emerging Microbes &amp; Infections</source><year>2021</year><month>Feb</month><volume>10</volume><fpage>252</fpage><lpage>255</lpage><pub-id pub-id-type="pmcid">PMC7894437</pub-id><pub-id pub-id-type="pmid">33525998</pub-id><pub-id pub-id-type="doi">10.1080/22221751.2021.1884003</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jungreis</surname><given-names>Irwin</given-names></name><name><surname>Sealfon</surname><given-names>Rachel</given-names></name><name><surname>Kellis</surname><given-names>Manolis</given-names></name></person-group><article-title>SARS-CoV-2 gene content and COVID-19 mutation impact by comparing 44 Sarbecovirus genomes</article-title><source>Nature Communications</source><year>2021</year><month>May</month><volume>12</volume><elocation-id>2642</elocation-id><pub-id pub-id-type="pmcid">PMC8113528</pub-id><pub-id pub-id-type="pmid">33976134</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-22905-7</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>Kenneth</given-names></name></person-group><article-title>Applications of the Dirichlet distribution to forensic match probabilities</article-title><source>Genetica</source><year>1995</year><month>Jun</month><volume>96</volume><fpage>107</fpage><lpage>117</lpage><pub-id pub-id-type="pmid">7607447</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Summary of the SWAMPy workflow.</title><p>Clockwise from top left, SWAMPy takes as input the genomes of the variants to be represented in the simulated wastewater sample, as well as information on the relative abundances of the variants in the simulated mixture. Source or input genomes are sliced according to a primer set to create a reference amplicon population, and amplicon read depths are adjusted to fit the amplicon abundance distribution of the given primer set (see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>) while taking into account a user-defined parameter which reflects the quality of the samples. The amplicon population is then further diversified by the addition of PCR mutants bearing different kinds of high-frequency errors, using parameters estimated from real data (see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>). The resulting reference and mutant amplicons, with corresponding read counts, are passed to the art_illumina program of ART (<xref ref-type="bibr" rid="R14">14</xref>) to model the Illumina sequencing step, where sequencing errors and base qualities are simulated. Finally, reads are merged and shuffled to create mixed-variant forward and reverse FASTQ files.</p></caption><graphic xlink:href="EMS158479-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>IGV (<xref ref-type="bibr" rid="R38">38</xref>) images of SWAMPy simulated reads.</title><p>Reads come from time point 53 of the simulations described in Results: Use Case, involving SARS-CoV-2 Alpha, Delta and Omicron variants. Uppermost, predominantly grey portion is the coverage track of IGV. Below that, horizontal pink and blue bars show forward and reverse reads, respectively, in “link supplementary alignments” mode of IGV. Black dashed lines are IGV’s optional “center line”, aiding visual perception of alignment of bases; faded colours indicate low quality bases. A) C-&gt;T SNP at position 7124 in the Delta variant, not present in the Alpha and Omicron variants. B) Sequencing errors added by ART. This image (zoomed out, with variant bases indicated by colour) is from a read end, where sequencing error density is often higher with Illumina sequencing. C) Unique high-frequency error. This only appears in one read direction and, despite this exemplar being chosen to be in an amplicon overlap region (not shown), only one of the amplicons carries the error. D) Recurrent high-frequency error (insertion of length 5) appearing in both read directions, and in both amplicons covering the chosen region (not shown).</p></caption><graphic xlink:href="EMS158479-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Progression of a simulated pandemic.</title><p>Sequencing of wastewater samples at 73 time points was simulated with SWAMPy, and corresponding Freyja estimations of SARS-CoV-2 variant abundances were made. Background colors represent the simulated values and lines represent the Freyja estimations. Lines generally follow the boundaries between the shaded areas, suggesting broadly accurate variant proportion estimates from Freyja. The region above the yellow line shows the sum of non-simulated variants (i.e. false positive variant detection) that Freyja erroneously inferred.</p></caption><graphic xlink:href="EMS158479-f003"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Comparison of metagenomic simulator features.</title><p>Software management systems cited are apt (<xref ref-type="bibr" rid="R24">24</xref>), conda (<xref ref-type="bibr" rid="R25">25</xref>), CPAN (<xref ref-type="bibr" rid="R26">26</xref>), docker (<xref ref-type="bibr" rid="R27">27</xref>) and pip (<xref ref-type="bibr" rid="R28">28</xref>). Programs with no management system listed are nevertheless open source and available for download and manual installation and use. Sequencing technologies cited are Illumina, Ion Torrent, Oxford Nanopore Technologies, Pacific Biosciences, Roche 454 (all described by (<xref ref-type="bibr" rid="R29">29</xref>)), and Sanger sequencing and ABI SOLiD (<xref ref-type="bibr" rid="R30">30</xref>). Illumina layout indicates single ended (SE) or paired end (PE) reads. Output file types are described by (<xref ref-type="bibr" rid="R31">31</xref>). Mix. indicates whether the program accepts a list of genomes to simulate a mixed sample. Amps.: can the program simulate amplicon sequencing protocols. VAA: are variable (i.e. non-uniform) amplicon abundances modeled. Ampl. bias: whether differential amplification success is modelled, based on (e.g.) reads’ GC content. Regarding SNP and indel errors, HF denotes high-frequency errors, i.e. recurring position-dependent errors, possibly appearing at the same position across different amplicons, as described in Methods; whereas Reads denotes independent per-read errors, e.g. from sequencing device error.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top" rowspan="2">Program</th><th align="left" valign="top" rowspan="2">Language; Management</th><th align="left" valign="top" rowspan="2">Sequencing Technology</th><th align="left" valign="top" rowspan="2">Illumina Layout</th><th align="left" valign="top" rowspan="2">Output File Type</th><th align="left" valign="top" rowspan="2">Mix.</th><th align="left" valign="top" rowspan="2">Amps.</th><th align="left" valign="top" rowspan="2">VAA</th><th align="left" valign="top" rowspan="2">Ampl. Bias</th><th align="left" valign="top" colspan="2" style="border-bottom: solid thin;">SNP &amp; Indel Errors</th><th align="left" valign="top" rowspan="2">Quality Scores</th></tr><tr><th align="left" valign="top">HF</th><th align="left" valign="top">Reads</th></tr></thead><tbody><tr><td align="left" valign="top">SWAMPy</td><td align="left" valign="top">python; docker</td><td align="left" valign="top">Illumina</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">ART (<xref ref-type="bibr" rid="R14">14</xref>)</td><td align="left" valign="top">C++, Perl; conda</td><td align="left" valign="top">Illumina, 454, SOLiD</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ, SAM</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">InSilicoSeq (<xref ref-type="bibr" rid="R13">13</xref>)</td><td align="left" valign="top">python; conda, docker, pip</td><td align="left" valign="top">Illumina</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">ww_simulations (<xref ref-type="bibr" rid="R18">18</xref>)</td><td align="left" valign="top">python;</td><td align="left" valign="top">Illumina, ONT</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">VLQ<sup><xref ref-type="table-fn" rid="TFN1">1</xref></sup> (<xref ref-type="bibr" rid="R15">15</xref>)</td><td align="left" valign="top">python; conda</td><td align="left" valign="top">Illumina</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">pIRS (<xref ref-type="bibr" rid="R19">19</xref>)</td><td align="left" valign="top">C++, Perl;</td><td align="left" valign="top">Illumina</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">GemSIM (<xref ref-type="bibr" rid="R20">20</xref>)</td><td align="left" valign="top">python; —</td><td align="left" valign="top">Illumina, 454</td><td align="center" valign="top">SE, PE</td><td align="left" valign="top">FASTQ, SAM</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">Grinder (<xref ref-type="bibr" rid="R7">7</xref>)</td><td align="left" valign="top">Perl; apt, CPAN</td><td align="left" valign="top">Illumina, 454, Sanger</td><td align="center" valign="top">PE</td><td align="left" valign="top">FASTA, FASTQ</td><td align="right" valign="top">✔</td><td align="right" valign="top">✔</td><td align="right" valign="top">✔</td><td align="left" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">—<sup><xref ref-type="table-fn" rid="TFN2">2</xref></sup></td></tr><tr><td align="left" valign="top">NeSSM (<xref ref-type="bibr" rid="R21">21</xref>)</td><td align="left" valign="top">C, Perl;</td><td align="left" valign="top">Illumina, 454</td><td align="center" valign="top">SE, PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">BEAR (<xref ref-type="bibr" rid="R22">22</xref>)</td><td align="left" valign="top">Perl, python; —</td><td align="left" valign="top">Illumina, 454, Ion Torrent</td><td align="center" valign="top">SE, PE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr><tr><td align="left" valign="top">FASTQSim (<xref ref-type="bibr" rid="R23">23</xref>)</td><td align="left" valign="top">python; —</td><td align="left" valign="top">Illumina, PacBio, IonTorrent, 454</td><td align="center" valign="top">SE</td><td align="left" valign="top">FASTQ</td><td align="center" valign="top">✔</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">—</td><td align="center" valign="top">✔</td><td align="center" valign="top">✔</td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><label>1</label><p id="P59">VLQ is a tool for analyzing wastewater sample sequence data for SARS-CoV-2 variant quantification; it has an unnamed simulation tool available as part of its benchmarking code.</p></fn><fn id="TFN2"><p id="P60">Output from Grinder can be FASTQ-formatted, but the quality scores serve only to indicate whether or not each position incurred a sequencing error.</p></fn></table-wrap-foot></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><title>Example simulated high-frequency errors</title><p>Abbreviations: rec: recurrent, u: unique, subs:substitution, del: deletion, ins: insertion, amp: amplicon number, len: length, alt: alternative allele, pos: genomic position, g<italic>N</italic>: SARS-CoV-2 variant genome.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="top">type</th><th align="center" valign="top">rec/u</th><th align="center" valign="top">genome</th><th align="center" valign="top">len</th><th align="center" valign="top">pos</th><th align="center" valign="top">ref</th><th align="center" valign="top">alt</th><th align="center" valign="top">VAF</th><th align="center" valign="top">amp</th></tr></thead><tbody><tr><td align="center" valign="top">subs</td><td align="center" valign="top">rec</td><td align="center" valign="top">g1,g2,g3</td><td align="center" valign="top">1</td><td align="center" valign="top">20,000</td><td align="center" valign="top">A</td><td align="center" valign="top">T</td><td align="center" valign="top">0.1</td><td align="center" valign="top">70,71</td></tr><tr><td align="center" valign="top">subs</td><td align="center" valign="top">u</td><td align="center" valign="top">g2</td><td align="center" valign="top">1</td><td align="center" valign="top">530</td><td align="center" valign="top">T</td><td align="center" valign="top">G</td><td align="center" valign="top">0.2</td><td align="center" valign="top">3</td></tr><tr><td align="center" valign="top">ins</td><td align="center" valign="top">rec</td><td align="center" valign="top">g1,g2,g3</td><td align="center" valign="top">7</td><td align="center" valign="top">245</td><td align="center" valign="top">A</td><td align="center" valign="top">AGCG</td><td align="center" valign="top">0.9</td><td align="center" valign="top">2</td></tr><tr><td align="center" valign="top">del</td><td align="center" valign="top">u</td><td align="center" valign="top">g3</td><td align="center" valign="top">3</td><td align="center" valign="top">230</td><td align="center" valign="top">AGCT</td><td align="center" valign="top">A</td><td align="center" valign="top">0.6</td><td align="center" valign="top">2</td></tr></tbody></table></table-wrap></floats-group></article>