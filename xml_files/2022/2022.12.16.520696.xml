<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158943</article-id><article-id pub-id-type="doi">10.1101/2022.12.16.520696</article-id><article-id pub-id-type="archive">PPR586949</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Consistent typing of plasmids with the mge-cluster pipeline</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Arredondo-Alonso</surname><given-names>Sergio</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Gladstone</surname><given-names>Rebecca A.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Pöntinen</surname><given-names>Anna K.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Gama</surname><given-names>João A.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Schürch</surname><given-names>Anita C.</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Lanza</surname><given-names>Val F.</given-names></name><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Johnsen</surname><given-names>Pål Jarle</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Samuelsen</surname><given-names>Ørjan</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Tonkin-Hill</surname><given-names>Gerry</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Corander</surname><given-names>Jukka</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A8">8</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biostatistics, University of Oslo, Oslo, Norway</aff><aff id="A2"><label>2</label>Parasites and Microbes, Wellcome Sanger Institute, Cambridge, UK</aff><aff id="A3"><label>3</label>Norwegian National Advisory Unit on Detection of Antimicrobial Resistance, Department of Microbiology and Infection Control, University Hospital of North Norway, Tromsø, Norway</aff><aff id="A4"><label>4</label>Department of Pharmacy, Faculty of Health Sciences, UiT The Arctic University of Norway, Tromsø, Norway</aff><aff id="A5"><label>5</label>Department of Medical Microbiology, UMC Utrecht, Utrecht, the Netherlands</aff><aff id="A6"><label>6</label>CIBERINFEC, Madrid, Spain</aff><aff id="A7"><label>7</label>Bioinformatics Unit, University Hospital Ramon y Cajal, IRYCIS, Madrid, Spain</aff><aff id="A8"><label>8</label>Department of Mathematics and Statistics, Helsinki Institute of Information Technology (HIIT), FI-00014 University of Helsinki, Helsinki, Finland</aff><pub-date pub-type="nihms-submitted"><day>23</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>19</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Extrachromosomal elements of bacterial cells such as plasmids are notorious for their importance in evolution and adaptation to changing ecology. However, high-resolution population-wide analysis of plasmids has only become accessible recently with the advent of scalable long-read sequencing technology. Current typing methods for the classification of plasmids remain limited in their scope which motivated us to develop a computationally efficient approach to simultaneously recognize novel types and classify plasmids into previously identified groups. Our method can easily handle thousands of input sequences which are compressed using a unitig representation in a de Bruijn graph. We provide an intuitive visualization, classification and clustering scheme that users can explore interactively. This provides a framework that can be easily distributed and replicated, enabling a consistent labelling of plasmids across past, present, and future sequence collections. We illustrate the attractive features of our approach by the analysis of population-wide plasmid data from the opportunistic pathogen <italic>Escherichia coli</italic> and the distribution of the colistin resistance gene <italic>mcr-1.1</italic> in the plasmid population.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Bacteria can exchange genetic material via Horizontal Gene Transfer (HGT) mediated by Mobile Genetic Elements (MGEs) such as temperate phages and plasmids. Plasmids act as key vehicles for the dissemination of important traits such as antimicrobial resistance (AMR) and virulence both within and between species (<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>). The introduction and broad implementation of long-read sequencing for the assembly of bacterial genomes have led to a dramatic increase in the number of complete plasmid sequences (<xref ref-type="bibr" rid="R3">3</xref>).</p><p id="P3">Clustering and classifying complete plasmid sequences into meaningful groups is a crucial step to understanding the epidemiology of plasmid-encoded genes (<xref ref-type="bibr" rid="R4">4</xref>). Without a consistent plasmid typing scheme, it is challenging to examine, for example, whether AMR genes are disseminated by a single or several plasmid types, or if particular plasmid types are overrepresented in successful bacterial clones. Current plasmid typing tools struggle to account for the extreme modularity observed in plasmids, where large genomic blocks can be rapidly gained or lost. Traditionally, plasmids have been classified according to their replicon and associated incompatibility (Inc) groups using tools such as PlasmidFinder (<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R6">6</xref>). However, replicon-based typing suffers from the presence of multiple replicons within the same sequence, offers a limited resolution for epidemiological purposes (<xref ref-type="bibr" rid="R4">4</xref>) and is only well-established in particular bacteria phyla (e.g. Proteobacteria). Another strategy consists of typing plasmids based on their relaxase, a protein involved in plasmid mobilisation (<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R8">8</xref>), which is in turn limited to plasmids transmissible by conjugation.</p><p id="P4">Network analyses based on k-mers or average nucleotide identities (ANI) have been proposed as an alternative classification framework (<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>). This strategy was implemented in the recent release of COPLA, a novel tool to classify sequences into discrete plasmid taxonomic units (PTUs) based on ANI distances and hierarchical stochastic block modelling (<xref ref-type="bibr" rid="R11">11</xref>). MOB-suite is another tool that classifies sequences but relies on k-mers observed in the entire plasmid (<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R13">13</xref>). MOB-suite uses Mash distances coupled with complete linkage clustering to partition plasmid sequences by maximising consistency with replicon and relaxase schemes. The use of COPLA is mainly restricted to typing small sets of sequences due to its computation-intensive algorithm while MOB-suite is more scalable. MOB-suite uses a single Mash threshold to cluster plasmid sequences into discrete groups and can fail to accurately cluster collections of MGEs with different sequence sizes or gene gain/loss rates.</p><p id="P5">Here, we present <italic>mge-cluster,</italic> a novel approach to consistently type and classify MGE. Mge-cluster provides a classification framework that allows for the typing of thousands of input sequences with a runtime faster than existing algorithms and moderate memory usage. Furthermore, in the light of new MGE data, it offers an option to type these new sequences with an existing mge-cluster model and avoids the need to reanalyse previously typed sequences. Mge-cluster considers the entire sequence content by extracting the unitig sequences which are extended nodes (k-mers) in a compressed de Bruijn graph. The presence/absence of unitigs is embedded into a 2D-representation using openTSNE (<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref>), a non-linear dimensionality reduction algorithm that permits the addition of new points to an existing embedding. The non-linear aspect of the tSNE algorithm allows for plasmid clusters to be identified at multiple scales of genetic variation. The HDBSCAN clustering algorithm is then finally used to define plasmid clusters in the resulting 2D embedding (<xref ref-type="bibr" rid="R17">17</xref>).</p><p id="P6">We demonstrate the features of mge-cluster by generating a plasmid classification framework for the opportunistic pathogen <italic>Escherichia coli,</italic> one of the leading causes of bloodstream and urinary tract infections globally with a large number of complete plasmid sequences available. In this organism, virulence factors are usually associated with plasmids, which drive the virulence of enteroinvasive, enteropathogenic, enterohemorrhagic, enteroaggregative, and extraintestinal pathogenic <italic>E. coli</italic> (<xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R19">19</xref>). Moreover, plasmids are key hosts for AMR determinants such as extended-spectrum β-lactamases and mobile colistin resistance genes contributing to the emergence of <italic>E. coli</italic> multi-drug resistant infections.</p><p id="P7">Overall, mge-cluster provides a fast and consistent classification framework for MGEs that can be easily distributed to enhance the analysis and tracking of these elements.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Test case: Generating a typing scheme for Escherichia coli plasmids</title><p id="P8">To evaluate the applicability and robustness of mge-cluster, we generated a plasmid typing scheme for <italic>E.coli</italic> plasmids. We considered all plasmids from the curated PLSDB plasmid database (<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R21">21</xref>) that includes samples from distinct isolation sources, hosts and countries. This dataset contained highly similar sequences that could lead to an overestimation of the performance of mge-cluster. Thus, redundant sequences were filtered using cd-hit-est (see Methods) to select a single representative plasmid among highly similar sequences (n = 6,185). The discarded plasmid sequences (n = 675) were used as a further test set for benchmarking the runtime and memory required for mge-cluster.</p><p id="P9">After removing uninformative unitigs (k=31) with low variance (0.01, n=680,491), mge-cluster considered 211,198 unitigs as input to generate the classification framework. The resulting unitigs had an average size of 37.52 bp (median=33.00 bp). This left 189 plasmids (3.1%, 189/6,185) without unitigs and these plasmids were excluded from subsequent clustering analysis resulting in 5,996 remaining plasmids in the analysis. The filtered unitig presence/absence matrix was embedded with openTSNE (perplexity=100) and clusters were called using HDBSCAN (min_cluster=30). In total, we obtained 41 discrete plasmid clusters grouping 4,784 sequences (79.8%, 4,784/5,996) with 1,212 sequences remaining unassigned (20.2%, 1,212/5,996) (<xref ref-type="fig" rid="F1">Figure 1</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S1</xref>).</p><p id="P10">The chosen perplexity value can impact the non-linear resultant embedding such that low perplexity values tend to preserve the local structure better, while sometimes artificially introducing some structure when none exists. Conversely, high perplexity values tend to preserve more of the global structure at the cost of merging small clusters together. We evaluated the impact of varying this mge-cluster parameter (perplexity=10, 30, 50, 200) by comparing their resulting clustering assignments using the adjusted Rand index. This index can vary from 0 (completely distinct typing models) to 1 (identical typing models) while adjusting for randomly assigning two sequences belonging to the same cluster. We observed that mge-cluster produced assignments robustly (average Rand index=0.95) to the chosen perplexity values when considering sequences assigned by two resulting models (<xref ref-type="table" rid="T1">Table 1</xref>). In addition, we show that the mge-cluster discrepancy between models can be explained by the sequences which are unassigned by one of the models but clustered in the other (<xref ref-type="table" rid="T1">Table 1</xref>). Consequently, we encourage users to run mge-cluster by setting distinct perplexity values to evaluate cluster stability.</p><p id="P11">Plasmids can rapidly incorporate or lose genomic modules or even co-integrate with other sequences present in the same cell, which drastically affects their size. For each cluster (n=41) (perplexity=100, min_cluster=30), the interquartile range (IQR) of the sequence length was on average 18.66 kbp but with pronounced differences depending on the cluster (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). As an example, cluster 26 (<xref ref-type="fig" rid="F1">Figure 1</xref>) with a mean length of 94.6 kbp showed an IQR of 0.26 kbp indicating an almost intact plasmid backbone, while, cluster 19 (<xref ref-type="fig" rid="F1">Figure 1</xref>) with a mean length of 159.4 kbp had an IQR of 51.2 kbp indicating the presence of distinct gained/lost genomic modules shared by only a fraction of the plasmids assigned to this cluster.</p><p id="P12">To quantify the percentage of shared sequences among plasmids from the same cluster, we used <italic>pyani</italic> to retrieve average nucleotide identity (ANI) and coverage values (<xref ref-type="bibr" rid="R22">22</xref>). On average, plasmids shared 62.3% of their sequence (pyani coverage) with other members from the same cluster with an associated ANI of 95.7%. We observed that the average coverage shared between plasmids varied substantially among clusters indicating distinct degrees of plasmid modularity as previously exemplified with the IQR of the sequence length (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). Clusters 29, 30 and 33, formed by large plasmids, displayed a low pyani coverage indicating that plasmids from those clusters shared only a minor fraction of their sequence. To further understand the content of each mge-cluster, we visualized the diversity of replicons (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S1</xref>) predicted by the MOB-typer module of MOB-suite (<xref ref-type="bibr" rid="R12">12</xref>) based largely on PlasmidFinder (<xref ref-type="bibr" rid="R6">6</xref>).</p></sec><sec id="S4"><title>Comparison of mge-cluster against other plasmid typing tools</title><p id="P13">To assess the level of concordance with current typing schemes, we compared the mge-cluster results against the gold standard methods for plasmid typing. MOB-suite provides a five-character fixed-length code (2 letters and 3 digits) to identify sequences belonging to the same group (termed ‘primary_cluster_id’) (<xref ref-type="supplementary-material" rid="SD3">Supplementary Table 3</xref>), while COPLA provides a PTU designation (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 4</xref>). However, the CPU time (167 minutes, 22 min wall-clock time) and memory (319.5 Mb) required for COPLA to predict the plasmid type of a single sequence (NZ_CP024805.1) hampered us from predicting the entire <italic>E. coli</italic> dataset of 6,185 plasmids for a full comparison with mge-cluster. However, 695 sequences (11.2%, 695/6,185) from our dataset were typed in the original publication describing COPLA [10] and were further considered in this comparison.</p><p id="P14">To compare the overall clustering concordance, we considered the adjusted Rand index which fluctuates from 0 (different clusters) to 1 (same clusters). We observed a moderate agreement between mge-cluster and MOB-suite with an index of 0.61, while for COPLA the adjusted Rand index was 0.53 (<xref ref-type="fig" rid="F2">Figure 2</xref>, no threshold). Notably, we observed that by increasing the membership probability threshold of mge-cluster to assign plasmids to particular clusters, we observed a higher level of overlap between the tools reaching a maximum adjusted Rand index value of 0.77 (<xref ref-type="supplementary-material" rid="SD7">Figure S2</xref>, threshold=0.9).</p><p id="P15">To define which mge-clusters had a higher level of overlap with MOB-suite and COPLA types, we calculated the Simpson diversity of each mge-cluster. For instance, if all plasmids from a particular mge-cluster were designated as a single type by MOB-suite and COPLA, this Simpson diversity value would be 0. In contrast, the presence of multiple types defined by MOB-suite and COPLA would result in diversity values close to 1. The diversity of MOB-suite and COPLA types was represented in <xref ref-type="supplementary-material" rid="SD7">Supplementary Figures S2 and S3</xref>, respectively.</p><p id="P16">The overall Simpson diversity per cluster was 0.46 and 0.21 for MOB-suite and COPLA, respectively. We observed that by increasing the membership probability threshold, the average diversity of MOB-suite types was substantially reduced up to 0.23 (threshold=0.9) with no changes in the case of COPLA (0.21, threshold=0.9) (<xref ref-type="fig" rid="F3">Figure 3</xref>). COPLA produced the same PTU designation (PTU-FE) for 10 distinct mge-clusters which resulted in a lower Simpson diversity than for MOB-suite at the cost of merging together plasmids with a distinct core gene content (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S3</xref>). This PTU-FE type was reported in COPLA’s publication as problematic because several plasmid configurations were present resulting in a low intra-cluster density (<xref ref-type="bibr" rid="R10">10</xref>).</p><p id="P17">MOB-suite showed a consistent agreement (Simpson value &lt; 0.2) in 13 mge-clusters (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). The disagreement between both tools occurred in the mge-clusters with an average small plasmid length (&lt; 10 kbp) (clusters: 2, 7, 12, 14, 20, 21). These clusters consisted of sequences with a predominant replicon type (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S1</xref>), however, MOB-suite predicted those sequences in distinct clusters (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S2</xref>). MOB-suite confirmed with a high Simpson diversity value, that clusters 29, 30 and 33 were formed by large plasmids from distinct types (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>).</p><p id="P18">For the rest of the clusters, we observed that mob-cluster only tended to group sequences that were highly similar in their gene content (high identity and coverage). To illustrate this, we considered a random sequence from mge-cluster 31 predicted with a different type by MOB-suite (NZ_LT985213.1 for AA735, NZ_CP010138.1 for AA334) and performed a gene synteny analysis (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S4</xref>). We could observe that these two sequences, despite being classified by MOB-suite as distinct types (AA735 and AA334), had a blastn coverage and identity of 73.1% and 99.6%, respectively. The synteny analysis revealed both sequences had an IncFII replicon with a well-conserved synteny (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S4</xref>). However, NZ_LT985213.1 had incorporated an extra module corresponding to the co-integration of an IncFIA replicon. MOB-suite uses a stringent Mash threshold (0.06) to group plasmid sequences. Therefore, sequences that share a highly similar plasmid backbone but have gained/lost genomic modules or even co-integrated other plasmids tend to be grouped by MOB-suite into distinct types. In the case of mge-cluster, plasmids acquiring an extra genomic module have a lower membership probability of belonging to the cluster since their unitig content differs but are still part of the same cluster. This behaviour explains why the increase in the membership threshold of mge-cluster results in a higher agreement with MOB-suite (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p></sec><sec id="S5"><title>Predicting novel sequences with an existing mge-cluster model</title><p id="P19">Mge-cluster was built to generate a classification network that can also assign the same cluster names without the requirement to re-analyze any previous dataset and to keep consistent cluster names (--<italic>existing</italic> mode). We considered the sequences discarded by cd-hit-est (n=675) to benchmark the runtime and memory required by mge-cluster to assign these sequences to the previous clusters. In addition, these sequences should be embedded and assigned to the same cluster as the representative sequence from the cd-hit-est step.</p><p id="P20">Mge-cluster predicted these 675 samples using less CPU and wall-clock time (23.3 minutes, ~4 min wall-clock time) than for MOB-suite (CPU time 32.2 minutes, ~ 26 minutes). However, the peak memory usage of mge-cluster (15.9 Gb) was substantially higher than for MOB-suite (4.5 Gb). From these 675 samples, 15 sequences corresponded to cd-hit clusters for which its representative sequence was discarded in the mge-cluster model because of the absence of unitigs and were not evaluated further. Mge-cluster correctly assigned 99.2% (655/660) of the plasmids to the same cluster as their corresponding reference sequence (<xref ref-type="supplementary-material" rid="SD7">Suppl. Figure S5</xref>). In five cases (0.8%, 5/660), mge-cluster predicted another cluster, including four cases where the model returned an unassignment (-1) category.</p><p id="P21">Next, we evaluated the performance of mge-cluster predicting plasmids not present in <italic>E. coli</italic> and thus unseen by the pipeline to build the mge-cluster model. For this, we considered all <italic>Staphylococcus aureus</italic> plasmids (n=1,021) from the PLSDB database because of the absence of plasmid transmission events between these two species (<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>). Mge-cluster did not detect any <italic>E.coli</italic>-specific unitigs (0/211,198) for 972 <italic>S. aureus</italic> plasmids (95%) and thus those sequences were not assigned to any of the mge-clusters from the <italic>E. coli</italic> model (<xref ref-type="supplementary-material" rid="SD5">Supplementary Table S5</xref>). This is due to the high specificity of the unitigs used in the mge-cluster model which had a minimum size of 31 bp and an average size of 37.52 bp. From the remaining 49 plasmids (5%), 28 plasmids were not assigned to any cluster, 12 plasmids were assigned to the mge-cluster 29 and 8 plasmids to the mge-cluster 30. We confirmed that the plasmids assigned to mge-clusters 29 and 30, had a low number of unitigs present and thus corresponded to samples with a vector of nearly all zeros. In those cases, mge-cluster embedded those sequences into clusters 29 and 30 which we previously highlighted as random noise clusters.</p><p id="P22">Lastly, we assessed the performance of mge-cluster predicting plasmids likely shared in other bacterial species from the same family <italic>(Enterobacterales)</italic> as <italic>E. coli.</italic> For this, we selected plasmids from the incompatibility group N (IncN) since they have a conserved core genome, which was used to develop a specific plasmid multilocus sequence typing (pMLST) scheme (<xref ref-type="bibr" rid="R6">6</xref>) and have been reported across several bacterial species belonging to <italic>Enterobacterales</italic> (<xref ref-type="bibr" rid="R23">23</xref>). We considered all IncN <italic>non-E.coli</italic> plasmids from the PLSDB database containing uniquely a single replication gene (n=206) and predicted their clustering assignment with the <italic>E. coli</italic> mge-cluster model (<xref ref-type="supplementary-material" rid="SD6">Supplementary Table S6</xref>). We observed that most IncN plasmids (80.6%, 166/206) were predicted as part of the mge-cluster 27 which contains a majority of <italic>E. coli</italic> plasmids belonging to this incompatibility group (Supplementary <xref ref-type="fig" rid="F1">Figure 1a</xref>) and thus confirming that this plasmid type is shared and has a conserved genomic backbone among <italic>Enterobacterales.</italic> In total, 34 plasmids (16.5%) could not be assigned to any mge-cluster and were labelled as (-1) showing that some of these IncN plasmids might have acquired or recombined with other genomic modules and thus have a clearly distinct unitig content. The remaining plasmids (2.9%, 6/206) were scattered among mge-clusters 29 (n=4), 14 (n=1) and 30 (n=1).</p></sec><sec id="S6"><title>Cluster distribution and visualization of a gene of interest in the embedding space</title><p id="P23">The typing scheme offered by mge-cluster is optimal for visualizing the genomes carrying any particular gene of special interest and tracking its distribution in future sequencing studies. To illustrate this, we considered the AMR gene <italic>mcr-1.1</italic> which confers resistance to colistin, a last-resort antibiotic for treating infections caused by multi-drug resistant <italic>E. coli.</italic> This AMR gene was first reported in 2016 on a plasmid with an IncI2-type backbone (<xref ref-type="bibr" rid="R24">24</xref>) that can be mobilised among distinct MGEs by the presence of an <italic>ISApl1</italic> transposon element situated upstream of the gene (<xref ref-type="bibr" rid="R25">25</xref>).</p><p id="P24">We observed that 327 plasmids contained the <italic>mcr-1.1</italic> gene, the vast majority of these present in only three mge-clusters: 3 (n=168), 1 (n=71) and 16 (n=53) (<xref ref-type="fig" rid="F4">Figure 4</xref>). This was in agreement with previous reports (<xref ref-type="bibr" rid="R26">26</xref>, <xref ref-type="bibr" rid="R27">27</xref>) showing this AMR gene to be mainly spread by the plasmid backbones IncI2 (mge-cluster 3), IncHI2 (mge-cluster 1) and IncX4 (mge-cluster 16) (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure S1</xref>). However, we also observed that the AMR gene was present in nine additional mge-clusters (30/327, 9.2%) (<xref ref-type="fig" rid="F4">Figure 4</xref>) and 5 sequences (1.5%) could not be assigned to any mge-cluster. This illustrates how a consistent typing provided by mge-cluster can be used to explore whether these nine clusters represent spillover events of the gene to other plasmid backbones for which the gene might be further disseminated using new plasmid types.</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P25">The number of MGEs available in public databases has exploded since the introduction of long-read sequencing technologies. However, the contextualization and comparison of MGEs are hampered by their high rates of recombination which result in the absence of a conserved marker that can be broadly used by standard phylogenetic methods. Mge-cluster responds to this need by generating discrete clusters from sequences generally evolving through a fast and dynamic turnover of gene gain/loss events.</p><p id="P26">We demonstrated the potential of mge-cluster by developing an <italic>E. coli</italic> model to classify plasmid sequences. We observed that the clusters generated by mge-cluster typically consisted of sequences with a shared plasmid backbone (coverage ~62%) but distinct accessory content. Mge-cluster and MOB-suite showed a moderate level of agreement between clustering solutions. Some of the disagreement between the tools is explained by mge-cluster grouping together plasmid sequences that have acquired an extra replicon sequence due to the cointegration of another plasmid. This characteristic of mge-cluster is particularly beneficial for tracking a plasmid in the context of longitudinal studies for which the same plasmid can rapidly gain/lose genomic modules. The current version of COPLA makes the typing of large collections unfeasible due to the CPU time required to run a single sample. Moreover, in the particular case of <italic>E. coli,</italic> COPLA erroneously merges clusters from distinct plasmids under the PTU-FE group. In contrast to MOB-suite and COPLA, mge-cluster does not require a predefined distance threshold to generate the typing model which facilitates broad applicability across distinct species and datasets.</p><p id="P27">For epidemiological purposes, clusters obtained with mge-cluster should be interpreted in a similar manner as MLST (<xref ref-type="bibr" rid="R28">28</xref>) or BAPS groups (<xref ref-type="bibr" rid="R29">29</xref>) that cluster strains based on chromosomal housekeeping gene alleles and genome alignments respectively. Even if two plasmids from different samples belong to the same cluster, we cannot directly assume a plasmid transmission scenario. For this, mge-cluster can be considered as a starting point to perform secondary analyses such as SNP phylogenies based on the resulting cluster core genome. These secondary analyses can confirm or refute transmission links, as recently illustrated in two studies presented by Ludden <italic>et al.</italic> and Hawkey <italic>et al.</italic> (<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R31">31</xref>). These types of sequencing studies may benefit from the usage of mge-cluster to define plasmid discrete groups which opens the possibility of sharing their models with other groups for further tracking the distribution of a plasmid or gene-of-interest.</p><p id="P28">While we demonstrated the use of mge-cluster using a single species, the pipeline can also be run on more diverse datasets such as the combination of plasmid sequences from the <italic>Enterobacterales</italic> family. To showcase mge-cluster we considered complete plasmid sequences, but the pipeline could also be utilised to type the bins resulting from tools predicting and extracting plasmids from short-read sequencing data (<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R32">32</xref>, <xref ref-type="bibr" rid="R33">33</xref>). We anticipate that mge-cluster can in addition be used for generating discrete clusters from other types of MGEs with sufficient gene content diversity including phages, integrative and conjugative elements (ICEs) or flanking sequences surrounding a gene-of-interest (e.g AMR gene).</p><p id="P29">The ability of mge-cluster to rapidly assign new plasmids with a consistent type facilitates the comparison of plasmids derived from distinct collections and boosts our capacity to conduct MGE surveillance in general.</p></sec><sec id="S8" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S9"><title>Mge-cluster workflow</title><p id="P30">Mge-cluster is a Python package installable through bioconda <ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/mge-cluster">https://anaconda.org/bioconda/mge-cluster</ext-link>, freely available under the open-source MIT license <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sirarredondo/mge_cluster">https://gitlab.com/sirarredondo/mge_cluster</ext-link>. <xref ref-type="fig" rid="F5">Figure 5</xref> illustrates the two different operational modes of mge-cluster: --<italic>create</italic> and --<italic>existing.</italic> In both cases, mge-cluster takes as input a file that indicates the absolute or relative paths to the nucleotide sequence files (.fasta format). The --<italic>create</italic> mode will generate a new classification scheme for the sequences provided as input by the user while the --<italic>existing</italic> mode will return embedding coordinates and cluster assignments considering a previous, existing mge-cluster model. Both modes can be run with the multithreading option (--<italic>threads</italic>) to reduce mge-cluster runtime.</p></sec><sec id="S10"><title>Operational mode --create: Unitigs as classification features</title><p id="P31">Unitigs defined as extended nodes in a compressed de Bruijn graph were selected as features for building the classification framework. Unitig-caller (--<italic>call</italic> mode, version 1.2.1) <ext-link ext-link-type="uri" xlink:href="https://github.com/bacpop/unitig-caller">https://github.com/bacpop/unitig-caller</ext-link> which implements Bifrost Build (<xref ref-type="bibr" rid="R34">34</xref>) is used with a k-mer size specified by the mge-cluster (argument --<italic>kmer</italic>) to generate a presence/absence matrix of the unitigs present in the input file.</p><p id="P32">Bifrost initially considers a <italic>de Bruijn</italic> graph structure defined as a direct graph: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>)</mml:mi></mml:mrow></mml:math></disp-formula></p><p id="P33"><italic>V</italic> corresponds to the number of vertices (k-mers) present and <italic>E</italic> to the edges connecting the distinct vertices. Thus, the vertices <italic>V</italic> present in graph <italic>G</italic> can be defined by: <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mn>...</mml:mn><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P34">The edges <italic>E</italic> can be defined as direct connections between two vertices of <italic>V</italic>: <disp-formula id="FD3"><mml:math id="M3"><mml:mrow><mml:mi>E</mml:mi><mml:mo>={(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>):|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mtext>n with an edge from </mml:mtext><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mtext>to </mml:mtext><mml:mi>v</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P35">For each <italic>v ∈ V,</italic> we define the in-degree <italic>d<sup>i</sup> (v</italic>) and out-degree <italic>d°(v</italic>) as the number of edges in <italic>E</italic> towards and from <italic>v</italic> respectively.</p><p id="P36">Paths in the graph can be defined as finite sequences of distinct vertices connected by edges <italic>p</italic> = (<italic>v</italic><sub>0</sub>, <italic>e</italic>(<italic>v</italic><sub>0</sub> <italic>v</italic><sub>1</sub>), <italic>v</italic><sub>1</sub>, <italic>e</italic>(<italic>v</italic><sub>1</sub>, <italic>v</italic><sub>2</sub>), …, <italic>v<sub>k</sub>,</italic> <italic>e</italic>(<italic>v<sub>k</sub></italic>–1 <italic>v<sub>k</sub></italic>)). Bifrost then considers all non-branching paths, defined as paths <italic>p</italic> in which all vertices have an <italic>d<sup>i</sup></italic> (<italic>v</italic>) = 1 and <italic>d°</italic> (<italic>v</italic>) = 1 excluding the first and last vertices in <italic>p.</italic></p><p id="P37">Each non-branching path is merged into a single vertex, termed unitig in Bifrost. Those unitigs represent extensions of the initial k-mers (vertices) that are longer in length than the original k-mer size. Unitig-caller then creates a presence/absence matrix of those unitigs. We can define <italic>M,</italic> as a binary matrix with <italic>s</italic> * <italic>u</italic> dimensions, in which <italic>s</italic> is the total number of sequences present in the input file and <italic>u</italic> corresponds to the total number of unitigs extracted by Bifrost. <disp-formula id="FD4"><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P38">Unitigs were chosen over other features (e.g. gene presence/absence) because identical unitig definitions could be computed between distinct datasets, an essential characteristic for the --<italic>existing</italic> prediction mode of mge-cluster. To reduce the memory use required to build the typing scheme, we remove unitigs with a variance less than 0.01 (default) using the function VarianceThreshold of the python package sklearn (version 1.0.2) (<xref ref-type="bibr" rid="R35">35</xref>). In this manner, we remove unitigs (features in the model) that have the same value for all samples and thus do not provide any relevant information for the embedding process. This variance threshold can be modified by the user in mge-cluster (argument --<italic>variance</italic>).</p></sec><sec id="S11"><title>Operational mode --create: Embedding the presence/absence of unitigs into a lower number of dimensions</title><p id="P39">We considered the implementation of the tSNE algorithm available in the python package openTSNE (version 0.6.1) (<xref ref-type="bibr" rid="R15">15</xref>) to generate a 2D embedding based on <italic>M,</italic> the unitigs presence/absence matrix. This new implementation improved the global positioning of the points and introduced the possibility of mapping new points into an existing, reference embedding. The multidimensional presence/absence matrix of unitig-caller can be represented as <italic>M</italic> = {<italic>m</italic><sub>1</sub>, <italic>m</italic><sub>2</sub>, … <italic>m<sub>s</sub></italic>} ∈ <italic>R<sup>u</sup></italic> for which <italic>m<sub>s</sub></italic> corresponds to a datapoint (sequence) with <italic>u</italic> defined as the number of dimensions (number of unitigs passing the variance threshold). In our case, openTSNE is run to find a 2D dimensional embedding <italic>Y</italic> = {<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, … <italic>y<sub>s</sub></italic>} ∈ <italic>R</italic><sup>2</sup> in which the original distance between <italic>m</italic><sub>1</sub> and <italic>m<sub>s</sub></italic> is preserved in <italic>y</italic><sub>1</sub> and <italic>y<sub>s</sub></italic>. The similarity between two data points in the original space is measured with Jaccard distances (flag --metric). The perplexity value is one of the main parameters of openTSNE that affects how the similarity between two data points in the original space is preserved in the resulting embedding space. Large perplexity values tend to preserve the global structure of the data better while obscuring some of the local structure potentially resulting in small clusters being merged together. Small perplexity values generate tight dense clusters preserving the local structure better but ignore the overall global structure for which the distance and position of the clusters in the resulting embedding can no longer be considered.</p><p id="P40">The TSNE function can be run with different perplexity values specified by the user with the mge-cluster arguments --<italic>perplexity</italic>, using ‘exact’ as the method for finding the nearest neighbor (flag --<italic>neighbors</italic>). For reproducibility purposes, we fixed the seed of the random number generator with the flag --<italic>random_state.</italic></p></sec><sec id="S12"><title>Operational mode --create: Calling plasmid clusters in the embedding space</title><p id="P41">To define which clusters were present in the embedding space <italic>Y</italic> = {<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, … <italic>y<sub>s</sub></italic>} ∈ <italic>R</italic><sup>2</sup> created by openTSNE, we required a clustering algorithm that (i) did not force us to provide the number of clusters present in the data, (ii) tolerated noisy data since plasmid modularity can result in sequences that are hybrids between two neighbouring clusters, (iii) tolerated clusters with different density and sizes (iv) allowed the assignment of new data points to an existing clustering solution. Based on these four premises, we selected the HDBSCAN algorithm (<xref ref-type="bibr" rid="R17">17</xref>), an improved version of dbscan that finds highly stable clusters over a range of epsilon values (the main parameter of dbscan).</p><p id="P42">HDBSCAN defines the mutual reachability distance (extracted from HDBSCAN documentation) as <italic>d<sub>mreach–k</sub></italic>(<italic>y</italic><sub>1</sub>, <italic>y<sub>s</sub></italic>) = <italic>max</italic>(<italic>core<sub>k</sub></italic>(<italic>y</italic><sub>1</sub>), <italic>core<sub>k</sub></italic>(<italic>y<sub>s</sub></italic>), <italic>d</italic>(<italic>y</italic><sub>1</sub>, <italic>y<sub>s</sub></italic>)), where <italic>d</italic>(<italic>y</italic><sub>1</sub>, <italic>y<sub>s</sub></italic>) is the original metric distance (Euclidean) and <italic>core<sub>k</sub></italic> the distance to its <italic>k</italic>th neighbour. This <italic>mreach</italic> distance is used to transform the embedding space into a new space where points with low core distances remain together while pushing away sparser points. This distance is considered to create a graph structure <italic>HG</italic> = (<italic>P, D</italic>) in which nodes <italic>P</italic> correspond to the original data points <italic>y<sub>s</sub></italic> while <italic>D</italic> are all edges with weight equal to <italic>d<sub>mreach–k</sub></italic>(<italic>y</italic><sub>1</sub>, <italic>y<sub>s</sub></italic>). HDBSCAN then transforms <italic>HG</italic> into a minimum spanning tree to look into the hierarchy of connected components. Lastly, HDBSCAN uses the parameter --min_cluster_size to define the minimum number of points that are required to define a cluster. This parameter is then used to generate a condensed tree to select clusters with high persistence. Lastly, HDBSCAN outputs for each point <italic>y<sub>s</sub></italic> their assigned cluster and membership probability.</p><p id="P43">The python package hdbscan (version 0.8.28) with the primary function HDBSCAN is run to specify a default minimum cluster size (flag --<italic>min_cluster_size</italic>) defined by the user in mge-cluster (argument --<italic>min_cluster</italic>).</p><p id="P44">The main output of this operational mode consists of a comma-separated file (csv) with the embedding coordinates given by openTSNE (columns ‘tsne1D’, ‘tsne2D’), the cluster assigned and membership probability returned by HDBSCAN (column ‘Standard_Cluster’ and ‘Membership_Probability’ and the last column (‘Sample_Name’) indicating the header extracted from the given nucleotide sequences.</p></sec><sec id="S13"><title>Operational mode --create: Storing and distributing an mge-cluster model</title><p id="P45">Mge-cluster was specifically designed to generate a classification scheme that can easily be distributed and reused by other users. The following files constitute a mge-cluster model: i) <italic>*.unitigs.fasta,</italic> the fasta file containing the unitigs with a variance higher than specified in the argument --<italic>variance,</italic> ii) <italic>*.embedding.pbz2,</italic> embedding model created by openTSNE to transform the unitig presence/absence matrix into 2D and iii) <italic>*clusters.pbz2,</italic> clustering model created by HDBSCAN to call clusters in the resulting embedding from openTSNE.</p></sec><sec id="S14"><title>Operational mode --existing: Prediction of a new batch of sequences using an existing mge-cluster model</title><p id="P46">For predicting the embedding coordinates and the cluster assignment of a new batch of plasmid sequences with an existing mge-cluster model, we designed the --<italic>existing</italic> operational mode. In this mode, mge-cluster requires an input file pointing to the nucleotide sequences of interest and the folder with the files constituting a mge-cluster model (<xref ref-type="fig" rid="F5">Figure 5</xref>).</p><p id="P47">Mge-cluster performs the following steps: i) computes the same unitig definitions present in the file <italic>*unitigs.fasta,</italic> using unitig-caller (--query mode), ii) uses the transform function from openTSNE python package to embed the new points to the existing embedding present in the file <italic>*embedding.pbz2,</italic> iii) assigns the new points to the existing HDBSCAN clusters present in the file <italic>*clusters.pbz2</italic> using the approximate_predict function from the hdbscan python package.</p></sec><sec id="S15"><title>Mge-cluster showcase: Generating an E. coli model to classify plasmid sequences</title><p id="P48">To showcase mge-cluster, we developed an <italic>E. coli</italic> model to classify plasmid sequences. We considered all plasmid sequences (n=6,864) with the species <italic>‘Escherichia coli’</italic> annotated in the PLSDB database (<xref ref-type="bibr" rid="R20">20</xref>). Sequences from this database can contain near identical plasmids which could bias the downstream validation of mge-cluster. To select a single representative sequence among highly similar plasmids, we used cd-hit-est (version 4.8.1) to remove redundant sequences within a 0.99 sequence identity threshold (-c 0.99 -s 0.9 -aL 0.9) (<xref ref-type="bibr" rid="R36">36</xref>, <xref ref-type="bibr" rid="R37">37</xref>). Cd-hit-est generated 6,185 groups encompassing plasmid sequences with high similarity and coverage, from these only a single representative sequence was chosen. The discarded sequences were used to benchmark the CPU time, runtime and memory required by mge-cluster to predict sequences considering an existing mge-cluster model. These sequences were also used as a quality check to ensure that mge-cluster returned the same cluster assignment as their cd-hit-est group.</p><p id="P49">We clustered the set of 6.185 non-redundant plasmids using mge-cluster. The perplexity was set to 100 (--<italic>perplexity</italic>), with a minimum cluster size of 30 (--<italic>min_cluster</italic>). Unitigs were discarded if their variance exceeded 0.01 (--<italic>variance</italic>). We used the script average_nucleotide_identity.py included in the pyani package (version 0.2.11) to calculate the average coverage and average nucleotide identity (ANI) of the plasmids within each cluster (<xref ref-type="bibr" rid="R38">38</xref>). We performed distinct runs of mge-cluster setting distinct perplexity values (10, 30, 50, 200) to compare the resulting clustering solution against the presented mge-cluster model (perplexity=100). For this, we considered the adjusted Rand index implemented in the function <italic>adjustedRandIndex</italic> from the mclust R package (version 5.4.7) (<xref ref-type="bibr" rid="R39">39</xref>). For representing the embedding created by openTSNE and the clusters defined by HDBSCAN, we used ggplot2 (version 3.3.6) and considered the Khachiyan algorithm implemented in the ggforce R package (<xref ref-type="bibr" rid="R40">40</xref>) to draw ellipses around the clusters.</p><p id="P50">The clustering given by mge-cluster was compared against the current typing schemes: i) ‘primary_cluster_id’ reported by the module MOB-typer of MOB-suite (<xref ref-type="bibr" rid="R12">12</xref>), a five-character fixed-length code that groups plasmids using complete-linkage clustering based on Mash distances (default distance = 0.06) and ii) plasmid taxonomic units (PTUs) reported by COPLA based on ANI distances and hierarchical stochastic block modelling (<xref ref-type="bibr" rid="R11">11</xref>). Due to the CPU time and memory required by COPLA to predict a single sample, we could not perform the typing and comparison of all the 6,185 plasmid sequences included in the model. Instead, from these 6,185 sequences, we considered 695 plasmids typed with a PTU in a recent publication introducing COPLA (<xref ref-type="bibr" rid="R10">10</xref>).</p><p id="P51">To quantify the concordance of the clustering solutions, we compared MOB-suite and COPLA against mge-cluster considering the adjusted Rand index (<xref ref-type="bibr" rid="R39">39</xref>). This metric compares two clustering solutions for the same set of points and returns a value ranging from 0 (no similarity) to 1 (identical clustering). The pairwise comparisons were only performed with sequences with a defined cluster for any of the typing tools, thus discarding plasmids labelled as -1 for mge-cluster or with an unknown PTU (‘-’) by COPLA. To further inspect the level of concordance between typing schemes, for each mge-cluster we computed its Simpson diversity for replicon, MOB-suite clusters (‘primary_cluster_id’) and COPLA PTUs. We considered the function <italic>diversity</italic> implemented in the vegan R package (version 2.5-7) specifying the ‘simpson’ index. This value can range from 0 (no diversity, same clustering solution) to 1 (high diversity, distinct clustering solution). To illustrate the differences between the clusterings given by mge-cluster and MOB-suite, we performed a gene synteny analysis with clinker (version v0.0.21) (<xref ref-type="bibr" rid="R41">41</xref>) using two randomly chosen sequences belonging to the same mge-cluster but differing in their MOB-suite cluster. To visualize the diversity of clustering solutions within each mge-cluster, we used the treemapify R package (version 2.5.5) which produces treemaps for displaying nested and hierarchical data (<xref ref-type="bibr" rid="R42">42</xref>).</p><p id="P52">To assess the performance of mge-cluster assigning plasmid sequences with a distinct gene content and origin, we considered all plasmid sequences (n=1,020) with the species <italic>‘Staphylococcus aureus’</italic> annotated from the PLSDB database and used the operational mode --existing of mge-cluster to assign these sequences to the clusters defined in the <italic>E. coli</italic> mge-cluster model. In the same manner, we typed all IncN plasmids (n=206) from PLSDB belonging to a species different to <italic>E. coli</italic> annotated in the database and having uniquely a single replication gene in the field ‘PlasmidFinder’.</p><p id="P53">To illustrate the potential of mge-cluster to track the distribution of a gene-of-interest, we searched for AMR genes in our <italic>E. coli</italic> dataset using AMRFinderPlus (version 3.10.18) indicating as organism (-O) <italic>Escherichia,</italic> specifying the --plus flag and other default settings (<xref ref-type="bibr" rid="R43">43</xref>). From the resulting report, we searched for plasmid sequences encoding for the gene <italic>mcr-1.1</italic> (NCBI Reference Sequence accession NG_050417.1).</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Table 1</label><media xlink:href="EMS158943-supplement-Supplementary_Table_1.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d39aAdEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Table 2</label><media xlink:href="EMS158943-supplement-Supplementary_Table_2.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d39aAdEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Table 3</label><media xlink:href="EMS158943-supplement-Supplementary_Table_3.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d39aAdEdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplementary Table 4</label><media xlink:href="EMS158943-supplement-Supplementary_Table_4.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d39aAdEeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary Table 5</label><media xlink:href="EMS158943-supplement-Supplementary_Table_5.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d39aAdEfB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>Supplementary Table 6</label><media xlink:href="EMS158943-supplement-Supplementary_Table_6.tsv" mimetype="text" mime-subtype="tab-separated-values; charset=utf-8" id="d39aAdEgB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>Supplementary Figures</label><media xlink:href="EMS158943-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d39aAdEhB" position="anchor"/></supplementary-material></sec></body><back><ack id="S16"><title>Funding</title><p>This project was supported by the European Union’s Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie Actions (grant No. 801,133 to S.A.-A. and A.K.P.). This work has been funded by the Trond Mohn Foundation (grant identifier TMS2019TMT04 to A.K.P., R.A.G., 0.S., P.J.J., and J.C.). This work received funding from the European Research Council (grant No. 742,158 to J.C.) and was partially supported by ZonMW (The Netherlands, project number 541003005 to A.C.S).</p></ack><sec id="S17" sec-type="data-availability"><title>Data and code availability</title><p id="P54">The mge-cluster package can be installed from bioconda <ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/mge-cluster">https://anaconda.org/bioconda/mge-cluster</ext-link> under the open-source MIT license. Extensive documentation on mge-cluster usage is available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sirarredondo/mge-cluster">https://gitlab.com/sirarredondo/mge-cluster</ext-link>.</p><p id="P55">The code required to reproduce the results and figures presented in this manuscript is available as a Rmarkdown document at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sirarredondo/mge-clustermanuscript">https://gitlab.com/sirarredondo/mge-clustermanuscript</ext-link></p><p id="P56">The plasmid sequences retrieved from the PLSDB database used to generate the <italic>E. coli</italic> mge-cluster for plasmid classification are publicly available at NCBI and their accession numbers listed on Supplementary Table S1. The accession numbers from the <italic>S. aureus</italic> and <italic>non-E.coli</italic> IncN plasmids retrieved from the PLSDB database and considered to assess the performance of mge-cluster typing new MGE data are available in Supplementary Tables S5 and S6 respectively.</p><p id="P57">The <italic>E. coli</italic> mge-cluster model presented in this manuscript is available as a figshare item at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.21674078.v1">https://doi.org/10.6084/m9.figshare.21674078.v1</ext-link></p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smalla</surname><given-names>K</given-names></name><name><surname>Jechalke</surname><given-names>S</given-names></name><name><surname>Top</surname><given-names>EM</given-names></name></person-group><article-title>Plasmid Detection, Characterization, and Ecology</article-title><source>Microbiol Spectr</source><year>2015</year><volume>3</volume><elocation-id>PLAS–0038–2014</elocation-id><pub-id pub-id-type="pmcid">PMC4480600</pub-id><pub-id pub-id-type="pmid">26104560</pub-id><pub-id pub-id-type="doi">10.1128/microbiolspec.PLAS-0038-2014</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carattoli</surname><given-names>A</given-names></name></person-group><article-title>Plasmids and the spread of resistance</article-title><source>Int J Med Microbiol</source><year>2013</year><volume>303</volume><fpage>298</fpage><lpage>304</lpage><pub-id pub-id-type="pmid">23499304</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orlek</surname><given-names>A</given-names></name><name><surname>Phan</surname><given-names>H</given-names></name><name><surname>Sheppard</surname><given-names>AE</given-names></name><name><surname>Doumith</surname><given-names>M</given-names></name><name><surname>Ellington</surname><given-names>M</given-names></name><name><surname>Peto</surname><given-names>T</given-names></name><name><surname>Crook</surname><given-names>D</given-names></name><name><surname>Walker</surname><given-names>AS</given-names></name><name><surname>Woodford</surname><given-names>N</given-names></name><name><surname>Anjum</surname><given-names>MF</given-names></name><etal/></person-group><article-title>Ordering the mob: Insights into replicon and MOB typing schemes from analysis of a curated dataset of publicly available plasmids</article-title><source>Plasmid</source><year>2017</year><volume>91</volume><fpage>42</fpage><lpage>52</lpage><pub-id pub-id-type="pmcid">PMC5466382</pub-id><pub-id pub-id-type="pmid">28286183</pub-id><pub-id pub-id-type="doi">10.1016/j.plasmid.2017.03.002</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orlek</surname><given-names>A</given-names></name><name><surname>Stoesser</surname><given-names>N</given-names></name><name><surname>Anjum</surname><given-names>MF</given-names></name><name><surname>Doumith</surname><given-names>M</given-names></name><name><surname>Ellington</surname><given-names>MJ</given-names></name><name><surname>Peto</surname><given-names>T</given-names></name><name><surname>Crook</surname><given-names>D</given-names></name><name><surname>Woodford</surname><given-names>N</given-names></name><name><surname>Walker</surname><given-names>AS</given-names></name><name><surname>Phan</surname><given-names>H</given-names></name><etal/></person-group><article-title>Plasmid Classification in an Era of Whole-Genome Sequencing: Application in Studies of Antibiotic Resistance Epidemiology</article-title><source>Front Microbiol</source><year>2017</year><volume>8</volume><fpage>182</fpage><pub-id pub-id-type="pmcid">PMC5299020</pub-id><pub-id pub-id-type="pmid">28232822</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.00182</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carattoli</surname><given-names>A</given-names></name><name><surname>Bertini</surname><given-names>A</given-names></name><name><surname>Villa</surname><given-names>L</given-names></name><name><surname>Falbo</surname><given-names>V</given-names></name><name><surname>Hopkins</surname><given-names>KL</given-names></name><name><surname>Threlfall</surname><given-names>EJ</given-names></name></person-group><article-title>Identification of plasmids by PCR-based replicon typing</article-title><source>J Microbiol Methods</source><year>2005</year><volume>63</volume><fpage>219</fpage><lpage>228</lpage><pub-id pub-id-type="pmid">15935499</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carattoli</surname><given-names>A</given-names></name><name><surname>Zankari</surname><given-names>E</given-names></name><name><surname>Garcia-Fernandez</surname><given-names>A</given-names></name><name><surname>Larsen</surname><given-names>MV</given-names></name><name><surname>Lund</surname><given-names>O</given-names></name><name><surname>Villa</surname><given-names>L</given-names></name><name><surname>Aarestrup</surname><given-names>FM</given-names></name><name><surname>Hasman</surname><given-names>H</given-names></name></person-group><article-title>In Silico detection and typing of plasmids using plasmidfinder and plasmid multilocus sequence typing</article-title><source>Antimicrob Agents Chemother</source><year>2014</year><volume>58</volume><fpage>3895</fpage><lpage>3903</lpage><pub-id pub-id-type="pmcid">PMC4068535</pub-id><pub-id pub-id-type="pmid">24777092</pub-id><pub-id pub-id-type="doi">10.1128/AAC.02412-14</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcillan-Barcia</surname><given-names>MP</given-names></name><name><surname>Francia</surname><given-names>MV</given-names></name><name><surname>de la Cruz</surname><given-names>F</given-names></name></person-group><article-title>The diversity of conjugative relaxases and its application in plasmid classification</article-title><source>FEMS Microbiol Rev</source><year>2009</year><volume>33</volume><fpage>657</fpage><lpage>687</lpage><pub-id pub-id-type="pmid">19396961</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garcillan-Barcia</surname><given-names>MP</given-names></name><name><surname>Redondo-Salvo</surname><given-names>S</given-names></name><name><surname>Vielva</surname><given-names>L</given-names></name><name><surname>de la Cruz</surname><given-names>F</given-names></name></person-group><chapter-title>MOBscan: Automated Annotation of MOB Relaxases</chapter-title><person-group person-group-type="editor"><name><surname>de la Cruz</surname><given-names>F</given-names></name></person-group><source>Horizontal Gene Transfer: Methods and Protocols</source><publisher-name>Springer US</publisher-name><publisher-loc>New York, NY</publisher-loc><year>2020</year><fpage>295</fpage><lpage>308</lpage><pub-id pub-id-type="pmid">31584171</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Acman</surname><given-names>M</given-names></name><name><surname>van Dorp</surname><given-names>L</given-names></name><name><surname>Santini</surname><given-names>JM</given-names></name><name><surname>Balloux</surname><given-names>F</given-names></name></person-group><article-title>Large-scale network analysis captures biological features of bacterial plasmids</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>2452</elocation-id><pub-id pub-id-type="pmcid">PMC7229196</pub-id><pub-id pub-id-type="pmid">32415210</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-16282-w</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redondo-Salvo</surname><given-names>S</given-names></name><name><surname>Fernández-López</surname><given-names>R</given-names></name><name><surname>Ruiz</surname><given-names>R</given-names></name><name><surname>Vielva</surname><given-names>L</given-names></name><name><surname>de Toro</surname><given-names>M</given-names></name><name><surname>Rocha</surname><given-names>EPC</given-names></name><name><surname>Garcillan-Barcia</surname><given-names>MP</given-names></name><name><surname>de la Cruz</surname><given-names>F</given-names></name></person-group><article-title>Pathways for horizontal gene transfer in bacteria revealed by a global map of their plasmids</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>3602</elocation-id><pub-id pub-id-type="pmcid">PMC7367871</pub-id><pub-id pub-id-type="pmid">32681114</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-17278-2</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redondo-Salvo</surname><given-names>S</given-names></name><name><surname>Bartomeus-Peñalver</surname><given-names>R</given-names></name><name><surname>Vielva</surname><given-names>L</given-names></name><name><surname>Tagg</surname><given-names>KA</given-names></name><name><surname>Webb</surname><given-names>HE</given-names></name><name><surname>Fernandez-Lopez</surname><given-names>R</given-names></name><name><surname>de la Cruz</surname><given-names>F</given-names></name></person-group><article-title>COPLA, a taxonomic classifier of plasmids</article-title><source>BmC Bioinformatics</source><year>2021</year><volume>22</volume><fpage>390</fpage><pub-id pub-id-type="pmcid">PMC8325299</pub-id><pub-id pub-id-type="pmid">34332528</pub-id><pub-id pub-id-type="doi">10.1186/s12859-021-04299-x</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>J</given-names></name><name><surname>Nash</surname><given-names>JHE</given-names></name></person-group><article-title>MOB-suite: software tools for clustering, reconstruction and typing of plasmids from draft assemblies</article-title><source>Microb Genom</source><year>2018</year><volume>4</volume><pub-id pub-id-type="pmcid">PMC6159552</pub-id><pub-id pub-id-type="pmid">30052170</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000206</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>J</given-names></name><name><surname>Bessonov</surname><given-names>K</given-names></name><name><surname>Schonfeld</surname><given-names>J</given-names></name><name><surname>Nash</surname><given-names>JHE</given-names></name></person-group><article-title>Universal whole-sequence-based plasmid typing and its utility to prediction of host range and epidemiological surveillance</article-title><source>Microb Genom</source><year>2020</year><volume>6</volume><pub-id pub-id-type="pmcid">PMC7660255</pub-id><pub-id pub-id-type="pmid">32969786</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000435</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>GC</given-names></name><name><surname>Rachh</surname><given-names>M</given-names></name><name><surname>Hoskins</surname><given-names>JG</given-names></name><name><surname>Steinerberger</surname><given-names>S</given-names></name><name><surname>Kluger</surname><given-names>Y</given-names></name></person-group><article-title>Fast interpolation-based t-SNE for improved visualization of single-cell RNA-seq data</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>243</fpage><lpage>245</lpage><pub-id pub-id-type="pmcid">PMC6402590</pub-id><pub-id pub-id-type="pmid">30742040</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0308-4</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poličar</surname><given-names>PG</given-names></name><name><surname>Stražar</surname><given-names>M</given-names></name><name><surname>Zupan</surname><given-names>B</given-names></name></person-group><article-title>openTSNE: a modular Python library for t-SNE dimensionality reduction and embedding</article-title><source>bioRxiv</source><year>2019</year><pub-id pub-id-type="doi">10.1101/731877</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poličar</surname><given-names>PG</given-names></name><name><surname>StraŽar</surname><given-names>M</given-names></name><name><surname>Zupan</surname><given-names>B</given-names></name></person-group><article-title>Embedding to reference t-SNE space addresses batch effects in single-cell classification</article-title><source>Mach Learn</source><year>2021</year><pub-id pub-id-type="doi">10.1007/s10994-021-06043-1</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Astels</surname><given-names>S</given-names></name></person-group><article-title>hdbscan: Hierarchical density based clustering</article-title><source>J Open Source Softw</source><year>2017</year><volume>2</volume><fpage>205</fpage></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaper</surname><given-names>JB</given-names></name><name><surname>Nataro</surname><given-names>JP</given-names></name><name><surname>Mobley</surname><given-names>HL</given-names></name></person-group><article-title>Pathogenic Escherichia coli</article-title><source>Nat Rev Microbiol</source><year>2004</year><volume>2</volume><fpage>123</fpage><lpage>140</lpage><pub-id pub-id-type="pmid">15040260</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson Timothy</surname><given-names>J</given-names></name><name><surname>Nolan Lisa</surname><given-names>K</given-names></name></person-group><article-title>Pathogenomics of the Virulence Plasmids of Escherichia coli</article-title><source>Microbiol Mol Biol Rev</source><year>2009</year><volume>73</volume><fpage>750</fpage><lpage>774</lpage><pub-id pub-id-type="pmcid">PMC2786578</pub-id><pub-id pub-id-type="pmid">19946140</pub-id><pub-id pub-id-type="doi">10.1128/MMBR.00015-09</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galata</surname><given-names>V</given-names></name><name><surname>Fehlmann</surname><given-names>T</given-names></name><name><surname>Backes</surname><given-names>C</given-names></name><name><surname>Keller</surname><given-names>A</given-names></name></person-group><article-title>PLSDB: a resource of complete bacterial plasmids</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>D195</fpage><lpage>D202</lpage><pub-id pub-id-type="pmcid">PMC6323999</pub-id><pub-id pub-id-type="pmid">30380090</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky1050</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmartz</surname><given-names>GP</given-names></name><name><surname>Hartung</surname><given-names>A</given-names></name><name><surname>Hirsch</surname><given-names>P</given-names></name><name><surname>Kern</surname><given-names>F</given-names></name><name><surname>Fehlmann</surname><given-names>T</given-names></name><name><surname>Muller</surname><given-names>R</given-names></name><name><surname>Keller</surname><given-names>A</given-names></name></person-group><article-title>PLSDB: advancing a comprehensive database of bacterial plasmids</article-title><source>Nucleic Acids Res</source><year>2022</year><volume>50</volume><fpage>D273</fpage><lpage>D278</lpage><pub-id pub-id-type="pmcid">PMC8728149</pub-id><pub-id pub-id-type="pmid">34850116</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkab1111</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>L</given-names></name><name><surname>Cock</surname><given-names>P</given-names></name><name><surname>Esen</surname><given-names>Ö</given-names></name></person-group><article-title>pyani v0. 2.8: average nucleotide identity (ANI) and related measures for whole genome comparisons</article-title><year>2019</year></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>García-Fernández</surname><given-names>A</given-names></name><name><surname>Villa</surname><given-names>L</given-names></name><name><surname>Moodley</surname><given-names>A</given-names></name><name><surname>Hasman</surname><given-names>H</given-names></name><name><surname>Miriagou</surname><given-names>V</given-names></name><name><surname>Guardabassi</surname><given-names>L</given-names></name><name><surname>Carattoli</surname><given-names>A</given-names></name></person-group><article-title>Multilocus sequence typing of IncN plasmids</article-title><source>J Antimicrob Chemother</source><year>2011</year><volume>66</volume><fpage>1987</fpage><lpage>1991</lpage><pub-id pub-id-type="pmid">21653604</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y-Y</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Walsh</surname><given-names>TR</given-names></name><name><surname>Yi</surname><given-names>L-X</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Spencer</surname><given-names>J</given-names></name><name><surname>Doi</surname><given-names>Y</given-names></name><name><surname>Tian</surname><given-names>G</given-names></name><name><surname>Dong</surname><given-names>B</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><etal/></person-group><article-title>Emergence of plasmid-mediated colistin resistance mechanism MCR-1 in animals and human beings in China: a microbiological and molecular biological study</article-title><source>Lancet Infect Dis</source><year>2016</year><volume>16</volume><fpage>161</fpage><lpage>168</lpage><pub-id pub-id-type="pmid">26603172</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poirel</surname><given-names>L</given-names></name><name><surname>Kieffer</surname><given-names>N</given-names></name><name><surname>Nordmann</surname><given-names>P</given-names></name></person-group><article-title>In Vitro Study of ISApl1-Mediated Mobilization of the Colistin Resistance Gene mcr-1</article-title><source>Antimicrob Agents Chemother</source><year>2017</year><volume>61</volume><pub-id pub-id-type="pmcid">PMC5487687</pub-id><pub-id pub-id-type="pmid">28416554</pub-id><pub-id pub-id-type="doi">10.1128/AAC.00127-17</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matamoros</surname><given-names>S</given-names></name><name><surname>van Hattem</surname><given-names>JM</given-names></name><name><surname>Arcilla</surname><given-names>MS</given-names></name><name><surname>Willemse</surname><given-names>N</given-names></name><name><surname>Melles</surname><given-names>DC</given-names></name><name><surname>Penders</surname><given-names>J</given-names></name><name><surname>Vinh</surname><given-names>TN</given-names></name><name><surname>ThiHoa</surname><given-names>N</given-names></name><name><surname>Bootsma</surname><given-names>MCJ</given-names></name><name><surname>van Genderen</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>Global phylogenetic analysis of Escherichia coli and plasmids carrying the mcr-1 gene indicates bacterial diversity but plasmid restriction</article-title><source>Sci Rep</source><year>2017</year><volume>7</volume><elocation-id>15364</elocation-id><pub-id pub-id-type="pmcid">PMC5681592</pub-id><pub-id pub-id-type="pmid">29127343</pub-id><pub-id pub-id-type="doi">10.1038/s41598-017-15539-7</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Migura-Garcia</surname><given-names>L</given-names></name><name><surname>González-López</surname><given-names>JJ</given-names></name><name><surname>Martinez-Urtaza</surname><given-names>J</given-names></name><name><surname>Aguirre Sánchez</surname><given-names>JR</given-names></name><name><surname>Moreno-Mingorance</surname><given-names>A</given-names></name><name><surname>de Rozas</surname><given-names>AP</given-names></name><name><surname>Höfle</surname><given-names>U</given-names></name><name><surname>Ramiro</surname><given-names>Y</given-names></name><name><surname>Gonzalez-Escalona</surname><given-names>N</given-names></name></person-group><article-title>mcr-Colistin Resistance Genes Mobilized by IncX4, IncHI2, and IncI2 Plasmids in Escherichia coli of Pigs and White Stork in Spain</article-title><source>Frontiers in Microbiology</source><year>2020</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC6978640</pub-id><pub-id pub-id-type="pmid">32010114</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2019.03072</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolley</surname><given-names>KA</given-names></name><name><surname>Maiden</surname><given-names>MCJ</given-names></name></person-group><year>2010</year><article-title>BIGSdb: Scalable analysis of bacterial genome variation at the population level</article-title><source>BMC Bioinformatics</source><volume>11</volume><fpage>595</fpage><pub-id pub-id-type="pmcid">PMC3004885</pub-id><pub-id pub-id-type="pmid">21143983</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-595</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tonkin-Hill</surname><given-names>G</given-names></name><name><surname>Lees</surname><given-names>JA</given-names></name><name><surname>Bentley</surname><given-names>SD</given-names></name><name><surname>Frost</surname><given-names>SDW</given-names></name><name><surname>Corander</surname><given-names>J</given-names></name></person-group><article-title>Fast hierarchical Bayesian analysis of population structure</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>5539</fpage><lpage>5549</lpage><pub-id pub-id-type="pmcid">PMC6582336</pub-id><pub-id pub-id-type="pmid">31076776</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkz361</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ludden</surname><given-names>C</given-names></name><name><surname>Coll</surname><given-names>F</given-names></name><name><surname>Gouliouris</surname><given-names>T</given-names></name><name><surname>Restif</surname><given-names>O</given-names></name><name><surname>Blane</surname><given-names>B</given-names></name><name><surname>Blackwell</surname><given-names>GA</given-names></name><name><surname>Kumar</surname><given-names>N</given-names></name><name><surname>Naydenova</surname><given-names>P</given-names></name><name><surname>Crawley</surname><given-names>C</given-names></name><name><surname>Brown</surname><given-names>NM</given-names></name><etal/></person-group><article-title>Defining nosocomial transmission of Escherichia coli and antimicrobial resistance genes: a genomic surveillance study</article-title><source>Lancet Microbe</source><year>2021</year><volume>2</volume><fpage>e472</fpage><lpage>e480</lpage><pub-id pub-id-type="pmcid">PMC8410606</pub-id><pub-id pub-id-type="pmid">34485958</pub-id><pub-id pub-id-type="doi">10.1016/S2666-5247(21)00117-8</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawkey</surname><given-names>J</given-names></name><name><surname>Wyres</surname><given-names>KL</given-names></name><name><surname>Judd</surname><given-names>LM</given-names></name><name><surname>Harshegyi</surname><given-names>T</given-names></name><name><surname>Blakeway</surname><given-names>L</given-names></name><name><surname>Wick</surname><given-names>RR</given-names></name><name><surname>Jenney</surname><given-names>AWJ</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name></person-group><article-title>ESBL plasmids in Klebsiella pneumoniae: diversity, transmission and contribution to infection burden in the hospital setting</article-title><source>Genome Med</source><year>2022</year><volume>14</volume><fpage>97</fpage><pub-id pub-id-type="pmcid">PMC9396894</pub-id><pub-id pub-id-type="pmid">35999578</pub-id><pub-id pub-id-type="doi">10.1186/s13073-022-01103-0</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antipov</surname><given-names>D</given-names></name><name><surname>Hartwick</surname><given-names>N</given-names></name><name><surname>Shen</surname><given-names>M</given-names></name><name><surname>Raiko</surname><given-names>M</given-names></name><name><surname>Pevzner</surname><given-names>PA</given-names></name></person-group><article-title>plasmidSPAdes :Assembling Plasmids from Whole Genome Sequencing Data</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>3380</fpage><lpage>3387</lpage><pub-id pub-id-type="pmid">27466620</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arredondo-Alonso</surname><given-names>S</given-names></name><name><surname>Bootsma</surname><given-names>M</given-names></name><name><surname>Hein</surname><given-names>Y</given-names></name><name><surname>Rogers</surname><given-names>MRC</given-names></name><name><surname>Corander</surname><given-names>J</given-names></name><name><surname>Willems</surname><given-names>RJL</given-names></name><name><surname>Schurch</surname><given-names>AC</given-names></name></person-group><article-title>gplas: a comprehensive tool for plasmid analysis using short-read graphs</article-title><source>Bioinformatics</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7320608</pub-id><pub-id pub-id-type="pmid">32271863</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa233</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holley</surname><given-names>G</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name></person-group><article-title>Bifrost: highly parallel construction and indexing of colored and compacted de Bruijn graphs</article-title><source>Genome Biol</source><year>2020</year><volume>21</volume><fpage>249</fpage><pub-id pub-id-type="pmcid">PMC7499882</pub-id><pub-id pub-id-type="pmid">32943081</pub-id><pub-id pub-id-type="doi">10.1186/s13059-020-02135-8</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>Fabian</given-names></name><name><surname>Varoquaux</surname><given-names>Gael</given-names></name><name><surname>Gramfort</surname><given-names>Alexandre</given-names></name><name><surname>Michel</surname><given-names>Vincent</given-names></name><name><surname>Thirion</surname><given-names>Bertrand</given-names></name><name><surname>Grisel</surname><given-names>Olivier</given-names></name><name><surname>Blondel</surname><given-names>Mathieu</given-names></name><name><surname>Prettenhofer</surname><given-names>Peter</given-names></name><name><surname>Weiss</surname><given-names>Ron</given-names></name><name><surname>Dubourg</surname><given-names>Vincent</given-names></name><name><surname>Vanderplas</surname><given-names>Jake</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine learning in Python</article-title><source>The Journal of Machine Learning Research</source><year>2011</year><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name></person-group><article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1658</fpage><lpage>1659</lpage><pub-id pub-id-type="pmid">16731699</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Niu</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><year>2012</year><article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title><source>Bioinformatics</source><volume>28</volume><fpage>3150</fpage><lpage>3152</lpage><pub-id pub-id-type="pmcid">PMC3516142</pub-id><pub-id pub-id-type="pmid">23060610</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>L</given-names></name><name><surname>Glover</surname><given-names>RH</given-names></name><name><surname>Humphris</surname><given-names>S</given-names></name><name><surname>Elphinstone</surname><given-names>JG</given-names></name><name><surname>Toth</surname><given-names>IK</given-names></name></person-group><article-title>Genomics and taxonomy in diagnostics for food security: soft-rotting enterobacterial plant pathogens</article-title><source>Anal Methods</source><year>2015</year><volume>8</volume><fpage>12</fpage><lpage>24</lpage></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scrucca</surname><given-names>L</given-names></name><name><surname>Fop</surname><given-names>M</given-names></name><name><surname>Murphy</surname><given-names>TB</given-names></name><name><surname>Raftery</surname><given-names>AE</given-names></name></person-group><article-title>mclust 5: Clustering, Classification and Density Estimation Using Gaussian Finite Mixture Models</article-title><source>R J</source><year>2016</year><volume>8</volume><fpage>289</fpage><lpage>317</lpage><pub-id pub-id-type="pmcid">PMC5096736</pub-id><pub-id pub-id-type="pmid">27818791</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedersen</surname><given-names>TL</given-names></name></person-group><article-title>ggforce: Accelerating ‘ggplot2’</article-title><year>2022</year></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilchrist</surname><given-names>CLM</given-names></name><name><surname>Chooi</surname><given-names>Y-H</given-names></name></person-group><article-title>Clinker &amp; clustermap.js: Automatic generation of gene cluster comparison figures</article-title><source>Bioinformatics</source><year>2021</year><pub-id pub-id-type="pmid">33459763</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilkins</surname><given-names>D</given-names></name></person-group><article-title>treemapify: Draw Treemaps in’ggplot2’</article-title><year>2017</year></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feldgarden</surname><given-names>M</given-names></name><name><surname>Brover</surname><given-names>V</given-names></name><name><surname>Gonzalez-Escalona</surname><given-names>N</given-names></name><name><surname>Frye</surname><given-names>JG</given-names></name><name><surname>Haendiges</surname><given-names>J</given-names></name><name><surname>Haft</surname><given-names>DH</given-names></name><name><surname>Hoffmann</surname><given-names>M</given-names></name><name><surname>Pettengill</surname><given-names>JB</given-names></name><name><surname>Prasad</surname><given-names>AB</given-names></name><name><surname>Tillman</surname><given-names>GE</given-names></name><etal/></person-group><article-title>AMRFinderPlus and the Reference Gene Catalog facilitate examination of the genomic links among antimicrobial resistance, stress response, and virulence</article-title><source>Sci Rep</source><year>2021</year><volume>11</volume><elocation-id>12728</elocation-id><pub-id pub-id-type="pmcid">PMC8208984</pub-id><pub-id pub-id-type="pmid">34135355</pub-id><pub-id pub-id-type="doi">10.1038/s41598-021-91456-0</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><article-title>Prokka: Rapid prokaryotic genome annotation</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>2068</fpage><lpage>2069</lpage><pub-id pub-id-type="pmid">24642063</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>OpenTSNE embedding based on unitigs (k=31) of 5,996 <italic>E. coli</italic> plasmids. Each point corresponds to a plasmid sequence and their assigned cluster (C) is labelled based on the cluster ID (n=41) defined by HDBSCAN. Sequences belonging to an HDBSCAN cluster are coloured (from red to blue) based on their membership probability. Unassigned sequences correspond to plasmids with a membership probability of 0 of belonging to any defined cluster and are coloured in grey. The ellipses (in black) delimit the cluster coordinates and were estimated using the Khachiyan algorithm implemented in the ggforce R package. To facilitate finding clusters 19, 26, 29, 30 and 33, which are highlighted as examples in the text, we indicated their positions with an arrow in the plot.</p></caption><graphic xlink:href="EMS158943-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Concordance of mge-cluster results compared to MOB-suite (in purple) and COPLA (in orange) based on adjusted Rand index values. For each sequence assigned to a cluster by mge-cluster, the tool returns a membership probability. This probability was used to set several thresholds (ranging from no threshold to 0.9) to assign the plasmid sequences and assess their concordance against MOB-suite and COPLA. Each point in the comparison is sized according to the number of sequences used to compute the adjusted Rand index value between the tools.</p></caption><graphic xlink:href="EMS158943-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Diversity of MOB-suite (in purple) and COPLA (in orange) types for each mge-cluster (n=41). The diversity (Simpson value) could range from 0 (agreement with mge-cluster) to 1 (no agreement). The probability assigned to each plasmid by mge-cluster was considered to set several thresholds (ranging from no threshold to 0.9) to assign the plasmid sequences and assess their concordance with MOB-suite and COPLA.</p></caption><graphic xlink:href="EMS158943-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Distribution of the <italic>mcr-1.1</italic> gene on the embedding space created by mge-cluster. The plasmids (n=327) containing the gene are coloured in the plot according to their cluster labels. The clusters (n=12) containing at least a single sequence having the <italic>mcr-1.1</italic> gene are indicated with an ellipse using the Khachiyan algorithm implemented in the ggforce R package. The sequences which were not assigned to any mge-cluster were labelled as ‘-1’ (light green) in the legend.</p></caption><graphic xlink:href="EMS158943-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Summary of the mge-cluster workflow. The tool is composed of two distinct operational modes: --<italic>create</italic> (left) and --<italic>existing</italic> (right). Both modes require as input a file listing the absolute or relative paths of the nucleotide sequences. The --<italic>create</italic> mode of mge-cluster requires the following arguments (--<italic>kmer, --variance, --perplexity, --exaggeration</italic> and --<italic>min_cluster</italic>) to generate discrete clusters from the sequences provided in the input. The --<italic>existing</italic> mode of mge-cluster requires the files (in yellow) generated by the --<italic>create</italic> mode to predict the clusters of a new batch of nucleotide sequences.</p></caption><graphic xlink:href="EMS158943-f005"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><p>Comparison of the mge-cluster models over a range of perplexity values (10, 30, 50, 200). The models were compared against the mge-cluster solution, corresponding to a perplexity value of 100. The Rand index was first computed considering only points assigned to a cluster by the two clustering solutions and thus ignoring points which were either unassigned by one of the two models. Secondly, the Rand index was computed with all points (assigned and unassigned) to highlight the discrepancy between the models is mainly caused by sequences clustered by one of the two models but unassigned by the other.</p></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">mge-cluster perplexity</th><th align="left" valign="top">Assigned points</th><th align="left" valign="top">Unassigned points</th><th align="left" valign="top">Number of clusters</th><th align="left" valign="top">Rand index - only assigned points</th><th align="left" valign="top">Rand index - all points</th></tr></thead><tbody><tr><td align="left" valign="middle">10</td><td align="left" valign="middle">3,778</td><td align="left" valign="middle">2,218</td><td align="left" valign="middle">45</td><td align="left" valign="middle">0.90 (3,502)</td><td align="left" valign="middle">0.29 (5,996)</td></tr><tr><td align="left" valign="middle">0</td><td align="left" valign="middle">5,187</td><td align="left" valign="middle">809</td><td align="left" valign="middle">44</td><td align="left" valign="middle">0.95 (4,651)</td><td align="left" valign="middle">0.61 (5,996)</td></tr><tr><td align="left" valign="middle">50</td><td align="left" valign="middle">4,887</td><td align="left" valign="middle">1,109</td><td align="left" valign="middle">45</td><td align="left" valign="middle">0.96 (4,579)</td><td align="left" valign="middle">0.70 (5,996)</td></tr><tr><td align="left" valign="middle">200</td><td align="left" valign="middle">4,528</td><td align="left" valign="middle">1,468</td><td align="left" valign="middle">38</td><td align="left" valign="middle">0.98 (4,392)</td><td align="left" valign="middle">0.70 (5,996)</td></tr></tbody></table></table-wrap></floats-group></article>