<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158048</article-id><article-id pub-id-type="doi">10.1101/2022.12.01.518687</article-id><article-id pub-id-type="archive">PPR578756</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>WASCO: A Wasserstein-based statistical tool to compare conformational ensembles of intrinsically disordered proteins</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>González-Delgado</surname><given-names>Javier</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Sagar</surname><given-names>Amin</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Zanon</surname><given-names>Christophe</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lindorff-Larsen</surname><given-names>Kresten</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Bernadó</surname><given-names>Pau</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Neuvial</surname><given-names>Pierre</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Cortés</surname><given-names>Juan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>LAAS-CNRS, Université de Toulouse, CNRS, Toulouse, France</aff><aff id="A2"><label>2</label>Institut de Mathématiques de Toulouse, Université de Toulouse, CNRS, Toulouse, France</aff><aff id="A3"><label>3</label>Centre de Biologie Structurale, Université de Montpellier, INSERM, CNRS, Montpellier, France</aff><aff id="A4"><label>4</label>The Linderstr⊘m-Lang Centre for Protein Science, Department of Biology, University of Copenhagen, Denmark</aff><pub-date pub-type="nihms-submitted"><day>04</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>02</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The structural investigation of intrinsically disordered proteins (IDPs) requires ensemble models describing the diversity of the conformational states of the molecule. Due to their probabilistic nature, there is a need for new paradigms that understand and treat IDPs from a purely statistical point of view, considering their conformational ensembles as well-defined probability distributions. In this work, we define a conformational ensemble as an ordered set of probability distributions and provide a suitable metric to detect differences between two given ensembles at the residue level, both locally and globally. The underlying geometry of the conformational space is properly integrated, being one ensemble characterized by a set of probability distributions supported on the three-dimensional Euclidean space (for global-scale comparisons) and on the two-dimensional flat torus (for local-scale comparisons). The inherent uncertainty of the data is also taken into account to provide finer estimations of the differences between ensembles. Additionally, an overall distance between ensembles is defined from the differences at the residue level. We illustrate the interest of the approach with several examples of applications for the comparison of conformational ensembles: (<italic>i</italic>) produced from molecular dynamics (MD) simulations using different force fields, and (<italic>ii</italic>) before and after refinement with experimental data. We also show the usefulness of the method to assess the convergence of MD simulations. The numerical tool has been implemented in Python through easy-to-use Jupyter Notebooks available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.laas.fr/moma/WASCO">https://gitlab.laas.fr/moma/WASCO</ext-link>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">The comparison of protein structures is a crucial problem in structural biology. In the early works [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>], the use of root-mean-square deviation (RMSD) was introduced and discussed as a metric between conformations of folded proteins, being later extended to its ensemble version [<xref ref-type="bibr" rid="R3">3</xref>]. More recently, Lindorff-Larsen and Ferkinghoff-Borg [<xref ref-type="bibr" rid="R4">4</xref>] defined three metrics that allow overall comparison between ensembles of ordered/structured systems, with stronger mathematical guarantees, but using RMSD as a distance between individual conformations, which complicates its extension to disordered structures. Cazals <italic>et al</italic>. [<xref ref-type="bibr" rid="R5">5</xref>] used a graph-based representation of the conformational space based on a set of low-energy conformations (i.e. local minima of the potential energy landscape) and compared them with the more suitable Wasserstein distance. To do so, they used the least-RMSD as ground metric between conformations. The methods presented in [<xref ref-type="bibr" rid="R4">4</xref>] and [<xref ref-type="bibr" rid="R5">5</xref>] are well suited to examine conformational ensembles of molecules that present a well-characterized energy landscape. However, their application to molecules with energy landscapes where low-energy conformations are difficult to identify, as it is the case of IDPs, is inappropriate.</p><p id="P3">A few recent works have dealt with the comparison of conformational ensembles of IDPs. Huihui and Ghosh [<xref ref-type="bibr" rid="R6">6</xref>] focused on averaged conformational properties over ensembles as informative descriptors of their function. They proposed a sequence-decoration metric that classifies IDPs using only their primary structure together with their charge configuration. The same idea of comparing average descriptors was applied by Lazar <italic>et al</italic>. [<xref ref-type="bibr" rid="R7">7</xref>], who proposed an ensemble comparison tool based on differences between average pairwise distances. Due to the huge conformational variability of IDPs, it is, however, important to take into account both the average properties as well as the distribution around those averages. Describing IDP conformations as being drawn from probability distributions determining their structure may yield to an important loss of information (or even misleading results) if the whole distribution is reduced to its mean. Even when comparing two (possibly multivariate) Gaussian distributions, the difference between the two depends both on the means and variances [<xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R9">9</xref>]; thus, methods for comparing ensembles should ideally include also higher order moments of the probability distributions. This is why a statistical approach that integrates the entire probability law defining an ensemble is crucial to correctly capture the existing differences between disordered ensembles.</p><p id="P4">In this work, we define a set of probability distributions that characterize at local and global level the highly variable conformations in an ensemble of disordered proteins, and to which we can have access in practice. These probability laws can then be compared using a suitable metric that presents strong mathematical and geometrical guarantees, allowing the identification of residue-specific and overall discrepancies. We also propose an approach to integrate the intrinsic uncertainty of the data within the metric, which enables a more clear identification of the relevant differences between the ensembles. The method has been implemented inside a purely non-parametric framework, avoiding model assumptions, dimensionality reduction or further simplifications that may yield significant loss of information.</p><p id="P5">In the following sections, we provide an overall description of the proposed methodology, which is exhaustively detailed in the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref>, together with several cases of applications that illustrate how our method identifies residue-specific and overall discrepancies between conformational ensembles of IDPs or flexible peptides generated for example by molecular dynamics simulations or stochastic sampling techniques.</p></sec><sec id="S2" sec-type="methods"><label>2</label><title>Methods</title><p id="P6">Due to the intrinsic probabilistic nature of IDPs, descriptors of their conformational ensembles should be conceived from a purely statistical point of view. To do so, we seek to locally and globally describe conformational ensembles using well-defined probability distributions and to develop statistical tools allowing their comparison. The main questions to answer are therefore: (1) which is the best way to define those probability distributions? and (2) how these distributions have to be compared to provide quantitative information about similarities and differences between ensembles?</p><sec id="S3"><label>2.1</label><title>Defining conformational ensembles as a set of probability distributions</title><p id="P7">IDP ensembles can be described at both local and global scales, providing complementary information. We aim at defining an ordered set of probability distributions that account for the highly variable structure of the ensemble and, above all, that can be estimated in practice from a set of sampled conformations.</p><p id="P8">The most important aspects of the local structure can be described by the dihedral angles (<italic>φ</italic>, <italic>ψ</italic>) for each amino acid residue along the sequence. Therefore, for each residue, the ensemble is locally characterized by a two-dimensional random variable (<italic>φ</italic>, <italic>ψ</italic>) or, in other words, by a probability distribution supported on the two-dimensional flat torus 𝕋<sup>2</sup> [<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>]. If we denote such distribution as <inline-formula><mml:math id="M1"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></inline-formula> for the residue at the <italic>i</italic>-th position, we define the local structural descriptor of an ensemble as the <italic>L</italic>-tuple <disp-formula id="FD1"><label>(1)</label><mml:math id="M2"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>all</mml:mtext><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>L</italic> is the sequence length and 𝒫 (𝕋<sup>2</sup>) denotes the space of probability distributions supported on 𝕋<sup>2</sup>.</p><p id="P9">Describing the global structure is a less trivial task. The use the absolute positions of the atoms and an absolute reference frame for the entire ensemble is not an appropriate description as it is sensitive to rigid-body motions. Therefore, our approach uses the relative positions of all pairs of residues along the sequence, which are invariant under rigid-body motion. More precisely, we define the position of a given residue as the the position of its <italic>C<sub>β</sub></italic> atom when it exists and of its <italic>C<sub>α</sub></italic> atom otherwise. If <italic>i</italic>, <italic>j</italic> ∈ {1, …, <italic>L</italic>}, <italic>i</italic> ≠ <italic>j</italic>, denote two different sequence positions, let <inline-formula><mml:math id="M3"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> be the three-dimensional random variable determining the relative position of <italic>j</italic>-th residue with respect to the <italic>i</italic>-th one. If we denote <inline-formula><mml:math id="M4"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula> the probability distribution associated to <inline-formula><mml:math id="M5"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula>, we define the global structural descriptor of an ensemble as the (<italic>L</italic>(<italic>L</italic> − 1)/2)-tuple <disp-formula id="FD2"><label>(2)</label><mml:math id="M6"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>all</mml:mtext><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>L</italic> is the sequence length and 𝒫 (ℝ<sup>3</sup>) denotes the space of probability distributions supported on the three-dimensional euclidean space.</p></sec><sec id="S4"><label>2.2</label><title>Accessing empirical probability distributions from sampled conformations</title><p id="P10">Estimating the local structural descriptor <xref ref-type="disp-formula" rid="FD1">(1)</xref> is immediate as we have direct access to dihedral angles (<italic>φ</italic>, <italic>ψ</italic>) from the sample of conformations. Therefore, the local structural descriptor will be estimated by its <italic>empirical</italic> counterpart <disp-formula id="FD3"><label>(3)</label><mml:math id="M7"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula> where each <inline-formula><mml:math id="M8"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> is the empirical probability distribution of <inline-formula><mml:math id="M9"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:math></inline-formula> and <italic>n</italic> is the number of conformations constituting the sample. Such empirical probability distributions are commonly represented through Ramachandran maps [<xref ref-type="bibr" rid="R12">12</xref>].</p><p id="P11">Obtaining a sample of <inline-formula><mml:math id="M10"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> from the set of conformations is less direct. To compute a set of comparable <inline-formula><mml:math id="M11"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> vectors from all conformations, their coordinates must be expressed on the same reference system. To do so, we first define a reference frame at the <italic>i</italic>-th residue, using only the positions of the <italic>i</italic>-th <italic>C</italic>′, <italic>C<sub>α</sub></italic> and <italic>N<sup>H</sup></italic> atoms. This frame, whose construction is detailed in the SI, is a meaningful representation of the spatial pose of each residue.</p><p id="P12">The reference frame associated to each residue <italic>i</italic> ∈ {1, …, <italic>L</italic>} allows to express the relative positions of all residues <italic>j</italic> ≠ <italic>i</italic> with respect to <italic>i</italic>. Moreover, the definition of a reference system allows the <italic>superposition</italic> of all the conformations in the ensemble. This is illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>, for three conformations. Consequently, for every <italic>j</italic> ≠ <italic>i</italic>, we will have access to <italic>n</italic> realizations of the random variable <inline-formula><mml:math id="M12"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> or, in other words, to a point cloud in the three-dimensional Euclidean space, representing a sample drawn from the distribution of <inline-formula><mml:math id="M13"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula>. Therefore, the global structural descriptor of the ensemble <xref ref-type="disp-formula" rid="FD2">(2)</xref> will be estimated by its <italic>empirical</italic> counterpart <disp-formula id="FD4"><label>(4)</label><mml:math id="M14"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M15"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula> is the empirical probability distribution of <inline-formula><mml:math id="M16"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula>, for all <italic>i</italic> = 1, …, <italic>L</italic> − 1, <italic>j</italic> = <italic>i</italic> + 1, …, <italic>L</italic>. An example of a pair of samples of <inline-formula><mml:math id="M17"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> is presented in <xref ref-type="supplementary-material" rid="SD1">Figure S4</xref>.</p></sec><sec id="S5"><label>2.3</label><title>Distances between local and global structural descriptors</title><p id="P13">After defining the local and global structural descriptors of an ensemble as an ordered set of probability distributions, the choice of a suitable metric allowing inter-ensemble comparisons becomes the subsequent question to deal with. The basic properties that such a metric should have are:</p><list list-type="order" id="L1"><list-item><p id="P14">Satisfying the mathematical properties that define a distance (i.e. being 0 if an only if the two compared distributions are identical, symmetry and triangle inequality),</p></list-item><list-item><p id="P15">Integrating the geometry of the underlying space.</p></list-item></list><p id="P16">The use of metrics between probability distributions is not new in structural biology. For instance, Ting <italic>et al</italic>. [<xref ref-type="bibr" rid="R13">13</xref>] used Hellinger distance to detect differences between (<italic>φ</italic>, <italic>ψ</italic>) distributions. However, this metric does not take into account the geometry of the underlying space (in particular here, its periodicity). A symmetrized Kullback-Leibler (KL) or the Jensen-Shannon (JS) divergence was used in [<xref ref-type="bibr" rid="R4">4</xref>, <xref ref-type="bibr" rid="R14">14</xref>] to compare ensembles of ordered systems. This metric has a firm interpretation, based on information theory (in particular the JS divergence is the square of a metric). However, it still misses the geometrical reliability and does not satisfy triangle inequality, which makes comparisons between multiple ensembles difficult to interpret.</p><p id="P17">Besides satisfying conditions 1 and 2, the Wasserstein distance, derived from the theory of Optimal Transport (OT), provides both strong theoretical guarantees [<xref ref-type="bibr" rid="R15">15</xref>] and attractive empirical performance [<xref ref-type="bibr" rid="R16">16</xref>]. Moreover, the Wasserstein distance (also known as the ‘earth mover distance’) has a physical interpretation, as it is defined as the minimum transportation cost needed to reconfigure the mass of one probability distribution to recover the other. For an introduction to this Theory, we refer to [<xref ref-type="bibr" rid="R16">16</xref>]. Most of the applications of OT are related to the very active field of machine learning, notably in the framework of generative networks [<xref ref-type="bibr" rid="R17">17</xref>], robustness [<xref ref-type="bibr" rid="R18">18</xref>] or fairness [<xref ref-type="bibr" rid="R19">19</xref>], among others. With some notable exemptions [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R23">23</xref>], Wasserstein distance has not been widely used in structural biology. More related to our work, in [<xref ref-type="bibr" rid="R5">5</xref>], Cazals <italic>et al</italic>. used Wasserstein distance to compare energy landscapes sampled from conformational ensembles. Recently, it was used in [<xref ref-type="bibr" rid="R23">23</xref>] to define statistical tests assessing differences between (<italic>ϕ, ψ</italic>) distributions. The incorporation of the underlying geometry to its definition makes it a well-adapted metric to measure distances between local and global structural descriptors of the ensembles. Details and important considerations regarding its practical computation are given in the <xref ref-type="supplementary-material" rid="SD1">SI</xref>.</p></sec><sec id="S6"><label>2.4</label><title>The comparison tool</title><p id="P18">Consider two ensembles <italic>A</italic>, <italic>B</italic>, associated to two protein sequences of equal length <italic>L</italic>, and let <italic>n<sub>A</sub></italic>, <italic>n<sub>B</sub></italic> be their number of conformations, respectively. We define the differences between local structural descriptors of <italic>A</italic> and <italic>B</italic> as the <italic>L</italic>-tuple of Wasserstein distances <disp-formula id="FD5"><label>(5)</label><mml:math id="M18"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M19"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M20"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) denotes the <italic>i</italic>-th distribution of the empirical local structural descriptor (<xref ref-type="disp-formula" rid="FD3">3</xref>) of ensemble <italic>A</italic> (resp. <italic>B</italic>). Statistical tests to assess whether any <inline-formula><mml:math id="M21"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is significantly different from zero have been recently defined in [<xref ref-type="bibr" rid="R23">23</xref>]. The second of the introduced techniques is better adapted to our problem, as it only detects the more important discrepancies and accepts slight differences that may arise from experimental or computational procedures. This is discussed in detail in [<xref ref-type="bibr" rid="R23">23</xref>]. Consequently, together with the <italic>L</italic>-tuple <xref ref-type="disp-formula" rid="FD5">(5)</xref> of distances comparing local structural descriptors, we are able to supply a <italic>L</italic>-tuple of <italic>p</italic>-values accounting for the statistical significance of the corresponding distances: <disp-formula id="FD6"><label>(6)</label><mml:math id="M22"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P19">Recall that a small <italic>p</italic>-value <inline-formula><mml:math id="M23"><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates strong evidence that the <italic>true</italic> distance that <inline-formula><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> estimates is different from zero. In other words, small <italic>p</italic>-values show significant differences between the corresponding local structural descriptors. Therefore, the vector <xref ref-type="disp-formula" rid="FD6">(6)</xref> enables the identification of those residues where the differences are more important, and those residues for which differences can be assigned as non-significant.</p><p id="P20">Analogously, the difference between global structural descriptors of <italic>A</italic> and <italic>B</italic> is defined as the (<italic>L</italic>(<italic>L</italic> − 1)/2)-tuple <disp-formula id="FD7"><label>(7)</label><mml:math id="M25"><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M26"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M27"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) denotes the <italic>i</italic>, <italic>j</italic> distribution of the empirical global structural descriptor (<xref ref-type="disp-formula" rid="FD4">4</xref>) of ensemble <italic>A</italic> (resp. <italic>B</italic>). Note that (<xref ref-type="disp-formula" rid="FD7">7</xref>) can be more naturally represented as a triangular (<italic>L</italic>− 1) × (<italic>L</italic>− 1) matrix <italic>W</italic><sup><italic>g</italic>,<italic>A</italic>,<italic>B</italic></sup>, whose elements are given by <inline-formula><mml:math id="M28"><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula> Graphically, the matrix <italic>W</italic><sup><italic>g,A,B</italic></sup> is represented using a color scale to fill the coefficients according to distance values. As the diagonal will remain empty, it will be filled with the local distances <xref ref-type="disp-formula" rid="FD5">(5)</xref>. This will also allow to assess whether changes on local structural descriptors are related with changes in global structural descriptors and to compare both scales within the same representation.</p><sec id="S7"><label>2.4.1</label><title>Accounting for uncertainty</title><p id="P21">The variability in experimental and simulated structures causes uncertainties and statistical noise that may significantly bias the distance estimation. For example, when running a MD simulation, independent replicas of the same simulation setup may results in non-negligible differences that distort the analysis of the comparison matrices. The same may occur when comparing two uniformly chosen subsets of conformations from an ensemble generated by stochastic sampling techniques [<xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref>]. In order to soften the effect of uncertainty and to obtain <italic>net</italic> estimates of the differences between a pair of ensembles, we will use (if available) independent replicas of the same ensemble. These replicas may also be produced by uniform subsampling of the set of conformations. However, special care must be taken when subsampling MD trajectories as the convergence of the simulation must be ensured for the subsamples to be representative of the entire ensemble.</p><p id="P22">Let <italic>A</italic><sub>1</sub>, …, <italic>A<sub>n<sub>I</sub></sub></italic> (resp. <italic>B</italic><sub>1</sub>, … , <italic>B<sub>n<sub>I</sub></sub></italic>) be <italic>n<sub>I</sub></italic> independent replicas of ensemble <italic>A</italic> (resp. B). The corrected difference between local structural descriptors of <italic>A</italic> and <italic>B</italic> is defined as the <italic>L</italic>-tuple <disp-formula id="FD8"><label>(8)</label><mml:math id="M29"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>1</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> where each corrected distance is defined as <disp-formula id="FD9"><label>(9)</label><mml:math id="M30"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>all</mml:mtext><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> where, for any real number <italic>x</italic>, (<italic>x</italic>)<sub>+</sub> = <italic>x</italic> if <italic>x</italic> &gt; 0 and (<italic>x</italic>)<sub>+</sub> = 0 otherwise. The first term in <xref ref-type="disp-formula" rid="FD9">(9)</xref> is an average of <italic>n<sub>I</sub></italic> Wasserstein distances between <italic>n<sub>I</sub></italic> paired independent replicas of <italic>A</italic> and <italic>B</italic>. As it was shown in [<xref ref-type="bibr" rid="R26">26</xref>], an average of Wasserstein distances between sub-samples of the same population is a pertinent estimate of the Wasserstein distance between the two entire populations that, in addition, conserves the properties that mathematically define a distance. Therefore, this first term estimates the Wasserstein distance between the entire populations of <italic>A</italic> and <italic>B</italic> (conceived as the union of all independent replicas), softening the variability. To this <italic>brutto</italic> inter-ensemble difference, we subtract an average of the Wasserstein distances between independent replicas of the same population (intra-ensemble). Note that, for the sake of computational simplicity, we just compared the first replica of each ensemble with the subsequent ones. Of course, distances between all pairs of replicas can be added to this term. The same applies if <italic>n<sub>I</sub></italic> is different for <italic>A</italic> and <italic>B</italic>; both terms in <xref ref-type="disp-formula" rid="FD9">(9)</xref> can be accordingly adapted. As it is illustrated in <xref ref-type="sec" rid="S11">Section 3</xref>, the use of corrected distances <xref ref-type="disp-formula" rid="FD9">(9)</xref> contribute to reduce the noise coming from structural uncertainty and help to emphasize residue-specific differences in the matrix representation. For the distances between global structural descriptors, the correction is performed analogously.</p></sec><sec id="S8"><label>2.4.2</label><title>Setting an interpretable scale</title><p id="P23">When defining an absolute distance or score between conformational ensembles, providing the clues to ease its interpretation is crucial. The problem of interpreting unbounded metrics with no intrinsic reference values has been widely discussed since the introduction of RMSD for the comparison of pairs of conformations [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>]. Here, we do not seek to define any cutoff to binarize the resulting matrices, but to provide a more informative continuous scale. To do so, we aim at quantifying the magnitude of the inter-ensemble distances compared to the intra-ensemble ones, using the uncertainty estimate as a reference. If we denote as <inline-formula><mml:math id="M31"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) the first (resp. second) term in <xref ref-type="disp-formula" rid="FD9">(9)</xref>, the score <disp-formula id="FD10"><label>(10)</label><mml:math id="M33"><mml:mstyle displaystyle="true"><mml:mfrac><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> reflects in which proportion the inter-ensemble distances exceed the “default” intra-ensemble ones. Once again, this score is analogously defined for differences between global structural descriptors.</p></sec><sec id="S9"><label>2.4.3</label><title>An overall distance between ensembles</title><p id="P24">In some situations, it may be of interest to perform overall comparisons between multiple ensembles. To do so, moving from a residue-specific analysis to a comparison at the whole structure level might be preferable. The definition of a score for the overall ensemble has been addressed for ordered systems [<xref ref-type="bibr" rid="R4">4</xref>]. Here, we propose to define such a score by aggregating all the residue-specific distances computed using the above-described methods. We recall that if <italic>d</italic><sub>1</sub>, …, <italic>d<sub>L</sub></italic> are <italic>L</italic> distances defined on <italic>L</italic> metric spaces χ<sub>1</sub>, …, χ<sub><italic>L</italic></sub>, the function <inline-formula><mml:math id="M34"><mml:msqrt><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:msqrt></mml:math></inline-formula> is a distance on the product space χ<sub>1</sub> × … ×χ<sub><italic>L</italic></sub>. Consequently, <disp-formula id="FD11"><label>(11)</label><mml:math id="M35"><mml:mstyle displaystyle="true"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></disp-formula> is a distance on the product space of all dihedral angles along the sequence and, therefore, serves to quantify the <italic>overall local discrepancy</italic> between a pair of ensembles. Analogously, <disp-formula id="FD12"><label>(12)</label><mml:math id="M36"><mml:mstyle displaystyle="true"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>all</mml:mtext><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> is a distance on the product space of all pairwise relative positions of the residues in both ensembles, and serves to quantify the <italic>overall global discrepancy</italic>. Note that we have assigned a positive weight <italic>w<sub>ij</sub></italic> to each global distance in <xref ref-type="disp-formula" rid="FD12">(12)</xref>. This allows to consider distances between specific residue pairs as more relevant than the others when computing the overall discrepancy [<xref ref-type="bibr" rid="R27">27</xref>]. For instance, we can highlight differences between global structural descriptors that appear for residue pairs that are far from each other in the sequence, i.e. large ∣<italic>i</italic>− <italic>j</italic>∣, and neglect distances between neighboring residue pairs, i.e small ∣<italic>i</italic>− <italic>j</italic>∣. This can be done by choosing <italic>w<sub>ij</sub></italic> as an appropriate increasing function of ∣<italic>i</italic> − <italic>j</italic>∣, as <disp-formula id="FD13"><label>(13)</label><mml:math id="M37"><mml:mstyle displaystyle="true"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> which satisfies <italic>w</italic><sub><italic>i</italic>,<italic>i</italic></sub> = 0 for all <italic>i</italic> and <italic>w</italic><sub>1,<italic>L</italic></sub> = <italic>w</italic><sub><italic>L</italic>,1</sub> = 1.</p><p id="P25">The drawback of this definition of the overall distance is that it does not take into account the uncertainty discussed in <xref ref-type="sec" rid="S7">Section 2.4.1</xref>. To solve this problem, the same strategy to define a global score can be performed by replacing each <inline-formula><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M39"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) by its corresponding corrected distance <inline-formula><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M41"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>) in <xref ref-type="disp-formula" rid="FD11">(11)</xref> (resp. <xref ref-type="disp-formula" rid="FD12">(12)</xref>). However, this strategy makes the triangle inequality for the overall metric no longer satisfied. Both scores can be implemented by the practitioner and used depending on the specific comparison context.</p></sec></sec><sec id="S10"><label>2.5</label><title>The Jupyter Notebook</title><p id="P26">The WASCO comparison tool has been implemented through an easy-to-use Jupyter Notebook. It is available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.laas.fr/moma/WASCO">https://gitlab.laas.fr/moma/WASCO</ext-link>, together with its installation guidelines and detailed implementation instructions. The notebook takes a pair of ensembles as input and returns the comparison results through the matrix defined in <xref ref-type="sec" rid="S6">Section 2.4</xref>, containing global and local differences. The user can choose to correct the computed distances by uncertainty, as proposed in <xref ref-type="sec" rid="S7">Section 2.4.1</xref>. When independent replicas are not provided as input, subsampling is used to emulate them. If this correction is performed, results are displayed in the interpretable scale defined in <xref ref-type="sec" rid="S8">Section 2.4.2</xref>. The overall score defined in <xref ref-type="sec" rid="S9">Section 2.4.3</xref>, aggregating the corrected distances, is also returned by the tool.</p><p id="P27">Ensembles can be provided as input in several of the most common data formats. WASCO accepts one .xtc file per replica, together with a .pdb file including the topology information of the molecule, one multiframe .pdb file per replica or a folder per replica containing one .pdb file per conformation. The user can also choose to compare ensembles for sequence segments (of equal length) instead of the entire sequence. Details are provided in the notebook documentation.</p><p id="P28">Due to the large number of Wasserstein distances to be computed (<italic>L</italic>(<italic>L</italic> − 1)/2 + <italic>L</italic> per pair of replicas), the computation time might be considerably high. The number of conformations constituting the ensemble also has a significant impact, due to computational limitations of the existing OT algorithms when sample sizes and dimension increase. In order to return results within a reasonable amount of time, WASCO computes Wasserstein distances in parallel. The required CPU time depends on the number of conformations, replicas and sequence length of the ensembles. For small proteins of <italic>L</italic> ∼ 30 and ensembles or reasonable size <italic>n<sub>A</sub></italic>, <italic>n<sub>B</sub></italic> ∼ 10<sup>4</sup>, the CPU time using 20 threads is less than 15 minutes using a standard computing server. However, for larger proteins of <italic>L</italic> ∼ 150 and large ensembles with <italic>n<sub>A</sub></italic>, <italic>n<sub>B</sub></italic> ∼ 10<sup>5</sup>, the CPU time using 20 threads goes up to some hours. Additionally, comparing large ensembles of substantially longer sequences (<italic>L</italic> ≫ 150) might cause memory problems, as all pairwise relative positions for every conformation need to be stocked. Therefore, the suitability of the sizes of the ensembles must be considered before launching WASCO. Adapting WASCO to longer sequences with large conformational ensembles remains an objective for future work.</p></sec></sec><sec id="S11" sec-type="results"><label>3</label><title>Results</title><p id="P29">In this section, we present several applications to illustrate the different possibilities enabled by WASCO. In all the cases, the distances between local and global structural descriptors were corrected for uncertainty using <xref ref-type="disp-formula" rid="FD9">(9)</xref>, as independent replicas were available. Both overall local and global discrepancies between pairs of ensembles were computed plugging the corrected distances in <xref ref-type="disp-formula" rid="FD11">(11)</xref> and <xref ref-type="disp-formula" rid="FD12">(12)</xref>, as discussed in <xref ref-type="sec" rid="S9">Section 2.4.3</xref>. The weight function <xref ref-type="disp-formula" rid="FD13">(13)</xref> was used to highlight differences between residue pairs far from each other in the sequence and reduce differences between neighboring amino acids. Note that this weighting is considered only to compute the overall distance <xref ref-type="disp-formula" rid="FD12">(12)</xref>, and not to depict distance values in the matrix representation, which correspond to the interpretable scale defined in <xref ref-type="sec" rid="S8">Section 2.4.2</xref>.</p><sec id="S12"><label>3.1</label><title>Comparison of ensembles produced by MD simulations using different force-fields</title><p id="P30">We applied WASCO to compare the results of MD simulations using different force-fields presented in [<xref ref-type="bibr" rid="R28">28</xref>] for two flexible peptides showing a significant propensity to form poly-l-proline type II (PPII) structures. Four different force-fields, having demonstrated relatively good performances to simulate IDPs were applied: AMBER ff99SB-disp, AMBER ff99SB-ILDN, CHARMM36IDPFF, and CHARMM36m (details and references to these force-fields can be found in [<xref ref-type="bibr" rid="R28">28</xref>]). For simplicity, we will refer to these force-fields as disp, ildn, c36idp and c36m, respectively. As independent replicas for each simulation were available, we could perform the correction for uncertainty <xref ref-type="disp-formula" rid="FD9">(9)</xref>.</p><p id="P31"><xref ref-type="fig" rid="F2">Figure 2</xref> presents the output of WASCO for several pairwise comparisons of conformational ensembles of Histatin-5 (Hst5) obtained with the different force-fields. The matrices and the overall dissimilarities suggest that the generated structures are closer (in Wasserstein distance) when they are simulated using c36idp and c36m (which we can define as group-I), or disp and ildn (group-II). This is not surprising as group-I are versions of CHARMM and group-II are versions of AMBER. Indeed, matrices (a) and (b), comparing force fields inside group-I and inside group-II respectively, present overall global differences which are small compared to those of panels (c) and (d), which compare force-fields of different groups. The same conclusion can be extracted by comparing the magnitude of the scales of both pairs of matrices. The two remaining comparisons (ildn vs. ildn and c36m vs. disp) are not included in <xref ref-type="fig" rid="F2">Figure 2</xref> as the corresponding matrices are qualitatively equivalent to (c) and (d). We note that similar observations have been made when comparing ensembles of folded proteins generated using related force-fields [<xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R29">29</xref>].</p><p id="P32">Matrices returned by WASCO also allow a residue-specific analysis of the distances. In <xref ref-type="fig" rid="F2">Figure 2</xref>, panels (c) and (d) show that the most relevant global differences appear in regions close to the diagonal (i.e. between residue pairs close in the sequence), where the inter-ensemble corrected distances rise up to 6-7 times the intra-ensemble ones. This is not the case when comparing force-fields inside the same group, as the largest differences appear in more internal matrix regions (i.e. between residue pairs more distant in the sequence). However, these corrected differences represent less than the half of the intra-ensemble distances. The information displayed on the diagonal allows the detection of the residues where the local conformation change more abruptly between force-fields. These local changes are more localized, contrary to the observed behaviour of global differences, which appeared for regions inside the lower triangle and not for isolated pairs of amino acids. In some cases, substantial local distances appear in residues where global structure also changes (see, for example, residues next to the N-terminus in (a,c)). However this correspondence is not observed in all matrices.</p><p id="P33">We repeated the same analysis for MD simulations of PEP3 with the same force-fields. Results are presented in <xref ref-type="fig" rid="F3">Figure 3</xref>. Here, the discrimination between the two force-field families is not observed. Nonetheless, we still observe that structures simulated with disp and ildn are very close in Wasserstein distance (<xref ref-type="fig" rid="F3">Figure 3b</xref>). Indeed, the overall global dissimilarity is substantially smaller than these of the remaining comparisons. Only inter-ensemble corrected differences representing about the 20% of the intra-ensemble ones appear for residues at the C-terminus. The distances between c36idp and c36m are now higher than for Hst5, and corrected differences of the same magnitude than the intra-ensemble ones appear in the interior of the matrix. The same behavior when comparing force-fields of different groups appear for PEP3. See, for instance, that substantial differences arise between relative positions of residues at opposite terminus in panel (d), which are highly weighted when computing the overall global discrepancy. One intriguing observation is that while there are substantial differences between disp and ildn (and between c36idp and c36m), simulations with c36idp and c36m used the same water model (the CHARMM-modified TIP3P water model) and the disp and ildn simulations also used very similar water models (TIP4P-D and a slightly variant of this) [<xref ref-type="bibr" rid="R28">28</xref>]. Overall, these results are complementary to those presented in [<xref ref-type="bibr" rid="R28">28</xref>], which mainly focused on secondary structure differences among ensembles, and they show the ability of WASCO to identify differences at both local and global scales.</p></sec><sec id="S13"><label>3.2</label><title>Online assessment of the convergence of MD simulations</title><p id="P34">Ensemble comparisons have previously been used to assess convergence in MD simulations of folded proteins [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R29">29</xref>, <xref ref-type="bibr" rid="R30">30</xref>]. We here propose to use the overall ensemble distances (defined in <xref ref-type="sec" rid="S9">Section 2.4.3</xref>) to examine the convergence of an MD simulation of a disordered protein. Moreover, this can be done on-the-fly to assess whether the simulation can be stopped. Let <italic>T</italic> denote the current simulation time and let 0 &lt; <italic>t</italic><sub>1</sub> &lt; <italic>t</italic><sub>2</sub> &lt; … &lt; <italic>t<sub>k</sub></italic> = <italic>T</italic> be <italic>k</italic> time points. If we denote <italic>A<sub>t</sub></italic> the conformational ensemble simulated up to time <italic>t</italic>, we can compute the overall distances <disp-formula id="FD14"><label>(14)</label><mml:math id="M42"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula> defined in <xref ref-type="disp-formula" rid="FD11">(11)</xref>, for all <italic>i</italic> = 2, …, <italic>k</italic>. For each <italic>i</italic>, <inline-formula><mml:math id="M43"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math></inline-formula> corresponds to the overall local distance between the ensemble from <italic>t</italic> = 0 to <italic>t</italic> = <italic>t<sub>i</sub></italic> and the ensemble from <italic>t</italic> = 0 to <italic>t</italic> = <italic>t</italic><sub><italic>i</italic>−1</sub>. Analogously, we compute the overall global distances <disp-formula id="FD15"><label>(15)</label><mml:math id="M44"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula> as defined in <xref ref-type="disp-formula" rid="FD12">(12)</xref>. Then, the representation of <inline-formula><mml:math id="M45"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula> with respect to the <italic>t<sub>i</sub></italic> indicates whether the simulation has converged or not. Note that the distances <inline-formula><mml:math id="M46"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula> can never be equal to zero, as they are empirical distances which <italic>converge</italic> to zero when the sample size tends to infinity. Therefore, convergence will be assumed when the profile approaches asymptotically to zero. Nevertheless, this criteria provides a stronger evidence of non-convergence, as the achievement of a zero asymptote for <xref ref-type="disp-formula" rid="FD15">(15)</xref>, even if necessary, may not be sufficient to guarantee convergence. If we resolve that the simulation must keep going until time <italic>T</italic> ′ <italic>&gt; T</italic>, it suffices to add 𝒪𝓦<sup><italic>l</italic>,<italic>A<sub>T</sub></italic>,<italic>A<sub>T</sub></italic>′</sup> and 𝒪𝓦<sup><italic>g</italic>,<italic>A<sub>T</sub></italic>,<italic>A<sub>T</sub></italic>′</sup> to each curve and recheck.</p><p id="P35"><xref ref-type="fig" rid="F4">Figure 4a</xref> presents the evolution of the online overall distances for PEP3 simulated with the four force-fields introduced in <xref ref-type="sec" rid="S12">Section 3.1</xref>. We observe that all the curves exhibit an asymptote at zero after the 80% of simulation time and therefore, convergence has been achieved in all cases. This is not the case for the simulation in <xref ref-type="fig" rid="F4">Figure 4b</xref>, corresponding to a 1,000 ns simulation of the K-18 domain of Tau using the AMBER ff99SB*-ILDN force-field and the TIP4P-D water model (Sthitadhi Maiti and Matthias Heyden, unpublished). Here, we clearly observe that no asymptote at zero is present and therefore that the simulation has not attained convergence. This result was expected due to the length of the protein (129 amino acids) and the reduced simulated time.</p></sec><sec id="S14"><label>3.3</label><title>Structural impact of SAXS ensemble refinement</title><p id="P36">Using Hst5 as example, we applied WASCO to evaluate the structural impact of SAXS refinement with the Ensemble Optimization Method (EOM) [<xref ref-type="bibr" rid="R31">31</xref>] on the resulting ensemble. We first compared the Hst5 ensemble simulated with Flexible-Meccano [<xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R32">32</xref>] with the refined one using previously reported SAXS data [<xref ref-type="bibr" rid="R33">33</xref>]. The results are presented in <xref ref-type="fig" rid="F5">Figure 5</xref>. Note that a previous EOM analysis of these data suggested that Hst5 in solution is slightly more extended that the random coil model generated with Flexible-Meccano [<xref ref-type="bibr" rid="R33">33</xref>]. Small but significant differences were observed at the central part of the peptide (from residues 6 to 13). Most probably, this central region has been conformationally modified during the refinement to account for the overall expansion of the peptide in solution [<xref ref-type="bibr" rid="R31">31</xref>]. Moreover, we observed highly significant local distances that propagate towards the interior of the matrix. In other words, these residues with large local distances conformationally influence their closest neighbours. Intriguingly, this propagation seems to only propagate towards the C-terminus.</p><p id="P37">We next assessed whether the direction in which conformations are built have a structural effect and change the refined ensemble. To do so, we generated two Hst5 ensembles using a stochastic sampling method similar to Flexible-Meccano but using a different sampling strategy [<xref ref-type="bibr" rid="R25">25</xref>], where the chains were built either from N-to-C or from C-to-N. When using these two ensembles to fit the experimental curve, the resulting distance matrices displayed very similar features for local and global distances (<xref ref-type="fig" rid="F6">Figures 6a and 6b</xref>), suggesting that the chain-building direction does not have a relevant effect. In both cases, a systematic increase in the distances is observed for the central residues, as observed in the previous analysis (<xref ref-type="fig" rid="F5">Figure 5</xref>).</p><p id="P38">In a recent study, ENCORE was used to show that refined ensembles were closer to each other than different input ensembles [<xref ref-type="bibr" rid="R14">14</xref>]. This can also be illustrated using WASCO, by comparing the Hst5 ensembles generated in both directions before and after the filtering with SAXS data (<xref ref-type="fig" rid="F6">Figures 6c and 6d</xref>). These comparisons clearly showed that both global and local differences were smaller for the refined ensembles than for the input ones, as observed when comparing the maximum values of the corresponding color scales. As we were comparing very similar ensembles, we expected the distances to be small. Nevertheless, we observe one significant local difference on the diagonal in <xref ref-type="fig" rid="F6">Figure 6c</xref> that disappeared after refinement.</p></sec></sec><sec id="S15" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P39">We have presented a novel method to compare conformational ensemble models of highly flexible proteins. WASCO is based on a non-parametric framework: local and global structural descriptors of the conformational space are defined as distributions and do not rely on probabilistic or statistic models. This allows capturing the entire variability of the ensemble without information loss. The distributions are compared using the Wasserstein distance, which has strong mathematical guarantees and respects the geometry of the underlying space. To this metric, we incorporated the structural uncertainty presented in experimental and simulated ensembles. Using this strategy, WASCO highlights the relevant differences between ensembles. We have illustrated several possible applications of WASCO as an additional tool for the investigation of IDPs and flexible peptides. It provides complementary information with respect to other tools to analyze and compare conformational ensembles based on global descriptors, such as the radius of gyration [<xref ref-type="bibr" rid="R34">34</xref>] or secondary structure propensities [<xref ref-type="bibr" rid="R28">28</xref>]. WASCO has been implemented in an open source Jupyter Notebook. The main drawback of this implementation is its inability to deal with considerably large ensembles. Adapting WASCO to larger chains remains a future work, as well as its extension to compare multi-domain proteins and coarse-grained models.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Information</label><media xlink:href="EMS158048-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d37aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S16"><title>Acknowledgements</title><p>We are grateful to Francesco Pesce, Sthitadhi Maiti and Matthias Heyden for providing useful data. We thank Gabriella Gerlach, Frederik Emil Thomasen and Philipp Schake for their helpful discussions and valuable feedback on WASCO implementation.</p><p>This work has been partially supported by the French National Research Agency (ANR) through grant ANR-19-P3IA-0004, the LabEx CIMI (ANR-11-LABX-0040) and EpiGenMed (ANR-10-LABX-12–01) within the French State Programme “Investissements d’Avenir”, by the European Research Council under the European Union’s H2020 Framework Programme (2014–2020)/ ERC Grant agreement n° [648030] awarded to PB and by the Lundbeck Foundation BRAINSTRUC initiative (R155-2015-2666). The CBS is a member of France-BioImaging (FBI) and the French Infrastructure for Integrated Structural Biology (FRISBI), 2 national infrastructures supported by the French National Research Agency (ANR-10-INBS-04-01 and ANR-10-INBS-05, respectively).</p></ack><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>S</given-names></name><name><surname>Rossmann</surname><given-names>MG</given-names></name></person-group><article-title>Comparison of super-secondary structures in proteins</article-title><source>J Mol Biol</source><year>1973</year><volume>76</volume><issue>2</issue><fpage>241</fpage><lpage>256</lpage><pub-id pub-id-type="pmid">4737475</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maiorov</surname><given-names>VN</given-names></name><name><surname>Crippen</surname><given-names>GM</given-names></name></person-group><article-title>Significance of root-mean-square deviation in comparing three-dimensional structures of globular proteins</article-title><source>J Mol Biol</source><year>1994</year><volume>235</volume><issue>2</issue><fpage>625</fpage><lpage>634</lpage><pub-id pub-id-type="pmid">8289285</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brüschweiler</surname><given-names>R</given-names></name></person-group><article-title>Efficient RMSD measures for the comparison of two molecular ensembles</article-title><source>Proteins</source><year>2003</year><volume>50</volume><issue>1</issue><fpage>26</fpage><lpage>34</lpage><pub-id pub-id-type="pmid">12471596</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindorff-Larsen</surname><given-names>K</given-names></name><name><surname>Ferkinghoff-Borg</surname><given-names>J</given-names></name></person-group><article-title>Similarity measures for protein ensembles</article-title><source>PLoS One 4</source><year>2009</year><volume>4</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><comment>01</comment><pub-id pub-id-type="pmcid">PMC2615214</pub-id><pub-id pub-id-type="pmid">19145244</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0004203</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cazals</surname><given-names>F</given-names></name><name><surname>Dreyfus</surname><given-names>T</given-names></name><name><surname>Mazauric</surname><given-names>D</given-names></name><name><surname>Roth</surname><given-names>C-A</given-names></name><name><surname>Robert</surname><given-names>CH</given-names></name></person-group><article-title>Conformational ensembles and sampled energy landscapes: Analysis and comparison</article-title><source>J Comput Chem</source><volume>36</volume><issue>16</issue><fpage>1213</fpage><lpage>1231</lpage><pub-id pub-id-type="pmid">25994596</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huihui</surname><given-names>J</given-names></name><name><surname>Ghosh</surname><given-names>K</given-names></name></person-group><article-title>Intrachain interaction topology can identify functionally similar intrinsically disordered proteins</article-title><source>Biophys J</source><year>2021</year><volume>120</volume><issue>10</issue><fpage>1860</fpage><lpage>1868</lpage><pub-id pub-id-type="pmcid">PMC8204386</pub-id><pub-id pub-id-type="pmid">33865811</pub-id><pub-id pub-id-type="doi">10.1016/j.bpj.2020.11.2282</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazar</surname><given-names>T</given-names></name><name><surname>Guharoy</surname><given-names>M</given-names></name><name><surname>Vranken</surname><given-names>W</given-names></name><name><surname>Rauscher</surname><given-names>S</given-names></name><name><surname>Wodak</surname><given-names>SJ</given-names></name><name><surname>Tompa</surname><given-names>P</given-names></name></person-group><article-title>Distance-based metrics for comparing conformational ensembles of intrinsically disordered proteins</article-title><source>Biophys J</source><year>2020</year><volume>118</volume><issue>12</issue><fpage>2952</fpage><lpage>2965</lpage><pub-id pub-id-type="pmcid">PMC7300341</pub-id><pub-id pub-id-type="pmid">32502383</pub-id><pub-id pub-id-type="doi">10.1016/j.bpj.2020.05.015</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kullback</surname><given-names>S</given-names></name></person-group><article-title>An application of information theory to multivariate analysis</article-title><source>The Annals of Mathematical Statistics</source><year>1952</year><fpage>88</fpage><lpage>102</lpage></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>SK</given-names></name><name><surname>Chellappa</surname><given-names>R</given-names></name></person-group><article-title>From sample similarity to ensemble similarity: Probabilistic distance measures in reproducing kernel hilbert space</article-title><source>IEEE Trans Pattern Anal Mach Intell</source><year>2006</year><volume>28</volume><issue>6</issue><fpage>917</fpage><lpage>929</lpage><pub-id pub-id-type="pmid">16724586</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mardia</surname><given-names>KV</given-names></name><name><surname>Taylor</surname><given-names>CC</given-names></name><name><surname>Subramaniam</surname><given-names>GK</given-names></name></person-group><article-title>Protein bioinformatics and mixtures of bivariate von mises distributions for angular data</article-title><source>Biometrics</source><year>2007</year><volume>63</volume><issue>2</issue><fpage>505</fpage><lpage>512</lpage><pub-id pub-id-type="pmid">17688502</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boomsma</surname><given-names>W</given-names></name><name><surname>Mardia</surname><given-names>KV</given-names></name><name><surname>Taylor</surname><given-names>CC</given-names></name><name><surname>Ferkinghoff-Borg</surname><given-names>J</given-names></name><name><surname>Krogh</surname><given-names>A</given-names></name><name><surname>Hamelryck</surname><given-names>T</given-names></name></person-group><article-title>A generative, probabilistic model of local protein structure</article-title><source>Proc Natl Acad Sci USA</source><year>2008</year><volume>105</volume><issue>26</issue><fpage>8932</fpage><lpage>8937</lpage><pub-id pub-id-type="pmcid">PMC2440424</pub-id><pub-id pub-id-type="pmid">18579771</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0801715105</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramachandran</surname><given-names>G</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Sasisekharan</surname><given-names>V</given-names></name></person-group><article-title>Stereochemistry of polypeptide chain configurations</article-title><source>J Mol Biol</source><year>1963</year><volume>7</volume><issue>1</issue><fpage>95</fpage><lpage>99</lpage><pub-id pub-id-type="pmid">13990617</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ting</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name><name><surname>Shapovalov</surname><given-names>M</given-names></name><name><surname>Mitra</surname><given-names>R</given-names></name><name><surname>Jordan</surname><given-names>M</given-names></name><name><surname>Dunbrack</surname><given-names>R</given-names></name></person-group><article-title>Neighbor-dependent ramachandran probability distributions of amino acids developed from a hierarchical dirich-let process model</article-title><source>PLoS Comput Biol</source><year>2010</year><volume>6</volume><issue>4</issue><elocation-id>e1000763</elocation-id><pub-id pub-id-type="pmcid">PMC2861699</pub-id><pub-id pub-id-type="pmid">20442867</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000763</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiberti</surname><given-names>M</given-names></name><name><surname>Papaleo</surname><given-names>E</given-names></name><name><surname>Bengtsen</surname><given-names>T</given-names></name><name><surname>Boomsma</surname><given-names>W</given-names></name><name><surname>Lindorff-Larsen</surname><given-names>K</given-names></name></person-group><article-title>Encore: software for quantitative ensemble comparison</article-title><source>PLoS Comput Biol</source><year>2015</year><volume>11</volume><issue>10</issue><elocation-id>e1004415</elocation-id><pub-id pub-id-type="pmcid">PMC4624683</pub-id><pub-id pub-id-type="pmid">26505632</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004415</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Villani</surname><given-names>C</given-names></name></person-group><source>Optimal Transport: Old and New</source><publisher-name>Springer-Verlag</publisher-name><publisher-loc>Berlin Heidelberg</publisher-loc><year>2008</year></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peyré</surname><given-names>G</given-names></name><name><surname>Cuturi</surname><given-names>M</given-names></name></person-group><article-title>Computational optimal transport: With applications to data science</article-title><source>Foundations and Trends® in Machine Learning</source><year>2019</year><volume>11</volume><issue>5-6</issue><fpage>355</fpage><lpage>607</lpage></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Arjovsky</surname><given-names>M</given-names></name><name><surname>Chintala</surname><given-names>S</given-names></name><name><surname>Bottou</surname><given-names>L</given-names></name></person-group><source>Wasserstein generative adversarial networks</source><person-group person-group-type="editor"><name><surname>Precup</surname><given-names>D</given-names></name><name><surname>Teh</surname><given-names>YW</given-names></name></person-group><conf-name>Proceedings of the 34th International Conference on Machine Learning</conf-name><conf-sponsor>Proceedings of Machine Learning Research, PMLR</conf-sponsor><year>2017</year><volume>70</volume><fpage>214</fpage><lpage>223</lpage></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serrurier</surname><given-names>M</given-names></name><name><surname>Mamalet</surname><given-names>F</given-names></name><name><surname>González-Sanz</surname><given-names>A</given-names></name><name><surname>Boissin</surname><given-names>T</given-names></name><name><surname>Loubes</surname><given-names>J-M</given-names></name><name><surname>del Barrio</surname><given-names>E</given-names></name></person-group><article-title>Achieving robustness in classification using optimal transport with hinge regularization</article-title><source>arXiv:2006.06520v3</source><year>2020</year></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>del Barrio</surname><given-names>E</given-names></name><name><surname>Gordaliza</surname><given-names>P</given-names></name><name><surname>Loubes</surname><given-names>J-M</given-names></name></person-group><article-title>A central limit theorem for lp transportation cost on the real line with application to fairness assessment in machine learning</article-title><source>Information and Inference: A Journal of the IMA</source><year>2019</year><volume>8</volume></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>A</given-names></name><name><surname>Kukharenko</surname><given-names>O</given-names></name><name><surname>Scheffner</surname><given-names>M</given-names></name><name><surname>Peter</surname><given-names>C</given-names></name></person-group><article-title>Towards a molecular basis of ubiquitin signaling: A dual-scale simulation study of ubiquitin dimers</article-title><source>PLoS Comput Biol</source><year>2018</year><volume>14</volume><issue>11</issue><elocation-id>e1006589</elocation-id><pub-id pub-id-type="pmcid">PMC6268000</pub-id><pub-id pub-id-type="pmid">30444864</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006589</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenbaum</surname><given-names>D</given-names></name><name><surname>Garnelo</surname><given-names>M</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Beattie</surname><given-names>C</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Huber</surname><given-names>A</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Doersch</surname><given-names>C</given-names></name><etal/></person-group><article-title>Inferring a continuous distribution of atom coordinates from cryo-em images using vaes</article-title><source>arXiv:2106.14108</source><year>2021</year></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Damjanovic</surname><given-names>J</given-names></name><name><surname>Murphy</surname><given-names>JM</given-names></name><name><surname>Lin</surname><given-names>Y-S</given-names></name></person-group><article-title>Catboss: Cluster analysis of trajectories based on segment splitting</article-title><source>J Chem Inf Model</source><year>2021</year><volume>61</volume><issue>10</issue><fpage>5066</fpage><lpage>5081</lpage><pub-id pub-id-type="pmcid">PMC8549068</pub-id><pub-id pub-id-type="pmid">34608796</pub-id><pub-id pub-id-type="doi">10.1021/acs.jcim.1c00598</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>González-Delgado</surname><given-names>J</given-names></name><name><surname>González-Sanz</surname><given-names>A</given-names></name><name><surname>Cortés</surname><given-names>J</given-names></name><name><surname>Neuvial</surname><given-names>P</given-names></name></person-group><article-title>Two-sample goodness-of-fit tests on the flat torus based on wasserstein distance and their relevance to structural biology</article-title><source>arXiv:2108.00165</source><year>2021</year></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozenne</surname><given-names>V</given-names></name><name><surname>Bauer</surname><given-names>F</given-names></name><name><surname>Salmon</surname><given-names>L</given-names></name><name><surname>Huang</surname><given-names>J-r</given-names></name><name><surname>Jensen</surname><given-names>MR</given-names></name><name><surname>Segard</surname><given-names>S</given-names></name><name><surname>Bernadó</surname><given-names>P</given-names></name><name><surname>Char-avay</surname><given-names>C</given-names></name><name><surname>Blackledge</surname><given-names>M</given-names></name></person-group><article-title>Flexible-meccano: a tool for the generation of explicit ensemble descriptions of intrinsically disordered proteins and their associated experimental observables</article-title><source>Bioin-formatics</source><year>2012</year><volume>28</volume><issue>11</issue><fpage>1463</fpage><lpage>1470</lpage><pub-id pub-id-type="pmid">22613562</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Estaña</surname><given-names>A</given-names></name><name><surname>Sibille</surname><given-names>N</given-names></name><name><surname>Delaforge</surname><given-names>E</given-names></name><name><surname>Vaisset</surname><given-names>M</given-names></name><name><surname>Cortés</surname><given-names>J</given-names></name><name><surname>Bernadó</surname><given-names>P</given-names></name></person-group><article-title>Realistic ensemble models of intrinsically disordered proteins using a structure-encoding coil database</article-title><source>Structure</source><year>2019</year><volume>27</volume><issue>2</issue><fpage>381</fpage><lpage>391</lpage><elocation-id>e2</elocation-id><pub-id pub-id-type="pmid">30554840</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommerfeld</surname><given-names>M</given-names></name><name><surname>Schrieber</surname><given-names>J</given-names></name><name><surname>Zemel</surname><given-names>Y</given-names></name><name><surname>Munk</surname><given-names>A</given-names></name></person-group><article-title>Optimal transport: Fast probabilistic approximation with exact solvers</article-title><source>J Mach Learn Res</source><year>2019</year><volume>20</volume><issue>105</issue><fpage>1</fpage><lpage>23</lpage></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name></person-group><article-title>Protein structure comparison by alignment of distance matrices</article-title><source>J Mol Biol</source><year>1993</year><volume>233</volume><issue>1</issue><fpage>123</fpage><lpage>138</lpage><pub-id pub-id-type="pmid">8377180</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jephthah</surname><given-names>S</given-names></name><name><surname>Pesce</surname><given-names>F</given-names></name><name><surname>Lindorff-Larsen</surname><given-names>K</given-names></name><name><surname>Skepö</surname><given-names>M</given-names></name></person-group><article-title>Force field effects in simulations of flexible peptides with varying polyproline II propensity</article-title><source>J Chem Theory Comput</source><year>2021</year><volume>17</volume><issue>10</issue><fpage>6634</fpage><lpage>6646</lpage><pub-id pub-id-type="pmcid">PMC8515809</pub-id><pub-id pub-id-type="pmid">34524800</pub-id><pub-id pub-id-type="doi">10.1021/acs.jctc.1c00408</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martín-García</surname><given-names>F</given-names></name><name><surname>Papaleo</surname><given-names>E</given-names></name><name><surname>Gomez-Puertas</surname><given-names>P</given-names></name><name><surname>Boomsma</surname><given-names>W</given-names></name><name><surname>Lindorff-Larsen</surname><given-names>K</given-names></name></person-group><article-title>Comparing molecular dynamics force fields in the essential subspace</article-title><source>PLoS One</source><year>2015</year><volume>10</volume><issue>3</issue><elocation-id>e0121114</elocation-id><pub-id pub-id-type="pmcid">PMC4374674</pub-id><pub-id pub-id-type="pmid">25811178</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0121114</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hess</surname><given-names>B</given-names></name></person-group><article-title>Convergence of sampling in protein simulations</article-title><source>Physical Review E</source><year>2002</year><volume>65</volume><issue>3</issue><elocation-id>031910</elocation-id><pub-id pub-id-type="pmid">11909112</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernadó</surname><given-names>P</given-names></name><name><surname>Mylonas</surname><given-names>E</given-names></name><name><surname>Petoukhov</surname><given-names>MV</given-names></name><name><surname>Blackledge</surname><given-names>M</given-names></name><name><surname>Svergun</surname><given-names>DI</given-names></name></person-group><article-title>Structural characterization of flexible proteins using small-angle X-ray scattering</article-title><source>J Am Chem Soc</source><year>2007</year><volume>129</volume><issue>17</issue><fpage>5656</fpage><lpage>5664</lpage><pub-id pub-id-type="pmid">17411046</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernadó</surname><given-names>P</given-names></name><name><surname>Blanchard</surname><given-names>L</given-names></name><name><surname>Timmins</surname><given-names>P</given-names></name><name><surname>Marion</surname><given-names>D</given-names></name><name><surname>Ruigrok</surname><given-names>RWH</given-names></name><name><surname>Blackledge</surname><given-names>M</given-names></name></person-group><article-title>A structural model for unfolded proteins from residual dipolar couplings and small-angle x-ray scattering</article-title><source>Proc Natl Acad Sci USA</source><year>2005</year><volume>102</volume><issue>47</issue><fpage>17002</fpage><lpage>17007</lpage><pub-id pub-id-type="pmcid">PMC1287987</pub-id><pub-id pub-id-type="pmid">16284250</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0506202102</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sagar</surname><given-names>A</given-names></name><name><surname>Jeffries</surname><given-names>CM</given-names></name><name><surname>Petoukhov</surname><given-names>MV</given-names></name><name><surname>Svergun</surname><given-names>DI</given-names></name><name><surname>Bernadó</surname><given-names>P</given-names></name></person-group><article-title>Comment on the optimal parameters to derive intrinsically disordered protein conformational ensembles from small-angle X-ray scattering data using the ensemble optimization method</article-title><source>J Chem Theory Comput</source><year>2021</year><volume>17</volume><issue>4</issue><fpage>2014</fpage><lpage>2021</lpage><pub-id pub-id-type="pmid">33725442</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tria</surname><given-names>G</given-names></name><name><surname>Mertens</surname><given-names>HDT</given-names></name><name><surname>Kachala</surname><given-names>M</given-names></name><name><surname>Svergun</surname><given-names>DI</given-names></name></person-group><article-title>Advanced ensemble modelling of flexible macromolecules using X-ray solution scattering</article-title><source>IUCrJ</source><year>2015</year><volume>2</volume><issue>2</issue><fpage>207</fpage><lpage>217</lpage><pub-id pub-id-type="pmcid">PMC4392415</pub-id><pub-id pub-id-type="pmid">25866658</pub-id><pub-id pub-id-type="doi">10.1107/S205225251500202X</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Illustration of how samples of global structural descriptors are obtained, for a pair of positions <italic>i</italic>, <italic>j</italic> along the sequence.</title><p>In (a), the reference frame is built for every conformation at residue <italic>i</italic>. In (b), all the frames are superimposed using this reference frame. Then, for any <italic>j</italic> ≠ <italic>i</italic>, the vectors <inline-formula><mml:math id="M47"><mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula> constitute a sample of <inline-formula><mml:math id="M48"><mml:mover><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo accent="false">→</mml:mo></mml:mover></mml:math></inline-formula>.</p></caption><graphic xlink:href="EMS158048-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comparison of Molecular Dynamics simulations of Hst5 ensemble using different force-fields.</title><p>The color scale indicates the proportion of intra-ensemble differences that corresponds to the observed corrected inter-ensemble differences, as defined in <xref ref-type="disp-formula" rid="FD10">(10)</xref>. The coefficients in the lower-triangle (in red) correspond to the global differences. The coefficients along the diagonal (in blue) correspond to the local differences. Blue stars indicate that the corresponding local corrected distance is significantly different from zero (the associated <italic>p</italic>-value <xref ref-type="disp-formula" rid="FD6">(6)</xref> is smaller than <italic>α</italic> = 0.05). Note the very different scales used in the different plots.</p></caption><graphic xlink:href="EMS158048-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Comparison of Molecular Dynamics simulations of PEP3 ensemble using different force fields.</title><p>The color scale indicates the proportion of intra-ensemble differences that corresponds to the observed corrected inter-ensemble differences, as defined in <xref ref-type="disp-formula" rid="FD10">(10)</xref>. The coefficients in the lower-triangle (in red) correspond to the global differences. The coefficients along the diagonal (in blue) correspond to the local differences. Blue stars indicate that the corresponding local corrected distance is significantly different from zero (the associated <italic>p</italic>-value <xref ref-type="disp-formula" rid="FD6">(6)</xref> is smaller than <italic>α</italic> = 0.05).</p></caption><graphic xlink:href="EMS158048-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>(a) Online convergence analysis for PEP3 ensemble simulated with force-fields c36idp, c36m, disp and ildn. (b) Online convergence analysis for K-18 domain of Tau ensemble simulated with AMBER ff99SB*-ILDN and TIP4P-D water model. In abscissas, the percentage of simulation time, divided in 20 equally spaced time intervals. In ordinates, the overall distances between the ensembles simulated at the extremes of the time intervals. The left (resp. right) column presents the evolution of <inline-formula><mml:math id="M49"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula><mml:math id="M50"><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math></inline-formula>) with respect to time.</p></caption><graphic xlink:href="EMS158048-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Comparison of Hst5 ensemble before and after filtering with experimental SAXS data.</title><p>The color scale indicates the proportion of intra-ensemble differences that corresponds to the observed corrected inter-ensemble differences, as defined in <xref ref-type="disp-formula" rid="FD10">(10)</xref>. The coefficients in the lower triangle (in red) correspond to the global differences. The coefficients along the diagonal (in blue) correspond to the local differences. Blue stars indicate that the corresponding local corrected distance is significantly different from zero (the associated <italic>p</italic>-value <xref ref-type="disp-formula" rid="FD6">(6)</xref> is smaller than <italic>α</italic> = 0.05).</p></caption><graphic xlink:href="EMS158048-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>comparison of Hst5 ensembles before and after filtering with experimental SAXS data.</title><p>The ensemble was simulated from (a) N-to-C or from (b) C-to-N. (c) Comparison of Hst5 ensembles generated from N-to-C and C-to-N. (d) comparison of the N-to-C and C-to-N SAXS refined. In all matrices, the color scale indicates the proportion of intra-ensemble differences that corresponds to the observed corrected inter-ensemble differences, as defined in <xref ref-type="disp-formula" rid="FD10">(10)</xref>. The coefficients in the lower triangle (in red) corresponds to the global differences. Coefficients along the diagonal (in blue) correspond to the local differences. Blue stars indicate that the corresponding local corrected distance is significantly different from zero (the associated <italic>p</italic>-value <xref ref-type="disp-formula" rid="FD6">(6)</xref> is smaller than <italic>α</italic> = 0.05).</p></caption><graphic xlink:href="EMS158048-f006"/></fig></floats-group></article>