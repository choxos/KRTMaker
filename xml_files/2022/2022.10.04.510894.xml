<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS155701</article-id><article-id pub-id-type="doi">10.1101/2022.10.04.510894</article-id><article-id pub-id-type="archive">PPR555688</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Unified and standardized mass spectrometry data processing in Python using spectrum_utils</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Bittremieux</surname><given-names>Wout</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Levitsky</surname><given-names>Lev</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Pilz</surname><given-names>Matteo</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Sachsenberg</surname><given-names>Timo</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Huber</surname><given-names>Florian</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Mingxun</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Dorrestein</surname><given-names>Pieter C.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib></contrib-group><aff id="A1"><label>1</label>Collaborative Mass Spectrometry Innovation Center, University of California San Diego, La Jolla, CA 92093, USA</aff><aff id="A2"><label>2</label>Skaggs School of Pharmacy and Pharmaceutical Sciences, University of California San Diego, La Jolla CA 92093, USA</aff><aff id="A3"><label>3</label>V. L. Talrose Institute for Energy Problems of Chemical Physics, N. N. Semenov Federal Research Center for Chemical Physics, Russian Academy of Sciences, 119334 Moscow, Russia</aff><aff id="A4"><label>4</label>Institute for Bioinformatics and Medical Informatics, University of Tübingen, 72076 Tübingen, Germany</aff><aff id="A5"><label>5</label>Centre for Digitalisation and Digitality, University of Applied Sciences Düsseldorf, 40476 Düsseldorf, Germany</aff><aff id="A6"><label>6</label>Department of Computer Science, University of California Riverside, Riverside, CA 92507, USA</aff><author-notes><corresp id="CR1">Corresponding author: <email>wbittremieux@health.ucsd.edu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>14</day><month>10</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>07</day><month>10</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">spectrum_utils is a Python package for mass spectrometry data processing and visualization. Since its introduction, spectrum_utils has grown into a fundamental software solution that powers various applications in proteomics and metabolomics, ranging from spectrum preprocessing prior to spectrum identification and machine learning applications, to spectrum plotting from online data repositories, and assisting data analysis tasks for dozens of other projects. Here we present updates to spectrum_utils, which include new functionality to integrate mass spectrometry community data standards, enhanced mass spectral data processing, and unified mass spectral data visualization in Python. spectrum_utils is freely available as open source at <ext-link ext-link-type="uri" xlink:href="https://github.com/bittremieux/spectrum_utils">https://github.com/bittremieux/spectrum_utils</ext-link>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">There exists a rich ecosystem of open-source mass spectrometry (MS) software. Some of the most popular MS software libraries in common programming languages, such as Python and R, include Pyteomics,<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup> pyOpenMS,<sup><xref ref-type="bibr" rid="R3">3</xref></sup> matchms,<sup><xref ref-type="bibr" rid="R4">4</xref></sup> pymzml,<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup> and MSnbase.<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup> Compared to vendor software and other closed-source MS software, these open-source solutions provide flexibility to develop powerful functionalities, are verifiable through their open-source nature, and have garnered widespread community support to grow their capabilities. Although each library predominantly covers its unique use cases, there are common tasks that frequently occur, such as MS/MS spectrum processing and visualization.</p><p id="P3">In its first release, spectrum_utils<sup><xref ref-type="bibr" rid="R9">9</xref></sup> provided a lightweight solution to cover common MS data manipulation functionalities. Its high-level application programming interface (API) allows developers to quickly prototype computational ideas for mass spectrometry projects. The data processing functionality is optimized for computational efficiency to handle large volumes of data (hundreds to thousands of files) that are generated during MS experiments. This dovetails with visualization functionality to produce publication-quality and interactive spectrum graphics. Since its introduction, spectrum_utils has been used in tools that perform spectral library searching<sup><xref ref-type="bibr" rid="R10">10</xref></sup> and spectrum clustering,<sup><xref ref-type="bibr" rid="R11">11</xref></sup> to preprocess MS/MS spectra prior to deep learning applications,<sup><xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R13">13</xref></sup> to plot MS/MS spectra from online data repositories,<sup><xref ref-type="bibr" rid="R14">14</xref></sup> and to assist in MS/MS processing and visualization efforts for dozens of other projects.<sup><xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R22">22</xref></sup></p><p id="P4">Here we present recent updates to spectrum_utils. It has now been extended with functionality for common and versatile data manipulation and visualization tasks when working with MS data in Python, including support for community data standards, updated visualization functionalities, and performance improvements. This has enabled spectrum_utils to grow into a building block of the MS Python ecosystem. It functions both as a client, to provide basic functionality for other software tools and by accessing external web resources, and as a server, through integration in key online tools for end users. With a strong focus on open source, compatibility and integration with other software libraries, and support of community standards, spectrum_utils is contributing to make MS data and software open, accessible, and reusable for the entire community. spectrum_utils is freely available as open source under the Apache 2.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/bittremieux/spectrum_utils">https://github.com/bittremieux/spectrum_utils</ext-link>.</p></sec><sec id="S2" sec-type="methods | results"><title>Methods &amp; Results</title><sec id="S3"><title>Supporting mass spectrometry community data standards for data access, processing, and visualization</title><p id="P5">spectrum_utils supports several official data standards and best practices developed by the Proteomics Standards Initiative (PSI) of the Human Proteome Organization (HUPO).<sup><xref ref-type="bibr" rid="R23">23</xref></sup> Specifically, spectrum_utils has now integrated support for the Universal Spectrum Identifier (USI)<sup><xref ref-type="bibr" rid="R24">24</xref></sup> for convenient retrieval of MS data from ProteomeXchange<sup><xref ref-type="bibr" rid="R25">25</xref></sup> and other online resources, the ProForma 2.0 specification<sup><xref ref-type="bibr" rid="R26">26</xref></sup> to encode proteoform information, and standardized fragment ion annotations (<ext-link ext-link-type="uri" xlink:href="https://github.com/HUPO-PSI/mzSpecLib/">https://github.com/HUPO-PSI/mzSpecLib/</ext-link>).</p><p id="P6">The Universal Spectrum Identifier<sup><xref ref-type="bibr" rid="R24">24</xref></sup> is a mechanism that provides unique identifiers for MS data present in ProteomeXchange repositories. Rather than only including spectral evidence of novel discoveries as static figures in scientific manuscripts or being relegated to supporting information, USIs make MS data Findable, Accessible, Interoperable, and Reusable (FAIR). spectrum_utils supports the USI specification to retrieve proteomics mass spectra from ProteomeXchange resources, including PRIDE,<sup><xref ref-type="bibr" rid="R27">27</xref></sup> MassIVE, PeptideAtlas,<sup><xref ref-type="bibr" rid="R28">28</xref></sup> and jPOST,<sup><xref ref-type="bibr" rid="R29">29</xref></sup> through integration with Pyteomics,<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup> as well as metabolomics mass spectra from GNPS/MassIVE,<sup><xref ref-type="bibr" rid="R30">30</xref></sup> MassBank,<sup><xref ref-type="bibr" rid="R31">31</xref></sup> MetaboLights,<sup><xref ref-type="bibr" rid="R32">32</xref></sup> Metabolomics Workbench,<sup><xref ref-type="bibr" rid="R33">33</xref></sup> and MS2LDA,<sup><xref ref-type="bibr" rid="R34">34</xref></sup> through integration with the GNPS’ Metabolomics USI Resolver.<sup><xref ref-type="bibr" rid="R14">14</xref></sup> USI integration in spectrum_utils makes it possible to effortlessly load MS data from virtually all major proteomics and metabolomics data platforms and start processing it in Python using a single line of code (<xref ref-type="fig" rid="F1">Figure 1a</xref>). Furthermore, as the Metabolomics USI resolver provides a convenient web API to programmatically retrieve MS data, indirectly spectrum_utils also facilitates the loading of MS data in any programming language.</p><p id="P7">The ProForma 2.0 format<sup><xref ref-type="bibr" rid="R26">26</xref></sup> is a compact way to encode peptidoforms and proteoforms by unambiguously specifying post-translational modifications (PTMs), which was recently developed for use in both bottom-up and top-down proteomics through joint efforts of the PSI and the Consortium for Top-Down Proteomics. ProForma 2.0 specifies several levels of compliance, including base-level support, top-down extensions, cross-linking extensions, glycan extensions, and more. spectrum_utils uniquely provides full support for all ProForma 2.0 levels, including all optional extensions, in a convenient Python interface (<xref ref-type="fig" rid="F1">Figure 1a</xref>). Internally, spectrum_utils represents the ProForma 2.0 specification as a formal grammar which is used to create an abstract syntax tree when parsing a ProForma string (<xref ref-type="fig" rid="F1">Figure 1c</xref>). This approach is similar to how compilers interpret complex source code instructions, and the formal grammar is the only existing codified representation for ProForma 2.0 that is machine-readable. This is an extremely robust and scalable solution to cover the full ProForma 2.0 specification, including optional extensions and edge cases, compared to alternative approaches, such as combinations of regular expressions. To interpret nodes in the abstract syntax tree that represent PTMs, spectrum_utils supports all controlled vocabularies (CVs) relevant for ProForma 2.0, including Unimod,<sup><xref ref-type="bibr" rid="R35">35</xref></sup> PSI-MOD,<sup><xref ref-type="bibr" rid="R36">36</xref></sup> RESID, XL-MOD,<sup><xref ref-type="bibr" rid="R37">37</xref></sup> and the Glycan Naming Ontology,<sup><xref ref-type="bibr" rid="R38">38</xref></sup> as well as PTMs specified by observed precursor mass differences. While traversing an abstract syntax tree, upon the first occurrence of a CV term, spectrum_utils will automatically download the corresponding CV file from its online resource and parse the CV term by its name or accession. Additionally, spectrum_utils will store the CV files in a local cache to minimize the time required for further lookups. Retrieving CV terms from a remote or local CV file is performed in a way that is completely transparent to the user.</p><p id="P8">When annotating an MS/MS spectrum with its ProForma string, spectrum_utils calculates all theoretical fragments and annotates matching fragment ions. spectrum_utils can consider a wide variety of theoretical fragments, including the primary a, b, c, x, y, and z peptide fragments; internal fragment ions, which result from two amide bond cleavages and thus do not contain either terminus; immonium ions, which are internal fragments for individual amino acids formed by a b/y cleavage on the N-terminal side and an a/x cleavage on the C-terminal side; intact precursor ions; reporter ions from isobaric labeling; and any of the preceding ions that have undergone a neutral loss, such as loss of hydrogen, ammonia, water, etc. Next, spectrum_utils can highlight all of the fragment ions with their annotations while plotting the MS/MS spectrum to visually validate the peptide-spectrum match (<xref ref-type="fig" rid="F1">Figure 1b</xref>).</p></sec><sec id="S4"><title>Case study: Annotating peaks in tandem mass spectra</title><p id="P9">We have used spectrum_utils to annotate fragment ions for 2,153,703 MS/MS spectra in the MassIVE-KB v1 spectral library.<sup><xref ref-type="bibr" rid="R39">39</xref></sup> This case study exemplifies how the powerful functionality to annotate spectra with ProForma peptide information and peak interpretation by matching observed fragment ions can be used. MassIVE-KB is a repository-wide human higher-energy collisional dissociation (HCD) spectral library, derived from over 30 TB of human MS/MS data from 227 public proteomics datasets on the MassIVE repository. Peptide identifications for MassIVE-KB were previously obtained using MSGF+<sup><xref ref-type="bibr" rid="R40">40</xref></sup> to search the spectra against the UniProt<sup><xref ref-type="bibr" rid="R41">41</xref></sup> human reference proteome database (v. 23 May 2016). Cysteine carbamidomethylation was set as a fixed modification, and variable modifications were methionine oxidation, N-terminal acetylation, N-terminal carbamylation, pyroglutamate formation from glutamine, and deamidation of asparagine and glutamine. MSGF+ was configured to allow one <sup>13</sup>C precursor mass isotope, at most one non-tryptic terminus, and 10 ppm precursor mass tolerance. The searches were individually filtered at 1% PSM-level FDR.</p><p id="P10">To interpret the observed fragment ions, we considered a, b, c, x, y, and z peptide fragments, immonium ions, internal fragment ions, and intact precursor ions. Additionally, the following neutral losses were considered for any of these ions: loss of hydrogen (H), loss of ammonia (NH3), loss of water (H2O), loss of carbon monoxide (CO), loss of carbon dioxide (CO2), loss of formamide (HCONH2), loss of formic acid (HCOOH), loss of methanesulfenic acid (CH4OS), loss of sulfur trioxide (SO3), loss of metaphosphoric acid (HPO3), loss of mercaptoacetamide (C2H5NOS), loss of mercaptoacetic acid (C2H4O2S), and loss of phosphoric acid (H3PO4). Fragments with charges up to the spectrum precursor charge were considered, and fragment ions were assigned a peak interpretation if their observed <italic>m</italic>/<italic>z</italic> was within 20 ppm of the theoretical <italic>m</italic>/<italic>z</italic>. In case multiple peak interpretations matched an observed fragment ion, heuristics were used to select the most relevant peak annotation by preferring y and b fragments, as well as fragments without a neutral loss.</p><p id="P11">Despite the many theoretical fragments that are possible, peak annotation of over 2 million MS/MS spectra took under 2.5 hours using an Intel Xeon Gold 6148 processor (2.4 GHz, 40 cores). On average, 74% of the observed intensity of the spectra could be explained by a matching peak interpretation. As expected for HCD data, the most prevalent ion types were y ions, explaining 33% of the fragment intensities on average, while b ions explained 13% of the fragment intensities (<xref ref-type="fig" rid="F2">Figure 2a</xref>). Internal fragment ions also covered a non-negligible amount of intensity. Although the average intensity of individual internal fragment ions was third-lowest (after x and z ions), their cumulative explained intensity amounted to 15% on average due to the very large number of small peaks that could be interpreted as internal fragments.</p><p id="P12">When further examining the intensity of peptide fragments based on their location in the peptides (<xref ref-type="fig" rid="F2">Figure 2b</xref>), we can observe that y ions provide the dominant signal across a wide range of fragment locations, followed by b ions, which are most intense in locations near the peptide N-terminus. Additionally, peptide a ions commonly occur for small N-terminal fragments. Thus, even though sequence database search engines often only consider b and y ions for HCD data, taking small a ions into account might help bolster confidence in the spectrum annotations.</p><p id="P13">Although the majority of explained intensity corresponds to fragments that do not include a neutral loss, a quarter of the observed intensity matches fragment ions that have undergone a wide variety of neutral losses (<xref ref-type="fig" rid="F2">Figure 2c</xref>). This indicates that considering appropriate neutral losses can again boost the quality of spectrum annotations.</p></sec></sec><sec id="S5" sec-type="conclusions"><title>Conclusions</title><p id="P14">spectrum_utils combines a high-level Python API to easily perform common MS data tasks with only a single line of code, such as annotating MS/MS spectra with their peptide labels after database searching or visualizing spectrum–spectrum matches from spectral library searching using mirror plots. Additionally, power users can expand upon the spectrum_utils functions and infinitely customize their results by writing surrounding Python code. As an example, we have demonstrated these aspects by annotating fragment ions for over 2 million MS/MS spectra and providing insights into which ion types explain the observed peaks. This functionality is similar to the recently proposed MS_Piano software,<sup><xref ref-type="bibr" rid="R49">49</xref></sup> but is inherently flexible using only a few lines of Python code, supports an extensive variety of PTMs through modification CV support in ProForma 2.0, and is fully cross-platform and open source. Further downstream applications can easily be achieved, such as quality assessment of spectrum annotations based on explained ion intensity or exporting annotated spectra to create a spectral library.</p><p id="P15">Besides the novel capabilities introduced here, the prior core functionality of spectrum_utils has also been extended and made compatible with third-party Python MS libraries focusing on both proteomics and metabolomics. Harnessing spectrum_utils’ plotting functionality to create publication-quality spectrum plots and mirror plots, this now powers on-the-fly spectrum visualization in the Metabolomics USI interface,<sup><xref ref-type="bibr" rid="R14">14</xref></sup> for MS/MS spectra in the MassIVE web interface, and it is integrated into the Python software packages Pyteomics,<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup> pyOpenMS,<sup><xref ref-type="bibr" rid="R3">3</xref></sup> and matchms<sup><xref ref-type="bibr" rid="R4">4</xref></sup> for MS-based proteomics and metabolomics. In conclusion, spectrum_utils powers a growing open-source Python software stack and has emerged as a focal point of MS data manipulation for proteomics and metabolomics.</p></sec></body><back><sec id="S6"><title>Acknowledgements</title><p>This research was supported by BBSRC-NSF award 2152526 and National Institutes of Health award R03OD034493.</p></sec><sec id="S7" sec-type="data-availability"><title>Code availability</title><p id="P16">spectrum_utils is available for Python 3.8+ and can be easily installed from the Python Package Index (PyPI) using pip or via conda using the Bioconda channel.<sup><xref ref-type="bibr" rid="R42">42</xref></sup> spectrum_utils depends on NumPy<sup><xref ref-type="bibr" rid="R43">43</xref></sup> and Numba<sup><xref ref-type="bibr" rid="R44">44</xref></sup> for efficient numerical computation, Pyteomics<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup> for peptide fragment ion mass calculations and USI resolving, fastobo<sup><xref ref-type="bibr" rid="R45">45</xref></sup> and lark-parser for parsing ProForma annotations, matplotlib<sup><xref ref-type="bibr" rid="R46">46</xref></sup> for static plotting, and Altair<sup><xref ref-type="bibr" rid="R47">47</xref></sup> and Pandas<sup><xref ref-type="bibr" rid="R48">48</xref></sup> for interactive plotting.</p><p id="P17">All code and detailed documentation on how to use spectrum_utils is freely available as open source under the Apache 2.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/bittremieux/spectrum_utils">https://github.com/bittremieux/spectrum_utils</ext-link>. Code for the example spectrum plot in <xref ref-type="fig" rid="F1">Figure 1b</xref> is available as open source at <ext-link ext-link-type="uri" xlink:href="https://gist.github.com/bittremieux/47be3b3b038efb1c5b320a136b1e2d47">https://gist.github.com/bittremieux/47be3b3b038efb1c5b320a136b1e2d47</ext-link> and code for the MassIVE-KB peak interpretation use case is available as open source at <ext-link ext-link-type="uri" xlink:href="https://gist.github.com/bittremieux/cf58d176bba81ee0af1810f3728d150c">https://gist.github.com/bittremieux/cf58d176bba81ee0af1810f3728d150c</ext-link>. The results presented here were obtained using spectrum_utils v0.4.0.</p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goloborodko</surname><given-names>AA</given-names></name><name><surname>Levitsky</surname><given-names>LI</given-names></name><name><surname>Ivanov</surname><given-names>MV</given-names></name><name><surname>Gorshkov</surname><given-names>MV</given-names></name></person-group><article-title>Pyteomics-a Python framework for exploratory data analysis and rapid software prototyping in proteomics</article-title><source>J Am Soc Mass Spectrom</source><year>2013</year><volume>24</volume><fpage>301</fpage><lpage>304</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levitsky</surname><given-names>LI</given-names></name><name><surname>Klein</surname><given-names>JA</given-names></name><name><surname>Ivanov</surname><given-names>MV</given-names></name><name><surname>Gorshkov</surname><given-names>M</given-names></name></person-group><article-title>Pyteomics 4.0: Five years of development of a Python proteomics framework</article-title><source>J Proteome Res</source><year>2019</year><volume>18</volume><fpage>709</fpage><lpage>714</lpage></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Röst</surname><given-names>HL</given-names></name><name><surname>Schmitt</surname><given-names>U</given-names></name><name><surname>Aebersold</surname><given-names>R</given-names></name><name><surname>Malmström</surname><given-names>L</given-names></name></person-group><article-title>pyOpenMS: A Python-based interface to the OpenMS mass-spectrometry algorithm library</article-title><source>PROTEOMICS</source><year>2014</year><volume>14</volume><fpage>74</fpage><lpage>77</lpage></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>F</given-names></name><etal/></person-group><article-title>matchms - processing and similarity evaluation of mass spectrometry data</article-title><source>J Open Source Softw</source><year>2020</year><volume>5</volume><fpage>2411</fpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bald</surname><given-names>T</given-names></name><etal/></person-group><article-title>pymzML--Python module for high-throughput bioinformatics on mass spectrometry data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>1052</fpage><lpage>1053</lpage></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kösters</surname><given-names>M</given-names></name><etal/></person-group><article-title>pymzML v2.0: Introducing a highly compressed and seekable gzip format</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>2513</fpage><lpage>2514</lpage></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gatto</surname><given-names>L</given-names></name><name><surname>Lilley</surname><given-names>KS</given-names></name></person-group><article-title>MSnbase-an R/Bioconductor package for isobaric tagged mass spectrometry data visualization, processing and quantitation</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>288</fpage><lpage>289</lpage></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gatto</surname><given-names>L</given-names></name><name><surname>Gibb</surname><given-names>S</given-names></name><name><surname>Rainer</surname><given-names>J</given-names></name></person-group><article-title>MSnbase, efficient and elegant R-based processing and visualization of raw mass spectrometry data</article-title><source>J Proteome Res</source><year>2020</year><pub-id pub-id-type="doi">10.1021/acs.jproteome.0c00313</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name></person-group><article-title>spectrum_utils: A Python package for mass spectrometry data processing and visualization</article-title><source>Anal Chem</source><year>2020</year><volume>92</volume><fpage>659</fpage><lpage>661</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>Extremely fast and accurate open modification spectral library searching of high-resolution mass spectra using feature hashing and graphics processing units</article-title><source>J Proteome Res</source><year>2019</year><volume>18</volume><fpage>3792</fpage><lpage>3799</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Dorrestein</surname><given-names>PC</given-names></name></person-group><article-title>Large-scale tandem mass spectrum clustering using fast nearest neighbor searching</article-title><source>Rapid Commun Mass Spectrom</source><year>2021</year><elocation-id>e9153</elocation-id><pub-id pub-id-type="doi">10.1002/rcm.9153</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>May</surname><given-names>DH</given-names></name><name><surname>Bilmes</surname><given-names>J</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>A learned embedding for efficient joint analysis of millions of mass spectra</article-title><source>Nat Methods</source><year>2022</year><fpage>675</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01496-1</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Yilmaz</surname><given-names>M</given-names></name><name><surname>Fondrie</surname><given-names>WE</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Oh</surname><given-names>S</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><source><italic>De novo</italic> mass spectrometry peptide sequencing with a transformer model</source><conf-name>Proceedings of the 39th International Conference on Machine Learning - ICML ’22</conf-name><publisher-name>PMLR</publisher-name><year>2022</year><volume>162</volume><fpage>25514</fpage><lpage>25522</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><etal/></person-group><article-title>Universal MS/MS visualization and retrieval with the Metabolomics Spectrum Resolver web service</article-title><source>bioRxiv</source><year>2020</year><pub-id pub-id-type="doi">10.1101/2020.05.09.086066</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pino</surname><given-names>L</given-names></name><name><surname>Lin</surname><given-names>A</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name></person-group><article-title>2018 YPIC Challenge: A case study in characterizing an unknown protein sample</article-title><source>J Proteome Res</source><year>2019</year><volume>18</volume><fpage>3936</fpage><lpage>3943</lpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altenburg</surname><given-names>T</given-names></name><name><surname>Giese</surname><given-names>SH</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Muth</surname><given-names>T</given-names></name><name><surname>Renard</surname><given-names>BY</given-names></name></person-group><article-title>Ad hoc learning of peptide fragmentation from mass spectra enables an interpretable detection of phosphorylated and cross-linked peptides</article-title><source>Nat Mach Intell</source><year>2022</year><volume>4</volume><fpage>378</fpage><lpage>388</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schessner</surname><given-names>JP</given-names></name><name><surname>Voytik</surname><given-names>E</given-names></name><name><surname>Bludau</surname><given-names>I</given-names></name></person-group><article-title>A practical guide to interpreting and generating bottom-up proteomics data visualizations</article-title><source>PROTEOMICS</source><year>2022</year><volume>22</volume><elocation-id>2100103</elocation-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boiko</surname><given-names>DA</given-names></name><name><surname>Kozlov</surname><given-names>KS</given-names></name><name><surname>Burykina</surname><given-names>JV</given-names></name><name><surname>Ilyushenkova</surname><given-names>VV</given-names></name><name><surname>Ananikov</surname><given-names>VP</given-names></name></person-group><article-title>Fully Automated Unconstrained Analysis of High-Resolution Mass Spectrometry Data with Machine Learning</article-title><source>J Am Chem Soc</source><year>2022</year><volume>144</volume><fpage>14590</fpage><lpage>14606</lpage></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Declercq</surname><given-names>A</given-names></name><etal/></person-group><article-title>MS2Rescore: Data-driven rescoring dramatically boosts immunopeptide identification rates</article-title><source>Mol Cell Proteomics</source><year>2022</year><volume>21</volume><elocation-id>100266</elocation-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname><given-names>C</given-names></name><name><surname>Boonen</surname><given-names>K</given-names></name><name><surname>Laukens</surname><given-names>K</given-names></name><name><surname>Bittremieux</surname><given-names>W</given-names></name></person-group><article-title>Open modification searching of SARS-CoV-2-human protein interaction data reveals novel viral modification sites</article-title><source>bioRxiv</source><year>2022</year></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><etal/></person-group><article-title>Open access repository-scale propagated nearest neighbor suspect spectral library for untargeted metabolomics</article-title><source>bioRxiv</source><year>2022</year><pub-id pub-id-type="doi">10.1101/2022.05.15.490691</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>IR</given-names></name><etal/></person-group><source>Coisolation of peptide pairs for peptide identification and MS/MS-based quantification</source><year>2022</year><comment><ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2022.04.18.488679">http://biorxiv.org/lookup/doi/10.1101/2022.04.18.488679</ext-link></comment><pub-id pub-id-type="doi">10.1101/2022.04.18.488679</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deutsch</surname><given-names>EW</given-names></name><etal/></person-group><article-title>Proteomics Standards Initiative: Fifteen years of progress and future work</article-title><source>J Proteome Res</source><year>2017</year><volume>16</volume><fpage>4288</fpage><lpage>4298</lpage></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deutsch</surname><given-names>EW</given-names></name><etal/></person-group><article-title>Universal Spectrum Identifier for mass spectra</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>768</fpage><lpage>770</lpage></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vizcaino</surname><given-names>JA</given-names></name><etal/></person-group><article-title>ProteomeXchange provides globally coordinated proteomics data submission and dissemination</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>223</fpage><lpage>226</lpage></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeDuc</surname><given-names>RD</given-names></name><etal/></person-group><article-title>Proteomics Standards Initiative’s ProForma 2.0: Unifying the Encoding of Proteoforms and Peptidoforms</article-title><source>J Proteome Res</source><year>2022</year><volume>21</volume><fpage>1189</fpage><lpage>1195</lpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perez-Riverol</surname><given-names>Y</given-names></name><etal/></person-group><article-title>The PRIDE database and related tools and resources in 2019: Improving support for quantification data</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>D442</fpage><lpage>D450</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desiere</surname><given-names>F</given-names></name><etal/></person-group><article-title>The PeptideAtlas project</article-title><source>Nucleic Acids Res</source><year>2006</year><volume>34</volume><fpage>D655</fpage><lpage>D658</lpage></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moriya</surname><given-names>Y</given-names></name><etal/></person-group><article-title>The jPOST environment: An integrated proteomics data repository and database</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>D1218</fpage><lpage>D1224</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>M</given-names></name><etal/></person-group><article-title>Sharing and community curation of mass spectrometry data with Global Natural Products Social Molecular Networking</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>828</fpage><lpage>837</lpage></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horai</surname><given-names>H</given-names></name><etal/></person-group><article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title><source>J Mass Spectrom</source><year>2010</year><volume>45</volume><fpage>703</fpage><lpage>714</lpage></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haug</surname><given-names>K</given-names></name><etal/></person-group><article-title>MetaboLights--an open-access general-purpose repository for metabolomics studies and associated meta-data</article-title><source>Nucleic Acids Res</source><year>2013</year><volume>41</volume><fpage>D781</fpage><lpage>D786</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sud</surname><given-names>M</given-names></name><etal/></person-group><article-title>Metabolomics Workbench: An international repository for metabolomics data and metadata, metabolite standards, protocols, tutorials and training, and analysis tools</article-title><source>Nucleic Acids Res</source><year>2015</year><volume>44</volume><fpage>D463</fpage><lpage>D470</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Hooft</surname><given-names>JJJ</given-names></name><name><surname>Wandy</surname><given-names>J</given-names></name><name><surname>Barrett</surname><given-names>MP</given-names></name><name><surname>Burgess</surname><given-names>KEV</given-names></name><name><surname>Rogers</surname><given-names>S</given-names></name></person-group><article-title>Topic modeling for untargeted substructure exploration in metabolomics</article-title><source>Proc Natl Acad Sci</source><year>2016</year><volume>113</volume><fpage>13738</fpage><lpage>13743</lpage></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Creasy</surname><given-names>DM</given-names></name><name><surname>Cottrell</surname><given-names>JS</given-names></name></person-group><article-title>Unimod: Protein modifications for mass spectrometry</article-title><source>PROTEOMICS</source><year>2004</year><volume>4</volume><fpage>1534</fpage><lpage>1536</lpage></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montecchi-Palazzi</surname><given-names>L</given-names></name><etal/></person-group><article-title>The PSI-MOD community standard for representation of protein modification data</article-title><source>Nat Biotechnol</source><year>2008</year><volume>26</volume><fpage>864</fpage><lpage>866</lpage></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mayer</surname><given-names>G</given-names></name></person-group><article-title>XLMOD: Cross-linking and chromatography derivatization reagents ontology</article-title><source>ArXiv200300329 Q-BioBM</source><year>2020</year><pub-id pub-id-type="doi">10.48550/ARXIV.2003.00329</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiemeyer</surname><given-names>M</given-names></name><etal/></person-group><article-title>GlyTouCan: an accessible glycan structure repository</article-title><source>Glycobiology</source><year>2017</year><volume>27</volume><fpage>915</fpage><lpage>919</lpage></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>M</given-names></name><etal/></person-group><article-title>Assembling the community-scale discoverable human proteome</article-title><source>Cell Syst</source><year>2018</year><volume>7</volume><fpage>412</fpage><lpage>421</lpage><elocation-id>e5</elocation-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Pevzner</surname><given-names>PA</given-names></name></person-group><article-title>MS-GF+ makes progress towards a universal database search tool for proteomics</article-title><source>Nat Commun</source><year>2014</year><volume>5</volume><fpage>5277</fpage></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breuza</surname><given-names>L</given-names></name><etal/></person-group><article-title>The UniProtKB guide to the human proteome</article-title><source>Database</source><year>2016</year><volume>2016</volume><elocation-id>bav120</elocation-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grüning</surname><given-names>B</given-names></name><etal/></person-group><article-title>Bioconda: Sustainable and comprehensive software distribution for the life sciences</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>475</fpage><lpage>476</lpage></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><etal/></person-group><article-title>Array programming with NumPy</article-title><source>Nature</source><year>2020</year><volume>585</volume><fpage>357</fpage><lpage>362</lpage></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lam</surname><given-names>SK</given-names></name><name><surname>Pitrou</surname><given-names>A</given-names></name><name><surname>Seibert</surname><given-names>S</given-names></name></person-group><source>Numba: a LLVM-based Python JIT compiler</source><conf-name>Proceedings of the Second Workshop on the LLVM Compiler Infrastructure in HPC - LLVM ‘15</conf-name><publisher-name>ACM Press</publisher-name><year>2015</year><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1145/2833157.2833162</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larralde</surname><given-names>M</given-names></name></person-group><article-title>Developing Python and Rust libraries to improve the ontology ecosystem</article-title><year>2019</year><pub-id pub-id-type="doi">10.7490/F1000RESEARCH.1117405.1</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>JD</given-names></name></person-group><article-title>Matplotlib: A 2D graphics environment</article-title><source>Comput Sci Eng</source><year>2007</year><volume>9</volume><fpage>90</fpage><lpage>95</lpage></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanderPlas</surname><given-names>J</given-names></name><etal/></person-group><article-title>Altair: Interactive statistical visualizations for Python</article-title><source>J Open Source Softw</source><year>2018</year><volume>3</volume><fpage>1057</fpage></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W</given-names></name></person-group><source>Data structures for statistical computing in Python</source><person-group person-group-type="editor"><name><surname>van der Walt</surname><given-names>S</given-names></name><name><surname>Millman</surname><given-names>J</given-names></name></person-group><conf-name>Proceedings of the 9th Python in Science Conference</conf-name><year>2010</year><fpage>51</fpage><lpage>56</lpage></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>X</given-names></name><etal/></person-group><article-title>MS_Piano: A software tool for annotating peaks in CID tandem mass spectra of peptides and N-glycopeptides</article-title><source>J Proteome Res</source><year>2021</year><volume>20</volume><fpage>4603</fpage><lpage>4609</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>(a)</bold> spectrum_utils provides a convenient and high-level interface to process MS data. Fully functional code example for loading an MS/MS spectrum using its USI, annotating the spectrum with the corresponding peptide sequence using the ProForma 2.0 format, and visualizing the spectrum using only a small number of lines of code. <bold>(b)</bold> Spectrum plot corresponding to the code example in (a). The final code was adapted only minimally for visualization purposes. spectrum_utils can annotate known peaks, including typical b and y peptide fragments (highlighted), as well as internal fragment ions (yellow), and immonium ions (dark gray). Different information for annotated peaks, such as the ion type and deviation from the theoretical fragment <italic>m/z,</italic> can be reported. <bold>(c)</bold> Internal representation of the abstract syntax tree when parsing a complex ProForma string that contains several modifications, including labile glycan modifications, modifications specified by their CV accession or CV name, and an observed modification mass of +79.966 that can be interpreted as a phosphorylation or a sulfation.</p></caption><graphic xlink:href="EMS155701-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>(a)</bold> Average explained intensity for fragment ions across 2 million HCD MS/MS spectra from the MassIVE-KB spectral library. Considered ion types are peptide fragments “a”, “b”, “c”, “x”, “y”, and “z”; internal fragment ions “m”, immonium ions “I”, and intact precursor ions “p”. <bold>(b)</bold> Intensity of peptide fragments related to their location in the peptides. For peptides with length <italic>n,</italic> distances to the peptide N-terminus correspond to b<sub>1</sub>, b<sub>2</sub>, … and y<sub><italic>n</italic>-1</sub>, y<sub><italic>n</italic>-2</sub>, … fragments (top), and distances to the peptide C-terminus correspond to b<sub><italic>n</italic>-1</sub>, b<sub><italic>n</italic>-2</sub>, … and y<sub>1</sub>, y<sub>2</sub>, … fragments (bottom). Distances for a/c and x/z fragments are interpreted equivalently, <bold>(c)</bold> Average explained intensity for neutral losses of the interpreted fragment ions.</p></caption><graphic xlink:href="EMS155701-f002"/></fig></floats-group></article>