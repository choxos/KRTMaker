<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157681</article-id><article-id pub-id-type="doi">10.1101/2022.11.21.517443</article-id><article-id pub-id-type="archive">PPR575769</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>RE2DC: a robust and efficient 2D classifier with visualization for processing massive and heterogeneous cryo-EM data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Lin</surname><given-names>Hsin-Hung</given-names></name><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Wu</surname><given-names>Kuen-Phon</given-names></name><xref ref-type="aff" rid="A4">d</xref></contrib><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Ting-Li</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><xref ref-type="aff" rid="A3">c</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Tu</surname><given-names>I-Ping</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>a</label>Institute of Statistical Science, Academia Sinica, Taiwan</aff><aff id="A2"><label>b</label>Department of Applied Mathematics, National Sun Yat-sen University, Taiwan</aff><aff id="A3"><label>c</label>Institute of Chemistry, Academia Sinica, Taiwan</aff><aff id="A4"><label>d</label>Institute of Biological Chemistry, Academia Sinica, Taiwan</aff><author-notes><corresp id="CR1">
<label>*</label>Correspondence: <email>weihau@gate.sinica.edu.tw</email> (W.H.C.), <email>iping@stat.sinica.edu.tw</email> (I.P.T.).</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>27</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>25</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Despite the fact that single particle cryo-EM has become a powerful method of structural biology, processing cryo-EM images are challenging due to the low SNR, high-dimension and un-label nature of the data. Selecting the best subset of particle images relies on 2D classification—a process that involves iterative image alignment and clustering. This process, however, represents a major time sink, particularly when the data is massive or overly heterogeneous. Popular approaches to this process often trade its robustness for efficiency. Here, we introduced a new unsupervised 2D classification method termed RE2DC. It is built upon a highly efficient variant of <italic>γ</italic>-SUP, a robust statistical cryo-EM clustering algorithm resistant to the attractor effect. To develop this efficient variant, we employed a tree-based approximation to reduce the computation complexity from <italic>O</italic>(<italic>N</italic><sup>2</sup>) to <italic>O</italic>(<italic>N</italic>), with <italic>N</italic> as the number of images. In addition, we exploited t-SNE visualization to unveil the process of 2D classification. Our tests of RE2DC using various datasets demonstrate it is both robust and efficient, with the potential to reveal subtle structural intermediates. Using RE2DC to curate a dataset of sub-millions of COVID-19 spike particles picked from 3,511 movies only takes 8 hours, suggesting its capability of accelerating cryo-EM structural determination. Currently, RE2DC is available with both CPU and GPU versions, where the implementation only requires modest hardware resources.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Since the resolution revolution of cryogenic electron microscopy (cryo-EM) was ignited by advancement in direct detectors [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R3">3</xref>, <xref ref-type="bibr" rid="R4">4</xref>] and improved image analysis algorithms [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R7">7</xref>], this method has transformed the landscape of structural biology. The approach of single particle analysis (SPA) [<xref ref-type="bibr" rid="R8">8</xref>] allows structural determination without the need for crystals, yet produces high-resolution density maps (Coulomb potential maps) comparable to those from X-ray crystals [<xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R11">11</xref>] to support de novo atomic model building for proteins and protein-nucleic acid complexes. As SPA cryo-EM records images from structures co-existing in solution [<xref ref-type="bibr" rid="R12">12</xref>], it permits capturing the structural intermediates for understanding molecular mechanisms [<xref ref-type="bibr" rid="R13">13</xref>]. The incredible power of cryo-EM is highlighted by the timely delivery of the spike protein structure of SARS-CoV-2 at its emergence [<xref ref-type="bibr" rid="R14">14</xref>], followed by continually elucidating the structural variants from rapidly evolved strains during this global pandemic [<xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R16">16</xref>, <xref ref-type="bibr" rid="R17">17</xref>], all together revealing the mechanisms underlying infection and antibody escape. Nonetheless, because cryo-EM images are exceedingly noisy as they are recorded with low electron dose (10-40 <italic>e</italic><sup>−</sup>/Å<sup>2</sup>) due to biological molecules being sensitivity to high-energy electrons, 3D structural determination from cryo-EM images of biological molecules represents a challenging inverse problem, for which developing image analysis software with improved performance to streamline the processing [<xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>, <xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R25">25</xref>] continues to be a vibrant activity in the cryo-EM community.</p><p id="P3">Computing a 3D structure from single particle images of low signal-to-noise ratio (SNR) with unknown orientations is a challenging task. This task is achieved by a workflow that consists of multiple steps (<xref ref-type="fig" rid="F1">Figure 1</xref>) [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>, <xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R25">25</xref>]. A vital step in the workflow is to remove bad particles and non-particle contaminants/artifacts [<xref ref-type="bibr" rid="R26">26</xref>]. As the SNR of the particles is low, this step of particle cleaning relies on 2D classification in an unsupervised manner [<xref ref-type="bibr" rid="R8">8</xref>] (see <xref ref-type="fig" rid="F1">Figure 1</xref>), a process that clusters particles of similar view into a class to give an average image of high SNR with identifiable features [<xref ref-type="bibr" rid="R27">27</xref>]. Currently, 2D classification may represent a major time-sink in the workflow for massive data, which is exacerbated by the high degree of heterogeneity. Prior to particle clustering, particle images must be aligned with each other to minimize the variations due to their differences in translation and in-plane rotation. Unfortunately, aligning particle images of low SNR using cross-correlation between images does not guarantee that the highest score gives the correct solution for alignment or finds the most resembling partner. To handle this issue, a maximum likelihood approach was introduced [<xref ref-type="bibr" rid="R28">28</xref>, <xref ref-type="bibr" rid="R29">29</xref>, <xref ref-type="bibr" rid="R30">30</xref>] and then adopted by popular cryo-EM packages [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>]. This approach models each experimental image as derived from one of K representative images via in-plane rotation, translation, corrupted by microscope contrast transfer function (CTF) and noise. As a result, the 2D classification becomes a computationally demanding process that involves the tasks of enormous image alignment and solving optimization problem using expectation-maximization [<xref ref-type="bibr" rid="R30">30</xref>]. Although this likelihood-based approach has been proven powerful for solving high-resolution structures for difficult proteins due to extremely low SNR [<xref ref-type="bibr" rid="R31">31</xref>], its popularity was hindered by the need of accessing a large number of CPU cores, which was later alleviated by the advent of GPU-enabled parallelism [<xref ref-type="bibr" rid="R20">20</xref>]. Even so, using likelihood-based 2D classification accelerated by GPU to curate a dataset that contains sub-millions of particles may still take several days [<xref ref-type="bibr" rid="R32">32</xref>].</p><p id="P4">In addition to particle cleaning, 2D classification serves other functions, including exploring the heterogeneity of a dataset—this heterogeneity stems from particle orientations, conformations, compositions, and their combinations. It is well-known that any likelihood approach inevitably suffers from the attractor effect of “rich getting richer and poor getting poorer” [<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R33">33</xref>] due to experimental images producing higher correlation scores with those class averages of large-sized classes that exhibit high SNR. As a result, applying a likelihood approach to highly heterogeneous datasets might not give a satisfactory outcome. To date, a better 2D classification method for heterogeneous data is represented by “iterative and stable alignment and clustering” (ISAC) [<xref ref-type="bibr" rid="R34">34</xref>], which is now integrated into the SPHIRE package [<xref ref-type="bibr" rid="R35">35</xref>], and recently tested to be compatible with other packages [<xref ref-type="bibr" rid="R36">36</xref>] with the aid of the SCIPION [<xref ref-type="bibr" rid="R19">19</xref>]. ISAC circumvents the above-mentioned class imbalance issue rooted in K-means clustering by “equalizing” the size of each class, and thereby more sensitive to data heterogeneity, and thereby more sensitive to data heterogeneity. Although ISAC uses cross-correlation scores to determine the best alignment, it manages to offer highly reliable outcome by eliminating impurities/outliers in each class using repeated reference-free alignment to validate each image member, which is extremely time-consuming. Thus, in this age of speed, ISAC is deemed best for ab initio or exploratory data analysis [<xref ref-type="bibr" rid="R37">37</xref>].</p><p id="P5">Here, we introduced RE2DC, a new 2D classification method that is robust and efficient. We chose <italic>γ</italic>–SUP clustering algorithm [<xref ref-type="bibr" rid="R38">38</xref>] to build RE2DC because it is proven to be highly robust against noise or outliers, with particular strengths in resisting the attractor effect rooted in K-means clustering [<xref ref-type="bibr" rid="R38">38</xref>]. However, the original <italic>γ</italic>–SUP is impractical for clustering a large number of images (<italic>N</italic> &gt; 10<sup>4</sup>) because its computation complexity for calculating the pairwise weight matrix scales quadratically in <italic>N</italic>, the number of data points (particle images). Another shortcoming of <italic>γ</italic>–SUP is that it requires human intervention for choosing a good hyper-parameter, which is critical for determining the number of clusters. In the present work, we eliminated those drawbacks by major algorithmic development with novel solutions. In brief, we constructed a sparse approximation for the weight matrix of <italic>γ</italic>–SUP by employing the well-known k-d-tree method (see <xref ref-type="sec" rid="S10">Methods</xref>). This has decreased the computation complexity for calculating the pairwise weight matrix from <italic>O</italic>(<italic>N</italic><sup>2</sup>) to <italic>O</italic>(<italic>N</italic>log(<italic>N</italic>)) [<xref ref-type="bibr" rid="R39">39</xref>] or even to <italic>O</italic>(<italic>N</italic>). Next, we devised a data-driven approach for automating the selection of the best hyper-parameter. As for image alignment, we adopted multi-reference-alignment (MRA) [<xref ref-type="bibr" rid="R27">27</xref>, <xref ref-type="bibr" rid="R31">31</xref>] with the introduction of a rapid dimension reduction (DR) termed 2SDR [<xref ref-type="bibr" rid="R40">40</xref>, <xref ref-type="bibr" rid="R41">41</xref>] to de-noise cryo-EM images prior to alignment. This de-noising approach has greatly improved the accuracy of noisy image alignment, which in turn leads to a significant reduction of the number of iterations required for current 2D classification methods [<xref ref-type="bibr" rid="R36">36</xref>]. As MRA can be enabled by GPU iterations required [<xref ref-type="bibr" rid="R42">42</xref>], we compared the time on RE2DC with and without GPU. Finally, as the main purpose of 2D classification is to curate a particle set, it is unnecessary to merge all images of similar views into one class. We then relaxed this constraint imposed by current 2D class methods and introduced a distributed computation strategy. This strategy that divides a large dataset into several smaller datasets for separate classification in parallel further speeded up RE2DC. Notably, to unveil the black box of 2D classification, we sought to track particle clustering in high-dimension during 2D classification [<xref ref-type="bibr" rid="R43">43</xref>]. To do so, we here, for the first time, employed a popular embedding tool of t-SNE [<xref ref-type="bibr" rid="R44">44</xref>, <xref ref-type="bibr" rid="R45">45</xref>] for visualizing the clusters in two dimensions since t-SNE embedding can preserve the relationships in high-dimension (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P6">To test RE2DC, we used various experimental single-particle cryo-EM sets, including five representative datasets from the public domain and our own dataset of glutamine synthetase (GS) (see the review of [<xref ref-type="bibr" rid="R46">46</xref>]). By benchmarking against ISAC, we first demonstrated RE2DC is indeed robust. We then explored whether or not GS could exist in oligomeric configuration other than dodecamer—RE2DC uncovered a peculiar oligomer that was missed by the current methods. We further tested the efficiency of RE2DC using large datasets (<italic>N</italic> &gt; 10<sup>5</sup> particles). For a curated dataset of 80S ribosome (<italic>N</italic> ~ 10<sup>5</sup>) <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10028/"><styled-content style="color:#EC00A7">[EMPIAR-10028]</styled-content></ext-link>, RE2DC finished the task in approximately 2 hours, whereas RELION took a much longer time. Similar strengths of RE2DC were observed for two more challenging datasets—non-curated TRPV channels (<italic>N</italic> ~ 0.8 × 10<sup>5</sup>) <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10005/"><styled-content style="color:#EC00A7">[EMPIAR-10005]</styled-content></ext-link> and TRPV channels in nanodisc (<italic>N</italic> ~ 2 × 10<sup>5</sup>) <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10059/"><styled-content style="color:#EC00A7">[EMPIAR-10059]</styled-content></ext-link>. Finally, curating sub-millions of COVID-19 spike particles (<italic>N</italic> ~ 4 × 10<sup>5</sup>) we picked from 3,511 movies <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10514/"><styled-content style="color:#EC00A7">[EMPIAR-10514]</styled-content></ext-link> [<xref ref-type="bibr" rid="R14">14</xref>] took RE2DC approximately 8 hours, demonstrating its processing capability for a massive dataset that can now be obtained in one day using high-throughput collection [<xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R47">47</xref>, <xref ref-type="bibr" rid="R48">48</xref>, <xref ref-type="bibr" rid="R49">49</xref>]. By using SCIPION [<xref ref-type="bibr" rid="R19">19</xref>] to couple RE2DC with 3D reconstruction algorithm from other packages, we showed those particles from RE2DC produced a high-quality density map with resolution comparable to the original work [<xref ref-type="bibr" rid="R14">14</xref>] (both &lt; 3.5Å). In summary, our findings demonstrate RE2DC is a robust and efficient 2D classifier with particular strength in uncovering subtle structural variations.</p></sec><sec id="S2" sec-type="results | discussion"><title>Results and Discussion</title><sec id="S3"><title>New <italic>γ</italic>-SUP variants reduce the issue of computation complexity associated with a large number of images</title><p id="P7">To build the clustering algorithm of RE2DC, we have introduced variants of <italic>γ</italic>-SUP. This new <italic>γ</italic>-SUP uses k-nearest neighbor (knn) to approximate the weight matrix. As shown in <xref ref-type="fig" rid="F1">Figure 1(b)</xref>, the computation time of this knn <italic>γ</italic>-SUP and its advanced derivative called dynamic <italic>γ</italic>-SUP scale up linearly with the number of images, contrasted to the quadratic dependence of image number in the original <italic>γ</italic>-SUP.</p></sec><sec id="S4"><title>Test on 70S ribosome particles highlights the robustness of RE2DC</title><p id="P8">To test whether or not the new <italic>γ</italic>-SUP algorithm preserves the robustness of the original <italic>γ</italic>-SUP, we employed the same E. coli 70S ribosome dataset and compared its performance against that of ISAC [<xref ref-type="bibr" rid="R34">34</xref>] since it is a 2D classification approach well-known for its robustness. This set of 5,000 particles, windowed from CCD micrographs by Joachim Frank’s lab prior to the cryo-EM revolution, was used by the early version of RELION for tutorial purposes. It is the first half of the 10,000 hand-picked particles composed of two half sets, each with a unique conformation. To unveil the clustering process, we employed t-SNE visualization [<xref ref-type="bibr" rid="R44">44</xref>, <xref ref-type="bibr" rid="R45">45</xref>] to monitor inter-particle distances resulting from each iteration of 2D classification (<xref ref-type="fig" rid="F1">Figure 1(c)</xref>). This visualization approach allows us to find that the clustering pattern of RE2DC has remained nearly unchanged after three iterations (<xref ref-type="fig" rid="F1">Figure 1(c)</xref>). This notion that stable results are achieved with a minimal number of iterations is consistent with the fact that the number of harvested particles has reached a peak after three iterations. Noticeably, RE2DC generates 27 good classes for this 70S dataset (<xref ref-type="fig" rid="F2">Figure 2(b)</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>), similar to that previously reported by the original <italic>γ</italic>-SUP [<xref ref-type="bibr" rid="R38">38</xref>].</p><p id="P9">For ISAC, it took many more iterations to converge. As summarized by <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>, ISAC reports a total of 29 stable classes for this 70S ribosome dataset, similar to that from RE2DC. The t-SNE plot for the ISAC particles (blue dots in <xref ref-type="fig" rid="F2">Figure 2(a)</xref>) reveals an interesting pattern. Unlike the RE2DC particles that segregate into well-dispersed islands (<xref ref-type="fig" rid="F2">Figure 2(a)</xref>), a large fraction of particles is aggregated as a core in the center, surrounded by small satellite clusters with similar size in the peripheral. Nearly 60% (18 out of 29) of the stable ISAC classes (red dots in <xref ref-type="fig" rid="F2">Figure 2(a)</xref>) correspond well to those off-center satellite clusters, whereas the remainder classes to the clusters located in the outer rim of the core. For those core-related ISAC classes, the class averages seem to be more blurred, as exemplified by the one in the lower-left corner in <xref ref-type="fig" rid="F2">Figure 2(a)</xref>, indicative of potential unresolved heterogeneity. Indeed, closer inspection reveals that almost every stable ISAC class contains impurity, as evidenced by that small numbers of red dots assigned to the same class by ISAC are scattered afar from those clusters (<xref ref-type="fig" rid="F2">Figure 2(a)</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>), a minor imperfection of ISAC previously unknown until the present diagnosis using t-SNE visualization.</p><p id="P10">By contrast, the stable RE2DC classes are virtually without impurities (red dots in <xref ref-type="fig" rid="F2">Figure 2(b)</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). Besides, the size RE2DC classes exhibit a wide range in distribution as revealed on the t-SNE plot, which we believe to better reflect the experimental reality than the equal size scenario [<xref ref-type="bibr" rid="R33">33</xref>]. Those findings have established that RE2DC is indeed a robust classification method where decent results can be obtained with a minimal number of iterations. Of note, RE2DC gives the highest particle yields (~ 92%) as compared to RELION (~ 84%) and ISAC (~ 76%). It is noted that a large fraction of good particles are rejected by ISAC due to being taken at lower defocus as previously found [<xref ref-type="bibr" rid="R36">36</xref>].</p></sec><sec id="S5"><title>RE2DC reveals assembly intermediates of glutamine synthetase in solution</title><p id="P11">Having established that RE2DC is a robust 2D classification method, we employed it to explore a cryo-EM data of E. coli glutamine synthetase (GS) [<xref ref-type="bibr" rid="R46">46</xref>]. GS is a ubiquitous enzyme found in all organisms. This enzyme catalyzes the condensation of glutamate and ammonia to form glutamine at the expense of ATP, and it can be organized in different types of quaternary structures: dodecameric (mostly found in prokaryotes); octameric or dodecameric (mostly located in eukaryotes), and hexameric (also found in prokaryotes) [<xref ref-type="bibr" rid="R46">46</xref>]. The structure of GS from several organisms except E. coli has been determined to atomic resolution using X-ray crystallography, where the asymmetric unit has been found to be a dodecamer built by two back-to-back hexameric rings. An early negative electron microscopy study revealed that E. coli GS could exist as dodecamer or helical tubes, with the organization sensitive to pH or divalent ions [<xref ref-type="bibr" rid="R50">50</xref>]. To pave the way for elucidating subunit-subunit interactions of E. coli GS, we embarked on a cryo-EM approach using conditions that favored dodecamer. We then collected a cryo-EM dataset of E. coli GS using our Titan Krios cryo-EM. This dataset containing 94,154 particles was 2D classified using different approaches, including RE2DC, RELION and ISAC. Remarkably, all three different approaches (<xref ref-type="fig" rid="F3">Figure 3</xref>) generated a number of high-quality top views and a side view corresponding to the back-to-back hexameric rings, indicating the tendency of E.coli GS in adopting preferred orientations in air-water interface. Those top views revealed variations of E coli GS in terms of compositions, including dodecamer, and other kinds of oligomers with fewer subunits, which may reflect assembly intermediates toward the dodecamer. This surprising finding may explain why E. coli GS is refractory to form good crystals for X-ray diffraction.</p><p id="P12">Remarkably, a comparison of the 2D classes from RE2DC (<xref ref-type="fig" rid="F3">Figure 3(a)</xref>) against those of RELION (<xref ref-type="fig" rid="F3">Figure 3(b)</xref>) or ISAC (<xref ref-type="fig" rid="F3">Figure 3(c)</xref>) shows that RE2DC identified a peculiar form missed by RELION or ISAC. This peculiar form of crescent shape seems to correspond to an octamer. For those RE2DC classes (upper panel in <xref ref-type="fig" rid="F3">Figure 3(a)</xref>), we located the corresponding clusters on the t-SNE plot (<xref ref-type="fig" rid="F1">Figure 1(a)</xref>); it is noted that the peculiar form is located in the center of the t-SNE plot, denoted by No. 3. We hypothesized that RELION might also be able to reveal this form when larger prescribed number of classes was used to mitigate the attractor effect. To maximize the potential of RELION for sorting out heterogeneity in this dataset, we gradually increased the prescribed number from 50 to 200 with a step of 50. As the number of 150 was used (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>), RELION was indeed able to reveal this peculiar form of crescent shape, which was hidden when more popular parameters such as 50 or 100 were used (<xref ref-type="fig" rid="F3">Figure 3(b)</xref>). This line of study attests that differentiating subtle structural variation in a heterogeneous dataset generally entails the use of a large number of class. Compared to these conventional 2D classification approaches, RE2DC does not require a user to specify this parameter as it is automatically determined by a data-driven approach. This unexpected finding suggests RE2DC and like approaches can serve as an ideal tool for discovering structural intermediates in vast classes of data in the absence of prior knowledge.</p></sec><sec id="S6"><title>RE2DC with random partition classifies a large 80S ribosome dataset into a large number of homogenous classes in two hours</title><p id="P13">To test the efficiency of RE2DC on large datasets, we first tested a highly curated 80S ribosome dataset from Scheres’s lab [<xref ref-type="bibr" rid="R51">51</xref>], provided as a <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10028/"><styled-content style="color:#EC00A7">RELION Benchmark example</styled-content></ext-link> (accession number <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10028/"><styled-content style="color:#EC00A7">EMPIAR-10028</styled-content></ext-link>). This dataset that contains a total of 105,247 excellent particle images with 360 × 360 pixels of 1.34 Å, was used for demonstrating RELION [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R5">5</xref>] in reaching 3 Å at the dawn of resolution revolution, thus suitable for testing whether or not a different package has similar capability [<xref ref-type="bibr" rid="R36">36</xref>]. Drugged with an antibiotic molecule [<xref ref-type="bibr" rid="R51">51</xref>], this 80S ribosome does not exhibit significant movement between the 60S and 40S subunits. As a result, the major source of data heterogeneity is associated with the diversity in particle orientations. Our previous work of 3D reconstruction from those particles indicated the particle orientations were evenly distributed in the angular space [<xref ref-type="bibr" rid="R36">36</xref>], which is also reflected by the large number of stable classes (520) generated by ISAC with the size limit of each class set to 200 (see [<xref ref-type="bibr" rid="R36">36</xref>] and <xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>). Since this 80S dataset is already highly curated, a good classification algorithm should give a high particle yield close to 100%. Indeed, RELION (one passage) gives 97% whereas ISAC gives 98% (<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>). It is noted that conventional ISAC that relies on CPU hardware consumes 124 hours for the task of 2D classification. In this work, we also tested the newly released GPU-enabled ISAC and surprisingly found that it only took 14 hours, comparable to RELION [<xref ref-type="bibr" rid="R36">36</xref>].</p><p id="P14">With those figures of merits of current algorithms in mind, we went on to test RE2DC on this 80S ribosome dataset. To this end, we introduced a partition scheme where we set the size per partition to 5,000. Strikingly, RE2DC automatically generated 514 homogeneous classes (<xref ref-type="fig" rid="F4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4(c)</xref>) with a particle yield of 97% (<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>). The plethora of class averages resulting from RE2DC reflecting a large number of different views indicated RE2DC results could be used for generating a high-quality ab initio 3D reconstruction [<xref ref-type="bibr" rid="R36">36</xref>]. Remarkably, CPU-based RE2DC took only 2.5 hours with whereas the time is further reduced to 2 hours when a GPU-based algorithm was used (<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>). Those results clearly demonstrate RE2DC champions in its efficiency without compromising its robustness.</p></sec><sec id="S7"><title>RE2DC classifies large non-curated large TRPV datasets less than four hours</title><p id="P15">Next, we tested RE2DC on non-curated membrane protein datasets, which are considered to be much more challenging for 2D classification. We first tested a famous TRPV dataset [<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10005/"><styled-content style="color:#EC00A7">EMPIAR-10005</styled-content></ext-link>] from Yifan Cheng and David Julius [<xref ref-type="bibr" rid="R52">52</xref>]. This dataset contains a total of 88,915 particle images with 256 × 256 pixels of 1.2 Å, where the subset selected by the authors using extensive 2D and 3D classification was used to derive a first near-atomic resolution TRPV structure (3.4 Å) at the dawn of resolution revolution. While RELION spent 16 hours and harvested 57% particles, and ISAC spent 55 hours and obtained a similar yield, RE2DC only spent less than 2 hours and harvested 67% particles (<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>). We further tested a dataset of ligand-bound TRPV embedded in nanodisc [<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10059/"><styled-content style="color:#EC00A7">EMPIAR-10059</styled-content></ext-link>], also provided Yifan Cheng and David Julius [<xref ref-type="bibr" rid="R53">53</xref>]. This dataset contains a total of 218,787 particle images with 192 ×192 pixels of 1.2 Å. This dataset is much more heterogeneous due to the nanodisc density surrounding the channel, but was used to extend the resolution of TRPV cryo-EM structure to sub-3Å. Again, RE2DC spent the least amount of time (3.86 hours with CPU, or 3.3 hours with GPU) compared to more than 10 hours for RELION or ISAC, and gives the highest particle yield (73%)(<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="table" rid="T2">Table 2</xref>), virtually twice the size of the subset selected by the authors using tedious 2D and 3D classification. Importantly, a 3D structure with 2.9 Å was obtained from the harvested particles. Those results show that for non-curated datasets only one pass of 2D classification is required for RE2DC, and again RE2DC is much faster than the popular method.</p></sec><sec id="S8"><title>RE2DC enables timely structural determination for COVID-19 spike protein</title><p id="P16">This RE2DC algorithm, together with tests on those famous datasets, was completed prior to the breakout of COVID-19. Due to the fact that single particle cryo-EM is without the need for crystallization, it has been employed to deliver the structure of COVID-19 spike protein almost immediately after its emergence [<xref ref-type="bibr" rid="R14">14</xref>]. However, during the three years of this global pandemic, the strain of COVID-19 has kept evolving with the changing of the sequence of the spike protein. Keeping up with the protein structures of a new COVID-19 strain is of extreme importance for understanding its pathological mechanisms and providing a rationale for the development of neutralizing antibodies. We then wondered whether or not RE2DC can be used for accelerating the structural research of COVID-19 proteins. To this end, we obtained 3,511 cryo-EM movies that contained images of the spike protein stabilized spike in the pre-fusion state, which was recently deposited by the Houston group [<xref ref-type="bibr" rid="R14">14</xref>] [<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10514/"><styled-content style="color:#EC00A7">EMPIAR-10514</styled-content></ext-link>]. It is noted that this amount of movies can now be collected within 8 to 10 hours with a cryo-EM instrument operated in a high-throughput mode [<xref ref-type="bibr" rid="R47">47</xref>, <xref ref-type="bibr" rid="R48">48</xref>, <xref ref-type="bibr" rid="R49">49</xref>]. We performed motion correction on the movies to obtain 3,511 micrographs and used crYOLO [<xref ref-type="bibr" rid="R23">23</xref>] to automatically pick 375,076 particles representing the largest set in this study. For this dataset, we only compared RE2DC with RELION. Seeing that this dataset may contain a high degree of heterogeneity due to subtle conformation states or high levels of glycosylation [<xref ref-type="bibr" rid="R15">15</xref>], we set the prescribed class number for RELION to be 500 in order to avoid the necessity of doing multiple rounds of classification as in the case when a small class number is used. RELION and RE2DC sifted a similar number of particles where the particle yields are similar, 63% (235,300 particles) from RELION and 59% (221,916 particles) from RE2DC. However, RELION seems to capture top views more often, whereas the RE2DC results are more balanced between top and side views. Besides, the 2D class averages from RE2DC are better centered and exhibit more details (<xref ref-type="fig" rid="F6">Figure 6</xref>). Remarkably, the computation time is drastically different—for RELION, it was 50.21 hours; whereas for RE2DC, also with GPU acceleration, it was only 7.76 hours. This finding suggests usage of RE2DC with a current workflow (<xref ref-type="fig" rid="F1">Figure 1</xref>) may permit the revelation of the density map of COVID-19 spike protein on the day of cryo-EM data collection. Furthermore, we perceive that, with on-the-fly usage of RE2DC, realizing robust real-time single cryo-EM structural determination is possible.</p></sec></sec><sec id="S9" sec-type="conclusions"><title>Conclusions</title><p id="P17">Here, we have successfully developed a new unsupervised 2D classification method called RE2DC for processing single particle cryo-EM data. Our tests using various datasets have demonstrated RE2DC is a robust and efficient tool that can be widely used, especially useful when the data is massive or highly heterogeneous. Of note, RE2DC has particular strengths in discovering rare structural intermediates. RE2DC can be implemented with modest computation resources and easily integrated with any cryo-EM package.</p></sec><sec id="S10" sec-type="methods"><title>Methods</title><p id="P18">To cope with those issues of current 2D classification regarding robustness or efficiency, we introduced a new 2D classification tool, termed RE2DC, which stands for robust and efficient 2D classification. As a 2D classification algorithm consists of sub-algorithms of image alignment and clustering [<xref ref-type="bibr" rid="R34">34</xref>], a robust and efficient classification method demands its sub-algorithms to be also robust and efficient. With this in mind, we first developed a clustering algorithm that is both robust and efficient. We employed <italic>γ</italic>-SUP clustering algorithm as the cornerstone [<xref ref-type="bibr" rid="R38">38</xref>] because of its robustness [<xref ref-type="bibr" rid="R38">38</xref>], with the promise of eliminating the issues of current classification methods stemming from K-means clustering. However, the computation costs of original <italic>γ</italic>–SUP prevented it from being useful when a large number of particles are encountered (<italic>N</italic> &gt; 10<sup>4</sup>) — its computation complexity for calculating the pairwise weight matrix scales quadratically with <italic>N</italic>, the number of data points (particle images). In practice, <italic>γ</italic>-SUP has another shortcoming—it requires human intervention for choosing a good hyper-parameter, which is critical for determining the number of clusters and the route of data points approaching their destiny clusters. In the present work, we provided novel solutions to eliminate these drawbacks, and obtained an efficient and automated version of <italic>γ</italic>-SUP. First, noticing that the weight matrix of <italic>γ</italic>-SUP is highly sparse, we constructed a sparse approximation for it by employing the well-known k-d-tree method. The usage of this approximation appears to have successfully decreased the computation complexity for calculating the pairwise weight matrix from <italic>O</italic>(<italic>N</italic><sup>2</sup>) to <italic>O</italic>(<italic>N</italic>). Secondly, to automate the selection of an optimal hyper-parameter, we devised a data-driven approach that screened over a wide range to search for an estimate that maximized a target function—e.g., the number of reasonable-sized clusters. The search is expedited by a highly efficient two-stage procedure. As for the sub-algorithm for image alignment, we adopted a straightforward approach based on multi-reference-alignment (MRA) framework [<xref ref-type="bibr" rid="R27">27</xref>, <xref ref-type="bibr" rid="R31">31</xref>] with the reference images directly generated from the data and then used for initiating the alignment process. As this framework utilizes cross-correlation scores for image alignment, the outcome will not be reliable when image SNR is too low [<xref ref-type="bibr" rid="R29">29</xref>]. To overcome this issue, we introduced dimension reduction MRA (DRMRA), where we used a rapid dimension reduction method (2SDR) [<xref ref-type="bibr" rid="R40">40</xref>, <xref ref-type="bibr" rid="R41">41</xref>] to de-noise cryo-EM images. This 2SDR strategy has been demonstrated to improve the accuracy of image alignment, which in turn leads to a significant reduction of the number of iterations required for current 2D classification methods [<xref ref-type="bibr" rid="R36">36</xref>]. Since the open-source code for GPU-accelerated MRA is available [<xref ref-type="bibr" rid="R42">42</xref>], we used it to make a GPU version of RE2DC. Finally, we introduced a distributed computation strategy that divided a large dataset into several smaller datasets to classify them separately and in parallel, which further speeded up RE2DC.</p><sec id="S11"><title>Dimension Reduction Multi-reference Alignment (DRMRA)</title><p id="P19">In this section, we elaborate on the algorithm of dimension reduction MRA (DRMRA). PCA methods or the extension have been popular for dimension reduction. PCA was introduced for processing single particle negative-stained EM images in early days [<xref ref-type="bibr" rid="R54">54</xref>], which was pivotal to the development of single particle cryo-EM [<xref ref-type="bibr" rid="R8">8</xref>]. Unfortunately, PCA vectorization involved in dimension reduction has been found to render the eigen-space estimate an unstable and time-consuming process when the image size becomes large [<xref ref-type="bibr" rid="R55">55</xref>]. This inevitable caveat is inevitable hinders the pursuit of cryo-EM structure to high resolution for large-pixelated images. To tackle this problem, 2SDR [<xref ref-type="bibr" rid="R40">40</xref>, <xref ref-type="bibr" rid="R41">41</xref>] has been proposed recently. This approach utilizes a two-stage procedure for dimension reduction, thereby circumventing the need of image vectorization. Crucially, in the first stage, 2SDR preserves the tensor form of the data matrix, which avoids the vectorization process and estimates the two eigenvector sets in a much lower dimensional space from column and row space. The images are then projected onto the space spanned by the Kronecker product of these two eigenvector sets. In the second stage, the highly correlated features of the projected core tensor are then de-correlated by modeling it as a PCA model and further reducing its dimensionality. It has been shown that 2SDR lowers the computation complexity of traditional PCA by several orders of magnitude [<xref ref-type="bibr" rid="R40">40</xref>, <xref ref-type="bibr" rid="R41">41</xref>] and can be used to empower current cryo-EM algorithm in the context of experimental images [<xref ref-type="bibr" rid="R36">36</xref>]. The hybrid PCA model associated with 2SDR and a consistent rank selection method is discussed in [<xref ref-type="bibr" rid="R41">41</xref>]. The hybrid PCA model has been demonstrated to be a better approximation for cryo-EM images than the PCA model. It is noted that the reconstructions of 2SDR can also serve as an effective de-noising tool that can improve the contrast of the particle image. When combining 2SDR with reference-free alignment, a processing tool called PrePro was made [<xref ref-type="bibr" rid="R36">36</xref>]. This PrePro has been proven effective in improving the classification results and conferred a faster convergence rate [<xref ref-type="bibr" rid="R36">36</xref>] <sup><xref ref-type="fn" rid="FN1">1</xref></sup>. We therefore added 2SDR to MRA to create DRMRA by directly employing PrePro. As shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref>, by priming MRA with PrePro for initial alignment, we found the class averages became stable in the second iteration of RE2DC. By contrast, conventional MRA required many more iterations to converge. This phenomenon that de-noised particles can lead to improvement in aligning cryo-EM images has also been observed by other groups [<xref ref-type="bibr" rid="R57">57</xref>], with a completely different approach that resorted to AI.</p></sec><sec id="S12"><title>Transforming <italic>γ</italic>-SUP from a robust to robust and efficient clustering</title><p id="P20">Image clustering is primary for resolving different views and/or other types of heterogeneity in cryo-EM data. In a non-curated cryo-EM dataset, there always exist non-particle artifacts. As non-particles should not be aligned well with particles, a good algorithm with the capability of labeling misaligned images as outliers can be used to identify those non-particles. In addition, when separating different projections or conformations into clusters becomes a primary interest, a large number of classes are desired. Considering those aspects, <italic>γ</italic>-SUP is an ideal clustering algorithm to suit a dataset that potentially contains a large number of clusters or is contaminated with noise or outliers. Previously, <italic>γ</italic>-SUP applied to simulated cryo-EM datasets demonstrated this clustering method conferrer higher accuracy in identifying misaligned outliers over existing methods, attesting it is a much more robust clustering algorithm than current algorithms [<xref ref-type="bibr" rid="R38">38</xref>]. At a high level, <italic>γ</italic>-SUP models the data with the q-Gaussian mixture and employs the minimum <italic>γ</italic> -divergence [<xref ref-type="bibr" rid="R58">58</xref>] as the metric for similarity estimation. It then aims to obtain a numerical solution by adopting the self-updating procedure (SUP) [<xref ref-type="bibr" rid="R59">59</xref>]. In the updating process, each data point moves to a new position during the iterations. The new position depends on the influences the data point receives from other points. At the end of the process, every point reaches an equilibrium position and points that arrive at the same position are regarded to be in the same cluster. The influence force or weight can be written as: <inline-formula><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>exp</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>exp<sub>q</sub></italic> is the <italic>q</italic>-exponential function, <italic>τ</italic> and <italic>s</italic> are tuning parameters. Notably, <italic>γ</italic>-SUP eliminates the need to set random cluster centers for initializing the process because it treats each data point as a singleton cluster for initialization. In practice, <italic>γ</italic>-SUP is quite insensitive to <italic>s</italic>. Thus, only the scaling parameter <italic>τ</italic> is left to be tuned, where the tuning is needed for different datasets. Since the parameter <italic>τ</italic> is proportional to the influence region in the updating process, it ignores the influence of data outside a certain range determined by <italic>τ</italic>. In other words, <italic>τ</italic> determines how many points can be accommodated in the same cluster. For instance, as shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref>, when <italic>τ</italic> is small enough, there exists no influence between any two data points such that each point forms an individual cluster by itself. As <italic>τ</italic> increases, data points start to attract each other to form a cluster. For the original <italic>γ</italic> –SUP [<xref ref-type="bibr" rid="R38">38</xref>], an appropriate choice of <italic>τ</italic> can be made by inspecting the transition point in a plot as previously suggested [<xref ref-type="bibr" rid="R38">38</xref>]. However, in practice, the behavior of phase transition is not always clear that the accordingly selection of hyperparameters <italic>τ</italic> becomes difficult. In addition, when sample size n increases, the computation time that scales with the order of <italic>O</italic>(<italic>N</italic><sup>2</sup>) has prohibited the application of original <italic>γ</italic> –SUP to large datasets.</p><p id="P21">In order to deliver a practical clustering method based on <italic>γ</italic> –SUP for large datasets, we made several modifications to the original algorithm as follows. First, we observed the weight matrix for each sample point was sparse. This sparsity of the weight matrix is the inherent nature of <italic>γ</italic> –SUP due to the use of <italic>γ</italic> -divergence and the <italic>q</italic>-Gaussian, which sets a rejection bound. We then exploited this sparsity property by employing the k-nearest neighbor graph to approximate the weight matrix. This is achieved by building a space-partitioning tree for sample points at the beginning of each iteration [<xref ref-type="bibr" rid="R60">60</xref>]. This approach enables an efficient search for the nearest neighbor. The overall complexity can thus be reduced to <italic>O</italic>(<italic>N</italic> log(<italic>N</italic>)) or even <italic>O</italic>(<italic>N</italic>). Secondly, we incorporated dynamic-SUP [<xref ref-type="bibr" rid="R61">61</xref>] into the new clustering algorithm so as to let the number of neighbors grow with iteration. This approach, which allowed us to focus on the local structure at the beginning, indeed gave a better performance in practice. Finally, to select the exact <italic>τ</italic>, we devised a two-stage procedure for the search. In the first stage, binary search is utilized to find the region that gives non-trivial solutions. Next, we utilized grid search to scan this region to find the parameter that maximized a targeted function, for instance, particle yield, number of reasonable-size clusters, or combination of these terms.</p></sec><sec id="S13"><title>Using t-SNE visualization for diagnosis of 2D classification</title><p id="P22">Visualizing high-dimensional data in low dimensions has been recognized as an important problem in many scientific applications, for which numerous statistical tools have been developed. Those approaches include PCA, Multidimensional Scaling (MDS), and t-Distributed Stochastic Neighbor Embedding (t-SNE) [<xref ref-type="bibr" rid="R44">44</xref>]. As the history of methodology development is concerned, t-SNE is the first one that can successfully separate the famous MNIST dataset into 10 clusters. Since such success, t-SNE has been widely applied to exploring the heterogeneity of high-dimensional data with applications in diverse areas, including cancer biology and bioinformatics. 2D classification in cryo-EM is virtually treated as a black box for an end-user and it is hard to have an intuitive insight into the progress or the quality of classification results. Here, to unveil the black box, we introduced t-SNE to display high-dimension image data in low dimensions for visualizing the final 2D classification results and monitoring the progress of the classification. The t-SNE algorithm comprises two main stages. First, it transforms the similarity matrix into a probability distribution (e.g., Gaussian distribution and t-distribution) for both the input data of high dimension and the visualization in low dimension (usually 2 or 3). Secondly, it minimizes the Kullback–Leibler (KL) divergence between the two distributions by a gradient descent algorithm. In practice, under a suitable parameter setting, t-SNE can effectively preserve the high-level qualitative structures of the input data, such as clusters or groups of nearest neighbor [<xref ref-type="bibr" rid="R62">62</xref>]. Our implementation of t-SNE with RE2DC chose FFT-accelerated interpolation-based t-SNE [<xref ref-type="bibr" rid="R63">63</xref>] and utilized scaled PCA for its initialization [<xref ref-type="bibr" rid="R45">45</xref>]. We surprisingly found the t-SNE plot could be used to evaluate the quality of the classification results, as demonstrated in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>, in which red points denote the data points that are “considered” by the classification algorithm to belong to the same group. We can see that in the middle panel of <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>, some of the red points are scattered across the t-SNE plot, which indicates that the algorithm under our test groups together those data points that belong to different blobs. As a result, the corresponding class average becomes blurred. In contrast, in the right panel of <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>, the red points assigned by the algorithm are localized within the same blob. In this case, the corresponding class average shows more structural details.</p></sec><sec id="S14"><title>Accelerated alignment by GPU</title><p id="P23">It is noted that the calculation of similarities in the alignment step is independent of particles, 2D reference or orientation. It is thus possible to calculate them in parallel using GPU. In our algorithm, the reference-based alignment and the reference-free alignment in PrePro can be GPU-accelerated using the routines from Cryo-RALib [<xref ref-type="bibr" rid="R42">42</xref>].</p></sec><sec id="S15"><title>Implementing RE2DC sub-algorithms</title><p id="P24">RE2DC consists of two sub-algorithms, one for image alignment and the other for image clustering as shown in <xref ref-type="boxed-text" rid="BX1">Algorithm 1</xref> and <xref ref-type="boxed-text" rid="BX2">Algorithm 2</xref>. The sub-algorithm for alignment follows the general architecture of MRA, but with major advancements as follows. First, to implement DRMRA with 2SDR, we employed PrePro [<xref ref-type="bibr" rid="R36">36</xref>] as it uses 2SDR instead of PCA for dimension reduction to achieve fast dimension reduction. The PrePro was found to add insignificant overhead, but speed up the convergence [<xref ref-type="bibr" rid="R36">36</xref>]. It was shown that for most datasets pre-processed by PrePro, only three iterations are required by RELION or ISAC to achieve convergence. As for the sub-algorithm of image clustering, we used <italic>γ</italic>-SUP instead of K-means for clustering to avoid the shortcoming of clustering with popular classification methods that are largely rooted in K-means. In this development, we implemented and tested six versions of <italic>γ</italic>–SUP. These six versions are divided into two sets for test. The first set includes the original one [<xref ref-type="bibr" rid="R38">38</xref>], a new one with k-nearest neighbors (knn), which we term knn <italic>γ</italic> –SUP, and a variant of knn <italic>γ</italic> –SUP where k increases in each iteration, which we call ’dynamic knn <italic>γ</italic>–SUP’ (<xref ref-type="fig" rid="F1">Figure 1(b)</xref>). The three in the second set called <italic>γ</italic>–estimator [<xref ref-type="bibr" rid="R38">38</xref>], are the same as those in the first set, except that the sample points do not move in each iteration. The number of k is set to 50 in the knn version and set to 10 + <italic>j</italic> × 5 in the dynamic-knn at iteration <italic>j</italic>. The clustering performance of the advanced variants of <italic>γ</italic>-SUP surpasses the original one in greatly reducing the computation time, as shown in <xref ref-type="fig" rid="F1">Figure 1(b)</xref>. To combine DRMRA and a new <italic>γ</italic>–SUP iteratively, we decided not to feed too many references to perform the reference-based alignment. This way, the class assignment can be largely determined in the clustering stage. The class averages generated by the clustering step are further grouped by <italic>γ</italic>-SUP into a smaller set of class averages as references for the next round of image alignment. Furthermore, the class average that contains more than <italic>g<sub>l</sub></italic> or smaller than <italic>g<sub>s</sub></italic> will be screened out in the alignment step. This also has the benefit of speeding up the alignment step. Finally, the algorithm architecture of RE2DC is highly flexible. For instance, one can swap in those MRA used for maximum likelihood approach [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R33">33</xref>] or stochastic hill-climbing scheme [<xref ref-type="bibr" rid="R6">6</xref>].</p><boxed-text id="BX1" position="anchor" content-type="above"><label>Algorithm 1</label><caption><title>RE2DC</title></caption><p id="P25"> <bold>Input:</bold> Set of experiment images <italic>X</italic> with <italic>N</italic> particles and feature size <italic>p</italic></p><p id="P26">      Number of iteration <italic>J</italic></p><p id="P27">      Target dimension for 2SDR <italic>p</italic><sub>0</sub>, <italic>q</italic><sub>0</sub>, <italic>r</italic></p><p id="P28">      Number of particles per-partition <italic>n</italic></p><p id="P29">      Number of reference for global alignment <italic>m</italic></p><p id="P30">      The size of largest/smallest cluster <italic>g<sub>l</sub></italic>/<italic>g<sub>s</sub></italic></p><p id="P31"> <bold>Output:</bold> Set of class averages <italic>C</italic></p><p id="P32">1 Applying PrePro on <italic>X</italic>.</p><p id="P33">2 iteration = 0. <bold>repeat</bold></p><p id="P34">3    iteration = iteration +1.</p><p id="P35">4    Reduce the dimension of <italic>X</italic> from <italic>p</italic> to <italic>r</italic> using 2SDR to obtain <italic>X<sub>r</sub></italic>.</p><p id="P36">5    Random partition <italic>X<sub>r</sub></italic> into <italic>I</italic> = <italic>N</italic>/<italic>n</italic> partitions to obtain <inline-formula><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p id="P37">6    Make the t-SNE plot of <inline-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and label each cluster.</p><p id="P38">7    <bold>for</bold> <italic>each partition</italic> <bold>do</bold></p><p id="P39">8    Cluster <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> using modified <italic>γ</italic>-SUP (<xref ref-type="boxed-text" rid="BX2">Algorithm 2</xref>).</p><p id="P40">9    Take averages of each cluster and discard the cluster with a size smaller than <italic>g<sub>s</sub></italic>.</p><p id="P41">10   <bold>if</bold> <italic>convergence</italic> <bold>then</bold></p><p id="P42">11    Break.</p><p id="P43">12   <bold>else</bold></p><p id="P44">13    <bold>if</bold> <italic>iteration</italic> ≠ <italic>J</italic> <bold>then</bold></p><p id="P45">14      Discard the class averages with cluster size larger than <italic>g<sub>l</sub></italic>. Combine the class</p><p id="P46">       averages from all partitions into <italic>k</italic> class averages using <italic>γ</italic>-SUP.</p><p id="P47">15    <italic>X</italic> is aligned to the combined <italic>m</italic> class averages through reference-based alignment to</p><p id="P48">     obtain orientation parameters.</p><p id="P49">16    Orientation parameters are applied to <italic>X</italic>.</p><p id="P50">17 <bold>until</bold> <italic>iteration</italic> = <italic>J</italic>;</p><p id="P51">18 (Optional) Split the cluster with a sizes larger than <italic>g<sub>l</sub></italic> using <italic>k</italic>-means.</p><p id="P52">19 Take the class averages of each cluster to obtain <italic>C</italic>.</p><p id="P53">20 Return <italic>C</italic></p></boxed-text><boxed-text id="BX2" position="anchor" content-type="above"><label>Algorithm 2</label><caption><title>Modified <italic>γ</italic>-SUP</title></caption><p id="P54"> <bold>Input:</bold> Set of experiment images <italic>X</italic> with <italic>n</italic> particles and feature size <italic>r</italic></p><p id="P55">      Tuning parameter <italic>s</italic>, <italic>τ</italic></p><p id="P56">      Number of neighbors <italic>k</italic></p><p id="P57"> <bold>Output:</bold> Set of clusters <italic>τμ</italic></p><p id="P58">1 iteration = 0.</p><p id="P59">2 Start with <italic>μ<sub>i</sub></italic> = <italic>X<sub>i</sub></italic>/<italic>τ</italic>, <italic>i</italic> = 1, …, <italic>n</italic>.</p><p id="P60">3 <bold>repeat</bold></p><p id="P61">4  tree = construct-Tree(<italic>μ</italic>).</p><p id="P62">5  <bold>for</bold> <italic>i</italic> = 1 : <italic>n</italic> <bold>do</bold></p><p id="P63">6     <italic>NN</italic> = tree.nearestNeighbors(<italic>μ<sub>i</sub></italic>).</p><p id="P64">7     <italic>w<sub>ij</sub></italic> = <italic>exp</italic><sub>1−<italic>s</italic></sub>(−|<italic>μ<sub>i</sub></italic> − <italic>μ<sub>j</sub></italic>|<sup>2</sup>), <italic>j</italic> ∈ <italic>NN</italic>.</p><p id="P65">8    <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula></p><p id="P66">9  <italic>μ<sub>i</sub></italic> = <italic>z<sub>i</sub></italic>, <italic>i</italic> = 1, …, <italic>n</italic>.</p><p id="P67">10   iteration = iteration +1.</p><p id="P68">11 <bold>until</bold> <italic>Convergence</italic>;</p><p id="P69">12 Return <italic>τμ</italic>.</p></boxed-text></sec><sec id="S16"><title>Random partition</title><p id="P70">We used random partition to partition a large dataset is used at the start of each iteration to reduce the computation time through parallelization. We found this scheme also improves the classification performance other than saving time. In practice, we suggest to set number of particles per-partition <italic>n</italic> to 5000, number of references <italic>m</italic> to 20, and the threshold of group size to <italic>g<sub>l</sub></italic> = 1000, <italic>g<sub>s</sub></italic> = 15, respectively. Moreover, we set the default iteration number to 3 for the convergence criterion and further validated this through the t-SNE plot. In a typical scenario, one can use a strategy without partitioning the data but instead setting the g<sub>s</sub> to a small number. This should allow the removal of apparent non-particles. In other scenarios, one can adjust the <italic>τ</italic>, <italic>g<sub>s</sub></italic> and the number of particles per partition. This may allow the user to inspect subtle structural variations within clusters to analyze the potential heterogeneity hidden within the dataset.</p></sec><sec id="S17"><title>Pre-treatment of the data prior to RE2DC</title><p id="P71">Considering the contrast transfer function (CTF), a user has an option to choose whether or not to correct it prior to the classification. For example, when RE2DC is implemented on SCIPION, one can choose to apply “phase flipping” to particle images before the classification as commonly performed before popular classification algorithms. Like most of MRA-based algorithms, we down-sampled images with large box size. Therefore, noise could be further reduced from the data, but high-resolution information will be removed as well so that fine details may not be evident in the class averages generated by RE2DC. If loss of details has rendered the distinction between particles and invalid particles harder, we provide an option to generate the class averages using the members in the original dataset, which is not down-sampled, while using the alignment parameters estimated based on the down-sampled images. If one is still concerned about the quality of the class averages from RE2DC, we have tested the possibility of enhancement by CTF correction and local 2D refinement using the CTF-correction module available from other packages such as SPHIRE [<xref ref-type="bibr" rid="R35">35</xref>]. The class averages can be further enhanced by adjusting their power spectrum using the procedure previously described by Penczek [<xref ref-type="bibr" rid="R64">64</xref>]. Those options will further render RE2DC to meet the demand from more difficult datasets when fine details matter.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS157681-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d168aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S18"><title>Acknowledgments</title><p>This work was supported by Academia Sinica Grants [AS-GCS-108-08] and [AS-IA-110-M05] to I-P.T.; Academia Sinica SUMMIT Projects [AS-SUMMIT-107], [AS-SUMMIT-108], [AS-SUMMIT-109] to W.-H.C.; and by the Ministry of Science and Technology Taiwan [MOST 106-2118-M-001-001-MY2] to I-P.T.; [MOST 106-2321-B-001-050-MY3] to K.-P.W.; and [MOST 110-2118-M-110-003-MY2] to S.-Z.C.. The authors are thankful for the excellent support from the Academia Sinica Cryo-EM Center [AS-CFII-108-110] for cryo-EM data collection.</p></ack><sec sec-type="data-availability" id="S19"><title>Code availability</title><p id="P72">The code will be available upon request once this manuscript is published in a peer-reviewed journal.</p></sec><fn-group><fn id="FN1"><label>1</label><p id="P73">The fact that better initial can improve the alignment results or speed up the classification has also been observed in [<xref ref-type="bibr" rid="R56">56</xref>]</p></fn><fn id="FN2" fn-type="con"><p id="P74"><bold>Author contributions</bold></p><p id="P75">I-P.T. and W.-H.C. conceived and designed the project. T.-L.C. contributed to algorithm development. S.-C.C. wrote the codes, conducted the classification experiments. K.-P.W. purified GS and provided GS cryo-EM data. S.-C.C., H.-H.L., and W.-H.C. analyzed the classification results. S.-C.C., I.-P.T., and W.-H.C. wrote the manuscript.</p></fn><fn id="FN3" fn-type="conflict"><p id="P76"><bold>Competing interests</bold></p><p id="P77">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>Liang</given-names></name><name><surname>Milazzo</surname><given-names>Anna-Clare</given-names></name><name><surname>Kleinfelder</surname><given-names>Stuart</given-names></name><name><surname>Li</surname><given-names>Shengdong</given-names></name><name><surname>Leblanc</surname><given-names>Philippe</given-names></name><name><surname>Duttweiler</surname><given-names>Fred</given-names></name><name><surname>Bouwer</surname><given-names>James C</given-names></name><name><surname>Peltier</surname><given-names>Steven T</given-names></name><name><surname>Ellisman</surname><given-names>Mark H</given-names></name><name><surname>Xuong</surname><given-names>Nguyen-Huu</given-names></name></person-group><article-title>Applications of direct detection device in transmission electron microscopy</article-title><source>Journal of structural biology</source><year>2008</year><volume>161</volume><issue>3</issue><fpage>352</fpage><lpage>358</lpage><pub-id pub-id-type="pmcid">PMC2359769</pub-id><pub-id pub-id-type="pmid">18054249</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2007.10.007</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Henderson</surname><given-names>R</given-names></name><name><surname>Faruqi</surname><given-names>AR</given-names></name></person-group><article-title>Detective quantum efficiency of electron area detectors in electron microscopy</article-title><source>Ultramicroscopy</source><year>2009</year><volume>109</volume><issue>9</issue><fpage>1126</fpage><lpage>1143</lpage><pub-id pub-id-type="pmcid">PMC2864625</pub-id><pub-id pub-id-type="pmid">19497671</pub-id><pub-id pub-id-type="doi">10.1016/j.ultramic.2009.04.002</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname><given-names>Melody G</given-names></name><name><surname>Cheng</surname><given-names>Anchi</given-names></name><name><surname>Brilot</surname><given-names>Axel F</given-names></name><name><surname>Moeller</surname><given-names>Arne</given-names></name><name><surname>Lyumkis</surname><given-names>Dmitry</given-names></name><name><surname>Veesler</surname><given-names>David</given-names></name><name><surname>Pan</surname><given-names>Junhua</given-names></name><name><surname>Harrison</surname><given-names>Stephen C</given-names></name><name><surname>Potter</surname><given-names>Clinton S</given-names></name><name><surname>Carragher</surname><given-names>Bridget</given-names></name><etal/></person-group><article-title>Movies of ice-embedded particles enhance resolution in electron cryo-microscopy</article-title><source>Structure</source><year>2012</year><volume>20</volume><issue>11</issue><fpage>1823</fpage><lpage>1828</lpage><pub-id pub-id-type="pmcid">PMC3510009</pub-id><pub-id pub-id-type="pmid">23022349</pub-id><pub-id pub-id-type="doi">10.1016/j.str.2012.08.026</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Mooney</surname><given-names>P</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Booth</surname><given-names>CR</given-names></name><name><surname>Braunfeld</surname><given-names>MB</given-names></name><name><surname>Gubbens</surname><given-names>S</given-names></name><name><surname>Agard</surname><given-names>DA</given-names></name><name><surname>Cheng</surname><given-names>Y</given-names></name></person-group><article-title>Electron counting and beam-induced motion correction enable near-atomic-resolution single-particle cryo-em</article-title><source>Nature Methods</source><year>2013</year><volume>10</volume><fpage>584</fpage><lpage>590</lpage><pub-id pub-id-type="pmcid">PMC3684049</pub-id><pub-id pub-id-type="pmid">23644547</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.2472</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name></person-group><article-title>Relion: implementation of a bayesian approach to cryo-em structure determination</article-title><source>Journal of structural biology</source><year>2012</year><volume>180</volume><issue>3</issue><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="pmcid">PMC3690530</pub-id><pub-id pub-id-type="pmid">23000701</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2012.09.006</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reboul</surname><given-names>Cyril F</given-names></name><name><surname>Bonnet</surname><given-names>Frederic</given-names></name><name><surname>Elmlund</surname><given-names>Dominika</given-names></name><name><surname>Elmlund</surname><given-names>Hans</given-names></name></person-group><article-title>A stochastic hill climbing approach for simultaneous 2d alignment and clustering of cryogenic electron microscopy images</article-title><source>Structure</source><year>2016</year><volume>24</volume><issue>6</issue><fpage>988</fpage><lpage>996</lpage><pub-id pub-id-type="pmid">27184214</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Punjani</surname><given-names>Ali</given-names></name><name><surname>Rubinstein</surname><given-names>John L</given-names></name><name><surname>Fleet</surname><given-names>David J</given-names></name><name><surname>Brubaker</surname><given-names>Marcus A</given-names></name></person-group><article-title>cryosparc: algorithms for rapid unsupervised cryo-em structure determination</article-title><source>Nature methods</source><year>2017</year><volume>14</volume><issue>3</issue><fpage>290</fpage><pub-id pub-id-type="pmid">28165473</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>Joachim</given-names></name></person-group><source>Three-dimensional electron microscopy of macromolecular assemblies: visualization of biological molecules in their native state</source><year>2006</year><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakane</surname><given-names>Takanori</given-names></name><name><surname>Kotecha</surname><given-names>Abhay</given-names></name><name><surname>Sente</surname><given-names>Andrija</given-names></name><name><surname>McMullan</surname><given-names>Greg</given-names></name><name><surname>Masiulis</surname><given-names>Simonas</given-names></name><name><surname>Brown</surname><given-names>Patricia MGE</given-names></name><name><surname>Grigoras</surname><given-names>Ioana T</given-names></name><name><surname>Malinauskaite</surname><given-names>Lina</given-names></name><name><surname>Malinauskas</surname><given-names>Tomas</given-names></name><name><surname>Miehling</surname><given-names>Jonas</given-names></name><etal/></person-group><article-title>Single-particle cryo-em at atomic resolution</article-title><source>Nature</source><year>2020</year><volume>587</volume><issue>7832</issue><fpage>152</fpage><lpage>156</lpage><pub-id pub-id-type="pmcid">PMC7611073</pub-id><pub-id pub-id-type="pmid">33087931</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2829-0</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yip</surname><given-names>Ka Man</given-names></name><name><surname>Fischer</surname><given-names>Niels</given-names></name><name><surname>Paknia</surname><given-names>Elham</given-names></name><name><surname>Chari</surname><given-names>Ashwin</given-names></name><name><surname>Stark</surname><given-names>Holger</given-names></name></person-group><article-title>Atomic-resolution protein structure determination by cryo-em</article-title><source>Nature</source><year>2020</year><volume>587</volume><issue>7832</issue><fpage>157</fpage><lpage>161</lpage><pub-id pub-id-type="pmid">33087927</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danev</surname><given-names>Radostin</given-names></name><name><surname>Yanagisawa</surname><given-names>Haruaki</given-names></name><name><surname>Kikkawa</surname><given-names>Masahide</given-names></name></person-group><article-title>Cryo-em performance testing of hardware and data acquisition strategies</article-title><source>Microscopy</source><year>2021</year><volume>70</volume><issue>6</issue><fpage>487</fpage><lpage>497</lpage><pub-id pub-id-type="pmid">33969878</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><name><surname>Huang</surname><given-names>Shih-Hsin</given-names></name><name><surname>Lin</surname><given-names>Hsin-Hung</given-names></name><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><name><surname>Tu</surname><given-names>I</given-names></name><etal/></person-group><article-title>Cryo-em analyses permit visualization of structural polymorphism of biological macromolecules</article-title><source>Frontiers in Bioinformatics</source><year>2021</year><fpage>74</fpage><pub-id pub-id-type="pmcid">PMC9580929</pub-id><pub-id pub-id-type="pmid">36303748</pub-id><pub-id pub-id-type="doi">10.3389/fbinf.2021.788308</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Shuwen</given-names></name><name><surname>Zou</surname><given-names>Shitao</given-names></name><name><surname>Yin</surname><given-names>Deyao</given-names></name><name><surname>Zhao</surname><given-names>Lihong</given-names></name><name><surname>Finley</surname><given-names>Daniel</given-names></name><name><surname>Wu</surname><given-names>Zhaolong</given-names></name><name><surname>Mao</surname><given-names>Youdong</given-names></name></person-group><article-title>Usp14-regulated allostery of the human proteasome by time-resolved cryo-em</article-title><source>Nature</source><year>2022</year><volume>605</volume><issue>7910</issue><fpage>567</fpage><lpage>574</lpage><pub-id pub-id-type="pmcid">PMC9117149</pub-id><pub-id pub-id-type="pmid">35477760</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04671-8</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wrapp</surname><given-names>Daniel</given-names></name><name><surname>Wang</surname><given-names>Nianshuang</given-names></name><name><surname>Corbett</surname><given-names>Kizzmekia S</given-names></name><name><surname>Goldsmith</surname><given-names>Jory A</given-names></name><name><surname>Hsieh</surname><given-names>Ching-Lin</given-names></name><name><surname>Abiona</surname><given-names>Olubukola</given-names></name><name><surname>Graham</surname><given-names>Barney S</given-names></name><name><surname>McLellan</surname><given-names>Jason S</given-names></name></person-group><article-title>Cryo-em structure of the 2019-ncov spike in the prefusion conformation</article-title><source>Science</source><year>2020</year><volume>367</volume><issue>6483</issue><fpage>1260</fpage><lpage>1263</lpage><pub-id pub-id-type="pmcid">PMC7164637</pub-id><pub-id pub-id-type="pmid">32075877</pub-id><pub-id pub-id-type="doi">10.1126/science.abb2507</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Tzu-Jing</given-names></name><name><surname>Yu</surname><given-names>Pei-Yu</given-names></name><name><surname>Chang</surname><given-names>Yuan-Chih</given-names></name><name><surname>Liang</surname><given-names>Kang-Hao</given-names></name><name><surname>Tso</surname><given-names>Hsian-Cheng</given-names></name><name><surname>Ho</surname><given-names>Meng-Ru</given-names></name><name><surname>Chen</surname><given-names>Wan-Yu</given-names></name><name><surname>Lin</surname><given-names>Hsiu-Ting</given-names></name><name><surname>Wu</surname><given-names>Han-Chung</given-names></name><name><surname>Hsu</surname><given-names>Shang-Te Danny</given-names></name></person-group><article-title>Effect of sars-cov-2 b. 1.1. 7 mutations on spike protein structure and function</article-title><source>Nature structural &amp; molecular biology</source><year>2021</year><volume>28</volume><issue>9</issue><fpage>731</fpage><lpage>739</lpage><pub-id pub-id-type="pmid">34385690</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mannar</surname><given-names>Dhiraj</given-names></name><name><surname>Saville</surname><given-names>James W</given-names></name><name><surname>Zhu</surname><given-names>Xing</given-names></name><name><surname>Srivastava</surname><given-names>Shanti S</given-names></name><name><surname>Berezuk</surname><given-names>Alison M</given-names></name><name><surname>Tuttle</surname><given-names>Katharine S</given-names></name><name><surname>Marquez</surname><given-names>Ana Citlali</given-names></name><name><surname>Sekirov</surname><given-names>Inna</given-names></name><name><surname>Subramaniam</surname><given-names>Sriram</given-names></name></person-group><article-title>Sars-cov-2 omicron variant: Antibody evasion and cryo-em structure of spike protein–ace2 complex</article-title><source>Science</source><year>2022</year><volume>375</volume><issue>6582</issue><fpage>760</fpage><lpage>764</lpage><pub-id pub-id-type="pmid">35050643</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Yunlong</given-names></name><name><surname>Yisimayi</surname><given-names>Ayijiang</given-names></name><name><surname>Jian</surname><given-names>Fanchong</given-names></name><name><surname>Song</surname><given-names>Weiliang</given-names></name><name><surname>Xiao</surname><given-names>Tianhe</given-names></name><name><surname>Wang</surname><given-names>Lei</given-names></name><name><surname>Du</surname><given-names>Shuo</given-names></name><name><surname>Wang</surname><given-names>Jing</given-names></name><name><surname>Li</surname><given-names>Qianqian</given-names></name><name><surname>Chen</surname><given-names>Xiaosu</given-names></name><etal/></person-group><article-title>Ba. 2.12. 1, ba. 4 and ba. 5 escape antibodies elicited by omicron infection</article-title><source>Nature</source><year>2022</year><volume>608</volume><issue>7923</issue><fpage>593</fpage><lpage>602</lpage><pub-id pub-id-type="pmcid">PMC9385493</pub-id><pub-id pub-id-type="pmid">35714668</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04980-y</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Guang</given-names></name><name><surname>Peng</surname><given-names>Liwei</given-names></name><name><surname>Baldwin</surname><given-names>Philip R</given-names></name><name><surname>Mann</surname><given-names>Deepinder S</given-names></name><name><surname>Jiang</surname><given-names>Wen</given-names></name><name><surname>Rees</surname><given-names>Ian</given-names></name><name><surname>Ludtke</surname><given-names>Steven J</given-names></name></person-group><article-title>Eman2: an extensible image processing suite for electron microscopy</article-title><source>Journal of structural biology</source><year>2007</year><volume>157</volume><issue>1</issue><fpage>38</fpage><lpage>46</lpage><pub-id pub-id-type="pmid">16859925</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De la Rosa-Trevín</surname><given-names>JM</given-names></name><name><surname>Quintana</surname><given-names>A</given-names></name><name><surname>Del Cano</surname><given-names>L</given-names></name><name><surname>Zaldivar</surname><given-names>A</given-names></name><name><surname>Foche</surname><given-names>I</given-names></name><name><surname>Gutiérrez</surname><given-names>J</given-names></name><name><surname>Gómez-Blanco</surname><given-names>J</given-names></name><name><surname>Burguet-Castell</surname><given-names>J</given-names></name><name><surname>Cuenca-Alba</surname><given-names>J</given-names></name><name><surname>Abrishami</surname><given-names>V</given-names></name><etal/></person-group><article-title>Scipion: a software framework toward integration, reproducibility and validation in 3d electron microscopy</article-title><source>Journal of structural biology</source><year>2016</year><volume>195</volume><issue>1</issue><fpage>93</fpage><lpage>99</lpage><pub-id pub-id-type="pmid">27108186</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimanius</surname><given-names>Dari</given-names></name><name><surname>Forsberg</surname><given-names>Björn O</given-names></name><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name><name><surname>Lindahl</surname><given-names>Erik</given-names></name></person-group><article-title>Accelerated cryo-em structure determination with parallelisation using gpus in relion-2</article-title><source>elife</source><year>2016</year><volume>5</volume><elocation-id>e18722</elocation-id><pub-id pub-id-type="pmcid">PMC5310839</pub-id><pub-id pub-id-type="pmid">27845625</pub-id><pub-id pub-id-type="doi">10.7554/eLife.18722</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>Timothy</given-names></name><name><surname>Rohou</surname><given-names>Alexis</given-names></name><name><surname>Grigorieff</surname><given-names>Nikolaus</given-names></name></person-group><article-title>cistem, user-friendly software for single-particle image processing</article-title><source>Elife</source><year>2018</year><volume>7</volume><elocation-id>e35383</elocation-id><pub-id pub-id-type="pmcid">PMC5854467</pub-id><pub-id pub-id-type="pmid">29513216</pub-id><pub-id pub-id-type="doi">10.7554/eLife.35383</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zivanov</surname><given-names>Jasenko</given-names></name><name><surname>Nakane</surname><given-names>Takanori</given-names></name><name><surname>Forsberg</surname><given-names>Björn O</given-names></name><name><surname>Kimanius</surname><given-names>Dari</given-names></name><name><surname>Hagen</surname><given-names>Wim JH</given-names></name><name><surname>Lindahl</surname><given-names>Erik</given-names></name><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name></person-group><article-title>New tools for automated high-resolution cryo-em structure determination in relion-3</article-title><source>elife</source><year>2018</year><volume>7</volume><elocation-id>e42166</elocation-id><pub-id pub-id-type="pmcid">PMC6250425</pub-id><pub-id pub-id-type="pmid">30412051</pub-id><pub-id pub-id-type="doi">10.7554/eLife.42166</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>Thorsten</given-names></name><name><surname>Merino</surname><given-names>Felipe</given-names></name><name><surname>Stabrin</surname><given-names>Markus</given-names></name><name><surname>Moriya</surname><given-names>Toshio</given-names></name><name><surname>Antoni</surname><given-names>Claudia</given-names></name><name><surname>Apelbaum</surname><given-names>Amir</given-names></name><name><surname>Hagel</surname><given-names>Philine</given-names></name><name><surname>Sitsel</surname><given-names>Oleg</given-names></name><name><surname>Raisch</surname><given-names>Tobias</given-names></name><name><surname>Prumbaum</surname><given-names>Daniel</given-names></name><etal/></person-group><article-title>Sphirecryolo is a fast and accurate fully automated particle picker for cryo-em</article-title><source>Communications biology</source><year>2019</year><volume>2</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC6584505</pub-id><pub-id pub-id-type="pmid">31240256</pub-id><pub-id pub-id-type="doi">10.1038/s42003-019-0437-z</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tegunov</surname><given-names>Dimitry</given-names></name><name><surname>Cramer</surname><given-names>Patrick</given-names></name></person-group><article-title>Real-time cryo-electron microscopy data preprocessing with warp</article-title><source>Nature methods</source><year>2019</year><volume>16</volume><issue>11</issue><fpage>1146</fpage><lpage>1152</lpage><pub-id pub-id-type="pmcid">PMC6858868</pub-id><pub-id pub-id-type="pmid">31591575</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0580-y</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caesar</surname><given-names>Joseph</given-names></name><name><surname>Reboul</surname><given-names>Cyril F</given-names></name><name><surname>Machello</surname><given-names>Chiara</given-names></name><name><surname>Kiesewetter</surname><given-names>Simon</given-names></name><name><surname>Tang</surname><given-names>Molly L</given-names></name><name><surname>Deme</surname><given-names>Justin C</given-names></name><name><surname>Johnson</surname><given-names>Steven</given-names></name><name><surname>Elmlund</surname><given-names>Dominika</given-names></name><name><surname>Lea</surname><given-names>Susan M</given-names></name><name><surname>Elmlund</surname><given-names>Hans</given-names></name></person-group><article-title>Simple 3.0. stream single-particle cryo-em analysis in real time</article-title><source>Journal of structural biology: X</source><year>2020</year><volume>4</volume><elocation-id>100040</elocation-id><pub-id pub-id-type="pmcid">PMC7695977</pub-id><pub-id pub-id-type="pmid">33294840</pub-id><pub-id pub-id-type="doi">10.1016/j.yjsbx.2020.100040</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henderson</surname><given-names>Richard</given-names></name></person-group><article-title>Avoiding the pitfalls of single particle cryo-electron microscopy: Einstein from noise</article-title><source>Proceedings of the National Academy of Sciences</source><year>2013</year><volume>110</volume><issue>45</issue><fpage>18037</fpage><lpage>18041</lpage><pub-id pub-id-type="pmcid">PMC3831464</pub-id><pub-id pub-id-type="pmid">24106306</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1314449110</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Heel</surname><given-names>Marin</given-names></name><name><surname>Stöffler-Meilicke</surname><given-names>M</given-names></name></person-group><article-title>Characteristic views of e. coli and b. stearother-mophilus 30s ribosomal subunits in the electron microscope</article-title><source>The EMBO journal</source><year>1985</year><volume>4</volume><issue>9</issue><fpage>2389</fpage><lpage>2395</lpage><pub-id pub-id-type="pmcid">PMC554515</pub-id><pub-id pub-id-type="pmid">3908096</pub-id><pub-id pub-id-type="doi">10.1002/j.1460-2075.1985.tb03944.x</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sigworth</surname><given-names>Fred J</given-names></name></person-group><article-title>A maximum-likelihood approach to single-particle image refinement</article-title><source>Journal of structural biology</source><year>1998</year><volume>122</volume><issue>3</issue><fpage>328</fpage><lpage>339</lpage><pub-id pub-id-type="pmid">9774537</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sigworth</surname><given-names>Fred J</given-names></name><name><surname>Doerschuk</surname><given-names>Peter C</given-names></name><name><surname>Carazo</surname><given-names>Jose-Maria</given-names></name><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name></person-group><chapter-title>An introduction to maximum-likelihood methods in cryo-em</chapter-title><source>Methods in enzymology</source><year>2010</year><volume>482</volume><fpage>263</fpage><lpage>294</lpage><publisher-name>Elsevier</publisher-name><pub-id pub-id-type="pmcid">PMC3051286</pub-id><pub-id pub-id-type="pmid">20888965</pub-id><pub-id pub-id-type="doi">10.1016/S0076-6879(10)82011-7</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>Amit</given-names></name><name><surname>Sigworth</surname><given-names>Fred J</given-names></name></person-group><article-title>Computational methods for single-particle electron cryomicroscopy</article-title><source>Annual Review of Biomedical Data Science</source><year>2020</year><volume>3</volume><pub-id pub-id-type="pmcid">PMC8412055</pub-id><pub-id pub-id-type="pmid">34485850</pub-id><pub-id pub-id-type="doi">10.1146/annurev-biodatasci-021020-093826</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>Peilong</given-names></name><name><surname>Bai</surname><given-names>Xiao-chen</given-names></name><name><surname>Ma</surname><given-names>Dan</given-names></name><name><surname>Xie</surname><given-names>Tian</given-names></name><name><surname>Yan</surname><given-names>Chuangye</given-names></name><name><surname>Sun</surname><given-names>Linfeng</given-names></name><name><surname>Yang</surname><given-names>Guanghui</given-names></name><name><surname>Zhao</surname><given-names>Yanyu</given-names></name><name><surname>Zhou</surname><given-names>Rui</given-names></name><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name><etal/></person-group><article-title>Three-dimensional structure of human <italic>γ</italic>-secretase</article-title><source>Nature</source><year>2014</year><volume>512</volume><issue>7513</issue><fpage>166</fpage><lpage>170</lpage><pub-id pub-id-type="pmcid">PMC4134323</pub-id><pub-id pub-id-type="pmid">25043039</pub-id><pub-id pub-id-type="doi">10.1038/nature13567</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baldwin</surname><given-names>Philip R</given-names></name><name><surname>Tan</surname><given-names>Yong Zi</given-names></name><name><surname>Eng</surname><given-names>Edward T</given-names></name><name><surname>Rice</surname><given-names>William J</given-names></name><name><surname>Noble</surname><given-names>Alex J</given-names></name><name><surname>Negro</surname><given-names>Carl J</given-names></name><name><surname>Cianfrocco</surname><given-names>Michael A</given-names></name><name><surname>Potter</surname><given-names>Clinton S</given-names></name><name><surname>Carragher</surname><given-names>Bridget</given-names></name></person-group><article-title>Big data in cryoem: automated collection, processing and accessibility of em data</article-title><source>Current opinion in microbiology</source><year>2018</year><volume>43</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC6067001</pub-id><pub-id pub-id-type="pmid">29100109</pub-id><pub-id pub-id-type="doi">10.1016/j.mib.2017.10.005</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sorzano</surname><given-names>COS</given-names></name><name><surname>Bilbao-Castro</surname><given-names>JR</given-names></name><name><surname>Shkolnisky</surname><given-names>Y</given-names></name><name><surname>Alcorlo</surname><given-names>M</given-names></name><name><surname>Melero</surname><given-names>R</given-names></name><name><surname>Caffarena-Fernández</surname><given-names>G</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Xu</surname><given-names>G</given-names></name><name><surname>Marabini</surname><given-names>R</given-names></name><name><surname>Carazo</surname><given-names>JM</given-names></name></person-group><article-title>A clustering approach to multireference alignment of single-particle projections in electron microscopy</article-title><source>Journal of structural biology</source><year>2010</year><volume>171</volume><issue>2</issue><fpage>197</fpage><lpage>206</lpage><pub-id pub-id-type="pmcid">PMC2893300</pub-id><pub-id pub-id-type="pmid">20362059</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2010.03.011</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Zhengfan</given-names></name><name><surname>Fang</surname><given-names>Jia</given-names></name><name><surname>Chittuluru</surname><given-names>Johnathan</given-names></name><name><surname>Asturias</surname><given-names>Francisco J</given-names></name><name><surname>Penczek</surname><given-names>Pawel A</given-names></name></person-group><article-title>Iterative stable alignment and clustering of 2d transmission electron microscope images</article-title><source>Structure</source><year>2012</year><volume>20</volume><issue>2</issue><fpage>237</fpage><lpage>247</lpage><pub-id pub-id-type="pmcid">PMC3426367</pub-id><pub-id pub-id-type="pmid">22325773</pub-id><pub-id pub-id-type="doi">10.1016/j.str.2011.12.007</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moriya</surname><given-names>Toshio</given-names></name><name><surname>Saur</surname><given-names>Michael</given-names></name><name><surname>Stabrin</surname><given-names>Markus</given-names></name><name><surname>Merino</surname><given-names>Felipe</given-names></name><name><surname>Voicu</surname><given-names>Horatiu</given-names></name><name><surname>Huang</surname><given-names>Zhong</given-names></name><name><surname>Penczek</surname><given-names>Pawel A</given-names></name><name><surname>Raunser</surname><given-names>Stefan</given-names></name><name><surname>Gatsogiannis</surname><given-names>Christos</given-names></name></person-group><article-title>High-resolution single particle analysis from electron cryo-microscopy images using sphire</article-title><source>JoVE (Journal of Visualized Experiments)</source><year>2017</year><issue>123</issue><elocation-id>e55448</elocation-id><pub-id pub-id-type="pmcid">PMC5607996</pub-id><pub-id pub-id-type="pmid">28570515</pub-id><pub-id pub-id-type="doi">10.3791/55448</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><name><surname>Lin</surname><given-names>Hsin-Hung</given-names></name><name><surname>Niu</surname><given-names>Po-Yao</given-names></name><name><surname>Huang</surname><given-names>Shih-Hsin</given-names></name><name><surname>Tu</surname><given-names>I-Ping</given-names></name><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name></person-group><article-title>Pre-pro is a fast pre-processor for single-particle cryo-em by enhancing 2d classification</article-title><source>Communications biology</source><year>2020</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC7486923</pub-id><pub-id pub-id-type="pmid">32917929</pub-id><pub-id pub-id-type="doi">10.1038/s42003-020-01229-0</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Yifan</given-names></name><name><surname>Grigorieff</surname><given-names>Nikolaus</given-names></name><name><surname>Penczek</surname><given-names>Pawel A</given-names></name><name><surname>Walz</surname><given-names>Thomas</given-names></name></person-group><article-title>A primer to single-particle cryo-electron microscopy</article-title><source>Cell</source><year>2015</year><volume>161</volume><issue>3</issue><fpage>438</fpage><lpage>449</lpage><comment>ISSN 0092-8674. URL <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0092867415003700">http://www.sciencedirect.com/science/article/pii/S0092867415003700</ext-link></comment><pub-id pub-id-type="pmcid">PMC4409659</pub-id><pub-id pub-id-type="pmid">25910204</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2015.03.050</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Ting-Li</given-names></name><name><surname>Hsieh</surname><given-names>Dai-Ni</given-names></name><name><surname>Hung</surname><given-names>Hung</given-names></name><name><surname>Tu</surname><given-names>I-Ping</given-names></name><name><surname>Wu</surname><given-names>Pei-Shien</given-names></name><name><surname>Wu</surname><given-names>Yi-Ming</given-names></name><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><name><surname>Huang</surname><given-names>Su-Yun</given-names></name></person-group><article-title><italic>γ</italic>-sup: A clustering algorthm for cryo-electron microscopy images of asymmetric particles</article-title><source>The Annals of Applied Statistics</source><year>2014</year><volume>8</volume><issue>1</issue><fpage>259</fpage><lpage>285</lpage></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Der Maaten</surname><given-names>Laurens</given-names></name></person-group><article-title>Accelerating t-sne using tree-based algorithms</article-title><source>The Journal of Machine Learning Research</source><year>2014</year><volume>15</volume><issue>1</issue><fpage>3221</fpage><lpage>3245</lpage></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><name><surname>Niu</surname><given-names>Po-Yao</given-names></name><name><surname>Huang</surname><given-names>Su-Yun</given-names></name><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><name><surname>Tu</surname><given-names>I-Ping</given-names></name></person-group><article-title>2sdr: Applying kronecker envelope pca to denoise cryo-em images</article-title><source>CoRR</source><year>2019</year></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><name><surname>Wang</surname><given-names>Shao-Hsuan</given-names></name><name><surname>Niu</surname><given-names>Po-Yao</given-names></name><name><surname>Huang</surname><given-names>Su-Yun</given-names></name><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><name><surname>Tu</surname><given-names>I</given-names></name><etal/></person-group><article-title>Two-stage dimension reduction for noisy high-dimensional images and application to cryogenic electron microscopy</article-title><source>Annals of Mathematical Sciences and Applications</source><year>2020</year><volume>5</volume><issue>2</issue><fpage>283</fpage><lpage>316</lpage></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>Szu-Chi</given-names></name><name><surname>Hung</surname><given-names>Cheng-Yu</given-names></name><name><surname>Siao</surname><given-names>Huei-Lun</given-names></name><name><surname>Wu</surname><given-names>Hung-Yi</given-names></name><name><surname>Chang</surname><given-names>Wei-Hau</given-names></name><name><surname>Tu</surname><given-names>I-Ping</given-names></name></person-group><source>Cryo-ralib-a modular library for accelerating alignment in cryo-em</source><conf-name>2021 IEEE International Conference on Image Processing (ICIP)</conf-name><conf-sponsor>IEEE</conf-sponsor><year>2021</year><fpage>225</fpage><lpage>229</lpage></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Jie</given-names></name><name><surname>Gao</surname><given-names>Haixiao</given-names></name><name><surname>Frank</surname><given-names>Joachim</given-names></name></person-group><article-title>Unsupervised classification of single particles by cluster tracking in multi-dimensional space</article-title><source>Journal of structural biology</source><year>2007</year><volume>157</volume><issue>1</issue><fpage>226</fpage><lpage>239</lpage><pub-id pub-id-type="pmid">16931050</pub-id></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname><given-names>Laurens</given-names></name><name><surname>Hinton</surname><given-names>Geoffrey</given-names></name></person-group><article-title>Visualizing data using t-sne</article-title><source>Journal of machine learning research</source><year>2008</year><month>Nov</month><day>9</day><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>Dmitry</given-names></name><name><surname>Berens</surname><given-names>Philipp</given-names></name></person-group><article-title>The art of using t-sne for single-cell transcriptomics</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC6882829</pub-id><pub-id pub-id-type="pmid">31780648</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-13056-x</pub-id></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Betti</surname><given-names>Marco</given-names></name><name><surname>García-Calderón</surname><given-names>Margarita</given-names></name><name><surname>Pérez-Delgado</surname><given-names>Carmen M</given-names></name><name><surname>Credali</surname><given-names>Alfredo</given-names></name><name><surname>Estivill</surname><given-names>Guillermo</given-names></name><name><surname>Galván</surname><given-names>Francisco</given-names></name><name><surname>Vega</surname><given-names>José M</given-names></name><name><surname>Márquez</surname><given-names>Antonio J</given-names></name></person-group><article-title>Glutamine synthetase in legumes: recent advances in enzyme structure and functional genomics</article-title><source>International Journal of Molecular Sciences</source><year>2012</year><volume>13</volume><issue>7</issue><fpage>7994</fpage><lpage>8024</lpage><pub-id pub-id-type="pmcid">PMC3430217</pub-id><pub-id pub-id-type="pmid">22942686</pub-id><pub-id pub-id-type="doi">10.3390/ijms13077994</pub-id></element-citation></ref><ref id="R47"><label>[47]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Anchi</given-names></name><name><surname>Eng</surname><given-names>Edward T</given-names></name><name><surname>Alink</surname><given-names>Lambertus</given-names></name><name><surname>Rice</surname><given-names>William J</given-names></name><name><surname>Jordan</surname><given-names>Kelsey D</given-names></name><name><surname>Kim</surname><given-names>Laura Y</given-names></name><name><surname>Potter</surname><given-names>Clinton S</given-names></name><name><surname>Carragher</surname><given-names>Bridget</given-names></name></person-group><article-title>High resolution single particle cryo-electron microscopy using beam-image shift</article-title><source>Journal of structural biology</source><year>2018</year><volume>204</volume><issue>2</issue><fpage>270</fpage><lpage>275</lpage><pub-id pub-id-type="pmcid">PMC6163078</pub-id><pub-id pub-id-type="pmid">30055234</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2018.07.015</pub-id></element-citation></ref><ref id="R48"><label>[48]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Chunling</given-names></name><name><surname>Huang</surname><given-names>Xiaojun</given-names></name><name><surname>Cheng</surname><given-names>Jing</given-names></name><name><surname>Zhu</surname><given-names>Dongjie</given-names></name><name><surname>Zhang</surname><given-names>Xinzheng</given-names></name></person-group><article-title>High-quality, high-throughput cryo-electron microscopy data collection via beam tilt and astigmatism-free beam-image shift</article-title><source>Journal of structural biology</source><year>2019</year><volume>208</volume><issue>3</issue><elocation-id>107396</elocation-id><pub-id pub-id-type="pmid">31562921</pub-id></element-citation></ref><ref id="R49"><label>[49]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efremov</surname><given-names>Rouslan G</given-names></name><name><surname>Stroobants</surname><given-names>Annelore</given-names></name></person-group><article-title>Coma-corrected rapid single-particle cryo-em data collection on the cryo arm 300</article-title><source>Acta Crystallographica Section D: Structural Biology</source><year>2021</year><volume>77</volume><issue>5</issue><fpage>555</fpage><lpage>564</lpage><pub-id pub-id-type="pmcid">PMC8098478</pub-id><pub-id pub-id-type="pmid">33950012</pub-id><pub-id pub-id-type="doi">10.1107/S2059798321002151</pub-id></element-citation></ref><ref id="R50"><label>[50]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cl Valentine</surname><given-names>R</given-names></name><name><surname>Shapiro</surname><given-names>BM</given-names></name><name><surname>Stadtman</surname><given-names>ER</given-names></name></person-group><article-title>Regulation of glutamine synthetase. xii. electron microscopy of the enzyme from escherichia coli</article-title><source>Biochemistry</source><year>1968</year><volume>7</volume><issue>6</issue><fpage>2143</fpage><lpage>2152</lpage><pub-id pub-id-type="pmid">4873173</pub-id></element-citation></ref><ref id="R51"><label>[51]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>Wilson</given-names></name><name><surname>Bai</surname><given-names>Xiao-chen</given-names></name><name><surname>Brown</surname><given-names>Alan</given-names></name><name><surname>Fernandez</surname><given-names>Israel S</given-names></name><name><surname>Hanssen</surname><given-names>Eric</given-names></name><name><surname>Condron</surname><given-names>Melanie</given-names></name><name><surname>Tan</surname><given-names>Yan Hong</given-names></name><name><surname>Baum</surname><given-names>Jake</given-names></name><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name></person-group><article-title>Cryo-em structure of the plasmodium falciparum 80s ribosome bound to the anti-protozoan drug emetine</article-title><source>Elife</source><year>2014</year><volume>3</volume><elocation-id>e03080</elocation-id><pub-id pub-id-type="pmcid">PMC4086275</pub-id><pub-id pub-id-type="pmid">24913268</pub-id><pub-id pub-id-type="doi">10.7554/eLife.03080</pub-id></element-citation></ref><ref id="R52"><label>[52]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>Maofu</given-names></name><name><surname>Cao</surname><given-names>Erhu</given-names></name><name><surname>Julius</surname><given-names>David</given-names></name><name><surname>Cheng</surname><given-names>Yifan</given-names></name></person-group><article-title>Structure of the trpv1 ion channel determined by electron cryo-microscopy</article-title><source>Nature</source><year>2013</year><volume>504</volume><issue>7478</issue><fpage>107</fpage><pub-id pub-id-type="pmcid">PMC4078027</pub-id><pub-id pub-id-type="pmid">24305160</pub-id><pub-id pub-id-type="doi">10.1038/nature12822</pub-id></element-citation></ref><ref id="R53"><label>[53]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>Yuan</given-names></name><name><surname>Cao</surname><given-names>Erhu</given-names></name><name><surname>Julius</surname><given-names>David</given-names></name><name><surname>Cheng</surname><given-names>Yifan</given-names></name></person-group><article-title>Trpv1 structures in nanodiscs reveal mechanisms of ligand and lipid action</article-title><source>Nature</source><year>2016</year><volume>534</volume><issue>7607</issue><fpage>347</fpage><lpage>351</lpage><pub-id pub-id-type="pmcid">PMC4911334</pub-id><pub-id pub-id-type="pmid">27281200</pub-id><pub-id pub-id-type="doi">10.1038/nature17964</pub-id></element-citation></ref><ref id="R54"><label>[54]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Heel</surname><given-names>Marin</given-names></name><name><surname>Frank</surname><given-names>Joachim</given-names></name></person-group><article-title>Use of multivariates statistics in analysing the images of biological macromolecules</article-title><source>Ultramicroscopy</source><year>1981</year><volume>6</volume><issue>1</issue><fpage>187</fpage><lpage>194</lpage><pub-id pub-id-type="pmid">7268930</pub-id></element-citation></ref><ref id="R55"><label>[55]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hung</surname><given-names>Hung</given-names></name><name><surname>Wu</surname><given-names>Pei-Shien</given-names></name><name><surname>Tu</surname><given-names>I-Ping</given-names></name><name><surname>Huang</surname><given-names>Su-Yun</given-names></name></person-group><article-title>On multilinear principal component analysis of order-two tensors</article-title><source>Biometrika</source><year>2012</year><volume>99</volume><fpage>569</fpage><lpage>583</lpage></element-citation></ref><ref id="R56"><label>[56]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heimowitz</surname><given-names>Ayelet</given-names></name><name><surname>Sharon</surname><given-names>Nir</given-names></name><name><surname>Singer</surname><given-names>Amit</given-names></name></person-group><article-title>Centering noisy images with application to cryo-em</article-title><source>SIAM Journal on Imaging Sciences</source><year>2021</year><volume>14</volume><issue>2</issue><fpage>689</fpage><lpage>716</lpage><pub-id pub-id-type="pmcid">PMC8813033</pub-id><pub-id pub-id-type="pmid">35126803</pub-id><pub-id pub-id-type="doi">10.1137/20m1365946</pub-id></element-citation></ref><ref id="R57"><label>[57]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palovcak</surname><given-names>Eugene</given-names></name><name><surname>Asarnow</surname><given-names>Daniel</given-names></name><name><surname>Campbell</surname><given-names>Melody G</given-names></name><name><surname>Yu</surname><given-names>Zanlin</given-names></name><name><surname>Cheng</surname><given-names>Yifan</given-names></name></person-group><article-title>Enhancing the signal-to-noise ratio and generating contrast for cryo-em images with convolutional neural networks</article-title><source>IUCrJ</source><year>2020</year><volume>7</volume><issue>6</issue><pub-id pub-id-type="pmcid">PMC7642784</pub-id><pub-id pub-id-type="pmid">33209325</pub-id><pub-id pub-id-type="doi">10.1107/S2052252520013184</pub-id></element-citation></ref><ref id="R58"><label>[58]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujisawa</surname><given-names>Hironori</given-names></name><name><surname>Eguchi</surname><given-names>Shinto</given-names></name></person-group><article-title>Robust parameter estimation with a small bias against heavy contamination</article-title><source>Journal of Multivariate Analysis</source><year>2008</year><volume>99</volume><issue>9</issue><fpage>2053</fpage><lpage>2081</lpage></element-citation></ref><ref id="R59"><label>[59]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Ting-Li</given-names></name><name><surname>Shiu</surname><given-names>Shang-Ying</given-names></name></person-group><source>A new clustering algorithm based on self-updating process</source><conf-name>JSM proceedings, statistical computing section</conf-name><year>2007</year><fpage>2034</fpage><lpage>2038</lpage><conf-loc>Salt Lake City, Utah</conf-loc></element-citation></ref><ref id="R60"><label>[60]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malkov</surname><given-names>Yury A</given-names></name><name><surname>Yashunin</surname><given-names>Dmitry A</given-names></name></person-group><article-title>Efficient and robust approximate nearest neighbor search using hierarchical navigable small world graphs</article-title><source>IEEE transactions on pattern analysis and machine intelligence</source><year>2018</year><pub-id pub-id-type="pmid">30602420</pub-id></element-citation></ref><ref id="R61"><label>[61]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shiu</surname><given-names>Shang-Ying</given-names></name><name><surname>Chen</surname><given-names>Ting-Li</given-names></name></person-group><article-title>On the strengths of the self-updating process clustering algorithm</article-title><source>Journal of Statistical Computation and Simulation</source><year>2016</year><volume>86</volume><issue>5</issue><fpage>1010</fpage><lpage>1031</lpage></element-citation></ref><ref id="R62"><label>[62]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>George C</given-names></name><name><surname>Steinerberger</surname><given-names>Stefan</given-names></name></person-group><article-title>Clustering with t-sne, provably</article-title><source>SIAM Journal on Mathematics of Data Science</source><year>2019</year><volume>1</volume><issue>2</issue><fpage>313</fpage><lpage>332</lpage><pub-id pub-id-type="pmcid">PMC7561036</pub-id><pub-id pub-id-type="pmid">33073204</pub-id><pub-id pub-id-type="doi">10.1137/18m1216134</pub-id></element-citation></ref><ref id="R63"><label>[63]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>George C</given-names></name><name><surname>Rachh</surname><given-names>Manas</given-names></name><name><surname>Hoskins</surname><given-names>Jeremy G</given-names></name><name><surname>Steinerberger</surname><given-names>Stefan</given-names></name><name><surname>Kluger</surname><given-names>Yuval</given-names></name></person-group><article-title>Fast interpolation-based t-sne for improved visualization of single-cell rna-seq data</article-title><source>Nature methods</source><year>2019</year><volume>16</volume><issue>3</issue><fpage>243</fpage><lpage>245</lpage><pub-id pub-id-type="pmcid">PMC6402590</pub-id><pub-id pub-id-type="pmid">30742040</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0308-4</pub-id></element-citation></ref><ref id="R64"><label>[64]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penczek</surname><given-names>Pawel A</given-names></name></person-group><article-title>Image restoration in cryo-electron microscopy</article-title><source>Methods in enzymology</source><year>2010</year><volume>482</volume><fpage>35</fpage><lpage>72</lpage><pub-id pub-id-type="pmcid">PMC3166661</pub-id><pub-id pub-id-type="pmid">20888957</pub-id><pub-id pub-id-type="doi">10.1016/S0076-6879(10)82002-6</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>A workflow for processing single particle cryo-EM images.</title><p>(a) Individual steps in the workflow from movie alignment (motion correction) to a final density map, as exemplified by a COVID-19 spike protein. (b) Dependence of the clustering time on the number of images, original <italic>γ</italic>-SUP versus new <italic>γ</italic>-SUP (knn <italic>γ</italic>-SUP or dynamical knn <italic>γ</italic>-SUP). (c) t-SNE plot for displaying particle distribution in high-dimension space in each iteration of a 2D classification, here exemplified by RE2DC on 70S ribosome.</p></caption><graphic xlink:href="EMS157681-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>t-SNE plot of particle images from the final iteration of a 2D classification with representative resulting 2D class-average images.</title><p>(a) Results from ISAC: each particle image is denoted by a blue point, where the member in a class is denoted in red. Note that the pattern of particle distribution from ISAC is different from RE2DC. In addition, an ISAC class usually contains members scattered far from the main cluster. For RE2DC, it is seldom the case. (b) Results from RE2DC: each particle image is denoted by a blue point, where the member in a class is denoted in red.</p></caption><graphic xlink:href="EMS157681-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>2D classification results for GS particle images by three different methods.</title><p>(a) Upper panel: Class averages from RE2DC. Lower panel: a t-SNE plot with six characteristic classes identified, where No. 3 denotes the peculiar form of crescent shape. (b) From RELION, where the number of pre-scribed class was set to 50. (c) From ISAC, where the size limit of each class was set to be 2000.</p></caption><graphic xlink:href="EMS157681-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Representative class averages resulted from the 2D classification on a curated 80S particle dataset <styled-content style="color:#EC00A7">[<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10028/">EMPIAR-10028</ext-link>]</styled-content> using three different methods.</title><p>(a) RELION. (b) ISAC. (c) RE2DC. (See <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref> for all the class averages).</p></caption><graphic xlink:href="EMS157681-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>2D classification average images from two non-curated TRPV channel datasets using three different classification methods.</title><p>(a) - (c) TRPV channel <styled-content style="color:#EC00A7">[<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10005/">EMPIAR-10005</ext-link>]</styled-content> by RELION, ISAC, and RE2DC respectively. (d) (f) TRPV channel in nanodisc <styled-content style="color:#EC00A7">[<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10059/">EMPIAR-10059</ext-link>]</styled-content> by RELION, ISAC, and RE2DC respectively.</p></caption><graphic xlink:href="EMS157681-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>2D classification results of COVID-19 spike particles pick from 3,511 cryo-EM movie data <styled-content style="color:#EC00A7">[<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10514/">EMPIAR-10514</ext-link>]</styled-content> by two classification methods.</title><p>(a) 2D class averages obtained by RELION. (b) 2D class averages obtained by RE2DC.</p></caption><graphic xlink:href="EMS157681-f006"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>The classification time of the CPU implementation on six datasets.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Algorithm</th><th align="left" valign="top">Dataset</th><th align="center" valign="middle">RELION</th><th align="center" valign="middle">ISAC</th><th align="center" valign="middle">RE2DC</th></tr></thead><tbody><tr><td align="left" valign="top" colspan="2">70S ribosome</td><td align="center" valign="top">0.43 (30 classes)</td><td align="center" valign="top">1.78 (200 members)</td><td align="center" valign="top">0.28</td></tr><tr><td align="left" valign="top" colspan="2">GS Protein</td><td align="center" valign="top">22.91 (150 classes)</td><td align="center" valign="top">50.92 (1000 members)</td><td align="center" valign="top">1.82</td></tr><tr><td align="left" valign="top" colspan="2">80S ribosome</td><td align="center" valign="top">62.32(f) (520 classes)</td><td align="center" valign="top">124.50<break/>(4X binning, 200 members)</td><td align="center" valign="top">2.54 (4X binning)</td></tr><tr><td align="left" valign="top" colspan="2">NC-TRPV1</td><td align="center" valign="top">16.03(f) (200 classes)</td><td align="center" valign="top">55.61<break/>(3X binning, 1000 members)</td><td align="center" valign="top">1.76 (3X binning)</td></tr><tr><td align="left" valign="top" colspan="2">NanoD-TRPV1</td><td align="center" valign="top">12.36(f) (100 classes)</td><td align="center" valign="top">*</td><td align="center" valign="top">3.86 (3X binning)</td></tr><tr><td align="left" valign="top" colspan="2">SARS-CoV-2</td><td align="center" valign="top">120.03(f) (500 classes)</td><td align="center" valign="top">*</td><td align="center" valign="top">8.45 (5X binning)</td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><label>a</label><p id="P78">Fast-subset is used for RELION whenever possible and is labeled with (f). The size of partition used in RE2DC is set to 5,000 or 70S ribosome, 80S ribosome and NC-TRPV1, 20,000 is used for SARS-CoV-2 and 10,000 is used for others and dynamic-SUP is used for the clustering step. The number of Message Passing Interface (MPI) used is 44 and the number of GPU is 1. Finally, the execution time is the average of 5 rounds for 70S ribosome and 3 rounds for all the other datasets. Note we do not count the data format conversion time on the platform.</p></fn></table-wrap-foot></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><title>The classification time of the GPU implementation on six datasets.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Algorithm</th><th align="left" valign="top">Dataset</th><th align="center" valign="middle">RELION</th><th align="center" valign="middle">ISAC</th><th align="center" valign="middle">RE2DC</th></tr></thead><tbody><tr><td align="left" valign="top" colspan="2">70S ribosome</td><td align="center" valign="top">0.28 (30 classes)</td><td align="center" valign="top">0.33 (200 members)</td><td align="center" valign="top">0.18</td></tr><tr><td align="left" valign="top" colspan="2">GS Protein</td><td align="center" valign="top">8.68 (150 classes)</td><td align="center" valign="top">4.08 (1000 members)</td><td align="center" valign="top">1.58</td></tr><tr><td align="left" valign="top" colspan="2">80S ribosome</td><td align="left" valign="top">30.12(f) (520 classes)</td><td align="center" valign="top">14.55<break/>(4X binning, 200 members)</td><td align="center" valign="top">2.02 (4X binning)</td></tr><tr><td align="center" valign="top" colspan="2">NC-TRPV1</td><td align="center" valign="top">13.56(f) (200 classes)</td><td align="center" valign="top">5.38<break/>(3X binning, 1000 members)</td><td align="center" valign="top">1.51 (3X binning)</td></tr><tr><td align="left" valign="top" colspan="2">NanoD-TRPV1</td><td align="center" valign="top">9.49(f) (100 classes)</td><td align="center" valign="top">12.65<break/>(3X binning, 1000 members)</td><td align="center" valign="top">3.33 (3X binning)</td></tr><tr><td align="left" valign="top" colspan="2">SARS-CoV-2</td><td align="center" valign="top">50.21(f) (500 classes)</td><td align="center" valign="top">*</td><td align="center" valign="top">7.76 (5X binning)</td></tr></tbody></table><table-wrap-foot><fn id="TFN2"><label>a</label><p id="P79">Fast-subset is used for RELION whenever possible and is labeled with (f). The size of partition used in RE2DC is set to 5,000 or 70S ribosome, 80S ribosome and NC-TRPV1, 20,000 is used for SARS-CoV-2 and 10,000 is used for others and dynamic-SUP is used for the clustering step. The number of Message Passing Interface (MPI) used is 44 and the number of GPU is 1. Finally, the execution time is the average over 5 rounds for 70S ribosome and 3 rounds for all the other datasets. Note we do not count the data format conversion time on the platform.</p></fn></table-wrap-foot></table-wrap></floats-group></article>