<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS155711</article-id><article-id pub-id-type="doi">10.1101/2022.10.11.511732</article-id><article-id pub-id-type="archive">PPR557056</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Designed active-site library reveals thousands of functional GFP variants</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Weinstein</surname><given-names>Jonathan Yaacov</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Martí-Gómez</surname><given-names>Carlos</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Lipsh-Sokolik</surname><given-names>Rosalie</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hoch</surname><given-names>Shlomo Yakir</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Liebermann</surname><given-names>Demian</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Nevo</surname><given-names>Reinat</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Weissman</surname><given-names>Haim</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Petrovich-Kopitman</surname><given-names>Ekaterina</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Margulies</surname><given-names>David</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Ivankov</surname><given-names>Dmitry</given-names></name><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>McCandlish</surname><given-names>David</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Fleishman</surname><given-names>Sarel Jacob</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biomolecular Sciences, Weizmann Institute of Science, Rehovot 7610001, Israel</aff><aff id="A2"><label>2</label>Simons Center for Quantitative Biology, Cold Spring Harbor Laboratory, Cold Spring Harbor, 11724, NY, USA</aff><aff id="A3"><label>3</label>Department of Chemical and Biological Physics, Weizmann Institute of Science, Rehovot 7610001, Israel</aff><aff id="A4"><label>4</label>Department of Molecular Chemistry and Materials Science, Weizmann Institute of Science, Rehovot, 7610001 Israel</aff><aff id="A5"><label>5</label>Life science Core facilities, Weizmann Institute of Science, Rehovot 7610001, Israel</aff><aff id="A6"><label>6</label>Department of Chemical and Structural Biology, Weizmann Institute of Science, Rehovot 7610001, Israel</aff><aff id="A7"><label>7</label>Center of Life Sciences, Skolkovo Institute of Science and Technology, Moscow, Russia</aff><pub-date pub-type="nihms-submitted"><day>14</day><month>10</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>11</day><month>10</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Mutations in a protein active site can lead to dramatic and useful changes in protein activity. The active site, however, is extremely sensitive to mutations due to a high density of molecular interactions, drastically reducing the likelihood of obtaining functional multipoint mutants. We introduce an atomistic and machine-learning-based approach, called htFuncLib, to design a sequence space in which mutations form low-energy combinations that mitigate the risk of incompatible interactions. We applied htFuncLib to the GFP chromophore-binding pocket, and, using fluorescence readout, recovered &gt;16,000 unique designs encoding as many as eight active-site mutations. Many designs exhibit substantial and useful diversity in functional thermostability (up to 96 °C), fluorescence lifetime, and quantum yield. By eliminating incompatible active-site mutations, htFuncLib generates a large diversity of functional sequences. We envision that htFuncLib will be useful for one-shot optimization of activity in enzymes, binders, and other proteins.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Protein active sites comprise molecular-interaction networks that are critical to function. Due to the molecular density of the active site, however, the majority of mutations destabilize the protein<sup><xref ref-type="bibr" rid="R1">1</xref></sup> or lead to dysfunction<sup><xref ref-type="bibr" rid="R2">2</xref></sup>, and functional multipoint mutants are exceptionally rare<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref></sup>. Thus, active sites are among the most evolutionarily conserved protein sites<sup><xref ref-type="bibr" rid="R5">5</xref></sup>. Furthermore, experimental lab-evolution studies that aim to modify protein activity typically discover many more mutations outside the active site than within it<sup><xref ref-type="bibr" rid="R6">6</xref></sup>; yet, understanding whether and how remote mutations change activity is often elusive<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup>. Although active-site mutations have the greatest potential to alter function, in practice, sensitivity to mutation has severely limited access to active-site functional variants in natural and lab evolution and in deep mutational scanning<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup> and computational protein design<sup><xref ref-type="bibr" rid="R11">11</xref></sup>. Therefore, as a rule, lab-evolution studies comprise multiple cycles of mutagenesis and selection that are customized specifically for each desired functional trait<sup><xref ref-type="bibr" rid="R12">12</xref>–<xref ref-type="bibr" rid="R14">14</xref></sup>. Such iterative processes are time consuming and likely to severely undersample the space of functional sequences.</p><p id="P3">Furthermore, epistatic interactions between mutations can severely restrict the chances of finding functional multipoint mutants<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. In epistasis, a mutation may be tolerated only if another position has already been mutated<sup><xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref></sup>, drastically reducing the chances for the emergence of beneficial multipoint mutants<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R19">19</xref></sup>. This dependence also severely limits our ability to predict the functional impact of multipoint mutations even when the effects of single-point mutations are known<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref></sup>, for instance, based on deep mutational scanning<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref></sup>. Epistasis has critical implications for our understanding of molecular evolution, including the emergence of viral and microbial resistance mutations<sup><xref ref-type="bibr" rid="R22">22</xref></sup> and the evolution of new enzymatic and binding specificities<sup><xref ref-type="bibr" rid="R23">23</xref></sup>. It also presents one of the primary obstacles to our ability to design protein activities in basic and applied research<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>.</p><p id="P4">Here, we introduce a computational method called high-throughput functional libraries (htFuncLib) to design large libraries of active-site mutants that can be applied, in principle, to any protein. Most current atomistic design methods, including our previously described FuncLib method<sup><xref ref-type="bibr" rid="R24">24</xref></sup>, select designs that optimize desired energy or structure criteria<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>. By contrast, htFuncLib searches for a set of active-site point mutations that, when freely combined, yield low-energy multipoint designs. Our approach can be applied to an arbitrarily large set of positions to generate diverse and complex libraries that encode millions of designs. htFuncLib thus accesses sequence spaces that have so far been interrogated through random or semi-random mutagenesis and selection methods. Yet, unlike such methods, htFuncLib generates libraries that are preselected computationally to enrich for stable, folded, and potentially active designs.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Principles for designing combinatorial active-site diversity</title><p id="P5">We applied htFuncLib to Green Fluorescent Protein (GFP). GFP and other fluorescent proteins have attracted intense interest in evolution studies due to their ubiquitous uses in molecular and cellular biology<sup><xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R29">29</xref></sup> and their straightforward optical readout<sup><xref ref-type="bibr" rid="R30">30</xref></sup>. GFP fluorescence depends on the chemical environment of the chromophore, including electrostatics and torsional freedom about the bond that links its aromatic rings<sup><xref ref-type="bibr" rid="R31">31</xref></sup> and is therefore sensitive to mutations in the chromophore-binding pocket. Most previous large-scale screens targeted the entire protein or consecutive segments of it<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R32">32</xref></sup>. GFP is a β-barrel, however, and the chromophore is buried within the protein core. Therefore, most mutations targeted solvent-exposed regions that are unlikely to impact spectral properties. Unlike these previous studies, we apply htFuncLib solely to positions that line the chromophore-binding pocket. Because active-site mutations may reduce protein stability, we chose as a starting point a previously designed version of enhanced GFP, PROSS-eGFP, that exhibited elevated resistance to thermal denaturation<sup><xref ref-type="bibr" rid="R33">33</xref></sup>. In this previous design, active-site positions, except Tyr145Phe and Thr167Ile, were immutable. In applying htFuncLib, we also allowed design in these two positions.</p><p id="P6">Our working hypothesis is that epistatic interactions most frequently arise from three molecular sources (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 1</xref>): (1) direct molecular interactions between proximal mutated amino acids; (2) indirect interactions between amino acid positions due to backbone conformational changes; and (3) stability-mediated interactions in which destabilizing mutations do not exhibit phenotypic differences when introduced singly but reduce stability or expression levels when combined<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup>.</p><p id="P7">The htFuncLib approach combines phylogenetic analysis, Rosetta atomistic design calculations<sup><xref ref-type="bibr" rid="R26">26</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup>, and a machine-learning analysis to nominate mutually compatible mutations when combined freely with one another (see <xref ref-type="sec" rid="S8">Methods</xref> for details). Using <xref ref-type="fig" rid="F1">Figure 1</xref> as a visual guide for applying htFuncLib to GFP, we started by manually selecting 27 active-site positions likely to impact functional properties based on previous GFP studies or proximity to the chromophore (<xref ref-type="fig" rid="F1">Figure 1A</xref>). htFuncLib then computed all single-point mutations and selected the ones likely to be tolerated against the background of the original amino acids in all other positions<sup><xref ref-type="bibr" rid="R34">34</xref></sup>. In this selection step, we retain mutations that are likely to be present in the diversity of sequence homologs and that are moreover predicted not to destabilize the protein native state according to atomistic design calculations<sup><xref ref-type="bibr" rid="R35">35</xref></sup>. The atomistic calculations contain the chromophore to ensure that the mutations do not abrogate contacts that may be critical to fluorescence. In addition, these calculations apply harmonic coordinate constraints to backbone atoms during whole-structure minimization, thereby penalizing backbone deformations that may lead to indirect epistatic interactions (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 1B</xref>).</p><p id="P8">After filtering, htFuncLib applies atomistic modeling to evaluate the energy of combinations of tolerated point mutations. Since the space of potential multipoint mutations in a large active site is computationally intractable for enumeration, we focus calculations on combinations of mutations within neighborhoods of proximal positions (<xref ref-type="fig" rid="F1">Figure 1B &amp; C</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary Tables 1 and 2</xref>) which are the most likely to give rise to direct epistatic interactions (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 1A</xref>). In a companion paper, we show how to select combinations of enzyme backbone fragments that form low-energy combinations when freely combined using a new machine-learning-based approach called EpiNNet<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. Here, we apply EpiNNet to select low-energy combinations of mutations across all spatial neighborhoods within the chromophore-binding pocket. The multipoint mutants within each neighborhood are classified according to their energies into favorable (Rosetta energies lower than PROSS-eGFP) and unfavorable (highest-energy 50%, <xref ref-type="fig" rid="F1">Figure 1D</xref>). We then train the neural network to predict the energy-based classification of favorable and unfavorable designs. Finally, the trained network ranks the single-point mutations according to their likelihood of being found in low-energy multipoint mutants, and the top-ranked mutations are selected for library construction. The resulting library is enriched in mutually compatible mutations, such that both direct and stability-mediated epistasis (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 1A and C</xref>) are addressed. Following design, we clone the library using Golden Gate assembly<sup><xref ref-type="bibr" rid="R37">37</xref></sup> (<xref ref-type="fig" rid="F1">Figure 1E</xref>) and apply FACS sorting and deep sequencing to identify active designs (<xref ref-type="fig" rid="F1">Figure 1F</xref>).</p><p id="P9">Multipoint mutants from the EpiNNet-enriched sequence space exhibit, on average, dramatically lower computed energies than those in the original filtered sequence space (<xref ref-type="fig" rid="F2">Figure 2A</xref>), suggesting that EpiNNet increases the fraction of folded and stable designs. Furthermore, in a representative case, following the selection steps, only 14 positions (out of the 27 we selected initially) were selected for design with a sequence space of 10<sup>7</sup>, compared to experimentally intractable 10<sup>35</sup> sequences for the space encompassing every mutation at 27 positions and 10<sup>19</sup> following the phylogenetic and single-mutation energy filters (<xref ref-type="supplementary-material" rid="SD2">Supplementary Tables 3 and 4</xref>).</p><p id="P10">Thus, unlike conventional protein design methods<sup><xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>, htFuncLib does not search for the most optimal mutants according to energy or structural criteria. Instead, the astronomically large space of combinatorial mutations in an active site is reduced to a tractable size through phylogenetic, structural, and energy-based analysis. Then, mutations that may destabilize the protein in combination with others are removed by analyzing the energies of combinatorial mutations. Thus, htFuncLib assumes that active-site stability is a primary constraint for discovering functional multipoint mutants<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R38">38</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup>. Additional functional constraints are encoded by verifying that the mutants form favorable interactions with the chromophore.</p></sec><sec id="S4"><title>Design of a multiplexed GFP active-site library</title><p id="P11">The spectral properties of GFP depend on chromophore packing, electrostatics, and hydrogen-bond networks around the chromophore<sup><xref ref-type="bibr" rid="R27">27</xref></sup>. Since hydrogen-bond networks are extremely sensitive to structural perturbations, we designed two libraries: nohbonds, which excluded positions that directly hydrogen bond to the chromophore, and hbonds, which included such positions. We manually selected 27 and 24 positions for design in each library, respectively, applied htFuncLib to these positions, and generated 11 million and 930,000 designs for each library, respectively. Both libraries are complex: some positions allow only subtle mutations, and others, including <italic>e.g</italic>., Gln69 and Tyr145, exhibit high diversity and radical mutations (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figures 2 and 3, Supplementary Table 5</xref>). According to Rosetta atomistic modeling, both libraries are highly enriched for low-energy mutants compared to the GFP starting point. For instance, nearly 99% and more than 67% of the nohbonds and hbonds designs, respectively, exhibit lower Rosetta energies than the progenitor PROSS-eGFP (<xref ref-type="fig" rid="F2">Figure 2A</xref>). By contrast, the energies of multipoint mutants from the sequence space prior to EpiNNet enrichment are significantly worse than PROSS-eGFP, with &gt;99% and &gt;96% exhibiting higher energies for nohbonds and hbonds, respectively (<xref ref-type="fig" rid="F2">Figure 2A</xref>). The unfavorable energies of combinatorial mutants in the sequence space before EpiNNet selection reflect the high epistasis in the active site. By contrast, the EpiNNet-enriched sequence space significantly improves the fraction of low-energy and, thus, potentially stable and foldable active-site designs. Additionally, combinations of EpiNNet-selected mutations exhibit lower energies than expected from an additive contribution of the constituting point mutations (<xref ref-type="fig" rid="F2">Figure 2B</xref>).</p><p id="P12">The two libraries were cloned using Golden Gate assembly into <italic>E. coli</italic> cells, with transformation efficiency greater than 5 x 10<sup>7</sup>. Deep-sequencing analysis of the unsorted libraries shows high uniformity in the distribution of multipoint mutations, verifying that the assembly process exhibits low bias (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 4</xref>). The cells were FACS-sorted using two selection gates: (405 nm excitation, 525 nm emission; referred to as AmCyan<sup>405/525</sup>) and (488 nm, 530 nm; referred to as GFP<sup>488/530</sup>; <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 5</xref>). Following selection, plasmids were purified and cloned into fresh cells and resorted using the same gating strategy to reduce sort errors. Following each sort, we collected several individual clones for sequencing and functional measurements, obtaining 62 unique designs, 50 of which were functional. Furthermore, the presorted library and the output from the second sort were subjected to deep sequencing analysis. To determine thresholds for selecting positive hits from the deep sequencing data, we analyzed the enrichment values of the 62 designs we collected during sorts. Relatively loose criteria (enrichment in the selected population relative to the presorted population &gt;1) captured 45 functional designs with only a single false positive (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table 6</xref>). Applying these thresholds, we identified 14,242 and 1,926 unique designs in the sorted nohbonds and hbonds libraries, respectively (0.13% and 0.21%, respectively; see <xref ref-type="supplementary-material" rid="SD2">Supplemental Figure 6</xref> for distribution of read counts in the selected libraries). We also retrospectively evaluated the fraction of functional GFP variants in libraries that were constructed from top-ranked EpiNNet-selected mutations. We found that up to library sizes of 10<sup>4</sup>-10<sup>5</sup>, approximately 10% of the multipoint mutants were functional, and only above a library size of 10<sup>5</sup> did the fraction of functional variants decay substantially (<xref ref-type="fig" rid="F2">Figure 2C &amp; D</xref>). These results are encouraging as they suggest that focusing htFuncLib on top-ranked mutations may yield highly functional libraries in experimental systems that are not amenable to high-throughput screening.</p><p id="P13">Combining the positive hits from both libraries yields 16,155 unique, putatively active GFP designs. Remarkably, these include 1,167 designs that exhibit ≥8 mutations relative to GFP (<xref ref-type="fig" rid="F3">Figure 3A</xref>). Strikingly, many of the active designs have radical mutations, including Thr203His (13%), Gln69Met (9%), Ser205Asp (9%), Gln94Leu (8%), and Tyr145Met (8%) (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table 7</xref>). The large number of functional active-site multipoint mutants is striking compared to previous engineering and design strategies applied to eGFP, which showed a steep decline in active mutants with the number of mutations and no active mutants with ≥5 mutations in the chromophore-binding pocket<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup> (albeit, these studies did not focus diversity on the active site). The vast majority of the mutations observed in those studies were in the more tolerant solvent-exposed surfaces. By contrast, the current designs are entirely within the chromophore-binding pocket where they are more likely to affect functional properties (<xref ref-type="fig" rid="F3">Figure 3A</xref>). The large number of active high-order multipoint designs in our dataset confirms our working hypothesis that a stable starting scaffold (eGFP-PROSS) and the htFuncLib enrichment of mutually compatible mutations dramatically increase the yield of functional active-site multipoint mutations. Furthermore, htFuncLib generates many more functional multipoint active-site designs relative to random mutagenesis (<xref ref-type="fig" rid="F3">Figure 3A</xref>). Finally, compared to all known descendants of <italic>Aequorea victoria</italic> GFP (avGFP) in the fluorescent protein database (FPBase)<sup><xref ref-type="bibr" rid="R35">35</xref></sup> and variants characterized in focused and high-throughput studies, we find that htFuncLib explored different regions of the sequence space (<xref ref-type="fig" rid="F3">Figure 3B</xref>).</p></sec><sec id="S5"><title>Random forest modeling of GFP genotype-phenotype map</title><p id="P14">To gain insight into what determines the functional outcome of multipoint mutants in the htFuncLib designs, we trained a random forest model using the functional annotations derived from the deep sequencing data for the nohobnds library. We chose this type of analysis because it is easily interpretable, less prone to overfitting than other approaches, and well suited for mixed categorical and numerical data. As features for training, we used the mutation identities, geometric and physicochemical properties, and conservation scores. The best-performing model exhibits 84% accuracy in predicting functional versus non-functional designs in a balanced test (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 7, Supplementary Table 9</xref>). The most important single feature for predicting functionality is the mean conservation score, calculated as the sum of differences in the conservation scores between PROSS-eGFP and mutated identities (ΔPSSM, <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 8</xref>). In fact, this single parameter exhibits an area under the ROC curve of 87%, compared to 93% for the random forest. This result provides a compelling verification for the approach of combining sequence conservation with atomistic protein design which underlies htFuncLib and other successful protein design methods developed in recent years<sup><xref ref-type="bibr" rid="R26">26</xref></sup>.</p><p id="P15">To further understand the qualitative features of the sequence-function relationship learned by the random forest, we used a technique for visualizing complex fitness landscapes<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. In this technique, the distance between sequences reflects the time it would take for a population to evolve from one sequence to another under selection to maintain a fluorescent phenotype as predicted by the random forest model (see <xref ref-type="sec" rid="S8">Methods</xref>). We found that the main structure of the landscape could be represented by a two-dimensional visualization, where each axis captures a different qualitative feature of the GFP genotype-phenotype map (<xref ref-type="fig" rid="F4">Figure 4A</xref>). The first axis (diffusion axis 1) mainly distinguishes functional from non-functional sequences (79% of sequences with diffusion axis 1 values greater than 1 were functional, while only 0.01% were functional if they had diffusion axis 1 values less than -1), capturing the fact that the functional sequences are highly connected with each other and localized in sequence space rather than consisting of isolated fitness peaks separated by valleys. The contiguity between functional sequences suggests that the htFuncLib selection of mutations that increase stability may generate a highly evolvable library in which active variants are connected via mutational trajectories that maintain function<sup><xref ref-type="bibr" rid="R38">38</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup>. Additionally, the second axis (diffusion axis 2) then largely separates functional AmCyan<sup>405/525</sup> sequences from functional GFP<sup>488/530</sup> sequences.</p><p id="P16"><xref ref-type="fig" rid="F4">Figure 4B</xref> provides more detail on the interpretation of diffusion axis 2 by showing site frequency logos for three different regions of the fitness landscape. These frequency logos indicate that the main set of functional sequences is largely separated into three groups: one group with Thr65Ser and Gln69 consisting of AmCyan<sup>405/525</sup> designs; one group with Thr65 and Gln69 consisting of designs that fluoresce a mixture of AmCyan<sup>405/525</sup>, GFP<sup>488/530</sup>, or both; and one group with Thr65 and Gln69Leu that consists of GFP<sup>488/530</sup> designs. All three groups are strongly supported by many different sequences directly assessed in the sorting experiment (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 9</xref>). Strikingly, Thr65Ser and Gln69Leu are highly incompatible: sequences that contain both these mutations have a much lower chance of being functional (<xref ref-type="fig" rid="F4">Figure 4C</xref>). As a consequence, evolutionary trajectories from Ser65/Gln69 to Thr65/Leu69 that maintain functionality would tend to pass through a Thr65/Gln69 intermediate.</p><p id="P17">In addition to these three main groups, which comprise the large majority of the functional designs, the random forest analysis predicts two long parallel tails of functional sequences spreading along diffusion axis 1 and sweeping up along diffusion axis 2. The AmCyan<sup>405/525</sup> tail is well-supported by the experimental data and is not an artifactual prediction of our model, as we observe a cluster of highly mutationally connected designs that were also among the most strongly enriched in AmCyan<sup>405/525</sup> sorted cells (<xref ref-type="fig" rid="F4">Figure 4D</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 9, Supplementary Table 10</xref>). Moreover, in this cluster, all sequences contain an unusual and rarely functional pairing of alleles Thr65/Gln69Ala (<xref ref-type="fig" rid="F4">Figure 4C</xref>), and all except one contain Thr108Glu, which is also unusual among other functional sequences (<xref ref-type="fig" rid="F4">Figure 4B</xref>). To investigate what distinguishes these designs from the other fluorescent proteins in the library, we fit an additive logistic regression model to the random forest output using only sequences up to two mutations away from the cluster highlighted in <xref ref-type="fig" rid="F4">Figure 4D</xref> (see <xref ref-type="sec" rid="S8">Methods</xref>). We then compared the estimated mutational effects on the probability of activity to those obtained by fitting the same logistic regression model to the full genotypic space (<xref ref-type="fig" rid="F4">Figure 4E</xref>). Although there are some commonalities in the inferred mutational effects (<italic>e.g</italic>., Tyr145Met, which is the strongest single-site predictor of functionality based on the random forest, greatly increases the probability that a sequence is fluorescent under both logistic regression models), positions 68, 69, 72 and 108 show marked differences in amino acid preferences. For example, Thr72Ala increases the odds ratio for functionality by approximately fourfold in the general model but reduces the odds ratio by 13-fold in this alternative context. These results suggest that variants within this cluster also differ in their functional constraints as compared to the majority of fluorescent designs, although more detailed experiments would be required to validate this qualitatively different solution to GFP fluorescence.</p></sec><sec id="S6"><title>Designs exhibit large and useful functional diversity</title><p id="P18">The above results, based on flow cytometry, identify designs that maintain fluorescence, but they do not provide information on other changes in functional properties, including finer-scale changes in excitation and emission spectra. To examine these aspects of functional diversity, we expressed, purified, and characterized a total of 88 unique designs, exhibiting at least two mutations from PROSS-eGFP and typically at least two mutations from one another, and three controls (eGFP, PROSS-eGFP, and superfolder GFP (sfGFP); <xref ref-type="supplementary-material" rid="SD2">Supplementary Tables 11 and 12</xref>). Twenty-four designs are cluster representatives of the hits observed in the deep-sequencing data, 17 of which (71%) were active. We also selected three designs with mutations rarely found in the sorted populations, Glu222Gln/Leu and Leu44Met, one of which was active. As an especially stringent test, we selected six designs with the maximal number of mutations (12-14), but none of these was functional. Furthermore, we selected 19 designs that were predicted to be functional by the random forest analysis but were not observed among the positive hits in the deep sequencing analysis. Surprisingly, 15 (79%) were active, confirming that a random forest analysis based on deep sequencing data of htFuncLib designs can be used to recover false negatives — active designs that were missed by the experimental workflow. Additionally, we isolated designs from FACS sorts that were gated for higher brightness or spectral shifts (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table 11</xref>) by applying sorting gates that combine two channels (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 10</xref>). We also verified that 19 designs could be transferred to the superfolder GFP (sfGFP) background<sup><xref ref-type="bibr" rid="R43">43</xref></sup> to demonstrate that the designs are compatible with a different chassis (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table 12</xref>).</p><p id="P19">Although we did not explicitly guide the design process to improve any functional property (except native-state stability (<xref ref-type="fig" rid="F1">Figures 1D</xref> and <xref ref-type="fig" rid="F2">2A</xref>)), we hypothesized that the large diversity in active-site sequences would lead to observable functional differences. We first analyzed GFP functional thermostability or the temperature at which its fluorescence deteriorates to 50% of the maximal value, a critical property for high-temperature or long-term experiments and “real-world” applications<sup><xref ref-type="bibr" rid="R44">44</xref>,<xref ref-type="bibr" rid="R45">45</xref></sup>. Functional thermostability is remarkably variable among the designs, 46-96 °C, compared to 84 °C for eGFP (<xref ref-type="fig" rid="F5">Figure 5A</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 11</xref>). We noticed that the PROSS-eGFP parental design is less stable than eGFP when functional thermostability is measured (<xref ref-type="fig" rid="F5">Figure 5A</xref>) rather than thermal denaturation as in the PROSS-eGFP design study<sup><xref ref-type="bibr" rid="R33">33</xref></sup>. Apparently, the PROSS-eGFP design is more resistant to heat denaturation, but its fluorescence is more sensitive to heat than eGFP. Quantum yield, which measures the efficiency of emitting light absorbed by the chromophore, was also extremely variable, 0.16-0.82, compared to 0.55 for eGFP (<xref ref-type="fig" rid="F5">Figure 5A</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 12</xref>). Surprisingly, across the all designs we tested, functional thermostability and quantum yield were correlated (Pearson’s <italic>r</italic>=0.53, <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 13</xref>). This correlation probably stems from the fact that both chromophore brightness and resistance to unfolding increase with core packing density<sup><xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R46">46</xref></sup>. To our knowledge, this is the first observation of such a correlation, demonstrating how a large set of active-site variants can yield insights even in a well-studied protein. Moreover, the designs we sorted specifically for spectral shifts indeed displayed significant shifts in excitation spectra (<xref ref-type="fig" rid="F5">Figure 5B</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary Tables 11 and 12, and Supplementary Figure 14</xref>).</p><p id="P20">We examined the design models for a molecular explanation of the large observed differences in stability and quantum yield. For instance, Tyr145Phe, seen previously to enhance stability and quantum yield<sup><xref ref-type="bibr" rid="R47">47</xref></sup>, appeared in all five high stability/brightness designs but only in one of the bottom 26 designs. Similarly, Thr203His, likely to stabilize the chromophore through π-π stacking interactions<sup><xref ref-type="bibr" rid="R48">48</xref></sup>, is seen in all top designs and none of the bottom ones. Ser205Thr is in three of the top-five designs and none of the bottom. By contrast to the two mutations above, Ser205Thr is enriched in designs with high thermostability and quantum yield though we are unaware of previous studies that pointed to its significance.</p><p id="P21">We also observed large variability in photostability, which is the resistance of the chromophore to bleaching by bright light. Bleaching is often a limitation in long-term live-imaging studies<sup><xref ref-type="bibr" rid="R49">49</xref></sup>, whereas it is an advantage in assays such as fluorescence recovery after photobleaching (FRAP), in which fast fluorescence decay enhances signal<sup><xref ref-type="bibr" rid="R50">50</xref></sup>. We isolated two designs that exhibited higher photostability than GFP (photostable.1 &amp; photostable.2, with seven mutations each from PROSS-eGFP) and many significantly less photostable designs (<xref ref-type="fig" rid="F5">Figure 5A</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 15</xref>). At the extremes, design fast.4 (6 mutations) photobleaches tenfold faster than GFP, while the design photostable.1 requires 122% of that time. Finally, we also noted large differences in fluorescence lifetime (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 16</xref>) and pH sensitivity (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 17</xref>). Furthermore, several mutations enriched in designs with altered pK<sub>a</sub> are either adjacent to His amino acids or introduce a novel His (Thr203His). Interestingly, seven designs exhibit different pH sensitivity profiles when excited at either 405 or 488nm (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 17</xref>).</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P22">Epistasis is a significant constraint on the emergence of new activities in proteins and other biomolecules<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. Until now, experimental methods to address epistasis have relied on iterative cycles of diversification and selection, but such processes do not efficiently cover the space of functional variants. Computational methods have used evolutionary couplings among pairs of positions<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, but such analyses require deep and diverse sequence alignments, which are not generally available. Other approaches have used machine-learning models trained on high-quality and large-scale mutational data to recommend mutations<sup><xref ref-type="bibr" rid="R52">52</xref>–<xref ref-type="bibr" rid="R54">54</xref></sup>. By contrast, htFuncLib only requires a molecular structure (or model) and a limited sequence alignment of homologs. Its success in generating an order of magnitude more functional active-site mutants than were previously known for GFP verifies our underlying assumption that energetically incompatible mutations are a significant source of epistasis. Furthermore, because the designs are diverse and only target the chromophore-binding pocket, they exhibit potentially useful functional diversity in each of the properties we assayed.</p><p id="P23">Our implementation of htFuncLib did not target a specific functional outcome, except for protein stability. This implementation is especially suitable if multiple variants for different and potentially incompatible goals are desired. For example, FRAP experiments require fluorescent proteins that bleach quickly, whereas long-term imaging experiments require slow bleaching, and we recovered designs that exhibited both properties from a single library. If a specific functional goal is desired and the molecular underpinnings of that goal are known, they can be imposed during the design process to focus diversity such that it exhibits these essential molecular features. The high stability and brightness of the eGFP starting point are likely to be key to obtaining so many functional variants<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R55">55</xref></sup>. Further research is needed to determine whether the combination of PROSS stability design<sup><xref ref-type="bibr" rid="R56">56</xref></sup> and htFuncLib can access such large spaces of functional variants in less robust starting points.</p><p id="P24">In a companion paper, we demonstrate that the EpiNNet strategy is general and can be extended to design large and highly functional enzyme libraries comprising substantial backbone conformational diversity, including insertions and deletions<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. We envision that htFuncLib will provide a platform for designing high-yield multipoint mutation libraries in a range of applications, including optimizing binding affinity and enzyme catalytic rate and selectivity.</p></sec><sec id="S8" sec-type="methods"><title>Methods</title><sec id="S9"><title>Library design</title><sec id="S10"><title>Phylogenetic analysis</title><p id="P25">A phylogenetic analysis was conducted as previously<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R56">56</xref>,<xref ref-type="bibr" rid="R57">57</xref></sup> using all sequences in the lineage of avGFP according to FPBase<sup><xref ref-type="bibr" rid="R35">35</xref></sup>. A total of 153 seqeunces were retrieved from FPBase, all synthetic variants of avGFP. Briefly, sequences were clustered by cd-hit<sup><xref ref-type="bibr" rid="R58">58</xref></sup> and aligned using MUSCLE<sup><xref ref-type="bibr" rid="R59">59</xref></sup>. The resulting multiple sequence alignment (MSA) was segmented by secondary structure elements. A position-specific scoring matrix (PSSM)<sup><xref ref-type="bibr" rid="R60">60</xref></sup> was then derived from the MSA segments and concatenated to create a PSSM for the whole sequence. The PSSM is used to filter mutations absent in the PSSM at each position and to bias the Rosetta energy function towards mutations favored by the PSSM (high PSSM score).</p></sec><sec id="S11"><title>Refinement and mutational scan</title><p id="P26">PROSS-eGFP was modeled based on a high-resolution X-ray structure of eGFP (PDB code: 2WUR). The eGFP-PROSS model was subsequently refined in Rosetta as described before<sup><xref ref-type="bibr" rid="R56">56</xref></sup>. Chromophore pocket positions were then manually selected, 14, 16, 18, 42, 44, 46, 61, 64, 66, 68, 69, 72, 108, 110, 112, 119, 123, 145, 150, 163, 165, 167, 181, 185, 201, 220, 224 and 42, 44, 61, 62, 69, 92, 94, 96, 112, 121, 145, 148, 150, 163, 165, 167, 181, 183, 185, 203, 205, 220, 222, 224 for the hbonds and nohbonds libraries, respectively. All positions are within 8 Å from the chromophore, and their side chains are buried within the GFP β-barrel. All mutations with PSSM scores &gt; -2 were then scanned <italic>in silico</italic>, as previously described<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup>. Briefly, each mutation is modeled, refined, and scored separately on the PROSS-eGFP background. This step calculates the ΔΔ<italic>G</italic> between the mutant and eGFP-PROSS.</p></sec><sec id="S12"><title>Spatial partitioning and sequence space selection</title><p id="P27">We split the chromophore pocket into spatial neighborhoods, with each selected position as a center of a distinct neighborhood. In order to capture direct epistatic interactions, each neighborhood is extended to all positions that interact directly with the neighborhood’s center. Here, direct interaction is defined as having at least two heavy atoms within 6 Å of the neighborhood’s central residue. Neighborhoods were manually examined, and positions that did not interact directly with the neighborhood’s center were removed. By selecting neighborhoods this way, we ensure overlap between proximal neighborhoods. These overlaps ensure that no position-position interactions are missed.</p></sec><sec id="S13"><title>Partial modeling and scoring</title><p id="P28">The number of designs encoded in each neighborhood is calculated for each ΔΔ<italic>G<sub>mut–wt</sub></italic> threshold. The energy threshold is selected to limit the number of unique variants to under 1 million. In this particular case, the ΔΔ<italic>G</italic> thresholds were set to +5.5 and +6.0 Rosetta energy units (R.e.u.) for nohbonds and hbonds, respectively. Neighborhoods with a sequence space smaller than 10,000 designs were fully modeled. For larger neighborhoods, only 10% of the sequence space was modeled. RosettaScripts<sup><xref ref-type="bibr" rid="R61">61</xref></sup> and command-line arguments for modeling calculations are in the <xref ref-type="supplementary-material" rid="SD2">Supplementary Information</xref>.</p></sec><sec id="S14"><title>Data aggregation and EpiNNet training</title><p id="P29">We train an EpiNNet neural net model to predict which designs are more stable than PROSS-eGFP. Specifically, designs that score better than the wild-type are labeled as success (1), and the worse 50% are labeled as failed (0). Intermediate designs are considered undetermined and discarded from subsequent analysis. The resulting data are split into a training (80%) and a test (20%) set. We then train a multi-layer perceptron classifier with a single hidden layer the size of the number of selected positions. The classifier is trained on a one-hot encoded representation of the sequence data to classify whether a sequence is more or less stable than PROSS-eGFP. The classifier is trained up to 2,000 iterations. Next, we rank single-point mutations according to the trained model: each single-point mutation in the tolerated sequence space is fed into EpiNNet separately, and its score is recorded. The mutations are then ranked from top to bottom according to their scores. Mutations are selected for the library by iteratively adding the top-ranked mutations until the resulting sequence space reaches the experimental limit of several million sequences.</p></sec><sec id="S15"><title><italic>In silico</italic> testing of the enriched versus the original sequence spaces</title><p id="P30">To ensure the resulting sequence space is enriched for low-energy sequences, 10,000 random sequences from both the original and enriched sequence spaces were modeled and scored (using the same protocol as in the modeling step). The resulting score distributions were compared (<xref ref-type="fig" rid="F1">Figure 1D</xref> and <xref ref-type="fig" rid="F2">Figure 2A</xref>).</p></sec><sec id="S16"><title>Random forest</title><p id="P31">To augment the sequence data for machine learning prediction, we added several features based solely on the sequence and not requiring atomistic calculations. These include the amino acid identity at each variable position, the total number of mutations compared to PROSS-eGFP, the number of mutations at each spatial neighborhood, and the number of mutations in specific areas. In addition, for every variable position, the difference in the surface accessible solvent area (SASA), PSSM score, and amino acid category were also assigned (comparing the mutated amino acid and the PROSS-eGFP identity). The mean and max values of each of these parameters were added as well. Non-informative features and features with low importance in initial random forest training were removed. A prediction pipeline with two consecutive elements was trained. The first predictor classifies sequences as either functional or non-functional. The subsequent predictor classifies all functional sequences as either GFP, AmCyan, GFP/AmCyan, or non-functional. Both models are gradient-boosting random forests from the LightGBM library<sup><xref ref-type="bibr" rid="R62">62</xref></sup>.</p></sec><sec id="S17"><title>Visualization methods</title><p id="P32">Visualization method as previously described<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. Briefly, we construct a model of molecular evolution where a population evolves via single amino acid substitutions, and the rate at which each possible substitution becomes fixed in the population reflects its selective advantage or disadvantage relative to the currently fixed sequence. More specifically, in our model, the rate of evolution from sequence <italic>i</italic> to any mutationally adjacent sequence <italic>j</italic> is given by <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>S<sub>ij</sub></italic> is the scaled selection coefficient (population size times the selection coefficient of <italic>j</italic> relative to <italic>i</italic>), time is measured relative to the amino acid mutation rate (each possible amino acid mutation occurs at rate 1), and the total leaving rate from each sequence <italic>i</italic> is given by <inline-formula><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. In the current context, sequences are either predicted to be fluorescent or not, and so we set <italic>S<sub>ij</sub></italic> = <italic>c</italic> if <italic>j</italic> is fluorescent and <italic>i</italic> is not, <italic>S<sub>ij</sub></italic> =– c if <italic>i</italic> is fluorescent and <italic>j</italic> is not, and otherwise <italic>S<sub>ij</sub></italic> = 0 so that <italic>Q<sub>ij</sub></italic> = 1 corresponding to neutral evolution. For this analysis, we choose <italic>c</italic> so that in the long-term, a population spends 60% of its time at functional sequences, representing a roughly 60-fold enrichment of functional sequences due to natural selection.</p><p id="P33">Given the rate matrix <italic>Q</italic> for our evolutionary model, we then construct the visualization by using the subdominant right eigenvectors associated with the smallest magnitude non-zero eigenvalues of this rate matrix as coordinates. This produces a visualization that reflects the long-term barriers to diffusion in sequence space, and, in particular, clusters of sequences in the visualization correspond to sets of initial states from which the evolutionary model approaches its stationary distribution in the same manner, and multi-peaked fitness landscapes appear as broadly separated clusters with one peak in each cluster. Moreover, by scaling the axes appropriately, as is done here, these axes can be given units of sqrt(time), and it can be shown that the resulting distances reflect evolutionary times under this model. In particular, using these coordinates, the squared Euclidean distance between arbitrary sequences <italic>i</italic> and <italic>j</italic> optimally approximates (in a specific sense) the sum of the expected time to evolve from <italic>i</italic> to <italic>j</italic> and the expected time to evolve from <italic>j</italic> to <italic>i</italic>. See ref. <sup><xref ref-type="bibr" rid="R42">42</xref></sup> for details.</p></sec><sec id="S18"><title>Logistic regression and sequence logos</title><p id="P34">Calculations and plots were performed using gpmap-tools python library (<ext-link ext-link-type="uri" xlink:href="https://gpmap-tools.readthedocs.io/en/latest/">https://gpmap-tools.readthedocs.io/en/latest/</ext-link>). Sequence logos were plotted using logomaker<sup><xref ref-type="bibr" rid="R63">63</xref></sup>, and L2-penalized logistic regression models were fit using scikit-learn <sup><xref ref-type="bibr" rid="R64">64</xref></sup>. Specifically, the global model using all sequences was fit using non-penalized regression, while the model in the neighborhood of the alternative functional sequences highlighted in <xref ref-type="fig" rid="F4">Figure 4D</xref> was fit using L2-penalization under one-hot encoding, using 10-fold cross-validation to optimize the hyperparameter controlling the strength of the regularization. The regularization constant was chosen to be C=0.5 as the strongest regularization before a drop in the cross-validated AUROC.</p></sec></sec><sec id="S19" sec-type="methods"><title>Experimental procedures</title><sec id="S20"><title>Library cloning</title><p id="P35">Each designed library was cloned separately using a Golden Gate assembly (manuscript in preparation). A computational algorithm optimizes a set of Golden-Gate gates to minimize the total cost of ordered oligos required to cover all mutations in the library without introducing unwanted mutations. This results in several variable and constant segments, with and without mutations. Constant segments were PCR amplified with primers adding <italic>BsaI</italic> recognition sites. These and all other DNA fragments were purified using (HiYield Gel/PCR DNA Fragments Extraction Kit, Real Genomics). Variable segments were ordered as degenerate oligos (IDT). The single-stranded oligos were double-stranded by a short PCR with a single primer and purified. The concentration of each segment was measured using NanoDrop One (Thermo Scientific). A Golden-Gate assembly was conducted using the manufacturer's specifications. Briefly, all segments are added at an equal amount, without the vector, and assembled using T4-ligase and BsaI-HF-v2 using cycles of 16°C and 37°C (New-England Biolabs). The resulting assembly is PCR amplified to add the final gates and assembled into a pBAD vector with appropriate gates.</p></sec><sec id="S21"><title>FACS sorting</title><p id="P36"><italic>E. coli</italic> BL21 (DE3) (E. cloni EXPRESS BL21 (DE3), Lucigen) cells were transformed with the pBAD plasmids containing the libraries and grown overnight. Transformation efficiency was estimated by plating serial dilutions of the transformed bacteria, ensuring that, for each library, the number of transformed cells was at least tenfold higher than the designed library size. 1 μl from each transformation was plated in dilution to estimate transformation efficiency. Cells were diluted 1:200 in 2YT media, grown to 0.6-8OD, induced using 0.2% arabinose, and shaken at 20°C overnight. Induced cultures were transferred to 4°C for another night to allow maturation. Cells were centrifuged at 3000RPM for 10 minutes, decanted, and resuspended with cold PBS twice. The cells were then sorted using a FACS AriaIII (BD Biosciences) with a 70 μm diameter nozzle and a cell flow rate of 10,000-20,000 events per second. A preliminary sorting gate was done on forward scatter (FSC) Vs. side scatter (SSC) parameters to select single bacteria cells alongside the AlexaFluor488 (excitation at 488 nm, emission detection at 530±15 nm) and AmCyan (excitation at 405 nm, emission detection at 525±25 nm) channels. Sorted cells were collected in SOC media (2.5 mM KCl, 20 mM glucose, 0.5% yeast extract, 2% tryptone, 10 mM MgCl2, 10 mM MgSO4, and 10 mM NaCl), grown overnight at 37°C and transferred to 2YT supplemented with ampicillin. Plasmids were extracted by mini-prep (Qiagen).</p><p id="P37">Plasmids from sorted populations were extracted by min-prep, transformed and sorted again (using the smae procedure) to reduce false-positives.</p></sec><sec id="S22"><title>Deep sequencing</title><p id="P38">Plasmids from presorted and sorted populations were PCR amplified using primers to generate 590bp amplicons, containing all variable positions excluding position 16 (forward primer: GGGCGATGCCACCTACGGCAAG and Reverse primer: GAGTGATCCCGGCGGCCTC). Amplicon libraries were prepared at the Weizmann Institute’s Israel National Center for Personalized Medicine. Libraries were prepared from 20 ng of DNA, as previously described<sup><xref ref-type="bibr" rid="R65">65</xref></sup>. Libraries were quantified by Qubit (Thermo fisher scientific) and TapeStation (Agilent). Sequencing was done on a Miseq instrument (Illumina) using a V3 600 cycles kit, using paired-end sequencing. Sequences were analyzed using the LAST software package and python<sup><xref ref-type="bibr" rid="R66">66</xref>,<xref ref-type="bibr" rid="R67">67</xref></sup>. Fastq sequences were aligned to all designed oligos using the LAST align function. Sequences were consequently filtered for low LAST scores, and assigned to the best aligned oligo. Pair-end reads were identified using MiSeq UMIs (unique molecular identifiers). Enrichment values were calculated as the ratio between read frequencies in the sorted and appropriate unsorted samples. The presorted libraries are too large to be completely covered by the deep sequencing analysis. We, therefore, did not expect to detect all combinations, specifically in the nohbonds library. However, given that the transformation efficiency was greater than 5x10<sup>7</sup>, and &gt; 10<sup>8</sup> cells were sorted by FACS, it is likely that the majority of the functional designs were recovered. We thus considered all sequences found solely in the sorted samples to be enriched.</p><p id="P39">The sorted library will be deposited in AddGene upon publication.</p></sec><sec id="S23"><title>Cloning of single designs</title><p id="P40">Genes encoding for selected designs were ordered from Twist Bioscience and codon-optimized for <italic>E. coli</italic>. Genes were inserted in the pET28 vector using <italic>BsaI</italic> restriction sites previously cloned using QuickChange. All plasmids were sequence verified. Designs selected directly from FACS sorting were transferred from the pBAD vector into pET28 by PCR amplifying the insert with primers and adding <italic>BsaI</italic> recognition sites. Amplicons were purified and inserted into a pET28 vector with <italic>BsaI</italic> insertion sites using Golden Gate assembly. All plasmids were individually verified using Sanger sequencing.</p></sec><sec id="S24"><title>Protein expression &amp; purification</title><p id="P41">pET28 plasmids containing the relevant insert were transformed into BL21 (DE3) cells and grown overnight. Overnight cultures were diluted 1:100 in 10ml conical tubes containing 2YT and 50ug/ml kanamycin, grown to OD=0.6-8, induced using 1mM IPTG, and shaken overnight at 20°C. After expression, samples were shaken at 4°C to maximize chromophore maturation. Samples were centrifuged at 4000RPM for 20 minutes at 4°C and resuspended in 1ml lysis buffer containing PBS, 0.01% Triton x100, 0.02% Benzonase, 0.1% protease inhibitor cocktail, and 0.1mg/ml lysozyme. Samples were then sonicated and centrifuged at 14,000RPM at 4°C for 45 minutes. 500μl Ni-NTA beads per sample were resuspended in PBS and allocated into an appropriate number of 1.7ml tubes. The supernatant of each sample was transferred to a tube containing 500μl Ni-NTA beads and 10mM imidazole. Samples were shaken at room temperature for two hours for binding, centrifuged at 3,000 RPM for 3 minutes, and the supernatant was removed. Beads were resuspended in PBS with 20mM imidazole and shaken for 30 minutes at room temperature. Samples were centrifuged again at 3,000RPM for 3 minutes, and the supernatant was removed. Samples were eluted using PBS with 500mM imidazole, shaken for 1 hour at room temperature, and centrifuged at 3,000 RPM for 5 minutes. The supernatant was recovered and kept at 4°C. Protein purity was estimated by SDS-PAGE gel electrophoresis, and protein concentration was determined using NanoDrop One (Thermo Scientific).</p></sec><sec id="S25"><title>Functional thermostability</title><p id="P42">Functional thermostability was measured similarly to SYPRO orange measurements<sup><xref ref-type="bibr" rid="R68">68</xref></sup>. 10μM of each design were diluted in PBS in triplicates and placed in a 96-well plate (20 MicroAmp Fast Optical 96W Reaction Plate, Thermo Fisher, and MicroAmp Optical Adhesive Film). A ViiA7 real-time PCR instrument (Applied Biosystems) was used to measure fluorescence during heating from 25-99.9°C at 0.05°C/second. Raw data were analyzed using Python to find the temperature at which fluorescence was 50% of the max for each well.</p></sec><sec id="S26"><title>Fluorescence lifetime</title><p id="P43">Fluorescence lifetime measurements were performed using a MicroTime200 optical setup. GFP samples were placed as drops on top of 175 μm glass slides (Precision Cover Glass No:1.5H, Marienfeld), mounted on an inverted microscope (IX83 inverted, Olympus) with a 60X water immersion objective (UPlanSApo, Superapochromat, Olympus. A 485 nm pulsed-interleaved excitation laser (LDH-D-C-485, PicoQuant) with a repetition rate of 20MHz (50 ns) was directed via a dichroic mirror (ZT473/594rpc, Chroma) and focused ~10 μm into the sample. The fluorescence emission signal passed through a 50 μm pinhole and an emission filter (HC520/35, Semrock). Photons were focused into a single-photon avalanche diode (SPCM-AQRH-14-TR, Excelitas) coupled to a counting module (PicoHarp 400, PicoQuant), and time-correlated single-photon counting (TCSPC) histograms were generated. Each sample was measured for 1-5 min with laser intensities between 2-20 μW, adjusted using OD filters to reach a photon count rate of ~20 kHz. The profile for the instrument response function (IRF) was obtained by measuring scattered light from a mirror. The fluorescence decay curves were fitted with a bi-exponential fluorescence decay model by iterative IRF-reconvolution to extract the characteristic lifetimes and weights of the GFP designs.</p></sec><sec id="S27"><title>Photobleaching</title><p id="P44">Photobleaching was measured similarly as previously described<sup><xref ref-type="bibr" rid="R69">69</xref></sup>. A final concentration of 1μM of each variant was embedded in polyacrylamide gels (168μl 30% acrylamide/bis-acrylamide, 25μl PBS, 0.5μl TEMED, and 3μl 10% APS and 57μl fluorescent protein in PBS) inside 8-well microscope slides (ibidi No. 80826). Slides were mounted to Eclipse TI-E Nikon inverted microscope (Nikon Instruments Inc., Melville, NY) with Plan Apo DIC 60X/1.4 NA objective and equipped with a cooled electron-multiplying charge-coupled device camera (IXON ULTRA 888; Andor). The measurement consisted of six repetitions of exposure to the strongest available LED light at either 405 or 488nm for 15 minutes while capturing an image every five seconds. Images were analyzed using ImageJ to recover the mean intensity from each frame. A bi-exponential function was fitted to normalized brightness as a function of exposure time. The weighted average of the exponential coefficients was calculated. Outliers were removed, and at least three measurements were used to calculate means and standard deviations.</p></sec><sec id="S28"><title>Fluorescence spectra and quantum yield</title><p id="P45">Proteins were diluted in PBS to OD 0.05 at either 450 or 400nm in disposable fluorescence cuvettes (ordered from Alex Red No CUV010015) in triplicates. OD was measured on a Cary 60 UV-Vis spectrophotometer (Agilent Technologies) from 300 to 650nm. Both emission and excitation spectra were measured with the same samples on a fluorescence spectrophotometer (Varian Cary Eclipse). Quantum yield was calculated using the relative method described in the literature<sup><xref ref-type="bibr" rid="R69">69</xref>,<xref ref-type="bibr" rid="R70">70</xref></sup>. Briefly, the ratio between absorbance at the excitation wavelength and the integral of emission spectra are measured for each sample and a standard with known quantum yield. Fluorescein and 1-aminoanthracene were used as standards for measurements at excitation wavelengths 450 and 400nm, respectively.</p></sec><sec id="S29"><title>pH sensitivity</title><p id="P46">Buffers at pH ranging from 3.0 to 10 were prepared as previously reported<sup><xref ref-type="bibr" rid="R69">69</xref></sup>. 100μl of pH buffer were placed in black flat-bottom 96-well plates (Greiner Bio-One, No 655090), and 2μg of fluorescent proteins were added. Samples were incubated at room temperature for one hour, and fluorescence at both 405 and 488mn and emission at 520nm was measured for all wells (Infinite M Plex, Tecan).</p></sec><sec id="S30"><title>Multipoint mutants from other GFP datasets</title><p id="P47">To compare the GFP variants considered here with that studied earlier, we extracted from previous works (refs. 17,18) sequences and fluorescences of variants having mutations in the chromophore pocket positions only (corresponding to 2WUR GFP positions 14, 16, 18, 42, 44, 46, 61, 62, 63, 64, 66, 68, 69, 72, 92, 94, 96, 108, 110, 112, 119, 121, 123, 145, 148, 150, 163, 165, 167, 181, 183, 185, 201, 203, 205, 220, 222, 224). The four GFP variants are <italic>Aequorea victoria</italic> GFP (avGFP<sup><xref ref-type="bibr" rid="R4">4</xref></sup>), <italic>Aequorea macrodactyla</italic> GFP (amacGFP<sup><xref ref-type="bibr" rid="R3">3</xref></sup>), <italic>Clytia gregaria</italic> (cgreGFP<sup><xref ref-type="bibr" rid="R3">3</xref></sup>), and <italic>Pontellina plumata</italic> GFP (ppluGFP<sup><xref ref-type="bibr" rid="R3">3</xref></sup>). Our reference GFP sequence was aligned to the alignment of the avGFP, amacGFP, cgreGFP, and ppluGFP.</p></sec><sec id="S31"><title>Fluorescence Vs. the number of mutations in the active site</title><p id="P48">The fluorescence <italic>F</italic> of different GFP variants was fit to the exponential-decline and negative-epistasis function<sup><xref ref-type="bibr" rid="R39">39</xref></sup>: <disp-formula id="FD2"><label>(1)</label><mml:math id="M3"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mo>α</mml:mo><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mo>−</mml:mo><mml:mo>β</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P49">To get a clearer interpretation of the coefficients <italic>α</italic> and <italic>α</italic>, we have rewritten the <xref ref-type="disp-formula" rid="FD2">Eq. (1)</xref> as: <disp-formula id="FD3"><label>(2)</label><mml:math id="M4"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mi>A</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mi>B</mml:mi><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P50">Where A = α − β is responsible for robustness, and <italic>B =</italic> 2β is responsible for the epistasis. We required <italic>A</italic> ≥ 0 and <italic>B ≥</italic> 0. The analysis is provided as a Jupyter notebook ‘GFP_threshold_epistasis.ipynb’.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Biophysical characterization of the individually tested designs.</label><media xlink:href="EMS155711-supplement-Biophysical_characterization_of_the_individually_tested_designs_.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d32aAdEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Information</label><media xlink:href="EMS155711-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d32aAdEcB" position="anchor"/></supplementary-material></sec></body><back><ack id="S32"><title>Acknowledgments</title><p>We thank Moshe Goldsmith, Robert Campbell, and Yi Shen for helpful advice and Olga Khersonsky and Shiran Barber-Zucker for critical reading. Research in the Fleishman lab was supported by the Volkswagen Foundation (94747), the Israel Science Foundation (1844), the European Research Council through a Consolidator Award (815379), the Dr. Barry Sherman Institute for Medicinal Chemistry, and a donation in memory of Sam Switzer. Research in the McCandlish lab was supported by NIH grant R35GM133613, an Alfred P. Sloan Research Fellowship, and additional funding from the Simons Center for Quantitative Biology at Cold Spring Harbor Laboratory.</p></ack><sec id="S33" sec-type="data-availability"><title>Data availability</title><p id="P51">All sorted and presorted libraries, together with designs of special interest, were deposited to AddGene (deposit number 81660). Deep-sequencing data is available on figshare at 10.6084/m9.figshare.21922365.</p><sec id="S34" sec-type="data-availability"><title>Code availability</title><p id="P52">Jupyter notebooks for the evolutionary analysis can be found at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/cmartiga/gfp_core/src/master">https://bitbucket.org/cmartiga/gfp_core/src/master</ext-link>. Jupyter notebooks, including data, for other analyses and the htFuncLib algorithm, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Fleishman-Lab/htFuncLib">https://github.com/Fleishman-Lab/htFuncLib</ext-link>.</p></sec></sec><ref-list><title>Bibliography</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldenzweig</surname><given-names>A</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name></person-group><article-title>Principles of Protein Stability and Their Application in Computational Design</article-title><source>Annu Rev Biochem</source><year>2018</year><volume>87</volume><fpage>105</fpage><lpage>129</lpage><pub-id pub-id-type="pmid">29401000</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoichet</surname><given-names>BK</given-names></name><name><surname>Baase</surname><given-names>Wa</given-names></name><name><surname>Kuroki</surname><given-names>R</given-names></name><name><surname>Matthews</surname><given-names>BW</given-names></name></person-group><article-title>A relationship between protein stability and protein function</article-title><source>Proceedings of the National Academy of Sciences</source><year>1995</year><volume>92</volume><fpage>452</fpage><lpage>456</lpage><pub-id pub-id-type="pmcid">PMC42758</pub-id><pub-id pub-id-type="pmid">7831309</pub-id><pub-id pub-id-type="doi">10.1073/pnas.92.2.452</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Somermeyer</surname><given-names>LG</given-names></name><etal/></person-group><article-title>Heterogeneity of the GFP fitness landscape and data-driven protein design</article-title><source>eLife</source><year>2022</year><volume>11</volume><pub-id pub-id-type="pmcid">PMC9119679</pub-id><pub-id pub-id-type="pmid">35510622</pub-id><pub-id pub-id-type="doi">10.7554/eLife.75842</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkisyan</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Local fitness landscape of the green fluorescent protein</article-title><source>Nature</source><year>2016</year><volume>533</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="pmcid">PMC4968632</pub-id><pub-id pub-id-type="pmid">27193686</pub-id><pub-id pub-id-type="doi">10.1038/nature17995</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaser</surname><given-names>F</given-names></name><name><surname>Rosenberg</surname><given-names>Y</given-names></name><name><surname>Kessel</surname><given-names>A</given-names></name><name><surname>Pupko</surname><given-names>T</given-names></name><name><surname>Ben-Tal</surname><given-names>N</given-names></name></person-group><article-title>The ConSurf-HSSP database: the mapping of evolutionary conservation among homologs onto PDB structures</article-title><source>Proteins</source><year>2005</year><volume>58</volume><fpage>610</fpage><lpage>617</lpage><pub-id pub-id-type="pmid">15614759</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blomberg</surname><given-names>R</given-names></name><etal/></person-group><article-title>Precision is essential for efficient catalysis in an evolved Kemp eliminase</article-title><source>Nature</source><year>2013</year><volume>503</volume><fpage>418</fpage><lpage>421</lpage><pub-id pub-id-type="pmid">24132235</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tokuriki</surname><given-names>N</given-names></name><name><surname>Stricher</surname><given-names>F</given-names></name><name><surname>Serrano</surname><given-names>L</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name></person-group><article-title>How Protein Stability and New Functions Trade Off</article-title><source>PLoS Comput Biol</source><year>2008</year><volume>4</volume><pub-id pub-id-type="pmcid">PMC2265470</pub-id><pub-id pub-id-type="pmid">18463696</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000002</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilding</surname><given-names>M</given-names></name><name><surname>Hong</surname><given-names>N</given-names></name><name><surname>Spence</surname><given-names>M</given-names></name><name><surname>Buckle</surname><given-names>AM</given-names></name><name><surname>Jackson</surname><given-names>CJ</given-names></name></person-group><article-title>Protein engineering: the potential of remote mutations</article-title><source>Biochem Soc Trans</source><year>2019</year><volume>47</volume><fpage>701</fpage><lpage>711</lpage><pub-id pub-id-type="pmid">30902926</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whitehead</surname><given-names>TA</given-names></name><etal/></person-group><article-title>Optimization of affinity, specificity and function of designed influenza inhibitors using deep sequencing</article-title><source>Nat Biotechnol</source><year>2012</year><volume>30</volume><fpage>543</fpage><lpage>548</lpage><pub-id pub-id-type="pmcid">PMC3638900</pub-id><pub-id pub-id-type="pmid">22634563</pub-id><pub-id pub-id-type="doi">10.1038/nbt.2214</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fowler</surname><given-names>DM</given-names></name><etal/></person-group><article-title>High-resolution mapping of protein sequence-function relationships</article-title><source>Nat Methods</source><year>2010</year><volume>7</volume><fpage>741</fpage><lpage>746</lpage><pub-id pub-id-type="pmcid">PMC2938879</pub-id><pub-id pub-id-type="pmid">20711194</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.1492</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>D</given-names></name></person-group><article-title>An exciting but challenging road ahead for computational enzyme design</article-title><source>Protein Sci</source><year>2010</year><volume>19</volume><fpage>1817</fpage><lpage>1819</lpage><pub-id pub-id-type="pmcid">PMC2998717</pub-id><pub-id pub-id-type="pmid">20717908</pub-id><pub-id pub-id-type="doi">10.1002/pro.481</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Campbell</surname><given-names>RE</given-names></name><name><surname>Harrison</surname><given-names>DJ</given-names></name></person-group><article-title>A single-phase flow microfluidic cell sorter for multiparameter screening to assist the directed evolution of Ca2+ sensors</article-title><source>Lab Chip</source><year>2019</year><volume>19</volume><fpage>3880</fpage><lpage>3887</lpage><pub-id pub-id-type="pmid">31641712</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ai</surname></name><name><surname>Henderson</surname></name><name><surname>Remington</surname></name></person-group><article-title>Directed evolution of a monomeric, bright and photostable version of Clavularia cyan fluorescent protein: structural characterization and applications in fluorescence</article-title><source>Biochem Biophys Res Commun</source><pub-id pub-id-type="pmcid">PMC1698604</pub-id><pub-id pub-id-type="pmid">16859491</pub-id><pub-id pub-id-type="doi">10.1042/BJ20060874</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Platisa</surname><given-names>J</given-names></name><name><surname>Vasan</surname><given-names>G</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><name><surname>Pieribone</surname><given-names>VA</given-names></name></person-group><article-title>Directed Evolution of Key Residues in Fluorescent Protein Inverses the Polarity of Voltage Sensitivity in the Genetically Encoded Indicator ArcLight</article-title><source>ACS Chem Neurosci</source><year>2017</year><volume>8</volume><fpage>513</fpage><lpage>523</lpage><pub-id pub-id-type="pmcid">PMC5355904</pub-id><pub-id pub-id-type="pmid">28045247</pub-id><pub-id pub-id-type="doi">10.1021/acschemneuro.6b00234</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breen</surname><given-names>MS</given-names></name><name><surname>Kemena</surname><given-names>C</given-names></name><name><surname>Vlasov</surname><given-names>PK</given-names></name><name><surname>Notredame</surname><given-names>C</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><article-title>Epistasis as the primary factor in molecular evolution</article-title><source>Nature</source><year>2012</year><volume>490</volume><fpage>535</fpage><lpage>538</lpage><pub-id pub-id-type="pmid">23064225</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domingo</surname><given-names>J</given-names></name><name><surname>Baeza-Centurion</surname><given-names>P</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>The Causes and Consequences of Genetic Interactions (Epistasis)</article-title><source>Annu Rev Genomics Hum Genet</source><year>2019</year><volume>20</volume><fpage>433</fpage><lpage>460</lpage><pub-id pub-id-type="pmid">31082279</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starr</surname><given-names>TN</given-names></name><name><surname>Thornton</surname><given-names>JW</given-names></name></person-group><article-title>Epistasis in protein evolution</article-title><source>Protein Sci</source><year>2016</year><volume>25</volume><fpage>1204</fpage><lpage>1218</lpage><pub-id pub-id-type="pmcid">PMC4918427</pub-id><pub-id pub-id-type="pmid">26833806</pub-id><pub-id pub-id-type="doi">10.1002/pro.2897</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Watson</surname><given-names>RA</given-names></name><name><surname>Chao</surname><given-names>L</given-names></name></person-group><article-title>Perspective: Sign Epistasis and Genetic Costraint on Evolutionary Trajectories</article-title><source>Evolution</source><year>2005</year><volume>59</volume><fpage>1165</fpage><lpage>1174</lpage><pub-id pub-id-type="pmid">16050094</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><year>2006</year><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="pmid">16601193</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miton</surname><given-names>CM</given-names></name><name><surname>Tokuriki</surname><given-names>N</given-names></name></person-group><article-title>How mutational epistasis impairs predictability in protein evolution and design</article-title><source>Protein Sci</source><year>2016</year><volume>25</volume><fpage>1260</fpage><lpage>1272</lpage><pub-id pub-id-type="pmcid">PMC4918425</pub-id><pub-id pub-id-type="pmid">26757214</pub-id><pub-id pub-id-type="doi">10.1002/pro.2876</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopf</surname><given-names>TA</given-names></name><etal/></person-group><article-title>Mutation effects predicted from sequence co-variation</article-title><source>Nat Biotechnol</source><year>2017</year><volume>35</volume><fpage>128</fpage><lpage>135</lpage><pub-id pub-id-type="pmcid">PMC5383098</pub-id><pub-id pub-id-type="pmid">28092658</pub-id><pub-id pub-id-type="doi">10.1038/nbt.3769</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>LI</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title><source>Elife</source><year>2013</year><volume>2</volume><elocation-id>e00631</elocation-id><pub-id pub-id-type="pmcid">PMC3654441</pub-id><pub-id pub-id-type="pmid">23682315</pub-id><pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dellus-Gur</surname><given-names>E</given-names></name><etal/></person-group><article-title>Negative Epistasis and Evolvability in TEM-1 β-Lactamase—The Thin Line between an Enzyme's Conformational Freedom and Disorder</article-title><source>J Mol Biol</source><year>2015</year><volume>427</volume><fpage>2396</fpage><lpage>2409</lpage><pub-id pub-id-type="pmcid">PMC4718737</pub-id><pub-id pub-id-type="pmid">26004540</pub-id><pub-id pub-id-type="doi">10.1016/j.jmb.2015.05.011</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khersonsky</surname><given-names>O</given-names></name><etal/></person-group><article-title>Automated Design of Efficient and Functionally Diverse Enzyme Repertoires</article-title><source>Mol Cell</source><year>2018</year><volume>72</volume><fpage>178</fpage><lpage>186</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="pmcid">PMC6193528</pub-id><pub-id pub-id-type="pmid">30270109</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2018.08.033</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhlman</surname><given-names>B</given-names></name><name><surname>Bradley</surname><given-names>P</given-names></name></person-group><article-title>Advances in protein structure prediction and design</article-title><source>Nat Rev Mol Cell Biol</source><year>2019</year><volume>20</volume><fpage>681</fpage><lpage>697</lpage><pub-id pub-id-type="pmcid">PMC7032036</pub-id><pub-id pub-id-type="pmid">31417196</pub-id><pub-id pub-id-type="doi">10.1038/s41580-019-0163-x</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khersonsky</surname><given-names>O</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name></person-group><article-title>What Have We Learned from Design of Function in Large Proteins?</article-title><source>BioDesign Research</source><year>2022</year><volume>2022</volume><fpage>1</fpage><lpage>11</lpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakhomov</surname><given-names>AA</given-names></name><name><surname>Martynov</surname><given-names>VI</given-names></name></person-group><article-title>GFP family: structural insights into spectral tuning</article-title><source>Chem Biol</source><year>2008</year><volume>15</volume><fpage>755</fpage><lpage>764</lpage><pub-id pub-id-type="pmid">18721746</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriguez</surname><given-names>EA</given-names></name><etal/></person-group><article-title>The Growing and Glowing Toolbox of Fluorescent and Photoactive Proteins</article-title><source>Trends Biochem Sci</source><year>2017</year><volume>42</volume><fpage>111</fpage><lpage>129</lpage><pub-id pub-id-type="pmcid">PMC5272834</pub-id><pub-id pub-id-type="pmid">27814948</pub-id><pub-id pub-id-type="doi">10.1016/j.tibs.2016.09.010</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname><given-names>FJ</given-names></name><name><surname>Socolich</surname><given-names>M</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Learning the pattern of epistasis linking genotype and phenotype in a protein</article-title><source>Nature Communications</source><year>2019</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC6746860</pub-id><pub-id pub-id-type="pmid">31527666</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-12130-8</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cormack</surname><given-names>BP</given-names></name><name><surname>Valdivia</surname><given-names>RH</given-names></name><name><surname>Falkow</surname><given-names>S</given-names></name></person-group><article-title>FACS-optimized mutants of the green fluorescent protein (GFP)</article-title><source>Gene</source><year>1996</year><volume>173</volume><fpage>33</fpage><lpage>38</lpage><pub-id pub-id-type="pmid">8707053</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unger-Angel</surname><given-names>L</given-names></name><etal/></person-group><article-title>Protein recognition by bivalent, ‘turn-on’ fluorescent molecular probes</article-title><source>Chemical Science</source><year>2015</year><volume>6</volume><fpage>5419</fpage><lpage>5425</lpage><pub-id pub-id-type="pmcid">PMC5502391</pub-id><pub-id pub-id-type="pmid">28717444</pub-id><pub-id pub-id-type="doi">10.1039/c5sc01038a</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ai</surname><given-names>H-W</given-names></name><name><surname>Shaner</surname><given-names>NC</given-names></name><name><surname>Cheng</surname><given-names>Z</given-names></name><name><surname>Tsien</surname><given-names>RY</given-names></name><name><surname>Campbell</surname><given-names>RE</given-names></name></person-group><article-title>Exploration of new chromophore structures leads to the identification of improved blue fluorescent proteins</article-title><source>Biochemistry</source><year>2007</year><volume>46</volume><fpage>5904</fpage><lpage>5910</lpage><pub-id pub-id-type="pmid">17444659</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bandyopadhyay</surname><given-names>B</given-names></name><etal/></person-group><article-title>Local energetic frustration affects the dependence of green fluorescent protein folding on the chaperonin GroEL</article-title><source>J Biol Chem</source><year>2017</year><volume>292</volume><fpage>20583</fpage><lpage>20591</lpage><pub-id pub-id-type="pmcid">PMC5733594</pub-id><pub-id pub-id-type="pmid">29066625</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M117.808576</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinstein</surname><given-names>J</given-names></name><name><surname>Khersonsky</surname><given-names>O</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name></person-group><article-title>Practically useful protein-design methods combining phylogenetic and atomistic calculations</article-title><source>Curr Opin Struct Biol</source><year>2020</year><volume>63</volume><fpage>58</fpage><lpage>64</lpage><pub-id pub-id-type="pmcid">PMC7289631</pub-id><pub-id pub-id-type="pmid">32505941</pub-id><pub-id pub-id-type="doi">10.1016/j.sbi.2020.04.003</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>TJ</given-names></name></person-group><article-title>FPbase: a community-editable fluorescent protein database</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>277</fpage><lpage>278</lpage><pub-id pub-id-type="pmid">30886412</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lipsh-Sokolik</surname><given-names>R</given-names></name><etal/></person-group><article-title>Combinatorial assembly and design of enzymes</article-title><source>Science</source><year>2023</year><volume>379</volume><fpage>195</fpage><lpage>201</lpage><pub-id pub-id-type="pmid">36634164</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engler</surname><given-names>C</given-names></name><name><surname>Kandzia</surname><given-names>R</given-names></name><name><surname>Marillonnet</surname><given-names>S</given-names></name></person-group><article-title>A one pot, step one, precision cloning method with high throughput capability</article-title><source>PLoS One</source><year>2008</year><volume>3</volume><elocation-id>e3647</elocation-id><pub-id pub-id-type="pmcid">PMC2574415</pub-id><pub-id pub-id-type="pmid">18985154</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0003647</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloom</surname><given-names>JD</given-names></name><name><surname>Labthavikul</surname><given-names>ST</given-names></name><name><surname>Otey</surname><given-names>CR</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><article-title>Protein stability promotes evolvability</article-title><source>Proc Natl Acad Sci U S A</source><year>2006</year><volume>103</volume><fpage>5869</fpage><lpage>5874</lpage><pub-id pub-id-type="pmcid">PMC1458665</pub-id><pub-id pub-id-type="pmid">16581913</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0510098103</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bershtein</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>M</given-names></name><name><surname>Bekerman</surname><given-names>R</given-names></name><name><surname>Tokuriki</surname><given-names>N</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name></person-group><article-title>Robustness–epistasis link shapes the fitness landscape of a randomly drifting protein</article-title><source>Nature</source><year>2006</year><volume>444</volume><fpage>929</fpage><lpage>932</lpage><pub-id pub-id-type="pmid">17122770</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Esvelt</surname><given-names>KM</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><article-title>Low-N protein engineering with data-efficient deep learning</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>389</fpage><lpage>396</lpage><pub-id pub-id-type="pmid">33828272</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Borg</surname><given-names>I</given-names></name><name><surname>Groenen</surname><given-names>PJF</given-names></name></person-group><source>Modern Multidimensional Scaling: Theory and Applications</source><publisher-name>Springer Science &amp; Business Media</publisher-name><year>2005</year></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mccandlish</surname><given-names>DM</given-names></name></person-group><article-title>Visualizing fitness landscapes</article-title><source>Evolution</source><year>2011</year><volume>65</volume><fpage>1544</fpage><lpage>1558</lpage><pub-id pub-id-type="pmcid">PMC3668694</pub-id><pub-id pub-id-type="pmid">21644947</pub-id><pub-id pub-id-type="doi">10.1111/j.1558-5646.2011.01236.x</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pédelacq</surname><given-names>J-D</given-names></name><name><surname>Cabantous</surname><given-names>S</given-names></name><name><surname>Tran</surname><given-names>T</given-names></name><name><surname>Terwilliger</surname><given-names>TC</given-names></name><name><surname>Waldo</surname><given-names>GS</given-names></name></person-group><article-title>Engineering and characterization of a superfolder green fluorescent protein</article-title><source>Nat Biotechnol</source><year>2006</year><volume>24</volume><fpage>79</fpage><lpage>88</lpage><pub-id pub-id-type="pmid">16369541</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frenzel</surname><given-names>E</given-names></name><name><surname>Legebeke</surname><given-names>J</given-names></name><name><surname>van Stralen</surname><given-names>A</given-names></name><name><surname>van Kranenburg</surname><given-names>R</given-names></name><name><surname>Kuipers</surname><given-names>OP</given-names></name></person-group><article-title>In vivo selection of sfGFP variants with improved and reliable functionality in industrially important thermophilic bacteria</article-title><source>Biotechnol Biofuels</source><year>2018</year><volume>11</volume><fpage>8</fpage><pub-id pub-id-type="pmcid">PMC5771013</pub-id><pub-id pub-id-type="pmid">29371884</pub-id><pub-id pub-id-type="doi">10.1186/s13068-017-1008-5</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henche</surname><given-names>A-L</given-names></name><name><surname>Koerdt</surname><given-names>A</given-names></name><name><surname>Ghosh</surname><given-names>A</given-names></name><name><surname>Albers</surname><given-names>S-V</given-names></name></person-group><article-title>Influence of cell surface structures on crenarchaeal biofilm formation using a thermostable green fluorescent protein</article-title><source>Environ Microbiol</source><year>2012</year><volume>14</volume><fpage>779</fpage><lpage>793</lpage><pub-id pub-id-type="pmid">22059595</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banerjee</surname><given-names>S</given-names></name><etal/></person-group><article-title>Mispacking and the Fitness Landscape of the Green Fluorescent Protein Chromophore Milieu</article-title><source>Biochemistry</source><year>2017</year><volume>56</volume><fpage>736</fpage><lpage>747</lpage><pub-id pub-id-type="pmcid">PMC6193456</pub-id><pub-id pub-id-type="pmid">28074648</pub-id><pub-id pub-id-type="doi">10.1021/acs.biochem.6b00800</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cotlet</surname><given-names>M</given-names></name><name><surname>Goodwin</surname><given-names>PM</given-names></name><name><surname>Waldo</surname><given-names>GS</given-names></name><name><surname>Werner</surname><given-names>JH</given-names></name></person-group><article-title>A Comparison of the Fluorescence Dynamics of Single Molecules of a Green Fluorescent Protein: One-versus Two-Photon Excitation</article-title><source>ChemPhysChem</source><year>2006</year><volume>7</volume><fpage>250</fpage><lpage>260</lpage><pub-id pub-id-type="pmid">16353266</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname><given-names>BC</given-names></name><name><surname>Petsko</surname><given-names>GA</given-names></name><name><surname>Liu</surname><given-names>CF</given-names></name></person-group><article-title>Crystal Structure of Green Fluorescent Protein Clover and Design of Clover-Based Redox Sensors</article-title><source>Structure</source><year>2018</year><volume>26</volume><fpage>225</fpage><lpage>237</lpage><elocation-id>e3</elocation-id><pub-id pub-id-type="pmid">29307487</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lac</surname><given-names>A</given-names></name><name><surname>Le Lam</surname><given-names>A</given-names></name><name><surname>Heit</surname><given-names>B</given-names></name></person-group><article-title>Optimizing Long-Term Live Cell Imaging</article-title><source>Methods Mol Biol</source><year>2022</year><volume>2440</volume><fpage>57</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">35218532</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snapp</surname><given-names>EL</given-names></name><name><surname>Altan</surname><given-names>N</given-names></name><name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name></person-group><article-title>Measuring protein mobility by photobleaching GFP chimeras in living cells</article-title><source>Curr Protoc Cell Biol</source><year>2003</year><volume>Chapter 21</volume><comment>Unit 21.1</comment><pub-id pub-id-type="pmid">18228432</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russ</surname><given-names>WP</given-names></name><etal/></person-group><article-title>An evolution-based model for designing chorismate mutase enzymes</article-title><source>Science</source><year>2020</year><volume>369</volume><fpage>440</fpage><lpage>445</lpage><pub-id pub-id-type="pmid">32703877</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freschlin</surname><given-names>CR</given-names></name><name><surname>Fahlberg</surname><given-names>SA</given-names></name><name><surname>Romero</surname><given-names>PA</given-names></name></person-group><article-title>Machine learning to navigate fitness landscapes for protein engineering</article-title><source>Curr Opin Biotechnol</source><year>2022</year><volume>75</volume><elocation-id>102713</elocation-id><pub-id pub-id-type="pmcid">PMC9177649</pub-id><pub-id pub-id-type="pmid">35413604</pub-id><pub-id pub-id-type="doi">10.1016/j.copbio.2022.102713</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>KK</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><article-title>Machine-learning-guided directed evolution for protein engineering</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>687</fpage><lpage>694</lpage><pub-id pub-id-type="pmid">31308553</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fox</surname><given-names>RJ</given-names></name><etal/></person-group><article-title>Improving catalytic function by ProSAR-driven enzyme evolution</article-title><source>Nat Biotechnol</source><year>2007</year><volume>25</volume><fpage>338</fpage><lpage>344</lpage><pub-id pub-id-type="pmid">17322872</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trudeau</surname><given-names>DL</given-names></name><name><surname>Tawfik</surname><given-names>DS</given-names></name></person-group><article-title>Protein engineers turned evolutionists—the quest for the optimal starting point</article-title><source>Current Opinion in Biotechnology</source><year>2019</year><volume>60</volume><fpage>46</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">30611116</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldenzweig</surname><given-names>A</given-names></name><etal/></person-group><article-title>Automated Structure-and Sequence-Based Design of Proteins for High Bacterial Expression and Stability</article-title><source>Mol Cell</source><year>2016</year><volume>63</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmcid">PMC4961223</pub-id><pub-id pub-id-type="pmid">27425410</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2016.06.012</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinstein</surname><given-names>JJ</given-names></name><name><surname>Goldenzweig</surname><given-names>A</given-names></name><name><surname>Hoch</surname><given-names>S-Y</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name></person-group><article-title>PROSS 2: a new server for the design of stable and highly expressed protein variants</article-title><source>Bioinformatics</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7611707</pub-id><pub-id pub-id-type="pmid">33367682</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1071</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name></person-group><article-title>Cd-hit: A fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1658</fpage><lpage>1659</lpage><pub-id pub-id-type="pmid">16731699</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>MUSCLE: Multiple sequence alignment with high accuracy and high throughput</article-title><source>Nucleic Acids Res</source><year>2004</year><volume>32</volume><fpage>1792</fpage><lpage>1797</lpage><pub-id pub-id-type="pmcid">PMC390337</pub-id><pub-id pub-id-type="pmid">15034147</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gertz</surname><given-names>EM</given-names></name><name><surname>Agarwala</surname><given-names>R</given-names></name><name><surname>Schäffer</surname><given-names>AA</given-names></name><name><surname>Yu</surname><given-names>Y-K</given-names></name></person-group><article-title>PSI-BLAST pseudocounts and the minimum description length principle</article-title><source>Nucleic Acids Res</source><year>2009</year><volume>37</volume><fpage>815</fpage><lpage>824</lpage><pub-id pub-id-type="pmcid">PMC2647318</pub-id><pub-id pub-id-type="pmid">19088134</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkn981</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fleishman</surname><given-names>SJ</given-names></name><etal/></person-group><article-title>RosettaScripts: a scripting language interface to the Rosetta macromolecular modeling suite</article-title><source>PLoS One</source><year>2011</year><volume>6</volume><elocation-id>e20161</elocation-id><pub-id pub-id-type="pmcid">PMC3123292</pub-id><pub-id pub-id-type="pmid">21731610</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0020161</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ke</surname></name><name><surname>Meng</surname></name><name><surname>Finley</surname></name><name><surname>Wang</surname></name></person-group><article-title>Lightgbm: A highly efficient gradient boosting decision tree</article-title><source>Adv Neural Inf Process Syst</source></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tareen</surname><given-names>A</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name></person-group><article-title>Logomaker: beautiful sequence logos in Python</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>2272</fpage><lpage>2274</lpage><pub-id pub-id-type="pmcid">PMC7141850</pub-id><pub-id pub-id-type="pmid">31821414</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btz921</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname></name><etal/></person-group><article-title>Scikit-learn: Machine Learning in Python</article-title><source>J Mach Learn Res</source></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blecher-Gonen</surname><given-names>R</given-names></name><etal/></person-group><article-title>High-throughput chromatin immunoprecipitation for genome-wide mapping of in vivo protein-DNA interactions and epigenomic states</article-title><source>Nat Protoc</source><year>2013</year><volume>8</volume><fpage>539</fpage><lpage>554</lpage><pub-id pub-id-type="pmid">23429716</pub-id></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kielbasa</surname><given-names>SM</given-names></name><name><surname>Wan</surname><given-names>R</given-names></name><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Horton</surname><given-names>P</given-names></name><name><surname>Frith</surname><given-names>MC</given-names></name></person-group><article-title>Adaptive seeds tame genomic sequence comparison</article-title><source>Genome Research</source><year>2011</year><volume>21</volume><fpage>487</fpage><lpage>493</lpage><comment>Preprint at</comment><pub-id pub-id-type="pmcid">PMC3044862</pub-id><pub-id pub-id-type="pmid">21209072</pub-id><pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frith</surname><given-names>MC</given-names></name><name><surname>Wan</surname><given-names>R</given-names></name><name><surname>Horton</surname><given-names>P</given-names></name></person-group><article-title>Incorporating sequence quality data into alignment improves DNA read mapping</article-title><source>Nucleic Acids Res</source><year>2010</year><volume>38</volume><fpage>e100</fpage><pub-id pub-id-type="pmcid">PMC2853142</pub-id><pub-id pub-id-type="pmid">20110255</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkq010</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huynh</surname><given-names>K</given-names></name><name><surname>Partch</surname><given-names>CL</given-names></name></person-group><article-title>Analysis of protein stability and ligand interactions by thermal shift assay</article-title><source>Curr Protoc Protein Sci</source><year>2015</year><volume>79</volume><elocation-id>28.9.1–28.9.14</elocation-id><pub-id pub-id-type="pmcid">PMC4332540</pub-id><pub-id pub-id-type="pmid">25640896</pub-id><pub-id pub-id-type="doi">10.1002/0471140864.ps2809s79</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cranfill</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>Quantitative assessment of fluorescent proteins</article-title><source>Nat Methods</source><year>2016</year><volume>13</volume><fpage>557</fpage><lpage>562</lpage><pub-id pub-id-type="pmcid">PMC4927352</pub-id><pub-id pub-id-type="pmid">27240257</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3891</pub-id></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fery-Forgues</surname><given-names>S</given-names></name><name><surname>Lavabre</surname><given-names>D</given-names></name></person-group><article-title>Are Fluorescence Quantum Yields So Tricky to Measure? A Demonstration Using Familiar Stationery Products</article-title><source>J Chem Educ</source><year>1999</year><volume>76</volume><elocation-id>1260</elocation-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Steps in applying htFuncLib to GFP.</title><p><bold>(A)</bold> 14 positions designed by htFuncLib are shown (PDB entry: 2WUR). <bold>(B)</bold> Red and blue backgrounds indicate representative neighborhoods centered around GFP amino acid positions 181 and 61, respectively. <bold>(C)</bold> The sequence space of each neighborhood is partially enumerated. Sequence representation of the two neighborhoods shown in (B). Only variable positions are shown for clarity. Color bars represent Rosetta energies. <bold>(D)</bold> EpiNNet top-ranked mutations are selected as the enriched sequence space. An atomistic verification step scores thousands of random combinations from the EpiNNet-enriched and the filtered sequence spaces. Nearly all designs in the EpiNNet sequence space are predicted to be more stable than PROSS-eGFP, compared to almost none in the filtered sequence space. Red triangles mark the mutable positions, and the number of mutations in each position is marked under the bar. <bold>(E)</bold> The designed library is cloned using Golden Gate assembly<sup><xref ref-type="bibr" rid="R37">37</xref></sup> of oligos that contain the desired mutations, expressed in <italic>E. coli</italic> cells, and <bold>(F)</bold> sorted by FACS.</p></caption><graphic xlink:href="EMS155711-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>htFuncLib selects mutations that combine to form low-energy designs.</title><p>(<bold>A</bold>) Energy distributions of the EpiNNet-enriched sequence space, the sequence space filtered by energy and phylogenetic criteria (Filtered), and unfiltered (all 20 amino acids at each position). &gt;95% of mutants in the EpiNNet-enriched combinatorial sequence space exhibit higher stability than PROSS-eGFP, compared to &lt;0.6% for the other spaces. 12,000 randomly selected sequences were modeled to generate each distribution. The dashed line signifies PROSS-eGFP energy. (<bold>B</bold>) Distributions of the energy difference between multipoint mutants and the sum of their constituent point mutations. (<bold>C</bold>) The number of functional designs according to FACS screening of libraries comprising an increasing number of top-ranked EpiNNet mutations is plotted as a function of the total number of designs detected in the deep-sequencing data. Points are color-coded according to the number of mutations that constitute the library. For example, a library of 25 top-ranked EpiNNet mutations that comprise ~10<sup>4</sup> designs would yield approximately 10<sup>3</sup> functional ones (dashed blue lines). The diagonal is the best fit to the data points. (<bold>D</bold>) Overlay of all mutations of the 25 top-ranked EpiNNet mutations from panel C. Despite the relatively small size of this library, it contains radical mutations, including Tyr145Met and Gln69Pro.</p></caption><graphic xlink:href="EMS155711-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>htFuncLib exposes a large space of functional multipoint active-site GFP variants.</title><p>Deep sequencing of htFuncLib libraries sorted by fluorescence revealed over 16,000 potentially active designs. (<bold>A</bold>) Frequency and number of functional variants with a given number of mutations (top and bottom, respectively). htFuncLib-NGS - all sequences obtained from deep sequencing of the sorted designs; htFuncLib-RF - the entire sequence space labeled by the random forest. The avGFP dataset was derived from Sarkisyan <italic>et al.<sup><xref ref-type="bibr" rid="R4">4</xref></sup></italic>. The amacGFP, cgreGFP, and ppluGFP datasets were derived from Somermeyer <italic>et al.<sup><xref ref-type="bibr" rid="R3">3</xref></sup></italic>. Lines represent fits to the data (points) according to <xref ref-type="disp-formula" rid="FD3">Eq. 2</xref> (see <xref ref-type="sec" rid="S8">Methods</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 8</xref>). Data excluded sequences with mutations outside of the chromophore pocket. (<bold>B</bold>) Distance-preserving dimensionality reduction analysis shows the relationships between GFP variants in FPBase<sup><xref ref-type="bibr" rid="R35">35</xref></sup>, Sarkisyan <italic>et al.<sup><xref ref-type="bibr" rid="R4">4</xref></sup></italic>, eUniRep<sup><xref ref-type="bibr" rid="R40">40</xref></sup>, and htFuncLib. The plot approximates the number of mutations between any pair of mutants<sup><xref ref-type="bibr" rid="R40">40</xref>,<xref ref-type="bibr" rid="R41">41</xref></sup>. PROSS-eGFP (and eGFP, which are nearly identical in the designed positions, <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 12</xref>) are marked by a cross for reference. Individually characterized htFuncLib designs are marked by purple circles. The number of sequences represented for each category is marked in parentheses. Variants with mutations outside the chromophore pocket were included, but these mutations were ignored when calculating distances.</p></caption><graphic xlink:href="EMS155711-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Global analysis of the GFP genotype-phenotype map shows high mutational contiguity among functional sequences.</title><p><bold>(A)</bold> Low-dimensional visualization of the sequence-function relationship predicted by the random forest model (see <xref ref-type="sec" rid="S8">Methods</xref>). Functional sequences are highlighted in different colors according to whether they are predicted to fluoresce in the GFP<sup>488/530</sup> channel (green), AmCyan<sup>405/525</sup> channel (blue), or both (gold). Lines join genotypes that are separated by a single amino acid substitution. <bold>(B)</bold> Site-frequency logos of functional sequences based on position along diffusion axis 2 (the three logos correspond to diffusion axis 2 coordinates greater than -0.5, between -0.5 and -2.25, and less than -2.25). <bold>(C)</bold> The proportion of functional sequences changes depending on the amino acids at positions 65 and 69. Gray lines indicate single amino acid substitutions. <bold>(D)</bold> Close-up of the region containing a cluster of observed sequences with unusual sequence properties. Highlighted dots indicate sequences that were directly characterized as functional in the high-throughput experiments, and black lines indicate single amino acid substitutions between these experimentally characterized sequences (see <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 9</xref> for a visualization of all sequences enriched in the high-throughput experiment). <bold>(E)</bold> Sequence logo representing the coefficients of the logistic regression models trained on random forest predictions to identify changes in allelic preferences when using all sequences for training (top) or only sequences within two mutations of the genotypes highlighted in panel D (bottom). Coefficients are expressed as additive allelic contributions (<italic>i.e</italic>., Δlog<sub>2</sub> odds ratios) that have been mean-centered by site.</p></caption><graphic xlink:href="EMS155711-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Functional diversity among htFuncLib designs.</title><p>(<bold>A</bold>) A subset of tested designs clustered by sequence similarity. The dashed line marks eGFP, error bars mark standard deviations. (<bold>B</bold>) Selected excitation and emission spectra in light and dark hues, respectively. The excitation spectra of several designs are considerably different from eGFP (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 14</xref>). (<bold>C &amp; D</bold>) Structural view of thermo.5 and slow.3. Each design exhibits six mutations from PROSS-eGFP). PROSS-eGFP and designs colored gray and orange, respectively.</p></caption><graphic xlink:href="EMS155711-f005"/></fig></floats-group></article>