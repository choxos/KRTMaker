<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS159135</article-id><article-id pub-id-type="doi">10.1101/2022.12.29.522182</article-id><article-id pub-id-type="archive">PPR589742</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A robust deep learning platform to predict CD8+ T-cell epitopes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lee</surname><given-names>Chloe H.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Huh</surname><given-names>Jaesung</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Buckley</surname><given-names>Paul R.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Jang</surname><given-names>Myeongjun</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Pinho</surname><given-names>Mariana Pereira</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fernandes</surname><given-names>Ricardo A.</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Antanaviciute</surname><given-names>Agne</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Simmons</surname><given-names>Alison</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Koohy</surname><given-names>Hashem</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A7">7</xref><xref ref-type="corresp" rid="CR1">+</xref></contrib></contrib-group><aff id="A1"><label>1</label>MRC Human Immunology Unit, Medical Research Council (MRC) Weatherall Institute of Molecular Medicine (WIMM), John Radcliffe Hospital, University of Oxford, Oxford, UK</aff><aff id="A2"><label>2</label>MRC WIMM Centre For Computational Biology, MRC Weatherall Institute of Molecular Medicine, John Radcliffe Hospital, University of Oxford</aff><aff id="A3"><label>3</label>Visual Geometry Group, Department of Engineering Science, University of Oxford</aff><aff id="A4"><label>4</label>Intelligent Systems Lab, Department of Computer science, University of Oxford</aff><aff id="A5"><label>5</label>Chinese Academy of Medical Sciences (CAMS) Oxford Institute (COI), University of Oxford</aff><aff id="A6"><label>6</label>Translational Gastroenterology Unit, John Radcliffe Hospital</aff><aff id="A7"><label>7</label>Alan Turning Fellow</aff><author-notes><corresp id="CR1">
<label>+</label>Correspondence: <email>hashem.koohy@rdm.ox.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>30</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>29</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">T-cells play a crucial role in the adaptive immune system by inducing an anti-tumour response, defending against pathogens, and maintaining tolerance against self-antigens, which has sparked interest in the development of T-cell-based vaccines and immunotherapies. Because screening antigens driving the T-cell response is currently low-throughput and laborious, computational methods for predicting CD8+ T-cell epitopes have emerged. However, most immunogenicity algorithms struggle to learn features of peptide immunogenicity from small datasets, suffer from HLA bias and are unable to reliably predict pathology-specific CD8+ T-cell epitopes. Therefore, we developed TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning platform for predicting CD8+ T-cell epitopes from MHC-I presented pathogenic and self-peptides. TRAP uses transfer learning, deep learning architecture and MHC binding information to make context-specific predictions of CD8+ T-cell epitopes. TRAP also detects low-confidence predictions for peptides that differ significantly from those in the training datasets to abstain from making incorrect predictions. To estimate the immunogenicity of pathogenic peptides with low-confidence predictions, we further developed a novel metric, RSAT (relative similarity to autoantigens and tumour-associated antigens), as a complementary to ‘dissimilarity to self’ from cancer studies. We used TRAP to identify epitopes from glioblastoma patients as well as SARS-CoV-2 peptides, and it outperformed other algorithms in both cancer and pathogenic settings. Thus, this study presents a novel computational platform for accurately predicting CD8+ T-cell epitopes to foster a better understanding of antigen-specific T-cell response and the development of effective clinical therapeutics.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">T-cells are essential for eliminating intracellular infections, triggering anti-tumour response as well as developing an immunological memory. Their ability to induce antigen-directed cytotoxicity has proven instrumental in fighting diseases, as evidenced by checkpoint blockade immunotherapy, adoptive cellular therapy and cancer vaccinology<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref></sup>. With the growing interest in identifying the cognate antigens of antigen-specific T-cells, many efforts have been made to improve experimental and computational methods for screening, predicting or characterising T-cell epitopes. However, current experimental approaches for identifying T-cell targets are labour-intensive, low-throughput and expensive<sup><xref ref-type="bibr" rid="R4">4</xref>–<xref ref-type="bibr" rid="R6">6</xref></sup>, and computational methods are still in their infancy<sup><xref ref-type="bibr" rid="R7">7</xref></sup>.</p><p id="P3">An effective antigen-specific CD8+ T-cell response to exogenous pathogens or endogenous threats relies on tightly regulated processing and presentation of antigenic peptides by class I MHCs, followed by recognition of the peptide-MHC (pMHC) by cognate CD8+ T-cells. Therefore, immunogenic peptides encompass features associated with MHC presentation <italic>and</italic> T-cell recognition<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. Among these, it has been demonstrated that features attributed to MHC presentation are more prominent than those attributed to TCR recognition, with strongly conserved motifs at anchor positions being one such feature<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup>. Indeed, recent cutting-edge models<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, such as the widely used NetMHCpan<sup><xref ref-type="bibr" rid="R12">12</xref></sup>, have demonstrated impressive performance in predicting MHC presentation on certain alleles. On the other hand, the dual nature of the peptide-specific TCR recognition interface, comprised of both peptide and MHC, makes predicting the interaction between TCR and pMHC uniquely challenging. In addition, the scarcity of peptides tested by T-cell assays, as well as the lack of true negative datasets (i.e. presented but not recognized by T-cells), hampers our understanding of the properties underlying T-cell recognition.</p><p id="P4">Despite these challenges, a plethora of computational models have been developed to aid in the prediction of T-cell targets and to foster a better understanding of the characteristics underpinning peptide immunogenicity<sup><xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R13">13</xref>–<xref ref-type="bibr" rid="R17">17</xref></sup>. These models utilise features such as amino acids at contact position, large and aromatic side chains<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, hydrophobicity<sup><xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R20">20</xref></sup>, peptide-MHC binding affinity and stability<sup><xref ref-type="bibr" rid="R16">16</xref></sup> as correlates to T-cell recognition. Specifically for cancer neoepitopes, agretopicity (i.e. the ratio of binding affinity between neoepitope and wild-type counterpart), foreignness score (i.e. similarity of neoepitope to previously characterised epitopes)<sup><xref ref-type="bibr" rid="R8">8</xref></sup> and dissimilarity to human proteome<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup> were found to indicate T-cell recognition.</p><p id="P5">However, we previously found that cancer and pathogenic epitopes often do not share the same immunogenicity features, which may differ in directionality or magnitude<sup><xref ref-type="bibr" rid="R23">23</xref></sup>. In addition to the context-specific differences, other factors, such as limited training data and a highly diverse T-cell receptor (TCR) repertoire contributed to the difficulty of predicting T-cell recognition potential. As a result, many existing models perform poorly against both cancer and emerging viral pathogens<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, and progress in improving performance appears to be incremental, suggesting that there are still remaining challenges in predicting T-cell epitopes.</p><p id="P6">Over the last decade, deep learning and natural language processing (NLP) have transformed biomedical research and offered breakthrough discoveries<sup><xref ref-type="bibr" rid="R24">24</xref></sup>. Because of their ability to extract complex patterns from large amounts of data, deep neural network (DNN) models have been used for predicting peptide-HLA binding<sup><xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup> as well as TCR specificity<sup><xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R29">29</xref></sup>. Furthermore, transformer-based pre-trained language models (PLMs) have advanced the prediction of protein structure and function<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R33">33</xref></sup> by combining the power of transformers, self-supervised learning and transfer leaming<sup><xref ref-type="bibr" rid="R34">34</xref>–<xref ref-type="bibr" rid="R36">36</xref></sup>. Indeed, as a solution to data constraints, these protein PLMs, which contain knowledge learned from a large volume of protein sequences, could serve as an additional source of information for related downstream tasks.</p><p id="P7">In addition, more research has recently been conducted on providing reliable predictions for safety-critical applications. Most of DNN models are trained under the assumption that test data distribution will be similar to the training data distribution. However, when used in real-world tasks, out-of-distribution (OOD) examples that deviate from the training data are common<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup>, resulting in a significant drop in model performance<sup><xref ref-type="bibr" rid="R39">39</xref>–<xref ref-type="bibr" rid="R41">41</xref></sup>. While this may be acceptable for some applications such as movie recommendations, it can be disastrous in safety-critical applications, such as medical diagnosis<sup><xref ref-type="bibr" rid="R42">42</xref>,<xref ref-type="bibr" rid="R43">43</xref></sup>. Therefore, the ability to identify OOD inputs and respond appropriately, whether by abstaining, requesting human intervention or gathering additional information, has become critical<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. Recently, several methods for estimating the degree of correctness have been proposed, and have been successfully applied in the Natural language Inference (NLI) and/or OOD datasets<sup><xref ref-type="bibr" rid="R44">44</xref>–<xref ref-type="bibr" rid="R48">48</xref></sup>. One of the major challenges in immunogenicity prediction has been the limited data and OOD generalisation problem for peptides derived from different hosts, organisms and diseases. As such, the OOD detection module would facilitate making reliable predictions on a real-world set of peptides that are often highly diverse and heterogeneous.</p><p id="P8">Here, we present TRAP (<underline>T</underline>-cell <underline>r</underline>ecognition potential of HL<underline>A</underline>-I presented <underline>p</underline>eptides), a deep learning-based platform that addresses the current limitations and effectively captures T-cell recognition motifs from HLA-I presented pathogenic or self-peptides. Novel strategies were implemented, such as a) building separate models for pathogenic and self-peptides to account for divergent immunogenicity-related features, b) using transfer learning to deliver amino acid embeddings from pre-trained large-scale protein language models, c) capturing T-cell recognition motifs with a deep learning architecture, and d) detecting low confidence predictions to abstain from making incorrect predictions. We further developed RSAT (relative similarity to autoantigens and tumour-associated antigens) to estimate the immunogenicity of pathogenic peptides when they are abstained due to low-confidence predictions. The TRAP was then used to identify cancer neoepitopes from glioblastoma patients and showed superior performance to other methods. While many immunogenicity algorithms are based on MHC binding, TRAP goes one step further by predicting T-cell targets from MHC-I ligands. This novel workflow will enable more accurate identification of CD8+ T-cell epitopes, facilitating the development of effective vaccines and therapeutics.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>TRAP: A robust deep learning platform to predict CD8+ T-cell recognition of MHC-I presented pathogenic and self-peptides</title><p id="P9">We present TRAP as a comprehensive platform for predicting CD8+ T-cell immunogenicity of HLA-I presented pathogenic and self-peptides (<xref ref-type="fig" rid="F1">Figure 1A</xref>).</p><p id="P10">In this workflow, peptide sequences of 9-10 amino acids in length are predicted to bind HLAs. The predicted HLA-I ligands are encoded using amino acid embeddings derived from protein transformer-based pretrained language models (PLMs). TRAP then employs a 1D convolutional neural network to extract T-cell recognition motifs, which are then combined with MHC binding rank score and hydrophobicity to predict peptide immunogenicity. Following that, TRAP includes a decision tree classifier to detect low-confidence predictions to improve accuracy. The immunogenicity of pathogenic peptides with low-confidence predictions can be predicted using a novel metric called Relative Similarity to Autoantigens or Tumour-associated antigens (RSAT), which is developed as a complement to “dissimilarity to self” from cancer studies.</p><p id="P11">TRAP has been developed as a user-friendly web application __, where users can input their peptide list and select the model of interest (pathogenic or self-antigen), and the application will compute the prediction scores along with its confidence (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). In the following sections, we will explain the rationales behind the model architecture and strategies for overcoming the current constraints and improving model performance.</p></sec><sec id="S4"><title>Out-of-distribution uncertainty and HLA bias result in poor performance</title><p id="P12">We previously reported that the existing immunogenicity algorithms showed suboptimal performance in predicting epitopes from both cancer and an emerging viral pathogen<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. We then attributed the poor performance to divergent discriminative features between cancer neoepitopes and pathogenic epitopes in directionality or magnitudes<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>.</p><p id="P13">Here, we investigated additional sources of suboptimal performance to aid in the development of accurate, robust and biologically meaningful classifiers. We retrieved peptides of lengths 9-10aa, characterised by T-cell assays from IEDB and retained predicted MHC binder from NetMHCpan 4.0, resulting in 5,093 immunogenic (‘Positive’) and 6,628 non-immunogenic (‘Negative’) peptides (named PeptideTcell data, <xref ref-type="sec" rid="S13">Methods</xref>) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2A</xref>). Notably, no peptides may be considered truly non-immunogenic as they may be recognized by at least one TCR in the repertoire under the right physiological conditions. However, there is a continuum of immunogenicity potential where some peptides are likely to trigger greater T-cell response and/or are able to bind numerous TCRs. Therefore, we designated the ‘Negatives’ as peptides with very low putative immunogenicity potential, defined as peptides characterised negative in more than three T-cell assays.</p><p id="P14">First, we evaluated the extent to which known hallmarks of immunogenicity, such as MHC binding affinity<sup><xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> and percentage of hydrophobic amino acids in peptide sequence<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, can be used to identify immunogenic peptides from different species. Notably, these features have been used as predictors in models such as TESLA<sup><xref ref-type="bibr" rid="R8">8</xref></sup>, iPred<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, NetTepi<sup><xref ref-type="bibr" rid="R16">16</xref></sup> and GAO<sup><xref ref-type="bibr" rid="R49">49</xref></sup>. Although two features could effectively distinguish epitopes from non-epitopes at a macroscopic level, where epitopes had higher MHC binding rank (-log transformed) and hydrophobicity with medium effect sizes (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2B-C</xref>), they no longer showed statistical significance at the species-level (<xref ref-type="fig" rid="F1">Figure 1B-C</xref>), which was caused in part by the small sample size. For example, hydrophobicity alone could not discriminate SARS-CoV-2 epitopes from non-epitopes.</p><p id="P15">Second, we assessed the extent to which cross-species peptides (i.e. peptides derived from other species) can predict epitopes of unseen pathogens. We divided PeptideTcell data randomly or in a cross-species manner: i) random split to 90% train vs. 10% test (i.e. representation of 10-fold cross-validation), or ii) cross-species split to Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and Non-vaccinia virus (Non-VACV) train vs. VACV test (<xref ref-type="fig" rid="F1">Figure 1D</xref>). We then compared the performance of XGBOOST classifiers on these datasets (<xref ref-type="sec" rid="S13">Method</xref>). While no substantial difference was observed during training (<xref ref-type="fig" rid="F1">Figure 1E</xref>), the cross-species model showed lower accuracy and higher root mean squared error (RMSE) on test datasets (<xref ref-type="fig" rid="F1">Figure 1F</xref>). This implied that cross-species peptides may not share common features in predicting immunogenicity (i.e. predictive features in training and test data are likely to be different which is known as an out-of-distribution generalisation problem), resulting in limited accuracy on unseen pathogens.</p><p id="P16">To support this, we generated differential position specific scoring matrices (dPSSMs) to compare immunogenicity-related sequence patterns between train and test datasets (<xref ref-type="sec" rid="S13">Methods</xref>). While random split data shared similar patterns between train and test datasets, such as enrichment of L, G/E, G, hydrophobic resides and T on P3-P8 (<xref ref-type="fig" rid="F1">Figure 1Gi</xref>), cross-species data showed low homology (<xref ref-type="fig" rid="F1">Figure 1Gii-iii</xref>), and dPSSM scores failed to predict immunogenicity on cross-species test datasets (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2D</xref>, <xref ref-type="sec" rid="S13">Method</xref>).</p><p id="P17">Third, we observed that high reported performance from the latest models incorporating peptide-HLA pairs might be driven by HLA bias from an imbalanced dataset. Recently, deep learning models incorporating peptide-HLA pairs reported ROC-AUC of ~0.85 by 10-fold cross-validation<sup><xref ref-type="bibr" rid="R15">15</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2E-F</xref>). While they reported the highest accuracy to date, we observed poor performance on SARS-CoV-2 peptides in our benchmarking study<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. Here, we hypothesized that this poor agreement may be due to differences in datasets and investigated the cause of disagreement.</p><p id="P18">First, we evaluated the ability of the model to discriminate Positive vs. Negative bound on the same HLA allele. We trained and tested models in single HLA-level on HLA-A*02:01 and HLA-A*24:02, which had the highest numbers of characterised peptides per HLA. We then compared them to the model trained using the same number of randomly sampled pMHCs (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2G</xref>). Here, the model showed marginally better than random performance on the balanced HLA-A*02:01 dataset (<xref ref-type="fig" rid="F1">Figure 1H</xref>), and high variation on the relatively imbalanced and smaller HLA-A*24:02 dataset (<xref ref-type="fig" rid="F1">Figure 1I</xref>). We further found that HLA-balanced data substantially reduces classifier performance (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2H</xref>, <xref ref-type="fig" rid="F1">Figure 1J</xref>), suggesting that current models are skewed towards classifying for certain over- or under-represented HLA alleles and their reported performance does not reflect their real-world accuracy.</p></sec><sec id="S5"><title>Mitigate HLA bias by employing peptide sequences at TCR contact positions</title><p id="P19">Previous studies reported the contribution of anchor positions (i.e. position 2 (P2) and P9 of 9aa peptide) for MHC binding<sup><xref ref-type="bibr" rid="R50">50</xref></sup> and contact positions (i.e. P3-P8) in T-cell recognition<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. Correspondingly, HLA supertypes drove the clustering of peptides at anchor positions (<xref ref-type="fig" rid="F2">Figure 2A</xref>) and TCR specificities at contact positions (<xref ref-type="fig" rid="F2">Figure 2B-C</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3A-B</xref>) on our data, with peptides bound by the same TCR showing conserved motifs (<xref ref-type="fig" rid="F2">Figure 2D</xref>). However, because of the strong conserved pattern in anchor positions, the HLA supertype not only drove the clustering of peptides at anchor positions but also acted as the strongest covariate driving the clustering of peptides in full sequence (<xref ref-type="fig" rid="F2">Figure 2E</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3C</xref>). With such a strong conserved pattern, MHC binding features may dominate immunogenicity predictions when the full peptide sequence is used for model training. In fact, we observed that some of the existing immunogenicity classifiers were more capable of predicting dominant HLA type (i.e. whether peptides were bound to HLA-A*02:01 or not) than peptide immunogenicity<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. As we aimed to predict T-cell recognition potential once peptides are bound to HLA alleles, we incorporated contact positions only i.e. positions 3-8 (P3-P8) of 9aa peptide and P3-P9 of 10aa peptides, not only to focus on T-cell recognition patterns, but also to rule out the need to balance the number of epitopes vs. non-epitopes by the HLA supertypes for model development.</p><p id="P20">To take such an approach, we first investigated whether neglecting HLA information would not result in a significant loss of information when predicting T-cell recognition potential of MHC-presented peptides from the current dataset. First, a novel metric was developed for converting qualitative measurements (i.e. Positive or Negative) to a quantitative ‘positivity score’ that reflects confidence in the immunogenicity (<xref ref-type="sec" rid="S13">Methods</xref>). Briefly, the metric took into account a) the number of experiments conducted (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4A</xref>), b) the percentage tested positive (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4B</xref>) and c) the number of cognate TCRs where available (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4C</xref>) to compute the positivity score (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4D</xref>).</p><p id="P21">Using the positivity scores of each peptide-HLA entry, the extent of inter-HLA variation (i.e. variation across different HLA alleles) was compared to intra-HLA variation (i.e. variation within the same HLA allele) for peptides bound on multiple HLA alleles. The intra-HLA variation accounted for the majority of data variability, while inter-HLA variation contributed less (<xref ref-type="fig" rid="F2">Figure 2F</xref>). This is because other biological (e.g. different effector cell, antigen presenting cells etc.) or technical (e.g. assay type, culture conditions, research groups etc.) factors were causing greater discrepancies in positivity score than HLA alleles (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4E-F</xref>). This implied that when it came to each peptide, there wasn’t much difference in the immunogenicity based on the HLAs to which it was bound, but when it came to HLAs, each HLA had a different pool of peptides, resulting in a different distribution of positive and negative peptides, resulting in HLA-bias. As a result, an HLA-generalised approach was adopted in which peptide-HLA binding information was used instead of the HLA allele itself.</p></sec><sec id="S6"><title>Deep learning architecture captures T-cell recognition motifs</title><p id="P22">As the potential causes of poor performance, previous sections discussed limited training dataset, HLA bias and out-of-distribution (OOD) generalisation problem. These issues were addressed in TRAP by a) using peptide sequence at contact positions, b) building separate models for pathogenic and self-peptides, c) encoding peptide sequences using amino acid properties derived from protein transformer-based pretrained language models (PLMs), d) devising one-dimensional convolutional neural network (1D CNN) architecture designed to capture T-cell recognition motifs and e) employing OOD detection module. These novel strategies enabled TRAP to offer more accurate and reliable predictions of CD8+ T-cell targets against cancer and viral diseases.</p><p id="P23">First, pathogenic and self-antigen datasets were prepared to build context-specific models (<xref ref-type="sec" rid="S13">Methods</xref>). Briefly, the pathogenic dataset is a subset of the PeptideTcell data, comprising only pathogen-derived peptides (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5A</xref>). For the self-antigen dataset, autoantigens, tumour-associated antigens and cancer neoepitopes were retrieved from Cancer peptide database, dbPepNeo, IEDB, McPAS-TCR and NEPdb databases as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5B-C</xref>). The HLA-I ligands (exclusively) expressed in the thymus were assumed to be involved in negative selection of T-cells, and thus no repertoire to recognise these peptides was expected. To the best of our knowledge, this is the first study to use the concept of negative thymic selection in classifying self-epitopes from non-epitopes.</p><p id="P24">Second, because peptides vary in lengths, we investigated the optimal padding strategy for aligning 6-mer with 7-mer contact position peptides. The predictive accuracies of simple dense layer classification, 1D CNN, 2D CNN and bidirectional recurrent neural network (biRNN) models were evaluated using pre- and post-padding strategies. No significant difference was observed across pathogenic and self-antigen data, with pre-padding achieving slightly better performance in self-antigen data on the BiRNN model (<xref ref-type="fig" rid="F3">Figure 3A</xref>). Furthermore, the relative location of k-gram motifs was compared on 6-mer and 7-mer peptides, and many 3-gram motifs found at P3 of the 9aa peptide were found at P4 of the 10aa peptide (<xref ref-type="fig" rid="F3">Figure 3B</xref>). Therefore, to align T-cell recognition hotspots with biological context, peptides of shorter length were pre-padded to align with longer peptides.</p><p id="P25">Third, to address data limitation, we adopted transfer learning to encode peptides using amino acid properties derived from protein transformer-based pretrained language models (PLMs). The protein transformer-based PLMs were trained using millions to billions of protein sequences and carry the most representative 1024 embeddings, which describe the physicochemical, structural or electrostatic properties of amino acids in protein space<sup><xref ref-type="bibr" rid="R33">33</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). The performance of classification models were compared when peptides were encoded by one-hot-encoding (OHE), amino acid descriptors and embeddings from five protein transformer-based PLMs (<xref ref-type="sec" rid="S13">Methods</xref>). ProtT5-XL-UniRef showed the highest performance, with an average ROC-AUC of 0.72 for pathogenic (<xref ref-type="fig" rid="F3">Figure 3Ci</xref>) and 0.724 for self-antigen datasets (<xref ref-type="fig" rid="F3">Figure 3Cii</xref>).</p><p id="P26">Fourth, the capability of different machine learning and deep learning architectures to classify immunogenicity potential was assessed. The performances of XGBOOST, BiRNN, bidirectional long short-term memory (BiLSTM), 1D CNN, 2D CNN and transformer models were compared. Briefly, RNNs or LSTMs are popular sequential models efficient in addressing sequential text data<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, whereas CNNs are suitable for scanning across text or images and detecting local patterns by using ‘kernels’. 1D CNNs have widely been used for text and 2Ds for image classifications<sup><xref ref-type="bibr" rid="R52">52</xref></sup>. The 1D CNN model using ProtT5-XL-UniRef embeddings achieved the highest average ROC-AUC of 0.74 for pathogenic (<xref ref-type="fig" rid="F3">Figure 3Di</xref>) and 0.75 for self-antigens (<xref ref-type="fig" rid="F3">Figure 3Dii</xref>). We surmised that T-cell recognition motifs captured by the 1D CNN model have more predictive power than sequential relationship captured by the RNN-based models.</p><p id="P27">In addition to peptide sequences, we examined whether incorporating other hallmarks of immunogenicity, such as predicted MHC binding rank score<sup><xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup> and hydrophobicity<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, can further improve the performance. Particularly, given that the current model only takes contact positions into account, adding MHC binding rank would allow the model to accommodate peptide-MHC binding information. This strategy has several advantages. First, it feeds the binding information with a minimal HLA-associated bias, circumventing the need to balance the training data by HLAs. Second, the most accurate binding information from NetMHCpan prediction can be incorporated without having to re-train the model using a massive peptide-HLA binding data. By integrating MHC binding rank and hydrophobicity as fully connected layers (i.e. Multilayer perceptrons, MLPs) and optimising hyperparameters (<xref ref-type="fig" rid="F3">Figure 3E</xref>, <xref ref-type="sec" rid="S13">Methods</xref>), performance was improved to an average ROC-AUC of 0.76 for pathogenic (<xref ref-type="fig" rid="F3">Figure 3F</xref>i) and 0.90 for self-antigens (<xref ref-type="fig" rid="F3">Figure 3Fii</xref>). Of note, a large improvement in the self-antigen model was due to a greater difference in MHC binding rank between self-epitopes vs. non-epitopes, as a consequence of the relaxed MHC binding rank threshold (≤ 10 MHC binding rank) to account for as many self-epitopes.</p><p id="P28">Therefore, representing peptide sequences at contact positions by ProtT5-XL-UniRef amino acid embeddings, extracting T-cell recognition motifs by 1D CNN kernels, and adding MHC binding rank and hydrophobicity as MLPs could effectively achieve superior performance in classifying immunogenicity.</p></sec><sec id="S7"><title>Sequence patterns discriminating immunogenicity</title><p id="P29">Among different architectures, the 1D CNN model that captures local motifs achieved the best performance. Moreover, extensive screening of pMHC library against a single TCR revealed dominant hotspots or motifs in the cognate peptides<sup><xref ref-type="bibr" rid="R53">53</xref>,<xref ref-type="bibr" rid="R54">54</xref></sup>. We therefore set out to expand this observation and explore the enrichment of n-grams (i.e. contiguous sequence of n-amino acids)<sup><xref ref-type="bibr" rid="R55">55</xref></sup> and position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids at specific positions) in contact residues of pathogenic and self-peptides.</p><p id="P30">We first computed the ratio (in normalised frequency) of n-gram or positions-specific k-mer motifs between epitopes and non-epitopes (<xref ref-type="sec" rid="S13">Methods</xref>). The top-ranking n-grams were GIG, GINA, GIF, LGIN, VEG and SGSP for pathogenic epitopes and SC, GIGI, IC, QC and CA for self-epitopes (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6C</xref>). In addition, top position-specific k-mer motifs were .EG.L., .E.IL. and .GIG… for pathogenic epitopes and GIG.., ..M.P., .G.GI.., and AGI…. for self-epitopes (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>). Notably, GIG, which was previously associated with DMF5 TCR, was one of the top n-grams and position-specific k-mer motifs.</p><p id="P31">To identify sequence patterns enriched in both pathogenic and self-epitopes, we compared n-grams and position-specific k-mer motifs from each analysis. The 48 n-grams and total 298 position-specific k-mer motifs from 9 and 10aa peptides (<xref ref-type="fig" rid="F4">Figure 4A</xref>) were shared between pathogenic and self-epitopes. These include GIG, GINA, GMP, ALGI and APTG n-grams (<xref ref-type="fig" rid="F4">Figure 4B</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6D</xref>), and …VP, W..P.., .G.GI.., and .GIG… position-specific k-mer motifs (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6E-G</xref>).</p><p id="P32">Furthermore, we computed pairwise global-alignment scores across pathogenic peptides to identify clusters of epitopes sharing high sequence homology (<xref ref-type="sec" rid="S13">Method</xref>). Plotting highly similar peptides revealed clusters dominated by Positive peptides (<xref ref-type="fig" rid="F4">Figure 4C</xref>). These clusters contained peptides having patterns, such as YNTI... FG(Y/F)PV(F/Y). F(E/D)(K/R)S.., G.GW.. .DR.WC, GPG.R.P, P.DFFP., .GIGI.., .DRGM., VALG.NA. and .LGLNA. (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5H-I</xref>).</p><p id="P33">Our analyses therefore suggest that TCR contact positions of immunogenic peptides exhibit preferences towards presenting certain motifs while disfavouring others. We also observed similarities and differences between pathogenic and self-peptides. The toolkits for analysing differential sequence patterns between peptides of the same length are developed as a R diffSeqPatterns package. We believe these shortlisted sequence patterns can be target for functional validations in identifying immune hotspots.</p></sec><sec id="S8"><title>Detect low-confidence predictions to improve robustness</title><p id="P34">While the DNN models could achieve higher accuracies than existing models, they are nonetheless far from making a perfect prediction. Partially due to the limited number of peptides characterised to fill the full combinatorial peptide space, the performance of sequence-based model drops substantially in predicting peptides non-homologous to those of training data, called the out-of-distribution (OOD) generalisation problem<sup><xref ref-type="bibr" rid="R43">43</xref></sup>. In contexts where incorrect predictions can have severe consequences such as in healthcare or security, using model uncertainty to decide when to trust or abstain the prediction can facilitate rejecting false predictions and improving model accuracy.</p><p id="P35">There are generally two types of OODs: background shift (i.e. a shift in population-level features that do not depend on classification labels) and semantic shift (i.e. a shift in features that are correlated with the context and label)<sup><xref ref-type="bibr" rid="R45">45</xref></sup>. In previous NLP studies, density or proximity-based models were found to be better at detecting background shifts, while calibration methods (i.e. using model’s prediction confidence) performed better at semantic shifts. In our study, the greatest OOD came from peptides originating from different species that have moderately different features associated with immunogenicity (i.e. semantic features). This aligns with previous findings that the majority of OOD stems from the semantic shift and thus calibration methods generally outperform proximity-based methods (i.e. autoencoder reconstruction)<sup><xref ref-type="bibr" rid="R45">45</xref></sup>.</p><p id="P36">Here, several OOD detection methods were tested to detect low-confidence predictions. Different autoencoder architectures, which are often used for anomaly detection, were first investigated<sup><xref ref-type="bibr" rid="R56">56</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7A-F</xref>, <xref ref-type="sec" rid="S13">Methods</xref>). However, we observed no significant difference in reconstruction loss between correctly and incorrectly predicted peptides, implying that the autoencoder-based methods cannot effectively identify OOD inputs.</p><p id="P37">Therefore, calibration methods such as maximum softmax probability (MaxProb), temperature scaling, average MaxProb from an ensemble of 10 models (called Ensemble) and Monte Carlo dropout were tested, because they were reported to effectively detect semantic shifts (<xref ref-type="sec" rid="S13">Methods</xref>). We observed that all four methods could significantly differentiate correct vs. incorrect predictions for both pathogenic and self-antigens (<xref ref-type="fig" rid="F4">Figure 4D-G</xref>). To evaluate the predictive power of these metrics, we trained a decision tree classifier that takes the score of the calibration methods as an input and predicts whether the input is an OOD sample. We observed that MaxProb and Ensemble had the highest feature importance, i.e. possess the best predictive power (<xref ref-type="fig" rid="F4">Figure 4H</xref>). They could achieve comparable performance to the model incorporating all four metrics with average ROC-AUC of 0.923 for pathogenic and 0.806 for self-antigens (<xref ref-type="fig" rid="F4">Figure 4I</xref>). With these, a MaxProb and Ensemble-based OOD detection module was introduced downstream of 1D CNN model prediction to report peptides that are likely to have a correct prediction.</p></sec><sec id="S9"><title>Relative similarity to autoantigens or tumour-associated antigens (RSAT) as a novel feature of pathogenic peptide immunogenicity</title><p id="P38">We and others<sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R57">57</xref></sup> have shown that some of the highly predictive metrics found from cancer neoepitope studies, such as ‘dissimilarity to self’, may not be applicable to pathogenic peptides. To address this, we present an alternative solution, termed a relative similarity to autoantigens or tumour-associated antigens (RSAT), to estimate the immunogenicity potential of pathogenic peptides. For pathogenic peptides that suffer from low confidence prediction, RSAT can provide an additional estimate of immunogenicity potential.</p><p id="P39">The ‘dissimilarity to self’ stems from the paradigm of negative selection where T-cells that bind strongly to self-peptides should have been negatively selected and thus no T-cell repertoire should be present to bind peptides homologous to self-proteome<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup> (<xref ref-type="fig" rid="F5">Figure 5A</xref>). However, there is another side of the story where T-cells that have low or moderate binding to self-peptides should have been positively selected. In fact, recent studies attributed the inability of the immune system to recognise a large number of pathogenic peptides – most of which are highly dissimilar to human proteome – to the mechanism of positive selection where only T-cells bound by low or moderately binding self-peptides survive to trigger an immune response<sup><xref ref-type="bibr" rid="R57">57</xref></sup>. Therefore, we hypothesised that pathogenic peptides homologous to immunogenic self-peptides, such as autoantigens or tumour-associated antigens, may be more likely to trigger an immune response, and assessed whether relative similarity to autoantigens or tumour-associated antigens compared to reference human proteome can be a predictor of immunogenicity for pathogenic peptides.</p><p id="P40">To test our hypothesis, 5023 unique Autoimmunity, Allergy or Tumour-associated antigens (AATs) were retrieved from NEPdb<sup><xref ref-type="bibr" rid="R58">58</xref></sup>, dbPepNeo<sup><xref ref-type="bibr" rid="R59">59</xref></sup>, McPAS-TCR<sup><xref ref-type="bibr" rid="R60">60</xref></sup>, IEDB<sup><xref ref-type="bibr" rid="R61">61</xref></sup> and cancer antigenic peptide database (<ext-link ext-link-type="uri" xlink:href="https://caped.icp.ucl.ac.be">https://caped.icp.ucl.ac.be</ext-link>) (<xref ref-type="fig" rid="F5">Figure 5B</xref>). We then computed the similarity between pathogenic peptides and AATs, and only retained pathogenic peptides having comparable AAT counterparts (<xref ref-type="sec" rid="S13">Methods</xref>). On these pathogenic peptides, we then computed the similarity between pathogenic peptide and AAT’s closest human proteome counterparts, and the ratio between the two i.e. <underline>r</underline>elative <underline>s</underline>imilarity of the pathogenic peptide to <underline>a</underline>utoantigens or <underline>t</underline>umour-associated antigens (named RSAT).</p><p id="P41">From pathogenic data, 346/3793 pathogenic epitopes and 295/6080 non-epitopes had comparable AAT counterparts by a threshold match score of 0.6 (<xref ref-type="sec" rid="S13">Method</xref>, <xref ref-type="fig" rid="F5">Figure 5C</xref>). The RSAT was computed on these peptides and found a significant difference between epitopes vs. non-epitopes (<xref ref-type="fig" rid="F5">Figure 5D</xref>) across peptide lengths 9 and 10aa (<xref ref-type="fig" rid="F5">Figure 5E</xref>), and across different pathogenic species (<xref ref-type="fig" rid="F5">Figure 5F</xref>), indicating that RSAT could effectively classify peptides of varying lengths and pathogen species. Despite the fact that each species had a limited number of peptides, epitopes had higher RSAT values with low (SARS-CoV-2 and M.tuberculosis), medium (EBV) or high (HCV and vaccinia virus) effect sizes.</p><p id="P42">Here, we developed a novel metric, RSAT, to estimate the immune potential of pathogenic peptides based on relative similarity to known auto- or tumour-associated epitopes. We demonstrated that RSAT can effectively discriminate epitopes of different lengths and pathogens. The RSAT is available as a separate module in the TRAP GitHub repository and is recommended to be used in conjunction with TRAP when the pathogenic peptides have low prediction confidence. We appreciate that the low number of Autoimmunity, Allergy or Tumour-associated antigens (AATs) limits the use of RSAT on a broader range of peptides. However, we envision that as data becomes more abundant, RSAT can become more popular.</p></sec><sec id="S10"><title>Benchmark TRAP performance to state-of-the-art algorithms</title><p id="P43">The performance of TRAP was benchmarked against existing immunogenicity models, namely NetTepi, IEDB, PRIME, DeepImmuno and TESLA by 10-fold cross-validation on the same datasets (<xref ref-type="sec" rid="S13">Method</xref>). Due to the nature of the existing models, HLA-agnostic predictions were performed for IEDB, iPred, NetTepi PRIME and Repitope, and HLA-restrictive prediction for DeepImmuno. TRAP was able to make both HLA-agnostic and restrictive predictions by incorporating the peptide sequence at contact positions and MHC as a rank score. The HLA-restrictive prediction was made using HLA-balanced data where the number of epitopes and non-epitopes were balanced per HLA to validate their prediction irrespective of HLA-associated bias.</p><p id="P44">TRAP was the best self-antigen model, achieving ROC-AUC of 0.931 for HLA-agnostic and 0.703 for HLA-restrictive predictions (<xref ref-type="fig" rid="F6">Figure 6A</xref>). It was also one of the best pathogenic models, with ROC-AUC of 0.751 for HLA-agnostic and 0.709 for HLA-restrictive predictions (<xref ref-type="fig" rid="F6">Figure 6B</xref>).</p><p id="P45">While Repitope slightly outperformed TRAP in pathogenic datasets, the robustness of its predictions was assessed on emerging pathogens. The coronavirus TRAP and Repitope models were trained using 1511 Non-Wuhan SARS-CoV-2 peptides by 10-fold cross-validations (<xref ref-type="fig" rid="F6">Figure 6C</xref>), which were then used to predict the immunogenicity of 66 Wuhan SARS-CoV-2 peptides (<xref ref-type="fig" rid="F6">Figure 6D</xref>). Here, TRAP was better at extracting immunogenicity-related features from limited data of emerging pathogens, and translating them onto related species (<xref ref-type="fig" rid="F6">Figure 6D</xref>).</p><p id="P46">Therefore, TRAP can predict CD8+ T-cell epitopes in both HLA-agnostic and restrictive contexts, and performed better in both. The TRAP can also make accurate predictions about emerging pathogens and is suitable for shortlisting therapeutic candidates when data is limited.</p></sec><sec id="S11"><title>Application of TRAP to identify glioblastoma neoantigens</title><p id="P47">Here, we demonstrate how the TRAP can be used for identifying cancer neoepitopes from glioblastoma patients. We previously sequenced the tumours of four HLA-A2 glioblastoma patients and shortlisted the cancer neoepitopes by using an in-house version of MuPeXI<sup><xref ref-type="bibr" rid="R62">62</xref></sup> codenamed TUNAPASTA v0.5. This method ranked peptides by the immunogenicity potential, taking into account NetMHCpan affinity, gene expression level, and mutant allele frequency. We then selected 153 predicted epitopes for functional validation, of which 33 were characterised positive by T-cell assay<sup><xref ref-type="bibr" rid="R63">63</xref></sup>. With only a small proportion of the shortlisted candidates found to be positive, the other existing models showed comparable levels of performance, PR-AUC ranging from 0.201 to 0.437 in our benchmarking study<sup><xref ref-type="bibr" rid="R7">7</xref></sup>.</p><p id="P48">Of the 153 tested peptides, we filtered out predicted HLA-A*02:01 non-binders and retained 9-10 amino acids peptides that were applicable to TRAP. This left 124 GBM peptides, of which 25 were characterised to be immunogenic and 99 non-immunogenic by T-cell assays. Of these, TRAP predicted 9/25 epitopes to be Positives and 84/99 non-epitopes to be Negatives (<xref ref-type="fig" rid="F6">Figure 6E</xref>), yielding 0.75 accuracy with ROC-AUC of 0.684 (<xref ref-type="fig" rid="F6">Figure 6F</xref>).</p><p id="P49">Identifying cancer neoepitopes is typically regarded as a ‘needle in a haystack’ problem in which an extremely small number of positives are sought from vastly imbalanced data. In this scenario, minimising the loss of true Positives from the candidate list was regarded to be more important than maximising accuracy. Therefore, we examined the confidence of predictions using the out-of-distribution detection module (<xref ref-type="fig" rid="F6">Figure 6G</xref>) and found that many incorrectly predicted Negatives had low-confidence predictions (<xref ref-type="fig" rid="F6">Figure 6H</xref>). By adding them to the candidate list, 24 more glioblastoma antigens were predicted positive, yielding 18/25 epitopes (<xref ref-type="fig" rid="F6">Figure 6I</xref>) and ROC-AUC of 0.705 (<xref ref-type="fig" rid="F6">Figure 6J</xref>).</p><p id="P50">Here, we applied TRAP for shortlisting glioblastoma cancer neoepitopes and showed that TRAP not only outperforms existing algorithms but also allow optimising candidates to minimise loss of likely epitopes.</p></sec><sec id="S12" sec-type="discussion"><title>Discussion</title><p id="P51">In this study, we present TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning platform for predicting CD8+ T-cell epitopes from MHC-I presented pathogenic and self-peptides. To address the current limitations, we used peptide sequences only at contact positions to avoid HLA bias caused by capturing dominant HLA binding features at anchor positions. Second, we built separate models for pathogenic and self-peptides to address the out-of-distribution generalisation problem. Third, to overcome data limitations, we encoded peptide sequences using amino acid properties derived from protein transformer-based pre-trained language models (PLMs). This enabled more information about the physicochemical, electrostatic or biophysical properties of amino acids to be fed into the system. Fourth, we captured T-cell recognition motifs using a one-dimensional convolutional neural network (1D CNN) architecture. Fifth, we added the MHC binding rank score predicted by the most accurate algorithm (NetMHCpan) to provide the information about MHC binding. Lastly, we devised an out-of-distribution detection module to abstain from low-confidence predictions for peptides that are very different from those in the training dataset. By taking these novel approaches, TRAP offers a more robust prediction compared to other machine learning algorithms.</p><p id="P52">Another metric proposed to estimate immunogenicity from cancer neoepitope studies was dissimilarity to self. However, the dissimilarity to self could not be applied to pathogenic peptides because pathogens have highly heterologous sequences compared to the human proteome. Therefore, a novel metric termed RSAT (Relative similarity to autoantigens or tumour-associated antigens) was developed to estimate the immunogenicity of peptides from emerging pathogens. To compensate for the high dissimilarity between pathogenic and human proteomes, this metric compares the similarity of pathogenic peptides to the reference human proteome (‘healthy’) with respect to ‘immunogenic’ self-peptides such as autoantigens or tumour-associated antigens. This allowed the identification of pathogenic epitopes despite their sequence dissimilarity to the human proteome.</p><p id="P53">The application of TRAP was demonstrated by using it to identify cancer neoepitopes from glioblastoma patients. We showed that the out-of-distribution detection module is well-suited for the ‘needle in a haystack’ problem by identifying those predicted negative with low confidence. In another study, we used TRAP to investigate the immune escape potential of SARS-CoV-2 variants<sup><xref ref-type="bibr" rid="R64">64</xref></sup>. By combining TRAP with <italic>in silico</italic> mutagenesis, we evaluated the extent to which all possible theoretical single point mutations can give rise to variants of concern and be detrimental to T-cell immunity. Based on the groundwork of this work, using models like TRAP to systematically evaluate the impact of mutations on the emergence of deleterious pathogens will be of great interest. Emerging pathogens have posed a significant threat in recent years, and new variants and pathogens are expected to rise in the coming years<sup><xref ref-type="bibr" rid="R65">65</xref></sup>. It is therefore critical to surveil variants of concern and assess the immune escape potential of these variants. Furthermore, in order to accurately determine deleterious variants, it is essential to assess the extent to which models trained by other pathogens can be generalised and thus used for emerging pathogens. Thus, an iterative process of refining the training data, model architecture and validating predictions should be followed to mitigate the impact of another pandemic.</p><p id="P54">For the self-antigen model, the autoantigens, tumour-associated antigens and cancer neoepitopes were collected as epitopes, and benign HLA-I ligands expressed in thymus as non-epitopes. We assumed that HLA-I ligands (exclusively) expressed in the thymus are involved in the negative selection of T-cells, and thus there is no repertoire recognising these peptides. Notably, our novel approach of incorporating the HLA-I ligands allowed for a clearer separation of self-epitopes versus non-epitopes. When the data is limited, biological knowledge, such as negative thymic selection, can serve as a useful resource to bridge the data gap, and aid in the development of a more accurate classifier.</p><p id="P55">In benchmarking TRAP performance, we found that while Repitope performed well on pathogenic data, it was limited in extracting immunogenicity-related features from limited data and transferring them onto related species, resulting in poor performance on emerging pathogens. Our previous analysis revealed that Repitope was one of the models with skewed prediction for prevalent HLAs, with HLA-A*02:01-bound peptides having a higher immunogenicity score than non-HLA-A*02:01 bound peptides<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. This suggested that the model considered A02:01 binding as a superior feature to T-cell recognition potential, skewing the prediction. While TRAP performed slightly lower on the pathogenic dataset, the HLA-generalised approach of TRAP mitigates the possibility of HLA bias. Therefore, end users should choose which model to pursue based on the peptides and HLA alleles of interest.</p><p id="P56">While these approaches improved the accuracy and robustness of the prediction, there still remains limitations. Foremost, while calibration methods could effectively detect incorrect prediction in 10-fold cross-validation, they failed on the cross-species dataset (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7G-H</xref>). We surmised this is because of “spurious semantic features” (i.e. features that have discriminative power in training data but not in test data) that were driving overly confident incorrect predictions. In a recent case study, Arora <italic>et al</italic>. benchmarked calibration methods on real-world challenge data and reported that models were over-confident on the OOD examples because of spurious semantic features and often produced accuracies close to random<sup><xref ref-type="bibr" rid="R45">45</xref></sup>. With spurious semantic shift being one of the remaining challenges in the NLP, further advances in deep learning and NLP will also facilitate improving the robustness of predictions on complex biological data.</p><p id="P57">Second, following our workflow, peptides may be abstained due to low-confidence predictions. For cancer peptides, TESLA<sup><xref ref-type="bibr" rid="R8">8</xref></sup> that incorporates generic features for neoepitope prediction could be an alternative solution. The pathogenic peptides having low-confidence predictions can be directed to RSAT to estimate immunogenicity potential with respect to self-epitopes. However, because RSAT is only applicable to peptides with self-epitope counterparts, its coverage remains limited. Further characterisation of self-epitopes will expand RSAT coverage to embrace a broader range of pathogenic peptides.</p><p id="P58">Third, TRAP takes an HLA-generalised approach to avoid HLA bias, as the current dataset contains little intra-HLA variation in peptide immunogenicity. However, characterizing peptide immunogenicity on a broader range of HLAs may provide insight into the effect of HLA on overall immunogenicity. Moreover, because the specific interaction between peptide and T-cell receptor is MHC-restricted<sup><xref ref-type="bibr" rid="R66">66</xref>,<xref ref-type="bibr" rid="R67">67</xref></sup>, MHC-focused studies would be required to model specific TCR:pMHC recognition.</p><p id="P59">Fourth, T-cell recognition depends not only on peptide-MHC complex, but also on multiple other factors, such as cytokine microenvironment, co-stimulatory molecules <italic>in vivo</italic> and availability of TCR repertoires that are often highly stochastic and individualized<sup><xref ref-type="bibr" rid="R68">68</xref></sup>, adding complexity to T-cell activation and function<sup><xref ref-type="bibr" rid="R69">69</xref></sup>. While there are almost no record of these determinants<sup><xref ref-type="bibr" rid="R70">70</xref></sup>, studies highlighting the influence of microenvironment on T-cell response will be pivotal to recapitulating T-cell function for therapeutic applications.</p><p id="P60">In addition, we incorporated peptide sequence at the contact position to gauge on T-cell recognition motifs. However, some studies showed that position 1 (P1) of 9-mer peptide may play an important role in T-cell binding, as demonstrated by P1, 3, 4, 5, 9 being critical for MAGE A3 binding by a3a-engineered T-cells<sup><xref ref-type="bibr" rid="R71">71</xref></sup>. Although it is difficult to deconvolute the roles of different positions in MHC and T-cell binding, more studies may shed light on the role of P1.</p><p id="P61">Fifth, due to the lack of true Negative self-antigens, we retrieved benign HLA-I ligands exclusively expressed in thymus for their relevance to central tolerance. While there have been studies describing Tregs reacting to self-peptides present in the thymus<sup><xref ref-type="bibr" rid="R72">72</xref>,<xref ref-type="bibr" rid="R73">73</xref></sup>, given that the models are targeted for CD8+ T-cells, we rationed that majority of benign HLA-I ligands will be non-immunogenic. However, not all peptides expressed in thymus will be involved in negative selection, with the notion that positive selection-inducing self-peptides are displayed by cortical thymic epithelial cells (cTEC)<sup><xref ref-type="bibr" rid="R74">74</xref></sup>. Therefore, future studies characterizing HLA-I ligand expressed in medulla thymic epithelial cells (mTEC) will improve confidence as ‘non-immunogenic self-antigens’.</p><p id="P62">Sixth, it will be valuable to extend the work of peptide immunogenicity to investigate the ability of peptides to be recognised by <italic>specific</italic> T-cells. Here, the peptide immunogenicity was investigated at the organismal level i.e. whether the peptide can elicit a response from <italic>any</italic> T-cell. The limitation was largely due to the limited pool of available peptides characterised for their cognate TCRs, however, advances in screening methods will lead to availability of more comprehensive datasets in the future, thus enabling the development of more tailored immunogenicity models. It is becoming apparent that predicting specific interactions between TCR and cognate pMHCs is crucial for developing personalised therapies and tailoring vaccines or treatments to individuals’ TCR repertoire. Therefore, screening antigen-specific TCR against a larger pool of epitopes from various origins and pathologies will greatly aid in learning peptide features that allow interaction with specific TCRs.</p><p id="P63">Lastly, the current breadth of peptides characterised by T-cell assays is far from filling the full combinatorial peptide space, especially for CD4+ T-cell targets. Also, while this model is limited to peptide specific binding of CD8+ T-cells, other T-cells are specific for lipid or small molecules like metabolites. As such, high-throughput screening of immune targets and antigen-specific TCRs by the help of recent technological advancement will greatly foster the process of model development.</p><p id="P64">Despite current data and model constraints, the novel computational strategies allowed TRAP to outperform existing models in predicting CD8+ T-cell epitopes and provide more robust, accurate, and biologically meaningful candidates for functional validations. We believe that this platform will foster a better understanding of TCR:pMHC interaction and aid in basic, clinical and translational research for a wide range of therapeutic applications.</p></sec></sec><sec id="S13" sec-type="methods"><title>Methods</title><sec id="S14"><title>Data preparation</title><sec id="S15"><title>PeptideTcell data</title><p id="P65">Peptides that bind MHC-I molecules are typically restricted to 8-10 amino acids (aa) in lengths due to closed structure of peptide-binding groove. Given the limited number of 8aa peptides in databases, peptides of lengths 9-10aa characterized by T-cells were retrieved from IEDB. These included cancer neoepitopes, autoantigens or pathogenic peptides. The peptides without HLA allele or serotype annotations were removed. To ensure MHC binding, peptides were subjected to NetMHCpan 4.0 prediction and only those with rank ≤ 2.0 (i.e. predicted MHC binder) were retained. Peptides having contradictory immunogenicity annotations were categorized as ‘Positive’ and we only included Negatives that were characterised negative in ≥3 tests. This resulted 5,093 immunogenic (‘Positive’) and 6,628 non-immunogenic (‘Negative’) peptides in PeptideTcell data. The dataset include information about peptide sequence, binary immunogenicity, HLA allele, source antigen and organism. This data is the foundation for sequence pattern analysis, model development, RSAT validation.</p></sec><sec id="S16"><title>Pathogenic data</title><p id="P66">For the analysis of sequence patterns and the development of deep learning-based models, datasets for pathogenic and self-antigens were prepared separately. For pathogenic datasets, we subset peptides originating from non-human species, resulting 4,000 Positive and 6,097 Negative pathogenic peptides.</p></sec><sec id="S17"><title>Self-antigen data</title><p id="P67">For immunogenic self-peptides, autoantigens, tumor-associated antigens and cancer neoepitopes having 9-10 amino acids were collected from different databases. We gathered 162 epitopes from Cancer peptide database, 228 from dbPepNeo, 1506 from IEDB, 256 from McPAS-TCR, and 256 from NEPdb. For Negative self-antigens, we gathered HLA-I ligands expressed in thymus suggested to be involved in the negative selection of T-cells. 240 HLA-I ligands were collected from Adamopoulou <italic>et al</italic>., which were expressed in negatively selecting dendritic cells, 187 HLA-I ligands from Espinosa <italic>et al</italic>., which were expressed in thymus, and 10,840 benign HLA-I presented peptides from HLA Ligand Atlas, exclusively expressed in thymus. Of note, we did not include ‘Negatives’ from IEDB for self-antigen data because many were tested due to their association with tumour-associated antigens e.g. cancer/testis antigen 1, melanoma-associated antigen 9; yet, there was little evidence that these peptides were immunogenic. Therefore, only MHC-I peptides expressed in thymus were included. After pre-processing, removing duplicates and filtering for peptides with NetMHCpan rank ≤ 10, the self-antigen dataset was composed of 1,606 Positive and 10,915 Negative peptides. Notably, we expanded the MHC binding rank score range to include as many self-epitopes as possible for model training and validation.</p></sec><sec id="S18"><title>Benchmarking data</title><p id="P68">The benchmarking analysis has been done in HLA-agnostic (i.e. peptide-based) or HLA-restrictive (i.e. peptide-HLA based) manner depending on the nature of different models. The TRAP makes prediction based on the peptide sequence and HLA binding rank score, which allows it to predict in both HLA-agnostic and restrictive manner. The HLA agnostic approach was applied on all peptides in the aforementioned pathogenic and self-antigen datasets. The HLA-restricted prediction was made against epitopes that were bound to 13 HLAs for which NetTepi could be performed, which are HLA-A*02:01, HLA-B*58:01, HLA-B*15:01, HLA-B*35:01, HLA-B*07:02, HLA-A*01:01, HLA-A*03:01, HLA-A*11:01, HLA-A*24:02, HLA-A*26:01, HLA-B*27:05, HLA-B*39:01, HLA-B*40:01. The list of models conducted in HLA-restricted manner are iPred, PRIME, NetTepi, IEDB and DeepImmuno. Specifically for DeepImmuno, an additional filter was applied to exclude peptides that were bound to HLAs that DeepImmuno could not process.</p></sec><sec id="S19"><title>DeepImmuno data</title><p id="P69">DeepImmuno training data was retrieved from GitHub repository, and used for evaluating the DeepImmuno performance. <ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno">https://github.com/frankligy/DeepImmuno</ext-link></p></sec></sec><sec id="S20"><title>10-fold CV and cross-species comparison</title><p id="P70">The peptideTcell data was divided randomly or in cross-species manner: i) 90% train vs. 10% test random split (i.e. representation of 10-fold cross-validation), ii) Non-SARS-CoV-2 (Non-SARS-2) train vs. SARS-2 test, and iii) Non-vaccinia virus (Non-VACV) train vs. VACV test.</p><p id="P71">To compare the performance of the XGBOOST classifier on random vs. cross-species datasets, amino acids at contact positions were first represented by their physicochemical properties using “aaDescriptors” function in R Peptides v2.4.4 package. The amino acid descriptors included kideraFactor, zScales, tScales, vhseScales, protFP, stScales, blosumIndices, mswhimScores, crucianiProperties and fasgaiVectors, which described properties such as polarity, electronic properties, hydrophobicity, α-helix/bend preference, β-sheet, bulkiness/size of side-chains, hydrogen-bonding, isoelectric point and structural topology<sup><xref ref-type="bibr" rid="R75">75</xref></sup>. In addition to amino acid-level embedding, the peptide-wide property was added by averaging these aaDescriptors across all positions for each peptide. The embeddings from random split and cross-species datasets were used to generate the XGBOOST classifier using “XGBClassifier” function in python xgboost v0.90 package. The set of hyperparameters, such as alpha, gamma, max_depth and colsample_bytree, were optimized by grid search for each dataset. The models were trained using training datasets: 90% train, Non-SARS-2 and Non-VACV peptides by 10-fold cross-validations. The trained model were tested on 10% test, SARS-2 and VACV peptides, respectively as representatives of 10-fold CV and cross-species comparisons.</p><p id="P72">To analyse sequence homology between training vs. test datasets, differential position specific scoring matrices (dPSSMs) were generated for each training and test datasets. The probability frequency of each amino acids in each position was represented by position specific scoring matrices using “consensusMatrix” function from R Biostrings v2.56.0 package. The PSSMs from Positive and Negative peptides were standardised by centre and scaling, and differential PSSMs were generated by subtracting the two. To estimate the discriminative power of the dPSSM scores, we generated dPSSMs using training data and used the matrices to score respective test peptides for their immunogenicity potential.</p></sec><sec id="S21"><title>Immunogenicity positivity score</title><p id="P73">The positivity score was computed by taking three factors into account: 1) the number of experiments conducted, 2) the percentage tested positive and 3) the number of cognate TCRs if available, using the following equations.
<disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mtext>PS</mml:mtext><mml:mo>=</mml:mo><mml:mtext>pr</mml:mtext><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TN</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Qp</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
<disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mtext>PS</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mtext>pr</mml:mtext><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TN</mml:mtext></mml:mrow><mml:mtext>Q</mml:mtext></mml:mfrac></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></disp-formula>
<disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mtext>x</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mtext>nTCR</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula>
<disp-formula id="FD4"><label>(4)</label><mml:math id="M4"><mml:mtext>PS</mml:mtext><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>max</mml:mi><mml:mo>′</mml:mo><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>x</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>∗</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>x</mml:mtext><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>x</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p id="P74">(1) computes positivity score (PS) for Positives peptides that do not have TCR information available, where pr = % responded positive, TN = total number of tests conducted and Qp = the number of tests designated as a minimum number of tests required to support positivity (Qp = 3). (2) computes PS for Negative peptides, where Qn = number of tests designated as a minimum number of tests required to support negativity (Qn = 5). (3) and (4) compute for Positives with cognate TCR information. (3) is a sigmoid function that translates the number of cognate TCR (nTCR) to values in a logistic growth curve and (4) scales the distribution to align with scores from (1), where min’ equals mean of the distribution (~1.28 equivalent to 1 test and 1 responded positive) and max’ = 2.0. Due to limited pool of peptides with cognate TCRs, the majority of peptides’ positivity score was computed by translating the number of experiments conducted and % tested positive, and the number of cognate TCRs was incorporated to add greater weights to positivity (all positivity scores with cognate TCR had values &gt; 1). The positivity scores were computed for each entry for each peptide-HLA pair, and ranged from 0 to 2.3, with Negatives ranging from 0-1 and Positives ranging from 1-2.3 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4D</xref>).</p></sec><sec id="S22"><title>Intra- and inter-HLA variability</title><p id="P75">The HLA effect was computed on 2,349 peptides having entries from multiple HLA alleles. One-way ANOVA was conducted for the effect of HLA on the positivity score for each peptide-HLA pair using ‘aov’ function from R stats v4.0.5 package. The distributions show mean squared from summary output.</p></sec><sec id="S23"><title>Differential sequence patterns</title><p id="P76">The n-grams (i.e. contiguous sequence of n-amino acids) were generated using ‘ngram’ function from R ngram v3.1.0 package. The number of peptides containing the n-grams was counted for Positive and Negative respectively and normalised for the total number of Positive and Negative peptides, respectively. Then, we computed ratio<sub>n-gram</sub> = normalized # of Positive peptides containing the n-gram / normalized # of Negative peptides containing the n-gram, and shortlist top differential n-grams by the ratio score. Similarly, we generated all possible combinations of position-specific k-mer motifs (i.e. contiguous or non-contiguous sequence of k amino acids restricted to peptides of same lengths), where e.g. .M.W. denotes MW pattern at P2 and P4 of 5 amino acid peptide. We computed ratio <sub>positional k-mer</sub> = normalized # of Positive peptides containing the positional k-mer / normalized # of Negative peptides containing the positional k-mer to shortlisted top differential position-specific k-mer motifs. For visualization, patterns were categorized by their normalized ratios, where ‘lows’ have ¼ &lt; ratio &lt; 4, ‘high in pos’ have ratio ≥ 4, ‘high in neg’ have ratio ≤ ¼, and ‘onlys’ have motifs in either positive or negative sets, and top differential patterns from ‘high’ or ‘only’ categories were visualized by barplot. To identify shared enriched patterns between pathogenic and self-antigens, only n-grams or positional k-mer motifs having ratio ≥ 3 or ≥ 3 positive peptides (for onlys) were pre-selected for comparison. The pairwise sequence similarity between peptides was computed using ‘pairwiseAlignment’ function in Biostrings v2.56.0 package<sup><xref ref-type="bibr" rid="R76">76</xref></sup>, using BLOSUM62 substitution matrix and default parameters. For clusters of highly similar peptides, the peptides having alignment scores ≥22 with ≥3 other peptides were visualized into network graph using R ggnetwork v0.5.10 package. The toolkits for generating the sequence patterns are deposited in: <ext-link ext-link-type="uri" xlink:href="https://github.com/ChloeHJ/diffSeqPatterns">https://github.com/ChloeHJ/diffSeqPatterns</ext-link>.</p></sec><sec id="S24"><title>Deep learning models for pathogenic and self-epitope prediction</title><p id="P77">The peptide sequences at contact positions, i.e. P3-P8 of 9aa and P3-P9 of 10aa peptides, were encoded either by one-hot-encoding having dimension [m, 7, 21], amino acid descriptors [m, 7, 49] or amino acid embeddings from protein transformer-based pretrained language models (PLMs) models [m, 7, 1024], where m represents the number of peptides. The amino acid descriptors included kideraFactors, tScales, protFP, BLOSUM, stScales and MSWHIM captured by “aaDescriptors” function from R Peptides v2.4.4 package, and Atchley factors from “AAMetric.Atchley” function in R HDMD v1.2 package. In addition, amino acids were embedded using five protein transformer-based PLMs, including prot_t5_xl_uniref50, prot_bert, prot_bert_bfd, prot_t5_xl_bfd, prot_xlnet from Rostlab using Tokenizer and EncoderModel functions from python transformers v4.19.0 package. These models are based on T5 or BERT and were pre-trained on a large corpus of protein sentences, e.g. UniRef50, a dataset consisting of 45 million protein sequences, in a semi-supervised fashion. Further details about transformer-based PLMs can be found in <ext-link ext-link-type="uri" xlink:href="https://huggingface.com/Rostlab">https://huggingface.com/Rostlab</ext-link>.</p><p id="P78">To account for peptides of varying lengths, the peptides coming from 9aa peptides were padded (i.e. adding non-relevant number to the borders of the matrix) either in the front (i.e. pre-padding) or at the back (i.e. post-padding). First, we computed all possible n-grams from 6- and 7-mer peptides, and analysed if the same n-grams were present in both 6- and 7-mers. We found that many n-grams were present in both 6- and 7-mers. We then aligned by their respective positions, and observed that many 3-grams located in P3-P5 of 9aa peptides were positioned at P4-P6 of 10aa peptides, indicating padding in front of 6-mer peptide (i.e. pre-padding) would align with hotspots in 7-mers.</p><p id="P79">The classification accuracies of different deep learning architectures were compared between simple dense layer (i.e. classification), biRNN, biLSTM, 1D CNN, 2D CNN and transformer models. The biRNN model contained two biRNN layers each having 512 units, followed by a dense layer of 256 units and a classification layer with dropouts in-between. The biLSTM model had the same structure as the biRNN model, but LSTM cell is used instead of the RNN cell. 2D CNN model had two Conv2D layers, with filters = 16 and 32 respectively, followed by MaxPool2D, Flatten, a dense layer of 256 units anda classification layer with dropouts in-between. The transformer model for pathogenic and self-antigen data had 10 and 2 attention heads respectively and 32 hidden layers in a feed forward network, followed by GlobalAveragePooling1D, dense layer with 128 units and classification, with dropouts in-between. The 1D CNN had kernel sizes 1, 3, 5 and 7, each max pooled and concatenated to a layer. In parallel, -log transformed NetMHCpan rank and hydrophobicity (i.e. the proportion of A, V, L, M, W) have been added as a MLP layer. 1D CNN and MLP layers were concatenated, and put into a dense layer of 256 units followed by classification. The hyperparameters of the final 1D CNN models were optimized by grid search. The final hyperparameters for pathogenic model are: learning rate = 1e-05, weight decay = 1e-06, dropout rate = 0.1, batch size = 50, dense layer node = 2000 and dense layer node = 256, giving ROC-AUC of 0.764 by 10-fold cross-validation. The final hyperparameters for self-antigen model are: learning rate = 0.001, weight decay = 0.01, dropout rate = 0.2, batch size = 100, MLP dense = 1500 and dense layer node = 512, giving ROC-AUC of 0.943 by 10-fold cross-validation. All deep learning architectures are implemented using python TensorFlow v2.8.0 package.</p></sec><sec id="S25"><title>Out of distribution (OOD) detection</title><p id="P80">Autoencoder is a type of unsupervised neural network that have a smaller number of neurons in the hidden layers than the input layer. This allows the architecture to extract essential information from the input layer, preserve in lower-dimension, and employ to reconstruct output. We used the difference between the input and reconstructed output (i.e. reconstruction loss) as a metric for anomaly detection, as autoencoders cannot effectively reconstruct patterns not learnt from training data<sup><xref ref-type="bibr" rid="R56">56</xref></sup>.</p><p id="P81">For anomaly detection, peptides encoded by prot_t5_xl_uniref50 transformer-based PLM were applied onto 2D and 3D autoencoders, variational autoencoder and denoising autoencoder models, using ‘AutoEncoder’ function from python pyod v1.0.1 package. The autoencoder models were trained using 90% random train and non-SARS-CoV-2 data, and were used to predict 10% test and SARS-CoV-2 data respectively. Then, we computed reconstruction loss between original and predicted test values.</p><p id="P82">For calibration methods, the 1D CNN model was trained using softmax activation function. We then computed softmax probability (MaxProb) and temperature-scaled softmax probability (T=2) for each test peptide. The MaxProb is the maximum softmax probability between class 0 (Negative) and 1 (Positive). The temperature scaling softens the softmax probability with T &gt; 1, making the network slightly less confident, reflecting the true probabilities<sup><xref ref-type="bibr" rid="R77">77</xref></sup>. For Ensemble, we used 10-folds of the training dataset to generate 10 different models. These models were then used to predict test data points, producing prediction scores for each. We combined MaxProb and found the average MaxProb of ten models. For Monte Carlo dropout, Monte Carlo models were reiterated 100 times with stochastic dropout of 0.6. The MaxProb was generated from each, and averaged over 100 scores. The final OOD classifier predicts correct vs. incorrect predictions by using the MaxProb and average MaxProb from the Ensemble as inputs to the decision tree classifier. The classifier was built using the ‘DecisionTreeClassifier’ function from python sklearn v1.0.2 package.</p></sec><sec id="S26"><title>Relative similarity to autoantigens or tumour-associated antigens (RSAT)</title><p id="P83">To compute RSAT, a total of 5023 unique cancer neoepitopes, autoantigens, tumour-associated antigens and other self-epitopes were retrieved from IEDB, dbPepNeo, NEPdb, McPAS-TCR and tumour antigenic peptide database. First, only pathogenic peptides having comparable self-epitope counterparts are retrained by computing Match score<sup><xref ref-type="bibr" rid="R78">78</xref></sup> (5) between pathogenic peptides and self-epitopes, where BL represents the global-local alignment score using BLOSUM62 matrix, p represents pathogenic peptide and se self-epitopes. Only pathogenic peptides having a match score ≥ 0.6 are retained to compute RSAT.
<disp-formula id="FD5"><label>(5)</label><mml:math id="M5"><mml:mtext> </mml:mtext><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∗</mml:mo><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P84">For pathogenic peptides having comparable self-epitope counterparts, RSAT was computed (6). First, we computed the maximum global-local alignment score between pathogenic peptides and AATs (a set of autoimmunity, allergy tor tumour-associated antigens) using the BLOSUM62 substitution matrix. Second, we computed the maximum global alignment score between pathogenic peptide and AAT’s best counterpart in human proteome. Third, we computed the ratio between alignment scores from self-epitope and human proteome counterpart. In the <xref ref-type="disp-formula" rid="FD6">equation (6)</xref> below, p = pathogenic peptide, AAT = autoimmunity, allergy tor tumour-associated antigens, hp = human proteome.
<disp-formula id="FD6"><label>(6)</label><mml:math id="M6"><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="S27"><title>Application of TRAP to shortlisting glioblastoma neoantigens</title><p id="P85">In previous in-house study<sup><xref ref-type="bibr" rid="R63">63</xref></sup>, tumours of four HLA-A2 glioblastoma patients were sequenced and cancer neoepitopes were shortlisted using an in-house version of MuPeXI<sup><xref ref-type="bibr" rid="R62">62</xref></sup> named TUNAPASTA v0.5. We then selected 153 predicted neoepitopes for functional T-cell assays, 33 of which were characterised Positive. From these 153 tested peptides, we filtered out predicted HLA*02:01 non-binders and retained 9-10 amino acid peptides that were applicable to TRAP. This left 124 GBM peptides, 25 of which were Positives and 99 Negatives. We used a pre-trained self-antigen TRAP model on this dataset to predict the immunogenicity of GBM peptides as well as the confidence of prediction by the OOD detection module. Because identifying cancer neoepitopes is thought to be a ‘needle in a haystack’ problem, we identified predicted Negatives with low-confidence prediction, and added 24 more candidates for validation, resulting in a ROC-AUC of 0.705.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Figures</label><media xlink:href="EMS159135-supplement-Supplemental_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d33aAdDbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S28"><title>Acknowledgements</title><p>This work has been supported by Medical Research Council. HK is funded by MRC Human Immunology Unit core funding. CL is funded by UK National Institute of Health Research (NIHR). AS is funded by a Wellcome Investigator Award (219523/Z/19/Z), the UK Medical Research Council, NIHR, awards from Bristol-Myers Squibb and UCB. The views expressed are those of the author(s) and not necessarily those of the NHS, the NIHR, or the Department of Health, UK.</p></ack><fn-group><fn id="FN1" fn-type="con"><p id="P86"><bold>Author contributions</bold></p><p id="P87">CL and HK conceived the study. CL designed and conducted all computational analysis with inputs from AA, JH, MJ, PB, MP, RF, AS and HK. CL developed deep learning model with inputs from JH and MJ. PB and CL conducted benchmarking. CL wrote the manuscript. JH, PB, MJ, MP, RF, AA, AS and HK commented and edited the manuscript. AS and HK supervised the study. All authors contributed to the article and approved the submitted version.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krammer</surname><given-names>F</given-names></name></person-group><article-title>SARS-CoV-2 vaccines in development</article-title><source>Nature</source><year>2020</year><volume>586</volume><fpage>516</fpage><lpage>527</lpage><pub-id pub-id-type="pmid">32967006</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ott</surname><given-names>PA</given-names></name><etal/></person-group><article-title>An immunogenic personal neoantigen vaccine for patients with melanoma</article-title><source>Nature</source><year>2017</year><volume>547</volume><fpage>217</fpage><lpage>221</lpage><pub-id pub-id-type="pmcid">PMC5577644</pub-id><pub-id pub-id-type="pmid">28678778</pub-id><pub-id pub-id-type="doi">10.1038/nature22991</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zacharakis</surname><given-names>N</given-names></name><etal/></person-group><article-title>Immune recognition of somatic mutations leading to complete durable regression in metastatic breast cancer</article-title><source>Nature Medicine</source><year>2018</year><volume>24</volume><fpage>724</fpage><lpage>730</lpage><pub-id pub-id-type="pmcid">PMC6348479</pub-id><pub-id pub-id-type="pmid">29867227</pub-id><pub-id pub-id-type="doi">10.1038/s41591-018-0040-8</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joglekar</surname><given-names>AV</given-names></name><name><surname>Li</surname><given-names>G</given-names></name></person-group><article-title>T cell antigen discovery</article-title><source>Nature Methods</source><year>2020</year><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">32632239</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubelt</surname><given-names>F</given-names></name><etal/></person-group><article-title>Adaptive Immune Receptor Repertoire Community recommendations for sharing immune-repertoire sequencing data</article-title><source>Nat Immunol</source><year>2017</year><volume>18</volume><fpage>1274</fpage><lpage>1278</lpage><pub-id pub-id-type="pmcid">PMC5790180</pub-id><pub-id pub-id-type="pmid">29144493</pub-id><pub-id pub-id-type="doi">10.1038/ni.3873</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birnbaum</surname><given-names>ME</given-names></name><etal/></person-group><article-title>Deconstructing the Peptide-MHC Specificity of T Cell Recognition</article-title><source>Cell</source><year>2014</year><volume>157</volume><fpage>1073</fpage><lpage>1087</lpage><pub-id pub-id-type="pmcid">PMC4071348</pub-id><pub-id pub-id-type="pmid">24855945</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2014.03.047</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buckley</surname><given-names>PR</given-names></name><etal/></person-group><article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title><source>Briefings in Bioinformatics</source><year>2022</year><volume>23</volume><elocation-id>bbac141</elocation-id><pub-id pub-id-type="pmcid">PMC9116217</pub-id><pub-id pub-id-type="pmid">35471658</pub-id><pub-id pub-id-type="doi">10.1093/bib/bbac141</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wells</surname><given-names>DK</given-names></name><etal/></person-group><article-title>Key Parameters of Tumor Epitope Immunogenicity Revealed Through a Consortium Approach Improve Neoantigen Prediction</article-title><source>Cell</source><year>2020</year><volume>183</volume><fpage>818</fpage><lpage>834</lpage><elocation-id>e13</elocation-id><pub-id pub-id-type="pmcid">PMC7652061</pub-id><pub-id pub-id-type="pmid">33038342</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.015</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karnaukhov</surname><given-names>V</given-names></name><etal/></person-group><article-title>HLA binding of self-peptides is biased towards proteins with specific molecular functions</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021.02.16.431395</elocation-id><pub-id pub-id-type="doi">10.1101/2021.02.16.431395</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bassani-Sternberg</surname><given-names>M</given-names></name><name><surname>Gfeller</surname><given-names>D</given-names></name></person-group><article-title>Unsupervised HLA Peptidome Deconvolution Improves Ligand Prediction Accuracy and Predicts Cooperative Effects in Peptide–HLA Interactions</article-title><source>The Journal of Immunology</source><year>2016</year><volume>197</volume><fpage>2492</fpage><lpage>2499</lpage><pub-id pub-id-type="pmid">27511729</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bassani-Sternberg</surname><given-names>M</given-names></name><etal/></person-group><article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title><source>PLOS Computational Biology</source><year>2017</year><volume>13</volume><elocation-id>e1005725</elocation-id><pub-id pub-id-type="pmcid">PMC5584980</pub-id><pub-id pub-id-type="pmid">28832583</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005725</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jurtz</surname><given-names>V</given-names></name><etal/></person-group><article-title>NetMHCpan-4.0: Improved Peptide–MHC Class I Interaction Predictions Integrating Eluted Ligand and Peptide Binding Affinity Data</article-title><source>The Journal of Immunology</source><year>2017</year><volume>199</volume><fpage>3360</fpage><lpage>3368</lpage><pub-id pub-id-type="pmcid">PMC5679736</pub-id><pub-id pub-id-type="pmid">28978689</pub-id><pub-id pub-id-type="doi">10.4049/jimmunol.1700893</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calis</surname><given-names>JJA</given-names></name><etal/></person-group><article-title>Properties of MHC Class I Presented Peptides That Enhance Immunogenicity</article-title><source>PLOS Computational Biology</source><year>2013</year><volume>9</volume><elocation-id>e1003266</elocation-id><pub-id pub-id-type="pmcid">PMC3808449</pub-id><pub-id pub-id-type="pmid">24204222</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003266</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogishi</surname><given-names>M</given-names></name><name><surname>Yotsuyanagi</surname><given-names>H</given-names></name></person-group><article-title>Quantitative Prediction of the Landscape of T Cell Epitope Immunogenicity in Sequence Space</article-title><source>Front Immunol</source><year>2019</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC6477061</pub-id><pub-id pub-id-type="pmid">31057550</pub-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.00827</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Iyer</surname><given-names>B</given-names></name><name><surname>Prasath</surname><given-names>VBS</given-names></name><name><surname>Ni</surname><given-names>Y</given-names></name><name><surname>Salomonis</surname><given-names>N</given-names></name></person-group><article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title><source>Briefings in Bioinformatics</source><year>2021</year><pub-id pub-id-type="pmcid">PMC8135853</pub-id><pub-id pub-id-type="pmid">34009266</pub-id><pub-id pub-id-type="doi">10.1093/bib/bbab160</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trolle</surname><given-names>T</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name></person-group><article-title>NetTepi: an integrated method for the prediction of T cell epitopes</article-title><source>Immunogenetics</source><year>2014</year><volume>66</volume><fpage>449</fpage><lpage>456</lpage><pub-id pub-id-type="pmid">24863339</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname><given-names>MV</given-names></name><etal/></person-group><article-title>Exploring the pre-immune landscape of antigen-specific T cells</article-title><source>Genome Medicine</source><year>2018</year><volume>10</volume><fpage>68</fpage><pub-id pub-id-type="pmcid">PMC6109350</pub-id><pub-id pub-id-type="pmid">30144804</pub-id><pub-id pub-id-type="doi">10.1186/s13073-018-0577-7</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tung</surname><given-names>C-W</given-names></name><name><surname>Ziehm</surname><given-names>M</given-names></name><name><surname>Kämper</surname><given-names>A</given-names></name><name><surname>Kohlbacher</surname><given-names>O</given-names></name><name><surname>Ho</surname><given-names>S-Y</given-names></name></person-group><article-title>POPISK: T-cell reactivity prediction using support vector machines and string kernels</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>446</fpage><pub-id pub-id-type="pmcid">PMC3228774</pub-id><pub-id pub-id-type="pmid">22085524</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-12-446</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chowell</surname><given-names>D</given-names></name><etal/></person-group><article-title>TCR contact residue hydrophobicity is a hallmark of immunogenic CD8+ T cell epitopes</article-title><source>PNAS</source><year>2015</year><volume>112</volume><fpage>E1754</fpage><lpage>E1762</lpage><pub-id pub-id-type="pmcid">PMC4394253</pub-id><pub-id pub-id-type="pmid">25831525</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1500973112</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chowell</surname><given-names>D</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name><name><surname>Blattman</surname><given-names>J</given-names></name><name><surname>Anderson</surname><given-names>K</given-names></name></person-group><article-title>Hydrophobicity is a hallmark of immunogenic MHC class I T cell epitopes (APP2P.111)</article-title><source>The Journal of Immunology</source><year>2014</year><volume>192</volume><elocation-id>43.1243.12</elocation-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richman</surname><given-names>LP</given-names></name><name><surname>Vonderheide</surname><given-names>RH</given-names></name><name><surname>Rech</surname><given-names>AJ</given-names></name></person-group><article-title>Neoantigen Dissimilarity to the Self-Proteome Predicts Immunogenicity and Response to Immune Checkpoint Blockade</article-title><source>Cell Systems</source><year>2019</year><volume>9</volume><fpage>375</fpage><lpage>382</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC6813910</pub-id><pub-id pub-id-type="pmid">31606370</pub-id><pub-id pub-id-type="doi">10.1016/j.cels.2019.08.009</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>JR</given-names></name><etal/></person-group><article-title>Structural dissimilarity from self drives neoepitope escape from immune tolerance</article-title><source>Nature Chemical Biology</source><year>2020</year><volume>16</volume><fpage>1269</fpage><lpage>1276</lpage><pub-id pub-id-type="pmcid">PMC8210748</pub-id><pub-id pub-id-type="pmid">32807968</pub-id><pub-id pub-id-type="doi">10.1038/s41589-020-0610-1</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>CH</given-names></name><name><surname>Antanaviciute</surname><given-names>A</given-names></name><name><surname>Buckley</surname><given-names>PR</given-names></name><name><surname>Simmons</surname><given-names>A</given-names></name><name><surname>Koohy</surname><given-names>H</given-names></name></person-group><article-title>To what extent does MHC binding translate to immunogenicity in humans?</article-title><source>ImmunoInformatics</source><year>2021</year><volume>3–4</volume><elocation-id>100006</elocation-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><etal/></person-group><article-title>Highly accurate protein structure prediction with AlphaFold</article-title><source>Nature</source><year>2021</year><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="pmcid">PMC8371605</pub-id><pub-id pub-id-type="pmid">34265844</pub-id><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>KK</given-names></name><etal/></person-group><article-title>Improved methods for predicting peptide binding affinity to MHC class II molecules</article-title><source>Immunology</source><year>2018</year><volume>154</volume><fpage>394</fpage><lpage>406</lpage><pub-id pub-id-type="pmcid">PMC6002223</pub-id><pub-id pub-id-type="pmid">29315598</pub-id><pub-id pub-id-type="doi">10.1111/imm.12889</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Racle</surname><given-names>J</given-names></name><etal/></person-group><article-title>Robust prediction of HLA class II epitopes by deep motif deconvolution of immunopeptidomes</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>1283</fpage><lpage>1286</lpage><pub-id pub-id-type="pmid">31611696</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>T</given-names></name><etal/></person-group><article-title>Deep learning-based prediction of the T cell receptor–antigen binding specificity</article-title><source>Nat Mach Intell</source><year>2021</year><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC9396750</pub-id><pub-id pub-id-type="pmid">36003885</pub-id><pub-id pub-id-type="doi">10.1038/s42256-021-00383-2</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sidhom</surname><given-names>J-W</given-names></name><name><surname>Larman</surname><given-names>HB</given-names></name><name><surname>Pardoll</surname><given-names>DM</given-names></name><name><surname>Baras</surname><given-names>AS</given-names></name></person-group><article-title>DeepTCR is a deep learning framework for revealing sequence concepts within T-cell repertoires</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><fpage>1605</fpage><pub-id pub-id-type="pmcid">PMC7952906</pub-id><pub-id pub-id-type="pmid">33707415</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-21879-w</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>A</given-names></name><name><surname>Born</surname><given-names>J</given-names></name><name><surname>Rodriguez Martinez</surname><given-names>M</given-names></name></person-group><article-title>TITAN: T-cell receptor specificity prediction with bimodal attention networks</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><fpage>i237</fpage><lpage>i244</lpage><pub-id pub-id-type="pmcid">PMC8275323</pub-id><pub-id pub-id-type="pmid">34252922</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab294</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rives</surname><given-names>A</given-names></name><etal/></person-group><article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title><source>PNAS</source><year>2021</year><volume>118</volume><pub-id pub-id-type="pmcid">PMC8053943</pub-id><pub-id pub-id-type="pmid">33876751</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>R</given-names></name><etal/></person-group><article-title>Evaluating Protein Transfer Learning with TAPE</article-title><source>Adv Neural Inf Process Syst</source><year>2019</year><volume>32</volume><fpage>9689</fpage><lpage>9701</lpage><pub-id pub-id-type="pmcid">PMC7774645</pub-id><pub-id pub-id-type="pmid">33390682</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>1315</fpage><lpage>1322</lpage><pub-id pub-id-type="pmcid">PMC7067682</pub-id><pub-id pub-id-type="pmid">31636460</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0598-1</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elnaggar</surname><given-names>A</given-names></name><etal/></person-group><source>ProtTrans: Towards Cracking the Language of Life’s Code Through Self-Supervised Learning</source><year>2020</year><pub-id pub-id-type="doi">10.1101/2020.07.12.199554</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalyan</surname><given-names>KS</given-names></name><name><surname>Rajasekharan</surname><given-names>A</given-names></name><name><surname>Sangeetha</surname><given-names>S</given-names></name></person-group><source>AMMUS : A Survey of Transformer-based Pretrained Models in Natural Language Processing</source><year>2021</year><pub-id pub-id-type="doi">10.48550/arXiv.2108.05542</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roshanzamir</surname><given-names>A</given-names></name><name><surname>Aghajan</surname><given-names>H</given-names></name><name><surname>Soleymani Baghshah</surname><given-names>M</given-names></name></person-group><article-title>Transformer-based deep neural network language models for Alzheimer’s disease risk assessment from targeted speech</article-title><source>BMC Medical Informatics and Decision Making</source><year>2021</year><volume>21</volume><fpage>92</fpage><pub-id pub-id-type="pmcid">PMC7971114</pub-id><pub-id pub-id-type="pmid">33750385</pub-id><pub-id pub-id-type="doi">10.1186/s12911-021-01456-3</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Devlin</surname><given-names>J</given-names></name><name><surname>Chang</surname><given-names>M-W</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Toutanova</surname><given-names>K</given-names></name></person-group><source>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</source><conf-name>Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2019</year><fpage>4171</fpage><lpage>4186</lpage><pub-id pub-id-type="doi">10.18653/v1/N19-1423</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torralba</surname><given-names>A</given-names></name><name><surname>Efros</surname><given-names>AA</given-names></name></person-group><article-title>Unbiased look at dataset bias</article-title><source>CVPR</source><year>2011</year><volume>2011</volume><fpage>1521</fpage><lpage>1528</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2011.5995347</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="book"><source>Dataset shift in machine learning</source><publisher-name>MIT Press</publisher-name><year>2009</year></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Eykholt</surname><given-names>K</given-names></name><etal/></person-group><source>Robust Physical-World Attacks on Deep Learning Visual Classification</source><conf-name>2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition</conf-name><year>2018</year><fpage>1625</fpage><lpage>1634</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2018.00175</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ribeiro</surname><given-names>MT</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Guestrin</surname><given-names>C</given-names></name><name><surname>Singh</surname><given-names>S</given-names></name></person-group><source>Beyond Accuracy: Behavioral Testing of NLP Models with CheckList</source><conf-name>Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2020</year><fpage>4902</fpage><lpage>4912</lpage><pub-id pub-id-type="doi">10.18653/v1/2020.acl-main.442</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>R</given-names></name><name><surname>Liang</surname><given-names>P</given-names></name></person-group><source>Adversarial Examples for Evaluating Reading Comprehension Systems</source><conf-name>Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing 2021-2031</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2017</year><pub-id pub-id-type="doi">10.18653/v1/D17-1215</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amodei</surname><given-names>D</given-names></name><etal/></person-group><article-title>Concrete Problems in AI Safety</article-title><year>2016</year><pub-id pub-id-type="doi">10.48550/arXiv.1606.06565</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hendrycks</surname><given-names>D</given-names></name><name><surname>Gimpel</surname><given-names>K</given-names></name></person-group><article-title>A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks</article-title><year>2018</year><pub-id pub-id-type="doi">10.48550/arXiv.1610.02136</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Varshney</surname><given-names>N</given-names></name><name><surname>Mishra</surname><given-names>S</given-names></name><name><surname>Baral</surname><given-names>C</given-names></name></person-group><source>Towards Improving Selective Prediction Ability of NLP Systems</source><conf-name>Proceedings of the 7th Workshop on Representation Learning for NLP</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2022</year><fpage>221</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.18653/v1/2022.repl4nlp-1.23</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Arora</surname><given-names>U</given-names></name><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>He</surname><given-names>H</given-names></name></person-group><source>Types of Out-of-Distribution Texts and How to Detect Them</source><conf-name>Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2021</year><fpage>10687</fpage><lpage>10701</lpage><pub-id pub-id-type="doi">10.18653/v1/2021.emnlp-main.835</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>C</given-names></name><name><surname>Jang</surname><given-names>M</given-names></name><name><surname>Seo</surname><given-names>S</given-names></name><name><surname>Park</surname><given-names>K</given-names></name><name><surname>Kang</surname><given-names>P</given-names></name></person-group><article-title>Intrusion Detection Based on Sequential Information Preserving Log Embedding Methods and Anomaly Detection Algorithms</article-title><source>IEEE Access</source><year>2021</year><volume>9</volume><fpage>58088</fpage><lpage>58101</lpage></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schlegl</surname><given-names>T</given-names></name><name><surname>Seeböck</surname><given-names>P</given-names></name><name><surname>Waldstein</surname><given-names>SM</given-names></name><name><surname>Schmidt-Erfurth</surname><given-names>U</given-names></name><name><surname>Langs</surname><given-names>G</given-names></name></person-group><chapter-title>Unsupervised Anomaly Detection with Generative Adversarial Networks to Guide Marker Discovery</chapter-title><source>Information Processing in Medical Imaging</source><person-group person-group-type="editor"><name><surname>Niethammer</surname><given-names>M</given-names></name><etal/></person-group><publisher-name>Springer International Publishing</publisher-name><year>2017</year><fpage>146</fpage><lpage>157</lpage><pub-id pub-id-type="doi">10.1007/978-3-319-59050-9_12</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jang</surname><given-names>M</given-names></name><name><surname>Lukasiewicz</surname><given-names>T</given-names></name></person-group><article-title>NoiER: An Approach for Training More Reliable Fine-Tuned Downstream Task Models</article-title><source>IEEE/ACM Transactions on Audio, Speech, and Language Processing</source><year>2022</year><volume>30</volume><fpage>2514</fpage><lpage>2525</lpage></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>A</given-names></name><etal/></person-group><article-title>Predicting the Immunogenicity of T cell epitopes: From HIV to SARS-CoV-2</article-title><year>2020</year><elocation-id>2020.05.14.095885</elocation-id><pub-id pub-id-type="doi">10.1101/2020.05.14.095885</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruppert</surname><given-names>J</given-names></name><etal/></person-group><article-title>Prominent role of secondary anchor residues in peptide binding to HLA-A2.1 molecules</article-title><source>Cell</source><year>1993</year><volume>74</volume><fpage>929</fpage><lpage>937</lpage><pub-id pub-id-type="pmid">8104103</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>K</given-names></name><etal/></person-group><source>Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation</source><conf-name>Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2014</year><fpage>1724</fpage><lpage>1734</lpage><pub-id pub-id-type="doi">10.3115/v1/D14-1179</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>Y</given-names></name></person-group><source>Convolutional Neural Networks for Sentence Classification</source><conf-name>Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)</conf-name><publisher-name>Association for Computational Linguistics</publisher-name><year>2014</year><fpage>1746</fpage><lpage>1751</lpage><pub-id pub-id-type="doi">10.3115/v1/D14-1181</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wooldridge</surname><given-names>L</given-names></name><etal/></person-group><article-title>CD8 Controls T Cell Cross-Reactivity</article-title><source>The Journal of Immunology</source><year>2010</year><volume>185</volume><fpage>4625</fpage><lpage>4632</lpage><pub-id pub-id-type="pmcid">PMC3018649</pub-id><pub-id pub-id-type="pmid">20844204</pub-id><pub-id pub-id-type="doi">10.4049/jimmunol.1001480</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bentzen</surname><given-names>AK</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name></person-group><article-title>T-cell-receptor cross-recognition and strategies to select safe T-cell receptors for clinical translation</article-title><source>Immuno-Oncology Technology</source><year>2019</year><volume>2</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmcid">PMC8741623</pub-id><pub-id pub-id-type="pmid">35036898</pub-id><pub-id pub-id-type="doi">10.1016/j.iotech.2019.06.003</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>D</given-names></name><name><surname>Heckendorf</surname><given-names>C</given-names></name></person-group><article-title>ngram: Fast n-Gram ‘Tokenization’</article-title><year>2021</year></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>C</given-names></name><name><surname>Paffenroth</surname><given-names>RC</given-names></name></person-group><source>Anomaly Detection with Robust Deep Autoencoders</source><conf-name>Proceedings of the 23rd ACMSIGKDD International Conference on Knowledge Discovery and Data Mining</conf-name><publisher-name>Association for Computing Machinery</publisher-name><year>2017</year><fpage>665</fpage><lpage>674</lpage><pub-id pub-id-type="doi">10.1145/3097983.3098052</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koncz</surname><given-names>B</given-names></name><etal/></person-group><article-title>Self-mediated positive selection of T cells sets an obstacle to the recognition of nonself</article-title><source>PNAS</source><year>2021</year><volume>118</volume><pub-id pub-id-type="pmcid">PMC8449404</pub-id><pub-id pub-id-type="pmid">34507984</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2100542118</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>J</given-names></name><etal/></person-group><article-title>NEPdb: A Database of T-Cell Experimentally-Validated Neoantigens and Pan Cancer Predicted Neoepitopes for Cancer Immunotherapy</article-title><source>Frontiers in Immunology</source><year>2021</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC8078594</pub-id><pub-id pub-id-type="pmid">33927717</pub-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.644637</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>X</given-names></name><etal/></person-group><article-title>dbPepNeo: a manually curated database for human tumor neoantigen peptides</article-title><source>Database</source><year>2020</year><volume>2020</volume><pub-id pub-id-type="pmcid">PMC7043295</pub-id><pub-id pub-id-type="pmid">32090262</pub-id><pub-id pub-id-type="doi">10.1093/database/baaa004</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tickotsky</surname><given-names>N</given-names></name><name><surname>Sagiv</surname><given-names>T</given-names></name><name><surname>Prilusky</surname><given-names>J</given-names></name><name><surname>Shifrut</surname><given-names>E</given-names></name><name><surname>Friedman</surname><given-names>N</given-names></name></person-group><article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><fpage>2924</fpage><lpage>2929</lpage><pub-id pub-id-type="pmid">28481982</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fleri</surname><given-names>W</given-names></name><etal/></person-group><article-title>The Immune Epitope Database and Analysis Resource in Epitope Discovery and Synthetic Vaccine Design</article-title><source>Frontiers in Immunology</source><year>2017</year><volume>8</volume><pub-id pub-id-type="pmcid">PMC5348633</pub-id><pub-id pub-id-type="pmid">28352270</pub-id><pub-id pub-id-type="doi">10.3389/fimmu.2017.00278</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjerregaard</surname><given-names>A-M</given-names></name><name><surname>Nielsen</surname><given-names>M</given-names></name><name><surname>Hadrup</surname><given-names>SR</given-names></name><name><surname>Szallasi</surname><given-names>Z</given-names></name><name><surname>Eklund</surname><given-names>AC</given-names></name></person-group><article-title>MuPeXI: prediction of neo-epitopes from tumor sequencing data</article-title><source>Cancer Immunol Immunother</source><year>2017</year><volume>66</volume><fpage>1123</fpage><lpage>1130</lpage><pub-id pub-id-type="pmid">28429069</pub-id></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>R</given-names></name><etal/></person-group><article-title>Decitabine increases neoantigen and cancer testis antigen expression to enhance T-cell-mediated toxicity against glioblastoma</article-title><source>Neuro-Oncology</source><year>2022</year><elocation-id>noac107</elocation-id><pub-id pub-id-type="pmcid">PMC9713507</pub-id><pub-id pub-id-type="pmid">35468205</pub-id><pub-id pub-id-type="doi">10.1093/neuonc/noac107</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buckley</surname><given-names>PR</given-names></name><name><surname>Lee</surname><given-names>CH</given-names></name><name><surname>Antanaviciute</surname><given-names>A</given-names></name><name><surname>Simmons</surname><given-names>A</given-names></name><name><surname>Koohy</surname><given-names>H</given-names></name></person-group><source>A systems approach evaluating the impact of SARS-CoV-2 variant of concern mutations on CD8+ T cell responses</source><elocation-id>2022.10.21.513200</elocation-id><year>2022</year><pub-id pub-id-type="doi">10.1101/2022.10.21.513200</pub-id></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>RE</given-names></name><etal/></person-group><article-title>Infectious disease in an era of global change</article-title><source>Nat Rev Microbiol</source><year>2022</year><volume>20</volume><fpage>193</fpage><lpage>205</lpage><pub-id pub-id-type="pmcid">PMC8513385</pub-id><pub-id pub-id-type="pmid">34646006</pub-id><pub-id pub-id-type="doi">10.1038/s41579-021-00639-z</pub-id></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zinkernagel</surname><given-names>RM</given-names></name><name><surname>Doherty</surname><given-names>PC</given-names></name></person-group><article-title>Restriction of in vitro T cell-mediated cytotoxicity in lymphocytic choriomeningitis within a syngeneic or semiallogeneic system</article-title><source>Nature</source><year>1974</year><volume>248</volume><fpage>701</fpage><lpage>702</lpage><pub-id pub-id-type="pmid">4133807</pub-id></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>La Gruta</surname><given-names>NL</given-names></name><name><surname>Gras</surname><given-names>S</given-names></name><name><surname>Daley</surname><given-names>SR</given-names></name><name><surname>Thomas</surname><given-names>PG</given-names></name><name><surname>Rossjohn</surname><given-names>J</given-names></name></person-group><article-title>Understanding the drivers of MHC restriction of T cell receptors</article-title><source>Nat Rev Immunol</source><year>2018</year><volume>18</volume><fpage>467</fpage><lpage>478</lpage><pub-id pub-id-type="pmid">29636542</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duan</surname><given-names>F</given-names></name><etal/></person-group><article-title>Genomic and bioinformatic profiling of mutational neoepitopes reveals new rules to predict anticancer immunogenicity</article-title><source>J Exp Med</source><year>2014</year><volume>211</volume><fpage>2231</fpage><lpage>2248</lpage><pub-id pub-id-type="pmcid">PMC4203949</pub-id><pub-id pub-id-type="pmid">25245761</pub-id><pub-id pub-id-type="doi">10.1084/jem.20141308</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Flies</surname><given-names>DB</given-names></name></person-group><article-title>Molecular mechanisms of T cell co-stimulation and co-inhibition</article-title><source>Nat Rev Immunol</source><year>2013</year><volume>13</volume><fpage>227</fpage><lpage>242</lpage><pub-id pub-id-type="pmcid">PMC3786574</pub-id><pub-id pub-id-type="pmid">23470321</pub-id><pub-id pub-id-type="doi">10.1038/nri3405</pub-id></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Achar</surname><given-names>SR</given-names></name><etal/></person-group><article-title>Universal antigen encoding of T cell activation from high-dimensional cytokine dynamics</article-title><source>Science</source><year>2022</year><volume>376</volume><fpage>880</fpage><lpage>884</lpage><pub-id pub-id-type="pmid">35587980</pub-id></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cameron</surname><given-names>BJ</given-names></name><etal/></person-group><article-title>Identification of a Titin-Derived HLA-A1-Presented Peptide as a Cross Reactive Target for Engineered MAGE A3–Directed T Cells</article-title><source>Science Translational Medicine</source><year>2013</year><volume>5</volume><elocation-id>197ra103</elocation-id><pub-id pub-id-type="pmcid">PMC6002776</pub-id><pub-id pub-id-type="pmid">23926201</pub-id><pub-id pub-id-type="doi">10.1126/scitranslmed.3006034</pub-id></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leonard</surname><given-names>JD</given-names></name><etal/></person-group><article-title>Identification of Natural Regulatory T Cell Epitopes Reveals Convergence on a Dominant Autoantigen</article-title><source>Immunity</source><year>2017</year><volume>47</volume><fpage>107</fpage><lpage>117</lpage><elocation-id>e8</elocation-id><pub-id pub-id-type="pmcid">PMC5562039</pub-id><pub-id pub-id-type="pmid">28709804</pub-id><pub-id pub-id-type="doi">10.1016/j.immuni.2017.06.015</pub-id></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>MM</given-names></name></person-group><article-title>Not-So-Negative Selection</article-title><source>Immunity</source><year>2015</year><volume>43</volume><fpage>833</fpage><lpage>835</lpage><pub-id pub-id-type="pmid">26588773</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takada</surname><given-names>K</given-names></name><name><surname>Takahama</surname><given-names>Y</given-names></name></person-group><article-title>Positive-selection-inducing self-peptides displayed by cortical thymic epithelial cells</article-title><source>Adv Immunol</source><year>2015</year><volume>125</volume><fpage>87</fpage><lpage>110</lpage><pub-id pub-id-type="pmid">25591465</pub-id></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osorio</surname><given-names>D</given-names></name><name><surname>Rondón-Villarreal</surname><given-names>P</given-names></name><name><surname>Torres</surname><given-names>R</given-names></name></person-group><article-title>Peptides: A Package for Data Mining of Antimicrobial Peptides</article-title><source>The R Journal</source><year>2015</year><volume>7</volume><fpage>4</fpage></element-citation></ref><ref id="R76"><label>76</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pagès</surname><given-names>H</given-names></name><name><surname>Aboyoun</surname><given-names>P</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name><name><surname>DebRoy</surname><given-names>S</given-names></name></person-group><article-title>Biostrings: Efficient manipulation of biological strings</article-title><year>2022</year><pub-id pub-id-type="doi">10.18129/B9.bioc.Biostrings</pub-id></element-citation></ref><ref id="R77"><label>77</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Pleiss</surname><given-names>G</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Weinberger</surname><given-names>KQ</given-names></name></person-group><source>On Calibration of Modern Neural Networks</source><conf-name>Proceedings of the 34th International Conference on Machine Learning</conf-name><publisher-name>PMLR</publisher-name><year>2017</year><fpage>1321</fpage><lpage>1330</lpage></element-citation></ref><ref id="R78"><label>78</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bresciani</surname><given-names>A</given-names></name><etal/></person-group><article-title>T-cell recognition is shaped by epitope sequence conservation in the host proteome and microbiome</article-title><source>Immunology</source><year>2016</year><volume>148</volume><fpage>34</fpage><lpage>39</lpage><pub-id pub-id-type="pmcid">PMC4819143</pub-id><pub-id pub-id-type="pmid">26789414</pub-id><pub-id pub-id-type="doi">10.1111/imm.12585</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><caption><title>Highlights</title></caption><list list-type="bullet" id="L1"><list-item><p>HLA bias and out-of-distribution problem are causes of poor performance of current state-of-the-art algorithms</p></list-item><list-item><p>Transfer learning, deep learning architecture, context-specific and HLA-generalised approaches improve CD8+ T-cell epitope prediction</p></list-item><list-item><p>TRAP reports degree of correctness to improve reliability of the prediction</p></list-item><list-item><p>A novel metric termed RSAT estimates immunogenicity of pathogenic peptides, as a complementary to ‘dissimilarity to self’ from cancer studies</p></list-item></list></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><title>Schematic of TRAP workflow and cross-species variation in T cell recognition features.</title><p>A. Schematic diagram of TRAP (T-cell recognition potential of HLA-I presented peptides), a robust deep learning-based workflow to predict CD8+ T-cell epitopes from MHC-I presented pathogenic or self-peptides. Once peptides have been predicted by NetMHCpan to bind HLA alleles, the TRAP uses the peptide sequence and NetMHCpan rank scores as inputs to predict the immunogenicity of the peptide with the respective HLA binding affinity. The TRAP workflow will output TRAP prediction score along with confidence in its prediction. If the prediction is detected to have a low confidence, we recommend predicting cancer neoepitopes using TESLA<sup><xref ref-type="bibr" rid="R52">52</xref></sup>, which is known to use more general features such as agretopicity and dissimilarity to self-proteome, and pathogenic peptides with RSAT (Relative Similarity to Autoantigens or Tumour-associated antigens). B-C. Distribution of MHC binding rank scores predicted by NetMHCpan (B) and hydrophobicity (C) for peptides derived from different pathogenic species. CMV: Cytomegalovirus; EBV: Epstein-Barr Virus; HCV: Hepatitis C Virus; HBV: Hepatitis B Virus; SARS-2: SARS-CoV-2; VACV: Vaccinia Virus; YFV: Yellow Fever Virus. D. Statistics of peptides in cross-species dataset (i.e. non-vaccinia virus (non-VACV) peptides for training and VACV peptides for testing, non-SARS-CoV-2 (non-SARS2) peptides for training and SARS-2 peptides for testing), and data randomly divided into 90% train and 10% test, as a resemblance of 10-fold cross-validation. E-F. Models trained using cross-species datasets could not effectively predict the immunogenicity of peptides derived from unseen pathogens. ROC-AUC curves of XGBOOST classifiers on training data by 10-fold cross-validations - on 90% data, non-SARS-2 and non-VACV peptides (E). ROC-AUC curves of XGBOOST classifiers on test datasets - 10% data, SARS2 and VACV peptides (F). G. Sequence logo of amino acids enriched in epitopes (Positive) compared to non-epitopes (Negative) in contact positions for randomly split data (i), SARS-2 data (ii) and vaccinia virus data (iii). H-I. High performance may be a reflection of HLA bias. ROC curve of DeepImmuno algorithm on single HLA allele, for peptides bound on HLA-A*02:01 (H) or HLA-A*24:02 (I). J. Performance of DeepImmuno algorithm on per-HLA down-sampled dataset i.e. the number of peptides has been down</p></caption><graphic xlink:href="EMS159135-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Effect of anchor and contact positions on peptide immunogenicity.</title><p>A. t-SNE embedding of peptides, coloured by HLA supertypes. Peptides at anchor positions (i.e. P2 and P9 of 9aa peptides) were represented by amino acid descriptors (aaDescriptors) and all amino acids across the peptide sequence were averaged to compute peptide-wide aaDescriptors. Each peptide was represented by positional (only at anchor positions) and peptide-wide aaDescriptors. B-C. t-SNE embedding of peptide-wide descriptors and amino acids at contact positions, coloured by cognate TCRs for 9aa peptides (B) and 10aa peptides (C). D. Sequence logos of peptides recognised by the same TCR, coloured by the physicochemical properties. Notably, these are examples of TCRs having the most cognate peptides in the database. However, except for the first TCR, the low number of peptides may limit statistical confidence in representing sequence conservation. E. t-SNE embeddings of peptide-wide descriptors and amino acids at all positions, coloured by HLA supertype (left), immunogenicity (middle) and species of origin (right). F. Distribution of intra-HLA and inter-HLA variation for peptides having different peptide-HLA entries. The variation described by ANOVA means squared.</p></caption><graphic xlink:href="EMS159135-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Optimise TRAP architecture.</title><p>A. Performance of pre- and post-padding strategies. ROC-AUC values of respective deep learning models with pre- vs. post-padding strategies for pathogenic (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. B. Example of n-grams found in both 9aa and 10aa peptides, coloured by the start position of the respective n-gram in the peptides. C. Comparing amino acid embedding strategies. ROC-AUC values of a single dense classification prediction using different encoding strategies, including one-hot encoding (OHE), amino acid descriptors (aaDescriptors) and embeddings from protein transformer-based PLMs on pathogenic peptides (i) and self-antigens (ii). Each point represents the ROC-AUC value from one round of 10-fold cross-validations. D. Comparing the performance of different deep learning architectures. ROC-AUC values comparing the performance of different machine learning and deep learning architectures using embeddings from 5 protein transformer-based PLMs for pathogenic (i) and self-peptides (ii). XGBOOST: an extreme gradient boosting. BiRNN: bidirectional recurrent neural network. BiLSTM: bidirectional Long short-term memory. 1DCNN: 1-dimensional convolutional neural network. 2-DCNN: 2dimensional CNN. Each point represents ROC-AUC value from one round of 10-fold cross-validations. E. Schematic diagram of the model incorporating MHC binding and hydrophobicity. F. Adding hallmarks of the immunogenicity. ROC curve comparing the performance of models after adding MHC binding rank score and/or hydrophobicity to peptide sequence-based 1D CNN model for pathogenic (i) and self-peptides (ii).</p></caption><graphic xlink:href="EMS159135-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Out-of-distribution detection using calibration methods.</title><p>A. Identifying motifs that are enriched in both pathogenic and self-epitopes. Venn diagram comparing the enriched n-grams (left) or position-specific k-mer motifs from 9aa (middle) or 10aa peptides (right) between pathogenic and self-peptides. B. Normalized enrichment ratio of shared n-grams enriched in both pathogenic and self-epitopes. C. Clusters of peptides with high sequence similarity in contact positions, demonstrated by pairwise global alignment scores. Network graph illustrating the pairwise global alignment score between 9aa pathogenic peptides. Shown are peptides having ≥22 alignment scores with ≥3 other peptides. D-G. Distribution of different calibration-based metrics on pathogenic (i) and self-(ii) peptides, discriminating correctly vs. incorrectly predicted peptides. The calibration-based metrics include maximum softmax probability (MaxProb) (D), temperature scaling using different levels of temperatures that scale the logit values (E), the average maximum softmax probability (average MaxProb) of 10 ensembled models (F) and the average MaxProb of models containing Monte Carlo dropouts (G). The Monte Carlo models were reiterated 100 times with stochastic dropouts of 0.6. T: temperature. Statistical significance by p-values from Student’s t-test. ns: non-significant. H. Feature importance of different calibration metrics on decision tree classifier that aims to discriminate correctly predicted peptides. Ensemble: average MaxProb of 10 ensembled models. I. ROC curve illustrating the performance of the out-of-distribution (OOD) decision tree classifiers using MaxProb and average MaxProb from ensembled models on pathogenic (i) and self-peptides (ii).</p></caption><graphic xlink:href="EMS159135-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Relative similarity to autoantigens and tumour-associated antigens (RSAT).</title><p>A. Schematic of positive and negative selection of T-cells in thymus. B. Number of self-peptides, such as cancer neoepitopes, autoantigens and tumour-associated antigens, retrieved from different databases. C. Distribution of Match score between pathogenic peptides and best self-peptide counterparts. Contains the Cohen’s d value showing the effect sizes differentiating positives versus negatives as well as the number of positive and negative peptides in each species. Cohen’s d values describe effective sizes, which are small (d = 0.2), medium (d = 0.5) and large (0.8). D. RSAT of pathogenic peptides that have comparable self-antigen counterparts (by match score ≥ 0.6). E-F. RSAT can effectively discriminate pathogenic epitopes from non-epitopes of varying lengths and species. E. Distribution of RSAT for pathogenic peptides having 9aa (left) and 10aa (right) in length. F. RSAT of peptides derived from different pathogens.</p></caption><graphic xlink:href="EMS159135-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Benchmark TRAP performance and use it to identify tumour antigens in glioblastoma.</title><p>A-B. ROC curve comparing the performance of TRAP with existing models, such as IEDB, iPred, NetTepi, PRIME, Repitope and DeepImmuno for self- (A) and pathogenic peptides (B). Due to the nature of these models, IEDB, iPred, NetTepi PRIME and Repitope were predicted in an HLA-agnostic manner (i.e. by peptide sequence only) (i), and DeepImmuno predicted in an HLA-restrictive manner (i.e. by peptide-HLA) using HLA-balanced data (ii). C. ROC curve comparing the performance of TRAP and Repitope that have been trained using 1511 Non-Wuhan SARS-CoV-2 peptides by 10-fold cross-validations. D. ROC-curve comparing the performance of Non-Wuhan SARS-CoV-2 trained TRAP and Repitope models in predicting 66 Wuhan SARS-CoV-2 peptides. E-J Application of TRAP in identifying glioblastoma neoepitopes. E. Confusion matrix of GBM cancer neoepitope prediction using self-antigen TRAP model in reference to T cell assay readout. F. ROC curve of TRAP performance on GBM dataset. G. MaxProb (i) and average MaxProb of 10 ensembled models (ii) for GBM peptides predicted to be non-immunogenic. H. The proportion of GBM epitopes (Positive) and non-epitopes (Negatives) predicted Positive or Negative with high or low confidence. The confidence has been predicted by the self-antigen out-of-distribution decision tree classifier. I. ROC curve of TRAP performance taking confidence into account, in which peptides that were predicted Negative with low confidence were removed to be considered as the potential epitope candidates. J. Confusion matrix of TRAP prediction after taking the confidence into account, in which peptides that were predicted Negative with low confidence were included as Positive.</p></caption><graphic xlink:href="EMS159135-f006"/></fig></floats-group></article>