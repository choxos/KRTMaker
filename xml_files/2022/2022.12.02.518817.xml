<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158084</article-id><article-id pub-id-type="doi">10.1101/2022.12.02.518817</article-id><article-id pub-id-type="archive">PPR579600</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>BBmix: a Bayesian Beta-Binomial mixture model for accurate genotyping from RNA-sequencing</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6230-3849</contrib-id><name><surname>Vigorito</surname><given-names>Elena</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Barton</surname><given-names>Anne</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Pitzalis</surname><given-names>Costantino</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9365-5345</contrib-id><name><surname>Lewis</surname><given-names>Myles J.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9755-1703</contrib-id><name><surname>Wallace</surname><given-names>Chris</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><aff id="A1"><label>1</label>MRC Biostatistics Unit, University of Cambridge, Cambridge, UK</aff><aff id="A2"><label>2</label>Division of Musculoskeletal &amp; Dermatological Sciences, University of Manchester, UK</aff><aff id="A3"><label>3</label>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London, London, UK</aff><aff id="A4"><label>4</label>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London, London, UK</aff><aff id="A5"><label>5</label>Cambridge Institute of Therapeutic Immunology &amp; Infectious Disease (CITIID), Jeffrey Cheah Biomedical Centre, Cambridge Biomedical Campus, University of Cambridge, Cambridge</aff></contrib-group><author-notes><corresp id="CR1"><label>*</label>Corresponding authors: Elena Vigorito <email>elena.vigorito@mrc-bsu.cam.ac.uk</email>, Chris Wallace <email>cew54@cam.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>05</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Motivation</title><p id="P1">While many pipelines have been developed for calling genotypes using RNA-sequencing data, they all have adapted DNA genotype callers that do not model biases specific to RNA-sequencing such as reference panel bias or allele specific expression.</p></sec><sec id="S2"><title>Results</title><p id="P2">Here, we present BBmix, a Bayesian Beta-Binomial mixture model that first learns the expected distribution of read counts for each genotype, and then deploys those learned parameters to call genotypes probabilistically. We benchmarked our model on a wide variety of datasets and showed that our method generally performed better than competitors, mainly due to an increase of up to 1.4% in the accuracy of heterozygous calls. Moreover, BBmix can be easily incorporated into standard pipelines for calling genotypes. We further show that parameters are generally transferable within datasets, such that a single learning run of less than one hour is sufficient to call genotypes in a large number of samples.</p></sec><sec id="S3"><title>Availability</title><p id="P3">We implemented BBmix as an R package that is available for free under a GPL-2 licence at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/evigorito/bbmix">https://gitlab.com/evigorito/bbmix</ext-link> and accompanying pipeline at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/evigorito/bbmix_pipeline">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>.</p></sec></abstract></article-meta></front><body><sec id="S4" sec-type="intro"><title>Introduction</title><p id="P4">RNA-sequencing (RNA-seq) is an established and popular technique with many applications including transcript quantification and detection of alternative splicing among others. More recently, a growing number of studies have developed and tested pipelines to use RNA-seq for variant and genotype calling (<xref ref-type="bibr" rid="R11">Rogier <italic>et al</italic>., 2018</xref>), (<xref ref-type="bibr" rid="R10">Quinn <italic>et al</italic>., 2013</xref>), (<xref ref-type="bibr" rid="R1">Adetunji <italic>et al</italic>., 2019</xref>), (<xref ref-type="bibr" rid="R3">Brouard <italic>et al</italic>., 2019</xref>) including somatic variant detection and identification of cancer drivers (<xref ref-type="bibr" rid="R2">Akutagawa <italic>et al</italic>., 2022</xref>). Applications include calling variants when DNA genotypes are unavailable (<xref ref-type="bibr" rid="R12">Wang <italic>et al</italic>., 2021</xref>), studying <italic>cis</italic>-regulated genes by analyzing allele specific expression (ASE) or conducting genome-wide association studies (GWAS) in non-model species, since whole genome sequencing is expensive and exome sequencing tools may be unavailable (<xref ref-type="bibr" rid="R6">Jehl <italic>et al</italic>., 2021</xref>), (<xref ref-type="bibr" rid="R11">Rogier <italic>et al</italic>., 2018</xref>). Genotype calling using RNA-seq is often more challenging than DNA-seq: coverage can be highly variable between genes, many reads map across splice junctions making correct alignment more difficult, and cis-acting eQTLs may create unequal expression between chromosomes. Despite this, for many applications, accuracy is paramount: for example in ASE, miscalling a homozygous genotype as heterozygous will create a false signal of allelic imbalance.</p><p id="P5">RNA-seq genotyping pipelines employ RNA-seq based aligners and quality control steps for filtering out potentially erroneous calls, but use the same statistical models as for DNA-sequencing. While adopting these methods provides a convenient way to call variants from RNA-seq, there are sources of variation in RNA-seq data that are not accounted for. In DNA-seq, in an ideal world, out of n reads covering a SNP, we expect 0, n/2 and n to contain the alternative allele for genotypes 0, 1 and 2. Sampling variation and reference mapping bias may mean the observed heterozygote genotype count deviates from n/2 particularly when n is small, and the homozygote observations may deviate minorly from 0 and n due to sequencing or mapping errors. However, when n is large, the genotypes are expected to be clearly distinguishable. In RNA-seq, the heterozygote observation may show much greater variance, because heterozygosity at local regulatory sequences may cause over-amplification of the allele on one chromosome over the allele on the other, and this effect will vary between samples as genotypes at the regulatory sequences vary. This may push the heterozygote observation nearer to 0 or n, making a miscall as a homozygote more likely, particularly when n is small.</p><p id="P6">In this work, we wanted to test whether directly modelling this additional variation in RNA-seq data could improve the quality of the genotype calls. We developed BBmix, a two-step method based on first modelling the genotype-specific read counts using beta binomial distributions and then using these to infer genotype posterior probabilities. ir We benchmarked our method using high confidence calls from the Genome in a Bottle consortium (<ext-link ext-link-type="uri" xlink:href="https://www.nist.gov/programs-projects/genome-bottle">https://www.nist.gov/programs-projects/genome-bottle</ext-link>), the subset of GBR samples from the GEUVADIS (Genetic European Variation in Disease) project (<xref ref-type="bibr" rid="R9">McVean <italic>et al</italic>., 2012</xref>), for which RNA-seq data and high quality genotype calls are publicly available and samples from the Pathobiology of Early Arthritis Cohort (PEAC) cohort (<xref ref-type="bibr" rid="R7">Lewis <italic>et al</italic>., 2019</xref>) for a “real data” case study. This is a cohort of 82 adult treatment-naive rheumatoid arthritis patients for whom RNA-seq from synovial tissue samples and DNA-microarray based genotypes are available. We found that our method generally performed better than competitors and can be easily incorporated into standard pipelines for calling variants.</p></sec><sec id="S5" sec-type="methods"><title>Methods</title><sec id="S6"><title>BBmix statistical model</title><p id="P7">We model the number of reads at the alternative allele at each SNP as a mixture of three beta-binomial distributions underlying the three possible genotypes, conditional on the total number of reads overlapping the SNP. To allow for sequencing or alignment errors as well as reference mapping bias, we allowed both the mean and variance parameters of each distribution to be learned from the data. The parameters of these distributions are shared between SNPs in a Bayesian model allowing the parameters to be learnt from many SNPs jointly. To maximise computational efficiency, we train the model on a random subset of SNPs and use the learnt parameters to call genotype probabilities across all SNPs. Details of the model are presented in <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>.</p></sec><sec id="S7"><title>Datasets</title><p id="P8">We use RNA-seq from lymphoblastic cells lines derived from NA12878 and 13 additional samples (study E-MTAB-1883) with the high confidence genotype calls from the Genome in a Bottle consortium for sample NA12878 used as a gold standard. Note that only non-reference homozygote genotypes are available for this data source. We also selected a subsample of 86 individuals of European ancestry coded as GBR from the GEUVADIS for which genotypes and RNA-seq data are publicly available and genotypes and RNA-seq from the PEAC study. Details for data sources both for genotypes and RNA-seq can be found in <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 2</xref>.</p></sec><sec id="S8"><title>RNA-seq preprocessing</title><p id="P9">We applied the GATK pipeline for RNA-seq short variant discovery (SNPs + Indels, https://gatk.broadinstitute.org/hc/en-us/articles/360035531192-RNAseq-short-variant-discovery-SNPs-Indels-) for read alignment and data cleanup (removal of duplicates and base quality recalibration<bold>)</bold> before calling variants. Details on the implementation are described in <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 3</xref>.</p></sec><sec id="S9"><title>Comparison to alternative methods</title><p id="P10">We validated BBmix against three other popular methods: HaplotypeCaller (<xref ref-type="bibr" rid="R3">Brouard <italic>et al</italic>., 2019</xref>), Mpileup from Bcftools (<xref ref-type="bibr" rid="R8">Li, 2011</xref>) and FreeBayes (<xref ref-type="bibr" rid="R5">Garrison and Marth, 2012</xref>) which have been applied for RNA-seq genotyping (<xref ref-type="bibr" rid="R12">Wang <italic>et al</italic>., 2021</xref>; <xref ref-type="bibr" rid="R11">Rogier <italic>et al</italic>., 2018</xref>; <xref ref-type="bibr" rid="R1">Adetunji <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="R10">Quinn <italic>et al</italic>., 2013</xref>). We also compared BBmix with a naive method based on applying thresholds on the proportion of alternative alleles; we referred to this method as “Count threshold”. The alignment output from the GATK pipeline was used as input for calling genotypes with BBmix, Count threshold, Haplotypecaller and Mpileup/bcftools. For FreeBayes the base quality recalibration step was excluded as it is not recommended (<ext-link ext-link-type="uri" xlink:href="https://github.com/freebayes/freebayes">https://github.com/freebayes/freebayes</ext-link>). Each method was run with default parameters. Details of the implementation are in <xref ref-type="supplementary-material" rid="SD1">Supplementary Note 4</xref>. We compared hard calls for exonic variants in the 1000 Genome project with allele frequency higher than 0.01 and excluded regions of the genome with known mapping bias against the corresponding gold standard (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 4</xref>). For the PEAC gold standard for which probabilistic genotype calls were available, we selected the subset for which genotypes were called with probability 1.</p></sec></sec><sec id="S10" sec-type="results"><title>Results</title><sec id="S11"><title>Determining the number of SNPs for training the Beta-Binomial mixture model</title><p id="P11">We first evaluated the effect of the number of SNPs used to train the Beta-Binomial mixture (BBmix) model on the accuracy of genotype calls. To this end, <bold>three sets</bold> of 500, 1,000, 2,000, 3,000, 4,000, 5,000 or 10,000 SNPs with at least 10 mapping reads (<bold>21 sets</bold> in total) were randomly selected from the Genome in a bottle sample NA12878. We fit the BBmix model independently on each subset (Methods). As expected, increasing the number of SNPs resulted in a narrower posterior distribution of the mean parameter of each component (<xref ref-type="fig" rid="F1">Fig. 1a</xref>), while the posterior mean for heterozygous calls departed from 0.5, suggestive of over-representation of the reference allele consistent with reference mapping bias (<xref ref-type="fig" rid="F1">Fig. 1a</xref> <bold>medium panel)</bold>. Increasing the number of training SNPs also resulted in overall small gains in concordance between genotype dosages estimated by BBmix and the high confidence calls available from the Genome in a bottle consortium until a plateau was reached at about 4,000 SNPs (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). For subsequent analysis we trained our model with 1000 SNPs, which we considered a good trade-off between concordance and computational time (mean time=46 minutes, <xref ref-type="fig" rid="F1">Fig. 1c</xref>).</p><p id="P12">Some analyses require hard calls instead of genotype dosages. To define hard calls we assigned the most likely genotype when its probability is above a predefined threshold. We tested thresholds of 0.90, 0.95 and 0.99 for sample N12878 and chose to favour accuracy over number of calls. We selected 0.99 as at depth 10 the concordance was 99.82% (0.1% increase relative to 0.9) while the loss in the number of calls was 0.15% (9303 total calls, <xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 2</xref>). In subsequent analyses, when applying the BBmix model on hard calls we selected 0.99 as the probability threshold.</p></sec><sec id="S12"><title>Benchmarking the BBmix model</title><p id="P13">We validated the BBmix model against three other popular methods: HaplotypeCaller (<xref ref-type="bibr" rid="R3">Brouard <italic>et al</italic>., 2019</xref>), Mpileup from Bcftools (<xref ref-type="bibr" rid="R8">Li, 2011</xref>) and FreeBayes (<xref ref-type="bibr" rid="R5">Garrison and Marth, 2012</xref>) which have been applied for RNA-seq genotyping (<xref ref-type="bibr" rid="R12">Wang <italic>et al</italic>., 2021</xref>; <xref ref-type="bibr" rid="R11">Rogier <italic>et al</italic>., 2018</xref>; <xref ref-type="bibr" rid="R1">Adetunji <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="R10">Quinn <italic>et al</italic>., 2013</xref>). We also compared BBmix with a naive method based on applying thresholds on the proportion of alternative alleles; we referred to this method as “Count threshold”. We applied these methods to three datasets: the highly curated genome in a bottle sample, a subset of the GEUVADIS samples with high quality genotypes and samples from the PEAC study which were genotyped by DNA-microarrays.</p><p id="P14">We first assessed the accuracy of the calls stratified by genotype across the different datasets. For this analysis we hard called genotypes for SNPs with at least 10 supporting reads, which we considered as a good trade-off between coverage and accuracy (<xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 2-4</xref>). Homozygous reference calls tend to be the most accurate (&gt; 99.6%) with the lowest variance across methods (<xref ref-type="fig" rid="F2">Fig. 2</xref>), while heterozygous calls are generally more prone to error (accuracy &lt; 99.0% in GEUVADIS and PEAC) and showed the highest variability across methods (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Overall, BBmix was generally superior to competitor methods, with the main gains in the accuracy of heterozygous calls (<xref ref-type="fig" rid="F2">Fig. 2</xref>).</p><p id="P15">Next, we assessed the prevalence of homozygous calls in the gold standard called heterozygous by methods (hom to het errors) and vice versa (het to hom errors). Overall we observed a better performance of BBmix in both types of errors with the exception of GEUVADIS on hom to het errors with HaplotypeCaller performing better (<xref ref-type="fig" rid="F3">Fig. 3</xref>). FreeBayes was consistently worst for hom to het errors while HaplotypeCaller had the worst het to hom error rate for both NA12878 and PEAC (<xref ref-type="fig" rid="F3">Fig. 3</xref>). Last, we compared methods performance across a wide range of read depth threshold on aggregated genotype calls. The accuracy of BBmix genotype calls was generally superior to competitor methods though the effect appeared modest especially for GEUVADIS and PEAC (<xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 2-4</xref>). This is because roughly 60% of the calls were homozygous reference (<xref ref-type="supplementary-material" rid="SD1">Supp. Tables 1-3</xref>) which showed the most accuracy and least variability across methods, while for NA12878 the gold standard does not contain homozygous reference calls. As expected, increasing the depth threshold decreased the gap in accuracy between BBmix and Count threshold.</p><p id="P16">With regards to the number of calls made by each method HaplotypeCaller had the highest number of calls, about 20-30% higher than BBmix, with the main gain being on homozygous reference calls (<xref ref-type="supplementary-material" rid="SD1">Supp. Tables 1-3, Supp. Figs. 2b-4b</xref>). For the subset of calls that were validated in the gold standard Mpileup had the highest number, between 10-25% higher than BBmix (<xref ref-type="supplementary-material" rid="SD1">Supp. Figs. 2b-4b</xref>). Overall BBmix accuracy was generally superior at the cost of lower number of calls.</p></sec><sec id="S13"><title>Exchangeability of model parameters between samples</title><p id="P17">Thus far we trained the BBmix model repeatedly for each sample under consideration. To save computational time we could train the model with a sample of reads from the pooled samples and use those parameters to call genotypes in each sample. Even better would be to have default parameters from an external sample and completely avoid model training. We assessed those options as follows: for sample NA12878, we trained the model with each of the 13 samples that were RNA-sequenced together with NA12878, with a pool of reads from all of the samples or using a randomly selected GEUVADIS external sample. We then called genotypes in NA12878 using the aforementioned scheme for model training and assessed genotype accuracy against the gold standard. The accuracy on genotypes was very robust to the source of reads for parameter training, ranging from 99.25%-99.60% for heterozygous calls and 99.40%-99.60% for homozygous alternative calls, and very close to the model trained with NA12878 reads, 99.38% for heterozygous and 99.44% for homozygous alternative calls (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). Next, we extended the analysis to the GEUVADIS sub-cohort by training the model with a pool of reads. We then called genotypes for each sample using the model trained either with the pool of reads, the external sample NA12878 or with the same sample used to fit the model. Again, the concordance of calls across all genotypes was very similar regardless of the source of reads used for training (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). Last, the same analysis performed in PEAC produced the same pattern, with very high concordance on genotype calls even when training with external samples (<xref ref-type="fig" rid="F4">Fig. 4c</xref>).</p><p id="P18">Prompted by the high level of genotype concordance regardless of training sample, we compared the distribution of the posterior samples for the model parameters trained with either a pool of the respective study samples with NA12878, a representative sample for GEUVADIS or PEAC. In all examples we observed a mixed pattern with some parameters showing similar distributions but clear departures from the identity line as well (<xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 6</xref>)</p><p id="P19">Overall, genotype calls appeared to be robust with regards to the source of reads used for model training.</p></sec></sec><sec id="S14" sec-type="discussion"><title>Discussion</title><p id="P20">Current pipelines for calling variants from RNA-seq rely on data cleaning and algorithms designed for DNA-seq, ignoring allele specific expression and reference mapping bias. In this study we provide proof of concept that calling variants from RNA-seq can be improved by modelling intrinsic sources of variation in RNA-seq read counts by assessing model performance in relation to DNA based methods for known common exonic SNPs and using DNA genotyping as the gold standard.</p><p id="P21">Our motivation to call variants from RNA-seq was to detect expression quantitative trait loci (eQTLs) using allele specific expression (ASE), which requires genotyping of exonic SNPs (<xref ref-type="bibr" rid="R4">Castel <italic>et al</italic>., 2015</xref>). This is because calling variants from RNA-seq has the potential to increase coverage for variants overlapping expressed genes. Moreover, genotyping errors arising from DNA-based genotyping may introduce bias, for example if homozygous exonic SNPs are mis-typed as heterozygous as the RNA-seq reads will show a strong allelic imbalance. We showed here that our method generally reduced this type of error compared to the other methods and performed particularly well on heterozygous calls, which is likely due to our modelling strategy accounting for noise in RNA-seq reads.</p><p id="P22">Our contribution shows that accounting for bias in RNA-seq can improve genotyping accuracy and we provide a statistical framework for modelling such data: in the case of the most carefully curated gold standard, the Genome in a Bottle sample, we reduced the proportion of erroneous calls over four-fold compared to the next best method. Although BBmix tends to increase accuracy, this occurs at the cost of reduced genotype calls made. Thus the method is designed to prioritise accuracy over volume. Although our method was not designed as a standalone pipeline for discovery, our modelling approach has potential to be integrated within current algorithms such as HaplotypeCaller, Mpileup or FreeBayes to tailor those methods for RNA-seq. Although Bayesian approaches tend to be computationally expensive, we showed that a modest number of training SNPs (1000) tends to be sufficient to learn the model parameters in less than an hour, and that calling variants was very consistent even when using an external sample, which completely eliminates the need for model training. Thus, our work presents a method tailored for calling variants using RNA-seq and also highlights that the current methods for calling variants using DNA could be adapted for RNA-seq by modelling RNA-seq count biases.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary material</label><media xlink:href="EMS158084-supplement-Supplementary_material.pdf" mimetype="application" mime-subtype="pdf" id="d35aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Acknowledgements</title><p>This work was co-funded by the Wellcome Trust (WT220788), the MRC (MC_UU_00002/4) and supported by the NIHR Cambridge Biomedical Research Centre (BRC-1215-20014). M.L., A.B and C.P were supported by the MRC/Arthritis Research UK award: Maximising Therapeutic Utility in RA (MATURA) (Grant MR-K015346). The Pathobiology of Early Arthritis Cohort (PEAC) was supported by funding from the MRC (grant number G0800648).</p></ack><sec id="S16" sec-type="data-availability"><title>Code availability</title><p id="P23">The R package with the code for genotyping using bbmix can be found at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/evigorito/bbmix">https://gitlab.com/evigorito/bbmix</ext-link>. The pipeline for preparing the inputs for running bbmix can be found at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/evigorito/bbmix_pipeline">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>. The pipeline and code used for preparing the manuscript is at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/evigorito/bbmixpaper_pipeline">https://gitlab.com/evigorito/bbmixpaper_pipeline</ext-link>.</p></sec><fn-group><fn id="FN1" fn-type="conflict"><p id="P24"><bold>Conflict of Interest</bold></p><p id="P25">CW holds research funding from GSK and MSD for an unrelated project and is a part-time employee of GSK. These companies had no involvement in or influence on this manuscript.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adetunji</surname><given-names>MO</given-names></name><etal/></person-group><article-title>Variant analysis pipeline for accurate detection of genomic variants from transcriptome sequencing data</article-title><source>PLOS ONE</source><year>2019</year><volume>14</volume><elocation-id>e0216838</elocation-id><pub-id pub-id-type="pmcid">PMC6756534</pub-id><pub-id pub-id-type="pmid">31545812</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0216838</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akutagawa</surname><given-names>J</given-names></name><etal/></person-group><article-title>Identification of cancer drivers from tumor-only RNA-seq with RNA-VACAY</article-title><year>2022</year><elocation-id>2022.05.10.491431</elocation-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brouard</surname><given-names>J-S</given-names></name><etal/></person-group><article-title>The GATK joint genotyping workflow is appropriate for calling variants in RNA-seq experiments</article-title><source>J Anim Sci Biotechnol</source><year>2019</year><volume>10</volume><elocation-id>44</elocation-id><pub-id pub-id-type="pmcid">PMC6587293</pub-id><pub-id pub-id-type="pmid">31249686</pub-id><pub-id pub-id-type="doi">10.1186/s40104-019-0359-0</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castel</surname><given-names>SE</given-names></name><etal/></person-group><article-title>Tools and best practices for data processing in allelic expression analysis</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><elocation-id>195</elocation-id><pub-id pub-id-type="pmcid">PMC4574606</pub-id><pub-id pub-id-type="pmid">26381377</pub-id><pub-id pub-id-type="doi">10.1186/s13059-015-0762-6</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group><article-title>Haplotype-based variant detection from short-read sequencing</article-title><year>2012</year></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jehl</surname><given-names>F</given-names></name><etal/></person-group><article-title>RNA-Seq Data for Reliable SNP Detection and Genotype Calling: Interest for Coding Variant Characterization and Cis-Regulation Analysis by Allele-Specific Expression in Livestock Species</article-title><source>Front Genet</source><year>2021</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC8273700</pub-id><pub-id pub-id-type="pmid">34262593</pub-id><pub-id pub-id-type="doi">10.3389/fgene.2021.655707</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Molecular Portraits of Early Rheumatoid Arthritis Identify Clinical and Treatment Response Phenotypes</article-title><source>Cell Rep</source><year>2019</year><volume>28</volume><fpage>2455</fpage><lpage>2470</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="pmcid">PMC6718830</pub-id><pub-id pub-id-type="pmid">31461658</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2019.07.091</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage><pub-id pub-id-type="pmcid">PMC3198575</pub-id><pub-id pub-id-type="pmid">21903627</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McVean</surname><given-names>GA</given-names></name><etal/></person-group><article-title>An integrated map of genetic variation from 1,092 human genomes</article-title><source>Nature</source><year>2012</year><volume>491</volume><fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="pmcid">PMC3498066</pub-id><pub-id pub-id-type="pmid">23128226</pub-id><pub-id pub-id-type="doi">10.1038/nature11632</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>EM</given-names></name><etal/></person-group><article-title>Development of Strategies for SNP Detection in RNA-Seq Data: Application to Lymphoblastoid Cell Lines and Evaluation Using 1000 Genomes Data</article-title><source>PLOS ONE</source><year>2013</year><volume>8</volume><elocation-id>e58815</elocation-id><pub-id pub-id-type="pmcid">PMC3608647</pub-id><pub-id pub-id-type="pmid">23555596</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0058815</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rogier</surname><given-names>O</given-names></name><etal/></person-group><article-title>Accuracy of RNAseq based SNP discovery and genotyping in Populusnigra</article-title><source>BMC Genomics</source><year>2018</year><volume>19</volume><elocation-id>909</elocation-id><pub-id pub-id-type="pmcid">PMC6291945</pub-id><pub-id pub-id-type="pmid">30541448</pub-id><pub-id pub-id-type="doi">10.1186/s12864-018-5239-z</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>T</given-names></name><etal/></person-group><article-title>A pipeline for RNA-seq based eQTL analysis with automated quality control procedures</article-title><source>BMC Bioinformatics</source><year>2021</year><volume>22</volume><elocation-id>403</elocation-id><pub-id pub-id-type="pmcid">PMC8386049</pub-id><pub-id pub-id-type="pmid">34433407</pub-id><pub-id pub-id-type="doi">10.1186/s12859-021-04307-0</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Training the Beta-Binomial mixture (BBmix) model with different numbers of SNPs.</title><p>A random sample of RNA-seq reads for the indicated number of SNPs with at least 10 supportive reads were used to train the BBmix model. The procedure was repeated 3 times. (a) Mean and 95% credible interval for the posterior distribution for each of the 3 components of the mean parameter (mu[1-3]). (b) Concordance of calls (y-axis) based on the expected genotypes (dosages) called with the parameters learnt from the BBmix model trained with the indicated number of SNPs (x-axis). The black points correspond to each replicate and the red triangle corresponds to the mean. (c) Running time (h) for fitting the BBmix model for the indicated number of SNPs. The average time when training with 500 SNPs was 25 minutes; for 1,000 SNPs was 46 minutes; for 2,000 83 minutes; for 3,000 128 minutes; for 4,000 2.9 hours; for 5,000 SNPs 4 hours and for 10,000 SNPs 10 hours. The dashed line corresponds to the linear regression line.</p></caption><graphic xlink:href="EMS158084-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Concordance of calls by genotype.</title><p>For each method the number of concordant calls relative to the gold standard for those SNPs with at least 10 supporting reads was calculated. The analysis was done for (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples and (c) PEAC samples. Note that for sample NA12878 the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p></caption><graphic xlink:href="EMS158084-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Genotype error type by method.</title><p>For each method it is shown the percentage or erroneous calls for the indicated type (heterozygous in gold standard but homozygous by method (het -&gt; hom) or vice versa). Only SNPs with at least 10 supporting reads were considered. (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples and (c) PEAC samples. Note that for sample NA12878 the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p></caption><graphic xlink:href="EMS158084-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Exchangeability of model parameters.</title><p>(a) The BBmix model was trained with each of the E-MTAB-1883 samples, a pool of those samples or a randomly selected external GEUVADIS sample (indicated in the x-axis). Genotypes were called in sample NA12878 and the concordance against the gold standard stratified by genotype is shown in the y-axis. (b) The BBmix model was trained with each of the GEUVADIS samples, a pool of them or the external sample NA12878. For each sample (x-axis) the plot shows the concordance on genotypes (y-axis) called with the same sample used for training the pool or NA12878. The arrow indicates sample HG00243 to ease comparison with <xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 6</xref>. (c) Same as in (b) except that genotypes for the PEAC samples were additionally called using HG00243 as an external sample. The arrows indicate sample QMUL2009047 to ease comparison with <xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 6</xref>.</p></caption><graphic xlink:href="EMS158084-f004"/></fig></floats-group></article>