<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS156302</article-id><article-id pub-id-type="doi">10.1101/2022.10.25.513659</article-id><article-id pub-id-type="archive">PPR563302</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Classifying directed and diffusive transport in short, noisy single-molecule trajectories with wMSD</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Danné</surname><given-names>Noémie</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Zhiqing</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Peterman</surname><given-names>Erwin J. G.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Physics and Astronomy and LaserLaB Amsterdam, Vrije Universiteit Amsterdam, De Boelelaan 1081, 1081 HV Amsterdam, The Netherlands</aff><author-notes><corresp id="CR1"><label>*</label>Correspondence should be addressed to E.J.G.P. (<email>e.j.g.peterman@vu.nl</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>28</day><month>10</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>26</day><month>10</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Fluorescence imaging in combination with single-particle tracking analysis has emerged as a powerful tool to study and characterize the motion of proteins moving in biological media. One of the main challenges in this approach is to reliably distinguish between directed and diffusive transport, especially for short and often noisy trajectories showing distinct, time- and place-dependent modes of motility. In this contribution, we present a windowed Mean-Square Displacements classifier (wMSDc) that is able to reliably (i) identify periods of diffusive and directed transport, (ii) extract position-dependent diffusion coefficients and velocities, and (iii) identify the location of switches in direction or motility mode in short (&lt; 50 time points) and noisy single-molecule trajectories. We compare the performance of this approach to a Hidden Markov Model (HMM) method and a Moment Scaling Spectrum based method (DC-MSS) previously published and show that, in most cases, its performance is superior. We present a wide range of applications: from the movement of whole organisms and cells to protein-DNA interactions <italic>in vitro</italic> and motor-protein dynamics <italic>in vivo</italic>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Proteins and other biomolecules can be visualized and localized in biological media with sub-diffraction localization precision (<italic>PL</italic> ≪ <italic>λ</italic>/2) (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref>) using fluorescent labeling and imaging (<xref ref-type="bibr" rid="R6">6</xref>) in combination with single-particle tracking (<xref ref-type="bibr" rid="R7">7</xref>). Using state-of-the-art fluorescence cameras (EMCCD (<xref ref-type="bibr" rid="R8">8</xref>), sCMOS (<xref ref-type="bibr" rid="R9">9</xref>)) access can be obtained to the dynamics underlying biological processes at video rate. Over the last decade, important focus has been put on developing methods to extract quantitative information from single-particle trajectories (<xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R14">14</xref>). However, the analysis of short (&lt; 50 time points) and noisy trajectories remains challenging. In single-molecule imaging, such trajectories are commonly obtained because of limiting imaging conditions: pixilation, excess or readout noise of the detector, out-of-focus fluorescence background, undesired autofluorescence from the sample, photo-bleaching/blinking of fluorescent proteins (<xref ref-type="bibr" rid="R15">15</xref>) and movement of the biomolecules of interest out of focus. These limitations affect both the localization precision (<xref ref-type="bibr" rid="R16">16</xref>) and the length of the trajectory. The challenge in analyzing such trajectories becomes even larger when molecules switch quickly between periods of directed and diffusive transport. In our previous work on intracellular transport in the chemosensory phasmid cilia of <italic>Caenorhabditis elegans</italic> (<xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R19">19</xref>) we have frequently observed switches between diffusion and directed motion. Switches can be immediate or can involve pauses of variable duration between transport in opposite directions (<xref ref-type="bibr" rid="R20">20</xref>). The complex motion of ciliary components in <italic>C. elegans</italic> cilia reveals a wide heterogeneity not only in terms of motion diversity (directed motion and diffusion / sub-diffusion) but also in terms of location-dependent velocity along the length of the cilium (<xref ref-type="bibr" rid="R21">21</xref>–<xref ref-type="bibr" rid="R23">23</xref>).</p><p id="P3">Several methods have been developed before to distinguish directed and diffusive transport in single-particle trajectories (<xref ref-type="bibr" rid="R12">12</xref>–<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R24">24</xref>–<xref ref-type="bibr" rid="R34">34</xref>). Mean-Square Displacement (MSD) analysis has been the most extensively used to analyze the motion of particles and proteins in crowded environments (<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R24">24</xref>–<xref ref-type="bibr" rid="R26">26</xref>, <xref ref-type="bibr" rid="R32">32</xref>, <xref ref-type="bibr" rid="R34">34</xref>). This method is relatively straightforward to apply and uses the anomalous exponent of the MSD to differentiate between different modes of transport. However, when the MSD is calculated using a temporal window this limits the temporal resolution and can affect the classification of the motion. Another classification approach makes use of probabilistic models like Hidden Markov Models (HMM). Classification is obtained by estimating the most probable mode of transport for each step in the trajectory based on the states of the previous steps (<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R35">35</xref>–<xref ref-type="bibr" rid="R37">37</xref>). However, such probabilistic approaches can result in misclassifications when the of the different modes of transport within a time step are similar and the noise is substantial. Moreover, the number of states that can be considered is limited. In a third approach, Divide-and-Conquer Moment Scaling Spectrum analysis (DC-MSS) the different modes of transport are classified after performing a track segmentation. This method uses a short time window (11 frames) during the initial segmentation allowing to minimize the potential effect of noise. It allows classification of a wide diversity of motion: immobile, confined, free diffusive and directed motion. However, the classification performance is limited by the number of time points in each segment because the MSS exponent values overlap (<xref ref-type="bibr" rid="R13">13</xref>). Recently, efforts have been made to develop deep-learning algorithms and combining them with already existing methodologies. The anomalous exponent of the MSD is used either as an input to feed a back-propagation neuronal network (<xref ref-type="bibr" rid="R38">38</xref>), or as an output of a Random Forest machine learning algorithm (<xref ref-type="bibr" rid="R39">39</xref>). These methodologies are promising but still have some limitations. For example, when the anomalous exponent is used as an input, the temporal window used can affect the classification.</p><p id="P4">In the current contribution, we propose a windowed Mean-Square Displacement classifier (wMSDc) approach to analyze this kind of trajectories – short, noisy and with velocities and diffusion coefficients that can be location dependent. The MSD is calculated for each point in the trajectory using a time-window previously determined with the trajectory’s characteristics: time between two consecutive points (Δ<italic>t</italic>), localization precision (<italic>PL</italic>) and estimated averaged velocity (〈<italic>v</italic>〉). The classification between periods of directed and diffusive transport is based on the anomalous exponent value (<italic>α</italic>) of the time lag (<italic>τ</italic>) (<italic>MSD</italic> = 2<italic>Γ</italic>. <italic>τ</italic><sup><italic>α</italic></sup>, with <italic>Γ</italic>, the generalized transport coefficient). <italic>α</italic> values are determined analytically for each time points. In order to perform the classification, we use an <italic>α</italic>-threshold value (<italic>α</italic><sub><italic>ht</italic></sub>) determined automatically for each individual trajectory. This paper addresses the following questions: (i) how can <italic>α</italic> be determined analytically?; (ii) what is the optimal time window?; (iii) what is the optimal <italic>α</italic>-threshold value to classify directed and diffusive transport?; and (iv) how can location-dependent velocities and diffusion coefficient be determined? We also compare the efficiency of the classification between wMSDc and two other methods: a HMM based method (<xref ref-type="bibr" rid="R12">12</xref>) and a Moment Scaling Spectrum based (DC-MSS) method (<xref ref-type="bibr" rid="R13">13</xref>), and discuss the limitations of each approach. Finally, we show several applications of our approach.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Windowed Mean-Square Displacement classifier (wMSDc) and <bold><italic>α</italic></bold> values: effect of localization precision, integration time, velocity and diffusion coefficient</title><p id="P5">Based on the anomalous diffusion model, the MSD of a one-dimensional trajectory can be expressed as the product of a constant, called the generalized transport coefficient <italic>Γ</italic>, and a power, <italic>α</italic>, of the time lag <italic>n</italic>Δ<italic>t</italic>: <disp-formula id="FD1"><label>(Eq.1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-mathit" mathvariant="italic">Γ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P6">In (<xref ref-type="disp-formula" rid="FD1">Eq.1</xref>), Δ<italic>t</italic> is the time between two frames and <italic>n</italic> is the number of frames. In case that a molecule undergoes pure directed transport, <italic>α</italic> = 2, and the average velocity <italic>v</italic> can be determined using <italic>v</italic> = (2 <italic>Γ</italic>)<sup>1/2</sup> (units in [<italic>m</italic>. <italic>s</italic><sup>−1</sup>]). In the case that a molecule diffuses freely, <italic>α</italic> = 1. The diffusion coefficient <italic>D</italic> of the molecule then equals <italic>Γ</italic> (units in [<italic>m</italic><sup>2</sup>. <italic>s</italic><sup>−1</sup>]). The case 1 &lt; <italic>α</italic> &lt; 2 corresponds to a mixture of directed and diffusive transport occurring within the time-window. For 0 &lt; <italic>α</italic> &lt; 1, MSD scales sub-linearly with the time lag and the displacements of the molecule are limited by local crowding or compartment boundaries (<xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R33">33</xref>). Sub-diffusion can also occur when the molecule (intermittently) links to a fixed structure. The case <italic>α</italic> &lt; 0, can occur when a molecule comes back to the initial position using the same path within the time window. As previously reported in the literature, <italic>α</italic> values can be used to distinguish between directed and diffusive transport within trajectories (<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R32">32</xref>). Commonly, <italic>α</italic> is extracted by fitting the MSD curve using a two-parameter fit (<italic>Γ</italic> and <italic>α</italic>). To limit the uncertainties due to the number of free parameters, we choose to calculate <italic>α</italic> analytically using the following equation (<xref ref-type="bibr" rid="R40">40</xref>): <disp-formula id="FD2"><label>(Eq.2)</label><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>α</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mi>∑</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P7">We assume here that the parameter <italic>Γ</italic> is constant and equal to an average transport coefficient determined on the time scale of the sliding window. To increase the accuracy, we average <italic>α</italic> over the first (<italic>W</italic> − 1)/2 time points of the window where <italic>W</italic> is the width of the sliding window. Each <italic>α</italic><sub><italic>i</italic></sub> value calculated within each window <italic>W</italic><sub><italic>i</italic></sub> (a sliding window centred around the <italic>i</italic><sup>th</sup> data point in the trajectory) is addressed for all the time points included in <italic>W</italic><sub><italic>i</italic></sub> as explained in <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref>. In this way, each point has one or more <italic>α</italic><sub><italic>i</italic></sub> values. The final <italic>α</italic> value for each point corresponds to the average of all the <italic>α</italic><sub><italic>i</italic></sub> values (〈<italic>α</italic>〉). <xref ref-type="fig" rid="F1">Figure 1A and 1B</xref> show examples of this wMSDc analysis of simulated trajectories for either directed or diffusive transport, respectively. The averaged <italic>α</italic> values obtained were equal to 1.75 and 0.81 for directed and diffusive transport respectively. These values are smaller than the theoretical values (2 and 1) because the localization precision adds random noise to the position of the molecules (see below).</p><p id="P8">In order to understand to what extend this discrepancy with the theoretical <italic>α</italic> values is due to localization precision (<italic>PL</italic>), integration time (Δ<italic>t</italic>), velocity (<italic>v</italic>), diffusion coefficient (<italic>D</italic>), and window width (<italic>W</italic>) used, we generated trajectories using different velocities (<italic>v</italic>: 0.3 – 1 μm. s<sup>−1</sup>), diffusion coefficients (<italic>D</italic>: 0.01 – 1.8 μm<sup>2</sup>. s<sup>−1</sup>), integration times (Δ<italic>t</italic>: 30, 60, 100 ms) and localization precision (<italic>PL</italic>: 0, 30, 60, 90 nm), reflecting typical values we have obtained in single-molecule trajectories of ciliary components in the chemosensory cilia of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R22">22</xref>). For each data set, we simulated 20 XY-trajectories of 200 steps (see parameters in <xref ref-type="supplementary-material" rid="SD1">Supplemental Table 1</xref>). In the X-direction, <italic>in-silico</italic> molecules undergo unidirectional directed transport and, in the Y-direction, the molecules diffuse freely. The X and Y-directions are analyzed separately using <xref ref-type="disp-formula" rid="FD1">Eq.1</xref> and <xref ref-type="disp-formula" rid="FD2">2</xref>. As reported before (<xref ref-type="bibr" rid="R12">12</xref>), alpha values change as a function of the window width. For this reason, the window width used to calculate alpha varies between 15 frames and 65 frames. The minimal window width is set to 15 frames to limit the fluctuations of <italic>α</italic> between consecutives time points (see <xref ref-type="supplementary-material" rid="SD1">Figure S2</xref>). <xref ref-type="fig" rid="F1">Figure 1C</xref> shows that <italic>α</italic> values of directed transport (<italic>α</italic><sub><italic>t</italic></sub>) decrease when the ratio <italic>PL</italic>/(<italic>v</italic> · Δ<italic>t</italic>) increases. The decrease of <italic>α</italic><sub><italic>t</italic></sub> is less pronounced when <italic>W</italic> (expressed in number of frames in <xref ref-type="fig" rid="F1">Figure 1</xref>) increases. <xref ref-type="fig" rid="F1">Figure 1D</xref> shows that <italic>α</italic> values of diffusing molecules (<italic>α</italic><sub><italic>d</italic></sub>) decrease with increasing ratio <italic>PL</italic>/(2<italic>D</italic> · Δ<italic>t</italic>)<sup>1/2</sup>. (Note that <italic>v</italic> ∙ Δ<italic>t</italic> and (2<italic>D</italic>. Δ<italic>t</italic>)<sup>1/2</sup> are equal to the average displacement of a molecule between two consecutive time points for directed and diffusive transport, respectively). For diffusion, the window width does not show a significant effect on <italic>α</italic><sub><italic>d</italic></sub> values. This could be explained by the fact that the average displacement &lt; X &gt;<sub><italic>W</italic></sub> = 0 during free diffusion (Brownian motion), independently of <italic>W</italic>. In the range of <italic>PL</italic>/(2<italic>D</italic> · Δ<italic>t</italic>)<sup>1/2</sup> values tested, <italic>α</italic><sub><italic>d</italic></sub> is always below 1. Taken together, <italic>α</italic><sub><italic>t</italic></sub> values for directed transport depend strongly on the ratio <italic>PL</italic>/(<italic>v</italic> · Δ<italic>t</italic>) and the window width <italic>W</italic> used to calculate them, while <italic>α</italic><sub><italic>d</italic></sub> values calculated for diffusive trajectories are always below 1, showing a small dependency on the ratio <italic>PL</italic>/(<italic>v</italic> · Δ<italic>t</italic>) and the window width <italic>W</italic>. These simulations have shown clear directions to make a proper choice of <italic>W</italic> based on the values of <italic>α</italic><sub><italic>t</italic></sub> and the characteristics of the individual trajectories.</p></sec><sec id="S4"><title>Classification between diffusive and directed transport</title><p id="P9">To classify directed and diffusive transport in single trajectories using wMSDc, we need to set an appropriate window width (<italic>W</italic>) as well as an appropriate <italic>α</italic>-threshold value (<italic>α</italic><sub><italic>Th</italic></sub>). Since the calculation of <italic>α</italic> values depends on <italic>W</italic>, the <italic>optimal</italic> couple (<italic>W</italic>, <italic>α</italic><sub><italic>Th</italic></sub>) needs to be set to perform the classification.</p><sec id="S5"><title>Window width and <italic>α</italic> threshold values (<italic>W</italic>, <italic>α</italic><sub><italic>Th</italic></sub>) for classification</title><p id="P10">In this section, we describe the three steps used to determine the appropriate minimal window width and threshold (<italic>W</italic>, <italic>α</italic><sub><italic>Th</italic></sub>). The first step is to determine the appropriate window width (<italic>W</italic>). <italic>W</italic> should be as small as possible, in order to detect and classify ‘stretches’ with the highest possible time resolution. Here, we define a stretch as a continuous part of a trajectory in which the mode of motility (directed motion or diffusion) is constant. For efficient and reliable classification, the difference (<italic>α</italic><sub><italic>t</italic></sub>(<italic>v</italic>, <italic>PL</italic>, Δ<italic>t</italic>) − <italic>α</italic><sub><italic>d</italic></sub>(<italic>D</italic>, <italic>PL</italic>, Δ<italic>t</italic>)) between <italic>α</italic><sub><italic>t</italic></sub> for directed motion and <italic>α</italic><sub><italic>d</italic></sub> for diffusion needs to be maximized. This is because, in the final step, an <italic>α</italic>-threshold, <italic>α</italic><sub><italic>th</italic></sub>, with a value between <italic>α</italic><sub><italic>t</italic></sub>(<italic>v</italic>, <italic>PL</italic>, Δ<italic>t</italic>) and <italic>α</italic><sub><italic>d</italic></sub>(<italic>D</italic>, <italic>PL</italic>, Δ<italic>t</italic>) will be used for classification. A larger difference between <italic>α</italic><sub><italic>t</italic></sub>(<italic>v</italic>, <italic>PL</italic>, Δ<italic>t</italic>) and <italic>α</italic><sub><italic>d</italic></sub>(<italic>D</italic>, <italic>PL</italic>, Δ<italic>t</italic>), will result in a classification that is more reliable and less sensitive to noise. In <xref ref-type="fig" rid="F2">Figure 2</xref> we depict and describe the different substeps to obtain the appropriate minimal window width for different cases. The first substep is to determine the average and the minimal velocities in the set of trajectories (〈<italic>v</italic>〉 and <italic>v</italic><sub><italic>min</italic></sub>) and to calculate the ratios <italic>PL</italic>/(〈<italic>v</italic>〉 · Δ<italic>t</italic>) and <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> · Δ<italic>t</italic>). The ratios are represented by two vertical red dashed lines in <xref ref-type="fig" rid="F2">Figure 2</xref>. For each trajectory, the time lag Δ<italic>t</italic> is constant and is defined by the experiment. The localization precision <italic>PL</italic> can be estimated from the global MSD (i.e. MSD calculated for the entire trajectory) by extracting the intersection at the origin (time lag, <italic>τ</italic> → 0 <italic>s</italic>). Here we assume that the <italic>PL</italic> is independent of time and location. We have shown in <xref ref-type="fig" rid="F1">Figures 1C and D</xref> that the dependency of <italic>α</italic> on the average displacement within the chosen time window <italic>W</italic> compared to the <italic>PL</italic> is stronger for directed motion than for diffusive motion. Taking this into account, the window width <italic>W</italic> needs to be chosen such that for directed motion at the lowest velocity within a set of trajectories, <italic>v</italic><sub><italic>min</italic></sub>, <italic>α</italic><sub><italic>t</italic></sub>(<italic>v</italic><sub><italic>min</italic></sub>, <italic>PL</italic>, Δ<italic>t</italic>) is larger than 1. This first criterion (Criterion 1,① in <xref ref-type="fig" rid="F2">Figure 2</xref>), is necessary but not sufficient for an efficient and reliable classification because the difference <italic>α</italic><sub><italic>t</italic></sub>(<italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> · Δ<italic>t</italic>)) − <italic>α</italic><sub><italic>d</italic></sub>(<italic>D</italic>, <italic>PL</italic>, Δ<italic>t</italic>), for <italic>D</italic> = <italic>D</italic><sub>max</sub> is too small (&lt; 0.2) and this can affect the classification accuracy. This effect can be particularly important in the case shown in <xref ref-type="fig" rid="F2">Figure 2C</xref> for which the velocity is constant. In order to maximize the difference <italic>α</italic><sub><italic>t</italic></sub> − <italic>α</italic><sub><italic>d</italic></sub> ∀ <italic>D</italic> and <italic>v</italic> (∀ meaning for all values), we set a another criterium on the averaged <italic>α</italic><sub><italic>t</italic></sub> value obtained for the averaged velocity 〈<italic>v</italic>〉 estimated within the set of trajectories, <italic>α</italic>(<italic>PL</italic>/(〈<italic>v</italic>〉 · Δ<italic>t</italic>)). For this second substep, we use the maximal <italic>α</italic> value that we can obtain when the velocity is minimal, <italic>α</italic><sub><italic>W</italic>=65</sub>, to set the lowest <italic>α</italic> value (<italic>α</italic><sub><italic>W</italic></sub>) we want to obtain for the averaged velocity 〈<italic>v</italic>〉. The objective is to maximize the average value of <italic>α</italic><sub><italic>t</italic></sub>, ∀ <italic>v</italic> obtained for the entire trajectory, and minimize its variations, while using the smallest window width possible. This second criterium can be expressed mathematically be the following expressions: <disp-formula id="FD3"><label>(Criterion 2)</label><mml:math id="M3"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>v</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mo>.</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mtext>with</mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mn>65</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1.7</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mn>65</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P11">In <xref ref-type="fig" rid="F2">Figure 2</xref>, <italic>α</italic><sub><italic>W</italic>=65</sub> is represented by a horizontal blue line. In case the ratio <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) is above 2.9 (see Figure A-C and F), <italic>α</italic><sub><italic>W</italic>=65</sub> is below 1.7 and thus the lowest <italic>α</italic> value of for the ratio <inline-formula><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mi>v</mml:mi><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula> equals <italic>α</italic><sub><italic>W</italic>=65</sub>. In the cases of the <xref ref-type="fig" rid="F2">Figure 2D and E</xref>, the ratio <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) is below 2.9 and <italic>α</italic><sub><italic>W</italic>=65</sub> is above 1.7. This configuration is not optimal because (i) the curves for the alpha values obtained for the different window widths are near to each other and the determination of the appropriate window width will highly depend on the value taken for the averaged velocity and (ii) a value of 1.7 is high enough to maximize the difference <italic>α</italic><sub><italic>t</italic></sub> − <italic>α</italic><sub><italic>d</italic></sub> ∀ <italic>D</italic> and <italic>v</italic>. For this reason, the maximal value of <italic>α</italic><sub><italic>W</italic></sub> is set to 1.7. The annotations ② and ③ in <xref ref-type="fig" rid="F2">Figure 2</xref> show the <italic>α</italic><sub><italic>W</italic></sub> value for the ratios <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>). The third substep is to read from the figure of the simulated data (<xref ref-type="fig" rid="F2">Figure 2</xref>) which window width satisfies the two criteria listed above (red arrows in <xref ref-type="fig" rid="F2">Figure 2</xref>). In the case of <xref ref-type="fig" rid="F2">Figure 2E and F</xref>, the two ratios <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>) are smaller than 0.7 or higher than 6.7. For these cases, the window width is automatically set to 15 or 65 frames respectively. This three-substep strategy has been implemented in our wMSDc approach. In practice, wMSDc determines semi-automatically the window width using the minimal and the averaged velocities (<italic>v</italic><sub><italic>min</italic></sub> and 〈<italic>v</italic>〉) set by the user. The matrix containing the <italic>α</italic>(<italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>)) values for <italic>W</italic> ∈ [15: 1: 65] time points is provided in the <xref ref-type="supplementary-material" rid="SD1">Supplemental Material</xref>.</p><p id="P12">After choosing the appropriate window width <italic>W</italic>, the next step is to determine the <italic>α</italic>-threshold value (<italic>α</italic><sub><italic>Th</italic></sub>), used for classification. To test how to do this, we used simulated data based on our experimental data of motor proteins moving bi-directionally in chemosensory phasmid cilia of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="R20">20</xref>). These motor-protein trajectories have two types of directional switches: (i) direct turnarounds - switches between directed transport in one direction and in the opposite direction, and (ii) diffusive turnarounds, containing three stretches: directed transport in one direction, diffusive transport (pause), and then directed transport in the opposite direction. In this data, the velocities of motors, duration of pausing and diffusion coefficients while pausing are position dependent. Therefore, we generated data sets using different integration times and localization precision, mimicking the experimental trajectories (see <xref ref-type="supplementary-material" rid="SD1">Figure S3</xref> and Methods section for the characteristics of the trajectories). <xref ref-type="fig" rid="F3">Figure 3A,D</xref> show the two types of turnarounds and the <italic>α</italic> values obtained for these two types of trajectories. The colors correspond to <italic>α</italic><sub><italic>X</italic></sub>-values, calculated for the X coordinate using a window width <italic>W</italic> selected by the algorithm (<xref ref-type="fig" rid="F3">Figure 3B,E</xref> - <italic>W</italic> = 15 or 29) as mentioned before. As expected, <italic>α</italic> values during directed transport are above 1, approaching 2 when the localization precision equals 0 (<xref ref-type="fig" rid="F3">Figure 3E</xref>). For a diffusive turnaround (normal case), the threshold, <italic>α</italic><sub><italic>Th</italic></sub>, is determined using the following equation: <disp-formula id="FD4"><label>(Eq.3)</label><mml:math id="M5"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>T</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"/><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"/><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mo>,</mml:mo><mml:mtext>with</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P13"><xref ref-type="fig" rid="F3">Figure 3C</xref> shows that the classification using this equation (wMSDc-row) is in agreement with the Ground Truth (GT-row), and the classification accuracy is 100%.</p><p id="P14">In case of direct turnarounds (<xref ref-type="fig" rid="F3">Figure 3E</xref>), we note that <italic>α</italic><sub><italic>t</italic></sub> values are not constant over time despite the fact that we only have directed transport. Indeed, we observe an average decrease of 15% at the turnaround location. In order to classify direct turnarounds as direct turnarounds, we set the following condition (see <xref ref-type="fig" rid="F3">Figure 3B</xref>): <disp-formula id="FD5"><label>(Condition #1)</label><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mtext>If</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>T</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∗</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mspace width="1em"/><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>T</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>W</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P15"><xref ref-type="fig" rid="F3">Figure 3E</xref> shows that the classification using <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> and Condition #1 (wMSDc-row) within this example trajectory is in agreement with the Ground Truth with an accuracy of 100%. wMSDc detects only directed transport as expected. In order to apply wMSDc to other types of data and not only turnarounds, we also address the specific case where there is no directed transport in the trajectory. An example of a simulated trajectory is shown in <xref ref-type="fig" rid="F3">Figure 3G</xref>. In the first half of the trajectory, the molecule is confined and moves sub-diffusively (<italic>α</italic> &lt; 1, see <xref ref-type="sec" rid="S11">Methods</xref>), and in the second half, the molecule diffuses freely (<italic>α</italic> = 1). Note that even though the molecule diffuses in 2 dimensions (see X-Y trajectory <xref ref-type="fig" rid="F3">Figure 3G</xref>), the <italic>α</italic><sub><italic>X</italic></sub> value (<xref ref-type="fig" rid="F3">Figure 3H</xref>, at the end of the trajectory) can be larger than 1 (<italic>W</italic> = 29 times points). In this case, the threshold determined with <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> (<italic>α</italic><sub><italic>Th</italic></sub> = 0.71) is not valid because a part of the stretch showing free diffusion (in this example at times between 2.7 s and 5.5 s, and above 5.8 s) will be classified as directed motion (see <xref ref-type="fig" rid="F3">Figure 3H</xref>, green line). In order to avoid misclassifying such motion as directed transport, we used the <italic>α</italic> values in the perpendicular direction (<italic>α</italic><sub><italic>Y</italic></sub>). <xref ref-type="supplementary-material" rid="SD1">Figure S4</xref> shows <italic>α</italic><sub><italic>X</italic></sub>, <italic>α</italic><sub><italic>Y</italic></sub> as well as <italic>α</italic><sub>2<italic>D</italic></sub> values (the latter corresponding to <italic>α</italic> values calculated using the Mean-Square Displacement in 2 dimensions) for a simulated trajectory containing the following stretches: sub-diffusion, free diffusion, directed motion in one direction, directed motion in the other direction, free diffusion, and directed motion again (in the ‘one’ direction). During diffusive and sub-diffusive motion, the condition max(<italic>α</italic><sub><italic>X</italic></sub> − <italic>α</italic><sub><italic>Y</italic></sub>) ≤ <italic>α</italic><sub><italic>W</italic></sub> − 0.5 is almost always true while this is not the case for directed transport. When this Condition #2 is not obeyed, we observed that during diffusive and sub-diffusive motion the Condition #3 <italic>α</italic><sub>2<italic>D</italic></sub>((<italic>α</italic><sub><italic>X</italic></sub> − <italic>α</italic><sub><italic>Y</italic></sub>) = max(<italic>α</italic><sub><italic>X</italic></sub> − <italic>α</italic><sub><italic>Y</italic></sub>)) ≤ <italic>α</italic><sub><italic>X</italic></sub>((<italic>α</italic><sub><italic>X</italic></sub> − <italic>α</italic><sub><italic>Y</italic></sub>) = max(<italic>α</italic><sub><italic>X</italic></sub> − <italic>α</italic><sub><italic>Y</italic></sub>)) − 1/6 and the Condition #4 max(<italic>α</italic><sub><italic>Y</italic></sub>) &gt; <italic>α</italic><sub><italic>W</italic></sub> − 0.2 are both always true. Based on this observation, we included the Conditions #2, 3 and 4 using <italic>α</italic><sub><italic>Y</italic></sub> in the algorithm, in order to differentiate, with a higher accuracy, between diffusion and directed motion in trajectories where there is no directed motion. These conditions are based on observations made using the simulated datasets of directed and diffusive transport, and sub-diffusive motion. <xref ref-type="fig" rid="F3">Figure 3I</xref> shows the classification results after the inclusion of Conditions #2, 3 and 4 in the determination of the threshold (dotted red line in <xref ref-type="fig" rid="F3">Figure 3H</xref>). All the time points in the trajectory are classified as diffusive motion, 100% in agreement with the Ground Truth for 90 % of the trajectories (18/20 trajectories). The input parameters are summarized in the <xref ref-type="supplementary-material" rid="SD1">Supplemental Table S2</xref>. Taken together, wMSDc performs very well in classifying motion in simulated trajectories (in total 290 trajectories divided over 10 datasets, see <xref ref-type="supplementary-material" rid="SD1">Supplemental Methods</xref>) such as those shown in <xref ref-type="fig" rid="F3">Figures 3C, F and I</xref>, demonstrating the promising power of wMSDc in distinguishing directed motion and diffusion in short and noisy experimental single-molecule trajectories.</p></sec><sec id="S6"><title>Comparison of the classification performance of wMSDc, HMM and DC-MSS</title><p id="P16">In this section we compare the performance of our wMSDc approach in classifying directed and diffusive transport periods in simulated single-molecule trajectories with two other approaches: a Hidden Markov Model (HMM-Bayes) and a method based on Moment Scaling Spectrum (DC-MSS). For the HMM-Bayes method, we used the standard implementation without pooling provided in the reference Monnier et al. (<xref ref-type="bibr" rid="R12">12</xref>). In this algorithm, the user selects the number of different states present in the trajectory (K = 2 or 3 states). In order to not bias the results by choosing K = 2 or K = 3, we compared the classification using both values of K (named HMM-2 and HMM-3 in the following). HMM analyzes the trajectories using the X and Y directions and is able to distinguish 2 types of states: Diffusion (denoted D) and a mix between diffusion and directed motion (denoted DV). In order to compare HMM and wMSDc, we consider the DV state in HMM equivalent to the directed motion state in wMSDc. For DC-MSS, we used the algorithm published in the reference Vega et al. (<xref ref-type="bibr" rid="R13">13</xref>). DC-MSS also analyzes the trajectories using the X and Y directions and is able to distinguish 4 types of state: immobile, confined, free diffusion and directed motion. In this contribution, we gathered the immobile, confined and free diffusion states together under the class “diffusive transport”.</p><p id="P17">In order to compare the performance of classification by the different algorithms, we calculated the classification accuracy (%), which corresponds to the number of time points for which the classification is correct (i.e. classifying directed/diffusive transport as directed/diffusive transport), i.e. comparing with the Ground Truth (GT) - divided by the total number of points describing directed/diffusive transport in the trajectory. <xref ref-type="fig" rid="F4">Figure 4A,B</xref> show two examples of classifications obtained for a direct and a diffusive turnaround. For the direct turnaround (<xref ref-type="fig" rid="F4">Figure 4A</xref>, Δ<italic>t</italic> = 100 ms and <italic>PL</italic> = 0 nm), the classification accuracy using DC-MSS, HMM and wMSDc equals 100 %. In case of a diffusive turnaround (<xref ref-type="fig" rid="F3">Figure 3G</xref>, Δ<italic>t</italic> = 30 ms and <italic>PL</italic> = 30 nm), DC-MSS, HMM-2 and HMM-3 classified the entire trajectory as diffusive transport and the classification accuracy was only 14% (57/421), which corresponds to the percentage of diffusive transport in this particular trajectory. In contrast, the classification with wMSDc showed three distinct stretches of different transport modality, with a classification accuracy of 100%. Based on these two examples, we note that the classification of the different types of motion using DC-MSS and HMM is not reliable and depends on the trajectory characteristics (<italic>v</italic>, <italic>D</italic>, <italic>PL</italic>, and Δ<italic>t</italic>), while using wMSDc, the classification accuracy reaches 100%. To investigate the effect of the <italic>PL</italic> and Δ<italic>t</italic> values on the classification accuracy, we repeated this analysis for all the simulated trajectories (<italic>PL</italic> between 0 and 60 nm, and Δ<italic>t</italic> between 30 and 100 ms). We calculated the averaged classification accuracies for directed and diffusive transport in <xref ref-type="fig" rid="F4">Figure 4C,D</xref>. For wMSDc, the classification accuracy for directed transport was relatively constant and above 90% while for DC-MSS and HMM, the results depend strongly on the ratio <italic>PL</italic>/Δ<italic>t</italic>. Their classification accuracy decreases with increasing <italic>PL</italic>/Δ<italic>t</italic>. This effect can be explained by the methods themselves. The classification using HMM is based on the X-Y displacement (Δ<italic>X</italic> − Δ<italic>Y</italic>) distribution and specifically on the center of the distribution in the Δ<italic>X</italic> − Δ<italic>Y</italic> space. When Δ<italic>t</italic> is low, the averaged steps value and thus, the center of the distribution is small. Moreover, when the Noise (<italic>PL</italic>) is high, the width of the distribution is large. The combination of these two effects induces a misclassification of directed transport (GT) as diffusive transport. For DC-MSS, the limitation stems from the number of points in each stretch detected. For stretch durations below 50 time points, the percentage of misclassification increases with increasing ratio <italic>PL</italic>/(<italic>v</italic> ∙ Δ<italic>t</italic>) (<xref ref-type="bibr" rid="R13">13</xref>). Directed transport is then misclassified as free diffusion due to an overlap of the moment scaling spectrum values. For diffusive transport (<xref ref-type="fig" rid="F4">Figure 4D</xref>), the classification accuracy depends on the ratio <italic>PL</italic>/Δ<italic>t</italic> for all methods. The classification accuracy for wMSDc is slightly better than for HMM and DC-MSS when the ratio <italic>PL</italic>/Δ<italic>t</italic> is below 0.95, while DC-MSS is slightly better than wMSDc and HMM when the ratio <italic>PL</italic>/Δ<italic>t</italic> is above 1.2 – 1.6. HMM detects diffusive transport with a higher accuracy when the noise is high and when Δ<italic>t</italic> is low as discussed above. The classification accuracy for DC-MSS depends strongly on the number of points detected in each stretch as mentioned above. This effect is important when Δ<italic>t</italic> increases. Indeed, for a fixed pause duration, the number of time points in the stretch is then smaller and the probability of misclassification using DC-MSS increases. For wMSDc, the origin of the misclassification is the width of the window and so in our case is connected to Δ<italic>t</italic>. Indeed, in case of diffusive turnarounds with a pause duration shorter than the window width, <italic>α</italic> values during the pause are higher than 15% of the maximal <italic>α</italic> value. In this case, diffusion is misclassified as directed motion due to the Condition #1 set to determine the <italic>α</italic>-threshold. In conclusion, these results show that wMSDc is more reliable than DC-MSS and HMM to detect directed transport in these short and noisy trajectories. The limitations of DC-MSS and HMM come from the ratio <italic>PL</italic>/(Δ<italic>x</italic>) (with Δ<italic>x</italic> = Δ<italic>X</italic>, Δ<italic>Y</italic>, the displacement between two frames) and the number of points detected in the segment for DC-MSS. For diffusive transport, the limiting factor for wMSDc and DC-MSS is the number of points during the pauses, while for HMM the limiting factor is the ratio <italic>PL</italic>/(Δ<italic>x</italic>).</p></sec><sec id="S7"><title>Classification between anterograde and retrograde directed transport</title><p id="P18">In addition to the classification between directed and diffusive transport, directed transport can be sub-classified based on direction in anterograde and retrograde directed transport. This sub-classification can be important in cases such as the chemosensory cilium of <italic>C. elegans</italic> for which the velocity of transport depends on directionality, since different motor proteins are involved. To distinguish anterograde and retrograde directed transport, we use the sign of the velocity smoothed over several time points (in most case 30, but less (e.g. 15) in case of short stretches, see Applications) to filter the noise coming from the localization precision (sign +: anterograde, sign -: retrograde).</p></sec></sec><sec id="S8"><title>Velocities and diffusion coefficients: effect of the localization precision and integration time</title><p id="P19">After we have found a reliable way to classify anterograde directed transport, retrograde directed transport and diffusive transport using wMSDc, the next step is to determine how velocities and diffusion coefficients can be extracted from the data. In order to detect local variations of these parameters, we first used the method published in the work of Holcman et al. (<xref ref-type="bibr" rid="R32">32</xref>), where velocities and diffusion coefficients were estimated from the displacement between two consecutive time points <italic>x</italic>(<italic>t</italic>) and <italic>x</italic>(<italic>t</italic> + Δ<italic>t</italic>): <disp-formula id="FD6"><label>(Eq.5)</label><mml:math id="M7"><mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P20">We found, however, that this approach can be substantially biased by the localization precision. To quantify this effect, we used the simulated data presented above. We extracted for each set the averaged values of the velocity or diffusion coefficient and the standard deviation of the mean. The parameters of the simulation can be found in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>. For directed transport, the averaged velocity calculated with Holcman’s method (<xref ref-type="disp-formula" rid="FD5">Eq.3</xref>) was in agreement with the velocity values fed into the simulations (<xref ref-type="supplementary-material" rid="SD1">supplementary Table 1</xref>, <xref ref-type="fig" rid="F5">Figure 5A</xref>). The standard deviation of the mean of the velocity (<italic>σ</italic><sub><italic>v</italic></sub>) increases linearly when the ratio <italic>PL</italic>/Δ<italic>t</italic> increases (<xref ref-type="fig" rid="F5">Figure 5C</xref>, grey filled circles) as expected. In order to minimize <italic>std</italic>(<italic>v</italic>), our strategy was to use more time points to calculate the velocity. Indeed, when the number of points increases, the standard deviation of the mean decreases (<xref ref-type="fig" rid="F5">Figure 5C</xref>, red circles and <xref ref-type="supplementary-material" rid="SD1">Figure S5B</xref>). In our method, position-dependent velocities are calculated using a sliding window of 9 time points. Within each time-window, we fit the curve <italic>X</italic>(<italic>n</italic><sub><italic>t</italic></sub>. Δ<italic>t</italic>) = <italic>v</italic>. (<italic>n</italic><sub><italic>t</italic></sub>. Δ<italic>t</italic>) (<italic>n</italic><sub><italic>t</italic></sub> = 1,..9 in the sliding window) and extract the velocity. In this way, <italic>σ</italic><sub><italic>v</italic></sub> is less than 25 % of <italic>v</italic> as shown in <xref ref-type="fig" rid="F5">Figure 5C</xref> (light red line). For diffusive transport (<xref ref-type="fig" rid="F5">Figure 5B</xref>), the averaged diffusion coefficient depends on the number of points used to calculate the diffusion coefficient. The diffusion coefficients calculated using <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> (in grey) differ from the diffusion coefficients fed into the simulations (black dashed line). The standard deviation of the mean of the diffusion coefficient (<italic>σ</italic><sub><italic>D</italic></sub>) depends on the diffusion coefficient (<italic>D</italic><sub><italic>th</italic></sub>), <italic>PL</italic> and Δ<italic>t</italic> as shown in <xref ref-type="fig" rid="F5">Figure 5D</xref>. The ratio <italic>σ</italic><sub><italic>D</italic></sub>/<italic>D</italic><sub><italic>th</italic></sub> scales, by definition, quadratically with the ratio <italic>PL</italic>/(2<italic>D</italic><sub><italic>th</italic></sub>. Δ<italic>t</italic>)<sup>1/2</sup>. The polynomial coefficients obtained are different depending on the approach used to determine the diffusion coefficient. As expected, it can be clearly seen that the ratio <italic>σ</italic><sub><italic>D</italic></sub>/<italic>D</italic><sub><italic>th</italic></sub> is smaller and increases less when the diffusion coefficient is calculated using the Mean-Square Displacement and a Window width of 15 frames. Using the <xref ref-type="disp-formula" rid="FD6">Eq.5</xref>, the ratio <italic>σ</italic><sub><italic>D</italic></sub>/<italic>D</italic><sub><italic>th</italic></sub> strongly depends on the ratio <italic>PL</italic>/(2<italic>D</italic><sub><italic>th</italic></sub>. Δ<italic>t</italic>)<sup>1/2</sup> with standard deviation of the mean, <italic>σ</italic><sub><italic>D</italic></sub>, exceeding 10 times the diffusion coefficient value, <italic>D</italic><sub><italic>th</italic></sub>, in extreme cases. In order to minimize this dependency, we fit the curve (<italic>x</italic>(<italic>t</italic> + <italic>n</italic><sub><italic>d</italic></sub>. Δ<italic>t</italic>) − <italic>x</italic>(<italic>t</italic>))<sup>2</sup> = 2. <italic>D</italic> * (<italic>n</italic><sub><italic>d</italic></sub>. Δ<italic>t</italic>) + <italic>b</italic>, with <italic>n</italic><sub><italic>d</italic></sub> = 1, 2 and 3 and extract the diffusion coefficient, <italic>D</italic>. Using this method, the ratio <italic>σ</italic><sub><italic>D</italic></sub>/<italic>D</italic><sub><italic>th</italic></sub> is reduced with a factor of almost 2 when the level of noise is 1.6 times higher than the average displacement between two consecutive frames (2<italic>D</italic><sub><italic>th</italic></sub>. Δ<italic>t</italic>)<sup>1/2</sup> (see <xref ref-type="fig" rid="F5">Figure 5D</xref>, blue filled circles). To summarize, we choose to use <italic>n</italic><sub><italic>t</italic></sub> = 9 and <italic>n</italic><sub><italic>d</italic></sub> = 3 combined with a linear fit to extract <italic>v</italic> and <italic>D</italic> instead of using the <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> (<italic>n</italic><sub><italic>t</italic></sub> = <italic>n</italic><sub><italic>d</italic></sub> = 2), in order to minimize the standard deviation of the means (<italic>σ</italic><sub><italic>v</italic></sub> and <italic>σ</italic><sub><italic>D</italic></sub>). Using this approach, we calculated the velocities and diffusion coefficients for the two example trajectories in <xref ref-type="fig" rid="F4">Figure 4 A and B</xref>. The results are shown in <xref ref-type="supplementary-material" rid="SD1">Figure S5 C and D</xref>. Overall, the results obtained with HMM-2, and wMSDc in combination with <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> are in agreement with the Ground Truth values of the position-dependent velocities (average anterograde velocity = 0.68 <italic>μm</italic>/<italic>s</italic> and retrograde = - 0.62 <italic>μm</italic>/<italic>s</italic>). However, we note a slight deviation of the velocity (<xref ref-type="supplementary-material" rid="SD1">Figure S5 C,D</xref>, in red) compared to the input value (<xref ref-type="supplementary-material" rid="SD1">Figure S5 C,D</xref>, in dark) at the location of the turnaround. As expected, the sliding window of 9 time points used to extract the velocity results in an underestimation of the absolute velocity at the location of the turnaround. This issue arises from the structure of the algorithm: the velocities and diffusion coefficients are calculated before the complete classification, and in particular the velocities are used to classify between anterograde and retrograde directed transport. To overcome the underestimation of the velocity at the location of the turnaround, one option is to recalculate the velocities and diffusion coefficients after performing the sub-classification between anterograde and retrograde directed transport. In summary, our wMSDc method is more reliable than DC-MSS and HMM-2,3 in distinguishing directed and diffusive transport in simulated data. The classification accuracy depends on the precision of localization and integration time. The velocity and diffusion coefficient values are overall in agreement with the input values independently of the method used, as long as the classification is correct.</p></sec><sec id="S9"><title>Applications</title><p id="P21">After having validated the performance of wMSDc in classifying motility modes in simulated trajectories, in this section, we apply wMSDc to analyze different kinds of experimental trajectories. Details of the analyses, for example the input average velocities and alpha values are listed in the <xref ref-type="supplementary-material" rid="SD1">Supplemental Table S2</xref>. We first analyzed trajectories of single motor proteins imaged in the chemosensory cilia of living <italic>C. elegans</italic> (<xref ref-type="bibr" rid="R20">20</xref>), similar to the simulated trajectories used to validate wMSDc. In <xref ref-type="fig" rid="F6">Figure 6A</xref> two examples are shown for the classification of the motility in these trajectories in diffusive motion and directed transport. In our analysis, the directed transport is subclassified in anterograde and retrograde transport. Many of these motor trajectories contain directional switches, turnarounds and the subclassification in anterograde and retrograde transport allows classifying turnaround events based on the initial and final motility direction (AR, RA, AA, or RR). Furthermore, the location of the turnaround, whether the turnaround contains a pause or not, what the duration of this pause is, and whether the motor is diffusing during the pause can be extracted. We have applied this wMSDc analysis approach to a complete data set as mentioned above (<xref ref-type="bibr" rid="R20">20</xref>).</p><p id="P22">The second dataset we analyzed using wMSDc involves the protein PICH, a DNA translocase involved in anaphase DNA bridge resolution. We analyzed 1-dimensional trajectories of individual PICH proteins moving along double-stranded lambda phage DNA, extended and held using optical tweezers <italic>in vitro</italic> (<xref ref-type="bibr" rid="R41">41</xref>). Similar to the simulated data and the <italic>C. elegans</italic> motor protein data, these trajectories appear to contain turnarounds, the velocities, however, are about two orders of magnitude lower. Since the PICH trajectories are 1-dimensional, we did not apply Condition #2 using <italic>α</italic> values in the perpendicular direction. In <xref ref-type="fig" rid="F6">Figure 6B</xref>, two example trajectories of PICH are shown, using wMSDc. In the left trajectory, several of the fast directional switches (in light blue) are misclassified as diffusion because the window width used in the analysis is larger than the time scale at which these switches occur. This is one of the expected limitations of wMSDc, as discussed above. Apart from this difficulty in correctly classifying frequent directional switches, the overall classification of the PICH trajectories appears sound (<xref ref-type="fig" rid="F6">Figure 6B</xref>), given the low signal-to-noise ratio and the small number of points in the trajectories.</p><p id="P23">The third dataset we analyzed using wMSDc involves cancerous cells (MDA-MB-231) migrating on a surface between two physical 2D-squared traps (<xref ref-type="fig" rid="F6">Figure 6C</xref>, ref (<xref ref-type="bibr" rid="R42">42</xref>)). The authors extracted the trajectories of cell motions by tracking the position of the nucleus as a function of time (shown in blue in <xref ref-type="fig" rid="F6">Figure 6C</xref>, top). To determine the appropriate threshold to analyze these trajectories, we used Eq. 4 to take into account the overall decrease of <italic>α</italic><sub><italic>X</italic></sub> values induced by fast switches occurring soon after the first switch. Moreover, as the switches occur within a period of time shorter than 30 time points, we adjusted the smoothing used to perform the sub-classification between anterograde and retrograde transport (15 time points instead of 30). The classification results obtained with wMSDc are shown in <xref ref-type="fig" rid="F6">Figure 6C</xref>. Classifications appear sound, demonstrating that wMSDc is able to reliably distinguish directed and diffusive transport for other type of trajectories than the ones we simulated.</p><p id="P24">The last dataset we analyzed involves 2D-trajectories of C. <italic>elegans</italic> moving on an agar plate before and after touching a droplet of a Sodium deoxycholate (SDS) solution pipetted on the plate, known to act as a repellent. The 2D trajectory of the worm was obtained by determining and tracking the position of the centroid of a segmented image sequence (<xref ref-type="fig" rid="F6">Figure 6D</xref> trajectory in the right upper corner). After touching the SDS droplet, the worm moves backward (in red) and makes a so-called omega-turn (grey-blue, light-blue, grey-blue; between the 160<sup>th</sup> and 210<sup>th</sup> frames on <xref ref-type="fig" rid="F6">Figure 6D</xref> right bottom corner) during which the worm changes direction (in red). We note that the omega turn appears as a combination of pauses and directed transport, highlighting that the interpretation of the classification requires <italic>a priori</italic> knowledge of the sample or process studied. With these four diverse examples, we have shown that wMSDc is an accessible and reliable method to distinguish directed and diffusive transport not only within the short and noisy trajectories commonly obtained in single-molecule fluorescence microscopy at the sub-cellular scale but also in various other types of trajectories occurring at different time and length scales, from single molecules, to cells and complete organisms.</p></sec></sec><sec id="S10" sec-type="discussion"><title>Discussion</title><p id="P25">Imaging and tracking of single biomolecules, cells and multicellular organisms has become routine over the last decade. Consequently, massive amounts of data (trajectories) have been generated, and now developing algorithms to extract quantitative information from these trajectories has become important. Most of the existing algorithms are developed using idealized, simulated trajectories: long (a large amount of time points), showing only one well-specified mode of motility (sub-diffusion, free diffusion or directed motion) and/or with low levels of noise (<xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R27">27</xref>, <xref ref-type="bibr" rid="R43">43</xref>). In practice, however, such trajectories are rarely observed, in particular for single proteins <italic>in vivo</italic>. Under these conditions, trajectories are often short (seconds) and noisy. Furthermore, the mode of motility can change over time or as a function of location, as is for example the case for our measurements of motor proteins moving in the chemosensory cilia of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R44">44</xref>). To extract quantitative information from such trajectories, we developed a new method based on Mean-Square Displacements (MSD), wMSDc. We also implemented sub-classification to (i) distinguish anterograde and retrograde directed transport, and (ii) classify the type of pausing to eventually compare their durations and amplitude of displacement. Furthermore, we developed tools to extract location-specific velocities and diffusion coefficients. By analyzing simulated data (with quality comparable to our experimental data), we showed that wMSDc is a reliable approach to extract quantitative information from short and noisy trajectories. The existing windowed MSD approaches require many inputs from the user, for example for window width and threshold used to distinguish the different modes of motility. Furthermore, it has been reported that the power of the time lag (<italic>α</italic>) depends on the window width used (<xref ref-type="bibr" rid="R12">12</xref>) and the level of noise (<xref ref-type="bibr" rid="R45">45</xref>). Therefore, in this study, we focused on finding objective rules to select these parameters, such that the decisions that need to be taken by the user are minimal. Using simulated trajectories similar to the ones obtained experimentally for single proteins in <italic>C. elegans</italic>, we compared the classification accuracy of wMSDc with a Hidden Markov Model based algorithm (<xref ref-type="bibr" rid="R12">12</xref>) (HMM) as well as a Moment Scaling Spectrum based method (DC-MSS (<xref ref-type="bibr" rid="R13">13</xref>)). The comparison shows that, in particular for directed motion, the classification accuracy of wMSDc is higher in the short and relatively noisy trajectories typically observed <italic>in vivo</italic>.</p><p id="P26">Further development of wMSDc will be needed to use it to distinguish sub-diffusive and diffusive transport, for example by implementing a locally varying threshold (instead of a constant). wMSDc could also be combined with other state-of the art algorithms to identify the mechanisms underlying sub-diffusive and diffusive transport (e.g. Fractional Brownian motion, Continuous-Time Random Walk (<xref ref-type="bibr" rid="R29">29</xref>), Brownian motion). In the future, wMSDc and DC-MSS could also be combined to optimize the detection of short pauses between two sequences of directed transport, for examples employing DC-MSS to detect the short pauses (in order to limit the effects of windowing in wMSDc), and wMSDc for classification (to avoid misclassifications due to the overlap of the moment-scaling-spectrum values). wMSDc could also be combined with back-propagation neuronal networks (<xref ref-type="bibr" rid="R38">38</xref>) to determine the window width in order to perform classifications with a better accuracy at low velocities.</p><p id="P27">As a final demonstration of the capabilities of wMSDc, we analyzed trajectories from different experimental systems: individual motor proteins moving in the chemosensory cilia of <italic>C. elegans</italic>; the protein PICH moving along and interacting with double-stranded DNA held, <italic>in vitro</italic>, between two optical traps; migrating cancerous cells (MDA-MB-231) moving on a surface between physical traps; and <italic>C. elegans</italic> moving on an agar plate. The results of these analyses show that wMSDc can be used to reliably analyze a wide variety of systems, from single-molecule to whole-organism levels, in short and noisy trajectories as well as in longer and less noisy ones.</p></sec><sec id="S11" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S12"><title>Simulated trajectories parameters used to compare wMSDc, HMM and DC-MSS classification efficiency</title><p id="P28">In order to set an appropriate pair (<italic>W</italic>, <italic>α</italic><sub><italic>Th</italic></sub>), we focused our work on switches between direct and diffusive transports assuming that is the hardest type of trajectory to classify. The “<italic>in-silico</italic>” molecules mimic the motion characteristics of IFT-dynein moving in the chemosensory cilia of C. elegans (<xref ref-type="bibr" rid="R20">20</xref>). In this paper, we have previously quantified the duration of the pauses, the velocities, the diffusion coefficients during the pauses, and the probability of turnarounds all location-dependent. In the current simulation, the cilia is modeled by a 2D rectangle with at length of 7 μm and a width of 200 nm. The initial positions of the “<italic>in-silico</italic>” molecules are distributed randomly between 1 μm and 6 μm. The average duration of the trajectories equals 7 seconds in order to reproduce experimental data. The duration of the pauses varies between 1.6 s and 4.4 s depending on the location. The probability of turnarounds is also location-dependent and the probability to pause at the turnaround location is constant and equals 64%. The diffusion coefficient and velocity are location-dependent. All the parameters are summarized in <xref ref-type="supplementary-material" rid="SD1">Figure S2</xref>. In the Y direction, the diffusion coefficient is arbitrary set at values 3 times lower than the diffusion coefficient values in the X direction. The precision of localization is added for each X-Y positions using a Gaussian distribution centered on the precision of localization value. We simulated 9 datasets using different localization precision (<italic>PL</italic> = 0, 30 or 60 nm) and integration time (Δ<italic>t</italic> = 30, 60 or 100 ms).</p><p id="P29">A supplemental dataset (20 trajectories, <italic>PL</italic> = 30 nm and Δ<italic>t</italic> = 30 ms) combining confined diffusion (first 100 frames) and free diffusion (last 100 frames) has been generated to develop the methodology and distinguish whether the trajectories contained bouts of directed transport. Diffusion coefficient equals 0.05 <italic>μm</italic><sup>2</sup>. <italic>s</italic><sup>−1</sup> for the half of the trajectories and 0.15 <italic>μm</italic><sup>2</sup>. <italic>s</italic><sup>−1</sup> for the other half which is in the range of values obtained for the motor proteins (<xref ref-type="bibr" rid="R20">20</xref>) and transmembrane protein (<xref ref-type="bibr" rid="R46">46</xref>) in the chemosensory cilia of <italic>C. elegans</italic>. The radius of confinement during confined motion is set to 0.1 <italic>μm</italic>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Information</label><media xlink:href="EMS156302-supplement-Supplemental_Information.pdf" mimetype="application" mime-subtype="pdf" id="d36aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgements</title><p>We thank Andreas Biebricher, Chase Broedersz and Christine W. Bruggeman for providing the data used in the applications section (PICH proteins, MDA-MB-231 cells and <italic>C. elegans</italic> omega-turn data). We also thank the members of our “worm team” (Jaap van Krugten, Aniruddha Mitra, Elizaveta Loseva, Wouter Mul and Christine Bruggeman) for discussions, and in particular Jaap van Krugten for providing the first datasets that indicated a new methodology was needed. We acknowledge financial support from the European Research Council under the European Union’s Horizon 2020 research and innovation program [E.J.G.P.; Grant Agreement No. 788363 “How intraflagellar transport shapes the cilium: a single-molecule systems study” (HITSCIL)].</p></ack><fn-group><fn id="FN1" fn-type="con"><p id="P30"><bold>Author Contributions</bold></p><p id="P31">N.D. and E.J.G.P. designed research; N.D. performed research and analyzed data; N.D., Z.Z. and E.J.G.P. wrote the manuscript.</p></fn><fn id="FN2" fn-type="conflict"><p id="P32"><bold>Declaration of interest</bold></p><p id="P33">The authors declare no competing interest.</p></fn><fn id="FN3"><p id="P34">Software availability</p><p id="P35">The wMSDc method and standalone application is written in Matlab and is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/nbdan01/wMSDc">https://github.com/nbdan01/wMSDc</ext-link>). A dataset containing simulated and various experimental data is provided with the algorithm. The format of the dataset can be either an.xlsx file, collection of.mat files obtained with the software Fiesta or Matlab files. Data can be either 1D or 2D. The templates for the.xlsx format are also available on Github.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sako</surname><given-names>Y</given-names></name><name><surname>Minoghchi</surname><given-names>S</given-names></name><name><surname>Yanagida</surname><given-names>T</given-names></name></person-group><article-title>Single-molecule imaging of EGFR signalling on the surface of living cells</article-title><source>Nat Cell Biol</source><year>2000</year><volume>2</volume><fpage>168</fpage><lpage>172</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schütz</surname><given-names>GJ</given-names></name><name><surname>Kada</surname><given-names>G</given-names></name><name><surname>Pastushenko</surname><given-names>V</given-names></name><name><surname>Schindler</surname><given-names>H</given-names></name></person-group><article-title>Properties of lipid microdomains in a muscle cell membrane visualized by single molecule microscopy</article-title><source>EMBO J</source><year>2000</year><volume>19</volume><fpage>892</fpage><lpage>901</lpage></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harms</surname><given-names>GS</given-names></name><name><surname>Cognet</surname><given-names>L</given-names></name><name><surname>Lommerse</surname><given-names>PHM</given-names></name><name><surname>Blab</surname><given-names>GA</given-names></name><name><surname>Kahr</surname><given-names>H</given-names></name><name><surname>Gamsjäger</surname><given-names>R</given-names></name><name><surname>Spaink</surname><given-names>HP</given-names></name><name><surname>Soldatov</surname><given-names>NM</given-names></name><name><surname>Romanin</surname><given-names>C</given-names></name><name><surname>Schmidt</surname><given-names>T</given-names></name></person-group><article-title>Single-Molecule Imaging of L-Type Ca2+ Channels in Live Cells</article-title><source>Biophys J</source><year>2001</year><volume>81</volume><fpage>2639</fpage><lpage>2646</lpage></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>R</given-names></name><name><surname>Koyama</surname><given-names>I</given-names></name><name><surname>Kusumi</surname><given-names>A</given-names></name></person-group><article-title>Single Molecule Imaging of Green Fluorescent Proteins in Living Cells: E-Cadherin Forms Oligomers on the Free Cell Surface</article-title><source>Biophys J</source><year>2001</year><volume>80</volume><fpage>2667</fpage><lpage>2677</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seisenberger</surname><given-names>G</given-names></name><name><surname>Ried</surname><given-names>MU</given-names></name><name><surname>Endreß</surname><given-names>T</given-names></name><name><surname>Büning</surname><given-names>H</given-names></name><name><surname>Hallek</surname><given-names>M</given-names></name><name><surname>Bräuchle</surname><given-names>C</given-names></name></person-group><article-title>Real-Time Single-Molecule Imaging of the Infection Pathway of an Adeno-Associated Virus</article-title><source>Science</source><year>2001</year><volume>294</volume><fpage>1929</fpage><lpage>1932</lpage></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Hare</surname><given-names>HM</given-names></name><name><surname>Johnsson</surname><given-names>K</given-names></name><name><surname>Gautier</surname><given-names>A</given-names></name></person-group><article-title>Chemical probes shed light on protein function</article-title><source>Curr Opin Struct Biol</source><year>2007</year><volume>17</volume><fpage>488</fpage><lpage>494</lpage></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Tauzin</surname><given-names>LJ</given-names></name><name><surname>Baiyasi</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Moringo</surname><given-names>N</given-names></name><name><surname>Shuang</surname><given-names>B</given-names></name><name><surname>Landes</surname><given-names>CF</given-names></name></person-group><article-title>Single Particle Tracking: From Theory to Biophysical Applications</article-title><source>Chem Rev</source><year>2017</year><volume>117</volume><fpage>7331</fpage><lpage>7376</lpage></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hynecek</surname><given-names>J</given-names></name></person-group><article-title>Impactron-a new solid state image intensifier</article-title><source>IEEE Trans Electron Devices</source><year>2001</year><volume>48</volume><fpage>2238</fpage><lpage>2241</lpage></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>ZL</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Long</surname><given-names>F</given-names></name><name><surname>Ma</surname><given-names>H</given-names></name><name><surname>Qin</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Ding</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Luo</surname><given-names>Q</given-names></name><name><surname>Zeng</surname><given-names>S</given-names></name></person-group><article-title>Localization-based super-resolution microscopy with an sCMOS camera</article-title><source>Opt Express</source><year>2011</year><volume>19</volume><fpage>19156</fpage><lpage>19168</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kowalek</surname><given-names>P</given-names></name><name><surname>Loch-Olszewska</surname><given-names>H</given-names></name><name><surname>Szwabiński</surname><given-names>J</given-names></name></person-group><article-title>Classification of diffusion modes in single-particle tracking data: Feature-based versus deep-learning approach</article-title><source>Phys Rev E</source><year>2019</year><volume>100</volume><elocation-id>032410</elocation-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>S</given-names></name><name><surname>Song</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name></person-group><article-title>Detection of Velocity and Diffusion Coefficient Change Points in Single-Particle Trajectories</article-title><source>Biophys J</source><year>2018</year><volume>115</volume><fpage>217</fpage><lpage>229</lpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monnier</surname><given-names>N</given-names></name><name><surname>Barry</surname><given-names>Z</given-names></name><name><surname>Park</surname><given-names>H</given-names></name></person-group><article-title>Inferring transient particle transport dynamics in live cells</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><fpage>838</fpage><lpage>840</lpage></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vega</surname><given-names>AR</given-names></name><name><surname>Freeman</surname><given-names>SA</given-names></name><name><surname>Grinstein</surname><given-names>S</given-names></name><name><surname>Jaqaman</surname><given-names>K</given-names></name></person-group><article-title>Multistep Track Segmentation and Motion Classification for Transient Mobility Analysis</article-title><source>Biophys J</source><year>2018</year><volume>114</volume><fpage>1018</fpage><lpage>1025</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huet</surname><given-names>S</given-names></name><name><surname>Karatekin</surname><given-names>E</given-names></name><name><surname>Tran</surname><given-names>VS</given-names></name><name><surname>Fanget</surname><given-names>I</given-names></name><name><surname>Cribier</surname><given-names>S</given-names></name><name><surname>Henry</surname><given-names>JP</given-names></name></person-group><article-title>Analysis of Transient Behavior in Complex Trajectories: Application to Secretory Vesicle Dynamics</article-title><source>Biophys J</source><year>2006</year><volume>91</volume><fpage>3542</fpage><lpage>3559</lpage></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Piston</surname><given-names>DW</given-names></name><name><surname>Patterson</surname><given-names>GH</given-names></name><name><surname>Knobel</surname><given-names>SM</given-names></name></person-group><chapter-title>Chapter 3: Quantitative Imaging of the Green Fluorescent Protein (GFP)</chapter-title><person-group person-group-type="editor"><name><surname>Sullivan</surname><given-names>KF</given-names></name><name><surname>Kay</surname><given-names>SA</given-names></name></person-group><source>Methods in Cell Biology</source><publisher-name>Academic Press</publisher-name><year>1998</year><fpage>31</fpage><lpage>48</lpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deschout</surname><given-names>H</given-names></name><name><surname>Zanacchi</surname><given-names>FC</given-names></name><name><surname>Mlodzianoski</surname><given-names>M</given-names></name><name><surname>Diaspro</surname><given-names>A</given-names></name><name><surname>Bewersdorf</surname><given-names>J</given-names></name><name><surname>Hess</surname><given-names>ST</given-names></name><name><surname>Braeckmans</surname><given-names>K</given-names></name></person-group><article-title>Precisely and accurately localizing single emitters in fluorescence microscopy</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>253</fpage><lpage>266</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prevo</surname><given-names>B</given-names></name><name><surname>Mangeol</surname><given-names>P</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Scholey</surname><given-names>JM</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Functional differentiation of cooperating kinesin-2 motors orchestrates cargo import and transport in C. elegans cilia</article-title><source>Nat Cell Biol</source><year>2015</year><volume>17</volume><fpage>1536</fpage><lpage>1545</lpage></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mijalkovic</surname><given-names>J</given-names></name><name><surname>Prevo</surname><given-names>B</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Mangeol</surname><given-names>P</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Ensemble and single-molecule dynamics of IFT dynein in Caenorhabditis elegans cilia</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><elocation-id>14591</elocation-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mijalkovic</surname><given-names>J</given-names></name><name><surname>van Krugten</surname><given-names>J</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Acar</surname><given-names>S</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Single-Molecule Turnarounds of Intraflagellar Transport at the C. elegans Ciliary Tip</article-title><source>Cell Rep</source><year>2018</year><volume>25</volume><fpage>1701</fpage><lpage>1707</lpage><elocation-id>e2</elocation-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Danné</surname><given-names>N</given-names></name><name><surname>Meddens</surname><given-names>B</given-names></name><name><surname>Heller</surname><given-names>I</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Direct imaging of intraflagellar-transport turnarounds reveals that motors detach, diffuse, and reattach to opposite-direction trains</article-title><source>Proc Natl Acad Sci</source><year>2021</year><volume>118</volume></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prevo</surname><given-names>B</given-names></name><name><surname>Mangeol</surname><given-names>P</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Scholey</surname><given-names>JM</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Functional differentiation of cooperating kinesin-2 motors orchestrates cargo import and transport in C. elegans cilia</article-title><source>Nat Cell Biol</source><year>2015</year><volume>17</volume><fpage>1536</fpage><lpage>1545</lpage></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mijalkovic</surname><given-names>J</given-names></name><name><surname>Prevo</surname><given-names>B</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Mangeol</surname><given-names>P</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Ensemble and single-molecule dynamics of IFT dynein in Caenorhabditis elegans cilia</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><elocation-id>14591</elocation-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mijalkovic</surname><given-names>J</given-names></name><name><surname>van Krugten</surname><given-names>J</given-names></name><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Acar</surname><given-names>S</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Single-Molecule Turnarounds of Intraflagellar Transport at the C. elegans Ciliary Tip</article-title><source>Cell Rep</source><year>2018</year><volume>25</volume><fpage>1701</fpage><lpage>1707</lpage><elocation-id>e2</elocation-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saxton</surname><given-names>MJ</given-names></name></person-group><article-title>Anomalous diffusion due to obstacles: a Monte Carlo study</article-title><source>Biophys J</source><year>1994</year><volume>66</volume><fpage>394</fpage><lpage>401</lpage></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monnier</surname><given-names>N</given-names></name><name><surname>Guo</surname><given-names>SM</given-names></name><name><surname>Mori</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>J</given-names></name><name><surname>Lénárt</surname><given-names>P</given-names></name><name><surname>Bathe</surname><given-names>M</given-names></name></person-group><article-title>Bayesian Approach to MSD-Based Analysis of Particle Motion in Live Cells</article-title><source>Biophys J</source><year>2012</year><volume>103</volume><fpage>616</fpage><lpage>626</lpage></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michalet</surname><given-names>X</given-names></name></person-group><article-title>Mean square displacement analysis of single-particle trajectories with localization error: Brownian motion in an isotropic medium</article-title><source>Phys Rev E</source><year>2010</year><volume>82</volume><elocation-id>041914</elocation-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menssen</surname><given-names>R</given-names></name><name><surname>Mani</surname><given-names>M</given-names></name></person-group><article-title>A Jump-Distance-Based Parameter Inference Scheme for Particulate Trajectories</article-title><source>Biophys J</source><year>2019</year><volume>117</volume><fpage>143</fpage><lpage>156</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manzo</surname><given-names>C</given-names></name><name><surname>Garcia-Parajo</surname><given-names>MF</given-names></name></person-group><article-title>A review of progress in single particle tracking: from methods to biophysical insights</article-title><source>Rep Prog Phys</source><year>2015</year><volume>78</volume><elocation-id>124601</elocation-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magdziarz</surname><given-names>M</given-names></name><name><surname>Weron</surname><given-names>A</given-names></name><name><surname>Burnecki</surname><given-names>K</given-names></name><name><surname>Klafter</surname><given-names>J</given-names></name></person-group><article-title>Fractional Brownian Motion Versus the Continuous-Time Random Walk: A Simple Test for Subdiffusive Dynamics</article-title><source>Phys Rev Lett</source><year>2009</year><volume>103</volume><elocation-id>180602</elocation-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>YL</given-names></name><name><surname>Perillo</surname><given-names>EP</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Yu</surname><given-names>P</given-names></name><name><surname>Chou</surname><given-names>CK</given-names></name><name><surname>Hung</surname><given-names>MC</given-names></name><name><surname>Dunn</surname><given-names>AK</given-names></name><name><surname>Yeh</surname><given-names>HC</given-names></name></person-group><article-title>Segmentation of 3D Trajectories Acquired by TSUNAMI Microscope: An Application to EGFR Trafficking</article-title><source>Biophys J</source><year>2016</year><volume>111</volume><fpage>2214</fpage><lpage>2227</lpage></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kowalek</surname><given-names>P</given-names></name><name><surname>Loch-Olszewska</surname><given-names>H</given-names></name><name><surname>Szwabiński</surname><given-names>J</given-names></name></person-group><article-title>Classification of diffusion modes in single-particle tracking data: Feature-based versus deep-learning approach</article-title><source>Phys Rev E</source><year>2019</year><volume>100</volume><elocation-id>032410</elocation-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holcman</surname><given-names>D</given-names></name><name><surname>Parutto</surname><given-names>P</given-names></name><name><surname>Chambers</surname><given-names>JE</given-names></name><name><surname>Fantham</surname><given-names>M</given-names></name><name><surname>Young</surname><given-names>LJ</given-names></name><name><surname>Marciniak</surname><given-names>SJ</given-names></name><name><surname>Kaminski</surname><given-names>CF</given-names></name><name><surname>Ron</surname><given-names>D</given-names></name><name><surname>Avezov</surname><given-names>E</given-names></name></person-group><article-title>Single particle trajectories reveal active endoplasmic reticulum luminal flow</article-title><source>Nat Cell Biol</source><year>2018</year><volume>20</volume><fpage>1118</fpage><lpage>1125</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höfling</surname><given-names>F</given-names></name><name><surname>Franosch</surname><given-names>T</given-names></name></person-group><article-title>Anomalous transport in the crowded world of biological cells</article-title><source>Rep Prog Phys</source><year>2013</year><volume>76</volume><elocation-id>046602</elocation-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Godin</surname><given-names>AG</given-names></name><name><surname>Varela</surname><given-names>JA</given-names></name><name><surname>Gao</surname><given-names>Z</given-names></name><name><surname>Danné</surname><given-names>N</given-names></name><name><surname>Dupuis</surname><given-names>JP</given-names></name><name><surname>Lounis</surname><given-names>B</given-names></name><name><surname>Groc</surname><given-names>L</given-names></name><name><surname>Cognet</surname><given-names>L</given-names></name></person-group><article-title>Single-nanotube tracking reveals the nanoscale organization of the extracellular space in the live brain</article-title><source>Nat Nanotechnol</source><year>2017</year><volume>12</volume><fpage>238</fpage><lpage>243</lpage></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cairo</surname><given-names>CW</given-names></name><name><surname>Das</surname><given-names>R</given-names></name><name><surname>Albohy</surname><given-names>A</given-names></name><name><surname>Baca</surname><given-names>QJ</given-names></name><name><surname>Pradhan</surname><given-names>D</given-names></name><name><surname>Morrow</surname><given-names>JS</given-names></name><name><surname>Coombs</surname><given-names>D</given-names></name><name><surname>Golan</surname><given-names>DE</given-names></name></person-group><article-title>Dynamic Regulation of CD45 Lateral Mobility by the Spectrin-Ankyrin Cytoskeleton of T Cells *</article-title><source>J Biol Chem</source><year>2010</year><volume>285</volume><fpage>11392</fpage><lpage>11401</lpage></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>R</given-names></name><name><surname>Cairo</surname><given-names>CW</given-names></name><name><surname>Coombs</surname><given-names>D</given-names></name></person-group><article-title>A Hidden Markov Model for Single Particle Tracks Quantifies Dynamic Interactions between LFA-1 and the Actin Cytoskeleton</article-title><source>PLOS Comput Biol</source><year>2009</year><volume>5</volume><elocation-id>e1000556</elocation-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Persson</surname><given-names>F</given-names></name><name><surname>Lindén</surname><given-names>M</given-names></name><name><surname>Unoson</surname><given-names>C</given-names></name><name><surname>Elf</surname><given-names>J</given-names></name></person-group><article-title>Extracting intracellular diffusive states and transition rates from single-molecule tracking data</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>265</fpage><lpage>269</lpage></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dosset</surname><given-names>P</given-names></name><name><surname>Rassam</surname><given-names>P</given-names></name><name><surname>Fernandez</surname><given-names>L</given-names></name><name><surname>Espenel</surname><given-names>C</given-names></name><name><surname>Rubinstein</surname><given-names>E</given-names></name><name><surname>Margeat</surname><given-names>E</given-names></name><name><surname>Milhiet</surname><given-names>PE</given-names></name></person-group><article-title>Automatic detection of diffusion modes within biological membranes using back-propagation neural network</article-title><source>BMC Bioinformatics</source><year>2016</year><volume>17</volume><fpage>197</fpage></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muñoz-Gil</surname><given-names>G</given-names></name><name><surname>Garcia-March</surname><given-names>MA</given-names></name><name><surname>Manzo</surname><given-names>C</given-names></name><name><surname>Martín-Guerrero</surname><given-names>JD</given-names></name><name><surname>Lewenstein</surname><given-names>M</given-names></name></person-group><article-title>Single trajectory characterization via machine learning</article-title><source>New string J Phys</source><year>2020</year><volume>22</volume><elocation-id>013010</elocation-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danné</surname><given-names>N</given-names></name></person-group><source>Etude de la structure nanométrique et de la viscosité locale de l’espace extracellulaire du cerveau par microscopie de fluorescence de nanotubes de carbone uniques</source><year>2018</year></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biebricher</surname><given-names>A</given-names></name><name><surname>Hirano</surname><given-names>S</given-names></name><name><surname>Enzlin</surname><given-names>JH</given-names></name><name><surname>Wiechens</surname><given-names>N</given-names></name><name><surname>Streicher</surname><given-names>WW</given-names></name><name><surname>Huttner</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>LHC</given-names></name><name><surname>Nigg</surname><given-names>EA</given-names></name><name><surname>Owen-Hughes</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Peterman</surname><given-names>E</given-names></name><etal/></person-group><article-title>PICH: A DNA Translocase Specially Adapted for Processing Anaphase Bridge DNA</article-title><source>Mol Cell</source><year>2013</year><volume>51</volume><fpage>691</fpage><lpage>701</lpage></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brückner</surname><given-names>DB</given-names></name><name><surname>Fink</surname><given-names>A</given-names></name><name><surname>Schreiber</surname><given-names>C</given-names></name><name><surname>Röttgermann</surname><given-names>PJF</given-names></name><name><surname>Rädler</surname><given-names>JO</given-names></name><name><surname>Broedersz</surname><given-names>CP</given-names></name></person-group><article-title>Stochastic nonlinear dynamics of confined cell migration in two-state systems</article-title><source>Nat Phys</source><year>2019</year><volume>15</volume><fpage>595</fpage><lpage>601</lpage></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granik</surname><given-names>N</given-names></name><name><surname>Weiss</surname><given-names>LE</given-names></name><name><surname>Nehme</surname><given-names>E</given-names></name><name><surname>Levin</surname><given-names>M</given-names></name><name><surname>Chein</surname><given-names>M</given-names></name><name><surname>Perlson</surname><given-names>E</given-names></name><name><surname>Roichman</surname><given-names>Y</given-names></name><name><surname>Shechtman</surname><given-names>Y</given-names></name></person-group><article-title>Single-Particle Diffusion Characterization by Deep Learning</article-title><source>Biophys J</source><year>2019</year><volume>117</volume><fpage>185</fpage><lpage>192</lpage></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oswald</surname><given-names>F</given-names></name><name><surname>Prevo</surname><given-names>B</given-names></name><name><surname>Acar</surname><given-names>S</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>Interplay between Ciliary Ultrastructure and IFT-Train Dynamics Revealed by Single-Molecule Super-resolution Imaging</article-title><source>Cell Rep</source><year>2018</year><volume>25</volume><fpage>224</fpage><lpage>235</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savin</surname><given-names>T</given-names></name><name><surname>Doyle</surname><given-names>PS</given-names></name></person-group><article-title>Static and Dynamic Errors in Particle Tracking Microrheology</article-title><source>Biophys J</source><year>2005</year><volume>88</volume><fpage>623</fpage><lpage>638</lpage></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Krugten</surname><given-names>J</given-names></name><name><surname>Danné</surname><given-names>N</given-names></name><name><surname>Peterman</surname><given-names>EJG</given-names></name></person-group><article-title>TRPV channel OCR-2 is distributed along C. elegans chemosensory cilia by diffusion in a local interplay with intraflagellar transport</article-title><source>bioRxiv</source></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><caption><title>Statement of Significance</title></caption><p>Extracting quantitative parameters from single-particle trajectories is a challenging task, especially in biological samples, which often show a high degree of heterogeneity. Trajectories can reveal switches between different types of motion; directed, diffusive and sub-diffusive motion. Usually, the length of these trajectories and their localization precision are limited by the experimental conditions. Here, we present a novel approach to analyse single molecule trajectories, windowed Mean-Square Displacement classifier (wMSDc) to reliably distinguish between directed and diffusive transport in the short trajectories with a finite precision of localization and integration time typically obtained when imaging single fluorescent proteins in living cells or organisms. We show that, using simulated and a wide range of experimental trajectories, wMSDc is a reliable method to extract motility parameters such as diffusion coefficient and velocity.</p></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><title>MSD analysis and α values during directed and diffusive transport.</title><p>A) Simulated trajectory of a single particle undergoing directed transport (<italic>v</italic> = 1 μm. s<sup>−1</sup>, Δ<italic>t</italic> = 30 ms and <italic>PL</italic> = 30 nm); MSD (top right) and α value (bottom right) extracted using a sliding window width <italic>W</italic> of 31 frames. The dashed dark lines show the linear fit of the 3 first lag time for MSD and the averaged α value over the <italic>W</italic>/2 first lag time. B) Simulated trajectory of a single particle undergoing diffusion (<italic>D</italic> = 0.01 μm<sup>2</sup>. s<sup>−1</sup>, Δ<italic>t</italic> = 30 ms and <italic>PL</italic> = 30 nm); MSD (top right) and <italic>α</italic> value (bottom right) extracted using a sliding window width <italic>W</italic> of 31 frames. The dashed dark lines show the linear fit of the 3 first lag time for MSD and the averaged <italic>α</italic> value over the W/2 first lag time. C) <italic>α</italic> values determined for directed transport as a function of the ratio <italic>PL</italic>/(<italic>v</italic> ∙ Δ<italic>t</italic>) using different sliding Window widths (<italic>W</italic>). D) <italic>α</italic> values determined for passive transport as a function of the ratio <italic>PL</italic>/(2<italic>D</italic> ∙ Δ<italic>t</italic>)<sup>1/2</sup> using different sliding Window widths (<italic>W</italic>). Velocities (<italic>v</italic>), diffusion coefficients (<italic>D</italic>), integration times (Δ<italic>t</italic>) and Localization precision (<italic>PL</italic>) values used for the graphs C and D are reported in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>.</p></caption><graphic xlink:href="EMS156302-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Substeps to choose the appropriate minimal window width <italic>W</italic>.</title><p>Simulated data are the same as in <xref ref-type="fig" rid="F1">Figure 1C</xref>. The dashed and dotted vertical red lines indicate the coordinates for the ratios <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>). The dashed horizontal blue line corresponds to <italic>α</italic> = 1. The horizontal blue line corresponds to <italic>α</italic> = <italic>α</italic><sub><italic>W</italic>=65</sub> and the dashed grey line to <italic>α</italic> = 1.7. The annotation ① indicates the first criterion (<italic>α</italic><sub><italic>t</italic></sub>(<italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>)) &gt; 1). The annotations ② and ③ indicate the <italic>α</italic><sub><italic>W</italic></sub> value for the ratios <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>). The red colour for the annotation indicates the most important criterion limiting the value of the minimal appropriate window width. The red arrow indicates the value of the appropriate window width. The different substeps are show for 6 examples. A) <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) range between 0.7 and 6.7. In this case the second criterion ③ imposes the value of the minimal appropriate window width. B) <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>) and <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) range between 0.7 and 6.7. In this case the first criterion ① imposes the value of the minimal appropriate window width. C) <italic>PL</italic>/(〈<italic>v</italic>〉 ∙ Δ<italic>t</italic>) = <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>). The velocity is constant. This case shows the relevance of the second criteria in order to maximize the difference <italic>α</italic><sub><italic>t</italic></sub> − <italic>α</italic><sub><italic>d</italic></sub> ∀ <italic>D</italic> and <italic>v</italic>. D) Particular case for which <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) &lt; 2.9 and <italic>α</italic><sub><italic>W</italic>=65</sub> &gt; 1.7. In this case, the lowest value of <italic>α</italic><sub><italic>t</italic></sub> ∀ <italic>v</italic> (<italic>α</italic><sub><italic>W</italic></sub>) equals 1.7 (dashed grey line). E) Particular case with <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) &lt; 0.7. The window width is automatically set to 15 frames. F) Particular case with <italic>PL</italic>/(<italic>v</italic><sub><italic>min</italic></sub> ∙ Δ<italic>t</italic>) &gt; 6.7. The window width is automatically set to 65 frames.</p></caption><graphic xlink:href="EMS156302-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Results obtained with wMSDc after optimization of the Window width and <italic>α</italic>-threshold values.</title><p>A,D) Examples of simulated trajectories showing a diffusive (Δ<italic>t</italic> = 30 ms and <italic>PL</italic> = 30 nm, <italic>W</italic> = 29 pts) and a direct (Δ<italic>t</italic> = 100 ms and <italic>PL</italic> = 0 nm, <italic>W</italic> = 15 pts) turnaround. The colors indicate <italic>α</italic><sub><italic>X</italic></sub> values obtained for the X coordinates. B,E) <italic>α</italic><sub><italic>X</italic></sub> values as a function of time (black line). <italic>α</italic><sub><italic>Th</italic></sub> values calculated are represented by horizontal red dashed lines. In case of the diffusive turnaround (B), the vertical dashed lines show the transitions between directed and diffusive transport, as injected in the simulation. In case of the direct turnaround (E), the vertical dashed line shows the transitions between the two stretches of directed transport in opposite direction, as injected in the simulation. C,F) Results of the classification within these trajectories using wMSDc. Red: directed transport, blue: diffusive transport. G) Example of a trajectory showing sub-diffusion (0 - 3 s) and free diffusion (3 - 6 s) with Δ<italic>t</italic> = 30 ms, <italic>PL</italic> = 30 nm, D = 0.05 μm<sup>2</sup>.s<sup>−1</sup> and a radius of 0.1 μm for the confinement. H) <italic>α</italic><sub><italic>X</italic></sub> values as a function of time (black line). <italic>α</italic><sub><italic>Th</italic></sub> value calculated using Condition #2 or not are represented by a red dashed line and a green line respectively. I) Results of the classification using wMSDc (Conditions #2. 3 and 4 included). Blue: diffusive transport. GT is Ground Truth (Classification injected in the simulation). Scale bar: 1 μm.</p></caption><graphic xlink:href="EMS156302-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Comparison of the classification accuracy of DC-MSS, HMM and wMSDc as a function of the ratio <italic>PL</italic>/Δ<italic>t</italic>.</title><p>A,B) Comparison of the classification using the three methods for a direct and a diffusive turnaround. Red: directed transport, Blue: diffusive transport. The dotted vertical lines in B indicate the beginning and end of the diffusive part. GT is Ground Truth, and HMM-2 and HMM-3 indicate the results obtained using HMM with an initial number of states equal to 2 and 3 respectively (see also main text). C) Classification accuracy during directed transport, D) Classification accuracy during diffusive transport. Scale bars: 1 μm.</p></caption><graphic xlink:href="EMS156302-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Effect of localization precision (<italic>PL</italic>) and integration time (<italic>Δt</italic>) on the values obtained for the velocity and diffusion coefficient.</title><p>These results are obtained using the simulated trajectories of <xref ref-type="fig" rid="F1">Figure 1</xref>, with directed motion in the X direction and free diffusion in the Y direction. Values for velocity and diffusion coefficient are listed in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref> (Set T and Set D). A) Velocity calculated using <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> (between 2 consecutive time points) in grey; Ground Truth velocity shown as black dashed line (see Set T) and velocity calculated using 9 time points in red. Note that the grey and red points overlap because the averaged velocity values obtained using 2 and 9 time points are equal. B) Diffusion coefficient calculated using <xref ref-type="disp-formula" rid="FD5">Eq.3</xref> (between 2 consecutive time points) in grey, Ground Truth D represented as black dashed line (see Set D) and D calculated using 3 consecutive time points in blue. C) Standard deviation of the velocity calculated using different amounts of points. D) Normalized Standard deviation of the diffusion coefficient, <italic>σ</italic><sub><italic>D</italic></sub>/<italic>D</italic><sub><italic>th</italic></sub>, calculated using <xref ref-type="disp-formula" rid="FD6">Eq.5</xref> (Holcman’s method, black solid circles), using our approach (see main text, blue solid circles) and using a linear fit on the Mean-Square Displacement calculated with a window width of 15 time points (red solid circles). The solid lines show quadratic fits.</p></caption><graphic xlink:href="EMS156302-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Applications of wMSDc to trajectories from the subcellular to the macroscopic scale: single motor protein trajectories <italic>in vivo,</italic> protein motion <italic>in vitro</italic>, cell motility, and <italic>C. elegans</italic> motion.</title><p>A) Example of two trajectories of single motor proteins recorded <italic>in vivo</italic> in chemosensory cilia of <italic>C. elegans</italic> (Δ<italic>t</italic> = 30 ms, <italic>PL</italic> = 55 nm and <italic>v</italic> ∈ [0.5 − 1.5] μm. s<sup>−1</sup>) (<xref ref-type="bibr" rid="R20">20</xref>). Red: anterograde (A) directed transport, Dark-blue: retrograde (R) directed transport, and Light-Blue: diffusive transport/pauses. AA, AR and RR are classifications of the pauses depending on the type of motion before and after the pause. B) Example of two PICH proteins interacting with a lambda DNA recorded <italic>in vitro</italic> (<xref ref-type="bibr" rid="R41">41</xref>). The DNA, with beads attached to both ends is extended and held in place with two optical traps. Δ<italic>t</italic> = 1 – 2.5 s, <italic>PL</italic> = 30 nm and <italic>v</italic> = 10 nm. s<sup>−1</sup>. C) Example of two trajectories showing human cancer cells <italic>in vitro</italic> moving between two 2D-squared traps (<xref ref-type="bibr" rid="R42">42</xref>) (37 μm x 37 μm). The position is extracted from the location of the nucleus (in blue). Δ<italic>t</italic> = 10 min, <italic>PL</italic> ≪ averaged steps size and <italic>v</italic> ≈ 1 μm. min<sup>−1</sup>. D) Example of one trajectory showing a <italic>C. elegans</italic> worm performing an Omega-turn (Ω-turn) on an agar plate after touching a repellent-containing liquid droplet (SDS). This typical reaction is a part of the behavioral response of <italic>C. elegans</italic> towards chemical stimuli. Δ<italic>t</italic> = 1 frame, <italic>PL</italic> ≪ averaged steps size and <italic>v</italic> ≈ 2 pxl. frame<sup>−1</sup>.</p></caption><graphic xlink:href="EMS156302-f006"/></fig></floats-group></article>