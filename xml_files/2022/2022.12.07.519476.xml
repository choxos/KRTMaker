<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158392</article-id><article-id pub-id-type="doi">10.1101/2022.12.07.519476</article-id><article-id pub-id-type="archive">PPR582384</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Bayesian clustering with uncertain data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Nicholls</surname><given-names>Kath</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kirk</surname><given-names>Paul D W</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Wallace</surname><given-names>Chris</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib></contrib-group><aff id="A1"><label>1</label>Cambridge Institute of Therapeutic Immunology and Infectious Disease</aff><aff id="A2"><label>2</label>MRC Biostatistics Unit, University of Cambridge</aff><aff id="A3"><label>3</label>Cancer Research UK Cambridge Centre, Ovarian Cancer Programme, University of Cambridge</aff><pub-date pub-type="nihms-submitted"><day>11</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>10</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Clustering is widely used in bioinformatics and many other fields, with applications from exploratory analysis to prediction. Many types of data have associated uncertainty or measurement error, but this is rarely used to inform the clustering.</p><p id="P2">We present Dirichlet Process Mixtures with Uncertainty (DPMUnc), an extension of a Bayesian nonparametric clustering algorithm which makes use of the uncertainty associated with data points. We show that DPMUnc out-performs existing methods on simulated data. We cluster immune-mediated diseases (IMD) using GWAS summary statistics, which have uncertainty linked with the sample size of the study. DPMUnc separates autoimmune from autoinflammatory diseases and isolates other subgroups such as adult-onset arthritis.</p><p id="P3">We additionally consider how DPMUnc can be used to cluster gene expression datasets that have been summarised using gene signatures. We first introduce a novel procedure for generating a summary of a gene signature on a dataset different to the one where it was discovered. Since the genes in the gene signature are unlikely to be as strongly correlated as in the original dataset, it is important to quantify the variance of the gene signature for each individual. We summarise three public gene expression datasets containing patients with a range of IMD, using three relevant gene signatures. We find association between disease and the clusters returned by DPMUnc, with clustering structure replicated across the datasets.</p><p id="P4">The significance of this work is two-fold. Firstly, we demonstrate that when data has associated uncertainty, this uncertainty should be used to inform clustering and we present a method which does this, DPMUnc. Secondly, we present a procedure for using gene signatures in datasets other than where they were originally defined. We show the value of this procedure by summarising gene expression data from patients with immune-mediated diseases using relevant gene signatures, and clustering these patients using DPMUnc.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P5">Grouping items by similarity has a variety of applications in bioinformatics. For example, clustering samples according to any molecular measures may help to identify subgroups of disease<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup>. In gene expression data, clustering the genes may be useful for inferring gene function using guilt by association and inferring regulatory relationships<sup><xref ref-type="bibr" rid="R3">3</xref></sup>. Clustering can also be used to cluster diseases themselves. For example, immune-mediated diseases (IMD) have been shown to have a shared genetic basis such that IMD can be clustered according to those shared patterns<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R5">5</xref></sup>.</p><p id="P6">Commonly used methods, such as k-means<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup> and mclust<sup><xref ref-type="bibr" rid="R8">8</xref></sup>, assume that the observations being clustered are observed without error, or that any errors are identically distributed. In reality we often have not just data points themselves but also a measure of uncertainty about each observation which has the potential to improve clustering accuracy if exploited. Within the clustering approaches, the Bayesian methods offer some advantages, in their ability to convey uncertainty about the cluster centers and variances as well as the overall clustering, and to simultaneously infer the number of clusters, <italic>K</italic>. Here, we propose Dirichlet Process Mixtures with Uncertainty (DPMUnc) which adapts Bayesian clustering to the setting where the data points have associated uncertainty.</p><p id="P7">We show that accounting for uncertainty can alter the clustering solution returned and demonstrate its performance on a range of simulated datasets and real applications. First, we consider clustering IMD using GWAS summary statistics, a problem where the uncertainty associated with each observation generally varies systematically with study sample size. Second, we cluster patients with IMD using gene expression data which can help identify subtypes of disease or predict response to treatment<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. However, clustering on all ~20,000 genes can be computationally expensive, and may group patients by disease-irrelevant structure, such as sex or age. Investigations of gene expression in relation to disease or biological processes sometimes produce a gene signature, a list of genes with a shared pattern of gene expression which is relevant to the disease or process. We propose a summary measure of a gene signature, which captures average signature expression and its variance, and show that DPMUnc allows patients to be clustered according to one or more signatures.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>DPMUnc model</title><p id="P8">Our approach follows previous work<sup><xref ref-type="bibr" rid="R9">9</xref></sup>, extended to include both the observations <italic>x<sub>i</sub></italic>, <italic>i</italic> = 1 ‚Ä¶ <italic>n</italic> and their respective uncertainty estimates <inline-formula><mml:math id="M1"><mml:msubsup><mml:mi>œÉ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. We model these <italic>x<sub>i</sub></italic> as noisy observations of some latent variables <inline-formula><mml:math id="M2"><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mo>ùí©</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>œÉ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The latent variables themselves are modelled as coming from a Dirichlet Process Gaussian Mixture Model (DPGMM). We follow the approach of<sup><xref ref-type="bibr" rid="R10">10</xref></sup>, which takes the infinite limit of a Gaussian Mixture Model and can be shown to be equivalent to using Dirichlet Processes directly<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>.</p><p id="P9">In a finite Gaussian Mixture Model the points are generated from <italic>K</italic> clusters, where points within each cluster are i.i.d. Gaussian variables with some mean <italic>Œº<sub>k</sub></italic> and variance <inline-formula><mml:math id="M3"><mml:msubsup><mml:mi>œÅ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>: <disp-formula id="FD1"><mml:math id="M4"><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>‚à£</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>~</mml:mo><mml:mo>ùí©</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Œº</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>œÅ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> where the indicator variables <italic>c<sub>i</sub></italic> show which cluster a variable belongs to. We give these indicator variables a standard categorical distribution with the weights for each category œÄ<sub>k</sub> having a Dirichlet prior: <disp-formula id="FD2"><mml:math id="M5"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>œÄ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>œÄ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>‚Ä¶</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>œÄ</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mspace width="0.2em"/><mml:mtext>Dirichlet</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>Œ±</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mo>‚Ä¶</mml:mo><mml:mo>,</mml:mo><mml:mi>Œ±</mml:mi><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M6"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>‚àë</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>œÄ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p id="P10">Finally, we define priors <disp-formula id="FD3"><mml:math id="M7"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mi>Œ±</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mo>~</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Œº</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>œÅ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>~</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Normal-Inverse</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Œº</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Œ∫</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Œ±</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Œ≤</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>a</italic><sub>0</sub> = 3, <italic>b</italic><sub>0</sub> = 4, <italic>Œº</italic><sub>0</sub> is the empirical mean of the observed data and Œ±<sub>0</sub>, <italic>Œ≤</italic><sub>0</sub>, <italic>Œ∫</italic><sub>0</sub> are hyperparameters that should be adjusted according to the spread of the data and the expected cluster structure. Some further discussion of how these values may be chosen is given in the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref>.</p><p id="P11">The joint density factorises as follows: <disp-formula id="FD4"><label>(1)</label><mml:math id="M8"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>œÄ</mml:mi><mml:mo>,</mml:mo><mml:mi>Œº</mml:mi><mml:mo>,</mml:mo><mml:mi>œÅ</mml:mi><mml:mo>,</mml:mo><mml:mi>Œ±</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>‚à£</mml:mo><mml:mi>œÄ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>œÄ</mml:mi><mml:mo>‚à£</mml:mo><mml:mi>Œ±</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Œ±</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>‚àè</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>‚à£</mml:mo><mml:msubsup><mml:mi>œÉ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>‚à£</mml:mo><mml:msub><mml:mi>œï</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula> as represented in <xref ref-type="fig" rid="F1">Figure 1</xref>. We now let <italic>K</italic> tend to infinity, yielding a Gaussian Mixture Model with no constraint on the number of clusters which is equivalent to a Dirichlet Process Gaussian Mixture Model<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>.</p><p id="P12">We use a Gibbs sampling algorithm to sample from the posterior <italic>p</italic>(<bold><italic>c</italic></bold>|<bold><italic>x</italic></bold>, <bold>œÉ</bold><sup>2</sup>) according to the conditional probability distributions as set out in Supplementary Information and as described in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure S9</xref>.</p><p id="P13">To more directly compare the effect of adjusting for the uncertainty of the points, we also run DPMUnc with adjusted versions of the datasets where the observations themselves were untouched, but the uncertainty estimates were shrunk to 0. Thus the rest of the DPMUnc works as normal, but the latent variables are essentially fixed to be equal to the observed data points throughout and so the only difference compared to DPMUnc is that no adjustment for uncertainty takes place. We call this version of the method DPMZeroUnc.</p></sec><sec id="S4"><title>Simulated study</title><p id="P14">We first used simulated data to explore the effects of differing levels of uncertainty associated with each observation and noise around each cluster location on DPMUnc. Detailed discussion of two illustrative examples is presented in the Supplementary Information. Briefly, we found that including estimates of uncertainty tended to produce solutions with smaller cluster variances, and with cluster means corresponding to a weighted mean of observations, in which observations with lower uncertainty were given greater weight, rather than unweighted means when uncertainty was ignored.</p><p id="P15">Using the larger simulations, DPMUnc outperformed its comparators kmeans and mclust by a small margin when observation noise and cluster variance were small, which increased with increasing cluster variance or observation noise (<xref ref-type="fig" rid="F2">Figure 2</xref>). The methods differed most in their ability to infer <italic>K</italic>. When the true <italic>K</italic> = 3, DPMUnc and DPMZeroUnc tended to select <italic>K</italic> = 3 or <italic>K</italic> = 4, whilst kmeans and, to a greater extent, mclust, tended to merge clusters and underestimate <italic>K</italic>, often selecting <italic>K</italic> = 1 as cluster noise increased (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure S7</xref>).</p><p id="P16">As a Bayesian method, DPMUnc not only provides a clustering of the data, but can quantify the uncertainty about the clustering. This can be captured using the posterior similarity matrix (PSM) whose entry PSM<sub><italic>i</italic>,<italic>j</italic></sub> is the proportion of samples from the MCMC sampling in which observation <italic>i</italic> and observation <italic>j</italic> were placed in the same cluster<sup><xref ref-type="bibr" rid="R12">12</xref></sup>.</p><p id="P17">We assessed how well-calibrated the posterior similarity scores were, by binning PSM values into deciles, and examining the proportion of trait pairs in each bin that were truly in the same cluster. We found the two were generally similar, suggesting that DPMUnc was relatively well-calibrated (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure S8</xref>).</p></sec><sec id="S5"><title>Clustering immune-mediated diseases using GWAS summary statistics</title><p id="P18">Methodology has been developed to summarise genetic associations shared by multiple diseases using multi-dimensional polygenic scores, such as the summary of IMD by 13 such scores<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. The paper also calculated these 13-dimensional scores for 1,230 independent GWAS datasets. We ran DPMUnc on 45 traits from these published data that showed significant differences to controls according to the original study (<xref ref-type="fig" rid="F3">Figure 3</xref>). GWAS summary statistics include both an estimate of the strength of association and the uncertainty associated with that estimate. The uncertainty is propagated through to the scores, which is influenced heavily by sample size so each trait has similar uncertainty across all the scores, while uncertainty varies between traits (<xref ref-type="fig" rid="F3">Figure 3</xref>).</p><p id="P19">Six clusters were identified, summarised as classic autoimmune diseases and most arthitides (A), a null cluster with observations lying close to zero or with sufficiently high uncertainty that they might truly lie near zero (B), classic autoinflammatory diseases and coeliac disease (C), multiple sclerosis (D), adult onset arthritis (E), and eosophilic granulomatisos granulomatosis with polyangiitis (EGPA) (F).</p><p id="P20">The posterior similarity matrix in <xref ref-type="supplementary-material" rid="SD1">Figure S10</xref> shows relatively high confidence in the clusters. In particular, even with the uncertainty associated with the location of the rare disease EGPA, the two EGPA subtypes form their own cluster in a high percentage of the samples, perhaps reflecting their extreme location on PC13 which was shown to be related to eosinophils<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. In contrast, whilst coeliac disease is clustered with other inflammatory bowel conditions (Crohn‚Äôs disease and Ulcerative Colitis), it is much less confidently placed in this cluster than the other traits, perhaps reflecting that it is generally considered an autoimmune disease.</p><p id="P21">Multiple sclerosis (MS) is the only disease to cluster alone, which perhaps reflects that MS is unusual in having both autoinflammatory and autoimmune features<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, although the PSM does show both neuromyelitis optica (NMO) IgG<sup>‚àí</sup> and systemic JIA have some non-zero probability of clustering with MS.</p></sec><sec id="S6"><title>Clustering patients by gene expression signatures</title><p id="P22">Gene expression signatures have been linked to several immune-mediated diseases, and we identified three such signatures from recent literature:</p><p id="P23"><bold><italic>Sig</italic><sub>NK</sub></bold> contains genes enriched for expression in NK cells and has been associated with T1D<sup><xref ref-type="bibr" rid="R15">15</xref></sup></p><p id="P24"><bold><italic>Sig</italic></bold><sub>IFN</sub> contains genes in the type I interferon pathway, commonly found to show increased expression in SLE patients<sup><xref ref-type="bibr" rid="R16">16</xref></sup></p><p id="P25"><bold><italic>Sig</italic><sub>CD8</sub></bold> genes associated with CD8 T cell exhaustion, which have been shown to predict prognosis in inflammatory bowel disease<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup></p><p id="P26">We attempted to cluster patients with a range of IMD in three gene expression datasets<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup> (<xref ref-type="table" rid="T1">Table 1</xref>). For each individual, we summarised expression levels of each signature with a mean level and its associated uncertainty, as described in Methods. For some signatures, we anticipated association with specific diseases (such as the interferon signature and SLE) whilst for others we had less clear prior hypotheses. Whilst we did not expect every signature or every clustering to associate with disease, because any clusters found might reflect disease activity, sex or ethnicity, we considered that clusterings which discriminated between diseases would be meaningful, and so assessed the association of each clustering with disease using Fisher‚Äôs exact test.</p><p id="P27">We first used DPMUnc to cluster datasets by individual signatures, and found clusters in each dataset which showed association with disease in the majority of cases (7/9). All datasets identified a ‚Äúhigh‚Äù cluster for <italic>Sig</italic><sub>IFN</sub> which contained a majority of SLE cases. Clustering by <italic>Sig</italic><sub>CD8</sub> also found a ‚Äúhigh‚Äù cluster which contained a majority of T1D cases in both datasets (Ferreira and Lyons). For <italic>Sig</italic><sub>NK</sub>, the Ferreira dataset identified a low cluster containing primarily T1D cases, as expected given the published associated of this signature with T1D<sup><xref ref-type="bibr" rid="R15">15</xref></sup>, but whilst evidence for differential clustering by disease was found in Chaussabel, there was no enrichment of T1D in the ‚Äúlow‚Äù cluster. This difference may reflect time since diagnosis - T1D cases in Ferreira were predominantly newly diagnosed, while the samples in the original study that identified the signature were from children before and around the time of seroconversion. Only limited details are given about the Chaussabel T1D samples<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, but since by definition T1D cases are only newly diagnosed for a short period of time, it is likely these were longer standing cases. Thus this signature may represent an active disease process that resolves in long standing T1D cases.</p><p id="P28">We then clustered the Ferreira and Chaussabel datasets, which had shown association with each signature, across all three signatures simultaneously. We found that in the case of Ferreira, the multiple-signature clustering discriminated more powerfully between diseases than any individual signature clustering (<xref ref-type="fig" rid="F5">Figure 5</xref>). However, in the case of Chaussabel, while the SLE group remained identifiable with high <italic>Sig</italic><sub>IFN</sub> values, the T1D cluster that had been identified in <italic>Sig</italic><sub>CD8</sub> clustering alone, was folded into the main cluster with the healthy controls.</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P29">Taking uncertainty into account can have an impact on clustering. We illustrated with simulated data how the cluster mean inferred by DPMUnc is closer to the points that have lower uncertainty, whereas methods like mclust and k-means place the cluster mean close to the empirical mean of all the points, and also how DPMUnc shifts the latent data points towards the inferred cluster mean, which results in a smaller cluster variance. In a more complicated dataset this could have knock-on consequences, perhaps excluding more distant points from joining the cluster, or splitting one cluster into two. On a range of simulated datasets, DPMUnc out-performed existing methods and the posterior similarity values were shown to be relatively well calibrated, so that if two points have posterior similarity of <italic>p</italic>, this roughly translates to probability <italic>p</italic> that they are in the same cluster in the true clustering.</p><p id="P30">Our clustering of diseases by the engineered GWAS features recapitulated known divisions and relationships in the immune-mediated diseases. It also suggests further uses for clustering with uncertainty, such as clustering individuals using sets of polygenic risk scores, where the uncertainty in the PRS coefficients could be exploited rather than ignored.</p><p id="P31">Gene signatures may be defined on one dataset with ideal experimental conditions, such as a timecourse study of the effect of interferon-<italic>Œ≤</italic>. To then use them on a new dataset with more complex structure, such as a dataset with patients with a mix of immune-mediated diseases, typically requires some form of dimension reduction such as WGCNA or PCA used on the new dataset, either using just those genes from the signature<sup><xref ref-type="bibr" rid="R16">16</xref></sup> or using all genes<sup><xref ref-type="bibr" rid="R18">18</xref></sup> with the hope that one WGCNA module or variable in PCA will coincide with the signature. Our proposed method of summarising a gene expression across a signature extends the possible uses of signatures, and since the signature may be weaker on a dataset with more complex structure, it is crucial to take the variability of the signature into account, which DPMUnc allows. In particular, it allows us to cluster patients simultaneously according to multiple signatures. In the case of the Ferreira dataset, this led to a clearer separation of the two disease and control groups, emphasizing the potential utility of considering multiple signatures, which provide multiple views of the same data.</p></sec><sec id="S8" sec-type="methods"><title>Methods</title><sec id="S9"><title>Inference from DPMUnc</title><sec id="S10"><title>Simulations</title><p id="P32">We simulated a variety of datasets with different characteristics to explore the behaviour of DPMUnc in comparison to other methods when the ‚Äútruth‚Äù was known.</p><p id="P33">The simulated datasets each consist of thirty points spread across three clusters, and broadly follow the model used by DPMUnc outlined above. The simulation process includes two parameters which are varied between simulations: <italic>U</italic> controls the magnitude of observation uncertainty and <italic>N</italic> controls the level of noise around the cluster means, i.e. the levels of observational and biological variation respectively. The process for simulating data is: <list list-type="order" id="L1"><list-item><p id="P34">Cluster means are the points <italic>Œº</italic><sub>1</sub> = (10,0), <italic>Œº</italic><sub>2</sub> = (0,10), <italic>Œº<sub>3</sub></italic> = (Œ±, Œ±) where <inline-formula><mml:math id="M9"><mml:mi>Œ±</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>‚âà</mml:mo><mml:mtext>‚Äâ</mml:mtext><mml:mn>14</mml:mn></mml:math></inline-formula> was chosen so that the cluster means are equidistant.</p></list-item><list-item><p id="P35">Points were independently and uniformly assigned to clusters i.e. <inline-formula><mml:math id="M10"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mover><mml:mo>~</mml:mo><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>.</mml:mo><mml:mtext>i</mml:mtext><mml:mo>.</mml:mo><mml:mtext>d</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mover></mml:math></inline-formula>Uniform{1, 2, 3} for <italic>i</italic> = 1, ‚Ä¶, 30.</p></list-item><list-item><p id="P36">Latent observations were simulated around the cluster mean, with variance <italic>N</italic> i.e. <italic>z<sub>i</sub></italic> | <italic>c<sub>i</sub></italic> = <italic>K</italic> ‚àº ùí© (<italic>Œº</italic><sub>k</sub>, <italic>N</italic>)</p></list-item><list-item><p id="P37">Uncertainty for the points was simulated using <inline-formula><mml:math id="M11"><mml:msubsup><mml:mi>œÉ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mover><mml:mo>~</mml:mo><mml:mrow><mml:mtext>i</mml:mtext><mml:mo>.</mml:mo><mml:mtext>i</mml:mtext><mml:mo>.</mml:mo><mml:mtext>d</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mover><mml:mo>Œì</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>Œ∏</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>U</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p id="P38">Observed data points were simulated about the latent points: <inline-formula><mml:math id="M12"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mo>ùí©</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>œÉ</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item></list></p><p id="P39">We simulated for 100 different seeds each combination of <italic>U</italic> = 5, 7,10,13 and <italic>N</italic> = 4, 9,12,16. A grid of simulated datasets is shown in <xref ref-type="supplementary-material" rid="SD1">Figure S6</xref> showing the range of the datasets.</p><p id="P40">We ran DPMUnc and DPMZeroUnc with 10 thousand iterations, saving only every 10th iteration to avoid autocorrelation and discarding the first half of the iterations as burn-in.</p></sec><sec id="S11"><title>Prior for cluster parameters</title><p id="P41">We used the prior hyperparameters <italic>Œ±</italic><sub>0</sub> = 2, <italic>Œ∫</italic><sub>0</sub> = 0.5. <italic>Œº</italic><sub>0</sub> is set to be the empirical mean of all the data. <italic>Œ≤</italic><sub>0</sub> is set to be 0.2 multiplied by the variance of the variable, thus scaling <italic>Œ≤</italic><sub>0</sub> by the variance of the variable. In datasets with multiple variables, we use the mean of the variances to scale <italic>Œ≤</italic><sub>0</sub>. If a dataset had variables on vastly different scales, this would not be an appropriate choice of prior but all the datasets in this paper have variables on comparable scales.</p></sec><sec id="S12"><title>Comparing to other methods</title><p id="P42">We used simulated data to examine the performance of DPMUnc. Simulated data provides access to the true latent observations and so we could use the clustering ability on the latent data as a guide to the best performance possible by DPMUnc: no matter how good the adjustment made for uncertainty of the points is, DPMUnc cannot be expected to do better than its performance on the true latent data. We also used two widely used clustering methods as benchmarks, using the adjusted rand index (ARI)<sup><xref ref-type="bibr" rid="R21">21</xref></sup> to quantify the accuracy.</p><p id="P43">mclust<sup><xref ref-type="bibr" rid="R8">8</xref></sup> is a Gaussian Mixture Model (GMM) which does not account for uncertainty and which requires <italic>K</italic> to be specified. We chose <italic>K</italic> by optimising the Bayesian Information Criterion.</p><p id="P44">k-means<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup> can be shown to be equivalent to a GMM with spherical clusters. The R package <italic>cluster <sup><xref ref-type="bibr" rid="R22">22</xref></sup></italic> provides a function <italic>clusGap</italic> which calculates a goodness of clustering measure called the gap statistic<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, which measures within-cluster similarity. We use this measure to choose the optimal value of <italic>k</italic>, the number of clusters.</p><p id="P45">We also ran DPMUnc with adjusted versions of the datasets where the uncertainty estimates were shrunk to 0. Thus the latent variables are essentially fixed to be equal to the observed data points throughout. We call this version of the method DPMZeroUnc.</p></sec><sec id="S13"><title>GWAS summary statistics features</title><p id="P46">We downloaded <xref ref-type="supplementary-material" rid="SD1">Table S10</xref> from<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and kept the 186 traits which differed significantly from a control dataset (FDR&lt; 0.01), and focused on disease traits. To avoid near duplicates, we retained only one set of results from UK Biobank (UKBB) by excluding the GeneAtlas analysis, and retaining the Neale analyses which had a greater representation of rarer immune traits, leaving us with 45 traits in our final dataset.</p><p id="P47">We ran DPMUnc and DPMZeroUnc with 100 million iterations, saving only every 1000th iteration to avoid autocorrelation and discarding the first half of the iterations as burn-in.</p></sec><sec id="S14"><title>Gene expression signatures</title><p id="P48">The genes representing each signature were identified as follows</p><p id="P49"><bold><italic>Sig</italic><sub>NK</sub></bold> consists of 87 genes (<xref ref-type="supplementary-material" rid="SD1">Supplementary File S6</xref> from<sup><xref ref-type="bibr" rid="R15">15</xref></sup>).</p><p id="P50"><bold><italic>Sig</italic></bold><sub>IFN</sub> consists of 56 genes identified through differential expression analysis using interferon stimulation of PBMCs and marked as discriminatory in SLE according to <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref><sup><xref ref-type="bibr" rid="R16">16</xref></sup>.</p><p id="P51"><bold><italic>Sig</italic><sub>CD8</sub></bold> consists of 12 genes from module 8 and module 9 in<sup><xref ref-type="bibr" rid="R17">17</xref></sup> <xref ref-type="supplementary-material" rid="SD1">Supplemental Table 1</xref> which showed reduced expression with log fold change &lt; ‚àí3 only in exhausted CD8 T cells. The signature was defined in mice and we used BioMart to convert from murine (GRCm39) genes to human (GRCh38.p13) genes<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>.</p><p id="P52">The selected signature genes are listed in full in <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>.</p></sec><sec id="S15"><title>MCMC summarisation approach</title><p id="P53">Whilst DPMUnc and DPMZeroUnc provide samples from a posterior distribution, it is useful to find a single summary clustering for downstream analyses. We first calculate the posterior similarity matrix (PSM). Each entry PSM<sub><italic>i</italic>,<italic>j</italic></sub> is the proportion of posterior samples in which observation <italic>i</italic> and observation <italic>j</italic> were placed in the same cluster. Secondly, we calculate the clustering of the PSM that optimises the posterior expected adjusted rand index (PEAR) with the true clustering (maxpear<sup><xref ref-type="bibr" rid="R12">12</xref></sup>), i.e. the clustering that seems the most compatible with the true clustering. This requires a search strategy to explore the space of possible clusters, and we use all possible clusters found via complete hierarchical clustering, using 1 ‚àí PSM as a distance matrix, using the mcclust and mcclust.ext packages in R.</p></sec><sec id="S16"><title>Preprocessing gene expression data</title><p id="P54">We first used a variance stabilising transformation<sup><xref ref-type="bibr" rid="R26">26</xref></sup> <italic>vsn2</italic> to minimise the relationship between average gene expression and the variance of gene expression (<xref ref-type="supplementary-material" rid="SD1">Figure S4</xref>). We then used median absolute deviation (MAD) scale normalization to make the distribution of expression values similar between genes, dividing all values for gene <italic>g</italic> by the MAD of the control samples for gene <italic>g</italic>. For each sample, we then summarised using the mean and variance of the normalised expression value, with the summary measures taken across all genes in a signature.</p><p id="P55">We ran DPMUnc and DPMZeroUnc with 20 million iterations, saving only every 500th iteration to avoid autocorrelation and discarding the first half of the iterations as burn-in.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Text</label><media xlink:href="EMS158392-supplement-Supplementary_Text.pdf" mimetype="application" mime-subtype="pdf" id="d15aAdEbB" position="anchor"/></supplementary-material></sec></body><back><sec id="S17"><title>Acknowledgements</title><p>This work is supported by the Wellcome Trust (WT220788, WT220024) and the Medical Research Council (MC UU 00002/4) and supported by the NIHR Cambridge BRC (BRC-1215-20014). The views expressed are those of the author(s) and not necessarily those of the NHS, the NIHR or the Department of Health and Social Care. For the purpose of open access, the authors have applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. This work was performed using resources provided by the Cambridge Service for Data Driven Discovery (CSD3) operated by the University of Cambridge Research Computing Service (<ext-link ext-link-type="uri" xlink:href="https://www.csd3.cam.ac.uk">www.csd3.cam.ac.uk</ext-link>), provided by Dell EMC and Intel using Tier-2 funding from the Engineering and Physical Sciences Research Council (capital grant EP/P020259/1), and DiRAC funding from the Science and Technology Facilities Council (<ext-link ext-link-type="uri" xlink:href="https://dirac.ac.uk/">www.dirac.ac.uk</ext-link>).</p></sec><sec id="S18" sec-type="data-availability"><title>Data Availability Statement</title><p id="P56">The datasets were derived from sources in the public domain, as follows: <list list-type="bullet" id="L2"><list-item><p id="P57">Ferreira from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1724">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1724</ext-link></p></list-item><list-item><p id="P58">Lyons from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-145">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-145</ext-link></p></list-item><list-item><p id="P59">Chaussabel from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-GEOD-11907">https://www.ebi.ac.uk/arrayexpress/experiments/E-GEOD-11907</ext-link></p></list-item></list></p></sec><fn-group><fn id="FN1"><p id="P60"><bold>Software</bold></p><p id="P61">We make the implementation of DPMUnc, and the code to generate the analyses in this manuscript, available in github repositories: <list list-type="bullet" id="L3"><list-item><p id="P62">DPMUnc software <ext-link ext-link-type="uri" xlink:href="https://github.com/nichollskc/DPMUnc">https://github.com/nichollskc/DPMUnc</ext-link></p></list-item><list-item><p id="P63">DPMUnc simulation study <ext-link ext-link-type="uri" xlink:href="https://github.com/nichollskc/DPMUnc_simulations">https://github.com/nichollskc/DPMUnc_simulations</ext-link></p></list-item><list-item><p id="P64">GWAS dataset analysis <ext-link ext-link-type="uri" xlink:href="https://github.com/nichollskc/DPMUnc_GWAS">https://github.com/nichollskc/DPMUnc_GWAS</ext-link></p></list-item><list-item><p id="P65">Gene expression dataset analysis <ext-link ext-link-type="uri" xlink:href="https://github.com/nichollskc/clusteringPublicGeneExpr">https://github.com/nichollskc/clusteringPublicGeneExpr</ext-link></p></list-item></list>
</p></fn><fn id="FN2" fn-type="conflict"><p id="P66"><bold>Conflicts of interest</bold></p><p id="P67">CW receives research funding from GSK and MSD for an unrelated project and is a part-time employee of GSK. These companies had no input into this study.</p></fn><fn id="FN3" fn-type="con"><p id="P68"><bold>Author contributions</bold></p><p id="P69">KN: Data curation, investigation, visualization, writing - original draft</p><p id="P70">PK: methodology, writing - review and editing</p><p id="P71">CW: supervision, investigation, visualization, writing - original draft</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>D</given-names></name><name><surname>Tang</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>A</given-names></name></person-group><article-title>Cluster Analysis for Gene Expression Data: A Survey</article-title><source>IEEE Transactions on Knowledge and Data Engineering</source><year>2004</year><month>Nov</month><volume>16</volume><issue>11</issue><fpage>1370</fpage><lpage>1386</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Slonim</surname><given-names>DK</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Huard</surname><given-names>C</given-names></name><name><surname>Gaasenbeek</surname><given-names>M</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><etal/></person-group><article-title>Molecular Classification of Cancer: Class Discovery and Class Prediction by Gene Expression Monitoring</article-title><source>Science</source><year>1999</year><month>Oct</month><volume>286</volume><issue>5439</issue><fpage>531</fpage><lpage>537</lpage><pub-id pub-id-type="pmid">10521349</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>A Comprehensive Evaluation of Module Detection Methods for Gene Expression Data</article-title><source>Nature Communications</source><year>2018</year><month>Mar</month><volume>9</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC5854612</pub-id><pub-id pub-id-type="pmid">29545622</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-03424-4</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cotsapas</surname><given-names>C</given-names></name><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Rossin</surname><given-names>E</given-names></name><name><surname>Lage</surname><given-names>K</given-names></name><name><surname>Neale</surname><given-names>BM</given-names></name><name><surname>Wallace</surname><given-names>C</given-names></name><etal/></person-group><article-title>Pervasive Sharing of Genetic Effects in Autoimmune Disease</article-title><source>PLoS genetics</source><year>2011</year><month>Aug</month><volume>7</volume><issue>8</issue><elocation-id>e1002254</elocation-id><pub-id pub-id-type="pmcid">PMC3154137</pub-id><pub-id pub-id-type="pmid">21852963</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002254</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Majumdar</surname><given-names>A</given-names></name><name><surname>Haldar</surname><given-names>T</given-names></name><name><surname>Bhattacharya</surname><given-names>S</given-names></name><name><surname>Witte</surname><given-names>JS</given-names></name></person-group><article-title>An Efficient Bayesian Meta-Analysis Approach for Studying Cross-Phenotype Genetic Associations</article-title><source>PLoS genetics</source><year>2018</year><month>Feb</month><volume>14</volume><issue>2</issue><elocation-id>e1007139</elocation-id><pub-id pub-id-type="pmcid">PMC5825176</pub-id><pub-id pub-id-type="pmid">29432419</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007139</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lloyd</surname><given-names>S</given-names></name></person-group><article-title>Least Squares Quantization in PCM</article-title><source>IEEE Transactions on Information Theory</source><year>1982</year><month>Mar</month><volume>28</volume><issue>2</issue><fpage>129</fpage><lpage>137</lpage></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>MacQueen</surname><given-names>J</given-names></name></person-group><source>Some Methods for Classification and Analysis of Multivariate Observations</source><conf-name>Proc Fifth Berkeley Sympos Math Statist and Probability (Berkeley, Calif, 1965/66)</conf-name><conf-sponsor>Statistics Univ California Press</conf-sponsor><conf-loc>Berkeley, Calif</conf-loc><year>1967</year><volume>I</volume><fpage>281</fpage><lpage>297</lpage></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scrucca</surname><given-names>L</given-names></name><name><surname>Fop</surname><given-names>M</given-names></name><name><surname>Murphy</surname><given-names>TB</given-names></name><name><surname>Raftery</surname><given-names>AE</given-names></name></person-group><article-title>mclust 5: Clustering, Classification and Density Estimation Using Gaussian Finite Mixture Models</article-title><source>The R Journal</source><year>2016</year><volume>8</volume><issue>1</issue><fpage>289</fpage><lpage>317</lpage><pub-id pub-id-type="pmcid">PMC5096736</pub-id><pub-id pub-id-type="pmid">27818791</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Escobar</surname><given-names>MD</given-names></name><name><surname>West</surname><given-names>M</given-names></name></person-group><article-title>Bayesian Density Estimation and Inference Using Mixtures</article-title><source>Journal of the American Statistical Association</source><year>1995</year><month>Jun</month><volume>90</volume><issue>430</issue><fpage>577</fpage><lpage>588</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Rasmussen</surname><given-names>CE</given-names></name></person-group><source>The Infinite Gaussian Mixture Model</source><conf-name>Proceedings of the 12th International Conference on Neural Information Processing Systems NIPS‚Äô99</conf-name><conf-sponsor>MIT Press</conf-sponsor><conf-loc>Cambridge, MA, USA</conf-loc><year>1999</year><fpage>554</fpage><lpage>560</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neal</surname><given-names>RM</given-names></name></person-group><article-title>Markov Chain Sampling Methods for Dirichlet Process Mixture Models</article-title><source>Journal of Computational and Graphical Statistics</source><year>2000</year><month>Jun</month><volume>9</volume><issue>2</issue><fpage>249</fpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fritsch</surname><given-names>A</given-names></name><name><surname>Ickstadt</surname><given-names>K</given-names></name></person-group><article-title>Improved Criteria for Clustering Based on the Posterior Similarity Matrix</article-title><source>Bayesian Analysis</source><year>2009</year><month>Jun</month><volume>4</volume><issue>2</issue><fpage>367</fpage><lpage>391</lpage></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burren</surname><given-names>OS</given-names></name><name><surname>Reales</surname><given-names>G</given-names></name><name><surname>Wong</surname><given-names>L</given-names></name><name><surname>Bowes</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>JC</given-names></name><name><surname>Barton</surname><given-names>A</given-names></name><etal/></person-group><article-title>Genetic Feature Engineering Enables Characterisation of Shared Risk Factors in Immune-Mediated Diseases</article-title><source>Genome Medicine</source><year>2020</year><month>Nov</month><volume>12</volume><issue>1</issue><elocation-id>106</elocation-id><pub-id pub-id-type="pmcid">PMC7687775</pub-id><pub-id pub-id-type="pmid">33239102</pub-id><pub-id pub-id-type="doi">10.1186/s13073-020-00797-4</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wootla</surname><given-names>B</given-names></name><name><surname>Eriguchi</surname><given-names>M</given-names></name><name><surname>Rodriguez</surname><given-names>M</given-names></name></person-group><article-title>Is Multiple Sclerosis an Autoimmune Disease?</article-title><source>Autoimmune Diseases</source><year>2012</year><volume>2012</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC3361990</pub-id><pub-id pub-id-type="pmid">22666554</pub-id><pub-id pub-id-type="doi">10.1155/2012/969657</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xhonneux</surname><given-names>LP</given-names></name><name><surname>Knight</surname><given-names>O</given-names></name><name><surname>Lernmark</surname><given-names>√Ö</given-names></name><name><surname>Bonifacio</surname><given-names>E</given-names></name><name><surname>Hagopian</surname><given-names>WA</given-names></name><name><surname>Rewers</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Transcriptional Networks in At-Risk Individuals Identify Signatures of Type 1 Diabetes Progression</article-title><source>Science translational medicine</source><year>2021</year><month>Mar</month><volume>13</volume><issue>587</issue><elocation-id>eabd5666</elocation-id><pub-id pub-id-type="pmcid">PMC8447843</pub-id><pub-id pub-id-type="pmid">33790023</pub-id><pub-id pub-id-type="doi">10.1126/scitranslmed.abd5666</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>RC</given-names></name><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Coulson</surname><given-names>RMR</given-names></name><name><surname>Smyth</surname><given-names>DJ</given-names></name><name><surname>Pekalski</surname><given-names>ML</given-names></name><name><surname>Burren</surname><given-names>OS</given-names></name><etal/></person-group><article-title>A Type I Interferon Transcriptional Signature Precedes Autoimmunity in Children Genetically at Risk for Type 1 Diabetes</article-title><source>Diabetes</source><year>2014</year><month>Jul</month><volume>63</volume><issue>7</issue><fpage>2538</fpage><lpage>2550</lpage><pub-id pub-id-type="pmcid">PMC4066333</pub-id><pub-id pub-id-type="pmid">24561305</pub-id><pub-id pub-id-type="doi">10.2337/db13-1777</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wherry</surname><given-names>EJ</given-names></name><name><surname>Ha</surname><given-names>SJ</given-names></name><name><surname>Kaech</surname><given-names>SM</given-names></name><name><surname>Haining</surname><given-names>WN</given-names></name><name><surname>Sarkar</surname><given-names>S</given-names></name><name><surname>Kalia</surname><given-names>V</given-names></name><etal/></person-group><article-title>Molecular Signature of CD8+ T Cell Exhaustion during Chronic Viral Infection</article-title><source>Immunity</source><year>2007</year><month>Oct</month><volume>27</volume><issue>4</issue><fpage>670</fpage><lpage>684</lpage><pub-id pub-id-type="pmid">17950003</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>EF</given-names></name><name><surname>Lee</surname><given-names>JC</given-names></name><name><surname>Jayne</surname><given-names>DRW</given-names></name><name><surname>Lyons</surname><given-names>PA</given-names></name><name><surname>Smith</surname><given-names>KGC</given-names></name></person-group><article-title>T-Cell Exhaustion, Co-Stimulation and Clinical Outcome in Autoimmunity and Infection</article-title><source>Nature</source><year>2015</year><month>Jul</month><volume>523</volume><issue>7562</issue><fpage>612</fpage><lpage>616</lpage><pub-id pub-id-type="pmcid">PMC4623162</pub-id><pub-id pub-id-type="pmid">26123020</pub-id><pub-id pub-id-type="doi">10.1038/nature14468</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaussabel</surname><given-names>D</given-names></name><name><surname>Quinn</surname><given-names>C</given-names></name><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Patel</surname><given-names>P</given-names></name><name><surname>Glaser</surname><given-names>C</given-names></name><name><surname>Baldwin</surname><given-names>N</given-names></name><etal/></person-group><article-title>A Modular Analysis Framework for Blood Genomics Studies: Application to Systemic Lupus Erythematosus</article-title><source>Immunity</source><year>2008</year><month>Jul</month><volume>29</volume><issue>1</issue><fpage>150</fpage><lpage>164</lpage><pub-id pub-id-type="pmcid">PMC2727981</pub-id><pub-id pub-id-type="pmid">18631455</pub-id><pub-id pub-id-type="doi">10.1016/j.immuni.2008.05.012</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyons</surname><given-names>PA</given-names></name><name><surname>McKinney</surname><given-names>EF</given-names></name><name><surname>Rayner</surname><given-names>TF</given-names></name><name><surname>Hatton</surname><given-names>A</given-names></name><name><surname>Woffendin</surname><given-names>HB</given-names></name><name><surname>Koukoulaki</surname><given-names>M</given-names></name><etal/></person-group><article-title>Novel Expression Signatures Identified by Transcriptional Analysis of Separated Leucocyte Sub-sets in Systemic Lupus Erythematosus and Vasculitis</article-title><source>Annals of the Rheumatic Diseases</source><year>2010</year><month>Jun</month><volume>69</volume><issue>6</issue><fpage>1208</fpage><lpage>1213</lpage><pub-id pub-id-type="pmcid">PMC2935323</pub-id><pub-id pub-id-type="pmid">19815495</pub-id><pub-id pub-id-type="doi">10.1136/ard.2009.108043</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubert</surname><given-names>L</given-names></name><name><surname>Arabie</surname><given-names>P</given-names></name></person-group><article-title>Comparing Partitions</article-title><source>Journal of Classification</source><year>1985</year><month>Dec</month><volume>2</volume><issue>1</issue><fpage>193</fpage><lpage>218</lpage></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Maechler</surname><given-names>M</given-names></name><name><surname>Rousseeuw</surname><given-names>P</given-names></name><name><surname>Struyf</surname><given-names>A</given-names></name><name><surname>Hubert</surname><given-names>M</given-names></name><name><surname>Hornik</surname><given-names>K</given-names></name></person-group><article-title>cluster: Cluster Analysis Basics and Extensions</article-title><source>R package version 2 1 4</source><year>2022</year><comment>For new features, see the ‚ÄòChangelog‚Äô file (in the package source). Available from:<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cluster">https://CRAN.R-project.org/package=cluster</ext-link></comment></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Walther</surname><given-names>G</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><article-title>Estimating the Number of Clusters in a Data Set via the Gap Statistic</article-title><source>Journal of the Royal Statistical Society Series B (Statistical Methodology)</source><year>2001</year><volume>63</volume><issue>2</issue><fpage>411</fpage><lpage>423</lpage></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durinck</surname><given-names>S</given-names></name><name><surname>Moreau</surname><given-names>Y</given-names></name><name><surname>Kasprzyk</surname><given-names>A</given-names></name><name><surname>Davis</surname><given-names>S</given-names></name><name><surname>De Moor</surname><given-names>B</given-names></name><name><surname>Brazma</surname><given-names>A</given-names></name><etal/></person-group><article-title>BioMart and Bioconductor: A Powerful Link between Biological Databases and Microarray Data Analysis</article-title><source>Bioinformatics</source><year>2005</year><month>Aug</month><volume>21</volume><issue>16</issue><fpage>3439</fpage><lpage>3440</lpage><pub-id pub-id-type="pmid">16082012</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durinck</surname><given-names>S</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Mapping Identifiers for the Integration of Genomic Datasets with the R/Bioconductor Package biomaRt</article-title><source>Nature Protocols</source><year>2009</year><volume>4</volume><issue>8</issue><fpage>1184</fpage><lpage>1191</lpage><pub-id pub-id-type="pmcid">PMC3159387</pub-id><pub-id pub-id-type="pmid">19617889</pub-id><pub-id pub-id-type="doi">10.1038/nprot.2009.97</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>von Heydebreck</surname><given-names>A</given-names></name><name><surname>Sultmann</surname><given-names>H</given-names></name><name><surname>Poustka</surname><given-names>A</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name></person-group><article-title>Variance Stabilization Applied to Microarray Data Calibration and to the Quantification of Differential Expression</article-title><source>Bioinformatics</source><year>2002</year><month>Jul</month><volume>18</volume><issue>suppl-1</issue><fpage>S96</fpage><lpage>S104</lpage><pub-id pub-id-type="pmid">12169536</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><caption><title>Author Summary</title></caption><p>Identifying groups of items that are similar to each other, a process called clustering, has a range of applications. For example, if patients split into two distinct groups this suggests that a disease may have subtypes which should be treated differently. Real data often has measurement error associated with it, but this error is frequently discarded by clustering methods. We propose a clustering method which makes use of the measurement error and use it to cluster diseases linked to the immune system.</p><p>Gene expression datasets measure the activity level of all ~20,000 genes in the human genome. We propose a procedure for summarising gene expression data using gene signatures, lists of genes produced by highly focused studies. For example, a study might list the genes which increase activity after exposure to a particular virus. The genes in the gene signature may not be as tightly correlated in a new dataset, and so our procedure measures the strength of the gene signature in the new dataset, effectively defining measurement error for the summary. We summarise gene expression datasets related to the immune system using relevant gene signatures and find that our method groups patients with the same disease.</p></boxed-text><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Plate diagram of Gaussian Mixture Model.</title><p>When <italic>K</italic> ‚Üí ‚àû this is the Dirichlet Process Gaussian Mixture Model that is the basis of our model. In the plate diagram, each rectangle (plate) corresponds to a group of variables, and the text at the bottom of each plate shows how many copies of that plate are required for the full model. Circles indicate random variables, which are shaded if the random variable is observed. The variables without circles are hyperparameters for the model.</p></caption><graphic xlink:href="EMS158392-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Accuracy on simulated datasets.</title><p>The first row of plots has the lowest noise <italic>N</italic> around the cluster mean, and the bottom row has the highest noise. Increasing uncertainty, corresponding to greater difference between latent data and the observed data is shown on the x-axis. The accuracy of the clustering is given by the Adjusted Rand Index (ARI) between the true clustering and the inferred clustering. Higher values of ARI are better.</p></caption><graphic xlink:href="EMS158392-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>Clusters inferred by DPMUnc, DPMZeroUnc and mclust alongside the polygenic GWAS scores and the associated uncertainty.</title><p>The clusters of DPMZeroUnc and mclust have been coloured to best match the colours of DPMUnc. The dendrogram on the left is formed by applying hierarchical clustering on the posterior similarity matrix from DPMUnc, using complete-linkage.</p></caption><graphic xlink:href="EMS158392-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>Clustering of samples in 3 gene expression datasets (rows) according to 3 gene signatures (columns).</title><p>(a-c) Ferreira (d-f) Chaussabel (g-i) Lyons. In each panel, the left plot shows the observed data, and the right plot shows the fraction of individuals assigned to each cluster. The p value shown relates to the null hypothesis that cluster membership is independent of disease.</p></caption><graphic xlink:href="EMS158392-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Clustering of samples in 2 gene expression datasets (rows) using all 3 gene signatures.</title><p>In each panel, the left plot shows the observed data, and the right plot shows the fraction of individuals assigned to each cluster. The p value shown relates to the null hypothesis that cluster membership is independent of disease.</p></caption><graphic xlink:href="EMS158392-f005"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Sample counts in each gene expression dataset. Counts for a subtype of a disease are in italics.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="right" valign="middle" style="border-right: 1px solid"/><th align="right" valign="middle">Ferreira<sup><xref ref-type="bibr" rid="R16">16</xref></sup></th><th align="right" valign="middle">Lyons<sup><xref ref-type="bibr" rid="R20">20</xref></sup></th><th align="right" valign="middle">Chaussabel<sup><xref ref-type="bibr" rid="R19">19</xref></sup></th></tr></thead><tbody><tr><td align="left" valign="middle" style="border-right: 1px solid">Healthy controls (HC)</td><td align="right" valign="middle">88</td><td align="right" valign="middle">25</td><td align="right" valign="middle">12</td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Systemic lupus erythematosus (SLE)</td><td align="right" valign="middle">25</td><td align="right" valign="middle">13</td><td align="right" valign="middle">103</td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Juvenile idiopathic arthritis (JIA)</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle">47</td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Melanoma (MEL)</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle">39</td></tr><tr style="border-bottom: 1px solid"><td align="left" valign="middle" style="border-right: 1px solid">Transplant (RET)</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle">37</td></tr><tr style="border-bottom: 1px solid"><td align="left" valign="middle" style="border-right: 1px solid">Type 1 diabetes (T1D)</td><td align="right" valign="middle">64</td><td align="right" valign="middle"/><td align="right" valign="middle">20</td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Vasculitis</td><td align="right" valign="middle"/><td align="right" valign="middle">30</td><td align="right" valign="middle"/></tr><tr><td align="left" valign="middle" style="border-right: 1px solid"><italic>Microscopic Polyangiitis</italic> (VWP)</td><td align="right" valign="middle"/><td align="right" valign="middle"><italic>8</italic></td><td align="right" valign="middle"/></tr><tr style="border-bottom: 1px solid"><td align="left" valign="middle" style="border-right: 1px solid"><italic>Wegener‚Äôs Granulomatosis</italic> (VMG)</td><td align="right" valign="middle"/><td align="right" valign="middle"><italic>22</italic></td><td align="right" valign="middle"/></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Infection</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle">40</td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid"><italic>Infection (E. Coli)</italic> (EColi)</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle"><italic>22</italic></td></tr><tr style="border-bottom: 1px solid"><td align="left" valign="middle" style="border-right: 1px solid"><italic>Infection (S. Aureus)</italic> (SAureus)</td><td align="right" valign="middle"/><td align="right" valign="middle"/><td align="right" valign="middle"><italic>18</italic></td></tr><tr><td align="left" valign="middle" style="border-right: 1px solid">Total</td><td align="right" valign="middle">177</td><td align="right" valign="middle">68</td><td align="right" valign="middle">298</td></tr></tbody></table></table-wrap></floats-group></article>