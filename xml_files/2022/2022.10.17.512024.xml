<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS156220</article-id><article-id pub-id-type="doi">10.1101/2022.10.17.512024</article-id><article-id pub-id-type="archive">PPR562513</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Bayesian multilevel hidden Markov models identify stable state dynamics in longitudinal recordings from macaque primary motor cortex</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Kirchherr</surname><given-names>Sebastien</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author"><name><surname>Moraga</surname><given-names>Sebastian Mildiner</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author"><name><surname>Coudé</surname><given-names>Gino</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Bimbi</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ferrari</surname><given-names>Pier F</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Aarts</surname><given-names>Emmeke</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="fn" rid="FN2">**</xref></contrib><contrib contrib-type="author"><name><surname>Bonaiuto</surname><given-names>James J</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN2">**</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institut des Sciences Cognitives Marc Jeannerod, CNRS UMR 5229, Bron, France</aff><aff id="A2"><label>2</label>Université Claude Bernard Lyon 1, Université de Lyon, France</aff><aff id="A3"><label>3</label>Universiteit Utrecht, Utrecht, Netherlands</aff><author-notes><corresp id="CR1"><bold>Corresponding author:</bold> <email>sebastien.kirchherr@isc.cnrs.fr</email></corresp><fn id="FN1"><label>*</label><p id="P1">shared first authors</p></fn><fn id="FN2"><label>**</label><p id="P2">shared last authors</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>27</day><month>10</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>10</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P3">Neural populations, rather than single neurons, may be the fundamental unit of cortical computation. Analyzing chronically recorded neural population activity is challenging not only because of the high dimensionality of activity in many neurons, but also because of changes in the recorded signal that may or may not be due to neural plasticity. Hidden Markov models (HMMs) are a promising technique for analyzing such data in terms of discrete, latent states, but previous approaches have either not considered the statistical properties of neural spiking data, have not been adaptable to longitudinal data, or have not modeled condition specific differences. We present a multilevel Bayesian HMM which addresses these shortcomings by incorporating multivariate Poisson log-normal emission probability distributions, multilevel parameter estimation, and trial-specific condition covariates. We applied this framework to multi-unit neural spiking data recorded using chronically implanted multi-electrode arrays from macaque primary motor cortex during a cued reaching, grasping, and placing task. We show that the model identifies latent neural population states which are tightly linked to behavioral events, despite the model being trained without any information about event timing. We show that these events represent specific spatiotemporal patterns of neural population activity and that their relationship to behavior is consistent over days of recording. The utility and stability of this approach is demonstrated using a previously learned task, but this multilevel Bayesian HMM framework would be especially suited for future studies of long-term plasticity in neural populations.</p></abstract><kwd-group><kwd>multilevel modeling</kwd><kwd>hidden Markov model</kwd><kwd>neural population activity</kwd><kwd>longitudinal recording</kwd><kwd>primary motor cortex</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P4">The accelerating scale of recorded neurophysiological data has been accompanied by a shift from the view that individual neurons are the basic unit of computation, to one that explains computational processes in terms of the dynamics of neural populations (<xref ref-type="bibr" rid="R39">Saxena &amp; Cunningham, 2019</xref>). Electrophysiology studies routinely record data from ever larger neural populations using chronically implanted multi-electrode arrays. These datasets are challenging to analyze because of their dimensionality, but recent evidence suggests that neural population activity in low dimensional subspaces, or manifolds, may be more important in neural computation than the firing of particular single neurons (<xref ref-type="bibr" rid="R6">Barack &amp; Krakauer, 2021</xref>; <xref ref-type="bibr" rid="R19">Gallego et al., 2017</xref>, <xref ref-type="bibr" rid="R20">2018</xref>; <xref ref-type="bibr" rid="R26">Humphries, 2021</xref>; <xref ref-type="bibr" rid="R39">Saxena &amp; Cunningham, 2019</xref>). Chronically implanted electrode arrays present an additional analysis hurdle because the recorded signals can change dramatically over weeks and months of recording because of electrode drift or degradation (<xref ref-type="bibr" rid="R7">Barrese et al., 2016</xref>), or task-induced plasticity (<xref ref-type="bibr" rid="R13">Dayan &amp; Cohen, 2011</xref>). The ability to understand long term learning mechanisms requires such longitudinal recording, but analysis of the resulting data at the individual neuron level is hindered by the difficulty in tracking single neurons over such long periods.</p><p id="P5">Hidden Markov Models (HMMs; <xref ref-type="bibr" rid="R34">Rabiner, 1989</xref>; <xref ref-type="bibr" rid="R53">Zucchini et al., 2017</xref>) are a particularly promising approach for analyzing the activity of large neural populations (e.g., <xref ref-type="bibr" rid="R21">Gat et al., 1997</xref>; <xref ref-type="bibr" rid="R28">Kemere et al., 2008</xref>; <xref ref-type="bibr" rid="R30">Mazurek et al., 2018</xref>; <xref ref-type="bibr" rid="R32">Ponce-Alvarez et al., 2012</xref>; <xref ref-type="bibr" rid="R35">Radons et al., 1994</xref>; <xref ref-type="bibr" rid="R38">Sadacca et al., 2016</xref>; <xref ref-type="bibr" rid="R43">Seidemann et al., 1996</xref>; <xref ref-type="bibr" rid="R47">van Kempen et al., 2021</xref>; <xref ref-type="bibr" rid="R50">Xydas et al., 2011</xref>). HMMs are probabilistic models which infer unobservable (hidden) “states” from a temporal sequence of observable data. These models can therefore be used to infer discretized lower dimensional state spaces that represent high dimensional neural activity. Given a suitable observational model governing the emission of observable data from unobservable states, HMMs do not require trial averaging or smoothing, making them suitable for trial-by-trial analyses.</p><p id="P6">Movements unfold in a specific spatiotemporal sequence, making it difficult to disentangle the underlying cognitive and motor mechanisms of goal-directed movements in which planning and feedforward and feedback-based control are fundamentally intertwined. The primary motor cortex is the largest source of corticospinal projections, making it uniquely situated to integrate these mechanisms and translate them to muscle coordination of the arm and hand. Because HMMs can identify discrete changes in continuous multivariate time series (<xref ref-type="bibr" rid="R12">Cunningham &amp; Yu, 2014</xref>), they are a promising technique for decomposing dynamic M1 population activity into discrete states corresponding to the underlying cognitive and motor mechanisms of goal-directed movement. Previous HMM-based approaches to analyzing neural spiking activity have shown that such models can identify similar patterns of neural population activity in premotor cortex between execution and observation of the same actions (<xref ref-type="bibr" rid="R30">Mazurek et al., 2018</xref>), accurately predict changes in movement velocity in the primary motor cortex (<xref ref-type="bibr" rid="R27">Kadmon Harpaz et al., 2019</xref>), and segment baseline, plan, and peri-movement epochs from dorsal premotor cortex activity (<xref ref-type="bibr" rid="R28">Kemere et al., 2008</xref>). However, these approaches typically use statistical models with assumptions that are unmet by neural spiking activity, and in general have not considered non-stationary patterns of activity over long term recordings.</p><p id="P7">In the current study, we present a novel Bayesian multilevel HMM (e.g., <xref ref-type="bibr" rid="R14">de Haan-Rietdijk et al., 2017</xref>; <xref ref-type="bibr" rid="R36">Raffa &amp; Dubin, 2015</xref>; <xref ref-type="bibr" rid="R37">Rueda et al., 2013</xref>; <xref ref-type="bibr" rid="R45">K. Shirley et al., 2016</xref>; <xref ref-type="bibr" rid="R52">Zhang &amp; Berhane, 2014</xref>) adapted to longitudinal spiking data recorded from multi-electrode arrays. To accommodate the spike counts in multiple electrodes along with temporal overdispersion in the activity patterns, a multivariate Poisson log-normal emission distribution is adopted, with individual, trial-based covariates on the transition distribution. Each individual trial is thus allowed to have a specific sequence of hidden states, along with a specific set of transition probabilities and emission parameters via parametric random effects (i.e., trial-specific means) following a lognormal distribution centered on the group-level means.</p><p id="P8">We trained the model on spiking neural data recorded from the primary motor cortex of the macaque monkey during a reaching, grasping, and placing task. State transitions were tightly linked to task behavioral events, and state dynamics were closely aligned with the duration of intervals between events. We show that the states identified by the HMM represent fast transitions between distinct spatiotemporal patterns of neural population activity which are generated during specific phases of the reach, grasp, and place task, and likely correspond to different motor control processes.</p></sec><sec id="S2" sec-type="materials | methods"><label>2</label><title>Materials and methods</title><sec id="S3"><label>2.1</label><title>Multilevel Bayesian hidden Markov model</title><p id="P9">HMMs identify latent states from observable data by assuming that each state is only dependent on its previous state (the Markov assumption), and that only one state actively generates observations (emissions) at any given time point (i.e., states are mutually exclusive). The fitted model parameters include transition probabilities, which define the likelihood of transitioning from any given state to any other state, and emission probabilities, which govern the generation of observable data within each state. Classic frequentist HMMs applied to neural data have used a univariate multinomial distribution for emission probabilities (<xref ref-type="bibr" rid="R10">Bollimunta et al., 2012</xref>; <xref ref-type="bibr" rid="R30">Mazurek et al., 2018</xref>; <xref ref-type="bibr" rid="R16">Diomedi et al., 2021</xref>), encoding which of <italic>N</italic> neurons is spiking in each time bin, and choosing a random neuron if multiple neurons spike in the same bin. Such an approach does not capture the multivariate nature of neural population activity measured with high density recordings, nor the statistical distribution of neural spiking, and breaks down as larger neural populations are recorded from. Previous HMM frameworks which have used multivariate and/or Poisson emission probabilities (<xref ref-type="bibr" rid="R35">Radon, 1994</xref>; Siedemann, 1996; <xref ref-type="bibr" rid="R28">Kemere, 2008</xref>; <xref ref-type="bibr" rid="R50">Xydas, 2011</xref>; <xref ref-type="bibr" rid="R32">Ponce-Alvarez, 2012</xref>), have been single-level, and thus unable to model day-to-day variability in longitudinal neural recordings. We therefore used a multilevel Bayesian hidden Markov model framework (<xref ref-type="bibr" rid="R44">K. E. Shirley et al., 2012</xref>) to mitigate these shortcomings, modeling trial-specific random effects in transition and emission probabilities, multivariate Poisson log-normal emission probability distributions, and trial-specific condition covariates.</p><p id="P10">The adoption of the multilevel framework therefore has a number of advantages over previous non-hierarchical approaches. First, all the information available in the full data set is used for the estimation of each trial-specific parameter, such that parameter estimation on trials consisting of a lower number of observations benefits from trials with more observations (<xref ref-type="bibr" rid="R25">Hox et al., 2018</xref>; <xref ref-type="bibr" rid="R40">Schoot &amp; Miočević, 2020</xref>). As a result, the hierarchical structure of the model produces a regularizing effect on the estimation of trial-specific parameters, making them more robust to outliers (<xref ref-type="bibr" rid="R22">Gelman &amp; Pardoe, 2006</xref>). Second, the inclusion of parametric random effects as part of the hierarchical structure of the model not only offers a vehicle for the allocation of variability between trials, but also avoids the statistical caveats of ignoring the nested structure of the electrophysiological recordings such as the underestimation of standard errors (<xref ref-type="bibr" rid="R2">Aarts et al., 2014</xref>; <xref ref-type="bibr" rid="R25">Hox et al., 2018</xref>; <xref ref-type="bibr" rid="R40">Schoot &amp; Miočević, 2020</xref>). Finally, the multilevel framework provides each trial with individual parameters including an individual trajectory over time, while ensuring that the meaning of each state remains the same across trials. This between-trial state consistency avoids the need for post-hoc state matching between trials, as would be necessary if separate single-level models were fit to data from each day or recording session.</p><p id="P11">In addition, the Bayesian HMM framework has several advantages over previous implementations relying on maximal likelihood estimation and expectation-maximization paradigms. First, it allows for the inclusion of trial-specific random effects in both transition and emission probabilities, which would rapidly become computationally intractable in alternative frameworks as the number of random effects (trials) and model complexity grow (<xref ref-type="bibr" rid="R5">Altman, 2007</xref>; <xref ref-type="bibr" rid="R14">de Haan-Rietdijk et al., 2017</xref>). Second, the Bayesian estimation procedure produces useful byproducts, at no extra computational cost, such as the local decoding of the states (the most likely state at each point in time) and credibility intervals (Bayesian analogue to confidence intervals) on all model parameters, avoiding the necessity for additional computationally intensive steps for estimation of parameter standard errors. Finally, although non-informative priors are most commonly used, adopting (weakly) informative priors allows the possibility of updating the model with new data as it becomes available.</p><sec id="S4"><label>2.1.1</label><title>Model specification of a basic HMM</title><p id="P12">The likelihood <italic>L<sub>T</sub></italic> of a basic hidden Markov model (HMM) consisting of a single time series of observations <italic>o</italic><sub>1:<italic>T</italic></sub> and a first-order Markov chain of <italic>m</italic> hidden states <italic>s</italic><sub>1:<italic>T</italic></sub> can be defined in terms of three basic components <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mspace width="0.2em"/><mml:mi>Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Γ</mml:mi><mml:mi>Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Γ</mml:mi><mml:mi>Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:mi>Γ</mml:mi><mml:mi>Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P13">where <italic>δ</italic> is a vector of dimensions (1 × <italic>M</italic>) with the initial probabilities of the states <italic>s</italic> ∈ {<italic>S</italic><sub>1</sub>, …, <italic>S<sub>m</sub></italic>}, <italic>Γ</italic> is a transition probability matrix of dimensions (<italic>M</italic> × <italic>M</italic>) denoting the transition probabilities <italic>γ<sub>ijt</sub></italic> = <italic>P</italic>(<italic>s<sub>t</sub></italic> = <italic>S<sub>j</sub></italic> | <italic>s</italic><sub><italic>t</italic>−1</sub> = <italic>S<sub>i</sub></italic>) which is assumed to be homogeneous over the occasions <italic>t, Θ</italic> is the emission distribution consisting of a diagonal matrix of dimensions (<italic>M</italic> × <italic>M</italic>) with the <italic>i</italic>th diagonal element denoting the emission probability density <italic>θ<sub>i</sub></italic> = <italic>P</italic>(<italic>o<sub>t</sub></italic> = <italic>O<sub>t</sub></italic> | <italic>s<sub>t</sub></italic> = <italic>S<sub>i</sub></italic>) which can take any arbitrary form, and 1′ is a column vector of <italic>M</italic> elements of value one. In the context of this study, a Poisson emission distribution is assumed for the observed spike counts <italic>o<sub>t</sub></italic>, given the hidden state <italic>s<sub>t</sub></italic>, such that <italic>P</italic>(<italic>o<sub>t</sub></italic> = <italic>O<sub>t</sub></italic> | <italic>s<sub>t</sub></italic> = <italic>S<sub>i</sub></italic>) ≡ <italic>Poisson</italic>(<italic>λ<sub>i</sub></italic>). <italic>λ</italic> is the diagonal matrix of dimensions (<italic>M</italic> × <italic>M</italic>) with its diagonal elements denoting the Poisson parameters (expected spike counts) for the <italic>M</italic> hidden states <italic>S</italic>.</p><p id="P14">Although the model has been defined for a single observed sequence, it can readily be extended to multivariate data with the convenient assumption that the multiple sequences (e.g., observations from multi-electrode probes) are conditionally independent given the hidden states (e.g., <xref ref-type="bibr" rid="R53">Zucchini et al., 2017</xref>). That is, we specify the joint distribution <italic>P</italic>(<italic>o</italic><sub>1<italic>t</italic></sub> = <italic>O</italic><sub>1<italic>t</italic></sub>, <italic>o</italic><sub>2<italic>t</italic></sub> = <italic>O</italic><sub>2<italic>t</italic></sub>,…, <italic>o<sub>kt</sub></italic> = <italic>O<sub>kt</sub></italic>) for the <italic>k</italic> ∈ {1, 2,…, <italic>K</italic>} state-dependent emission distributions as the product of the <italic>K</italic> marginal state-dependent emission probability densities <italic>P</italic>(<italic>o<sub>kt</sub></italic> = <italic>O<sub>kt</sub></italic> | <italic>s<sub>t</sub></italic> = <italic>S<sub>i</sub></italic>): <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p id="P15">As a result, the likelihood of the general multivariate HMM takes the form: <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mi>δ</mml:mi><mml:msub><mml:mi>Θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Γ</mml:mi><mml:msub><mml:mi>Θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Γ</mml:mi><mml:msub><mml:mi>Θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:mi>Γ</mml:mi><mml:msub><mml:mi>Θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P16">A basic HMM of this specification can be easily estimated using direct likelihood maximization (e.g., <xref ref-type="bibr" rid="R53">Zucchini et al., 2017</xref>), following a computationally efficient recursive implementation of the Expectation-Maximization algorithm (<xref ref-type="bibr" rid="R15">Dempster et al., 1977</xref>) known as the Baum-Welch algorithm (<xref ref-type="bibr" rid="R9">Baum et al., 1970</xref>; <xref ref-type="bibr" rid="R53">Zucchini et al., 2017</xref>), or via the Bayesian estimation framework as we do here (e.g., <xref ref-type="bibr" rid="R42">Scott, 2002</xref>).</p></sec><sec id="S5"><label>2.1.2</label><title>Model specification of the Bayesian multilevel HMM</title><p id="P17">In the current implementation of the multilevel HMM, <italic>γ<sub>nij</sub></italic>, the probability for the individual <italic>n</italic> ∈ {1, .., <italic>N</italic>} (normally an individual, but here each trial) of switching between a state <italic>i</italic> and state <italic>j</italic>, at occasion <italic>t</italic>, follows a Multinomial Logit model <disp-formula id="FD4"><label>(4)</label><mml:math id="M4"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p id="P18">Hence, each trials’ probability to transition from hidden state <italic>i</italic> ∈ {1, .., <italic>M</italic>} to state <italic>j</italic> ∈ {1, .., <italic>M</italic>} is modeled using <italic>M</italic> batches of <italic>M</italic> − 1 random intercepts, <italic>α<sub>nij</sub></italic>. That is, <disp-formula id="FD5"><label>(5)</label><mml:math id="M5"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P19">Where the numerator is set equal to 1 for <italic>j</italic> = 1, making the first state of every row of the transition probability matrix <italic>Γ</italic> the baseline category.</p><p id="P20">For the Bayesian implementation we adopt a group-level state-specific multivariate Normal prior distribution on the trial-specific parameters <italic>α<sub>nij</sub></italic>, with mean vector <inline-formula><mml:math id="M6"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of (<italic>M</italic> – 1) elements, and covariance <italic>Ψĳ</italic> –denoting the covariance between the <italic>M</italic> – 1 state <italic>i</italic>-specific intercepts over trials. Thus, in addition to the group-level intercepts <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> we have <italic>M</italic> matrices of <italic>p</italic> * (<italic>M</italic> – 1) fixed regression coefficients, <inline-formula><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>p</italic> denotes the number of used covariates. The columns of <inline-formula><mml:math id="M9"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> are used to model the random intercepts denoting the probability of transitioning from state <italic>i</italic> to state <italic>j</italic> given <italic>p</italic> individual-level covariates.</p><p id="P21">A convenient hyper-prior on the parameters of the group-level prior distribution is a multivariate Normal distribution for the mean vector <inline-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the fixed regression coefficients <inline-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and an Inverse Wishart distribution for the covariance <italic>Ψ<sub>ij</sub></italic>. That is, <disp-formula id="FD6"><label>(6)</label><mml:math id="M12"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> <disp-formula id="FD7"><label>(7)</label><mml:math id="M13"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> <disp-formula id="FD8"><label>(8)</label><mml:math id="M14"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> <disp-formula id="FD9"><label>(9)</label><mml:math id="M15"><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p id="P22">The parameters <italic>m</italic><sub>0<italic>ij</italic></sub>, <italic>m</italic><sub>1<italic>ij</italic></sub>, and <italic>K</italic><sub>0</sub> denote the values of the parameters of the hyper-prior on the group (mean) vector <inline-formula><mml:math id="M16"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="M17"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></inline-formula> respectively. Here, <italic>m</italic><sub>0<italic>ij</italic></sub> and <italic>m</italic><sub>1<italic>ij</italic></sub> represent vectors of means, and <italic>K</italic><sub>0</sub> denotes the number of observations (i.e., the number of hypothetical prior trials) on which <italic>m</italic><sub>0<italic>ij</italic></sub> and <italic>m</italic><sub>1<italic>ij</italic></sub> are based. The parameters <italic>Ψ</italic><sub>0</sub> and <italic>df</italic><sub>0</sub>, respectively, denote values of the covariance and the degrees of freedom of the hyper-prior for the Inverse Wishart distribution on the group variance <italic>Ψ<sub>ij</sub></italic> of the trial-specific random intercepts <italic>α<sub>nij</sub></italic>.</p><p id="P23">Just as for the basic HMM introduced in <xref ref-type="sec" rid="S4">section 2.1.1</xref>, spike count data <italic>o<sub>nkt</sub></italic> follow Poisson emission distributions, but here with trial-specific parameters <italic>λ<sub>nik</sub></italic> conditionally independent on the state <italic>i</italic> ∈ {1, ., <italic>M</italic>}. That is, <disp-formula id="FD10"><label>(10)</label><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P24">for electrode (the dependent variable) <italic>k</italic> ∈ {1, .., <italic>K</italic>}, on time point <italic>t</italic> ∈ {1, .., <italic>T</italic>}, and trial <italic>n</italic> ∈ {1, .., <italic>N</italic>}, given the state <italic>i</italic>.</p><p id="P25">We adopt a group-level state-specific log-Normal prior distribution on the trial-specific parameters <italic>λ<sub>nki</sub></italic>, with mean vector <inline-formula><mml:math id="M19"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <italic>M</italic> elements, and variance <italic>τ<sub>ki</sub></italic>. Note that for the emission distribution no covariates have been used to model the variability between the trial-specific, electrode-specific, state-specific parameters <italic>λ<sub>nki</sub></italic>. The complete specification of the emission distribution adopted is detailed in probabilistic notation below, along with conveniently defined hyper-priors on the parameters of the model <disp-formula id="FD11"><label>(11)</label><mml:math id="M20"><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> <disp-formula id="FD12"><label>(12)</label><mml:math id="M21"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> <disp-formula id="FD13"><label>(13)</label><mml:math id="M22"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>I</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p id="P26">The parameters <italic>m</italic><sub>0<italic>ki</italic></sub> denote the <italic>a priori</italic> expectations on the group-level mean counts on the logarithmic scale, along with the <italic>a priori</italic> expectations on their variability, <italic>τ</italic><sub>0<italic>ki</italic></sub>. Finally, <italic>α<sub>ki</sub></italic>, <italic>b<sub>ki</sub></italic> are the hyper parameters denoting the shape and rate of the hyper prior on the between-individual variance <italic>τ<sub>ki</sub></italic>.</p><p id="P27">Note that using a Normal prior on the log-transformation of the trial-specific, electrode-specific, state-specific Poisson parameters <italic>λ<sub>nki</sub></italic> is equivalent to specifying a log-Normal prior on the untransformed Poisson parameter. In addition, as previously mentioned, because <italic>λ<sub>nki</sub></italic> are assumed to be conditionally independent given the state, no covariance matrix is estimated for the covariance between dependent variables.</p></sec></sec><sec id="S6"><label>2.2</label><title>Reach-to-grasp task</title><p id="P28">Two adult female rhesus macaques (<italic>Macaca mulatta</italic>) trained on a reach and grasp task served as the subjects. The animal handling as well as surgical and experimental procedures complied with European guideline (2010/63/UE) and authorized by the French Ministry for Higher Education and Research (project # 2016112713202878) in force on the care and use of laboratory animals, and were approved by the ethics committee CELYNE (comité d’éthique Lyonnais pour les neurosciences expérimentale, C2EA 42). After initial training, we performed a sterile surgery to implant six floating multielectrode arrays (FMA, Microprobes for Life Science, Gaithersburg, MD, USA) in the right (monkey 1) or left (monkey 2) cortical hemisphere. Each array was comprised of 32 platinum/iridium electrodes (impedance 0.5 MΩ at 1 kHz) with lengths ranging from 1 to 6 mm, and with an inter-electrode spacing of 400 μm. One electrode array was implanted in the primary motor cortex (M1), two were implanted in the ventral premotor cortex (F5), one in the dorsal premotor cortex (F2), and two in the prefrontal cortex (45a and 46/12r), as estimated according to a previous magnetic resonance imaging scan. For the purposes of this study, we analyzed data from the M1 array of each monkey.</p><p id="P29">Throughout the task, the monkey sat in front of a table containing a handle and a semicircular groove. A metallic cube, the target, was placed at 11 cm from the handle, in a slot within a metallic grasping platform which could be placed within the groove (<xref ref-type="fig" rid="F1">Figure 1B</xref>). Contact with the handle, target object, and the bottom of the groove was recorded by a circuit which detected changes in resistance. The task was programmed and controlled by EventIDE software (OkazoLab Ltd). Trials started when the monkey grasped the handle. After a variable delay period (500 - 1000 ms), an auditory go signal (900 Hz tone) instructed the monkey to reach for the target object, grasp it, and place it into the groove beside the grasping platform. The monkey was then rewarded with a few drops of water. Data was recorded from 1 second before the handle grasp until the reward. The task was run in blocks of 10 trials per condition (with the grasping platform placed in the left, right, or center of the groove). The left and right target positions were each 25° from the center of the semicircular groove, relative to the handle. The orientation of the slot in the grasping platform depended on the condition. In the center condition the slot was oriented at 0° with respect to the animal, and in the left and right conditions the slot was oriented at 45° to left and right, respectively. The monkey completed 2-4 blocks of 10 trials per day by condition (monkey 1: left: <italic>M</italic> = 17.1, <italic>SD</italic> = 5.4, center: <italic>M</italic> = 16.7, <italic>SD</italic> = 5.1, right: <italic>M</italic> = 16.7, <italic>SD</italic> = 7.2; monkey 2: left: <italic>M</italic> = 16.0, <italic>SD</italic> = 4.1, center: <italic>M</italic> = 13.1, <italic>SD</italic> = 4.4, right: <italic>M</italic> = 15.2, <italic>SD</italic> = 3.9), for a total of 25-70 trials per day (monkey 1: <italic>M</italic> = 50.5, <italic>SD</italic> = 13.3; monkey 2: <italic>M</italic> = 44.3, <italic>SD</italic> = 11.9). Any trial in which the handle was released before the go signal or the grasping movement was not properly executed within 3 seconds was aborted and not rewarded. Each monkey used the hand contralateral to the implanted array to perform the task (monkey 1: left hand, monkey 2: right hand).</p></sec><sec id="S7"><label>2.3</label><title>Neural recordings</title><p id="P30">The wideband neural signal (bandpass filtered at 0.1 to 7500 kHz) was recorded at 30 kS/s, and amplified and digitized (16-bit; 0.192 μV resolution) with an Intan Tech-based (Intan Technologies, Los Angeles, CA, USA) open source acquisition system (Open Ephys; Siegle et al. 2017). This system uses a 256-channel Intan RHD2000 series acquisition board and 32-channel headstages (RHD2132). Spike detection was performed offline using Trisdesclous (Garcia &amp; Pouzat,2015). The common reference was removed to reduce ambient noise. Spikes were then detected from each electrode using a threshold of 2 times the median absolute deviation (MAD), and analyzed as multi-unit activity (MUA) in 10 ms bins. All electrodes in which at least one well-isolated spike waveform was detected were selected for the following analyses. We thus used a sample of 21 electrodes out of 32 for monkey 1, and 25 out of 32 electrodes for monkey 2. Custom made detection panels were used to record the moments when the monkey’s hand released the handle, the hand contacted the target object, and when the object was placed in the groove. An Omniplex 16-channel recording system (Plexon, Dallas, TX, USA) was used to simultaneously record these behavioral events. Trials were discarded if the response time (time between the go signal and handle release) was less than 100 or greater than 1500 ms, the reach duration (time between handle release and object contact) was less than 100 or greater than 1000 ms, or the placing duration (time between object contact and placing the object in the groove) was less than 100 or greater than 1200 ms, leaving 19 - 68 trials per day for monkey 1 (<italic>M</italic> = 43.9, <italic>SD</italic> = 15.46, <italic>N</italic> = 439; left: <italic>M</italic> = 14.8, <italic>SD</italic> = 5.74; center: <italic>M</italic> = 14.4, <italic>SD</italic> = 5.15; right: <italic>M</italic> = 14.7, <italic>SD</italic> = 7.73), and 23 - 49 per day for monkey 2 (<italic>M</italic> = 38.3, <italic>SD</italic> = 9.87, <italic>N</italic> = 383; left: <italic>M</italic> = 14.2, <italic>SD</italic> = 3.91; center: <italic>M</italic> = 10.8, <italic>SD</italic> = 3.55; right: <italic>M</italic> = 13.3, <italic>SD</italic> = 3.37).</p></sec><sec id="S8"><label>2.4</label><title>Model training</title><p id="P31">Model training was performed using R (<xref ref-type="bibr" rid="R33">R Core Team, 2021</xref>) and the developer version of the package <italic>mHMMbayes</italic> (<xref ref-type="bibr" rid="R1">Aarts, 2019</xref>). In <italic>mHMMbayes</italic>, models are fitted using a hybrid Metropolis within Gibbs MCMC algorithm, which expands on classic HMM implementations by using Bayesian estimation as outlined in <xref ref-type="bibr" rid="R42">Scott (2002)</xref>. Estimation results from a conventional expectation-maximization HMM trained on aggregated spike count data were used as starting values for the MCMC chain (depmixS4; <xref ref-type="bibr" rid="R48">Visser &amp; Speekenbrink, 2010</xref>). The Bayesian multilevel HMM was fit to binned (10 ms bin width) spike counts from each electrode used with trial-specific intercepts, and covariates encoding each trial’s condition. The model was fit with 4000 iterations, with the first 2000 being discarded to dissipate the effect of starting conditions (burn-in). In fitting the model, agnostic non-informative hyper-priors were specified for all group-level parameters. Convergence of all sample-level parameters was checked by verifying that the multivariate potential scale reduction factor, <italic>Ȓ</italic>, was lower than a threshold of 1.05 (<xref ref-type="bibr" rid="R11">Brooks &amp; Gelman, 1998</xref>) for two additional chains with randomized starting values. The sequence of most likely states given the neural data, along with each state’s forward probabilities were determined for each trial with the Viterbi algorithm (<xref ref-type="bibr" rid="R17">Forney, 1973</xref>; <xref ref-type="bibr" rid="R49">Viterbi, 1967</xref>) based on trial-specific parameters.</p><p id="P32">Model selection was performed by comparing relative model fit using AIC (<xref ref-type="bibr" rid="R4">Akaike, 1974</xref>) and BIC (<xref ref-type="bibr" rid="R41">Schwarz, 1978</xref>). The ability of the selected model to reproduce the original multielectrode data was determined using Bayesian posterior predictive checks (PPCs; for more details see: <xref ref-type="bibr" rid="R23">Gelman &amp; Shalizi, 2013</xref>; <xref ref-type="bibr" rid="R31">McElreath, 2020</xref>). For the PPCs, the fitted model was used to simulate 500 new data sets, after which we assessed the extent to which a set of summary statistics (mean, standard deviation, maximum counts, and proportion of zeros) on all electrodes (21 for monkey 1 and 25 for monkey 2) at the aggregated sample-level in the simulated data recovered the values empirically observed in the electrophysiological data.</p><p id="P33">The upper bound for the decoding accuracy of the neural states identified by the multilevel HMM was assessed with a small Monte Carlo simulation. The fitted model was used to simulate 100 new data sets with the same number of trials and observations per trial as the empirical data used to fit the model. The simulated data sets were then used to fit new multilevel HMMs, after which the accuracy of state decoding was evaluated.</p></sec><sec id="S9"><label>2.5</label><title>Neural and behavioral data analysis</title><p id="P34">To compare state onset and offset times to behavioral event timings, we identified episodes lasting at least 100 ms in each trial where a particular state was identified as the most likely using the Viterbi algorithm. If a state was activated multiple times in a trial, we used the first activation. The partial Spearman’s correlation coefficient was used to relate state onset and offset times to each behavioral event time (movement onset, object contact, and placing), accounting for correlations between other event timings and the onset or offset of all other states. Statistical significance was tested using permutation tests (10,000 permutations) in which the event timings, but not the state onset and offset times, were shuffled in each iteration.</p><p id="P35">Response time (the time between the go and movement onset events), reach duration (time between the movement onset and object contact events), and placing duration (time between the object contact and placing events) were computed for each trial and compared between conditions using linear mixed models with condition (left, center, right) as a fixed effect and day-specific offsets as a random effect. The number of state activations per trial was given by the number of episodes where a state was identified as the most likely for at least 100 ms. To compute state lifetime, the first activation was used if a state was activated multiple times in a trial, as above. State activations and lifetime were compared across states and conditions using generalized linear mixed models (with Poisson distribution and log link function for activations, and Normal distribution and identity link function for lifetime) with condition, state, and their interaction as fixed effects, and trial nested within day offsets as random effects. The relationship between response time, reach duration, and placing duration and the number of activations and lifetime of each state was evaluated using partial Spearman correlation coefficients, accounting for all other behavioral durations and state activations or lifetimes.</p><p id="P36">Multi-unit firing rate activity around state transitions was compared by aligning firing rates to the onset and offset of the maximum duration activation of each state around a time window lasting from 100 ms prior to the onset to half of the mean state lifetime after onset, and from half the mean state lifetime prior to offset to 100 ms after offset. The firing rate from each electrode was then baseline-corrected using the mean firing rate in the 100 ms prior to the state onset. For each electrode, we compared the mean, baseline-corrected firing rate in the 100 ms prior to state onset to that in the first half of the state lifetime using linear mixed models with state, time period (baseline or first half of lifetime), and their interactions as fixed effects, and trial nested within day offsets as random effects. In the same way, we compared the mean, baseline-corrected firing rate in the first half of the state lifetime to that in the second half.</p><p id="P37">Temporal and spatial shuffling was performed by permuting the data either by time point or by electrode, 100 times. The resulting permuted data was run through the HMM to obtain forward probabilities and sequences of the most likely state. For each iteration, the partial Spearman coefficient between state onsets and offsets and the behavioral events (accounting for correlations between other event timings and the onset or offset of all other states, as above) was evaluated, and the resulting coefficients were used as the null distribution for comparison with the corresponding unshuffled coefficients.</p><p id="P38">All mixed models were run in R (<xref ref-type="bibr" rid="R33">R Core Team, 2021</xref>) using <italic>lme4</italic> (v1.1.26; <xref ref-type="bibr" rid="R8">Bates et al., 2018</xref>). Factor significance was determined using type II Wald X<sup>2</sup> tests using the <italic>car</italic> package (v3.0.10; <xref ref-type="bibr" rid="R18">Fox et al., 2019</xref>), and pairwise Tukey-corrected follow-up tests were performed using estimated marginal means using the <italic>emmeans</italic> package (v1.5.3; <xref ref-type="bibr" rid="R29">Lenth et al., 2020</xref>) with Kenward-Roger approximated degrees of freedom. Code for all analyses is freely available (<ext-link ext-link-type="uri" xlink:href="https://github.com/danclab/motor_mea_mbhmm">https://github.com/danclab/motor_mea_mbhmm)</ext-link>.</p></sec></sec><sec id="S10" sec-type="results"><label>3</label><title>Results</title><p id="P39">Multiple multilevel Bayesian HMMs with 3 to 8 states were fit to single-trial multi-unit spiking activity (<xref ref-type="fig" rid="F2">Figure 2A</xref>) recorded from the primary motor cortex of two macaque monkeys during a reach-grasp task. Model comparison (AIC and BIC) was used to select the optimal model, yielding a model with 6 states for monkey 1, and 5 states for monkey 2 (<xref ref-type="supplementary-material" rid="SD1">Figure S1</xref>). All group-level parameters in the optimal models met the convergence criterion.</p><sec id="S11"><label>3.1</label><title>Simulations</title><p id="P40">We started by evaluating the goodness of fit of the optimal models selected for the two monkeys with posterior predictive checks. The results of the posterior predictive checks (PPCs) show that the models were able to recover the overall patterns of electrical activity aggregated over trials for the 21 and 25 electrodes of the first (<xref ref-type="supplementary-material" rid="SD1">Figure S2</xref>) and second monkey (<xref ref-type="supplementary-material" rid="SD1">Figure S3</xref>), respectively, which indicates a good fit to the empirical data. In addition, for some of the electrodes, the PPCs reveal a small overestimation of the mean aggregated counts, coupled with a small underestimation of the proportion of bins with zero spike counts (e.g., monkey 1 electrodes 6, 10, and 21; <xref ref-type="supplementary-material" rid="SD1">Figure S2</xref>) which are consistent with a zero-inflated generative process. These minor deviations from good fit appear to be more pronounced for the data of the second monkey than for the first monkey.</p><p id="P41">Next, we explored the expected state decoding accuracy with a Monte Carlo simulation based on the modeling results for the optimal models on the two monkeys. The mean percent balanced accuracy averaged over trials and simulation repetitions of 91.6% (95%CI [91.3-92.0%]) for monkey 1 and 87.5% (95%CI [86.3-88.7%]) for monkey 2 (see <xref ref-type="supplementary-material" rid="SD1">Table S1</xref> for extended performance metrics). The mean balanced accuracy varied across states, ranging from 73.0% for state 2 to 96.6% for state 1 in monkey 1 and from 60.8% for state 2 to 98.6% for state 3 in monkey 2 (<xref ref-type="supplementary-material" rid="SD1">Table S2</xref>). Given the good fit to the data (<xref ref-type="supplementary-material" rid="SD1">Figures S2 and S3</xref>), these results indicate that a high level of decoding accuracy can be expected for the empirical data.</p></sec><sec id="S12"><label>3.2</label><title>Distinct M1 population activity states occur during different phases of the reach-to-grasp task</title><p id="P42">For each state, the model generates a forward probability, representing the probability at each point in time that the neural population is in that state given the MUA (<xref ref-type="fig" rid="F2">Figure 2B</xref>). States were labeled in order of their trial-averaged order of occurrence. Trials had different durations due to variability in response time and movement kinematics, so in order to determine the task phase specificity of each state, we aligned both multi-unit firing rates and each state's forward probability with each behavioral event (go signal, hand movement onset, object contact, and placing), and averaged over trials. The event-aligned multi-unit mean firing rate exhibited slow ramping dynamics prior to the movement onset, and peaking just before object contact (monkey 1: <xref ref-type="fig" rid="F2">Figure 2C</xref>; monkey 2: <xref ref-type="supplementary-material" rid="SD1">Figure S4A</xref>). In contrast, the mean forward probabilities of each HMM state indicate that discrete state transitions tended to occur around the same time as the movement onset, object contact, and object placing behavioral events (<xref ref-type="fig" rid="F2">Figure 2D</xref>). At the start of each trial, state 1 predominated, but sometime following the go signal, there was a transition to state 2, followed by a transition to state 3 after the hand movement onset. During the initial reach, there was a transition to state 4, and then to state 5 after the hand contacted the object. Finally, during the final reaching movement to place the object in the groove, there was a transition to state 6. This sequence of state transitions was similar for the 5 states identified from monkey 2 (<xref ref-type="supplementary-material" rid="SD1">Figure S4B</xref>). Importantly, behavioral event timings were not provided to the HMM during training, it was simply fit to the multi-unit spiking activity recorded during each trial. This suggests that the identified states represent actual states of the neural population corresponding to different processes involved in motor control, rather than trivially reflecting the temporal structure of the task.</p><p id="P43">Although it appears that state transitions occur in specific relation to behavioral events, this could have been a result of trial averaging. We therefore examined the temporal relationship between state transitions and behavioral events at the single trial level. In each trial, increases and decreases in state forward probabilities closely matched the timing of the movement onset, object contact, and placing events (monkey 1: <xref ref-type="fig" rid="F3">Figure 3</xref>; monkey 2: <xref ref-type="supplementary-material" rid="SD1">Figure S4C</xref>). In each trial, there was a transition from state 1 to state 2 occurring before the hand movement onset, from state 2 to 3 closely locked to the hand movement onset, from 3 to 4 between the hand movement onset and object contact, from 4 to 5 locked to object contact, and from 5 to 6 between object contact and the placing event. We next used the Viterbi algorithm (<xref ref-type="bibr" rid="R17">Forney 1973</xref>; <xref ref-type="bibr" rid="R49">Viterbi 1967</xref>) to estimate the most likely state at each point in time, for every trial, from the forward probabilities. We used the sequence of most likely states to determine the onset and offset times of each state in every trial. We then ran a permutation test on the partial Spearman’s correlation coefficient (accounting for correlations between event timings and the onsets and offsets of other states) between the onset and offset time of each state and the timing of each behavioral event. This revealed that for monkey 1, the onset <italic>(ρ</italic> = 0.73, <italic>p</italic> &lt; 0.001) and offset (<italic>ρ</italic> = 0.64, <italic>p</italic> &lt; 0.001) of state 2 were most correlated with the movement onset time. Only the onset of state 3 (<italic>ρ</italic> = 0.46, <italic>p</italic> = 0.003), the offset of state 4 (<italic>ρ</italic> = 0.56, <italic>p</italic> &lt; 0.001), and the onset of state 5 (<italic>ρ</italic> = 0.46, <italic>p</italic> = 0.005) were correlated with the object contact event. The offset of state 5 (<italic>ρ</italic> = 0.26, <italic>p</italic> = 0.037) and the onset of state 6 (<italic>ρ</italic> = 0.32, <italic>p</italic> = 0.005) were the transitions most correlated with the placing event. For monkey 2, the onset (<italic>ρ</italic> = 0.33, <italic>p</italic> &lt; 0.001) and offset (<italic>ρ</italic> = 0.32, <italic>p</italic> &lt; 0.001) of state 2 was were correlated with movement onset time, the onset of state 3 (<italic>ρ</italic> = 0.15, <italic>p</italic> = 0.042) and the onset (<italic>ρ</italic> = 0.24, <italic>p</italic> = 0.001) and offset (<italic>ρ</italic> = 0.30, <italic>p</italic> &lt; 0.001) of state 4 were correlated with object contact, and the onset (<italic>ρ</italic> = 0.35, <italic>p</italic> &lt; 0.001) and offset (<italic>ρ</italic> = 0.38, <italic>p</italic> &lt; 0.001) of state 4 and the onset of state 5 (<italic>ρ</italic> = 0.15, <italic>p</italic> = 0.046) with the placing event. We then evaluated these correlations over the duration of the recordings, in groups of two days to ensure a large enough number of trials for each correlation. In both monkeys, these correlations were sustained over 10 days of recording (all <italic>p</italic> &lt; 0.02; <xref ref-type="fig" rid="F4">Figure 4</xref>). The onset and offset of various states was therefore tightly linked to the movement onset, object contact, and placing events at the single trial level, with earlier occurring states tending to be related to movement onset, states in the middle of the trial related to object contact, and states occurring later related to the placing event. Moreover, this linkage between states and behavioral events was stable over the entire period of recording.</p></sec><sec id="S13"><label>3.3</label><title>M1 population state dynamics are related to behavioral state durations</title><p id="P44">We next compared response time (the time between the go signal and the hand movement onset events), reach duration (the time between the hand movement onset and object contact events), placing duration (the time between the object contact and placing events), and state dynamics between task conditions. States were characterized by their number of activations per trial and their lifetime (the time that state remains active, taken for each trial as the maximum duration over all activations in that trial).</p><p id="P45">There was no difference in response time between conditions (monkey 1: <italic>X</italic><sup>2</sup>(2) = 0.66, <italic>p</italic> = 0.717; monkey 2: <italic>X</italic><sup>2</sup>(2) = 4.37, <italic>p</italic> = 0.113), but conditions varied in terms of reach duration (monkey 1: <italic>X</italic><sup>2</sup>(2) = 78.68, <italic>p</italic> &lt; 0.001; monkey 2: <italic>X</italic><sup>2</sup>(2) = 9.09, <italic>p</italic> = 0.011; <xref ref-type="supplementary-material" rid="SD1">Figure S5</xref>). For monkey 1, reach durations to the left target location (<italic>M</italic> = 408, <italic>SE</italic> = 8.40 ms) were longer than to the right (<italic>M</italic> = 343, <italic>SE</italic> = 8.58 ms, <italic>t</italic>(430) = 5.83, <italic>p</italic> &lt; 0.001) and center (<italic>M</italic> = 312, <italic>SE</italic> = 8.48 ms, <italic>t</italic>(432) = -8.67, <italic>p</italic> &lt; 0.001), and longer to the right compared to the center target location (<italic>t</italic>(436) = -2.79, <italic>p</italic> = 0.015). For monkey 2, reach durations to the left target (<italic>M</italic> = 230, <italic>SE</italic> = 13.2 ms) were shorter than to the right (<italic>M</italic> = 264, <italic>SE</italic> = 13.3, <italic>t</italic>(372) = -3.01, <italic>p</italic> = 0.008). Placing duration was only different for monkey 1 (<italic>X</italic><sup>2</sup>(2) = 30.18, <italic>p</italic> &lt; 0.001), and longer in the left (<italic>M</italic> = 641, <italic>SE</italic> = 15.7 ms) compared to the right (<italic>M</italic> = 582, <italic>SE</italic> = 15.8 ms, <italic>t</italic>(436) = 3.41, <italic>p</italic> = 0.002) and center (<italic>M</italic> = 548, <italic>SE</italic> = 15.8 ms, <italic>t</italic>(430) = -5.43, <italic>p</italic> &lt; 0.001) conditions, but there was no difference between placing duration for the center and right conditions (<italic>t</italic>(433) = -1.96, <italic>p</italic> = 0.123).</p><p id="P46">The number of state activations per trial and their lifetime varied by state and condition in monkey 1 (activations: <italic>X</italic><sup>2</sup>(10) = 95.94, <italic>p</italic> &lt; 0.001; <xref ref-type="fig" rid="F5">Figure 5</xref>; lifetime: <italic>X</italic><sup>2</sup>(10) = 66.00, <italic>p</italic> &lt; 0.001; <xref ref-type="fig" rid="F6">Figure 6</xref>). State 1 had a shorter lifetime in the center (<italic>M</italic> = 533.5, <italic>SE</italic> = 11.4 ms) compared to the left (<italic>M</italic> = 635.5, <italic>SE</italic> = 11.2 ms, <italic>t</italic>(2616) = -6.39, <italic>p</italic> &lt; 0.001) and right (<italic>M</italic> = 626.9, <italic>SE</italic> = 11.2 ms, <italic>t</italic>(2616) = - 5.84, <italic>p</italic> &lt; 0.001) conditions. State 3 was activated more times the left condition (<italic>M</italic> = 0.67, <italic>SE</italic> = 0.06) than in the center (<italic>M</italic> = 0.36, <italic>SE</italic> = 0.07, <italic>z</italic> = -3.37, <italic>p</italic> = 0.002) and right (<italic>M</italic> = 0.39, <italic>SE</italic> = 0.07, <italic>z</italic> = 3.12, <italic>p</italic> = 0.005) conditions. State 4 had longer duration in the left condition (<italic>M</italic> = 160.2, <italic>SE</italic> = 11.2 ms) than in the center (<italic>M</italic> = 97.7, <italic>SE</italic> = 11.4 ms, <italic>t</italic>(2616) = -3.92, <italic>p</italic> &lt; 0.001) and right (<italic>M</italic> = 114.4, <italic>SE</italic> = 11.2, <italic>t</italic>(2616) = 2.89, <italic>p</italic> = 0.011) conditions. In contrast, state 5 was activated fewer times in the left condition (<italic>M</italic> = 0.11, <italic>SE</italic> = 0.08) than the center (<italic>M</italic> = 0.61, <italic>SE</italic> = 0.06, <italic>z</italic> = 5.10, <italic>p</italic> &lt; 0.001) and right (<italic>M</italic> = 0.68, <italic>SE</italic> = 0.06, <italic>z</italic> = -5.81, <italic>p</italic> &lt; 0.001) conditions. State 6 was also activated more times and had longer lifetime in the left condition (activations: M = 0.77, SE = 0.06; lifetime: M = 114.8, SE = 11.2 ms) than the center (activations: M = 0.26, SE = 0.07, z = -5.59, p &lt; 0.001, lifetime: M = 43.1, SE = 11.4 ms, t(2616) = -4.50, p &lt; 0.001) and right (activations: M = 0.30, SE = 0.07, z = 5.23, p &lt; 0.001; lifetime: M = 67.7, SE = 11.2 ms, t(2616) = 2.97, p = 0.008) conditions. The dynamics of state 2 did not vary by condition. In monkey 2, there was only a main effect of state on the number of state activations per trial and their lifetime, however, there was almost no difference between conditions in response time, reach duration, and placing duration for this monkey.</p><p id="P47">Finally, we looked at relationships between state dynamics and response time, reach duration, and placing duration. For monkey 1, response time was correlated with the number of activations (<italic>ρ</italic> = 0.11, <italic>p</italic> = 0.03) and lifetime (<italic>ρ</italic> = 0.46, <italic>p</italic> = 0.005) of state 1. Reach duration was correlated with the number of activations of states 3 (<italic>ρ</italic> = 0.15, <italic>p</italic> = 0.002), 4 (<italic>ρ</italic> = 0.23, <italic>p</italic> &lt; 0.001), and 6 (<italic>ρ</italic> = 0.17, <italic>p</italic> = 0.001). Placing duration was correlated with the number of activations of states 1 (<italic>ρ</italic> = 0.17, <italic>p</italic> = 0.001) and 4 (activations: <italic>ρ</italic> = 0.11, p = 0.018), as well as the number of activations and lifetime of state 6 (activations: <italic>ρ</italic> = 0.34, <italic>p</italic> &lt; 0.001; lifetime: <italic>ρ</italic> = 0.39, <italic>p</italic> = 0.020). For monkey 2, response time was correlated with the number of activations (<italic>ρ</italic> = 0.34, <italic>p</italic> &lt; 0.001) and lifetime (<italic>ρ</italic> = 0.22, <italic>p</italic> = 0.005) of state 1, and the number of activations of state 2 (<italic>ρ</italic> = 0.17, <italic>p</italic> &lt; 0.001). Reach duration was correlated with the number of activations of states 2 (<italic>ρ</italic> = 0.23, <italic>p</italic> &lt; 0.001), 3 (<italic>ρ</italic> = 0.25, <italic>p</italic> &lt; 0.001), and 5 (<italic>ρ</italic> = 0.22, <italic>p</italic> &lt; 0.001), and the number of activations and lifetime of state 4 (activations: <italic>ρ</italic> = 0.20, <italic>p</italic> &lt; 0.001; lifetime: <italic>ρ</italic> = 0.22, <italic>p</italic> = 0.003). Placing duration was correlated with the number of activations of state 2 (<italic>ρ</italic> = 0.22, <italic>p</italic> &lt; 0.001), the lifetime of state 4 (<italic>ρ</italic> = 0.22, <italic>p</italic> = 0.003), and the number of activations and lifetimes of states 3 (activations: <italic>ρ</italic> = 0.30, <italic>p</italic> &lt; 0.001; lifetime: <italic>ρ</italic> = 0.15, <italic>p</italic> = 0.036), and 5 (activations: <italic>ρ</italic> = 0.37, <italic>p</italic> &lt; 0.001; lifetime: <italic>ρ</italic> = 0.18, <italic>p</italic> = 0.015). The number of activations and lifetime of identified states was therefore related to response time, reach duration, and placing duration in a state-specific way, with earlier occurring states related to response time, states occurring in the middle of the trial to reach duration, and states occurring later to placing duration.</p></sec><sec id="S14"><label>3.4</label><title>States represent distinct spatiotemporal patterns of neural population activity</title><p id="P48">Having determined that the timing, number of activations, and lifetime of the HMM-identified states are tightly coupled to the behavioral phases of reaching, grasping, and placing an object, we next examined neural dynamics associated with state transitions and occurring within states. We aligned multi-unit firing rates to the onset and offset times of each state in every trial, and baseline-corrected them using activity from the 100 ms prior to the state onset (monkey 1: <xref ref-type="fig" rid="F7">Figure 7</xref>; monkey 2: <xref ref-type="supplementary-material" rid="SD1">Figure S6</xref>). State transitions tended to be associated by rapid changes in firing rates, followed by state-specific patterns of activity. For each electrode, we compared the effect of state on the multi-unit firing rate in the 100 ms prior to state onset to that in the first half of the state duration, and the multi-unit firing rate in the last half of the state duration with that in the 100 ms following the state offset. For monkey 1, all electrodes had a significant interaction between state and time period, and follow-up comparisons showed that states differed in the number of electrodes in which multi-unit firing changed with the onset (state 1: <italic>N</italic> = 0, state 2: <italic>N</italic> = 14, state 3: <italic>N</italic> = 18, state 4: <italic>N</italic> = 19, state 5: <italic>N</italic> = 19, state 6: <italic>N</italic> = 16) and offset (state 1: <italic>N</italic> = 16, state 2: <italic>N</italic> = 20, state 3: <italic>N</italic> = 15, state 4: <italic>N</italic> = 19, state 5: <italic>N</italic> = 14, state 6: <italic>N</italic> = 18) of the state. The same was true for monkey 2 for all electrodes for both state onset (state 1: <italic>N</italic> = 0, state 2: <italic>N</italic> = 18, state 3: <italic>N</italic> = 24, state 4: <italic>N</italic> = 15, state 5: <italic>N</italic> = 20) and offset (state 1: <italic>N</italic> = 20, state 2: <italic>N</italic> = 19, state 3: <italic>N</italic> = 21, state 4: <italic>N</italic> = 21, state 5: <italic>N</italic> = 12). In order to determine if activity within each state represented dynamic or sustained patterns of activity, we similarly compared the effect of state on firing rate in the first half of the state duration to that in the second half. A significant interaction between state and time period was found in 19 out the 21 electrodes for monkey 1, with the fewest number of electrodes exhibiting within-state dynamic activity in state 1 and the greatest number in state 4 (state 1: <italic>N</italic> = 0, state 2: <italic>N</italic> = 5, state 3: <italic>N</italic> = 9, state 4: <italic>N</italic> = 19, state 5: <italic>N</italic> = 9, state 6: <italic>N</italic> = 6). For monkey 2, there was a significant state by time period interaction in 24 out of the 25 electrodes, with the least within-state dynamics in state 1 and the most in state 5 (state 1: <italic>N</italic> = 5, state 2: <italic>N</italic> = 15, state 3: <italic>N</italic> = 14, state 4: <italic>N</italic> = 16, state 5: <italic>N</italic> = 14). In both monkeys, state 1 therefore represents a static period of low activity in all electrodes, but each other state represents a transition to a specific combination of sustained and dynamic activity across electrodes.</p><p id="P49">We then evaluated the spatiotemporal specificity of these activity patterns by shuffling the data, either temporally (i.e. shuffling time points; <xref ref-type="supplementary-material" rid="SD1">Figure S7</xref>) or spatially (i.e. shuffling electrodes; <xref ref-type="supplementary-material" rid="SD1">Figure S8</xref>) and using the HMM to obtain forward probabilities and sequences of the most likely state. For monkey 1, both temporal and spatial shuffling abolished the relationships between the movement onset time and the onset (temporal shuffled <italic>ρ</italic> = 0.14; compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>ρ</italic> = 0.08; compared to unshuffled: <italic>p</italic> = 0.01) and offset (temporal shuffled ρ = 0.09; compared to unshuffled: p = 0.01; spatial shuffled ρ = 0.04; compared to unshuffled: p = 0.01) of state 2. The correlations between the object contact event and the onset of state 3 (temporal shuffled <italic>ρ</italic> = -0.02, compared to unshuffled: <italic>p</italic> = 0.02; spatial shuffled <italic>ρ</italic> = 0.10, compared to unshuffled: <italic>p</italic> = 0.02) and the onset of state 5 (temporal shuffled <italic>ρ</italic> = 0.10, compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>ρ</italic> = 0.13, compared to unshuffled: <italic>p</italic> = 0.01) were also destroyed by temporal and spatial shuffling. Only spatial shuffling had an effect on the correlation between the placing event and the onset of state 6 (spatial shuffled <italic>ρ</italic> = -0.08, compared to unshuffled: <italic>p</italic> = 0.02), and only temporal shuffling disrupted the relationship between object contact and the offset of state 4 (<italic>ρ</italic> = -0.02, <italic>p</italic> = 0.01). For monkey 2, both temporal and spatial shuffling abolished the relationships between the movement onset time and the onset (temporal shuffled <italic>p</italic> = -0.05; compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>p</italic> = 0.06; compared to unshuffled: <italic>p</italic> = 0.01) and offset (temporal shuffled <italic>ρ</italic> = -0.05; compared to unshuffled: p = 0.01; spatial shuffled <italic>p</italic> = 0.04; compared to unshuffled: p = 0.01) of state 2. The correlations between the object contact event and the onset of state 3 were not destroyed by either temporal or spatial shuffling, but those between object contact and the onset (temporal shuffled <italic>p</italic> = -0.03, compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>p</italic> = 0.10, compared to unshuffled: <italic>p</italic> = 0.02) and offset (temporal shuffled <italic>p</italic> = -0.02, compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>ρ</italic> = 0.06, compared to unshuffled: <italic>p</italic> = 0.01) of state 4 were affected by both forms of shuffling. Both temporal and spatial shuffling had an effect on the correlation between the placing event and the offset of state 4 (temporal shuffled <italic>ρ</italic> = -0.03, compared to unshuffled: <italic>p</italic> = 0.01; spatial shuffled <italic>p</italic> = 0.04, compared to unshuffled: <italic>p</italic> = 0.01), but neither had an effect on that between the placing event and the onset of state 5. The states identified by the HMM therefore represent rapid transitions between distinct spatiotemporal patterns of neural population activity which are generated during specific phases of the reach, grasp, and place task.</p></sec></sec><sec id="S15" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P50">In this paper we present a new multilevel Bayesian HMM, designed for analyzing longitudinal neural recordings from chronic multi-electrode arrays through the use of trial-specific random effects in transition and emission probabilities, multivariate Poisson log-normal emission probability distributions, and trial-specific condition covariates. We trained instantiations of the model on long term data recorded from the primary motor cortex of the macaque monkey during a task involving reaching, grasping, and placing a target object. We showed that although the model was not trained with any information about the task structure, the timing of discrete state transitions was tightly linked to behavioral events (i.e. the timing of the movement onset, object contact, and placing events), and state dynamics were closely aligned with the duration of intervals between events (i.e. response time, reach duration, placing duration). The states identified by the HMM represented fast transitions between distinct spatiotemporal patterns of neural population activity which are generated during specific phases of the reach, grasp, and place task, likely corresponding to different motor control processes.</p><p id="P51">At the single trial level, various states were coupled to different phases of the task. In both monkeys, state 1 represented a static period of low activity across all electrodes, and the go signal event did not elicit any state transition. However, sometime after the go signal, there was a transition to state 2, whose onset and offset correlated with movement onset time. State 2 therefore likely represents movement preparation or initiation mechanisms. States 3, 4, and 5 in monkey 1 and states 3 and 4 in monkey 2 were correlated with the object contact, the reach duration, and the placing duration and therefore may be differentially involved in the acceleration and deceleration phases of reaching (<xref ref-type="bibr" rid="R27">Kadmon Harpaz et al., 2019</xref>), or the coordination of the wrist orientation. State 6 is activated before, and aligned to, the placing event, and therefore likely reflects control of a reaching movement in the opposite direction from the initial reach-to-grasp (<xref ref-type="bibr" rid="R27">Kadmon Harpaz et al., 2019</xref>). The model was trained solely on the multi-unit spike data from each trial without any event timing information, and yet state transitions and lifetimes were tightly linked to kinematic events and movement durations, suggesting that each state represents distinct motor control mechanisms.</p><p id="P52">There are a few limitations to this framework which include the basic assumptions of HMMs, longitudinal generalizability for predictive decoding, task conditions, zero-inflation, and the use of multi-unit, rather than single-unit, activity. All HMMs make the assumption that only one state can be active at any given time, and that state transition probabilities only depend on the current state rather than the recent history of states (the Markov assumption). These may not be reasonable assumptions for neural population activity, and there have been recent efforts to develop a similar framework without, or with relaxed versions of, these assumptions (<xref ref-type="bibr" rid="R24">Gohil et al., 2022</xref>). A promising future direction might be to extend the benefits of multilevel Bayesian HMMs to such frameworks, for example by implementing an explicit-duration hidden semi-Markov model that relaxes the Markov assumption, decoupling the state duration from the transition probabilities by explicitly assigning distributions to the duration of the states (<xref ref-type="bibr" rid="R51">Yu, 2010</xref>). One advantage of the multilevel approach is the ability to model between-trial differences in activity that might undermine attempts to identify the population state. However, as would also be the case for single level models, new trials would have to use group-level mean model parameters. One possibility for future work might be to take advantage of the trial-specific parameters in the multilevel model and extrapolate them for decoding future activity. The task used involves only three reach directions and one grasp type. This was a necessary restriction for the current study to establish and test the framework, but future applications should use a wider range of reach and grasp movements along with kinematic tracking in order to identify the specific motor control mechanisms represented by each state. Model checking with PPCs revealed a minor underestimation of the proportion of zeros in the spike count data, consistent with a zero-inflated generative process. Future versions of the model could be extended with a zero-inflated Poisson emission distribution to model the excess of zeros beyond what a common random-effect Poisson distribution can accommodate (<xref ref-type="bibr" rid="R3">Aguero-Valverde, 2013</xref>). Finally, we trained the model on multi-unit spiking data, due to the inherent difficulty in tracking single units over long-term recordings. However, this is also a strength of this approach, as multi-unit activity has been shown to be sufficient to capture neural population dynamics (<xref ref-type="bibr" rid="R46">Trautmann et al., 2019</xref>), and therefore circumvents the need for longitudinal spike sorting.</p></sec><sec id="S16" sec-type="conclusions"><label>5</label><title>Conclusion</title><p id="P53">The multilevel Bayesian HMM presented here has several unique advantages for analyzing longitudinal neural population dynamics from multi-electrode arrays compared to current approaches. The emission probabilities are multivariate Poisson distributions, capturing the statistical distribution of neuronal spikes. The model is trained trial-by-trial, without the need for epochs of the same length, making it applicable to motor tasks which typically have variable trial duration due to movement variability. The inclusion of covariates allows the model to be fit on data from multiple experimental conditions and therefore simplifies comparison between them. In this study, each monkey was pre-trained on the reaching, grasping, and placing task, but because the multilevel Bayesian framework easily handles longitudinal data, it is especially well suited for studies of longer term neural population plasticity in the context of motor learning.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary material</label><media xlink:href="EMS156220-supplement-Supplementary_material.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S17"><title>Acknowledgements</title><p>We acknowledge funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (ERC-CoG 864550 to JB), and the National Institutes of Health (NICHD P01HD064653 to PFF). This work made use of the Dutch national e-infrastructure Snellius with the support of the SURF Cooperative using grant no. EINF-2570, which is (partly) financed by the Dutch Research Council (NWO). SK was supported by the Fondation pour la Recherche Médical (FRM). We thank H Scherberger and PA Beuriat for assistance with array implantation. We thank M Montagna and S Pinède for their help with the construction of the laboratory set up.</p></ack><ref-list><title>Bibliography</title><ref id="R1"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Aarts</surname><given-names>E</given-names></name></person-group><source>mHMMbayes: Multilevel Hidden Markov Models Using Bayesian Estimation (0.1.1.9002) [R]</source><year>2019</year><comment><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/mHMMbayes/mHMMbayes.pdf">https://cran.r-project.org/web/packages/mHMMbayes/mHMMbayes.pdf</ext-link></comment></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aarts</surname><given-names>E</given-names></name><name><surname>Verhage</surname><given-names>M</given-names></name><name><surname>Veenvliet</surname><given-names>JV</given-names></name><name><surname>Dolan</surname><given-names>CV</given-names></name><name><surname>Van Der Sluis</surname><given-names>S</given-names></name></person-group><article-title>A solution to dependency: Using multilevel analysis to accommodate nested data</article-title><source>Nature Neuroscience</source><year>2014</year><volume>17</volume><issue>4</issue><fpage>491</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/nn.3648</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aguero-Valverde</surname><given-names>J</given-names></name></person-group><article-title>Full Bayes Poisson gamma, Poisson lognormal, and zero inflated random effects models: Comparing the precision of crash frequency estimates</article-title><source>Accident Analysis &amp; Prevention</source><year>2013</year><volume>50</volume><fpage>289</fpage><lpage>297</lpage><pub-id pub-id-type="doi">10.1016/j.aap.2012.04.019</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akaike</surname><given-names>H</given-names></name></person-group><article-title>A new look at the statistical model identification</article-title><source>IEEE Transactions on Automatic Control</source><year>1974</year><volume>19</volume><issue>6</issue><fpage>716</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altman</surname><given-names>RM</given-names></name></person-group><article-title>Mixed Hidden Markov Models</article-title><source>Journal of the American Statistical Association</source><year>2007</year><volume>102</volume><issue>477</issue><fpage>201</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1198/016214506000001086</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barack</surname><given-names>DL</given-names></name><name><surname>Krakauer</surname><given-names>JW</given-names></name></person-group><article-title>Two views on the cognitive brain</article-title><source>Nature Reviews Neuroscience</source><year>2021</year><volume>22</volume><issue>6</issue><comment>Article 6</comment><pub-id pub-id-type="doi">10.1038/s41583-021-00448-6</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrese</surname><given-names>JC</given-names></name><name><surname>Aceros</surname><given-names>J</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name></person-group><article-title>Scanning electron microscopy of chronically implanted intracortical microelectrode arrays in non-human primates</article-title><source>Journal of Neural Engineering</source><year>2016</year><volume>13</volume><issue>2</issue><elocation-id>026003</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/13/2/026003</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bates</surname><given-names>D</given-names></name><name><surname>Kliegl</surname><given-names>R</given-names></name><name><surname>Vasishth</surname><given-names>S</given-names></name><name><surname>Baayen</surname><given-names>H</given-names></name></person-group><article-title>Parsimonious Mixed Models</article-title><source>arXiv</source><year>2018</year><elocation-id>arXiv:1506.04967</elocation-id><pub-id pub-id-type="doi">10.48550/arXiv.1506.04967</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baum</surname><given-names>LE</given-names></name><name><surname>Petrie</surname><given-names>T</given-names></name><name><surname>Soules</surname><given-names>G</given-names></name><name><surname>Weiss</surname><given-names>N</given-names></name></person-group><article-title>A Maximization Technique Occurring in the Statistical Analysis of Probabilistic Functions of Markov Chains</article-title><source>The Annals of Mathematical Statistics</source><year>1970</year><volume>41</volume><issue>1</issue><fpage>164</fpage><lpage>171</lpage></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bollimunta</surname><given-names>A</given-names></name><name><surname>Totten</surname><given-names>D</given-names></name><name><surname>Ditterich</surname><given-names>J</given-names></name></person-group><article-title>Neural Dynamics of Choice: Single-Trial Analysis of Decision-Related Activity in Parietal Cortex</article-title><source>Journal of Neuroscience</source><year>2012</year><volume>32</volume><issue>37</issue><fpage>12684</fpage><lpage>12701</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5752-11.2012</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname><given-names>SP</given-names></name><name><surname>Gelman</surname><given-names>A</given-names></name></person-group><article-title>General Methods for Monitoring Convergence of Iterative Simulations</article-title><source>Journal of Computational and Graphical Statistics</source><year>1998</year><volume>7</volume><issue>4</issue><fpage>434</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1080/10618600.1998.10474787</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><article-title>Dimensionality reduction for large-scale neural recordings</article-title><source>Nature Neuroscience</source><year>2014</year><volume>17</volume><issue>11</issue><comment>Article 11</comment><pub-id pub-id-type="doi">10.1038/nn.3776</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>E</given-names></name><name><surname>Cohen</surname><given-names>LG</given-names></name></person-group><article-title>Neuroplasticity Subserving Motor Skill Learning</article-title><source>Neuron</source><year>2011</year><volume>72</volume><issue>3</issue><fpage>443</fpage><lpage>454</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.10.008</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Haan-Rietdijk</surname><given-names>S</given-names></name><name><surname>Kuppens</surname><given-names>P</given-names></name><name><surname>Bergeman</surname><given-names>CS</given-names></name><name><surname>Sheeber</surname><given-names>LB</given-names></name><name><surname>Allen</surname><given-names>NB</given-names></name><name><surname>Hamaker</surname><given-names>EL</given-names></name></person-group><article-title>On the Use of Mixed Markov Models for Intensive Longitudinal Data</article-title><source>Multivariate Behavioral Research</source><year>2017</year><volume>52</volume><issue>6</issue><fpage>747</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1080/00273171.2017.1370364</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maximum Likelihood from Incomplete Data Via the EM Algorithm</article-title><source>Journal of the Royal Statistical Society: Series B (Methodological)</source><year>1977</year><volume>39</volume><issue>1</issue><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1111/j.2517-6161.1977.tb01600.x</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diomedi</surname><given-names>S</given-names></name><name><surname>Vaccari</surname><given-names>FE</given-names></name><name><surname>Galletti</surname><given-names>C</given-names></name><name><surname>Hadjidimitrakis</surname><given-names>K</given-names></name><name><surname>Fattori</surname><given-names>P</given-names></name></person-group><article-title>Motor-like neural dynamics in two parietal areas during arm reaching</article-title><source>Progress in Neurobiology</source><year>2021</year><volume>205</volume><elocation-id>102116</elocation-id><pub-id pub-id-type="doi">10.1016/j.pneurobio.2021.102116</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Forney</surname><given-names>GD</given-names></name></person-group><source>The viterbi algorithm</source><conf-name>Proceedings of the IEEE</conf-name><year>1973</year><volume>61</volume><issue>3</issue><fpage>268</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1109/PROC.1973.9030</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fox</surname><given-names>J</given-names></name><name><surname>Weisberg</surname><given-names>S</given-names></name><name><surname>Price</surname><given-names>B</given-names></name><name><surname>Adler</surname><given-names>D</given-names></name><name><surname>Bates</surname><given-names>D</given-names></name><name><surname>Baud-Bovy</surname><given-names>G</given-names></name><name><surname>Bolker</surname><given-names>B</given-names></name></person-group><article-title>car: Companion to Applied Regression</article-title><source>R package version 3.0-2</source><year>2019</year><date-in-citation>Accessed 17 March 2020</date-in-citation><comment>Website <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/car/index.html">Https://CRAN.R-Project.Org/Package=Car</ext-link></comment></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallego</surname><given-names>JA</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name><name><surname>Solla</surname><given-names>SA</given-names></name></person-group><article-title>Neural Manifolds for the Control of Movement</article-title><source>Neuron</source><year>2017</year><volume>94</volume><issue>5</issue><fpage>978</fpage><lpage>984</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.05.025</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallego</surname><given-names>JA</given-names></name><name><surname>Perich</surname><given-names>MG</given-names></name><name><surname>Naufel</surname><given-names>SN</given-names></name><name><surname>Ethier</surname><given-names>C</given-names></name><name><surname>Solla</surname><given-names>SA</given-names></name><name><surname>Miller</surname><given-names>LE</given-names></name></person-group><article-title>Cortical population activity within a preserved neural manifold underlies multiple motor behaviors</article-title><source>Nature Communications</source><year>2018</year><volume>9</volume><issue>1</issue><comment>Article 1</comment><pub-id pub-id-type="doi">10.1038/s41467-018-06560-z</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gat</surname><given-names>I</given-names></name><name><surname>Tishby</surname><given-names>N</given-names></name><name><surname>Abeles</surname><given-names>M</given-names></name></person-group><article-title>Hidden Markov modelling of simultaneously recorded cells in the associative cortex of behaving monkeys</article-title><source>Network: Computation in Neural Systems</source><year>1997</year><volume>8</volume><issue>3</issue><fpage>297</fpage><lpage>322</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_8_3_005</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name><name><surname>Pardoe</surname><given-names>I</given-names></name></person-group><article-title>Bayesian Measures of Explained Variance and Pooling in Multilevel (Hierarchical) Models</article-title><source>Technometrics</source><year>2006</year><volume>48</volume><issue>2</issue><fpage>241</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.1198/004017005000000517</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name><name><surname>Shalizi</surname><given-names>CR</given-names></name></person-group><article-title>Philosophy and the practice of Bayesian statistics</article-title><source>British Journal of Mathematical and Statistical Psychology</source><year>2013</year><volume>66</volume><issue>1</issue><fpage>8</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1111/j.2044-8317.2011.02037.x</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gohil</surname><given-names>C</given-names></name><name><surname>Roberts</surname><given-names>E</given-names></name><name><surname>Timms</surname><given-names>R</given-names></name><name><surname>Skates</surname><given-names>A</given-names></name><name><surname>Higgins</surname><given-names>C</given-names></name><name><surname>Quinn</surname><given-names>A</given-names></name><name><surname>Pervaiz</surname><given-names>U</given-names></name><name><surname>van Amersfoort</surname><given-names>J</given-names></name><name><surname>Notin</surname><given-names>P</given-names></name><name><surname>Gal</surname><given-names>Y</given-names></name><name><surname>Adaszewski</surname><given-names>S</given-names></name><name><surname>Woolrich</surname><given-names>M</given-names></name></person-group><article-title>Mixtures of large-scale dynamic functional brain network modes</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.05.03.490453</elocation-id><pub-id pub-id-type="doi">10.1101/2022.05.03.490453</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hox</surname><given-names>JJ</given-names></name><name><surname>Moerbeek</surname><given-names>M</given-names></name><name><surname>van de Schoot</surname><given-names>R</given-names></name></person-group><source>Multilevel analysis: Techniques and applications</source><edition>3rd ed</edition><publisher-name>Routledge/Taylor &amp; Francis Group</publisher-name><year>2018</year></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>MD</given-names></name></person-group><article-title>Strong and weak principles of neural dimension reduction</article-title><source>arXiv</source><year>2021</year><comment>arXiv:2011.08088</comment><pub-id pub-id-type="doi">10.48550/arXiv.2011.08088</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kadmon Harpaz</surname><given-names>N</given-names></name><name><surname>Ungarish</surname><given-names>D</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Flash</surname><given-names>T</given-names></name></person-group><article-title>Movement Decomposition in the Primary Motor Cortex</article-title><source>Cerebral Cortex</source><year>2019</year><volume>29</volume><issue>4</issue><fpage>1619</fpage><lpage>1633</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhy060</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kemere</surname><given-names>C</given-names></name><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Afshar</surname><given-names>A</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Meng</surname><given-names>TH</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><article-title>Detecting Neural-State Transitions Using Hidden Markov Models for Motor Cortical Prostheses</article-title><source>Journal of Neurophysiology</source><year>2008</year><volume>100</volume><issue>4</issue><fpage>2441</fpage><lpage>2452</lpage><pub-id pub-id-type="doi">10.1152/jn.00924.2007</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lenth</surname><given-names>R</given-names></name><name><surname>Buerkner</surname><given-names>P</given-names></name><name><surname>Herve</surname><given-names>M</given-names></name><name><surname>Love</surname><given-names>J</given-names></name><name><surname>Riebl</surname><given-names>H</given-names></name><name><surname>Singmann</surname><given-names>H</given-names></name></person-group><source>emmeans: Estimated marginal means, aka least-squares means, v1. 5.1</source><publisher-name>R Core Team</publisher-name><publisher-loc>Vienna</publisher-loc><year>2020</year></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazurek</surname><given-names>KA</given-names></name><name><surname>Rouse</surname><given-names>AG</given-names></name><name><surname>Schieber</surname><given-names>MH</given-names></name></person-group><article-title>Mirror Neuron Populations Represent Sequences of Behavioral Epochs During Both Execution and Observation</article-title><source>Journal of Neuroscience</source><year>2018</year><volume>38</volume><issue>18</issue><fpage>4441</fpage><lpage>4455</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3481-17.2018</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McElreath</surname><given-names>R</given-names></name></person-group><source>Statistical rethinking: A Bayesian course with examples in R and Stan</source><publisher-name>Chapman and Hall/CRC</publisher-name><year>2020</year></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ponce-Alvarez</surname><given-names>A</given-names></name><name><surname>Nácher</surname><given-names>V</given-names></name><name><surname>Luna</surname><given-names>R</given-names></name><name><surname>Riehle</surname><given-names>A</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name></person-group><article-title>Dynamics of Cortical Neuronal Ensembles Transit from Decision Making to Storage for Later Report</article-title><source>Journal of Neuroscience</source><year>2012</year><volume>32</volume><issue>35</issue><fpage>11956</fpage><lpage>11969</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6176-11.2012</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><collab>R Core Team</collab><article-title>R: A language and environment for statistical computing (version 4.1.1,“Kick Things”)</article-title><source>R Foundation for Statistical Computing</source><year>2021</year></element-citation></ref><ref id="R34"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name></person-group><source>A tutorial on hidden Markov models and selected applications in speech recognition</source><conf-name>Proceedings of the IEEE</conf-name><year>1989</year><volume>77</volume><issue>2</issue><fpage>257</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1109/5.18626</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radons</surname><given-names>G</given-names></name><name><surname>Becker</surname><given-names>JD</given-names></name><name><surname>Dülfer</surname><given-names>B</given-names></name><name><surname>Krüger</surname><given-names>J</given-names></name></person-group><article-title>Analysis, classification, and coding of multielectrode spike trains with hidden Markov models</article-title><source>Biological Cybernetics</source><year>1994</year><volume>71</volume><issue>4</issue><fpage>359</fpage><lpage>373</lpage><pub-id pub-id-type="doi">10.1007/BF00239623</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raffa</surname><given-names>JD</given-names></name><name><surname>Dubin</surname><given-names>JA</given-names></name></person-group><article-title>Multivariate longitudinal data analysis with mixed effects hidden Markov models</article-title><source>Biometrics</source><year>2015</year><volume>71</volume><issue>3</issue><fpage>821</fpage><lpage>831</lpage><pub-id pub-id-type="doi">10.1111/biom.12296</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rueda</surname><given-names>OM</given-names></name><name><surname>Rueda</surname><given-names>C</given-names></name><name><surname>Diaz-Uriarte</surname><given-names>R</given-names></name></person-group><article-title>A Bayesian HMM with random effects and an unknown number of states for DNA copy number analysis</article-title><source>Journal of Statistical Computation and Simulation</source><year>2013</year><volume>83</volume><issue>1</issue><fpage>82</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1080/00949655.2011.609818</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadacca</surname><given-names>BF</given-names></name><name><surname>Mukherjee</surname><given-names>N</given-names></name><name><surname>Vladusich</surname><given-names>T</given-names></name><name><surname>Li</surname><given-names>JX</given-names></name><name><surname>Katz</surname><given-names>DB</given-names></name><name><surname>Miller</surname><given-names>P</given-names></name></person-group><article-title>The Behavioral Relevance of Cortical Neural Ensemble Responses Emerges Suddenly</article-title><source>Journal of Neuroscience</source><year>2016</year><volume>36</volume><issue>3</issue><fpage>655</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2265-15.2016</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saxena</surname><given-names>S</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name></person-group><article-title>Towards the neural population doctrine</article-title><source>Current Opinion in Neurobiology</source><year>2019</year><volume>55</volume><fpage>103</fpage><lpage>111</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2019.02.002</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="book"><person-group person-group-type="editor"><name><surname>van de Schoot</surname><given-names>R</given-names></name><name><surname>Miočević</surname><given-names>M</given-names></name></person-group><source>Small Sample Size Solutions: A Guide for Applied Researchers and Practitioners</source><edition>1st Edition</edition><publisher-name>Routledge/Taylor &amp; Francis Group</publisher-name><year>2020</year><comment><ext-link ext-link-type="uri" xlink:href="https://www.taylorfrancis.com/books/oa-edit/10.4324/9780429273872/small-sample-size-solutions-rens-van-de-schoot-milica-mio%C4%8Devi%C4%87">https://www.taylorfrancis.com/books/oa-edit/10.4324/9780429273872/small-sample-size-solutions-rens-van-de-schoot-milica-mio%C4%8Devi%C4%87</ext-link></comment></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname><given-names>G</given-names></name></person-group><article-title>Estimating the Dimension of a Model</article-title><source>The Annals of Statistics</source><year>1978</year><volume>6</volume><issue>2</issue><fpage>461</fpage><lpage>464</lpage></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>SL</given-names></name></person-group><article-title>Bayesian Methods for Hidden Markov Models</article-title><source>Journal of the American Statistical Association</source><year>2002</year><volume>97</volume><issue>457</issue><fpage>337</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1198/016214502753479464</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seidemann</surname><given-names>E</given-names></name><name><surname>Meilijson</surname><given-names>I</given-names></name><name><surname>Abeles</surname><given-names>M</given-names></name><name><surname>Bergman</surname><given-names>H</given-names></name><name><surname>Vaadia</surname><given-names>E</given-names></name></person-group><article-title>Simultaneously recorded single units in the frontal cortex go through sequences of discrete and stable states in monkeys performing a delayed localization task</article-title><source>Journal of Neuroscience</source><year>1996</year><volume>16</volume><issue>2</issue><fpage>752</fpage><lpage>768</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-02-00752.1996</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shirley</surname><given-names>KE</given-names></name><name><surname>Small</surname><given-names>DS</given-names></name><name><surname>Lynch</surname><given-names>KG</given-names></name><name><surname>Maisto</surname><given-names>SA</given-names></name><name><surname>Oslin</surname><given-names>DW</given-names></name></person-group><article-title>Hidden Markov models for alcoholism treatment trial data</article-title><source>Annals of Applied Statistics</source><year>2012</year><volume>6</volume><issue>1</issue><fpage>366</fpage><lpage>395</lpage><pub-id pub-id-type="doi">10.1214/09-AOAS282</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shirley</surname><given-names>K</given-names></name><name><surname>Vasilaky</surname><given-names>KN</given-names></name><name><surname>Greatrex</surname><given-names>HL</given-names></name><name><surname>Osgood</surname><given-names>DE</given-names></name></person-group><article-title>Hierarchical Bayes models for daily rainfall time series at multiple locations from heterogenous data sources</article-title><year>2016</year><pub-id pub-id-type="doi">10.7916/D8QF8SZ4</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trautmann</surname><given-names>EM</given-names></name><name><surname>Stavisky</surname><given-names>SD</given-names></name><name><surname>Lahiri</surname><given-names>S</given-names></name><name><surname>Ames</surname><given-names>KC</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>O’Shea</surname><given-names>DJ</given-names></name><name><surname>Vyas</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><article-title>Accurate Estimation of Neural Population Dynamics without Spike Sorting</article-title><source>Neuron</source><year>2019</year><volume>103</volume><issue>2</issue><fpage>292</fpage><lpage>308</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuron.2019.05.003</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Kempen</surname><given-names>J</given-names></name><name><surname>Gieselmann</surname><given-names>MA</given-names></name><name><surname>Boyd</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Moore</surname><given-names>T</given-names></name><name><surname>Engel</surname><given-names>TA</given-names></name><name><surname>Thiele</surname><given-names>A</given-names></name></person-group><article-title>Top-down coordination of local cortical state during selective attention</article-title><source>Neuron</source><year>2021</year><volume>109</volume><issue>5</issue><fpage>894</fpage><lpage>904</lpage><elocation-id>e8</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuron.2020.12.013</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visser</surname><given-names>I</given-names></name><name><surname>Speekenbrink</surname><given-names>M</given-names></name></person-group><article-title>depmixS4: An R package for hidden Markov models</article-title><source>Journal of Statistical Software</source><year>2010</year><volume>36</volume><fpage>1</fpage><lpage>21</lpage></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viterbi</surname><given-names>A</given-names></name></person-group><article-title>Error bounds for convolutional codes and an asymptotically optimum decoding algorithm</article-title><source>IEEE Transactions on Information Theory</source><year>1967</year><volume>13</volume><issue>2</issue><fpage>260</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1109/TIT.1967.1054010</pub-id></element-citation></ref><ref id="R50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xydas</surname><given-names>D</given-names></name><name><surname>Downes</surname><given-names>JH</given-names></name><name><surname>Spencer</surname><given-names>MC</given-names></name><name><surname>Hammond</surname><given-names>MW</given-names></name><name><surname>Nasuto</surname><given-names>SJ</given-names></name><name><surname>Whalley</surname><given-names>BJ</given-names></name><name><surname>Becerra</surname><given-names>VM</given-names></name><name><surname>Warwick</surname><given-names>K</given-names></name></person-group><article-title>Revealing Ensemble State Transition Patterns in Multi-Electrode Neuronal Recordings Using Hidden Markov Models</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><year>2011</year><volume>19</volume><issue>4</issue><fpage>345</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2011.2157360</pub-id></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>S-Z</given-names></name></person-group><article-title>Hidden semi-Markov models</article-title><source>Artificial Intelligence</source><year>2010</year><volume>174</volume><issue>2</issue><fpage>215</fpage><lpage>243</lpage><pub-id pub-id-type="doi">10.1016/j.artint.2009.11.011</pub-id></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Berhane</surname><given-names>K</given-names></name></person-group><article-title>Bayesian mixed hidden Markov models: A multi-level approach to modeling categorical outcomes with differential misclassification</article-title><source>Statistics in Medicine</source><year>2014</year><volume>33</volume><issue>8</issue><fpage>1395</fpage><lpage>1408</lpage><pub-id pub-id-type="doi">10.1002/sim.6039</pub-id></element-citation></ref><ref id="R53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zucchini</surname><given-names>W</given-names></name><name><surname>Macdonald</surname><given-names>IL</given-names></name><name><surname>Langrock</surname><given-names>R</given-names></name></person-group><chapter-title>Hidden Markov models for time series: An introduction using R, second edition</chapter-title><source>In Hidden Markov Models for Time Series: An Introduction Using R</source><edition>Second Edition</edition><publisher-name>Chapman and Hall/CRC</publisher-name><year>2017</year><pub-id pub-id-type="doi">10.1201/b20790</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Experimental setup.</title><p><bold>A)</bold> Localization of the floating multi-electrode arrays (FMA) on the right cortical hemisphere of monkey 1. Six arrays were implanted in the frontal cortex, and here we analyze data from one which was located in the primary motor cortex (M1). Labels show the location of the arcuate sulcus (AS), central sulcus (CS), and principal sulcus (PS). <bold>B)</bold> The monkey performed a cued reach-to-grasp task. In each trial, the monkey was required to grasp a handle until the go signal, then reach and grasp a metallic cube with a precision grasp (using the index finger and thumb), and finally place it into a groove in the table.</p></caption><graphic xlink:href="EMS156220-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>The HMM identifies states that correspond to different phases of the action.</title><p><bold>A)</bold> Raster plot of a single example trial representing the spiking activity from 21 electrodes from the M1 array of monkey 1. <bold>B)</bold> Forward probabilities for each state given by the model for the same trial shown in (A). <bold>C)</bold> Mean multi-unit firing rate of 21 electrodes from the M1 array of monkey 1 over 10 days (439 trials) aligned to behavioral events (go: go signal tone, hand movement onset: beginning of the reaching movement, object contact: grasping of the object, place: placing the object). <bold>D)</bold> Mean forward probabilities generated by the model for each state, averaged over the same trials and aligned to the same behavioral events as in (C).</p></caption><graphic xlink:href="EMS156220-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>States are tightly linked to behavioral events at the single trial level.</title><p>Each row shows the forward probabilities from one of the model states for each trial, over all days of recording, for monkey 1. Each column shows the trial forward probabilities sorted by one of the behavioral events (from left to right: go signal, hand movement onset, object contact, and placing). When trials are sorted by the appropriate event, the alignment between state forward probabilities and event timing can be clearly seen over all trials.</p></caption><graphic xlink:href="EMS156220-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>The link between states and behavioral events is consistent over days.</title><p><bold>A)</bold> Partial correlation coefficients between state transitions and behavioral events over the duration of recording from monkey 1, in groups of two days. Asterisks indicate statistically significant correlations. <bold>B)</bold> As in (A) for monkey 2.</p></caption><graphic xlink:href="EMS156220-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Number of state activations per trial compared between conditions.</title><p><bold>A)</bold> The number of activations per trial for each state identified by the model. Shaded areas indicate the distribution density, scatter plots show the number of activations for individual trials, and box plots show descriptive statistics: median (in the box), interquartile interval (the box), outliers (above whiskers). The inset shows the event-aligned mean state forward probabilities from <xref ref-type="fig" rid="F2">Figure 2</xref>. <bold>B)</bold> Number of activations per trial for each state compared by conditions: center, right, left. Asterisks indicate significant pairwise comparisons.</p></caption><graphic xlink:href="EMS156220-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Maximum state lifetime compared between conditions.</title><p><bold>A)</bold> The maximum lifetime (duration of the longest activation per trial) for each state identified by the model. Shaded areas indicate the distribution density, scatter plots show the maximum state lifetime for individual trials, and box plots show descriptive statistics: median (in the box), interquartile interval (the box), outliers (above whiskers). The inset shows the event-aligned mean state forward probabilities from <xref ref-type="fig" rid="F2">Figure 2</xref>. <bold>B)</bold> Maximum lifetime for each state compared by conditions: center, right, left. Asterisks indicate significant pairwise comparisons.</p></caption><graphic xlink:href="EMS156220-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>States represent different patterns of neural activity patterns.</title><p>Each panel shows mean, baseline-corrected firing rates from each electrode from monkey 1 aligned to the onset (left plot) and offset (right plot) of states 1-6 (A-F). Dashed vertical lines indicate the onset and offset time of the state. State transitions are associated with rapid changes in state-specific patterns of neural activity.</p></caption><graphic xlink:href="EMS156220-f007"/></fig></floats-group></article>