<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS158244</article-id><article-id pub-id-type="doi">10.1101/2022.12.05.519181</article-id><article-id pub-id-type="archive">PPR580823</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>The establishment of locally adaptive inversions in structured populations</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Mackintosh</surname><given-names>Carl</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Scott</surname><given-names>Michael F</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Reuter</surname><given-names>Max</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Pomiankowski</surname><given-names>Andrew</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Genetics, Evolution, and Environment, University College London, Gower Street, London, WC1E 6BT</aff><aff id="A2"><label>2</label>CoMPLEX, University College London, Gower Street, London, WC1E 6BT</aff><aff id="A3"><label>3</label>School of Biological Sciences, University of East Anglia, Norwich Research Park, Norwich, NR4 7TJ</aff><author-notes><corresp id="CR1">
<label>*</label>Author for correspondence: Andrew Pomiankowski (<email>ucbhpom@ucl.ac.uk</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>08</day><month>12</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>07</day><month>12</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Inversions have been proposed to facilitate local adaptation, by linking together locally coadapted alleles at different loci. Classic prior work addressing this question theoretically has considered the spread of inversions in “continent-island” models in which there is a unidirectional flow of mal-adapted migrants into the island population. In this setting, inversions are most likely to establish when selection is weak, because stronger local selection more effectively purges maladaptive alleles, thus lessening the advantage of inversions. Here, we show this finding only holds under limited conditions. We study the establishment of inversions in a “two-deme” model, which explicitly considers the dynamics of allele frequencies in both populations linked by bidirectional migration. For symmetric selection and migration, we find that stronger local selection increases the flow of maladaptive alleles and favours inversions, the opposite of the pattern seen in the asymmetric continent-island model. Furthermore, we show that the strength and symmetry of selection also change the likelihood that an inversion captures an adaptive haplotype in the first place. Considering the combined process of invasion and capture shows that inversions are most likely to be found when locally adaptive loci experience strong selection. In addition, inversions that establish in one deme also protect adaptive allele combinations in the other, leading to differentiation between demes. Stronger selection in either deme once again makes differentiation between populations more likely. In contrast, differentiation is less likely when migration rates are high because adaptive haplotypes become less common. Overall, this analysis of evolutionary dynamics across a structured population shows that established inversions are most likely to have captured strongly selected local adaptation alleles.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Chromosomal inversions are a form of structural variant that suppress recombination between loci. Inversions can result in reduced fitness due to the disruption of genes around their breakpoints (<xref ref-type="bibr" rid="R23">Kirkpatrick 2010</xref>), or from the capture and accumulation of deleterious alleles due to their lower effective recombination rate (<xref ref-type="bibr" rid="R44">Wasserman 1968</xref>; <xref ref-type="bibr" rid="R3">Berdan et al. 2021</xref>). Furthermore, inversion heterozygotes may experience reduced fecundity as a result of improper meiosis that results in aneuploid gametes (<xref ref-type="bibr" rid="R46">White 1978</xref>). Despite these negative fitness effects, the ubiquity of inversions has led to several putative explanations for their continued persistence (see reviews <xref ref-type="bibr" rid="R23">Kirkpatrick 2010</xref>; <xref ref-type="bibr" rid="R45">Wellenreuther and Bernatchez 2018</xref>; <xref ref-type="bibr" rid="R14">Faria, Johannesson, et al. 2019</xref>; <xref ref-type="bibr" rid="R20">Huang and Rieseberg 2020</xref>; <xref ref-type="bibr" rid="R43">Villoutreix et al. 2021</xref>). In particular, inversions could facilitate local adaptation under gene flow by increasing linkage between coadapted alleles and reducing effective migration of mal-adapted haplotypes (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>).</p><p id="P3">Empirical evidence for this hypothesis has since been documented across a wide array of taxa (e.g. <xref ref-type="bibr" rid="R31">Lowry and Willis 2010</xref>; <xref ref-type="bibr" rid="R8">Cheng et al. 2012</xref>; <xref ref-type="bibr" rid="R2">Ayala, Guerrero, and Kirkpatrick 2013</xref>; <xref ref-type="bibr" rid="R28">Lee et al. 2017</xref>; <xref ref-type="bibr" rid="R9">Christmas et al. 2019</xref>; <xref ref-type="bibr" rid="R13">Faria, Chaube, et al. 2019</xref>; <xref ref-type="bibr" rid="R19">Huang, Andrew, et al. 2020</xref>; <xref ref-type="bibr" rid="R26">Koch et al. 2021</xref>; <xref ref-type="bibr" rid="R17">Hager et al. 2022</xref>; <xref ref-type="bibr" rid="R18">Harringmeyer and Hoekstra 2022</xref>), and a body of related theoretical work has also developed from the original model, investigating the roles of geography, chromosome type, and inversion length on the fate of adaptive inversions (<xref ref-type="bibr" rid="R15">Feder, Gejji, et al. 2011</xref>; <xref ref-type="bibr" rid="R7">Charlesworth and Barton 2018</xref>; <xref ref-type="bibr" rid="R11">Connallon, Olito, et al. 2018</xref>; <xref ref-type="bibr" rid="R10">Connallon and Olito 2021</xref>; <xref ref-type="bibr" rid="R39">Proulx and Teotónio 2022</xref>). For simplicity, this work often considers a “continent-island” model, in which inversions are introduced into an “island” population which receives maladapted migrants from a larger “continent” population. In this model, the selective advantage of an adaptive inversion is proportional to the rate of gene flow (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>), and inversely proportional to the strength of selection on the island (<xref ref-type="bibr" rid="R5">Bürger and Akerman 2011</xref>; <xref ref-type="bibr" rid="R7">Charlesworth and Barton 2018</xref>). These results rely on the homogeneous maladaptation of migrant alleles which follows from the extreme migration asymmetry assumed between the continent and island populations (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>). This scenario is unlikely to apply to many empirical systems, where local adaptation occurs in a structured population with greater symmetry and individuals migrate between similarly sized populations at rates that are similar to and from each population (e.g. <xref ref-type="bibr" rid="R15">Feder, Gejji, et al. 2011</xref>, <xref ref-type="bibr" rid="R39">Proulx and Teotónio 2022</xref>). With two-way dispersal, selection will interact with migration to determine the overall rate of maladaptive gene flow. However, there has been no thorough analytical dissection of the roles that migration and selection play individually in such a model.</p><p id="P4">In addition, it is important to consider not only whether an inversion spreads but also how the frequency of adaptive haplotypes affects their probability of being captured by an inversion. This has been briefly discussed before (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>), and in relative terms when comparing X-linked and autosomal inversions (<xref ref-type="bibr" rid="R11">Connallon, Olito, et al. 2018</xref>). But so far models have sidestepped the problem by assuming that either an inversion capturing the coadapted haplotype simply existed or that such an inversion arose during a period of allopatry (<xref ref-type="bibr" rid="R15">Feder, Gejji, et al. 2011</xref>). Explicitly modelling the origin of the inversion is important because parameters favourable for the establishment of an adaptive inversion are not necessarily those where adaptive inversions are likely to arise. Assuming an inversion captures a random genotype, the probability of capturing a particular adaptive combination is proportional to its frequency. For example, adaptive inversions are expected to be favoured most when there are high rates of migrant gene flow, so there are fewer fit genotypes to be captured.</p><p id="P5">Here, we model the fate of locally adaptive chromosomal inversions in a two-locus, two-allele, two-deme model with migration and selection. We consider the case of symmetrical deme sizes and migration, as well as asymmetrical scenarios with the continent-island model as the extreme case. To understand the dynamics of inversions, we determine the probability of an adaptive inversion arising and its subsequent selective advantage in a population in which the locally adaptive alleles have reached their equilibrium frequencies and linkage under migration and selection. By considering the processes of inversion origin and spread in both demes, we determine population structures which favour the evolution of inversions that allow local adaptation under environmentally variable selection.</p></sec><sec id="S2" sec-type="methods"><title>Methods</title><p id="P6">We consider a population consisting of two demes linked by bidirectional migration with selection for local adaptation. We first derive analytical expressions for equilibrium allele frequencies at the local adaptation loci and the linkage disequilibrium (LD) between them. This will allow us to assess the frequency of each haplotype and hence the invasion probability of an inversion capturing a locally adapted combination of alleles. We then determine the probability of such an inversion arising and establishing itself in the population.</p><sec id="S3"><title>Model</title><p id="P7">We model an infinite population of two demes, consisting of haploid, hermaphroditic individuals with discrete non-overlapping generations. The model is equally applicable to the case where there are two sexes at even sex ratio whose genetic determination is unlinked to the adaptive loci under consideration. Selection acts on two loci, <italic>A</italic> and <italic>B</italic>, that have two alleles each, <italic>A<sub>i</sub></italic> and <italic>B<sub>i</sub></italic>, where <italic>i</italic> ∈ {1,2} denotes the deme in which the allele provides a benefit <italic>s<sub>i</sub></italic> (equal between the two loci). The relative fitness of an individual in deme <italic>i</italic> is either (1 + <italic>s<sub>i</sub></italic>)<sup>2</sup>, (1 + <italic>s<sub>i</sub></italic>) or 1, depending on whether it carries two, one or no allele(s) conferring local adaptation to its environment.</p><p id="P8">The life cycle begins with adults. These individuals reproduce, whereby pairs of parents are sampled according to their relative fitness in their current deme to produce one joint offspring. During reproduction, recombination occurs between the parental chromosomes (and their loci for local adaptation) at rate <italic>r</italic>. When alleles are held in an inversion, the recombination rate with non-inverted chromosomes drops to zero (double cross-overs and gene conversion are ignored). Migration between demes then occurs such that a proportion <italic>m<sub>kl</sub></italic> of juveniles in deme <italic>l</italic> are migrants from deme <italic>k</italic>. After migration, the juveniles in each deme become the adults of the next generation. As the life cycle consist of just two phases, reproduction/selection and dispersal, the order of events within a generation does not affect the results.</p><p id="P9">At the beginning of a generation, <italic>A<sub>i</sub>B<sub>j</sub></italic> adults in deme <italic>k</italic> are at proportion <inline-formula><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and have fitness <inline-formula><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Among the parents sampled for reproduction, the frequencies are <inline-formula><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the mean fitness in deme <italic>k</italic>. <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the coefficient of linkage disequilibrium in deme <italic>k</italic>, and <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the linkage disequilibrium after selection, among parents. Among the juveniles of the next generation, the frequency of genotype <italic>A<sub>i</sub>B<sub>j</sub></italic> in deme <italic>k</italic> after migration, is given by <disp-formula id="FD1"><label>(1)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> if <italic>i</italic> = <italic>j</italic>, and <disp-formula id="FD2"><label>(2)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.2em"/><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> otherwise.</p><p id="P10">When migration is limited to one direction (i.e., <italic>m</italic><sub>12</sub> or <italic>m</italic><sub>21</sub> = 0) or when selection in one environment is very strong (<italic>s<sub>i</sub></italic> ≫ <italic>s<sub>j</sub></italic>), the model approaches the well studied “continent-island” model (hereafter superscript “C-I”, e.g., <xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref> and <xref ref-type="bibr" rid="R7">Charlesworth and Barton 2018</xref>).</p></sec><sec id="S4"><title>Analysis</title><p id="P11">To use the quasi-linkage equilibrium (QLE) approximation, we first rewrite the genotype frequencies in terms of allele frequencies and LD, and then calculate their equilibria (<xref ref-type="bibr" rid="R25">Kirkpatrick, Johnson, and Barton 2002</xref>; <xref ref-type="bibr" rid="R36">Otto and Day 2011</xref>). This approximation assumes that recombination between the two loci is sufficiently high compared to migration and selection (<italic>r</italic> ≫ <italic>m<sub>i j</sub></italic>, <italic>s<sub>k</sub></italic>) to allow LD to reach an equilibrium much more quickly than the allele frequencies. This is justified here if we do not consider loci that are already tightly linked. But this is not an interesting case, because inversions then offer minimal advantage from suppressing recombination. To ensure the existence of an equilibrium, migration must also be weak compared to selection (i.e. max(<italic>m</italic><sub>12</sub>, <italic>m</italic><sub>21</sub>) &lt; min(<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>)). These values allow the calculation of the equilibrium mean fitness in each deme, and hence the rate of increase of an adaptive inversion.</p><p id="P12">Using <xref ref-type="disp-formula" rid="FD1">Equations 1</xref> and <xref ref-type="disp-formula" rid="FD2">2</xref> with <italic>r</italic> = 0, the dynamics of an <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> inversion are described by the transition matrix <italic>M</italic><sub>11</sub>, in which the (<italic>i</italic>, <italic>j</italic>)-th entry describes an inverted adult experiencing selection in deme <italic>i</italic>, and whose offspring is located in deme <italic>j</italic> post-dispersal, given by <disp-formula id="FD3"><label>(3)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mo>=</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the equilibrium mean fitness in deme <italic>k</italic> (we use the circumflex symbol ^ for equilibrium values throughout). The rate that a rare <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> inversion increases in frequency in the whole population (<italic>λ</italic><sub>11</sub>) is given by the leading eigenvalue of <italic>M</italic><sub>11</sub>. As the population is at equilibrium the growth rate of a recombining <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype is 1, so <italic>λ</italic><sub>11</sub> &gt; 1 implies a benefit to the inversion that can be ascribed to the absence of recombination. From this measure of ‘invasion fitness’, we can approximate the invasion probability as 2(<italic>λ</italic><sub>11</sub> – 1) (<xref ref-type="bibr" rid="R35">Otto and Whitlock 2013</xref>). A similar transition matrix <italic>M</italic><sub>22</sub> can be derived for the behaviour of an <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub> inversion (see File S1).</p><p id="P13">The invasion probability (2(<italic>λ</italic><sub>11</sub> – 1)) is specific to the <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype and hence conditional on an inversion capturing this allelic combination. To account for the probability of an inversion actually capturing the <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype in the first place, we need to take into account the frequency of this haplotype in a population at equilibrium. The simplest way of achieving this would be to multiply <italic>λ</italic><sub>11</sub> by the overall frequency of <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub>, across the two demes. This is an acceptable approach in the extreme case of the continent-island scenario, where the inversion is limited to the island and the growth rate only applies to that population. However, the overall frequency of <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> is no longer suitable in a two-deme model, because it gives equal weight to individuals in deme 1 where the haplotype is adaptive and and those in deme 2 where it is not adaptive. Accordingly, in order to determine the probability of an <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> inversion arising, we need to take into account not only the frequency of the <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype but also the relative reproductive value of the inversion in each deme. The reproductive value of the inversion in each deme is given by the left eigenvector of <italic>M<sub>i i</sub></italic> and its components can be scaled to relative values that sum to 1. Call this scaled vector <inline-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">v</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:mo>(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>1</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mtext>2</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mtext>)</mml:mtext></mml:mrow></mml:math></inline-formula>. Now, the probability that an inversion captures coadapted alleles (<italic>A<sub>i</sub>B<sub>i</sub></italic>) and invades is given by <disp-formula id="FD4"><label>(4)</label><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P14">Finally, the probability of any locally adapted inversion establishing when it arises needs to consider both <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> and <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub> haplotypes, and is given by <disp-formula id="FD5"><label>(5)</label><mml:math id="M13"><mml:mrow><mml:mtext>Γ</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P15">This is also equal to the probability of an inversion establishing itself overall, because inversions that capture allele combinations that are not advantageous in either deme (i.e. <italic>A</italic><sub>1</sub><italic>B</italic><sub>2</sub> or <italic>A</italic><sub>2</sub><italic>B</italic><sub>1</sub>) are never favoured.</p></sec></sec><sec id="S5" sec-type="results"><title>Results</title><sec id="S6"><title>Equilibrium allele frequencies and linkage disequilibrium</title><p id="P16">At equilibrium, the frequencies of the alleles (<inline-formula><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for allele <italic>j</italic> in deme <italic>i</italic>) are <disp-formula id="FD6"><label>(6)</label><mml:math id="M15"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> and the linkage disequilibrium between loci in deme 1 (<italic>D</italic><sub>1</sub>) is <disp-formula id="FD7"><label>(7)</label><mml:math id="M16"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P17">Linkage disequilibrium in deme 2 <inline-formula><mml:math id="M17"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is given by replacing <italic>m</italic><sub>21</sub> with <italic>m</italic><sub>12</sub> and vice versa. These equilibrium values, derived here for haploidy and weak selection, are in accord with previous results (<xref ref-type="bibr" rid="R1">Akerman and Bürger 2014</xref>).</p><p id="P18">In the case where migration and selection are symmetric, <italic>m<sub>kl</sub></italic> = <italic>m</italic> and <italic>s<sub>i</sub></italic> = <italic>s</italic> (i.e., two populations with exactly opposing local selection pressures exchanging an equal proportion of migrants), the demes have symmetric allele frequencies <inline-formula><mml:math id="M18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and linkage disequilibria (<italic>D</italic><sub>1</sub> = <italic>D</italic><sub>2</sub>) <disp-formula id="FD8"><label>(8)</label><mml:math id="M19"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD9"><label>(9)</label><mml:math id="M20"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:mfrac><mml:mo>+</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> meaning that <disp-formula id="FD10"><label>(10)</label><mml:math id="M21"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P19">In the other extreme case, where there is unidirectional gene flow from deme 2 (“continent”) to deme 1 (“island”), the “continent” genotypes remain fixed to <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub>. Setting <italic>s</italic><sub>1</sub> = <italic>s</italic> and <italic>m</italic><sub>21</sub> = <italic>m</italic> <disp-formula id="FD11"><label>(11)</label><mml:math id="M22"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD12"><label>(12)</label><mml:math id="M23"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P20">Locally adaptive alleles are more abundant in the symmetric scenario (<xref ref-type="disp-formula" rid="FD8">equation 8</xref>) than in the continent-island scenario (<xref ref-type="disp-formula" rid="FD11">equation 11</xref>). This difference arises because in the symmetric scenario a fraction of locally adapted migrants from a focal deme migrate to and survive in the other deme, only to return back and contribute to the frequency of beneficial alleles in the focal deme. In the continent-island scenario, in contrast, continental migrants can only introduce deleterious alleles into the focal deme.</p><p id="P21">In both scenarios, linkage disequilibrium is positive, indicating that the adaptive alleles tend to be found together in coadapted haplotypes (<italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> and <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub>). This tendency increases with the strength of selection in both models <inline-formula><mml:math id="M24"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∂</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mo>∂</mml:mo><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, because selection favours the association of coadapted alleles, but decreases with the rate of recombination <inline-formula><mml:math id="M25"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∂</mml:mo><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mo>∂</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which breaks the coadapted haplotypes apart to create more intermediate haplotypes (<italic>A</italic><sub>1</sub><italic>B</italic><sub>2</sub> and <italic>A</italic><sub>2</sub><italic>B</italic><sub>1</sub>).</p><p id="P22">The role of migration is less straightforward and differs between the two scenarios. At small migration rates, selection tends to be stronger relative to migration and demes are enriched for locally adapted haplotypes. Linkage disequilibrium then increases with <italic>m</italic> because more <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub> combinations are introduced into deme 1 (and more <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> combinations are introduced into deme 2 in the symmetric scenario). When migration becomes higher, the balance between selection and migration shifts and migration tends to introduce proportionately more maladaptive haplotypes from the other deme, thus degrading the linkage disequilibrium that is built up locally by selection. The rate of migration at which this effect sets in depends on the model. In the continent-island scenario, migration decreases linkage disequilibrium when <italic>m</italic> &gt; <italic>s</italic>/3. In the symmetric case, migration begins to decrease linkage disequilibrium at a lower point, when <inline-formula><mml:math id="M26"><mml:mrow><mml:mi>m</mml:mi><mml:mspace width="0.2em"/><mml:mtext>&gt;</mml:mtext><mml:mspace width="0.2em"/><mml:mi>s</mml:mi><mml:msqrt><mml:mrow><mml:mn>3</mml:mn><mml:mtext>/</mml:mtext><mml:mn>6</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, because the presence of <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> migrants in deme 2 generates more intermediate haplotypes through recombination. These individuals can back-migrate and degrade linkage disequilibrium in deme 1 (with the same process going on in the reverse direction).</p></sec><sec id="S7"><title>Invasion probability of a locally adaptive inversion</title><p id="P23">Having established the equilibrium composition of populations, we can now consider the fate of a new inversion that captures allele <italic>A</italic><sub>1</sub> and <italic>B</italic><sub>1</sub>, which are locally adaptive in deme 1. We calculate the rate of increase and probability of fixation of this inversion. We again compare the two extreme models, the continent-island and the symmetric scenarios before examining the full model.</p><p id="P24">The growth rate of the inversion in the continent-island scenario is <disp-formula id="FD13"><label>(13)</label><mml:math id="M27"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>C-I</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> implying that migration is the main driver behind the selective advantage of inversions (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>). The rate of growth is independent of the strength of selection in the island. The inversion’s benefit is the protection of locally adapted haplotypes from acquiring maladaptive migrant alleles through recombination. Increasing the strength of selection within the “island” has no effect to leading order, under the assumption that selection and migration are both weak.</p><p id="P25">In the symmetric scenario, the growth rate of an inversion is given by <disp-formula id="FD14"><label>(14)</label><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>sym</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P26">Since <inline-formula><mml:math id="M29"><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>&lt;</mml:mo><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, we always have <inline-formula><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>sym</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>C-I</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the advantage of the inversion is weaker in the two-deme compared to the continent-island model. The inversion’s growth rate in the symmetric scenario now depends on the strength of local selection. Specifically, inversions are increasingly favoured with stronger selection (the square root terms in <xref ref-type="disp-formula" rid="FD14">Equation 14</xref> converge as <italic>s</italic> increases and <inline-formula><mml:math id="M31"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mtext>sym</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> tends towards <inline-formula><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mtext>C-I</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>). As the strength of selection increases, the proportion of deme 2 that is well-adapted increases. This means that new migrants carry more maladaptive alleles and recombination more often results in less fit offspring, so that the inverted haplotype has a greater advantage over non-inverted <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotypes.</p><p id="P27">While stronger selection increases the frequency of maladaptive alleles among migrants, it will also remove them more effectively from the focal deme. This effect is not captured by our QLE approximation, so we numerically calculate the advantage of a rare inversion while assuming that allele frequencies are at the exact equilibrium calculated to second order in selection and migration (<xref ref-type="fig" rid="F1">Figure 1</xref>). In the continent-island scenario, the genotypic composition of migrants is unaffected by selection. Stronger selection reduces the advantage of an inversion (as found by <xref ref-type="bibr" rid="R5">Bürger and Akerman 2011</xref>; <xref ref-type="bibr" rid="R7">Charlesworth and Barton 2018</xref>) because the island population becomes better adapted as selection increases, so that recombining adaptive haplotypes results in less fit offspring less often (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P28">In the symmetric scenario, the numerical results confirm that increasingly strong selection favours inversions, as in the QLE results. This happens because selection reinforces local adaptation and makes migrants more maladapted. However, this advantage plateaus as the strength of selection increases, because adaptive alleles become more common. This decreases the advantage of inversions, as selection alone tends to weed out the maladapted combinations. Unless selection is very strong, the former force dominates, meaning that the selective advantage of inversions is primarily determined by the genotypic composition of migrants. Under very strong selection, the invasion probability under symmetric migration converges on that in the island-continent scenario (<xref ref-type="fig" rid="F1">Figure 1</xref>), because the composition of migrants in each become similar.</p><p id="P29">Unlike the continent-island model, the two-deme model allows us to include asymmetric local selection and migration (<xref ref-type="fig" rid="F2">Figure 2</xref>). Selection in the focal deme (<italic>s</italic><sub>1</sub>) increases the degree of local adaptation and inversions therefore have a lesser advantage. This effect is strongest when there are more maladapted migrants entering deme 1 (higher <italic>m</italic><sub>21</sub>, <xref ref-type="fig" rid="F2">Figure 2A</xref>) or when the genotypic composition of migrants is more maladapted (higher <italic>s</italic><sub>2</sub>, <xref ref-type="fig" rid="F2">Figure 2C</xref>),but has a weaker effect on inversion invasion probability than parameters that change the genotypic composition of migrants (<italic>m</italic><sub>21</sub> and <italic>s</italic><sub>2</sub>). For a fixed level of migration into deme 1 (<italic>m</italic><sub>21</sub>), the growth rate of the inversion decreases with increasing migration out of deme 1 (<italic>m</italic><sub>12</sub>) because inversions migrate out of the environment in which they are adapted (<xref ref-type="fig" rid="F2">Figure 2B</xref>). Overall, a combination of increased migration from, and selection in, deme 2, are the most important factors in generating the inversion’s advantage (<xref ref-type="fig" rid="F2">Figure 2D</xref>)—exactly the two parameters that are most extreme in the continent-island model.</p></sec><sec id="S8"><title>Combined capture and invasion probability of locally adaptive inversions</title><p id="P30">The analysis above calculates the invasion probability assuming that an inversion captures the <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype. It does not take into account the probability that an inversion occurs in an <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> individual. It seems reasonable to assume that an inversion captures a random haplotype which means that the invasion probability should reflect the relative frequency of <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> as well as its reproductive value in each deme. Under this assumption, both the continent-island and two-deme scenarios predict similar patterns of invasion probabilities. As the strength of selection <italic>s</italic> increases, more locally adaptive genotypes are available to be captured by an inversion (<xref ref-type="fig" rid="F3">Figure 3</xref>). The positive effect of selection on the frequency of locally adapted genotypes (<italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub>) has a larger positive effect on the combined invasion probability than the negative effect of selection on the inversion’s subsequent selective advantage relative to the population (as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>). Thus, our results predict that stronger selection is more likely to drive the evolution of locally adaptive inversions. Importantly, this is true for both scenarions and radically alters the prediction for how inversions should contribute to local adaptation in the continent-island scenario (c.f. <xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P31">We can also see how asymmetric migration or selection affect the combined process of haplotype capture and invasion by inversions. While high migration into deme 1 strongly favours the invasion of existing adaptive inversions (<xref ref-type="fig" rid="F2">Figure 2B</xref>), it also lowers the probability of them arising in the first place, due to the lower frequency of coadapted haplotypes. Thus, adaptive inversions are most likely to form and invade when <italic>m</italic><sub>21</sub> is intermediate, such that the probability of an inversion capturing an adaptive haplotype and the inversion’s subsequent selective advantage are both reasonably large (<xref ref-type="fig" rid="F4">Figure 4A</xref>).</p><p id="P32">Increasing the strength of selection in either deme typically increases the chance that adaptive inversions will arise and spread. Increasing the strength of selection in deme 2 (<italic>s</italic><sub>2</sub>) increases migration load and therefore the inversion’s advantage and increasing selection in deme 1 (<italic>s</italic><sub>1</sub>) increases the probability of capturing the adaptive haplotype (<xref ref-type="fig" rid="F4">Figure 4B</xref>). Yet, as discussed above, <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> inversion invasion probabilities decline under very strong selection in deme 1 (very high <italic>s</italic><sub>1</sub>) by increasing preexisting adaptation. Nevertheless, stronger local selection usually creates a more favourable environment for adaptive inversions to arise and proliferate.</p><p id="P33">So far, we have only considered the evolution of a specific inversion, adaptive in one deme. This is the only plausible scenario in the continent-island scenario, where only inversions that capture the island-adapted haplotype <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> are of interest. However, with two demes, divergent local adaptation can occur from either adaptive inversion, both due to the beneficial effects in the favoured deme and due to the protection from deleterious recombination that such an inversion offers to individuals adapted to the other deme. So in this final section we consider the overall probability of local adaptation through the spread of an inversion that arises anywhere in the population (<inline-formula><mml:math id="M33"><mml:mrow><mml:mtext>Γ</mml:mtext><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>; <xref ref-type="fig" rid="F4">Figure 4C</xref>, <xref ref-type="fig" rid="F4">4D</xref>).</p><p id="P34">Under symmetric local selection, inversions are most likely to establish when migration is symmetric and intermediate (<xref ref-type="fig" rid="F4">Figure 4C</xref>). Migration rates that are favourable for the establishment of inversion in one deme are not so favourable in the other (<italic>γ</italic><sub>22</sub> values can be seen by reflecting <xref ref-type="fig" rid="F4">Figures 4A</xref>, <xref ref-type="fig" rid="F4">4B</xref> across the diagonal) such that symmetric migration rates give the highest overall probability of inversion establishment. Similarly, when migration is symmetric, strong and symmetric local selection is most conducive to the formation and spread of locally adaptive inversions (<xref ref-type="fig" rid="F4">Figure 4D</xref>). Across both demes, this maximises the probability of capturing an adaptive haplotype while maintaining migration load.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P35">Here, we have examined the evolution of locally adaptive chromosomal inversions while explicitly modelling selection across a structured population. Inversions can keep locally favoured allele combinations together in the face of maladapted migrants. Therefore, adaptive inversions spread fastest when migrant alleles are homogeneously maladaptive, as assumed in the continent-island scenario that has been well studied (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>; <xref ref-type="bibr" rid="R7">Charlesworth and Barton 2018</xref>). The continent-island scenario represents an extreme, where migrants are fixed in their genetic composition, being purely maladaptive, with the migration rate alone determining selection for the inversion. In comparison, the two-deme model leads to a number of novel insights. By including the dynamics of selection and migration in the source population, we find that inversions capturing alleles experiencing relatively strong selection are more favoured, unlike the condition found when migration is unidirectional in the continent-island scenario (<xref ref-type="fig" rid="F1">Figure 1</xref>). Extending the model to account for the probability that inversions initially capture favourable haplotypes shows that relatively strong selection is most likely to underlie inversions (<xref ref-type="fig" rid="F3">Figure 3</xref>) and continent-island scenarios aren’t necessarily most conducive to inversion evolution (<xref ref-type="fig" rid="F3">Figure 3</xref>). We further examine asymmetric selection pressures across demes, showing that strong selection in either deme generally promotes the establishment of adaptive inversions by either increasing the selective advantage or the probability of capture (<xref ref-type="fig" rid="F4">Figure 4</xref>). Overall, our results suggest that inversions are particularly likely to arise and establish when selection on locally adaptive alleles is strong.</p><p id="P36">Theories concerning the origins of adaptive inversions can broadly be split into three categories (<xref ref-type="bibr" rid="R41">Schaal, Haller, and Lotterhos 2022</xref>): “capture”, in which an inversion creates a linkage group of existing adaptive variation and spreads (<xref ref-type="bibr" rid="R24">Kirkpatrick and Barton 2006</xref>); “gain”, in which an inversion is initially polymorphic (e.g. due to drift, under dominance, or acquisition of a good genetic background), and then accumulates adaptive variation which is subsequently protected from recombination (e.g. <xref ref-type="bibr" rid="R27">Lamichhaney et al. 2016</xref>, <xref ref-type="bibr" rid="R40">Samuk et al. 2017</xref>); or “generation”, in which adaptive variation is created when the inversion occurs through the breakpoint disrupting coding sequence or gene expression (<xref ref-type="bibr" rid="R16">Feder and Nosil 2009</xref>; <xref ref-type="bibr" rid="R43">Villoutreix et al. 2021</xref>, e.g. <xref ref-type="bibr" rid="R22">Jones et al. 2012</xref>). Our work focuses on the “capture” hypothesis in which locally adaptive alleles are already segregating and have reached migration-selection equilibrium and may have already evolved enhanced local fitness. This scenario is the most analytically tractable, and hence we analyse it here. However there is <italic>a priori</italic> no reason why any inversion with “capture” origins could not subsequently gain more adaptive variation at a later date as set-out in the “gain” hypothesis. In a pure “capture” scenario, we show large effect alleles are the most likely to underlie adaptive inversions.</p><p id="P37">The evolution of the effect size distribution of locally adaptive alleles is likely to favour those that are strongly selected, facilitating the evolution of adaptive inversions. In the short term, locally adaptive alleles must experience fairly strong selection to be able to resist being swamped by migration (<xref ref-type="bibr" rid="R29">Lenormand 2002</xref>; <xref ref-type="bibr" rid="R47">Yeaman 2015</xref>). Small effect alleles can still contribute to local adaptation when they arise in close linkage with large effect alleles, resulting in aggregated regions of adaptation which could be modelled as a single locus of large effect (<xref ref-type="bibr" rid="R48">Yeaman and Whitlock 2011</xref>). Alternatively, they can contribute transiently before being lost (<xref ref-type="bibr" rid="R47">Yeaman 2015</xref>). With high gene flow, and over long timescales, the architecture of local adaptation is expected to evolve towards a few, highly concentrated clusters of small effect alleles linked with large effect alleles (<xref ref-type="bibr" rid="R48">Yeaman and Whitlock 2011</xref>), which are likely to be particularly conducive to inversion establishment.</p><p id="P38">Migration regimes under which inversions are likely to form and spread are fairly specific because they must satisfy multiple requirements. Firstly, we assume that locally adaptive alleles are polymorphic, which means they must be able to resist swamping by migration. This condition requires relatively weak migration and is likely to be a significant constraint on the evolution of local adaptation (<xref ref-type="bibr" rid="R15">Feder, Gejji, et al. 2011</xref>). Then, given that locally adaptive alleles are maintained, higher migration rates favour the spread of inversions because they increase the frequency of the maladaptive alleles and thus the cost of recombination (<xref ref-type="fig" rid="F1">Figures 1</xref>, <xref ref-type="fig" rid="F2">2</xref>). However, this also has the effect of reducing the frequency of adaptive haplotypes so that inversions are less likely to capture a full complement of adaptive alleles (<xref ref-type="fig" rid="F4">Figure 4</xref>). The result is that higher migration rates do not always favour the evolution of inversions. In general, rates of migration may turn out to restrict the evolution of capture-origin inversions more than previously though.</p><p id="P39"><xref ref-type="bibr" rid="R41">Schaal, Haller, and Lotterhos 2022</xref> used simulations to study the invasion of inversions capturing variation that influences a polygenic quantitative trait, finding that inversions involved in local adaptation tended to exhibit more of a capture than a gain effect when alleles were unlikely to be swamped. When alleles were prone to swamping by migration, persisting locally adaptive inversions had often gained much more adaptive variation post-capture. Under high rates of gene flow both capture and gain scenarios are plausible, depending on the effect size of the loci captured. Because adaptive alleles can be gained after the inversion arose and spread, recent inversions may offer the best opportunity to test our predictions about the effect size of alleles driving the evolution of locally adaptive inversions. The allelic content of such inversions could depend on how long the populations in question have been diverging, with the expectation that long periods of divergence results in a more concentrated architecture (<xref ref-type="bibr" rid="R48">Yeaman and Whitlock 2011</xref>). However, separating the individual trait effects of different loci within the inversion is challenging once they have been linked together. Thus, despite the prevalence of putatively adaptive inversions, mapping of quantitative trait loci has been achieved in only a handful of cases (e.g. <xref ref-type="bibr" rid="R37">Peichel and Marques 2017</xref>; <xref ref-type="bibr" rid="R26">Koch et al. 2021</xref>; and <xref ref-type="bibr" rid="R38">Poelstra et al. 2014</xref> for an example unrelated to local adaptation) leaving open questions about the number and effect size of loci that underpin inversion selective advantage (<xref ref-type="bibr" rid="R42">Tigano and Friesen 2016</xref>).</p><p id="P40">We only consider the evolution of inversions that link alleles at two relatively nearby loci. It is possible that an inversion could capture more than two loci that affect local adaptation. As the number of loci contributing towards adaptation increases, it becomes less likely that an inversion will capture all the adaptive alleles on the same haplotype. Nevertheless, inversions will still spread if they capture more locally adaptive alleles than the population mean. A similar process has been proposed for the evolution of inversions that happen to capture fewer deleterious mutations than average (<xref ref-type="bibr" rid="R33">Nei, Kojima, and Schaffer 1967</xref>; <xref ref-type="bibr" rid="R21">Jay et al. 2022</xref>; <xref ref-type="bibr" rid="R30">Lenormand and Roze 2022</xref>). The relationship between invasion fitness and haplotype frequencies as the number of loci increases remains to be explored, but we expect inversion evolution will continue to depend on a balance between the selective advantage of the captured haplotype and on the probability of capturing a favourable haplotype.</p><p id="P41">Our model does not include deleterious mutations or breakpoint effects, which can affect the fate of inversions. Low rates of gene flux within inverted arrangements means that deleterious variation captured by the inversion persists for a long time throughout lineages, as purging this variation relies on rare events such as gene conversion and double crossover events. Inversion breakpoints can also disrupt gene function and result in lower individual fitness (<xref ref-type="bibr" rid="R46">White 1978</xref>; <xref ref-type="bibr" rid="R23">Kirkpatrick 2010</xref>), though this can occasionally be adaptive (e.g. <xref ref-type="bibr" rid="R12">Corbett-Detig 2016</xref>). These effects can be incorporated into the model by introducing a fixed cost or benefit. Reduced recombination within inversions severely weakens the efficacy of purifying selection on new mutations (<xref ref-type="bibr" rid="R6">Charlesworth 1996</xref>; <xref ref-type="bibr" rid="R4">Betancourt, Welch, and Charlesworth 2009</xref>). Mutation accumulation is particularly important while the inversion is at low frequency, because most inverted chromosomes will occur in heterokaryotypes where recombination is suppressed (<xref ref-type="bibr" rid="R32">Navarro, Barbadilla, and Ruiz 2000</xref>), though gene conversion and double crossover events may alleviate this a little (<xref ref-type="bibr" rid="R3">Berdan et al. 2021</xref>). We model a haploid population, but in diploids the presence and accumulation of strong recessive mutations within inversion will result in negative frequency-dependent selection which limits inversion frequency and the recombination rate (<xref ref-type="bibr" rid="R33">Nei, Kojima, and Schaffer 1967</xref>; <xref ref-type="bibr" rid="R44">Wasserman 1968</xref>; <xref ref-type="bibr" rid="R34">Ohta 1971</xref>). The generally deleterious effects associated with inversions likely mean that their invasion probabilities are much lower than we obtain here.</p><p id="P42">In summary, our results emphasise the likelihood that strongly selected loci can contribute to local adaptation in two ways: by increasing the frequency of adaptive haplotypes that can be captured by an inversion, and by increasing the rate of migrant gene flow and thus the potential cost of recombination. High migration rates also increase this recombination load and thus the selective advantage of an inversion, but this also reduces the frequency of adaptive haplotypes. The probability of adaptive inversion formation could be as important as its selective advantage in determining where such inversions are likely to be found.</p></sec></body><back><ack id="S10"><title>Acknowledgesments</title><sec id="S11"><title>Funding</title><p>CM is supported by funding from CoMPLEX and an Engineering and Physical Sciences Research Council studentship (EP/N509577/1). MFS is supported by a Leverhulme Trust Early Career Fellowship (ECF-2020-095). AP is supported by funding from the Engineering and Physical Sciences Research Council (EP/F500351/1, EP/I017909/1), Natural Environment Research Council 400 (NE/R010579/1) and Biotechnology and Biological Sciences Research Council (BB/V003542/1).</p></sec></ack><sec id="S12" sec-type="data-availability"><title>Data availability</title><p id="P43">A Mathematica notebook containing derivations and code used to generate figures is available as File S1.</p></sec><ref-list><title>Bibliography</title><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akerman</surname><given-names>A</given-names></name><name><surname>Bürger</surname><given-names>R</given-names></name></person-group><article-title>The consequences of gene flow for local adaptation and differentiation: a two-locus two-deme model</article-title><source>Journal of Mathematical Biology</source><year>2014</year><volume>68</volume><issue>5</issue><fpage>1135</fpage><lpage>1198</lpage><pub-id pub-id-type="pmcid">PMC3948587</pub-id><pub-id pub-id-type="pmid">23532261</pub-id><pub-id pub-id-type="doi">10.1007/s00285-013-0660-z</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayala</surname><given-names>D</given-names></name><name><surname>Guerrero</surname><given-names>RF</given-names></name><name><surname>Kirkpatrick</surname><given-names>M</given-names></name></person-group><article-title>Reproductive isolation and local adaptation quantified for a chromosome inversion in a malaria mosquito</article-title><source>Evolution</source><year>2013</year><volume>67</volume><issue>4</issue><fpage>946</fpage><lpage>958</lpage><pub-id pub-id-type="pmid">23550747</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berdan</surname><given-names>EL</given-names></name><etal/></person-group><article-title>Deleterious mutation accumulation and the long-term fate of chromosomal inversions</article-title><source>PLOS Genetics</source><year>2021</year><volume>17</volume><issue>3</issue><elocation-id>e1009411</elocation-id><pub-id pub-id-type="pmcid">PMC7963061</pub-id><pub-id pub-id-type="pmid">33661924</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009411</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Betancourt</surname><given-names>AJ</given-names></name><name><surname>Welch</surname><given-names>JJ</given-names></name><name><surname>Charlesworth</surname><given-names>B</given-names></name></person-group><article-title>Reduced effectiveness of selection caused by a lack of recombination</article-title><source>Current Biology</source><year>2009</year><volume>19</volume><issue>8</issue><fpage>655</fpage><lpage>660</lpage><pub-id pub-id-type="pmid">19285399</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bürger</surname><given-names>R</given-names></name><name><surname>Akerman</surname><given-names>A</given-names></name></person-group><article-title>The effects of linkage and gene flow on local adaptation: A two-locus continent–island model</article-title><source>Theoretical Population Biology</source><year>2011</year><volume>80</volume><issue>4</issue><fpage>272</fpage><lpage>288</lpage><pub-id pub-id-type="pmcid">PMC3257863</pub-id><pub-id pub-id-type="pmid">21801739</pub-id><pub-id pub-id-type="doi">10.1016/j.tpb.2011.07.002</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlesworth</surname><given-names>B</given-names></name></person-group><article-title>Background selection and patterns of genetic diversity in Drosophila melanogaster</article-title><source>Genetics Research</source><year>1996</year><volume>68</volume><issue>2</issue><fpage>131</fpage><lpage>149</lpage><pub-id pub-id-type="pmid">8940902</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlesworth</surname><given-names>B</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>The spread of an inversion with migration and selection</article-title><source>Genetics</source><year>2018</year><volume>208</volume><issue>1</issue><fpage>377</fpage><lpage>382</lpage><pub-id pub-id-type="pmcid">PMC5753870</pub-id><pub-id pub-id-type="pmid">29158424</pub-id><pub-id pub-id-type="doi">10.1534/genetics.117.300426</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>C</given-names></name><etal/></person-group><article-title>Ecological genomics of <italic>Anopheles gambiae</italic> along a latitudinal cline: a population-resequencing approach</article-title><source>Genetics</source><year>2012</year><volume>190</volume><issue>4</issue><fpage>1417</fpage><lpage>1432</lpage><pub-id pub-id-type="pmcid">PMC3316653</pub-id><pub-id pub-id-type="pmid">22209907</pub-id><pub-id pub-id-type="doi">10.1534/genetics.111.137794</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christmas</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Chromosomal inversions associated with environmental adaptation in honeybees</article-title><source>Molecular Ecology</source><year>2019</year><volume>28</volume><issue>6</issue><fpage>1358</fpage><lpage>1374</lpage><pub-id pub-id-type="pmid">30431193</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Connallon</surname><given-names>T</given-names></name><name><surname>Olito</surname><given-names>C</given-names></name></person-group><article-title>Natural selection and the distribution of chromosomal inversion lengths</article-title><source>Molecular Ecology</source><year>2021</year><volume>31</volume><issue>13</issue><pub-id pub-id-type="pmid">34297880</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Connallon</surname><given-names>T</given-names></name><name><surname>Olito</surname><given-names>C</given-names></name><etal/></person-group><article-title>Local adaptation and the evolution of inversions on sex chromosomes and autosomes</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><year>2018</year><volume>373</volume><issue>1757</issue><elocation-id>20170423</elocation-id><pub-id pub-id-type="pmcid">PMC6125732</pub-id><pub-id pub-id-type="pmid">30150221</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2017.0423</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corbett-Detig</surname><given-names>RB</given-names></name></person-group><article-title>Selection on inversion breakpoints favors proximity to pairing sensitive sites in <italic>Drosophila melanogaster</italic></article-title><source>Genetics</source><year>2016</year><volume>204</volume><issue>1</issue><fpage>259</fpage><lpage>265</lpage><pub-id pub-id-type="pmcid">PMC5012391</pub-id><pub-id pub-id-type="pmid">27343234</pub-id><pub-id pub-id-type="doi">10.1534/genetics.116.190389</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faria</surname><given-names>R</given-names></name><name><surname>Chaube</surname><given-names>P</given-names></name><etal/></person-group><article-title>Multiple chromosomal rearrangements in a hybrid zone between <italic>Littorina saxatilis</italic> ecotypes</article-title><source>Molecular Ecology</source><year>2019</year><volume>28</volume><issue>6</issue><fpage>1375</fpage><lpage>1393</lpage><pub-id pub-id-type="pmcid">PMC6518922</pub-id><pub-id pub-id-type="pmid">30537056</pub-id><pub-id pub-id-type="doi">10.1111/mec.14972</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faria</surname><given-names>R</given-names></name><name><surname>Johannesson</surname><given-names>K</given-names></name><etal/></person-group><article-title>Evolving inversions</article-title><source>Trends in Ecology &amp; Evolution</source><year>2019</year><volume>34</volume><issue>3</issue><fpage>239</fpage><lpage>248</lpage><pub-id pub-id-type="pmid">30691998</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feder</surname><given-names>JL</given-names></name><name><surname>Gejji</surname><given-names>R</given-names></name><etal/></person-group><article-title>Adaptive chromosomal divergence driven by mixed geographic mode of evolution</article-title><source>Evolution</source><year>2011</year><volume>65</volume><issue>8</issue><fpage>2157</fpage><lpage>2170</lpage><pub-id pub-id-type="pmid">21790566</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feder</surname><given-names>JL</given-names></name><name><surname>Nosil</surname><given-names>P</given-names></name></person-group><article-title>Chromosomal inversions and species differences: when are genes affecting adaptive divergence and reproductive isolation expected to reside within inversions?</article-title><source>Evolution</source><year>2009</year><volume>63</volume><issue>12</issue><fpage>3061</fpage><lpage>3075</lpage><pub-id pub-id-type="pmid">19656182</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hager</surname><given-names>ER</given-names></name><etal/></person-group><article-title>A chromosomal inversion contributes to divergence in multiple traits between deer mouse ecotypes</article-title><source>Science</source><year>2022</year><volume>377</volume><issue>6604</issue><fpage>399</fpage><lpage>405</lpage><pub-id pub-id-type="pmcid">PMC9571565</pub-id><pub-id pub-id-type="pmid">35862520</pub-id><pub-id pub-id-type="doi">10.1126/science.abg0718</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harringmeyer</surname><given-names>OS</given-names></name><name><surname>Hoekstra</surname><given-names>HE</given-names></name></person-group><article-title>Chromosomal inversion polymorphisms shape the genomic landscape of deer mice</article-title><source>Nature Ecology &amp; Evolution</source><year>2022</year><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmcid">PMC9715431</pub-id><pub-id pub-id-type="pmid">36253543</pub-id><pub-id pub-id-type="doi">10.1038/s41559-022-01890-0</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>K</given-names></name><name><surname>Andrew</surname><given-names>RL</given-names></name><etal/></person-group><article-title>Multiple chromosomal inversions contribute to adaptive divergence of a dune sunflower ecotype</article-title><source>Molecular Ecology</source><year>2020</year><volume>29</volume><issue>14</issue><fpage>2535</fpage><lpage>2549</lpage><pub-id pub-id-type="pmid">32246540</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>K</given-names></name><name><surname>Rieseberg</surname><given-names>LH</given-names></name></person-group><article-title>Frequency, origins, and evolutionary role of chromosomal inversions in plants</article-title><source>Frontiers in Plant Science</source><year>2020</year><volume>11</volume><pub-id pub-id-type="pmcid">PMC7093584</pub-id><pub-id pub-id-type="pmid">32256515</pub-id><pub-id pub-id-type="doi">10.3389/fpls.2020.00296</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jay</surname><given-names>P</given-names></name><etal/></person-group><article-title>Sheltering of deleterious mutations explains the stepwise extension of recombination suppression on sex chromosomes and other supergenes</article-title><source>PLOS Biology</source><year>2022</year><volume>20</volume><issue>7</issue><elocation-id>e3001698</elocation-id><pub-id pub-id-type="pmcid">PMC9295944</pub-id><pub-id pub-id-type="pmid">35853091</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3001698</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>FC</given-names></name><etal/></person-group><article-title>The genomic basis of adaptive evolution in threespine sticklebacks</article-title><source>Nature</source><year>2012</year><volume>484</volume><issue>7392</issue><fpage>55</fpage><lpage>61</lpage><pub-id pub-id-type="pmcid">PMC3322419</pub-id><pub-id pub-id-type="pmid">22481358</pub-id><pub-id pub-id-type="doi">10.1038/nature10944</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>M</given-names></name></person-group><article-title>How and why chromosome inversions evolve</article-title><source>PLOS Biology</source><year>2010</year><volume>8</volume><issue>9</issue><elocation-id>e1000501</elocation-id><pub-id pub-id-type="pmcid">PMC2946949</pub-id><pub-id pub-id-type="pmid">20927412</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000501</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>N</given-names></name></person-group><article-title>Chromosome inversions, local adaptation and speciation</article-title><source>Genetics</source><year>2006</year><volume>173</volume><issue>1</issue><fpage>419</fpage><lpage>434</lpage><pub-id pub-id-type="pmcid">PMC1461441</pub-id><pub-id pub-id-type="pmid">16204214</pub-id><pub-id pub-id-type="doi">10.1534/genetics.105.047985</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>M</given-names></name><name><surname>Johnson</surname><given-names>T</given-names></name><name><surname>Barton</surname><given-names>N</given-names></name></person-group><article-title>General models of multilocus evolution</article-title><source>Genetics</source><year>2002</year><volume>161</volume><issue>4</issue><fpage>1727</fpage><lpage>1750</lpage><pub-id pub-id-type="pmcid">PMC1462196</pub-id><pub-id pub-id-type="pmid">12196414</pub-id><pub-id pub-id-type="doi">10.1093/genetics/161.4.1727</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>EL</given-names></name><etal/></person-group><article-title>Genetic variation for adaptive traits is associated with polymorphic inversions in Littorina saxatilis</article-title><source>Evolution Letters</source><year>2021</year><volume>5</volume><issue>3</issue><fpage>196</fpage><lpage>213</lpage><pub-id pub-id-type="pmcid">PMC8190449</pub-id><pub-id pub-id-type="pmid">34136269</pub-id><pub-id pub-id-type="doi">10.1002/evl3.227</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamichhaney</surname><given-names>S</given-names></name><etal/></person-group><article-title>Structural genomic changes underlie alternative reproductive strategies in the ruff (Philomachus pugnax)</article-title><source>Nature Genetics</source><year>2016</year><volume>48</volume><issue>1</issue><fpage>84</fpage><lpage>88</lpage><pub-id pub-id-type="pmid">26569123</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C-R</given-names></name><etal/></person-group><article-title>Young inversion with multiple linked QTLs under selection in a hybrid zone</article-title><source>Nature Ecology &amp; Evolution</source><year>2017</year><volume>1</volume><issue>5</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC5607633</pub-id><pub-id pub-id-type="pmid">28812690</pub-id><pub-id pub-id-type="doi">10.1038/s41559-017-0119</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenormand</surname><given-names>T</given-names></name></person-group><article-title>Gene flow and the limits to natural selection</article-title><source>Trends in Ecology &amp; Evolution</source><year>2002</year><volume>17</volume><issue>4</issue><fpage>183</fpage><lpage>189</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenormand</surname><given-names>T</given-names></name><name><surname>Roze</surname><given-names>D</given-names></name></person-group><article-title>Y recombination arrest and degeneration in the absence of sexual dimorphism</article-title><source>Science</source><year>2022</year><volume>375</volume><issue>6581</issue><fpage>663</fpage><lpage>666</lpage><pub-id pub-id-type="pmid">35143289</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lowry</surname><given-names>DB</given-names></name><name><surname>Willis</surname><given-names>JH</given-names></name></person-group><article-title>A widespread chromosomal inversion polymorphism contributes to a major life-history transition, local adaptation, and reproductive isolation</article-title><source>PLOS Biology</source><year>2010</year><volume>8</volume><issue>9</issue><elocation-id>e1000500</elocation-id><pub-id pub-id-type="pmcid">PMC2946948</pub-id><pub-id pub-id-type="pmid">20927411</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000500</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navarro</surname><given-names>A</given-names></name><name><surname>Barbadilla</surname><given-names>A</given-names></name><name><surname>Ruiz</surname><given-names>A</given-names></name></person-group><article-title>Effect of inversionpPolymorphism on the neutral nucleotide variability of linked chromosomal regions in Drosophila</article-title><source>Genetics</source><year>2000</year><volume>155</volume><issue>2</issue><fpage>685</fpage><lpage>698</lpage><pub-id pub-id-type="pmcid">PMC1461098</pub-id><pub-id pub-id-type="pmid">10835391</pub-id><pub-id pub-id-type="doi">10.1093/genetics/155.2.685</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nei</surname><given-names>M</given-names></name><name><surname>Kojima</surname><given-names>K-I</given-names></name><name><surname>Schaffer</surname><given-names>HE</given-names></name></person-group><article-title>Frequency changes of new inversions in populations under mutation-selection equilibria</article-title><source>Genetics</source><year>1967</year><volume>57</volume><issue>4</issue><fpage>741</fpage><lpage>750</lpage><pub-id pub-id-type="pmcid">PMC1211764</pub-id><pub-id pub-id-type="pmid">6082619</pub-id><pub-id pub-id-type="doi">10.1093/genetics/57.4.741</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohta</surname><given-names>T</given-names></name></person-group><article-title>Associative overdominance caused by linked detrimental mutations*</article-title><source>Genetics Research</source><year>1971</year><volume>18</volume><issue>3</issue><fpage>277</fpage><lpage>286</lpage><pub-id pub-id-type="pmid">5158298</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Otto</surname><given-names>SP</given-names></name><name><surname>Whitlock</surname><given-names>MC</given-names></name></person-group><source>Fixation Probabilities and Times eLS</source><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name><year>2013</year></element-citation></ref><ref id="R36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Otto</surname><given-names>SP</given-names></name><name><surname>Day</surname><given-names>T</given-names></name></person-group><source>A Biologist’s Guide to Mathematical Modeling in Ecology and Evolution</source><publisher-name>Princeton University Press</publisher-name><year>2011</year></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peichel</surname><given-names>CL</given-names></name><name><surname>Marques</surname><given-names>DA</given-names></name></person-group><article-title>The genetic and molecular architecture of phenotypic diversity in sticklebacks</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><year>2017</year><volume>372</volume><issue>1713</issue><elocation-id>20150486</elocation-id><pub-id pub-id-type="pmcid">PMC5182418</pub-id><pub-id pub-id-type="pmid">27994127</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2015.0486</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelstra</surname><given-names>JW</given-names></name><etal/></person-group><article-title>The genomic landscape underlying phenotypic integrity in the face of gene flow in crows</article-title><source>Science</source><year>2014</year><volume>344</volume><issue>6190</issue><fpage>1410</fpage><lpage>1414</lpage><pub-id pub-id-type="pmid">24948738</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proulx</surname><given-names>SR</given-names></name><name><surname>Teotónio</surname><given-names>H</given-names></name></person-group><article-title>Selection on modifiers of genetic architecture under migration load</article-title><source>PLOS Genetics</source><year>2022</year><volume>18</volume><issue>9</issue><elocation-id>e1010350</elocation-id><pub-id pub-id-type="pmcid">PMC9484686</pub-id><pub-id pub-id-type="pmid">36070315</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1010350</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samuk</surname><given-names>K</given-names></name><etal/></person-group><article-title>Gene flow and selection interact to promote adaptive divergence in regions of low recombination</article-title><source>Molecular Ecology</source><year>2017</year><volume>26</volume><issue>17</issue><fpage>4378</fpage><lpage>4390</lpage><pub-id pub-id-type="pmid">28667780</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaal</surname><given-names>SM</given-names></name><name><surname>Haller</surname><given-names>BC</given-names></name><name><surname>Lotterhos</surname><given-names>KE</given-names></name></person-group><article-title>Inversion invasions: when the genetic basis of local adaptation is concentrated within inversions in the face of gene flow</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><year>2022</year><volume>377</volume><issue>1856</issue><elocation-id>20210200</elocation-id><pub-id pub-id-type="pmcid">PMC9189506</pub-id><pub-id pub-id-type="pmid">35694752</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2021.0200</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tigano</surname><given-names>A</given-names></name><name><surname>Friesen</surname><given-names>VL</given-names></name></person-group><article-title>Genomics of local adaptation with gene flow</article-title><source>Molecular Ecology</source><year>2016</year><volume>25</volume><issue>10</issue><fpage>2144</fpage><lpage>2164</lpage><pub-id pub-id-type="pmid">26946320</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villoutreix</surname><given-names>R</given-names></name><etal/></person-group><article-title>Inversion breakpoints and the evolution of supergenes</article-title><source>Molecular Ecology</source><year>2021</year><volume>30</volume><issue>12</issue><fpage>2738</fpage><lpage>2755</lpage><pub-id pub-id-type="pmid">33786937</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>M</given-names></name></person-group><article-title>Recombination-induced chromosomal heterosis</article-title><source>Genetics</source><year>1968</year><volume>58</volume><issue>1</issue><fpage>125</fpage><lpage>139</lpage><pub-id pub-id-type="pmcid">PMC1211842</pub-id><pub-id pub-id-type="pmid">5656342</pub-id><pub-id pub-id-type="doi">10.1093/genetics/58.1.125</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wellenreuther</surname><given-names>M</given-names></name><name><surname>Bernatchez</surname><given-names>L</given-names></name></person-group><article-title>Eco-evolutionary genomics of chromosomal inversions</article-title><source>Trends in Ecology &amp; Evolution</source><year>2018</year><volume>33</volume><issue>6</issue><fpage>427</fpage><lpage>440</lpage><pub-id pub-id-type="pmid">29731154</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>White</surname><given-names>MJD</given-names></name></person-group><source>Modes of Speciation</source><publisher-name>W. H. Freeman</publisher-name><year>1978</year></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeaman</surname><given-names>S</given-names></name></person-group><article-title>Local adaptation by alleles of small effect</article-title><source>The American Naturalist</source><year>2015</year><volume>186</volume><issue>S1</issue><fpage>S74</fpage><lpage>S89</lpage><pub-id pub-id-type="pmid">26656219</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeaman</surname><given-names>S</given-names></name><name><surname>Whitlock</surname><given-names>MC</given-names></name></person-group><article-title>The genetic architecture of adaptation under migration–selection balance</article-title><source>Evolution</source><year>2011</year><volume>65</volume><issue>7</issue><fpage>1897</fpage><lpage>1911</lpage><pub-id pub-id-type="pmid">21729046</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>Invasion probabilities approximated to second order in migration and selection for an inversion capturing <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> in each of the symmetric and continent-island scenarios under various rates of migration.. Data with <italic>s</italic> &lt; <italic>m</italic> are excluded as the adaptive alleles may not be at a stable equilibrium. The rate of recombination between the two loci was <italic>r</italic> = 0.15.</p></caption><graphic xlink:href="EMS158244-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> inversion invasion probabilities calculated to second order in migration and selection terms. Where they do not vary, migration parameters are 0.02 and selection parameters are 0.05. Recombination was set to <italic>r</italic> = 0.15.</p></caption><graphic xlink:href="EMS158244-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Combined probability of an inversion arising on an <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype and then invading (<italic>γ</italic><sub>11</sub>). The invasion probabilities from <xref ref-type="fig" rid="F1">Figure 1</xref> are adjusted to account for the frequency and relative reproductive value of <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> in each deme. Equilibria are unstable for <italic>m</italic> &lt; <italic>s</italic>, <italic>r</italic> = 0.15.</p></caption><graphic xlink:href="EMS158244-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Total establishment probability of an adaptive inversion across the whole population.</title><p>A, B: Combined probability of an inversion arising on the <italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> haplotype and then invading (<italic>γ</italic><sub>11</sub>) for asymmetric migration (A) or selection (B). C, D: Probability of an inversion capturing either adaptive haplotype (<italic>A</italic><sub>1</sub><italic>B</italic><sub>1</sub> or <italic>A</italic><sub>2</sub><italic>B</italic><sub>2</sub>) and invading (Γ) for asymmetric migration (C) or selection (D). The continent-island model corresponds to <italic>m</italic><sub>12</sub> = 0 (Y axis in A, C) and the symmetric two-deme model corresponds to the <italic>s</italic><sub>1</sub> = <italic>s</italic><sub>2</sub> diagonal in panels B and D. Unless varying along axes, <italic>m</italic><sub>12</sub> = <italic>m</italic><sub>21</sub> = 0.02 and <italic>s</italic><sub>1</sub> = <italic>s</italic><sub>2</sub> = 0.05. To ensure stability, we vary parameters inthe range where max(<italic>m</italic><sub>12</sub>, <italic>m</italic><sub>21</sub>) &lt; min(<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>), <italic>r</italic> = 0.15.</p></caption><graphic xlink:href="EMS158244-f004"/></fig></floats-group></article>