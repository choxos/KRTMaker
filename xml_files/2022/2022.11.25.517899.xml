<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157641</article-id><article-id pub-id-type="doi">10.1101/2022.11.25.517899</article-id><article-id pub-id-type="archive">PPR575686</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Transcriptional diversity in synaptic gene sets is sufficient to discriminate cortical neuronal identity</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Adam</surname><given-names>Amparo Roig</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>López</surname><given-names>Jose Martínez</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>van der Spek</surname><given-names>Sophie</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><collab>The SYNGO consortium</collab></contrib><contrib contrib-type="author"><name><surname>Sullivan</surname><given-names>Patrick F</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Smit</surname><given-names>August B.</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Verhage</surname><given-names>Matthijs</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">†</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Hjerling-Leffler</surname><given-names>Jens</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">†</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Medical Biochemistry and Biophysics, Division of Molecular Neurobiology, Karolinska Institutet, Stockholm 17177, Sweden</aff><aff id="A2"><label>2</label>Department of Functional Genomics, Center for Neurogenomics and Cognitive Research (CNCR), Amsterdam Neuroscience, VU University Amsterdam, 1081 HV Amsterdam, The Netherlands</aff><aff id="A3"><label>3</label>Department of Molecular and Cellular Neurobiology, Center for Neurogenomics and Cognitive Research (CNCR), Amsterdam Neuroscience, VU University Amsterdam and VU Medical Center, 1081 HV Amsterdam, The Netherlands</aff><aff id="A4"><label>4</label>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet, Stockholm, Sweden</aff><aff id="A5"><label>5</label>Department of Genetics, University of North Carolina, Chapel Hill, NC, 27599-7264, USA</aff><author-notes><corresp id="CR1"><label>†</label>Correspondence: J.H-L., <email>jens.hjerling-leffler@ki.se</email>; M.V., <email>m.verhage@vu.nl</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>26</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>25</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Synapse diversity has been described from different perspectives, ranging from the specific neurotransmitters released, to their diverse biophysical properties and proteome profiles. However, synapse diversity at the transcriptional level has not been systematically identified across all synapse populations in the brain. To quantify postsynaptic and identify specific synaptic features of neuronal cell types we combined the SynGO (Synaptic Gene Ontology) database with single-cell RNA sequencing data of the mouse neocortex. We show that cell types can be discriminated by synaptic genes alone with the same power as all genes. The cell type discriminatory power is not equally distributed across synaptic genes as we could identify functional categories and synaptic compartments with greater cell type specific expression. Synaptic genes, and specific SynGO categories, belonged to three different types of gene modules: gradient expression over all cell types, gradient expression in selected cell types and cell class- or type-specific profiles. This data provides a deeper understanding of synapse diversity in the neocortex and identifies potential markers to selectively identify synapses from specific neuronal populations.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Synapses are the information processing units of the brain and function in a use-dependent manner<sup><xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref></sup>. Synapses are diverse with regards to subcellular targets and physiological properties<sup><xref ref-type="bibr" rid="R3">3</xref></sup> and are central in information processing and storage theories<sup><xref ref-type="bibr" rid="R4">4</xref></sup>. Moreover, brain regions involved in higher cognitive functions, such as the hippocampus and neocortex, contain greater synapse diversity<sup><xref ref-type="bibr" rid="R5">5</xref></sup>. Synapse diversity also overlaps with the connectivity patterns (connectome) between brain areas associated to different functions<sup><xref ref-type="bibr" rid="R5">5</xref></sup>. Thus, understanding synapse diversity is crucial for gaining insights into the mechanisms for information processing in the brain.</p><p id="P3">Neurotransmitters and biophysical properties have traditionally been used for classification of synapses<sup><xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R4">4</xref></sup>. New technologies, including diverse ‘<italic>omics</italic>’, are now uncovering additional layers of complexity and diversity on the molecular signatures of synapses<sup><xref ref-type="bibr" rid="R6">6</xref></sup>. Proteome differences between synapse types correlate with functional diversity (strength, kinetics, or synaptic plasticity)<sup><xref ref-type="bibr" rid="R4">4</xref></sup>. These different molecular profiles include, for example, scaffold proteins PSD95 and SAP102<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup>, and AMPA-type glutamate receptors (AMPARs)<sup><xref ref-type="bibr" rid="R4">4</xref></sup> for postsynaptic terminals of excitatory cells; and Gephyrin (GPHN) and Collybistin (ARHGEF9) scaffold proteins, and the GABA<sub>A</sub> receptors (GABA<sub>A</sub>R) for inhibitory postsynaptic sites<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. On the presynaptic side, synaptotagmins 1 and 2, involved in calcium-dependent vesicle exocytosis, are differentially expressed between synapse types<sup><xref ref-type="bibr" rid="R9">9</xref></sup>. While most previous work is centered on inhibitory and excitatory synapses, recent studies have pointed out the expression of synaptic genes as correlated with neuronal diversity in subpopulations of transcriptomic cell types<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup>.</p><p id="P4">Here, we aim to systematically identify how synaptic gene expression specifies the diversity of neuronal cell types in mouse neocortex using single cell transcriptomics data. Combining the expert-curated, evidence-based SynGO synaptic ontology<sup><xref ref-type="bibr" rid="R12">12</xref></sup> and single cell expression data we could observe that expression of synaptic genes presents a striking diversity. Remarkably, specific biological function and synaptic component gene categories contained significantly high diversity and discrete modules of synaptic genes exhibited different modes of variability revealing that synapse diversity is organized at different levels.</p></sec><sec id="S2" sec-type="methods"><title>Methods</title><sec id="S3"><title>Datasets</title><p id="P5">The single cell RNA-sequencing dataset published by Tasic et al. (2018)<sup><xref ref-type="bibr" rid="R13">13</xref></sup> together with the information available in the SynGO<sup><xref ref-type="bibr" rid="R12">12</xref></sup> database were retrieved for the study the expression of synaptic genes in the neocortex. The scRNA-seq dataset used was generated using the smart-seq RNA-sequencing technique. The tissue used was mouse primary visual cortex and anterior lateral motor cortex and up to 133 transcriptomic cell types and 16 cell classes were identified. The described cell classes include glutamatergic neurons, labeled according to their preferential layer of residence (for example Layer 4 neurons are labelled as L4) and their projection pattern (intratelencephalic, IT; pyramidal tract, PT; near-projecting, NP; and corticothalamic, CT) and GABAergic neurons labelled with their predominant expressed gene including: Sst, Pvalb, Vip, Lamp5, Sncg and Serpinf1<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. The first release of the expert-curated synaptic gene ontology, SynGO1.0 was used<sup><xref ref-type="bibr" rid="R12">12</xref></sup>. SynGO1.0 contains 1112 unique human genes annotated to 2918 terms hierarchically organized and divided into ‘Cellular Components’ and ‘Biological Processes’ related to the synapse. These annotated synaptic genes encode evidenced proteins that localize to synaptic compartments and contribute to synaptic functions.</p></sec><sec id="S4"><title>Pre-processing and visualization</title><p id="P6">The scRNA-seq data were filtered to keep only the cells belonging to the classes ‘GABAergic’ and ‘Glutamatergic’ (n = 22439 cells) and expression data of the synaptic genes included in SynGO (1049 genes). Three subsets of the data were used for the downstream analysis separately by filtering the genes in the original dataset according to the following gene sets: all synaptic genes present in the SynGO database, SynGO presynaptic genes and SynGO postsynaptic genes.</p><p id="P7">Each of the filtered datasets was pre-processed with the standard protocol used by the Seurat<sup><xref ref-type="bibr" rid="R14">14</xref></sup> R package as follows: log-normalization and scaling (scaling factor = 10000) of the raw count data, identification of highly variable genes, PCA dimensionality reduction, selection of significant principal components (PCs) by the Jackstraw procedure, and tSNE (t-distributed Stochastic Neighbor Embedding) dimensionality reduction/visualization (perplexity = 50). The significant PCs determined for each data subset were: 60 PCs for the full dataset, 42 PCs for the dataset with all synaptic genes and 21 PCs for both datasets with the pre- and postsynaptic genes. No quality filtering was performed on the cells since the dataset used was already passing the quality criteria in Tasic et al. (2018). The tSNE embedding of the data were color coded with the cluster identities determined by Tasic et al. (2018).</p></sec><sec id="S5"><title>Synaptic function and localisation (SynGO annotations) underlying diversity</title><p id="P8">MetaNeighbor<sup><xref ref-type="bibr" rid="R15">15</xref></sup> was used to measure the power of each of the SynGO annotations to discriminate between different cell types. For each gene set (or SynGO annotated term), AUROC (Area Under the Receiver Operator Curve) scores were calculated for each of the 16 described cell types. To do so, random samples of the dataset were taken to train (2/3) the algorithm and test (1/3) the gene sets. Only those gene sets with at least 2 genes were used in this analysis. The result is an AUROC score for each gene set that can be interpreted as the performance of the gene set for the task of identifying each cell type, with 0.5 being equivalent to a random guess.</p><p id="P9">To calculate the statistical significance of the AUROC scores, the performance of random gene sets in MetaNeighbor was compared to that obtained with the SynGO annotations by generating random gene sets of the same size. For each gene set size in SynGO 10000 gene sets were generated by sampling from all the genes expressed in the original dataset, as well as all genes found in SynGO. For each of these randomly generated gene sets the ‘fast_version’ of MetaNeighbor was used. Firstly, the AUROC scores were used to compare the average performance of random gene sets and random synaptic gene sets of each size. Secondly, the random synaptic gene sets were used to calculate the statistical significance of the SynGO annotation scorings by calculating an empirical p-value. As indicated in <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>, this is done by calculating the fraction of scores from the randomized gene sets that are higher than the scores of the SynGO annotations. To calculate this as the overall score across all cell types, the score used for the p-value calculation was the sum of the AUROC scores in the 16 cell types. Likewise, we calculated the empirical p-value of SynGO annotations performing significantly worse than random gene sets (fraction of AUROC scores from randomized synaptic gene sets lower than the scores of SynGO annotations). <disp-formula id="FD1"><label>(Eq. 1)</label><mml:math id="M1"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mspace width="0.2em"/><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mo>{</mml:mo><mml:mi>∑</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mo>≥</mml:mo><mml:mi>∑</mml:mi><mml:mi>S</mml:mi><mml:mi>Y</mml:mi><mml:mi>n</mml:mi><mml:mi>G</mml:mi><mml:mi>O</mml:mi><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mtext>}</mml:mtext></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>;</mml:mo><mml:mspace width="0.2em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>N</mml:mtext><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:mtext>total</mml:mtext><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext>number</mml:mtext><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mtext>random</mml:mtext><mml:mspace width="0.2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.2em"/><mml:mtext>permutations</mml:mtext><mml:mspace width="0.2em"/><mml:mo>(</mml:mo><mml:mn>10000</mml:mn><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></sec><sec id="S6"><title>Quantification of cell type diversity encoded by synaptic genes</title><p id="P10">To measure and compare the cell type diversity observed with different gene sets MetaNeighbor analysis was performed as described in the previous section. The quantified gene sets included the most high variable genes among: all genes in the dataset, non-synaptic genes (defined as all genes excluding the genes in SynGO), all synaptic genes, presynaptic genes, postsynaptic genes and mitochondrial genes (all genes included in the dataset and annotated in MitoCarta<sup><xref ref-type="bibr" rid="R18">18</xref></sup>). AUROC scores were calculated for each gene set and cell type, as well as for every cell class. Wilcoxon rank test (followed by false discovery rate [FDR] correction) was used to determine statistically different performance of each pair of gene sets.</p></sec><sec id="S7"><title>Synapse gene correlation network analysis</title><p id="P11">Weighted gene correlation network analysis (WCGNA) was used to investigate modules of synaptic genes in the transcriptional network of the dataset. In brief, the standard pipeline from the WGCNA<sup><xref ref-type="bibr" rid="R16">16</xref></sup> R package was used to perform hierarchical clustering on the distance between every gene pair, calculated as 1-TOM (topological overlap matrix). To generate the TOM matrix, the co-expression similarity matrix is raised to a soft thresholding power (adjacency) that approximates a scale-free topology while keeping the mean connectivity of the network (ß = 4)<sup><xref ref-type="bibr" rid="R17">17</xref></sup>. Finally, the clustered genes are grouped into modules of highly interconnected genes using a dynamic branch-cutting algorithm. We used the dynamic tree cutting function (maximum height 0.9, 0.95, 0.98) and the modules were selected from a consensus of the result.</p><p id="P12">The gene modules were classified using K-means clustering on the eigenvector that explains the variance of gene expression in each cell type (80.3% variability explained). To do so, the average gene expression of each module in each cell was used to calculate the variance of expression for each gene module in each cluster. Next, the cell type identity information was removed, and the variance matrix ordered. The eigenvector explaining the maximum variability in the data (PC1) was used to cluster the modules in groups of similar variances of gene expression.</p><p id="P13">The individual gene modules were characterized using two approaches: mapping the average expression of the module to the synaptic types and annotating the function or cellular compartment they are related to by gene ontology enrichment. The former was done by mapping the average expression of all genes in each module, normalized to the average expression of random genes, to the transcriptomic cell types and visualizing it in the tSNE generated using only synaptic genes. To map the function and cellular component most related to each gene module, hypergeometric gene set enrichment was used. The background used for this analysis (universe) was comprised by all the genes annotated in SynGO that were present in the Tasic et al. (2018) dataset. The significance scores (p-value) from the hypergeometric tests were adjusted for multiple hypothesis testing using the Bonferroni correction method. Lastly, visualization of the test results for every gene module was produced with the sunburst custom color-coding tool of SynGO ontologies<sup><xref ref-type="bibr" rid="R12">12</xref></sup>.</p></sec></sec><sec id="S8" sec-type="results"><title>Results</title><sec id="S9"><title>Synapse genes contain cell identity information</title><p id="P14">To evaluate transcriptional diversity of synaptic genes in neuronal cell types, we filtered the expression data of cell types identified by Tasic et al. (2018) using the genes in SynGO. We analyzed four gene sets, including all genes in the original dataset (<xref ref-type="fig" rid="F1">Fig 1A</xref>), all synaptic genes in SynGO (<xref ref-type="fig" rid="F1">Fig 1B</xref>), presynaptic genes in SynGO (<xref ref-type="fig" rid="F1">Fig 1C</xref>) and postsynaptic genes in SynGO (<xref ref-type="fig" rid="F1">Fig 1D</xref>). We then compared the cell class and cell type diversity across the four different subsets. Here, we refer to the 133 transcriptomic neuronal types described in Tasic et al. (2018) as cell types (different colors in <xref ref-type="fig" rid="F1">Fig 1</xref>) and 16 merged groups of these cell types as cell classes. Distinct classes and cell types could be discerned using SynGO genes only and all genes in the dataset to a similar extent (<xref ref-type="fig" rid="F1">Fig 1A,B</xref>). Additionally, the observed transcriptomic diversity of presynaptic (<xref ref-type="fig" rid="F1">Fig 1C</xref>) and postsynaptic (<xref ref-type="fig" rid="F1">Fig 1D</xref>) genes showed similar levels of cell type specification. Quantification of the class and cell type discriminatory power of synaptic gene expression was calculated as the cell classification performance of each gene set using MetaNeighbor<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. We included a similar sized gene-set from MitoCarta<sup><xref ref-type="bibr" rid="R18">18</xref></sup> as comparison. Synaptic genes had a similar power in discerning classes and cell types in comparison to all genes or after removing SynGO genes (<xref ref-type="fig" rid="F1">Fig 1E,F</xref>). We observed no difference in the discriminatory power between presynaptic and postsynaptic gene sets (<xref ref-type="fig" rid="F1">Fig 1E, F</xref>). Similarly, no difference was observed when measuring pre- and post-synaptic genes in excitatory and inhibitory neurons independently (<xref ref-type="supplementary-material" rid="SD1">Suppl Fig 1A</xref>). However, there is a considerable overlap between the terms pre- and post-synaptic genes. Comparing only the genes specific for each category revealed a significantly higher score of postsynaptic genes for inhibitory neurons (<xref ref-type="supplementary-material" rid="SD1">Suppl Fig 1 B,C</xref>). This suggests that postsynaptic diversity is larger among GABAergic cells. These results indicate that the diversity of the synapse transcriptome across cell types is similar to that of the full transcriptome.</p></sec><sec id="S10"><title>Specific SynGO annotations underlie synapse diversity</title><p id="P15">To identify whether genes contributing to synapse diversity belong to specific functional sets or are expressed in specific synaptic compartments, we analyzed the cell type discriminatory power of annotated SynGO terms. To test this, we used MetaNeighbor<sup><xref ref-type="bibr" rid="R15">15</xref></sup> to score the performance of each SynGO term on the task of discriminating different cell types (AUROC scores) and compared it to random sets (of equivalent size) of genes drawn from SynGO and from all expressed genes in the dataset (<xref ref-type="fig" rid="F2">Fig 2</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl Fig 2A</xref>). Several SynGO terms in both biological functions (BP, <xref ref-type="fig" rid="F2">Fig 2B</xref>) and cellular components (CC, <xref ref-type="fig" rid="F2">Fig 2C</xref>) discriminated cell types significantly better than random gene sets. Among the top biological process annotations are elements of the postsynaptic density organization, synaptic signaling, modulation of presynaptic chemical transmission and synaptic vesicle exocytosis. For cellular localisation, both presynaptic and postsynaptic membranes, as well as the presynaptic cytosol and active zone membrane were significant. A few categories conversely performed worse than random, including ribosomal genes and genes involved in metabolism (<xref ref-type="supplementary-material" rid="SD1">Suppl. Fig 2B,C</xref>). Analysis of average expression per category could not explain this result (<xref ref-type="supplementary-material" rid="SD1">Suppl Fig 2D,E</xref>). This analysis confirmed that synaptic genes perform better, on average, in cell type identification analysis than gene sets comprised of any gene expressed in the data also when normalising for number of genes. These results show that synapse diversity among different neuronal types accumulates in specific functions and cellular components.</p></sec><sec id="S11"><title>Gene network analysis reveals different levels of synaptic organisation</title><p id="P16">WGCNA analysis and hierarchical clustering of the gene co-expression network revealed a high level of modularity of synaptic genes (<xref ref-type="fig" rid="F3">Fig 3A</xref>). Classification of the gene modules according to the eigenvector calculated from the variance of gene expression across cell types (<xref ref-type="fig" rid="F3">Fig. 3B</xref>), showed that synaptic gene modules can be clustered into three types: modules with specific expression in cell types or cell classes (discrete modules), modules showing a gradient of expression in a specific cell class (intermediate gradients) and modules with a similar gradient of expression in all cell types (pure gradients). Notably, these different classes of diversity were similarly found in pre- and postsynaptic gene modules. The results from this analysis were mapped to cell types using the average expression of the gene module in each cell (<xref ref-type="fig" rid="F3">Fig 3E,G,I</xref>; <xref ref-type="supplementary-material" rid="SD1">Supp Fig 3</xref>). Interestingly, we observed modules with cell type specific expression in Vip-cells, sometimes shared with other cell types including Sncg-cells (pink; <xref ref-type="fig" rid="F3">Fig 3I</xref>) and near projecting cells (dark green; <xref ref-type="supplementary-material" rid="SD1">Supp Fig 3</xref>). This suggest that some synaptic specializations can be re-used between GABAergic cell types and across GABAergic and excitatory cell types. In addition, gene set enrichment analysis of the obtained gene modules showed the biological processes and cell compartments (SynGO terms) to which each gene module is most related (<xref ref-type="fig" rid="F3">Fig 3D,F,H</xref>). Interestingly, none of the enriched SynGO terms in the different groups of modules are overlapping between groups. Modules exhibiting gradients of expression included terms related to metabolism, post- and pre-synaptic ribosome, and protein translation (similar to those terms indicated in <xref ref-type="supplementary-material" rid="SD1">Suppl 2B</xref>). Interestingly we observed two gradient modules with opposing expression pattern (<xref ref-type="fig" rid="F3">Fig 3C</xref>) suggesting that these are specific programs that are anti-regulated, perhaps in response to external signals or each other. This included the genes CTBP1 and ARL8 involved in “presynapse to nucleus signaling pathway” and “regulation of anterograde synaptic vesicle transport respectively” (yellow module), opposing the expression pattern of ribosomal and translational machinery genes (turquoise module). These results suggest that there are different types of synaptic organisation, ranging from cell type-specific to pan-neuronal programs, specified by distinct sets of genes at the transcriptome level, which also involve specific cellular functions.</p></sec></sec><sec id="S12" sec-type="discussion"><title>Discussion</title><p id="P17">In this study, synapse diversity was mapped to previously defined transcriptomic neuronal cell types. We found that synaptic genes contain considerable cell identity information at the transcriptome level. Among synaptic genes, certain groups of genes associated to specific synaptic functions and localisation, annotated as SynGO terms, underlie the observed synapse diversity. Moreover, we identified additional candidate modules of co-expressed genes that contribute to synaptic functional diversity. These gene modules suggest different types of synapse organisation or different hierarchies of synaptic specification.</p><p id="P18">These results agree with the proposed vast synapse diversity arising from the combination of the different proteins that have been described as part of the synapse proteome<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R19">19</xref></sup>. Therefore, transcriptomic synapse diversity exists to a deeper extent of that depicted by the classical classifications of synapse types, possibly integrating the anatomical and physiological features classically described, as proposed for GABAergic interneurons in previous studies<sup><xref ref-type="bibr" rid="R11">11</xref></sup>.</p><p id="P19">We observed cell type-related diversity in both the pre- and postsynaptic genes. Our findings add additional gene-level resolution to the postsynaptic site diversity previously proposed in the brain based on protein expression of <italic>Dlg4</italic> (PSD95) and <italic>Dlg3</italic> (SAP102)<sup><xref ref-type="bibr" rid="R5">5</xref></sup>. Additionally, our data highlights the existence of such diversity also in the presynaptic site, showing a similar molecular diversity.</p><p id="P20">Our results show that synapse diversity, as well as similarity, between different cell types resides in specific synaptic functions and components. We identified cytoskeleton organisation, cell adhesion and synaptic signaling, as important for synapse diversity. As expected, we observed gene modules specific to excitatory/inhibitory synapse classification but also gene modules being specific to neuronal classes and neuronal types. An additional layer of diversity seems to be related to gradient-like expression of gene modules within each cell type, and surprisingly gene modules showing opposing expression which is likely an indication of dynamic synapse regulation as proposed by Zu F et al (2018)<sup><xref ref-type="bibr" rid="R5">5</xref></sup>.</p><p id="P21">Despite the single-neuron synapse diversity depicted here, recent studies have also described synapse diversity within a single neuron<sup><xref ref-type="bibr" rid="R6">6</xref></sup>. It is our hope that our results broaden the understanding of synapse diversity and generate hypothesis for future single synapse research. As an example, gene modules showing gradient expression profiles within cell types could reflect different cell states of the same cell types, in which single synapse variability could have a role. Our study provides the opportunity to expand the knowledge on the specific synaptic profile of distinct cell types. Further work in this direction could be used to selectively identify populations of synapses derived from specific populations of neuronal cell types, in intact tissue as well as in disease models.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS157641-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d32aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgements</title><p>J.H.-L. was funded by the Swedish Research Council (Vetenskapsrådet, award 2018-00799), European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (Grant agreement No. 819540), and the Swedish Brain Foundation (Hjärnfonden). M.V., A.B.S. and A.R.A. were funded by the Broad Synapse 3 project (6910259-5500000759) and the Simons foundation SFARI director's grant (882976).</p></ack><sec id="S14" sec-type="data-availability"><title>Code availability</title><p id="P22"><ext-link ext-link-type="uri" xlink:href="https://github.com/Hjerling-Leffler-Lab/SynGO_scRNAseq">https://github.com/Hjerling-Leffler-Lab/SynGO_scRNAseq</ext-link></p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Regehr</surname><given-names>WG</given-names></name></person-group><article-title>Synaptic computation</article-title><source>Nature</source><year>2004</year><volume>431</volume><issue>7010</issue><fpage>796</fpage><lpage>803</lpage><pub-id pub-id-type="pmid">15483601</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackman</surname><given-names>SL</given-names></name><name><surname>Regehr</surname><given-names>WG</given-names></name></person-group><article-title>The Mechanisms and Functions of Synaptic Facilitation</article-title><source>Neuron</source><year>2017</year><volume>94</volume><issue>3</issue><fpage>447</fpage><lpage>464</lpage><pub-id pub-id-type="pmcid">PMC5865607</pub-id><pub-id pub-id-type="pmid">28472650</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2017.02.047</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kubota</surname><given-names>Y</given-names></name><name><surname>Karube</surname><given-names>F</given-names></name><name><surname>Nomura</surname><given-names>M</given-names></name><name><surname>Kawaguchi</surname><given-names>Y</given-names></name></person-group><article-title>The Diversity of Cortical Inhibitory Synapses</article-title><source>Front Neural Circuits</source><year>2016</year><volume>10</volume><elocation-id>27</elocation-id><pub-id pub-id-type="pmcid">PMC4842771</pub-id><pub-id pub-id-type="pmid">27199670</pub-id><pub-id pub-id-type="doi">10.3389/fncir.2016.00027</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Rourke</surname><given-names>NA</given-names></name><name><surname>Weiler</surname><given-names>NC</given-names></name><name><surname>Micheva</surname><given-names>KD</given-names></name><name><surname>Smith</surname><given-names>SJ</given-names></name></person-group><article-title>Deep molecular diversity of mammalian synapses: why it matters and how to measure it</article-title><source>Nat Rev Neurosci</source><year>2012</year><volume>13</volume><issue>6</issue><fpage>365</fpage><lpage>379</lpage><pub-id pub-id-type="pmcid">PMC3670986</pub-id><pub-id pub-id-type="pmid">22573027</pub-id><pub-id pub-id-type="doi">10.1038/nrn3170</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>F</given-names></name><name><surname>Cizeron</surname><given-names>M</given-names></name><name><surname>Qiu</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Architecture of the Mouse Brain Synaptome</article-title><source>Neuron</source><year>2018</year><volume>99</volume><issue>4</issue><fpage>781</fpage><lpage>799</lpage><elocation-id>e10</elocation-id><pub-id pub-id-type="pmcid">PMC6117470</pub-id><pub-id pub-id-type="pmid">30078578</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2018.07.007</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>SGN</given-names></name><name><surname>Fransén</surname><given-names>E</given-names></name></person-group><article-title>The Synapse Diversity Dilemma: Molecular Heterogeneity Confounds Studies of Synapse Function</article-title><source>Front Synaptic Neurosci</source><year>2020</year><volume>12</volume><fpage>45</fpage><pub-id pub-id-type="pmcid">PMC7561708</pub-id><pub-id pub-id-type="pmid">33132891</pub-id><pub-id pub-id-type="doi">10.3389/fnsyn.2020.590403</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Broadhead</surname><given-names>MJ</given-names></name><name><surname>Bonthron</surname><given-names>C</given-names></name><name><surname>Arcinas</surname><given-names>L</given-names></name><etal/></person-group><article-title>Nanostructural Diversity of Synapses in the Mammalian Spinal Cord</article-title><source>Sci Rep</source><year>2020</year><volume>10</volume><issue>1</issue><elocation-id>8189</elocation-id><pub-id pub-id-type="pmcid">PMC7235094</pub-id><pub-id pub-id-type="pmid">32424125</pub-id><pub-id pub-id-type="doi">10.1038/s41598-020-64874-9</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crosby</surname><given-names>KC</given-names></name><name><surname>Gookin</surname><given-names>SE</given-names></name><name><surname>Garcia</surname><given-names>JD</given-names></name><name><surname>Hahm</surname><given-names>KM</given-names></name><name><surname>Dell’Acqua</surname><given-names>ML</given-names></name><name><surname>Smith</surname><given-names>KR</given-names></name></person-group><article-title>Nanoscale Subsynaptic Domains Underlie the Organization of the Inhibitory Synapse</article-title><source>Cell Rep</source><year>2019</year><volume>26</volume><issue>12</issue><fpage>3284</fpage><lpage>3297</lpage><elocation-id>e3</elocation-id><pub-id pub-id-type="pmcid">PMC6529211</pub-id><pub-id pub-id-type="pmid">30893601</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2019.02.070</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Südhof</surname><given-names>TC</given-names></name></person-group><article-title>THE SYNAPTIC VESICLE CYCLE</article-title><source>Annu Rev Neurosci</source><year>2004</year><volume>27</volume><issue>1</issue><fpage>509</fpage><lpage>547</lpage><pub-id pub-id-type="pmid">15217342</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Hochgerner</surname><given-names>H</given-names></name><name><surname>Lönnerberg</surname><given-names>P</given-names></name><etal/></person-group><article-title>Molecular Architecture of the Mouse Nervous System</article-title><source>Cell</source><year>2018</year><volume>174</volume><issue>4</issue><fpage>999</fpage><lpage>1014</lpage><elocation-id>e22</elocation-id><pub-id pub-id-type="pmcid">PMC6086934</pub-id><pub-id pub-id-type="pmid">30096314</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.06.021</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Raudales</surname><given-names>R</given-names></name><etal/></person-group><article-title>Transcriptional Architecture of Synaptic Communication Delineates GABAergic Neuron Identity</article-title><source>Cell</source><year>2017</year><volume>171</volume><fpage>522</fpage><lpage>525</lpage><elocation-id>e20</elocation-id><pub-id pub-id-type="pmcid">PMC5772785</pub-id><pub-id pub-id-type="pmid">28942923</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2017.08.032</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koopmans</surname><given-names>F</given-names></name><name><surname>van Nierop</surname><given-names>P</given-names></name><name><surname>Andres-Alonso</surname><given-names>M</given-names></name><etal/></person-group><article-title>SynGO: An Evidence-Based, Expert-Curated Knowledge Base for the Synapse</article-title><source>Neuron</source><year>2019</year><volume>103</volume><issue>2</issue><fpage>217</fpage><lpage>234</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC6764089</pub-id><pub-id pub-id-type="pmid">31171447</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2019.05.002</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Graybuck</surname><given-names>LT</given-names></name><etal/></person-group><article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title><source>Nature</source><year>2018</year><volume>563</volume><issue>7729</issue><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="pmcid">PMC6456269</pub-id><pub-id pub-id-type="pmid">30382198</pub-id><pub-id pub-id-type="doi">10.1038/s41586-018-0654-5</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title><source>Nat Biotechnol</source><year>2018</year><volume>36</volume><issue>5</issue><fpage>411</fpage><lpage>420</lpage><pub-id pub-id-type="pmcid">PMC6700744</pub-id><pub-id pub-id-type="pmid">29608179</pub-id><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Ballouz</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name></person-group><article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><issue>1</issue><elocation-id>884</elocation-id><pub-id pub-id-type="pmcid">PMC5830442</pub-id><pub-id pub-id-type="pmid">29491377</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><issue>1</issue><fpage>559</fpage><pub-id pub-id-type="pmcid">PMC2631488</pub-id><pub-id pub-id-type="pmid">19114008</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>A General Framework for Weighted Gene Co-Expression Network Analysis</article-title><source>Stat Appl Genet Mol Biol</source><year>2005</year><volume>4</volume><issue>1</issue><pub-id pub-id-type="pmid">16646834</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rath</surname><given-names>S</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name><name><surname>Gupta</surname><given-names>R</given-names></name><etal/></person-group><article-title>MitoCarta3.0: an updated mitochondrial proteome now with sub-organelle localization and pathway annotations</article-title><source>Nucleic Acids Res</source><year>2021</year><volume>49</volume><issue>D1</issue><fpage>D1541</fpage><lpage>D1547</lpage><pub-id pub-id-type="pmcid">PMC7778944</pub-id><pub-id pub-id-type="pmid">33174596</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkaa1011</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>SGN</given-names></name></person-group><article-title>Toward a molecular catalogue of synapses</article-title><source>Brain Res Rev</source><year>2007</year><volume>55</volume><issue>2</issue><fpage>445</fpage><lpage>449</lpage><pub-id pub-id-type="pmid">17572504</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Neuronal diversity is recovered using only synaptic genes.</title><p>t-SNE embedding visualization of the dataset from Tasic et.al. (2018) using the most variable genes among (A) all genes in the dataset, (B) only synaptic genes annotated in SynGO, (C) only presynaptic genes or (D) only postsynaptic genes, allow distinction of the annotated cell types to a similar extent. Dotted lines indicate cell classes and colors correspond to cell types described in Tasic et.al. (2018). Quantification was performed by calculating the cell class (E) and cell type (F) discriminatory power of each gene set in the MetaNeighbor pipeline. Wilcoxon rank test was used to determine statistically different performance of each pair of gene sets (*: p &lt;= 0.05; **: p &lt;= 0.01; ***: p &lt;= 0.001; ****: p &lt;= 0.0001).</p></caption><graphic xlink:href="EMS157641-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Synapse diversity resides in specific functions and cellular compartments.</title><p>For all SynGO categories, the mean AUROC score across the 16 cell types is shown for biological functions (A) and cellular compartments (C) annotated in SynGO. Some SynGO terms (red) perform better than random synaptic gene sets of the same size (black line). Randomly generated synaptic gene sets (black line) discriminate cell types better than random gene sets (grey line) regardless the set size (Wilcoxon rank sum test; W = 3049, p = 0.001). The sunburst plots show the SynGO biological processes (B) and cellular compartments (D) where most variability lies across all neuronal subclasses. The color code (p-value) indicates SynGO terms that perform significantly better than random synaptic gene sets of the same size.</p></caption><graphic xlink:href="EMS157641-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>WGCNA reveals different levels of synaptic organisation: pure gradients within cell types, intermediate gradients and discrete expression in specific cell types and cell classes.</title><p>(A) WGCNA dendrogram and gene modules selected. (B) Density distribution of the eigenvector (PC1) that explains the variance of gene expression across cell types in the gene modules (80.3% variance explained). Colour coding corresponds to the K-means gene module classification according to their greediness across cell types. (C) Anticorrelation of the average gene expression of the turquoise and yellow gradient modules. (D, F, H) Sunburst plots showing the biological functions (left) and cellular components (right) for which the gene modules of each type show enrichment. Dark grey indicates non-significant SynGO terms that contain genes in the modules, and coloured SynGO terms indicate enrichment in one of the gene modules. (E, G, I) tSNE plot of example modules within each group colour coded with the average gene expression of the genes in each module.</p></caption><graphic xlink:href="EMS157641-f003"/></fig></floats-group></article>