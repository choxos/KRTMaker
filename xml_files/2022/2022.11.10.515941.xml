<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157079</article-id><article-id pub-id-type="doi">10.1101/2022.11.10.515941</article-id><article-id pub-id-type="archive">PPR570788</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A machine-learning tool to identify bistable states from calcium imaging data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Varma</surname><given-names>Aalok</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Udupa</surname><given-names>Sathvik</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Sengupta</surname><given-names>Mohini</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">#</xref></contrib><contrib contrib-type="author"><name><surname>Ghosh</surname><given-names>Prasanta Kumar</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Thirumalai</surname><given-names>Vatsala</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>National Centre for Biological Sciences, Tata Institute of Fundamental Research, Bellary Road, Bangalore 560065</aff><aff id="A2"><label>2</label>Department of Electrical Engineering Indian Institute of Science Bangalore - 560 012</aff><author-notes><corresp id="CR1"><label>*</label>Correspondence: <email>vatsala@ncbs.res.in</email></corresp><fn fn-type="present-address" id="FN1"><label>#</label><p id="P1">Current Address: Washington University School of Medicine in St Louis 660 S Euclid Ave, St. Louis, MO 63110.</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>15</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>13</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">The use of calcium imaging to map the activation of neurons <italic>in vivo</italic> during behavioral tasks has resulted in advancing our understanding of how nervous systems encode sensory input and generate appropriate output. In almost all of these studies, calcium imaging is used to infer spike times or probabilities since action potentials activate voltage-gated calcium channels and increase intracellular calcium levels. However, it is well known that neurons not only fire action potentials but convey information via intrinsic dynamics such as by generating bistable membrane potential states. While a number of tools for spike inference have been developed and are currently being used, no tool exists for converting calcium imaging signals to maps of cellular state in bistable neurons.</p><p id="P3">Purkinje neurons (PNs), the GABA-ergic principal neurons of the cerebellum, exhibit membrane potential bistability, firing either tonically or in bursts. Several studies have implicated the role of a population code in cerebellar function, with bistability adding an extra layer of complexity to the code. In this manuscript we develop a tool, CaMLsort, which uses convolutional recurrent neural networks to classify calcium imaging traces as arising from either tonic or bursting cells. We validated the classifier using a number of different methods and we show that the tool performs well on simulated event rasters as well as real biological data that was previously not seen by the network. This tool offers a new way of analysing calcium imaging data from bistable neurons to understand how they participate in network computation and natural behaviors.</p></abstract><kwd-group><kwd>Purkinje neuron</kwd><kwd>bistability</kwd><kwd>zebrafish</kwd><kwd>machine learning</kwd><kwd>convolutional neural network</kwd><kwd>recurrent neural networks</kwd><kwd>cerebellum</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P4">Calcium imaging enables us to sample the activity of populations of neurons and even whole brains during animal behaviour (<xref ref-type="bibr" rid="R2">Ahrens et al., 2013</xref>; <xref ref-type="bibr" rid="R16">Grewe and Helmchen, 2009</xref>; <xref ref-type="bibr" rid="R17">Grienberger and Konnerth, 2012</xref>), providing us a window into the functioning of the nervous system. When a neuron fires an action potential, somatic calcium levels increase dramatically due to the opening of voltage-dependent calcium channels. Simultaneous electrophysiology and calcium imaging recordings of neuronal activity demonstrate the correspondence of somatic calcium imaging signals with action potential firing (<xref ref-type="bibr" rid="R7">Chen et al., 2013</xref>; <xref ref-type="bibr" rid="R25">Kerr et al., 2005</xref>; <xref ref-type="bibr" rid="R29">Kwan and Dan, 2012</xref>; <xref ref-type="bibr" rid="R56">Tian et al., 2009</xref>). Nevertheless, the calcium imaging signal is at best a delayed, low-pass filtered and non-linearly transformed proxy for neuronal activity. Non-linearities are introduced due to the dynamics of calcium release, and the kinetics of calcium binding and unbinding by the sensor molecules (<xref ref-type="bibr" rid="R3">Ali and Kwan, 2020</xref>). Yet, this technique is useful in cases where the neurons being studied have low baseline firing rate. However, this is not often the case and several neuronal classes, such as cerebellar Purkinje neurons and cortical interneurons are known to fire at very high spike rates spontaneously (<xref ref-type="bibr" rid="R4">Armstrong and Edgley, 1984</xref>; <xref ref-type="bibr" rid="R35">Markram et al., 2004</xref>). Further, many neuronal types have interesting intracellular dynamics apart from action potential firing that might strongly modulate calcium imaging signals (<xref ref-type="bibr" rid="R32">Lin et al., 2007</xref>; <xref ref-type="bibr" rid="R40">Moreaux and Laurent, 2007</xref>). Lastly, confounds may be introduced when more than one type of electrical event leads to somatic calcium increase (<xref ref-type="bibr" rid="R31">Lev-Ram et al., 1992</xref>; <xref ref-type="bibr" rid="R47">Ramirez and Stell, 2016</xref>).</p><p id="P5">Purkinje neurons (PNs) show all of the features mentioned above that make the interpretation of calcium signals in these neurons especially difficult. PNs are principal neurons of the cerebellum, integrate thousands of synaptic inputs and are indispensable for cerebellar function (<xref ref-type="bibr" rid="R41">Narayanan and Thirumalai, 2019</xref>). Therefore, studying PN population activity during motor behaviours is critical to deciphering cerebellar computation. PNs fire simple spikes and complex spikes - in mammals, climbing fiber (CF) input from the inferior olive leads to calcium entry within the dendrites and several spikelets that ride the depolarization wave (<xref ref-type="bibr" rid="R27">Kitamura and Häusser, 2011</xref>; <xref ref-type="bibr" rid="R39">Miyakawa et al., 1992</xref>); in fish, the olivary input causes an all-or-none AMPAR-mediated giant synaptic potential with concomitant calcium entry but without any spikelets (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>). While the CF input causes a relatively large calcium signal, bursts of simple spikes can also generate calcium signals via the activation of somatic voltage-dependent calcium channels, albeit smaller in amplitude (<xref ref-type="bibr" rid="R28">Knogler et al., 2019</xref>; <xref ref-type="bibr" rid="R53">Sengupta, 2015</xref>). This means that optically recorded calcium dF/F signals cannot be uniquely assigned to simple spikes or CF inputs.</p><p id="P6">In addition to the above, PNs exhibit membrane potential bistability - PNs can exist in one of two stable membrane potentials. At a depolarized state, they generate action potentials at a more or less regular rate and are said to be tonic. When hyperpolarized, they generate bursts of action potentials (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>). Simple spikes in the bursting state are highly correlated with motor bouts whereas those in the tonic state are not (<xref ref-type="bibr" rid="R53">Sengupta, 2015</xref>). This implies that bistability has important ramifications for how motor bouts are represented across the entire PN population. We wondered if calcium imaging can be used to deduce the state of PNs. Since both CF inputs and simple spikes contribute to calcium signals, assigning optically recorded dF/F signals is not straight-forward and deduction of spike rate using existing spike inference algorithms is not possible.</p><p id="P7">Here, we first performed simultaneous electrophysiological recordings and calcium imaging to obtain ground truth data. Unsurprisingly, we found that none of the usually measured parameters such as peak amplitude, area under the curve etc., of the calcium signal uniquely correlated with cellular state. We therefore built a sorter using convolutional recurrent neural networks to identify cellular state from dF/F data. We have tested our sorter with data that was not part of the training set and validated that it performs at above 90% accuracy and with F1 scores greater than 0.8 in most cases. Our method demonstrates that calcium imaging datasets can be mined using such tools to glean greater insights into neuronal activity states.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Zebrafish cerebellar Purkinje neurons are spontaneously active and exhibit membrane potential bistability</title><p id="P8">Purkinje neurons (PNs) are the principal neurons in the cerebellar circuit (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). In larval zebrafish, they are spontaneously active and exhibit two kinds of membrane potential events that can be distinguished solely based on their amplitude in both extracellular and intracellular recordings (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>) (<xref ref-type="fig" rid="F1">Fig 1B and 1C</xref>). The smaller amplitude events are action potentials and are called simple spikes (<xref ref-type="fig" rid="F1">Fig 1B-E</xref>, marked by cyan dots), while the larger amplitude events are all-or-none synaptic input from climbing fibers (<xref ref-type="fig" rid="F1">Fig 1B-E</xref>, marked by magenta dots). Moreover, these neurons exhibit membrane potential bistability, i.e. they are found to be at one of two stable membrane potentials and fire either tonically or in bursts, depending on the membrane potential. Both these states can be distinguished visually from extracellular loose-patch recordings based on (i) the firing frequency of simple spikes and (ii) the presence of long intervals of inactivity in the burst mode (<xref ref-type="fig" rid="F1">Fig 1B</xref>, left) which are not present in the tonic mode (<xref ref-type="fig" rid="F1">Fig 1B</xref>, right). The same features can be used to distinguish between the two modes in whole-cell patch-clamp recordings, along with an extra feature - membrane potentials are more hyperpolarized in the bursting mode (<xref ref-type="fig" rid="F1">Fig 1C</xref>, left) as opposed to the tonic mode (<xref ref-type="fig" rid="F1">Fig 1C</xref>, right). Cells can spontaneously switch between these two states, but can also be taken from one state to the other by current injection - bursting cells become tonic upon depolarizing current injection, whereas tonic cells fire in bursts when injected with hyperpolarizing currents.</p></sec><sec id="S4"><title>Calcium imaging reports both simple spike bursts and individual CF inputs, independent of state</title><p id="P9">Given that PNs manifest two distinct activity patterns (tonic and bursting) and two types of electrical events (simple spike and CF events), we wondered if calcium imaging signals can reliably report these distinct patterns of activity. To do this, we performed simultaneous wide-field calcium imaging and targeted patch-clamp electrophysiology from zebrafish PNs. We used the carbonic anhydrase (Ca8) enhancer element and a minimal promoter (<italic>cfos</italic>) to drive expression of the genetically encoded calcium sensor GCaMP5G in PNs (<xref ref-type="bibr" rid="R36">Matsui et al., 2014</xref>). Embryos were microinjected at the 1-2 cell stage and those larvae that showed sparse labelling in PNs were selected for targeted patch-clamp electrophysiology and imaging (<xref ref-type="fig" rid="F2">Fig 2A</xref>). We chose to perform extracellular, loose-patch recordings so as to be minimally invasive and to avoid the dialysis of cellular contents including GCaMP. We obtained such recordings from 15 cells in 12 larvae, out of which 9 cells were naturally in the tonic state, and 6 cells, in the bursting state.</p><p id="P10">Representative traces from this experiment for cells in the bursting and the tonic states are shown in <xref ref-type="fig" rid="F2">Fig 2B and 2C</xref>, respectively. The first observation we made was that many of the calcium transients (marked with a hash symbol in <xref ref-type="fig" rid="F2">Fig 2B and 2C</xref>) had an almost one-to-one correspondence with CF inputs (magenta lines in the rasters) in cells of both states. In tonic cells, most simple spikes are not reported as transients, as one would expect from cells that fire at high frequencies. However, in some cases, calcium transient peaks occurred in the absence of CF inputs, during times of simple spike firing (<xref ref-type="fig" rid="F2">Fig 2C</xref>, see asterisk and cyan lines in raster). Similarly, in bursting cells, we found some calcium transients associated only with a burst of simple spikes (<xref ref-type="fig" rid="F2">Fig 2B</xref>, asterisk). Naturally, then, one would expect to see calcium transients when CF inputs co-occurred with a burst of simple spikes, which is what we observed (marked with open circles in <xref ref-type="fig" rid="F2">Fig 2B and 2C</xref>). Thus, regardless of the state of a cell, we found calcium transients that corresponded to individual CF inputs, bursts of simple spikes or a combination of both.</p><p id="P11">To quantify the correspondence between calcium imaging signals and simple spikes or CF events, we first measured the average calcium signal triggered with respect to individual simple spikes (<xref ref-type="fig" rid="F2">Fig 2D(i)</xref>) or CF inputs (<xref ref-type="fig" rid="F2">Fig 2D(ii)</xref>). We found that the calcium signal’s decay is the dominant response when triggered to individual simple spikes. This may be attributed to the high frequency of simple spikes observed in these cells. When aligned to CF inputs, however, there is a modest increase in calcium response after the CF input, followed by a decay, which is the typical response of a calcium sensor. It is interesting to note here that the baseline calcium signal preceding either of the two events is roughly the same. These general features of the event-triggered calcium signal remained the same when data was sorted by cellular state (<xref ref-type="supplementary-material" rid="SD1">Supp. Fig. 2.1</xref>)</p><p id="P12">While this method confirms that a calcium transient occurs after a CF input, suggesting a causal link between the CF input’s arrival and the measured calcium influx into the cell, it is not useful in the case of simple spikes. Firstly, there are multiple simple spikes per frame - approximately 2-3 spikes per frame when imaged at 30Hz. This is further worsened by the timescales of GCaMP5G’s rise and decay, which occurs on the order of 100s of milliseconds. Moreover, one cannot separate out the individual effects of simple spikes and CF inputs because the two events are interspersed and thus, when calculating the triggered average response for one event, there is bleed-through from the other.</p><p id="P13">As an alternate measure, we decided to look at the number of simple spikes and CF inputs relative to the peak of the calcium signal using peri-event time histograms (<xref ref-type="fig" rid="F2">Fig 2E</xref>). GCaMP5G has a rise time constant of ~100ms, which means that the time it takes to reach a peak value from the baseline is ~267ms. This time point is marked in the histograms with a vertical dashed line. The y-axes of these histograms represent the z-score for each bin. We calculated the average z-score of bins 200-400ms before the GCaMP peak (which is the window in which the rise in the signal would have started, <xref ref-type="fig" rid="F2">Fig 2E</xref>, yellow shaded area) and the average z-score of bins +/- 100ms around the peak (which is roughly when the signal would start decaying, <xref ref-type="fig" rid="F2">Fig 2E</xref>, grey shaded area). It is clear from these that there is a greater count of both simple spikes and CF inputs right before the GCaMP signal starts to rise, which suggests that the occurrence of both kinds of electrical events in a PN could lead to a calcium transient. We checked if this effect was state-dependent, and we find that it is not, since the histograms do not differ much between tonic and bursting cells (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2.2</xref>).</p><p id="P14">In summary, it is difficult to infer the underlying event train or even the cellular state of a Purkinje neuron directly from its calcium signal, as there is no one-to-one correspondence between calcium transients and their underlying electrophysiological events, as has also been reported previously (<xref ref-type="bibr" rid="R28">Knogler et al., 2019</xref>; <xref ref-type="bibr" rid="R53">Sengupta, 2015</xref>).</p></sec><sec id="S5"><title>The calcium signal for a Purkinje neuron can be reconstructed from its electrophysiological recording</title><p id="P15">Though the calcium signal in PNs could arise from more than one electrical event, we hypothesised that there might be sufficient information in the calcium signal time series to allow us to determine whether it is tonically firing or bursting. One possible approach to this problem could be the application of machine learning algorithms to build a classifier that labels cells as tonic or bursting given a time series of calcium transients. For this, it was first necessary to generate a larger ground truth dataset comprising the electrical activity patterns and their corresponding calcium transients for training the classifier. Mathematically, the calcium signal obtained by imaging can be thought of as the result of the convolution of spike trains with a calcium sensor kernel having a fast rise and a slow decay and described as a difference of exponentials. This transformation has been shown to work well in cells that are not spontaneously active, where every single action potential produces a large increase in intracellular calcium concentration (<xref ref-type="bibr" rid="R49">Rupprecht et al., 2021</xref>; <xref ref-type="bibr" rid="R58">Vogelstein et al., 2010</xref>; <xref ref-type="bibr" rid="R60">Yaksi and Friedrich, 2006</xref>). We hypothesised that a similar transformation could be used to reconstruct the calcium signal profiles of PNs from their electrophysiological recordings alone. Such reconstructed calcium imaging traces with their corresponding electrical recording traces could then be applied to build the classifier.</p><p id="P16">However, given that these neurons have not one, but two electrophysiological events, each contributing differently to the calcium signal obtained from imaging, we must assign each event a separate kernel (<xref ref-type="fig" rid="F3">Fig 3A</xref>), which we assume to be independent of each other. This is a valid assumption, since simple spikes and CF events arise from distinct intrinsic mechanisms (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>). We used simultaneous imaging and electrophysiology recordings to find optimal kernels for simple spikes and CF events. For each PN recording, we obtained simple spike and CF event rasters. Each event raster was then independently convolved with its own exponential response kernel, and the resulting “event-specific signals” were added to produce the final reconstruction (<xref ref-type="fig" rid="F3">Fig 3A</xref>). We then calculated the correlation coefficient and the mean squared error (MSE) between the reconstructed calcium signal time series and the experimentally obtained calcium imaging time series.</p><p id="P17">With this description in place, the problem then becomes one of finding optimal coefficients for each response kernel. This optimization was done by gradient descent to minimise the MSE between the ground truth and the reconstruction. The process was performed independently for each cell in the dataset. Then, these optimal kernel combinations were used to make reconstructions for other cells in the dataset, and the kernel that generalised best across all cells, as quantified by least total MSE and highest total cross-correlation between the ground truth and reconstruction (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>), was taken to be the best kernel for the next steps. Kernel numbers 7 and 8 were very close to each other in both scores (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>), so kernel 7 was chosen for further analysis.</p><p id="P18">Although this is a simple forward model with calcium dynamics assumed to be linear and time-invariant, we found that this method to approximate the calcium signal works well, no matter the state of the neuron (<xref ref-type="fig" rid="F3">Fig 3B</xref>). The quality of the reconstructions has been quantified by measuring the correlation coefficient between the ground truth and the reconstruction (<xref ref-type="fig" rid="F3">Fig 3C</xref>). To benchmark the correlation coefficient values obtained against those obtained simply by chance, we also calculated the correlation coefficient between the ground truth and a scrambled version of the reconstruction, as well as that between the ground truth and a reconstruction generated after shuffling all the event times in the recording (<xref ref-type="fig" rid="F3">Fig 3C</xref>). In both the latter cases, the correlation disappears, suggesting that the reconstructions generated by this forward model are, indeed, faithful reconstructions.</p><p id="P19">Given that only groups/bursts of simple spikes produce a calcium transient amplitude comparable to that generated by an individual CF input, one would expect a much smaller response kernel for simple spikes than for the CF input. Indeed, the optimal kernels found by this method show that the CF input response kernel is approximately 7.5 times larger than the simple spike response kernel (<xref ref-type="fig" rid="F3">Fig 3D</xref>).</p></sec><sec id="S6"><title>A state-labelled calcium signal dataset was generated by reconstructing the calcium signal for a compilation of electrophysiological traces</title><p id="P20">Having a method of converting any given PN electrophysiology trace to its corresponding calcium imaging trace allowed us to generate simulated calcium imaging traces for a compilation of all electrophysiological recordings acquired in our lab (<xref ref-type="fig" rid="F4">Fig 4A</xref>). To do so, we first pooled all the electrophysiological recordings, both extracellular and whole-cell, made during the period of 2011-2020, for a total of N=173 recordings. Recordings of poor quality, i.e., those with interruptions, or noisy baselines, unusually broad/filtered events, or indistinguishable simple spikes and CF inputs (N=37) were first excluded from the dataset. Retained recordings then had a state assigned to them, including state switches, if there were any. This collection was split into two sets, one with those recordings which had only one state throughout (N=131), and another with those which had a state switch (N=5). Events were detected in all the recordings, and then the calcium signal reconstructed, to finally produce two labelled datasets - a state-labelled reconstructed calcium signal dataset and an independent dataset with switches. The recordings used to generate this dataset were of different durations with a median duration of 60 seconds. In order to get multiple samples per recording, we decided to split the traces into 10-second-long non-overlapping chunks, representative samples from which are shown in <xref ref-type="fig" rid="F4">Fig 4B</xref>. This produced a dataset of state-labelled calcium imaging traces (n=928 traces; n=580 bursting, n=348 tonic) that is much larger than could have been obtained by simultaneous imaging and electrophysiology of individual cells. The entire complement of non-overlapping samples is shown as a heatmap in <xref ref-type="fig" rid="F4">Fig 4C</xref>.</p><p id="P21">To test whether there were properties of these traces that could be used to unambiguously classify their source state, we compared various properties of the traces between the two classes - the number of peaks, average peak amplitude, area under the curve, mean, standard deviation and coefficient of variation (<xref ref-type="fig" rid="F4">Fig 4D</xref>). We found that most of the properties of the traces between the two classes were largely similar. While several of these differences are statistically significant (<xref ref-type="table" rid="T2">Table 2</xref>), they have small effect sizes, and our aim was not to just find properties that are statistically distinguishable from each other but to be able to classify a trace as having come from either a tonically firing cell or a bursting cell. To do so, we first performed a PCA on the dataset of trace features and found that they had large overlaps (<xref ref-type="fig" rid="F4">Fig 4E</xref>). Thus, linear methods of separating the two classes weren’t successful and we needed to consider more complex models to solve this classification problem.</p><p id="P22">Machine learning methods have successfully been used to solve such problems when the data points are not linearly separable (<xref ref-type="bibr" rid="R19">He et al., 2016</xref>). Thus, we turned to developing a machine learning model to identify the state of a cell from a calcium signal time series.</p></sec><sec id="S7"><title>Training a convolutional recurrent neural network to distinguish state from calcium imaging data alone</title><p id="P23">To find good machine learning models to solve this classification problem, we performed 5-fold cross validation, which is used to ensure that models generalised well and do not overfit the training data (<xref ref-type="fig" rid="F5">Fig 5A</xref>). On each fold, only 60% of the training traces were shown to the network in the training phase (<xref ref-type="fig" rid="F5">Fig 5A</xref>, white boxes), the network optimised on 20% of data used as a validation set (<xref ref-type="fig" rid="F5">Fig 5A</xref>, yellow boxes), and the generalizability of the trained network assessed using the remaining 20% (<xref ref-type="fig" rid="F5">Fig 5A</xref>, blue boxes). Each of the 5 folds had a different 60-20-20 split, such that the training and cross-validation datasets had a balance of traces from both classes.</p><p id="P24">We tested several different machine learning models on this classification problem - Support Vector Machines (SVMs), Deep Neural Networks (DNN) and Convolutional Neural Networks (CNNs). The prediction accuracies and F1 scores (a metric that adjusts for class imbalances as well as whether a prediction was a true/false positive/negative, defined in the methods section) for the various models tested are shown in <xref ref-type="table" rid="T3">Table 3</xref>. Of these models, the 1D CNN model performed best across all folds. However, these are only on snapshots of 10s-long snippets of the calcium trace, and the networks had more erroneous performance when predicting on the entire time series (data not shown). To overcome this, we decided to use a CNN-LSTM model. LSTM (Long short-term memory) networks (<xref ref-type="bibr" rid="R20">Hochreiter and Schmidhuber, 1997</xref>) are a kind of recurrent neural network (RNN), which has the ability to learn features across an entire sequence and not just across neighbouring positions in a trace sequence, like CNNs do.</p><p id="P25">The architecture of the network is shown in <xref ref-type="fig" rid="F5">Fig 5B</xref>. The input to the network is a trace sampled at 30Hz, which is some multiple of 10 seconds in duration. It is first remapped to values between 0 and 1 using min-max normalisation and then processed by a CNN, which acts as a local feature extractor that also down samples the input data, such that it produces 4 vector outputs at a 1Hz sampling frequency. These outputs are passed to a bidirectional LSTM, one time step at a time. A forward LSTM cell looks at trends in the forward direction (<xref ref-type="fig" rid="F5">Fig 5B</xref>, blue dotted box and arrow), while a reverse LSTM cell goes through the data in the reverse direction (<xref ref-type="fig" rid="F5">Fig 5B</xref>, red dotted box and arrow). Each of the two cells produces a “hidden state” as its output. Given that the LSTM is a recurrent neural network, this output is fed back into the network along with the next appropriate time step from the CNN’s output, a process which is repeated 9 more times (for every 10 second trace). In essence, the LSTM is detecting trends across the entire sequence. The final hidden states from the forward and reverse LSTMs, produced after passing through the entire trace, are retained and concatenated. These outputs are combined by passing them through a Linear layer, which performs a matrix multiplication to produce an output that is 10 samples long. At this step, each sample represents the likelihood that the trace in question comes from a cell in the bursting mode, predicted at 1 second intervals. The likelihood of each time step having come from the tonic state can then be inferred (<xref ref-type="fig" rid="F5">Fig 5B</xref>, grayscale boxes on the right). The state with the larger likelihood score is taken to be the final classification at each time step.</p><p id="P26">Five networks were produced, one for each fold of cross-validation. The median accuracy was 80.15% for the cross-validation phase and 82.02% for the test phase (<xref ref-type="fig" rid="F5">Fig 5C</xref>, top). The median F1-score was 0.7302 for the cross-validation phase and 0.8071 for the test phase (<xref ref-type="fig" rid="F5">Fig 5C</xref>, bottom). We looked at the posterior scores of the predicted class in both the cross-validation and test stages (<xref ref-type="fig" rid="F5">Fig 5D</xref>). In almost all the cases, the posterior scores of a network are higher in the true positive and true negative cases as opposed to the false positive and false negative cases. Of all the network folds, Fold 2 (orange) seemed to be particularly promising, because it consistently had high posterior scores, and had much higher scores for true positives and negatives when compared to false positives and negatives. Put together, this means that not only are these networks being trained well and making accurate predictions, but also confident about the predictions they made.</p><p id="P27">To be sure that networks weren’t performing well just because of peculiarities in the dataset used for training and testing, we presented an independent set of calcium signal reconstructions to the network that were not used in any phase of the training. These reconstructions also had state switches in them (<xref ref-type="fig" rid="F6">Fig 6A</xref>). Networks performed fairly well even in these cases, with median F-1 scores higher than 0.8 (<xref ref-type="fig" rid="F6">Fig. 6B</xref>). Fold 2 had a median F1-score of 1 and its predictions are shown in <xref ref-type="fig" rid="F6">Fig 6A</xref>. The regions highlighted in red are those where the prediction didn’t match the ground truth. What is immediately clear from it is that most of the cells’ states were correctly identified, except in those cases where the cell switched state mid-recording, which is underrepresented in our training dataset as well.</p><p id="P28">As a further challenge to the trained networks, we decided to generate artificial spike trains that represent extreme cases of the tonic or bursting class (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref>), reconstruct the calcium signal for these spike trains and ask the network to classify these completely synthetic data. We found that most folds of the network performed this task well (<xref ref-type="fig" rid="F6">Fig 6D</xref>). Fold 2, in particular, predicted the state of 20/20 traces correctly (<xref ref-type="fig" rid="F6">Fig 6C</xref>), with only one brief misclassified region, marked in the pink shaded area in <xref ref-type="fig" rid="F6">Fig 6C</xref>.</p></sec><sec id="S8"><title>Neural networks trained only on simulated calcium signals correctly identify Purkinje neuron state from real data</title><p id="P29">Thus far, all the inputs and challenges to the network were made using calcium signal reconstructions. To test the applicability of these networks on data from experiments, we went back to our original simultaneous electrophysiology-imaging data and asked if the network could call the state of those cells correctly based on the dF/F traces alone.</p><p id="P30">We found that the networks called the state of 7/15 cells correctly throughout the entire trace duration. In two other cells, more than 50% of the entire trace duration was called correctly (<xref ref-type="fig" rid="F6">Fig 6E</xref>). It is important to note, though, that those traces which were incorrectly identified also had posterior scores that were not only low, but also similar for both classes (<xref ref-type="fig" rid="F6">Fig 6E</xref> bottommost trace).</p><p id="P31">This outcome is interesting, because the networks have only been exposed to simulated calcium signals generated using a first-order generative model in the training and test phases, and yet are able to reasonably assess the state from real data, which have several challenging features - variable sensor expression levels, shot noise and signal bleaching, to name a few.</p><p id="P32">Among the five optimal networks identified from the 5-fold cross-validation, network #2 performed the best across all the challenges presented to it (<xref ref-type="fig" rid="F5">Fig 5C, Fig 5D</xref>, and <xref ref-type="fig" rid="F6">Fig 6</xref>), and thus is what we have decided to retain for future use, and call it CaMLsort_v1 (Calcium imaging and Machine Learning based tool to sort intracellular state). This will be made available as a Python package on GitHub.</p><p id="P33">CaMLsort not only makes calls about the state of a neuron but also produces class posterior scores, which essentially show how confident it was for each call. Thus, with some subjectivity on the part of the experimenter in combining the calls with the confidence scores, the error rate may be further reduced.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P34">In this paper, we describe the development of CaMLsort, a machine learning-based tool to identify the bistable state of Purkinje neurons from calcium imaging data. We develop this network and train it only on a simulated calcium signal dataset, but find that it can be used on experimental data, too.</p><sec id="S10"><title>Bistability in Purkinje neuron populations</title><p id="P35">The ability of neurons to exist in two stable states and exhibit distinct firing patterns/ excitabilities in those states has been documented in invertebrate (<xref ref-type="bibr" rid="R11">Dickinson and Nagy, 1983</xref>; <xref ref-type="bibr" rid="R30">Lechner et al., 1996</xref>; <xref ref-type="bibr" rid="R34">Marder et al., 1996</xref>; <xref ref-type="bibr" rid="R50">Russell and Hartline, 1982</xref>) and vertebrate nervous systems (<xref ref-type="bibr" rid="R9">Cowan and Wilson, 1994</xref>; <xref ref-type="bibr" rid="R22">Hounsgaard et al., 1984</xref>; <xref ref-type="bibr" rid="R33">Loewenstein et al., 2005</xref>; <xref ref-type="bibr" rid="R38">Misgeld et al., 1986</xref>; <xref ref-type="bibr" rid="R52">Schwindt and Crill, 1980</xref>).</p><p id="P36">Among the many systems in which neuronal bistability has been studied, Purkinje neurons of the cerebellum are particularly interesting because they are spontaneously active. Thus, they switch between firing either tonically or in bursts (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>), and such behavior is not only unique to Purkinje neurons but has also been reported in many other cell types such as thalamic (<xref ref-type="bibr" rid="R24">Jahnsen and Llinás, 1984</xref>) and cortical neurons (<xref ref-type="bibr" rid="R37">McCormick et al., 1985</xref>).</p><p id="P37">Though it is appreciated that bistability increases the information processing capacity of neurons, such as by allowing gating of synaptic inputs (<xref ref-type="bibr" rid="R55">Thirumalai and Jha, 2022</xref>), its implication for network computation or behavioural output is less well understood. This is true of Purkinje neurons as well - while it is established that these neurons are bistable and are important for motor behaviours (<xref ref-type="bibr" rid="R13">Engbers et al., 2013</xref>; <xref ref-type="bibr" rid="R46">Popa et al., 2018</xref>; <xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>), the role of bistability in Purkinje neuron computation or motor behaviour output has thus far not been clear.</p><p id="P38">We propose that that having more than one stable state allows a cell to toggle in and out of participating in circuit computations. In the cerebellum, specifically, bistability may have significant consequences by modulating PN neuronal synchrony with other PNs. PNs make weak inhibitory synapses onto deep cerebellar nuclear (DCN) cells in mammals and the eurydendroid cells in fish, with a high degree of convergence (<xref ref-type="bibr" rid="R5">Bae et al., 2009</xref>; <xref ref-type="bibr" rid="R10">De Zeeuw et al., 2011</xref>; <xref ref-type="bibr" rid="R18">Harmon et al., 2020</xref>; <xref ref-type="bibr" rid="R23">Ikenaga et al., 2006</xref>; <xref ref-type="bibr" rid="R45">Person and Raman, 2012</xref>). DCN cell spike times could be effectively controlled via inhibition from several PNs firing synchronously (<xref ref-type="bibr" rid="R45">Person and Raman, 2012</xref>). Since PNs fire tonically when synaptically-isolated and CF inputs can trigger bursts (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>), the bursting state is a network-embedded state while the tonic state could be thought of as an isolated state. By toggling between these two states PNs can increase or decrease the levels of population synchrony and thereby affect DCN firing differentially. Mapping state distribution across the PN population during various tasks will lead us to an understanding of how PNs synchronize or desynchronize during these tasks and how that in turn shapes cerebellar output and motor behaviors.</p></sec><sec id="S11"><title>Inferring long-term dynamics from calcium imaging data</title><p id="P39">Calcium imaging has been one of the core experimental techniques in neuroscience for more than three decades and has seen many major developments in sensor quality, microscopy and analytical algorithms and software (<xref ref-type="bibr" rid="R7">Chen et al., 2013</xref>; <xref ref-type="bibr" rid="R15">Göbel and Helmchen, 2007</xref>; <xref ref-type="bibr" rid="R44">Peron et al., 2015</xref>; <xref ref-type="bibr" rid="R48">Renninger and Orger, 2013</xref>; <xref ref-type="bibr" rid="R56">Tian et al., 2009</xref>; <xref ref-type="bibr" rid="R61">Yang and Yuste, 2017</xref>). Yet, the technique is largely used to identify regions of the brain that respond to presented stimuli or correlate with behavioral output under well-defined experimental conditions. This is resultant from the fact that the predominant mode of transient calcium elevation occurs due to the opening of voltage-gated calcium channels during action potential firing (<xref ref-type="bibr" rid="R6">Borst and Helmchen, 1998</xref>; <xref ref-type="bibr" rid="R15">Göbel and Helmchen, 2007</xref>). Thus, these calcium transients are quite brief, typically lasting only a few milliseconds and report spiking activity of neuronal populations during sensory stimulation and/or motor output. However, it is clear that neurons also exhibit longer time scale dynamics such as bursting, which carries information for downstream neurons (<xref ref-type="bibr" rid="R62">Zeldenrust et al., 2018</xref>). As the currently available calcium sensors themselves are much slower compared to the calcium transients, it is obvious that the recorded dF/F signals must manifest signatures of such long-term dynamics. CaMLsort addresses this issue by looking at longer term signatures in the calcium imaging time series data to identify cellular state.</p></sec><sec id="S12"><title>Broader Applications of CaMLsort</title><p id="P40">The development of CaMLsort has opened up the possibility of a lot of future research in understanding PN bistability and its role in the function of the cerebellum as a whole. We could now experimentally address, for instance, what causes a switch in a PN’s state by doing a high-throughput screen for chemical agents that affect bistability. We know that while bistability is a cell-intrinsic property, state switches could be a result of modulation of network activity. Neuromodulators are key candidates for this, as they can alter cell-intrinsic properties as well as network activity, and could thereby affect the bistability of a neuron, as has been demonstrated in multiple experimental systems (<xref ref-type="bibr" rid="R1">Abbinanti et al., 2012</xref>; <xref ref-type="bibr" rid="R8">Conway et al., 1988</xref>; <xref ref-type="bibr" rid="R21">Hounsgaard et al., 1988</xref>; <xref ref-type="bibr" rid="R30">Lechner et al., 1996</xref>; <xref ref-type="bibr" rid="R59">Williams et al., 2002</xref>).</p><p id="P41">Another question we can now directly address is how the state of a cell changes over development. We hypothesise that the tonic state could be a developmentally early state, with the burst-like phenotype developing as they get integrated into the developing cerebellar circuit. By birthdating PNs using a photoconvertible protein like Kaede and imaging their activity with GCaMP, we can use CaMLsort to ask whether younger cells tend to be more tonic or vice versa. While this question could potentially be addressed using electrophysiology, CaMLsort allows us to perform this experiment in a more high-throughput and minimally invasive fashion.</p><p id="P42">We focused on calcium imaging and electrophysiology data obtained from Purkinje neurons of larval zebrafish where we have shown that the tool predicts cellular state with very high accuracy and reliability (<xref ref-type="fig" rid="F6">Fig. 6</xref>). A natural question is whether prediction of cellular state is useful in cell types other than the Purkinje neuron. A number of cell types exhibit bistability including cortical neurons (<xref ref-type="bibr" rid="R9">Cowan and Wilson, 1994</xref>; <xref ref-type="bibr" rid="R12">Egorov et al., 2002</xref>), striatal neurons (<xref ref-type="bibr" rid="R38">Misgeld et al., 1986</xref>), thalamic neurons (<xref ref-type="bibr" rid="R14">Fuentealba et al., 2005</xref>) and spinal motoneurons (<xref ref-type="bibr" rid="R22">Hounsgaard et al., 1984</xref>). In all of these cases, cellular state dictates how synaptic inputs are integrated. Therefore, predicting cellular state is essential to understanding circuit computation and here CaMLsort will be immensely useful. It is natural to wonder whether CaMLsort will be equally effective in predicting cellular state in different cell types and in different model organisms. While CaMLsort needs to be tested in other cell types and organisms, our classifier is built using kernels derived from a small ground truth dataset and then used to build a larger database of calcium traces from electrophysiological recordings. A similar approach can be used without much more additional work to create parallel electrophysiology-calcium imaging databases of any of the above-mentioned cell types. Taken together, the development of CaMLsort opens up new avenues of research into the functioning of not just the cerebellar circuit, but also other circuits with bistable neurons.</p></sec><sec id="S13"><title>Limitations of CaMLsort</title><p id="P43">Having said the above, CaMLsort is not free of limitations. For instance, the generative model we use to train the neural network is a linear, time-invariant model and results may improve with the use of more accurate models, such as ones that estimate the true increase in intracellular calcium concentration resulting from simple spikes and CF inputs.</p><p id="P44">Similarly, our model is trained and tested on GCaMP5G, for reasons of resource availability and experimental feasibility. However, newer generations of the GCaMP family of sensors continue to be developed, the latest being the 8th generation, which have much faster dynamics and a higher signal-to-noise ratio than the GCaMP5G we have used. Whether our results depend on the variant of calcium sensor being used is unclear, but we do not expect it to make a significant difference, because CaMLsort performs a window-wise min-max normalisation prior to identifying state. Since the relative ratio of simple spike to CF input calcium influx shouldn’t depend on the sensor used, we predict that CaMLsort will work well regardless of the sensor being used. Moreover, the advantage of the method we have described is that a small ground truth dataset might be all that is necessary to retrain CaMLsort for a new sensor.</p><p id="P45">Lastly, it could be that CaMLsort may not work independent of the imaging method used. However, this is also easily fixed, either by the acquisition of a small ground-truth dataset, or by comparing the traces obtained from imaging to those in the reconstructions dataset, or by denoising the data prior to prediction using CaMLsort.</p></sec></sec><sec id="S14" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S15"><title>Experimental Animals</title><p id="P46">Experiments were performed on Indian wild type (Ind WT) zebrafish (<italic>Danio rerio</italic>) and were approved by the institutional animal ethics committee (IAEC) and institutional biosafety committee (IBSC). Embryos were obtained by setting up an incross between adult Ind WT zebrafish raised and housed in a ZebTec multi linking system (Tecniplast, Italy) with a pH setting of 7.8 and conductivity of 1200μS. Larvae were kept in a MIR-154 incubator (Sanyo, Japan) with 14:10h light-dark cycle maintained at 28°C in E3 medium (composition in mM: 5 NaCl, 0.17 KCl, 0.33 CaCl<sub>2</sub>, and 0.33 MgSO<sub>4</sub>, pH 7.8) in standard 90mm Petri dishes (Tarsons, Kolkata, India). The medium was routinely replaced, and starting at 5 dpf, larvae were fed Zeigler Larval diet AP100 (&lt;100 microns) (Pentair AES, FL, United States). Larvae have not yet undergone sex specification by these stages, so experiments performed were agnostic to the sex of the animal.</p></sec><sec id="S16"><title>Transient transgenesis by microinjection</title><p id="P47">Thin-walled borosilicate capillaries (1.0mm OD, 0.56mm ID; Warner Instruments, Hamden, CT, United States) were pulled using a Flaming-Brown P-97 pipette puller (Sutter Instruments, Novato, CA, United States) to produce long and thin pipettes for microinjection. Indian WT embryos at the 1-2 cell stage were injected with ~10nL of a mixture of tagRFP-T:PC:GCaMP5G plasmid (<xref ref-type="bibr" rid="R36">Matsui et al., 2014</xref>) (50 ng/μL) and Tol2 transposase mRNA (50 ng/μl) (<xref ref-type="bibr" rid="R57">Urasaki et al., 2006</xref>), using a Picospritzer III (Parker Hannifin, NH, United States) pressure injection apparatus, and raised as described above. Larvae were screened at 5 dpf at an epifluorescence dissection microscope (Olympus SZX-16) and those showing mosaic labelling of Purkinje neurons were selected for experiments, which were performed at 7 dpf at room temperature (25-28°C).</p></sec><sec id="S17"><title>Electrophysiology</title><p id="P48">Larvae were anaesthetised in 0.01% MS-222 (Sigma-Aldrich; Missouri, USA) and transferred to a custom-made acrylic recording chamber. Fine tungsten wire (California Fine Wire, CA, USA) was used to pin the larva onto a piece of Sylgard (Dow Corning, Midland, MI, United States) glued to the recording chamber. Two pins were put through the notochord at the level of the swim bladder and the tail, respectively. A third pin was then used to position the larval head dorsal-up. The MS222 was replaced by external solution (composition in mM: 134 NaCl, 2.9 KCl, 1.2 MgCl<sub>2</sub>, 10 HEPES, 10 glucose, 2.1 CaCl<sub>2</sub>, 0.01 D-tubocurarine; pH 7.8; 290 mOsm) and skin on the dorsal surface of the larva was carefully removed using fine no. 5 forceps (Fine Science Tools, Foster City, USA) to expose the brain.</p><p id="P49">A Flaming-Brown P-97 pipette puller (Sutter Instruments, Novato, CA, United States) was used to pull patch pipettes made of standard-walled borosilicate capillaries with a filament (1.5 mm OD; 0.86 mm ID; Warner Instruments, Hamden, CT, United States), pulled to a final tip diameter of 1-1.5 μm. For loose patch recordings, pipettes were backfilled with external solution, while for whole-cell recordings, pipettes were backfilled with K-gluconate internal solution (composition in mM: 115 K gluconate, 15 KCl, 2 MgCl<sub>2</sub>, 10 HEPES, 10 EGTA, 4 Mg-ATP; pH 7.2; 290 mOsm). Solutions were filtered using a 0.2μm filter (Millipore, Merck, Germany) before backfilling pipettes, which typically had resistances between 8 and 10 MΩ. Sulforhodamine (Sigma-Aldrich, St.Louis, MO, United States) was added to the patch internal solution at a final concentration of 5μg/mL to facilitate visualisation of cellular morphology post-recording.</p><p id="P50">Recordings were acquired with a Multiclamp 700B amplifier, Digidata 1440A digitizer and pCLAMP 10 software (Molecular Devices, Sunnyvale, CA, United States). Data were low pass filtered at 2 kHz and sampled at 20-50 kHz with a gain of 1 (whole-cell recordings) or between 20-1000 (loose patch recordings), so as to optimally use the dynamic range of the digitizer.</p></sec><sec id="S18"><title>Simultaneous calcium imaging and electrophysiology</title><p id="P51">Indian WT larvae microinjected with the Tol2-tagRFP-T:PC:GCaMP5G construct (gift from Dr. Hideaki Matsui, Niigata University, Japan) and screened for sparse labelling were used for this experiment. Purkinje neurons expressing GCaMP5G were targeted for the recordings. Widefield imaging was performed using a 60x water-immersion objective (1.0 NA) at an Olympus BX61WI microscope. Excitation light was provided using a pE300-ultra (CoolLED, Andover, England). Imaging was performed using an EVOLV EM-CCD camera (Photometrics, Tucson, AZ, United States) at the rig, with an exposure of 30 ms, and an on-chip gain of 170. An ROI was drawn around the targeted cell, so that only an isolated cell was imaged. Imaging was synchronised with electrophysiology by interfacing with the Digidata 1440A.</p><p id="P52">Image analysis was performed in Fiji/ImageJ (<xref ref-type="bibr" rid="R51">Schindelin et al., 2012</xref>). In order to identify cell boundaries, the averaged time series was used as a reference and an ROI drawn around the cell. Bleach correction was performed using the Exponential Fitting Method in the Bleach Correction plugin in Fiji. The average raw pixel intensity values within the ROI for each time point was extracted. The baseline intensity, F0, was taken to be the 5th percentile of these values. dF/F was then calculated for each frame using the formula (F - F0)/F0, where F represents the fluorescence in that frame and F0 the baseline fluorescence. Following this calculation, a Gaussian filter was applied to the time series in MATLAB R2019b (Mathworks, Natick, MA), using its function ‘<italic>smoothdata</italic>’, with a window size of 15.</p></sec><sec id="S19"><title>Spike detection and analysis</title><p id="P53">All electrophysiological analyses were done using custom scripts written in MATLAB, using functions defined in a publicly available repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/wagenadl/mbl-nsb-toolbox">https://github.com/wagenadl/mbl-nsb-toolbox</ext-link>) to read electrophysiology data. For extracellular recordings, spikes were identified as events that showed large fluctuations relative to a 25ms rolling window baseline and the peak timing and amplitude were extracted. Events were sorted based on amplitude, with small amplitude events being classified as simple spikes and large amplitude events as climbing fiber (CF) inputs, as per (<xref ref-type="bibr" rid="R54">Sengupta and Thirumalai, 2015</xref>). For intracellular recordings, peak detection algorithms inbuilt in MATLAB were used to identify spikes. Once again, events were sorted as simple spikes or CF inputs based on their amplitude relative to baseline.</p></sec><sec id="S20"><title>Calcium imaging reconstruction from electrophysiology data</title><p id="P54">Simultaneous calcium imaging and extracellular electrophysiology data was used to infer optimal GCaMP5G kernels, which are of the general form <bold>A1*exp(-t/□<sub>decay</sub>) - A2*exp(-t/□<sub>rise</sub>)</bold>, for simple spikes and CF inputs of zebrafish PNs. Simple spike and CF input timings were first extracted from the electrophysiology data for a single cell. Simple spike timings were convolved with a simple spike kernel, with amplitudes A1s and A2s and CF input timings were convolved with a similar CF input kernel, with amplitudes A1c and A2c. The sum of both these convolutions was taken to be the putative calcium imaging reconstruction, downsampled to match the sampling rate of calcium imaging. The mean squared error (MSE) between the reconstruction and the true calcium imaging trace was calculated. The values for A1s, A2s, A1c and A2c were obtained by minimising the MSE between the true calcium imaging trace and the reconstructed trace using gradient descent. To ensure that local minima were avoided, the gradient descent algorithm was repeated with randomised starting points. The kernels with these coefficients were taken to be the optimal simple spike and CF input kernels, respectively, for that cell.</p><p id="P55">The ‘optimal’ kernel would be one that generalised best. This was tested by using the kernels from one cell to reconstruct calcium imaging for other cells for which ground truth data was available. As before, the MSE and also the Pearson correlation coefficient between the reconstructed trace and the true trace were calculated. The final ‘optimal’ kernel was obtained by taking the kernel which generalised the best, i.e., had minimum MSE and maximum correlation across all cells. To test whether the correlation was real or not, the Pearson correlation coefficient between a scrambled reconstructed trace and the true trace was also calculated, for reference.</p><p id="P56">This process of convolving simple spike and CF timings with their optimal GCaMP5G kernels and summating the resultant traces was then used to generate a calcium imaging trace from both extracellular and intracellular Purkinje cell recordings.</p></sec><sec id="S21"><title>Building a state-labelled calcium imaging dataset</title><p id="P57">Intracellular and extracellular recordings from larval zebrafish Purkinje neurons acquired during the period 2011-2020 by various members of the lab were compiled. Good quality recordings were those in which the resting membrane potential of the cell was not below -80mV or not above -20mV, were uninterrupted gap-free recordings with no current injections and had two clearly distinguishable event types. Only those recordings which met the aforementioned criteria were retained. Besides poor quality recordings, those recordings with an ambiguous, indeterminate state were also excluded. These recordings were renumbered randomly, to remove grouping of data collected by the same individual. Recordings were then classified as tonic or bursting. If there was a switch in state within the recording, the recordings were labelled as “switch”, with the appropriate state switch timing and kind (tonic-to-bursting, or bursting-to-tonic) marked. A summary of the recording information is in <xref ref-type="table" rid="T1">Table 1</xref>.</p><p id="P58">Here, data was split into two groups - one that contained traces only with a single state throughout the recording, and another that contained traces with switches in state. Once split, the spike detection protocol described above was applied to each group of recordings to detect the simple spikes and CF inputs. These event timings were then used to generate simulated calcium imaging traces as described above. Combining the reconstruction with the assigned state resulted in the state-labelled calcium imaging dataset.</p></sec><sec id="S22"><title>Principal Components Analysis</title><p id="P59">Principal Components Analysis was performed using the PCA module that is part of the sklearn package in Python (<xref ref-type="bibr" rid="R43">Pedregosa et al., 2011</xref>). The input to the model was a vector with the trace features for each 10 second long trace in the reconstructions dataset (number of peaks, peak amplitude, area under the curve, mean, standard deviation and coefficient of variation). A 2-component PCA was performed, and the resulting fit (shown in <xref ref-type="fig" rid="F4">Figure 4E</xref>) explained 88% of the variance in the data.</p></sec><sec id="S23"><title>Training the CNN-LSTM model for classification</title><p id="P60">The dataset of reconstructed calcium imaging time series was first split into 5 folds to perform cross validation (<xref ref-type="fig" rid="F5">Fig 5A</xref>). The experiments are repeated by considering each fold as a test set, with one of the folds being the validation set and remaining 3 folds to be training sets such that the data split for each experiment is as follows - 60% for training, 20% for validation, 20% for testing. This splitting was done at the level of entire traces, such that the training, testing and cross-validation sets all had a balanced representation of traces from both the tonic and bursting classes. We chose to do a 5-fold cross-validation, i.e. the entire training dataset is split into 5 parts, each containing 20% of the data. Four of the folds are used for training and the remaining one is used for cross-validation.</p><p id="P61">The architecture of the network is shown in <xref ref-type="fig" rid="F5">Fig 5B</xref>. The input to the network is the entire trace sequence at 30Hz, normalised using min-max normalisation for every non-overlapping 10 second period, thus setting the minimum to 0, and maximum to 1. The first layer of processing is a CNN with kernel size 30 and stride size 30. The CNN downsamples the input trace from 30Hz to 1Hz, and produces 4 vector outputs, which act as the input to the LSTM. The LSTM is bidirectional, so it looks at the sequence in both the forward and reverse order to produce an output. The LSTM has 24 hidden layers, so it produces 48 numbers per time step (<xref ref-type="fig" rid="F5">Fig 5B</xref>). The feature dimensions are collapsed by a Linear layer by taking their weighted average. This provides the classification logits at each position, which is passed through a softmax layer. The network is optimised using a cross entropy loss and the Adam optimizer (<xref ref-type="bibr" rid="R26">Kingma and Ba, 2017</xref>). The output of a trained neural network, then, is the probability of each timestep (at 1 Hz) belonging to the bursting class, from which the probability of it belonging to the tonic class can be derived. The class with the higher probability is assigned to each time step.</p><p id="P62">Since the model acts on the entire trace sequence, the amount of independent data for training the model is significantly reduced. To overcome this issue, we used a data augmentation strategy, which allows the network to learn features on arbitrary length sequences. For a sequence of length N, we determine a random segment size n, with n between [k, N], where k is the minimum sequence length. We randomly determine a starting position x, with a constraint that x &lt; N - n. In our case, k=300 samples, and n varies in multiples of k (i.e. n = 300, 600, 900…). In each iteration of the network pass during the training phase, this random sequential segment was taken as the input trace to the model and gradient descent was performed to update weights. This was done for all the traces in the training set, so that the network saw entire traces at least once and in a non-overlapping fashion during the 500 epochs of training. The training is stopped before the full 500 epochs, based on early stopping criteria - if the validation loss does not improve after few epochs. All models were trained using the PyTorch framework in Python 3 (<xref ref-type="bibr" rid="R42">Paszke et al., 2019</xref>).</p><p id="P63">For all evaluations - cross-validation, test and other independent validations, the network had to make predictions for the entire trace duration and not just the n-sample long chunks. Networks were evaluated using two metrics - classification accuracies and F1-scores. Classification accuracies are simply the fraction of predictions that were correct. F1-scores, on the other hand, are adjusted for class imbalances and account for the kind of errors made. By definition, an F1-score is the harmonic mean of the precision and recall metrics, where precision is the fraction of all predicted positives that were true positives, and recall is the fraction of all ground truth positives that were true positives.</p></sec><sec id="S24"><title>Generating artificial Purkinje neuron spike trains</title><p id="P64">Synthetic spike trains of the tonic class were generated using a Poisson statistical model. The only parameter needed for this is an average event rate, λ, which we took to be a random number between 4-10 for simple spikes. Spike trains for bursting neurons do not follow Poisson statistics. Hence, we used an inverse sampling method to generate spike trains of the bursting class. For this, we used the compiled electrophysiology data to obtain the real cumulative distribution of interevent intervals for simple spikes across all bursting cells. A random number, y, is generated from the uniform distribution and it is used to find a value x from the reference cumulative interspike interval (ISI) distribution such that P(ISI &lt;= x) = y. Thus, by generating events sequentially with a given next interevent interval, we obtained artificial simple spike trains for the bursting class.</p><p id="P65">CF input event trains were generated using a Poisson statistics model with an average event rate between 0.2-1. The distributions of interevent intervals in the synthetic datasets were compared against the real distributions using histograms and QQ plots (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6C-F</xref>). Independent reviewers were asked to classify unlabelled spike trains as real or artificial and managed to do so with an accuracy of ~42% on average.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS157079-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d124aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S25"><title>Acknowledgements</title><p>The authors would like to thank the following sources of funding support: Wellcome Trust-DBT India Alliance Intermediate (VT; 500040/Z/09/Z) and Senior fellowships (VT; IA/S/17/2/503297), Department of Biotechnology (VT; BT/PR4983/MED/30/790/2012), Science and Engineering Research Board, Department of Science and Technology (VT; EMR/2015/000595), Department of Atomic Energy (VT) and Department of Science and Technology, Govt. of India (PKG). The authors would also like to thank members of the fishfolk lab at NCBS for their inputs at various stages of this project, and T.P. Jagadeesh for maintaining the fish facility. The authors would also like to thank Prof. Rohini Balakrishnan for initiating this collaboration.</p></ack><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbinanti</surname><given-names>MD</given-names></name><name><surname>Zhong</surname><given-names>G</given-names></name><name><surname>Harris-Warrick</surname><given-names>RM</given-names></name></person-group><article-title>Postnatal emergence of serotonin-induced plateau potentials in commissural interneurons of the mouse spinal cord</article-title><source>Journal of Neurophysiology</source><year>2012</year><volume>108</volume><fpage>2191</fpage><lpage>2202</lpage><pub-id pub-id-type="pmcid">PMC3545016</pub-id><pub-id pub-id-type="pmid">22832564</pub-id><pub-id pub-id-type="doi">10.1152/jn.00336.2012</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Keller</surname><given-names>PJ</given-names></name></person-group><article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>413</fpage><lpage>420</lpage><pub-id pub-id-type="pmid">23524393</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ali</surname><given-names>F</given-names></name><name><surname>Kwan</surname><given-names>AC</given-names></name></person-group><article-title>Interpreting in vivo calcium signals from neuronal cell bodies, axons, and dendrites: a review</article-title><source>Neurophotonics</source><year>2020</year><volume>7</volume><elocation-id>011402</elocation-id><pub-id pub-id-type="pmcid">PMC6664352</pub-id><pub-id pub-id-type="pmid">31372367</pub-id><pub-id pub-id-type="doi">10.1117/1.NPh.7.1.011402</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armstrong</surname><given-names>DM</given-names></name><name><surname>Edgley</surname><given-names>SA</given-names></name></person-group><article-title>Discharges of Purkinje cells in the paravermal part of the cerebellar anterior lobe during locomotion in the cat</article-title><source>J Physiol (Lond)</source><year>1984</year><volume>352</volume><fpage>403</fpage><lpage>424</lpage><pub-id pub-id-type="pmcid">PMC1193220</pub-id><pub-id pub-id-type="pmid">6747896</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.1984.sp015300</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bae</surname><given-names>Y-K</given-names></name><name><surname>Kani</surname><given-names>S</given-names></name><name><surname>Shimizu</surname><given-names>T</given-names></name><name><surname>Tanabe</surname><given-names>K</given-names></name><name><surname>Nojima</surname><given-names>H</given-names></name><name><surname>Kimura</surname><given-names>Y</given-names></name><name><surname>Higashijima</surname><given-names>S</given-names></name><name><surname>Hibi</surname><given-names>M</given-names></name></person-group><article-title>Anatomy of zebrafish cerebellum and screen for mutations affecting its development</article-title><source>Dev Biol</source><year>2009</year><volume>330</volume><fpage>406</fpage><lpage>426</lpage><pub-id pub-id-type="pmid">19371731</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borst</surname><given-names>JG</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name></person-group><article-title>Calcium influx during an action potential</article-title><source>Methods Enzymol</source><year>1998</year><volume>293</volume><fpage>352</fpage><lpage>371</lpage><pub-id pub-id-type="pmid">9711618</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>T-W</given-names></name><name><surname>Wardill</surname><given-names>TJ</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Renninger</surname><given-names>SL</given-names></name><name><surname>Baohan</surname><given-names>A</given-names></name><name><surname>Schreiter</surname><given-names>ER</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><etal/></person-group><article-title>Ultrasensitive fluorescent proteins for imaging neuronal activity</article-title><source>Nature</source><year>2013</year><volume>499</volume><fpage>295</fpage><lpage>300</lpage><pub-id pub-id-type="pmcid">PMC3777791</pub-id><pub-id pub-id-type="pmid">23868258</pub-id><pub-id pub-id-type="doi">10.1038/nature12354</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conway</surname><given-names>BA</given-names></name><name><surname>Hultborn</surname><given-names>H</given-names></name><name><surname>Kiehn</surname><given-names>O</given-names></name><name><surname>Mintz</surname><given-names>I</given-names></name></person-group><article-title>Plateau potentials in alpha- motoneurones induced by intravenous injection of L-dopa and clonidine in the spinal cat</article-title><source>J Physiol (Lond)</source><year>1988</year><volume>405</volume><fpage>369</fpage><lpage>384</lpage><pub-id pub-id-type="pmcid">PMC1190980</pub-id><pub-id pub-id-type="pmid">3255795</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.1988.sp017337</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname><given-names>RL</given-names></name><name><surname>Wilson</surname><given-names>CJ</given-names></name></person-group><article-title>Spontaneous firing patterns and axonal projections of single corticostriatal neurons in the rat medial agranular cortex</article-title><source>Journal of Neurophysiology</source><year>1994</year><volume>71</volume><fpage>17</fpage><lpage>32</lpage><pub-id pub-id-type="pmid">8158226</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Zeeuw</surname><given-names>CI</given-names></name><name><surname>Hoebeek</surname><given-names>FE</given-names></name><name><surname>Bosman</surname><given-names>LWJ</given-names></name><name><surname>Schonewille</surname><given-names>M</given-names></name><name><surname>Witter</surname><given-names>L</given-names></name><name><surname>Koekkoek</surname><given-names>SK</given-names></name></person-group><article-title>Spatiotemporal firing patterns in the cerebellum</article-title><source>Nature Reviews Neuroscience</source><year>2011</year><volume>12</volume><fpage>327</fpage><lpage>344</lpage><pub-id pub-id-type="pmid">21544091</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname><given-names>PS</given-names></name><name><surname>Nagy</surname><given-names>F</given-names></name></person-group><article-title>Control of a central pattern generator by an identified modulatory interneurone in crustacea. II. Induction and modification of plateau properties in pyloric neurones</article-title><source>Journal of Experimental Biology</source><year>1983</year><volume>105</volume><fpage>59</fpage><lpage>82</lpage><pub-id pub-id-type="pmid">6619733</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egorov</surname><given-names>AV</given-names></name><name><surname>Hamam</surname><given-names>BN</given-names></name><name><surname>Fransén</surname><given-names>E</given-names></name><name><surname>Hasselmo</surname><given-names>ME</given-names></name><name><surname>Alonso</surname><given-names>AA</given-names></name></person-group><article-title>Graded persistent activity in entorhinal cortex neurons</article-title><source>Nature</source><year>2002</year><volume>420</volume><fpage>173</fpage><lpage>178</lpage><pub-id pub-id-type="pmid">12432392</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engbers</surname><given-names>JDT</given-names></name><name><surname>Fernandez</surname><given-names>FR</given-names></name><name><surname>Turner</surname><given-names>RW</given-names></name></person-group><article-title>Bistability in Purkinje neurons: Ups and downs in cerebellar research</article-title><source>Neural Networks, Computation in the Cerebellum</source><year>2013</year><volume>47</volume><fpage>18</fpage><lpage>31</lpage><pub-id pub-id-type="pmid">23041207</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuentealba</surname><given-names>P</given-names></name><name><surname>Timofeev</surname><given-names>I</given-names></name><name><surname>Bazhenov</surname><given-names>M</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>Steriade</surname><given-names>M</given-names></name></person-group><article-title>Membrane Bistability in Thalamic Reticular Neurons During Spindle Oscillations</article-title><source>Journal of Neurophysiology</source><year>2005</year><volume>93</volume><fpage>294</fpage><lpage>304</lpage><pub-id pub-id-type="pmcid">PMC2915789</pub-id><pub-id pub-id-type="pmid">15331618</pub-id><pub-id pub-id-type="doi">10.1152/jn.00552.2004</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Göbel</surname><given-names>W</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name></person-group><article-title>In Vivo Calcium Imaging of Neural Network Function</article-title><source>Physiology</source><year>2007</year><volume>22</volume><fpage>358</fpage><lpage>365</lpage><pub-id pub-id-type="pmid">18073408</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grewe</surname><given-names>BF</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name></person-group><article-title>Optical probing of neuronal ensemble activity</article-title><source>Current Opinion in Neurobiology, Neuronal and glial cell biology New technologies</source><year>2009</year><volume>19</volume><fpage>520</fpage><lpage>529</lpage><pub-id pub-id-type="pmid">19854041</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grienberger</surname><given-names>C</given-names></name><name><surname>Konnerth</surname><given-names>A</given-names></name></person-group><article-title>Imaging Calcium in Neurons</article-title><source>Neuron</source><year>2012</year><volume>73</volume><fpage>862</fpage><lpage>885</lpage><pub-id pub-id-type="pmid">22405199</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harmon</surname><given-names>TC</given-names></name><name><surname>McLean</surname><given-names>DL</given-names></name><name><surname>Raman</surname><given-names>IM</given-names></name></person-group><article-title>Integration of Swimming-Related Synaptic Excitation and Inhibition by olig2+ Eurydendroid Neurons in Larval Zebrafish Cerebellum</article-title><source>J Neurosci</source><year>2020</year><volume>40</volume><fpage>3063</fpage><lpage>3074</lpage><pub-id pub-id-type="pmcid">PMC7141884</pub-id><pub-id pub-id-type="pmid">32139583</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2322-19.2020</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>He</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>S</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><source>Deep Residual Learning for Image Recognition2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</source><conf-name>Presented at the 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</conf-name><year>2016</year><fpage>770</fpage><lpage>778</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2016.90</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochreiter</surname><given-names>S</given-names></name><name><surname>Schmidhuber</surname><given-names>J</given-names></name></person-group><article-title>Long Short-Term Memory</article-title><source>Neural Computation</source><year>1997</year><volume>9</volume><fpage>1735</fpage><lpage>1780</lpage><pub-id pub-id-type="pmid">9377276</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hounsgaard</surname><given-names>J</given-names></name><name><surname>Hultborn</surname><given-names>H</given-names></name><name><surname>Jespersen</surname><given-names>B</given-names></name><name><surname>Kiehn</surname><given-names>O</given-names></name></person-group><article-title>Bistability of alpha- motoneurones in the decerebrate cat and in the acute spinal cat after intravenous 5-hydroxytryptophan</article-title><source>The Journal of Physiology</source><year>1988</year><volume>405</volume><fpage>345</fpage><lpage>367</lpage><pub-id pub-id-type="pmcid">PMC1190979</pub-id><pub-id pub-id-type="pmid">3267153</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.1988.sp017336</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hounsgaard</surname><given-names>J</given-names></name><name><surname>Hultborn</surname><given-names>H</given-names></name><name><surname>Jespersen</surname><given-names>B</given-names></name><name><surname>Kiehn</surname><given-names>O</given-names></name></person-group><article-title>Intrinsic membrane properties causing a bistable behaviour of alpha-motoneurones</article-title><source>Exp Brain Res</source><year>1984</year><volume>55</volume><fpage>391</fpage><lpage>394</lpage><pub-id pub-id-type="pmid">6086378</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ikenaga</surname><given-names>T</given-names></name><name><surname>Yoshida</surname><given-names>M</given-names></name><name><surname>Uematsu</surname><given-names>K</given-names></name></person-group><article-title>Cerebellar efferent neurons in teleost fish</article-title><source>Cerebellum</source><year>2006</year><volume>5</volume><fpage>268</fpage><lpage>274</lpage><pub-id pub-id-type="pmid">17134989</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahnsen</surname><given-names>H</given-names></name><name><surname>Llinás</surname><given-names>R</given-names></name></person-group><article-title>Electrophysiological properties of guinea-pig thalamic neurones: an in vitro study</article-title><source>The Journal of Physiology</source><year>1984</year><volume>349</volume><fpage>205</fpage><lpage>226</lpage><pub-id pub-id-type="pmcid">PMC1199334</pub-id><pub-id pub-id-type="pmid">6737292</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.1984.sp015153</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerr</surname><given-names>JND</given-names></name><name><surname>Greenberg</surname><given-names>D</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name></person-group><article-title>Imaging input and output of neocortical networks in vivo</article-title><source>Proceedings of the National Academy of Sciences</source><year>2005</year><volume>102</volume><fpage>14063</fpage><lpage>14068</lpage><pub-id pub-id-type="pmcid">PMC1201343</pub-id><pub-id pub-id-type="pmid">16157876</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0506029102</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><article-title>Adam: A Method for Stochastic Optimization</article-title><year>2017</year><pub-id pub-id-type="doi">10.48550/arXiv.1412.6980</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kitamura</surname><given-names>K</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><article-title>Dendritic calcium signaling triggered by spontaneous and sensory-evoked climbing fiber input to cerebellar Purkinje cells in vivo</article-title><source>J Neurosci</source><year>2011</year><volume>31</volume><fpage>10847</fpage><lpage>10858</lpage><pub-id pub-id-type="pmcid">PMC3758548</pub-id><pub-id pub-id-type="pmid">21795537</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2525-10.2011</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knogler</surname><given-names>LD</given-names></name><name><surname>Kist</surname><given-names>AM</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><article-title>Motor context dominates output from purkinje cell functional regions during reflexive visuomotor behaviours</article-title><source>eLife</source><year>2019</year><volume>8</volume><elocation-id>e42138</elocation-id><pub-id pub-id-type="pmcid">PMC6374073</pub-id><pub-id pub-id-type="pmid">30681408</pub-id><pub-id pub-id-type="doi">10.7554/eLife.42138</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kwan</surname><given-names>AC</given-names></name><name><surname>Dan</surname><given-names>Y</given-names></name></person-group><article-title>Dissection of Cortical Microcircuits by Single-Neuron Stimulation In Vivo</article-title><source>Current Biology</source><year>2012</year><volume>22</volume><fpage>1459</fpage><lpage>1467</lpage><pub-id pub-id-type="pmcid">PMC3467311</pub-id><pub-id pub-id-type="pmid">22748320</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2012.06.007</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lechner</surname><given-names>HA</given-names></name><name><surname>Baxter</surname><given-names>DA</given-names></name><name><surname>Clark</surname><given-names>JW</given-names></name><name><surname>Byrne</surname><given-names>JH</given-names></name></person-group><article-title>Bistability and its regulation by serotonin in the endogenously bursting neuron R15 in Aplysia</article-title><source>J Neurophysiol</source><year>1996</year><volume>75</volume><fpage>957</fpage><lpage>962</lpage><pub-id pub-id-type="pmid">8714668</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lev-Ram</surname><given-names>V</given-names></name><name><surname>Miyakawa</surname><given-names>H</given-names></name><name><surname>Lasser-Ross</surname><given-names>N</given-names></name><name><surname>Ross</surname><given-names>WN</given-names></name></person-group><article-title>Calcium transients in cerebellar Purkinje neurons evoked by intracellular stimulation</article-title><source>Journal of Neurophysiology</source><year>1992</year><volume>68</volume><fpage>1167</fpage><lpage>1177</lpage><pub-id pub-id-type="pmid">1432076</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>B-J</given-names></name><name><surname>Chen</surname><given-names>T-W</given-names></name><name><surname>Schild</surname><given-names>D</given-names></name></person-group><article-title>Cell type-specific relationships between spiking and [Ca2+]i in neurons of the Xenopus tadpole olfactory bulb</article-title><source>The Journal of Physiology</source><year>2007</year><volume>582</volume><fpage>163</fpage><lpage>175</lpage><pub-id pub-id-type="pmcid">PMC2075311</pub-id><pub-id pub-id-type="pmid">17463049</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.2006.125963</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loewenstein</surname><given-names>Y</given-names></name><name><surname>Mahon</surname><given-names>S</given-names></name><name><surname>Chadderton</surname><given-names>P</given-names></name><name><surname>Kitamura</surname><given-names>K</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name><name><surname>Yarom</surname><given-names>Y</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><article-title>Bistability of cerebellar Purkinje cells modulated by sensory stimulation</article-title><source>Nat Neurosci</source><year>2005</year><volume>8</volume><fpage>202</fpage><lpage>211</lpage><pub-id pub-id-type="pmid">15665875</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Turrigiano</surname><given-names>GG</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Golowasch</surname><given-names>J</given-names></name></person-group><source>Memory from the dynamics of intrinsic membrane currents</source><conf-name>Proceedings of the National Academy of Sciences</conf-name><year>1996</year><volume>93</volume><fpage>13481</fpage><lpage>13486</lpage><pub-id pub-id-type="doi">10.1073/pnas.93.24.13481</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>H</given-names></name><name><surname>Toledo-Rodriguez</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Silberberg</surname><given-names>G</given-names></name><name><surname>Wu</surname><given-names>C</given-names></name></person-group><article-title>Interneurons of the neocortical inhibitory system</article-title><source>Nat Rev Neurosci</source><year>2004</year><volume>5</volume><fpage>793</fpage><lpage>807</lpage><pub-id pub-id-type="pmid">15378039</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>H</given-names></name><name><surname>Namikawa</surname><given-names>K</given-names></name><name><surname>Babaryka</surname><given-names>A</given-names></name><name><surname>Köster</surname><given-names>RW</given-names></name></person-group><article-title>Functional regionalization of the teleost cerebellum analyzed in vivo</article-title><source>Proc Natl Acad Sci USA</source><year>2014</year><volume>111</volume><fpage>11846</fpage><lpage>11851</lpage><pub-id pub-id-type="pmcid">PMC4136595</pub-id><pub-id pub-id-type="pmid">25002482</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1403105111</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCormick</surname><given-names>DA</given-names></name><name><surname>Connors</surname><given-names>BW</given-names></name><name><surname>Lighthall</surname><given-names>JW</given-names></name><name><surname>Prince</surname><given-names>DA</given-names></name></person-group><article-title>Comparative electrophysiology of pyramidal and sparsely spiny stellate neurons of the neocortex</article-title><source>Journal of Neurophysiology</source><year>1985</year><volume>54</volume><fpage>782</fpage><lpage>806</lpage><pub-id pub-id-type="pmid">2999347</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misgeld</surname><given-names>U</given-names></name><name><surname>Calabresi</surname><given-names>P</given-names></name><name><surname>Dodt</surname><given-names>HU</given-names></name></person-group><article-title>Muscarinic modulation of calcium dependent plateau potentials in rat neostriatal neurons</article-title><source>Pflugers Arch</source><year>1986</year><volume>407</volume><fpage>482</fpage><lpage>487</lpage><pub-id pub-id-type="pmid">3786109</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyakawa</surname><given-names>H</given-names></name><name><surname>Lev-Ram</surname><given-names>V</given-names></name><name><surname>Lasser-Ross</surname><given-names>N</given-names></name><name><surname>Ross</surname><given-names>WN</given-names></name></person-group><article-title>Calcium transients evoked by climbing fiber and parallel fiber synaptic inputs in guinea pig cerebellar Purkinje neurons</article-title><source>J Neurophysiol</source><year>1992</year><volume>68</volume><fpage>1178</fpage><lpage>1189</lpage><pub-id pub-id-type="pmid">1359027</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreaux</surname><given-names>L</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name></person-group><article-title>Estimating firing rates from calcium signals in locust projection neurons in vivo</article-title><source>Frontiers in Neural Circuits</source><year>2007</year><volume>1</volume><pub-id pub-id-type="pmcid">PMC2526277</pub-id><pub-id pub-id-type="pmid">18946544</pub-id><pub-id pub-id-type="doi">10.3389/neuro.04.002.2007</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narayanan</surname><given-names>S</given-names></name><name><surname>Thirumalai</surname><given-names>V</given-names></name></person-group><article-title>Contributions of the Cerebellum for Predictive and Instructional Control of Movement</article-title><source>Curr Opin Physiol</source><year>2019</year><volume>8</volume><fpage>146</fpage><lpage>151</lpage><pub-id pub-id-type="pmcid">PMC6436720</pub-id><pub-id pub-id-type="pmid">30944888</pub-id><pub-id pub-id-type="doi">10.1016/j.cophys.2019.01.011</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Massa</surname><given-names>F</given-names></name><name><surname>Lerer</surname><given-names>A</given-names></name><name><surname>Bradbury</surname><given-names>J</given-names></name><name><surname>Chanan</surname><given-names>G</given-names></name><name><surname>Killeen</surname><given-names>T</given-names></name><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Gimelshein</surname><given-names>N</given-names></name><name><surname>Antiga</surname><given-names>L</given-names></name><name><surname>Desmaison</surname><given-names>A</given-names></name><etal/></person-group><source>PyTorch: An Imperative Style, High-Performance Deep Learning LibraryAdvances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc</publisher-name><year>2019</year></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Prettenhofer</surname><given-names>P</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Dubourg</surname><given-names>V</given-names></name><name><surname>Vanderplas</surname><given-names>J</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine Learning in Python</article-title><source>Journal of Machine Learning Research</source><year>2011</year><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peron</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>T-W</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name></person-group><article-title>Comprehensive imaging of cortical networks</article-title><source>Current Opinion in Neurobiology</source><year>2015</year><volume>32</volume><fpage>115</fpage><lpage>123</lpage><comment>Large-Scale Recording Technology (32)</comment><pub-id pub-id-type="pmid">25880117</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Person</surname><given-names>AL</given-names></name><name><surname>Raman</surname><given-names>IM</given-names></name></person-group><article-title>Purkinje neuron synchrony elicits time-locked spiking in the cerebellar nuclei</article-title><source>Nature</source><year>2012</year><volume>481</volume><fpage>502</fpage><lpage>505</lpage><pub-id pub-id-type="pmcid">PMC3268051</pub-id><pub-id pub-id-type="pmid">22198670</pub-id><pub-id pub-id-type="doi">10.1038/nature10732</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popa</surname><given-names>LS</given-names></name><name><surname>Streng</surname><given-names>ML</given-names></name><name><surname>Ebner</surname><given-names>TJ</given-names></name></person-group><article-title>Purkinje Cell Representations of Behavior: Diary of a Busy Neuron</article-title><source>Neuroscientist</source><year>2018</year><elocation-id>1073858418785628</elocation-id><pub-id pub-id-type="pmcid">PMC6509027</pub-id><pub-id pub-id-type="pmid">29985093</pub-id><pub-id pub-id-type="doi">10.1177/1073858418785628</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramirez</surname><given-names>JE</given-names></name><name><surname>Stell</surname><given-names>BM</given-names></name></person-group><article-title>Calcium Imaging Reveals Coordinated Simple Spike Pauses in Populations of Cerebellar Purkinje Cells</article-title><source>Cell Reports</source><year>2016</year><volume>17</volume><fpage>3125</fpage><lpage>3132</lpage><pub-id pub-id-type="pmid">28009283</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renninger</surname><given-names>SL</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name></person-group><article-title>Two-photon imaging of neural population activity in zebrafish</article-title><source>Methods, Zebrafish Methods</source><year>2013</year><volume>62</volume><fpage>255</fpage><lpage>267</lpage><pub-id pub-id-type="pmid">23727462</pub-id></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rupprecht</surname><given-names>P</given-names></name><name><surname>Carta</surname><given-names>S</given-names></name><name><surname>Hoffmann</surname><given-names>A</given-names></name><name><surname>Echizen</surname><given-names>M</given-names></name><name><surname>Blot</surname><given-names>A</given-names></name><name><surname>Kwan</surname><given-names>AC</given-names></name><name><surname>Dan</surname><given-names>Y</given-names></name><name><surname>Hofer</surname><given-names>SB</given-names></name><name><surname>Kitamura</surname><given-names>K</given-names></name><name><surname>Helmchen</surname><given-names>F</given-names></name><name><surname>Friedrich</surname><given-names>RW</given-names></name></person-group><article-title>A database and deep learning toolbox for noise-optimized, generalized spike inference from calcium imaging</article-title><source>Nat Neurosci</source><year>2021</year><volume>24</volume><fpage>1324</fpage><lpage>1337</lpage><pub-id pub-id-type="pmcid">PMC7611618</pub-id><pub-id pub-id-type="pmid">34341584</pub-id><pub-id pub-id-type="doi">10.1038/s41593-021-00895-5</pub-id></element-citation></ref><ref id="R50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russell</surname><given-names>DF</given-names></name><name><surname>Hartline</surname><given-names>DK</given-names></name></person-group><article-title>Slow active potentials and bursting motor patterns in pyloric network of the lobster</article-title><source>Panulirus interruptus Journal of Neurophysiology</source><year>1982</year><volume>48</volume><fpage>914</fpage><lpage>937</lpage><pub-id pub-id-type="pmid">7143034</pub-id></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J</given-names></name><name><surname>Arganda-Carreras</surname><given-names>I</given-names></name><name><surname>Frise</surname><given-names>E</given-names></name><name><surname>Kaynig</surname><given-names>V</given-names></name><name><surname>Longair</surname><given-names>M</given-names></name><name><surname>Pietzsch</surname><given-names>T</given-names></name><name><surname>Preibisch</surname><given-names>S</given-names></name><name><surname>Rueden</surname><given-names>C</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Schmid</surname><given-names>B</given-names></name><name><surname>Tinevez</surname><given-names>J-Y</given-names></name><etal/></person-group><article-title>Fiji: an open-source platform for biological-image analysis</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><fpage>676</fpage><lpage>682</lpage><pub-id pub-id-type="pmcid">PMC3855844</pub-id><pub-id pub-id-type="pmid">22743772</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwindt</surname><given-names>P</given-names></name><name><surname>Crill</surname><given-names>W</given-names></name></person-group><article-title>Role of a persistent inward current in motoneuron bursting during spinal seizures</article-title><source>Journal of Neurophysiology</source><year>1980</year><volume>43</volume><fpage>1296</fpage><lpage>1318</lpage><pub-id pub-id-type="pmid">6246221</pub-id></element-citation></ref><ref id="R53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sengupta</surname><given-names>M</given-names></name></person-group><source>Purkinje neurons in action: From single cells to ensembles</source><publisher-name>Tata Institute of Fundamental Research</publisher-name><publisher-loc>Mumbai</publisher-loc><year>2015</year></element-citation></ref><ref id="R54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sengupta</surname><given-names>M</given-names></name><name><surname>Thirumalai</surname><given-names>V</given-names></name></person-group><article-title>AMPA receptor mediated synaptic excitation drives state-dependent bursting in Purkinje neurons of zebrafish larvae</article-title><source>Elife</source><year>2015</year><volume>4</volume><pub-id pub-id-type="pmcid">PMC4584246</pub-id><pub-id pub-id-type="pmid">26416140</pub-id><pub-id pub-id-type="doi">10.7554/eLife.09158</pub-id></element-citation></ref><ref id="R55"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Thirumalai</surname><given-names>V</given-names></name><name><surname>Jha</surname><given-names>U</given-names></name></person-group><source>RECRUITMENT OF MOTONEURONSVertebrate Motoneurons</source><publisher-name>Springer-Verlag</publisher-name><year>2022</year><comment>In Press</comment></element-citation></ref><ref id="R56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Hires</surname><given-names>SA</given-names></name><name><surname>Mao</surname><given-names>T</given-names></name><name><surname>Huber</surname><given-names>D</given-names></name><name><surname>Chiappe</surname><given-names>ME</given-names></name><name><surname>Chalasani</surname><given-names>SH</given-names></name><name><surname>Petreanu</surname><given-names>L</given-names></name><name><surname>Akerboom</surname><given-names>J</given-names></name><name><surname>McKinney</surname><given-names>SA</given-names></name><name><surname>Schreiter</surname><given-names>ER</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name><etal/></person-group><article-title>Imaging neural activity in worms, flies and mice with improved GCaMP calcium indicators</article-title><source>Nat Methods</source><year>2009</year><volume>6</volume><fpage>875</fpage><lpage>881</lpage><pub-id pub-id-type="pmcid">PMC2858873</pub-id><pub-id pub-id-type="pmid">19898485</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.1398</pub-id></element-citation></ref><ref id="R57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urasaki</surname><given-names>A</given-names></name><name><surname>Morvan</surname><given-names>G</given-names></name><name><surname>Kawakami</surname><given-names>K</given-names></name></person-group><article-title>Functional dissection of the Tol2 transposable element identified the minimal cis-sequence and a highly repetitive sequence in the subterminal region essential for transposition</article-title><source>Genetics</source><year>2006</year><volume>174</volume><fpage>639</fpage><lpage>649</lpage><pub-id pub-id-type="pmcid">PMC1602067</pub-id><pub-id pub-id-type="pmid">16959904</pub-id><pub-id pub-id-type="doi">10.1534/genetics.106.060244</pub-id></element-citation></ref><ref id="R58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogelstein</surname><given-names>JT</given-names></name><name><surname>Packer</surname><given-names>AM</given-names></name><name><surname>Machado</surname><given-names>TA</given-names></name><name><surname>Sippy</surname><given-names>T</given-names></name><name><surname>Babadi</surname><given-names>B</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><article-title>Fast Nonnegative Deconvolution for Spike Train Inference From Population Calcium Imaging</article-title><source>Journal of Neurophysiology</source><year>2010</year><volume>104</volume><fpage>3691</fpage><lpage>3704</lpage><pub-id pub-id-type="pmcid">PMC3007657</pub-id><pub-id pub-id-type="pmid">20554834</pub-id><pub-id pub-id-type="doi">10.1152/jn.01073.2009</pub-id></element-citation></ref><ref id="R59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>SR</given-names></name><name><surname>Christensen</surname><given-names>SR</given-names></name><name><surname>Stuart</surname><given-names>GJ</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><article-title>Membrane potential bistability is controlled by the hyperpolarization-activated current I(H) in rat cerebellar Purkinje neurons in vitro</article-title><source>J Physiol (Lond)</source><year>2002</year><volume>539</volume><fpage>469</fpage><lpage>483</lpage><pub-id pub-id-type="pmcid">PMC2290163</pub-id><pub-id pub-id-type="pmid">11882679</pub-id><pub-id pub-id-type="doi">10.1113/jphysiol.2001.013136</pub-id></element-citation></ref><ref id="R60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yaksi</surname><given-names>E</given-names></name><name><surname>Friedrich</surname><given-names>RW</given-names></name></person-group><article-title>Reconstruction of firing rate changes across neuronal populations by temporally deconvolved Ca2+ imaging</article-title><source>Nat Methods</source><year>2006</year><volume>3</volume><fpage>377</fpage><lpage>383</lpage><pub-id pub-id-type="pmid">16628208</pub-id></element-citation></ref><ref id="R61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>W</given-names></name><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><article-title>In vivo imaging of neural activity</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>349</fpage><lpage>359</lpage><pub-id pub-id-type="pmcid">PMC5903578</pub-id><pub-id pub-id-type="pmid">28362436</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4230</pub-id></element-citation></ref><ref id="R62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeldenrust</surname><given-names>F</given-names></name><name><surname>Wadman</surname><given-names>WJ</given-names></name><name><surname>Englitz</surname><given-names>B</given-names></name></person-group><article-title>Neural Coding With Bursts—Current State and Future Perspectives</article-title><source>Frontiers in Computational Neuroscience</source><year>2018</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC6043860</pub-id><pub-id pub-id-type="pmid">30034330</pub-id><pub-id pub-id-type="doi">10.3389/fncom.2018.00048</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Cerebellar Purkinje neurons (PNs) in larval zebrafish exhibit membrane potential bistability</title><p><bold>(A)</bold> Schematic of the cerebellar circuitry in larval zebrafish (<italic>Danio rerio</italic>), showing the location of the cerebellum in the brain (left) and the cell types and circuit architecture (right). Purkinje neurons (green) are the principal neurons in this circuit and receive multiple inputs from afferent sensorimotor nuclei outside the cerebellum via parallel fibers (black) and climbing fibers (magenta). <bold>(B)</bold> Representative loose patch recordings from larval zebrafish PNs showing the two modes of firing. The bursting mode recording is shown on the left, and the tonic mode is shown on the right. In each mode, electrical events can be distinguished by their amplitude, with small-amplitude simple spikes marked in cyan and the large-amplitude CF inputs marked in magenta. Note that the time scales shown for each mode are different, with a longer duration shown for the bursting mode than the tonic mode. <bold>(C)</bold> Representative whole-cell current clamp recordings showing the two modes of firing in PNs, with the same colour scheme for events as in (B). These recordings were obtained from different cells from those shown in (B). The horizontal dotted line marks -40mV. <bold>(D)</bold> Raster plots of 20 second-long epochs of events from recordings from n=10 cells in the bursting mode. <bold>(E)</bold> Raster plots as in (D) for n=10 cells in the tonic mode.</p></caption><graphic xlink:href="EMS157079-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Both simple spikes and CF EPSPs contribute to the calcium signal in PNs irrespective of cellular state.</title><p><bold>(A)</bold> Schematic of the experimental design and setup of simultaneous calcium imaging and electrophysiology in larval zebrafish. Wild-type zebrafish embryos were injected at the 1-cell stage with the Tol2-Arch-TagRFP:PC:GCaMP5G construct (left). At 7 days post fertilisation (dpf) (right), isolated PNs expressing GCaMP (right, inset) were targeted for simultaneous electrophysiology and imaging (cell and pipette outlined in white in inset). <bold>(B)</bold> and <bold>(C)</bold> Representative traces obtained during simultaneous imaging and electrophysiology for cells in the bursting (B) and tonic (C) mode. Simple spikes and CF inputs in the trace are identified and marked in the raster above the trace in cyan and magenta, respectively. The simultaneously-recorded change in GCaMP fluorescence (dF/F) is shown below in green. Calcium transients are marked with an asterisk (*) if they correspond to only simple spikes in the electrophysiology channel. Similarly, they are marked with a hash symbol (#) if they correspond only to CF inputs, and with an open circle (o) if they correspond to both simple spikes and CF inputs. <bold>(D)</bold> Event-triggered average calcium signals. <bold>(i)</bold> Simple spike-triggered average calcium signal. The black line represents the mean and the cyan-shaded region is the SEM. n=2293 events from N=15 cells. <bold>(ii)</bold> CF-input triggered average calcium signal, similar to (i). The black line represents the mean and the magenta region is the SEM. n=111 events from N=15 cells <bold>(E)</bold> Peri-event time histograms (PETHs) of <bold>(i)</bold> simple-spikes and <bold>(ii)</bold> CF inputs relative to peaks in the calcium signal. The vertical dashed lines mark t=-0.267s and t=0s, which is the interval during which the GCaMP5G increases from baseline to peak. The y-axis values represent z-scores of the event counts. The mean z-scores for the yellow and grey shaded regions are given above each shaded region.</p></caption><graphic xlink:href="EMS157079-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Reconstructing the calcium signal from electrophysiology traces.</title><p><bold>(A)</bold> Representative example showing the method used to reconstruct the calcium signal from an electrophysiological trace. Simple spike (cyan) and CF input (magenta) rasters (left) are independently convolved with calcium sensor kernels (cyan for simple spikes, magenta for CF inputs) to generate an event-specific calcium signal time series (middle). These are then simply added together to get the final reconstruction (right), shown in dark purple. This example is the same cell as shown in the rightmost plot in B(ii). <bold>(B)</bold> Comparison of ground truth and reconstructions for 6 cells (3 bursting (i) and 3 tonic (ii)) chosen randomly from the dataset. The ground truth trace is shown in green and the reconstruction in purple, and the Pearson’s correlation coefficient between the two traces is marked for each pair. <bold>(C)</bold> Quantification of the quality of reconstructions obtained using the optimal kernel combination. Correlation coefficients were calculated between the ground truth for each cell (n=15 cells; 6 bursting, 9 tonic) and either the true reconstruction, a scrambled version of the reconstruction, or the reconstruction for when simple spike and CF input event times were shuffled. A Kruskal-Wallis test yielded a p-value of 2.108 x 10^-7, which was followed by a post-hoc Dunn’s test for individual comparisons, the latter of which is marked on the figure. <bold>(D)</bold> The optimal calcium sensor kernels for simple spikes (cyan) and CF inputs (magenta).</p></caption><graphic xlink:href="EMS157079-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Generating a labelled dataset of reconstructed calcium signal traces</title><p><bold>(A)</bold> Flowchart showing how electrophysiological recordings from PNs were processed to generate the state-labelled calcium signal database. <bold>(B)</bold> Representative randomly sampled traces from the state-labelled reconstructed calcium signal dataset. The left column has reconstructions from tonic cells and the right column has reconstructions from bursting cells. Above each trace is the raster showing the events in the source recording, with simple spikes in cyan, and CF inputs in magenta. <bold>(C)</bold> Heatmaps representing all the reconstructions in the state-labelled calcium signal dataset, for each state, after splitting all traces into 10 second-long non-overlapping chunks. (n=348 tonic traces; n=580 bursting traces). <bold>(D)</bold> Comparing the distribution of trace properties for both states. The top three plots show (from left to right) the number of peaks, peak amplitude and area under the curve of the reconstructions in the dataset. The bottom three plots show (from left to right) the mean, standard deviation and the coefficient of variation of the traces. n’s are the number of 10s-long samples. N’s are the number of recordings used to generate the samples. p-values were computed using linear mixed-effects models (see <xref ref-type="table" rid="T2">Table 2</xref>). <bold>(E)</bold> Principal Components Analysis of trace properties, with data points marked by state - tonic (red crosses) and bursting (black open circles).</p></caption><graphic xlink:href="EMS157079-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Design and training of CaMLsort</title><p><bold>(A)</bold> Flowchart showing how the state-labelled calcium signal dataset was split into training and test datasets using a 5-fold 60-20-20 split into training (white boxes), test (blue boxes) and cross-validation (yellow boxes) samples, respectively. The networks that performed well in the training phase, as assessed by performance on the cross-validation samples, were then challenged with the unseen test data (blue boxes) in each fold. An independent dataset with state switches was also used to further validate the networks obtained (see <xref ref-type="fig" rid="F6">Fig 6</xref>). <bold>(B)</bold> The architecture of the convolutional recurrent neural networks used to solve the classification problem. The network takes an input time series trace sampled at 30Hz (purple) and that is a multiple of 10 seconds long in duration (here just 10 seconds long). This trace is first normalized using min-max normalization, following which it is passed through a 1-dimensional convolutional neural network (1D CNN), which has 4 kernels with a step size and stride length of 30 each. The resulting 4 traces (grey boxes) are downsampled, local feature-extracted versions of the original trace. All 4 outputs are passed to the LSTM module (central black box) for trend identification. The LSTM is a bidirectional one, which processes traces in both the forward (blue arrow) and reverse (red arrow) directions. A single time step is taken from all the CNN outputs (red and blue dotted boxes) and passed to the respective LSTM cell, which then processes the input to produce a resultant “hidden state” output (red and blue filled boxes). This output is passed back into the LSTM cell along with the next sample from the CNN’s output traces, until every time step from it has been processed (here 10 rounds). Once this is done, the final “hidden state” from each LSTM cell is retained and concatenated before their weighted average is taken by a Linear layer. The resulting average is converted to a “posterior score” using an activation function. These posterior scores represent the likelihood of the cell being in the bursting state at each time step. The likelihood of it being in the tonic state can be calculated from this. The final call is taken to be the state which has a higher posterior score. The text in italics represents the net effect of each phase of the neural network. The numbers in parentheses indicate the sampling frequency and/or the duration of the resultant vectors at various stages of processing by the neural network. Similarly, the numbers in bold and italics within square brackets indicate the size of the vectors/matrices at various stages of passing through the network. <bold>(C)</bold> Average classification accuracy (top) and F1-scores (bottom) at the cross-validation and the test phases, for trained networks. Each fold is represented in a different colour, marked in the legend to the right of panels (C) and (D). <bold>(D)</bold> Posterior scores for the predicted class in the cross-validation (top) and test (bottom) phases. Each dot represents the mean posterior score for a trained network, with error bars representing standard deviation.</p></caption><graphic xlink:href="EMS157079-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Validation of CaMLsort on independent datasets</title><p><bold>(A)</bold> CaML sort predictions on calcium signal reconstructions from previously unseen data (n=19 recordings). Predictions from CaMLsort (middle) against ground truth state (top). Predictions for each recording were made independently, but individual recordings have been stitched here for the purposes of representation. Each recording is separated by a vertical dashed line. The areas shaded in pink represent those regions where the prediction and ground truth do not match. The bottommost plot has posterior scores for each time step. The orange trace is the confidence score for the tonic class, while the green one shows the confidence scores for the bursting class. The F1 score in the heading shows the total F1-score obtained from comparing the two stitched time series. <bold>(B)</bold> Individual F1-scores for each cell and each fold of networks trained. The data represented in (A) is from network fold 2. <bold>(C)</bold> Predictions as in (A), but on calcium signal reconstructions from artificially generated PN spike trains of each class (n=20 recordings). <bold>(D)</bold> Individual F1-scores for data in (C) for all trained networks. <bold>(E)</bold> CaMLsort predictions on experimental data obtained from simultaneous imaging and electrophysiology (n=15 recordings). <bold>(F)</bold> Individual F1-scores for data in (E) across all folds of trained networks, similar to (B) and (D).</p></caption><graphic xlink:href="EMS157079-f006"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Number of recordings compiled for the state-labelled imaging dataset</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="middle"/><th align="left" valign="middle">Extracellular</th><th align="left" valign="middle">Intracellular</th><th align="left" valign="middle">Total</th></tr></thead><tbody><tr><td align="left" valign="middle">Bursting</td><td align="left" valign="middle">39</td><td align="left" valign="middle">48</td><td align="left" valign="middle"><bold>87</bold></td></tr><tr><td align="left" valign="middle">Tonic</td><td align="left" valign="middle">11</td><td align="left" valign="middle">43</td><td align="left" valign="middle"><bold>54</bold></td></tr><tr><td align="left" valign="middle">Switch</td><td align="left" valign="middle">0</td><td align="left" valign="middle">7</td><td align="left" valign="middle"><bold>7</bold></td></tr><tr><td align="left" valign="middle">Ambiguous</td><td align="left" valign="middle">0</td><td align="left" valign="middle">25</td><td align="left" valign="middle"><bold>25</bold></td></tr><tr><td align="left" valign="middle"><bold>Total</bold></td><td align="left" valign="middle"><bold>50</bold></td><td align="left" valign="middle"><bold>123</bold></td><td align="left" valign="middle"><bold>173</bold></td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><title>Linear mixed-effects model statistics for comparing the various trace properties (related to <xref ref-type="fig" rid="F4">Fig 4D</xref>)</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Parameter</th><th align="left" valign="top">Model #</th><th align="left" valign="top">Model</th><th align="left" valign="top">DF</th><th align="left" valign="top">AIC</th><th align="left" valign="top">Test</th><th align="left" valign="top">p-value</th><th align="left" valign="top">Effect Size (<italic>b</italic>) [Tonic relative to Bursting]</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="3">No of peaks</td><td align="left" valign="top">1</td><td align="left" valign="top">NPeaks ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">5066.33</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">NPeaks ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">4550.27</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;0.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">NPeaks ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">4532.48</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>&lt;0.0001</bold></td><td align="left" valign="top"><bold>2.3575</bold></td></tr><tr><td align="left" valign="top" rowspan="3">Average peak amplitude(Amp)</td><td align="left" valign="top">1</td><td align="left" valign="top">Amp ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">-2549.08</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">Amp ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">-3000.83</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;0.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">Amp ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">-3000.62</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>0.1812</bold></td><td align="left" valign="top"><bold>-0.0122</bold></td></tr><tr><td align="left" valign="top" rowspan="3">Area Under the Curve(AUC)</td><td align="left" valign="top">1</td><td align="left" valign="top">AUC ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">7192.146</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">AUC ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">6315.809</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">AUC ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">6312.661</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>0.0233</bold></td><td align="left" valign="top"><bold>4.4053</bold></td></tr><tr><td align="left" valign="top" rowspan="3">Mean dF/F (Mean)</td><td align="left" valign="top">1</td><td align="left" valign="top">Mean ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">-3365.760</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">Mean ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">-4244.373</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">Mean ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">-4247.505</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>0.0235</bold></td><td align="left" valign="top"><bold>0.0147</bold></td></tr><tr><td align="left" valign="top" rowspan="3">Standard deviation of dF/F (Stdev)</td><td align="left" valign="top">1</td><td align="left" valign="top">Stdev ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">-4566.303</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">Stdev ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">-5034.750</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">Stdev ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">-5052.501</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>&lt;.0001</bold></td><td align="left" valign="top"><bold>-0.0135</bold></td></tr><tr><td align="left" valign="top" rowspan="3">Coefficient of Variation of dF/F (CV)</td><td align="left" valign="top">1</td><td align="left" valign="top">CV ~ 1</td><td align="left" valign="top">2</td><td align="left" valign="top">1378.348</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">CV ~ 1|Cell</td><td align="left" valign="top">3</td><td align="left" valign="top">558.4086</td><td align="left" valign="top">1 vs 2</td><td align="left" valign="top">&lt;.0001</td><td align="left" valign="top">-</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">CV ~ State|Cell</td><td align="left" valign="top">4</td><td align="left" valign="top">511.7434</td><td align="left" valign="top">2 vs 3</td><td align="left" valign="top"><bold>&lt;.0001</bold></td><td align="left" valign="top"><bold>-0.4744</bold></td></tr></tbody></table></table-wrap><table-wrap id="T3" position="float" orientation="portrait"><label>Table 3</label><caption><title>Prediction accuracies and F1-scores for various models trained to solve the classification problem.</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top" rowspan="2">Model</th><th align="left" valign="top" rowspan="2">Fold</th><th align="left" valign="top" colspan="2">Validation</th><th align="left" valign="top" colspan="2">Test</th></tr><tr><th align="left" valign="top">Accuracy (%)</th><th align="left" valign="top">F1-score</th><th align="left" valign="top">Accuracy(%)</th><th align="left" valign="top">F1-score</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="6">Support Vector Machine (SVM)</td><td align="left" valign="top">1</td><td align="left" valign="top">81.41</td><td align="left" valign="top">0.7206</td><td align="left" valign="top">70.19</td><td align="left" valign="top">0.6077</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">72.68</td><td align="left" valign="top">0.593</td><td align="left" valign="top">79.66</td><td align="left" valign="top">0.6842</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">75.84</td><td align="left" valign="top">0.703</td><td align="left" valign="top">72.55</td><td align="left" valign="top">0.6055</td></tr><tr><td align="left" valign="top">4</td><td align="left" valign="top">73.10</td><td align="left" valign="top">0.6422</td><td align="left" valign="top">73.65</td><td align="left" valign="top">0.671</td></tr><tr><td align="left" valign="top">5</td><td align="left" valign="top">70.67</td><td align="left" valign="top">0.629</td><td align="left" valign="top">74.89</td><td align="left" valign="top">0.6755</td></tr><tr><td align="left" valign="top">Mean ± Stdev</td><td align="left" valign="top">74.74 ± 4.16</td><td align="left" valign="top">0.6576 ± 0.0531</td><td align="left" valign="top">74.19 ± 3.51</td><td align="left" valign="top">0.6488 ± 0.0388</td></tr><tr><td align="left" valign="top" rowspan="6">Deep Neural Network</td><td align="left" valign="top">1</td><td align="left" valign="top">83.91</td><td align="left" valign="top">0.7893</td><td align="left" valign="top">72.99</td><td align="left" valign="top">0.6649</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">77.71</td><td align="left" valign="top">0.7205</td><td align="left" valign="top">82.89</td><td align="left" valign="top">0.7849</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">74.85</td><td align="left" valign="top">0.7099</td><td align="left" valign="top">76.10</td><td align="left" valign="top">0.6788</td></tr><tr><td align="left" valign="top">4</td><td align="left" valign="top">73.31</td><td align="left" valign="top">0.6535</td><td align="left" valign="top">75.12</td><td align="left" valign="top">0.7143</td></tr><tr><td align="left" valign="top">5</td><td align="left" valign="top">77.82</td><td align="left" valign="top">0.7060</td><td align="left" valign="top">75.24</td><td align="left" valign="top">0.6629</td></tr><tr><td align="left" valign="top">Mean ± Stdev</td><td align="left" valign="top">77.52 ± 4.06</td><td align="left" valign="top">0.7158 ± 0.0486</td><td align="left" valign="top">76.47 ± 3.77</td><td align="left" valign="top">0.7012 ± 0.0511</td></tr><tr><td align="left" valign="top" rowspan="6">1D CNN</td><td align="left" valign="top">1</td><td align="left" valign="top">87.20</td><td align="left" valign="top">0.8163</td><td align="left" valign="top">84.00</td><td align="left" valign="top">0.7933</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">80.67</td><td align="left" valign="top">0.7541</td><td align="left" valign="top">88.33</td><td align="left" valign="top">0.8336</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">82.66</td><td align="left" valign="top">0.7880</td><td align="left" valign="top">80.09</td><td align="left" valign="top">0.7263</td></tr><tr><td align="left" valign="top">4</td><td align="left" valign="top">78.28</td><td align="left" valign="top">0.7185</td><td align="left" valign="top">81.07</td><td align="left" valign="top">0.7719</td></tr><tr><td align="left" valign="top">5</td><td align="left" valign="top">82.60</td><td align="left" valign="top">0.7604</td><td align="left" valign="top">78.34</td><td align="left" valign="top">0.7004</td></tr><tr><td align="left" valign="top">Mean ± Stdev</td><td align="left" valign="top">82.28 ± 3.28</td><td align="left" valign="top">0.7675 ± 0.0369</td><td align="left" valign="top">82.37 ± 3.91</td><td align="left" valign="top">0.7651 ± 0.0530</td></tr><tr><td align="left" valign="top" rowspan="6">1D CNN (3x)</td><td align="left" valign="top">1</td><td align="left" valign="top">87.54</td><td align="left" valign="top">0.8226</td><td align="left" valign="top">84.00</td><td align="left" valign="top">0.7893</td></tr><tr><td align="left" valign="top">2</td><td align="left" valign="top">80.61</td><td align="left" valign="top">0.7535</td><td align="left" valign="top">86.97</td><td align="left" valign="top">0.8142</td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">80.61</td><td align="left" valign="top">0.7650</td><td align="left" valign="top">78.41</td><td align="left" valign="top">0.7089</td></tr><tr><td align="left" valign="top">4</td><td align="left" valign="top">78.62</td><td align="left" valign="top">0.73</td><td align="left" valign="top">73.66</td><td align="left" valign="top">0.6592</td></tr><tr><td align="left" valign="top">5</td><td align="left" valign="top">82.49</td><td align="left" valign="top">0.7592</td><td align="left" valign="top">76.83</td><td align="left" valign="top">0.6775</td></tr><tr><td align="left" valign="top">Mean ± Stdev</td><td align="left" valign="top">81.97 ± 3.40</td><td align="left" valign="top">0.7661 ± 0.0343</td><td align="left" valign="top">79.97 ± 5.42</td><td align="left" valign="top">0.7298 ± 0.0686</td></tr><tr><td align="left" valign="top" rowspan="6">CNN-LSTM</td><td align="left" valign="top">1</td><td align="left" valign="top">86.74</td><td align="left" valign="top">0.8246</td><td align="left" valign="top">82.87</td><td align="left" valign="top">0.7831</td></tr><tr><td align="left" valign="top"><bold>2</bold></td><td align="left" valign="top"><bold>79.32</bold></td><td align="left" valign="top"><bold>0.7358</bold></td><td align="left" valign="top"><bold>87.03</bold></td><td align="left" valign="top"><bold>0.8259</bold></td></tr><tr><td align="left" valign="top">3</td><td align="left" valign="top">87.03</td><td align="left" valign="top">0.8259</td><td align="left" valign="top">81.25</td><td align="left" valign="top">0.7288</td></tr><tr><td align="left" valign="top">4</td><td align="left" valign="top">84.83</td><td align="left" valign="top">0.8036</td><td align="left" valign="top">80.54</td><td align="left" valign="top">0.7542</td></tr><tr><td align="left" valign="top">5</td><td align="left" valign="top">82.60</td><td align="left" valign="top">0.7596</td><td align="left" valign="top">71.93</td><td align="left" valign="top">0.7583</td></tr><tr><td align="left" valign="top">Mean ± Stdev</td><td align="left" valign="top">84.10 ± 3.21</td><td align="left" valign="top">0.7899 ± 0.0404</td><td align="left" valign="top">80.72 ± 5.52</td><td align="left" valign="top">0.7701 ± 0.0367</td></tr></tbody></table></table-wrap></floats-group></article>