<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS156673</article-id><article-id pub-id-type="doi">10.1101/2022.11.03.515010</article-id><article-id pub-id-type="archive">PPR566767</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Towards increased accuracy and reproducibility in SARS-CoV-2 next generation sequence analysis for public health surveillance</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Connor</surname><given-names>Ryan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Yarmosh</surname><given-names>David A.</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Maier</surname><given-names>Wolfgang</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Shakya</surname><given-names>Migun</given-names></name></contrib><contrib contrib-type="author"><name><surname>Martin</surname><given-names>Ross</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Bradford</surname><given-names>Rebecca</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Brister</surname><given-names>J. Rodney</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Chain</surname><given-names>Patrick SG</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Copeland</surname><given-names>Courtney A.</given-names></name><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>di Iulio</surname><given-names>Julia</given-names></name><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Hu</surname><given-names>Bin</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Ebert</surname><given-names>Philip</given-names></name><xref ref-type="aff" rid="A9">9</xref></contrib><contrib contrib-type="author"><name><surname>Gunti</surname><given-names>Jonathan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Jin</surname><given-names>Yumi</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Katz</surname><given-names>Kenneth S.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kochergin</surname><given-names>Andrey</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>LaRosa</surname><given-names>Tré</given-names></name><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Jiani</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Po-E</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Lo</surname><given-names>Chien-Chi</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Rashid</surname><given-names>Sujatha</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Maiorova</surname><given-names>Evguenia S.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Xiao</surname><given-names>Chunlin</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Zalunin</surname><given-names>Vadim</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Pruitt</surname><given-names>Kim D.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, MD 20894, USA</aff><aff id="A2"><label>2</label>Clinical Virology Department, Gilead Sciences, 333 Lakeside Dr, Foster City, CA 94404, USA</aff><aff id="A3"><label>3</label>American Type Culture Collection, 10807 University Blvd, Manassas, VA 20110, USA</aff><aff id="A4"><label>4</label>BEI Resources</aff><aff id="A5"><label>5</label>Galaxy Europe Team, University of Freiburg, Freiburg, Germany</aff><aff id="A6"><label>6</label>Bioscience Division, Los Alamos National Laboratory, Los Alamos, NM 87545 USA</aff><aff id="A7"><label>7</label>Deloitte Consulting LLP, 1919 North Lynn St, Suite 1500, Rosslyn, VA 22209 USA</aff><aff id="A8"><label>8</label>Vir Biotechnology Inc., San Francisco, CA, USA</aff><aff id="A9"><label>9</label>Eli Lilly and Company, Indianapolis, IN</aff><pub-date pub-type="nihms-submitted"><day>06</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><license-p>This article is a US Government work. It is not subject to copyright under 17 USC 105 and is also made available for use under a CC0 license.</license-p></license><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/publicdomain/zero/1.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">CC0 license</ext-link>.</license-p></license></permissions><abstract><p id="P1">During the COVID-19 pandemic, SARS-CoV-2 surveillance efforts integrated genome sequencing of clinical samples to identify emergent viral variants and to support rapid experimental examination of genome-informed vaccine and therapeutic designs. Given the broad range of methods applied to generate new viral genomes, it is critical that consensus and variant calling tools yield consistent results across disparate pipelines. Here we examine the impact of sequencing technologies (Illumina and Oxford Nanopore) and 7 different downstream bioinformatic protocols on SARS-CoV-2 variant calling as part of the NIH Accelerating COVID-19 Therapeutic Interventions and Vaccines (ACTIV) Tracking Resistance and Coronavirus Evolution (TRACE) initiative, a public-private partnership established to address the COVID-19 outbreak. Our results indicate that bioinformatic workflows can yield consensus genomes with different single nucleotide polymorphisms, insertions, and/or deletions even when using the same raw sequence input datasets. We introduce the use of a specific suite of parameters and protocols that greatly improves the agreement among pipelines developed by diverse organizations. Such consistency among bioinformatic pipelines is fundamental to SARS-CoV-2 and future pathogen surveillance efforts. The application of analysis standards is necessary to more accurately document phylogenomic trends and support data-driven public health responses.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The COVID-19 pandemic stimulated an unrivaled level of research in a short period of time resulting in an unprecedented amount of public genomic data for any single taxon – SARS-CoV-2. Genomes inferred from Next-Generation Sequencing (NGS) data enable global tracking of transmission routes and detection of new SARS-CoV-2 strains that can affect the efficacy of therapeutics or molecular diagnostic assays. Analysis of prevalent genomes supports the design of plasmids and pseudoviruses to perform experimental testing, such as neutralization assays to determine which monoclonal antibodies retain efficacy. The CDC provides viral strains that are used by the FDA, among other organizations and purposes, to guide which therapeutics receive emergency use authorization per each region (<ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/coronavirus/2019-ncov/lab/grows-virus-cell-culture.html">https://www.cdc.gov/coronavirus/2019-ncov/lab/grows-virus-cell-culture.html</ext-link>). In addition, the FDA requires submission of NGS data and the interpretation by pharmaceutical companies for new drug applications. Therefore, accurate and reproducible detection of mutations in SARS-CoV-2 sequencing data is critical for effective management of the SARS-CoV-2 pandemic (<ext-link ext-link-type="uri" xlink:href="https://covid.cdc.gov/covid-data-tracker/#variant-proportions">https://covid.cdc.gov/covid-data-tracker/#variant-proportions</ext-link>), and the development of vaccines and antiviral drugs.</p><p id="P3">As of August 17 2022, there have been over 11.7 million SARS-CoV-2 sequence submissions from over 7.9 million samples submitted to the National Institute of Health (NIH), National Library of Medicine (NLM), National Center for Biotechnology Information (NCBI) open access repositories GenBank<sup><xref ref-type="bibr" rid="R1">1</xref></sup> and the Sequence Read Archive (SRA)<sup><xref ref-type="bibr" rid="R2">2</xref></sup>; of these, data was submitted to both GenBank and SRA for over 3.8 million samples. This sequence data represents the culmination of efforts across many different research institutions and public health laboratories around the world, using different library preparation methods, sequencing technologies and analysis methods. SARS-CoV-2 samples have been prepared in multiple different ways for sequencing, including shotgun, capture based methods, and the commonly-used tiled amplicon-based approaches, which continue to evolve. These have been coupled with the full complement of today’s most popular sequencing technologies including short read Illumina sequencers and long read sequencers like Oxford Nanopore Technologies (ONT) and Pacific Biosciences (PacBio). Bioinformatic analysis pipelines to generate SARS-CoV-2 genomes and to identify sequence variations also differ widely, even within a specific methodology/technology, with many developed and optimized for entirely different use cases. Therefore, no worldwide standards exist for generating SARS-CoV-2 genomes from NGS data, or for identifying important sequence variation therein.</p><p id="P4">Consensus-based approaches using NGS data have been a standard practice for SARS-CoV-2 mutation discovery, and a significant number of viral consensus sequences have been made available in open access or restricted access repositories such as GenBank and GISAID (<ext-link ext-link-type="uri" xlink:href="https://www.gisaid.org/">https://www.gisaid.org/</ext-link>) to support public health research. Reference alignment-based variant discovery using NGS data is not new, and has been widely used in human population studies. The performance of such approaches using different processing pipelines, including read aligners, variant callers, and sequencing instruments, has been assessed by various studies<sup><xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R9">9</xref></sup> resulting in best practices for germline<sup><xref ref-type="bibr" rid="R10">10</xref></sup> and somatic variant detections.<sup><xref ref-type="bibr" rid="R11">11</xref></sup> However, the performance of NGS pipelines for SARS-CoV-2 mutation detection has not been systematically assessed. Such evaluation is urgently needed with the on-going SARS-CoV-2 pandemic, as it will provide guidelines and best practices specific to SARS-Cov-2 and mutation detection by research groups, clinical sequencing labs and public health agencies,<sup><xref ref-type="bibr" rid="R12">12</xref></sup> and set the stage for similar types of analyses in the future.</p><p id="P5">To address this issue, as part of the Foundation for the National Institutes of Health’s (FNIH) Accelerating COVID-19 Therapeutic Interventions and Vaccines Tracking Resistance and Coronavirus Evolution (ACTIV TRACE) initiative (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/research-training/medical-research-initiatives/activ/tracking-resistance-coronavirus-evolution-trace">https://www.nih.gov/research-training/medical-research-initiatives/activ/tracking-resistance-coronavirus-evolution-trace</ext-link>), seven groups across government, industry, and academia assessed a number of different approaches to SARS-CoV-2 NGS data analysis. The pipelines considered here were initially developed for each participating groups’ specific needs and are used here to analyze a representative subset of data available from the SRA. Thus, while some differences in results were expected, given that they all aim at calling variants for SARS-CoV-2 data, it is reasonable to expect that, given the same input, they should yield overall comparable results. Comparing results across the pipelines using common input datasets helped identify unexpected differences in analysis results and determine standardized protocols to improve the consistency of results across pipelines. We describe below our analysis of raw sequencing data and the development of quality assurance protocols to identify the most supported sequence variation calls from a sequenced sample, which in turn can be used for downstream ACTIV TRACE efforts to assess therapeutic efficacy in response to the evolving SARS-CoV-2 virus.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>SARS-CoV-2 consensus bioinformatic workflow overview</title><p id="P6">With the great global investment in sequencing the SARS-CoV-2 virus using a broad array of disparate techniques, we aimed to characterize bioinformatic methods for identifying variants from NGS sequencing data to support accurate and reliable use of these data in downstream analyses such as for phylogenomic and pharmaceutical applications. When the work was initiated, Illumina platform data was the most prevalent data type, with Oxford Nanopore Technologies (ONT hereafter) data the next most common, hence the current focus. Currently, however, PacBio data is approximately as common as ONT. The generic bioinformatics workflow for processing SARS-CoV-2 genomes has several steps as outlined in <xref ref-type="fig" rid="F1">Figure 1</xref>. These include data retrieval, de-hosting, read clean-up (QC), alignment, variant calling, and variant filtering (post-processing). We evaluated 7 bioinformatics workflows which include many of the most commonly used tools and software packages for each step of the bioinformatics process (QC, alignment, variant calling). A more detailed comparison of each pipeline’s software and parameters is summarized in <xref ref-type="supplementary-material" rid="SD5">Supplemental Table 1</xref>. Of note, in agreement with the variety of software available for each, we found a much greater diversity in software used for Illumina platform data (<xref ref-type="fig" rid="F1">Figure 1A</xref>) than ONT (<xref ref-type="fig" rid="F1">Figure 1B</xref>), further supporting the generalizability of our results. To perform this analysis, a preliminary dataset, termed “Dataset 1,” was used to develop each pipeline’s protocol. A subsequent dataset, the “Dataset 2,” was used to compare concordance across pipelines.</p></sec><sec id="S4"><title>Data pre-processing impacts on variant calling</title><p id="P7">Initial attempts at comparison across pipelines identified large differences between the pipelines, more than was expected. To ensure these differences were genuine, we first examined differences in how the pipelines pre-processed the data. First, it was noted that not all groups were taking steps to exclude possible host-read contamination. As shown in <xref ref-type="fig" rid="F2">Figure 2A</xref>, failure to remove host-read data can result in spurious calls, and thus artificially reduce the observed frequency of true calls. Additionally, differences in how workflows handled primer trimming were found. As seen in <xref ref-type="fig" rid="F2">Figure 2B</xref>, failure to trim primer sequence from reads results in a reduction in the reported frequency of many variants in primer binding sites. This can reduce variant frequency below a threshold for consideration, 15% for the purposes of the work here, or below the threshold for incorporation into a consensus sequence (50%, e.g.). Unfortunately, accounting for primer sequence, especially for reanalysis of SRA data, can be tedious as such information is typically not available.</p></sec><sec id="S5"><title>A parsimony normalization method to standardize variant reporting across all workflows allowed vis-a-vis comparison of variants</title><p id="P8">Comparison of results was further complicated by differences in how variants are reported, with this issue most pronounced in the case of Insertions and Deletions (InDels). To address this, two steps were taken. First the SPDI algorithm<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, used as part of the dbSNP and ClinVar databases at NCBI, for human genetic variants was adapted for use with SARS-CoV-2. While this greatly reduced the number of observed discrepancies in formatting, a number of issues with InDels remained. To this end, a Parsimony algorithm was developed (see <xref ref-type="sec" rid="S8">Methods</xref>) to ensure the number of preceding and subsequent bases around an event were consistent, and that the events were left-aligned to a common starting position. Together these approaches help minimize the possibility that the remaining differences are artifactual, and thus increase the likelihood that they represent genuine differences between pipeline results.</p></sec><sec id="S6"><title>Allele Frequency and Depth of Coverage are important parameters and determine consistency of variant calls across workflows</title><p id="P9">To assess parameters that impact agreement between pipelines and across platforms a Receiver-Operating Characteristic (ROC) analysis was conducted. For this purpose, variants identified by greater than 5 workflows (or by both technologies) were considered a True Positive while calls made by fewer workflows (or a single technology) were considered a False Positive. The rationale is that if a result is accurate, it should be found by any pipeline (or technology), regardless of the implementation specifics, though this approach cannot guarantee the agreed upon results are accurate. Additionally, this means that the ROC AUCs cannot be directly compared between groups. Looking at the ROC curves to identify the inflection point across parameter settings can suggest settings that maximize True Positive results, across workflows or technologies, while minimizing False Positive results. <xref ref-type="fig" rid="F3">Figure 3A+B</xref> and <xref ref-type="fig" rid="F3">Figure 3C+D</xref> show the results for comparing results across pipelines for Illumina and ONT platform results respectively, while <xref ref-type="fig" rid="F3">Figure 3E+F</xref> and <xref ref-type="fig" rid="F3">Figure 3G+H</xref> show the results for comparing between technologies for Illumina and ONT platform results respectively. The most sensitive discriminator, the parameter for which a sharp inflection point was identified for most workflows, for results across pipelines was found to be Alternate Allele Depth (ALTDP), <xref ref-type="fig" rid="F3">Figure 3A+C+E+G</xref>, while the best discriminator for results between technologies was found to be Alternate Allele Frequency (AF), as depicted in <xref ref-type="fig" rid="F3">Figure 3B+D+F+H</xref>. Accordingly, a minimum ALTDP of 50 and a minimum AF of 50% was used for subsequent analyses. Additionally, as overall read depth (DP) was also found to perform well for comparison of results across pipelines (data not shown) a minimum DP of 100 was used as well. Additionally, records for which less than 50% of the reference sequence was covered or for which the average coverage was less than 100 were excluded, and as not all workflows supported the analysis of single-end read data, these were excluded as well. Finally, as many of the InDel discrepancies that could not be resolved with the combination of SPDI and Parsimony approaches were found to be in homopolymer regions, these were excluded as well (<xref ref-type="supplementary-material" rid="SD1">Supplemental Figure 1</xref>).</p><p id="P10">To ensure the approach employed was robust to changes in the virus and sequencing methodologies over time, a more recent set of samples (collected from 04/14/2021 to 04/02/2022) were analyzed as well after having settled on our normalization approach. To determine the extent of agreement and disagreement across pipelines, variants calling results were compared and plotted as upset plots (<xref ref-type="fig" rid="F4">Figure 4</xref>). First, results without any filtering applied were considered, <xref ref-type="fig" rid="F4">Figure 4A-D</xref>. Here only variants with an AF of at least 15% were considered and the results had both SPDI and Parsimony normalizations applied. While Illumina data showed strong agreement, even prior to filtering for both SNPs and InDeis (<xref ref-type="fig" rid="F4">Figure 4A+B</xref>, respectively), for ONT data, for both SNPs and InDels (<xref ref-type="fig" rid="F4">Figure 4C+D</xref> respectively), the results were dominated by pipeline unique calls, as evidenced by the higher bars to the left of the graph where, below the bars, there is a single filled dot associated with a single pipeline. Next, we applied the filtering outlined above, <xref ref-type="fig" rid="F4">Figure 4E-H</xref>. For both Illumina and ONT SNPs (<xref ref-type="fig" rid="F4">Figure 4E</xref> and <xref ref-type="fig" rid="F4">Figure 4G</xref> respectively), the filtering increased the concordance in variant calls, though this was more pronounced for the ONT results. Thus, the majority of pipeline discrepancies can be attributed to calls with AF &lt; 50%, calls at locations with DP &lt; 100 or an ALTDP &lt; 50, calls from samples with poor reference genome coverage (&lt;50%), calls in homopolymer regions, or from single-end data. While the approach did improve the agreement in InDel calls for both Illumina and ONT (<xref ref-type="fig" rid="F4">Figure 4F</xref> and <xref ref-type="fig" rid="F4">Figure 4H</xref> respectively), the extent of agreement was not as strong as seen for SNPs. Notably, the total number of InDel calls was greatly reduced, suggesting that the majority of InDel calls may be artifactual or otherwise poorly supported. The initial test set also showed good agreement in variant calls postfiltering (<xref ref-type="supplementary-material" rid="SD2">Supplement Figure 2</xref>), however the improvement in InDel calls was less pronounced suggesting that the differences in Dataset1 may have been due to other issues. Additionally, agreement in both SNP and InDel calls across the length of the genome was plotted as a heatmap (<xref ref-type="supplementary-material" rid="SD3">Supplemental Figure 3</xref>) and no significant association with any portion of the genome was observed.</p><p id="P11">Similarly, to assess the extent of agreement and disagreement across sequencing technologies, stacked bar plots were generated (<xref ref-type="fig" rid="F5">Figure 5</xref>), with samples being considered only if both Illumina and ONT data passed the filtering criteria described above. Similar to what was seen with the cross-pipeline comparison, the results for both SNPs and InDels without filtering (<xref ref-type="fig" rid="F5">Figure 5A</xref> and <xref ref-type="fig" rid="F5">Figure 5B</xref> respectively) were markedly improved for both SNPs and InDels with the application of our filters (<xref ref-type="fig" rid="F5">Figure 5C</xref> and <xref ref-type="fig" rid="F5">Figure 5D</xref> respectively). Again, similar to what was seen with the cross-pipeline comparison, the initial dataset showed similar agreement for SNPs and more modest agreement for InDel calls post filtering (<xref ref-type="supplementary-material" rid="SD4">Supplemental Figure 4</xref>), again suggesting that the discrepancies observed with the initial data set are likely due to issues in sequencing early during the pandemic.</p><p id="P12">In summary, the filtering we identified (summarized in <xref ref-type="fig" rid="F6">Figure 6</xref>), provides robust agreement across diverse variant calling pipelines for both Illumina and ONT platform data and supports robust agreement between these technologies. This in turn should support consistent reporting of consensus sequences for downstream analyses, and the fair comparison of results generated by many different sequencing groups.</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P13">In the current pandemic, at least at the beginning, the majority of the effort was focused on analyzing consensus genomes. However, recent cases of possible recombinants, co-infection, contamination, and monitoring for drug resistance to antivirals has made clear the importance of working beyond consensus genome.<sup><xref ref-type="bibr" rid="R14">14</xref></sup> Consensus genomes reduce the complexity and size of the data, but this reduction also removes information that may be pertinent to determine the quality (contamination, bioinformatic workflow, etc.) of data and increases the difficulty of extracting relevant information (co-infection, minority variants, recombination, etc.) from the data. Coinfections and contamination, which can come in many forms and can happen during sample collection, laboratory preparation, sequencing, or bioinformatics processing,<sup><xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R18">18</xref></sup> if not detected during consensus genome generation, can get propagated as biological signal. In absence of corresponding raw data, such issues cannot be easily tracked and corrected. Still, as consensus genomes are the starting material for many common analyses, we aimed here to identify factors which influence the accuracy and consistency of variant calling results.</p><p id="P14">A key feature of the study presented here is the variety of sample types and bioinformatics analytical pipelines. Every sequencing methodology has some degree of implicit bias and error profile toward genomic regions, such as regions containing homopolymer repeats or near the ends of linear genomes. Biases can also be introduced by upstream sample handling procedures, including different library preparation and DNA/RNA extraction techniques, as well as downstream analysis methods, ie. algorithms used by different bioinformatics tools. Next Generation Sequencing is an increasingly valuable technology that provides a great deal of analytical insight, but it comprises a series of different methods and few, if any, are objectively superior or all encompassing. To gain the clearest representation of any given genome, more diverse sequencing methods and more diverse analytical pipelines should be employed. Though an evaluation of library preparation methods is outside the scope of this work, that remains a significant point of interest in determining the validity of any detected variant through sequencing methods. With this study including seven different groups reviewing the same sequencing data, themselves derived from a much greater breadth of institutions and methods, we are able to show the degree of concordance between these methods and technologies and infer meaning. Illumina is known for its accuracy in short-read (75-300 base pairs) sequencing<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. A high accuracy rate is ideal for determining small nucleotide variations relative to another genome sequence. However, short read data is challenging to interpret in convoluted sequence regions, which are prevalent in many genomes<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>. In the event a region of a genome is difficult to deconvolute over a range longer than that of a single read, a bioinformatics alignment program will struggle to place this read in the correct location. Oxford Nanopore Technologies (ONT) produces reads of variable lengths that are typically much longer than their Illumina counterparts. These reads are ideal for spanning the previously described convoluted regions of a genome, however they have a higher error rate<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>. From a variant calling perspective, reads are more likely to be accurately placed but more likely to have infrequent variant artifacts found at a given position.<sup><xref ref-type="bibr" rid="R21">21</xref></sup> While Illumina technology has been most frequently used in next generation sequencing and many variant callers have been designed and optimized to specifically handle Illumina reads, ONT sequencing is comparatively new and actively being improved, including updates that reduce the error rate, with lower sequencing cost (<ext-link ext-link-type="uri" xlink:href="https://nanoporetech.com/about-us/continuous-development-and-improvement">https://nanoporetech.com/about-us/continuous-development-and-improvement</ext-link>). Long and short read technologies are being increasingly linked in hybrid assembly software to benefit from the strengths of each technology while minimizing the weaknesses. In a similar vein, a variant calling effort that compares those called on Illumina reads and those called on ONT reads would find high confidence in any variants called on both platforms for the same samples.</p><p id="P15">The ACTIV-TRACE group employs different alignment and variant calling pipelines from each contributor. Variant calling tools tend to be built for specific purposes, such as human genomics, microbial genomics, or metagenomics. Alignment tools are less deliberately biased toward organism type but employ different algorithms to handle specific read types.<sup><xref ref-type="bibr" rid="R21">21</xref></sup> Within both alignment and variant calling algorithms, there are explicit and implicit filters related to match score, mismatch penalty, strand-bias handling, depth and frequency requirements, and primary alignments that further differentiate even identical programs between pipelines. The benefits of several pipelines are not limited to variant calling and alignment. Standard pre-processing steps of adapter or base quality trimming, de-hosting or taxonomic identity binning, and read deduplication or complexity requirements add further nuance to results comparison. The ACTIV-TRACE group’s variety in analytical methods provides the opportunity to examine how differently they perform in the context of SARS-CoV-2.</p><p id="P16">While the work here is focused on variant calling, the major phylogenetic approaches employed extensively during the current pandemic rely on consensus sequences as input data.<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup> As consensus sequences can be viewed as a condensed representation of variant calling data, it is worth noting some of the implications of the current work on that data type. Firstly, while the various pipelines employed here achieved excellent consensus, there were still differences between each pipeline (e.g. the number of False positives found by each pipeline after filtering, varies from less than 3% of remaining calls to approximately 27%). Thus, it is important that information on how sequencing was conducted, and how the subsequent bioinformatic analyses were conducted be deposited along with the consensus sequences so that analysis using them can take the information into account in determining if the sequences are truly comparable. Further, primer trimming can have a notable effect on variant calling results, as improperly trimmed reads will result in incorrect variants that reflect the primer sequence instead this information should also be included with consensus sequence submission. Additionally, given that the discrepancies between pipelines is greater at lower allele frequencies, and that consensus sequences cannot capture the detail found in VCF’s beyond the use of IUPAC ambiguity codes, it is recommended that a relatively high allele frequency be chosen for inclusion into a consensus sequence.<sup><xref ref-type="bibr" rid="R24">24</xref></sup> While this recommendation is expected to increase the comparability of consensus sequences generated across pipeline, it may reduce the useful of consensus sequences for drug resistance monitoring. An allele frequency threshold of 50% will ensure that mutations included in consensus sequences are of high confidence and reduce the need for us of IUPAC ambiguity codes, which themselves present challenges for many downstream bioinformatic applications. Similarly, as consistency across pipelines is sensitive to overall and alternate allele depth, requiring a minimum depth of 100 and alternate allele depth of 50 should ensure that those mutations that make it into a consensus sequence are of high confidence. For cases in which a minimum depth is not met, until variant calling software enables the usage of IUPAC ambiguity codes in reference sequences, these ambiguous locations should be reported as “N.” Together, these recommendations would help ensure that the results represented in consensus sequences are of high confidence, i.e., are likely replicable across different pipelines and sequencing technologies, and thus are appropriate to compare to each other during downstream analyses.</p><p id="P17">Of note, having the same dataset being analyzed by multiple groups offered the possibility for each group to prioritize the investigation/visual assessment of potentially spurious variant calls (based on the comparison with the results of the other groups) and tune their pipeline parameters accordingly, with the acknowledged limit that a variant being called by majority of the pipelines does not necessarily mean it is real (example sample contamination or library preparation artefact).</p><p id="P18">Pharmaceutical and biotechnology companies are required to comply with Good Practice (GxP) guidelines and obtain system validation, when developing computer software to ensure that medical devices, drugs and other life science products are safe and effective (<ext-link ext-link-type="uri" xlink:href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/part-11-electronic-records-electronic-signatures-scope-and-application">https://www.fda.gov/regulatory-information/search-fda-guidance-documents/part-11-electronic-records-electronic-signatures-scope-and-application</ext-link>). At present, it is unclear to what level of computer system validation is required by the FDA for NGS analysis pipelines, and the FDA performs their own independent analysis and compares to submitted analysis from sponsor. Given the numerous sample preparation methods and sequencing technologies as well as the various analysis pipelines (many of which are proprietary), this presents challenges for regulatory review of NGS data.<sup><xref ref-type="bibr" rid="R25">25</xref></sup> In the future, the FDA anticipates the development of standardized NGS analysis pipelines that will provide a reproducible data analysis sufficient for generating consistent and robust results from NGS data.<sup><xref ref-type="bibr" rid="R25">25</xref></sup> Based on the analysis described here within, standardized NGS analysis pipelines have not been achieved given the lack of agreement in the analysis of publicly available NGS datasets. Further collaborative efforts like ACTIVE TRACE’S work here are needed to achieve standardization of pipelines and reproducibility of results.</p></sec><sec sec-type="methods" id="S8" specific-use="web-only"><title>Online Methods</title><sec id="S9"><title>Common Features</title><p id="P19">RefSeq<sup><xref ref-type="bibr" rid="R26">26</xref></sup> accession sequence NC_045512.2 was used as reference genome for alignment. A description of the data analyzed in the original and recent datasets can be found in <xref ref-type="supplementary-material" rid="SD5">Supplemental Table 2</xref> and <xref ref-type="supplementary-material" rid="SD5">Supplemental Table 3</xref>, respectively. Briefly, Dataset 1 consists of 413 sequence records, representing 155 samples, while the recent set consisted of 419 sequence records, representing 210 samples. Dataset 1 consists mostly of pre-alpha lineages and some alpha samples, while Dataset 2 has a mix of VOCs (alpha, delta, omicron and some other lineages). Both sets are constituted by paired Illumina and ONT samples. The records were processed by each of seven pipelines described below. The results were then combined, and SNPs were normalized using the SPDI algorithm.<sup><xref ref-type="bibr" rid="R13">13</xref></sup> Subsequently, the InDel results are normalized using the Parsimony script, described below, and the additional analyses and figures were generated via python scripts, all available here (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/ACTIVTRACEvariants">https://github.com/ncbi/ACTIVTRACEvariants</ext-link>).</p></sec><sec id="S10"><title>Parsimony Script</title><p id="P20">Following SPDI-normalization, the parsimony script is applied. After pulling the SPDI-processed data into a data table, the first step is to sort data according to analytical group, sample accession, and position. Then, it must resolve adjacent indels into singular records. Where InDels use a hyphen (-) to represent the reference or alternate allele, we search for any adjacent rows with identical group and accession values and the positions are consecutive. For each record that satisfies these requirements for either the next or previous record, they are grouped together and concatenated according to the Group and Acc values, with any number of repeated hyphens being replaced with a singular hyphen to match SPDI formatting. This only saves the depth and alternate allele values for the first record in the set of each consecutive InDel. In practice, we have not found this disruptive to our analysis, but this may present an issue when this occurs closer to the limit of detection or when precise depth is significant.</p><p id="P21">Next, we must address the nucleotide context issue. This combined data table is looped over, row by row, capturing the assorted metadata in each row. These fields will not be altered. We are only concerned with InDels that don’t conform to our simple formatting. First, we check for the simple cases that either the reference or alternate allele completely contains the other, such as AAA4313AAAA. In this case, we remove the shorter of ref or alt from the other and replace the shorter field with a hyphen (-) and write to file, transforming AAA4313AAAA to A4313-.</p><p id="P22">This leaves the more complex case of a single record containing both an InDel and a SNP. These records have neither a reference nor alternate allele that completely contains the counterpart, so we cannot simply remove the identity of one from the other, as we had before. Instead, we align the reference allele and the alternate allele for each qualifying row using biopython’s<sup><xref ref-type="bibr" rid="R27">27</xref></sup> pairwise2 module as align.globalms with settings match=2, mismatch=-0.5, gapopen=-1, gap extension=0.1 and allow only the top alignment. These settings were determined to be sufficient for the data presented in this study but have not been optimized to other datasets. For each alignment, we determine where a deletions may be found and save InDel in the ‘type’ field of the metadata variable. For all other nonmatching bases in the alignment, we save SNP to the ‘type’ field of the metadata. In both cases, the position of the variant is incremented by the number of preceding matching bases to correct for where the variant occurs. These explicit and separated InDel and SNPs are written as discrete records to file. In all remaining cases, both the reference and alternate allele values match with at least the starting nucleotide of the record. We remove all matching alternate alleles from the reference alleles that haven’t been otherwise addressed from the beginning of the reference and increment the position by the length of the removed bases. This will leave only a deletion in all observed cases. These are written to file with a hyphen in place of the alternate allele.</p></sec><sec id="S11"><title>Studying the effects of primer trimming on variant calls and apparent allele frequencies of called variants</title><p id="P23">83 high-quality ARTICv3-amplified samples were selected from the ACTIV TRACE Illumina paired-end sample collection. These samples were analyzed twice with the Galaxy pipeline, once with and once without primer trimming. The position of each resulting variant call (2696 calls total with, 2637 without trimming) was compared to the known primer binding sites of the ARTICv3 primer scheme to classify calls as inside (421 calls with, 360 calls without primer trimming) and outside of primer binding sites. For variants called with and without primer trimming, the observed variant allele-frequency with primer trimming was plotted against the same metric without primer trimming. For variants called only with primer trimming a value of zero was used as a substitute for the unobserved variant allele-frequency without primer trimming.</p></sec><sec id="S12"><title>Calculation of Receiver Operating Characteristic (ROC) plots based on concordance across pipelines</title><p id="P24">For each participating group, all variant calls made for all samples analyzed with the group’s pipeline were classified as either concordant or discordant based on whether that same variant had or had not been called for the same sample by the majority of groups (&gt;= 6 pipelines) that had analyzed that sample. For the purpose of generating ROC-like plots, concordant and discordant calls were treated as true-positive and false-positive calls respectively. The true- and false-positive lists of each group were then filtered independently with increasing thresholds on two key variant call metrics: the number of sequencing reads supporting the variant allele (alternate allele read depth, AltDP) and the fraction of all sequencing reads at the variant site that support the alternate allele (alternate allele-frequency, AF). Increasing thresholds of each of the two metrics lower the number of true- and false-positive calls, but to different extents. For plotting, the numbers of retained true- and false-positive calls at each threshold were normalized to the numbers of unfiltered true- and false-positive calls of the respective group, thus the ROC AUCs cannot be directly compared between groups.</p></sec><sec id="S13"><title>Calculation of Receiver Operating Characteristic (ROC) plots based on cross-platform agreement</title><p id="P25">For samples for which both Illumina and ONT sequencing data was available, alternative plots could be generated as follows.</p><p id="P26">For each participating group, all variant calls made for all samples analyzed with the group’s pipeline based on the data for one of the two sequencing platforms were classified as concordant or discordant based on whether that same variant had or had not been called for the same sample on the other platform either by any participating group, or not. For plotting, the true- and false-positive lists of each group resulting from this alternate classification were used to create a threshold and subsequently normalized as described above.</p></sec><sec id="S14"><title>BEI Resources</title><p id="P27">SARS-CoV-2 reads were retrieved from NCB’s<sup><xref ref-type="bibr" rid="R28">28</xref></sup> Sequence Read Archive (SRA) directly using the fastq-dump v2.11.1 utility (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link>). These reads were then trimmed and filtered to remove adapter sequences and low-quality reads, using <italic>fastp</italic><sup><xref ref-type="bibr" rid="R29">29</xref></sup> v0.23.2 for Illumina reads and <italic>NanoFilt</italic><sup><xref ref-type="bibr" rid="R30">30</xref></sup> v2.8.0 for Oxford Nanopore reads. Settings for <italic>fastp</italic> were left at default, while <italic>NanoFilt</italic> was set for a minimum average quality of 10 and minimum length of 150, while trimming the first 30 bases of each read. Following this, both sets of reads were taxonomically binned using ATCC’s <italic>bin_reads</italic> function, which relies on <italic>kraken2</italic><sup><xref ref-type="bibr" rid="R31">31</xref></sup> v 2.1.2 to identify the nearest taxonomy of any given read. Kraken2 classification was run with default settings and its bacterial_viral_db database. Kraken2 also contains an extract reads function that was employed using NCBI: taxID6940099, which corresponds to SARS-Coronavirus and all sub-taxa.</p><p id="P28">All Illumina reads that have been processed as outlined above were entered into an identical pipeline for variant calling analysis. This pipeline comprises four steps: read mapping to NC_045512.2 (Wuhan-Hu-1), local realignment, variant calling, and normalization. Prior to alignment, paired-Illumina fastqs need another step of processing. Because kraken2’s taxonomic binning does not guarantee that both forward and reverse fastqs will have the same resulting reads, <italic>seqkit common</italic><sup><xref ref-type="bibr" rid="R32">32</xref></sup> v 2.1.0 is used to ensure that only paired reads are further analyzed. Alignment was performed with <italic>bwa mem</italic><sup><xref ref-type="bibr" rid="R33">33</xref></sup> v 0.7.17-r1188 using default parameters. Local realignment begins with <italic>bcftools mpileup</italic><sup><xref ref-type="bibr" rid="R39">39</xref></sup> v1.12 to produce a per-base pileup to stage the realignment. This uses default settings, except for the max-depth which was set to 8000 to reduce the chance of missing minority variants due to excessive depth at a position. Next, <italic>bcftools call</italic> and <italic>bcftools filter</italic> are used to capture multiallelic variants with a variant call quality above 30. This initial vcf is passed to <italic>GATK</italic><sup><xref ref-type="bibr" rid="R35">35</xref></sup> v4.2.2.0 to apply base quality score recalibration within the context of all bases at each position. Finally, realignment is achieved using the <italic>lofreq viterbi</italic><sup><xref ref-type="bibr" rid="R36">36</xref></sup> tool v2.1.5, using default parameters. Variant calling is performed using <italic>lofreq</italic> v2.1.5 in four stages: <italic>indelqual</italic> with “--dindel” parameter and <italic>alnqual</italic> to capture indel variants, <italic>call</italic> with --call-indels and -C 50 to capture all variants above a depth of 50x, <italic>and filter</italic> with -v 50 and -a 0.15 to further filter for minimum depth of 50x and alternate allele frequency of 15%.</p><p id="P29">Oxford Nanopore long reads have a few fundamental differences that affect what off-the-shelf tools can be used for their processing. Namely, underlying algorithms in <italic>fastp, GATK</italic>, and <italic>bwa mem</italic> are not designed for the increased length and error profile of these reads. Consequently, medaka_haploid_variant<sup><xref ref-type="bibr" rid="R37">37</xref></sup> v1.5.0 is used to perform the initial alignment and its BAM file is passed to lofreq in the same manner as in the Illumina dataset. Minimum depth and alternate frequency filters are applied afterward and the previously described step of taxonomic binning is identical to the Illumina dataset.</p></sec><sec id="S15"><title>Galaxy Project</title><p id="P30">Illumina short-read (paired-end subset of the data only) and Oxford Nanopore long-read data was downloaded in fastq.gz format from the FTP server of the European Bioinformatics Institute (EMBL-EBI) at <ext-link ext-link-type="uri" xlink:href="ftp.sra.ebi.ac.uk">ftp.sra.ebi.ac.uk</ext-link>. Variant calling was then performed with platform-specific Galaxy workflows, which have previously been described<sup><xref ref-type="bibr" rid="R38">38</xref></sup> and are publicly available from Dockstore<sup><xref ref-type="bibr" rid="R39">39</xref></sup> and the WorkflowHub<sup><xref ref-type="bibr" rid="R40">40</xref></sup> against NCBI Reference Sequence NC_045512.2. No attempt was made to analyze single-end Illumina data.</p><p id="P31">A brief overview of the analysis of data from both platforms is provided below.□</p><sec id="S16"><title>Variant calling from paired-end Illumina short-read data</title><p id="P32">We used fastp (version 0.23.2) for read trimming and quality control<sup><xref ref-type="bibr" rid="R29">29</xref></sup>, aligned reads with bwa-mem (version 0.7.17)<sup><xref ref-type="bibr" rid="R33">33</xref></sup>, filtered for reads with fully mapped read pairs (with samtools, version 1.9<sup><xref ref-type="bibr" rid="R34">34</xref></sup>), re-aligned reads using the lofreq viterbi command from the lofreq package (version 2.1.5 used here and in all subsequent steps using lofreq)<sup><xref ref-type="bibr" rid="R36">36</xref></sup> and calculated indel quality scores with lofreq indelqual. We then attempted to trim amplification primers from the aligned reads using ivar trim (version 1.3.1)<sup><xref ref-type="bibr" rid="R41">41</xref></sup> assuming the ARTIC v3 primer scheme<sup><xref ref-type="bibr" rid="R42">42</xref></sup> had been used in amplification of all samples (which is true for the majority of the samples analyzed, but not all of them; we continued with untrimmed data for those other samples). The remaining, trimmed alignments served as the input for variant calling with lofreq, and variant calls down to an allele-frequency of 0.05 were reported if confirmed by at least 10 reads.</p></sec><sec id="S17"><title>Variant calling from Oxford Nanopore long-read data</title><p id="P33">We used fastp (version 0.23.2) for quality control<sup><xref ref-type="bibr" rid="R29">29</xref></sup> and read length filtering. For samples that we detected to be amplified with the ARTIC v3 primer scheme we filtered for read sizes between 300 and 650 bases, for other samples we allowed read sizes between 300 and 3,000 bases. Retained reads were aligned with minimap2 (version 2.17)<sup><xref ref-type="bibr" rid="R33">33</xref></sup>, and successfully mapped reads left-aligned with BamLeftAlign from the freebayes package (version 1.3.1)<sup><xref ref-type="bibr" rid="R43">43</xref></sup>, after which we attempted to trim primers from the reads with ivar trim (version 1.3.1), again assuming the ARTIC v3 primer scheme and using untrimmed data where that assumption failed. The data was then analyzed with the medaka consensus tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link>, version 1.0.3)<sup><xref ref-type="bibr" rid="R37">37</xref></sup> and variants extracted with medaka variant tool (version 1.3.2) and postprocessed with medaka tools annotate (integrated into the medaka variant tool’s Galaxy wrapper; <ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/repository?repository_id=a25f9bf8a7d98ae4&amp;changeset_revision=0f5f4a208660">https://toolshed.g2.bx.psu.edu/repository?repository_id=a25f9bf8a7d98ae4&amp;changeset_revision=0f5f4a208660</ext-link>). Variant calls down to an allele-frequency of 0.05 were reported if confirmed by at least 10 reads and called, in the case of SNVs only, with a QUAL score of at least 10.</p></sec></sec><sec id="S18"><title>Gilead Sciences</title><p id="P34">Illumina short-reads and Oxford Nanopore long-read data were downloaded from Sequence Read Archive (SRA) using sratoolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools#the-sra-toolkit">https://github.com/ncbi/sra-tools#the-sra-toolkit</ext-link>, v 2.8.1).</p><sec id="S19"><title>Illumina□</title><p id="P35">Fastq files were aligned to hg38 reference using BWA v0.7.15<sup><xref ref-type="bibr" rid="R33">33</xref></sup> to exclude human RNA transcripts and to isolate viral reads for further processing. Next, reads were trimmed using Trimmomatic v0.3 6<sup><xref ref-type="bibr" rid="R44">44</xref></sup> for low quality (sliding window 4 bp, avg phred 15) and short reads (&lt;50 base pairs) were filtered out. Paired end reads that overlap were merged using NGmerge v0.3<sup><xref ref-type="bibr" rid="R45">45</xref></sup> software creating a single-end fastq file containing merged reads and any single end reads that do not overlap. Reads are then aligned to the Wuhan-Hu-1 reference (NC_045512) using SMALT v0.7.6 aligner (<ext-link ext-link-type="uri" xlink:href="https://www.sanger.ac.uk/tool/smalt-0/">https://www.sanger.ac.uk/tool/smalt-0/</ext-link>). If amplification primer information was available, trimmed the base pairs from reads that overlap with primers. Tabulate nucleotide variants and indels per genome position (NC_045512), excluding any variants with average phred score less than 20 and read depth less than 50 as well as any frameshift indels.</p></sec><sec id="S20"><title>ONT</title><p id="P36">Fastq files were aligned to hg38 reference using minimap2 v2.17<sup><xref ref-type="bibr" rid="R46">46</xref></sup> to exclude human RNA transcripts and to isolate viral reads for further processing. Reads are then aligned to the Wuhan-Hu-1 reference (NC_045512) using minimap2 v2.17.<sup><xref ref-type="bibr" rid="R46">46</xref></sup> If amplification primer information was available, trimmed the base pairs from reads that overlap with primers. Tabulate nucleotide variants and indels per genome position (NC_045512), excluding any variants with average phred score less than 10, forward strand ratio &lt; 0.1 or &gt; 0.9, and read depth less than 50 as well as any frameshift indels.</p></sec></sec><sec id="S21"><title>LANL</title><p id="P37">Illumina short-read and Oxford Nanopore long-read data were downloaded from Sequence Read Archive (SRA) using sratoolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools#the-sra-toolkit">https://github.com/ncbi/sra-tools#the-sra-toolkit</ext-link>, v 2.9.2). Quality control, read mapping, variant calling, and consensus genome generation were then performed with EDGE-COVID19 (EC-19) workflows (<ext-link ext-link-type="uri" xlink:href="http://edge-covid19.edgebioinformatics.org/">http://edge-covid19.edgebioinformatics.org/</ext-link>). Detailed description of the EC-19 workflows has also been previously described<sup><xref ref-type="bibr" rid="R47">47</xref></sup> (<ext-link ext-link-type="uri" xlink:href="https://edge-covid19.edgebioinformatics.org/docs/EDGE_COVID-19_guide.pdf">https://edge-covid19.edgebioinformatics.org/docs/EDGE_COVID-19_guide.pdf</ext-link>). Briefly, the EC-19 workflow employs many commonly used tools such as FaQCs (v2.09) for quality control, Minimap2 (v2.17, default for ONT) or BWA mem (v0.7.12, default for Illumina) for mapping reads to a SARS-CoV-2 reference genome (NC_045512.2 without the 33nt poly-A tail in the 3’ is used as default), an algorithm based on ARTIC pipeline (<ext-link ext-link-type="uri" xlink:href="https://github.com/artic-network/fieldbioinformatics">https://github.com/artic-network/fieldbioinformatics</ext-link>) for trimming primers if an ampliconbased method (e.g. ARTIC, SWIFT) was used for sequencing, generating consensus genomes, and variant calling based on samtools mpileup (v1.9) wrapped into a custom script (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/chienchi/reference-based_assembly">https://gitlab.com/chienchi/reference-based_assembly</ext-link>). EC-19 then accounts for strand biasness using both fisher score and Strand Odds ratio (<ext-link ext-link-type="uri" xlink:href="https://gatk.broadinstitute.org/hc/en-us/articles/360036464972-AS-StrandOddsRatio">https://gatk.broadinstitute.org/hc/en-us/articles/360036464972-AS-StrandOddsRatio</ext-link>) and reports SNVs if the Allele Frequency (AF) &gt; 0.2 and have minimum Depth of Coverage (DC) of five5. Likewise, InDels are reported if DC &gt; 5 and then platform specific thresholds are implemented for AF as AF&gt;0.5 is required for Illumina and AF&gt; 0.6 for ONT data in order to account for the higher error rates with this technology, and &gt;0.8 within homopolymer sequences.<sup><xref ref-type="bibr" rid="R48">48</xref>,<xref ref-type="bibr" rid="R49">49</xref></sup>
</p></sec><sec id="S22"><title>Lilly</title><sec id="S23"><title>Illumina</title><p id="P38">The paired end raw sequencing data were trimmed in two successive rounds using cutadapt<sup><xref ref-type="bibr" rid="R50">50</xref></sup> version 2.5 with the following parameters:□]</p><p id="P39">pe1_parms:□ --quality-base=33 -a ‘G{150}’-A ‘G{150}’:□□□</p><p id="P40">pe2_parms: -a AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -A AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT : --quality-base=33 -q 20 --n 2 -trim-n -m 20 --max-n=.2 : -a ‘{150}’ -A ‘{150}’ -a ‘T{150}’ -A ‘T{150}’ : -g ‘{150}’ -G ‘{150}’ -g ‘T{150}’ -G ‘T{150}’: -g AAGCAGTGGTATCAACGCAGAG -G AAGCAGTGGTATCAACGCAGAGI3 : -g AAGCAGTGGTATCAACGCAGAGTAC -G AAGCAGTGGTATCAACGCAGAGTAC□□</p><p id="P41">Reads were aligned to the hg19_human_trxome_and_coronavirus.fa reference genome (Thermo Fisher, which included MT019532.1 BetaCoV/Wuhan/IPBCAMS-WH-04/2019) using bwa-mem<sup><xref ref-type="bibr" rid="R33">33</xref></sup> version 0.7.12 with default parameters. Variants were called using FreeBayes<sup><xref ref-type="bibr" rid="R43">43</xref></sup> version 1.3.1 with the following parameters: -F 0 -p 1 -K -C 0 -n 5 -w --min-alternate-count 0 --min-alternate-fraction 0.</p><p id="P42">Variants were reported if there were &gt;= 5 reads supporting the variant; if□ &gt;= 10% of reads supporting the variant were derived from the minor strand; and if the allele frequency was &gt;=15%.□</p></sec></sec><sec id="S24"><title>NCBI</title><p id="P43">The NCBI SARS-CoV-2 variant calling pipeline can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sars2variantcalling">https://github.com/ncbi/sars2variantcalling</ext-link>. The pipeline, as used for the analyses presented here, is briefly described below.</p><sec id="S25"><title>Illumina</title><p id="P44">Illumina short reads were downloaded from SRA database using fastq-dump of sratoolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools#the-sra-toolkit">https://github.com/ncbi/sra-tools#the-sra-toolkit</ext-link>, version 2.11.0), then trimmed using trimmomatic (version 0.39)<sup><xref ref-type="bibr" rid="R44">44</xref></sup>. The reads were aligned using Hisat2 (version 2.2.1)<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, then left-aligned using GATK LeftAlignIndels (version 4.2.4.1)<sup><xref ref-type="bibr" rid="R52">52</xref></sup>. GATK HaplotypeCaller (version 4.2.4.1) with the options “minimummapping-quality 10”<sup><xref ref-type="bibr" rid="R52">52</xref></sup> was used for generating variant VCFs with NCBI Reference Sequence NC_045512.2 as the reference. Calls with QUAL value smaller than 100, alternate allele counts lower than 10, FS value smaller than 60, SOR value smaller than 4, QD value equal to or greater than 2, ReadPosRankSum value equal to or greater than -4, allele frequency lower than 0.15, and reference genome positions beyond 29850 were excluded.□</p></sec><sec id="S26"><title>ONT</title><p id="P45">Nanopore reads were downloaded from SRA database using fastq-dump of sratoolkit (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools#the-sra-toolkit">https://github.com/ncbi/sra-tools#the-sra-toolkit</ext-link>, version 2.11.0), then trimmed using NanoFilt<sup><xref ref-type="bibr" rid="R30">30</xref></sup> (version 2.8.0) with the options “q 10” and “headcrop 40”<sup><xref ref-type="bibr" rid="R30">30</xref></sup>. Two rounds of medaka (version 1.3.2, <ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link>) were applied to generate consensus assembly. Consensus to reference (NC_045512.2) alignment and initial variant calls were generated with MUMmer (version 4.0.0rc1, <ext-link ext-link-type="uri" xlink:href="https://github.com/mummer4/mummer">https://github.com/mummer4/mummer</ext-link>). InDels and SNPs within 10bps of an InDel were excluded using bcftools (version 1.11)<sup><xref ref-type="bibr" rid="R34">34</xref></sup>, and snp clusters (2 or more SNPs within 10 bps) were filtered using vcftools (version 0.1.12b),<sup><xref ref-type="bibr" rid="R24">24</xref></sup>□□</p><p id="P46">□</p></sec></sec><sec id="S27"><title>VIR□□□□□</title><sec id="S28"><title>Illumina□</title><p id="P47">The pipeline was written and optimized for another library preparation and the primer removal step and pipeline parameters were not optimized for the samples analyzed in this study.</p><p id="P48">Illumina short reads□were downloaded from SRA□database□using□fastq-dump of□sratoolkit□ (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools#the-sra-toolkit">https://github.com/ncbi/sra-tools#the-sra-toolkit</ext-link>, version□2.9.1) [parameters: –<italic>split-files</italic> for paired end reads].□</p><p id="P49">The library preparation consisted of a mix of SE reads, and PE reads (with random fragmentation or amplicons fragment). The read length ranged from 300 to 500bp for SE, and 50 to 300bp for PE reads. As the samples were prepared with different library preparations, not always retrievable from the metadata, we used a conservative approach to trim the 31bp at the beginning of all reads that were 150bp or longer. 31bp corresponds to the maximum primer length in the ARTICV3 kit. Reads were trimmed with trimmomatic (version 0.39) [parameters: HEADCROP:31 MINLEN:35; PE -validatePairs for paired end; SE for single end].<sup><xref ref-type="bibr" rid="R44">44</xref></sup></p><p id="P50">The alignment was performed with bwa-mem (<ext-link ext-link-type="uri" xlink:href="quay.io/biocontainers/bwa:0.7.17--hed695b0_7">quay.io/biocontainers/bwa:0.7.17--hed695b0_7</ext-link>) [parameters: -M].<sup><xref ref-type="bibr" rid="R53">53</xref></sup> The variant calling was performed with lofreq (<ext-link ext-link-type="uri" xlink:href="quay.io/biocontainers/lofreq:2.1.5--py36ha518a1e_1">quay.io/biocontainers/lofreq:2.1.5--py36ha518a1e_1</ext-link>)<sup><xref ref-type="bibr" rid="R36">36</xref></sup> in multiple consecutive steps: lofreq viterbi; lofreq indelqual [parameters: --dindel]; lofreq call-parallel [parameters: --no-default-filter --call-indels –min-bq 6 –min-alt-bq 6 –min-mq 1 –sig 1]; lofreq filter [parameters: --no-defaults –af-min 0.01 –cov-min 15 –sb-mte fdr-sb–alpha 0.05 –sb-incl-indels; note: --sb-alpha parameter was set to 0 for samples prepared with amplicon libraries to prevent filtering variant due to strand bias, which can occur with amplicon library preparation]. For each sample, SNVs present at AF&gt;0.5 were substituted in the reference genome with bcftools consensus (<ext-link ext-link-type="uri" xlink:href="quay.io/biocontainers/bcftools:1.10.2-hd2cd319_0">quay.io/biocontainers/bcftools:1.10.2-hd2cd319_0</ext-link>)<sup><xref ref-type="bibr" rid="R34">34</xref></sup> and the alignment and variant calling steps were run a second time on the “new” reference genome (in order to rescue reads that were potentially mis-aligned/un-aligned due to too many mutations located in the near vicinity of each other). Of note, the final variant calling is done with regards to the initial NC_045512.2 reference genome nomenclature. SNVs and indels were reported if they were present with AF&gt;0.15. Minimum read depth was set at a low threshold (15 reads) for the purpose of this analysis. Variants flagged as potentially spurious due to their location on the reads (i.e. consistently located at the same position in the read for the alternative allele, but not for the reference allele) were further filtered if they were present in more than 2 samples and in all samples at low AF (&lt;0.5).</p></sec><sec id="S29"><title>ONTI3</title><p id="P51">At the time of analysis, VIR did not have an existing pipeline to assess ONT data.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Figure 1</label><media xlink:href="EMS156673-supplement-Supplemental_Figure_1.pdf" mimetype="application" mime-subtype="pdf" id="d90aAdEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplemental Figure 2</label><media xlink:href="EMS156673-supplement-Supplemental_Figure_2.pdf" mimetype="application" mime-subtype="pdf" id="d90aAdEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplemental Figure 3</label><media xlink:href="EMS156673-supplement-Supplemental_Figure_3.pdf" mimetype="application" mime-subtype="pdf" id="d90aAdEdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplemental Figure 4</label><media xlink:href="EMS156673-supplement-Supplemental_Figure_4.pdf" mimetype="application" mime-subtype="pdf" id="d90aAdEeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplemental Table 1</label><media xlink:href="EMS156673-supplement-Supplemental_Table_1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d90aAdEfB" position="anchor"/></supplementary-material></sec></body><back><ack id="S30"><title>Acknowledgements</title><p>This work was supported in part by the National Center for Biotechnology Information of the National Library of Medicine (NLM), National Institutes of Health. This work was supported in part by the European Union’s Horizon 2020 and Horizon Europe research and innovation programs under grant agreements No 871075 (ELIXIR-CONVERGE) and 101046203 (BY-COVID). This project was funded in part with Federal funds from the National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under Contract No. HHSN272201600013C, managed by ATCC. This work was supported in part by the Los Alamos National Laboratory’s Laboratory-Directed Research and Development program [20200732ER and 20210767DI] and under IAA project RRJJ00 with the Centers for Disease Control and Prevention. We would like to acknowledge Roberto Spreafico, Leah Soriaga, Li Yin and Amin Momin for their contribution in the VIR variant calling pipeline, and Lisa Purcell for providing guidance and advice to this group. We would also like to acknowledge John Calley for his creation of the Lilly variant calling pipeline. The work would not be possible without the NIH ACTIV TRACE initiative and the support of the Deep Sequencing Analysis Subgroup and the HHS Office of the Assistant Secretary for Preparedness and Response (ASPR) Countermeasures Acceleration Group (CAG).</p></ack><fn-group><fn id="FN1" fn-type="conflict"><p id="P52"><bold>Conflict of Interest</bold></p><p id="P53">RM, JL, and ESM are employees of, and stockholders in, Gilead Sciences, Inc. JdI is an employee of, and hold stock or stock options in, Vir Biotechnology, Inc. PE is an employee of, and holds stock or stock options in, Eli Lilly and Company. The remaining authors declare no conflict of interest.</p></fn><fn id="FN2" fn-type="con"><p id="P54"><bold>Author contributions</bold></p><p id="P55">RC, DAY, WM, MS, RM, RB, JRB, PSGC, CAC, JdI, PE, TLR, PL, CL, SR, ESM, CX, and KDP all contributed to editing the manuscript. DAY, WM, MS, RM, RB, JdI, BH, PE, YJ, JG, KSK, AK, JL, PL, CL, SR, CX, VZ all contributed to the development of one of the workflows and/or processed data used in this study by one of the workflows. RC, DAY, WM, MS, RM, PSGC, JdI, PE, JL, PL, CL, CX all conducted analyses of variant calling results. RC, DAY, WM, CAC, TLR, JL all contributed to figure generation. RC, DAY, WM, MS, RM, JdI, ESM, CX, KDP all contributed writing to the manuscript. CAC and TLR helped facilitate the group meetings and coordinate the group’s efforts. RC led the group’s efforts. All author’s contributed to determining the direction of the research and evaluating analysis results.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sayers</surname><given-names>EW</given-names></name><etal/></person-group><article-title>GenBank</article-title><source>Nucleic Acids Res</source><year>2022</year><volume>50</volume><fpage>D161</fpage><lpage>D164</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>K</given-names></name><etal/></person-group><article-title>The Sequence Read Archive: a decade more of explosive growth</article-title><source>Nucleic Acids Res</source><year>2022</year><volume>50</volume><fpage>D387</fpage><lpage>D390</lpage></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>B</given-names></name><etal/></person-group><article-title>Assessing reproducibility of inherited variants detected with short-read whole genome sequencing</article-title><source>Genome Biol</source><year>2022</year><volume>23</volume></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foox</surname><given-names>J</given-names></name><etal/></person-group><article-title>Performance assessment of DNA sequencing platforms in the ABRF Next-Generation Sequencing Study</article-title><source>Nat. Biotechnol</source><year>2021</year><volume>39</volume><fpage>1129</fpage><lpage>1140</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnan</surname><given-names>V</given-names></name><etal/></person-group><article-title>Benchmarking workflows to assess performance and suitability of germline variant calling pipelines in clinical diagnostic assays</article-title><source>BMC Bioinformatics</source><year>2021</year><volume>22</volume></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lincoln</surname><given-names>SE</given-names></name><etal/></person-group><article-title>A Rigorous Interlaboratory Examination of the Need to Confirm Next-Generation Sequencing–Detected Variants with an Orthogonal Method in Clinical Genetic Testing</article-title><source>J. Mol. Diagnostics</source><year>2019</year><volume>21</volume><fpage>318</fpage><lpage>329</lpage></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornish</surname><given-names>A</given-names></name><name><surname>Guda</surname><given-names>C</given-names></name></person-group><article-title>A Comparison of Variant Calling Pipelines Using Genome in a Bottle as a Reference</article-title><source>Biomed Res Int</source><year>2015</year><volume>2015</volume></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>YL</given-names></name><etal/></person-group><article-title>Comparison of GATK and DeepVariant by trio sequencing</article-title><source>Sci Rep</source><year>2022</year><volume>12</volume></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Zhong</surname><given-names>H</given-names></name><name><surname>Meng</surname><given-names>Y</given-names></name><name><surname>Du</surname><given-names>H</given-names></name></person-group><article-title>Systematic comparison of germline variant calling pipelines cross multiple next-generation sequencers</article-title><source>Sci Rep</source><year>2019</year><volume>9</volume></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krusche</surname><given-names>P</given-names></name><etal/></person-group><article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>555</fpage><lpage>560</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>W</given-names></name><etal/></person-group><article-title>Toward best practice in cancer mutation detection with whole-genome and whole-exome sequencing</article-title><source>Nat Biotechnol</source><year>2021</year><volume>39</volume><fpage>1141</fpage><lpage>1150</lpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Posada-Cespedes</surname><given-names>S</given-names></name><etal/></person-group><article-title>V-pipe: a computational pipeline for assessing viral genetic diversity from high-throughput data</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><fpage>1673</fpage><lpage>1680</lpage></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradley Holmes</surname><given-names>J</given-names></name><name><surname>Moyer</surname><given-names>E</given-names></name><name><surname>Phan</surname><given-names>L</given-names></name><name><surname>Maglott</surname><given-names>D</given-names></name><name><surname>Kattman</surname><given-names>B</given-names></name></person-group><article-title>SPDI: data model for variants and applications at NCBI</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>1902</fpage><lpage>1907</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolze</surname><given-names>A</given-names></name><etal/></person-group><article-title>Evidence for SARS-CoV-2 Delta and Omicron co-infections and recombination</article-title><source>medRxiv</source><year>2022</year><elocation-id>2022.03.09.22272113</elocation-id><pub-id pub-id-type="doi">10.1101/2022.03.09.22272113</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitwieser</surname><given-names>FP</given-names></name><name><surname>Pertea</surname><given-names>M</given-names></name><name><surname>Zimin</surname><given-names>AV</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Human contamination in bacterial genomes has created thousands of spurious proteins</article-title><source>Genome Res</source><year>2019</year><volume>29</volume><fpage>954</fpage><lpage>960</lpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Huntemann</surname><given-names>M</given-names></name><name><surname>Ivanova</surname><given-names>N</given-names></name><name><surname>Kyrpides</surname><given-names>NC</given-names></name><name><surname>Pati</surname><given-names>A</given-names></name></person-group><article-title>Large-scale contamination of microbial isolate genomes by illumina Phix control</article-title><source>Stand Genomic Sci</source><year>2015</year><volume>10</volume><fpage>1</fpage><lpage>4</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lagerborg</surname><given-names>KA</given-names></name><etal/></person-group><article-title>Synthetic DNA spike-ins (SDSIs) enable sample tracking and detection of inter-sample contamination in SARS-CoV-2 sequencing workflows</article-title><source>Nat Microbiol</source><year>2021</year><volume>7</volume><fpage>108</fpage><lpage>119</lpage><comment>2021, 71</comment></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornet</surname><given-names>L</given-names></name><name><surname>Baurain</surname><given-names>D</given-names></name></person-group><article-title>Contamination detection in genomic data: more is not enough</article-title><source>Genome Biol</source><year>2022</year><volume>23</volume><fpage>1</fpage><lpage>15</lpage></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delahaye</surname><given-names>C</given-names></name><name><surname>Nicolas</surname><given-names>J</given-names></name></person-group><article-title>Sequencing DNA with nanopores: Troubles and biases</article-title><source>PLoS One</source><year>2021</year><volume>16</volume><elocation-id>e0257521</elocation-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>T</given-names></name><name><surname>Chitnis</surname><given-names>N</given-names></name><name><surname>Monos</surname><given-names>D</given-names></name><name><surname>Dinh</surname><given-names>A</given-names></name></person-group><article-title>Next-generation sequencing technologies: An overview</article-title><source>Hum Immunol</source><year>2021</year><volume>82</volume><fpage>801</fpage><lpage>811</lpage></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alser</surname><given-names>M</given-names></name><etal/></person-group><article-title>Technology dictates algorithms: recent developments in read alignment</article-title><source>Genome Biol</source><year>2021</year><volume>22</volume><fpage>1</fpage><lpage>34</lpage><comment>2021 221</comment></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aksamentov</surname><given-names>I</given-names></name><name><surname>Roemer</surname><given-names>C</given-names></name><name><surname>Hodcroft</surname><given-names>EB</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><article-title>Nextclade: clade assignment, mutation calling and quality control for viral genomes</article-title><source>J Open Source Softw</source><year>2021</year><volume>6</volume><elocation-id>3773</elocation-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Toole</surname><given-names>Á</given-names></name><etal/></person-group><article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title><source>Virus Evol</source><year>2021</year><volume>7</volume></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname><given-names>P</given-names></name><etal/></person-group><article-title>The variant call format and VCFtools</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>2156</fpage></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donaldson</surname><given-names>EF</given-names></name><name><surname>Deming</surname><given-names>DJ</given-names></name><name><surname>O’Rear</surname><given-names>JJ</given-names></name><name><surname>Naeger</surname><given-names>LK</given-names></name></person-group><article-title>Regulatory evaluation of antiviral drug resistance in the era of next-generation sequencing</article-title><source>Biomark. Med</source><year>2015</year><volume>9</volume><fpage>1047</fpage><lpage>1051</lpage></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Leary</surname><given-names>NA</given-names></name><etal/></person-group><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title><source>Nucleic Acids Res</source><year>2016</year><volume>44</volume><fpage>D733</fpage><lpage>D745</lpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJA</given-names></name><etal/></person-group><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>1422</fpage><lpage>1423</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><collab>NCBI Resource Coordinators</collab><article-title>Database resources of the National Center for Biotechnology Information</article-title><source>Nucleic Acids Res</source><year>2016</year><volume>44</volume><fpage>D7</fpage><lpage>D19</lpage></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Gu</surname><given-names>J</given-names></name></person-group><article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>i884</fpage><lpage>i890</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Coster</surname><given-names>W</given-names></name><name><surname>D’Hert</surname><given-names>S</given-names></name><name><surname>Schultz</surname><given-names>DT</given-names></name><name><surname>Cruts</surname><given-names>M</given-names></name><name><surname>Van Broeckhoven</surname><given-names>C</given-names></name></person-group><article-title>NanoPack: visualizing and processing long-read sequencing data</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>2666</fpage><lpage>2669</lpage></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>DE</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name></person-group><article-title>Improved metagenomic analysis with Kraken 2</article-title><source>Genome Biol</source><year>2019</year><volume>20</volume><fpage>1</fpage><lpage>13</lpage></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Le</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>F</given-names></name></person-group><article-title>SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation</article-title><source>PLoS One</source><year>2016</year><volume>11</volume><elocation-id>e0163962</elocation-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>589</fpage><lpage>595</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname><given-names>P</given-names></name><etal/></person-group><article-title>Twelve years of SAMtools and BCFtools</article-title><source>Gigascience</source><year>2021</year><volume>10</volume><fpage>1</fpage><lpage>4</lpage></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Auwera</surname><given-names>G</given-names></name><name><surname>O’Connor</surname><given-names>B</given-names></name><name><surname>Safarian</surname><given-names>OMC</given-names></name></person-group><article-title>Genomics in the Cloud: Using Docker, GATK, and WDL in Terra</article-title><source>Genomics in the Cloud</source><year>2020</year></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilm</surname><given-names>A</given-names></name><etal/></person-group><article-title>LoFreq: a sequence-quality aware, ultra-sensitive variant caller for uncovering cellpopulation heterogeneity from high-throughput sequencing datasets</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><fpage>11189</fpage><lpage>11201</lpage></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="web"><source>GitHub - nanoporetech/medaka: Sequence correction provided by ONT Research</source><comment><ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link></comment></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maier</surname><given-names>W</given-names></name><etal/></person-group><article-title>Ready-to-use public infrastructure for global SARS-CoV-2 monitoring</article-title><source>Nat Biotechnol</source><year>2021</year><volume>39</volume><fpage>1178</fpage><lpage>1179</lpage></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Connor</surname><given-names>BD</given-names></name><etal/></person-group><article-title>The Dockstore: enabling modular, community-focused sharing of Dockerbased genomics tools and workflows</article-title><source>F1000Research</source><year>2017</year><volume>6</volume></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="web"><source>Freely accessible ready to use global infrastructure and workflows for SARS-CoV-2 monitoring</source><comment><ext-link ext-link-type="uri" xlink:href="https://workflowhub.eu/collections/2">https://workflowhub.eu/collections/2</ext-link></comment></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grubaugh</surname><given-names>ND</given-names></name><etal/></person-group><article-title>An amplicon-based sequencing framework for accurately measuring intrahost virus diversity using PrimalSeq and iVar</article-title><source>Genome Biol</source><year>2019</year><volume>20</volume><fpage>1</fpage><lpage>19</lpage></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>nickloman</surname></name><etal/></person-group><source>artic-network/fieldbioinformatics: 1.2.2</source><year>2022</year><pub-id pub-id-type="doi">10.5281/ZENODO.6245266</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group><source>Haplotype-based variant detection from short-read sequencing</source><year>2012</year><pub-id pub-id-type="doi">10.48550/arxiv.1207.3907</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolger</surname><given-names>AM</given-names></name><name><surname>Lohse</surname><given-names>M</given-names></name><name><surname>Usadel</surname><given-names>B</given-names></name></person-group><article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>2114</fpage><lpage>2120</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaspar</surname><given-names>JM</given-names></name></person-group><article-title>NGmerge: Merging paired-end reads via novel empirically-derived models of sequencing errors</article-title><source>BMC Bioinformatics</source><year>2018</year><volume>19</volume><fpage>1</fpage><lpage>9</lpage></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>3094</fpage><lpage>3100</lpage></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lo</surname><given-names>C-C</given-names></name><etal/></person-group><article-title>EDGE COVID-19: a web platform to generate submission-ready genomes from SARS-CoV-2 sequencing efforts</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><fpage>2700</fpage><lpage>2704</lpage></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cretu Stancu</surname><given-names>M</given-names></name><etal/></person-group><article-title>Mapping and phasing of structural variation in patient genomes using nanopore sequencing</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>1</fpage><lpage>13</lpage><comment>2017 81</comment></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rang</surname><given-names>FJ</given-names></name><name><surname>Kloosterman</surname><given-names>WP</given-names></name><name><surname>de Ridder</surname><given-names>J</given-names></name></person-group><article-title>From squiggle to basepair: Computational approaches for improving nanopore sequencing read accuracy</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><fpage>1</fpage><lpage>11</lpage></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>M</given-names></name></person-group><article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title><source>EMBnet.journal</source><year>2011</year><volume>17</volume><fpage>10</fpage><lpage>12</lpage></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Paggi</surname><given-names>JM</given-names></name><name><surname>Park</surname><given-names>C</given-names></name><name><surname>Bennett</surname><given-names>C</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Graph-based genome alignment and genotyping with HISAT2 and HISAT-genotype</article-title><source>Nat. Biotechnol</source><year>2019</year><volume>37</volume><fpage>907</fpage><lpage>915</lpage></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><etal/></person-group><article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><fpage>1297</fpage><lpage>1303</lpage></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Barrett</surname><given-names>J</given-names></name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Analysis schematic.</title><p>A) Illumina Platform Variant Calling. B) Oxford Nanopore Technologies (ONT) Variant Calling. For each sequencing technology, the main steps of variant calling are broken out in large boxes: read retrieval, host removal, read trimming, alignment, variant calling, variant filtering, variant normalization. For each step, software used by each group/s pipeline is noted.</p></caption><graphic xlink:href="EMS156673-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Impact of read cleanup.</title><p>A) Impact of de-hosting on read alignment. Removal of host reads from RNAseq SARS-CoV-2 sequencing result, SRA run SRR12245095, reduced the potential for false positive variant calls. In the top panel, additional mutations were present in aligned reads between positions 3049-3076 of NC_045512 when host reads were not removed. After excluding host reads (bottom panel), reads containing the mutations were no longer observed B) Impact of primer trimming on variant calls. Allele-frequencies of variants called after trimming primer sequences from aligned reads (corrected allele-frequencies) are plotted against allele-frequencies of the same variants called without primer trimming (uncorrected allele-frequencies). Primer trimming increases called allele-frequencies of most within-primer binding sites variants. Blue lines represent the allele-frequency thresholds used in this study to filter variant calls (AF &gt;= 0.15) and to call consensus variants (AF &gt;= 0.5). Primer trimming lifts the allele-frequencies of 61 within-primer binding site variants above the threshold for retaining them, and enables calling of six additional consensus variants.</p></caption><graphic xlink:href="EMS156673-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Identification of filtering parameters inflection points.</title><p>A+C) Effect of alternate allele read depth (AltDP) on Accuracy and Specificity of each pipeline with regards to calls made by the majority of groups. B+D) Effect of alternate allele frequency (AF) on Accuracy and Specificity of each pipeline with regards to calls made by the majority of groups. A+B) Impact of AltDP and AF on pipeline accuracy and specificity for Illumina pipelines. C+D) Impact of AltDP and AF on pipeline accuracy and specificity for Illumina pipelines. E+F) Impact of AltDP on accuracy and specificity of calls made by both platforms for Illumina pipelines. G+H) Impact of AltDP on accuracy and specificity of calls made by both platforms for ONT pipelines. For each, calls made by all but one pipeline (or both technologies) were considered true positives, while calls made by only a single pipeline (or technology) were considered false positives, thus the ROC AUCs cannot be directly compared between groups.</p></caption><graphic xlink:href="EMS156673-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Agreement across pipelines with and without recommended parameters.</title><p>A+B+C+D) Agreement across pipelines without recommended parameters. E+F+G+H) Agreement across pipelines with recommended parameters. A+E) Agreement on Illumina SNP calls. B+F) Agreement on Illumina InDel calls. C+G) Agreement on Oxford Nanopore (ONT) SNP calls. D+H) Agreement on ONT InDel Calls. For each figure, the bars indicate the number of variants called by the groups indicated by filled circles below, across the whole dataset. The large number of workflow unique calls for LANL and BEI in C) and D) respectively are attributable to calls with low read support (DP&lt;100 or ALTDP&lt;50), of low frequency (&lt;50%), in homopolymer regions, or in samples with poor reference coverage, as indicated by the reduction after filtering, G) and H) respectively.</p></caption><graphic xlink:href="EMS156673-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Agreement across platforms with and without recommended parameters.</title><p>A+B) Agreement between platforms without recommended parameters. C+D) Agreement between platforms with recommended parameters. A+C) Agreement between platforms on SNP calls. B+D) Agreement between platforms on InDel calls. For each figure, only those sample for which both Illumina and ONT platform data had at least one variant call that passed all the filters was considered. The total height is normalized to the total number of calls made by each pipeline, with the light blue portion indicating calls made on both platforms for a given sample, the medium blue indicating calls made only for the Illumina data, and the dark blue indicating calls made only for the ONT data.</p></caption><graphic xlink:href="EMS156673-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Variant Calling Pipeline Recommendations.</title><p>Recommendations for each step in a variant calling pipeline, from read cleanup to variant filtering, are illustrated. Additionally, the benefit of implementing the recommendations at each step are noted.</p></caption><graphic xlink:href="EMS156673-f006"/></fig></floats-group></article>