<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206473</article-id><article-id pub-id-type="doi">10.1101/2025.06.12.659409</article-id><article-id pub-id-type="archive">PPR1035705</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Planetary-scale metagenomic search reveals new patterns of CRISPR targeting</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Roux</surname><given-names>Simon</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Neri</surname><given-names>Uri</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Bushnell</surname><given-names>Brian</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fremin</surname><given-names>Brayon</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>George</surname><given-names>Nikhil A.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Gophna</surname><given-names>Uri</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Hug</surname><given-names>Laura A.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Camargo</surname><given-names>Antonio Pedro</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wu</surname><given-names>Dongying</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ivanova</surname><given-names>Natalia</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kyrpides</surname><given-names>Nikos</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Eloe-Fadrosh</surname><given-names>Emiley</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04xm1d337</institution-id><institution>DOE Joint Genome Institute</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jbv0t02</institution-id><institution>Lawrence Berkeley National Laboratory</institution></institution-wrap>, <city>Berkeley</city>, <country country="US">USA</country></aff><aff id="A2"><label>2</label>Department of Biomedical Informatics, Harvard Medical School, Boston, MA, USA</aff><aff id="A3"><label>3</label>The Shmunis School of Biomedicine and Cancer Research, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04mhzgx49</institution-id><institution>Tel Aviv University</institution></institution-wrap>, <city>Tel Aviv</city>, <country country="IL">Israel</country></aff><aff id="A4"><label>4</label>Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01aff2v68</institution-id><institution>University of Waterloo</institution></institution-wrap>, <city>Waterloo</city>, <state>Ontario</state><country country="CA">Canada</country></aff><author-notes><corresp id="CR1">Correspondence to: <email>sroux@lbl.gov</email>, <email>eaeloefadrosh@lbl.gov</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>15</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><license-p>This article is a US Government work. It is not subject to copyright under 17 USC 105 and is also made available for use under a CC0 license.</license-p></license><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/publicdomain/zero/1.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">CC0 license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Interactions between microbes and their mobile genetic elements (MGEs), including viruses and plasmids, are critical drivers of microbiome structures and processes. CRISPR-Cas systems are known to be important regulators of these host-MGE interactions, but a global understanding of CRISPR-Cas diversity, activity, and roles across Earth’s biomes is still lacking. Here, we use an optimized computational approach to search shortread data and collect ~800 million CRISPR spacers across ~450,000 public metagenomes. Comparing spacers across samples and taxa revealed a high population diversity for CRISPR loci overall, with typically only a small subset of spacers detected as prevalent and conserved within a microbial population. From this extensive CRISPR spacer dataset, we identified 1.18 billion hits between 41 million spacers and 2.5 million viruses and plasmids. Prevalent and conserved spacers were over-represented in these MGE-matching spacers, and CRISPR spacers frequently matched multiple MGEs, consistent with a positive selection pressure associated with MGE targeting. Focusing on the role of CRISPR as anti-phage defense, we observed surprising cases of viruses targeted by microbes not expected to be viable hosts. These were more frequent for viruses encoding a diversification mechanism (DGR) for their host attachment proteins, and associated with a reduced rate of escape mutations. This suggests that broad spacer targeting may derive from the recurring entry of a virus genome into a non-host microbial cell, leading to some viruses being targeted by taxonomically diverse microbes well outside of their actual host range. Taken together, this petabase-scale exploration of CRISPR arrays in nature outlines the extensive diversity of CRISPR array loci across microbiomes. It highlights several key genomic and ecological parameters driving the activity of CRISPR arrays that are likely influencing strainlevel diversification and selection processes within microbial populations.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Microbes are the dominant form of life on Earth, driving major biogeochemical cycles and shaping the biology of larger plants and animals, including humans<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup>. Microbes most often coexist in complex communities, known as microbiomes, in which interactions between organisms are critical drivers of microbial ecology, evolution, and metabolic activity<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref></sup>. Among these, interactions between microbes and “mobile genetic elements” (MGEs), including plasmids and viruses, can shape long-term genetic exchange and evolutionary trajectories of microbial populations. Viruses in particular are now broadly recognized as key drivers of microbial population structure, diversity, and metabolism<sup><xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>. Yet the full breadth of interactions between microbes and MGEs are still only partially explored, and eco-evolutionary drivers of MGE-host dynamics remain to be characterized.</p><p id="P3">CRISPR-Cas systems, encoded in ~40% of bacterial and ~85% of archaeal genomes<sup><xref ref-type="bibr" rid="R9">9</xref></sup>, play a key part in these MGE-host interactions. Since their original discovery, CRISPR-associated enzymes have quickly become a foundational part of the genome editing toolkit<sup><xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R12">12</xref></sup>. CRISPR-Cas systems can recognize and cleave exogenous DNA or RNA templates, and store short sequences derived from these templates, termed “spacers”, which enable recognition and targeting of similar exogenous elements in future encounters<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R13">13</xref>–<xref ref-type="bibr" rid="R16">16</xref></sup>. As CRISPR spacers are stored in dedicated and identifiable loci (“arrays”) in microbial genomes, these can be used to survey past encounters between microbial populations and other organisms or genetic elements, especially plasmids and viruses. The diversity of spacer arrays and the impact of spacer targeting on MGE populations have been mostly studied <italic>in vitro</italic> or in individual habitats<sup><xref ref-type="bibr" rid="R17">17</xref>–<xref ref-type="bibr" rid="R21">21</xref></sup>. Studies of CRISPR spacers obtained from shotgun metagenomes, i.e. direct sequencing of DNA extracted from a microbiome, suggest that CRISPR arrays in natural communities are broadly but unevenly distributed across taxa and environments, that some spacer arrays are highly diverse across space and time, and that spacers can target both sympatric and allopatric viruses<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R22">22</xref>–<xref ref-type="bibr" rid="R26">26</xref></sup>.</p><p id="P4">As these metagenomic studies have been performed on relatively small-scale datasets, several open questions remain regarding the overall diversity and MGE targeting of CRISPR arrays<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R31">31</xref></sup>. First, several tools have been designed to extract CRISPR spacers from metagenomes<sup><xref ref-type="bibr" rid="R32">32</xref>–<xref ref-type="bibr" rid="R35">35</xref></sup>, which sometimes led to conflicting observations, ranging from very high population diversity and spacer turnover to highly stable arrays with low rates of new spacer acquisition, without a clear indication of whether these reflect biological or methodological differences<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R36">36</xref></sup>. Second, several metagenomic studies recently reported viruses targeted by bacteria assigned to different classes or phyla, far beyond the host range of characterized virus isolates<sup><xref ref-type="bibr" rid="R37">37</xref>–<xref ref-type="bibr" rid="R39">39</xref></sup>. This suggests that either some uncultivated viruses are able to infect hosts across these large phylogenetic distances, or CRISPR targeting may occur between viruses and non-host microbial populations<sup><xref ref-type="bibr" rid="R38">38</xref></sup>.</p><p id="P5">Here, we designed an approach to systematically extract CRISPR spacers from short reads across 467,018 public metagenomes and built a global database of 794,125,610 CRISPR spacers connected to 274,000 distinct repeats. We leverage this unique dataset to explore global diversity and activity patterns of CRISPR systems across ecosystems, identify different levels of CRISPR targeting presumably associated with different types of microbe-MGE interactions, and use this new framework to re-interpret previous observations of viruses targeted by CRISPR arrays from phylogenetically distant microorganisms.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Metagenome reads encode an extensive diversity of CRISPR spacers</title><p id="P6">To evaluate the global diversity of CRISPR spacers across taxa and environments, we first identified CRISPR arrays using CRISPRCasTyper<sup><xref ref-type="bibr" rid="R40">40</xref></sup> across 383,318 public genomes and 33,727 metagenomes (see <xref ref-type="sec" rid="S9">Methods</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Data File 1</xref>). After quality control and curation, a total of 581,889 non-redundant CRISPR repeats could be identified from these arrays (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). Among repeats that could be classified taxonomically (n=109,810), most (61.3%) were assigned to a single family or genus, spanning across 159 phyla, 2,481 families, and 8,418 genera of bacteria and archaea (<xref ref-type="fig" rid="F1">Fig. 1B</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>).</p><p id="P7">We next used this extensive CRISPR repeat database in a new pipeline designed to efficiently extract CRISPR spacers from short reads (“SpacerExtractor”, see <xref ref-type="sec" rid="S9">Methods</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Text 1, Fig. S2</xref>) across 467,018 metagenomes publicly available in NCBI’s SRA (<xref ref-type="fig" rid="F1">Fig. 1A</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Data File 2</xref>)<sup><xref ref-type="bibr" rid="R41">41</xref></sup>. After quality control and denoising (see <xref ref-type="sec" rid="S9">Methods</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>), the final dataset was composed of 794,125,610 spacers, which dereplicated into 409,584,943 distinct spacers associated with 274,000 repeats across 367,609 metagenomes. Spacer sets, defined here as sets of 5 or more non-redundant spacers associated with a given repeat in a given sample (<xref ref-type="fig" rid="F1">Fig. 1A</xref>), could be readily obtained for most repeats identified in one or more genomes, isolate or metagenome-assembled genome (MAG) (<xref ref-type="fig" rid="F1">Fig. 1C</xref>). Overall, spacers were typically (99.0%) associated with a single repeat sequence, or associated with a single genus when linked to multiple repeat sequences (78.5%).</p><p id="P8">After controlling for sequencing depth, a higher number of CRISPR repeats was detected on average in wastewater, bioreactor, and hot spring microbiomes, while a lower number was observed in marine samples, likely reflecting a combination of differences in community complexity and frequency of CRISPR array carriage in these populations <sup><xref ref-type="bibr" rid="R23">23</xref></sup> (<xref ref-type="fig" rid="F1">Fig. 1D</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>). The taxonomic distribution of these CRISPR repeats was consistent with expected patterns of bacterial taxa distribution, with e.g. <italic>Lachnospira</italic> and <italic>Bifidobacterium-assigned</italic> repeats being among the most frequently detected in human gut samples, and <italic>Microcystis</italic> the most common in freshwater (<xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>). Taken together, these results confirm that the combination of an extensive CRISPR repeat database and large-scale metagenome mining provides a uniquely broad picture of the global diversity of CRISPR spacers across microbiomes.</p></sec><sec id="S4"><title>CRISPR spacers show high turnover rate and limited persistence across samples</title><p id="P9">We next explored the content and diversity of 18.1 million spacer sets (5 or more spacers), corresponding to spacers associated with 274,000 unique repeats across 367,609 metagenomes (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). Specifically, we compared the composition of these spacer sets within and between samples to evaluate the prevalence and persistence of individual spacers in natural microbial populations (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>).</p><p id="P10">Overall, most (52.5%) spacer sets included ≥20 distinct spacers, with 1,346,554 (7.4%) including ≥100 distinct spacers (<xref ref-type="fig" rid="F2">Fig. 2A</xref>). Among sets with sufficient sampling (≥1 spacer(s) with ≥20x coverage, n=2,068,538 sets), 75.7% showed a minority of high-abundance or “common” spacers, presumably shared across most members of the population, followed by a long tail of rare spacers (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). Accordingly, across the entire dataset, a two-third (67.0%) majority of spacers were singletons, i.e. identified on a single read (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>). This is consistent with a previous survey that used targeted PCR to deeply sequence the spacer diversity associated with a known repeat, and observed a large majority of low-frequency spacers<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. Clustering of spacers at lower identity levels suggested that more than half (62.9%) of the singletons were not closely related to another spacer in the same set, and thus are likely to represent genuinely rare spacers as opposed to sequencing artifacts (<xref ref-type="fig" rid="F2">Fig. 2C</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Text 2</xref>). Taken together, these results suggest that, at any given time, individual cells within a microbial population encode a small subset of spacers shared broadly within the population next to a larger number of rare spacers, potentially unique to this cell. Across our dataset, the highest levels of spacer diversity were observed in thermal springs and engineered ecosystems and for uncultivated taxa known or predicted to engage in microbe-microbe interactions, possibly reflecting specific eco-evolutionary pressures leading to high population diversity at CRISPR loci (<xref ref-type="supplementary-material" rid="SD1">Supplementary Text 2, Fig. S8</xref>).</p><p id="P11">CRISPR spacers are also expected to vary across time and space as new spacers are acquired and potentially selected for. To evaluate spacer variability across samples, we focused on the 17,585 repeat sequences with high-coverage sets (≥1 spacer(s) with ≥20x coverage) available for 10 or more samples, and compared the composition of these sets across samples (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). Most spacers (86.5%) were only detected in a single sample, although spacers identified as common in the population for at least one sample were more frequently identified in multiple samples (~53.7%, <xref ref-type="fig" rid="F2">Fig. 2D</xref>). When considering only samples from a single subject (for host-associated ecosystems) or location (for environmental samples), a similar percentage (84.7%) of spacers were detected in a single sample, but almost all common spacers (95.6%) were detected in multiple samples (<xref ref-type="fig" rid="F2">Fig. 2D</xref>). This is consistent with recent analyses of CRISPR loci diversity in individual human gut, shale wells, and marine aggregate microbiomes<sup><xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R29">29</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R42">42</xref></sup>, and suggests that (i) new spacers are frequently acquired by individual cells, leading to high alpha and beta diversity at CRISPR loci, (ii) most newly-acquired spacers are quickly lost to drift, and only a minority is retained and becomes common in the population, likely because of direct selection or genetic draft, and (iii) these common spacers are especially conserved through time within stable and established microbiomes (sensu <sup><xref ref-type="bibr" rid="R43">43</xref></sup>) such as in a single subject or location (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). Opposing this overall trend, a small number of repeats (~2.0%) were associated with an unusually low diversity of spacers within and between samples, and may represent “memory arrays” as previously suggested <sup><xref ref-type="bibr" rid="R44">44</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Fig. S9, Supplementary Text 2</xref>).</p></sec><sec id="S5"><title>Individual CRISPR spacers frequently match multiple potential targets</title><p id="P12">Given this expanded set of CRISPR spacers, we next looked for potential protospacers, i.e. spacer hits, in two large databases of viruses (IMG/VR) and plasmids (IMG/PR). Considering only hits covering the entire spacer with 0 or 1 mismatch, we identified spacer hits for 36.1% of IMG/VR sequences (n=2,011,412), including 81.8% of high-quality tailed phages genomes (HQ <italic>Caudoviricetes,</italic> n=290,883), for a total of 1.18 billion hits across 38 million distinct spacers (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>). Beyond <italic>Caudoviricetes,</italic> 9 million hits were observed to other phages including 4 million hits to <italic>Malgrandviricetes</italic> ssDNA phages, providing new information on the potential host range of these and other atypical viruses (<xref ref-type="supplementary-material" rid="SD1">Supplementary text 3, Fig. S11</xref>). Similarly, a majority (59.9%) of plasmids in IMG/PR had ≥1 hit(s), including 84.8% of the predicted complete plasmids and 79.5% of plasmids encoding a mating pair formation system, for a total of 212 million hits across 3 million spacers (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>). These spacer hits were more frequently observed between spacers and viruses or plasmids from similar ecosystems (<xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>), and represent a 6-fold and 2-fold increase compared to the current data in IMG/VR and IMG/PR, respectively. Based on these hits, Protospacer-Adjacent Motifs (PAMs), i.e. conserved motifs found next to protospacers for some CRISPR types, could be predicted for 61.1% of repeats based on sequence conservation around the spacer hits (<xref ref-type="fig" rid="F3">Fig. 3B</xref>). Predicted PAMs were overall consistent with known motifs described in the literature <sup><xref ref-type="bibr" rid="R45">45</xref>,<xref ref-type="bibr" rid="R46">46</xref></sup>, and potential new motifs could be predicted for several repeats for which none had yet been proposed (<xref ref-type="fig" rid="F3">Fig. 3B</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S12, Table S1</xref>).</p><p id="P13">Matches to viruses and plasmids were more frequently observed for common spacers (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, 30.5% with hit(s) compared to 10.1% for rare spacers), and spacers from human-associated samples (21.8% vs 5.64% on average for other ecosystems), the latter likely reflecting a database bias towards human microbiome spacers, viruses, and plasmids (<xref ref-type="fig" rid="F3">Fig. 3C</xref>). Strikingly, among spacers with at least one hit, 60.8% matched two or more distinct virus genomes, designated in IMG/VR as virus operational taxonomic units or vOTUs (<xref ref-type="fig" rid="F3">Fig. 3D</xref>). These identical matches across distinct vOTUs were found across both closely related and mostly unrelated viruses (<xref ref-type="fig" rid="F3">Fig. 3E</xref>), and more frequently associated with genes with known functions (47.9% of hits compared to 40.9% for spacers matching a single vOTU, <xref ref-type="supplementary-material" rid="SD1">Table S2</xref>). This is consistent with previous observations from smaller-scale studies of spacers matching conserved genes and/or genes laterally exchanged between viruses<sup><xref ref-type="bibr" rid="R29">29</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>, and could reflect arms race dynamics in which spacers targeting the most critical and/or common regions of virus genomes would be preferentially selected for and retained. However, the presence of these spacers matching multiple and sometimes unrelated viruses also means that, in order to reliably understand ongoing virus-host interactions, individual spacer hits may be misleading and a combined analysis of all spacer hits from a given repeat to a given target is required.</p></sec><sec id="S6"><title>CRISPR targeting is not always associated with elevated population diversity in the targeted virus</title><p id="P14">We next focused on the 314,567 near-complete and complete viral genomes (“HQ” viruses) with at least one spacer hit, and evaluated how much of the genome was targeted for each virus-repeat pair. Across 16,425,500 pairs in total, 75.4% only included a few spacer hits (&lt;10 spacers and &lt;200bp covered). Nevertheless, nearly half (48.1%) of HQ viruses showed at least one repeat with ≥10 spacer hits covering ≥200bp of the genome (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). For viruses with known hosts (isolated or detected as a provirus), the taxonomic assignment of repeats with ≥10 spacer hits were more commonly consistent with the host taxonomy compared to repeats with &lt;10 hits (77% vs 46%), suggesting that the number of spacer hits may help identify virus-host pairs (<xref ref-type="supplementary-material" rid="SD1">Fig. S14, Supplementary Text 4</xref>). In addition, 34.7% of HQ viruses showed at least one repeat with spacer hits covering ≥10% of the genome or ≥1kb (“high” level of targeting, <xref ref-type="supplementary-material" rid="SD1">Fig. S13</xref>), possibly linked to phenomena such as priming, in which new spacers are acquired based on and around existing spacers<sup><xref ref-type="bibr" rid="R47">47</xref></sup>. In most cases (80.6% of virus-repeat pairs), these high levels of targeting were not observed in any individual sample but only identified when considering spacers collected across multiple samples, suggesting these result from recurring virus-microbe encounters (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S13</xref>).</p><p id="P15">Recurring virus-host encounters are expected to lead to evolutionary arms races, including, in some cases, compensatory mutations in the virus genome to avoid CRISPR targeting<sup><xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R50">50</xref></sup>. In our analysis, most of these compensatory mutations would appear as mismatches between CRISPR spacer and target. We thus evaluated, for individual virus-repeat pairs with ≥10 spacer hits and ≥200bp covered, how the number of spacer hits observed changed as a function of the number of mismatches between virus and spacer (from 0 to 3 mismatches, <xref ref-type="fig" rid="F4">Fig. 4C</xref>). Overall, 27.8% of virus-repeat pairs showed a clear increase in the number of hits with increasing mismatches (correlation coefficient ≥0.7, “positive” mismatch profile, <xref ref-type="fig" rid="F4">Fig. 4D and E</xref>). This suggests an elevated diversity in these virus populations at the targeted loci, possibly associated with escape mutations as part of an ongoing arms race. Meanwhile, 41.0% of virus-host pairs, including 46.7% of pairs with “high” levels of targeting, showed a clear decreasing number of hits with increasing mismatches, i.e. most spacer hits were a perfect match to the virus genome (correlation coefficient ≤-0.7, “negative” mismatch profiles, <xref ref-type="fig" rid="F4">Fig. 4D and E</xref>). For viruses with known hosts, these negative mismatch profiles were most often associated with repeats assigned to a different taxon than the expected host (<xref ref-type="fig" rid="F4">Fig. 4F</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S14, Supplementary Text 4</xref>). Viruses encoding a diversity-generating retroelement (DGR) were also much more likely to be involved in virus-repeat interactions with a negative mismatch profile (<xref ref-type="fig" rid="F4">Fig. 4G</xref>), and negative mismatch profiles were also more common for plasmids, for which they represented 64.6% of the plasmid-repeat pairs (<xref ref-type="fig" rid="F4">Fig. 4D</xref>).</p><p id="P16">Taken together, we interpret these negative mismatch profiles as reflecting MGE-microbe interactions that are frequent enough to maintain a pool of targeting spacers, but do not lead to an evolutionary arms race via escape mutations. One possible mechanism could be virus particles recognizing receptors on non-host cells. In such a case, the CRISPR system(s) of the non-host cell may acquire spacers following virus genome entry but there would be no selection for escape mutants, as other defense systems and/or a lack of adaptation to the cellular machinery would likely prevent successful infection regardless. This scenario is especially likely for DGR-encoding viruses, as DGRs can modify receptor binding proteins possibly leading to virion attachment to non-host cells<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, and previous studies already highlighted that DGR-encoding viruses are targeted by a broader diversity of CRISPR systems than non-DGR-encoding viruses<sup><xref ref-type="bibr" rid="R52">52</xref></sup>. Virus genomes may also enter microbial cells via cell-to-cell transfer (e.g. conjugation or inter-species mating<sup><xref ref-type="bibr" rid="R53">53</xref></sup>) or natural transformation following lysis of a neighboring cell, which could lead to recurring interactions between viruses and specific non-host microbes in structured microbiomes with limited local diversity such as biofilms, micro-aggregates, or between syntrophic partners<sup><xref ref-type="bibr" rid="R38">38</xref></sup>.</p><p id="P17">Alternatively, mechanisms able to circumvent CRISPR targeting such as anti-CRISPR (acr) genes<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, integration into the host genome, or positive selection via host function complementation could also lead to the observation of negative mismatch profiles. No correlation between negative mismatch profiles and acr gene presence on viruses was observed here, although this may be due to our limited knowledge of acr gene diversity<sup><xref ref-type="bibr" rid="R54">54</xref></sup>. Meanwhile, the near-absence of “positive” mismatch profiles for plasmids suggests they rarely rely on escape mutations, and could instead counter CRISPR targeting by encoding anti-CRISPR and/or genes providing the host cell with a fitness advantage<sup><xref ref-type="bibr" rid="R55">55</xref></sup>.</p></sec><sec id="S7"><title>Broad CRISPR targeting does not necessarily correspond to broad host range</title><p id="P18">Finally, in light of this expanded CRISPR spacer database and different types of virus-microbe interactions identified, we sought to analyze in more detail viruses seemingly targeted by multiple unrelated taxa. Several such cases were recently reported and may suggest the existence of viruses with a much broader host range than any experimentally characterized isolate, possibly spanning across multiple classes, phyla, or even domains<sup><xref ref-type="bibr" rid="R37">37</xref>–<xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup>. However, most of these observations were based on a limited number of spacer matches and could also derive from sequences shared across unrelated viruses or from the presence of a viral genome in a non-host cell<sup><xref ref-type="bibr" rid="R38">38</xref></sup>.</p><p id="P19">Here, restricting the dataset to only spacers associated with taxonomically-assigned CRISPR repeats (medium-and high-confidence, see <xref ref-type="sec" rid="S9">Methods</xref>) and virus-repeat pairs connected by ≥10 spacers, we identified 715,536 cases in which a virus was targeted by at least one taxon (<xref ref-type="fig" rid="F5">Fig. 5A</xref>). Of these, 90,109 virus genomes (12.6%) were targeted by taxa from different classes, with 67.6% (n=60,973) showing a clear “dominant” targeting, either a single taxon with high level of targeting, or multiple taxa with high levels of targeting but a single one with a mismatch profile suggesting a potential arms race (<xref ref-type="fig" rid="F5">Fig. 5A</xref>). The latter group was enriched in DGR-encoding viruses (<xref ref-type="fig" rid="F5">Fig. 5B</xref>), consistent with the hypothesis that these viruses have a primary host but, presumably through the hypervariation of their host attachment protein, may also enter other unrelated cells. Pairs of repeats assigned to distinct classes but targeting the same virus were typically co-detected in the same samples, suggesting the microbes encoding these repeats may indeed co-exist in the same environment and be exposed to similar viruses (<xref ref-type="supplementary-material" rid="SD1">Fig. S15</xref>).</p><p id="P20">Several viruses from human and landfill samples previously described as targeted by distinct phyla<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup> also appeared as broadly targeted in our analysis (<xref ref-type="fig" rid="F5">Fig. 5C</xref>). Most of these viruses showed a “dominant” targeting pattern, i.e. one taxon encoding spacers covering a large fraction of the virus genome (≥25% and ≥10kb), while the targeting by other taxa was limited to &lt;300bp. One exception was the landfill virus I49 which showed relatively large targeting (1kb and 900bp) by two distinct phyla (<italic>Muirbacteria</italic> &amp; <italic>Patescibacteria</italic>), with spacer hits evenly distributed across the ~20kb of the virus sequence, but without a mismatch profile suggestive of an arms race (<xref ref-type="fig" rid="F5">Fig. 5C</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S16, Table S3, Supplementary Text 5</xref>). In addition to previously reported sequences, several additional viruses could be identified in the same landfill datasets, including two (I15 and I10) showing broad spacer coverage (≥1kb) by distantly related taxa (<italic>Bacilli</italic> &amp; <italic>Negativicutes,</italic> and <italic>Halobacteriota</italic> &amp; <italic>Clostridia</italic>) with possible signs of ongoing arms race, and with one of the two (I15) encoding a DGR (<xref ref-type="fig" rid="F5">Fig. 5D</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S17, Table S3, Supplementary Text 5</xref>). While errors in the taxonomic assignment of the repeat and/or horizontal transfer of arrays across unrelated microbes could lead to similar observations, these cases represent the most likely candidates for viruses with unusually broad host range in our dataset, if such viruses exist.</p></sec></sec><sec id="S8" sec-type="conclusions"><title>Conclusion</title><p id="P21">CRISPR-Cas systems are critical molecular mechanisms for microbes to identify and degrade allochthonous DNA and RNA elements. They are especially important as a defense mechanism against viruses, although counter-defenses including anti-CRISPR proteins and escape mutations can limit their efficiency and lead to arm races dynamics <sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R19">19</xref></sup>. The global-scale database of CRISPR spacers built here from public metagenomes reveals that most CRISPR arrays appear to be active and diverse, especially in hot springs and bioreactor ecosystems, possibly due to highly structured micro-habitats such as heterogeneous biofilms and aggregates existing in these environments. This is in contrast with a recent study suggesting a relatively low rate of new spacer acquisition in some human gut microbes<sup><xref ref-type="bibr" rid="R21">21</xref></sup>. Differences in methodologies may explain these seemingly contradictory results. Given the high diversity of spacers observed here and via deep PCR sequencing<sup><xref ref-type="bibr" rid="R36">36</xref></sup>, it is likely that CRISPR arrays are indeed highly diverse in natural populations, and CRISPR spacers frequently acquired by individual microbes. However, most of these spacers may remain confined to only a few individuals, and only a small minority may propagate through the host population to become prevalent. Conservative analysis frameworks focusing on these prevalent spacers may thus report a low rate of new spacer acquisition<sup><xref ref-type="bibr" rid="R21">21</xref></sup>. Similarly, previous reports of viruses with potentially broad host ranges based on CRISPR targeting by distantly related microbes<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup> could be further refined here and, while most seem to be associated with a primary and likely single host taxon, some may represent candidates for broad host range viruses to be further characterized. Overall, the incredible diversity of CRISPR spacers collected from metagenomes, along with the multiple patterns of targeting revealed in this analysis, reflect the extraordinary complexity of microbe-MGE interactions. These findings open new avenues for research into the ecological and evolutionary constraints on and consequences of these interactions across microbiomes.</p></sec><sec id="S9" sec-type="methods" specific-use="web-only"><title>Methods</title><sec id="S10"><title>CRISPR repeat database: Source data, CRISPR repeat identification, and dereplication</title><p id="P22">To build a global database of CRISPR repeat sequences, CRISPR repeats were searched across 383,318 bacterial and archaeal genomes from NCBI GenBank<sup><xref ref-type="bibr" rid="R57">57</xref></sup> and in contigs from 33,727 publicly available and unrestricted assembled metagenomes and metatranscriptomes publicly available in the IMG database<sup><xref ref-type="bibr" rid="R58">58</xref></sup> (accessed February 2023).</p><p id="P23">For genomes and metagenomes, Minced version 0.4.2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/ctSkennerton/minced">https://github.com/ctSkennerton/minced</ext-link>), derived from CRT<sup><xref ref-type="bibr" rid="R59">59</xref></sup>, was first run with default parameters to identify potential arrays. For each contig with at least one predicted array, CRISPRCasTyper<sup><xref ref-type="bibr" rid="R40">40</xref></sup> v1.8.0 was run (option “--prodigal meta”) to identify which of these repeat regions may represent CRISPR-Cas systems. From the CRISPRCasTyper prediction, a custom python script (now available as part of “SE_run_cctyper.py” in SpacerExtractor) was applied to refine the predicted repeat sequence from CRISPRCasTyper, specifically looking for cases where the spacers are near-identical at their 5’ and/or 3’ end(s), and extending the repeat as needed. Finally, arrays with the following characteristics were retained: Trusted “True” by CRISPRCasTyper, repeat_identity ≥80, spacer_identity ≤60, spacer_len_sem ≤2, repeat_len ≥ 2, and repeat_len ≤55. When the repeats were refined by the custom python scripts, these array features were recalculated except for the “Trusted” value from CRISPRCasTyper. This led to a total of 3,168,155 arrays predicted across genomes and metagenomes.</p><p id="P24">Repeats were first deduplicated, i.e. clustered at 100% nucleotide identity over 100% of both repeats’ lengths (i.e. identical length), via cd-hit-est<sup><xref ref-type="bibr" rid="R60">60</xref></sup> v4.8.1 (“cd-hit-est -d 0 -c 1 -g 0 -aL 1 -aS 1”), which yielded 870,235 unique repeats (from 5,808,315 total). Next, these unique repeats were clustered at 100% identity but without constraint on repeat length (“cd-hit-est -d 0 -c 1”). In this second round of clustering, for each genus, only one representative sequence per repeat cluster was kept if this representative sequence represented more than 75% of the repeats in this cluster for this genus. This was done in order to identify and remove potentially mispredicted repeats, i.e. repeats identical to other repeats predicted in the same genus but lacking (or having additional) bases on the repeat’s edge. The cutoff of at least 75% of the repeat sequences being strictly identical was used to ensure that a clear consensus sequence was available to be used as representative. After this second round of clustering, a total of 689,554 unique repeats were obtained.</p><p id="P25">To further avoid including repeats (and later spacers) unlikely to be linked to a CRISPR array, the 689,554 unique repeat sequences were further screened for low complexity based on Local Composition Complexity and kmer frequency. Specifically, we used the lcc_simp function from the Bio.SeqUtils.lcc python package and flagged all repeats with lcc value &lt;0.8 as “low complexity”. In addition, we used the kcounter package to get counts of kmers from k=2 to k=8, and flagged repeats based on the frequency of the majority kmer (≥30% at k=2, ≥20% at k=3, ≥5% at k=4, ≥3 at k=5, and ≥2 at k=6, 7, and 8). This procedure identified 107,628 repeats that were filtered out because they were classified as “low complexity”. Finally, all metagenome-derived repeats with a taxonomic assignment to <italic>Eukaryota</italic> or to viruses outside of the <italic>Caudoviricetes</italic> order (see below) were considered as more likely to originate from a repeat region not associated with a CRISPR array, and excluded (n=315). The final curated database of repeats was composed of 581,889 unique repeats (<xref ref-type="supplementary-material" rid="SD1">Supplementary Data File 1</xref>).</p></sec><sec id="S11"><title>CRISPR repeat database: Taxonomic and CRISPR type assignment process</title><p id="P26">Taxonomic annotation of the repeats (GTDB taxonomy version r214) was based on genome taxonomy for detections made in a genome or MAG, or on contig taxonomy otherwise. For each unique repeat, the taxonomic assignment was based on the lowest common ancestor (LCA) of all identical repeats detected in isolate genomes if any, or the LCA of MAG contigs larger than 500kb if any, or the LCA of all MAG contigs. Because of challenges with binning contigs encoding repeated structures such as CRISPR loci, we divided genome-based taxonomy into three different confidence tiers based on the number and type of detections as follows: (i) the taxonomic assignment of repeats found in 4 or more genomes of isolates was considered as “high-confidence” (n=3,073), (ii) the taxonomic assignment of repeats found in 4 or more MAGs or 1 or more isolate was considered as “medium-confidence” (n=18,572), and (iii) the taxonomic assignment of repeats found exclusively in MAGs and in less than 4 genomes was considered as “low-confidence” (n=21,838). Repeats exclusively detected in metagenomes (n=538,406) were classified based on the taxonomic assignment of the corresponding contig in IMG (April 2024), or IMG/VR for contigs predicted to be of viral origin, considering only cases in which this contig classification was based on at least 2 assigned genes, and taking the lowest common ancestor of all classified contigs for repeats identified across multiple datasets. This yielded an additional 66,327 taxonomic assignments of individual repeats to bacterial (n=62,076), archaeal (n=2,987) or phage (<italic>Caudoviricetes,</italic> n=1,264) taxa.</p><p id="P27">In this process, some repeats were assigned to eukaryote (n=11) or other viruses (n=304) and were removed from the final curated database, as mentioned above. The remaining unique repeats (n=472,079) were not assigned to any taxon. The vast majority of these unclassified repeats (94%, n=442,389) were exclusively detected on short metagenomic contigs with 0 or 1 predicted gene, i.e. the contig consisted almost entirely of the putative CRISPR array without any taxonomically-informative region. Finally, each unique repeat was assigned to a predicted CRISPR type based on CRISPRCasTyper<sup><xref ref-type="bibr" rid="R40">40</xref></sup> v1.8.0 (minimum cutoff of 0.8). When multiple copies of a repeat were detected across different datasets, the CRISPR type assignment was based on the repeat selected as representative.</p></sec><sec id="S12"><title>Selection and metadata collection for public metagenomes</title><p id="P28">To identify shotgun metagenomics datasets relevant for CRISPR spacer search, the NCBI SRA database was searched in December 2023 with the following criteria: source field entered as “Metagenomic”; the strategy field was not one of “Amplicon”, “ATAC-seq”, “Bisulfite-Seq”, “ChIP-Seq”, “CLONE”, “CLONEEND”, “CTS”, “Dnase-Hypersensitivity”, “EST”, “FAIRE-seq”, “FINISHING”, “FL-cDNA”, “GBS”, “Hi-C”, “miRNA-Seq”, “ncRNA-Seq”, “POOLCLONE”, “RAD-Seq”, “RIP-Seq”, “RNA-Seq”, “Synthetic-Long-Read”, “Targeted-Capture”, “Tethered Chromatin Conformation Capture”, or “Tn-Seq”; the selection field was one of “other”, “PCR”, “RANDOM”, “RANDOM PCR”, “size fractionation”, or unspecified; and the sequencing platform was one of “BGISEQ” or “ILLUMINA”. Datasets indicated as containing less than 1,000,000 spots or with an average read length lower than 90 in the SRA metadata were excluded, as were datasets that likely underwent whole-genome amplification, such as those mentioning single-cell sorting or MDA, because whole-genome amplification often leads to over-inflated predicted spacer diversity, possibly including erroneous spacers due to amplification errors. Read files from all potential datasets to be mined were then downloaded using Kingfisher<sup><xref ref-type="bibr" rid="R61">61</xref></sup>, and bbcountunique.sh from BBTools 39.03 was used to evaluate the uniqueness of the 25,000 first reads. If the percentage of unique reads in this subset was &lt;20%, the dataset was excluded as either an amplicon dataset or a very low diversity metagenome. The final list of metagenomes used included 467,018 datasets (<xref ref-type="supplementary-material" rid="SD1">Supplementary Data File 2</xref>).</p><p id="P29">The NCBI Entrez API was used to identify the BioSample corresponding to each SRA dataset. Each BioSample was then associated with an ecosystem type using a custom script (“biosample_to_ecosystem.pl”) based on the information provided in the fields DATA_env_broad_scale, DATA_env_local_scale, DATA_env_medium, or DATA_Env_Package, the type of package selected (e.g. “DATA_human gut environmental package”), or keywords in the fields DATA_sample comment, DATA_host, DATA_isolation_source, DATA_Organism, DATA_Descr, or Title. When needed and available, information from the Gold<sup><xref ref-type="bibr" rid="R62">62</xref></sup> and the MGNify<sup><xref ref-type="bibr" rid="R63">63</xref></sup> databases were used to refine the assignment to ecosystem types. This ecosystem information was then aggregated into a simplified classification with 11 ecosystem types: specifically, starting from the detailed classification, ecosystems were ordered based on the number of samples, repeats, and spacers observed, and all ecosystems with &lt;1,500 samples or &lt;10 million spacers were grouped with another ecosystem into a broader category (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>). Ultimately, 431,265 datasets (92%) could be associated with one of these 11 simplified ecosystem types, with the majority (59%) identified as human-associated.</p></sec><sec id="S13"><title>Comparison of the number and taxonomy of CRISPR repeats across ecosystems</title><p id="P30">To compare the number of CRISPR repeats across samples and ecosystems while accounting for differences in sequencing depth, we used a linear regression framework for each ecosystem type. Briefly, for each ecosystem category, the lm function from the stats package in R<sup><xref ref-type="bibr" rid="R64">64</xref></sup> v4.3.3 was used to perform a linear regression with the number of bases in a metagenome as the predictor and the number of distinct repeats detected (considering only high-quality spacers, see above) as the predicted value, and forcing the y-intercept to 0. The slopes obtained were all significantly greater than 0 (p-value &lt;1E-5), and the corresponding model was used to predict a 99% confidence interval for the average number of repeats expected to be observed per 1Gb for each ecosystem. The distribution of taxa encoding CRISPR repeats across ecosystems was based on all repeats for which a genus-level taxonomic assignment could be achieved. For each ecosystem, the total number of repeats from each taxon was tallied, and converted into a frequency by dividing by the total number of repeats with a genus-level assignment observed in this ecosystem. A heatmap was then prepared using the ggplot2<sup><xref ref-type="bibr" rid="R65">65</xref></sup> v3.5.1 R package and including all genera observed with a frequency ≥2% and/or in the top 3 highest frequencies for at least one ecosystem.</p></sec><sec id="S14"><title>Initial detection of potential spacers in metagenomic reads</title><p id="P31">A new approach was designed to identify spacers in metagenomic short-reads data, inspired from CRASS<sup><xref ref-type="bibr" rid="R35">35</xref></sup> and CasCollect<sup><xref ref-type="bibr" rid="R34">34</xref></sup>. This approach relies on a new component of the BBTools toolkit (“bbcrisprfinder.sh”), available starting in BBTools 39.03 (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/bbmap/">https://sourceforge.net/projects/bbmap/</ext-link>). The entire pipeline is available in a single package named “SpacerExtractor” (<ext-link ext-link-type="uri" xlink:href="https://code.jgi.doe.gov/SRoux/spacerextractor">https://code.jgi.doe.gov/SRoux/spacerextractor</ext-link>). The version used in this study corresponds to SpacerExtractor v0.8.</p><p id="P32">The first step in the pipeline identified and extracted potentially relevant reads based on the 581,889 non-redundant CRISPR repeats previously identified (see above) using bbduk.sh (using a fasta file of these repeats as “ref” argument, minimum kmer length of 23, options kfilter = t, maskmiddle = f). Selected reads were then quality-trimmed using bbduk.sh (options ktrim=r, k=23, mink=11, hdist=1, tbo, tpe, minlen=90, ref=adapters, ftm=5, maxns=0, maq=8) and merged if sequenced as paired-end with bbmerge.sh (options mix, nn=t). Next, bbcrisprfinder.sh was used to identify potential “repeat – spacer – repeat” loci in these selected and trimmed reads in two ways: one using the 581,889 non-redundant CRISPR repeats as guides (options k=13, mm=1, minrepeats=2, rmismatches=1, minspacer=20, maxspacer=55, minrepeat=20, maxrepeat=55, bruteforce=t, mintailrepeat=6, rmmt=0, kref=13, mmref=0, maxrefmm=0), the other leveraging the <italic>de novo</italic> detection of “repeat – spacer – repeat” loci from bbcrisprfinder.sh (options k=13, mm=1, minrepeats=2, rmismatches=1, minspacer=20, maxspacer=55, minrepeat=20, maxrepeat=55, bruteforce=t, mintailrepeat=6, rmmt=0). For the <italic>de novo</italic> detection, two rounds of detection were performed, with the second one using the repeat sequences identified in the first <italic>de novo</italic> detection as guides. The results of these two different spacer detection steps were then merged to identify the most likely repeat for each read, with priority given to exact complete repeat (2 full-length repeats, no mismatch) over exact partial repeat (1 full-length repeat and 1 partial repeat) and over non-exact repeats (some mismatch between the two copies of the repeat). If multiple instances of the same repeat were detected on the same read, the quality of this repeat in this read was taken as the highest quality across all repeats, and the total number of predicted “repeat-spacer-repeat” regions was tallied.</p><p id="P33">Eventually, each read was assigned to a single repeat based on (i) number of “repeat-spacer-repeat” regions detected (higher is better), (ii) length of the repeat (higher is better), (iii) quality of the best repeat matches (see above), and (iv) global count of the repeat in the metagenome (higher being better). After linking a read to individual repeats, additional spacers were searched for the same repeat on the read based on the detection of partial repeats on the read’s 5’ and 3’ edges that would have been missed in the first round of detection (minimum of 4bp with no mismatch for considering a partial repeat on a read’s 5’ or 3’ edge). For each metagenome library, this process yielded a list of potential repeats and spacers that were then further refined and quality-checked (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>).</p></sec><sec id="S15"><title>Identification of potentially spurious CRISPR spacers</title><p id="P34">To remove as many spurious spacer detections as possible, potential spacers were first dereplicated for each metagenome library at 100% nucleotide identity using cd-hit-est<sup><xref ref-type="bibr" rid="R60">60</xref></sup> v4.8.1 (options -c 1, -G 0, -aL 1, -aS 1). Next, because the repeats and spacers were detected from individual reads and not used in a consensus assembly, a denoising step similar to the one used for 16S rRNA amplicons in DADA2<sup><xref ref-type="bibr" rid="R66">66</xref></sup> was performed (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). Specifically, the repeats detected in a given library were first denoised to identify cases in which a repeat detection likely derived from a sequencing error based on the presence of a near-identical repeat with much higher coverage in the same library. This was done by calculating an expected number of cases in which a given repeat R1 would be observed instead of another repeat R2 due to sequencing error (assuming an error rate of 0.001), considering only cases in which the overall coverage of R2 is higher than the one of R1. A p-value associated with this expected number of observations under a sequencing error scenario was then calculated based on a Poisson distribution, and a repeat R1 was reclassified as R2 if this p-value was ≥0.05, unless the repeat R1 was a singleton (i.e. observed only in one read) in which case it was reclassified if the number of expected observations was ≥0.05. When reclassifying repeats, all reads on which the original repeat R1 was predicted were then reprocessed to extract new spacer sequences corresponding to R2.</p><p id="P35">Next, a similar approach was used to denoise the spacer sequences predicted for each repeat. For each predicted repeat R1, spacers were compared to each other and a spacer S1 was reclassified as spacer S2 if it was likely to be derived from S2 given expected sequencing errors (p-value ≥0.05, or expected number of observations ≥0.05 for singleton spacers). Finally, potentially erroneous spacers were flagged after denoising based on the following criteria (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>): (i) spacer sequences identified as low quality or low complexity, i.e. a Local Composition Complexity &lt;0.8 as computed with the Bio.SeqUtils lcc_simp function, the presence of an ambiguous base (“N”) in the spacer sequence, or high frequency of a given kmer across the spacer sequence suggestive of a repeat region within the spacer; (ii) detection on the edge of a read, i.e. spacers for which one repeat is partial and &lt;5nt; (iii) spacers with an outlier length compared to other spacers associated with the same repeat in this sample, i.e. with a length either shorter than the first quartile minus 1.5*inter-quartile range, or longer than the third quartile plus 1.5*inter-quartile range, based on the length of all spacers for this repeat in this sample; and (iv) spacers with unexpectedly conserved 5’ or 3’ ends. Spacer conservation is based on deduplicated spacers and computed as follows: for terminal 2-, 3-, and 4-mers, spacer ends were considered as unexpectedly conserved if the most frequent k-mer was found in &gt;50% of deduplicated spacers and with a p-value &lt;1E-5 when calculating the probability of observing this number of identical k-mers at random under a binomial distribution given the size of the kmer and the total number of deduplicated kmers observed. If unexpected spacer end conservation was detected, all spacers associated with this repeat in this sample were ignored. For cases in which identical spacers were associated with multiple repeats in the same metagenome library, the spacer was assigned only to the repeat for which the spacer prediction was the highest quality (i.e. no warning flag), or to multiple repeats if the spacer predictions were of identical quality. Finally, spacers flagged as edge, low-complexity or low-quality, or with unexpected length or conservation patterns, and spacers associated with rare repeats, i.e. repeats for which less than 5 spacers in total were detected in the library (ignoring any spacer flagged with one of the previous warnings), were removed from the final set of spacers predicted for each metagenome.</p></sec><sec id="S16"><title>Evaluation of spacer recovery from simulated metagenomes</title><p id="P36">To evaluate the efficiency and limits of our spacer extraction pipeline, we used a simulation framework similar to Zhang et al. <sup><xref ref-type="bibr" rid="R21">21</xref></sup>. First, 200 high-quality genomes (&lt;20 scaffolds) with at least one predicted CRISPR array were randomly selected from the IMG database<sup><xref ref-type="bibr" rid="R58">58</xref></sup>. CRISPRCas typer<sup><xref ref-type="bibr" rid="R40">40</xref></sup> v1.8.0, default parameters, was used to establish a ground truth of repeats and spacers for these genomes. Next, art_illumina<sup><xref ref-type="bibr" rid="R67">67</xref></sup> v2.5.8 was used to simulate reads from these genomes at 3 different coverage levels (-f parameters set at 0.8, 10, and 100x) and 2 different error profiles (“-ss HS25” and “-ss HS25 -qs 3 -qs2 3”). Other parameters were kept constant (“-p -l 150 -m 200 -s 10”). Three different tools were then used on the simulated reads to predict CRISPR spacers: SpacerExtractor v0.8 (options “-m 0” in “filter_hq_spacers”, high-quality spacers only, default parameters otherwise), Crass<sup><xref ref-type="bibr" rid="R35">35</xref></sup> v1.0.1 (default parameters) and MetaCRAST<sup><xref ref-type="bibr" rid="R33">33</xref></sup> (May 2023 version). For SpacerExtractor, the default repeat database “SE_Db_r214GBIMG_0.9” was used, for MetaCRAST the sequence of repeats predicted by CRISPRCasTyper was provided for each genome, while Crass predicts both repeats and spacers <italic>de novo.</italic> Only repeats present in the SpacerExtractor database were considered in the results, spacers identical (after reverse-complementing if needed) between CRISPRCasTyper and the <italic>de novo</italic> prediction were considered as true positive (TP), spacers predicted for a known repeat but not listed by CRISPRCasTyper were considered as false positive (FP), and spacers listed by CRISPRCasTyper but not predicted were considered as false negative (FN). Recall was calculated as TP divided by TP+FN, false-discovery rate (FDR) as FP divided by FP+TP, and F1 score as 2*TP divided by 2*TP+FP+FN. In addition, another set of metrics was calculated from the <italic>de novo</italic> spacers predicted by SpacerExtractor after ignoring all singleton spacers (coverage=1).</p></sec><sec id="S17"><title>Clustering of spacers and spacer set diversity</title><p id="P37">In order to build a non-redundant database of spacers, the 794,125,610 curated spacers were clustered at 100% identity using a custom python script looking for exact string matches (over the entire length) between two spacers or between a spacer and the reverse-complement of another spacer. To evaluate the sequence similarity of singleton spacers to other spacers in the same sample, cd-hit-est v4.8.1 was used to cluster spacers extracted from each individual sample and each repeat at 95% identity (-c 0.95) and 80% identity (-c 0.80).</p><p id="P38">In order to define spacer sets, a list of all distinct spacers associated with a given repeat was obtained for each sample, and considered as the “spacer set” for this repeat in this sample. Each spacer was associated with an estimated depth of coverage based on the number of reads in which this spacer was identified in the corresponding sample. Based on the observed distribution of spacer relative coverage within sets, two categories of spacers were empirically defined: “common” spacers as spacers with a number of reads ≥50% of the number of reads of the highest coverage spacer (i.e. maximum number of reads) in the set, and “rare” spacers as spacers with a number of reads &lt;5% of the number of reads of the most covered spacer (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). At the spacer set level, we categorized spacer sets as “low” diversity if ≥50% of the spacers in the set were common. Spacer turnover between samples was evaluated by identifying and tallying the number of identical spacers between spacer sets connected to the same repeat. This was done only for repeats associated with ≥10 sets of ≥10 spacers or more and at least one spacer with ≥20x coverage (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). To account for differences in the number of samples in which each repeat is found, the distribution of individual spacers was estimated for a random subset of 10 samples for each set, and the number of samples in which each spacer was observed was tallied. Spacers were considered as “common” if they were considered as common (coverage ≥50% of the maximum spacer coverage in the corresponding spacer set) in at least one sample.</p><p id="P39">Samples originating from individual subjects (for host-associated samples) or individual sampling sites (for environmental samples), were identified based on the corresponding BioSample metadata. Specifically, samples with the same value in the “DATA_host_subject_id” field were considered as coming from the same subject, and samples with the same value in the “DATA_lat_lon” field were considered as coming from the same location. Spacer distribution was evaluated using the same approach as previously described: repeats for which spacer sets including ≥10 spacers with at least one spacer with ≥20x coverage were available for ≥10 different sampling dates (to avoid exact replicates) for an individual subject or location were identified. For each of these sets, a random subset of 10 samples from an individual subject of location was selected, and the number of samples in which each spacer was observed was tallied.</p></sec><sec id="S18"><title>Matching spacers to IMG/VR and IMG/PR sequences</title><p id="P40">Bowtie1 v1.3.1<sup><xref ref-type="bibr" rid="R68">68</xref></sup> was used to identify matches between the 409,584,943 non-redundant spacers and either 5,579,078 IMG/VR v4.1<sup><xref ref-type="bibr" rid="R69">69</xref></sup> high-confidence virus genomes or 699,973 IMG/PR v1 plasmids<sup><xref ref-type="bibr" rid="R70">70</xref></sup>. Specifically, a bowtie1 database was built for IMG/VR v4.1 and IMG/PR v1, and spacers were mapped to each database using Bowtie v1.3.1 with the following options: “ -a -v 3” to report all alignments (“-a”) for a given spacer and report alignments with up to 3 mismatches (“-v 3”) over the whole length of the spacer. The resulting sam file is then parsed to extract the coordinates of each match along with the number of mismatches (from the “NM” tag), the CIGAR string, and the MD string. Individual alignments of spacers to IMG/VR and IMG/PR sequences were further filtered to remove all alignments overlapping with (i) a low complexity region in the target, detected with dustmasker v1.0.0 (package blast 2.5.0)<sup><xref ref-type="bibr" rid="R71">71</xref></sup> with default parameters, or (ii) a region predicted as being a CRISPR array, detected with minced v0.4.2 (default parameters; <ext-link ext-link-type="uri" xlink:href="https://github.com/ctSkennerton/minced">https://github.com/ctSkennerton/minced</ext-link>) and by mapping sequences from the repeat database built in this study using Bowtie v1.3.1.</p><p id="P41">To estimate the number of hits that would be expected from random sequences of a similar length and nucleotide content, we randomly selected a subset of 1 million spacers with at least one hit in IMG/VR, reversed the sequences, and used the same approach as described above to match to IMG/VR. A total of 309 reversed spacers had a hit to an IMG/VR sequence with 0 or 1 mismatch, suggesting a random hit rate of ~ 0.03%.</p><p id="P42">In order to evaluate the connection between CRISPR targeting and virus-host relationships, we identified 233,982 sequences in IMG/VR with “known” hosts, i.e. genomes with a host indicated in the NCBI RefSeq Virus database (n=3,438) or genomes detected as prophages or proviruses in bacterial or archaeal genomes, respectively (n=230,544). For these genomes, we specifically compared the host taxonomy as indicated in NCBI RefSeq Virus or in IMG (for prophages/proviruses) to the taxonomy of the repeat for which spacers targeting this genome were identified, after converting all taxonomies to GTDB r214.</p></sec><sec id="S19"><title>Prediction of protospacer-adjacent motifs (PAM) based on matches to IMG/VR and IMG/PR</title><p id="P43">For all spacer hits identified with 0 or 1 mismatch across both IMG/VR and IMG/PR, the 10-bp regions upstream and downstream of the match were extracted. For each repeat sequence, surrounding regions across all spacer hits were deduplicated such that only 1 copy of the regions were retained when both upstream and downstream 10-bp sequences were identical. Then, the 5-bp regions immediately upstream or downstream of the hit were separately extracted from these deduplicated sets for each repeat, and used as input for <italic>de novo</italic> motif detection with MEME v5.5.5<sup><xref ref-type="bibr" rid="R72">72</xref></sup> with options “-dna -p 12 -minw 5 -maxw 5”, if at least 10 sequences were available. Motifs built from at least 50% of the sequences were retained, and sorted based on the frequency (higher prioritized) or length (for identical frequencies, longer motifs prioritized from a longest possible of 5 bp). The predicted motifs were then curated based on the predicted array type, and assigned as “expected” or “not expected” based on the previous identification of identical motifs for this CRISPR array type in the literature<sup><xref ref-type="bibr" rid="R45">45</xref>,<xref ref-type="bibr" rid="R46">46</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Fig. S12</xref>). Each unique repeat was then assigned the <italic>de novo</italic> predicted PAM (if any) or one of the canonical PAMs for this CRISPR array type (if any) if this motif was detected at the expected position in ≥25% of the deduplicated neighborhood regions. If no candidate motif fulfilled these conditions, no PAM motifs were assigned to this repeat.</p></sec><sec id="S20"><title>Additional annotation, feature prediction, and comparison of IMG/VR genomes</title><p id="P44">Information on virus genomes including original ecosystem and taxonomic assignment were obtained from the IMG/VR v4 database<sup><xref ref-type="bibr" rid="R69">69</xref></sup>. In addition, a lifestyle prediction was performed, as well as identification of putative Diversity-Generating Retroelements (DGRs) and anti-crispr genes (Acr). For lifestyle prediction, we identified all sequences for which the IMG annotation included a gene with a product mentioning “integrase” or “recombinase”, and conducted additional searches against a published database of integrase HMM profiles<sup><xref ref-type="bibr" rid="R73">73</xref></sup> as well as all HMM profiles annotated as integrase in the PHROG<sup><xref ref-type="bibr" rid="R74">74</xref></sup> v4 database (hmmsearch<sup><xref ref-type="bibr" rid="R75">75</xref></sup> v3.3.2, score ≥50 and e-value ≤1.0e-05, default parameters otherwise). All sequences predicted to encode an integrase/recombinase based on one or more of these annotations was predicted as having a “temperate” lifestyle. For DGRs, the approach used in <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/srouxjgi/dgr_scripts/src/master/DGR_identification/">https://bitbucket.org/srouxjgi/dgr_scripts/src/master/DGR_identification/</ext-link><sup><xref ref-type="bibr" rid="R76">76</xref></sup> was used, with a detection of putative DGR reverse-transcriptase based on a collection of HMM profiles (hmmsearch<sup><xref ref-type="bibr" rid="R75">75</xref></sup> v3.3.2, score ≥50 and e-value ≤1.0e-05, default parameters otherwise) followed by a custom script to detect likely DGRs based on the presence of a nearby TR-VR structure. Finally, anti-CRISPR genes were searched based on the APIS database<sup><xref ref-type="bibr" rid="R77">77</xref></sup> (June 2024) using diamond<sup><xref ref-type="bibr" rid="R78">78</xref></sup> v2.1.8 (“--max-target-seqs 999999999”, score ≥50, e-value≤1e-05, minimum coverage of 80% for query and target, default parameters otherwise) and hmmsearch<sup><xref ref-type="bibr" rid="R75">75</xref></sup> v3.3.2 (minimum score of 50 and maximum e-value 1.0e-05, default parameters otherwise).</p><p id="P45">To compare the functional annotation of targeted and untargeted regions in viruses, subsamples of 1,000,000 spacers matching a single vOTU and 1,000,000 spacers matching multiple vOTUs were selected. For the corresponding targets, the predicted cds overlapping the spacer hits were extracted from the IMG annotation, and annotated with the PHROG<sup><xref ref-type="bibr" rid="R74">74</xref></sup> v4 database using MMseqs2<sup><xref ref-type="bibr" rid="R79">79</xref></sup> version 14.7e284 (easy-search function, score ≥50, e-value ≤1e-05, default parameters otherwise). Genes were considered as functionally annotated if they showed one or more hits against the PHROG database.</p><p id="P46">To evaluate the similarity between sequences targeted by the same spacer, a set of 2,000,000 spacers matching multiple high-quality virus genomes was randomly selected, and genomes targeted by each spacer were compared all-vs-all using lz-ani<sup><xref ref-type="bibr" rid="R80">80</xref></sup> v1.0.1 (all2all function, default parameters). For each spacer, the largest distance (i.e. 1 - gani) between a pair of high-quality virus genomes was taken as the maximum distance between targets for this spacer.</p></sec><sec id="S21"><title>Definition of targeting patterns and identification of associated viral features</title><p id="P47">For IMG/VR matches, patterns of spacer targeting (i.e. number of spacers matching a target, percentage of target covered, number of spacer hits for different number of mismatches between spacer and target, and targeting by prokaryotic host taxon) were calculated for prokaryotic viruses only. Specifically, only genomes assigned to <italic>Tokiviricetes, Caudoviricetes, Faserviricetes, Malgrandaviricetes, Huolimaviricetes, Leviviricetes, Tectiliviricetes,</italic> or <italic>Laserviricetes</italic> classes were considered for these analyses, except sequences assigned to the <italic>Rowavirales</italic> order (i.e. adenoviruses) that were specifically excluded as this taxon contains eukaryotic viruses within the <italic>Tectiliviricetes</italic> class of bacteriophages and archaeoviruses.</p><p id="P48">To evaluate the level of targeting of individual viruses by individual CRISPR repeats, we analyzed the collection of spacer hits based on all spacers collected across all samples for a given repeat to a given virus genome. The total virus genome coverage by spacers was calculated as the number of positions to which at least 1 spacer from this repeat had a hit with 0 or 1 mismatch, divided by the total length of the virus genome. Targeting level was defined as low if &lt;10 spacers connect a repeat to a virus, high if spacers cover ≥1kb or ≥10% of the viral genome (for high-quality genomes), and medium otherwise (≥10 spacers but &lt;1kb covered, and &lt;10% genome coverage for high-quality genomes).</p><p id="P49">For virus-repeat pairs including ≥10 spacer hits with 0 or 1 mismatch and for which the virus genome is of “high-quality” (i.e. ≥90% completeness), the spacer hits with 2 or 3 mismatches were extracted from the same Bowtie1 mapping (see above) and tallied to be compared with the number of spacers matching the same virus genome with 0 or 1 mismatch. To summarize these mismatch profiles and identify cases in which the number of matches either systematically increased or decreased with the number of mismatches, we computed linear regression between the two metrics (number of mismatches between spacer and virus, and number of observations for a given virus-repeat pair), and considered this relationship to be positively correlated if ≥0.7, and negatively correlated if ≤-0.7.</p><p id="P50">A Random Forest approach was used to identify features potentially associated with the level of targeting of a virus (“high”, “medium”, or “low”) or the mismatch patterns (“mostly near-exact matches” i.e. correlation ≤-0.7, or “mostly distant matches” i.e. correlation ≥0.7). Specifically we used the randomForest package (<ext-link ext-link-type="uri" xlink:href="https://rdocumentation.org/packages/randomForest/">https://rdocumentation.org/packages/randomForest/</ext-link>) v4.7-1.2 to train classifiers to predict the mismatch profile (positive, negative, or unknown) of a given virus-repeat pair based on the following features: ecosystem classification of the assembled virus either using the 11-ecosystem classification or a simplified version separating human-associated from non-human-associated microbiomes, the predicted lifestyle (temperate, virulent, or chronic) of the virus, the presence of multiple tail fiber genes in the virus genome (yes or no), the presence of an anti-CRISPR gene in the virus genome (yes or no), the presence of a DGR in the virus genome (yes or no, see “Additional annotation…” above for more information about how these features were predicted), the length of the virus genome (in bp), the taxonomic assignment of the virus genome (class rank), and the taxonomic assignment of the repeat (class rank). The function “randomForest” was used to train the Random Forest classifier (with option “proximity=FALSE”, default parameters otherwise), leading to a predictor with an 18.33% out-of-bag error rate. For this classifier, feature importance was evaluated based on the mean decrease in Gini index returned by the randomForest function, and highlighted the presence of DGR as the main predictor (mean Gini decrease of 57,818.4, compared to 12,747.55 and 10,286.85 for the second and third-ranked predictors).</p></sec><sec id="S22"><title>Analysis of targeting patterns for viruses with potentially broad host range</title><p id="P51">When exploring the taxonomic range of CRISPR repeats targeting individual viruses, only repeats with a taxonomic assignment of medium-confidence or high-confidence were used (see “<xref ref-type="sec" rid="S11">CRISPR repeat database: Taxonomic and CRISPR type assignment process</xref>” above). Next, virus sequences from two previous studies<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup> that highlighted potential broad range targeting were re-analyzed using this set of taxonomically assigned spacers. The sequences of 547 and 13,404 viruses, respectively, were collected and spacer mapping using the same bowtie1-based approach was performed for the same non-redundant set of spacers (see above). Spacer hits were collated using the same approach as previously described to calculate overall coverage and mismatch profile for each virus-taxon pair.</p><p id="P52">For virus-taxon network representation, two selection criteria were applied. First, the specific virus sequences that had been previously highlighted as targeted by multiple phyla<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup> were selected and included in the virustaxon network if also connected to multiple phyla based on hits from the global spacer database (panel C of <xref ref-type="fig" rid="F5">Fig. 5</xref>). Next, virus sequences from the George et al. dataset<sup><xref ref-type="bibr" rid="R37">37</xref></sup> not already included in panel C but connected to repeats from different phyla with 10 or more hits based on the new global spacer database were included in a separate network (panel D of <xref ref-type="fig" rid="F5">Fig. 5</xref>). In both cases, Cytoscape<sup><xref ref-type="bibr" rid="R81">81</xref></sup> 3.10.1 was used to display the networks.</p></sec><sec id="S23"><title>Visualization and statistical tests</title><p id="P53">All visualization and statistical tests were performed using the R software, version 4.3.3 (2024-02-29), except for the networks which were displayed with Cytoscape version 3.10.1.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS206473-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d47aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S24"><title>Acknowledgments</title><p>The work conducted by the U.S. Department of Energy Joint Genome Institute (<ext-link ext-link-type="uri" xlink:href="https://ror.org/04xm1d337">https://ror.org/04xm1d337</ext-link>), a DOE Office of Science User Facility, is supported by the Office of Science of the U.S. Department of Energy operated under Contract No. DE-AC02-05CH11231. Some of this work was supported by the U.S. Department of Energy, Office of Science, Biological and Environmental Research, Early Career Research Program (SR) awarded under UC-DOE Prime Contract DE-AC02-05CH11231. Some of this work was supported by the Canadian National Science and Engineering Research Council Discovery Grant 2016-03686. LAH was supported by a Canada Research Chair. UG was funded by the European Research Council (grant ERC-AdG 787514).</p></ack><sec id="S25" sec-type="data-availability"><title>Data availability</title><p id="P54">Raw data used for this study are available at <ext-link ext-link-type="uri" xlink:href="https://portal.nersc.gov/dna/microbial/prokpubs/spacer_database_resources/">https://portal.nersc.gov/dna/microbial/prokpubs/spacer_database_resources/</ext-link>, and from NCBI SRA using accession numbers listed in the file “ Supplementary_Data_File_2_samples.tsv”. Access to the spacer database including spacer information and spacer hits against IMG/VR and IMG/PR is documented at <ext-link ext-link-type="uri" xlink:href="https://spacers.jgi.doe.gov">https://spacers.jgi.doe.gov</ext-link>. This companion website also includes notebooks and examples illustrating how to explore and interact with the spacer database, as well as direct links to download the entire database.</p></sec><sec id="S26" sec-type="data-availability"><title>Code availability</title><p id="P55">The main tool used to identify CRISPR spacers in metagenomes, SpacerExtractor, is available at <ext-link ext-link-type="uri" xlink:href="https://code.jgi.doe.gov/SRoux/spacerextractor">https://code.jgi.doe.gov/SRoux/spacerextractor</ext-link> and as a package on bioconda (<ext-link ext-link-type="uri" xlink:href="https://bioconda.github.io/recipes/spacerextractor/README.html">https://bioconda.github.io/recipes/spacerextractor/README.html</ext-link>). Additional new scripts used to conduct the analysis and prepare figures for this study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/simroux/globalspacers_scripts">https://github.com/simroux/globalspacers_scripts</ext-link>.</p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Falkowski</surname><given-names>PG</given-names></name><name><surname>Fenchel</surname><given-names>T</given-names></name><name><surname>Delong</surname><given-names>EF</given-names></name></person-group><article-title>The Microbial Engines That Drive Earth’s Biogeochemical Cycles</article-title><source>Science</source><year>2008</year><volume>320</volume><fpage>1034</fpage><lpage>1039</lpage><pub-id pub-id-type="pmid">18497287</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>JA</given-names></name><etal/></person-group><article-title>Current understanding of the human microbiome</article-title><source>Nat Med</source><year>2018</year><volume>24</volume><fpage>392</fpage><lpage>400</lpage><pub-id pub-id-type="pmcid">PMC7043356</pub-id><pub-id pub-id-type="pmid">29634682</pub-id><pub-id pub-id-type="doi">10.1038/nm.4517</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macalady</surname><given-names>JL</given-names></name><etal/></person-group><article-title>Energy, ecology and the distribution of microbial life</article-title><source>Phil Trans R Soc B</source><year>2013</year><pub-id pub-id-type="pmcid">PMC3685468</pub-id><pub-id pub-id-type="pmid">23754819</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2012.0383</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname><given-names>SA</given-names></name><name><surname>Diggle</surname><given-names>SP</given-names></name><name><surname>Buckling</surname><given-names>A</given-names></name><name><surname>Gardner</surname><given-names>A</given-names></name><name><surname>Griffin</surname><given-names>AS</given-names></name></person-group><article-title>The Social Lives of Microbes</article-title><source>Annu Rev Ecol Evol Syst</source><year>2007</year><volume>38</volume><fpage>53</fpage><lpage>77</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottery</surname><given-names>MJ</given-names></name></person-group><article-title>Ecological dynamics of plasmid transfer and persistence in microbial communities</article-title><source>Current Opinion in Microbiology</source><year>2022</year><volume>68</volume><elocation-id>102152</elocation-id><pub-id pub-id-type="pmcid">PMC9586876</pub-id><pub-id pub-id-type="pmid">35504055</pub-id><pub-id pub-id-type="doi">10.1016/j.mib.2022.102152</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitbart</surname><given-names>M</given-names></name><name><surname>Bonnain</surname><given-names>C</given-names></name><name><surname>Malki</surname><given-names>K</given-names></name><name><surname>Sawaya</surname><given-names>NA</given-names></name></person-group><article-title>Phage puppet masters of the marine microbial realm</article-title><source>Nat Microbiol</source><year>2018</year><volume>3</volume><fpage>754</fpage><lpage>766</lpage><pub-id pub-id-type="pmid">29867096</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shkoporov</surname><given-names>AN</given-names></name><name><surname>Hill</surname><given-names>C</given-names></name></person-group><article-title>Bacteriophages of the Human Gut: The “Known Unknown” of the Microbiome</article-title><source>Cell Host &amp; Microbe</source><year>2019</year><volume>25</volume><fpage>195</fpage><lpage>209</lpage><pub-id pub-id-type="pmid">30763534</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williamson</surname><given-names>KE</given-names></name><name><surname>Fuhrmann</surname><given-names>JJ</given-names></name><name><surname>Wommack</surname><given-names>KE</given-names></name><name><surname>Radosevich</surname><given-names>M</given-names></name></person-group><article-title>Viruses in Soil Ecosystems: An Unknown Quantity Within an Unexplored Territory</article-title><source>Annu Rev Virol</source><year>2017</year><volume>4</volume><fpage>201</fpage><lpage>219</lpage><pub-id pub-id-type="pmid">28961409</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makarova</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Evolutionary classification of CRISPR–Cas systems: a burst of class 2 and derived variants</article-title><source>Nat Rev Microbiol</source><year>2020</year><volume>18</volume><fpage>67</fpage><lpage>83</lpage><pub-id pub-id-type="pmcid">PMC8905525</pub-id><pub-id pub-id-type="pmid">31857715</pub-id><pub-id pub-id-type="doi">10.1038/s41579-019-0299-x</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Horvath</surname><given-names>P</given-names></name></person-group><article-title>A decade of discovery: CRISPR functions and applications</article-title><source>Nat Microbiol</source><year>2017</year><volume>2</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">28581505</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doudna</surname><given-names>JA</given-names></name><name><surname>Charpentier</surname><given-names>E</given-names></name></person-group><article-title>The new frontier of genome engineering with CRISPR-Cas9</article-title><source>Science</source><year>2014</year><volume>346</volume><elocation-id>1258096</elocation-id><pub-id pub-id-type="pmid">25430774</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>JY</given-names></name><name><surname>Doudna</surname><given-names>JA</given-names></name></person-group><article-title>CRISPR technology: A decade of genome editing is only the beginning</article-title><source>Science</source><year>2023</year><volume>379</volume><elocation-id>eadd8643</elocation-id><pub-id pub-id-type="pmid">36656942</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amitai</surname><given-names>G</given-names></name><name><surname>Sorek</surname><given-names>R</given-names></name></person-group><article-title>CRISPR–Cas adaptation: insights into the mechanism of action</article-title><source>Nat Rev Microbiol</source><year>2016</year><volume>14</volume><fpage>67</fpage><lpage>76</lpage><pub-id pub-id-type="pmid">26751509</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrangou</surname><given-names>R</given-names></name><etal/></person-group><article-title>CRISPR Provides Acquired Resistance Against Viruses in Prokaryotes</article-title><source>Science</source><year>2007</year><volume>315</volume><fpage>1709</fpage><lpage>1712</lpage><pub-id pub-id-type="pmid">17379808</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deveau</surname><given-names>H</given-names></name><name><surname>Garneau</surname><given-names>JE</given-names></name><name><surname>Moineau</surname><given-names>S</given-names></name></person-group><article-title>CRISPR/Cas System and Its Role in Phage-Bacteria Interactions</article-title><source>Annu Rev Microbiol</source><year>2010</year><volume>64</volume><fpage>475</fpage><lpage>493</lpage><pub-id pub-id-type="pmid">20528693</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>Dowling</surname><given-names>AJ</given-names></name><name><surname>Broniewski</surname><given-names>JM</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name></person-group><article-title>Evolution and Ecology of CRISPR</article-title><source>Annu Rev Ecol Evol Syst</source><year>2016</year><volume>47</volume><fpage>307</fpage><lpage>331</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fehrenbach</surname><given-names>A</given-names></name><name><surname>Mitrofanov</surname><given-names>A</given-names></name><name><surname>Alkhnbashi</surname><given-names>OS</given-names></name><name><surname>Backofen</surname><given-names>R</given-names></name><name><surname>Baumdicker</surname><given-names>F</given-names></name></person-group><article-title>SpacerPlacer: ancestral reconstruction of CRISPR arrays reveals the evolutionary dynamics of spacer deletions</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><fpage>10862</fpage><lpage>10878</lpage><pub-id pub-id-type="pmcid">PMC11472070</pub-id><pub-id pub-id-type="pmid">39268572</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkae772</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrett</surname><given-names>SC</given-names></name></person-group><article-title>Pruning and Tending Immune Memories: Spacer Dynamics in the CRISPR Array</article-title><source>Front Microbiol</source><year>2021</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC8047081</pub-id><pub-id pub-id-type="pmid">33868219</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2021.664299</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pawluk</surname><given-names>A</given-names></name><name><surname>Davidson</surname><given-names>AR</given-names></name><name><surname>Maxwell</surname><given-names>KL</given-names></name></person-group><article-title>Anti-CRISPR: discovery, mechanism and function</article-title><source>Nat Rev Microbiol</source><year>2018</year><volume>16</volume><fpage>12</fpage><lpage>17</lpage><pub-id pub-id-type="pmid">29062071</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watson</surname><given-names>BNJ</given-names></name><name><surname>Steens</surname><given-names>JA</given-names></name><name><surname>Staals</surname><given-names>RHJ</given-names></name><name><surname>Westra</surname><given-names>ER</given-names></name><name><surname>van Houte</surname><given-names>S</given-names></name></person-group><article-title>Coevolution between bacterial CRISPR-Cas systems and their bacteriophages</article-title><source>Cell Host &amp; Microbe</source><year>2021</year><volume>29</volume><fpage>715</fpage><lpage>725</lpage><pub-id pub-id-type="pmid">33984274</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>A-N</given-names></name><etal/></person-group><article-title>CRISPR-Cas spacer acquisition is a rare event in human gut microbiome</article-title><source>Cell Genomics</source><year>2024</year><comment>0</comment><pub-id pub-id-type="pmcid">PMC11770219</pub-id><pub-id pub-id-type="pmid">39719706</pub-id><pub-id pub-id-type="doi">10.1016/j.xgen.2024.100725</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>AF</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><article-title>Virus Population Dynamics and Acquired Virus Resistance in Natural Microbial Communities</article-title><source>Science</source><year>2008</year><volume>320</volume><fpage>1047</fpage><lpage>1050</lpage><pub-id pub-id-type="pmid">18497291</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burstein</surname><given-names>D</given-names></name><etal/></person-group><article-title>Major bacterial lineages are essentially devoid of CRISPR-Cas viral defence systems</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><elocation-id>10613</elocation-id><pub-id pub-id-type="pmcid">PMC4742961</pub-id><pub-id pub-id-type="pmid">26837824</pub-id><pub-id pub-id-type="doi">10.1038/ncomms10613</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emerson</surname><given-names>JB</given-names></name><etal/></person-group><article-title>Virus-Host and CRISPR Dynamics in Archaea-Dominated Hypersaline Lake Tyrrell, Victoria, Australia</article-title><source>Archaea</source><year>2013</year><volume>2013</volume><pub-id pub-id-type="pmcid">PMC3703381</pub-id><pub-id pub-id-type="pmid">23853523</pub-id><pub-id pub-id-type="doi">10.1155/2013/370871</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>England</surname><given-names>WE</given-names></name><name><surname>Kim</surname><given-names>T</given-names></name><name><surname>Whitaker</surname><given-names>RJ</given-names></name></person-group><article-title>Metapopulation Structure of CRISPR-Cas Immunity in Pseudomonas aeruginosa and Its Viruses</article-title><source>mSystems</source><year>2018</year><volume>3</volume><pub-id pub-id-type="pmcid">PMC6199469</pub-id><pub-id pub-id-type="pmid">30374457</pub-id><pub-id pub-id-type="doi">10.1128/mSystems.00075-18</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>CL</given-names></name><name><surname>Thomas</surname><given-names>BC</given-names></name><name><surname>Barrangou</surname><given-names>R</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><article-title>Metagenomic reconstructions of bacterial CRISPR loci constrain population histories</article-title><source>ISME J</source><year>2016</year><volume>10</volume><fpage>858</fpage><lpage>870</lpage><pub-id pub-id-type="pmcid">PMC4796926</pub-id><pub-id pub-id-type="pmid">26394009</pub-id><pub-id pub-id-type="doi">10.1038/ismej.2015.162</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amundson</surname><given-names>KK</given-names></name><name><surname>Roux</surname><given-names>S</given-names></name><name><surname>Shelton</surname><given-names>JL</given-names></name><name><surname>Wilkins</surname><given-names>MJ</given-names></name></person-group><article-title>Long-term CRISPR locus dynamics and stable host-virus co-existence in subsurface fractured shales</article-title><source>Current Biology</source><year>2023</year><volume>33</volume><fpage>3125</fpage><lpage>3135</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmid">37402375</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emerson</surname><given-names>JB</given-names></name><etal/></person-group><article-title>Host-linked soil viral ecology along a permafrost thaw gradient</article-title><source>Nat Microbiol</source><year>2018</year><volume>3</volume><fpage>870</fpage><lpage>880</lpage><pub-id pub-id-type="pmcid">PMC6786970</pub-id><pub-id pub-id-type="pmid">30013236</pub-id><pub-id pub-id-type="doi">10.1038/s41564-018-0190-y</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosmopoulos</surname><given-names>JC</given-names></name><name><surname>Campbell</surname><given-names>DE</given-names></name><name><surname>Whitaker</surname><given-names>RJ</given-names></name><name><surname>Wilbanks</surname><given-names>EG</given-names></name></person-group><article-title>Horizontal Gene Transfer and CRISPR Targeting Drive Phage-Bacterial Host Interactions and Coevolution in “Pink Berry” Marine Microbial Aggregates</article-title><source>Appl Environ Microbiol</source><year>2023</year><volume>89</volume><elocation-id>e00177-23</elocation-id><pub-id pub-id-type="pmcid">PMC10370329</pub-id><pub-id pub-id-type="pmid">37404190</pub-id><pub-id pub-id-type="doi">10.1128/aem.00177-23</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>López-Beltrán</surname><given-names>A</given-names></name><name><surname>Botelho</surname><given-names>J</given-names></name><name><surname>Iranzo</surname><given-names>J</given-names></name></person-group><article-title>Dynamics of CRISPR-mediated virus–host interactions in the human gut microbiome</article-title><source>ISME J</source><year>2024</year><volume>18</volume><elocation-id>wrae134</elocation-id><pub-id pub-id-type="pmcid">PMC11307328</pub-id><pub-id pub-id-type="pmid">39023219</pub-id><pub-id pub-id-type="doi">10.1093/ismejo/wrae134</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>AR</given-names></name><etal/></person-group><article-title>Wildfire-dependent changes in soil microbiome diversity and function</article-title><source>Nat Microbiol</source><year>2022</year><volume>7</volume><fpage>1419</fpage><lpage>1430</lpage><pub-id pub-id-type="pmcid">PMC9418001</pub-id><pub-id pub-id-type="pmid">36008619</pub-id><pub-id pub-id-type="doi">10.1038/s41564-022-01203-y</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name></person-group><article-title>Assemble CRISPRs from metagenomic sequencing data</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>i520</fpage><lpage>i528</lpage><pub-id pub-id-type="pmid">27587670</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moller</surname><given-names>AG</given-names></name><name><surname>Liang</surname><given-names>C</given-names></name></person-group><article-title>MetaCRAST: reference-guided extraction of CRISPR spacers from unassembled metagenomes</article-title><source>PeerJ</source><year>2017</year><volume>5</volume><elocation-id>e3788</elocation-id><pub-id pub-id-type="pmcid">PMC5592083</pub-id><pub-id pub-id-type="pmid">28894651</pub-id><pub-id pub-id-type="doi">10.7717/peerj.3788</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Podlevsky</surname><given-names>JD</given-names></name><name><surname>Hudson</surname><given-names>CM</given-names></name><name><surname>Timlin</surname><given-names>JA</given-names></name><name><surname>Williams</surname><given-names>KP</given-names></name></person-group><article-title>CasCollect: Targeted assembly of CRISPR-associated operons from high-throughput sequencing data</article-title><source>NAR Genomics and Bioinformatics</source><year>2020</year><volume>2</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmcid">PMC7671303</pub-id><pub-id pub-id-type="pmid">33575613</pub-id><pub-id pub-id-type="doi">10.1093/nargab/lqaa063</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skennerton</surname><given-names>CT</given-names></name><name><surname>Imelfort</surname><given-names>M</given-names></name><name><surname>Tyson</surname><given-names>GW</given-names></name></person-group><article-title>Crass: identification and reconstruction of CRISPR from unassembled metagenomic data</article-title><source>Nucleic acids research</source><year>2013</year><volume>41</volume><fpage>e105</fpage><pub-id pub-id-type="pmcid">PMC3664793</pub-id><pub-id pub-id-type="pmid">23511966</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkt183</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silas</surname><given-names>S</given-names></name><etal/></person-group><article-title>On the origin of reverse transcriptase-using CRISPR-Cas systems and their hyperdiverse, enigmatic spacer repertoires</article-title><source>mBio</source><year>2017</year><volume>8</volume><pub-id pub-id-type="pmcid">PMC5513706</pub-id><pub-id pub-id-type="pmid">28698278</pub-id><pub-id pub-id-type="doi">10.1128/mBio.00897-17</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>George</surname><given-names>NA</given-names></name><name><surname>Hug</surname><given-names>LA</given-names></name></person-group><article-title>CRISPR-resolved virus-host interactions in a municipal landfill include non-specific viruses, hyper-targeted viral populations, and interviral conflicts</article-title><source>Sci Rep</source><year>2023</year><volume>13</volume><fpage>5611</fpage><pub-id pub-id-type="pmcid">PMC10076291</pub-id><pub-id pub-id-type="pmid">37019939</pub-id><pub-id pub-id-type="doi">10.1038/s41598-023-32078-6</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>Y</given-names></name><name><surname>Roux</surname><given-names>S</given-names></name><name><surname>Coclet</surname><given-names>C</given-names></name><name><surname>Krause</surname><given-names>SJE</given-names></name><name><surname>Girguis</surname><given-names>PR</given-names></name></person-group><article-title>Viruses interact with hosts that span distantly related microbial domains in dense hydrothermal mats</article-title><source>Nat Microbiol</source><year>2023</year><volume>8</volume><fpage>946</fpage><lpage>957</lpage><pub-id pub-id-type="pmcid">PMC10159854</pub-id><pub-id pub-id-type="pmid">37024618</pub-id><pub-id pub-id-type="doi">10.1038/s41564-023-01347-5</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Jaffe</surname><given-names>AL</given-names></name><name><surname>Chen</surname><given-names>L</given-names></name><name><surname>Bor</surname><given-names>B</given-names></name><name><surname>Banfield</surname><given-names>JF</given-names></name></person-group><article-title>Host translation machinery is not a barrier to phages that interact with both CPR and non-CPR bacteria</article-title><source>mBio</source><year>2023</year><volume>14</volume><elocation-id>e01766-23</elocation-id><pub-id pub-id-type="pmcid">PMC10746230</pub-id><pub-id pub-id-type="pmid">38009957</pub-id><pub-id pub-id-type="doi">10.1128/mbio.01766-23</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russel</surname><given-names>J</given-names></name><name><surname>Pinilla-Redondo</surname><given-names>R</given-names></name><name><surname>Mayo-Muñoz</surname><given-names>D</given-names></name><name><surname>Shah</surname><given-names>SA</given-names></name><name><surname>Sørensen</surname><given-names>SJ</given-names></name></person-group><article-title>CRISPRCasTyper: Automated Identification, Annotation, and Classification of CRISPR-Cas Loci</article-title><source>The CRISPR Journal</source><year>2020</year><volume>3</volume><fpage>462</fpage><lpage>469</lpage><pub-id pub-id-type="pmid">33275853</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arita</surname><given-names>M</given-names></name><name><surname>Karsch-Mizrachi</surname><given-names>I</given-names></name><name><surname>Cochrane</surname><given-names>G</given-names></name><collab>on behalf of the International Nucleotide Sequence Database Collaboration</collab></person-group><article-title>The international nucleotide sequence database collaboration</article-title><source>Nucleic Acids Research</source><year>2021</year><volume>49</volume><fpage>D121</fpage><lpage>D124</lpage><pub-id pub-id-type="pmcid">PMC7778961</pub-id><pub-id pub-id-type="pmid">33166387</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkaa967</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daly</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Viruses control dominant bacteria colonizing the terrestrial deep biosphere after hydraulic fracturing</article-title><source>Nat Microbiol</source><year>2019</year><volume>4</volume><fpage>352</fpage><lpage>361</lpage><pub-id pub-id-type="pmid">30510171</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>RS</given-names></name><etal/></person-group><article-title>Stability of the human faecal microbiome in a cohort of adult men</article-title><source>Nat Microbiol</source><year>2018</year><volume>3</volume><fpage>347</fpage><lpage>355</lpage><pub-id pub-id-type="pmcid">PMC6016839</pub-id><pub-id pub-id-type="pmid">29335554</pub-id><pub-id pub-id-type="doi">10.1038/s41564-017-0096-0</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mick</surname><given-names>E</given-names></name><name><surname>Stern</surname><given-names>A</given-names></name><name><surname>Sorek</surname><given-names>R</given-names></name></person-group><article-title>Holding a grudge: Persisting anti-phage CRISPR immunity in multiple human gut microbiomes</article-title><source>RNA Biology</source><year>2013</year><volume>10</volume><fpage>900</fpage><lpage>906</lpage><pub-id pub-id-type="pmcid">PMC3737347</pub-id><pub-id pub-id-type="pmid">23439321</pub-id><pub-id pub-id-type="doi">10.4161/rna.23929</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leenay</surname><given-names>RT</given-names></name><etal/></person-group><article-title>Identifying and Visualizing Functional PAM Diversity across CRISPR-Cas Systems</article-title><source>Molecular Cell</source><year>2016</year><volume>62</volume><fpage>137</fpage><lpage>147</lpage><pub-id pub-id-type="pmcid">PMC4826307</pub-id><pub-id pub-id-type="pmid">27041224</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2016.02.031</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rybnicky</surname><given-names>GA</given-names></name><name><surname>Fackler</surname><given-names>NA</given-names></name><name><surname>Karim</surname><given-names>AS</given-names></name><name><surname>Köpke</surname><given-names>M</given-names></name><name><surname>Jewett</surname><given-names>MC</given-names></name></person-group><article-title>Spacer2PAM: A computational framework to guide experimental determination of functional CRISPR-Cas system PAM sequences</article-title><source>Nucleic Acids Research</source><year>2022</year><volume>50</volume><fpage>3523</fpage><lpage>3534</lpage><pub-id pub-id-type="pmcid">PMC8990532</pub-id><pub-id pub-id-type="pmid">35258601</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac142</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicholson</surname><given-names>TJ</given-names></name><etal/></person-group><article-title>Bioinformatic evidence of widespread priming in type I and II CRISPR-Cas systems</article-title><source>RNA Biology</source><year>2019</year><volume>16</volume><fpage>566</fpage><lpage>576</lpage><pub-id pub-id-type="pmcid">PMC6546363</pub-id><pub-id pub-id-type="pmid">30157725</pub-id><pub-id pub-id-type="doi">10.1080/15476286.2018.1509662</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hossain</surname><given-names>AA</given-names></name><name><surname>McGinn</surname><given-names>J</given-names></name><name><surname>Meeske</surname><given-names>AJ</given-names></name><name><surname>Modell</surname><given-names>JW</given-names></name><name><surname>Marraffini</surname><given-names>LA</given-names></name></person-group><article-title>Viral recombination systems limit CRISPR-Cas targeting through the generation of escape mutations</article-title><source>Cell Host &amp; Microbe</source><year>2021</year><volume>29</volume><fpage>1482</fpage><lpage>1495</lpage><elocation-id>e12</elocation-id><pub-id pub-id-type="pmcid">PMC8516739</pub-id><pub-id pub-id-type="pmid">34582782</pub-id><pub-id pub-id-type="doi">10.1016/j.chom.2021.09.001</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malone</surname><given-names>LM</given-names></name><name><surname>Birkholz</surname><given-names>N</given-names></name><name><surname>Fineran</surname><given-names>PC</given-names></name></person-group><article-title>Conquering CRISPR: how phages overcome bacterial adaptive immunity</article-title><source>Current Opinion in Biotechnology</source><year>2021</year><volume>68</volume><fpage>30</fpage><lpage>36</lpage><pub-id pub-id-type="pmid">33113496</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>CL</given-names></name><etal/></person-group><article-title>Phage mutations in response to CRISPR diversification in a bacterial population</article-title><source>Environmental Microbiology</source><year>2013</year><volume>15</volume><fpage>463</fpage><lpage>470</lpage><pub-id pub-id-type="pmid">23057534</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macadangdang</surname><given-names>BR</given-names></name><name><surname>Makanani</surname><given-names>SK</given-names></name><name><surname>Miller</surname><given-names>JF</given-names></name></person-group><article-title>Accelerated Evolution by Diversity-Generating Retroelements</article-title><source>Annu Rev Microbiol</source><year>2022</year><volume>76</volume><fpage>389</fpage><lpage>411</lpage><pub-id pub-id-type="pmid">35650669</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nayfach</surname><given-names>S</given-names></name><etal/></person-group><article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title><source>Nat Microbiol</source><year>2021</year><volume>6</volume><fpage>960</fpage><lpage>970</lpage><pub-id pub-id-type="pmcid">PMC8241571</pub-id><pub-id pub-id-type="pmid">34168315</pub-id><pub-id pub-id-type="doi">10.1038/s41564-021-00928-6</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turgeman-Grott</surname><given-names>I</given-names></name><etal/></person-group><article-title>Pervasive acquisition of CRISPR memory driven by inter-species mating of archaea can limit gene transfer and influence speciation</article-title><source>Nat Microbiol</source><year>2019</year><volume>4</volume><fpage>177</fpage><lpage>186</lpage><pub-id pub-id-type="pmcid">PMC6298592</pub-id><pub-id pub-id-type="pmid">30478289</pub-id><pub-id pub-id-type="doi">10.1038/s41564-018-0302-8</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makarova</surname><given-names>KS</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><article-title><italic>In Silico</italic> Approaches for Prediction of Anti-CRISPR Proteins</article-title><source>Journal of Molecular Biology</source><year>2023</year><volume>435</volume><elocation-id>168036</elocation-id><pub-id pub-id-type="pmcid">PMC10073340</pub-id><pub-id pub-id-type="pmid">36868398</pub-id><pub-id pub-id-type="doi">10.1016/j.jmb.2023.168036</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samuel</surname><given-names>B</given-names></name><name><surname>Mittelman</surname><given-names>K</given-names></name><name><surname>Croitoru</surname><given-names>SY</given-names></name><name><surname>Ben Haim</surname><given-names>M</given-names></name><name><surname>Burstein</surname><given-names>D</given-names></name></person-group><article-title>Diverse anti-defence systems are encoded in the leading region of plasmids</article-title><source>Nature</source><year>2024</year><volume>635</volume><fpage>186</fpage><lpage>192</lpage><pub-id pub-id-type="pmcid">PMC11541004</pub-id><pub-id pub-id-type="pmid">39385022</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07994-w</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Páez-Espino</surname><given-names>D</given-names></name><etal/></person-group><article-title>Uncovering Earth’s virome</article-title><source>Nature</source><year>2016</year><volume>536</volume><fpage>425</fpage><lpage>430</lpage><pub-id pub-id-type="pmid">27533034</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sayers</surname><given-names>EW</given-names></name><etal/></person-group><article-title>GenBank 2024 Update</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><fpage>D134</fpage><lpage>D137</lpage></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>I-MA</given-names></name><etal/></person-group><article-title>The IMG/M data management and analysis system v.7: content updates and new features</article-title><source>Nucleic Acids Research</source><year>2023</year><volume>51</volume><fpage>D723</fpage><lpage>D732</lpage><pub-id pub-id-type="pmcid">PMC9825475</pub-id><pub-id pub-id-type="pmid">36382399</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac976</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bland</surname><given-names>C</given-names></name><etal/></person-group><article-title>CRISPR Recognition Tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>209</fpage><pub-id pub-id-type="pmcid">PMC1924867</pub-id><pub-id pub-id-type="pmid">17577412</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-209</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Niu</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>3150</fpage><lpage>3152</lpage><pub-id pub-id-type="pmcid">PMC3516142</pub-id><pub-id pub-id-type="pmid">23060610</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woodcroft</surname><given-names>BJ</given-names></name><name><surname>Cunningham</surname><given-names>M</given-names></name><name><surname>Gans</surname><given-names>JD</given-names></name><name><surname>Bolduc</surname><given-names>BB</given-names></name><name><surname>Hodgkins</surname><given-names>SB</given-names></name></person-group><article-title>Kingfisher: A utility for procurement of public sequencing data</article-title><source>Zenodo</source><year>2024</year><pub-id pub-id-type="doi">10.5281/zenodo.10525086</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mukherjee</surname><given-names>S</given-names></name><etal/></person-group><article-title>Twenty-five years of Genomes OnLine Database (GOLD): data updates and new features in v.9</article-title><source>Nucleic Acids Research</source><year>2023</year><volume>51</volume><fpage>D957</fpage><lpage>D963</lpage><pub-id pub-id-type="pmcid">PMC9825498</pub-id><pub-id pub-id-type="pmid">36318257</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac974</pub-id></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>L</given-names></name><etal/></person-group><article-title>MGnify: the microbiome sequence data analysis resource in 2023</article-title><source>Nucleic Acids Research</source><year>2022</year><volume>51</volume><fpage>D753</fpage><lpage>D759</lpage><pub-id pub-id-type="pmcid">PMC9825492</pub-id><pub-id pub-id-type="pmid">36477304</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac1080</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="book"><collab>R Core Team</collab><source>R: A Language and Environment for Statistical Computing</source><publisher-name>R Foundation for Statistical Computing</publisher-name><publisher-loc>Vienna, Austria</publisher-loc><year>2024</year></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group><source>Ggplot2: Elegant Graphics for Data Analysis</source><publisher-name>Springer-Verlag New York</publisher-name><year>2016</year></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname><given-names>BJ</given-names></name><etal/></person-group><article-title>DADA2: High-resolution sample inference from Illumina amplicon data</article-title><source>Nat Methods</source><year>2016</year><volume>13</volume><fpage>581</fpage><lpage>583</lpage><pub-id pub-id-type="pmcid">PMC4927377</pub-id><pub-id pub-id-type="pmid">27214047</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Myers</surname><given-names>JR</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name></person-group><article-title>T ART: a next-generation sequencing read simulator</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>593</fpage><lpage>594</lpage><pub-id pub-id-type="pmcid">PMC3278762</pub-id><pub-id pub-id-type="pmid">22199392</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pop</surname><given-names>M</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title><source>Genome Biol</source><year>2009</year><volume>10</volume><fpage>R25</fpage><pub-id pub-id-type="pmcid">PMC2690996</pub-id><pub-id pub-id-type="pmid">19261174</pub-id><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camargo</surname><given-names>AP</given-names></name><etal/></person-group><article-title>IMG/VR v4: an expanded database of uncultivated virus genomes within a framework of extensive functional, taxonomic, and ecological metadata</article-title><source>Nucleic Acids Research</source><year>2023</year><volume>51</volume><fpage>D733</fpage><lpage>D743</lpage><pub-id pub-id-type="pmcid">PMC9825611</pub-id><pub-id pub-id-type="pmid">36399502</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac1037</pub-id></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camargo</surname><given-names>AP</given-names></name><etal/></person-group><article-title>IMG/PR: a database of plasmids from genomes and metagenomes with rich annotations and metadata</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><fpage>D164</fpage><lpage>D173</lpage><pub-id pub-id-type="pmcid">PMC10767988</pub-id><pub-id pub-id-type="pmid">37930866</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkad964</pub-id></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C</given-names></name><etal/></person-group><article-title>BLAST+: architecture and applications</article-title><source>BMC Bioinformatics</source><year>2009</year><volume>10</volume><fpage>421</fpage><pub-id pub-id-type="pmcid">PMC2803857</pub-id><pub-id pub-id-type="pmid">20003500</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>TL</given-names></name><etal/></person-group><article-title>MEME SUITE: tools for motif discovery and searching</article-title><source>Nucleic Acids Research</source><year>2009</year><volume>37</volume><fpage>W202</fpage><lpage>W208</lpage><pub-id pub-id-type="pmcid">PMC2703892</pub-id><pub-id pub-id-type="pmid">19458158</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkp335</pub-id></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khedkar</surname><given-names>S</given-names></name><etal/></person-group><article-title>Landscape of mobile genetic elements and their antibiotic resistance cargo in prokaryotic genomes</article-title><source>Nucleic Acids Research</source><year>2022</year><volume>50</volume><fpage>3155</fpage><lpage>3168</lpage><pub-id pub-id-type="pmcid">PMC8989519</pub-id><pub-id pub-id-type="pmid">35323968</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac163</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terzian</surname><given-names>P</given-names></name><etal/></person-group><article-title>PHROG: families of prokaryotic virus proteins clustered using remote homology</article-title><source>NAR Genomics and Bioinformatics</source><year>2021</year><volume>3</volume><elocation-id>lqab067</elocation-id><pub-id pub-id-type="pmcid">PMC8341000</pub-id><pub-id pub-id-type="pmid">34377978</pub-id><pub-id pub-id-type="doi">10.1093/nargab/lqab067</pub-id></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Accelerated Profile HMM Searches</article-title><source>PLoS Comput Biol</source><year>2011</year><volume>7</volume><elocation-id>e1002195</elocation-id><pub-id pub-id-type="pmcid">PMC3197634</pub-id><pub-id pub-id-type="pmid">22039361</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id></element-citation></ref><ref id="R76"><label>76</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roux</surname><given-names>S</given-names></name><etal/></person-group><article-title>Ecology and molecular targets of hypermutation in the global microbiome</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC8144416</pub-id><pub-id pub-id-type="pmid">34031405</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-23402-7</pub-id></element-citation></ref><ref id="R77"><label>77</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Y</given-names></name><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name></person-group><article-title>dbAPIS: a database of anti-prokaryotic immune system genes</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><fpage>D419</fpage><lpage>D425</lpage><pub-id pub-id-type="pmcid">PMC10767833</pub-id><pub-id pub-id-type="pmid">37889074</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkad932</pub-id></element-citation></ref><ref id="R78"><label>78</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname><given-names>B</given-names></name><name><surname>Xie</surname><given-names>C</given-names></name><name><surname>Huson</surname><given-names>DH</given-names></name></person-group><article-title>Fast and sensitive protein alignment using DIAMOND</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><fpage>59</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">25402007</pub-id></element-citation></ref><ref id="R79"><label>79</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Söding</surname><given-names>J</given-names></name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title><source>Nat Biotechnol</source><year>2017</year><volume>35</volume><fpage>1026</fpage><lpage>1028</lpage><pub-id pub-id-type="pmid">29035372</pub-id></element-citation></ref><ref id="R80"><label>80</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zielezinski</surname><given-names>A</given-names></name><etal/></person-group><article-title>Ultrafast and accurate sequence alignment and clustering of viral genomes</article-title><source>Nat Methods</source><year>2025</year><fpage>1</fpage><lpage>4</lpage><pub-id pub-id-type="pmcid">PMC12168504</pub-id><pub-id pub-id-type="pmid">40374946</pub-id><pub-id pub-id-type="doi">10.1038/s41592-025-02701-7</pub-id></element-citation></ref><ref id="R81"><label>81</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demchak</surname><given-names>B</given-names></name><etal/></person-group><article-title>Cytoscape: the network visualization tool for GenomeSpace workflows</article-title><source>F1000Res</source><year>2014</year><volume>3</volume><fpage>151</fpage><pub-id pub-id-type="pmcid">PMC4133763</pub-id><pub-id pub-id-type="pmid">25165537</pub-id><pub-id pub-id-type="doi">10.12688/f1000research.4492.2</pub-id></element-citation></ref><ref id="R82"><label>82</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breusing</surname><given-names>C</given-names></name><etal/></person-group><article-title>Ecological differences among hydrothermal vent symbioses may drive contrasting patterns of symbiont population differentiation</article-title><source>mSystems</source><year>2023</year><volume>8</volume><elocation-id>e00284-23</elocation-id><pub-id pub-id-type="pmcid">PMC10469979</pub-id><pub-id pub-id-type="pmid">37493648</pub-id><pub-id pub-id-type="doi">10.1128/msystems.00284-23</pub-id></element-citation></ref><ref id="R83"><label>83</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eloe-Fadrosh</surname><given-names>EA</given-names></name><etal/></person-group><article-title>Global metagenomic survey reveals a new bacterial candidate phylum in geothermal springs</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><elocation-id>10476</elocation-id><pub-id pub-id-type="pmcid">PMC4737851</pub-id><pub-id pub-id-type="pmid">26814032</pub-id><pub-id pub-id-type="doi">10.1038/ncomms10476</pub-id></element-citation></ref><ref id="R84"><label>84</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaible</surname><given-names>GA</given-names></name><etal/></person-group><article-title>Multicellular magnetotactic bacteria are genetically heterogeneous consortia with metabolically differentiated cells</article-title><source>PLOSBiology</source><year>2024</year><volume>22</volume><elocation-id>e3002638</elocation-id><pub-id pub-id-type="pmcid">PMC11239054</pub-id><pub-id pub-id-type="pmid">38990824</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3002638</pub-id></element-citation></ref><ref id="R85"><label>85</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirchberger</surname><given-names>PC</given-names></name><name><surname>Ochman</surname><given-names>H</given-names></name></person-group><article-title>Microviruses: A World Beyond phiXl74</article-title><source>Annual Review of Virology</source><year>2023</year><volume>10</volume><fpage>99</fpage><lpage>118</lpage><pub-id pub-id-type="pmid">37774127</pub-id></element-citation></ref><ref id="R86"><label>86</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roux</surname><given-names>S</given-names></name><etal/></person-group><article-title>Cryptic inoviruses revealed as pervasive in bacteria and archaea across Earth’s biomes</article-title><source>Nat Microbiol</source><year>2019</year><volume>4</volume><fpage>1895</fpage><lpage>1906</lpage><pub-id pub-id-type="pmcid">PMC6813254</pub-id><pub-id pub-id-type="pmid">31332386</pub-id><pub-id pub-id-type="doi">10.1038/s41564-019-0510-x</pub-id></element-citation></ref><ref id="R87"><label>87</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neri</surname><given-names>U</given-names></name><etal/></person-group><article-title>Expansion of the global RNA virome reveals diverse clades of bacteriophages</article-title><source>Cell</source><year>2022</year><volume>185</volume><fpage>4023</fpage><lpage>4037</lpage><elocation-id>e18</elocation-id><pub-id pub-id-type="pmid">36174579</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Large-scale detection of CRISPR spacers across metagenomes.</title><p><bold>A.</bold> Schematic of the approach used to collect and analyze a global CRISPR spacer dataset. Potential CRISPR repeats were first identified from assembled genomes and metagenomes, and then used in the SpacerExtractor tool to collect spacers from metagenomic reads. Spacers were then analyzed in terms of diversity within and between samples, and matched to viruses and plasmids (IMG/VR and IMG/PR) to detect potential targeting. <bold>B.</bold> Distribution of the predicted CRISPR type, taxonomic assignment level, and predicted taxon of CRISPR repeats. For repeats detected on genomes, the taxonomic assignment was considered as high-, medium-, or low-confidence based on the type and number of genomes it was detected in (see <xref ref-type="sec" rid="S9">Methods</xref>). Repeats detected from metagenomic contigs that could not be taxonomically assigned are indicated as “Unk.” (“Unknown”), with contigs including &lt;2 predicted genes considered as “short”. The distribution of taxa is indicated at the phylum level (GTDB r214) for taxonomically-assigned repeats. C. Distribution of the number of samples in which a spacer set (i.e. at least 5 distinct spacers) were detected for individual CRISPR repeats. Repeats are categorized on the y-axis based on their taxonomic assignment type (see Panel B). D. Estimated average number of distinct repeats for which spacers were identified for individual metagenomes, normalized to 1Gb of metagenomic reads, across ecosystems. Error bars represent the 99% confidence interval of the estimation.</p></caption><graphic xlink:href="EMS206473-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Spacer sets diversity within and between samples.</title><p><bold>A.</bold> Distribution of the size of spacer sets, i.e. of the number of non-redundant spacers associated with a given repeat in a given sample. The bottom panel shows the distribution of spacer set size as boxplots for different set coverages, estimated here based on the maximum spacer coverage in the set. <bold>B.</bold> Illustration of the typical distribution of spacer coverage within collected spacer sets. The plot is based on a subsample of 100 spacer sets per ecosystem, each with at least 1,000 spacer-containing reads and at least one spacer with ≥20x coverage. Each spacer coverage is then plotted according to its rank (x-axis, log10) and its coverage relative to the maximum coverage in the set (y-axis), with common (≥50% of the maximum coverage) and rare (&lt;5% of the maximum coverage) spacers highlighted in color. The black curve is based on a local polynomial regression across all data points. <bold>C.</bold> Percentage of singleton spacers (i.e. spacers identified on a single read, y-axis) within set as a function of the set size (x-axis) and minimum identify percentage used for clustering (in colors). The plot shows the median percentage of singletons for each spacer set size, for sets from 5 to 200 spacers. The distribution of singleton percentage for categories of spacer set size are provided in <xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>. <bold>D.</bold> Number of samples in which individual spacers were detected for individual repeats, for all spacers (left), common spacers only (middle) or singleton spacers only (right). The number of samples is log10-transformed (x-axis), and a dashed blue line indicates the border between one sample (left) and multiple samples (right). Plots are based on a random subset of 10 samples for repeats found in 10 samples or more. The top row shows plots based on any random subset of 10 samples, while the bottom row shows the same plot for subsets of 10 samples associated with the same subject (for host-associated samples) or location (for environmental samples). <bold>E.</bold> Schematic overview of the potential mechanisms that could lead to a high observed diversity for CRISPR loci both within a sample and between samples.</p></caption><graphic xlink:href="EMS206473-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>Spacer hits in IMG/VR (viruses) and IMG/PR (plasmid) databases.</title><p><bold>A.</bold> Percentage of virus genomes (top) and plasmids (bottom) with at least 1 spacer hit (100% spacer coverage, 0 or 1 mismatch). For both viruses and plasmids, the percentage across the entire IMG/VR or IMG/PR database is first indicated, followed by percentages for specific subsets. Caudovirus are sequences assigned to the class <italic>Caudoviricetes.</italic> “High-quality” is used to designate genomes predicted to be ≥90% complete. “mpf” refers to mating pair formation genes. <bold>B.</bold> Prediction of protospacer-adjacent motifs (PAMs) based on sequence conservation around spacer hits to IMG/VR and IMG/PR, by predicted CRISPR array type. Predicted array types were obtained from CRISPRCasTyper. For each array type, the percentage of arrays (i.e. unique repeats) for which a putative PAM was identified is in color, with solid colors when this predicted PAMs matched a known motif previously described in the literature, and light color otherwise. A more detailed description of the predicted PAMs is available in <xref ref-type="supplementary-material" rid="SD1">Fig. S12</xref>. <bold>C.</bold> Percentage of unique spacers matching a sequence in IMG/VR (viruses), IMG/PR (plasmids), or both. This percentage is shown for different categories of spacers based on their prevalence within and between samples (top), or their ecosystem of origin (bottom). The percentage of hits for common spacers was significantly greater than the one for rare spacers, and the percentage of hits for spacers from human-associated samples was significantly greater than the one for spacers from other ecosystems (2-sample test for equality of proportions, p-value &lt;2.2e-16). <bold>D.</bold> Distribution of the number of vOTUs matched by individual spacers. For this analysis, only matches to high-quality virus genomes were considered, as including genome fragments may artificially inflate the number of vOTUs due to incomplete clustering. <bold>E.</bold> Genome diversity of targets for spacers matching 2 or more viruses. A subsample of 2,000,000 spacers matching ≥2 high-quality virus genomes was selected, and the similarity between target genomes evaluated for each spacer. The y-axis represents the maximum distance (i.e. 1 – average nucleotide identity, ANI) observed between targets for a given spacer. The distribution of the number of observation along the x-axis and y-axis are based on the 2,000,000 spacers, and a random subset of 100,000 spacers are included in the x-y plot for clarity.</p></caption><graphic xlink:href="EMS206473-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>Coverage patterns of potential targets by CRISPR spacers.</title><p><bold>A.</bold> Distribution of the number of spacers connecting individual CRISPR repeats to individual IMG/VR virus sequences. Virus-repeat pairs connected by more than 10 spacers are highlighted in black. <bold>B.</bold> Relationship between the breadth of coverage of a virus by spacers collected across all samples (x-axis) and maximum breadth of coverage observed in a single sample (y-axis), for a given virus-repeat pair. The maximum coverage in a single sample is represented as a percentage of the “all sample” coverage. Virus-repeat pairs for which a single sample includes spacers representing ≥20% of the total coverage across all samples are highlighted in orange. <bold>C.</bold> Illustration of the different trends observed for the mismatch profiles, i.e. the number of spacer hits observed at different mismatch levels (x-axis, from 0 to 3 mismatches) for individual virus-repeat pairs. Each line connects 4 dots (one for each mismatch level) and represents the mismatch profile of a single virus-repeat pair. A random subsample of 100 virus-repeat pairs was selected to be included on the plot. The number of spacers on the y-axis is Z-score normalized within each profile for clarity. <bold>D.</bold> Distribution of the correlation between number of mismatches and number of spacer hits for individual virus-repeat or plasmid-repeat pairs. The bar chart is colored similarly as panel C. Vertical dashed lines define three types of mismatch profiles, from left to right: “negative”, i.e. mostly near-exact matches, “Unknown”, i.e. no specific trend, and “Positive”, i.e. mostly distant matches. <bold>E.</bold> Overall distribution of targeting level (based on number of spacer hits and number of bp covered in the target) and mismatch profiles (see panels C and D) across all virus-repeat pairs. <bold>F.</bold> Consistency between the known host and the taxonomic assignment of CRISPR repeats targeting a given virus genome, for different types of mismatch profiles. Known hosts are based on the taxonomic classification of the host on which a virus was cultivated for isolate viruses, or the taxonomic classification of the bacterial or archaeal genome for virus genomes detected as pro-phages/viruses. Only virus-repeat pairs linked by 10 spacers or more were included. Examples of taxonomy inconsistency are included in <xref ref-type="supplementary-material" rid="SD1">Figure S14</xref>. The percentage of consistent taxonomy was significantly higher for unknown and positive profiles compared to negative profiles (2-sample test for equality of proportions, p-value &lt;2.2e-16). <bold>G.</bold> Distribution of mismatch profiles for high-quality virus genomes, divided by either DGR-encoding (top) or not DGR-encoding (bottom). The percentage of negative profiles was significantly higher for DGR-encoding viruses (2-sample test for equality of proportions, p-value &lt;2.2e-16).</p></caption><graphic xlink:href="EMS206473-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>CRISPR targeting of viruses across microbial taxa.</title><p><bold>A.</bold> Distribution of the number of taxa targeting individual viruses based on different patterns of virus-repeat linkages. The top panel shows the different types of linkages that are color-coded: grey for medium targeting, brown for high targeting without sign of arms race, and blue for high targeting with potential arms race. The bottom panel shows the distribution of the taxon range connected to individual viruses considering all medium and high linkages (top), only high linkages (middle), or only high linkages with potential arms race (bottom). From top to bottom, only viruses targeted by multiple classes, phyla, or domains in one row are displayed in the next one. <bold>B.</bold> Distribution of virus features including percentage of temperate phages, viruses from human-associated samples, and viruses encoding DGRs for different groups of viruses (rows). Groups are based on the taxonomic diversity of repeats targeting the virus, with a similar color-coding as in panel A. Counts are based only on high-quality virus genomes clustered into virus operational taxonomic units (vOTUs). For cases in which vOTU members displayed varying values for some features (e.g. presence or absence of DGR), a 2/3rd majority rule was applied, and the feature was considered as unknown if no value reached this 2/3rd majority threshold. The percentage of viruses encoding a DGR was significantly higher for the second and third categories (i.e. viruses targeted by several classes with only one showing high targeting level, or only one showing high targeting level and potential arms race) compared to the first and fourth group (2-sample test for equality of proportions, p-value &lt;2e-10). <bold>C.</bold> Virus-taxon network for viruses identified as targeted by multiple phyla in previous studies <sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup> and in this analysis. Microbial taxa are grouped at the class ranks and represented by circle nodes colored by phylum and labeled with the corresponding microbial class. Viral contigs are represented by square nodes, and labeled with a simplified IMG/VR or UGV id (I20: IMGVR_UViG_3300008436_000020, I33: IMGVR_UViG_3300008506_000033, I24: IMGVR_UViG_3300008155_000024, U105: UGV-GENOME-0183105, U060: UGV-GENOME-0152060, I14: IMGVR_UViG_7000000432_000014, I49: IMGVR_UViG_3300028603_000349). Connections between viruses and taxa are based on all spacers from this taxon matching this virus, with the edge width scaled by the target coverage, and the edge colored based on the mismatch profile (as <xref ref-type="fig" rid="F4">Fig. 4C and 4D</xref>). <bold>D.</bold> Virus-taxon network for virus sequences assembled from landfill metagenomes <sup><xref ref-type="bibr" rid="R37">37</xref></sup> and connected to multiple phyla. The network displays microbial taxa (circle nodes), virus sequences (square nodes), and connections based on spacer hits (edges) using the same format as panel C. Virus sequence identifiers are simplified IMG/VR ids (I60: IMGVR_UViG_3300028601_000060, I15: IMGVR_UViG_3300014203_000115, I86: IMGVR_UViG_3300028603_000086, I48: IMGVR_UViG_3300014206_000048, I87: IMGVR_UViG_3300028602_002887, I10: IMGVR_UViG_3300028601_000010, I53: IMGVR_UViG_3300029288_007053). The asterisk symbol for virus I15 indicates that this virus genome encodes a DGR.</p></caption><graphic xlink:href="EMS206473-f005"/></fig></floats-group></article>