<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206402</article-id><article-id pub-id-type="doi">10.1101/2025.06.04.657816</article-id><article-id pub-id-type="archive">PPR1033503</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>iTissue</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zambrana</surname><given-names>Carme</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Malod-Dognin</surname><given-names>Nöel</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Pržulj</surname><given-names>Nataša</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05sd8tv96</institution-id><institution>Barcelona Supercomputing Center</institution></institution-wrap>, <city>Barcelona</city>, <country country="ES">Spain</country></aff><aff id="A2"><label>2</label>Computational Biology Department, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0258gkt32</institution-id><institution>Mohamed bin Zayed University of Artificial Intelligence</institution></institution-wrap>, <city>Abu Dhabi</city>, <country country="AE">United Arab Emirates</country></aff><aff id="A3"><label>3</label>Department of Computer Science, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap>, <city>London</city>, <postal-code>WC1E 6BT</postal-code>, <country country="GB">United Kingdom</country></aff><author-notes><corresp id="CR1">
<label>*</label><email>natasa.przulj@mbzuai.ac.ae</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>14</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>08</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><title>Summary</title><p id="P1">Tumors are highly heterogeneous tissues, and this heterogeneity impacts metastasis and its progression. Spatial data are essential for studying these hetrogeneity. However, its limited resolution makes crucial the integration of spatial data with molecular networks to identify relevant genes for the progression of metastasis. We develop a new data integration method, named iTissue, based on Graph Non-negative Matrix Tri-Factorization that integrates spatial and single-cell transcriptomics with molecular interaction networks, producing low-dimensional space. For three clear cell renal cell carcinoma (ccRCC) patients, we applied iTissue to their tumour-core and tumour-normal interface samples. We identified the top 100 with the highest euclidean distance between these two samples, since we show that the genes with the highest euclidean distance are relevant for ccRCC. By taking the intersection of the top 100 genes for the three patients, we identify 50 genes enriched in GO-BP terms relevant for metastasis. Moreover, we find that we can cluster the three regions of the tumour-normal interface (healthy tissue, tumour tissue and interface) using the identified genes. Our framework is general and can enable insight into other diseases.</p></abstract><kwd-group><kwd>data integration</kwd><kwd>non-negative matrix tri-factorisation</kwd><kwd>spatial transcriptomics</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The tumor microenvironment (TME) plays a crucial role in the progression of metastasis. Within this microenvironment, factors such as extracellular matrix components, stromal cells, immune cells, and signaling molecules interact in complex ways to promote tumor growth, invasion, and the spread of cancer to distant sites. Spatial data are essential for studying the TME in the context of metastasis, as they allow a deeper understanding of the complex interactions between tumor cells and their surroundings. Unlike traditional bulk data, which provide an averaged picture of molecular changes, spatially resolved data allows to map the precise localization of key components within the TME. However, spatial data resolution is limited; thus the integration of these data with molecular networks is crucial to identify relevant genes for the progression of metastasis.</p><p id="P3">Matrix factorization methods, such as NMF and its extension Non-Negative Matrix Tri-Factorization (NMTF) and Graph-regulirased NMTF (GNMTF), are highly effective for integrating expression data with biological networks because they provide a robust framework to combine heterogeneous data types. Recently, NMTF has successfully been used to integrate single-cell transcriptomics data with molecular networks in the context of Parkinson Disease<sup><xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref></sup>. One of the strengths of NMTF-based methods is its ability to integrate high-dimensional data from different sources (e.g., gene expression, protein interactions, spatial localization) and project them into lower-dimensional embedding (latent) spaces<sup><xref ref-type="bibr" rid="R3">3</xref></sup>. In contrast to other artificial intelligence algorithms, these methods are linear in nature and define latent spaces with natural biological interpretations<sup><xref ref-type="bibr" rid="R4">4</xref>, <xref ref-type="bibr" rid="R5">5</xref></sup>. Moreover, the GNMTF extension allows to add information about any data type using graph regularisation<sup><xref ref-type="bibr" rid="R6">6</xref></sup>, which can be used to add the spatial dependencies of the spatial data. Thus, we propose iTissue, a data integration framework based on GNMTF to integrate spatial and single-cell transcriptomics data with molecular networks to uncover relevant genes for the progression of metastasis.</p><p id="P4">We use iTissue to study the difference between the tumour-core and tumour-normal interface of clear cell renal cell carcinoma (ccRCC) patients. First, for each patient and sample (tumour-core and tumour-normal interface), we integrate spatial and single-cell transcriptomics data with molecular networks and obtain the genes embeddings in the low-dimensional space created by the integration. Then, for each patient, we obtained the top 100 genes with the highest euclidean distance between the gene embeddings for the tumour-core and tumour-normal interface samples, since we show that the genes with the highest euclidean distance are relevant for ccRCC. From these top 100 genes, we identify 50 genes that are shared between the 3 patients and validate that they are relevant for metastatic mechanisms. Finally, we find that we can cluster the three regions of the tumour-normal interface (healthy tissue, tumour tissue and interface) using the identified genes.</p></sec><sec id="S2" sec-type="results"><title>Results</title><p id="P5">We create our data fusion framework iTissue, based on graph-regularized non-negative matrix tri-factorization (GNMTF) to integrate spatial and single-cell transcriptomics data with molecular networks (i.e., protein-protein interactions (PPI), genetic interactions (GI), co-expression (CoEx) and metabolic interactions (MI)). To add the spatial dependencies of the spatial data, we use graph regularisation penalties to favour embedding close in space the spots that are neighbours in the spatial spot graph constructed by connecting each spot to all its neighbours (see <xref ref-type="fig" rid="F8">figure 8</xref>; for more details on the data that we used see “<xref ref-type="sec" rid="S8">Data collection</xref>” section and on our framework see “<xref ref-type="sec" rid="S11">iTissue data integration framework</xref>” section).</p><sec id="S3"><title>Ablation study</title><p id="P6">To assess the contribution of each molecular network (PPI, GI, CoEx and MI) to create a gene space that is functionally organised, we integrate the spatial and single-cell data with the different possible combinations of these four networks using our iTissue data integration framework (for more details, see section “<xref ref-type="sec" rid="S11">iTissue data integration framework</xref>”). For each network, we used two versions: its adjacency matrix and a weighted version of it (for more details, see section “<xref ref-type="sec" rid="S10">Molecular networks</xref>”). To measure the functional organisation of the space, we cluster the genes and compute the enrichment of these clusters in the following biological annotations: Gene Ontology-Biological Processes (GO-BP)<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, Reactome<sup><xref ref-type="bibr" rid="R8">8</xref></sup> and KEGG<sup><xref ref-type="bibr" rid="R9">9</xref></sup> (for more details, see section “<xref ref-type="sec" rid="S12">Extracting clusters of genes</xref>” and “<xref ref-type="sec" rid="S13">Enrichment Analysis</xref>”). For the three biological annotations, the weighted version of all combinations of networks, except GI+CoEx and GI+MI, obtained higher percentage of enriched genes than the adjacency matrix counterparts (see <xref ref-type="fig" rid="F2">Figure 2</xref>). The combination of PPI and MI networks obtained the highest percentage of enriched genes for Reactome and KEGG pathways, and the second-best percentage for GO-BP. Thus, we will use the combination of spatial and single-cell transcriptomic and PPI and MI networks.</p></sec><sec id="S4"><title>Identifying relevant genes for metastatic cancer</title><p id="P7">To identify genes and mechanisms that differ in the different regions of a tumour, we compare the tumour-core and tumour-normal interface of 3 clear cell renal cell carcinoma (ccRCC) patients<sup><xref ref-type="bibr" rid="R10">10</xref></sup> (see section “<xref ref-type="sec" rid="S9">Spatial and single cell transcriptomic</xref>”). For each patient and sample (i.e., tumour-core and tumour-normal interface), we apply our iTissue data integration framework (see section “<xref ref-type="sec" rid="S11">iTissue data Integration framework</xref>”) to integrate the spatial and single-cell data with the PPI and MI networks. We did not integrate CoEx and GI since we show that adding them in the integration do not result in a better functional organisation of the space (for more details, see section “<xref ref-type="sec" rid="S3">Ablation Study</xref>”).</p><p id="P8">To assess if we can identify genes relevant for ccRCC using their movement between the spaces created by the iTissue, for each patient and sample (i.e., the tumour-core and tumour-normal interface), we compute the euclidean distance of each gene between the two spaces. Since the space created for each sample will have a different set of coordinates, to be able to compute the euclidean distance between genes of different spaces, we first compute the relative distance between the genes of the same space: <italic>RelativeGeneEmbedding(RGE) = G * G<sup>T</sup></italic>. After computing the euclidean distance between each gene's RGE of the spaces created by the tumour-core and tumour-normal interface samples, we compare the euclidean distances of the genes known to be related to ccRCC in DisGeNET database<sup><xref ref-type="bibr" rid="R11">11</xref></sup> using Mann Whiteney U-test. We find that genes known to be related ccRCC have statistically significantly higher euclidean distance between the spaces created by the tumour-core and tumour-normal interface samples. Thus, other genes with high euclidean distance might also be relevant for ccRCC.</p><p id="P9">After showing that relevant genes for ccRCC have high euclidean distance between the spaces created by the tumour-core and tumour-normal interface samples, for each of the patients, we selected the top 100 with the highest euclidean distance. These three sets overlap in 50 genes (see <xref ref-type="fig" rid="F3">Figure 3</xref>). Using the curated version of DisGeNET database, we validate that 26 of these 50 genes are known to be related to cancer. To investigate which specific mechanisms these 50 genes are participating in, we use enrichment analysis in GO-BP terms (for more details, see “<xref ref-type="sec" rid="S13">Enrichment Analysis</xref>” section). Among all the enriched terms, we found that this set of genes are enriched in terms related to metastasis, such as, <italic>positive regulation of endocytosis,</italic> which is used by metastatic-suppressor genes to suppress metastasis<sup><xref ref-type="bibr" rid="R12">12</xref></sup> and <italic>regulation of fibroblast proliferation,</italic> which play a key role in cancer invasion and metastasis<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. Moreover, other enriched mechanisms, such as <italic>regulation of cellular senescence,</italic> which is a potential therapeutic target to limit metastasis formation<sup><xref ref-type="bibr" rid="R14">14</xref></sup> and <italic>Antigen processing and presentation,</italic> which has been used in cancer immunotherapy<sup><xref ref-type="bibr" rid="R15">15</xref></sup>, suggesting that the identified genes could be used as potential treatments. These results show that using the euclidean distance between the spaces created by the tumour-core and tumour-normal interface samples for the three patients, we uncover a unique set of 50 genes that are involved in the metastatic process and that could be used as targets for drug repurposing.</p></sec><sec id="S5"><title>Identified genes cluster the tumour-normal interface regions</title><p id="P10">To assess whether the identified genes are relevant for the three regions in the tumour-normal interface (healthy tissue, tumour tissue and interface), we cluster the spots in the Vissum array based on the distance of their embeddings to the embeddings of the identified genes in the gene space created by the iTissue. We cluster the spots using hierarchical clustering on the cosine distance between the spots embeddings and the genes embeddings (for more details, see “<xref ref-type="sec" rid="S14">Clustering spots based on the identified genes</xref>” section). For two of the three patients (PD45816 and PD47171), the spots cluster in three big clusters (see <xref ref-type="fig" rid="F4">Figure 4</xref> and <xref ref-type="fig" rid="F5">5</xref>) and these correspond to the three regions of healthy tissue, tumour tissue and interface (see <xref ref-type="fig" rid="F7">Figure 7</xref> left and middle). For the patient PD45814, the majority of the spots are assigned to the same cluster (see <xref ref-type="fig" rid="F6">Figure 6</xref>) and the three biggest clusters did not correspond to the three regions of healthy tissue, tumour tissue and interface (see <xref ref-type="fig" rid="F7">Figure 7</xref> right). These results show that, for two of the patients, the identified can separate the tumour-normal interface tissue into the three regions of healthy tissue, tumour tissue and interface.</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P11">In summary, we presented the iTissue framework to integrate spatial and single-cell transcriptomics data with the molecular interaction networks of PPI and MI. We apply iTissue to the tumour-core and tumour-normal interface samples of 3 clear cell renal cell carcinoma (ccRCC) patients. We showed that relevant genes for ccRCC have higher euclidean distance between their embedding in the spaces created by the tumour-core and tumour-normal interface samples. Thus, for each patient, we prioritise the top 100 genes with the highest euclidean distance between the gene embeddings obtained by these two samples. From these top 100 genes, we identify 50 genes that are shared between the 3 patients and validate that 27 out of the 50 are already known to be cancer related. Moreover, we validate that the identified genes are enriched in GO-BP relevant for metastatic mechanisms. Finally, we find that the identified genes can be used to cluster the tumour-normal interface in the main three regions (healthy tissue, tumour tissue and interface).</p><p id="P12">In this study, we uncover genes that are involved in metastatic mechanisms for ccRCC patients. However, the number of patients is limited to 3, so this result should be validated with more patients when data is available. Moreover, for two of the three patients, we cluster the tumour-normal interface in the three main regions (healthy tissue, tumour tissue and interface) using the identified genes. Further investigation is needed to assess why for the thrid patients the clusters obtained do not match the three main regions.</p></sec><sec id="S7" sec-type="methods"><title>Methods</title><sec id="S8"><title>Data collection</title><sec id="S9"><title>Spatial and single cell transcriptomics</title><p id="P13">To identify relevant genes for the metastasis of the clear cell renal cell carcinoma (ccRCC), we use spatial and single-cell transcriptomics from 3 ccRCC patients<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. From each patient, two samples were obtained, one from the core of the tumour and one from the tumour-normal interface. We create the single-cell expression matrix in which rows represent cells, columns represent genes, and an entry is the expression level. Similarly, we create the spatial expression matrix in which rows represent a spot in the Visium array, columns represent genes, and an entry is the expression level. To include the spatial information between the spots, we create the Spatial spot graph connecting each spot to all its neighbours.</p></sec><sec id="S10"><title>Molecular networks</title><p id="P14">To integrate the single-cell and spatial data with prior knowledge, we collect four molecular networks from Homo sapiens. To create the protein-protein interaction (PPI) network, we collected all physical protein-protein interactions between human proteins from BioGRID v4.4.208<sup><xref ref-type="bibr" rid="R16">16</xref></sup> that are experimentally validated using yeast two-hybrid, or affinity capture-based technologies; this resulted in 18,525 proteins (nodes) connected by 609,495 interactions (edges). To create the Gene interaction (GI) network, we collect all genetic interactions reported in BioGRID v4.4.208<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, which resulted in 7,016 proteins (nodes) connected by 17,789 interactions (edges). To create the CoExpression (CoEx) network, we collect correlations between genes from CoexpressDB v.7.325<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, the co-expression measure between two genes is standardised using zeta scores. To construct the COEX networks, in which nodes represent genes and edges represent the co-expressions between the genes, we selected the strongest co-expression values having a zeta score higher than or equal to 3, which is the usual practice, this resulted in resulted in 15,130 proteins (nodes) connected by 14,63280 interactions (edges). Finally, we construct the Metabolic Interaction (MI) network by connecting genes participating in the same metabolic pathways in KEGG<sup><xref ref-type="bibr" rid="R9">9</xref></sup>, resulting in 3,415 proteins (nodes) connected by 465,112 interactions (edges).</p><p id="P15">Following<sup><xref ref-type="bibr" rid="R18">18</xref></sup>, we represent the PPI, GI and MI networks with their Positive Pointwise Mutual Information (PPMI) matrices. These matrices quantify how frequently any two nodes in the corresponding PPI, GI and MI networks co-occur in a random walk compared to what would be expected if the occurrences of the nodes were independent. We use the DeepWalk closed formula with its default settings to compute the PPMI matrix (see <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>) <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula> where A is the adjacency matrix of the network N, D is the diagonal matrix of A, vol(N) is the volume of N, <italic>T</italic> = 10 is the length of the random walk.</p><p id="P16">To have a corresponding weighted matrix for the CoEx network, we took as weights the normalised correlation scores.</p></sec></sec><sec id="S11"><title>iTissue data integration framework</title><p id="P17">To integrate the spatial and single-cell transcriptomic with molecular interaction networks, we used Graph-regularized Non-negative Matrix Tri-Factorization (GNMTF), which approximates a high-dimensional data matrix as a product of three low-dimensional, non-negative matrices. We decompose the single-cell expression matrix in three matrices <italic>S</italic>, <italic>H<sub>s</sub></italic> and <italic>G</italic>, the spatial expression matrix in three matrices <italic>C</italic>, <italic>H<sub>c</sub></italic> and <italic>G</italic>, and all four matrices representing the molecular networks in three matrices <italic>G, H<sub>i</sub></italic>, where <italic>i</italic> = {PPI, GI, COEx, MI} and <italic>G</italic>. The matrix factor <italic>G</italic> is shared across decompositions to simultaneously decompose the all the matrices. The spatial information between the spots is added to the decomposition through graph regularisation penalties. We use these graph regularisation penalties to favour embedding close in space the spots that are neighbours in the spatial spot graph (see <xref ref-type="fig" rid="F8">Figure 8</xref>)</p><p id="P18">To extract knowledge from the decomposition, we embedded all the entities, spots, cells, and genes in the gene space. We obtain the spot embeddings by multiplying <italic>S</italic> x <italic>H<sub>s</sub></italic>, and the cell embedding by multiplying <italic>C</italic> x <italic>H<sub>c</sub></italic>. For the gene embeddings, we directly used the matrix factor <italic>G</italic>.</p></sec><sec id="S12"><title>Extracting clusters of genes</title><p id="P19">The matrix factor <italic>G<sup>g×k</sup></italic>, from the GNMTF decomposition, is the cluster indicators of genes; based on their entries, <italic>g</italic> genes are assigned to <italic>k</italic> clusters. In particular, the hard clustering procedure of Brunet <italic>et al.</italic> 2004<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, was used to cluster the genes of the matrix factor <italic>G<sup>g×k</sup></italic>. The columns of <italic>G<sup>g×k</sup></italic> correspond to the <italic>k</italic> clusters, and each gene is assigned to the cluster that has the largest entry in the gene row.</p></sec><sec id="S13"><title>Enrichment Analysis</title><p id="P20">To assess the quality of the obtained clusters of genes, we computed the enrichment of biological annotations in the clusters. For each gene (or equivalently, protein, as a gene product) in the network, we use the most specific experimentally validated annotations of Biological Process (BP) present in the Gene Ontology (GO)<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. The probability that an annotation is enriched in a cluster was computed by using a hypergeometric test, i.e., sampling without replacement strategy shown in <xref ref-type="disp-formula" rid="FD2">equation 2</xref>: <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula> where <italic>N</italic> is the number of annotated genes in the cluster, <italic>X</italic> is the number of genes in the cluster that are annotated with the given annotation, <italic>M</italic> is the number of annotated genes in the network and <italic>K</italic> is the number of genes in the network that are annotated with the annotation in question. Annotations with a Benjamini-Hochberg adjusted p-value<sup><xref ref-type="bibr" rid="R20">20</xref></sup> of p ≤ 0.05 were considered to be statistically significant enriched.</p></sec><sec id="S14"><title>Clustering spots based on identified genes</title><p id="P21">To assess whether the identified genes are relevant for the three regions in the tumour-normal interface (healthy tissue, tumour tissue and interface), we cluster the spots in the Vissum array based on the distance of their embeddings to the embeddings of the identified genes in the gene space created by the iTissue. First, we obtain the spots embeddings in the gene space by multiplying matrix factors obtained by the decomposition <italic>SpotEmbeddings</italic>(<italic>SE</italic>) = <italic>S</italic> x <italic>H<sub>s</sub></italic>. Then, we compute the cosine distance between the spots embeddings and the genes embeddings and cluster the spots according to it using Hierarchical clustering.</p></sec></sec></body><back><ack id="S26"><title>Acknowledgements</title><p>This project has received funding from Mohamed bin Zayed University of Artificial Intelligence, the European Research Council (ERC) Consolidator Grant 770827, the Spanish State Research Agency and the Ministry of Science and Innovation MCIN grant PID2022-141920NB-I00/AEI/10.13039/ 501100011033 FEDER, UE, and the Department of Research and Universities of the Generalitat de Catalunya code 2021 SGR 01536.</p></ack><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mihajlovic</surname><given-names>K</given-names></name><name><surname>Ceddia</surname><given-names>G</given-names></name><name><surname>Malod-Dognin</surname><given-names>N</given-names></name><name><surname>Novak</surname><given-names>G</given-names></name><name><surname>Kyriakis</surname><given-names>D</given-names></name><name><surname>Skupin</surname><given-names>A</given-names></name><etal/></person-group><article-title>Multi-omics integration of scRNA-seq time series data predicts new intervention points for Parkinson's disease</article-title><source>bioRxiv</source><year>2023</year><volume>12</volume><elocation-id>2023</elocation-id><comment>preprint</comment><pub-id pub-id-type="pmcid">PMC11094121</pub-id><pub-id pub-id-type="pmid">38744869</pub-id><pub-id pub-id-type="doi">10.1038/s41598-024-61844-3</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mihajlović</surname><given-names>K</given-names></name><name><surname>Malod-Dognin</surname><given-names>N</given-names></name><name><surname>Ameli</surname><given-names>C</given-names></name><name><surname>Skupin</surname><given-names>A</given-names></name><name><surname>Pržulj</surname><given-names>N</given-names></name></person-group><article-title>MONFIT: multi-omics factorization-based integration of time-series data sheds light on Parkinson's disease</article-title><source>NAR Molecular Medicine</source><year>2024</year><volume>1</volume><issue>4</issue><elocation-id>ugae012</elocation-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>T</given-names></name></person-group><source>Non-negative graph embedding</source><conf-name>2008 IEEE Conference on Computer Vision and Pattern Recognition</conf-name><year>2008</year><fpage>1</fpage><lpage>8</lpage><conf-sponsor>IEEE</conf-sponsor></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huizing</surname><given-names>GJ</given-names></name><name><surname>Deutschmann</surname><given-names>IM</given-names></name><name><surname>Peyré</surname><given-names>G</given-names></name><name><surname>Cantini</surname><given-names>L</given-names></name></person-group><article-title>Paired single-cell multi-omics data integration with Mowgli</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>7711</elocation-id><pub-id pub-id-type="pmcid">PMC10673889</pub-id><pub-id pub-id-type="pmid">38001063</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-43019-2</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Argelaguet</surname><given-names>R</given-names></name><name><surname>Arnol</surname><given-names>D</given-names></name><name><surname>Bredikhin</surname><given-names>D</given-names></name><name><surname>Deloro</surname><given-names>Y</given-names></name><name><surname>Velten</surname><given-names>B</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><etal/></person-group><article-title>MOFA+: a statistical framework for comprehensive integration of multi-modal single-cell data</article-title><source>Genome biology</source><year>2020</year><volume>21</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC7212577</pub-id><pub-id pub-id-type="pmid">32393329</pub-id><pub-id pub-id-type="doi">10.1186/s13059-020-02015-1</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>D</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>TS</given-names></name></person-group><source>Graph regularized nonnegative matrix factorization for data representation</source><conf-name>EEE Transactions on Pattern Analysis and Machine Intelligence</conf-name><year>2010</year><volume>33</volume><issue>8</issue><fpage>1548</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">21173440</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Butler</surname><given-names>H</given-names></name><name><surname>Cherry</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Gene ontology: Tool for the unification of biology</article-title><source>Nature Genetics</source><year>2000</year><month>may</month><volume>25</volume><issue>1</issue><fpage>25</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC3037419</pub-id><pub-id pub-id-type="pmid">10802651</pub-id><pub-id pub-id-type="doi">10.1038/75556</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jassal</surname><given-names>B</given-names></name><name><surname>Matthews</surname><given-names>L</given-names></name><name><surname>Viteri</surname><given-names>G</given-names></name><name><surname>Gong</surname><given-names>C</given-names></name><name><surname>Lorente</surname><given-names>P</given-names></name><name><surname>Fabregat</surname><given-names>A</given-names></name><etal/></person-group><article-title>The reactome pathway knowledgebase</article-title><source>Nucleic Acids Research</source><year>2019</year><day>11</day><volume>48</volume><issue>D1</issue><fpage>D498</fpage><lpage>503</lpage><pub-id pub-id-type="pmcid">PMC7145712</pub-id><pub-id pub-id-type="pmid">31691815</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkz1031</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Furumichi</surname><given-names>M</given-names></name><name><surname>Tanabe</surname><given-names>M</given-names></name><name><surname>Sato</surname><given-names>Y</given-names></name><name><surname>Morishima</surname><given-names>K</given-names></name></person-group><article-title>KEGG: New perspectives on genomes, pathways, diseases and drugs</article-title><source>Nucleic Acids Research</source><year>2017</year><month>jan</month><volume>45</volume><issue>D1</issue><fpage>D353</fpage><lpage>61</lpage><pub-id pub-id-type="pmcid">PMC5210567</pub-id><pub-id pub-id-type="pmid">27899662</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkw1092</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Ferdinand</surname><given-names>JR</given-names></name><name><surname>Loudon</surname><given-names>KW</given-names></name><name><surname>Bowyer</surname><given-names>GS</given-names></name><name><surname>Laidlaw</surname><given-names>S</given-names></name><name><surname>Muyas</surname><given-names>F</given-names></name><etal/></person-group><article-title>Mapping single-cell transcriptomes in the intra-tumoral and associated territories of kidney cancer</article-title><source>Cancer cell</source><year>2022</year><volume>40</volume><issue>12</issue><fpage>1583</fpage><lpage>99</lpage><pub-id pub-id-type="pmcid">PMC9767677</pub-id><pub-id pub-id-type="pmid">36423636</pub-id><pub-id pub-id-type="doi">10.1016/j.ccell.2022.11.001</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piñero</surname><given-names>J</given-names></name><name><surname>Ramírez-Anguita</surname><given-names>JM</given-names></name><name><surname>Saüch-Pitarch</surname><given-names>J</given-names></name><name><surname>Ronzano</surname><given-names>F</given-names></name><name><surname>Centeno</surname><given-names>E</given-names></name><name><surname>Sanz</surname><given-names>F</given-names></name><etal/></person-group><article-title>The DisGeNET knowledge platform for disease genomics: 2019 update</article-title><source>Nucleic Acids Research</source><year>2019</year><day>11</day><volume>48</volume><issue>D1</issue><fpage>D845</fpage><lpage>55</lpage><pub-id pub-id-type="pmcid">PMC7145631</pub-id><pub-id pub-id-type="pmid">31680165</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkz1021</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>I</given-names></name><name><surname>Steeg</surname><given-names>PS</given-names></name></person-group><article-title>Endocytosis: A pivotal pathway for regulating metastasis</article-title><source>British journal of cancer</source><year>2021</year><volume>124</volume><issue>1</issue><fpage>66</fpage><lpage>75</lpage><pub-id pub-id-type="pmcid">PMC7782782</pub-id><pub-id pub-id-type="pmid">33262521</pub-id><pub-id pub-id-type="doi">10.1038/s41416-020-01179-8</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asif</surname><given-names>PJ</given-names></name><name><surname>Longobardi</surname><given-names>C</given-names></name><name><surname>Hahne</surname><given-names>M</given-names></name><name><surname>Medema</surname><given-names>JP</given-names></name></person-group><article-title>The role of cancer-associated fibroblasts in cancer invasion and metastasis</article-title><source>Cancers</source><year>2021</year><volume>13</volume><issue>18</issue><elocation-id>4720</elocation-id><pub-id pub-id-type="pmcid">PMC8472587</pub-id><pub-id pub-id-type="pmid">34572947</pub-id><pub-id pub-id-type="doi">10.3390/cancers13184720</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faggioli</surname><given-names>F</given-names></name><name><surname>Velarde</surname><given-names>MC</given-names></name><name><surname>Wiley</surname><given-names>CD</given-names></name></person-group><article-title>Cellular senescence, a novel area of investigation for metastatic diseases</article-title><source>Cells</source><year>2023</year><volume>12</volume><issue>6</issue><fpage>860</fpage><pub-id pub-id-type="pmcid">PMC10047218</pub-id><pub-id pub-id-type="pmid">36980201</pub-id><pub-id pub-id-type="doi">10.3390/cells12060860</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>MY</given-names></name><name><surname>Jeon</surname><given-names>JW</given-names></name><name><surname>Sievers</surname><given-names>C</given-names></name><name><surname>Allen</surname><given-names>CT</given-names></name></person-group><article-title>Antigen processing and presentation in cancer immunotherapy</article-title><source>Journal for immunotherapy of cancer</source><year>2020</year><volume>8</volume><issue>2</issue><elocation-id>e001111</elocation-id><pub-id pub-id-type="pmcid">PMC7454179</pub-id><pub-id pub-id-type="pmid">32859742</pub-id><pub-id pub-id-type="doi">10.1136/jitc-2020-001111</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oughtred</surname><given-names>R</given-names></name><name><surname>Stark</surname><given-names>C</given-names></name><name><surname>Breitkreutz</surname><given-names>BJ</given-names></name><name><surname>Rust</surname><given-names>J</given-names></name><name><surname>Boucher</surname><given-names>L</given-names></name><name><surname>Chang</surname><given-names>C</given-names></name><etal/></person-group><article-title>The BioGRID interaction database: 2019 update</article-title><source>Nucleic Acids Research</source><year>2019</year><month>jan</month><volume>47</volume><issue>D1</issue><fpage>D529</fpage><lpage>41</lpage><pub-id pub-id-type="pmcid">PMC6324058</pub-id><pub-id pub-id-type="pmid">30476227</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky1079</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Obayashi</surname><given-names>T</given-names></name><name><surname>Kagaya</surname><given-names>Y</given-names></name><name><surname>Aoki</surname><given-names>Y</given-names></name><name><surname>Tadaka</surname><given-names>S</given-names></name><name><surname>Kinoshita</surname><given-names>K</given-names></name></person-group><article-title>COXPRESdb v7: a gene coexpression database for 11 animal species supported by 23 coexpression platforms for technical evaluation and evolutionary inference</article-title><source>Nucleic acids research</source><year>2019</year><volume>47</volume><issue>D1</issue><fpage>D55</fpage><lpage>62</lpage><pub-id pub-id-type="pmcid">PMC6324053</pub-id><pub-id pub-id-type="pmid">30462320</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky1155</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doria-Belenguer</surname><given-names>S</given-names></name><name><surname>Xenos</surname><given-names>A</given-names></name><name><surname>Ceddia</surname><given-names>G</given-names></name><name><surname>Malod-Dognin</surname><given-names>N</given-names></name><name><surname>Pržulj</surname><given-names>N</given-names></name></person-group><article-title>The axes of biology: a novel axes-based network embedding paradigm to decipher the functional mechanisms of the cell</article-title><source>Bioinformatics Advances</source><year>2024</year><volume>4</volume><issue>1</issue><elocation-id>vbae075</elocation-id><pub-id pub-id-type="pmcid">PMC11142626</pub-id><pub-id pub-id-type="pmid">38827411</pub-id><pub-id pub-id-type="doi">10.1093/bioadv/vbae075</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunet</surname><given-names>JP</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2004</year><month>mar</month><volume>101</volume><issue>12</issue><fpage>4164</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC384712</pub-id><pub-id pub-id-type="pmid">15016911</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title><source>Journal of the Royal Statistical Society: Series B (Methodological)</source><year>1995</year><month>jan</month><volume>57</volume><issue>1</issue><fpage>289</fpage><lpage>300</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>For different combinations of networks (x-axis) integrated with single-cell and spatial data with the iTissue data integration framework, percentage of enriched genes in GeneOntology Biological Process (left), Reactome Pathways (middle) and KEGG Pathways (right) using two representation for the molecular networks: adjacency matrix (blue) and weighted version (orange).</p></caption><graphic xlink:href="EMS206402-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>For the three patients, genes known to be related to clear cell renal cell carcinoma (ccRCC), in blue, have statistically significantly higher euclidean distance between the spaces created by the tumour-core and tumour-normal interface samples than the rest of the genes (Background), in orange. p-values obtained using Mann Whiteney U-test.</p></caption><graphic xlink:href="EMS206402-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>The top 100 with the highest movement of each patient overlap in 50 genes.</title></caption><graphic xlink:href="EMS206402-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Hierarchical clustering of the spots using the cosine distance between the spots embeddings and the genes embeddings of the 50 genes with the highest movement for patient PD45816.</p></caption><graphic xlink:href="EMS206402-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Hierarchical clustering of the spots using the cosine distance between the spots embeddings and the genes embeddings of the 50 genes with the highest movement for patient PD47171.</p></caption><graphic xlink:href="EMS206402-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p>Hierarchical clustering of the spots using the cosine distance between the spots embeddings and the genes embeddings of the 50 genes with the highest movement for patient PD45814.</p></caption><graphic xlink:href="EMS206402-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><p>Clusters obtained using the hierarchical clustering define the three regions (healthy, tumour tissue and interface) for patients PD45816 (on the left) and PD47171 (in the middle). For patient PD45814 most of the spots correspond to the same clustering, and the clustering does not correspond to the regions.</p></caption><graphic xlink:href="EMS206402-f007"/></fig><fig id="F8" position="float"><label>Figure 8</label><caption><title>Illustration of the iTissue integration method.</title><p>Graph-regularised non-negative matrix tri-factorisation (GNMTF) used for integrating the single-cell expression matrix, the spatial expression matrix, and all four matrices representing the molecular networks (PPI, GI, CoEx and MI). The matrix factor is shared across decompositions to simultaneously decompose all the matrices. The spatial information between the spots is incorporated into the data integration by using one regularisation term (illustrated by arcs with arrows).</p></caption><graphic xlink:href="EMS206402-f008"/></fig></floats-group></article>