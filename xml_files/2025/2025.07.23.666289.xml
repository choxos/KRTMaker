<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207620</article-id><article-id pub-id-type="doi">10.1101/2025.07.23.666289</article-id><article-id pub-id-type="archive">PPR1056217</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A Workflow to Create Personalised Musculoskeletal Models Based on Magnetic Resonance Images</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Stansfield</surname><given-names>Ekaterina</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Koller</surname><given-names>Willi</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Gonçalves</surname><given-names>Basílio</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kainz</surname><given-names>Hans</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Evolutionary Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03prydq77</institution-id><institution>University of Vienna</institution></institution-wrap>, <country country="AT">Austria</country></aff><aff id="A2"><label>2</label>Centre for Sport Science and University Sports, Department of Sport and Human Movement Science, Neuromechanics Research Group, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03prydq77</institution-id><institution>University of Vienna</institution></institution-wrap>, <country country="AT">Austria</country></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author <email>hans.kainz@univie.ac.at</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>29</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>27</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Musculoskeletal simulations typically rely on generic models that may not accurately represent individual anatomy. While personalisation based on medical images can improve model accuracy, current approaches often require time-consuming workflows to create these models. We present a semi-automatic workflow for creating personalised musculoskeletal models based on magnetic resonance imaging (MRI) that does not require bone segmentation.</p><p id="P2">Our workflow uses 3D Slicer and Python scripts employing Thin-Plate Spline transformation to map 106 homologous landmarks from generic models onto participants’ anatomy. Generic-scaled and MRI-based models were created for eight healthy participants, and simulations were performed using the participants’ 3D motion capture data. MRI-based models were compared with generic-scaled models through principal component analysis, and joint kinematics and joint contact forces were analysed between both modelling approaches.</p><p id="P3">Clear geometric differences existed between model types, with MRI-based models showing wider pelvises and different femur/tibia proportions. Unlike generic models, MRI-based male and female models displayed systematic differences. Despite anatomical discrepancies, joint kinematics were similar between models of the same individual, except for pelvis tilt. Muscle moment arms were generally aligned with published data from cadaver studies. MRI-based models consistently produced higher joint contact forces with greater inter-individual variation, particularly at knee joints, compared to generic-scaled models.</p><p id="P4">The proposed workflow simplifies MRI-based model creation while revealing significant sensitivity of joint contact forces to individual morphology, highlighting the importance of personalisation for biomechanical analyses.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P5">Musculoskeletal simulations, mostly based on generic-scaled models, are increasingly used to address research questions based on healthy or pathological movement data [<xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref>]. Such simulations typically require motion data obtained with a 3D gait laboratory. Body segment locations in space are captured using reflective markers placed on the skin. A personalised musculoskeletal model is created either by modifying a pre-existing generic model or by creating a model from scratch [<xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R5">5</xref>]. Finally, musculoskeletal simulations are performed based on the personalised model and motion data, which typically includes marker trajectories and ground reaction forces [<xref ref-type="bibr" rid="R6">6</xref>].</p><p id="P6">Personalised musculoskeletal models can be created to different degrees, either solely based on the position of reflective markers or by additionally integrating medical images. In ordinary workflows, the position of skin marker pairs is used to define scale factors for personalising a pre-existing generic musculoskeletal model. Based on these scale factors, the model is linearly scaled to match participants’ segment dimensions as closely as possible[<xref ref-type="bibr" rid="R7">7</xref>]. However, generic-scaled models do not account for individual anatomical differences, such as variations in bone shape and muscle lines of action [<xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R9">9</xref>]. To improve accuracy and applicability in medical settings, these models may require further, non-linear personalisation to better align digital representation with actual human subjects.</p><p id="P7">Integrating information from medical images into model personalisation improves the accuracy of musculoskeletal simulations [<xref ref-type="bibr" rid="R10">10</xref>]. The degree of personalisation spans from accurate capture of linear bone measurements to detailed reconstruction of muscle line of action, muscle fibre properties, and joint surface features [<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref>]. The path to personalised medical imaging-informed models requires several consecutive steps. First, joint centre locations and body segment orientation in parent-child coordinate systems are determined, typically following International Society of Biomechanics (ISB) recommendations [<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref>]. Second, correct locations and representations of muscle-tendon paths are identified in response to individual bone morphology. Some approaches to personalise muscle-tendon unit pathways have used linear fitting of muscle via points onto bone surfaces [<xref ref-type="bibr" rid="R15">15</xref>], employed non-linear mapping onto bone surfaces [<xref ref-type="bibr" rid="R16">16</xref>], utilised segmented muscle surfaces from 3D medical images [<xref ref-type="bibr" rid="R12">12</xref>], or applied population-based estimates followed by optimisation algorithms [<xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref>]. Finally, models’ muscle fibre parameters can be personalised using empirical data from medical images or cadaveric research [<xref ref-type="bibr" rid="R19">19</xref>]. Once built, models need validation, for example, by comparing muscle moment arms with published data or estimated muscle activation patterns with recorded electromyography data [<xref ref-type="bibr" rid="R20">20</xref>].</p><p id="P8">The accessibility of open-source segmentation and annotation software, such as 3DSlicer, and open-source musculoskeletal modelling software, such as OpenSim, has made creating personalised musculoskeletal models much more accessible. In this study, we propose a semi-automatic method that utilises Thin-Plate Spline (TPS) function and magnetic resonance imaging-based workflow. A similar methodology for bone reconstruction from sparse data, now known as statistical shape analysis, was previously explored by Zheng et al. [<xref ref-type="bibr" rid="R21">21</xref>] and Zheng and Nolte [<xref ref-type="bibr" rid="R22">22</xref>]. The present approach, however, is based on identifying biologically and/or geometrically homologous points on template and target objects [<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref>]. We compare these MRI-based models with generic-scaled models and investigate the impact of personalisation workflow on inverse kinematics, inverse dynamics and joint contact forces.</p></sec><sec id="S2" sec-type="results"><title>Results</title><p id="P9">Each of the eight participants (four males and four females, healthy, from 26 to 51 years of age) is represented by two models: a generic-scaled Rajagopal (2016) model that had its linear dimensions scaled to match the participant’s antropometry and an MRI-based model that was obtained with the help of our pipeline (see Methods and Supplementary information).</p><sec id="S3"><title>Comparing musculoskeletal geometry between generic-scaled and MRI-based models</title><p id="P10">Bony landmarks and muscle paths of generic-scaled and MRI-based models were analysed using principal components. The first two principal components (PC) described 63.9% of the variance (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). PC1 (51.8% of variance) strongly differentiated between MRI-based and generic-scaled models, ensuring no overlap between groups. PC2 (12.1% of variance) differentiated between MRI-based male and female models. In the generic-scaled models, males and females did not differ.</p><p id="P11">MRI-based models tend to have wider pelvises (large blue points in <xref ref-type="fig" rid="F1">Fig. 1b</xref>), especially in ischiopubic arches, compared to generic-scaled models, which alters the origins of hamstrings and adductor muscles (large green points in <xref ref-type="fig" rid="F1">Fig. 1b</xref>). In most cases, generic-scaled models underestimate the length of the femur by up to 15% and overestimate the length of the tibia by about 5-7% (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). In articular, femora in the P02 were 12-15% longer in the MRI-based personalised model than in the MRI-based one. Similar observations applied to muscle locations, where P02 had the most extensive distribution of differences in muscle path points, in agreement with segment length differences, and no individual had an average difference of less than 1 cm in muscle via point locations (<xref ref-type="fig" rid="F1">Fig. 1d</xref>).</p><p id="P12">On further investigation, path point locations for some muscles around the knee in generic-scaled models were notably different compared to their locations in MRIs (Supplementary information, Fig. S2). Muscle origin and via points of <italic>gastrocnemius</italic>, <italic>adductor magnus</italic>, <italic>sartorius,</italic> and <italic>tensor fasciae latae</italic> were located further away from the knee joint centre in generic-scaled models compared to MRI-based models. The sartorius P2 via point was positioned much more anteriorly in the generic-scaled models than its actual location, visible in MRI.</p><p id="P13">Large errors in muscle insertion points on the patella were observed in the generic-scaled models. Despite scaling the patella to match the participants’ knee widths, the size of the patella in generic-scaled models was significantly larger than the actual size in MRI. As a result, patella muscle via points for <italic>rectus femoris</italic> and <italic>vastii</italic> muscles were at least 1 cm different between generic-scaled and MRI-based models in most individuals (Supplementary information, Fig. S2c).</p></sec><sec id="S4"><title>Comparing simulation results between generic-scaled and MRI-based models</title><p id="P14">Joint kinematics was comparable between the generic-scaled and MRI-based models (<xref ref-type="fig" rid="F2">Fig. 2a</xref>). Cosine similarity in joint kinematics between generic-scaled and MRI-based models ranged between 0.8 and 1 (<xref ref-type="fig" rid="F2">Fig. 2b</xref>). Knee and subtalar angles exhibited the least difference between models, and pelvis tilt was affected by the personalisation the most. In inverse dynamic analysis, mean cosine similarity values were consistent for forces and moments across all coordinates.</p><p id="P15">Geometric differences between models markedly affected muscle moment arms and joint contact forces. The gluteal muscles, <italic>psoas</italic>, and <italic>biceps femoris long head</italic> most frequently showed moment arm differences exceeding 50% of the generic-scaled range across joint angles (Appendix 1, Supplementary information, Tab. S4, Fig. S3). MRI-based models produced higher joint contact forces with greater variation than generic-scaled models (<xref ref-type="fig" rid="F3">Fig. 3a and b</xref>, Supplementary information, Fig. S4). Knees joint contact forces showed the largest increases in median values and the greatest spread among the three joint sets.</p><p id="P16">To investigate the relationship between joint contact forces and bone morphology, we computed Pearson’s correlations between peak joint contact forces and the first principal component (PC1), which differentiates between MRI-based and generic-scaled models based on pelvis, femora, patellae, and tibiae shape (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). PC1 exhibited high negative correlations with first peak hip and knee joint contact forces. In other words, generic-scaled models produced lower joint contact forces than their MRI-based counterparts. The same pattern was detected when P07, the individual with the strongest expression of the geometric feature combination as expressed by PC1 (<xref ref-type="fig" rid="F1">Fig. 1a</xref>), was excluded from the correlation test (<xref ref-type="fig" rid="F4">Fig. 4b</xref>).</p></sec><sec id="S5"><title>Validation</title><p id="P17">Inverse kinematics yielded root mean squared (RMS) marker tracking errors of less than 2 cm for all individuals. Across all models, simulations yielded residual forces well below the recommended threshold [<xref ref-type="bibr" rid="R20">20</xref>] of 100 N (typically less than 10 N) and residual moments below 35 Nm (typically less than 5 Nm). In most cases, EMG activity corresponds to muscle activations obtained from the MRI-based models (see figures in Appendix 2). However, EMG signal registers earlier than estimated muscle activation, likely due to electromechanical delay between muscle electrical activation (EMG) and mechanical output [<xref ref-type="bibr" rid="R30">30</xref>].</p><p id="P18">Despite discrepancies in leg length and muscle path point locations, muscle moment arms of MRI-based models were, for most muscles, similar to generic-scaled ones (Appendix 1) and, in most cases where literature data were available, corresponded with empirical studies (Supplementary information Fig. S3).</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P19">A user-friendly open-source pipeline for a non-linear personalisation of musculoskeletal models was developed using 3D Slicer and custom Python scripts. MRI-based models produced valid kinematics and residual forces output, sensu Hickes et al. [<xref ref-type="bibr" rid="R20">20</xref>]. The musculoskeletal geometry of the MRI-based models consistently differed from the generic-scaled models created for the same individual. Nevertheless, muscle moment arms in both generic-scaled and MRI-based models generally fell within two standard deviations of each other and aligned with available empirical data.</p><p id="P20">Despite anatomical discrepancies, kinematic outputs were broadly comparable between models across most joint coordinates, except for pelvis tilt. This similarity likely results from using identical anatomical coordinate systems and degrees of freedom in both model types [<xref ref-type="bibr" rid="R31">31</xref>]. Joint moments showed even greater consistency between models in agreement with previous personalisation studies [<xref ref-type="bibr" rid="R32">32</xref>].</p><p id="P21">Variation in musculoskeletal geometry resulted in differences in muscle moment arms. According to our results, generic-scaled models substantially overestimated patella size, underestimated femur length and overestimated shank length. Consequently, most muscle paths in generic-scaled models deviated from corresponding muscle locations visible in MRIs. The gluteal muscles, <italic>psoas,</italic> and <italic>biceps femoris</italic> were most frequently listed as the muscles with the highest proportional difference between the two models. According to Bosman et al. [<xref ref-type="bibr" rid="R33">33</xref>], anatomical variability in muscle via point locations significantly affects calculated muscle forces, with <italic>gluteus medius</italic>, <italic>iliacus</italic>, and <italic>psoas</italic> being the most sensitive. Moreover, perturbations in these muscles’ moment arms may result in extensive concomitant changes in unperturbed muscle forces.</p><p id="P22">High knee joint contact forces in MRI-based models were associated with higher activations in the <italic>sartorius</italic> and <italic>gastrocnemius</italic> muscles. Additionally, discrepancies in patella size and shape between model types altered via point positions of the <italic>rectus femoris</italic> and <italic>vastii</italic> muscles, reducing their moment arms in MRI-based models. Despite not being maximally activated, these strong muscles contributed substantially to joint contact forces.</p><p id="P23">Overall, MRI-based models exhibited greater variability in joint contact forces than generic-scaled models, with estimates for some individuals reaching up to 6.5 body weights. Although these values remain within the normal range reported in musculoskeletal modelling studies [<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R35">35</xref>], they contrast with results from instrumented implants that report forces within 1 to 4 times body weight [<xref ref-type="bibr" rid="R36">36</xref>–<xref ref-type="bibr" rid="R38">38</xref>].</p><p id="P24">Correlation analysis revealed that a combination of morphological features in the pelvis, femur, and tibia (PC1) was associated with elevated peak hip and knee contact forces in personalised models. This feature combination was most pronounced in individual P07. Excluding P07 from the analysis maintained the same pattern, although with reduced correlation magnitudes. These results agree with reports that individual variations in femur morphology, such as torsion angle, neck-shaft angle, and femoral neck length, affect joint contact forces [<xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R39">39</xref>].</p><p id="P25">Many previous studies have agreed that the physiological consistency of musculoskeletal models improves with the degree of personalisation [<xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R40">40</xref>–<xref ref-type="bibr" rid="R44">44</xref>]. Smale et al (2019) and Killen et al. (2024) demonstrated that personalisation of knee geometry results in different kinematics and joint moment patterns, as well as in different knee ligament lengths and joint pressure locations in models for anterior cruciate ligament deficiency patients and knee arthritis. Studies in healthy children and children with cerebral palsy showed a significant impact of personalised musculoskeletal geometry, combined with calibrated parameters of musculotendon units and electromyographic signal tracking, on muscle activation calculations and resulting muscle and joint contact forces [<xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R40">40</xref>–<xref ref-type="bibr" rid="R42">42</xref>]. Conconi et al. [<xref ref-type="bibr" rid="R32">32</xref>] demonstrated that ankle models with higher complexity, compared to simple hinge models, produced greater adherence to the hypothesis of negligible joint work when quantifying ligament and cartilage deformations from joint motion. Modenese et al. [<xref ref-type="bibr" rid="R15">15</xref>] argued that realistic knee contact forces could be estimated when musculotendon parameters were linearly scaled from a reference model and the muscle force-length-velocity relationship was incorporated into the simulation. At the same time, Kainz et al. [<xref ref-type="bibr" rid="R40">40</xref>] found that the most realistic joint contact forces were obtained in MRI-based models that tracked electromyography, with geometry personalisation having the greatest impact.</p><p id="P26">Previous publications in model personalisation, as listed above, frequently focus on children or pathological cases. Here, we present the first demonstration that personalisation also affects outcomes of models created for healthy adults. The personalisation we achieve using a non-linear approach to reconstructing bone morphology and muscle paths is higher than the linear scaling and affine transformation methods adopted in some of the previous studies. For the first time, this approach allowed us to demonstrate systematic differences between male and female musculoskeletal models. These may be responsible for differential muscle activation patterns and joint contact forces between the sexes. A detailed study of a larger population of healthy adults is currently underway.</p><p id="P27">Our study focuses on musculoskeletal geometry and has several limitations. First, we did not account for individual motor control; EMG-informed approaches may help overcome excessive muscle activations [<xref ref-type="bibr" rid="R40">40</xref>]. Second, morphological changes in personalised models may require corresponding muscle–tendon parameter adjustments. Ackland et al. [<xref ref-type="bibr" rid="R45">45</xref>] demonstrated that muscle force calculations are highly sensitive to tendon slack length, as altering one muscle’s parameters can influence synergistic muscle forces due to optimisation constraints. Optimisation procedures for adjusting these parameters, as suggested by Modenese et al. [<xref ref-type="bibr" rid="R46">46</xref>], may improve outcomes. Finally, we lack a ground truth for joint kinematics and contact forces. However, personalised models produce more accurate results in people with instrumented prostheses [<xref ref-type="bibr" rid="R10">10</xref>], making MRI-based models more trustworthy than generic-scaled models.</p></sec><sec id="S7" sec-type="conclusions"><title>Conclusions</title><p id="P28">Using a non-linear approach, we presented a workflow for MRI-based personalised models that allows for close fitting of skeletal and muscle geometries. We demonstrated that personalisation is essential not only for pathological, paediatric or edge cases, but also for healthy adults. In particular, we clearly showed differences in musculoskeletal geometry between males and females.</p><p id="P29">Unlike previous work that used non-linear approaches to personalisation, our workflow does not require large population samples to predict muscle paths. It uses open-source tools readily available to both research and medical practitioners. Moreover, our supplementary material includes a step-by-step introduction to creating these models and the required Python code. Many clinical centres have 3D movement data and medical images but lack the knowledge to create such models. Our proposed workflow may help overcome these limitations and make personalized musculoskeletal modelling more accessible in practice.</p></sec><sec id="S8" sec-type="methods"><title>Methods</title><sec id="S9" sec-type="subjects"><title>Participants</title><p id="P30">Eight healthy individuals volunteered to participate in this study. Participants’ ages ranged from 26 to 51 (<xref ref-type="table" rid="T1">Table 1</xref>). They attended a 3D motion capture session at the Department for Biomechanics, Kinesiology and Computer Science in Sport at the University of Vienna (Vienna, Austria), followed by a magnetic resonance imaging (MRI) session at the Orthopaedic Hospital Speising (Vienna, Austria).</p></sec><sec id="S10"><title>Ethics Statement</title><p id="P31">Ethics approval was obtained from the Ethics Committee of the University of Vienna (reference number 00716). Written informed consent was obtained from all participants prior to data collection.</p></sec><sec id="S11"><title>Motion Capture</title><p id="P32">Gait data were collected using a three-dimensional motion capture system (12-camera Vicon Motion Systems, Oxford, UK), five force plates (Kistler Instrumente AG, Winterthur, Switzerland), and a 16-channel electromyography (EMG) system (Cometa SRL, Bareggio, Italy). <italic>Gluteus maximus</italic>, <italic>gluteus medius</italic>, <italic>tensor fasciae latae</italic>, <italic>biceps femoris</italic>, <italic>rectus femoris</italic>, <italic>vastus lateralis</italic>, <italic>vastus medialis</italic> and <italic>gastrocnemius medialis</italic> activation signals were collected on the left and right lower limb with the help of EMG sensors. An adapted Cleveland marker placement protocol (Sutherland, 2002) was used for tracking motion (Supplementary information, Tab. S1).</p></sec><sec id="S12"><title>MRI images</title><p id="P33">Each participant underwent MRI scans of the pelvis and lower extremities (Magnetom Vida, Gradient Recalled scanning sequence, segmented k-space variant, Cardiac Gating, Respiratory Gating, Phase Encode Reordering, repetition time 5.42 msec, echo time 2.46 ms, magnetic field strength 3T, imaging frequency 123.25 Hz). Voxel size was 0.9 x 0.9 x 1 mm.</p></sec><sec id="S13"><title>Model personalisation</title><p id="P34">We used the Rajagopal et al. [<xref ref-type="bibr" rid="R25">25</xref>] model, a commonly used OpenSim model, as a base for creating personalised models. The arms were removed from the base model, and the torso mass was adjusted to compensate for the loss of the arms. A generic-scaled and MRI-based models were created for each participant. MRI-based models featured joint centres in MRI according to ISB definitions and muscle paths closely matching actual anatomy. Bone surfaces were approximated for display purposes only.</p><sec id="S14"><title>Generic-scaled models</title><p id="P35">The generic Rajagopal model was scaled to match participant dimensions determined by reflective markers during static motion capture (Supplementary information, Tab. S2). Scaling was performed using the OpenSim scaling tool, which linearly updates x, y, and z segment dimensions and scales muscle fibres’ optimal length to individual segment dimensions. We also adjusted maximum isometric muscle force using a regression equation from Handsfield et al. [<xref ref-type="bibr" rid="R26">26</xref>] for calculating lower limb muscle volumes. The maximum muscle force scaling factor was determined by <xref ref-type="disp-formula" rid="FD1">equation (1)</xref>. <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.2em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P36">Where <italic>V<sub>scaled</sub>, V<sub>generic</sub>,</italic> are volumes of the generic and scaled models, <italic>l<sub>optimal scaled</sub></italic> and <italic>l<sub>optimal generic</sub></italic> are optimal fibre lengths of a specific muscle in the scaled individual and generic models. In their turn, the volumes were defined by <xref ref-type="disp-formula" rid="FD2">equation (2)</xref> [<xref ref-type="bibr" rid="R26">26</xref>]. <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>47</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>×</mml:mo><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.2em"/><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1285</mml:mn></mml:mrow></mml:math></disp-formula></p><p id="P37">This equation agrees with the convention that maximum isometric muscle force is proportional to physiological cross-sectional area (PCSA). The scaled-generic model, together with muscle parameters and inertia values, became the template for creating the MRI-based models for each participant.</p></sec><sec id="S15"><title>MRI-based models</title><p id="P38">A workflow to create the MRI-based model was developed using 3DSlicer software and OpenSim API in Python (Supplementary information, Fig. S1). Creating the MRI-based model included updating the generic-scaled model with muscle paths and bone shapes obtained from MRI images. To obtain these data, we identified homologous landmarks on the generic model and participants’ MRIs. These landmarks were chosen to represent each segment’s geometry while providing sufficient guidance for later muscle path fitting. 106 landmarks were placed on the pelvis, femur, patella, tibia and fibula of the template model (<xref ref-type="fig" rid="F5">Fig. 5</xref>, Supplementary information Tab. S3). Landmarks represented two groups. The primary group included 21 landmarks easily identifiable on MRI and essential for further steps, placed manually on MRI using 3DSlicer (<xref ref-type="fig" rid="F5">Fig. 5</xref>). Remaining landmarks were projected into MRI space using a Thin-Plate Spline (TPS) non-linear registration algorithm available in 3DSlicer. An operator verified the correct positioning of registered landmarks to ensure alignment with predefined orientation planes within the MRI volume. Once proper positioning was established, bone landmarks were used for Thin-Plate Spline fitting of muscle point paths and translations of muscle wrapping surfaces.</p><p id="P39">Fitting was achieved using a custom Python script, though the same procedure can be set up using only 3DSlicer tools. Thin-Plate Spline bending strength was penalised at a 0.02 level, determined experimentally to ensure projected points fell within the expected boundaries of bone and muscle positions. Once projected, muscle path locations were rechecked to fit in the middle of the muscles’ axial cross-sections in MRI space. Only a few manual adjustments were necessary (<xref ref-type="fig" rid="F6">Fig. 6</xref>).</p><p id="P40">Next, the data were separated into segments, and each segment was rotated to ISB-recommended orientation and scaled to meters to match OpenSim scaling convention. Simultaneously, new bone surfaces were created by warping template model bone surfaces onto participant data. Surfaces were rotated, translated into the ISB-recommended orientation, and later used for model display.</p><p id="P41">Once muscle paths, joint locations, muscle wrapping surface translations and bone surfaces were obtained and transformed to ISB standard orientation, a copy of the generic-scaled model was updated with this information. Wrapping surface radii, length, and orientation were preserved from the generic-scaled model. During adjustment, a custom Python script monitored potential intersections between muscle path points and wrapping surfaces to ensure accurate alignment. The wrapping surface radius was modified if the distance of the neighbouring via point from the axis of the wrapping surface was smaller than its radius. Skin marker locations underwent TPS transformation to fit the personalised geometry, after which experimental marker locations from static trials were fitted using the OpenSim scaling tool.</p><p id="P42">Personalisation frequently results in discrepancies between muscle paths and wrapping surface size and position throughout the entire range of motion [<xref ref-type="bibr" rid="R27">27</xref>]. To address this, we created an additional optimisation script that adjusted muscle via point positions to prevent muscles from dynamically penetrating wrapping surfaces and avoid significant decreases in personalised muscle moment arms. The following objective function was minimised: <disp-formula id="FD3"><mml:math id="M3"><mml:mrow><mml:mi>O</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula> where <italic>d<sub>mean</sub></italic> means the average absolute distance between the generic and personalised muscle moment arm; <italic>d<sub>max</sub></italic> means the maximum absolute distance between the moment arms; <italic>d<sub>shape</sub></italic> is the term that calculates the absolute maximum height between the start and the end of the moment arm waveform; and <italic>p<sub>drop</sub></italic> is the penalty for the sudden drop in the moment arm due to the interaction with the wrapping surface. We utilised an OpenSim API function calculating moment arm as the differential of the ratio between musculotendon length and joint angle [<xref ref-type="bibr" rid="R28">28</xref>]. Adjustment boundaries were customised for different muscles. For example, <italic>gluteus maximus</italic> via points could move within a 2 cm radius, while <italic>rectus femoris</italic> and <italic>vastii</italic> points at the patella were limited to a 0.5 cm radius. The optimisation procedure included grid search within the set radius, followed by gradient optimisation using the Sequential Least Squares Programming (SLSQP) method in the SciPy Python library. Python scripts and notebooks required to reproduce this pipeline are available publicly.</p></sec></sec><sec id="S16"><title>Validation and Analyses</title><sec id="S17"><title>Comparing generic-scaled and MRI-based models</title><p id="P43">To compare the musculoskeletal geometry of the generic-scaled and MRI-based models, we first extracted principal components from the clouds of landmarks on the bone and muscle path points, which combined data from all models. The components were extracted from the superimposed and standardised landmark clouds, so variations due to translation, orientation, and size were removed from the data [<xref ref-type="bibr" rid="R29">29</xref>]. This allowed us to explore the trends in the shape differences between the generic-scaled and MRI-based models. We also computed and plotted root mean square differences (RMSD) in joint and muscle locations between generic-scaled and MRI-based models.</p><p id="P44">Inverse kinematics, muscle moment arm analyses, inverse dynamics, static optimisation, and joint reaction analyses were performed using custom Python scripts and the OpenSim 4.5 API. Joint kinematics and dynamics were compared between the MRI-based and generic-scaled models. This was achieved by calculating the cosine similarity metric, a cos between two vectors of values for joint angles (in kinematics) or joint moments (in dynamics) for the right gait cycle in each individual. We further compared predicted joint contact forces in generic-scaled models with MRI-based models to quantify the sensitivity of joint contact forces to model personalisation.</p></sec><sec id="S18"><title>Validation</title><p id="P45">We compared kinematic tracking errors and residual forces with recommended threshold values [<xref ref-type="bibr" rid="R20">20</xref>]. Furthermore, model validation was performed by comparing muscle activations estimated by static optimisation with EMG data collected from 16 muscles. Additionally, we compared muscle moment arms from generic-scaled and MRI-based models with data from the literature.</p></sec></sec></sec></body><back><ack id="S19"><title>Acknowledgement</title><p>ES acknowledges funding by the Austrian Science Fund, grant P 35714-B. HK and WK acknowledge funding by the European Research Council, GAP 101170218. Co-funded by the European Union. Views and opinions expressed are however those of the authors only and do not necessarily reflect those of the European Union or European Research Council Executive Agency. Neither the European Union nor the granting authority can be held responsible for them.</p></ack><sec id="S20" sec-type="data-availability"><title>Data availability</title><p id="P46">Scripts for re-creating the pipeline, models and motion capture data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/katya-stanzy/tps_personalised_model">https://github.com/katya-stanzy/tps_personalised_model</ext-link>.</p></sec><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buehler</surname><given-names>C</given-names></name><name><surname>Koller</surname><given-names>W</given-names></name><name><surname>De Comtes</surname><given-names>F</given-names></name><name><surname>Kainz</surname><given-names>H</given-names></name></person-group><article-title>Quantifying muscle forces and joint loading during hip exercises performed with and without an elastic resistance band</article-title><source>Front Sports Act Living</source><year>2021</year><volume>3</volume><elocation-id>695383</elocation-id><pub-id pub-id-type="doi">10.3389/fspor.2021.695383</pub-id><pub-id pub-id-type="pmcid">PMC8419330</pub-id><pub-id pub-id-type="pmid">34497999</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Rossom</surname><given-names>S</given-names></name><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Wesseling</surname><given-names>M</given-names></name><name><surname>Papageorgiou</surname><given-names>E</given-names></name><name><surname>De Groote</surname><given-names>F</given-names></name><name><surname>Van Campenhout</surname><given-names>A</given-names></name><etal/></person-group><article-title>Single-event multilevel surgery, but not botulinum toxin injections normalize joint loading in cerebral palsy patients</article-title><source>Clin Biomech (Bristol, Avon)</source><year>2020</year><volume>76</volume><elocation-id>105025</elocation-id><pub-id pub-id-type="pmid">32402900</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Hoang</surname><given-names>HX</given-names></name><name><surname>Stockton</surname><given-names>C</given-names></name><name><surname>Boyd</surname><given-names>RR</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name><name><surname>Carty</surname><given-names>CP</given-names></name></person-group><article-title>Accuracy and Reliability of Marker-Based Approaches to Scale the Pelvis, Thigh, and Shank Segments in Musculoskeletal Models</article-title><source>J Appl Biomech</source><year>2017</year><volume>33</volume><fpage>354</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">28290736</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheys</surname><given-names>L</given-names></name><name><surname>Van Campenhout</surname><given-names>A</given-names></name><name><surname>Spaepen</surname><given-names>A</given-names></name><name><surname>Suetens</surname><given-names>P</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name></person-group><article-title>Personalized MR-based musculoskeletal models compared to rescaled generic models in the presence of increased femoral anteversion: effect on hip moment arm lengths</article-title><source>Gait Posture</source><year>2008</year><volume>28</volume><fpage>358</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">18571416</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valente</surname><given-names>G</given-names></name><name><surname>Crimi</surname><given-names>G</given-names></name><name><surname>Vanella</surname><given-names>N</given-names></name><name><surname>Schileo</surname><given-names>E</given-names></name><name><surname>Taddei</surname><given-names>F</given-names></name></person-group><article-title>nmsBuilder: Freeware to create subject-specific musculoskeletal models for OpenSim</article-title><source>Comput Methods Programs Biomed</source><year>2017</year><volume>152</volume><fpage>85</fpage><lpage>92</lpage><pub-id pub-id-type="pmid">29054263</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seth</surname><given-names>A</given-names></name><name><surname>Sherman</surname><given-names>M</given-names></name><name><surname>Reinbolt</surname><given-names>JA</given-names></name><name><surname>Delp</surname><given-names>SL</given-names></name></person-group><article-title>OpenSim: a musculoskeletal modeling and simulation framework for in silico investigations and exchange</article-title><source>Procedia IUTAM</source><year>2011</year><volume>2</volume><fpage>212</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1016/j.piutam.2011.04.021</pub-id><pub-id pub-id-type="pmcid">PMC4397580</pub-id><pub-id pub-id-type="pmid">25893160</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delp</surname><given-names>SL</given-names></name><name><surname>Anderson</surname><given-names>FC</given-names></name><name><surname>Arnold</surname><given-names>AS</given-names></name><name><surname>Loan</surname><given-names>P</given-names></name><name><surname>Habib</surname><given-names>A</given-names></name><name><surname>John</surname><given-names>CT</given-names></name><etal/></person-group><article-title>OpenSim: open-source software to create and analyze dynamic simulations of movement</article-title><source>IEEE Trans Biomed Eng</source><year>2007</year><volume>54</volume><fpage>1940</fpage><lpage>50</lpage><pub-id pub-id-type="pmid">18018689</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name></person-group><article-title>Imaging-based musculoskeletal models alter muscle and joint contact forces but do not improve the agreement with experimentally measured electromyography signals in children with cerebral palsy</article-title><source>Gait Posture</source><year>2023</year><volume>100</volume><fpage>91</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">36502666</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Mindler</surname><given-names>GT</given-names></name><name><surname>Kranzl</surname><given-names>A</given-names></name></person-group><article-title>Influence of femoral anteversion angle and neck-shaft angle on muscle forces and joint loading during walking</article-title><source>PLoS One</source><year>2023</year><volume>18</volume><elocation-id>e0291458</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0291458</pub-id><pub-id pub-id-type="pmcid">PMC10569567</pub-id><pub-id pub-id-type="pmid">37824447</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Barzan</surname><given-names>M</given-names></name><name><surname>Carty</surname><given-names>CP</given-names></name></person-group><article-title>Dependency of lower limb joint reaction forces on femoral version</article-title><source>Gait Posture</source><year>2021</year><volume>88</volume><fpage>318</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">34246172</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheys</surname><given-names>L</given-names></name><name><surname>Desloovere</surname><given-names>K</given-names></name><name><surname>Spaepen</surname><given-names>A</given-names></name><name><surname>Suetens</surname><given-names>P</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name></person-group><article-title>Calculating gait kinematics using MR-based kinematic models</article-title><source>Gait Posture</source><year>2011</year><volume>33</volume><fpage>158</fpage><lpage>64</lpage><pub-id pub-id-type="pmid">21247765</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Kohout</surname><given-names>J</given-names></name></person-group><article-title>Automated Generation of Three-Dimensional Complex Muscle Geometries for Use in Personalised Musculoskeletal Models</article-title><source>Ann Biomed Eng</source><year>2020</year><volume>48</volume><fpage>1793</fpage><lpage>804</lpage><pub-id pub-id-type="doi">10.1007/s10439-020-02490-4</pub-id><pub-id pub-id-type="pmcid">PMC7280327</pub-id><pub-id pub-id-type="pmid">32185569</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>G</given-names></name><name><surname>Siegler</surname><given-names>S</given-names></name><name><surname>Allard</surname><given-names>P</given-names></name><name><surname>Kirtley</surname><given-names>C</given-names></name><name><surname>Leardini</surname><given-names>A</given-names></name><name><surname>Rosenbaum</surname><given-names>D</given-names></name><etal/></person-group><article-title>ISB recommendation on definitions of joint coordinate system of various joints for the reporting of human joint motion—part I: ankle, hip, and spine</article-title><source>J Biomech</source><year>2002</year><volume>35</volume><fpage>543</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">11934426</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>G</given-names></name><name><surname>van der Helm</surname><given-names>FCT</given-names></name><name><surname>Veeger</surname><given-names>HEJD</given-names></name><name><surname>Makhsous</surname><given-names>M</given-names></name><name><surname>Van Roy</surname><given-names>P</given-names></name><name><surname>Anglin</surname><given-names>C</given-names></name><etal/></person-group><article-title>ISB recommendation on definitions of joint coordinate systems of various joints for the reporting of human joint motion--Part II: shoulder, elbow, wrist and hand</article-title><source>J Biomech</source><year>2005</year><volume>38</volume><fpage>981</fpage><lpage>92</lpage><pub-id pub-id-type="pmid">15844264</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Montefiori</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Wesarg</surname><given-names>S</given-names></name><name><surname>Viceconti</surname><given-names>M</given-names></name><name><surname>Mazzà</surname><given-names>C</given-names></name></person-group><article-title>Investigation of the dependence of joint contact forces on musculotendon parameters using a codified workflow for image-based modelling</article-title><source>J Biomech</source><year>2018</year><volume>73</volume><fpage>108</fpage><lpage>18</lpage><pub-id pub-id-type="pmid">29673935</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Scheys</surname><given-names>L</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name><name><surname>Loeckx</surname><given-names>D</given-names></name><name><surname>Maes</surname><given-names>F</given-names></name><name><surname>Spaepen</surname><given-names>A</given-names></name><name><surname>Suetens</surname><given-names>P</given-names></name></person-group><chapter-title>Image Based Musculoskeletal Modeling Allows Personalized Biomechanical Analysis of Gait</chapter-title><source>Biomedical Simulation</source><publisher-name>Springer</publisher-name><publisher-loc>Berlin Heidelberg</publisher-loc><year>2006</year><fpage>58</fpage><lpage>66</lpage></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Killen</surname><given-names>BA</given-names></name><name><surname>Brito da Luz</surname><given-names>S</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name><name><surname>Carleton</surname><given-names>AD</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Besier</surname><given-names>TF</given-names></name><etal/></person-group><article-title>Automated creation and tuning of personalised muscle paths for OpenSim musculoskeletal models of the knee joint</article-title><source>Biomech Model Mechanobiol</source><year>2021</year><volume>20</volume><fpage>521</fpage><lpage>33</lpage><pub-id pub-id-type="pmid">33098487</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nolte</surname><given-names>D</given-names></name><name><surname>Tsang</surname><given-names>CK</given-names></name><name><surname>Zhang</surname><given-names>KY</given-names></name><name><surname>Ding</surname><given-names>Z</given-names></name><name><surname>Kedgley</surname><given-names>AE</given-names></name><name><surname>Bull</surname><given-names>AMJ</given-names></name></person-group><article-title>Non-linear scaling of a musculoskeletal model of the lower limb using statistical shape models</article-title><source>J Biomech</source><year>2016</year><volume>49</volume><fpage>3576</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1016/j.jbiomech.2016.09.005</pub-id><pub-id pub-id-type="pmcid">PMC6399126</pub-id><pub-id pub-id-type="pmid">27653375</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolsterlee</surname><given-names>B</given-names></name><name><surname>Veeger</surname><given-names>HEJD</given-names></name><name><surname>van der Helm</surname><given-names>FCT</given-names></name><name><surname>Gandevia</surname><given-names>SC</given-names></name><name><surname>Herbert</surname><given-names>RD</given-names></name></person-group><article-title>Comparison of measurements of medial gastrocnemius architectural parameters from ultrasound and diffusion tensor images</article-title><source>J Biomech</source><year>2015</year><volume>48</volume><fpage>1133</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">25682540</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hicks</surname><given-names>JL</given-names></name><name><surname>Uchida</surname><given-names>TK</given-names></name><name><surname>Seth</surname><given-names>A</given-names></name><name><surname>Rajagopal</surname><given-names>A</given-names></name><name><surname>Delp</surname><given-names>SL</given-names></name></person-group><article-title>Is my model good enough? Best practices for verification and validation of musculoskeletal models and simulations of movement</article-title><source>J Biomech Eng</source><year>2015</year><volume>137</volume><elocation-id>020905</elocation-id><pub-id pub-id-type="doi">10.1115/1.4029304</pub-id><pub-id pub-id-type="pmcid">PMC4321112</pub-id><pub-id pub-id-type="pmid">25474098</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>G</given-names></name><name><surname>Rajamani</surname><given-names>KT</given-names></name><name><surname>Nolte</surname><given-names>L-P</given-names></name></person-group><chapter-title>Use of a dense surface point distribution model in a three-stage anatomical shape reconstruction from sparse information for computer assisted orthopaedic surgery: A preliminary study</chapter-title><source>Computer Vision – ACCV 2006</source><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin, Heidelberg</publisher-loc><year>2006</year><fpage>52</fpage><lpage>60</lpage></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>G</given-names></name><name><surname>Nolte</surname><given-names>L-P</given-names></name></person-group><source>Surface reconstruction of bone from X-ray images and point distribution model incorporating a novel method for 2D-3D correspondence</source><conf-name>2006 IEEE Computer Society Conference on Computer Vision and Pattern Recognition - Volume 2 (CVPR’06)</conf-name><conf-sponsor>IEEE</conf-sponsor><year>2006</year><pub-id pub-id-type="doi">10.1109/cvpr.2006.300</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bookstein</surname><given-names>FL</given-names></name></person-group><chapter-title>Thin-Plate splines and the atlas problem for biomedical images</chapter-title><person-group person-group-type="editor"><name><surname>Colchester</surname><given-names>ACF</given-names></name><name><surname>Hawkes</surname><given-names>DJ</given-names></name></person-group><source>Information Processing in Medical Imaging</source><publisher-name>Springer-Verlag</publisher-name><publisher-loc>Berlin/Heidelberg</publisher-loc><year>1991</year><fpage>326</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1109/cvpr.2006.300</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slice</surname><given-names>DE</given-names></name></person-group><article-title>Modern morphometrics</article-title><source>Modern Morphometrics in Physical Anthropology</source><year>2005</year></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajagopal</surname><given-names>A</given-names></name><name><surname>Dembia</surname><given-names>CL</given-names></name><name><surname>DeMers</surname><given-names>MS</given-names></name><name><surname>Delp</surname><given-names>DD</given-names></name><name><surname>Hicks</surname><given-names>JL</given-names></name><name><surname>Delp</surname><given-names>SL</given-names></name></person-group><article-title>Full-Body Musculoskeletal Model for Muscle-Driven Simulation of Human Gait</article-title><source>IEEE Trans Biomed Eng</source><year>2016</year><volume>63</volume><fpage>2068</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1109/TBME.2016.2586891</pub-id><pub-id pub-id-type="pmcid">PMC5507211</pub-id><pub-id pub-id-type="pmid">27392337</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handsfield</surname><given-names>GG</given-names></name><name><surname>Meyer</surname><given-names>CH</given-names></name><name><surname>Hart</surname><given-names>JM</given-names></name><name><surname>Abel</surname><given-names>MF</given-names></name><name><surname>Blemker</surname><given-names>SS</given-names></name></person-group><article-title>Relationships of 35 lower limb muscles to height and body mass quantified using MRI</article-title><source>Journal of Biomechanics</source><year>2014</year><volume>47</volume><fpage>631</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">24368144</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koller</surname><given-names>W</given-names></name><name><surname>Horsak</surname><given-names>B</given-names></name><name><surname>Kranzl</surname><given-names>A</given-names></name><name><surname>Unglaube</surname><given-names>F</given-names></name><name><surname>Baca</surname><given-names>A</given-names></name><name><surname>Kainz</surname><given-names>H</given-names></name></person-group><article-title>Physiological plausible muscle paths: A MATLAB tool for detecting and resolving muscle path discontinuities in musculoskeletal OpenSim models</article-title><source>Gait Posture</source><year>2025</year><volume>117</volume><fpage>S21</fpage><lpage>2</lpage></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherman</surname><given-names>MA</given-names></name><name><surname>Seth</surname><given-names>A</given-names></name><name><surname>Delp</surname><given-names>SL</given-names></name></person-group><article-title>What Is a Moment Arm? Calculating Muscle Effectiveness In Biomechanical Models Using Generalized Coordinates</article-title><source>Proc ASME Des Eng Tech Conf</source><year>2013</year><comment>2013</comment><pub-id pub-id-type="doi">10.1115/DETC2013-13633</pub-id><pub-id pub-id-type="pmcid">PMC4404026</pub-id><pub-id pub-id-type="pmid">25905111</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dryden</surname><given-names>IL</given-names></name><name><surname>Mardia</surname><given-names>KV</given-names></name></person-group><source>Statistical Shape Analysis: With Applications in R</source><publisher-name>John Wiley &amp; Sons</publisher-name><year>2016</year></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavanagh</surname><given-names>PR</given-names></name><name><surname>Komi</surname><given-names>PV</given-names></name></person-group><article-title>Electromechanical delay in human skeletal muscle under concentric and eccentric contractions</article-title><source>Eur J Appl Physiol Occup Physiol</source><year>1979</year><volume>42</volume><fpage>159</fpage><lpage>63</lpage><pub-id pub-id-type="pmid">527577</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name><name><surname>Maine</surname><given-names>S</given-names></name><name><surname>Walsh</surname><given-names>HPJ</given-names></name><name><surname>Carty</surname><given-names>CP</given-names></name></person-group><article-title>Joint kinematic calculation based on clinical direct kinematic versus inverse kinematic gait models</article-title><source>J Biomech</source><year>2016</year><volume>49</volume><fpage>1658</fpage><lpage>69</lpage><pub-id pub-id-type="pmid">27139005</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conconi</surname><given-names>M</given-names></name><name><surname>Montefiori</surname><given-names>E</given-names></name><name><surname>Sancisi</surname><given-names>N</given-names></name><name><surname>Mazzà</surname><given-names>C</given-names></name></person-group><article-title>Modeling musculoskeletal dynamics during gait: Evaluating the best personalization strategy through model anatomical consistency</article-title><source>Appl Sci (Basel)</source><year>2021</year><volume>11</volume><elocation-id>8348</elocation-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bosmans</surname><given-names>L</given-names></name><name><surname>Valente</surname><given-names>G</given-names></name><name><surname>Wesseling</surname><given-names>M</given-names></name><name><surname>Van Campen</surname><given-names>A</given-names></name><name><surname>De Groote</surname><given-names>F</given-names></name><name><surname>De Schutter</surname><given-names>J</given-names></name><etal/></person-group><article-title>Sensitivity of predicted muscle forces during gait to anatomical variability in musculotendon geometry</article-title><source>J Biomech</source><year>2015</year><volume>48</volume><fpage>2116</fpage><lpage>23</lpage><pub-id pub-id-type="pmid">25979383</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giarmatzis</surname><given-names>G</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name><name><surname>Wesseling</surname><given-names>M</given-names></name><name><surname>Van Rossom</surname><given-names>S</given-names></name><name><surname>Verschueren</surname><given-names>S</given-names></name></person-group><article-title>Loading of hip measured by hip contact forces at different speeds of walking and running: Hip loading measured by hcfs at different speeds of walking and running</article-title><source>J Bone Miner Res</source><year>2015</year><volume>30</volume><fpage>1431</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">25704538</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Killen</surname><given-names>BA</given-names></name><name><surname>Wesseling</surname><given-names>M</given-names></name><name><surname>Perez-Boerema</surname><given-names>F</given-names></name></person-group><article-title>A multi-scale modelling framework combining musculoskeletal rigid-body simulations with adaptive finite element analyses, to evaluate the impact of femoral geometry…</article-title><source>PLoS</source><year>2020</year><pub-id pub-id-type="doi">10.1371/journal.pone.0235966</pub-id><pub-id pub-id-type="pmcid">PMC7377390</pub-id><pub-id pub-id-type="pmid">32702015</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stansfield</surname><given-names>BW</given-names></name><name><surname>Nicol</surname><given-names>AC</given-names></name><name><surname>Paul</surname><given-names>JP</given-names></name><name><surname>Kelly</surname><given-names>IG</given-names></name><name><surname>Graichen</surname><given-names>F</given-names></name><name><surname>Bergmann</surname><given-names>G</given-names></name></person-group><article-title>Direct comparison of calculated hip joint contact forces with those measured using instrumented implants. An evaluation of a three-dimensional mathematical model of the lower limb</article-title><source>J Biomech</source><year>2003</year><volume>36</volume><fpage>929</fpage><lpage>36</lpage><pub-id pub-id-type="pmid">12757801</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergmann</surname><given-names>G</given-names></name><name><surname>Bender</surname><given-names>A</given-names></name><name><surname>Dymke</surname><given-names>J</given-names></name><name><surname>Duda</surname><given-names>G</given-names></name><name><surname>Damm</surname><given-names>P</given-names></name></person-group><article-title>Standardized loads acting in hip implants</article-title><source>PLoS One</source><year>2016</year><volume>11</volume><elocation-id>e0155612</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0155612</pub-id><pub-id pub-id-type="pmcid">PMC4873223</pub-id><pub-id pub-id-type="pmid">27195789</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Damm</surname><given-names>P</given-names></name><name><surname>Kutzner</surname><given-names>I</given-names></name><name><surname>Bergmann</surname><given-names>G</given-names></name><name><surname>Rohlmann</surname><given-names>A</given-names></name><name><surname>Schmidt</surname><given-names>H</given-names></name></person-group><article-title>Comparison of in vivo measured loads in knee, hip and spinal implants during level walking</article-title><source>J Biomech</source><year>2017</year><volume>51</volume><fpage>128</fpage><lpage>32</lpage><pub-id pub-id-type="pmid">27914627</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenaerts</surname><given-names>G</given-names></name><name><surname>De Groote</surname><given-names>F</given-names></name><name><surname>Demeulenaere</surname><given-names>B</given-names></name><name><surname>Mulier</surname><given-names>M</given-names></name><name><surname>Van der Perre</surname><given-names>G</given-names></name><name><surname>Spaepen</surname><given-names>A</given-names></name><etal/></person-group><article-title>Subject-specific hip geometry affects predicted hip joint contact forces during gait</article-title><source>J Biomech</source><year>2008</year><volume>41</volume><fpage>1243</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">18346745</pub-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kainz</surname><given-names>H</given-names></name><name><surname>Wesseling</surname><given-names>M</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name></person-group><article-title>Generic scaled versus subject-specific models for the calculation of musculoskeletal loading in cerebral palsy gait: Effect of personalized musculoskeletal…</article-title><source>Clin Biomech</source><year>2021</year><pub-id pub-id-type="pmid">34098149</pub-id></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davico</surname><given-names>G</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name><name><surname>Carty</surname><given-names>CP</given-names></name><name><surname>Killen</surname><given-names>BA</given-names></name><name><surname>Devaprakash</surname><given-names>D</given-names></name><name><surname>Pizzolato</surname><given-names>C</given-names></name></person-group><article-title>Multi-level personalization of neuromusculoskeletal models to estimate physiologically plausible knee joint contact forces in children</article-title><source>Biomech Model Mechanobiol</source><year>2022</year><volume>21</volume><fpage>1873</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1007/s10237-022-01626-w</pub-id><pub-id pub-id-type="pmcid">PMC9700656</pub-id><pub-id pub-id-type="pmid">36229699</pub-id></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davico</surname><given-names>G</given-names></name><name><surname>Pizzolato</surname><given-names>C</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name><name><surname>Obst</surname><given-names>SJ</given-names></name><name><surname>Walsh</surname><given-names>HPJ</given-names></name><name><surname>Carty</surname><given-names>CP</given-names></name></person-group><article-title>Increasing level of neuromusculoskeletal model personalisation to investigate joint contact forces in cerebral palsy: A twin case study</article-title><source>Clin Biomech (Bristol, Avon)</source><year>2020</year><volume>72</volume><fpage>141</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">31877532</pub-id></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Killen</surname><given-names>BA</given-names></name><name><surname>Willems</surname><given-names>M</given-names></name><name><surname>Jonkers</surname><given-names>I</given-names></name></person-group><article-title>An open-source framework for the generation of OpenSim models with personalised knee joint geometries for the estimation of articular contact mechanics</article-title><source>J Biomech</source><year>2024</year><volume>177</volume><elocation-id>112387</elocation-id><pub-id pub-id-type="pmid">39488193</pub-id></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smale</surname><given-names>KB</given-names></name><name><surname>Conconi</surname><given-names>M</given-names></name><name><surname>Sancisi</surname><given-names>N</given-names></name><name><surname>Krogsgaard</surname><given-names>M</given-names></name><name><surname>Alkjaer</surname><given-names>T</given-names></name><name><surname>Parenti-Castelli</surname><given-names>V</given-names></name><etal/></person-group><article-title>Effect of implementing magnetic resonance imaging for patient-specific OpenSim models on lower-body kinematics and knee ligament lengths</article-title><source>J Biomech</source><year>2019</year><volume>83</volume><fpage>9</fpage><lpage>15</lpage><pub-id pub-id-type="pmid">30527390</pub-id></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackland</surname><given-names>DC</given-names></name><name><surname>Lin</surname><given-names>Y-C</given-names></name><name><surname>Pandy</surname><given-names>MG</given-names></name></person-group><article-title>Sensitivity of model predictions of muscle function to changes in moment arms and muscle-tendon properties: a Monte-Carlo analysis</article-title><source>J Biomech</source><year>2012</year><volume>45</volume><fpage>1463</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">22507351</pub-id></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Modenese</surname><given-names>L</given-names></name><name><surname>Ceseracciu</surname><given-names>E</given-names></name><name><surname>Reggiani</surname><given-names>M</given-names></name><name><surname>Lloyd</surname><given-names>DG</given-names></name></person-group><article-title>Estimation of musculotendon parameters for scaled and subject specific musculoskeletal models using an optimization technique</article-title><source>J Biomech</source><year>2016</year><volume>49</volume><fpage>141</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">26776930</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><caption><title>Author Summary</title></caption><p>Questions about healthy or pathological movement patterns in humans—critical for injury prevention, rehabilitation, and sports performance—are often explored with the help of musculoskeletal modelling. This approach uses a priori defined generic models of the human musculoskeletal system to study joint moments, muscle activation patterns and joint contact forces. Typically, a generic model is scaled to match the participant’s dimensions linearly, which does not allow for an accurate representation of their bone and muscle morphology. We developed a semi-automatic workflow to creating magnetic resonance imaging-based personalisation that does not require bone segmentation but closely matches individual geometry with the help of a non-linear fitting function. By comparing magnetic resonance imaging-based and generic-scaled models in eight individuals, we show systematic bias inherent to one of the most popular musculoskeletal models and demonstrate the importance of model personalisation for healthy adults. Our personalisation pipeline is openly available and easy to set up, which will facilitate musculoskeletal modelling studies based on highly personalised models in clinical and research settings, potentially improving treatment planning and biomechanical assessments in the future.</p></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><title>Geometry comparison between MRI-based and generic-scaled models. P01, P02, etc. labels indicate the participant.</title><p>(a) Principal component analysis of superimposed and standardised data for bone landmarks and muscle path points: the first two principal components; triangles indicate generic-scaled models and stars show MRI-based models. Male models are depicted in red, and female models in blue. (b) Shape differences between generic-scaled and MRI-based models as described by the first principal component. Bone surfaces and small black points indicate bones and muscle paths of an average model across all models. Large blue and green points depict the configuration at PC1 minimum value. Lines between homologous points show direction and magnitude of change between the mean and PC1 minimum. (c) Differences of the segment length in the MRI-based models from the generic-scaled ones, expressed as per cent of the segment length in the generic-based model. (d) Root mean squared distances (RMSD) between generic-scaled and MRI-based models in muscle path point locations.</p></caption><graphic xlink:href="EMS207620-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comparison of kinematics and dynamics between MRI-based and generic-scaled models, averaged across all individuals.</title><p>(a) Inverse Kinematics, (b) Inverse Dynamics, (c) cosine similarity between mean waveforms in the generic-scaled and MRI-based models.</p></caption><graphic xlink:href="EMS207620-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Comparison of joint contact forces calculated with generic-scaled and MRI-based models: (a) Mean waveforms with standard deviation; and (b) boxplot of values exported for first and second peaks of waveforms.</title></caption><graphic xlink:href="EMS207620-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Correlations between the shape of all models (MRI-based and generic-scaled) as described by PC1 peak joint forces: (a) for the complete set of individuals, (b) excluding P07.</title></caption><graphic xlink:href="EMS207620-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Locations of homologous landmarks on the generic model. The primary set of 21 landmarks is shown in blue. Landmarks in femur head centres are not visible. The secondary set comprising 89 landmarks is shown in pink.</p></caption><graphic xlink:href="EMS207620-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p>Landmarks in 3D Slicer before data transformation into OpenSim coordinate sets. Blue points show bony landmarks. Pink points show muscle paths. Yellow bone representations were created by warping the template OpenSim geometry onto the participant’s landmark data.</p></caption><graphic xlink:href="EMS207620-f006"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Participants’ statistics, mean (SD)</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle"/><th align="center" valign="middle">Number</th><th align="center" valign="middle">Age [years]</th><th align="center" valign="middle">Mass [kg]</th><th align="center" valign="middle">Height [m]</th></tr></thead><tbody><tr><td align="left" valign="middle"><bold>Males</bold></td><td align="center" valign="middle">4</td><td align="center" valign="middle">26.75 (5.07)</td><td align="center" valign="middle">76.43 (10.32)</td><td align="center" valign="middle">1.84 (0.06)</td></tr><tr><td align="left" valign="middle"><bold>Females</bold></td><td align="center" valign="middle">4</td><td align="center" valign="middle">36.25 (9.15)</td><td align="center" valign="middle">59.53 (5.49)</td><td align="center" valign="middle">1.64 (0.07)</td></tr></tbody></table></table-wrap></floats-group></article>