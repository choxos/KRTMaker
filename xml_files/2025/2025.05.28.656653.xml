<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206120</article-id><article-id pub-id-type="doi">10.1101/2025.05.28.656653</article-id><article-id pub-id-type="archive">PPR1029127</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Neural Spectral Prediction for Structure Elucidation with Tandem Mass Spectrometry</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Runzhong</given-names></name><email>runzhong@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Manjrekar</surname><given-names>Mrunali</given-names></name><email>mrunali@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mahjour</surname><given-names>Babak</given-names></name><email>bmahjour@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Avila-Pacheco</surname><given-names>Julian</given-names></name><email>jravilap@broadinstitute.org</email><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Provenzano</surname><given-names>Joules</given-names></name><email>jpro@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Reynolds</surname><given-names>Erin</given-names></name><email>er.reynolds@northeastern.edu</email><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lederbauer</surname><given-names>Magdalena</given-names></name><email>magled@mit.edu</email><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Mashin</surname><given-names>Eivgeni</given-names></name><email>emashin@broadinstitute.org</email><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Goldman</surname><given-names>Samuel</given-names></name><email>samlg@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Mingxun</given-names></name><email>mingxun.wang@ucr.edu</email><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Weng</surname><given-names>Jing-Ke</given-names></name><email>jingke.weng@northeastern.edu</email><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Plata</surname><given-names>Desirée L.</given-names></name><email>dplata@mit.edu</email><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Clish</surname><given-names>Clary B.</given-names></name><email>clary@broadinstitute.org</email><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Coley</surname><given-names>Connor W.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042nb2s44</institution-id><institution>Massachusetts Institute of Technology</institution></institution-wrap>, <addr-line>77 Massachusetts Ave</addr-line>, <city>Cambridge</city>, <postal-code>02139</postal-code>, <state>MA</state>, <country country="US">United States</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0ya142</institution-id><institution>Broad Institute of MIT and Harvard</institution></institution-wrap>, <addr-line>415 Main St</addr-line>, <city>Cambridge</city>, <postal-code>02142</postal-code>, <state>MA</state>, <country country="US">United States</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04t5xt781</institution-id><institution>Northeastern University</institution></institution-wrap>, <addr-line>360 Huntington Ave</addr-line>, <city>Boston</city>, <postal-code>02115</postal-code>, <state>MA</state>, <country country="US">United States</country></aff><aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zurich</institution></institution-wrap>, <addr-line>Rämistrasse 101</addr-line>, <city>Zurich</city>, <postal-code>8092</postal-code>, <country country="CH">Switzerland</country></aff><aff id="A5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03nawhv43</institution-id><institution>University of California</institution></institution-wrap>, <city>Riverside</city>, <addr-line>900 University Ave, Riverside</addr-line>, <postal-code>92521</postal-code>, <state>CA</state>, <country country="US">United States</country></aff><author-notes><corresp id="CR1"><label>*</label>Corresponding author(s). <email>ccoley@mit.edu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>04</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>01</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nd/4.0/">CC BY-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Structural elucidation using untargeted tandem mass spectrometry (MS/MS) has played a critical role in advancing scientific discovery [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>]. However, differentiating molecular fragmentation patterns between isobaric structures remains a prominent challenge in metabolomics [<xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R10">10</xref>], drug discovery [<xref ref-type="bibr" rid="R11">11</xref>–<xref ref-type="bibr" rid="R13">13</xref>], and reaction screening [<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R17">17</xref>], presenting a significant barrier to the cost-effective and rapid identification of unknown molecular structures. Here, we present a geometric deep learning model, ICEBERG, that simulates collision-induced dissociation in mass spectrometry to generate chemically plausible fragments and their relative intensities with awareness of collision energies and polarities. We utilize ICEBERG predictions to facilitate structure elucidation by ranking a set of candidate structures based on the similarity between their predicted <italic>in silico</italic> MS/MS spectra and an experimental MS/MS spectrum of interest. This integrated elucidation pipeline enables state-of-the-art performance in compound annotation, with 40% top-1 accuracy on the NIST’20 [M+H]<sup>+</sup> adduct subset and with 92% of correct structures appearing in the top ten predictions in the same dataset. We demonstrate several real-world case studies, including identifying clinical biomarkers of depression and tuberculous meningitis, annotating an aqueous abiotic degradation product of the pesticide thiophanate methyl, disambiguating isobaric products in pooled reaction screening, and annotating biosynthetic pathways in <italic>Withania somnifera.</italic> Overall, this deep learning-based, chemically-interpretable paradigm for structural elucidation enables rapid molecular annotation from complex mixtures, driving discoveries across diverse scientific domains.</p></abstract><kwd-group><kwd>Structural elucidation</kwd><kwd>Geometric deep learning</kwd><kwd>Tandem mass spectrometry</kwd><kwd>Computational metabolomics</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">From metabolomics [<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R10">10</xref>] to drug discovery [<xref ref-type="bibr" rid="R11">11</xref>–<xref ref-type="bibr" rid="R13">13</xref>] and reaction screening [<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R17">17</xref>], the identification of molecular structures using liquid chromatography with tandem mass spectrometry (LC-MS/MS) has broad applications in chemistry and biology. In a structural elucidation campaign with LC-MS/MS, the sample mixture is first separated using liquid chromatography. At each retention time (RT), compounds eluting from the LC column are softly ionized and separated by different mass-over-charge (<italic>m/z</italic>) values, i.e., separated by MS1. Each precursor ion within a certain RT and <italic>m/z</italic> window can then be fed into a second fragmentation stage where the bonds are cleaved and the fragments are detected as peaks, cumulatively called a tandem mass spectrum (MS/MS) [<xref ref-type="bibr" rid="R18">18</xref>]. Different analytical workflows may employ different fragmentation mechanisms, ionization modes, and mass detectors; here, we focus on high-energy collision-induced dissociation (HCD) using Orbitrap mass spectrometers. In the broader context of analytical chemistry, mass spectrometry plays a unique role due to its exceptional sensitivity, precision, and throughput [<xref ref-type="bibr" rid="R19">19</xref>].</p><p id="P3">The ultimate goal of structure elucidation directly from MS/MS spectra remains a formidable challenge [<xref ref-type="bibr" rid="R20">20</xref>]. Current practices overwhelmingly rely on matching experimental MS/MS spectra to MS/MS reference spectral libraries of known structures. However, these reference libraries either require authentic standards or laborious orthogonal structure elucidation—both of which exist only for a vanishingly small fraction of the vast space of all possible molecules. In real-world metabolomics studies, most MS/MS features measured do not have any close match to known standards, known as “metabolite dark matter” [<xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>].</p><p id="P4">We tackle structural elucidation of such dark matter by building upon the recent success of heuristic [<xref ref-type="bibr" rid="R23">23</xref>–<xref ref-type="bibr" rid="R26">26</xref>] and machine learning-based [<xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R30">30</xref>] approaches that predict MS/MS from molecular structures. These prediction approaches mitigate the challenge of limited reference library sizes by generating <italic>in silico</italic> spectra for candidate structures that may not exist in these libraries. These predicted MS/MS spectra can be used to narrow down the candidate structures for an unannotated spectrum, reducing the burden of acquiring standards for experimental validation of a hypothesized structural annotation (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). The ability to predict MS/MS spectra directly from molecular structures illuminates new areas of chemical space that were previously limited by spectral libraries. For example, structure libraries (e.g., HMDB [<xref ref-type="bibr" rid="R31">31</xref>], PubChem [<xref ref-type="bibr" rid="R32">32</xref>]), enumerative techniques (e.g., virtual reaction enumeration [<xref ref-type="bibr" rid="R33">33</xref>]), and generative modeling (e.g., mimicking the distribution of known metabolites [<xref ref-type="bibr" rid="R34">34</xref>]) could provide plausible candidate structures. Such a structural elucidation workflow leveraging MS/MS prediction can significantly accelerate the analysis of large numbers of unannotated spectra, opening up new frontiers in mass spectrometry-based discoveries. We acknowledge that there also exist complementary methods that focus on <italic>de novo</italic> structural prediction from MS/MS without the use of an explicit MS/MS predictor [<xref ref-type="bibr" rid="R35">35</xref>–<xref ref-type="bibr" rid="R39">39</xref>], which are as yet limited in terms of accuracy [<xref ref-type="bibr" rid="R40">40</xref>] and beyond the scope of this paper.</p><p id="P5">Inferring Collision-induced-dissociation by Estimating Breakage Events and Reconstructing their Graphs (ICEBERG) is a geometric deep learning model that simulates mass spectra from structures that we previously introduced in Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>]. The model design is inspired by the physical fragmentation process in tandem mass spectrometers. ICEBERG is a two-stage model where the first model (ICEBERG-Generate) generates the most plausible molecular fragmentations, creating a fragmentation graph in an auto-regressive manner; given the highest probability fragments, the second model, ICEBERG-Score, predicts intensities and hydrogen shifts for each fragment (<xref ref-type="fig" rid="F1">Fig. 1b</xref>), yielding the final MS/MS prediction.</p><p id="P6">In this work, we introduce a substantially improved version of ICEBERG as a state-of-the-art neural MS/MS predictor for small organic molecules (<xref ref-type="fig" rid="F6">Extended Data Fig. 1</xref>). We expand the relevant application space by including collision energy and ionization polarity (positive and negative mode) as key parameters. Further, we introduce new innovations in model design, such as contrastive fine-tuning [<xref ref-type="bibr" rid="R42">42</xref>], accounting for possible charge migrations in fragmentation [<xref ref-type="bibr" rid="R43">43</xref>], and utilizing spectral entropy [<xref ref-type="bibr" rid="R44">44</xref>] in training and retrieval. These technical improvements together contribute to an increase in top-1 annotation accuracy from 25% to 40% on the NIST’20 benchmark. To demonstrate how these improvements have impacted elucidation, we showcase successful applications with different sets of candidate structures: we identify three novel biomarkers from clinical studies and identify a pesticide degradation product with candidates from PubChem (<xref ref-type="fig" rid="F1">Fig. 1c</xref>), elucidate isobaric products in pooled reaction screening with candidates from virtual reaction enumeration (<xref ref-type="fig" rid="F1">Fig. 1d</xref>), and annotate structures in a biosynthetic pathway with candidates from reference structures (<xref ref-type="fig" rid="F1">Fig. 1e</xref>). Collectively, these case studies illustrate how the ICEBERG approach to MS/MS prediction enables structure elucidation in diverse scientific settings. Finally, the open-source philosophy of ICEBERG may help democratize access for the scientific community in annotating structures from LC-MS/MS.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title><italic>In silico</italic> validation of MS/MS prediction accuracy through quantitative benchmarking</title><p id="P7">We evaluate ICEBERG on Orbitrap HCD spectra collected from the NIST’20 dataset, a library developed by the National Institute of Standards and Technology (NIST) [<xref ref-type="bibr" rid="R45">45</xref>]. Following prior work, we reserve ~10% of reference spectra for testing and ~10% for validation. Generalization is assessed through two types of splits. In the random split, structures with different InChI keys are randomly put into training, validation, and testing sets (<xref ref-type="fig" rid="F2">Fig. 2a</xref>). In the scaffold split, structures with the same molecular scaffold are kept in the same set (<xref ref-type="fig" rid="F2">Fig. 2b</xref>), providing a more challenging out-of-distribution evaluation that assesses the ability of the model to generalize to distinct structural families. For both splits, we evaluate the spectral prediction accuracy in terms of the average cosine similarity of the predicted and ground truth spectra, as well as retrieval accuracy to assess models’ performance in elucidation given a set of candidate isomers from PubChem. Experiments are repeated with 3 random seeds, and the 95% confidence interval (CI) values are shown in cosine similarity plots. Further details can be found in <xref ref-type="sec" rid="S9">Methods</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Section S2</xref>.</p><p id="P8">The architectural and training modifications improve ICEBERG by a substantial margin from 25.1% (95% CI 23.5–26.7%) top-1 [M+H]<sup>+</sup> retrieval accuracy to 40.0% (95% CI 39.2–40.8%) on the random split of NIST’20 (<xref ref-type="fig" rid="F2">Fig. 2a</xref>) and from 22.9% (95% CI 22.5–23.3%) to 33.5% (95% CI 33.0–34.0%) on the scaffold split (<xref ref-type="fig" rid="F2">Fig. 2b</xref>). Additional quantitative results show performance on a wider range of adducts for which not all baseline methods are able to make predictions [<xref ref-type="bibr" rid="R30">30</xref>] (<xref ref-type="fig" rid="F7">Extended Data Fig. 2</xref>). We benchmark heuristic-based fragmentation methods while excluding comparisons to certain other baseline models that do not permit retraining (<xref ref-type="supplementary-material" rid="SD1">Supplementary Section S2.1</xref>). All technical contributions are validated by an ablation study that confirms the positive contribution of each design choice to overall performance (<xref ref-type="table" rid="T1">Extended Data Table 1</xref>).</p><p id="P9">ICEBERG-generated spectra provide consistently accurate predictions across a range of peak counts and molecular masses, achieving robust retrieval accuracies (<xref ref-type="fig" rid="F2">Fig. 2c</xref>) and similarities to experimental spectra (<xref ref-type="fig" rid="F2">Fig. 2d</xref>). We attribute the comparatively strong performance on large structures to the model’s ability to reason about chemical structure through graph neural networks, whereby the learned message passing generalizes across molecular sizes. Model performance across several adduct types shows that higher performance is achieved for adducts that are more abundant in the dataset (<xref ref-type="fig" rid="F2">Fig. 2e</xref>).</p><p id="P10">ICEBERG predicts fragmentation spectra in an inherently explanatory manner that attributes each peak to a substructural fragment, yet the veracity of these explanations is not straightforward to assess. Experimental spectra do not typically reveal such detailed structural information about each peak [<xref ref-type="bibr" rid="R46">46</xref>]. However, we evaluate the consistency of ICEBERG’s explanations with intuition and with inductive cleavage energy [<xref ref-type="bibr" rid="R47">47</xref>]. The trend of model predictions across different collision energies shows that ICEBERG learns to break “weaker” C-O bonds at lower collision energies and learns to break “stronger” aromatic bonds at higher collision energies (<xref ref-type="fig" rid="F8">Extended Data Fig. 3a</xref>). Collision energy-dependent fragmentation further aligns with density functional theory (DFT)-level calculations of cleavage energy of the same fragmentation event (<xref ref-type="fig" rid="F8">Extended Data Fig. 3b</xref>). Qualitatively, <italic>in silico</italic> spectra are predicted to have more fragmentation as collision energy increases (<xref ref-type="fig" rid="F8">Extended Data Fig. 3c</xref>).</p></sec><sec id="S4"><title>Elucidation of biomarkers in clinical metabolomics studies of depression</title><p id="P11">We set out to demonstrate how ICEBERG can be used effectively in a structure elucidation pipeline across a variety of small-molecule compound classes that arise from chemical and biological discovery campaigns. Clinical metabolomics studies provide one such testing ground: an interest in metabolites across a wide range of concentrations—where isolation and elucidation by NMR are usually unrealistic—makes LC-MS/MS followed by computational analysis a well-suited technique for the discovery of novel metabolites.</p><p id="P12">We first apply ICEBERG to the investigation of differentially enriched plasma metabolomic features from a post-traumatic stress disorder (PTSD) distress study collected from the Nurses’ Health Study cohort [<xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R50">50</xref>] (<xref ref-type="fig" rid="F3">Fig. 3a</xref>). Earlier research has established a metabolite “distress” score based on features in the cohort associated with anxiety and depression phenotypes; this study identified other metabolite features that were associated with persistent PTSD symptoms. Previously conducted cohort statistical analysis identified a feature (198.1238 <italic>m/z</italic>) to be significantly negatively associated with persistent PTSD symptoms (<italic>p</italic> = 0.014) [<xref ref-type="bibr" rid="R50">50</xref>]. To elucidate this metabolite, we first infer the formula based on the MS1 and MS2 information, filtering a set of candidate formulae proposed by SIRIUS [<xref ref-type="bibr" rid="R53">53</xref>]. We then query isomers from PubChem with chemical formulae matching that of the most plausible formula, C<sub>9</sub>H<sub>15</sub>N<sub>3</sub>O<sub>2</sub>, from which we identify 8,413 candidates.</p><p id="P13">ICEBERG is used to simulate the MS/MS spectra of these candidate structures with experimental parameters: an [M+H]<sup>+</sup> adduct and collision energies of 4, 8, 12, 16, 20 eV, which correspond to 10%, 20%, 30%, 40%, 50% normalized collision energies (NCEs), respectively. Spectral entropy similarities are computed between each candidate <italic>in silico</italic> MS/MS and the true experimental spectrum, averaged among all collision energies. This retrieval strategy proposes hercynine (<bold>1</bold>) as the top-ranked structure (<xref ref-type="fig" rid="F3">Fig. 3b</xref>). Following ICEBERG’s prediction, a hercynine standard was ordered, experimentally analyzed, and confirmed as a match by both RT and MS/MS (<xref ref-type="fig" rid="F9">Extended Data Fig. 4a</xref>). Hercynine is a histidine derivative with known correlations with fungi or mushroom food intake [<xref ref-type="bibr" rid="R54">54</xref>, <xref ref-type="bibr" rid="R55">55</xref>] but limited documented correlation with psychiatric state. The related derivative ergothioneine is well-established as an antioxidant and known to have neuroprotective effects [<xref ref-type="bibr" rid="R56">56</xref>], leaving room for further exploration and validation of possible causal biological mechanisms.</p><p id="P14">The same trauma study identified another higher-mass unknown feature (538.3873 <italic>m/z</italic>) that is positively associated with persistent PTSD symptoms (p = 0.029) [<xref ref-type="bibr" rid="R50">50</xref>]. 55 candidates with the formula proposed by SIRIUS, C<sub>27</sub>H<sub>56</sub>NO<sub>7</sub>P, are retrieved from PubChem. We use ICEBERG to simulate [M+H]<sup>+</sup> spectra for these 55 candidates at the same five NCEs (<xref ref-type="fig" rid="F3">Fig. 3c</xref>). The second-ranked structure <bold>9</bold> contains a canonical glycerol subgroup distinctive of lysophosphatidylcholine (LPC) and lysophosphatidylethanolamine (LPE) lipids, a subgroup not present in similarly-scored structures <bold>8</bold> and <bold>10</bold>. Based on this signature and class-level associations, we ordered LPC 19:0 (<bold>9</bold>), and confirmed its structure by RT and MS/MS matching to the standard (<xref ref-type="fig" rid="F9">Extended Data Fig. 4b</xref>). Alongside several glycerophospholipids have been previously found to be implicated in mental disorders [<xref ref-type="bibr" rid="R57">57</xref>] and neurodegenerative disorders [<xref ref-type="bibr" rid="R58">58</xref>], LPC 19:0 is a novel biomarker of persistent PTSD symptoms; the abundance of metabolites in the same glycerophospholipid class, such as LPE 18:0 and LPC 34:2, was previously found to be statistically significant by Zhu et al. [<xref ref-type="bibr" rid="R50">50</xref>].</p></sec><sec id="S5"><title>Elucidation of biomarkers in clinical metabolomics studies of tuberculous meningitis</title><p id="P15">Following the same elucidation approach, we next apply ICEBERG to a tuberculous meningitis (TBM) study comprising 1,069 patients from Southeast Asia, from whom both cerebrospinal fluid (CSF) and plasma metabolomic samples were collected [<xref ref-type="bibr" rid="R51">51</xref>, <xref ref-type="bibr" rid="R52">52</xref>, <xref ref-type="bibr" rid="R59">59</xref>] (<xref ref-type="fig" rid="F3">Fig. 3d</xref>). This study yielded an unknown feature (260.1717 <italic>m/z</italic>) negatively correlated with both TBM infection (<italic>β</italic> = – 2.844, <italic>p</italic> = 7.4 × 10<sup>–8</sup>) and TBM mortality (<italic>β</italic> = –1.24, <italic>p</italic> = 0.07) [<xref ref-type="bibr" rid="R52">52</xref>]. We consider 61 candidates collected from PubChem with formula C<sub>10</sub>H<sub>21</sub>N<sub>5</sub>O<sub>3</sub> and generate their [M+H]<sup>+</sup> spectra at 10%, 20%, 30%, 40%, 50% NCEs. ICEBERG ranks GABA-Arg (<bold>2</bold>), an arginine conjugate of the GABA (gamma-aminobutyric acid) neurotransmitter [<xref ref-type="bibr" rid="R60">60</xref>], as the top structure (<xref ref-type="fig" rid="F3">Fig. 3e</xref>). Several other arginine conjugates yield similar spectral similarity scores, but the gamma-butyric substructure is most structurally plausible as measured by predicted spectral similarity to the experimental CSF spectrum. A custom-synthesized authentic standard of GABA-Arg exhibited an exact RT and MS/MS match, validating ICEBERG’s proposed annotation (<xref ref-type="fig" rid="F9">Extended Data Fig. 4c</xref>). ICEBERG has sufficient structural sensitivity to distinguish between subtly different isomers <bold>2</bold>, <bold>11</bold>, and <bold>12</bold> and correctly identify this feature as GABA-Arg.</p><p id="P16">While other GABA-amino acid conjugates have been identified and characterized, such as homocarnosine, a GABA-histidine conjugate thought to confer neuroprotective benefits following ischemic stroke [<xref ref-type="bibr" rid="R61">61</xref>], few other GABA conjugates with proteogenic amino acids have recorded biological significance to date.</p></sec><sec id="S6"><title>Elucidation of an abiotic degradant of thiophanate methyl pesticide</title><p id="P17">The importance of structural elucidation extends beyond metabolomics and into fields including environmental forensics. Here, using ICEBERG, we aim to characterize novel hydrolysis and photolysis products of pesticides collected in a controlled degradation study. Aqueous solutions of thiophanate methyl (<bold>13</bold>), a heavily used pesticide, were aged in simulated sunlight and dark conditions under environmentally relevant starting concentrations of 10 parts-per-billion (ppb). Aliquots were collected between 0 and 70 days to capture time-resolved system dynamics. Experimental features were collected using an untargeted, data-dependent acquisition mode with three stepped collision energies at 30%, 40%, and 60% NCEs. The challenge of identifying low parts-per-billion compounds and mapping their largely unexplored reactivity makes environmental forensics a compelling application for LC-MS/MS elucidation [<xref ref-type="bibr" rid="R7">7</xref>].</p><p id="P18">Thiophanate methyl (<bold>13</bold>) yielded an unknown (i.e., unmatched to reference spectra) degradation feature (192.0766 <italic>m/z</italic>) in both light-exposed and dark conditions but with substantially different temporal dynamics (<xref ref-type="fig" rid="F3">Fig. 3f</xref>). To determine its identity, we employ the same formula candidate retrieval strategy, retrieving 4,790 C<sub>9</sub>N<sub>9</sub>N<sub>3</sub>O<sub>2</sub> structures from PubChem and using ICEBERG to simulate all isomers’ spectra at the three collision energies. Visual inspection of the top-ranking candidates illustrates their close structural similarity, differing only in ring connectivity and subsequent spectral similarity; yet, the benzene ring from <bold>13</bold> is only preserved in the top-1 candidate, carbendazim (<bold>14</bold>) (<xref ref-type="fig" rid="F3">Fig. 3g</xref>). Acquisition and analysis of an authentic standard confirmed a match based on both RT and MS/MS (<xref ref-type="fig" rid="F9">Extended Data Fig. 4d</xref>).</p><p id="P19">Carbendazim is a known metabolite, a known photolysis product of thiophanate methyl (<bold>13</bold>) [<xref ref-type="bibr" rid="R62">62</xref>–<xref ref-type="bibr" rid="R65">65</xref>], an active fungicide, and a known pollutant in environmental samples [<xref ref-type="bibr" rid="R66">66</xref>]. Carbendazim is also well-classified as a reproductive toxin and carcinogen to both aquatic life and humans, with concentrations as low as 12.4-1240 ppb considered to confer an increased cancer risk [<xref ref-type="bibr" rid="R67">67</xref>–<xref ref-type="bibr" rid="R69">69</xref>]. However, carbendazim has not thus far been detected as a hydrolysis product of <bold>13</bold>. The kinetic patterns are distinct under light and dark conditions, where <bold>14</bold> is transient in light samples but accumulates in dark samples. The observed behavior may indicate the potential for carbendazim to accumulate in waters outside of the photic zone, in sediments, and within the human body, where photolytic pathways are inaccessible.</p></sec><sec id="S7"><title>Elucidation of isobaric reaction products facilitates data-rich experimentation</title><p id="P20">Beyond the detection of compounds in biological and environmental samples, we further demonstrate the utility of ICEBERG in synthetic chemistry. We report a proof-of-concept in assessing the relative reactivity of substrates through pooled experimentation. Traditional reaction screening evaluates reactants in a singleton fashion, in parallel or in sequence, which can be time-consuming and labor-intensive depending on the number of combinations under consideration (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). In contrast, pooled screening enables a single experiment to test multiple substrates (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). However, these approaches typically use MS1 to deconvolute (pooled) reaction products with unknown retention times, which imposes the critical limitation that products must be non-isobaric and therefore easily distinguishable [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R71">71</xref>, <xref ref-type="bibr" rid="R72">72</xref>]. Here, we show ICEBERG can enable pooled reaction screening in settings even with isobaric substrates (and thus expected isobaric products) (<xref ref-type="fig" rid="F4">Fig. 4c</xref>), expanding the utility of these data-rich experimental workflows. This use case is distinct from the prior demonstrations in that the analytical challenge is not to identify fully unknown products, but rather to disambiguate expected products from a mixture where retention times are not known and no authentic standards are available.</p><p id="P21">We exemplify our MS/MS-enabled workflow with the analysis of reactivity trends across eight copper-catalyzed C–N coupling reactions. Using conditions reported by Zhang et al. [<xref ref-type="bibr" rid="R70">70</xref>], four isobaric amines were reacted with two halides within the same reaction vessel (<xref ref-type="fig" rid="F4">Fig. 4d</xref>). Eight MS/MS features with the expected precursor masses (by MS1) were identified in quantifiable abundance after 48 hours at 150 °C. The eight products were matched to the eight features by the maximal linear assignment based on all pairwise spectral entropy similarities (<xref ref-type="fig" rid="F10">Extended Data Fig. 5</xref>). While expected products <bold>20c</bold> and <bold>20d</bold> co-elute, we are still able to distinguish them using a diagnostic fragment at 183.1043 <italic>m/z</italic> that ICEBERG recognizes would only appear in <bold>20d</bold> (<xref ref-type="fig" rid="F11">Extended Data Fig. 6b</xref>). Each product is quantified by integrated extracted ion chromatogram (XIC) normalized using an internal standard (IS).</p><p id="P22">The intention of pooled screening is to provide an efficient way of accessing data-rich information. We therefore validate the pooled results by comparing normalized product abundances to the results of eight singleton experiments. All structure assignments are confirmed by RT (<xref ref-type="fig" rid="F11">Extended Data Fig. 6a</xref>) and MS/MS matches. We also confirm that the reactivity trends among the four isobaric amines are largely preserved when comparing the pooled and singleton results (<xref ref-type="fig" rid="F4">Fig. 4e</xref>). Though applied here to only four isobaric amines, these results illustrate how ICEBERG can enable deconvolution of isobaric and even co-eluting products that would otherwise impede such pooled reaction screening campaigns.</p></sec><sec id="S8"><title>Elucidation of biosynthetic pathways in <italic>Withania somnifera</italic></title><p id="P23">Another elucidation strategy arises in applications such as analyzing biosynthetic pathways, where close chemical structure relatives of an unknown metabolite are available. To find close structural candidates, we can leverage the alignment strategies used in molecular networking for matching unknown MS/MS spectra to known reference spectra [<xref ref-type="bibr" rid="R73">73</xref>]. We further build upon these alignments to address the computational problem of localizing the specific site on the known molecule where the unknown structure differs as recently formalized by the ModiFinder algorithm [<xref ref-type="bibr" rid="R74">74</xref>]. Instead of utilizing combinatorial fragmentation explanations for MS/MS peaks, as with ModiFinder, we hypothesized that the use of ICEBERG-generated spectra and substructural explanations could localize where structural changes had taken place.</p><p id="P24">We apply ICEBERG to investigate the biosynthetic pathway in <italic>Withania somnifera</italic> that produces bioactive compounds withanolide A (<bold>30</bold>) and withaferin A (<bold>31</bold>), among other withanolides, from 24-methylene cholesterol (<bold>22</bold>). Purified with-anolides exhibit anti-cancer, anti-inflammatory, cardioprotective, neurological, and immunomodulatory activities [<xref ref-type="bibr" rid="R75">75</xref>–<xref ref-type="bibr" rid="R78">78</xref>] and clinical trials demonstrate that <italic>W. somnifera</italic> extracts can reduce depression, anxiety, and insomnia [<xref ref-type="bibr" rid="R79">79</xref>, <xref ref-type="bibr" rid="R80">80</xref>]; improve cognitive function and memory [<xref ref-type="bibr" rid="R81">81</xref>]; and enhance cardiorespiratory endurance and recovery from stroke [<xref ref-type="bibr" rid="R82">82</xref>, <xref ref-type="bibr" rid="R83">83</xref>]. Elucidating the enzymes involved in withanolide biosynthesis might enable biomanufacturing of withanolides for clinical and pharmaceutical applications.</p><p id="P25">Until recently, only the first committed step of withanolide biosynthesis was known: the conversion of 24-methylene cholesterol (<bold>22</bold>) to 24-methyl desmosterol (<bold>23</bold>) by the sterol isomerase 24ISO [<xref ref-type="bibr" rid="R84">84</xref>]. To elucidate additional steps, candidate genes for involvement in withanolide biosynthesis were identified by Reynolds et al. [<xref ref-type="bibr" rid="R85">85</xref>] through biosynthetic gene cluster mining. Candidate genes were tested by heterologous expression in <italic>Saccharomyces cerevisiae</italic> (yeast) followed by metabolite extraction and LC-MS/MS analysis to identify pathway intermediates. Further experimental details are reported in ref. [<xref ref-type="bibr" rid="R85">85</xref>]. For each reaction, the mass difference and MS/MS spectra of the reactant and the product are known.</p><p id="P26">We use ICEBERG to predict potential modification sites for six intermediates using their respective known reactants as reference MS/MS spectra (<xref ref-type="fig" rid="F5">Fig. 5a</xref>). For instance, in the transformation from compound <bold>26</bold> to <bold>27</bold>, we analyze the experimental spectrum of <bold>27</bold> against the experimental spectrum of <bold>26</bold> to identify peak pairs differing by 15.999 Da, indicative of hydroxylation. The ICEBERG-predicted peak annotations then provide the candidate substructures responsible for those peaks. We score each reference structure atom by summing intensities from matched peaks where its substructure includes that atom; atoms scored over 0.8 are proposed as probable modification sites. In the case of <bold>26</bold> → <bold>27</bold>, we identify six probable hydroxylation sites.</p><p id="P27">While ICEBERG does not propose a unique structure for each pathway intermediate in this setting, it narrows down potential sites of modification to streamline downstream metabolite identification. Viewed as a classification problem, this process achieves perfect recall: the true modification site is always contained within the 3-8 proposed candidates. This refinement is especially valuable given that NMR validation requires both bulk production and labor-intensive purification. With this stepwise elucidation strategy with ICEBERG, the biosynthetic pathway from compound <bold>23</bold> to <bold>29</bold> is successfully reconstructed (<xref ref-type="fig" rid="F5">Fig. 5b</xref>), with key intermediates confirmed by NMR as shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Section S9</xref>. Altogether, these results demonstrate ICEBERG’s ability to guide and ultimately accelerate the structural elucidation of biosynthetic intermediates in complex natural product pathways.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P28">In this work, we report a geometric deep learning framework, ICEBERG, that learns to simulate fragmentation in tandem mass spectrometry with state-of-the-art accuracy. We demonstrate successful applications of ICEBERG in identifying clinical biomarkers associated with depression (<bold>1</bold>, <bold>9</bold>) and tuberculous meningitis (<bold>2</bold>), elucidating an abiotic degradant of thiophanate methyl pesticide (<bold>14</bold>), enabling pooled reaction screening by deconvoluting isobaric reaction products (<bold>20a-d</bold>, <bold>21a-d</bold>), and annotatingintermediate products in biosynthetic pathways in <italic>W. somnifera</italic> (<bold>24-29</bold>). These successful applications demonstrate structural elucidation in diverse chemical, biological, and medical domains and underscore the promise that ICEBERG-aided elucidation workflows with LC-MS/MS hold for the broader scientific community.</p><p id="P29">We envision several key avenues for future improvement that may enhance the utility of ICEBERG in additional prospective elucidation campaigns. First, ICEBERG accounts for rearrangements through its fragmentation prediction and allowance of ±6 hydrogen shifts; while this provides coverage of most known rearrangement rules (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures S1 and S2</xref>), revisions to the architecture might yield a more general solution. Second, we have focused our demonstrations on settings where structural hypotheses can be derived from PubChem, reaction enumeration, or minor modifications relative to a reference structure. There are many cases where structural candidates are not available, motivating the use of <italic>de novo</italic> generation approaches [<xref ref-type="bibr" rid="R35">35</xref>–<xref ref-type="bibr" rid="R39">39</xref>]. ICEBERG can be used to generate virtually unlimited numbers of simulated spectra to enable large-scale training of these generative models as foundation models for structure elucidation. Finally, as a practical consideration, ICEBERG could be augmented with a confidence estimator to help scientists prioritize which authentic standards to synthesize or purchase for unknown spectral features of interest.</p><p id="P30">We envision that deep learning-based MS/MS prediction will play a pivotal role in structural elucidation workflows across the community. The advances in ICEBERG presented here demonstrate a leap in prediction performance that enhances the viability of using MS/MS prediction for structure elucidation. By releasing a capable model that is open source and readily accessible by the community, ICEBERG is able to be used by the community and integrated into existing and newly developed structure elucidation pipelines, which in turn will drive new discoveries both scientifically and algorithmically.</p></sec><sec id="S10" sec-type="methods"><title>Methods</title><sec id="S11"><title>Molecular space</title><p id="P31">Within the scope of this paper, molecules consisting of the elements C, H, N, O, S, P, F, Cl, Br, I, Si, B, Se, Fe, Co, As, Na, and K with molecular masses below 1,500 Dalton are considered. Molecules beyond this scope are not supported by ICEBERG’s model design.</p></sec><sec id="S12"><title>ICEBERG model architecture</title><p id="P32">ICEBERG is a neural MS/MS predictor for small molecules. Traditionally, MS/MS predictors rely on combinatorial enumeration of bond breakages to mimic physical fragmentation processes [<xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R86">86</xref>]. While physically grounded, these methods are computationally intensive and often inaccurate due to overestimation of intensities. Deep learning-based predictors significantly reduce inference time while maintaining competitive accuracy, although they either fully discard physical constraints [<xref ref-type="bibr" rid="R29">29</xref>, <xref ref-type="bibr" rid="R87">87</xref>] or only partially retain them via subformulae [<xref ref-type="bibr" rid="R27">27</xref>, <xref ref-type="bibr" rid="R28">28</xref>]. ICEBERG strikes a balance by generating a pruned fragmentation graph and predicting intensity values using transformers [<xref ref-type="bibr" rid="R88">88</xref>]. It is a two-stage model consisting of ICEBERG-Generate and ICEBERG-Score (<xref ref-type="fig" rid="F1">Fig. 1a</xref> and <xref ref-type="fig" rid="F6">Extended Data Fig. 1</xref>).</p><sec id="S13"><title>ICEBERG-Generate</title><p id="P33">(<xref ref-type="fig" rid="F6">Extended Data Fig. 1a</xref>). ICEBERG-Generate simulates high-energy collision-induced dissociation (HCD) by iteratively predicting the most probable fragments through stepwise atom and bond removals from the molecular graph. This autoregressive process supports multiple fragmentation steps, producing a directed acyclic graph (DAG) with the original molecule as the root and its fragments as children. At each step, the model receives a (sub)fragment as input and outputs the probabilities of atom breakages, which are then used as inputs for the next step. As the ground-truth data provides only <italic>m/z</italic> values and intensities—without annotated fragmentation graphs—we use the MAGMa algorithm [<xref ref-type="bibr" rid="R24">24</xref>] to generate DAG labels (please refer to Training ICEBERG for details). We allow up to three atom-breaking steps and a maximum of six bond breakages. All predicted fragments are ranked by their cumulative probabilities, and the top 100 are passed to ICEBERG-Score.</p></sec><sec id="S14"><title>ICEBERG-Score</title><p id="P34">(<xref ref-type="fig" rid="F6">Extended Data Fig. 1b</xref>). ICEBERG-Score processes the fragmentation DAG to predict peak intensities for each fragment. The architecture comprises: 1) a GNN module that ingests molecular graphs and instrumental parameters to generate embeddings for both fragments and the root molecule, and 2) a set transformer [<xref ref-type="bibr" rid="R88">88</xref>] that predicts the fragment intensities. Multiple intensity values are predicted for the same fragment to account for hydrogen shifts and charge migration. Predicted intensities are merged into a mass spectrum using the corresponding <italic>m/z</italic> values. For more details, readers are referred to Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>] and the open-source code at <ext-link ext-link-type="uri" xlink:href="https://github.com/coleygroup/ms-pred">https://github.com/coleygroup/ms-pred</ext-link>.</p></sec><sec id="S15"><title>Incorporating collision energy</title><p id="P35">Collision energy is a critical LC-MS/MS parameter that heavily influences fragmentation patterns. In Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>], spectra with varying collision energies were merged and treated as a single prediction task. Here, we explicitly incorporate collision energy (in eV) using a 64-dimensional positional embedding (32 sine, 32 cosine terms, base 10,000) to encode its continuous value. This embedding is concatenated with the input features for both ICEBERG-Generate and ICEBERG-Score.</p></sec><sec id="S16"><title>Incorporating negative mode and featurization</title><p id="P36">Earlier versions of ICEBERG supported only positive mode adducts, such as [M+H]<sup>+</sup> [M+Na]<sup>+</sup>, and [M–H<sub>2</sub>O+H]<sup>+</sup>. However, many metabolites (e.g., fatty acids, phosphorylated or halogenated compounds) are better fragmented in negative mode [<xref ref-type="bibr" rid="R89">89</xref>, <xref ref-type="bibr" rid="R90">90</xref>], particularly [M–H]<sup>–</sup>. We incorporate negative mode by encoding new adduct types as one-hot vectors. Additional chemical knowledge is encoded as multi-hot vectors, including features such as positive/negative mode, alkali metal adducts, proton gain/loss, halogen adducts, loss of H<sub>2</sub>O or CO<sub>2</sub>, and gain of NH<sub>3</sub>. All these features are concatenated with the model input.</p></sec><sec id="S17"><title>Intensity prediction with charge migration</title><p id="P37">ICEBERG-Score predicts up to 13 × 2 = 26 intensity values per fragment. Part of ICEBERG-Generate’s output is the number of bond-breaking steps needed for each fragment, and we allow for a ±1 hydrogen shift for each step to accommodate rearrangements (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures S1 and S2</xref>). With a maximum of six bond breakages, this results in 13 hydrogen shift states (<xref ref-type="fig" rid="F6">Extended Data Fig. 1b</xref>). We also incorporate both charge retention fragmentation (CRF) and charge migration fragmentation (CMF) [<xref ref-type="bibr" rid="R47">47</xref>]. For instance, for [M+A] + and denoting B as the neutral loss, both [M–B+A]<sup>+</sup> (CRF) and [M–B]<sup>+</sup> (CMF) might be observed, i.e., CRF indicates adduct retention, whereas CMF indicates adduct detachment and charge migration. We introduce CMF as part of the technical contributions of this paper. While Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>] implicitly handled CMF for [M+H]<sup>+</sup> with hydrogen shifts, other adducts such as [M+Na]+ or [M–H<sub>2</sub>O+H]<sup>+</sup> require explicit modeling. The benefits of charge migration modeling are demonstrated in the ablation study (<xref ref-type="table" rid="T1">Extended Data Table 1</xref>).</p></sec></sec><sec id="S18"><title>Dataset processing</title><p id="P38">The NIST’20 dataset [<xref ref-type="bibr" rid="R45">45</xref>] comprises standardized spectra collected using various instruments. Among these, HCD LC-MS/MS spectra—most commonly obtained via Orbitrap instruments—are predominant in structural elucidation. We therefore focus exclusively on HCD spectra. We assume that all deposited spectra have undergone basic noise filtering and perform no further preprocessing. We square root all intensities (between 0 and 1) to emphasize lower-intensity peaks. To align with our target use case, we exclude non-HCD spectra. Although this work does not include QTOF spectra, our approach can be extended to handle them by retraining or finetuning.</p><p id="P39">We aim to support the most common adduct types for the maximum applicability of ICEBERG. Due to the challenges in modeling, we exclude adducts with multiple charges (e.g., [M+2H]<sup>2+</sup>), multiple neutral molecules (e.g., [2M+H]<sup>+</sup>). Less abundant adducts that comprise less than 0.8% of the dataset (except [M+K]<sup>+</sup>) are also excluded. The following adducts are used for training and evaluation: [M+H]<sup>+</sup>, [M+Na]<sup>+</sup>, [M+K]<sup>+</sup>, [M–H<sub>2</sub>O+H]<sup>+</sup>, [M–2H<sub>2</sub>O+H]<sup>+</sup>, [M+NH3+H]<sup>+</sup>, [M–H]<sup>–</sup>, [M+Cl]<sup>–</sup>, [M–H<sub>2</sub>O–H]<sup>–</sup>, and [M–CO<sub>2</sub>–H]<sup>–</sup>. Collision energy values recorded as normalized collision energy (NCE) are converted to eV using: <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtext>collision</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>energy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>NCE</mml:mtext><mml:mo>·</mml:mo><mml:mtext>precursor</mml:mtext><mml:mspace width="0.2em"/><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mtext>eV</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P40">Molecules with unsupported atom types (<xref ref-type="sec" rid="S10">Molecular space</xref>) and molecular masses larger than 1,500 Dalton are also filtered out. After filtering, the dataset contains 530,640 spectra across 25,541 unique molecules (<xref ref-type="table" rid="T2">Extended Data Table 2</xref>). All models use the same 8:1:1 train/validation/test split. We follow the data splits created by previous benchmarks [<xref ref-type="bibr" rid="R28">28</xref>, <xref ref-type="bibr" rid="R41">41</xref>], while since these benchmarks are positive-adduct-only, we maintain the same split on positive adducts and build upon for structures that only appear in the negative mode.</p></sec><sec id="S19"><title>Training ICEBERG</title><sec id="S20"><title>Hardware setup</title><p id="P41">All experiments reported in this paper are conducted on a workstation with AMD 3995WX CPU, 4×NVIDIA A5000 GPU, and 512GB RAM.</p></sec><sec id="S21"><title>Generating fragmentation DAG labels and training ICEBERG-Generate</title><p id="P42">ICEBERG-Generate requires annotated fragmentation paths, which are absent in raw NIST’20 data. We use the MAGMa algorithm [<xref ref-type="bibr" rid="R86">86</xref>] to enumerate all potential fragmentations. Each generated fragment is matched to a peak <italic>m/z</italic> value, allowing for ±6 hydrogen shifts and both [M–B+A]<sup>+</sup> and [M–B]<sup>+</sup> forms if the adduct is [M+A]<sup>+</sup> (analogous rules apply in negative mode). High-resolution HCD spectra (i.e., Orbitrap, with 5 ppm accuracy) facilitate accurate fragment identification. For matched fragments, we construct a minimal spanning tree to serve as the fragmentation DAG label for training. ICEBERG-Generate is trained at a starting learning rate of 0.000996, decays by 0.7214 after every 5,000 steps, and has a dropout rate of 0.2. These hyperparameters are directly adapted from ref. [<xref ref-type="bibr" rid="R91">91</xref>]. Training for 16 epochs takes 6.2 hours on a single NVIDIA RTX A5000 GPU. Before training ICEBERGScore, we need to use the pretrained ICEBERG-Generate to predict DAG labels on the training set, which takes 3.0 GPU hours.</p></sec><sec id="S22"><title>Training ICEBERG-Score with spectral entropy loss</title><p id="P43">ICEBERG-Score is trained to minimize differences between predicted and reference spectra. Spectral entropy, as proposed by Li et al. [<xref ref-type="bibr" rid="R44">44</xref>], has been shown to outperform cosine similarity for spectrum comparison. While Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>] employed cosine loss, we adopt entropy loss to better emphasize low-intensity peaks: <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>entropy</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>loss</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>log</mml:mi><mml:mspace width="0.2em"/><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:mo>∀</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P44">where <italic>a<sub>m</sub></italic> and <italic>b<sub>m</sub></italic> denote the normalized intensities at <italic>m/z</italic> = <italic>m</italic> in spectra 1 and 2, respectively. The normalization term log 4 reflects the maximum entropy divergence and ensures the entropy loss is between 0 and 1. Because many predicted intensity values are zero (due to absent fragments), intensity prediction resembles a classification task. Emphasizing low-intensity peaks aids the model in distinguishing relevant fragments. From a deep learning perspective, cross-entropy is also the natural choice for training classifier models, aligning with our adoption of the entropy-based loss. ICEBERG-Score is trained at a starting learning rate of 0.000736, decays by 0.825 after every 5,000 steps, and has a dropout rate of 0.1. Training for 21 epochs takes 9.2 hours on a single NVIDIA RTX A5000 GPU.</p></sec><sec id="S23"><title>Contrastive finetuning</title><p id="P45">Contrastive finetuning has emerged as an effective regularization strategy to improve model generalization [<xref ref-type="bibr" rid="R42">42</xref>]. To enhance retrieval accuracy, we develop a contrastive finetuning procedure using negative samples from Pub-Chem and mutated molecules. Specifically, 50% of negative structures share the same chemical formula (from PubChem), and 50% are generated by single-step graph mutations [<xref ref-type="bibr" rid="R92">92</xref>, <xref ref-type="bibr" rid="R93">93</xref>]. During training, ICEBERG predicts on one positive and three negative structures simultaneously, yielding the following pairwise distance matrix: <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P46">where <italic>d<sub>i</sub></italic> is the entropy distance (<xref ref-type="disp-formula" rid="FD2">Equation (2)</xref>) between the predicted spectrum for structure <italic>i</italic> and the ground-truth spectrum, and <italic>d</italic><sub>1</sub> is the positive sample. We encourage <italic>d</italic><sub>1</sub> to be the smallest via a differentiable soft ranking using the Sinkhorn algorithm [<xref ref-type="bibr" rid="R94">94</xref>, <xref ref-type="bibr" rid="R95">95</xref>], where <inline-formula><mml:math id="M4"><mml:mrow><mml:mover accent="true"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = Sinkhorn(–<bold>D</bold>, <italic>τ</italic>) and <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> ∈ [0,1] is the top-left entry of <inline-formula><mml:math id="M6"><mml:mrow><mml:mover accent="true"><mml:mtext mathvariant="bold">D</mml:mtext><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. Sinkhorn could be viewed as a soft, differentiable version of linear assignment, where a smaller temperature τ will lead to a more discrete output. We set τ = 0.05. When <italic>d</italic><sub>1</sub> is the smallest among {<italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>, <italic>d</italic><sub>3</sub>, <italic>d</italic><sub>4</sub>}, Sinkhorn algorithm will yield a larger <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The larger <inline-formula><mml:math id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is, the larger the gap between <italic>d</italic><sub>1</sub> and the next smallest <italic>d<sub>i</sub></italic>(<italic>i</italic> = 1). The contrastive loss is then: <disp-formula id="FD4"><label>(4)</label><mml:math id="M9"><mml:mrow><mml:mtext>contrastive</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>loss</mml:mtext><mml:mo>=</mml:mo><mml:mtext>entropy</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>loss</mml:mtext><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mspace width="0.2em"/><mml:mo>·</mml:mo><mml:mi>ReLU</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P47">where <italic>w</italic> (empirically set to 1) scales the contrastive term, and the offset <italic>δ</italic> = 0.5 prevents overfitting by discouraging further maximization when <inline-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is already large. To finetune ICEBERG-Score, we have to run ICEBERG-Generate on all decoy structures (10 per training sample), which takes 28.1 GPU hours. The finetuning step has a learning rate of 0.0005, decays by 0.825 after every 5,000 steps, and has a dropout rate of 0.1. Training for 10 epochs takes 7.9 hours on two NVIDIA RTX A5000 GPUs.</p></sec></sec><sec id="S24"><title>Molecular formula identification</title><p id="P48">We identify the molecular formula of unknown MS/MS features by either manual annotation or running SIRIUS [<xref ref-type="bibr" rid="R53">53</xref>]. For the structural elucidation campaign for GABA-Arg (<bold>2</bold>), we enumerate all possible chemical formula that matches its MS1 mass and manually check if it is a reasonable chemical formula by comparing MS2 peaks to the subformulae. For campaigns for hercynine (<bold>1</bold>), LPC 19:0 (<bold>9</bold>), and carbendazim (<bold>14</bold>), we run SIRIUS (5.8.6) under the command line interface and take the top formula prediction. For the reaction screening study (<xref ref-type="fig" rid="F4">Fig. 4</xref>) and the elucidation of biosynthetic pathway for <italic>W. somnifera</italic> (<xref ref-type="fig" rid="F5">Fig. 5</xref>), the formulae are derived based on known starting materials and reaction rules derived from the difference in <italic>m/z</italic>.</p></sec><sec id="S25"><title>PubChem candidates generation</title><p id="P49">We use our locally cached version of PubChem (downloaded in January 2024, with 116,124,942 SMILES) for all numerical evaluations and case studies. We compute chemical formulae for all structures, create a mapping from chemical formula to SMILES, and deduplicate SMILES and stereoisomers based on InChI keys. We also ignore salts, disjoint structures, molecules containing unsupported elements, and molecules that are heavier than 1,500 Dalton.</p></sec><sec id="S26"><title>Spectral similarity metric</title><p id="P50">We use spectral entropy similarity [<xref ref-type="bibr" rid="R44">44</xref>] as the metric to rank candidate structures for all structural elucidation campaigns reported in this work. For the elucidation of hercynine (<bold>1</bold>), LPC 19:0 (<bold>9</bold>), GABA-Arg (<bold>2</bold>), and carbendazim (<bold>14</bold>), their precursor ion peaks are masked, and the remaining peaks are normalized when computing the entropy similarity to avoid the bias introduced by the precursor peak. For the deconvolution of <bold>20a-d</bold> and <bold>21a-d</bold>, the precursor peak is retained because the relative peak intensity of the precursor dictates the disambiguation process. The experimental spectra are processed with electronic denoising [<xref ref-type="bibr" rid="R96">96</xref>], square-rooted to emphasize the lower-intensity peaks, and we only consider the top-20 peaks from each spectrum (except for withanolides that have rich fragmentation).</p></sec><sec id="S27"><title>Handling stepped collision energy</title><p id="P51">In the studies of the abiotic degradation of thiophanate methyl and pooled C-N coupling reaction screening, we ran LC-MS/MS at stepped collision energy to achieve rich fragmentation patterns with multiple energies while avoiding the time cost of running the same sample multiple times. In the stepped collision energy mode, the precursor ions are first fragmented at different energies, and then detected at the same time. To mimic the same process with ICEBERG, as the applied energy values are known (30%, 40%, 60% NCEs), we use ICEBERG to predict spectra at these energies, and then merge them to create the <italic>ín sílíco</italic> spectra. When merging, spectra intensities are summed if their <italic>m/z</italic> values are the same to the 4th decimal point.</p></sec><sec id="S28"><title>Disambiguation of co-eluting peak areas</title><p id="P52">In the pooled screening of the C-N coupling reactions, <bold>20c</bold> and <bold>20d</bold> co-eluted, making it non-straightforward to measure the abundances of <bold>20c</bold> and <bold>20d</bold> in the pool because their peak areas are merged at the precursor mass. As predicted by ICEBERG, we use their diagnostic peaks in MS2, which are also in-source fragments in MS1, to compute their relative abundance. More specifically, we look for the XIC peak of 170.0965 <italic>m/z</italic> at the same RT as <bold>20c</bold>’s precursor peak, and 183.1043 <italic>m/z</italic> for <bold>20d</bold> (<xref ref-type="fig" rid="F11">Extended Data Fig. 6b</xref>). We compute these two XIC peak areas (<bold>20c</bold>’s 170.0965 <italic>m/z</italic> PROD/IS: 8.19×10<sup>–3</sup>; <bold>20d</bold>’s 183.1043 <italic>m/z</italic> PROD/IS: 1.91 ×10<sup>–3</sup>) and use them as weights tosplit the merged precursor peak area. The merged XIC peak has PROD/IS: 2.378, and <bold>20c</bold>’s PROD/IS is estimated as 1.928, <bold>20d</bold>’s PROD/IS is estimated as 0.450.</p></sec><sec id="S29"><title>Structure annotation from reference structures</title><p id="P53">To annotate possible modification sites from a known reference, we extend the ModiFinder algorithmic framework [<xref ref-type="bibr" rid="R74">74</xref>] with ICEBERG. ModiFinder identifies possible modification sites from a known reference structure and a structurally similar unknown, where both of their MS/MS spectra are characterized. The original Mod-iFinder then utilizes a combinatorial fragmentation enumeration [<xref ref-type="bibr" rid="R86">86</xref>] to explain peaks with the <italic>m/z</italic> shift of interest, where intensity scores are accumulated for each atom. In this work, we replace the combinatorial enumeration with ICEBERG and introduce several technical adjustments. First, ICEBERG learns and predicts fragment structures, which are used to match peaks of interest by <italic>m/z</italic> values. If ICEBERG predicts multiple fragments with the same <italic>m/z</italic> value, all substructures are considered, and the score is reweighted by ICEBERG-predicted intensities for each of them. Second, we apply an <italic>m/z</italic> value cut-off (set to 200 for case studies in <xref ref-type="fig" rid="F5">Fig. 5</xref>) to avoid accumulating scores for larger fragments, which contain less information to help locate the modification site. Finally, the scores are normalized to the range between 0 and 1, and candidates with atom-level scores &gt; 0.8 are considered as possible modification sites, as highlighted in yellow in <xref ref-type="fig" rid="F5">Fig. 5</xref>.</p></sec></sec><sec sec-type="extended-data" id="S30"><title>Extended Data</title><fig id="F6" position="anchor"><label>Extended Data Fig. 1</label><caption><title>Details of ICEBERG-Generate and ICEBERG-Score with architectural improvements in this work.</title><p id="P54"><bold>a</bold>, ICEBERG-Generate takes a (sub)structure as input and predicts plausible fragmentation. It is an auto-regressive model, i.e., the first-step fragments are fed into the model again to fragment them further, creating second-step fragments. The model predicts probabilities at each atom about whether this atom should be removed, and we allow up to 3 fragmentation steps for the fragmentation graph. <bold>b</bold>, ICEBERG-Score takes the top 100 fragments from the fragmentation graph and predicts intensities for each of them. The output dimension is 26, including up to ±6 hydrogen shift that accounts for rearrangements relative to two “base” <italic>m/z</italic> values that account for retaining or migrating the charge from the adduct ion (Na<sup>+</sup> in this case).</p></caption><graphic xlink:href="EMS206120-f006"/></fig><fig id="F7" position="anchor"><label>Extended Data Fig. 2</label><caption><title>Quantitative evaluation results on more adduct types beyond [M+H]<sup>+</sup></title><p id="P55">Like <xref ref-type="fig" rid="F2">Fig. 2a-b</xref>, Error bars with 95% confidence interval are reported for 3 random seeds for cosine similarity. Only mean retrieval accuracies are plotted, and their confidence intervals are reported in <xref ref-type="supplementary-material" rid="SD1">Supplementary Tables S4, S6 and S7</xref>. <bold>a-b</bold>, The data splits are the same as results reported in <xref ref-type="fig" rid="F2">Fig. 2</xref>, and the models are the same without retraining. <bold>c</bold>, For all positive mode adducts ([M+H]<sup>+</sup>, [M+Na]<sup>+</sup>, [M+K]<sup>+</sup>, [M–H<sub>2</sub>O+H]<sup>+</sup>, [M–2H<sub>2</sub>O+H]<sup>+</sup>, [M+NH<sub>3</sub>+H]<sup>+</sup>) under random split, ICEBERG outperforms all competing methods in terms of spectrum prediction accuracy and retrospective evaluation of retrieval accuracy. <bold>d</bold>, Similar trend is observed on the scaffold split, where ICEBERG outperforms peer methods by a significant margin. <bold>e</bold>, For all positive and negative adducts (aforementioned positive adducts and [M–H]<sup>–</sup>, [M+Cl]<sup>–</sup>, [M–H<sub>2</sub>O–H]<sup>–</sup>, [M–CO<sub>2</sub>–H]<sup>–</sup>), with random split, ICEBERG reaches state-of-the-art accuracy. Peer methods that do not support negative mode are excluded for comparison. <bold>f</bold>, When switched to scaffold split, ICEBERG still performs as the state-of-the-art. In terms of retrieval accuracy, the performance degeneration is not significant from random split to scaffold split, and from positive mode to negative mode. <bold>g-h</bold>, ICEBERG outperforms the learning-free fragmentation heuristic MetFrag among the adduct types supported by MetFrag ([M+H]<sup>+</sup>, [M+Na]<sup>+</sup>, [M+K]<sup>+</sup>, [M+NH<sub>3</sub>+H]<sup>+</sup>, [M–H]<sup>–</sup>, [M+Cl]<sup>–</sup>).</p></caption><graphic xlink:href="EMS206120-f007"/></fig><fig id="F8" position="anchor"><label>Extended Data Fig. 3</label><caption><title>Qualitative evaluation demonstrates ICEBERG’s interpretability as matched by chemistry intuition and DFT calculations.</title><p id="P56"><bold>a</bold>, For the six most abundant bond types in NIST’20 testing dataset, ICEBERG’s prediction of the average contribution to spectral intensity matches chemistry intuitions. Bond type notations follow SMARTS primitives, where C:C and C:N denote aromatic bonds, C=O denotes double bond, and C-O, C-N, C-C denote single bonds. C-O and C=O bond fragmentations are of greater relative importance at lower collision energies, and their trends are similar, alongside the double bond exhibits stronger. ICEBERG also learns that aromatic bonds are stable at lower collision energies, but break more often when the collision energy goes as high as 100 eV. <bold>b</bold>, ICEBERG learns bond cleavage orders that associate with DFT calculation of inductive cleavage energy (<italic>C</italic>). Inductive cleavage energy is defined as the bond dissociation energy for charged ions. In the case studies of <bold>2</bold> and <bold>7</bold>, ICEBERG predictions align with <italic>C</italic> in most cases, except for the outlier at 10 eV for <bold>2</bold>. <bold>c</bold>, A sweep of collision energies for <bold>2</bold> illustrates that ICEBERG learns the expected shift from higher <italic>m/z</italic> peaks to lower <italic>m/z</italic> peaks as collision energy increases.</p></caption><graphic xlink:href="EMS206120-f008"/></fig><fig id="F9" position="anchor"><label>Extended Data Fig. 4</label><caption><title>Matching of authentic standards and the biomarkers and pesticide degradant shows agreement in both RT and MS/MS fragmentation.</title><p id="P57">For each elucidated structure, we purchase the reference standard, run it with the same LC-MS/MS instrument again, and verify the structure by matching both RT and MS/MS. Experimental spectra of the unknown and the standard are shown in the upper and lower halves of the mirror plots, respectively. Mirror plots viewable on MassIVE for each of these samples are available for hercycine (<bold>1</bold>), LPC:19-0 (<bold>9</bold>), GABA-Arg (<bold>2</bold>), and carbendazim (<bold>14</bold>), with embedded links in the PDF version.</p></caption><graphic xlink:href="EMS206120-f009"/></fig><fig id="F10" position="anchor"><label>Extended Data Fig. 5</label><caption><title>ICEBERG deconvolutes isobaric reaction products in pooled screening.</title><p id="P58">ICEBERG successfully matches isobaric products to their MS/MS. In each mirror plot, the upper half is ICEBERG-predicted spectra (with structures at each row), and the lower half is experimental spectra (with RTs at the top of each column). S denotes the spectral entropy similarity. The assignment of structures to RTs is obtained by solving a maximal linear assignment problem from ICEBERG-predicted similarities. <bold>a</bold>, isobaric products and matching at 212.1432 <italic>m/z</italic> (<bold>20a</bold>-<bold>20d</bold>). <bold>b</bold>, isobaric products and matching at 257.1285 <italic>m/z</italic> (<bold>21a</bold>-<bold>21d</bold>).</p></caption><graphic xlink:href="EMS206120-f010"/></fig><fig id="F11" position="anchor"><label>Extended Data Fig. 6</label><caption><title>Comparison of singleton and pooled reactions validates structural elucidation of our C-N coupling products.</title><p id="P59">Singleton experiments validate our structural elucidation of the products by RT and MS/MS match. The XIC peak intensities are normalized and square-rooted for better visibility of the lower intensity peaks. Mirror plots comparing pooled and singleton products are available via MassIVE for <bold>20a</bold>, <bold>20b</bold>, <bold>20c</bold>, <bold>20d</bold>, <bold>21a</bold>, <bold>21b</bold>, <bold>21c</bold>, <bold>21d</bold>, with embedded links in the PDF version. <bold>b</bold>, For <bold>20c</bold> and <bold>20d</bold> that are coeluting in the pooled experiment, they are deconvoluted by ICEBERG with the diagnostic peak at 183.1043 <italic>m/z</italic>. We visualize ICEBERG predictions with the first two MS2 scans from the pooled peak, representing <bold>20c</bold>, and the last two MS2 scans for <bold>20d</bold>. Since 183.1043 <italic>m/z</italic> and 170.0965 <italic>m/z</italic> are unique in-source fragments for <bold>20c</bold> and <bold>20d</bold>, respectively, the XIC peak areas of these in-source fragments are used to help calculate peak areas of <bold>20c</bold> and <bold>20d</bold> from the pooled experiment.</p></caption><graphic xlink:href="EMS206120-f011"/></fig><table-wrap id="T1" position="anchor" orientation="portrait"><label>Extended Data Table 1</label><caption><title>Ablation study of ICEBERG technical improvements.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Top-<italic>k</italic> accuracy</th><th align="center" valign="top">Top-1</th><th align="center" valign="top">Top-2</th><th align="center" valign="top">Top-3</th><th align="center" valign="top">Top-4</th><th align="center" valign="top">Top-5</th><th align="center" valign="top">Top-6</th><th align="center" valign="top">Top-7</th><th align="center" valign="top">Top-8</th><th align="center" valign="top">Top-9</th><th align="center" valign="top">Top-10</th></tr></thead><tbody><tr><td align="left" valign="top">ICEBERG (Goldman’24 [<xref ref-type="bibr" rid="R41">41</xref>])</td><td align="center" valign="top">0.203</td><td align="center" valign="top">0.383</td><td align="center" valign="top">0.492</td><td align="center" valign="top">0.565</td><td align="center" valign="top">0.617</td><td align="center" valign="top">0.658</td><td align="center" valign="top">0.693</td><td align="center" valign="top">0.722</td><td align="center" valign="top">0.745</td><td align="center" valign="top">0.765</td></tr><tr style="border-top: double"><td align="left" valign="top" colspan="11">ICEBERG (Ours)</td></tr><tr><td align="left" valign="top">  + collision energy</td><td align="center" valign="top">0.214</td><td align="center" valign="top">0.411</td><td align="center" valign="top">0.537</td><td align="center" valign="top">0.610</td><td align="center" valign="top">0.662</td><td align="center" valign="top">0.704</td><td align="center" valign="top">0.739</td><td align="center" valign="top">0.767</td><td align="center" valign="top">0.791</td><td align="center" valign="top">0.809</td></tr><tr><td align="left" valign="top">  + entropy loss</td><td align="center" valign="top">0.288</td><td align="center" valign="top">0.483</td><td align="center" valign="top">0.593</td><td align="center" valign="top">0.669</td><td align="center" valign="top">0.718</td><td align="center" valign="top">0.756</td><td align="center" valign="top">0.784</td><td align="center" valign="top">0.808</td><td align="center" valign="top">0.827</td><td align="center" valign="top">0.844</td></tr><tr><td align="left" valign="top">  + contrastive finetune</td><td align="center" valign="top">0.294</td><td align="center" valign="top">0.498</td><td align="center" valign="top">0.611</td><td align="center" valign="top">0.680</td><td align="center" valign="top">0.729</td><td align="center" valign="top">0.757</td><td align="center" valign="top">0.785</td><td align="center" valign="top">0.806</td><td align="center" valign="top">0.826</td><td align="center" valign="top">0.842</td></tr><tr><td align="left" valign="top">  + × 2 batch size</td><td align="center" valign="top">0.307</td><td align="center" valign="top">0.503</td><td align="center" valign="top">0.612</td><td align="center" valign="top">0.677</td><td align="center" valign="top">0.728</td><td align="center" valign="top">0.762</td><td align="center" valign="top">0.791</td><td align="center" valign="top">0.809</td><td align="center" valign="top">0.826</td><td align="center" valign="top">0.844</td></tr><tr><td align="left" valign="top">  + charge migration</td><td align="center" valign="top"><bold>0.335</bold></td><td align="center" valign="top"><bold>0.543</bold></td><td align="center" valign="top"><bold>0.658</bold></td><td align="center" valign="top"><bold>0.730</bold></td><td align="center" valign="top"><bold>0.774</bold></td><td align="center" valign="top"><bold>0.811</bold></td><td align="center" valign="top"><bold>0.842</bold></td><td align="center" valign="top"><bold>0.865</bold></td><td align="center" valign="top"><bold>0.880</bold></td><td align="center" valign="top"><bold>0.892</bold></td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><p id="P60">We validate the source of accuracy improvements on the NIST’20 random split. Retrieval accuracy values are averaged among all positive and negative adduct types. The training random seed is set to 1 in this ablation study.</p></fn></table-wrap-foot></table-wrap><table-wrap id="T2" position="anchor" orientation="portrait"><label>Extended Data Table 2</label><caption><title>Statistics of the Orbitrap spectra from the NIST’20 library.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="top" style="border-right: solid thin">Mode</th><th align="center" valign="top">Unique molecules</th><th align="center" valign="top">Unique spectra (molecules + adducts)</th><th align="center" valign="top">Unique spectra (molecules + adducts + collision energies)</th></tr></thead><tbody><tr><td align="center" valign="top" style="border-right: solid thin">ESI+</td><td align="center" valign="top">24,403</td><td align="center" valign="top"><underline>35,129</underline></td><td align="center" valign="top">391,288</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">ESI–</td><td align="center" valign="top">10,959</td><td align="center" valign="top">14,035</td><td align="center" valign="top">139,352</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">Total</td><td align="center" valign="top">25,541</td><td align="center" valign="top">49,164</td><td align="center" valign="top"><bold>530,640</bold> (our dataset)</td></tr></tbody></table><table-wrap-foot><fn id="TFN2"><p id="P61">Incorporating collision energy and negative mode ionization increases the number of training spectra 15-fold compared to Goldman et al. [<xref ref-type="bibr" rid="R41">41</xref>] (underlined). Each combination of molecule and adduct has an average of 11 recorded spectra at different collision energies.</p></fn></table-wrap-foot></table-wrap></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Information</label><media xlink:href="EMS206120-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d80aAcFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S31"><title>Acknowledgements</title><p>The authors acknowledge Dr. Itai Levin, Mohammad Reza Shahneh, Jenna Fromer, Dr. Raji Balasubramanian, Dr. Sue Hankinson, Dr. Arjan van Larhooven, Dr. Reinout Van Crevel for assistance, and Dr. Guangqi Wu, Dr. Wenhao Gao, Dr. Keir Adams, Dr. Tianyi Jin, and Rui-Xi Wang for discussions.</p><sec id="S32"><title>Funding</title><p>This work was supported by DSO National Laboratories in Singapore and the Machine Learning for Pharmaceutical Discovery and Synthesis consortium. The Nurses’ Health Study II and follow-up studies were supported by the National Institutes of Health (U01CA176726, R01CA67262, R01AG051600). The Southeast Asia TBM studies were supported by the National Institutes of Health (R01AI145781) and the Wellcome Trust (110179/Z/15/Z and 206724/Z/17/Z). M.M. acknowledges support from the National Institutes of Health under grant no. T32GM087237. J.P. was supported by the MIT Accenture Fellowship. M.L. acknowledges financial support by the Zeno Karl Schindler Foundation, the ETH Foundation, and the Swiss European Mobility Programme.</p></sec></ack><sec id="S33" sec-type="data-availability"><title>Data availability</title><p id="P62">The NIST’20 dataset used to train ICEBERG is a commercial resource and is available for purchase through several vendors worldwide <ext-link ext-link-type="uri" xlink:href="https://chemdata.nist.gov/dokuwiki/doku.php?id=chemdata:distributors">https://chemdata.nist.gov/dokuwiki/doku.php?id=chemdata:distributors</ext-link>. Given the scale of effort required to purchase samples, run experiments, and collect the 530K spectra, and that NIST’20 is the only database where all spectra have collision energy annotations, this dataset is a reasonable investment in mass spectrum-related research in the absence of a thorough open-source replacement. We also provide the code to process raw data at <ext-link ext-link-type="uri" xlink:href="https://github.com/rogerwwww/ms-data-parser">https://github.com/rogerwwww/ms-data-parser</ext-link>. The LC-MS/MS data from case studies and DFT calculations are deposited in MassIVE under the <ext-link ext-link-type="uri" xlink:href="https://massive.ucsd.edu/ProteoSAFe/dataset.jsp?task=dc445037e906465faa8ae64943406f18">identifier MSV000097986</ext-link>.</p></sec><sec id="S34" sec-type="data-availability"><title>Code availability</title><p id="P63">All code for training and testing ICEBERG, together with example applications, is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/coleygroup/ms-pred">https://github.com/coleygroup/ms-pred</ext-link>. As the NIST’20 dataset is a commercial resource requiring the purchase of a license, the pretrained weights will be made available to those with a license.</p></sec><fn-group><title>Declarations</title><fn id="FN1" fn-type="conflict"><p id="P64"><bold>Competing interests.</bold> The authors declare no competing interests.</p></fn><fn id="FN2"><p id="P65"><bold>Ethics approval and consent to participate.</bold> Not applicable.</p></fn><fn id="FN3"><p id="P66"><bold>Consent for publication.</bold> Not applicable.</p></fn><fn id="FN4" fn-type="con"><p id="P67"><bold>Author contributions.</bold> R.W., M.M., S.G., and C.W.C. developed the ICEBERG model. R.W. and M.M. developed the protocol for real-world applications. B.M. and C.W.C. led the pooled C-N coupling reactivity study. J.A.-P., E.M., and C.B.C. led the LC-MS/MS analysis of clinical biomarkers. J.P. and D.L.P. led the pesticide degradation study. E.R. and J.-K.W. led the study of W. <italic>somnifera.</italic> M.L. conducted the computational analysis of inductive collision energies. M.W. proposed the modification localization algorithm. All authors contributed to the writing of this paper.</p></fn><fn id="FN5"><p id="P68"><bold>Materials availability.</bold> The vendor information of purchased analytical standards is presented in supplementary information (<xref ref-type="supplementary-material" rid="SD1">Supplementary Section S4</xref>).</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentry</surname><given-names>EC</given-names></name><etal/></person-group><article-title>Reverse metabolomics for the discovery of chemical structures from humans</article-title><source>Nature</source><year>2024</year><volume>626</volume><fpage>419</fpage><lpage>426</lpage><pub-id pub-id-type="pmcid">PMC10849969</pub-id><pub-id pub-id-type="pmid">38052229</pub-id><pub-id pub-id-type="doi">10.1038/s41586-023-06906-8</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrimpe-Rutledge</surname><given-names>AC</given-names></name><name><surname>Codreanu</surname><given-names>SG</given-names></name><name><surname>Sherrod</surname><given-names>SD</given-names></name><name><surname>McLean</surname><given-names>JA</given-names></name></person-group><article-title>Untargeted metabolomics strategies—challenges and emerging directions</article-title><source>Journal of the American Society for Mass Spectrometry</source><year>2016</year><volume>27</volume><fpage>1897</fpage><lpage>1905</lpage><pub-id pub-id-type="pmcid">PMC5110944</pub-id><pub-id pub-id-type="pmid">27624161</pub-id><pub-id pub-id-type="doi">10.1007/s13361-016-1469-y</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicholson</surname><given-names>JK</given-names></name><etal/></person-group><article-title>Metabolic phenotyping in clinical and surgical environments</article-title><source>Nature</source><year>2012</year><volume>491</volume><fpage>384</fpage><lpage>392</lpage><pub-id pub-id-type="pmid">23151581</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Global chemical effects of the microbiome include new bile-acid conjugations</article-title><source>Nature</source><year>2020</year><volume>579</volume><fpage>123</fpage><lpage>129</lpage><pub-id pub-id-type="pmcid">PMC7252668</pub-id><pub-id pub-id-type="pmid">32103176</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2047-9</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Plasticity of ether lipids promotes ferroptosis susceptibility and evasion</article-title><source>Nature</source><year>2020</year><volume>585</volume><fpage>603</fpage><lpage>608</lpage><pub-id pub-id-type="pmcid">PMC8051864</pub-id><pub-id pub-id-type="pmid">32939090</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2732-8</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pareek</surname><given-names>V</given-names></name><name><surname>Tian</surname><given-names>H</given-names></name><name><surname>Winograd</surname><given-names>N</given-names></name><name><surname>Benkovic</surname><given-names>SJ</given-names></name></person-group><article-title>Metabolomics and mass spectrometry imaging reveal channeled de novo purine synthesis in cells</article-title><source>Science</source><year>2020</year><volume>368</volume><fpage>283</fpage><lpage>290</lpage><pub-id pub-id-type="pmcid">PMC7494208</pub-id><pub-id pub-id-type="pmid">32299949</pub-id><pub-id pub-id-type="doi">10.1126/science.aaz6465</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>Z</given-names></name><etal/></person-group><article-title>A ubiquitous tire rubber–derived chemical induces acute mortality in coho salmon</article-title><source>Science</source><year>2021</year><volume>371</volume><fpage>185</fpage><lpage>189</lpage><pub-id pub-id-type="pmid">33273063</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Discovery of bioactive microbial gene products in inflammatory bowel disease</article-title><source>Nature</source><year>2022</year><volume>606</volume><fpage>754</fpage><lpage>760</lpage><pub-id pub-id-type="pmcid">PMC9913614</pub-id><pub-id pub-id-type="pmid">35614211</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04648-7</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Furuichi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Commensal consortia decolonize enterobacteriaceae via ecological control</article-title><source>Nature</source><year>2024</year><volume>633</volume><fpage>878</fpage><lpage>886</lpage><pub-id pub-id-type="pmcid">PMC11424487</pub-id><pub-id pub-id-type="pmid">39294375</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-07960-6</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Coassolo</surname><given-names>L</given-names></name><etal/></person-group><article-title>Prohormone cleavage prediction uncovers a non-incretin anti-obesity peptide</article-title><source>Nature</source><publisher-name>Nature Publishing Group</publisher-name><year>2025</year><fpage>1</fpage><lpage>10</lpage><comment>URL <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41586-025-08683-y">https://www.nature.com/articles/s41586-025-08683-y</ext-link></comment><pub-id pub-id-type="pmcid">PMC12043402</pub-id><pub-id pub-id-type="pmid">40044869</pub-id><pub-id pub-id-type="doi">10.1038/s41586-025-08683-y</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMillan</surname><given-names>EA</given-names></name><etal/></person-group><article-title>Chemistry-first approach for nomination of personalized treatment in lung cancer</article-title><source>Cell</source><year>2018</year><volume>173</volume><fpage>864</fpage><lpage>878</lpage><pub-id pub-id-type="pmcid">PMC5935540</pub-id><pub-id pub-id-type="pmid">29681454</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.028</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>B-S</given-names></name><etal/></person-group><article-title>An orally available non-nucleotide sting agonist with antitumor activity</article-title><source>Science</source><year>2020</year><volume>369</volume><elocation-id>eaba6098</elocation-id><pub-id pub-id-type="pmid">32820094</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prudent</surname><given-names>R</given-names></name><name><surname>Annis</surname><given-names>DA</given-names></name><name><surname>Dandliker</surname><given-names>PJ</given-names></name><name><surname>Ortholand</surname><given-names>J-Y</given-names></name><name><surname>Roche</surname><given-names>D</given-names></name></person-group><article-title>Exploring new targets and chemical space with affinity selection-mass spectrometry</article-title><source>Nature Reviews Chemistry</source><year>2021</year><volume>5</volume><fpage>62</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">37118102</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Troshin</surname><given-names>K</given-names></name><name><surname>Hartwig</surname><given-names>JF</given-names></name></person-group><article-title>Snap deconvolution: An informatics approach to high-throughput discovery of catalytic reactions</article-title><source>Science</source><year>2017</year><volume>357</volume><fpage>175</fpage><lpage>181</lpage><pub-id pub-id-type="pmid">28706066</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagen</surname><given-names>CC</given-names></name><name><surname>McMinn</surname><given-names>SE</given-names></name><name><surname>Kwan</surname><given-names>EE</given-names></name><name><surname>Jacobsen</surname><given-names>EN</given-names></name></person-group><article-title>Screening for generality in asymmetric catalysis</article-title><source>Nature</source><year>2022</year><volume>610</volume><fpage>680</fpage><lpage>686</lpage><pub-id pub-id-type="pmcid">PMC9645431</pub-id><pub-id pub-id-type="pmid">36049504</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05263-2</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>M</given-names></name><etal/></person-group><article-title>Continuous collective analysis of chemical reactions</article-title><source>Nature</source><year>2024</year><volume>636</volume><fpage>374</fpage><lpage>379</lpage><pub-id pub-id-type="pmcid">PMC11823688</pub-id><pub-id pub-id-type="pmid">39663496</pub-id><pub-id pub-id-type="doi">10.1038/s41586-024-08211-4</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozlov</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Discovering organic reactions with a machine-learning-powered deciphering of tera-scale mass spectrometry data</article-title><source>Nature Communications</source><year>2025</year><volume>16</volume><fpage>2587</fpage><pub-id pub-id-type="pmcid">PMC11911446</pub-id><pub-id pub-id-type="pmid">40090941</pub-id><pub-id pub-id-type="doi">10.1038/s41467-025-56905-8</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McLafferty</surname><given-names>F</given-names></name></person-group><source>Interpretation of mass spectra</source><publisher-name>University Science Books</publisher-name><year>1993</year></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cooks</surname><given-names>RG</given-names></name><name><surname>Yan</surname><given-names>X</given-names></name></person-group><article-title>Mass spectrometry for synthesis and analysis</article-title><source>Annual Review of Analytical Chemistry</source><year>2018</year><volume>11</volume><fpage>1</fpage><lpage>28</lpage><pub-id pub-id-type="pmid">29894228</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebbels</surname><given-names>TM</given-names></name><etal/></person-group><article-title>Recent advances in mass spectrometry-based computational metabolomics</article-title><source>Current opinion in chemical biology</source><year>2023</year><volume>74</volume><elocation-id>102288</elocation-id><pub-id pub-id-type="pmcid">PMC11075003</pub-id><pub-id pub-id-type="pmid">36966702</pub-id><pub-id pub-id-type="doi">10.1016/j.cbpa.2023.102288</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittremieux</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>M</given-names></name><name><surname>Dorrestein</surname><given-names>PC</given-names></name></person-group><article-title>The critical role that spectral libraries play in capturing the metabolomics community knowledge</article-title><source>Metabolomics</source><year>2022</year><volume>18</volume><fpage>94</fpage><pub-id pub-id-type="pmcid">PMC10284100</pub-id><pub-id pub-id-type="pmid">36409434</pub-id><pub-id pub-id-type="doi">10.1007/s11306-022-01947-y</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Abiead</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Discovery of metabolites prevails amid in-source fragmentation</article-title><source>Nat Metab</source><year>2025</year><volume>7</volume><fpage>435</fpage><lpage>437</lpage><pub-id pub-id-type="pmid">40021935</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Schmidt</surname><given-names>S</given-names></name><name><surname>Müller-Hannemann</surname><given-names>M</given-names></name><name><surname>Neumann</surname><given-names>S</given-names></name></person-group><article-title>In silico fragmentation for computer assisted identification of metabolite mass spectra</article-title><source>BMC bioinformatics</source><year>2010</year><volume>11</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC2853470</pub-id><pub-id pub-id-type="pmid">20307295</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-148</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ridder</surname><given-names>L</given-names></name><name><surname>van der Hooft</surname><given-names>JJ</given-names></name><name><surname>Verhoeven</surname><given-names>S</given-names></name></person-group><article-title>Automatic compound annotation from mass spectrometry data using magma</article-title><source>Mass Spectrometry</source><year>2014</year><volume>3</volume><elocation-id>S0033</elocation-id><pub-id pub-id-type="pmcid">PMC4321337</pub-id><pub-id pub-id-type="pmid">26819876</pub-id><pub-id pub-id-type="doi">10.5702/massspectrometry.S0033</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>F</given-names></name><name><surname>Greiner</surname><given-names>R</given-names></name><name><surname>Wishart</surname><given-names>D</given-names></name></person-group><article-title>Competitive fragmentation modeling of esi-ms/ms spectra for putative metabolite identification</article-title><source>Metabolomics</source><year>2015</year><volume>11</volume><fpage>98</fpage><lpage>110</lpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>F</given-names></name><etal/></person-group><article-title>Cfm-id 4.0: more accurate esi-ms/ms spectral prediction and compound identification</article-title><source>Analytical chemistry</source><year>2021</year><volume>93</volume><fpage>11692</fpage><lpage>11700</lpage><pub-id pub-id-type="pmcid">PMC9064193</pub-id><pub-id pub-id-type="pmid">34403256</pub-id><pub-id pub-id-type="doi">10.1021/acs.analchem.1c01465</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Murphy</surname><given-names>M</given-names></name><etal/></person-group><source>Efficiently predicting high resolution mass spectra with graph neural networks</source><conf-name>International Conference on Machine Learning</conf-name><year>2023</year><fpage>25549</fpage><lpage>25562</lpage></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>S</given-names></name><name><surname>Bradshaw</surname><given-names>J</given-names></name><name><surname>Xin</surname><given-names>J</given-names></name><name><surname>Coley</surname><given-names>C</given-names></name></person-group><article-title>Prefix-tree decoding for predicting mass spectra from molecules</article-title><source>Advances in Neural Information Processing Systems</source><year>2023</year><volume>36</volume><fpage>48548</fpage><lpage>48572</lpage></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>A</given-names></name><name><surname>Röst</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name></person-group><article-title>Tandem mass spectrum prediction for small molecules using graph transformers</article-title><source>Nature Machine Intelligence</source><year>2024</year><volume>6</volume><fpage>404</fpage><lpage>416</lpage></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>A</given-names></name><etal/></person-group><article-title>Fragnnet: A deep probabilistic model for mass spectrum prediction</article-title><source>arXiv preprint</source><year>2024</year><elocation-id>arXiv:2404.02360</elocation-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wishart</surname><given-names>DS</given-names></name><etal/></person-group><article-title>Hmdb: the human metabolome database</article-title><source>Nucleic acids research</source><year>2007</year><volume>35</volume><fpage>D521</fpage><lpage>D526</lpage><pub-id pub-id-type="pmcid">PMC1899095</pub-id><pub-id pub-id-type="pmid">17202168</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkl923</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><etal/></person-group><article-title>Pubchem 2025 update</article-title><source>Nucleic Acids Research</source><year>2025</year><volume>53</volume><fpage>D1516</fpage><lpage>D1525</lpage><pub-id pub-id-type="pmcid">PMC11701573</pub-id><pub-id pub-id-type="pmid">39558165</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkae1059</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahjour</surname><given-names>B</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Fromer</surname><given-names>J</given-names></name><name><surname>Casetti</surname><given-names>N</given-names></name><name><surname>Coley</surname><given-names>C</given-names></name></person-group><article-title>Ideation and evaluation of novel multicomponent reactions via mechanistic network analysis and automation</article-title><source>ChemRxiv</source><year>2024</year></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiang</surname><given-names>H</given-names></name><etal/></person-group><article-title>Language model-guided anticipation and discovery of unknown metabolites</article-title><source>bioRxiv</source><year>2024</year><fpage>2024</fpage><lpage>11</lpage></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stravs</surname><given-names>MA</given-names></name><name><surname>Döhrkop</surname><given-names>K</given-names></name><name><surname>Böcker</surname><given-names>S</given-names></name><name><surname>Zamboni</surname><given-names>N</given-names></name></person-group><article-title>Msnovelist: de novo structure generation from mass spectra</article-title><source>Nature Methods</source><year>2022</year><volume>19</volume><fpage>865</fpage><lpage>870</lpage><pub-id pub-id-type="pmcid">PMC9262714</pub-id><pub-id pub-id-type="pmid">35637304</pub-id><pub-id pub-id-type="doi">10.1038/s41592-022-01486-3</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>T</given-names></name><etal/></person-group><article-title>Ms2mol: A transformer model for illuminating dark chemical space from mass spectra</article-title><source>ChemRxiv</source><year>2023</year></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>J</given-names></name><name><surname>Overstreet</surname><given-names>R</given-names></name><name><surname>King</surname><given-names>E</given-names></name><name><surname>Ciesielski</surname><given-names>D</given-names></name></person-group><article-title>Advancing the prediction of ms/ms spectra using machine learning</article-title><source>Journal of the American Society for Mass Spectrometry</source><year>2024</year><volume>35</volume><fpage>2256</fpage><lpage>2266</lpage><pub-id pub-id-type="pmid">39258761</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakkir Shah</surname><given-names>AK</given-names></name><etal/></person-group><article-title>Statistical analysis of feature-based molecular networking results from non-targeted metabolomics data</article-title><source>Nature protocols</source><year>2025</year><volume>20</volume><fpage>92</fpage><lpage>162</lpage><pub-id pub-id-type="pmid">39304763</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bohde</surname><given-names>M</given-names></name><name><surname>Manjrekar</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Ji</surname><given-names>S</given-names></name><name><surname>Coley</surname><given-names>CW</given-names></name></person-group><article-title>Diffms: Diffusion generation of molecules conditioned on mass spectra</article-title><source>arXiv preprint</source><year>2025</year><elocation-id>arXiv:2502.09571</elocation-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bushuiev</surname><given-names>R</given-names></name><etal/></person-group><article-title>Massspecgym: A benchmark for the discovery and identification of molecules</article-title><source>Neural Information Processing Systems Dataset and Benchmark Track</source><year>2024</year></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Coley</surname><given-names>CW</given-names></name></person-group><article-title>Generating molecular fragmentation graphs with autoregressive neural networks</article-title><source>Analytical Chemistry</source><year>2024</year><volume>96</volume><fpage>3419</fpage><lpage>3428</lpage><pub-id pub-id-type="pmid">38349970</pub-id></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Gunel</surname><given-names>B</given-names></name><name><surname>Du</surname><given-names>J</given-names></name><name><surname>Conneau</surname><given-names>A</given-names></name><name><surname>Stoyanov</surname><given-names>V</given-names></name></person-group><source>Supervised contrastive learning for pre-trained language model fine-tuning</source><conf-name>International Conference onLearning Representations</conf-name><year>2021</year></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLafferty</surname><given-names>FW</given-names></name></person-group><article-title>Mass spectrometric analysis. molecular rearrangements</article-title><source>Analytical chemistry</source><year>1959</year><volume>31</volume><fpage>82</fpage><lpage>87</lpage></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Spectral entropy outperforms ms/ms dot product similarity for small-molecule compound identification</article-title><source>Nature Methods</source><year>2021</year><volume>18</volume><fpage>1524</fpage><lpage>1531</lpage><pub-id pub-id-type="pmcid">PMC11492813</pub-id><pub-id pub-id-type="pmid">34857935</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01331-z</pub-id></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="web"><collab>National Institute of Standards and Technology (NIST)</collab><source>NIST standard reference database 2020 edition</source><year>2020</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://www.nist.gov/srd">https://www.nist.gov/srd</ext-link></comment></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Tetering</surname><given-names>L</given-names></name><etal/></person-group><article-title>A spectroscopic test suggests that fragment ion structure annotations in ms/ms libraries are frequently incorrect</article-title><source>Communications Chemistry</source><year>2024</year><volume>7</volume><fpage>30</fpage><pub-id pub-id-type="pmcid">PMC10867025</pub-id><pub-id pub-id-type="pmid">38355930</pub-id><pub-id pub-id-type="doi">10.1038/s42004-024-01112-7</pub-id></element-citation></ref><ref id="R47"><label>[47]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demarque</surname><given-names>DP</given-names></name><name><surname>Crotti</surname><given-names>AE</given-names></name><name><surname>Vessecchi</surname><given-names>R</given-names></name><name><surname>Lopes</surname><given-names>JL</given-names></name><name><surname>Lopes</surname><given-names>NP</given-names></name></person-group><article-title>Fragmentation reactions using electrospray ionization mass spectrometry: an important tool for the structural elucidation and characterization of synthetic and natural products</article-title><source>Natural Product Reports</source><year>2016</year><volume>33</volume><fpage>432</fpage><lpage>455</lpage><pub-id pub-id-type="pmid">26673733</pub-id></element-citation></ref><ref id="R48"><label>[48]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belanger</surname><given-names>CF</given-names></name><name><surname>Hennekens</surname><given-names>CH</given-names></name><name><surname>Rosner</surname><given-names>B</given-names></name><name><surname>Speizer</surname><given-names>FE</given-names></name><etal/></person-group><article-title>The nurses’ health study</article-title><source>Am J Nurs</source><year>1978</year><volume>78</volume><fpage>1039</fpage><lpage>1040</lpage></element-citation></ref><ref id="R49"><label>[49]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shutta</surname><given-names>KH</given-names></name><etal/></person-group><article-title>Plasma metabolomic profiles associated with chronic distress in women</article-title><source>Psychoneuroendocrinology</source><year>2021</year><volume>133</volume><elocation-id>105420</elocation-id><pub-id pub-id-type="pmcid">PMC8547060</pub-id><pub-id pub-id-type="pmid">34597898</pub-id><pub-id pub-id-type="doi">10.1016/j.psyneuen.2021.105420</pub-id></element-citation></ref><ref id="R50"><label>[50]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Persistent PTSD symptoms are associated with plasma metabolic alterations relevant to long-term health: A metabolome-wide investigation in women</article-title><source>Psychol Med</source><year>2025</year><volume>55</volume><fpage>e30</fpage><pub-id pub-id-type="pmcid">PMC12017366</pub-id><pub-id pub-id-type="pmid">39924258</pub-id><pub-id pub-id-type="doi">10.1017/S0033291724003374</pub-id></element-citation></ref><ref id="R51"><label>[51]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heemskerk</surname><given-names>AD</given-names></name><etal/></person-group><article-title>Intensified antituberculosis therapy in adults with tuberculous meningitis</article-title><source>New England Journal of Medicine</source><year>2016</year><volume>374</volume><fpage>124</fpage><lpage>134</lpage><pub-id pub-id-type="pmid">26760084</pub-id></element-citation></ref><ref id="R52"><label>[52]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Laarhoven</surname><given-names>A</given-names></name><etal/></person-group><article-title>Cerebral tryptophan metabolism and outcome of tuberculous meningitis: an observational cohort study</article-title><source>The Lancet Infectious Diseases</source><year>2018</year><volume>18</volume><fpage>526</fpage><lpage>535</lpage><pub-id pub-id-type="pmid">29395996</pub-id></element-citation></ref><ref id="R53"><label>[53]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Böcker</surname><given-names>S</given-names></name><name><surname>Dührkop</surname><given-names>K</given-names></name></person-group><article-title>Fragmentation trees reloaded</article-title><source>Journal of cheminformatics</source><year>2016</year><volume>8</volume><fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="pmcid">PMC4736045</pub-id><pub-id pub-id-type="pmid">26839597</pub-id><pub-id pub-id-type="doi">10.1186/s13321-016-0116-8</pub-id></element-citation></ref><ref id="R54"><label>[54]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>RMY</given-names></name><name><surname>Cheah</surname><given-names>IK-M</given-names></name><name><surname>Yew</surname><given-names>TSK</given-names></name><name><surname>Halliwell</surname><given-names>B</given-names></name></person-group><article-title>Distribution and accumulation of dietary ergothioneine and its metabolites in mouse tissues</article-title><source>Scientific reports</source><year>2018</year><volume>8</volume><fpage>1601</fpage><pub-id pub-id-type="pmcid">PMC5785509</pub-id><pub-id pub-id-type="pmid">29371632</pub-id><pub-id pub-id-type="doi">10.1038/s41598-018-20021-z</pub-id></element-citation></ref><ref id="R55"><label>[55]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondoh</surname><given-names>H</given-names></name><name><surname>Teruya</surname><given-names>T</given-names></name><name><surname>Kameda</surname><given-names>M</given-names></name><name><surname>Yanagida</surname><given-names>M</given-names></name></person-group><article-title>Decline of ergothioneine in frailty and cognition impairment</article-title><source>FEBS letters</source><year>2022</year><volume>596</volume><fpage>1270</fpage><lpage>1278</lpage><pub-id pub-id-type="pmid">35090053</pub-id></element-citation></ref><ref id="R56"><label>[56]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paul</surname><given-names>BD</given-names></name></person-group><article-title>Ergothioneine: a stress vitamin with antiaging, vascular, and neuroprotective roles?</article-title><source>Antioxidants &amp; Redox Signaling</source><year>2022</year><volume>36</volume><fpage>1306</fpage><lpage>1317</lpage><pub-id pub-id-type="pmcid">PMC9221166</pub-id><pub-id pub-id-type="pmid">34619979</pub-id><pub-id pub-id-type="doi">10.1089/ars.2021.0043</pub-id></element-citation></ref><ref id="R57"><label>[57]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zorkina</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Lipids in psychiatric disorders: functional and potential diagnostic role as blood biomarkers</article-title><source>Metabolites</source><year>2024</year><volume>14</volume><fpage>80</fpage><pub-id pub-id-type="pmcid">PMC10890164</pub-id><pub-id pub-id-type="pmid">38392971</pub-id><pub-id pub-id-type="doi">10.3390/metabo14020080</pub-id></element-citation></ref><ref id="R58"><label>[58]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klavins</surname><given-names>K</given-names></name><etal/></person-group><article-title>The ratio of phosphatidylcholines to lysophosphatidylcholines in plasma differentiates healthy controls from patients with alzheimer’s disease and mild cognitive impairment</article-title><source>Alzheimers Dement (Amst.)</source><year>2015</year><volume>1</volume><fpage>295</fpage><lpage>302</lpage><pub-id pub-id-type="pmcid">PMC4700585</pub-id><pub-id pub-id-type="pmid">26744734</pub-id><pub-id pub-id-type="doi">10.1016/j.dadm.2015.05.003</pub-id></element-citation></ref><ref id="R59"><label>[59]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ardiansyah</surname><given-names>E</given-names></name><etal/></person-group><article-title>Tryptophan metabolism determines outcome in tuberculous meningitis: a targeted metabolomic analysis</article-title><source>Elife</source><year>2023</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC10181821</pub-id><pub-id pub-id-type="pmid">37158692</pub-id><pub-id pub-id-type="doi">10.7554/eLife.85307</pub-id></element-citation></ref><ref id="R60"><label>[60]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veiga-da Cunha</surname><given-names>M</given-names></name><name><surname>Chevalier</surname><given-names>N</given-names></name><name><surname>Stroobant</surname><given-names>V</given-names></name><name><surname>Vertommen</surname><given-names>D</given-names></name><name><surname>Van Schaftingen</surname><given-names>E</given-names></name></person-group><article-title>Metabolite proofreading in carnosine and homocarnosine synthesis: molecular identification of PM20D2 as <italic>β</italic>-alanyl-lysine dipeptidase</article-title><source>J Biol Chem</source><year>2014</year><volume>289</volume><fpage>19726</fpage><lpage>19736</lpage><pub-id pub-id-type="pmcid">PMC4094082</pub-id><pub-id pub-id-type="pmid">24891507</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M114.576579</pub-id></element-citation></ref><ref id="R61"><label>[61]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tabakman</surname><given-names>R</given-names></name><name><surname>Lazarovici</surname><given-names>P</given-names></name><name><surname>Kohen</surname><given-names>R</given-names></name></person-group><article-title>Neuroprotective effects of carnosine and homocarnosine on pheochromocytoma PC12 cells exposed to ischemia</article-title><source>J Neurosci Res</source><year>2002</year><volume>68</volume><fpage>463</fpage><lpage>469</lpage><pub-id pub-id-type="pmid">11992473</pub-id></element-citation></ref><ref id="R62"><label>[62]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchenauer</surname><given-names>H</given-names></name><name><surname>Edgington</surname><given-names>LV</given-names></name><name><surname>Grossmann</surname><given-names>F</given-names></name></person-group><article-title>Photochemical transformation of thiophanate-methyl and thiophanate to alkyl benzimidazol-2-yl carbamates</article-title><source>Pesticide Science</source><year>1973</year><volume>4</volume><fpage>343</fpage><lpage>348</lpage></element-citation></ref><ref id="R63"><label>[63]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vonk</surname><given-names>J</given-names></name><name><surname>Sijpesteijn</surname><given-names>A</given-names></name></person-group><article-title>Methyl benzimidazol-2-ylcarbamate, the fungitoxic principle of thiophanate-methyl</article-title><source>Pesticide Science</source><year>1971</year><volume>2</volume><fpage>160</fpage><lpage>164</lpage></element-citation></ref><ref id="R64"><label>[64]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yasuda</surname><given-names>Y</given-names></name><name><surname>Hashimotoa</surname><given-names>S</given-names></name><name><surname>Soeda</surname><given-names>Y</given-names></name><name><surname>Noguchi</surname><given-names>T</given-names></name></person-group><article-title>Metabolism of thiophanate-methyl by pathogenic fungi and antifungal activity of its metabolites</article-title><source>Japanese Journal of Phytopathology</source><year>1973</year><volume>39</volume><fpage>49</fpage><lpage>52</lpage></element-citation></ref><ref id="R65"><label>[65]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soeda</surname><given-names>Y</given-names></name><name><surname>Kosaka</surname><given-names>S</given-names></name><name><surname>Noguchi</surname><given-names>T</given-names></name></person-group><article-title>Identification of alkyl 2-benzimidazolecarbamates as a ma jor metabolite of thiophanates fungicide in/on the bean plant</article-title><source>Agricultural and Biological Chemistry</source><year>1972</year><volume>36</volume><fpage>817</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1080/00021369.1972.10860332</pub-id></element-citation></ref><ref id="R66"><label>[66]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>S-Y</given-names></name><name><surname>Shi</surname><given-names>X-C</given-names></name><name><surname>Liu</surname><given-names>F-Q</given-names></name><name><surname>Laborda</surname><given-names>P</given-names></name></person-group><article-title>Chromatographic methods for detection and quantification of carbendazim in food</article-title><source>Journal of Agricultural and Food Chemistry</source><year>2020</year><volume>68</volume><fpage>11880</fpage><lpage>11894</lpage><pub-id pub-id-type="pmid">33059442</pub-id></element-citation></ref><ref id="R67"><label>[67]</label><element-citation publication-type="web"><collab>Agency USEP</collab><source>2021 human health benchmarks for pesticides</source><year>2025</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://www.epa.gov/sdwa/2021-human-health-benchmarks-pesticides">https://www.epa.gov/sdwa/2021-human-health-benchmarks-pesticides</ext-link></comment></element-citation></ref><ref id="R68"><label>[68]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sigma-Aldrich</surname><given-names>I</given-names></name></person-group><source>Safety data sheet: Carbendazim Tech Rep</source><publisher-name>Sigma-Aldrich, Inc</publisher-name><year>2024</year></element-citation></ref><ref id="R69"><label>[69]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dotson</surname><given-names>D</given-names></name><name><surname>Hansen</surname><given-names>L</given-names></name><name><surname>Collantes</surname><given-names>M</given-names></name><name><surname>Dole</surname><given-names>T</given-names></name></person-group><source>Thiophanate-methyl and carbendazim human health risk assessment. Tech Rep</source><publisher-name>United States Environmental Protection Agency</publisher-name><year>2020</year></element-citation></ref><ref id="R70"><label>[70]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Cai</surname><given-names>Q</given-names></name><name><surname>Ma</surname><given-names>D</given-names></name></person-group><article-title>Amino acid promoted cui-catalyzed c-n bond formation between aryl halides and amines or n-containing heterocycles</article-title><source>The Journal of organic chemistry</source><year>2005</year><volume>70</volume><fpage>5164</fpage><lpage>5173</lpage><pub-id pub-id-type="pmid">15960520</pub-id></element-citation></ref><ref id="R71"><label>[71]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>H</given-names></name><etal/></person-group><article-title>A multi-substrate screening approach for the identification of a broadly applicable diels–alder catalyst</article-title><source>Nature Communications</source><year>2019</year><volume>10</volume><fpage>770</fpage><pub-id pub-id-type="pmcid">PMC6377681</pub-id><pub-id pub-id-type="pmid">30770804</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-08374-z</pub-id></element-citation></ref><ref id="R72"><label>[72]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fogel</surname><given-names>MS</given-names></name><name><surname>Koide</surname><given-names>K</given-names></name></person-group><article-title>Recent progress on one-pot multisubstrate screening</article-title><source>Organic Process Research &amp; Development</source><year>2023</year><volume>27</volume><fpage>1235</fpage><lpage>1247</lpage><pub-id pub-id-type="pmcid">PMC10389808</pub-id><pub-id pub-id-type="pmid">37529075</pub-id><pub-id pub-id-type="doi">10.1021/acs.oprd.3c00128</pub-id></element-citation></ref><ref id="R73"><label>[73]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watrous</surname><given-names>J</given-names></name><etal/></person-group><article-title>Mass spectral molecular networking of living microbial colonies</article-title><source>Proc Natl Acad Sci U S A</source><year>2012</year><volume>109</volume><fpage>E1743</fpage><lpage>52</lpage><pub-id pub-id-type="pmcid">PMC3387089</pub-id><pub-id pub-id-type="pmid">22586093</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1203689109</pub-id></element-citation></ref><ref id="R74"><label>[74]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shahneh</surname><given-names>MRZ</given-names></name><etal/></person-group><article-title>Modifinder: Tandem mass spectral alignment enables structural modification site localization</article-title><source>Journal of the American Society for Mass Spectrometry</source><year>2024</year><pub-id pub-id-type="pmcid">PMC11540723</pub-id><pub-id pub-id-type="pmid">38830143</pub-id><pub-id pub-id-type="doi">10.1021/jasms.4c00061</pub-id></element-citation></ref><ref id="R75"><label>[75]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Misico</surname><given-names>RI</given-names></name><etal/></person-group><article-title>Withanolides and related steroids</article-title><source>Progress in the Chemistry of Organic Natural Products</source><year>2011</year><volume>94</volume><fpage>127</fpage><lpage>229</lpage><pub-id pub-id-type="pmid">21833839</pub-id></element-citation></ref><ref id="R76"><label>[76]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>A</given-names></name><name><surname>Raza</surname><given-names>A</given-names></name><name><surname>Amin</surname><given-names>S</given-names></name><name><surname>Damodaran</surname><given-names>C</given-names></name><name><surname>Sharma</surname><given-names>AK</given-names></name></person-group><article-title>Recent advances in the chemistry and therapeutic evaluation of naturally occurring and synthetic withanolides</article-title><source>Molecules</source><year>2022</year><volume>27</volume><fpage>886</fpage><pub-id pub-id-type="pmcid">PMC8840339</pub-id><pub-id pub-id-type="pmid">35164150</pub-id><pub-id pub-id-type="doi">10.3390/molecules27030886</pub-id></element-citation></ref><ref id="R77"><label>[77]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>A</given-names></name><name><surname>Duggal</surname><given-names>S</given-names></name><name><surname>Singh</surname><given-names>H</given-names></name><name><surname>Singh</surname><given-names>J</given-names></name><name><surname>Katekhaye</surname><given-names>S</given-names></name></person-group><article-title>Withanolides: Phytoconstituents with significant pharmacological activities</article-title><source>International Journal of Green Pharmacy (IJGP)</source><year>2010</year><volume>4</volume></element-citation></ref><ref id="R78"><label>[78]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ojha</surname><given-names>SK</given-names></name><name><surname>Arya</surname><given-names>DS</given-names></name></person-group><article-title>Withania somnifera dunal (ashwagandha): a promising remedy for cardiovascular diseases</article-title><source>World J Med Sci</source><year>2009</year><volume>4</volume><fpage>156</fpage><lpage>158</lpage></element-citation></ref><ref id="R79"><label>[79]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gannon</surname><given-names>JM</given-names></name><name><surname>Brar</surname><given-names>J</given-names></name><name><surname>Rai</surname><given-names>A</given-names></name><name><surname>Chengappa</surname><given-names>KR</given-names></name></person-group><article-title>Effects of a standardized extract of withania somnifera (ashwagandha) on depression and anxiety symptoms in persons with schizophrenia participating in a randomized, placebo-controlled clinical trial</article-title><source>Annals of Clinical Psychiatry</source><year>2019</year><volume>31</volume><fpage>123</fpage><lpage>129</lpage><pub-id pub-id-type="pmid">31046033</pub-id></element-citation></ref><ref id="R80"><label>[80]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deshpande</surname><given-names>A</given-names></name><name><surname>Irani</surname><given-names>N</given-names></name><name><surname>Balkrishnan</surname><given-names>R</given-names></name><name><surname>Benny</surname><given-names>IR</given-names></name></person-group><article-title>A randomized, double blind, placebo controlled study to evaluate the effects of ashwagandha (withania somnifera) extract on sleep quality in healthy adults</article-title><source>Sleep Med</source><year>2020</year><volume>72</volume><fpage>28</fpage><lpage>36</lpage><pub-id pub-id-type="pmid">32540634</pub-id></element-citation></ref><ref id="R81"><label>[81]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naidu</surname><given-names>PS</given-names></name><name><surname>Singh</surname><given-names>A</given-names></name><name><surname>Kulkarni</surname><given-names>SK</given-names></name></person-group><article-title>Effect of withania somnifera root extract on reserpine-induced orofacial dyskinesia and cognitive dysfunction</article-title><source>Phytother Res</source><year>2006</year><volume>20</volume><fpage>140</fpage><lpage>146</lpage><pub-id pub-id-type="pmid">16444668</pub-id></element-citation></ref><ref id="R82"><label>[82]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohanty</surname><given-names>IR</given-names></name><name><surname>Arya</surname><given-names>DS</given-names></name><name><surname>Gupta</surname><given-names>SK</given-names></name></person-group><article-title>Withania somnifera provides cardioprotection and attenuates ischemia-reperfusion induced apoptosis</article-title><source>Clin Nutr</source><year>2008</year><volume>27</volume><fpage>635</fpage><lpage>642</lpage><pub-id pub-id-type="pmid">18620784</pub-id></element-citation></ref><ref id="R83"><label>[83]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choudhary</surname><given-names>D</given-names></name><name><surname>Bhattacharyya</surname><given-names>S</given-names></name><name><surname>Bose</surname><given-names>S</given-names></name></person-group><article-title>Efficacy and safety of ashwagandha (withania somnifera (l.) dunal) root extract in improving memory and cognitive functions</article-title><source>Journal of dietary supplements</source><year>2017</year><volume>14</volume><fpage>599</fpage><lpage>612</lpage><pub-id pub-id-type="pmid">28471731</pub-id></element-citation></ref><ref id="R84"><label>[84]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knoch</surname><given-names>E</given-names></name><etal/></person-group><article-title>Third dwf1 paralog in solanaceae, sterol δ24-isomerase, branches withanolide biosynthesis from the general phytosterol pathway</article-title><source>Proceedings of the National Academy of Sciences</source><year>2018</year><volume>115</volume><fpage>E8096</fpage><lpage>E8103</lpage><pub-id pub-id-type="pmcid">PMC6112714</pub-id><pub-id pub-id-type="pmid">30082386</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1807482115</pub-id></element-citation></ref><ref id="R85"><label>[85]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>E</given-names></name><etal/></person-group><article-title>Elucidation of gene clusters underlying withanolide biosynthesis in ashwagandha through yeast metabolic engineering</article-title><source>bioRxiv</source><year>2024</year><fpage>2024</fpage><lpage>12</lpage></element-citation></ref><ref id="R86"><label>[86]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ridder</surname><given-names>L</given-names></name><name><surname>van der Hooft</surname><given-names>JJJ</given-names></name><name><surname>Verhoeven</surname><given-names>S</given-names></name></person-group><article-title>Automatic compound annotation from mass spectrometry data using magma</article-title><source>Mass Spectrometry</source><year>2014</year><volume>3</volume><elocation-id>S0033</elocation-id></element-citation></ref><ref id="R87"><label>[87]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>JN</given-names></name><name><surname>Belanger</surname><given-names>D</given-names></name><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Sculley</surname><given-names>D</given-names></name></person-group><article-title>Rapid prediction of electron–ionization mass spectrometry using neural networks</article-title><source>ACS central science</source><year>2019</year><volume>5</volume><fpage>700</fpage><lpage>708</lpage><pub-id pub-id-type="pmcid">PMC6487538</pub-id><pub-id pub-id-type="pmid">31041390</pub-id><pub-id pub-id-type="doi">10.1021/acscentsci.9b00085</pub-id></element-citation></ref><ref id="R88"><label>[88]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J</given-names></name><etal/></person-group><source>Set transformer: A framework for attention-based permutationinvariant neural networks</source><conf-name>International conference on machine learning</conf-name><year>2019</year><fpage>3744</fpage><lpage>3753</lpage></element-citation></ref><ref id="R89"><label>[89]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pulfer</surname><given-names>M</given-names></name><name><surname>Murphy</surname><given-names>RC</given-names></name></person-group><article-title>Electrospray mass spectrometry of phospholipids</article-title><source>Mass spectrometry reviews</source><year>2003</year><volume>22</volume><fpage>332</fpage><lpage>364</lpage><pub-id pub-id-type="pmid">12949918</pub-id></element-citation></ref><ref id="R90"><label>[90]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerwin</surname><given-names>JL</given-names></name><name><surname>Wiens</surname><given-names>AM</given-names></name><name><surname>Ericsson</surname><given-names>LH</given-names></name></person-group><article-title>Identification of fatty acids by electrospray mass spectrometry and tandem mass spectrometry</article-title><source>Journal of mass spectrometry</source><year>1996</year><volume>31</volume><fpage>184</fpage><lpage>192</lpage><pub-id pub-id-type="pmid">8799272</pub-id></element-citation></ref><ref id="R91"><label>[91]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>S</given-names></name><etal/></person-group><article-title>Annotating metabolite mass spectra with domain-inspired chemical formula transformers</article-title><source>Nature Machine Intelligence</source><year>2023</year><volume>5</volume><fpage>965</fpage><lpage>979</lpage></element-citation></ref><ref id="R92"><label>[92]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>W</given-names></name><name><surname>Fu</surname><given-names>T</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Coley</surname><given-names>C</given-names></name></person-group><article-title>Sample efficiency matters: a benchmark for practical molecular optimization</article-title><source>Advances in neural information processing systems</source><year>2022</year><volume>35</volume><fpage>21342</fpage><lpage>21357</lpage></element-citation></ref><ref id="R93"><label>[93]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tripp</surname><given-names>A</given-names></name><name><surname>Hernández-Lobato</surname><given-names>JM</given-names></name></person-group><article-title>Genetic algorithms are strong baselines for molecule generation</article-title><source>arXiv preprint</source><year>2023</year><elocation-id>arXiv:2310.09267</elocation-id></element-citation></ref><ref id="R94"><label>[94]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sinkhorn</surname><given-names>R</given-names></name><name><surname>Rangarajan</surname><given-names>A</given-names></name></person-group><article-title>A relationship between arbitrary positive matrices and doubly stochastic matrices</article-title><source>Ann Math Statistics</source><year>1964</year><volume>35</volume><fpage>876</fpage><lpage>879</lpage></element-citation></ref><ref id="R95"><label>[95]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname><given-names>RP</given-names></name><name><surname>Zemel</surname><given-names>RS</given-names></name></person-group><article-title>Ranking via sinkhorn propagation</article-title><source>arXiv preprint</source><year>2011</year><elocation-id>arXiv:1106.1925</elocation-id></element-citation></ref><ref id="R96"><label>[96]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kong</surname><given-names>F</given-names></name><etal/></person-group><article-title>Denoising search doubles the number of metabolite and exposome annotations in human plasma using an orbitrap astral mass spectrometer</article-title><source>Nature Methods</source><year>2025</year><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmcid">PMC12087458</pub-id><pub-id pub-id-type="pmid">40155721</pub-id><pub-id pub-id-type="doi">10.1038/s41592-025-02646-x</pub-id></element-citation></ref><ref id="R97"><label>[97]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruttkies</surname><given-names>C</given-names></name><name><surname>Schymanski</surname><given-names>EL</given-names></name><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Hollender</surname><given-names>J</given-names></name><name><surname>Neumann</surname><given-names>S</given-names></name></person-group><article-title>Metfrag relaunched: incorporating strategies beyond in silico fragmentation</article-title><source>Journal of cheminformatics</source><year>2016</year><volume>8</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC4732001</pub-id><pub-id pub-id-type="pmid">26834843</pub-id><pub-id pub-id-type="doi">10.1186/s13321-016-0115-9</pub-id></element-citation></ref><ref id="R98"><label>[98]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>S</given-names></name><name><surname>Xin</surname><given-names>J</given-names></name><name><surname>Provenzano</surname><given-names>J</given-names></name><name><surname>Coley</surname><given-names>CW</given-names></name></person-group><article-title>Mist-cf: Chemical formula inference from tandem mass spectra</article-title><source>Journal of Chemical Information and Modeling</source><year>2023</year><volume>64</volume><fpage>2421</fpage><lpage>2431</lpage><pub-id pub-id-type="pmid">37725368</pub-id></element-citation></ref><ref id="R99"><label>[99]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xing</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Huan</surname><given-names>T</given-names></name></person-group><article-title>Buddy: molecular formula discovery via bottom-up ms/ms interrogation</article-title><source>Nature Methods</source><year>2023</year><volume>20</volume><fpage>881</fpage><lpage>890</lpage><pub-id pub-id-type="pmid">37055660</pub-id></element-citation></ref><ref id="R100"><label>[100]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bajusz</surname><given-names>D</given-names></name><name><surname>Racz</surname><given-names>A</given-names></name><name><surname>Héberger</surname><given-names>K</given-names></name></person-group><article-title>Why is tanimoto index an appropriate choice for fingerprint-based similarity calculations?</article-title><source>Journal of cheminformatics</source><year>2015</year><volume>7</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC4456712</pub-id><pub-id pub-id-type="pmid">26052348</pub-id><pub-id pub-id-type="doi">10.1186/s13321-015-0069-3</pub-id></element-citation></ref><ref id="R101"><label>[101]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dührkop</surname><given-names>K</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Meusel</surname><given-names>M</given-names></name><name><surname>Rousu</surname><given-names>J</given-names></name><name><surname>Böcker</surname><given-names>S</given-names></name></person-group><article-title>Searching molecular structure databases with tandem mass spectra using CSI: FingerID</article-title><source>Proceedings of the National Academy of Sciences</source><year>2015</year><volume>112</volume><fpage>12580</fpage><lpage>12585</lpage><pub-id pub-id-type="pmcid">PMC4611636</pub-id><pub-id pub-id-type="pmid">26392543</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1509788112</pub-id></element-citation></ref><ref id="R102"><label>[102]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tantawi</surname><given-names>O</given-names></name><etal/></person-group><article-title>Designing for degradation: the importance of considering biotic and abiotic polymer degradation</article-title><source>Environ Sci Process Impacts</source><year>2025</year><pub-id pub-id-type="pmid">40207386</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>ICEBERG is an <italic>in silico</italic> predictor of tandem mass spectrometry and accelerates structural elucidation with different sources of candidates.</title><p><bold>a</bold>, Structural elucidation from MS/MS is a time-intensive and costly task, especially when custom synthesis of authentic standards is needed, as shown in this prototypical structural elucidation workflow. <bold>b</bold>, ICEBERG is a two-stage neural network model that simulates the fragmentation process in LC-MS/MS. ICEBERG-Generate first generates a fragmentation graph given a molecular structure. ICEBERG-Score then predicts the intensities for each fragment, together with other inputs such as adduct type and collision energy. Structural elucidation is achieved by using ICEBERG-generated MS/MS to rank candidate structures, where candidates can be defined through several complementary strategies; three are demonstrated as follows. <bold>c</bold>, If the unknown is expected to be in a chemical library, e.g., PubChem, and the chemical formula is known or can be inferred, all structures in PubChem with the same chemical formula could be treated as candidates. <bold>d</bold>, If the unknown structure is novel, there might be prior knowledge that helps constrain the set of possible structures, for example, through virtual reaction enumeration given known starting materials. <bold>e</bold>, If the unknown structure is thought or found to be closely related to a reference structure (e.g., through late-stage functionalization from chemical or biological sources), where the MS/MS of the unknown is close to the reference’s, candidates could be derived from the reference structure. For example, with a known formula difference of +O, ICEBERG identifies substructures that explain peaks shifted by +O and high-lights the most plausible sites of hydroxylation.</p></caption><graphic xlink:href="EMS206120-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Quantitative evaluation of ICEBERG demonstrates state-of-the-art accuracy in MS/MS prediction and structure annotation.</title><p>ICEBERG predicts spectra more accurately on both <bold>(a)</bold> random split and <bold>(b)</bold> scaffold split of the NIST’20 dataset compared to other prediction tools as measured by cosine similarity as well as structural elucidation through database retrieval. The scaffold split evaluates generalization ability to unseen molecular scaffolds as a more challenging setting. <bold>c</bold>, Retrieval accuracy as a function of the molecular mass and number of peaks in the experimental spectrum shows that ICEBERG performance is consistent with respect to different sizes of molecules and various numbers of peaks. <bold>d</bold>, Spectral similarity as a function of molecular mass and the spectral entropy similarity [<xref ref-type="bibr" rid="R44">44</xref>] to an experimental spectrum. The slight negative correlation is attributable to the greater number of peaks larger molecules tend to provide, negatively biasing the entropy similarity metric. <bold>e</bold>, Retrieval accuracy as a function of adduct type shows that [M+H]<sup>+</sup> and [M–H]<sup>–</sup> are the best-performing adduct types, consistent with these adducts comprising the plurality of data in NIST’20.</p></caption><graphic xlink:href="EMS206120-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>ICEBERG elucidates novel structures in untargeted metabolomics and environmental studies with candidates from PubChem (<xref ref-type="fig" rid="F1">Fig. 1c</xref>).</title><p>Each structure annotation in this figure was verified by both retention time and MS/MS matching using an authentic standard. <bold>a</bold>, From the Nurses’ Health Study [<xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R50">50</xref>], a metabolomics study is performed for groups with or without depression, whereby statistically significant MS/MS features are identified. <bold>b</bold>, ICEBERG ranks hercynine (<bold>1</bold>) as the top-1 candidate for a biomarker that is negatively associated with depression. Alongside matches in RT, ICEBERG spectra predictions, MS/MS of the standard, and MS/MS from plasma align well across the five collision energies. Despite the difference in peak intensities, all three MS/MS exhibit the same trend of leftward peak-shifting across collision energies. <bold>c</bold>, Following ICEBERG predictions, LPC 19:0 (<bold>9</bold>) is identified as a novel biomarker positively associated with depression. ICEBERG predicts similar fragmentation patterns for the top-3 structures, where <bold>9</bold> is the most biologically plausible. LPC: lysophosphatidylcholine. <bold>d</bold>, A clinical study of tuberculous meningitis (TBM) [<xref ref-type="bibr" rid="R51">51</xref>, <xref ref-type="bibr" rid="R52">52</xref>] yields metabolomic signatures of potential biomarkers of interest. <bold>e</bold>, ICEBERG’S top-ranked prediction, GABA-Arg (<bold>2</bold>), is verified as an unknown feature found to be negatively correlated with TBM infection and negatively correlated with mortality rate. GABA: gamma-aminobutyric acid. <bold>f</bold>, Thiophanate methyl (<bold>13</bold>) is a widely used fungicide. Under controlled abiotic degradation, an unknown degradant is found to accumulate in dark samples but is transient in light samples. <bold>g</bold>, ICEBERG ranks carbendazim (<bold>14</bold>) as the top-1 structure, which is further confirmed by an authentic standard.</p></caption><graphic xlink:href="EMS206120-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>ICEBERG enables the deconvolution of pooled reaction screening experiments where candidates are derived from virtual enumeration (<xref ref-type="fig" rid="F1">Fig. 1d</xref>).</title><p><bold>a</bold>, Traditional singleton experimentation requires running N experiments for N starting materials, which is labor-intensive. <bold>b</bold>, Pooled experimentation is more scalable, where a single pooled reaction is enough to test all N building blocks. However, a key limitation hindering the applicability is that pooled experimentation requires all potential products to be non-isobaric. <bold>c</bold>, In this work, LC-MS/MS and ICEBERG enable the deconvolution of isobaric products, allowing more flexibility in experimental design. <bold>d</bold>, As a validation case study, we use four isobaric anilines (<bold>17a</bold>-<bold>17d</bold>) and run C-N coupling [<xref ref-type="bibr" rid="R70">70</xref>] with iodobenzene (<bold>18</bold>) and 1-bromo-4-nitrobenzene (<bold>19</bold>). Such a pooled reaction creates two batches of isobaric products, which are further distinguished by LC-MS/MS and ICEBERG. <bold>e</bold>, The abundance of products in the pooled reaction aligns well with singleton experiments, as measured by the normalized extracted ion chromatogram area. The yellow line is the parity line (i.e., <italic>y</italic> = <italic>x</italic>).</p></caption><graphic xlink:href="EMS206120-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>ICEBERG facilitates the elucidation of enzymatic function in a biosynthetic pathway with candidates derived from close reference structures (<xref ref-type="fig" rid="F1">Fig. 1d</xref>).</title><p><bold>a</bold>, ICEBERG identifies high probability modification sites based on comparing MS/MS spectra for a known and an unknown structure. In this example, we aim to predict the hydroxylation site of <bold>26</bold> as a precursor to the unknown <bold>27</bold>. Pairs of peaks with a mass shift of +O (15.9997 Da) are matched across the two spectra and annotated with the ICEBERG-predicted substructures that explain them in the reference structure (shown in black). Aggregation of intensities from each peak yields a set of predicted modification sites based on the resulting per-atom scores. Peaks over a cutoff of 200 <italic>m/z</italic> are ignored to focus on smaller fragments that can better localize information for structural elucidation. Sites with scores &gt; 0.8 are shown in yellow, while the verified modification site is in green. <bold>b</bold>, This elucidation strategy is applied to a multi-step enzymatic pathway of <italic>W. somnifera</italic> that converts 24-methylene cholesterol (<bold>22</bold>) into bioactive compounds <bold>30</bold> and <bold>31</bold>. ICEBERG successfully suggests potential modification sites for putative intermediate structures (<bold>24</bold>, <bold>25</bold>, <bold>26</bold>, <bold>27</bold>, <bold>28</bold>, <bold>29</bold>) in the pathway by taking their precursor structures as references. Confirmed modifications are annotated in green, as verified by either NMR or inferred from other structures in the pathway with high confidence. With the biosynthetic steps to <bold>30</bold> and <bold>31</bold> yet to be resolved, we annotate all known net structural modifications relative to <bold>29</bold> in blue.</p></caption><graphic xlink:href="EMS206120-f005"/></fig></floats-group></article>