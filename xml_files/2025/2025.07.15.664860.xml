<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207303</article-id><article-id pub-id-type="doi">10.1101/2025.07.15.664860</article-id><article-id pub-id-type="archive">PPR1051748</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>OrthoFinder: scalable phylogenetic orthology inference for comparative genomics</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Emms</surname><given-names>David M</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Yi</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Belcher</surname><given-names>Laurence</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Holmes</surname><given-names>Jonathan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Kelly</surname><given-names>Steven</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><aff id="A1"><label>1</label>Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap>, <addr-line>South Parks Road</addr-line>, <city>Oxford</city>, <postal-code>OX1 3RB</postal-code>, <country country="GB">United Kingdom</country></aff></contrib-group><author-notes><corresp id="CR1"><bold><italic>Corresponding Author</italic></bold> Name: Steven Kelly, <email>steven.kelly@biology.ox.ac.uk</email>, Address: Department of Biology, University of Oxford, South Parks Road, Oxford, OX1 3RB, UK</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>17</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>16</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Here, we present a major advance of the OrthoFinder method. This extends OrthoFinder’s high accuracy comparative genomic framework to provide substantially enhanced scalability and accuracy. Specifically, we show that enhanced phylogenetic delineation of orthogroups provides a 7% relative increase in orthogroup inference accuracy. We further demonstrate that a new gene assignment method substantially reduces overall runtime RAM usage without compromising accuracy. The latest version of OrthoFinder is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/OrthoFinder/OrthoFinder">https://github.com/OrthoFinder/OrthoFinder</ext-link>.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Inferring orthology between biological sequences is fundamental to contemporary biological research. It provides the foundation for studying the evolution and diversity of life on Earth and it provides the framework for transfer of biological knowledge between species. Given the central importance of orthology inference to biological research it has been the subject of extensive methodological development for more than 40 years (<xref ref-type="bibr" rid="R16">Fitch, 1970</xref>; <xref ref-type="bibr" rid="R17">Gabaldón <italic>et al</italic>., 2009</xref>; <xref ref-type="bibr" rid="R1">Altenhoff <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="R29">Linard <italic>et al</italic>., 2021</xref>). Diverse approaches to the computational challenge of identifying related genes in different species has resulted in a broad array of methods with varied performance characteristics when applied to diverse datasets (<xref ref-type="bibr" rid="R25">Kristensen <italic>et al</italic>., 2011</xref>; <xref ref-type="bibr" rid="R1">Altenhoff <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="R34">Nichio, Marchaukoski and Raittz, 2017</xref>).</p><p id="P3">Although orthology inference has been subject to substantial improvements since the advent of the first automated methods, one of the major challenges facing method development in this field is how to achieve high orthology inference accuracy at scale (<xref ref-type="bibr" rid="R6">Cosentino, Sriswasdi and Iwasaki, 2024</xref>; <xref ref-type="bibr" rid="R30">Majidian <italic>et al</italic>., 2025</xref>). This challenge has become more pressing in recent years with genome sequencing projects such as The Darwin Tree of Life (<xref ref-type="bibr" rid="R37">The Darwin Tree of Life Project Consortium, 2022</xref>) and The Earth BioGenome Project (<xref ref-type="bibr" rid="R27">Lewin <italic>et al</italic>., 2018</xref>), which collectively aim to sequence, assemble and annotate the reference genomes for all two million known species of eukaryote. These pioneering efforts, combined with widespread sequencing efforts that are distributed across many biological communities, are creating an unprecedented scalability challenge for automated orthology inference methods (<xref ref-type="bibr" rid="R29">Linard <italic>et al</italic>., 2021</xref>; <xref ref-type="bibr" rid="R26">Langschied <italic>et al</italic>., 2024</xref>). Thousands of genomes are already available, it is likely that millions more are coming, and there is a real need to be able to accurately and efficiently analyse these resources to maximize their value.</p><p id="P4">There are several distinct computation bottlenecks for inferring orthology for large numbers of species. For example, the entry point to the majority of inference methods is an all-vs-all sequence similarity search from which orthology relationships can be inferred (<xref ref-type="bibr" rid="R13">Emms and Kelly, 2019</xref>). Substantial efforts have been focused at increasing the computational efficiency of individual sequence similarity searches with methods such as DIAMOND (<xref ref-type="bibr" rid="R2">Buchfink, Reuter and Drost, 2021</xref>), Usearch (<xref ref-type="bibr" rid="R9">Edgar, 2010</xref>), and mmseqs (<xref ref-type="bibr" rid="R20">Hauser, Steinegger and Söding, 2016</xref>) greatly advancing the capability to efficiently identify similar sequences in large databases. Even though major improvements have been made, all-vs-all sequence searches have an order of n<sup>2</sup> time complexity (where n is the number of species under consideration) and consequently are not well suited to conducting orthology inference as species number increases. Thus, alternative orthology inference approaches that retain high accuracy while improving scalability are required to realize the full value of global sequencing efforts.</p><p id="P5">Previously we developed the OrthoFinder method for phylogenetic orthology inference (<xref ref-type="bibr" rid="R10">Emms and Kelly, 2015</xref>, <xref ref-type="bibr" rid="R13">2019</xref>). OrthoFinder first identifies orthogroups, the sets of genes that each descend from a single gene in the last common ancestor of a group of species. OrthoFinder then infers a gene tree for each orthogroup and analyses these gene trees to identify the rooted species tree (<xref ref-type="bibr" rid="R11">Emms and Kelly, 2017</xref>, <xref ref-type="bibr" rid="R12">2018</xref>). OrthoFinder also identifies all gene duplication events in the complete set of gene trees and analyses this information in the context of the species tree to provide both gene tree and species tree-level analysis of gene duplication events. Finally, OrthoFinder analyses this cohort of phylogenetic information to identify the complete set of orthologs between all species and provide a suite of comparative genomics statistics. The phylogenetic approach developed in OrthoFinder provided a step change for comparative genomics, enabling the transition from similarity score-based approximations of orthology to tree-based phylogenetic relationships between genes. In recent work, we showed that it was possible to rapidly and accurately place individual sequences into a database of phylogenetic trees and biological sequences produced by an OrthoFinder search (<xref ref-type="bibr" rid="R15">Emms and Kelly, 2022</xref>). This approach provided a rapid phylogenetic framework through which individual genes could be added to an existing orthology inference run without incurring a computationally costly all-vs-all re-analysis of existing species. We hypothesized that it should be possible to extend this single-gene approach to support the addition of sets of species and thereby achieve improved scalability without compromising accuracy.</p><p id="P6">Here we present a major update to OrthoFinder that significantly enhances the scalability of the method. We show that it is possible to rapidly search and assign sequence sets from large numbers of species to a phylogenetically partitioned and structured database of biological sequences in near linear time. We demonstrate that using such an accelerated search functionality does not compromise orthology inference accuracy. Moreover, through advancements in phylogenetic interrogation of orthogroups we show that it is possible to achieve scalable inference with higher accuracy than any competitor method or previous versions of OrthoFinder. Finally, we show that the latest version of OrthoFinder is scalable to thousands of genomes on conventional computing resources. As before, the updated version of OrthoFinder is accurate, customizable, and is performed with a simple command using only protein sequences as input.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Improved phylogenetic delineation of orthogroups</title><p id="P7">In previous versions of OrthoFinder, orthologs were defined phylogenetically but orthogroups were defined solely based on MCL clustering of sequence similarity search results (<xref ref-type="bibr" rid="R10">Emms and Kelly, 2015</xref>, <xref ref-type="bibr" rid="R13">2019</xref>). While this method does correct for inter-species divergence it does not leverage the phylogenetic relationship between the species represented in each orthogroup, and thus does not always identify the true extent of an orthogroup. Errors in orthogroup delineation at this stage propagate through all subsequent steps of the analysis, causing collateral errors in orthology inference. To address this, we developed and implemented a novel phylogenetic re-evaluation of orthogroup membership (<xref ref-type="fig" rid="F1">Figure 1</xref>). First, MCL clustering is performed as in OrthoFinder v2, and a gene tree is inferred for each orthogroup. Next, OrthoFinder applies its high accuracy gene tree species tree reconciliation algorithm (<xref ref-type="bibr" rid="R13">Emms and Kelly, 2019</xref>) to identify and map all gene duplication events in each gene tree. By definition, an orthogroup should not contain genes arising from ‘ancient’ duplications that predate the root of the species tree, any such duplications indicate that the genes have descended from multiple independent genes present in the last common ancestor of the set of species under consideration. OrthoFinder splits all gene trees at such ancient gene duplication nodes and in doing so creates a new set of revised phylogenetically defined orthogroups which are then recorded and used for all subsequent downstream analyses. OrthoFinder preforms this for all nodes in the species tree creating orthogroups for each node in the species tree. This new step splits erroneously fused orthogroups, and prunes sequences that do not adhere to the phylogenetic definition of the orthogroup (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P8">To test the impact of this novel approach on orthogroup inference accuracy, we compared this new version of OrthoFinder to a set of alternative methods on the OrthoBench dataset of expert-curated reference orthogroups (<xref ref-type="bibr" rid="R38">Trachana <italic>et al</italic>., 2011</xref>; <xref ref-type="bibr" rid="R14">Emms and Kelly, 2020</xref>). We deployed OrthoFinder in its two most commonly used implementations. One implementation uses multiple sequence alignment and maximum likelihood tree inference to infer orthogroup trees and is provided with a precomputed species tree (OF3_Align_ST), and the other implementation uses the DendroBLAST method to bypass the requirement to construct alignments and alignment-based trees (<xref ref-type="bibr" rid="R23">Kelly and Maini, 2013</xref>) (OF3_DB) which is the default implementation in OrthoFinder v2. We also included the new scalable version of OrthoFinder v3 (OF3_Linear) which is discussed in detail in the following section of the manuscript. The list of comparator methods included Broccoli (<xref ref-type="bibr" rid="R8">Derelle, Philippe and Colbourne, 2020</xref>), OrthoHMM (<xref ref-type="bibr" rid="R36">Steenwyk <italic>et al</italic>., 2024</xref>), SonicParanoid2 (<xref ref-type="bibr" rid="R6">Cosentino, Sriswasdi and Iwasaki, 2024</xref>), OrthoMCL (<xref ref-type="bibr" rid="R28">Li, Stoeckert and Roos, 2003</xref>), ProteinOrtho (<xref ref-type="bibr" rid="R24">Klemm, Stadler and Lechner, 2023</xref>), Hieranoid (<xref ref-type="bibr" rid="R22">Kaduk and Sonnhammer, 2017</xref>), and FastOMA (<xref ref-type="bibr" rid="R30">Majidian <italic>et al</italic>., 2025</xref>).</p><p id="P9">For each method, we calculated seven measures of accuracy: (A) the percentage of missing reference orthogroups, (B) the percentage of missing genes, (C) the percentage of incorrect orthogroup fusion events, (D) the percentage of incorrect orthogroup fission events, and (E, F, G) recall, precision, and entropy. Entropy is the measure of reference orthogroup fragmentation, with higher values indicating greater fragmentation. We then calculated an overall rank-based score by evaluating the relative performance of each method across all seven measures. This revealed that OrthoFinder v3 (in either implementation) outperformed all other orthogroup inference methods including OrthoFinder v2 (<xref ref-type="fig" rid="F2">Figure 2</xref>). OrthoFinder v3 had the highest recall, lowest fraction of missing genes, and the lowest entropy. Moreover, OrthoFinder v3 had 5-7% higher accuracy (f-score harmonic mean of recall and precision. Supplementary S1 Table 1) than the previous version of OrthoFinder run with identical settings (OF2_Align_ST and OF2_DB, <xref ref-type="fig" rid="F2">Figure 2</xref>). While OrthoFinder v3 achieved a lower precision than several other methods, OrthoFinder v3 showed a substantially higher recall, and consequently suffered from a much lower rate of missing data. For example, while SonicParanoid2 (SP_def) showed a 3.7% higher precision than OrthoFinder v3 (OF3_Align_ST), the recall of OrthoFinder v3 was 19% higher. Almost all tools were identical in the production of fused reference orthogroups (RefOG), with the exception of FastOMA which erroneously fused 3.5 times more reference orthogroups than other methods (10% compared to 2.85%). The spread of reference orthogroup fissions events across the tools varied, with low precision tools such as Broccoli and OrthoHMM making relatively few RefOG fissions. Analysis of the entropy scores, which are similar to a weighted combination of fission and fusion events, revealed that OrthoFinder tends to produce orthogroups whose sizes and membership most accurately recapture the reference dataset (<xref ref-type="fig" rid="F2">Figure 2</xref>). Therefore, the introduction of the phylogenetic delimitation of orthogroups improves overall orthogroup inference accuracy, and OrthoFinder v3 is the most accurate method currently available.</p></sec><sec id="S4"><title>Achieving enhanced scalability without compromising accuracy</title><p id="P10">In addition to improvements in the phylogenetic definition of orthogroups, we also developed a novel implementation of OrthoFinder to improve the scalability of the method. This is achieved through adaptation and further development of the SHOOT profile algorithm (<xref ref-type="bibr" rid="R15">Emms and Kelly, 2022</xref>) which enables rapid addition of new species to existing OrthoFinder runs. This novel scalable version of OrthoFinder is implemented as a two-step process (<xref ref-type="fig" rid="F3">Figure 3</xref>). Prior to starting, the input species set are partitioned into two non-overlapping subsets – a “core” subset and an “assign” subset. It is recommended that the “core” subset contain fewer than 100 species for analysis on conventional computing resources. The “assign” subset can be substantially larger as described below. The first step of this new implementation requires that a conventional OrthoFinder run is performed on the core subset. This creates a phylogenetically partitioned and structured reference database of biological sequences (<xref ref-type="bibr" rid="R15">Emms and Kelly, 2022</xref>) that is then used as input for the second stage of the algorithm. The species from the assign subset are then rapidly assigned to the correct orthogroup in the reference database, irrespective of the number of sequences contained within each core orthogroup. Following completion of the assignment step, OrthoFinder’s rapid phylogeny-based orthogroup and ortholog inference steps are performed to produce an expanded rooted species tree, gene trees, phylogenetically determined orthogroups, orthologs, gene duplication events, and comparative genomic statistics (<xref ref-type="fig" rid="F3">Figure 3</xref>).</p><p id="P11">To test the impact on scalability of this new workflow, OrthoFinder v3 was compared against the set of commonly used orthology inference tools. The time each method took to complete analyses of datasets of different sizes was measured, unless a timeout of 7 days was reached before completion. Peak memory usage was also calculated for each analysis. Each tool was run on a Linux server using AMD processers, all tools were allocated 32 threads (16 cores) and up to 200gb of RAM for each run. In order to test performance on a representative set of species, the Ensembl (<xref ref-type="bibr" rid="R19">Harrison <italic>et al</italic>., 2024</xref>) rapid release genomes (Accessed 29<sup>th</sup> of August 2024) were downloaded. Test datasets ranging in size from 2 - 1024 species we compiled by sampling species from</p><p id="P12">Ensembl dataset using PDA (phylogenetic diversity analyzer) (<xref ref-type="bibr" rid="R4">Chernomor <italic>et al</italic>., 2015</xref>), see ‘Methods’ for more details. All methods were run on the same datasets in their default implementations unless indicated otherwise in the methods or figure legends. OrthoFinder v3 was run using the standard OrthoFinder 2 workflow up to 64 species. Beyond 64 species OrthoFinder v3 was run in the new scalable implementation where the first 64 species were taken to be the core set and all other species were assigned. The final run time for OrthoFinder v3 was calculated using the combined run time for the core 64 species and the assigned dataset.</p><p id="P13">OrthoFinder v3 linear addition outperformed all other tested methods, being the only method able to perform orthology inference on 1024 species within the seven-day cutoff (<xref ref-type="fig" rid="F4">Figure 4A</xref>). OrthoFinder v3 completed this run in 128 hours. SonicParanoid2 (fast mode) and FastOMA were the only two methods able to run 512 proteomes within the cutoff time. OrthoFinder v3 followed a near linear run time trend for 128 – 1024 species. This new implementation of OrthoFinder was faster than each of the other competitor methods tested and significantly (x8) faster than OrthoFinder v2 on datasets larger than 64 species, an important improvement in scalability from the previous version.</p><p id="P14">OrthoFinder v3 also performed well on memory usage (<xref ref-type="fig" rid="F4">Figure 4B</xref>). OrthoFinder v3 outperformed OrthoFinder v2 above 128 species, with increasing memory saving as species number increases. For example, v3 linear shows a 3.4-fold decrease in RAM consumption for 256 species compared to v2 DendroBlast. On the largest datasets that other methods could complete, OrthoFinder v3, used approximately 4-fold lower peak memory consumption (<xref ref-type="fig" rid="F4">Figure 4B</xref>).</p><p id="P15">To demonstrate that the alternative implementation did not compromise orthogroup inference accuracy, the linear species addition method (OF3_Linear) was also tested on the OrthoBench data (<xref ref-type="fig" rid="F2">Figure 2</xref>). OrthoFinder v3 Linear only slightly underperformed compared to the non-scalable version, with slight decreases in some measures observed. However, this scalable version was more accurate than any implementation of OrthoFinder v2 and any other competitor methods (<xref ref-type="fig" rid="F2">Figure 2</xref>), supporting the use of this accelerated implementation of OrthoFinder in comparative genomic analyses.</p></sec><sec id="S5"><title>OrthoFinder 3 performs accurate ortholog inference on the quest for orthologs benchmarking service</title><p id="P16">We also tested the accuracy of the orthologs predicted by OrthoFinder v3 in multiple implementations using the Quest for Orthologs (QfO) benchmarking service (<xref ref-type="bibr" rid="R17">Gabaldón <italic>et al</italic>., 2009</xref>; <xref ref-type="bibr" rid="R1">Altenhoff <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="R29">Linard <italic>et al</italic>., 2021</xref>). QfO is the most widely used orthology benchmarking service, which evaluates a tool’s ability to accurately predict orthologs across a diverse set of taxa, including Archaea, Bacteria, and eukaryotes. QfO gives many different measures of accuracy, including comparisons to expert-curated reference orthologs and the accuracy of species trees inferred from a set of orthologs. We used the most recent published set of reference proteomes, which consists of 78 species (23 bacteria, 48 eukaryotes, and 7 archaea) (<xref ref-type="bibr" rid="R33">Nevers <italic>et al</italic>., 2022</xref>). We compared OrthoFinder v3 against the results obtained from 14 orthology inference tools.</p><p id="P17">Analysis of the resulting scores revealed that the new OrthoFinder v3 workflow for high scalability does not compromise accuracy (<xref ref-type="fig" rid="F5">Figure 5</xref>). OrthoFinder v3 is on the Pareto frontier for species tree discordance tests in both eukaryotes (<xref ref-type="fig" rid="F5">Figure 5A</xref>), and bacteria (<xref ref-type="fig" rid="F5">Figure 5B</xref>), demonstrating its ability to perform accurate orthology inference across different domains of life. The only other tool with scalability comparable to OrthoFinder v3 is FastOMA, but this method has substantially lower ortholog inference accuracy (<xref ref-type="fig" rid="F5">Figure 5</xref>). For example, while the Robinson-Foulds distance (measuring disagreement between true and inferred species trees) for eukaryotes is marginally worse in OrthoFinder v3 compared to FastOMA (0.06 vs. 0.05), OrthoFinder v3 has an 80% higher recall (15721 vs. 8686). Similarly, OrthoFinder v3 is marginally better than FastOMA for Robinson-Foulds distance on the bacteria species tree discordance test (0.590 vs. 0.587), but again has a 23% higher recall. OrthoFinder v3 is on the Pareto frontier for the enzyme classification test (<xref ref-type="fig" rid="F5">Figure 5C</xref>), which measures how well predicted orthologs match to Enzyme Commission numbers (which are given depending on the chemical reaction they catalyze). OrthoFinder v3 is only outperformed in precision by tools that rely on pre-computed databases (e.g. OrthoInspector and PANTHER), and is better than FastOMA in both precision (0.933 vs 0.928) and recall (183368 vs 157049).</p><p id="P18">OrthoFinder v3 is on the Pareto frontier for all three of the human-curated reference sets (<xref ref-type="fig" rid="F5">Figure 5 D-F</xref>), scoring particularly well on recall. OrthoFinder v3 has the highest recall of all methods on both the VGNC and SwissTree human-curated reference sets and is only marginally beaten for recall on the TreeFam dataset by OrthoFinder v2 (0.72 vs. 0.74). In summary, similar to the high accuracy of its orthogroup inference, OrthoFinder v3 also exhibits high accuracy ortholog inference across multiple benchmark tests.</p></sec></sec><sec id="S6" sec-type="discussion"><title>Discussion</title><p id="P19">Planet Earth is home to more than 6,000 species of mammal (Burgin <italic>et al</italic>., 2018), 300,000 species of plant (<xref ref-type="bibr" rid="R5">Christenhusz and Byng, 2016</xref>), 5,000,000 species of insect (<xref ref-type="bibr" rid="R18">Gaston, 1991</xref>), and an unknown number of species of unicellular eukaryotes, bacteria and archaea (<xref ref-type="bibr" rid="R32">Mora <italic>et al</italic>., 2011</xref>; <xref ref-type="bibr" rid="R21">Hugenholtz <italic>et al</italic>., 2021</xref>). Inferring the phylogenetic relationships between the biological sequences of these organisms provides a foundation upon which we can study evolution and molecular diversity, and enables us to understand and transfer biological information between organisms. It is likely that a substantial fraction of all known species on Earth will have a representative genome in the coming decades, but methods do not yet exist to enable this scale of data to be analysed. Here, we present a major advance to OrthoFinder that substantially improves the scalability and accuracy of the method. We show it is possible to rapidly assign gene sets from large numbers of species to a phylogenetically partitioned and structured database of biological sequences in near linear time. We also show that using phylogenetic delimitation improves the inference of orthogroups, enhancing the accuracy of OrthoFinder and extending its performance advantage over comparator methods. OrthoFinder remains an easy-to-use, fast, accurate, and fully phylogenetic orthology inference software tool. OrthoFinder also continues to be one of the few tools to provide a wide range of output information including gene duplications, gene trees, sequence alignments and single copy ortholog sequences allowing downstream analysis.</p><p id="P20">The updated OrthoFinder method is now capable of analysing thousands of species using a novel two-step process. Although this process requires an additional step for the user, the only input required is still the set amino acid sequences corresponding to the protein-coding genes for the species of interest. The default parameters for OrthoFinder have been optimized for speed, accuracy, and scalability and enable the combined analysis of thousands of species on commonly available computing resources. OrthoFinder also retains its customizability for expert users, and intermediate steps in the algorithm (such as alignment or tree inference) can be substituted with alternative methods should the user wish. Although there is still some distance to travel, this upgrade to OrthoFinder provides an important step towards the goal of being able to provide high accuracy phylogenetic orthology inference for all species on Earth.</p></sec><sec id="S7" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S8"><title>The OrthoFinder v3 workflow enhanced scalability workflow</title><p id="P21">The scalable linear species addition framework of OrthoFinder v3 requires the results of a conventional OrthoFinder analysis of an ‘core’ set of species. For each orthogroup, OrthoFinder v3 employs the SHOOT profile algorithm (<xref ref-type="bibr" rid="R15">Emms and Kelly, 2022</xref>) to select the most representative sequences using k-means clustering applied to an embedding of the sequences from the length L multiple sequence alignment (MSA) of the orthogroup in a 2*L-dimensional space. DIAMOND (<xref ref-type="bibr" rid="R2">Buchfink, Reuter and Drost, 2021</xref>) is used to assign the new genes to the core orthogroups using these profiles. Genes not assigned to any core orthogroups are set aside to be analysed separately at a later stage. Once all genes have been assigned, gene trees are inferred. To support the analysis of larger datasets, the MAFFT multiple sequence alignment method has been replaced with the more scalable FAMSA method (<xref ref-type="bibr" rid="R7">Deorowicz, Debudaj-Grabysz and Gudyś, 2016</xref>). Users can revert back to previous default alignment method “-A mafft”. Maximum likelihood tree inference of the resulting alignments is then performed using FastTree (<xref ref-type="bibr" rid="R35">Price, Dehal and Arkin, 2010</xref>) employing the “-fastest” runtime option. The use of other alignment or tree inference programs is supported through use of the config.json file, although users are advised to test if they have sufficient computational resources to use more computationally expensive programs. Once all orthogroup trees are inferred, a revised species tree is then computed using ASTRAL-Pro (<xref ref-type="bibr" rid="R40">Zhang and Mirarab, 2022</xref>).</p><p id="P22">As mentioned above, some genes fail to be assigned to any core orthogroups during the initial assignment step. This occurs because the new species (or sets of species) being added will sometimes contain new genes that have arisen <italic>de novo</italic>, and are not found in the core species set. To resolve this, OrthoFinder performs a root to tip tree traversal to identify clades of species (minimum size = 2) that had no representation in the now sparsely sampled initial core species set. Once identified a conventional OrthoFinder analysis is performed on the clade, and the new orthogroups are added to the revised orthogroup set.</p><p id="P23">The original OrthoFinder algorithm applied a per-species-pair gene length normalisation that accounted for both evolutionary-distance and gene-length dependence in pairwise bit-scores between sequences (<xref ref-type="bibr" rid="R13">Emms and Kelly, 2019</xref>). However, this normalisation step requires a large number of pairwise hits between the genes in each species in order to fit the required correction functions. To enable the smaller set analysis above, the updated version of OrthoFinder employs an alternative normalisation approach. The approach separates the sequence length bias and species divergences to obtain many independent estimates of the extent of each orthogroup Specifically, bit-scores between two sequences, B<sub>qh</sub>, are length normalised using geometric mean of the lengths of the query and hit sequences, L<sub>q</sub> and L<sub>h</sub>: B<sub>qh</sub>=B<sub>qh</sub>/(L<sub>q</sub>L<sub>h</sub>)<sup>1/2</sup>. As before, normalised reciprocal best hits (RBH) are treated as putative orthologs and are used to estimate the sequence divergence between pairs of species and on a per-orthogroup basis. In the modified version we calculate a set of ratios R<sub>XY</sub>* for species X and Y. These estimate the expected ratio of the normalised bit score between the RBH for a pair of genes x and y from species X and Y from some orthogroup and the normalised bit score from the gene x to the most distant gene in that orthogroup. Using these, every RBH observed can be used to estimate a cut-off for the most distant gene in that orthogroup. In this way, if a gene has an RBH in multiple species then it provides multiple independent estimates of the cut-off for the most distant sequence in the orthogroup. Likewise, if multiple genes from a (currently undetermined) orthogroup obtain one or more RBH, then these will each provide multiple independent estimates of the extent of the orthogroup. These estimates are used to construct a graph such that a pair of sequences is connected within the graph if the NBS between those sequences fall within that gene-specific and species-specific cut-off. As such, this graph attempts to connect as densely as possible with edges all sequences within the same orthogroup while having as few edges as possible between sequences in different orthogroups. As before, the MCL algorithm (<xref ref-type="bibr" rid="R39">Van Dongen, 2008</xref>) is applied to identify the sets of genes in the graph best satisfying the putative shared orthogroup memberships encoded in the edges of this graph. As with the core orthogroups, the resulting gene trees of the putative orthogroups are analysed to phylogenetically resolve the true extent of each orthogroup (<xref ref-type="fig" rid="F1">Figure 1</xref>). The non-core orthogroups are subjected to phylogenetic analysis to infer rooted gene trees and subsequently these rooted gene trees are analysed to determine the full comparative analysis including orthologs, hierarchical orthogroups, and gene duplication events.</p></sec><sec id="S9"><title>Assessing orthogroup inference accuracy</title><p id="P24">The full details on the orthogroup benchmarking, including the calculation of the scores, and a complete method by method breakdown of the results are provided in <xref ref-type="supplementary-material" rid="SD1">Supplemental File 1</xref> and the complete set of output files generated by each method is provided in <xref ref-type="supplementary-material" rid="SD2">Supplemental File 2</xref>.</p></sec><sec id="S10"><title>Assessing scalability performance</title><p id="P25">The Ensembl (<xref ref-type="bibr" rid="R19">Harrison <italic>et al</italic>., 2024</xref>) rapid release dataset was accessed on the 29<sup>th</sup> August 2024. Amino acid sequences for all protein coding genes in each genome were downloaded. For species which had more than one version available, the most recent proteome file was used. The OrthoFinder v2 script ‘primary_transcript.py’ was used to extract only the longest variant for each gene giving a dataset with a total of 1789 species. Following collection of the Ensembl proteomes an approximate species tree was derived in order to extract a set of representative proteomes for performance testing across each orthology inference tool. The species tree was generated using orthologs of BUSCO genes (<xref ref-type="bibr" rid="R31">Manni <italic>et al</italic>., 2021</xref>). In brief, the hidden Markov model provided for each BUSCO gene was used to identify high scoring amino acid sequences in each species. The resulting hits from each species to each BUSCO gene were aligned using MAFFT, and the resulting multiple sequence alignments concatenated. An unrooted phylogenetic tree was then inferred from this concatenated alignment using FastTree. This tree was then used as input to Phylogenetic Diversity Analyzer (<xref ref-type="bibr" rid="R4">Chernomor <italic>et al</italic>., 2015</xref>) to select sets of species in the range of 2-1024 species such that each subsequent set contained all the species of the previous set, and that each subset maximised the sampled branch length of the inferred tree. The complete result dataset for runtime and scalability of all methods is provided in <xref ref-type="supplementary-material" rid="SD3">Supplemental File 3</xref>.</p></sec><sec id="S11"><title>Assessing ortholog inference accuracy</title><p id="P26">OrthoFinder v3 was run on the 2022 edition of the Quest for Orthologs reference proteomes. We ran both OrthoFinder v3 Align (with FAMSA), and OrthoFinder v3 Linear (--core –assign). OrthoFinder v2 along with 13 other orthology inference tools have already been run on this dataset, and is available as part of the publicly available results alongside many methods. The Quest for Orthologs datasets consists of 78 proteomes (48 eukaryotes, 23 prokaryotes, and 7 archaea). We ran OrthoFinder on these input datasets and extracted pairs of orthologous genes identified by the method. The file containing orthologous pairs was uploaded to the Quest for Orthologs web server for benchmarking. The Quest for Orthologs papers describe the methodology for benchmarking in full detail (<xref ref-type="bibr" rid="R1">Altenhoff <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="R33">Nevers <italic>et al</italic>., 2022</xref>).</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental File 1</label><media xlink:href="EMS207303-supplement-Supplemental_File_1.docx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.wordprocessingml.document" id="d62aAcEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplemental File 2</label><media xlink:href="EMS207303-supplement-Supplemental_File_2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d62aAcEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplemental File 3</label><media xlink:href="EMS207303-supplement-Supplemental_File_3.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d62aAcEdB" position="anchor"/></supplementary-material></sec></body><back><ack id="S12"><title>Acknowledgements</title><p>The authors would like to thank the OrthoFinder user community for their feedback on the method and their continued support.</p><sec id="S13"><title>Funding</title><p>YL, LB, JH, SK were funded by the Wellcome Trust under grant agreement number 226598/Z/22/Z.</p></sec></ack><fn-group><fn id="FN1" fn-type="con"><p id="P27"><bold><italic>Author information</italic></bold></p><p id="P28">DE developed the method. DE, YL, LB, JH implemented software. DE, YL, LB, JH, SK contributed to the analysis. DE, LB, JH, SK wrote and edited the manuscript.</p></fn><fn id="FN2"><p id="P29"><bold><italic>Ethics declaration</italic></bold></p><p id="P30">Sk is co-founder of Wild Bioscience Ltd and an employee of Ellison Institute of Technology, Oxford Limited.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altenhoff</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Standardized benchmarking in the quest for orthologs</article-title><source>Nature Methods</source><year>2016</year><volume>13</volume><issue>5</issue><fpage>425</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3830</pub-id><pub-id pub-id-type="pmcid">PMC4827703</pub-id><pub-id pub-id-type="pmid">27043882</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname><given-names>B</given-names></name><name><surname>Reuter</surname><given-names>K</given-names></name><name><surname>Drost</surname><given-names>H-G</given-names></name></person-group><article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title><source>Nature Methods</source><year>2021</year><volume>18</volume><issue>4</issue><fpage>366</fpage><lpage>368</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id><pub-id pub-id-type="pmcid">PMC8026399</pub-id><pub-id pub-id-type="pmid">33828273</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgin</surname><given-names>CJ</given-names></name><etal/></person-group><article-title>How many species of mammals are there?</article-title><source>Journal of Mammalogy</source><year>2018</year><volume>99</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1093/jmammal/gyx147</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chernomor</surname><given-names>O</given-names></name><etal/></person-group><article-title>Split diversity in constrained conservation prioritization using integer linear programming</article-title><source>Methods in Ecology and Evolution</source><year>2015</year><volume>6</volume><issue>1</issue><fpage>83</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.12299</pub-id><pub-id pub-id-type="pmcid">PMC4392707</pub-id><pub-id pub-id-type="pmid">25893087</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christenhusz</surname><given-names>MJM</given-names></name><name><surname>Byng</surname><given-names>JW</given-names></name></person-group><article-title>The number of known plants species in the world and its annual increase</article-title><source>Phytotaxa</source><year>2016</year><volume>261</volume><issue>3</issue><fpage>201</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.11646/phytotaxa.261.3.1</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cosentino</surname><given-names>S</given-names></name><name><surname>Sriswasdi</surname><given-names>S</given-names></name><name><surname>Iwasaki</surname><given-names>W</given-names></name></person-group><article-title>SonicParanoid2: fast, accurate, and comprehensive orthology inference with machine learning and language models</article-title><source>Genome Biology</source><year>2024</year><volume>25</volume><issue>1</issue><fpage>195</fpage><pub-id pub-id-type="doi">10.1186/s13059-024-03298-4</pub-id><pub-id pub-id-type="pmcid">PMC11270883</pub-id><pub-id pub-id-type="pmid">39054525</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deorowicz</surname><given-names>S</given-names></name><name><surname>Debudaj-Grabysz</surname><given-names>A</given-names></name><name><surname>Gudyś</surname><given-names>A</given-names></name></person-group><article-title>FAMSA: Fast and accurate multiple sequence alignment of huge protein families</article-title><source>Scientific Reports</source><year>2016</year><volume>6</volume><issue>1</issue><elocation-id>33964</elocation-id><pub-id pub-id-type="doi">10.1038/srep33964</pub-id><pub-id pub-id-type="pmcid">PMC5037421</pub-id><pub-id pub-id-type="pmid">27670777</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derelle</surname><given-names>R</given-names></name><name><surname>Philippe</surname><given-names>H</given-names></name><name><surname>Colbourne</surname><given-names>JK</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Falush</surname><given-names>D</given-names></name></person-group><article-title>Broccoli: Combining Phylogenetic and Network Analyses for Orthology Assignment</article-title><source>Molecular Biology and Evolution</source><year>2020</year><volume>37</volume><issue>11</issue><fpage>3389</fpage><lpage>3396</lpage><pub-id pub-id-type="pmid">32602888</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>Search and clustering orders of magnitude faster than BLAST</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><issue>19</issue><fpage>2460</fpage><lpage>2461</lpage><pub-id pub-id-type="pmid">20709691</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>OrthoFinder: solving fundamental biases in whole genome comparisons dramatically improves orthogroup inference accuracy</article-title><source>Genome Biology</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>157</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0721-2</pub-id><pub-id pub-id-type="pmcid">PMC4531804</pub-id><pub-id pub-id-type="pmid">26243257</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>STRIDE: Species Tree Root Inference from Gene Duplication Events</article-title><source>Molecular Biology and Evolution</source><year>2017</year><volume>34</volume><issue>12</issue><fpage>3267</fpage><lpage>3278</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx259</pub-id><pub-id pub-id-type="pmcid">PMC5850722</pub-id><pub-id pub-id-type="pmid">29029342</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>STAG: Species Tree Inference from All Genes’</article-title><source>bioRxiv</source><year>2018</year><elocation-id>267914</elocation-id><pub-id pub-id-type="doi">10.1101/267914</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title><source>Genome Biology</source><year>2019</year><volume>20</volume><issue>1</issue><fpage>238</fpage><pub-id pub-id-type="doi">10.1186/s13059-019-1832-y</pub-id><pub-id pub-id-type="pmcid">PMC6857279</pub-id><pub-id pub-id-type="pmid">31727128</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>Benchmarking Orthogroup Inference Accuracy: Revisiting Orthobench</article-title><source>Genome Biology and Evolution</source><year>2020</year><volume>12</volume><issue>12</issue><fpage>2258</fpage><lpage>2266</lpage><pub-id pub-id-type="doi">10.1093/gbe/evaa211</pub-id><pub-id pub-id-type="pmcid">PMC7738749</pub-id><pub-id pub-id-type="pmid">33022036</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emms</surname><given-names>DM</given-names></name><name><surname>Kelly</surname><given-names>S</given-names></name></person-group><article-title>SHOOT: phylogenetic gene search and ortholog inference</article-title><source>Genome Biology</source><year>2022</year><volume>23</volume><issue>1</issue><fpage>85</fpage><pub-id pub-id-type="doi">10.1186/s13059-022-02652-8</pub-id><pub-id pub-id-type="pmcid">PMC8962542</pub-id><pub-id pub-id-type="pmid">35346327</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name></person-group><article-title>Distinguishing Homologous from Analogous Proteins</article-title><source>Systematic Biology</source><year>1970</year><volume>19</volume><issue>2</issue><fpage>99</fpage><lpage>113</lpage><pub-id pub-id-type="pmid">5449325</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabaldón</surname><given-names>T</given-names></name><etal/></person-group><article-title>Joining forces in the quest for orthologs</article-title><source>Genome Biology</source><year>2009</year><volume>10</volume><issue>9</issue><fpage>403</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-9-403</pub-id><pub-id pub-id-type="pmcid">PMC2768974</pub-id><pub-id pub-id-type="pmid">19785718</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaston</surname><given-names>KJ</given-names></name></person-group><article-title>The Magnitude of Global Insect Species Richness</article-title><source>Conservation Biology</source><year>1991</year><volume>5</volume><issue>3</issue><fpage>283</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1111/j.1523-1739.1991.tb00140.x</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>PW</given-names></name><etal/></person-group><article-title>Ensembl 2024</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><issue>D1</issue><fpage>D891</fpage><lpage>D899</lpage><pub-id pub-id-type="doi">10.1093/nar/gkad1049</pub-id><pub-id pub-id-type="pmcid">PMC10767893</pub-id><pub-id pub-id-type="pmid">37953337</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauser</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Söding</surname><given-names>J</given-names></name></person-group><article-title>MMseqs software suite for fast and deep clustering and searching of large protein sequence sets</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>9</issue><fpage>1323</fpage><lpage>1330</lpage><pub-id pub-id-type="pmid">26743509</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hugenholtz</surname><given-names>P</given-names></name><etal/></person-group><article-title>Prokaryotic taxonomy and nomenclature in the age of big sequence data</article-title><source>The ISME Journal</source><year>2021</year><volume>15</volume><issue>7</issue><fpage>1879</fpage><lpage>1892</lpage><pub-id pub-id-type="doi">10.1038/s41396-021-00941-x</pub-id><pub-id pub-id-type="pmcid">PMC8245423</pub-id><pub-id pub-id-type="pmid">33824426</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaduk</surname><given-names>M</given-names></name><name><surname>Sonnhammer</surname><given-names>E</given-names></name></person-group><article-title>Improved orthology inference with Hieranoid 2</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><issue>8</issue><fpage>1154</fpage><lpage>1159</lpage><pub-id pub-id-type="pmid">28096085</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelly</surname><given-names>S</given-names></name><name><surname>Maini</surname><given-names>PK</given-names></name></person-group><article-title>DendroBLAST: Approximate Phylogenetic Trees in the Absence of Multiple Sequence Alignments</article-title><source>PLOS ONE</source><year>2013</year><volume>8</volume><issue>3</issue><elocation-id>e58537</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0058537</pub-id><pub-id pub-id-type="pmcid">PMC3598851</pub-id><pub-id pub-id-type="pmid">23554899</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klemm</surname><given-names>P</given-names></name><name><surname>Stadler</surname><given-names>PF</given-names></name><name><surname>Lechner</surname><given-names>M</given-names></name></person-group><article-title>Proteinortho6: pseudo-reciprocal best alignment heuristic for graph-based detection of (co-)orthologs</article-title><source>Frontiers in Bioinformatics</source><year>2023</year><volume>3</volume><pub-id pub-id-type="doi">10.3389/fbinf.2023.1322477</pub-id><pub-id pub-id-type="pmcid">PMC10751348</pub-id><pub-id pub-id-type="pmid">38152702</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname><given-names>DM</given-names></name><etal/></person-group><article-title>Computational methods for Gene Orthology inference</article-title><source>Briefings in Bioinformatics</source><year>2011</year><volume>12</volume><issue>5</issue><fpage>379</fpage><lpage>391</lpage><pub-id pub-id-type="doi">10.1093/bib/bbr030</pub-id><pub-id pub-id-type="pmcid">PMC3178053</pub-id><pub-id pub-id-type="pmid">21690100</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langschied</surname><given-names>F</given-names></name><etal/></person-group><article-title>Quest for Orthologs in the Era of Biodiversity Genomics</article-title><source>Genome Biology and Evolution</source><year>2024</year><volume>16</volume><issue>10</issue><elocation-id>evae224</elocation-id><pub-id pub-id-type="doi">10.1093/gbe/evae224</pub-id><pub-id pub-id-type="pmcid">PMC11523110</pub-id><pub-id pub-id-type="pmid">39404012</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewin</surname><given-names>HA</given-names></name><etal/></person-group><article-title>Earth BioGenome Project: Sequencing life for the future of life</article-title><source>Proceedings of the National Academy of Sciences</source><year>2018</year><volume>115</volume><issue>17</issue><fpage>4325</fpage><lpage>4333</lpage><pub-id pub-id-type="doi">10.1073/pnas.1720115115</pub-id><pub-id pub-id-type="pmcid">PMC5924910</pub-id><pub-id pub-id-type="pmid">29686065</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Stoeckert</surname><given-names>CJ</given-names></name><name><surname>Roos</surname><given-names>DS</given-names></name></person-group><article-title>OrthoMCL: Identification of Ortholog Groups for Eukaryotic Genomes</article-title><source>Genome Research</source><year>2003</year><volume>13</volume><issue>9</issue><fpage>2178</fpage><lpage>2189</lpage><pub-id pub-id-type="doi">10.1101/gr.1224503</pub-id><pub-id pub-id-type="pmcid">PMC403725</pub-id><pub-id pub-id-type="pmid">12952885</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linard</surname><given-names>B</given-names></name><etal/></person-group><article-title>Ten Years of Collaborative Progress in the Quest for Orthologs</article-title><source>Molecular Biology and Evolution</source><year>2021</year><volume>38</volume><issue>8</issue><fpage>3033</fpage><lpage>3045</lpage><pub-id pub-id-type="doi">10.1093/molbev/msab098</pub-id><pub-id pub-id-type="pmcid">PMC8321534</pub-id><pub-id pub-id-type="pmid">33822172</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Majidian</surname><given-names>S</given-names></name><etal/></person-group><article-title>Orthology inference at scale with FastOMA</article-title><source>Nature Methods</source><year>2025</year><volume>22</volume><issue>2</issue><fpage>269</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-024-02552-8</pub-id><pub-id pub-id-type="pmcid">PMC11810774</pub-id><pub-id pub-id-type="pmid">39753922</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manni</surname><given-names>M</given-names></name><etal/></person-group><article-title>BUSCO Update: Novel and Streamlined Workflows along with Broader and Deeper Phylogenetic Coverage for Scoring of Eukaryotic, Prokaryotic, and Viral Genomes</article-title><source>Molecular Biology and Evolution</source><year>2021</year><volume>38</volume><issue>10</issue><fpage>4647</fpage><lpage>4654</lpage><pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id><pub-id pub-id-type="pmcid">PMC8476166</pub-id><pub-id pub-id-type="pmid">34320186</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname><given-names>C</given-names></name><etal/></person-group><article-title>How Many Species Are There on Earth and in the Ocean?</article-title><source>PLOS Biology</source><year>2011</year><volume>9</volume><issue>8</issue><elocation-id>e1001127</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001127</pub-id><pub-id pub-id-type="pmcid">PMC3160336</pub-id><pub-id pub-id-type="pmid">21886479</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nevers</surname><given-names>Y</given-names></name><etal/></person-group><article-title>The Quest for Orthologs orthology benchmark service in 2022</article-title><source>Nucleic Acids Research</source><year>2022</year><volume>50</volume><issue>W1</issue><fpage>W623</fpage><lpage>W632</lpage><pub-id pub-id-type="doi">10.1093/nar/gkac330</pub-id><pub-id pub-id-type="pmcid">PMC9252809</pub-id><pub-id pub-id-type="pmid">35552456</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nichio</surname><given-names>BTL</given-names></name><name><surname>Marchaukoski</surname><given-names>JN</given-names></name><name><surname>Raittz</surname><given-names>RT</given-names></name></person-group><article-title>New Tools in Orthology Analysis: A Brief Review of Promising Perspectives</article-title><source>Frontiers in Genetics</source><year>2017</year><volume>8</volume><fpage>165</fpage><pub-id pub-id-type="doi">10.3389/fgene.2017.00165</pub-id><pub-id pub-id-type="pmcid">PMC5674930</pub-id><pub-id pub-id-type="pmid">29163633</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Dehal</surname><given-names>PS</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name></person-group><article-title>FastTree 2 – Approximately Maximum-Likelihood Trees for Large Alignments</article-title><source>PLOS ONE</source><year>2010</year><volume>5</volume><issue>3</issue><elocation-id>e9490</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id><pub-id pub-id-type="pmcid">PMC2835736</pub-id><pub-id pub-id-type="pmid">20224823</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steenwyk</surname><given-names>JL</given-names></name><etal/></person-group><article-title>OrthoHMM: Improved Inference of Ortholog Groups using Hidden Markov Models’</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.12.07.627370</elocation-id><pub-id pub-id-type="doi">10.1101/2024.12.07.627370</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="confproc"><collab>The Darwin Tree of Life Project Consortium</collab><article-title>Sequence locally, think globally: The Darwin Tree of Life Project</article-title><source>Proceedings of the National Academy of Sciences</source><year>2022</year><volume>119</volume><issue>4</issue><elocation-id>e2115642118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2115642118</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trachana</surname><given-names>K</given-names></name><etal/></person-group><article-title>Orthology prediction methods: A quality assessment using curated protein families</article-title><source>BioEssays</source><year>2011</year><volume>33</volume><issue>10</issue><fpage>769</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1002/bies.201100062</pub-id><pub-id pub-id-type="pmcid">PMC3193375</pub-id><pub-id pub-id-type="pmid">21853451</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Dongen</surname><given-names>S</given-names></name></person-group><article-title>Graph Clustering Via a Discrete Uncoupling Process</article-title><source>SIAM Journal on Matrix Analysis and Applications</source><year>2008</year><volume>30</volume><issue>1</issue><fpage>121</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1137/040608635</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Mirarab</surname><given-names>S</given-names></name></person-group><article-title>ASTRAL-Pro 2: ultrafast species tree reconstruction from multi-copy gene family trees</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><issue>21</issue><fpage>4949</fpage><lpage>4950</lpage><pub-id pub-id-type="pmid">36094339</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>The improved phylogenetic delineation of orthogroups. OrthoFinder reconciles gene trees with the species tree to identify duplication events within putative MCL orthogroups. When a duplication event is identified to have occurred prior to the divergence of the species set under consideration, then orthogroup is split into two (or more) independent orthogroups, ensuring that each resulting orthogroup contains only genes descended from a single gene in the last common ancestor of all species (the definition of an orthogroup).</p></caption><graphic xlink:href="EMS207303-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Comparative analysis of different orthogroup inference tools on the OrthoBench dataset. Panels A-G each show one of seven performance metrics used to evaluate orthology prediction accuracy. Lower values indicate better performance for error-based metrics (A-D,G), higher values are better for recall and precision (E-F). Panel H shows the rank score, combining all seven metrics.</p></caption><graphic xlink:href="EMS207303-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>The OrthoFinder v3 workflow. The first step of OrthoFinder 3 is to perform a conventional OrthoFinder run on a set of core proteomes. The second step then uses an adapted version of the SHOOT profiling algorithm to assign genes from additional species to these core orthogroups and identify new orthogroups not present in the initial input gene set. Gene trees are then inferred and used to infer a revised species tree. All results files are then revised and updated.</p></caption><graphic xlink:href="EMS207303-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>A comparison of runtime and peak memory usage for orthogroup inference tools.</title><p>(A) Time (log scale) and (B) peak RAM usage required to run different orthology prediction tools across increasing numbers of input proteomes (from 2 to 1024).</p></caption><graphic xlink:href="EMS207303-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>A comparative analysis of ortholog inference accuracy on the Quest for Orthologs dataset. Each panel shows a different benchmark from the QfO benchmarking service (2022 release). OrthoFinder is compared against other ortholog inference methods which have made their results publicly available. (A–B) Species tree discordance (Robinson-Foulds distance) vs. recall across completed gene trees for eukaryotes (A) and bacteria (B). (C) Conservation of enzyme classification across orthologs (Schlicker similarity) vs. number of orthologous relationships. (D) VGNC reference orthologs: precision vs. recall. (E–F) SwissTree (E) and TreeFam (F) reference gene trees: precision vs. recall. Better-performing methods are toward the top-right for precision measures (C-F), and bottom right for discordance measures (A-B).</p></caption><graphic xlink:href="EMS207303-f005"/></fig></floats-group></article>