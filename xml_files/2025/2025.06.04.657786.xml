<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206207</article-id><article-id pub-id-type="doi">10.1101/2025.06.04.657786</article-id><article-id pub-id-type="archive">PPR1030882</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>REnformer, a single-cell ATAC-seq predicting model to investigate open chromatin sites</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Riva</surname><given-names>Simone G.</given-names></name><email>simone.riva@imm.ox.ac.uk</email></contrib><contrib contrib-type="author"><name><surname>Sanders</surname><given-names>Edward</given-names></name><email>edward.sanders@imm.ox.ac.uk</email></contrib><contrib contrib-type="author"><name><surname>Wilson</surname><given-names>Tom</given-names></name><email>tom.wilson@imm.ox.ac.uk</email></contrib><aff id="A1"><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02khxwt12</institution-id><institution>MRC Molecular Haematology Unit</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01q496a73</institution-id><institution>MRC Weatherall Institute of Molecular Medicine</institution></institution-wrap><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>Oxford University</institution></institution-wrap><city>Oxford</city>, <country country="GB">UK</country></aff></contrib-group><contrib-group><contrib contrib-type="author"><name><surname>Stranieri</surname><given-names>Nicolo</given-names></name><email>nicolo.stranieri@studbocconi.it</email><aff id="A2">Department of Computing Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05crjpb27</institution-id><institution>Bocconi University</institution></institution-wrap><city>Milan</city>, <country country="IT">Italy</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="author"><name><surname>GUr</surname><given-names>E. Ravza</given-names></name><email>emine.gur@ndcls.ox.ac.uk</email></contrib><contrib contrib-type="author"><name><surname>Baxter</surname><given-names>Matthew</given-names></name><email>matthew.baxter@ndcls.ox.ac.uk</email></contrib><contrib contrib-type="author"><name><surname>Hughes</surname><given-names>Jim R.</given-names></name><email>jim.hughes@imm.ox.ac.uk</email></contrib><aff id="A3"><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02khxwt12</institution-id><institution>MRC Molecular Haematology Unit</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01q496a73</institution-id><institution>MRC Weatherall Institute of Molecular Medicine</institution></institution-wrap><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>Oxford University</institution></institution-wrap><city>Oxford</city>, <country country="GB">UK</country></aff></contrib-group><pub-date pub-type="nihms-submitted"><day>06</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>04</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Genome regulatory elements are fundamental to cellular identity and cell type specific gene expression. Understanding how the underlying genetic code is differentially utilised by different cell types is central to understanding human health and disease. To better understand how DNA encodes genome regulatory elements such as promoters, enhancers, and boundary elements, we leverage the Enformer gene expression and epigenetic prediction model. We used transfer learning with high quality single cell ATAC datasets to develop REnformer, a model to predict chromatin accessibility. By introducing a benchmark for comparing performances against Enformer model, REnformer significantly outperformed Enformer in terms of higher prediction outcomes and lower error rates in all extensive analyses shown; introducing these benchmarks allowed us, and possible future works, to fairly compare such models. We further tested REnformer by predicting the effects of a well characterised Î±-thalassemia variant and found that the prediction aligned with the observed change in genome regulatory element, previously validated. We conclude that REnformer is and can be a state-of-the-art tool to predict cell type specific regulatory elements, and interrogate the effect of genome variation in health and disease.</p></abstract><kwd-group><title>Index Terms</title><kwd>Transfer learning</kwd><kwd>Deep Learning</kwd><kwd>Gene regulation</kwd><kwd>Genome variation</kwd></kwd-group></article-meta></front><body><sec id="S1"><label>I</label><title>Introduction &amp; Motivation</title><p id="P2">Chromatin states from DNA sequences provide a more comprehensive view of genome regulation. At the genome level, many non-coding genetic variants associated with human disease and traits might or might not affect this regulation, creating a huge machinery that is manually difficult to decipher and even time-consuming due to the specificity occurring differently in cell populations or tissues. In addition, this variety of mechanisms can be linked to variants or causal associations due to linkage disequilibrium.</p><p id="P3">To date, numerous computational approaches have been developed to deep-dive into such a problem. Spanning from deep convolutional neural networks, like in DeepSEA [<xref ref-type="bibr" rid="R1">1</xref>], Basset [<xref ref-type="bibr" rid="R2">2</xref>], and DeepHaem [<xref ref-type="bibr" rid="R3">3</xref>], where peak calling is needed to focus on open chromatin regions, to more cutting-edge methods such as transformer-based architecture, like DNABERT [<xref ref-type="bibr" rid="R4">4</xref>] and Enformer [<xref ref-type="bibr" rid="R5">5</xref>]. The former follows the same paradigm as BERT, a transformer-based model that excels in natural language processing tasks by utilising pre-training and finetuning to develop general understandings from unlabeled data; whereas the latter is a neural network architecture based on self-attention with the aim to predict gene expression and chromatin states from DNA sequences.</p><p id="P4">With all these new methods and technologies in our hands, it is difficult to understand which approach is correct to answer niche biological questions. Our interest is to better understand CTCF, enhancer, and promoter interactions and their effects on gene expression [<xref ref-type="bibr" rid="R6">6</xref>], [<xref ref-type="bibr" rid="R7">7</xref>]. Therefore, our work focuses on leveraging the Enformer model to make a better predictor of cell populations and decipher gene regulation in noncoding regions when driven by CTCF, promoter, and enhancer interactions.</p><p id="P5">A key motivation for this work is its future applications for genome-wide association study (GWAS) and variant prioriti-sation. As shown in [<xref ref-type="bibr" rid="R5">5</xref>], variant effects can be identified in the genome. In GWAS analyses, a haplotype gets linked to a trait. This model enables one to fine-map to both individual variants, cell types, and regulatory elements. Furthermore, if a model correctly links enhancers to promoters, it can enable one to link GWAS haplotypes to genes (via their promoters).</p><p id="P6">In this study, we present REnformer, a network based on a previously published model (Enformer) [<xref ref-type="bibr" rid="R5">5</xref>], with the intent to predict open chromatin regions from DNA sequence from 151 single-cell Assay for Transposase-Accessible Chromatin using sequencing (scATAC-seq); introducing a data normalisation step and a benchmark that shows the better performance that can be achieved with REnformer, but also allowing benchmarking future approaches with the current state-of-the-art.</p></sec><sec id="S2"><label>II</label><title>Data &amp; Method</title><p id="P7">This section focuses on what publicly available data we collected, how we processed it, and the architecture of REn-former.</p><sec id="S3"><label>A</label><title>Data collection</title><p id="P8">We collected 151 different scATAC-seq types from various samples and collections (genome version GRCh38), allowing us to cover almost the entire human body. In detail, we selected 7 cell types from Turner <italic>et al.</italic> [<xref ref-type="bibr" rid="R8">8</xref>], 107 cell types from Zhang <italic>et al.</italic> [<xref ref-type="bibr" rid="R9">9</xref>], 15 cell types from Granja <italic>et al.</italic> [<xref ref-type="bibr" rid="R10">10</xref>], 18 primary peripheral blood mononuclear cells (PBMC) cell types (See <xref ref-type="table" rid="T1">Table I</xref>), and 3 erythroid differentiation stages and 1 human umbilical vein endothelial cell (HUVEC) <italic>in-house</italic> generated (see <xref ref-type="table" rid="T1">Table II</xref>) for full list of cell types).</p></sec><sec id="S4"><label>B</label><title>Data processing</title><p id="P9">The <italic>in-house</italic> generated data has been processed using 10X Genomics Cell Ranger ATAC/ARC (v2.0.0), making bigWig files; Turner <italic>et al.</italic>, Granja <italic>et al.</italic>, and PBMCs datasets have been (upstream and downstream) analysed in more detail to isolate and generate bigWig files of the correct cell types of interest; whereas, Zhang <italic>et al.</italic> data has been taken from their interactive web atlas in bigWig format directly.</p><p id="P10">Once all bigWig files (one per cell type) were collected, we normalised the coverage counts across all samples to make them comparable across experiments and cell types using the <italic>in-house</italic> zone z-score normalisation (<italic>ZZS</italic>). This is a modified version of z-score normalisation used to make RNA-seq comparable between samples [<xref ref-type="bibr" rid="R11">11</xref>]. Compared to the traditional z-score, the modified version is better suited for skew and more robust to outliers [Reference book: Volume 16: How to Detect and Handle Outliers, Boris Iglewicz, David Caster Hoaglin].</p><p id="P11"><italic>ZZS</italic> is divided into 6 phases: 1) Coordinates within the hg38 blacklist [<xref ref-type="bibr" rid="R12">12</xref>] and regions with 500 base-pairs (bp) or more consecutive zeros were masked. To reduce the impact of noise, remaining signal was smoothed via convolution with a 301 bp triangular kernel. 2) The modified z-score fits a normal distribution per chromosome c centred at the median of c and scaled by an approximation of 1 standard deviation. The median absolute deviation from the median for <italic>c</italic> was calculated as <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>Â¯</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and if <italic>MAD</italic> â  0, the scale set as 1.4826 Ã <italic>MAD</italic>. Otherwise, the mean absolute deviation was calculated as <italic>meanAD<sub>c</sub></italic> = |x<sub>c</sub>i â <italic>Î¼<sub>c</sub></italic>| and scale set as 1.2533 Ã <italic>meanAD.</italic> These constants were taken from common usage of scale parameters [<xref ref-type="bibr" rid="R13">13</xref>]. 3) As the vast majority of scATAC-seq signal is noise, a threshold was derived using a probability of 99.7% to capture the value at which the smoothed signal for <italic>c</italic> falls three deviations from the median. The threshold was applied across each bp in the smoothed signal. Start and end coordinates exceeding the threshold for 35 bp or more were extracted, rounded to the nearest full-sized bin of 1, 000 bp size and consecutive coordinates merged forming signal zones. 4) Fragment size <italic>f<sub>c</sub></italic> was estimated per chromosome as the smallest non-zero value <italic>f<sub>c</sub></italic> = min({x<sub>ci</sub> | x<sub>ci</sub> â  0}) and the global mean reads excluding zeros <italic>Î¼<sub>g</sub></italic> calculated across all chromosomes. Zones were then filtered to remove those where all signals falls below quality threshold <italic>Ï<sub>c</sub></italic> = <italic>max(1.5Î¼<sub>c</sub>,</italic> 1.5Î¼<sub>g</sub><italic>, 10f<sub>c</sub></italic>) â we observed the upper noise boundary tends to fall around 1.5Ã the non-zero mean, so 1.5Ã is a safety net for larger library sizes; and anything less than 10 reads was considered low-quality data, as also shown in pre-filtering count cutoff recommended by DESeq2 [<xref ref-type="bibr" rid="R14">14</xref>] and csaw [<xref ref-type="bibr" rid="R15">15</xref>]. 5) For each sample, the bigWig signal across its zones is extracted per chromosome and zeros removed. Then, the 10<sup><italic>th</italic></sup> lower and upper percentile of values are also removed to improve robustness against technical artifacts. An intermediate signal per bp is calculated via the z-score: <disp-formula id="FD1"><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Î¼</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Ï</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P12">by using the remaining signal <inline-formula><mml:math id="M3"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, its mean <inline-formula><mml:math id="M4"><mml:msub><mml:mover accent="true"><mml:mi>Î¼</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="M5"><mml:msub><mml:mover accent="true"><mml:mi>Ï</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>. 6) Finally, as scATAC-seq signal is positive, if <italic>z<sub>c</sub></italic> contains a negative value, the minimum is subtracted to produce the normalised chromosome signal <italic>ZZS<sub>c</sub></italic> : <disp-formula id="FD2"><mml:math id="M6"><mml:mrow><mml:mi>Z</mml:mi><mml:mi>Z</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>â</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Î¶</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P13">We then processed all normalised samples and chunk the sequences in 196,608 bp, covering 50% of the genome per sample, removing blacklist regions, and obtaining a total of 7,099 regions functioning as input for the model. These 7,099 regions have also been converted into 896 bp in length, corresponding to 114,688 bp, by cropping 40,960 bp on each side and aggregated into 128 bp bins as the target of the model.</p></sec><sec id="S5" sec-type="methods"><label>C</label><title>Method</title><p id="P14">We build REnformer leveraging Enformer architecture, which consists of 7 convolutional blocks with pooling, 11 transformer blocks, and a cropping layer followed by final pointwise convolution developed in Tensorflow (v2.4.1) [<xref ref-type="bibr" rid="R16">16</xref>] and Sonnet (v2.0.0) [<xref ref-type="bibr" rid="R17">17</xref>] and converted into PyTorch (v2.4.1) [<xref ref-type="bibr" rid="R18">18</xref>] under Python v3.11.11. We also mapped the trained Tensorflow weights, released by Avsec <italic>et al.</italic> [<xref ref-type="bibr" rid="R5">5</xref>], into PyTorch weights for transfer learning purposes and replaced the output head of Enformer with our output head (see <xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P15">With a one-hot-encoded DNA sequence of length 196,608 bp as input (A = [1,0,0,0], C = [0,1,0,0], G = [0,0,1,0], T = [0,0,0,1], and N = [0,0,0,0]), our model predicts 151 genomic tracks for the human genome, each of the tracks being 896 bp long, totalling 114,688 bp aggregated into 128 bp bins, as explained in Section II-A and II-B.</p></sec></sec><sec id="S6"><label>III</label><title>Result</title><p id="P16">We introduce REnformer, a revisited version of Enformer, leveraging transfer learning strategy to train the network on scATAC-seq data only â since it offers more thorough insight into the use of such data and is abundant in epigenetic information at the cell level, when compared to any bulk technology [<xref ref-type="bibr" rid="R19">19</xref>] â with the purpose of predicting open chromatin from DNA sequence in humans and investigating possible hypotheses on genomic variation within chromatin states. In the training phase, we applied the transfer-learning technique, consisting of a subset of fine-tuning approach class, only the new final layers are trained on the new scATAC-seq data, whilst the rest of the model has been frozen, leveraging the learned features from the original Enformer model. We sampled the genome, selecting 9, 406 regions and divided them into train and test sets, respectively, 7, 099 (75%) and 2, 307 (25%) 196,608 bp region length. We then trained REnformer on Nvidia L40S graphics processing unit using the 7, 099 regions. <xref ref-type="fig" rid="F2">Figure 2</xref> shows the output of Renfomer in chr10 : 22241840â22356528 region â selected from the test set â comparing the output of HUVEC experiment provided to REnformer (light green) and its prediction (dark green), against the two DNase I hypersensitive sites sequencing (DNase) HUVEC provided to Enformer (DNase experiment HUVEC 1 in light blue and Enformer prediction in dark blue; DNase experiment HUVEC 2 in light orange and Enformer prediction in dark orange). As illustrated in <xref ref-type="fig" rid="F2">Figure 2</xref>, using the normalisation described in Section II-B, and scATAC-seq data for REnformer, allowed us to fine-map the open chromatin sites with a better global visual resolution than Enformer. Even if Enformer can predict open chromatin, there is a lack of sensitivity in some hypersensitive regions.</p><p id="P17">Subsequently, we introduced three tests to evaluate and better compare REnformer against Enformer performances, all based on the root mean square error (<italic>RMSE</italic>): <disp-formula id="FD3"><mml:math id="M7"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P18">where <inline-formula><mml:math id="M8"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>â¦</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent the predicted values, and <italic>y<sub>ij1</sub></italic>,â¦ <italic>y<sub>ijk</sub>,â¦, y<sub>ijn</sub></italic> denote the ground truth values for element <italic>i</italic> in the set, class <italic>j</italic> â [1,â¦,151], and region <italic>k</italic> â [1,â¦, <italic>n</italic>] with <italic>n</italic> = 896. All three metrics are a variation of the normalised <italic>RMSE<sub>ij</sub></italic> (<italic>NRMSE<sub>ij</sub></italic>): firstly, normalising by using the standard deviation Ï: <disp-formula id="FD4"><mml:math id="M9"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>Ï</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P19">secondly, normalising by the min-max values: <disp-formula id="FD5"><mml:math id="M10"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P20">and thirdly, normalising by the difference of the <italic>75<sup><italic>th</italic></sup></italic> and 25<sup><italic>th</italic></sup> quantiles: <disp-formula id="FD6"><mml:math id="M11"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mn>75</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>â</mml:mo><mml:mi>Q</mml:mi><mml:mn>25</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P21">where <italic>Îµ</italic> = 1<italic>e</italic><sup>-8</sup> in all three cases, since some values in the ground truth are constant in some region <italic>i,</italic> and to avoid division by zero error. From the test set, we removed regions where the target was only filled with zeros (123), obtaining 2, 184 regions and randomly grouped them, without duplication in six subsets. We then applied the <inline-formula><mml:math id="M12"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="M13"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> between all predicted<inline-formula><mml:math id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and observed <italic>y<sub>ij</sub></italic> values, where i is the region and <italic>j</italic> the class. Similarly, we applied the same tests on 151 (same number of classifiers in REnformer) selected DNase classifiers in Enformer model and visualised the results in <xref ref-type="fig" rid="F3">Figure 3.</xref> For each <inline-formula><mml:math id="M15"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:math></inline-formula>, where <italic>k</italic> â [1, 2, 3], we also applied Mann-Whitney U test [<xref ref-type="bibr" rid="R20">20</xref>], by using <monospace>alternative = âlessâ</monospace>. The distribution underlying REnformer observed and predicted data is stochastically less than the distribution underlying Enformer observed and predicted data, for all regions of interest, using Bonferroni correction [<xref ref-type="bibr" rid="R21">21</xref>], showing that in all comparisons â except in subset 6 for <inline-formula><mml:math id="M16"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, where we cannot rule out the null hypothesis â there is a statistically difference in <inline-formula><mml:math id="M17"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:math></inline-formula> in favour of REnformer outcomes. This analysis introduced a way to compare and benchmark REnformer against Enformer, or any future model based on either of these, and showed that applying transfer learning along with the introduced data processing (explained in Section II-B), REnformer outperformed Enformer model. Furthermore, the kernel density estimates (<italic>KDE</italic>) in <xref ref-type="fig" rid="F4">Figure 4</xref> indicated that the <italic>KDE</italic> curves for REnformer begin at lower error values, reach higher peaks, and drop off more rapidly, indicating overall better performance. However, the greater variability in the REnformer peaks suggests a higher heterogeneity in the difficulty of predicting values among classes.</p><p id="P22">In addition, we checked edge cases results to understand the differences between REnformer predictions and the observed values. We plotted selected the randomly selected regions in subset 1, and in <xref ref-type="fig" rid="F5">Figure 5</xref>, where each dot represents a region <italic>i</italic> for a classifier <italic>j</italic> for REnformer model, with the <italic>RMSE<sub>ij</sub></italic> (x-axis) against the <inline-formula><mml:math id="M18"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (y-axis. We picked 5 dots <italic>ij</italic> , a random one (orange), the one with the worst <italic>RMSE<sub>ij</sub></italic> value (green), the worst <inline-formula><mml:math id="M19"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (red), the best <inline-formula><mml:math id="M20"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (purple), and the best <italic>RMSEij</italic> (brown). Consequently, we showed the predicted and observed genomic tracks for these 5 regions (see <xref ref-type="fig" rid="F6">Figure 6</xref>), instructing us that such difference between the prediction and the ground truth is minimum; for the worst <italic>RMSE</italic> <bold>(6a</bold>), worst <inline-formula><mml:math id="M21"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <bold>(6b</bold>), random <bold>(6c</bold>), and the best <inline-formula><mml:math id="M22"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <bold>(6d</bold>) regions the difference is only in the magnitude of the open chromatin sites. In contrast, the best <italic>RMSEij</italic> <bold>(6e</bold>) region is related to a genomic region filled with zeros in the target; whilst its prediction, for the selected class, is asymptotically zero in all the prediction scores across the targeted genomic region. This shows that also in the edge-cases, the prediction is close to the observed values, confirming the positive outcomes of our REnformer model.</p><p id="P23">Given the excellent obtained REnformer results, we wanted to investigate some mutagenesis analysis and how variants might affect open chromatin sites. To do so, we choose a variant form of the inherited blood disorder <italic>Î±</italic> thalassemia [<xref ref-type="bibr" rid="R22">22</xref>], since our model has learnt three behaviours of the erythroid differentiation. This selection has been driven from the fact that this variant T into C, occurring in position chr16 : 159710 (in hg38) is well understood and studied in the biological field, as it is a gain of function, which act as an orientation dependent enhancer blocker, by creating a new promoter [<xref ref-type="bibr" rid="R22">22</xref>], [<xref ref-type="bibr" rid="R23">23</xref>]. With this information, providing the reference genome and the alteration genome (which includes the variant T instead of the C), we expected to see a peak underneath the variant region only when predicting the open chromatin in erythroid data in the altered genome. Indeed, <xref ref-type="fig" rid="F7">Figure 7</xref> shows T/C mutation, where it is visualised, in green, the most differentiated experiment erythroid track (chr16 : 102366â217054), the prediction using REnformer using the hg38 reference genome in blue, showing that it resembles coherently the epigenetic sites as per the experiment, and the prediction with the variation in it in red. To visualise better where the gain of function and the promoter appear, we subtracted from the prediction on the alteration, the prediction on the reference, in purple, showing that the created promoter, in fact, becomes visible where the T/C variation is applied; even more strongly visible when overalying the blue and red, respectively the reference and altered genome, tracks. This result, indeed, was aligned with the discovery in early 2000s by De Gobbi <italic>et al.</italic> [<xref ref-type="bibr" rid="R22">22</xref>] and then reconfirmed in more details by Bozhilov <italic>et al.</italic> [<xref ref-type="bibr" rid="R23">23</xref>].</p></sec><sec id="S7"><label>IV</label><title>Conclusion &amp; future work</title><p id="P24">In this work, we presented REnformer, a transformer-based approach, based on the published Enformer model, where applying transfer learning strategy to learn epigenetic features from scATAC-seq data, we were able to achieve a better performance (<xref ref-type="fig" rid="F3">Figure 3</xref>) and resolution <xref ref-type="fig" rid="F5">Figures 5</xref> and <xref ref-type="fig" rid="F6">6</xref> on predicted values (<xref ref-type="fig" rid="F2">Figure 2</xref>), given the introduced data normalisation (Section II-B) and the high resolution of the data collected (Section II-A). Furthermore, we showed that single nucleotide variant (SNP) analysis, i.e., looking at the <italic>Î±</italic> thalassaemia example, where the T into C, shown in <xref ref-type="fig" rid="F7">Figure 7</xref>, demonstrating that REnformer can detect this change, which creates a promoter. In fact, a key application is to comprehend mutagenesis, the effect of variants, to better fine-map GWAS traits, with also applications to rare diseases. Linking these achievements with REgulamentary [<xref ref-type="bibr" rid="R24">24</xref>], where using open chromatin and histone mark data can allow us to link haplotypes to gain or loss in gene regulatory regions with high granularity. This is often limited by the inability to fine-map from a linked haplotype, containing many variants, to one or more variants. Currently, we have to integrate REnformer with other pipeline analyses to achieve these goals. REnformer will enable us to prioritise and rank which variants, within a haplotype, are most likely to have a causal relationship, and eventually also to infer the interactionâs directionality between regulatory elements and decipher better the non-coding landscape. Lastly, to further improve and refine REnformer prediction of open chromatin in different classes and minimise errors between predicted and observed values, an adjustment on the proposed loss function, by Avsec <italic>et al.</italic>, and batch size during the training phase should be taken into consideration.</p></sec></body><back><ack id="S8"><title>Acknowledgment</title><p id="P25">S.G.R. is supported by the MRC grant (MCÍUUÍ00029/3). E.S. and M.B. are supported by the Wellcome Trust grant (225220/Z/22/Z). T.W is supported by the MRC grant (MCÍSTÍ00029)o E.R.G. is supported by the Ministry of National Education Selection and Placement of Candidates Sent Abroad for Postgraduate Education (YLSY) scholarship, Republic of TÃ¼rkiye Ministry of National Education and the Wellcome Trust grant (225220/Z/22/Z). J.R.H. is supported by the Wellcome Trust grants (225220/Z/22/Z and 106130/Z/14/Z) and the MRC grant (MCÍUUÍ00029/3).</p></ack><fn-group><fn id="FN1"><p id="P26"><bold>Declaration</bold></p><p id="P27">J.R.H. is a co-founder and director of Nucleome Therapeutics and provides consultancy to the company.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Jian</given-names></name><name><surname>Troyanskaya</surname><given-names>Olga G</given-names></name></person-group><article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title><source>Nature methods</source><year>2015</year><volume>12</volume><issue>10</issue><fpage>931</fpage><lpage>934</lpage><pub-id pub-id-type="pmcid">PMC4768299</pub-id><pub-id pub-id-type="pmid">26301843</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.3547</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelley</surname><given-names>David R</given-names></name><name><surname>Snoek</surname><given-names>Jasper</given-names></name><name><surname>Rinn</surname><given-names>John L</given-names></name></person-group><article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title><source>Genome research</source><year>2016</year><volume>26</volume><issue>7</issue><fpage>990</fpage><lpage>999</lpage><pub-id pub-id-type="pmcid">PMC4937568</pub-id><pub-id pub-id-type="pmid">27197224</pub-id><pub-id pub-id-type="doi">10.1101/gr.200535.115</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwessinger</surname><given-names>Ron</given-names></name><name><surname>Gosden</surname><given-names>Matthew</given-names></name><name><surname>Downes</surname><given-names>Damien</given-names></name><name><surname>Brown</surname><given-names>Richard C</given-names></name><name><surname>Oudelaar</surname><given-names>A Marieke</given-names></name><name><surname>Telenius</surname><given-names>Jelena</given-names></name><name><surname>Teh</surname><given-names>Yee Whye</given-names></name><name><surname>Lunter</surname><given-names>Gerton</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name></person-group><article-title>Deepc: predicting 3d genome folding using megabase-scale transfer learning</article-title><source>Nature methods</source><year>2020</year><volume>17</volume><issue>11</issue><fpage>1118</fpage><lpage>1124</lpage><pub-id pub-id-type="pmcid">PMC7610627</pub-id><pub-id pub-id-type="pmid">33046896</pub-id><pub-id pub-id-type="doi">10.1038/s41592-020-0960-3</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>Yanrong</given-names></name><name><surname>Zhou</surname><given-names>Zhihan</given-names></name><name><surname>Liu</surname><given-names>Han</given-names></name><name><surname>Davuluri</surname><given-names>Ramana V</given-names></name></person-group><article-title>Dnabert: pre-trained bidirectional encoder representations from transformers model for dna-language in genome</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><issue>15</issue><fpage>2112</fpage><lpage>2120</lpage><pub-id pub-id-type="pmcid">PMC11025658</pub-id><pub-id pub-id-type="pmid">33538820</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab083</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avsec</surname><given-names>Ziga</given-names></name><name><surname>Agarwal</surname><given-names>Vikram</given-names></name><name><surname>Visentin</surname><given-names>Daniel</given-names></name><name><surname>Ledsam</surname><given-names>Joseph R</given-names></name><name><surname>Grabska-Barwinska</surname><given-names>Agnieszka</given-names></name><name><surname>Taylor</surname><given-names>Kyle R</given-names></name><name><surname>Assael</surname><given-names>Yannis</given-names></name><name><surname>Jumper</surname><given-names>John</given-names></name><name><surname>Kohli</surname><given-names>Pushmeet</given-names></name><name><surname>Kelley</surname><given-names>David R</given-names></name></person-group><article-title>Effective gene expression prediction from sequence by integrating long-range interactions</article-title><source>Nature methods</source><year>2021</year><volume>18</volume><issue>10</issue><fpage>1196</fpage><lpage>1203</lpage><pub-id pub-id-type="pmcid">PMC8490152</pub-id><pub-id pub-id-type="pmid">34608324</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01252-x</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Downes</surname><given-names>Damien J</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name></person-group><article-title>Natural and experimental rewiring of gene regulatory regions</article-title><source>Annual Review of Genomics and Human Genetics</source><year>2022</year><volume>23</volume><fpage>73</fpage><lpage>97</lpage><pub-id pub-id-type="pmid">35472292</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larke</surname><given-names>Martin SC</given-names></name><name><surname>Schwessinger</surname><given-names>Ron</given-names></name><name><surname>Nojima</surname><given-names>Takayuki</given-names></name><name><surname>Telenius</surname><given-names>Jelena</given-names></name><name><surname>Beagrie</surname><given-names>Robert A</given-names></name><name><surname>Downes</surname><given-names>Damien J</given-names></name><name><surname>Oudelaar</surname><given-names>A Marieke</given-names></name><name><surname>Truch</surname><given-names>Julia</given-names></name><name><surname>Graham</surname><given-names>Bryony</given-names></name><name><surname>Bender</surname><given-names>MA</given-names></name><etal/></person-group><article-title>Enhancers predominantly regulate gene expression during differentiation via transcription initiation</article-title><source>Molecular cell</source><year>2021</year><volume>81</volume><issue>5</issue><fpage>983</fpage><lpage>997</lpage><pub-id pub-id-type="pmcid">PMC7612206</pub-id><pub-id pub-id-type="pmid">33539786</pub-id><pub-id pub-id-type="doi">10.1016/j.molcel.2021.01.002</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname><given-names>Adam W</given-names></name><name><surname>Hu</surname><given-names>Shengen Shawn</given-names></name><name><surname>Mosquera</surname><given-names>Jose Verdezoto</given-names></name><name><surname>Ma</surname><given-names>Wei Feng</given-names></name><name><surname>Hodonsky</surname><given-names>Chani J</given-names></name><name><surname>Wong</surname><given-names>Doris</given-names></name><name><surname>Auguste</surname><given-names>Gaelle</given-names></name><name><surname>Song</surname><given-names>Yipei</given-names></name><name><surname>Sol-Church</surname><given-names>Katia</given-names></name><name><surname>Farber</surname><given-names>Emily</given-names></name><etal/></person-group><article-title>Single-nucleus chromatin accessibility profiling highlights regulatory mechanisms of coronary artery disease risk</article-title><source>Nature genetics</source><year>2022</year><volume>54</volume><issue>6</issue><fpage>804</fpage><lpage>816</lpage><pub-id pub-id-type="pmcid">PMC9203933</pub-id><pub-id pub-id-type="pmid">35590109</pub-id><pub-id pub-id-type="doi">10.1038/s41588-022-01069-0</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Kai</given-names></name><name><surname>Hocker</surname><given-names>James D</given-names></name><name><surname>Miller</surname><given-names>Michael</given-names></name><name><surname>Hou</surname><given-names>Xiaomeng</given-names></name><name><surname>Chiou</surname><given-names>Joshua</given-names></name><name><surname>Poirion</surname><given-names>Olivier B</given-names></name><name><surname>Qiu</surname><given-names>Yunjiang</given-names></name><name><surname>Li</surname><given-names>Yang E</given-names></name><name><surname>Gaulton</surname><given-names>Kyle J</given-names></name><name><surname>Wang</surname><given-names>Allen</given-names></name><etal/></person-group><article-title>A single-cell atlas of chromatin accessibility in the human genome</article-title><source>Cell</source><year>2021</year><volume>184</volume><issue>24</issue><fpage>5985</fpage><lpage>6001</lpage><pub-id pub-id-type="pmcid">PMC8664161</pub-id><pub-id pub-id-type="pmid">34774128</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.10.024</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granja</surname><given-names>Jeffrey M</given-names></name><name><surname>Klemm</surname><given-names>Sandy</given-names></name><name><surname>McGinnis</surname><given-names>Lisa M</given-names></name><name><surname>Kathiria</surname><given-names>Arwa S</given-names></name><name><surname>Mezger</surname><given-names>Anja</given-names></name><name><surname>Corces</surname><given-names>M Ryan</given-names></name><name><surname>Parks</surname><given-names>Benjamin</given-names></name><name><surname>Gars</surname><given-names>Eric</given-names></name><name><surname>Liedtke</surname><given-names>Michaela</given-names></name><name><surname>Zheng</surname><given-names>Grace XY</given-names></name><etal/></person-group><article-title>Single-cell multiomic analysis identifies regulatory programs in mixed-phenotype acute leukemia</article-title><source>Nature biotechnology</source><year>2019</year><volume>37</volume><issue>12</issue><fpage>1458</fpage><lpage>1465</lpage><pub-id pub-id-type="pmcid">PMC7258684</pub-id><pub-id pub-id-type="pmid">31792411</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0332-7</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Yingdong</given-names></name><name><surname>Li</surname><given-names>Ming-Chung</given-names></name><name><surname>Konate</surname><given-names>Mariam M</given-names></name><name><surname>Chen</surname><given-names>Li</given-names></name><name><surname>Das</surname><given-names>Biswajit</given-names></name><name><surname>Karlovich</surname><given-names>Chris</given-names></name><name><surname>Williams</surname><given-names>P Mickey</given-names></name><name><surname>Evrard</surname><given-names>Yvonne A</given-names></name><name><surname>Doroshow</surname><given-names>James H</given-names></name><name><surname>McShane</surname><given-names>Lisa M</given-names></name></person-group><article-title>Tpm, fpkm, or normalized counts? a comparative study of quantification measures for the analysis of rna-seq data from the nci patient-derived models repository</article-title><source>Journal of translational medicine</source><year>2021</year><volume>19</volume><issue>1</issue><fpage>269</fpage><pub-id pub-id-type="pmcid">PMC8220791</pub-id><pub-id pub-id-type="pmid">34158060</pub-id><pub-id pub-id-type="doi">10.1186/s12967-021-02936-w</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amemiya</surname><given-names>Haley M</given-names></name><name><surname>Kundaje</surname><given-names>Anshul</given-names></name><name><surname>Boyle</surname><given-names>Alan P</given-names></name></person-group><article-title>The encode blacklist: identification of problematic regions of the genome</article-title><source>Scientific reports</source><year>2019</year><volume>9</volume><issue>1</issue><elocation-id>9354</elocation-id><pub-id pub-id-type="pmcid">PMC6597582</pub-id><pub-id pub-id-type="pmid">31249361</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-45839-z</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>Leo</given-names></name></person-group><source>Statistics. with a view toward applications</source><publisher-loc>Boston</publisher-loc><publisher-name>Houghton Mifflin Co</publisher-name><year>1973</year></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>Michael I</given-names></name><name><surname>Huber</surname><given-names>Wolfgang</given-names></name><name><surname>Anders</surname><given-names>Simon</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for rna-seq data with deseq2</article-title><source>Genome biology</source><year>2014</year><volume>15</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC4302049</pub-id><pub-id pub-id-type="pmid">25516281</pub-id><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>Aaron TL</given-names></name><name><surname>Smyth</surname><given-names>Gordon K</given-names></name></person-group><article-title>csaw: a bioconductor package for differential binding analysis of chip-seq data using sliding windows</article-title><source>Nucleic acids research</source><year>2015</year><volume>44</volume><issue>5</issue><fpage>e45</fpage><pub-id pub-id-type="pmcid">PMC4797262</pub-id><pub-id pub-id-type="pmid">26578583</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkv1191</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abadi</surname><given-names>MartÃ­n</given-names></name><name><surname>Agarwal</surname><given-names>Ashish</given-names></name><name><surname>Barham</surname><given-names>Paul</given-names></name><name><surname>Brevdo</surname><given-names>Eugene</given-names></name><name><surname>Chen</surname><given-names>Zhifeng</given-names></name><name><surname>Citro</surname><given-names>Craig</given-names></name><name><surname>Corrado</surname><given-names>Greg S</given-names></name><name><surname>Davis</surname><given-names>Andy</given-names></name><name><surname>Dean</surname><given-names>Jeffrey</given-names></name><name><surname>Devin</surname><given-names>Matthieu</given-names></name><name><surname>Ghemawat</surname><given-names>Sanjay</given-names></name><etal/></person-group><article-title>TensorFlow: Large-scale machine learning on heterogeneous systems, 2015</article-title><source>Software available from tensorflow.org</source></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>M</given-names></name><name><surname>Barth-Maron</surname><given-names>G</given-names></name><name><surname>Besse</surname><given-names>F</given-names></name><name><surname>de Las Casas</surname><given-names>D</given-names></name><name><surname>Fidjeland</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Puigdomenech</surname><given-names>A</given-names></name><name><surname>Racaniere</surname><given-names>S</given-names></name><name><surname>Rae</surname><given-names>J</given-names></name><name><surname>Viola</surname><given-names>F</given-names></name></person-group><article-title>Open sourcing sonnet-a new library for constructing neural networks</article-title><source>DeepMind</source><year>2017</year></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>Adam</given-names></name><name><surname>Gross</surname><given-names>Sam</given-names></name><name><surname>Chintala</surname><given-names>Soumith</given-names></name><name><surname>Chanan</surname><given-names>Gregory</given-names></name><name><surname>Yang</surname><given-names>Edward</given-names></name><name><surname>DeVito</surname><given-names>Zachary</given-names></name><name><surname>Lin</surname><given-names>Zeming</given-names></name><name><surname>Desmaison</surname><given-names>Alban</given-names></name><name><surname>Antiga</surname><given-names>Luca</given-names></name><name><surname>Lerer</surname><given-names>Adam</given-names></name></person-group><source>Automatic differentiation in pytorch</source><year>2017</year></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravza Gur</surname><given-names>E</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name></person-group><article-title>scatac-seq generates more accurate and complete regulatory maps than bulk atac-seq</article-title><source>Scientific Reports</source><year>2025</year><volume>15</volume><issue>1</issue><elocation-id>3665</elocation-id><pub-id pub-id-type="pmcid">PMC11779887</pub-id><pub-id pub-id-type="pmid">39881144</pub-id><pub-id pub-id-type="doi">10.1038/s41598-025-87351-7</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mann</surname><given-names>Henry B</given-names></name><name><surname>Whitney</surname><given-names>Donald R</given-names></name></person-group><article-title>On a test of whether one of two random variables is stochastically larger than the other</article-title><source>The annals of mathematical statistics</source><year>1947</year><fpage>50</fpage><lpage>60</lpage></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knudby</surname><given-names>Anders</given-names></name><name><surname>Ellsworth</surname><given-names>L</given-names></name></person-group><article-title>Bonferroni, ce, 1936. teoria statistica delle classi e calcolo delle probabilita, pubblicazioni del r istituto superiore di scienze economiche e commerciali di firenze, 8: 3-62. brenning, a., 2009. benchmarking classifiers to optimally integrate terrain analysis and multispectral remote sensing in automatic</article-title><source>Environment</source><year>1936</year><volume>37</volume><issue>1</issue><fpage>35</fpage><lpage>46</lpage></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gobbi</surname><given-names>Marco De</given-names></name><name><surname>Viprakasit</surname><given-names>Vip</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name><name><surname>Fisher</surname><given-names>Chris</given-names></name><name><surname>Buckle</surname><given-names>Veronica J</given-names></name><name><surname>Ayyub</surname><given-names>Helena</given-names></name><name><surname>Gibbons</surname><given-names>Richard J</given-names></name><name><surname>Vernimmen</surname><given-names>Douglas</given-names></name><name><surname>Yoshinaga</surname><given-names>Yuko</given-names></name><name><surname>Jong</surname><given-names>Pieter De</given-names></name><etal/></person-group><article-title>A regulatory snp causes a human genetic disease by creating a new transcriptional promoter</article-title><source>Science</source><year>2006</year><volume>312</volume><issue>5777</issue><fpage>1215</fpage><lpage>1217</lpage><pub-id pub-id-type="pmid">16728641</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bozhilov</surname><given-names>Yavor K</given-names></name><name><surname>Downes</surname><given-names>Damien J</given-names></name><name><surname>Telenius</surname><given-names>Jelena</given-names></name><name><surname>Oudelaar</surname><given-names>A Marieke</given-names></name><name><surname>Olivier</surname><given-names>Emmanuel N</given-names></name><name><surname>Mountford</surname><given-names>Joanne C</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name><name><surname>Gibbons</surname><given-names>Richard J</given-names></name><name><surname>Higgs</surname><given-names>Douglas R</given-names></name></person-group><article-title>A gain-of-function single nucleotide variant creates a new promoter which acts as an orientationdependent enhancer-blocker</article-title><source>Nature communications</source><year>2021</year><volume>12</volume><issue>1</issue><elocation-id>3806</elocation-id><pub-id pub-id-type="pmcid">PMC8217497</pub-id><pub-id pub-id-type="pmid">34155213</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-23980-6</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riva</surname><given-names>Simone G</given-names></name><name><surname>Georgiades</surname><given-names>Emily</given-names></name><name><surname>Herrmann</surname><given-names>Jennifer C</given-names></name><name><surname>GÃ¼r</surname><given-names>E Ravza</given-names></name><name><surname>Sanders</surname><given-names>Edward</given-names></name><name><surname>Sergeant</surname><given-names>Martin</given-names></name><name><surname>Baxter</surname><given-names>Matthew</given-names></name><name><surname>Hughes</surname><given-names>Jim R</given-names></name></person-group><article-title>Deciphering cis-regulatory elements using regulamentary</article-title><source>bioRxiv</source><year>2024</year><fpage>2024</fpage><lpage>05</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of REnformer model.</title></caption><graphic xlink:href="EMS206207-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Genome Browser track for chr10 : 22241840â22356528 region. In green, experiment (light) and predicted (dark) HUVEC cell type for REnformer model. In blue and orange, experiments (light) and predicted (dark) 2 DNase HUVEC cell types for Enformer model.</p></caption><graphic xlink:href="EMS206207-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Boxplots representing the <inline-formula><mml:math id="M23"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <italic>k</italic> â [1, 2, 3] for each random test subset; showing the performance of REnformer (blue) against Enformer (orange). On top of every <inline-formula><mml:math id="M24"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and subset is the p-value of Mann-Whitney U test, where * means the p-value â¤ 1e<sup>-4</sup> and ns means p-value &gt; 0.05.</p></caption><graphic xlink:href="EMS206207-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title><italic>KDE</italic> of the <inline-formula><mml:math id="M25"><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math></inline-formula> reveal that REnformer (blue) exhibits lower minimum and mean error values than Enformer (orange).</title></caption><graphic xlink:href="EMS206207-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Scatterplot showing on the x-axis <italic>RMSEij</italic> and on the y-axis the <inline-formula><mml:math id="M26"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, whilst dots are representing regions <italic>i</italic> and classifiers <italic>j</italic> of REnformer in the random test subset 1. Highlighted in orange, green, red, purple, and brown a random case and 4 edge cases or the <italic>RMSEij</italic> and <inline-formula><mml:math id="M27"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic xlink:href="EMS206207-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Lineplots of the highlighted regions in <xref ref-type="fig" rid="F5">Figure 5</xref>. Blue lines represent the predicted values, whilst the red lines represent the observed values.</title><p><bold>a)</bold> shows the worst <italic>RMSE<sub>i</sub>j</italic> (region chr10 : 91185369 â 91300057); <bold>b)</bold> the worst <inline-formula><mml:math id="M28"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (region chr3 : 126452244 â 126566932); <bold>c)</bold> the random region (region chr11 : 19929739 â 20044427); whereas <bold>d)</bold>, the best <inline-formula><mml:math id="M29"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (region chr3 : 2018426 â 2133114). In these 4 cases, the difference between predictions and ground truths corresponds to a magnitude difference. Instead, <bold>e)</bold>, which represents the best <italic>RMSE<sub>ij</sub></italic> (region chr18 : 20719561 â 20834249) corresponds to a region where no open chromatin sites are present, either for the observed and the predicted values.</p></caption><graphic xlink:href="EMS206207-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>Genome Brower Î± thalassemia locus (chr16 : 102366 â 217054).</title><p>This figure shows the effect of the variation from T to C in position 159710 (highlighted in yellow) in erythroid cells. As a convincing factor, the first track, in green, represents the erythroid experiment data, the prediction on the reference genome in blue (where the T is located), the prediction on the variation in red (where the T has been replaced with the C). We then subtracted the blue with the red tracks, showing where the changes occurred (in purple), and below, the overlay of the blue and red predictions.</p></caption><graphic xlink:href="EMS206207-f007"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table I</label><caption><title>Human Healthy Donors, 10x Genomics, accessed</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Dataset Name with hyperref URL</th></tr></thead><tbody><tr><td align="left" valign="top">500 PBMC (Next GEM v1.1)</td></tr><tr><td align="left" valign="top">1k PBMC (Next GEM v1.1)</td></tr><tr><td align="left" valign="top">5k PBMC (Next GEM v1.1)</td></tr><tr><td align="left" valign="top">10k PBMC (Next GEM v1.1)</td></tr><tr><td align="left" valign="top">10k PBMC, ATAC v1.1, Chromium X</td></tr><tr><td align="left" valign="top">10k PBMC, ATAC v1.1, Chromium Controller</td></tr><tr><td align="left" valign="top">3k PBMC - Granulocytes Removed Through Cell Sorting</td></tr><tr><td align="left" valign="top">10k PBMC - Granulocytes Removed Through Cell Sorting</td></tr><tr><td align="left" valign="top">3k PBMC - No Cell Sorting</td></tr><tr><td align="left" valign="top">10k PBMC - No Cell Sorting</td></tr><tr><td align="left" valign="top">10k PBMCs, Multiome v1.0, Chromium X</td></tr><tr><td align="left" valign="top">10k PBMCs, Multiome v1.0, Chromium Controller</td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table II</label><caption><title>List Of Scatac-Seq Cell Types Used In Renformer.</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Cell type</th><th align="left" valign="top">Cell type</th><th align="left" valign="top">Cell type</th><th align="left" valign="top">Cell type</th><th align="left" valign="top">Cell type</th></tr></thead><tbody><tr><td align="left" valign="top">Endothelial Myocardial</td><td align="left" valign="top">Plasma</td><td align="left" valign="top">Fetal Endothelial General</td><td align="left" valign="top">Fetal Skeletal Myocyte</td><td align="left" valign="top">pDC</td></tr><tr><td align="left" valign="top">Enterocyte</td><td align="left" valign="top">Schwann General</td><td align="left" valign="top">Fetal Endothelial Hepatic</td><td align="left" valign="top">Fetal Stellate</td><td align="left" valign="top">Pre B</td></tr><tr><td align="left" valign="top">Esophageal Epithelial</td><td align="left" valign="top">SI Goblet</td><td align="left" valign="top">Fetal Endothelial Placental</td><td align="left" valign="top">Fetal Sympathoblast</td><td align="left" valign="top">B intermediate</td></tr><tr><td align="left" valign="top">Fasciculata</td><td align="left" valign="top">Smooth Muscle Colon</td><td align="left" valign="top">Fetal Enteric Glia</td><td align="left" valign="top">Fetal Syncitio and Cytotrophoblast</td><td align="left" valign="top">B memory</td></tr><tr><td align="left" valign="top">Fibro Epithelial</td><td align="left" valign="top">Smooth Muscle GE junction</td><td align="left" valign="top">Fetal Enteric Neuron</td><td align="left" valign="top">Fetal T Lymphocyte CD4+</td><td align="left" valign="top">B naive</td></tr><tr><td align="left" valign="top">Fibro General</td><td align="left" valign="top">Smooth Muscle GI</td><td align="left" valign="top">Fetal Enterocyte</td><td align="left" valign="top">Fetal T Lymphocyte Cytotoxic</td><td align="left" valign="top">CD14 Monocytes</td></tr><tr><td align="left" valign="top">Fibro GI</td><td align="left" valign="top">Smooth Muscle Muscularis</td><td align="left" valign="top">Fetal Erythroblast</td><td align="left" valign="top">Fetal T Lymphocyte IL2+</td><td align="left" valign="top">CD16 Monocytes</td></tr><tr><td align="left" valign="top">Fibro Liver Adrenal</td><td align="left" valign="top">T Lymphocyte CD4+</td><td align="left" valign="top">Fetal Excitatory Neuron</td><td align="left" valign="top">Fetal Thymocyte</td><td align="left" valign="top">CD4 Naive</td></tr><tr><td align="left" valign="top">Fibro Muscle</td><td align="left" valign="top">T Lymphocyte CD8+</td><td align="left" valign="top">Fetal Fibro General</td><td align="left" valign="top">Fetal Ureteric Bud</td><td align="left" valign="top">CD4 TCM</td></tr><tr><td align="left" valign="top">Fibro Nerve</td><td align="left" valign="top">Transitional Cortical</td><td align="left" valign="top">Fetal Fibro GI</td><td align="left" valign="top">Fetal V Cardiomyocyte</td><td align="left" valign="top">CD4 TEM</td></tr><tr><td align="left" valign="top">Follicular</td><td align="left" valign="top">Type I Skeletal Myocyte</td><td align="left" valign="top">Fetal Fibro Muscle</td><td align="left" valign="top">Erythroid day0</td><td align="left" valign="top">CD8 Naive</td></tr><tr><td align="left" valign="top">Hepatocyte</td><td align="left" valign="top">Type II Skeletal Myocyte</td><td align="left" valign="top">Fetal Fibro Placental</td><td align="left" valign="top">Erythroid day10</td><td align="left" valign="top">CD8 TCM</td></tr><tr><td align="left" valign="top">Keratinocyte</td><td align="left" valign="top">V Cardiomyocyte</td><td align="left" valign="top">Fetal Fibro Splenic</td><td align="left" valign="top">Erythroid day5</td><td align="left" valign="top">CD8 TEM</td></tr><tr><td align="left" valign="top">Luteal</td><td align="left" valign="top">Vascular Smooth Muscle</td><td align="left" valign="top">Fetal Gastri Goblet</td><td align="left" valign="top">B</td><td align="left" valign="top">cDC2</td></tr><tr><td align="left" valign="top">Lymphatic</td><td align="left" valign="top">Fetal A Cardiomyocyte</td><td align="left" valign="top">Fetal Hepatoblast</td><td align="left" valign="top">CD4 M</td><td align="left" valign="top">HSPC</td></tr><tr><td align="left" valign="top">Macrophage General</td><td align="left" valign="top">Fetal Acinar</td><td align="left" valign="top">Fetal Inhibitory Neuron</td><td align="left" valign="top">CD8 CM</td><td align="left" valign="top">MAIT</td></tr><tr><td align="left" valign="top">Mammary Basal Epithelial</td><td align="left" valign="top">Fetal Adrenal Cortical</td><td align="left" valign="top">Fetal Macrophage Hepatic</td><td align="left" valign="top">CD8 EM</td><td align="left" valign="top">NK</td></tr><tr><td align="left" valign="top">Mammary Epithelial</td><td align="left" valign="top">Fetal Adrenal Neuron</td><td align="left" valign="top">Fetal Macrophage Placental</td><td align="left" valign="top">cDC1</td><td align="left" valign="top">Plasmablast</td></tr><tr><td align="left" valign="top">Mammary Luminal Epithelial</td><td align="left" valign="top">Fetal Alveolar Cap Endo</td><td align="left" valign="top">Fetal Megakaryocyte</td><td align="left" valign="top">CLP</td><td align="left" valign="top">Platelet</td></tr><tr><td align="left" valign="top">Memory B</td><td align="left" valign="top">Fetal Alveolar Epithelial</td><td align="left" valign="top">Fetal Mesangial</td><td align="left" valign="top">CMP LMPP</td><td align="left" valign="top">Treg</td></tr><tr><td align="left" valign="top">Mesothelial</td><td align="left" valign="top">Fetal Astrocyte</td><td align="left" valign="top">Fetal Metanephric</td><td align="left" valign="top">Early Basophil</td><td align="left" valign="top">HUVEC</td></tr><tr><td align="left" valign="top">Naive T</td><td align="left" valign="top">Fetal Cardiac Fibroblast</td><td align="left" valign="top">Fetal Photoreceptor</td><td align="left" valign="top">Early Erythoid</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top">Natural Killer T</td><td align="left" valign="top">Fetal Chromaffin</td><td align="left" valign="top">Fetal Retinal Neuron</td><td align="left" valign="top">GMP</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top">Nerve Stromal</td><td align="left" valign="top">Fetal Cilliated</td><td align="left" valign="top">Fetal Retinal Progenitor</td><td align="left" valign="top">GMP Neutrophils</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top">Parietal</td><td align="left" valign="top">Fetal Ductal</td><td align="left" valign="top">Fetal Satellite</td><td align="left" valign="top">HSC</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top">Pericyte Muscularis</td><td align="left" valign="top">Fetal Endocardial</td><td align="left" valign="top">Fetal Schwann General</td><td align="left" valign="top">Late Erythoid</td><td align="left" valign="top"/></tr></tbody></table></table-wrap></floats-group></article>