<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206298</article-id><article-id pub-id-type="doi">10.1101/2025.06.06.658293</article-id><article-id pub-id-type="archive">PPR1032394</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Accurately Programming Complex Light Regimes with Multi-channel LEDs</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Vong</surname><given-names>Gina Y.W.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Scott</surname><given-names>Paul</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Claydon</surname><given-names>Will</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Daff</surname><given-names>Jason</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Denby</surname><given-names>Katherine</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Ezer</surname><given-names>Daphne</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04m01e293</institution-id><institution>University of York</institution></institution-wrap>, <addr-line>Wentworth Way, Heslington</addr-line>, <city>York</city>, <postal-code>YO10 5DD</postal-code>, <country country="GB">UK</country></aff><aff id="A2"><label>2</label>Horticulture Facilities, Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04m01e293</institution-id><institution>University of York</institution></institution-wrap>, <postal-code>YO10 5DD</postal-code></aff><aff id="A3"><label>3</label>Centre for Novel Agricultural Products (CNAP), Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04m01e293</institution-id><institution>University of York</institution></institution-wrap>, <postal-code>YO10 5DD</postal-code></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author: <email>daphne.ezer@york.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>08</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>06</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Background</title><p id="P1">Advances in LED lighting technologies have allowed researchers to explore increasingly complex light regimes. This has given us greater insight into plants’ responses to dynamic light, including seasonality and fluctuating conditions, rather than the discrete (i.e. on / off) lighting previously explored. However, there is a need for methods to accurately program multi-channel / waveband LED lighting systems.</p></sec><sec id="S2"><title>Results</title><p id="P2">We present a multi-step, multidimensional algorithm to accurately program LED lights. This algorithm accounts for non-linearity between intensity settings and irradiance output, as well as bleedthrough between channels of different wavebands. Our algorithm out-performs other methods which treat waveband channels as independent variables, predicting intensity settings more accurately.</p></sec><sec id="S3"><title>Conclusions</title><p id="P3">We have made this algorithm available to the plant sciences community as an R package, LightFitR (available on GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ginavong/LightFitR">https://github.com/ginavong/LightFitR</ext-link>). We hope this package will enable the community to explore even more complex light regimes, gaining insight into the versatility of plant responses to light.</p></sec></abstract><kwd-group><kwd>Light</kwd><kwd>LED</kwd><kwd>light recipe</kwd><kwd>calibration</kwd><kwd>realistic conditions</kwd><kwd>dynamic light</kwd><kwd>controlled environment plant growth</kwd></kwd-group></article-meta></front><body><sec id="S4" sec-type="intro"><title>Introduction</title><p id="P4">Plants rely on light to fix carbon and grow. As such, light is an essential source of information for plants [<xref ref-type="bibr" rid="R1">1</xref>] to optimise their photosynthesis. Red / far-red ratios drive shade-avoidance [<xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R4">4</xref>], while blue light is involved in photomorphogenesis [<xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R8">8</xref>]. Plants have thus evolved elaborate mechanisms for gathering this information, integrating it with other environmental inputs and translating it into a physiological response [<xref ref-type="bibr" rid="R9">9</xref>–<xref ref-type="bibr" rid="R12">12</xref>]. Indeed, much work has been done to study the mechanisms of how plants perceive and respond to light information. These insights allow us to understand, with increasing resolution, how a plant behaves, with the potential to inform strategies to engineer climate resilient crops and novel agricultural technologies [<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R14">14</xref>].</p><p id="P5">Light information can be subdivided into 3 components: i) irradiance, informing the plant of how much light it is receiving [<xref ref-type="bibr" rid="R15">15</xref>]; ii) photoperiod [<xref ref-type="bibr" rid="R16">16</xref>], the duration for which the plant is receiving light; and iii) light quality, corresponding to the spectrum and wavelengths / colours of light [<xref ref-type="bibr" rid="R17">17</xref>]. Together, these 3 components allow the plant to infer information about the time of day [<xref ref-type="bibr" rid="R18">18</xref>], seasons [<xref ref-type="bibr" rid="R19">19</xref>–<xref ref-type="bibr" rid="R21">21</xref>] and shade avoidance [<xref ref-type="bibr" rid="R2">2</xref>].</p><p id="P6">However, much of the work on plant light response to date uses discrete lighting changes (e.g. sudden on/off) or constant light / darkness [<xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref>], rather than the dynamic changes seen in nature where irradiance, photoperiod and spectrum gradually change over the day and across seasons [<xref ref-type="bibr" rid="R22">22</xref>]. Increasingly, research has focussed on plants’ responses to fluctuating light conditions throughout the day [<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R23">23</xref>–<xref ref-type="bibr" rid="R27">27</xref>], giving us a deeper understanding of plants’ perception and response to light signals, as well as implications of variable light on plant productivity. These studies take advantage of advances in LED technologies [<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R29">29</xref>], which allow researchers to modulate the irradiance across multiple waveband channels in pre-defined schedules to produce dynamic light regimes. However, there is currently inconsistent reporting of lighting regimes used in these experiments [<xref ref-type="bibr" rid="R30">30</xref>], and a lack of methods for accurately programming complex light regimes involving multiple channels at different irradiances.</p><p id="P7">Existing methods for calibrating and programming LED lights vary. Some use regression methods [<xref ref-type="bibr" rid="R31">31</xref>] while others seem to use a laborious ‘measure and adjust’ approach [<xref ref-type="bibr" rid="R32">32</xref>]. Regression-based methods assume a linear relationship between intensity (settings within the LED, typically a %) and irradiance (measured light output from the LED). Further, by treating each LED channel individually (i.e. assuming independence between the channels), neither approach accounts for the complex interaction of the spectral irradiances produced by multiple overlapping channels. A spectrometer (rather than a light meter) allows the assessment of the wavelength range of each LED channel, the extent of overlap between channels, and whether a channel has a secondary peak [<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R33">33</xref>]. All these factors can influence the output of the LED fixtures, as well as plants’ responses in experiments [<xref ref-type="bibr" rid="R30">30</xref>].</p><p id="P8">Moreover, the output of the lights is highly dependent on their installation, as different materials on growth cabinet walls have differing reflectance and absorbances. This affects how much, and which wavelengths of, light actually reach the plant, not to mention the potential variation between LED fixtures even of the same model. Therefore, each LED lighting setup requires a bespoke calibration in order to accurately program a light regime for experiments.</p><p id="P9">Here, we present an experimental protocol coupled with an algorithm for effectively calibrating and programming complex light regimes involving multiple LED waveband channels across a range of irradiances. We also present a further refinement step for those requiring additional accuracy. The algorithm is available as an R package, LightFitR, facilitating the employment of more complex light regimes for plant science experiments.</p></sec><sec id="S5" sec-type="methods"><title>Methods</title><p id="P10">All data processing, analysis and figure creation was carried out in R (version 4.4.1). The code is available on GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ginavong/2024_LightFitR_MethodsPaper">https://github.com/ginavong/2024_LightFitR_MethodsPaper</ext-link> and the raw data is available at: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.15584172">https://doi.org/10.5281/zenodo.15584172</ext-link></p><sec id="S6"><title>Defining key terms</title><p id="P11">In the context of this manuscript, we use the term <italic>LED channel</italic> to denote the waveband produced by a given type of LED. While <italic>LED fixture(s)</italic> refers to the lighting fixture as a whole, including all the LED channels housed within.</p><p id="P12">We use the term <italic>intensity</italic> to refer to the unitless setting we provide to each LED channel. In contrast, we use the term <italic>irradiance</italic> to refer to the instantaneous measurement (area x time) of light output that is present at specific designated wavelengths (in nm) at the plant level in the growth chamber. The aim of our protocol is to enable a researcher to predict what intensity they should programme for each LED channel to produce a <italic>target irradiance</italic> at a target waveband required for a specific experiment.</p><p id="P13"><italic>Peak wavelength</italic> is the precise wavelength where the maximum irradiance is observed for that channel. We define <italic>bleedthrough</italic> as the irradiance of light from one LED channel, which is encroaching on the peak wavelengths of other channels.</p><p id="P14">Further, we use <italic>event</italic> to refer to the time period when a given set of LED channels is on at a given set of intensities. A series of events is referred to as a <italic>regime</italic> or <italic>schedule</italic>.</p></sec><sec id="S7"><title>Cabinet setup</title><p id="P15">The experiments were conducted in a Snijders (Tilburg, Netherlands) MC1750 growth chamber with Internal dimensions (w x d x h) 1830mm x 780mm x 1230mm. The chamber was modified to provide two equal growing compartments with separate lighting regimes, by installing an internal partition made from white Palfoam (Palram, Hull, UK) aerated PVC foam sheet. The partition was sealed with RS PRO (Corby, UK) 5mm Black Foam Tape, to prevent light spillage between the compartments and did not impair the upward airflow distribution system (<xref ref-type="fig" rid="F1">Fig.1A</xref>). Sufficient outdoor make-up air provides ambient CO2 conditions inside the chamber. The chamber air temperature was maintained at 22/22°C (s.d. ±1/1°C) during the light/dark period. The relative humidity in the chamber was maintained at 55% (s.d. ±10%).</p><p id="P16">Heliospectra DYNA (Gothenburg, Sweden) LED fixtures were mounted in the existing passively ventilated lamp loft, partitioned by a clear glass barrier above the growing compartments below, the LED fixtures were cooled by internal variable speed fans. The LED channels were controlled by helioCORE™ (version), a web-based lighting control system, independent of the growth chamber’s local control system.</p></sec><sec id="S8"><title>Light Measurements</title><p id="P17">For automated light measurements, schedules were uploaded to the LED fixtures via helioCORE. Each event in the schedule lasted 5 minutes to allow time for multiple readings to be taken.</p><p id="P18">Light readings were taken at the plant growth level, 95 cm below the centre of the LED fixture (<xref ref-type="fig" rid="F1">Fig.1B</xref>). For spectrum readings, an OceanInsight FLAME spectrometer (Ocean Optics, Duiven, Netherlands) was used in conjunction with OceanView (version 2.0.14) software set up to record every 1 minute with a 500 ms integration time and averaging over 5 scans.</p></sec><sec id="S9"><title>Spectrometry data processing</title><p id="P19">The spectrum measurements are processed to trim the wavelengths from 300-800 nm. Irradiance unit conversions (from uW cm-2 nm-1 s-1 to umol m-2 nm-1 s-1) were calculated using the photobiology package (version 0.11.3) in R. As there were multiple readings for each event, the reading at the middle time point was selected for subsequent analysis. Further annotation of the processed dataset was then carried out depending on the analysis required (see specifics below).</p></sec><sec id="S10"><title>Generating and analysing calibration data</title><p id="P20">Calibration curves were generated separately for each LED channel (380 nm, 400 nm, 420 nm, 450 nm, 530 nm, 620 nm, 660 nm, 735 nm and 5700k white), by increasing the intensity every 5 minutes (0, 1, 5, 10, 20, 50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000) and taking spectrometer readings every 1 minute (see <xref ref-type="sec" rid="S8">Measurements of the Lights</xref>).</p><p id="P21">After the raw measurements were processed (see <xref ref-type="sec" rid="S9">Spectrometry data processing</xref>), the following values were calculated for each reading (<xref ref-type="fig" rid="F2">Fig.2A</xref>): (i) the total irradiance (i.e. sum of irradiances between 300-800 nm); (ii) the peak wavelength (i.e. wavelength at which the maximum irradiance occurred in the spectrum), with the median peak wavelength for the LED channel used for future analysis); (iii) the irradiance at the peak wavelength (i.e. peak irradiance). Further, we calculated <italic>bleedthrough</italic> for each channel at 1000 intensity by extracting the irradiances at the peak wavelengths of the channels which were not on.</p></sec><sec id="S11"><title>Intensity Prediction Algorithm</title><p id="P22">Our algorithm (<xref ref-type="fig" rid="F2">Fig.2B</xref>) takes user-provided calibration data and user-defined target irradiances for each peak wavelength in order to predict intensities for each channel. These intensities can be programmed into the fixtures to achieve the target regime. It consists of 3 steps: (i) produce a rough estimate of intensities by directly using the calibration data for each LED channel, (ii) adjust the estimated intensities to account for bleedthrough between LED channels, and (iii) modify estimated intensities to fit hardware requirements (<xref ref-type="fig" rid="F2">Fig.2B</xref>).</p><p id="P23">First, when given an event of target irradiances at the peak wavelengths, it searches the calibration data for intensities which produce the closest irradiances to the target irradiance for each channel (i.e. intensity with the smallest absolute difference in irradiance, called the <italic>closest intensities</italic>). We define <italic>m</italic> to be the vector of closest intensities for each LED channel.</p><p id="P24">Next, we refine these intensities to account for bleedthrough between channels (see <xref ref-type="sec" rid="S10">Generating and processing calibration data</xref>). We combine bleedthrough at the closest intensities identified in the first step into a matrix, M<sub>m</sub>.</p><p id="P25">This matrix is then used to solve a multidimensional system of linear equations, either using R’s ‘solve’ function (we simply call this approach ‘system of linear equations (SLE)’) or with non-negative least squares (NNLS), as in <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>. To calculate the predicted intensities, we use <xref ref-type="disp-formula" rid="FD2">Equation (2)</xref>.</p><boxed-text id="BX1" position="anchor" orientation="portrait"><p id="P26"><disp-formula id="FD1"><label>Equation 1</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></disp-formula></p><p id="P27">Where M is the bleedthrough matrix at LED intensities m, x is the vector of coefficients we are trying to predict and b is the vector of target irradiances.</p><p id="P28"><disp-formula id="FD2"><label>Equation 2</label><mml:math id="M2"><mml:mrow><mml:mi>m</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></disp-formula></p><p id="P29">Where c is the predicted intensities that we expect will produce irradiances close to the target irradiance b.</p></boxed-text><p id="P30">Finally, we must adapt these estimates to meet the hardware requirements of the LEDs. For example, these predicted intensities may be below 0 (in the case of SLE) or above the maximum achievable intensity by the LEDs (1000 for Heliospectra DYNA). Furthermore, the LED fixtures can only take integer (whole numbers) intensity values while the predicted intensities are often not integers. Therefore, we created a final ‘tidying’ step which (i) rounds to the nearest integer; (ii) sets negative predicted intensities to 0; and (iii) caps the maximum intensity to the maximum achievable by the light model.</p></sec><sec id="S12"><title>Algorithm comparison</title><p id="P31">We compared our multidimensional algorithm (with SLE and NNLS) with prior methods from the literature: individual closest, individual linear model / regression, individual NNLS.</p><p id="P32">We first designed a test regime where random LED channels were turned on in combination, at random intensities. Our testing regime increased in complexity, starting with just 2 random channels active / on at a given time and increasing until all 8 LED channels were on simultaneously, with n=20 events for each level of complexity. We ran this regime and measured the spectra for each event (see <xref ref-type="sec" rid="S8">light measurements</xref> and <xref ref-type="sec" rid="S9">spectrometry data processing</xref>).</p><p id="P33">Using the measured irradiances, we asked each algorithm to predict the intensities which were originally used. This allowed us to assess the accuracy of the algorithm predictions for each LED channel at each event (i.e. the residuals: predicted - true). To produce an overall score for how accurate each algorithm was for a given event, the mean squared error (MSE) across LED channels was calculated for each event. We compared the algorithms at each complexity level using a Kruskal-Wallace test, with Dunn post-hoc test and Holm’s p-value adjustment. To assess whether an algorithm was consistently over- or under-shooting, we created visualisations of the raw differences / residuals.</p></sec><sec id="S13"><title>Refinement with random search</title><p id="P34">Additionally, we demonstrate experiments for further refining the intensities to produce irradiances that are even closer to the target irradiance, by using a random search approach (<xref ref-type="fig" rid="F2">Fig.2C</xref>). The premise is that we select random combinations of intensities near our algorithm’s predicted optimal intensities, which can be experimentally tested on the LEDs to enable further refinements. The range of the intensities is weighted by how ‘wrong’ the algorithm predicted intensities are.</p><p id="P35">More specifically, we programme the algorithm’s predicted intensities in our LEDs (i.e. the starting intensity), measure the irradiance at each waveband and calculate the difference between the actual irradiance and the target irradiance (i.e. the residual). We defined test ranges for each LED channel, which were proportional to the direction and size of the residual for the algorithm predicted intensity (see <xref ref-type="disp-formula" rid="FD3">Equations 3</xref> &amp; <xref ref-type="disp-formula" rid="FD4">4</xref>). n=50 events then were selected for each treatment, each with a random combination of intensities (within the LED channels’ test ranges). These events were tested on the LEDs and the spectra collected. The optimal intensities are then defined as the combination of intensities which have the lowest MSE.</p><boxed-text id="BX2" position="anchor" orientation="portrait"><p id="P36"><disp-formula id="FD3"><label>Equation 3</label><mml:math id="M3"><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext>1</mml:mtext><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>–</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P37"><disp-formula id="FD4"><label>Equation 4</label><mml:math id="M4"><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext>2</mml:mtext><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>ϵ</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P38">Where <italic>bound1</italic> defines an intensity limit in the opposite direction of the residual (<italic>ϵ</italic>) and <italic>bound2</italic> defines an intensity limit in the same direction as the residual. <italic>i</italic> is the algorithm predicted intensity, and <italic>s</italic> is a scaling factor turn the small residuals (in μmol s<sup>-1</sup> m<sup>-2</sup>) into numbers &gt;1 (we used s=100 but other setups may differ). <italic>p</italic> is a proportionality factor that indicates how far away from the algorithm predicted intensity should be searched where <italic>p</italic><sub>1</sub> &gt; <italic>p</italic><sub>2</sub> to ensure that the range of <italic>bound1</italic> is greater than <italic>bound2</italic> (we used <italic>p</italic><sub>1</sub>=10<sup>1.4</sup> and <italic>p</italic><sub>2</sub>=10).</p></boxed-text></sec><sec id="S14"><title>Testing the efficacy of random search</title><p id="P39">We tested the random search approach for three different sets of target irradiances to use as ‘treatments’. This allowed us to assess the marginal benefit of using random search for different starting (i.e. algorithm predicted) MSEs. To determine the treatments, we used target irradiances from the <xref ref-type="sec" rid="S12">Algorithm comparison</xref> section at a complexity of 4 LED channels, selecting the events with the lowest (minimum), median and highest (maximum) predicted MSE.</p><p id="P40">After processing the raw spectrometer data, the dataset was filtered to retain only the irradiances at the median peak wavelengths for further analysis. These were compared with the target irradiances to calculate residuals and then MSE per event. Within each treatment, the event with the lowest MSE was labelled the ‘best’. The Euclidean distance between each event and the corresponding ‘best’ event was then calculated, and Spearman rank used to assess the correlation between MSE and Euclidean distance.</p></sec></sec><sec id="S15" sec-type="results"><title>Results</title><sec id="S16"><title>Properties of the lighting system</title><p id="P41">‘Intensity’ is an arbitrary unit within the light system settings, associated with the amount of electrical power that a particular channel receives. Thus we investigated how intensity impacts the amount of light (irradiance, umol m-2 s-1 nm-1) being output. We noted that irradiance does not scale linearly with intensity (<xref ref-type="fig" rid="F3">Fig. 3A</xref> &amp; <xref ref-type="supplementary-material" rid="SD1">Fig. S1B</xref>). Each LED channel has a different maximum irradiance, with the 380 nm channel emitting particularly low irradiances of light. Indeed, the maximum irradiance for the 620 nm channel was around 600 intensity rather than 1000.</p><p id="P42">We also noticed that the spectra of some LED channels overlapped with each other (<xref ref-type="fig" rid="F3">Fig.3B</xref> and <xref ref-type="supplementary-material" rid="SD1">S1A</xref>), resulting in bleedthrough. This bleedthrough is particularly severe among the blue (400 nm, 420 nm, 450 nm) channels, with the green (530 nm) channel bleeding through into all other channels and bleedthrough between the red (620 nm, 660 nm, 730 nm) channels. We note also, a small amount of bleedthrough between the blue and red channels, and vice versa. The algorithm we developed accounts for both the non-linear associations between intensity and irradiance and the bleedthrough between LED channels.</p><p id="P43">Finally, we wished to confirm whether the peak wavelength for each channel matched the named wavelength of the channel (<xref ref-type="fig" rid="F3">Fig. 3C</xref>). We note that none of the channel peaks exactly matched the purported wavelengths, with some channels deviating more than others. At low intensities, the noise from the spectrometer was greater than the irradiance at the peak wavelength, and thus the ‘peaks’ around 800 nm at those low intensities do not represent true output from the light. However, we noted that, at intensities over 100, the peak wavelengths were changing and diverging from the purported wavelengths (<xref ref-type="fig" rid="F3">Fig. 3D</xref>) as the intensity increased. Going forward, we define the peak wavelength for a channel as the median of that channel’s peak wavelengths across all intensities.</p></sec><sec id="S17"><title>Performance of the prediction algorithm</title><p id="P44">Our algorithm aims to accurately predict intensities for LED lights to achieve user-defined target irradiances and wavelength profiles. To test the performance of our algorithm, we took detailed measurements from a complex light regime which had random combinations of LED channels using the light set up described above. Using these measurements (irradiance and wavelength), we asked the algorithm to predict the intensities needed for each LED channel to achieve the measurements. These predicted intensities were then compared to the original (true) intensities that were used (i.e. predicted - true intensity) as a measure of the accuracy of the prediction for each LED channel. Mean squared error (MSE) was used to summarise the accuracy of the predictions across all LED channels for a given event. To benchmark our algorithm, we compared our multidimensional approach (either with NNLS or SLE) with three other approaches, which treat each LED channel individually: (i) taking the closest intensity from the calibration data [<xref ref-type="bibr" rid="R32">32</xref>]; (ii) carrying out a separate linear regression across each LED channel [<xref ref-type="bibr" rid="R31">31</xref>]; and (iii) computing a non-negative least squares regression across each channel individually.</p><p id="P45">We observe that our multidimensional approaches consistently show lower MSEs compared to the individual approaches (<xref ref-type="fig" rid="F4">Fig.4a</xref>) (p&lt;0.01, <xref ref-type="supplementary-material" rid="SD2">Table S1</xref>), with a particular advantage as the complexity (i.e. number of LED channels active) increases. We note that multidimensional SLE and multidimensional NNLS produce very similar MSEs for this test, with some differentiation with outliers.</p><p id="P46">We investigated whether the final tidying step of our algorithm had an effect on the accuracy and found that the pre-tidied (i.e. raw predicted values) predictions did not have a substantial difference in MSE (<xref ref-type="supplementary-material" rid="SD1">Fig.S2</xref>) compared with tidied predictions.</p><p id="P47">When comparing linear regression (the best of the individual approaches) and multidimensional NNLS (the best multidimensional approach) (<xref ref-type="fig" rid="F4">Fig.4b</xref>), we see that both consistently predict higher intensities than the true intensity in the blue (380, 400, 420, 450 nm) channels but this effect is markedly less pronounced with the multidimensional approach. We hypothesise that this is due to our approach being able to account for the interaction between LED channels, particularly in the blue range (<xref ref-type="fig" rid="F3">Fig.3b</xref>), where there is significant bleedthrough from overlapping spectra.</p><p id="P48">We note that the near-red (620 nm) channel performs consistently poorly across all algorithms. We hypothesise that this is due to the non-monotonic relation between intensity and irradiance (<xref ref-type="fig" rid="F3">Fig.3a</xref>).</p></sec><sec id="S18"><title>Refinement using random search</title><p id="P49">To assess whether our algorithm’s predictions could be improved upon, we carried out an additional refinement process using a random search. Here, intensities (within a defined range) are randomly selected in an attempt to generate an irradiance closer to the target (<xref ref-type="supplementary-material" rid="SD1">Fig.S4a</xref>). We selected target irradiances where our algorithm predicted intensities generating low, medium and high overall MSEs in order to assess the marginal benefit of this additional refinement.</p><p id="P50">Regardless of the MSE of the algorithm predicted intensities (i.e. the starting MSE), the random search was able to improve the accuracy of the lights (<xref ref-type="fig" rid="F5">Fig.5</xref>). The high starting MSE seems to have benefited most from this refinement process, whereas users may not need to invest extra time in refinement if the intensities predicted by the algorithm are already very close to the target.</p><p id="P51">We note that the random search for the mid starting MSE treatment was not able to reduce the MSE as much as the low and high treatments. We hypothesise that the challenge in identifying intensities in this treatment comes from the inclusion of the 620 nm channel (<xref ref-type="supplementary-material" rid="SD1">Fig.S4a</xref>), which had a non-monotonic relation between intensity and irradiance (<xref ref-type="fig" rid="F3">Fig.3a</xref>).</p><p id="P52">When taking measurements using any instrument, there is an amount of random technical noise which affects the accuracy of the measurement. Since the MSEs we observe are quite small, we wished to determine whether the improved accuracy from the random search arose because we were truly approaching the local optimum intensity rather than capturing random noise in spectrometer readings. To assess this, we determined whether the LED intensity combinations that were more similar (i.e. small Euclidean distance) to our final selected intensities produced more accurate irradiances (i.e. lower MSE) than intensities that were further away. If our results are due to random technical noise, we would expect a random distribution of points in <xref ref-type="supplementary-material" rid="SD1">Fig.S4b</xref>. However in the mid and high algorithm MSE treatments, <xref ref-type="supplementary-material" rid="SD1">Fig.S4b</xref> shows a smooth gradient in MSE with a strong positive correlation (<xref ref-type="supplementary-material" rid="SD2">Table S2</xref>), therefore confirming that we are approaching the local optimum for those treatments and that random search is an effective strategy for refining selected intensities.</p></sec></sec><sec id="S19" sec-type="discussion"><title>Discussion</title><p id="P53">Most research on plant light response has been done under discrete conditions, which are dissimilar to the dynamic natural light that they have evolved for [<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R34">34</xref>]. Advances in LED technology allow us to program more realistic light regimes which mimic the spectrum and fluctuations of natural daylight at different latitudes and times of year. Indeed, more realistic conditions are beginning to be explored, with implications for fluctuating light affecting leaf morphology and photosynthetic acclimation [<xref ref-type="bibr" rid="R24">24</xref>]; natural light resulting in differences in metabolite use [<xref ref-type="bibr" rid="R11">11</xref>]; and twilight length affecting growth and flowering [<xref ref-type="bibr" rid="R23">23</xref>]. Taken together, these studies show that conclusions from discrete lighting experiments cannot be directly translated to natural conditions. Therefore, dynamic lighting conditions are potentially a fruitful area for further research.</p><p id="P54">However, the complexity of the light regimes that are possible to investigate is limited by the difficulties of accurately programming LEDs across multiple channels. The algorithm we present here allows us to more accurately programme LED fixtures, thus unlocking the potential of these LEDs for research. By using a multi-step approach, LightFitR (<ext-link ext-link-type="uri" xlink:href="https://github.com/ginavong/LightFitR">https://github.com/ginavong/LightFitR</ext-link>) can account for a non-linear relationship between intensity and irradiance output, as well as channels with overlapping wavelength ranges. Our approach is light-agnostic, meaning that it can work for any programmable LED-based lights which have multiple channels. This package therefore allows the community to more accurately program complex light regimes involving multiple LED waveband channels, fine-tuning wavelength ratios as well as gradual changes to irradiance through the day.</p><p id="P55">We have shown the value of calibrating the lights when installing them in a cabinet, and [<xref ref-type="bibr" rid="R35">35</xref>] suggests calibrating them regularly thereafter. Although some LEDs in some scenarios show more linearity between intensity and irradiance [<xref ref-type="bibr" rid="R31">31</xref>], this is not the case universally (<xref ref-type="fig" rid="F3">Fig3a</xref>). Further, we obtained the full spectrum for each channel, providing insight into bleedthrough between the waveband channels. Thus, in addition to calibration, we encourage plant scientists to more comprehensively report their lighting conditions in controlled environment experiments, in line with [<xref ref-type="bibr" rid="R30">30</xref>].</p><p id="P56">We have demonstrated that our multidimensional algorithm outperforms other approaches, especially at high complexities. Other approaches assume linearity between intensity and irradiance [<xref ref-type="bibr" rid="R31">31</xref>], and treat each LED channel as an independent variable. Our approach accounts for potential non-linearity by first subsetting to the calibration point which is closest to the target. Then by using a multidimensional system of linear equations, we can account for the bleedthrough between different LED channels. This may not be required if the number of active LED channels (i.e. complexity) is low. However, as the research is moving towards more complex regimes which emulate natural / field conditions, there will be a need for methods of reliably programming them.</p><p id="P57">Additionally, we present an extra refinement step which uses a local random search. This represents a way to provide additional accuracy for light regimes that require it, and is more efficient than previous measure and adjust approaches [<xref ref-type="bibr" rid="R32">32</xref>]. However, it is a rather time-consuming step and so we recommend it only if the extra accuracy is needed and existing methods are not getting users close enough to the target irradiances. Though not demonstrated here, a more thorough grid search, where every possible combination of intensities is tested within a narrow range, can be used to further refine the random search. However, the time required to do grid search increases exponentially with the number of LED channels involved. Therefore we would suggest doing grid search only if absolutely necessary.</p><p id="P58">The methods presented here provide a way for the plant sciences community to accurately program complex light regimes on LED-based lights. This will allow researchers to investigate more natural regimes, where irradiance and wavelengths change gradually through the day. This could lead to deeper insights into, for example, how variation in light quality and quantity entrains the circadian clock; how plants respond to temporary shade (e.g. from clouds or upper canopy); and how seasonal changes in light quality affect phenological responses. Our approach may also be beneficial for applied research, for example optimising light regimes for indoor controlled environment agriculture and vertical farms. We look forward to seeing how the community uses our package.</p></sec><sec id="S20" sec-type="conclusions"><title>Conclusions</title><p id="P59">Here, we present a method for accurately programming complex light regimes using multiple LED channels. By using a multi-step, multidimensional algorithm, we can account for non-linearity between intensity settings and light irradiance output as well as bleedthrough between different LED channels, outperforming other approaches. The algorithm-predicted intensities can be further refined using a localised random search. This approach will enable the plant sciences community to explore plants’ responses to complex light regimes, such as the conditions experienced in the field.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Materials</label><media xlink:href="EMS206298-supplement-Supplemental_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d44aAcFbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplemental tables</label><media xlink:href="EMS206298-supplement-Supplemental_tables.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d44aAcFcB" position="anchor"/></supplementary-material></sec></body><back><ack id="S21"><title>Acknowledgements</title><p>We thank the Horticulture Team at the University of York Biology Department for their maintenance of the growth facilities, cabinets and helpful insights. We are also grateful to David Nelmes for IT support with the lights, and Ethan Redmond for stimulating discussion about the mathematics used in this paper.</p><sec id="S22"><title>Funding</title><p>We would like to thank the Royal Society (RGS\R2\212345: D.E.), Biotechnology and Biological Sciences Research Council (Responsive Mode) (BB/V006665/1: D.E.), the Biotechnology and Biological Sciences Research Council (White Rose Doctoral Training Partnership) (BB/T007222/1: G.Y.W.V.),</p></sec></ack><sec id="S23" sec-type="data-availability"><title>Data &amp; software availability</title><p id="P60">The R package (LightFitR) containing the algorithm is available under the GNU General Public License and can be installed from GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/ginavong/LightFitR">https://github.com/ginavong/LightFitR</ext-link></p><p id="P61">The processed data and analysis code (in R) for this paper is available under the GNU General Public License in the 2024_LightFitR_MethodsPaper GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ginavong/2024_LightFitR_MethodsPaper">https://github.com/ginavong/2024_LightFitR_MethodsPaper</ext-link></p><p id="P62">The raw datasets supporting the conclusions of this article are available on Zenodo: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.15584172">https://doi.org/10.5281/zenodo.15584172</ext-link></p></sec><fn-group><title>Declarations</title><fn id="FN1" fn-type="con"><p id="P63"><bold>Author contributions</bold></p><p id="P64">GV and DE designed the algorithm and wrote the R package. PS and JD installed Heliospectra lights into the growth cabinets, and made additional modifications to the cabinet. GV, WC, PS and JD measured and tested the lights. GV carried out the experiment design, analysis and figure creation. KD and DE supervised the work. All authors contributed to the writing of this manuscript.</p></fn><fn id="FN2" fn-type="conflict"><p id="P65"><bold>Competing Interests</bold></p><p id="P66">The authors declare no conflicts of interest.</p></fn><fn id="FN3"><p id="P67"><bold>Ethics approval and consent to participate</bold></p><p id="P68">Not applicable</p></fn><fn id="FN4"><p id="P69"><bold>Consent for publication</bold></p><p id="P70">Not applicable</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Liao</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>C</given-names></name><name><surname>Oka</surname><given-names>Y</given-names></name></person-group><article-title>Coordination of Cryptochrome and Phytochrome Signals in the Regulation of Plant Light Responses</article-title><source>Agronomy</source><year>2017</year><volume>7</volume><fpage>25</fpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ballaré</surname><given-names>CL</given-names></name><name><surname>Pierik</surname><given-names>R</given-names></name></person-group><article-title>The shade-avoidance syndrome: multiple signals and ecological consequences</article-title><source>Plant Cell Environ</source><year>2017</year><volume>40</volume><fpage>2530</fpage><lpage>43</lpage><pub-id pub-id-type="pmid">28102548</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname><given-names>KA</given-names></name></person-group><article-title>Shade avoidance</article-title><source>New Phytol</source><year>2008</year><volume>179</volume><fpage>930</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">18537892</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruberti</surname><given-names>I</given-names></name><name><surname>Sessa</surname><given-names>G</given-names></name><name><surname>Ciolfi</surname><given-names>A</given-names></name><name><surname>Possenti</surname><given-names>M</given-names></name><name><surname>Carabelli</surname><given-names>M</given-names></name><name><surname>Morelli</surname><given-names>G</given-names></name></person-group><article-title>Plant adaptation to dynamically changing environment: The shade avoidance response</article-title><source>Biotechnol Adv</source><year>2012</year><volume>30</volume><fpage>1047</fpage><lpage>58</lpage><pub-id pub-id-type="pmid">21888962</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hajdu</surname><given-names>A</given-names></name><name><surname>Dobos</surname><given-names>O</given-names></name><name><surname>Domijan</surname><given-names>M</given-names></name><name><surname>Bálint</surname><given-names>B</given-names></name><name><surname>Nagy</surname><given-names>I</given-names></name><name><surname>Nagy</surname><given-names>F</given-names></name><etal/></person-group><article-title>ELONGATED HYPOCOTYL 5 mediates blue light signalling to the Arabidopsis circadian clock</article-title><source>Plant J</source><year>2018</year><volume>96</volume><fpage>1242</fpage><lpage>54</lpage><pub-id pub-id-type="pmid">30256479</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>G</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Dong</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><article-title>The Blue-Light Receptor CRY1 Interacts with BZR1 and BIN2 to Modulate the Phosphorylation and Nuclear Function of BZR1 in Repressing BR Signaling in Arabidopsis</article-title><source>Mol Plant</source><year>2019</year><volume>12</volume><fpage>689</fpage><lpage>703</lpage><pub-id pub-id-type="pmid">30763615</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Qi</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Zhai</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>C</given-names></name></person-group><article-title>PIF4 and PIF5 Transcription Factors Link Blue Light and Auxin to Regulate the Phototropic Response in Arabidopsis</article-title><source>Plant Cell</source><year>2013</year><volume>25</volume><fpage>2102</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC3723615</pub-id><pub-id pub-id-type="pmid">23757399</pub-id><pub-id pub-id-type="doi">10.1105/tpc.113.112417</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>P</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Xu</surname><given-names>F</given-names></name><name><surname>Mao</surname><given-names>Z</given-names></name><name><surname>Cao</surname><given-names>X</given-names></name><etal/></person-group><article-title>Blue light-dependent interactions of CRY1 with GID1 and DELLA proteins regulate gibberellin signaling and photomorphogenesis in Arabidopsis</article-title><source>Plant Cell</source><year>2021</year><volume>33</volume><fpage>2375</fpage><lpage>94</lpage><pub-id pub-id-type="pmcid">PMC8364249</pub-id><pub-id pub-id-type="pmid">34046684</pub-id><pub-id pub-id-type="doi">10.1093/plcell/koab124</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alvarez-Fernandez</surname><given-names>R</given-names></name><name><surname>Penfold</surname><given-names>CA</given-names></name><name><surname>Galvez-Valdivieso</surname><given-names>G</given-names></name><name><surname>Exposito-Rodriguez</surname><given-names>M</given-names></name><name><surname>Stallard</surname><given-names>EJ</given-names></name><name><surname>Bowden</surname><given-names>L</given-names></name><etal/></person-group><article-title>Time-series transcriptomics reveals a <italic>BBX32</italic> -directed control of acclimation to high light in mature <italic>Arabidopsis</italic> leaves</article-title><source>Plant J</source><year>2021</year><volume>107</volume><fpage>1363</fpage><lpage>86</lpage><pub-id pub-id-type="pmid">34160110</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balcerowicz</surname><given-names>M</given-names></name><name><surname>Mahjoub</surname><given-names>M</given-names></name><name><surname>Nguyen</surname><given-names>D</given-names></name><name><surname>Lan</surname><given-names>H</given-names></name><name><surname>Stoeckle</surname><given-names>D</given-names></name><name><surname>Conde</surname><given-names>S</given-names></name><etal/></person-group><article-title>An early-morning gene network controlled by phytochromes and cryptochromes regulates photomorphogenesis pathways in Arabidopsis</article-title><source>Mol Plant</source><year>2021</year><volume>14</volume><fpage>983</fpage><lpage>96</lpage><pub-id pub-id-type="pmid">33766657</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annunziata</surname><given-names>MG</given-names></name><name><surname>Apelt</surname><given-names>F</given-names></name><name><surname>Carillo</surname><given-names>P</given-names></name><name><surname>Krause</surname><given-names>U</given-names></name><name><surname>Feil</surname><given-names>R</given-names></name><name><surname>Mengin</surname><given-names>V</given-names></name><etal/></person-group><article-title>Getting back to nature: a reality check for experiments in controlled environments</article-title><source>J Exp Bot</source><year>2017</year><volume>68</volume><fpage>4463</fpage><lpage>77</lpage><pub-id pub-id-type="pmcid">PMC5853417</pub-id><pub-id pub-id-type="pmid">28673035</pub-id><pub-id pub-id-type="doi">10.1093/jxb/erx220</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>YH</given-names></name><name><surname>Kubota</surname><given-names>A</given-names></name><name><surname>Kwon</surname><given-names>MS</given-names></name><name><surname>Covington</surname><given-names>MF</given-names></name><name><surname>Lee</surname><given-names>N</given-names></name><name><surname>Taagen</surname><given-names>ER</given-names></name><etal/></person-group><article-title>Molecular basis of flowering under natural long-day conditions in Arabidopsis | Nature Plants</article-title><source>Nat Plants</source><year>2018</year><volume>4</volume><fpage>824</fpage><lpage>35</lpage><pub-id pub-id-type="pmcid">PMC6195122</pub-id><pub-id pub-id-type="pmid">30250277</pub-id><pub-id pub-id-type="doi">10.1038/s41477-018-0253-3</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paradiso</surname><given-names>R</given-names></name><name><surname>Proietti</surname><given-names>S</given-names></name></person-group><article-title>Light-Quality Manipulation to Control Plant Growth and Photomorphogenesis in Greenhouse Horticulture: The State of the Art and the Opportunities of Modern LED Systems</article-title><source>J Plant Growth Regul</source><year>2022</year><volume>41</volume><fpage>742</fpage><lpage>80</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bechtold</surname><given-names>U</given-names></name><name><surname>Burow</surname><given-names>M</given-names></name><name><surname>Kangasjärvi</surname><given-names>S</given-names></name></person-group><article-title>Translational photobiology: towards dynamic lighting in indoor horticulture</article-title><source>Trends Plant Sci</source><year>2025</year><volume>30</volume><fpage>301</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">39482192</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poorter</surname><given-names>H</given-names></name><name><surname>Niinemets</surname><given-names>Ü</given-names></name><name><surname>Ntagkas</surname><given-names>N</given-names></name><name><surname>Siebenkäs</surname><given-names>A</given-names></name><name><surname>Mäenpää</surname><given-names>M</given-names></name><name><surname>Matsubara</surname><given-names>S</given-names></name><etal/></person-group><article-title>A meta-analysis of plant responses to light intensity for 70 traits ranging from molecules to whole plant performance</article-title><source>New Phytol</source><year>2019</year><volume>223</volume><fpage>1073</fpage><lpage>105</lpage><pub-id pub-id-type="pmid">30802971</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goto</surname><given-names>N</given-names></name><name><surname>Kumagai</surname><given-names>T</given-names></name><name><surname>Koornneef</surname><given-names>M</given-names></name></person-group><article-title>Flowering responses to light-breaks in photomorphogenic mutants of Arabidopsis thaliana, a long-day plant</article-title><source>Physiol Plant</source><year>1991</year><volume>83</volume><fpage>209</fpage><lpage>15</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paik</surname><given-names>I</given-names></name><name><surname>Huq</surname><given-names>E</given-names></name></person-group><article-title>Plant photoreceptors: Multi-functional sensory proteins and their signaling networks</article-title><source>Semin Cell Dev Biol</source><year>2019</year><volume>92</volume><fpage>114</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC8630751</pub-id><pub-id pub-id-type="pmid">30946988</pub-id><pub-id pub-id-type="doi">10.1016/j.semcdb.2019.03.007</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paajanen</surname><given-names>P</given-names></name><name><surname>Lane de Barros Dantas</surname><given-names>L</given-names></name><name><surname>Dodd</surname><given-names>AN</given-names></name></person-group><article-title>Layers of crosstalk between circadian regulation and environmental signalling in plants</article-title><source>Curr Biol</source><year>2021</year><volume>31</volume><fpage>R399</fpage><lpage>413</lpage><pub-id pub-id-type="pmid">33905701</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nieto</surname><given-names>C</given-names></name><name><surname>Catalán</surname><given-names>P</given-names></name><name><surname>Luengo</surname><given-names>LM</given-names></name><name><surname>Legris</surname><given-names>M</given-names></name><name><surname>López-Salmerón</surname><given-names>V</given-names></name><name><surname>Davière</surname><given-names>JM</given-names></name><etal/></person-group><article-title>COP1 dynamics integrate conflicting seasonal light and thermal cues in the control of Arabidopsis elongation</article-title><source>Sci Adv</source><year>2022</year><volume>8</volume><elocation-id>eabp8412</elocation-id><pub-id pub-id-type="pmcid">PMC9390991</pub-id><pub-id pub-id-type="pmid">35984876</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.abp8412</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gangappa</surname><given-names>SN</given-names></name><name><surname>Kumar</surname><given-names>SV</given-names></name></person-group><article-title>DET1 and COP1 Modulate the Coordination of Growth and Immunity in Response to Key Seasonal Signals in Arabidopsis</article-title><source>Cell Rep</source><year>2018</year><volume>25</volume><fpage>29</fpage><lpage>37</lpage><elocation-id>e3</elocation-id><pub-id pub-id-type="pmcid">PMC6180345</pub-id><pub-id pub-id-type="pmid">30282035</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2018.08.096</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronald</surname><given-names>J</given-names></name><name><surname>Lock</surname><given-names>SCL</given-names></name><name><surname>Claydon</surname><given-names>W</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>McCarthy</surname><given-names>K</given-names></name><name><surname>Pendlington</surname><given-names>E</given-names></name><etal/></person-group><article-title>Hypocotyl Development in Arabidopsis and other Brassicaceae Displays Evidence of Photoperiodic Memory</article-title><source>bioRxiv</source><year>2024</year><date-in-citation>cited 2024 May 26</date-in-citation><elocation-id>2024.05.13.593876</elocation-id><comment>[Internet]</comment><pub-id pub-id-type="doi">10.1101/2024.05.13.593876v1</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poorter</surname><given-names>H</given-names></name><name><surname>Fiorani</surname><given-names>F</given-names></name><name><surname>Pieruschka</surname><given-names>R</given-names></name><name><surname>Wojciechowski</surname><given-names>T</given-names></name><name><surname>van der Putten</surname><given-names>WH</given-names></name><name><surname>Kleyer</surname><given-names>M</given-names></name><etal/></person-group><article-title>Pampered inside, pestered outside? Differences and similarities between plants growing in controlled conditions and in the field</article-title><source>New Phytol</source><year>2016</year><volume>212</volume><fpage>838</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">27783423</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>D</given-names></name><name><surname>Scandola</surname><given-names>S</given-names></name><name><surname>Kennedy</surname><given-names>C</given-names></name><name><surname>Lummer</surname><given-names>C</given-names></name><name><surname>Gallo</surname><given-names>MCR</given-names></name><name><surname>Grubb</surname><given-names>LE</given-names></name><etal/></person-group><article-title>Twilight length alters growth and flowering time in Arabidopsis via LHY/CCA1</article-title><source>Sci Adv</source><year>2024</year><volume>10</volume><elocation-id>eadl3199</elocation-id><pub-id pub-id-type="pmcid">PMC11212724</pub-id><pub-id pub-id-type="pmid">38941453</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.adl3199</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vialet-Chabrand</surname><given-names>S</given-names></name><name><surname>Matthews</surname><given-names>JSA</given-names></name><name><surname>Simkin</surname><given-names>AJ</given-names></name><name><surname>Raines</surname><given-names>CA</given-names></name><name><surname>Lawson</surname><given-names>T</given-names></name></person-group><article-title>Importance of Fluctuations in Light on Plant Photosynthetic Acclimation</article-title><source>Plant Physiol</source><year>2017</year><volume>173</volume><fpage>2163</fpage><lpage>79</lpage><pub-id pub-id-type="pmcid">PMC5373038</pub-id><pub-id pub-id-type="pmid">28184008</pub-id><pub-id pub-id-type="doi">10.1104/pp.16.01767</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emmerson</surname><given-names>RA</given-names></name><name><surname>Bechtold</surname><given-names>U</given-names></name><name><surname>Zabet</surname><given-names>NR</given-names></name><name><surname>Lawson</surname><given-names>T</given-names></name></person-group><article-title>DNA methylation contributes to plant acclimation to naturally fluctuating light</article-title><source>bioRxiv</source><year>2024</year><date-in-citation>cited 2025 Mar 12</date-in-citation><elocation-id>2024.06.07.597890</elocation-id><comment>[Internet]</comment><pub-id pub-id-type="doi">10.1101/2024.06.07.597890v1</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaiser</surname><given-names>E</given-names></name><name><surname>Morales</surname><given-names>A</given-names></name><name><surname>Harbinson</surname><given-names>J</given-names></name></person-group><article-title>Fluctuating Light Takes Crop Photosynthesis on a Rollercoaster Ride</article-title><source>Plant Physiol</source><year>2018</year><volume>176</volume><fpage>977</fpage><lpage>89</lpage><pub-id pub-id-type="pmcid">PMC5813579</pub-id><pub-id pub-id-type="pmid">29046421</pub-id><pub-id pub-id-type="doi">10.1104/pp.17.01250</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belmonte</surname><given-names>A</given-names></name><name><surname>Tissot</surname><given-names>N</given-names></name><name><surname>Rabinovich</surname><given-names>A</given-names></name><name><surname>Ploschuk</surname><given-names>EL</given-names></name><name><surname>Crocco</surname><given-names>CD</given-names></name><name><surname>Ulm</surname><given-names>R</given-names></name><etal/></person-group><article-title>Sensory perception of fluctuating light in Arabidopsis [Internet]</article-title><source>bioRxiv</source><year>2024</year><date-in-citation>cited 2025 May 8</date-in-citation><elocation-id>2024.02.21.581400</elocation-id><pub-id pub-id-type="pmid">40421713</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yano</surname><given-names>A</given-names></name><name><surname>Fujiwara</surname><given-names>K</given-names></name></person-group><article-title>Plant lighting system with five wavelength-band light-emitting diodes providing photon flux density and mixing ratio control</article-title><source>Plant Methods</source><year>2012</year><volume>8</volume><fpage>46</fpage><pub-id pub-id-type="pmcid">PMC3573946</pub-id><pub-id pub-id-type="pmid">23173915</pub-id><pub-id pub-id-type="doi">10.1186/1746-4811-8-46</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevens</surname><given-names>J</given-names></name><name><surname>Davey</surname><given-names>P</given-names></name><name><surname>Kasznicki</surname><given-names>P</given-names></name><name><surname>Hofmann</surname><given-names>TA</given-names></name><name><surname>Lawson</surname><given-names>T</given-names></name></person-group><article-title>Green Conversations: Harnessing Plant Communication to control growth light intensity</article-title><source>bioRxiv</source><year>2024</year><date-in-citation>cited 2025 Mar 12</date-in-citation><elocation-id>2024.08.29.610229</elocation-id><comment>[Internet]</comment><pub-id pub-id-type="doi">10.1101/2024.08.29.610229v1</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Both</surname><given-names>AJ</given-names></name><name><surname>Benjamin</surname><given-names>L</given-names></name><name><surname>Franklin</surname><given-names>J</given-names></name><name><surname>Holroyd</surname><given-names>G</given-names></name><name><surname>Incoll</surname><given-names>LD</given-names></name><name><surname>Lefsrud</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Guidelines for measuring and reporting environmental parameters for experiments in greenhouses</article-title><source>Plant Methods</source><year>2015</year><volume>11</volume><fpage>43</fpage><pub-id pub-id-type="pmcid">PMC4567830</pub-id><pub-id pub-id-type="pmid">26366189</pub-id><pub-id pub-id-type="doi">10.1186/s13007-015-0083-5</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hashida</surname><given-names>Y</given-names></name><name><surname>Tezuka</surname><given-names>A</given-names></name><name><surname>Nomura</surname><given-names>Y</given-names></name><name><surname>Kamitani</surname><given-names>M</given-names></name><name><surname>Kashima</surname><given-names>M</given-names></name><name><surname>Kurita</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Fillable and unfillable gaps in plant transcriptome under field and controlled environments</article-title><source>Plant Cell Environ</source><year>2022</year><volume>45</volume><fpage>2410</fpage><lpage>27</lpage><pub-id pub-id-type="pmcid">PMC9544781</pub-id><pub-id pub-id-type="pmid">35610174</pub-id><pub-id pub-id-type="doi">10.1111/pce.14367</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>JA</given-names></name><name><surname>Vasiliev</surname><given-names>M</given-names></name><name><surname>Nur-E-Alam</surname><given-names>M</given-names></name><name><surname>Alameh</surname><given-names>K</given-names></name></person-group><article-title>Increasing the Yield of Lactuca sativa, L. in Glass Greenhouses through Illumination Spectral Filtering and Development of an Optical Thin Film Filter</article-title><source>Sustainability</source><year>2020</year><volume>12</volume><fpage>3740</fpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Holmes</surname><given-names>MG</given-names></name></person-group><chapter-title>Radiation Measurement</chapter-title><person-group person-group-type="editor"><name><surname>Smith</surname><given-names>H</given-names></name><name><surname>Holmes</surname><given-names>MG</given-names></name></person-group><source>Tech Photomorphogenesis</source><publisher-loc>USA</publisher-loc><publisher-name>Academic Press</publisher-name><year>1984</year><fpage>81</fpage><lpage>107</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holmes</surname><given-names>MG</given-names></name><name><surname>Smith</surname><given-names>H</given-names></name></person-group><article-title>The Function of Phytochrome in the Natural Environment—I. Characterization of Daylight for Studies in Photomorphogenesis and Photoperiodism</article-title><source>Photochem Photobiol</source><year>1977</year><volume>25</volume><fpage>533</fpage><lpage>8</lpage></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Holmes</surname><given-names>MG</given-names></name></person-group><chapter-title>Light Sources</chapter-title><person-group person-group-type="editor"><name><surname>Smith</surname><given-names>H</given-names></name><name><surname>Holmes</surname><given-names>MG</given-names></name></person-group><source>Tech Photomorphogenesis</source><publisher-loc>USA</publisher-loc><publisher-name>Academic Press</publisher-name><year>1984</year><fpage>43</fpage><lpage>79</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Cabinet setup with Heliospectra DYNA lights.</title><p><bold>(a)</bold> Overall setup of the growth cabinet with 2 Heliospectra DYNA lights resting on a glass shelf in a separate lighting compartment with its own ventilation. These lights are connected to a laptop which controls them. The growth compartment is separately ventilated, with a height adjustable shelf for plants. An opaque divider was installed to separate the light coming from the 2 sets of LEDs above. <bold>(b)</bold> Setup for taking measurements. Only half of the cabinet is shown. The spectrometer rests on the shelf, 95cm away from the light source. The spectrometer is connected to a laptop which records the measurements while also controlling the LED lights.</p></caption><graphic xlink:href="EMS206298-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Analysis and algorithm diagrams.</title><p><bold>(a)</bold> Example spectrum from an LED at a given intensity, breaking down which features were used for analysis: peak wavelength, peak irradiance, total irradiance, bleedthrough. <bold>(b)</bold> Graphical explanation of our algorithm for accurately programming LED lights. It takes user provided target irradiances and calibration data and uses it to predict which intensities to set the lights, in order to achieve the target irradiances. This is achieved through multiple steps: obtaining the closest calibration intensity to the target irradiance, getting the calibration spectrum for each LED at that closest intensity, compiling a matrix of these channel irradiances, solving a system of linear equations with this matrix and the target irradiances, multiplying the solved coefficients with the closest intensities to predict the optimum intensities for the lights, and tidying the predicted intensities so that they are accepted by the lighting software. <bold>(c)</bold> The process of carrying out a random search. Take the intensities that the LightFitR algorithm predicts and run it on the lights, measuring their output. Calculate residuals by comparing the measurements with the original target irradiances. Test ranges for each LED are calculated proportional to the scale and direction (positive or negative) of the residual, using the LightFitR intensities. Random combinations of intensities (within these ranges) are selected and then run on the lights with each random combination considered an event. Measurements are again taken and mean squared error for each event is calculated using the residuals. The event with the lowest mean squared error is the ‘best’ event and the intensities used for that best event should be used in experiments.</p></caption><graphic xlink:href="EMS206298-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Challenges of the lighting system, revealed during calibration. The spectrum was measured independently for each LED channel at increasing intensities (0, 1, 5, 10, 20, 50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000) with a spectrometer. <bold>(a)</bold> The irradiances at the peak wavelengths of the spectrum, with a smoothing function applied to highlight the non-linearity. <bold>(b)</bold> The bleedthrough from 1 LED into the wavelengths of the other channels, at maximum (1000) intensity. The diagonal is NA as that represents the channel which is on. <bold>(c)</bold> The wavelength of the spectrum peak for each LED channel, with dashed lines representing the purported peak wavelengths. <bold>(d)</bold> The difference between the peak we measured and the purported peak, and how it relates to intensity. The 530 nm and 620 nm channels are highlighted as they show the most extreme differences.</p></caption><graphic xlink:href="EMS206298-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Testing our algorithm against previous methods. The algorithms were tested on their ability to predict the correct intensities which were originally used in a light regime with random intensities in random combinations of LEDs at increasing complexity. Individual LED approaches (closest, linear regression, non-negative least squares) were compared with multidimensional methods (system of linear equations, non-negative least squares). <inline-graphic xlink:href="EMS206298-i001.jpg"/> denotes the mean. <bold>(a)</bold> Mean squared error of each event at increasing complexities. For all algorithms, see <xref ref-type="supplementary-material" rid="SD1">figure S2</xref>. (***) indicates p&lt;0.001 in pairwise comparisons within the complexity level. <bold>(b)</bold> Residuals ([predicted intensity] - [true intensity] i.e. how wrong the prediction is) per LED across all complexity levels. The best individual approach is compared with a multidimensional approach to illustrate the differences. For the LED breakdowns across all algorithms, see <xref ref-type="supplementary-material" rid="SD1">figure S3</xref>.</p></caption><graphic xlink:href="EMS206298-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Random search. Target irradiances (complexity: 4 LEDs) were chosen based on the accuracy of the intensities predicted by the multidimensional NNLS algorithm, with a low, medium and high mean squared error (of the algorithm prediction) selected <inline-graphic xlink:href="EMS206298-i002.jpg"/>. These algorithm-predicted intensities were used as the basis of a random search in an attempt to find the light intensities with the lowest mean squared error (*). Each point represents an event where random intensities (within a range) were selected for each of the 4 LED channels.</p></caption><graphic xlink:href="EMS206298-f005"/></fig></floats-group></article>