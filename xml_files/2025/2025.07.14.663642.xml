<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207363</article-id><article-id pub-id-type="doi">10.1101/2025.07.14.663642</article-id><article-id pub-id-type="archive">PPR1052186</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>WitChi: Efficient Detection and Pruning of Compositional Bias in Phylogenomic Alignments Using Empirical Chi-Squared Testing</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Köstlbacher</surname><given-names>Stephan</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Panagiotou</surname><given-names>Kassiani</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tamarit</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ettema</surname><given-names>Thijs J. G.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>Laboratory of Microbiology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04qw24q55</institution-id><institution>Wageningen University and Research</institution></institution-wrap>, <city>Wageningen</city>, <country country="NL">The Netherlands</country></aff><aff id="A2"><label>2</label>Theoretical Biology and Bioinformatics, Department of Biology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04pp8hn57</institution-id><institution>Utrecht University</institution></institution-wrap>, <city>Utrecht</city>, <country country="NL">The Netherlands</country></aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author. <email>stephan.koestlbacher@proton.me</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>22</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>18</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Convergent evolution, where unrelated taxa independently evolve similar nucleotide or amino acid compositions, can introduce compositional bias into biological sequence data. Such biases distort phylogenetic inference, particularly in deep or unevenly sampled phylogenomic datasets. While composition-aware models can mitigate this issue, their computational demands often preclude their use in large-scale analyses. We present WitChi, a computationally efficient tool for identifying and removing compositionally biased alignment columns using empirical significance testing. WitChi calculates taxon-specific chi-squared (χ<sup>2</sup>) scores and compares them to null distributions derived from column permutations that preserve the phylogenetic structure of the alignment. Sites most responsible for significant deviation are iteratively pruned using one of three scoring algorithms, continuing until no taxa remain significantly biased or until further pruning would reduce the overall alignment χ<sup>2</sup> score below the expected null range. Z-scores and p-values are provided for both taxa and alignments, offering interpretable metrics of bias severity. Pruning of simulated compositional heterogeneous alignments show that WitChi reliably restores correct topologies under standard, compositionally stationary models. In benchmarks, WitChi outperforms or matches BMGE’s stationary-based trimming while scaling linearly with taxon number. Applied to the archaeal GTDB r220 dataset (5,869 taxa; 10,101 sites), WitChi completes pruning in under two hours on four CPU cores. The resulting phylogeny recovers key clades previously resolved only by in-depth analyses using complex models of sequence evolution. WitChi provides an efficient and scalable solution for detecting and removing compositional bias, enabling more accurate phylogenetic inference across the tree of life.</p></abstract><kwd-group><kwd>Compositional bias</kwd><kwd>χ<sup>2</sup> test</kwd><kwd>multiple sequence alignment</kwd><kwd>alignment pruning</kwd><kwd>phylogenetics</kwd><kwd>Tree of life</kwd><kwd>phylogenetic artefacts</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Compositional heterogeneity in multiple sequence alignments (MSAs) is a well-recognized source of systematic error in phylogenetic inference (<xref ref-type="bibr" rid="R15">Foster and Hickey 1999</xref>). When different lineages evolve under distinct nucleotide or amino acid compositions, phylogenetic methods may recover spurious relationships, grouping taxa by sequence composition rather than evolutionary history. This issue is particularly relevant in large phylogenomic datasets, where compositional biases may be widespread and difficult to detect.</p><p id="P3">Notable examples include the misplacement of AT-biased (<xref ref-type="bibr" rid="R16">Foster et al. 1997</xref>), halophilic (<xref ref-type="bibr" rid="R1">Aouad et al. 2019</xref>; <xref ref-type="bibr" rid="R25">Martijn et al. 2020</xref>; <xref ref-type="bibr" rid="R3">Baker et al. 2024</xref>), and thermophilic lineages (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>)—many of which belong to Archaea. This domain, in particular, has proven vulnerable to compositional artefacts due to the ecological extremes inhabited by many of its taxa. In each case, biased composition overwhelmed the true phylogenetic signal, leading to incorrect or unsupported topologies without laborious specialized analyses.</p><p id="P4">To address these challenges, some methods model substitution processes using multiple composition matrices across the tree. For example, non-stationary models implemented in software such as p4 (<xref ref-type="bibr" rid="R14">Foster 2004</xref>) explicitly account for compositional heterogeneity across branches, but are computationally demanding. Recoding strategies—such as Dayhoff (<xref ref-type="bibr" rid="R8">Dayhoff et al. 1969</xref>) or SR4 schemes (<xref ref-type="bibr" rid="R37">Susko and Roger 2007</xref>)—aim to reduce compositional noise by collapsing amino acids into categories with similar physicochemical properties or high frequencies of substitutions, thus eliminating within-category compositional biases. However, these approaches can only target some sources of heterogeneity and are not universally successful at mitigating compositional biases (<xref ref-type="bibr" rid="R17">Foster et al. 2023</xref>).</p><p id="P5">A flexible and widely used alternative is chi-squared (χ<sup>2</sup>) pruning, which removes alignment columns that disproportionately contribute to taxon-specific compositional biases (<xref ref-type="bibr" rid="R13">Esser et al. 2004</xref>; <xref ref-type="bibr" rid="R45">Williams et al. 2007</xref>; <xref ref-type="bibr" rid="R40">Viklund et al. 2012</xref>). This method does not rely on prior tree inference or predefined recoding, but instead uses taxon-specific χ<sup>2</sup> scores to identify problematic sites (<xref ref-type="bibr" rid="R40">Viklund et al. 2012</xref>; <xref ref-type="bibr" rid="R26">Martijn et al. 2015</xref>). It is thus flexible and agnostic to the form of heterogeneity, successfully mitigating diverse sources of compositional bias (<xref ref-type="bibr" rid="R40">Viklund et al. 2012</xref>; <xref ref-type="bibr" rid="R26">Martijn et al. 2015</xref>, <xref ref-type="bibr" rid="R27">2018</xref>, <xref ref-type="bibr" rid="R25">2020</xref>; <xref ref-type="bibr" rid="R10">Dharamshi et al. 2020</xref>, <xref ref-type="bibr" rid="R9">2023</xref>; <xref ref-type="bibr" rid="R29">Muñoz-Gómez et al. 2022</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>). A related strategy is implemented in BMGE (<xref ref-type="bibr" rid="R7">Criscuolo and Gribaldo 2010</xref>), which includes a stationary-based trimming mode that iteratively removes compositionally deviant sites using pairwise comparisons of sequence composition. Like χ<sup>2</sup> pruning, this approach is model-free and does not require a tree, yet it lacks a statistical testing framework for taxon-specific bias and scales poorly with large numbers of taxa.</p><p id="P6">However, a more fundamental limitation remains: χ<sup>2</sup> tests assume that each sequence is an independent sample—a condition violated in MSAs due to shared ancestry. As a result, the canonical parametric χ<sup>2</sup> distribution, which assumes independent and identically distributed data, does not provide an accurate baseline for interpreting scores from real MSAs (<xref ref-type="bibr" rid="R18">Goldman 1993</xref>). While simulations can effectively generate empirical null distributions (<xref ref-type="bibr" rid="R14">Foster 2004</xref>), this approach requires a known tree topology and carefully chosen substitution model. These prerequisites introduce practical limitations, making simulations labor-intensive to set up and computationally costly for large phylogenomic datasets.</p><p id="P7">To resolve these limitations, we developed WitChi, a fast and modular Python tool that uses empirical null distributions derived from column permutations to test for compositionally biased taxa. WitChi iteratively removes alignment columns that drive taxon-specific χ<sup>2</sup> scores away from the permuted null expectation and recalculates alignment-wide amino acid frequencies to approach an unbiased equilibrium. This permutation-based framework better reflects the statistical structure of real MSAs and eliminates the need for prior tree inference or simulation. WitChi integrates the legacy χ<sup>2</sup> pruning method (“squared”) and introduces two additional scoring algorithms. We compare WitChi to the stationary-based trimming mode in BMGE, showing that WitChi achieves slightly superior clade recovery while scaling linearly—rather than quadratically—with the number of taxa, making it suitable for phylogenomic datasets with hundreds to thousands of taxa. We benchmark the tool on simulated datasets with varying degrees of heterogeneity and apply it to the archaeal tree of life—an empirically well-studied dataset where many taxa show compositionally biased sequences—demonstrating both practical scalability and significant gains in phylogenetic accuracy.</p></sec><sec id="S2"><title>Implementation and Evaluation</title><sec id="S3"><title>WitChi Workflow Overview</title><p id="P8">WitChi is a modular Python-based framework designed to detect and prune compositionally biased columns from MSAs. It operates in two main modes: test’ and ‘prune’ (<xref ref-type="fig" rid="F1">Fig. 1</xref>). These can be run independently or as an iterative workflow. Both rely on the calculation of taxon-specific χ<sup>2</sup> scores and comparison to an empirical null distribution generated by column-wise permutation.</p><p id="P9">The ‘test’ module computes a χ<sup>2</sup> score for each taxon, quantifying how much its composition deviates from the alignment-wide average. To account for phylogenetic structure, WitChi generates a null distribution by permuting columns independently across taxa. This preserves site-specific residue distributions while disrupting taxon-specific signals. The empirical null is used to calculate Z-scores and empirical p-values for each taxon.</p><p id="P10">The ‘prune’ module removes alignment columns that contribute disproportionately to bias. At each iteration, columns are scored using one of three algorithms—squared, quartic, or Wasserstein-guided (see below)—and the most extreme columns are iteratively pruned. Unless a user-defined threshold is reached first, the process continues until either no taxa are identified as significantly biased, or the overall alignment χ<sup>2</sup> score goes below the expected null range.</p></sec><sec id="S4"><title>Software Implementation</title><p id="P11">WitChi is implemented in Python 3.9 and designed for speed, scalability, extensibility, and ease of use. The core scientific stack includes NumPy for efficient array operations and matrix-based statistics (<xref ref-type="bibr" rid="R20">Harris et al. 2020</xref>), Biopython for robust parsing of FASTA, PHYLIP, and NEXUS alignments (<xref ref-type="bibr" rid="R6">Cock et al. 2009</xref>), multiprocessing with joblib for parallelized permutation and pruning steps (Varoquaux et al.). WitChi includes a command-line interface (‘test’ and ‘prune’) with sensible defaults and logging. It is available under the MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/stephkoest/witchi">https://github.com/stephkoest/witchi</ext-link>, with included unit tests, example data, and benchmark scripts.</p></sec><sec id="S5"><title>Statistical Basis</title><p id="P12">To quantify compositional bias in MSAs, we calculate a χ<sup>2</sup> score for each taxon. This score reflects how much the observed frequency of characters (e.g., nucleotides or amino acids) in a given sequence deviates from the global character distribution of the alignment. Specifically, we compute: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P13">Where <italic>O</italic><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>E</italic><sub><italic>j</italic></sub> are the observed and expected frequencies of amino acid j in taxon i in the alignment, and n is the number of characters (20 amino-acids or 4 nucleotides). Then, we compute an alignment-wide χ<sup>2</sup> score: <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p id="P14">Where <italic>χ</italic><sub><italic>i</italic></sub><sup><italic>2</italic></sup> is the χ<sup>2</sup> score of taxon i, and <italic>n</italic> is the number of taxa in the alignment.</p><sec id="S6"><title>Empirical Null Distribution from Permutations</title><p id="P15">To approximate an appropriate null distribution, we randomly permute characters within each alignment column, maintaining global composition while removing taxon-specific signal. This generates permuted MSAs that reflect the expected χ<sup>2</sup> score distribution under compositional homogeneity. Each permutation results in a new χ<sup>2</sup> score for every taxon. Across all permutations (default: 100), these scores are aggregated to form an empirical null distribution.</p></sec><sec id="S7"><title>Taxon- and Alignment-Level Bias Metrics</title><p id="P16">To assess compositional bias in multiple sequence alignments, WitChi calculates a suite of taxon-specific and alignment-level statistics based on χ<sup>2</sup> scores and their empirical null distributions.</p></sec><sec id="S8"><title>Taxon-Specific χ<sup>2</sup> Scores and Empirical Testing</title><p id="P17">To determine whether a taxon’s observed χ<sup>2</sup> score indicates significant compositional bias, components are defined as follows with: <disp-formula id="FD3"><mml:math id="M3"><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mtext>obs</mml:mtext><mml:mo>:</mml:mo><mml:mtext>the</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>observed</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>taxon</mml:mtext><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mtext>specific</mml:mtext><mml:mspace width="0.2em"/><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext>score</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>from</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>the</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>input</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>alignment</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P18">χ<sup>2</sup><sub>perm</sub>: the set of χ<sup>2</sup> scores for taxa across N permuted alignments (the empirical null distribution).</p><p id="P19">μ<sub>perm</sub> and σ<sub>perm</sub>: the mean and standard deviation of the empirical null distribution over all taxa from the permuted alignments.</p></sec><sec id="S9"><title>Taxon empirical p-values</title><p id="P20">To quantify the significance of each taxon’s observed χ<sup>2</sup> score, empirical p-values are computed by comparing them to the permuted null and multiplied by the number of observed χ<sup>2</sup> values (number of taxa), to account for multiple comparisons: <disp-formula id="FD4"><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>obs</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>∈</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P21">Here, <italic>p</italic><sub><italic>i</italic></sub> is the empirical p-value for taxon i, <italic>N</italic><sub><italic>perm</italic></sub> is the number of permuted alignments, and <italic>N</italic><sub><italic>obs</italic></sub> is the number of observed χ<sup>2</sup> values. This value reflects how extreme the observed χ<sup>2</sup> score is under the null hypothesis of compositional homogeneity. We chose an arbitrary cutoff of empirical p-value smaller than 0.05 to suggest significant deviation.</p></sec><sec id="S10"><title>Taxon Z-scores</title><p id="P22">We also compute Z-scores to express the magnitude of deviation from the empirical mean: <disp-formula id="FD5"><mml:math id="M5"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P23">These per-taxon scores can be used to identify outlier taxa in the ‘test’ module of the workflow.</p></sec><sec id="S11"><title>Alignment-Level Summary Statistics</title><sec id="S12"><title>Z-score</title><p id="P24"><disp-formula id="FD6"><mml:math id="M6"><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:munder accentunder="true"><mml:mi>χ</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p id="P25">Where <italic>X</italic><sup>2</sup>is the mean observed χ<sup>2</sup> across all taxa and captures how far the average taxa scores deviate from expectation.</p></sec><sec id="S13"><title>q95 Z-score</title><p id="P26"><disp-formula id="FD7"><mml:math id="M7"><mml:mrow><mml:mi>q</mml:mi><mml:mn>95</mml:mn><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mn>95</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mn>95</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P27">Where <italic>q</italic><sup>95</sup>is the 95th percentile of observed χ<sup>2</sup> scores, <inline-formula><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mtext>perm</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mn>95</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the 95th percentile of χ<sup>2</sup> scores for all taxa in all permuted alignments. This normalized score captures how far the top 5% of biased taxa deviate from expectation median.</p></sec><sec id="S14"><title>Alignment empirical p-value</title><p id="P28">To test whether the overall alignment contains significant compositional bias, we compute an empirical p-value for the mean taxon χ<sup>2</sup> score: <disp-formula id="FD8"><mml:math id="M9"><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>∈</mml:mi><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p id="P29">This represents the probability that a randomly permuted alignment would have an equal or greater χ<sup>2</sup> score than observed.</p></sec></sec></sec><sec id="S15"><title>Scoring Algorithms</title><p id="P30">WitChi implements three scoring strategies to rank alignment columns by their contribution to compositional bias. Each reflects a different principle for identifying columns that distort χ<sup>2</sup> statistics across taxa.</p><p id="P31">Squared ranks columns by their overall contribution to the summed χ<sup>2</sup> score, favoring those with broad impact. Quartic amplifies extreme deviations, emphasizing columns that disproportionately affect highly biased taxa. Wasserstein evaluates how each column shifts the full distribution of χ<sup>2</sup> scores, capturing subtle or distribution-wide effects.</p><sec id="S16"><title>Squared</title><p id="P32">We compute a total χ<sup>2</sup> value across all rows. For each column, we determine how its removal affects the global χ<sup>2</sup> score. Columns producing the largest drop are pruned first. <disp-formula id="FD9"><mml:math id="M10"><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mspace width="0.2em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p id="P33">A positive <italic>ΔX</italic><sup>2</sup>indicates that pruning has shifted the alignment’s composition closer to the expected distribution under homogeneity.</p></sec><sec id="S17"><title>Quartic</title><p id="P34">We squared the row-level χ<sup>2</sup> values and then calculated the impact of removing each column on these squared scores. This approach amplifies high values, emphasizing columns that strongly deviate from the expected distribution. <disp-formula id="FD10"><mml:math id="M11"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msup><mml:mi>χ</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>χ</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>χ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mspace width="0.2em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/></mml:mrow><mml:mn>4</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P35">A positive <italic>ΔX</italic><sup>4</sup> indicates that pruning has shifted the alignment’s composition closer to the expected distribution under homogeneity.</p></sec><sec id="S18"><title>Wasserstein</title><p id="P36">We computed the Kantorovich metric (<xref ref-type="bibr" rid="R23">Kantorovich 1960</xref>) (also known as Wasserstein distance or) between the empirical distribution of observed taxon-specific χ<sup>2</sup> scores and the empirical null distribution obtained from permuted alignments, which approximates the minimal “effort” required to transform one distribution into another. The metric was calculated using the ‘<monospace>scipy.stats.wasserstein_distance()</monospace>’ function (<xref ref-type="bibr" rid="R41">Virtanen et al. 2020</xref>). <disp-formula id="FD11"><mml:math id="M12"><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mi>c</mml:mi><mml:mspace width="0.2em"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula> where <italic>W</italic> denotes the Wasserstein-1 distance between the observed taxon-specific χ<sup>2</sup> distribution and the empirical null distribution. A positive ΔW indicates that pruning has shifted the alignment’s composition closer to the expected distribution under homogeneity.</p></sec></sec><sec id="S19"><title>Datasets</title><sec id="S20"><title>Simulated datasets</title><p id="P37">To benchmark performance, we used simulated alignments constructed to exhibit varying levels of compositional heterogeneity and known ground-truth topologies. Dataset design followed the simulation strategies of <xref ref-type="bibr" rid="R17">Foster et al. (2023)</xref>, including alignments with multiple compositional regimes across the tree. All alignments were simulated with p4 (commit 91e49a9) (<xref ref-type="bibr" rid="R14">Foster 2004</xref>).</p></sec><sec id="S21"><title>Empirical Null Validation</title><p id="P38">To approximate a parametric null distribution, we sampled 10 values from a χ<sup>2</sup> distribution with 19 degrees of freedom (corresponding to 20 amino acid states) in 1,000 iterations using the rchisq() function in R (v4.4.1), generating a total of 10,000 theoretical χ<sup>2</sup> scores for comparison. To assess the behavior of parametric versus empirical χ<sup>2</sup> null distributions, we simulated 1,000 alignments under both homogeneous and heterogeneous amino acid composition, across three species trees of increasing branch length (tree length of 0.25, 2.5, and 5.0). Alignments consisted of 10,000 columns and four taxa. Under homogeneous conditions, all taxa evolved under the LG model. Under heterogeneous conditions, <italic>b</italic> branches evolved under the Dayhoff amino acid frequency profile, while the others retained root composition. Simulations were performed using p4 (<xref ref-type="bibr" rid="R14">Foster 2004</xref>) commit 70364fb, specifying stationary substitution models and amino acid frequencies directly. These datasets were used to generate observed χ<sup>2</sup> score distributions for each taxon, as well as to evaluate the accuracy of permutation-based null models and empirical p-values in classifying biased versus unbiased taxa.</p></sec><sec id="S22"><title>Pruning Strategy Benchmarking</title><p id="P39">To benchmark the performance of different pruning strategies, we simulated a separate set of amino acid alignments under a fixed nine-taxon tree topology with two alternative compositions (Dayhoff and GAP-FYMINK). Five of the nine taxa were assigned to evolve under either Dayhoff or GAP-FYMINK compositions, while the remaining four taxa used the root composition. Internal branches were set to 0.01 substitutions per site and external branches to 1.0, creating a challenging scenario with strong compositional signal and shallow clade separations. This setup favors artefactual clustering by composition and provides a stringent test of pruning effectiveness.</p><p id="P40">Pruning was performed with WitChi using three scoring algorithms (squared, quartic, and Wasserstein) and pruning step sizes ranging from 1 column per iteration to 10% of the initial alignment length. All alignments were pruned until no taxa were significantly biased according to the respective method.</p></sec><sec id="S23"><title><xref ref-type="bibr" rid="R17">Foster et al. (2023)</xref> recoding benchmark set</title><p id="P41">Protein and DNA alignments depicted in <xref ref-type="fig" rid="F3">Figures 3</xref> and <xref ref-type="fig" rid="F4">4</xref> in <xref ref-type="bibr" rid="R17">Foster et al. (2023)</xref> with compositional heterogeneity over the tree were downloaded from <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.6djh9w11s">http://dx.doi.org/10.5061/dryad.6djh9w11s</ext-link>. Pruning was performed with WitChi using squared algorithm and pruning step size was 1.</p></sec><sec id="S24"><title>Timing pruning algorithms</title><p id="P42">To assess computational scalability, we measured runtime for pruning alignments of 10,000 columns while varying the number of taxa, i.e., 10, 50, 100, 200. Timing benchmarks were performed on a dual-socket AMD EPYC 9654 “Genoa” machine (2 × 96 cores, 2.4 GHz, 384 GiB RAM), running a Linux environment. <preformat preformat-type="computer code">
<styled-content style="background-color:#f2f2f2">
ls ${BASEDIR}/*fasta | parallel -j 192 \
“witchi prune --file {} --format fasta --num_workers_chisq 1 \
--pruning_algorithm $algorithm --max_residue_pruned 9000 --top_n 10”</styled-content>
</preformat>
</p><p id="P43">Each pruning run used a single core per alignment (--num_workers 1) to ensure consistent measurement of algorithm scaling with taxon number. Total runtime was recorded for each pruning algorithm (quartic, squared, Wasserstein) across varying taxon counts. BMGE timings were obtained using the stationary-based trimming mode (-s YES) with entropy filtering disabled (-h 0:1), executed similarly in batch mode. Testing was executed using WitChi’s command-line interface with the following command: <preformat preformat-type="computer code">
<styled-content style="background-color:#f2f2f2">
ls ${BASEDIR}/*fasta | parallel -j 192 \
“witchi test --file {} --format fasta --num_workers_permute 1 --create_output”
</styled-content>
</preformat>
</p></sec><sec id="S25"><title>Parallel runtime scaling</title><p id="P44">To evaluated how well WitChi benefits from multi-core execution, we measured runtime of pruning and significance testing operations on alignments of varying size using 1, 2, or 3 CPU cores. For taxon scaling (20-200 taxa), alignment length was fixed at 10,000 residues; for alignment scaling (10,000–100,000 residues), taxon number was fixed at 50. Speedup was calculated as the ratio of runtimes with one core vs. multiple cores (T<sub>1</sub>/T<sub>n</sub>).</p></sec><sec id="S26"><title>Estimated overlap calculations</title><p id="P45">To quantify the similarity between χ<sup>2</sup> score distributions, we computed the estimated kernel density overlap (eO) between observed scores from homogeneous alignments and two null models (permutation-based and parametric). Kernel density estimates were computed on a common support grid (with a ±1 buffer around the data range) using base R’s density() function. The minimum density at each point (pmin) was integrated numerically using integrate.xy() from the sfsmisc package to calculate the area of intersection. The eO coefficient was computed as: <disp-formula id="FD12"><mml:math id="M13"><mml:mrow><mml:mi>e</mml:mi><mml:mi>O</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>Area</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mtext>intersection</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>Area</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mtext>dist</mml:mtext><mml:mspace width="0.2em"/><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mspace width="0.2em"/><mml:mtext>Area</mml:mtext><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mtext>dist</mml:mtext><mml:mspace width="0.2em"/><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p id="P46">This yields values between 0 and 1, where 1 indicates complete overlap. Overlap was calculated separately for each internal branch length tested (0.25, 2.5, 5.0).</p></sec><sec id="S27"><title>BMGE stationary trimming</title><p id="P47">We benchmarked BMGE v1.12 using its stationary-based trimming mode to compare performance with WitChi. Alignments were trimmed using the following parameters: “-t AA -h 0:1 -s YES”. The -s YES flag enables the stationary-based trimming algorithm, which removes alignment columns based on pairwise composition distance among sequences. To ensure a fair comparison focused solely on composition-based pruning, entropy filtering was disabled by setting the entropy threshold range with -h 0:1. The -t AA option specifies amino acid alignments. All other parameters were left at their defaults. BMGE was applied to the same simulated datasets and evaluated using the same downstream tree inference protocol as used for WitChi.</p><p id="P48">Phylogenetic tree inference from simulated alignments</p><p id="P49">All trees from simulated amino acid alignments were inferred with IQ-TREE v2.1.3 (<xref ref-type="bibr" rid="R28">Minh et al. 2020</xref>) under the LG+G4 model. DNA alignments were inferred with the GTR+G4 model.</p></sec><sec id="S28"><title>Comparison of phylogenetic support across pruning algorithms</title><p id="P50">To quantify the phylogenetic signal retained by different pruning strategies implemented in WitChi and by BMGE stationary-based trimming, we evaluated support values for specific clades across trees generated from pruned alignments. Here, support indicates the number of times the correct clade is present in the best trees of the 100 simulated alignments. Alignments pruned with the squared, quartic, and wasserstein algorithms were compared against unpruned and control treatments across a range of relative pruning step sizes. Delta scores were computed for each clade as the summed difference in support between pruned and unpruned alignments across algorithms. To enable cross-alignment length comparison, these delta values were normalized relative to a control, which represents compositionally homogeneous alignments generated under the same tree. This was necessary as shorter alignments contain less information and the true tree is not always recovered. We then calculated the mean and standard deviation of support deltas per algorithm, alignment length, and pruning step size. To rank algorithm performance, we computed ranks based on the relative delta improvement. Final algorithm rankings were summarized by their median rank across alignment lengths and pruning intensities.</p></sec><sec id="S29"><title>Benchmark data processing and visualization</title><p id="P51">All statistical analyses and figures were generated using R v4.4.3 (<xref ref-type="bibr" rid="R33">R Core Team 2018</xref>). Data processing utilized data.table v1.16.4 (<xref ref-type="bibr" rid="R5">Barrett et al. 2025</xref>). Visualization was performed using ggplot2 v3.5.1 (<xref ref-type="bibr" rid="R43">Wickham 2009</xref>), cowplot v1.1.3 (<xref ref-type="bibr" rid="R44">Wilke 2015</xref>) for multi-panel figure assembly, and patchwork v1.3.0 (<xref ref-type="bibr" rid="R30">Pedersen 2019</xref>) for composite layouts.</p></sec><sec id="S30"><title>Empirical Dataset</title><p id="P52">To evaluate WitChi’s performance on empirical data, we selected the archaeal dataset from GTDB r220 (<xref ref-type="bibr" rid="R35">Rinke et al. 2021</xref>). The MSA, consisting of 53 archaeal marker genes (<xref ref-type="bibr" rid="R11">Dombrowski et al. 2020</xref>), includes 5,869 taxa and 10,101 columns. We evaluated χ<sup>2</sup> values with WitChi and pruned the supermatrix using the quartic algorithm, which is the highest-ranking from benchmarking. The pruning was set to a step size of 10 residues per iteration and after the removal of 55.04% of the original alignment no biased taxa were detected. FastTree v2.1.11 (-lg) (<xref ref-type="bibr" rid="R31">Price et al. 2010</xref>) was used to reconstruct a phylogeny from the pruned supermatrix. The resulting tree served as a guide in a PMSF approximation (<xref ref-type="bibr" rid="R42">Wang et al. 2018</xref>) within IQ-TREE v2.1.3 under the LG+C10+G4+F model, with branch support assessed using 1,000 ultrafast bootstraps (UFboot) (<xref ref-type="bibr" rid="R21">Hoang et al. 2018</xref>) and 1,000 SH-like approximate likelihood ratio tests (SH-aLRT) (<xref ref-type="bibr" rid="R19">Guindon et al. 2010</xref>). To assess patterns of incongruence, we constructed a tanglegram comparing the reference archaeal phylogeny of GTDB with the phylogeny reconstructed from the WitChi-pruned GTDB supermatrix, using the phytools v2.0 R package (<xref ref-type="bibr" rid="R34">Revell 2024</xref>). In both trees, leaves of species representatives were collapsed at either phylum or class level. For each group, we retained the species whose terminal branch length was closest to the median branch length of its corresponding phylum or class. The optimal growth temperature for all archaea species representatives of GTDB r220 was estimated using GenomeSPOT v1.0.1 (<xref ref-type="bibr" rid="R4">Barnum et al. 2024</xref>).</p></sec></sec></sec><sec id="S31" sec-type="results"><title>Results</title><sec id="S32"><title>WitChi’s column permutation provides a robust null hypothesis for alignment χ<sup>2</sup> testing</title><p id="P53">To evaluate whether WitChi’s empirical null distribution provides a reliable reference for unbiased alignments, we simulated alignments evolving under both homogeneous and heterogeneous composition, and under trees with varying internal branch lengths to modulate divergence. Alignments simulated under homogeneous composition provide the gold-standard reference for expected χ<sup>2</sup> score distributions given a known species tree (simulation-based null). As expected, observed χ<sup>2</sup> scores increased with evolutionary distance and were further elevated when taxa evolved under distinct compositions—reflecting the accumulation of compositional signal (<xref ref-type="fig" rid="F2">Fig. 2</xref>, top row).</p><p id="P54">To approximate a null model without requiring tree inference and simulation, WitChi generates permuted alignments by randomly shuffling characters within each alignment column (<xref ref-type="fig" rid="F1">Fig. 1</xref>). This disrupts taxon-specific composition while preserving site-wise residue distributions, thereby retaining the alignment’s global structure (permutation-based null).</p><p id="P55">For comparison, we also evaluated the parametric null, i.e., the canonical χ<sup>2</sup> distribution that assumes independent and identically distributed samples with degrees of freedom equal to the number of character states minus one. Across all conditions, parametric χ<sup>2</sup> distributions increasingly failed to reflect the expected null distribution, as shown by a decline in kernel density overlap (eO) between the homogeneous taxa χ<sup>2</sup> scores and the parametric null (<xref ref-type="fig" rid="F2">Fig. 2</xref>). This overlap dropped to near zero even at modest tree lengths (eO = 0.00–0.47). In contrast, permutation-derived null distributions (see <italic>Methods</italic>) closely matched the homogeneous expectation across all divergence levels, with consistently high overlap values (eO = 0.96–0.98; <xref ref-type="fig" rid="F2">Fig. 2</xref>, third row). This demonstrates that permutation provides a robust, alignment-specific null model that adapts to the structure of each dataset.</p><p id="P56">To quantify deviations from the null distribution, we implemented Z-score and empirical p-value (also referred to as pseudo p-value) metrics for both taxon-specific and alignment-wide χ<sup>2</sup> scores. Z-scores were computed as standard deviations from the empirical permutation mean. Under homogeneous conditions, taxon-level Z-scores remained centered near zero. In heterogeneous simulations, Z-scores of biased taxa were strongly elevated (<xref ref-type="fig" rid="F2">Fig. 2</xref>, bottom row). Taxon Z-scores derived from permutation-based nulls closely matched those from simulation-based nulls (Pearson r = 0.999, R<sup>2</sup> = 0.997). A similar correlation was observed at the alignment level (Pearson r = 0.996, R<sup>2</sup> = 0.992; <xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>), confirming that permutation can serve as a practical surrogate for costly simulation-based testing.</p><p id="P57">We further assessed classification performance by evaluating whether permutation-based empirical p-values correctly distinguish biased from unbiased taxa. Across all simulations, permutation-based significance testing achieved high accuracy, with a balanced accuracy of 0.988 (sensitivity = 0.985; specificity = 0.992). Even under the most challenging condition—short-tree simulations where homogeneous and heterogeneous distributions overlap (<xref ref-type="fig" rid="F2">Fig. 2A</xref>)—accuracy remained high (balanced accuracy = 0.966; sensitivity = 0.948; specificity = 0.985).</p></sec><sec id="S33"><title>WitChi pruning algorithms efficiently remove compositional bias</title><p id="P58">To assess the effectiveness of WitChi pruning strategies under realistic conditions, we benchmarked performance on simulated alignments with known true topologies. These datasets were designed to introduce controlled compositional heterogeneity, allowing systematic evaluation of how different pruning approaches impact phylogenetic accuracy. Specifically, we simulated 100 alignments under a nine-taxon tree evolving under the LG+G4 model, in which five taxa (5 terminal branches and 1 internal branch) evolved under two compositions distinct from the root, with ten-fold over- and underrepresentation of specific amino acid sets (STNDMIF-AGEQKLVW –Dayhoff– and GAP-FYMINK) (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). This setup models patterns of lineage-specific compositional bias and allows direct testing of pruning effectiveness in recovering the true tree using standard substitution models in the presence of multiple compositions.</p><p id="P59">We first examined the impact of recalculating alignment-wide amino acid frequencies after column removal (<xref ref-type="fig" rid="F3">Fig. 3B</xref>). Distinct trends emerged depending on the frequency recalculation strategy. When pruning was performed with static global frequencies (i.e., no recalculation), biased taxa were never fully corrected: instead, χ<sup>2</sup> scores initially decreased but began to increase again after approximately 60% of the alignment had been removed, indicating that static pruning ultimately exacerbates compositional biases rather than resolving them. Conversely, using large dynamic steps of 10% to recalculate frequencies successfully removed bias but required pruning a substantially larger fraction of the alignment, and χ<sup>2</sup> scores showed intermediate increases before eventual decline. More moderate recalculation schemes, such as updating frequencies after every 0.1% or 1% of columns removed, resulted in robust bias correction without excessive column removal, and pruning generally converged at substantially smaller fractions of the alignment removed. Across recalculation strategies with step sizes of 1% or less, all three scoring algorithms appeared broadly effective in eliminating biased taxa, always achieving unbiased alignments with a median of 53.8% of columns (interquartile range: 53.3 - 54.3%) removed from the original alignment, although minor differences in pruning efficiency and residual χ<sup>2</sup> scores were observed between methods.</p><p id="P60">To test whether such pruning improves phylogenetic accuracy, we evaluated clade recovery (<xref ref-type="fig" rid="F3">Fig. 3C</xref>) from unpruned homogeneous alignments (control), unpruned heterogeneous alignments (biased), and heterogeneous alignments after pruning (pruned). Unpruned alignments with heterogeneous compositions consistently failed to recover the correct clade (0%), while pruning with ≤1% step sizes restored the true clade in 100% of replicates, matching the control alignments simulated under homogeneous conditions. In contrast, pruning with a 10% step size resulted in partial recovery only (24– 46%), likely due to the presence of residual compositional bias or excessive pruning, or a combination thereof (median 90% of alignments pruned). These findings validate that bias removal using empirically guided χ<sup>2</sup> pruning directly improves inference of the true evolutionary relationships.</p></sec><sec id="S34"><title>WitChi enables true clade recovery under compositional heterogeneity</title><p id="P61">Having established that small step sizes combined with dynamic frequency recalculation robustly eliminate bias, we next asked whether different scoring algorithms differ in their ability to recover the true topology following pruning. We compared the squared, quartic, and Wasserstein algorithms including alignments of shorter lengths (5,000 to 20,000 columns), to test whether pruning remains effective under lower information content (<xref ref-type="fig" rid="F3">Fig. 3D</xref>). Across all pruning step sizes—from single-column removal to 10% of the alignment per iteration—the quartic algorithm consistently achieved the highest performance, ranking first or second in all conditions and outperforming other methods for longer alignments. Its amplification of extreme taxon-specific χ<sup>2</sup> deviations appears to more effectively prioritize the removal of bias-driving columns. The squared algorithm also performed well but exhibited greater variability across replicates, while the Wasserstein method consistently ranked lowest.</p><p id="P62">To compare algorithm performance across all pruning regimes and alignment sizes, we computed a global ranking of algorithm and step size combinations (<xref ref-type="fig" rid="F3">Fig. 3E</xref>) based on true clade recovery (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>). The quartic algorithm with a 0.1% step size emerged as the top-performing strategy, balancing bias reduction and phylogenetic accuracy across alignment lengths.</p><p id="P63">To further validate these findings, we applied WitChi to amino acid and DNA alignments with compositional heterogeneity over the tree from <xref ref-type="bibr" rid="R17">Foster et al. (2023)</xref>, originally designed to evaluate recoding strategies under strong compositional heterogeneity. In amino acid simulations, pruning with WitChi consistently restored the correct tree in 100% of replicates using a simple LG+F model (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). DNA alignments also showed marked improvements under GTR+G4 (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>). These results confirm that empirical χ<sup>2</sup>-guided pruning can in principle remove misleading compositional signal, even without recoding or model heterogeneity (Supplementary Results).</p></sec><sec id="S35"><title>WitChi outperforms alternative pruning strategies and scales linearly</title><p id="P64">Finally, we assessed computational scalability by measuring runtime for pruning alignments of 10,000 columns while varying the number of taxa (<xref ref-type="fig" rid="F3">Fig. 3F</xref>). All WitChi algorithms scale approximately linearly with taxon number. The quartic and squared methods completed pruning in under 17 minutes for alignments with 200 taxa, while Wasserstein-guided pruning was significantly slower, exceeding 5 hours due to distribution-level comparisons at each iteration. Despite its slower runtime, we retained the Wasserstein algorithm due to its flexibility and conceptual generality. While it did not place first in simulated benchmarks, it consistently ranked second in some conditions and may prove advantageous for more complex empirical datasets where distributional shifts matter.</p><p id="P65">We also benchmarked BMGE’s stationary-based trimming mode for comparison. While BMGE performed comparably to WitChi in terms of true clade recovery (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>), its performance consistently ranked below the best WitChi configurations over different alignment lengths (<xref ref-type="fig" rid="F3">Fig. 3D</xref>) and in the overall median performance (<xref ref-type="fig" rid="F3">Fig. 3E</xref>). Notably, BMGE scaled poorly with increasing taxon count, exceeding 4 days at 100 taxa. We only obtained 80 replicates for the 50 taxa, and 10 for the 100 taxa dataset and we omitted running 200 taxa due to a 5-day computation time limit on our available computational resources. BMGE’s stationary trimming approach, while conceptually related, is not optimized for large phylogenomic matrices and scales quadratically with taxon number due to its all-pairs comparison strategy. In contrast, WitChi’s taxon-specific scoring and empirical null framework scale linearly, making it applicable to much larger datasets.</p><p id="P66">These results support the quartic algorithm with a relative step size of 0.1% of the unpruned alignment as a robust default strategy for fast and accurate pruning of heterogeneous MSAs.</p><p id="P67">Finally, we evaluated parallel runtime scaling using 1–3 CPU cores across varying taxon numbers and alignment lengths (<xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>). Pruning operations scaled more efficiently than significance testing, with longer alignments benefiting more from additional cores. The highest speedup was observed for the Wasserstein algorithm, indicating that WitChi particularly benefits from parallelization on large datasets.</p></sec><sec id="S36"><title>Application to a deeply divergent and compositionally biased archaeal dataset</title><p id="P68">To assess the effectiveness of WitChi on real data, we applied it to the archaeal supermatrix of GTDB release r220. This dataset provides an ideal benchmark due to its evolutionary significance and known cases of compositional bias affecting deep archaeal relationships, particularly among thermophilic and halophilic clades (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>; <xref ref-type="bibr" rid="R3">Baker et al. 2024</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>). Using WitChi’s ‘test’ workflow, we identified 5,583 out of 5,869 taxa (95.1%) as significantly deviating from the permuted null distribution. We then pruned the 10,101-column alignment with the quartic algorithm and a 0.1% step size—settings optimized through prior benchmarking. WitChi removed 55.04% of columns in under two hours, reducing the number of biased taxa from 95.1% to 2.3% (136 taxa) and lowering the mean taxon z-score from 44.73 to -0.01. Pruning automatically halted just before the total alignment χ<sup>2</sup> score dropped below the expected null range, preventing over-trimming. This safeguard ensures that pruning ends not only when taxa appear unbiased but also when further removal would likely compromise informative phylogenetic signal.</p><p id="P69">Phylogenetic reconstruction from the pruned alignment, using the same model as GTDB, revealed several topological rearrangements consistent with prior in-depth phylogenomic studies (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). For example, the class JANJXX01—encompassing Panguiarchaeales and Njordarchaeales—comprises members with biased amino acid compositions (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>) and that are predicted to grow at high temperatures (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). Phylogenomic analyses have placed this class either with the thermophilic Korarchaeia (<xref ref-type="bibr" rid="R32">Qu et al. 2023</xref>) or within Heimdallarchaeia (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>) Here, JANJXX01 is placed within Asgardarchaeota, consistent with previous inferences that account for compositional bias (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>). Similarly, DRAE01 and Korarchaeia—both composed of hyperthermophiles (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>)—were split from this clade and more plausibly repositioned, with DRAE01 placed within Thermoproteota and with Korarchaeia at the base of the clade formed by Thermoproteota and Asgardarchaeota (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>), in agreement with recent studies (<xref ref-type="bibr" rid="R38">Tahon et al. 2023</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>).</p><p id="P70">Another well-documented artifact concerns halophilic archaea. In the GTDB reference tree (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, left), the classes Methanonatronarchaeia and Halobacteria are recovered as sister lineages, suggesting a single origin of halophily. However, this grouping likely reflects convergent compositional bias. In the tree reconstructed from the WitChi-pruned alignment (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, right), Methanonatronarchaeia instead emerges as the sister group to all other Halobacteriota, while Halobacteria is well nested within the phylum—supporting independent adaptation to extreme salinity, consistent with targeted analyses (<xref ref-type="bibr" rid="R1">Aouad et al. 2019</xref>; <xref ref-type="bibr" rid="R3">Baker et al. 2024</xref>).</p><p id="P71">We also observed a rearrangement of the clade comprising B88-G9, Hadarchaeia, and Methanobacteriota_B, which are grouped more closely with Hydrothermarchaeota, JACRDV01 and Methanobacteriota in the GTDB reference (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, left). After pruning with WitChi (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, right), this clade shifts to form a sister lineage to the TACK and Asgardarchaeota groups, a placement that aligns with previous phylogenomic studies using site-heterogeneous models (<xref ref-type="bibr" rid="R2">Aouad et al. 2022</xref>).</p><p id="P72">Together, these results highlight the capacity of WitChi to resolve multiple sources of bias within a single dataset. By homogenising taxon-specific biases (<xref ref-type="fig" rid="F4">Fig. 4C</xref>) and preserving vertical signal, WitChi recovers more accurate topologies with increased branch support across clades, showing a 15% increase in average bipartition support for nodes representing class-level and higher groups after pruning.</p></sec></sec><sec id="S37" sec-type="discussion"><title>Discussion</title><p id="P73">Compositional bias is a pervasive source of systematic error in phylogenetic inference (<xref ref-type="bibr" rid="R15">Foster and Hickey 1999</xref>; <xref ref-type="bibr" rid="R14">Foster 2004</xref>), particularly in deep phylogenomics where lineages may evolve under distinct amino acid or nucleotide compositions. Standard substitution models assume compositional stationarity (<xref ref-type="bibr" rid="R18">Goldman 1993</xref>), and when this assumption is violated, even otherwise well-fitting models can yield incorrect topologies. While composition-aware models and recoding schemes offer partial solutions (<xref ref-type="bibr" rid="R17">Foster et al. 2023</xref>), they remain either computationally expensive, or rigid and insufficiently general for large, complex datasets.</p><p id="P74">WitChi addresses this challenge by combining classical χ<sup>2</sup>-based detection of taxon-specific biases with permutation-derived empirical null models. These nulls account for the phylogenetic structure of the alignment by disrupting taxon-specific compositional signal while preserving site-wise composition, enabling more accurate assessment of whether observed taxon scores represent significant compositional deviation. This approach avoids assumptions of taxon independence (<xref ref-type="bibr" rid="R18">Goldman 1993</xref>) and better reflects the statistical behavior of real-world MSAs.</p><p id="P75">A key insight from our work is that the combination of empirical permutation-derived null distributions with iterative pruning enables robust elimination of compositionally biased signal, without requiring recoding or complex model fitting. The iterative nature of the algorithm—re-evaluating χ<sup>2</sup> scores after each batch of columns is removed—allows WitChi to target multiple sources of bias. This strategy, first suggested in the context of χ<sup>2</sup> pruning by Dharamshi et al. (<xref ref-type="bibr" rid="R9">Dharamshi et al. 2023</xref>), is here generalized and formalized into a fully automated and scalable implementation. While several scoring strategies are available, our results suggest that amplifying extreme deviations (as in the quartic scoring algorithm) improves pruning precision and phylogenetic recovery.</p><p id="P76">Beyond simulations, WitChi restores accurate topologies in complex empirical datasets using only branch-homogeneous substitution models, as demonstrated using the archaeal GTDB r220 supermatrix. Rearrangements observed in the tree obtained from the WitChi-pruned alignment closely mirror results from studies using recoding or complex profile mixture models, including the repositioning of Panguiarchaeales, Methanonatronarchaeia, and Korarchaeia (<xref ref-type="bibr" rid="R12">Eme et al. 2023</xref>; <xref ref-type="bibr" rid="R3">Baker et al. 2024</xref>; <xref ref-type="bibr" rid="R22">Huang et al. 2025</xref>). That these results can be recovered with a lightweight preprocessing step underscores the utility of targeted, composition-aware pruning.</p><p id="P77">WitChi also addresses practical concerns of scalability. By relying on matrix operations and parallelization, it completes pruning of alignments with thousands of taxa and tens of thousands of sites in under two hours on a modern workstation. This makes the method broadly applicable to modern phylogenomic studies, where computational overhead often limits the use of complex-model approaches.</p><p id="P78">While BMGE’s stationary-based trimming mode also aims to reduce compositional artefacts without relying on explicit tree inference, it differs fundamentally from WitChi in both statistical framing and computational design. BMGE applies iterative pruning based on pairwise composition comparisons but lacks taxon-specific significance testing and does not generate an empirical null (<xref ref-type="bibr" rid="R7">Criscuolo and Gribaldo 2010</xref>). Our benchmarking showed that BMGE performs well at improving phylogenetic recovery, particularly in smaller datasets, but its quadratic scaling with taxon number and the lack of statistical interpretability limit its applicability in large-scale phylogenomic workflows.</p><p id="P79">While WitChi is currently implemented for amino acid and DNA alignments, its underlying framework is extensible. Future work could explore its application to codon alignments, or alternative alphabets like recoding schemes or structural alphabets. In some datasets, pruning alone may not resolve all artefacts, but as we show, it substantially reduces misleading signal and enables more accurate reconstruction under tractable models. This is especially important because large datasets can produce deceptively high statistical support for incorrect topologies when model assumptions are violated (<xref ref-type="bibr" rid="R24">Kumar et al. 2012</xref>). By removing columns that drive such bias, WitChi helps restore a balance between model fit and statistical confidence, improving not just accuracy but also interpretability of phylogenetic support.</p><p id="P80">In conclusion, WitChi offers a practical and statistically grounded method for identifying and mitigating compositional bias in MSAs. By coupling empirical null testing with iterative pruning, it enables scalable improvement of phylogenetic inference in datasets where compositional heterogeneity would otherwise distort evolutionary relationships. We anticipate it will be a valuable addition to phylogenomic pipelines, particularly in studies of early-diverging lineages, and other taxa where compositional convergence is common and challenging to model.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Information</label><media xlink:href="EMS207363-supplement-Supplemental_Information.pdf" mimetype="application" mime-subtype="pdf" id="d17aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S40"><title>Acknowledgments</title><p>We thank Peter Foster for sharing simulation code that supported the development and benchmarking of WitChi, and for providing valuable feedback on the manuscript draft. We thank Isabelle Anna Zink, Astrid Marihart, Martin Reitschmied, Manuel Pirker-Ihl, and Bela Hausmann for discussions and feedback during the development of WitChi.</p><sec id="S38"><title>Funding</title><p>We thank SURF (<ext-link ext-link-type="uri" xlink:href="http://www.surf.nl">www.surf.nl</ext-link>) for supporting the use of the National Supercomputer Snellius, facilitated through a grant from the Dutch Research Council (NWO-2021.059). This work was supported by the European Research Council Consolidator and Advanced Grants 817834 and 101142180, respectively (TJGE), the Dutch Research Council VI.C.192.016 (TJGE), the Volkswagen Foundation Grant 96725 (TJGE), and the Simons Foundation as part of the Moore-Simons Project on the Origin of the Eukaryotic Cell (Grant 73592LPI; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.46714/735925LPI">https://doi.org/10.46714/735925LPI</ext-link>) (TJGE).</p></sec></ack><sec id="S39" sec-type="data-availability"><title>Data and code availability</title><p id="P81">WitChi is available as open-source software under the MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/stephkoest/witchi">https://github.com/stephkoest/witchi</ext-link>, along with documentation and example workflows.</p><p id="P82">We will provide user support for WitChi for a minimum of two years from the date of publication.</p><p id="P83">All simulated alignments generated for this study will be made available via Dryad (Reviewer link: <ext-link ext-link-type="uri" xlink:href="https://tinyurl.com/y5b7mxah">https://tinyurl.com/y5b7mxah</ext-link>), and an extended version including, benchmarking processing scripts as well as the processed GTDB archaeal alignment and pruned tree files on the Zenodo Digital Repository (Reviewer link: <ext-link ext-link-type="uri" xlink:href="https://tinyurl.com/bdcutkkd">https://tinyurl.com/bdcutkkd</ext-link>). The reference GTDB r220 archaeal alignment and phylogenetic tree are available from <ext-link ext-link-type="uri" xlink:href="https://gtdb.ecogenomic.org">https://gtdb.ecogenomic.org</ext-link>.</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P84"><bold>Author contribution</bold></p><p id="P85">S.K. conceived the study, developed the WitChi software, designed and conducted all benchmarking and simulation-based analyses, and wrote the manuscript. K.P. performed the phylogenomic analysis of the GTDB archaeal dataset and wrote the corresponding Results section. D.T. generated the simulated datasets used for algorithm benchmarking. T.J.G.E. contributed to project discussions and secured funding support for S.K. and K.P. All authors provided critical feedback and helped shape the research, analysis and manuscript.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aouad</surname><given-names>M</given-names></name><name><surname>Borrel</surname><given-names>G</given-names></name><name><surname>Brochier-Armanet</surname><given-names>C</given-names></name><name><surname>Gribaldo</surname><given-names>S</given-names></name></person-group><article-title>Evolutionary placement of Methanonatronarchaeia</article-title><source>Nat Microbiol</source><year>2019</year><volume>4</volume><fpage>558</fpage><lpage>559</lpage><pub-id pub-id-type="pmid">30804543</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aouad</surname><given-names>M</given-names></name><name><surname>Flandrois</surname><given-names>JP</given-names></name><name><surname>Jauffrit</surname><given-names>F</given-names></name><name><surname>Gouy</surname><given-names>M</given-names></name><name><surname>Gribaldo</surname><given-names>S</given-names></name><name><surname>Brochier-Armanet</surname><given-names>C</given-names></name></person-group><article-title>A divide-and-conquer phylogenomic approach based on character supermatrices resolves early steps in the evolution of the Archaea</article-title><source>BMC Ecol Evol</source><year>2022</year><volume>22</volume><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/s12862-021-01952-0</pub-id><pub-id pub-id-type="pmcid">PMC8734073</pub-id><pub-id pub-id-type="pmid">34986784</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>BA</given-names></name><name><surname>Gutiérrez-Preciado</surname><given-names>A</given-names></name><name><surname>Rodríguez Del Río</surname><given-names>Á</given-names></name><name><surname>McCarthy</surname><given-names>CGP</given-names></name><name><surname>López-García</surname><given-names>P</given-names></name><name><surname>Huerta-Cepas</surname><given-names>J</given-names></name><name><surname>Susko</surname><given-names>E</given-names></name><name><surname>Roger</surname><given-names>AJ</given-names></name><name><surname>Eme</surname><given-names>L</given-names></name><name><surname>Moreira</surname><given-names>D</given-names></name></person-group><article-title>Expanded phylogeny of extremely halophilic archaea shows multiple independent adaptations to hypersaline environments</article-title><source>Nat Microbiol</source><year>2024</year><volume>9</volume><fpage>964</fpage><lpage>975</lpage><pub-id pub-id-type="pmid">38519541</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnum</surname><given-names>TP</given-names></name><name><surname>Crits-Christoph</surname><given-names>A</given-names></name><name><surname>Molla</surname><given-names>M</given-names></name><name><surname>Carini</surname><given-names>P</given-names></name><name><surname>Lee</surname><given-names>HH</given-names></name><name><surname>Ostrov</surname><given-names>N</given-names></name></person-group><article-title>Predicting microbial growth conditions from amino acid composition</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.03.22.586313</elocation-id></element-citation></ref><ref id="R5"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>T</given-names></name><name><surname>Dowle</surname><given-names>M</given-names></name><name><surname>Srinivasan</surname><given-names>A</given-names></name><name><surname>Gorecki</surname><given-names>J</given-names></name><name><surname>Chirico</surname><given-names>M</given-names></name><name><surname>Hocking</surname><given-names>T</given-names></name><name><surname>Schwendinger</surname><given-names>B</given-names></name><name><surname>Krylov</surname><given-names>I</given-names></name></person-group><source>data.table: Extension of “data.frame”</source><year>2025</year><comment>Available from <ext-link ext-link-type="uri" xlink:href="https://r-datatable.com">https://r-datatable.com</ext-link></comment></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJA</given-names></name><name><surname>Antao</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>JT</given-names></name><name><surname>Chapman</surname><given-names>BA</given-names></name><name><surname>Cox</surname><given-names>CJ</given-names></name><name><surname>Dalke</surname><given-names>A</given-names></name><name><surname>Friedberg</surname><given-names>I</given-names></name><name><surname>Hamelryck</surname><given-names>T</given-names></name><name><surname>Kauff</surname><given-names>F</given-names></name><name><surname>Wilczynski</surname><given-names>B</given-names></name><name><surname>de Hoon</surname><given-names>MJL</given-names></name></person-group><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>1422</fpage><lpage>1423</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id><pub-id pub-id-type="pmcid">PMC2682512</pub-id><pub-id pub-id-type="pmid">19304878</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Criscuolo</surname><given-names>A</given-names></name><name><surname>Gribaldo</surname><given-names>S</given-names></name></person-group><article-title>BMGE (Block Mapping and Gathering with Entropy): a new software for selection of phylogenetic informative regions from multiple sequence alignments</article-title><source>BMC Evol Biol</source><year>2010</year><volume>10</volume><fpage>210</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-10-210</pub-id><pub-id pub-id-type="pmcid">PMC3017758</pub-id><pub-id pub-id-type="pmid">20626897</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>MO</given-names></name><name><surname>Schwartz</surname><given-names>RM</given-names></name><name><surname>Orcutt</surname><given-names>BC</given-names></name></person-group><chapter-title>Chapter 22: A model of evolutionary change in proteins</chapter-title><person-group person-group-type="editor"><name><surname>Dayhoff</surname><given-names>MO</given-names></name></person-group><source>Atlas of Protein Sequence and Structure Dayhoff, MO</source><publisher-name>National Biomedical Research Foundation</publisher-name><publisher-loc>Washington, DC</publisher-loc><year>1969</year><fpage>345</fpage><lpage>352</lpage></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dharamshi</surname><given-names>JE</given-names></name><name><surname>Köstlbacher</surname><given-names>S</given-names></name><name><surname>Schön</surname><given-names>ME</given-names></name><name><surname>Collingro</surname><given-names>A</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name><name><surname>Horn</surname><given-names>M</given-names></name></person-group><article-title>Gene gain facilitated endosymbiotic evolution of Chlamydiae</article-title><source>Nat Microbiol</source><year>2023</year><volume>8</volume><fpage>40</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1038/s41564-022-01284-9</pub-id><pub-id pub-id-type="pmcid">PMC9816063</pub-id><pub-id pub-id-type="pmid">36604515</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dharamshi</surname><given-names>JE</given-names></name><name><surname>Tamarit</surname><given-names>D</given-names></name><name><surname>Eme</surname><given-names>L</given-names></name><name><surname>Stairs</surname><given-names>CW</given-names></name><name><surname>Martijn</surname><given-names>J</given-names></name><name><surname>Homa</surname><given-names>F</given-names></name><name><surname>Jørgensen</surname><given-names>SL</given-names></name><name><surname>Spang</surname><given-names>A</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name></person-group><article-title>Marine Sediments Illuminate Chlamydiae Diversity and Evolution</article-title><source>Curr Biol</source><year>2020</year><volume>30</volume><fpage>1032</fpage><lpage>1048</lpage><elocation-id>e7</elocation-id><pub-id pub-id-type="pmid">32142706</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dombrowski</surname><given-names>N</given-names></name><name><surname>Williams</surname><given-names>TA</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>Woodcroft</surname><given-names>BJ</given-names></name><name><surname>Lee</surname><given-names>J-H</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Spang</surname><given-names>A</given-names></name></person-group><article-title>Undinarchaeota illuminate DPANN phylogeny and the impact of gene transfer on archaeal evolution</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>3939</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-17408-w</pub-id><pub-id pub-id-type="pmcid">PMC7414124</pub-id><pub-id pub-id-type="pmid">32770105</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eme</surname><given-names>L</given-names></name><name><surname>Tamarit</surname><given-names>D</given-names></name><name><surname>Caceres</surname><given-names>EF</given-names></name><name><surname>Stairs</surname><given-names>CW</given-names></name><name><surname>De Anda</surname><given-names>V</given-names></name><name><surname>Schön</surname><given-names>ME</given-names></name><name><surname>Seitz</surname><given-names>KW</given-names></name><name><surname>Dombrowski</surname><given-names>N</given-names></name><name><surname>Lewis</surname><given-names>WH</given-names></name><name><surname>Homa</surname><given-names>F</given-names></name><name><surname>Saw</surname><given-names>JH</given-names></name><etal/></person-group><article-title>Inference and reconstruction of the heimdallarchaeial ancestry of eukaryotes</article-title><source>Nature</source><year>2023</year><volume>618</volume><fpage>992</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06186-2</pub-id><pub-id pub-id-type="pmcid">PMC10307638</pub-id><pub-id pub-id-type="pmid">37316666</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Esser</surname><given-names>C</given-names></name><name><surname>Ahmadinejad</surname><given-names>N</given-names></name><name><surname>Wiegand</surname><given-names>C</given-names></name><name><surname>Rotte</surname><given-names>C</given-names></name><name><surname>Sebastiani</surname><given-names>F</given-names></name><name><surname>Gelius-Dietrich</surname><given-names>G</given-names></name><name><surname>Henze</surname><given-names>K</given-names></name><name><surname>Kretschmann</surname><given-names>E</given-names></name><name><surname>Richly</surname><given-names>E</given-names></name><name><surname>Leister</surname><given-names>D</given-names></name><name><surname>Bryant</surname><given-names>D</given-names></name><etal/></person-group><article-title>A genome phylogeny for mitochondria among alpha-proteobacteria and a predominantly eubacterial ancestry of yeast nuclear genes</article-title><source>Mol Biol Evol</source><year>2004</year><volume>21</volume><fpage>1643</fpage><lpage>1660</lpage><pub-id pub-id-type="pmid">15155797</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>PG</given-names></name></person-group><article-title>Modeling compositional heterogeneity</article-title><source>Syst Biol</source><year>2004</year><volume>53</volume><fpage>485</fpage><lpage>495</lpage><pub-id pub-id-type="pmid">15503675</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>PG</given-names></name><name><surname>Hickey</surname><given-names>DA</given-names></name></person-group><article-title>Compositional bias may affect both DNA-based and protein-based phylogenetic reconstructions</article-title><source>J Mol Evol</source><year>1999</year><volume>48</volume><fpage>284</fpage><lpage>290</lpage><pub-id pub-id-type="pmid">10093217</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>PG</given-names></name><name><surname>Jermiin</surname><given-names>LS</given-names></name><name><surname>Hickey</surname><given-names>DA</given-names></name></person-group><article-title>Nucleotide composition bias affects amino acid content in proteins coded by animal mitochondria</article-title><source>J Mol Evol</source><year>1997</year><volume>44</volume><fpage>282</fpage><lpage>288</lpage><pub-id pub-id-type="pmid">9060394</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>PG</given-names></name><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Williams</surname><given-names>TA</given-names></name><name><surname>Cox</surname><given-names>CJ</given-names></name><name><surname>Embley</surname><given-names>TM</given-names></name></person-group><article-title>Recoding Amino Acids to a Reduced Alphabet may Increase or Decrease Phylogenetic Accuracy</article-title><source>Syst Biol</source><year>2023</year><volume>72</volume><fpage>723</fpage><lpage>737</lpage><pub-id pub-id-type="pmid">35713492</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Statistical tests of models of DNA substitution</article-title><source>J Mol Evol</source><year>1993</year><volume>36</volume><fpage>182</fpage><lpage>198</lpage><pub-id pub-id-type="pmid">8114118</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guindon</surname><given-names>S</given-names></name><name><surname>Dufayard</surname><given-names>J-F</given-names></name><name><surname>Lefort</surname><given-names>V</given-names></name><name><surname>Anisimova</surname><given-names>M</given-names></name><name><surname>Hordijk</surname><given-names>W</given-names></name><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title><source>Syst Biol</source><year>2010</year><volume>59</volume><fpage>307</fpage><lpage>321</lpage><pub-id pub-id-type="pmid">20525638</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Wieser</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Kern</surname><given-names>R</given-names></name><etal/></person-group><article-title>Array programming with NumPy</article-title><source>Nature</source><year>2020</year><volume>585</volume><fpage>357</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><pub-id pub-id-type="pmcid">PMC7759461</pub-id><pub-id pub-id-type="pmid">32939066</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoang</surname><given-names>DT</given-names></name><name><surname>Chernomor</surname><given-names>O</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Vinh</surname><given-names>LS</given-names></name></person-group><article-title>UFBoot2: Improving the Ultrafast Bootstrap Approximation</article-title><source>Mol Biol Evol</source><year>2018</year><volume>35</volume><fpage>518</fpage><lpage>522</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx281</pub-id><pub-id pub-id-type="pmcid">PMC5850222</pub-id><pub-id pub-id-type="pmid">29077904</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>W-C</given-names></name><name><surname>Probst</surname><given-names>M</given-names></name><name><surname>Hua</surname><given-names>Z-S</given-names></name><name><surname>Szánthó</surname><given-names>LL</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>TA</given-names></name><name><surname>Spang</surname><given-names>A</given-names></name></person-group><article-title>Phylogenomic analyses reveal that Panguiarchaeum is a clade of genome-reduced Asgard archaea</article-title><source>bioRxiv</source><year>2025</year><elocation-id>2025.02.13.637844</elocation-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kantorovich</surname><given-names>LV</given-names></name></person-group><article-title>Mathematical Methods of organizing and Planning Production</article-title><source>Manage Sci</source><year>1960</year><volume>6</volume><fpage>366</fpage><lpage>422</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Filipski</surname><given-names>AJ</given-names></name><name><surname>Battistuzzi</surname><given-names>FU</given-names></name><name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name><name><surname>Tamura</surname><given-names>K</given-names></name></person-group><article-title>Statistics and truth in phylogenomics</article-title><source>Mol Biol Evol</source><year>2012</year><volume>29</volume><fpage>457</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1093/molbev/msr202</pub-id><pub-id pub-id-type="pmcid">PMC3258035</pub-id><pub-id pub-id-type="pmid">21873298</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martijn</surname><given-names>J</given-names></name><name><surname>Schön</surname><given-names>ME</given-names></name><name><surname>Lind</surname><given-names>AE</given-names></name><name><surname>Vosseberg</surname><given-names>J</given-names></name><name><surname>Williams</surname><given-names>TA</given-names></name><name><surname>Spang</surname><given-names>A</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name></person-group><article-title>Hikarchaeia demonstrate an intermediate stage in the methanogen-to-halophile transition</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>5490</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-19200-2</pub-id><pub-id pub-id-type="pmcid">PMC7599335</pub-id><pub-id pub-id-type="pmid">33127909</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martijn</surname><given-names>J</given-names></name><name><surname>Schulz</surname><given-names>F</given-names></name><name><surname>Zaremba-Niedzwiedzka</surname><given-names>K</given-names></name><name><surname>Viklund</surname><given-names>J</given-names></name><name><surname>Stepanauskas</surname><given-names>R</given-names></name><name><surname>Andersson</surname><given-names>SGE</given-names></name><name><surname>Horn</surname><given-names>M</given-names></name><name><surname>Guy</surname><given-names>L</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name></person-group><article-title>Single-cell genomics of a rare environmental alphaproteobacterium provides unique insights into Rickettsiaceae evolution</article-title><source>ISME, J</source><year>2015</year><volume>9</volume><fpage>2373</fpage><lpage>2385</lpage><pub-id pub-id-type="doi">10.1038/ismej.2015.46</pub-id><pub-id pub-id-type="pmcid">PMC4497978</pub-id><pub-id pub-id-type="pmid">25848874</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martijn</surname><given-names>J</given-names></name><name><surname>Vosseberg</surname><given-names>J</given-names></name><name><surname>Guy</surname><given-names>L</given-names></name><name><surname>Offre</surname><given-names>P</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name></person-group><article-title>Deep mitochondrial origin outside the sampled alphaproteobacteria</article-title><source>Nature</source><year>2018</year><volume>557</volume><fpage>101</fpage><lpage>105</lpage><pub-id pub-id-type="pmid">29695865</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Schmidt</surname><given-names>HA</given-names></name><name><surname>Chernomor</surname><given-names>O</given-names></name><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Woodhams</surname><given-names>MD</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name></person-group><article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title><source>Mol Biol Evol</source><year>2020</year><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><pub-id pub-id-type="pmcid">PMC7182206</pub-id><pub-id pub-id-type="pmid">32011700</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muñoz-Gómez</surname><given-names>SA</given-names></name><name><surname>Susko</surname><given-names>E</given-names></name><name><surname>Williamson</surname><given-names>K</given-names></name><name><surname>Eme</surname><given-names>L</given-names></name><name><surname>Slamovits</surname><given-names>CH</given-names></name><name><surname>Moreira</surname><given-names>D</given-names></name><name><surname>López-García</surname><given-names>P</given-names></name><name><surname>Roger</surname><given-names>AJ</given-names></name></person-group><article-title>Site-and-branch-heterogeneous analyses of an expanded dataset favour mitochondria as sister to known Alphaproteobacteria</article-title><source>Nat Ecol Evol</source><year>2022</year><volume>6</volume><fpage>253</fpage><lpage>262</lpage><pub-id pub-id-type="pmid">35027725</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedersen</surname><given-names>TL</given-names></name></person-group><article-title>patchwork: The Composer of Plots</article-title><source>CRAN: Contributed Packages</source><year>2019</year></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Dehal</surname><given-names>PS</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name></person-group><article-title>FastTree 2--approximately maximum-likelihood trees for large alignments</article-title><source>PLoS One</source><year>2010</year><volume>5</volume><elocation-id>e9490</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id><pub-id pub-id-type="pmcid">PMC2835736</pub-id><pub-id pub-id-type="pmid">20224823</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qu</surname><given-names>YN</given-names></name><name><surname>Rao</surname><given-names>YZ</given-names></name><name><surname>Qi</surname><given-names>YL</given-names></name><name><surname>Li</surname><given-names>YX</given-names></name><name><surname>Li</surname><given-names>A</given-names></name><name><surname>Palmer</surname><given-names>M</given-names></name><name><surname>Hedlund</surname><given-names>BP</given-names></name><name><surname>Shu</surname><given-names>WS</given-names></name><name><surname>Evans</surname><given-names>PN</given-names></name><name><surname>Nie</surname><given-names>GX</given-names></name><name><surname>Hua</surname><given-names>ZS</given-names></name><etal/></person-group><article-title>Panguiarchaeum symbiosum, a potential hyperthermophilic symbiont in the TACK superphylum</article-title><source>Cell Rep</source><year>2023</year><volume>42</volume><elocation-id>112158</elocation-id><pub-id pub-id-type="pmid">36827180</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="other"><collab>R Core Team</collab><source>R: A Language and Environment for Statistical Computing</source><year>2018</year></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Revell</surname><given-names>LJ</given-names></name></person-group><article-title>phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things)</article-title><source>PeerJ</source><year>2024</year><volume>12</volume><elocation-id>e16505</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.16505</pub-id><pub-id pub-id-type="pmcid">PMC10773453</pub-id><pub-id pub-id-type="pmid">38192598</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Chuvochina</surname><given-names>M</given-names></name><name><surname>Mussig</surname><given-names>AJ</given-names></name><name><surname>Chaumeil</surname><given-names>PA</given-names></name><name><surname>Davín</surname><given-names>AA</given-names></name><name><surname>Waite</surname><given-names>DW</given-names></name><name><surname>Whitman</surname><given-names>WB</given-names></name><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name></person-group><article-title>A standardized archaeal taxonomy for the Genome Taxonomy Database</article-title><source>Nat Microbiol</source><year>2021</year><volume>6</volume><fpage>946</fpage><lpage>959</lpage><pub-id pub-id-type="pmid">34155373</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Schwientek</surname><given-names>P</given-names></name><name><surname>Sczyrba</surname><given-names>A</given-names></name><name><surname>Ivanova</surname><given-names>NN</given-names></name><name><surname>Anderson</surname><given-names>IJ</given-names></name><name><surname>Cheng</surname><given-names>JF</given-names></name><name><surname>Darling</surname><given-names>A</given-names></name><name><surname>Malfatti</surname><given-names>S</given-names></name><name><surname>Swan</surname><given-names>BK</given-names></name><name><surname>Gies</surname><given-names>EA</given-names></name><name><surname>Dodsworth</surname><given-names>JA</given-names></name><etal/></person-group><article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title><source>Nature</source><year>2013</year><volume>499</volume><fpage>431</fpage><lpage>437</lpage><pub-id pub-id-type="pmid">23851394</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Susko</surname><given-names>E</given-names></name><name><surname>Roger</surname><given-names>AJ</given-names></name></person-group><article-title>On reduced amino acid alphabets for phylogenetic inference</article-title><source>Mol Biol Evol</source><year>2007</year><volume>24</volume><fpage>2139</fpage><lpage>2150</lpage><pub-id pub-id-type="pmid">17652333</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tahon</surname><given-names>G</given-names></name><name><surname>Köstlbacher</surname><given-names>S</given-names></name><name><surname>Pelve</surname><given-names>EA</given-names></name><name><surname>Baker</surname><given-names>BJ</given-names></name><name><surname>Saw</surname><given-names>JH</given-names></name><name><surname>Eme</surname><given-names>L</given-names></name><name><surname>Tamarit</surname><given-names>D</given-names></name><name><surname>Schön</surname><given-names>ME</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name></person-group><article-title>Phylogenomics and ancestral reconstruction of Korarchaeota reveals genomic adaptation to habitat switching</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.09.28.559970</elocation-id></element-citation></ref><ref id="R39"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Estève</surname><given-names>L</given-names></name><name><surname>Abadie</surname><given-names>A</given-names></name><name><surname>Moreau</surname><given-names>T</given-names></name><name><surname>Glaser</surname><given-names>P</given-names></name><name><surname>Gervais</surname><given-names>P</given-names></name><name><surname>Halchenko</surname><given-names>Y</given-names></name><name><surname>Charras</surname><given-names>F</given-names></name><name><surname>Self-Construct</surname><given-names>E</given-names></name><name><surname>Berkes</surname><given-names>P</given-names></name><etal/></person-group><source>joblib/joblib: 142</source></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viklund</surname><given-names>J</given-names></name><name><surname>Ettema</surname><given-names>TJG</given-names></name><name><surname>Andersson</surname><given-names>SGE</given-names></name></person-group><article-title>Independent genome reduction and phylogenetic reclassification of the oceanic SAR11 clade</article-title><source>Mol Biol Evol</source><year>2012</year><volume>29</volume><fpage>599</fpage><lpage>615</lpage><pub-id pub-id-type="pmid">21900598</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Oliphant</surname><given-names>TE</given-names></name><name><surname>Haberland</surname><given-names>M</given-names></name><name><surname>Reddy</surname><given-names>T</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Burovski</surname><given-names>E</given-names></name><name><surname>Peterson</surname><given-names>P</given-names></name><name><surname>Weckesser</surname><given-names>W</given-names></name><name><surname>Bright</surname><given-names>J</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><etal/></person-group><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title><source>Nat Methods</source><year>2020</year><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmcid">PMC7056644</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H-C</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Susko</surname><given-names>E</given-names></name><name><surname>Roger</surname><given-names>AJ</given-names></name></person-group><article-title>Modeling Site Heterogeneity with Posterior Mean Site Frequency Profiles Accelerates Accurate Phylogenomic Estimation</article-title><source>Syst Biol</source><year>2018</year><volume>67</volume><fpage>216</fpage><lpage>235</lpage><pub-id pub-id-type="pmid">28950365</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group><source>ggplot2: Elegant Graphics for Data Analysis</source><publisher-name>Springer Science &amp; Business Media</publisher-name><year>2009</year></element-citation></ref><ref id="R44"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><source>cowplot: Streamlined Plot Theme and Plot Annotations for “ggplot2”. CRAN: Contributed Packages</source><year>2015</year></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>KP</given-names></name><name><surname>Sobral</surname><given-names>BW</given-names></name><name><surname>Dickerman</surname><given-names>AW</given-names></name></person-group><article-title>A robust species tree for the alphaproteobacteria</article-title><source>J Bacteriol</source><year>2007</year><volume>189</volume><fpage>4578</fpage><lpage>4586</lpage><pub-id pub-id-type="doi">10.1128/JB.00269-07</pub-id><pub-id pub-id-type="pmcid">PMC1913456</pub-id><pub-id pub-id-type="pmid">17483224</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of the WitChi workflows for detecting and reducing compositional bias in multiple sequence alignments.</title><p>(<bold>A</bold>) The ‘test’ workflow (blue background) computes taxon-specific χ<sup>2</sup> scores and establishes an empirical null distribution by column permutation (100x), allowing the identification of biased taxa. The ‘prune’ workflow (purple background) iteratively removes alignment columns with the highest Δχ<sup>2</sup>, followed by a convergence check to determine whether pruning should continue or stop. (<bold>B</bold>) Example observed MSA and one corresponding column-permuted MSA, illustrating how taxon-specific biases are homogenised while preserving global composition. The bar plot on the right compares taxon χ<sup>2</sup> scores between the observed and permuted alignments. (<bold>C</bold>) Left: Δχ<sup>2</sup> scores per alignment column of the observed alignment in B, with the most biased column flagged for removal (dashed box). Right: Density distributions of taxon-specific χ<sup>2</sup> scores before and during the pruning loop, showing how pruning shifts scores toward the null distribution. Once no further biased taxa are detected, pruning results in an unbiased alignment, in which the taxon-specific χ<sup>2</sup> score distribution approaches the permuted null distribution (right panel).</p></caption><graphic xlink:href="EMS207363-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Column permutation of heterogeneous alignments approximates a homogenous null distribution.</title><p>(A–C) Phylogenetic trees in the first row illustrate three scenarios with varying tree lengths (0.25, 2.5, 5.0). Density plots in the second row show observed taxa χ<sup>2</sup> score distributions for 1,000 alignments with heterogeneous compositions (solid lines, where branches b evolve under a different amino acid composition) and homogeneous compositions (dashed lines), respectively. The third row density plots compare expected χ<sup>2</sup> distributions derived from permuted alignments (pink) and parametric χ<sup>2</sup> distributions (blue). Observed scores are represented by orange distributions, with solid vertical orange lines marking the median χ<sup>2</sup> score for homogeneous compositions. The panels highlight the increase of χ<sup>2</sup> scores as total tree length increases, demonstrating the divergence between observed, permuted, and parametric distributions. eO represents the estimated kernel density overlap between the χ<sup>2</sup> distribution of alignments with homogeneous composition and either the permuted alignment χ<sup>2</sup> distribution for heterogeneous composition (pink font) or the parametric χ<sup>2</sup> distribution (blue font). Scatter plots in the bottom row show taxon Z-scores derived from the simulated null (x-axis) compared to Z-scores derived from permuted null distributions corresponding to alignments evolved under the tree in the respective column. The diagonal dashed line indicates a slope of 1.</p></caption><graphic xlink:href="EMS207363-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Quartic algorithm slightly outperforms other algorithms and scales linearly with the number of taxa.</title><p>(A) Tree and compositions used for generating 9 taxa alignments with branches evolving under 3 compositions used for panels B-C: root (black), Dayhoff (orange), and GAP-FYMINK (turquoise). Internal branches were 0.01, and terminal branches 1 substitution per position long. (B) Lines indicate biased taxa and alignment χ<sup>2</sup> scores when pruning 100 alignments with 50,000 columns using different amino acid frequency recalculation strategies for scoring: no recalculation (static), recalculation after removing every 10%, 1%, 0.1% columns of the initial alignment, and recalculation after each individual column is removed. Line colors represent pruning algorithm (legend: bottom right). (C) Recovery of the true clade from the 50,000 column long simulated alignments from the heterogeneous (biased), the pruned, and the control alignments. The correct clade was fully supported when alignments were pruned with step sizes lower than 10%. (D) Performance ranking, including BMGE stationary trimming, based on true clade recovery from pruned alignments of 5,000, 10,000, 20,000, and 50,000 columns. <xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref> for detailed resolution of clade retrieval. (E) Each point represents the median rank of an algorithm’s performance over all four alignment lengths at a given pruning intensity. Lower ranks indicate better performance. (F) Points indicating pruning time of alignments with 10,000 columns and varying number of taxa for significance testing under the three WitChi pruning algorithms, and BMGE stationary trimming.</p></caption><graphic xlink:href="EMS207363-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Addressing compositional heterogeneity with WitChi leads to topological rearrangements in the archaeal reference tree of the Genome Taxonomy Database.</title><p>(A) Phylum-level tanglegram comparing the archaeal Genome Taxonomy Database r220 (GTDB) reference tree (left) with its WhitChi-treated counterpart (right). The WitChi-treated phylogeny was inferred from the pruned alignment of 4,541 columns (down from the original 10,101). Light gray links indicate branches with unchanged topology, while colored links highlight topological rearrengements, with each color corresponding to the supergroup of the affected lineage. Phylum-level splits resulting from the WitChi treatment are shown leading to their respective member lineages, with lineages corresponding to single classes labeled with the prefix “<italic>c</italic> “. Both trees are rooted at the clade shown in orange, originally named after Diapherotrites, Parvarchaeota, Aenigmarchaeota, Nanoarchaeota and Nanohaloarchaeota (DPANN) (<xref ref-type="bibr" rid="R36">Rinke et al. 2013</xref>). Black circles at nodes indicate UFboot ≥ 95% support. The scale bar denotes the average number of substitutions per site. (B) Subtrees from (A) focusing on rearrangements in the relationships among the classes within the phylum Halobacteriota. (C) Distributions of χ<sup>2</sup> scores for the GTDB ar53 supermatrix: pink represents the distribution derived from 100 permuted alignments, orange represents the observed scores in the original alignment, and blue represents the scores for the WitChi-pruned supermatrix.</p></caption><graphic xlink:href="EMS207363-f004"/></fig></floats-group></article>