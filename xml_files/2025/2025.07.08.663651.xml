<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207135</article-id><article-id pub-id-type="doi">10.1101/2025.07.08.663651</article-id><article-id pub-id-type="archive">PPR1047400</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Weighted sliced inverse regression for scalable supervised dimensionality reduction of spatial transcriptomics data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Woollard</surname><given-names>Maximilian</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Panwar</surname><given-names>Pratibha</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Harland</surname><given-names>Luke T.G.</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Mo</surname><given-names>Jeremy</given-names></name><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Hanyun</given-names></name><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Swarbrick</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Gottgens</surname><given-names>Berthold</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Ghazanfar</surname><given-names>Shila</given-names></name><xref ref-type="corresp" rid="CR1">*</xref><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Nghiem</surname><given-names>Linh H.</given-names></name><xref ref-type="corresp" rid="CR1">*</xref><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib></contrib-group><aff id="A1"><label>1</label>School of Mathematics and Statistics, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0384j8v12</institution-id><institution>The University of Sydney</institution></institution-wrap>, <city>Camperdown</city>, <state>New South Wales</state>, <country country="AU">Australia</country></aff><aff id="A2"><label>2</label>Charles Perkins Centre, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0384j8v12</institution-id><institution>The University of Sydney</institution></institution-wrap>, <city>Camperdown</city>, <state>New South Wales</state>, <country country="AU">Australia</country></aff><aff id="A3"><label>3</label>Sydney Precision Data Science Centre, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/0384j8v12</institution-id><institution>The University of Sydney</institution></institution-wrap>, <city>Camperdown</city>, <state>New South Wales</state>, <country country="AU">Australia</country></aff><aff id="A4"><label>4</label>Cambridge Stem Cell Institute, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <city>Cambridge</city>, <country country="GB">UK</country></aff><aff id="A5"><label>5</label>Department of Haematology, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <city>Cambridge</city>, <country country="GB">UK</country></aff><aff id="A6"><label>6</label>Wolfson College, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/013meh722</institution-id><institution>University of Cambridge</institution></institution-wrap>, <city>Cambridge</city>, <country country="GB">UK</country></aff><aff id="A7"><label>7</label>Cancer Ecosystems Program, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01b3dvp57</institution-id><institution>Garvan Institute of Medical Research</institution></institution-wrap>, <city>Darlinghurst</city>, <state>NSW</state><country country="AU">Australia</country></aff><aff id="A8"><label>8</label>School of Clinical Medicine, Faculty of Medicine &amp; Health, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03r8z3t63</institution-id><institution>UNSW Sydney</institution></institution-wrap>, <city>Sydney</city>, <state>NSW</state><country country="AU">Australia</country></aff><author-notes><corresp id="CR1"><label>*</label>Co-corresponding authors: Shila Ghazanfar (<email>shila.ghazanfar@sydney.edu.au</email>) and Linh H. Nghiem (<email>linh.nghiem@sydney.edu.au</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>14</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>11</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">With the dramatic take-up of spatially resolved transcriptomics biotechnologies, performing spatially-aware analysis of the resulting data is crucial to maximise advances in biological understanding. Dimensionality reduction is a first step in almost any analysis of spatial transcriptomics data, regardless of whether the data is collected at the single-cell or spot level. While common approaches, such as principal component analysis, aim to identify low-dimensional scores that preserve total variances of gene expression features, such variances do not usually correspond to biologically relevant spatial variation. To this end, we have developed weighted sliced inverse regression (wSIR), a sufficient dimension reduction technique that performs dimensionality reduction and retains as much predictive power of the spatial coordinates as possible. As a linear dimensionality reduction approach, wSIR is applicable to multiple distinct spatial transcriptomic datasets, and is extremely scalable due to the algorithm and our Rcpp implementation, with over 100, 000 cells processed in under 2 minutes on a standard laptop. The feature loadings are interpretable, and new non-spatial data can be projected into the wSIR low-dimensional space for further downstream analyses. We examine wSIR’s performance through benchmarking and demonstrate its capability of biological discovery through two case studies in breast cancer and early embryonic development.</p></abstract><kwd-group><kwd>spatial transcriptomics</kwd><kwd>dimensionality reduction</kwd><kwd>sufficient dimensionality reduction</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">Spatial transcriptomics is becoming a widespread method for profiling hundreds to thousands of genes at single cell resolution in their spatial context for a variety of tissues (<xref ref-type="bibr" rid="R39">You et al., 2024</xref>). There is great potential to uncover the complexity of tissue organisation and discover new biological aspects in normal processes and the emergence of disease. Current analysis of spatial transcriptomics data has emerged primarily as an extension of the last 5-8 years of single-cell transcriptomics research (<ext-link ext-link-type="uri" xlink:href="https://www.scrna-tools.org/">https://www.scrna-tools.org/</ext-link>), with several key analytical steps often borrowed from single-cell analysis, including normalisation, filtering and dimensionality reduction techniques. Dimensionality reduction, in particular, is a crucial step in analysing complex high-dimensional data, including single-cell and spatial transcriptomics, as several other downstream analysis steps rely on this (<xref ref-type="bibr" rid="R8">Huang et al., 2022</xref>; <xref ref-type="bibr" rid="R35">Wang et al., 2023</xref>; <xref ref-type="bibr" rid="R3">Cantini et al., 2021</xref>). For example, clustering of cells is typically performed using graph-based approaches on low-dimensional embeddings rather than the original gene expression matrix to avoid the curse of dimensionality. As such, effective and appropriate dimensionality reduction of spatial transcriptomics data is an important challenge in the analysis of these data.</p><p id="P3">Despite the rapidly accelerating generation of spatial transcriptomics data, it is not straightforward how to incorporate spatial coordinates and gene expression measurements to form a low-dimensional representation of the data. Popular dimensionality reduction approaches such as principal component analysis (PCA) do not utilise spatial coordinates; it focuses on finding orthogonal linear combinations of the gene expression data to preserve the largest amounts of their total variation. Other classical statistical approaches can be adapted to perform a “spatially-aware” dimensionality reduction, such as partial least squares (PLS) and linear discriminant analysis (LDA). PLS treats spatial coordinates in each dimension as separate responses, and may not be well suited to account for the complex spatial associations between the spatial coordinates and the gene expressions. LDA is sensitive to the arbitrary choice of allocation of the spatial coordinates into distinct classes. Given these challenges, new approaches have emerged that aim to integrate gene expression and spatial coordinates to arrive at meaningful dimensionality reduction. Some innovative approaches, such as GraphPCA (<xref ref-type="bibr" rid="R38">Yang et al., 2024</xref>), SpatialPCA (<xref ref-type="bibr" rid="R27">Shang and Zhou, 2022</xref>), MUS-TARD (<xref ref-type="bibr" rid="R42">Zhuang et al., 2024</xref>), and DR-SC (<xref ref-type="bibr" rid="R18">Liu et al., 2022</xref>), improve PCA by incorporating an additional step, such as augmenting the PCA objective function with a spatial penalty term, including a cell-cell kernel function, utilising experimental trajectory information, or incorporating PCA into a hierarchical model, respectively. Other approaches have adapted different modelling strategies, such as nonnegative matrix factorisation, to utilise spatial information (<xref ref-type="bibr" rid="R36">Wang et al., 2024</xref>; <xref ref-type="bibr" rid="R5">Georgaka et al., 2023</xref>; <xref ref-type="bibr" rid="R32">Townes and Engelhardt, 2022</xref>). In another line of research, several methods have utilised a dimensionality reduction step to cluster cells or spots in a “spatially-aware” manner, including STAMP (<xref ref-type="bibr" rid="R41">Zhong et al., 2024</xref>), stLearn (<xref ref-type="bibr" rid="R25">Pham et al., 2020</xref>), and FAST (<xref ref-type="bibr" rid="R19">Liu et al., 2023</xref>). Other approaches used bespoke techniques utilising deep learning to learn from spatial gene expression and images jointly (<xref ref-type="bibr" rid="R31">Tang et al., 2024</xref>), or exploited higher order interactions to identify clusters of interest (<xref ref-type="bibr" rid="R7">Haviv et al., 2024</xref>). Additionally, some methods are developed to utilise the spatial transcriptomic data as a reference to predict the latent spatial coordinates of scRNA-seq derived data, such as CellContrast (<xref ref-type="bibr" rid="R15">Li et al., 2023</xref>) and Tangram (<xref ref-type="bibr" rid="R2">Biancalani et al., 2021</xref>).</p><p id="P4">In statistics research, advances in sufficient dimension reduction (SDR) have emerged in the last few decades. SDR is a technique that enables dimensionality reduction of features so that the ability to predict the response variables is best preserved. Among SDR methods, sliced inverse regression (SIR), which was originally proposed in the seminal paper of <xref ref-type="bibr" rid="R12">Li (1991)</xref> is still the most popular due to its simplicity, flexibility, and computational efficiency (<xref ref-type="bibr" rid="R11">Li, 2018</xref>). Despite many developments of SIR to handle complex settings, to the best of our knowledge, SIR has not been adapted to be suitable for single-cell or spatial transcriptomics data. While several approaches have been developed for spatial dimensionality reduction, many are prohibitive in terms of computational scalability and runtime, and are limited in their ability to project new gene expression data into a low-dimensional space.</p><p id="P5">Given these challenges, we have developed <underline>w</underline>eighted <underline>S</underline>liced Inverse <underline>R</underline>egression (wSIR), a new statistical approach that performs SDR to preserve the association between the gene expressions and the spatial information. wSIR takes into account the slice-slice correlation induced from spatial transcriptomics data, and enables projection of non-spatial gene expression data into the low-dimensional spaces. Due to its linearity, wSIR is highly scalable and can be applied to massive single-cell spatial transcriptomics datasets across multiple distinct samples. In this paper, we describe the wSIR approach, explore its properties, and demonstrate its superior performance compared to other statistical methods. Furthermore, we will also employ wSIR to uncover additional insights from spatial transcriptomics data in two real biological contexts in human breast cancer and mouse development.</p></sec><sec id="S2" sec-type="results"><label>2</label><title>Results</title><sec id="S3"><label>2.1</label><title>Spatially-aware dimensionality reduction with weighted sliced inverse regression (wSIR)</title><p id="P6">Given the challenges in effectively describing spatial transcriptomics data, we developed a new linear sufficient dimension reduction approach named weighted sliced inverse regression (wSIR). Assuming a <italic>n</italic> × <italic>p</italic> gene expression matrix <bold>X</bold> with <italic>n</italic> samples and <italic>p</italic> features, and a corresponding <italic>n</italic> × <italic>q</italic> responses <bold>Y</bold>, sufficient dimension reduction is a class of statistical techniques that aims to estimate a <italic>d</italic> ≪ <italic>p</italic> vector-valued function of the data <italic>f</italic> (<bold>X</bold>) so that <bold>Y</bold> ⊥ <bold>X</bold> | <italic>f</italic> (<bold>X</bold>), that is, that <bold>Y</bold> and <bold>X</bold> are conditionally independent given the reduced data <italic>f</italic> (<bold>X</bold>). Sliced inverse regression (SIR), which was invented in <xref ref-type="bibr" rid="R12">Li (1991)</xref> is an example of linear sufficient dimension reduction, where <italic>f</italic> (<bold>X</bold>) is assumed to be a linear combination of the <bold>X</bold>, i.e <italic>f</italic> (<bold>X</bold>) = <bold>XB</bold> with <bold>B</bold> a <italic>p</italic> × <italic>d</italic> matrix. Under mild technical conditions, SIR has been shown to be a powerful technique in the area of linear SDR due to its ability to preserve complex and nonlinear patterns within the data (<xref ref-type="bibr" rid="R11">Li, 2018</xref>; <xref ref-type="bibr" rid="R17">Lin et al., 2019</xref>; <xref ref-type="bibr" rid="R6">Girard et al., 2022</xref>, among many others). One important challenge in implementing such an approach to spatial transcriptomics, however, is that SIR does not account for possible spatial relationships among the slices, prompting our development of a novel weight component to SIR to create wSIR (Methods).</p><p id="P7">Briefly, wSIR takes in spatial transcriptomics data with appropriately normalised, centred and scaled gene expression values, alongside spatial coordinates that can belong to one or more distinct tissues or samples (<xref ref-type="fig" rid="F1">Figure 1a</xref>). The observations within each sample are then grouped according to their proximity in physical space into distinct “slices”, alongside the corresponding gene expression data (<xref ref-type="fig" rid="F1">Figure 1b</xref>). Then, a slice-slice correlation matrix is estimated by taking into account the physical proximity of the centroids of each slice per sample (<xref ref-type="fig" rid="F1">Figure 1c</xref>, Methods), where the closer the two slices are, the higher the corresponding value in the correlation matrix. On each slice, gene expression values are averaged over each gene. Following this step, the slice-mean gene expression and slice-slice correlation matrix are subjected to an eigendecomposition to obtain the eigenvectors, which are finally multiplied by the inverse of the sample covariance matrix of the gene expression to the wSIR direction (loadings). A sample-level scores (embeddings) matrix is then formed by multiplying the original data by the loadings matrix, representing the low-dimensional embedding of the data (<xref ref-type="fig" rid="F1">Figure 1d</xref>). This procedure enables the projection of new, unseen, potentially non-spatial data to the same low-dimensional embedding via matrix multiplication. Overall, wSIR enables interpretation of important genes via examination of the loadings matrix, as well as further downstream analysis (such as clustering) on the spatial transcriptomic data, alongside mapping of non-spatial (e.g. scRNA-seq resolved) transcriptomic data to a spatially-informed low dimensional space.</p></sec><sec id="S4"><label>2.2</label><title>wSIR prioritises spatially relevant variation</title><p id="P8">To examine the properties of wSIR, we created a simple simulation containing features that were associated with spatial coordinates as well as features that were independent of spatial coordinates. We generated an input data matrix <bold>X</bold> containing <italic>p</italic> = 20 features and <italic>n</italic> = 500 samples, alongside <italic>q</italic> = 2-dimensional spatial coordinates in Cartesian space corresponding to a rough doughnut shape (<xref ref-type="fig" rid="F2">Figure 2a</xref>, left column, Methods). We split features so that some features were 1) uncorrelated with spatial coordinates, 2) some features were correlated with the radial position of the sample, and 3) some features were correlated with the angular position of the samples, all with varying degrees of total noise. We then performed other common approaches for supervised or unsupervised dimensionality reduction approaches, including GraphPCA (<xref ref-type="bibr" rid="R38">Yang et al., 2024</xref>), PLS, and PCA. We found that in this simulation, the corresponding scores generated by the first and second wSIR’s directions were highly correlated with the angle and radius, respectively, where in contrast, GraphPCA and PLS were only able to partially recover the spatial pattern. As expected, PCA did not capture the spatial pattern and rather captured the non-spatial variables that were simulated to have the highest amount of variation (<xref ref-type="fig" rid="F2">Figure 2a</xref>). Since the spatial patterns correspond to angle and radius, we conclude that wSIR is capable of prioritising the underlying linear signals in the gene expression data, which encode the non-linear relationship with the spatial positions of each cell.</p></sec><sec id="S5"><label>2.3</label><title>wSIR is robust to parameter choice</title><p id="P9">Next, we sought to examine the impact of the two main parameters in the wSIR algorithm on the performance of the corresponding low-dimensional embeddings. The main tuning parameters of interest are 1) the number of tiles to partition the spatial coordinates, and 2) Alpha (<italic>α</italic>), representing the scaling factor applied to the slice-slice correlation matrix (Methods). We note that for certain selections of these tuning parameters, the wSIR approach becomes equivalent to SIR (Alpha chosen as 0) and PCA (i.e. when the number of slices approaches the total number of observations in the dataset). For this exploration, we used two case study datasets from single-cell resolved transcriptomic technologies in mouse development and human breast cancer stemming from seqFISH and 10x Genomics’ Xenium platform respectively (<xref ref-type="bibr" rid="R20">Lohoff et al., 2021</xref>; <xref ref-type="bibr" rid="R9">Janesick et al., 2023</xref>) (Methods). For each combination of these tuning parameters, the quality of the low-dimensional embedding was measured by the bias-corrected distance correlation (BCDC, Methods) between it and the true spatial coordinates. The resulting heatmaps for each dataset (<xref ref-type="fig" rid="F2">Figure 2b-c</xref>) show that, overall, wSIR obtains a higher BCDC than SIR, and that a high value of BCDC is maintained for parameter choices deviating from the “optimal” choices. This indicates that the performance of wSIR is relatively robust to the choice of parameters, and that a selection of a sub-optimal combination of parameters is likely to still yield useful results.</p></sec><sec id="S6"><label>2.4</label><title>wSIR embeddings better preserve local and global cell-cell distances</title><p id="P10">Following our exploration of tuning parameter selection for wSIR, we examined the relative performance of wSIR compared to other dimensionality-reduction approaches used in single-cell and spatial transcriptomics analysis. Using the two case-study datasets (mouse development and human breast cancer), we performed a cross-validation study to compare the BCDC for PCA, GraphPCA, LDA, PLS, SIR (i.e. wSIR with Alpha = 0), and wSIR (Methods). In particular, we aimed to map <italic>non-spatial</italic> gene expression data to a spatially-informed low-dimensional embedding, so we only used spatial coordinates of the query cells to assess accuracy after projecting the cells. Given this aim, we compared wSIR with the methods that have abilities to project new gene expression data to such a low-dimensional embedding. As such, other spatially-aware dimensionality reduction approaches, such as SpatialPCA (<xref ref-type="bibr" rid="R27">Shang and Zhou, 2022</xref>), are not included in this comparison.</p><p id="P11">In the case of the mouse development, we performed cross-validation by selecting two of the three biological samples as reference and query, and repeating for each of the six combinations. For the human breast cancer data, we repeatedly randomly selected subsets of the cells to treat as reference and took the remainder of cells as query. Following this, we found that wSIR consistently resulted in higher BCDC values, indicating its ability to preserve spatially relevant patterns from gene expression data (<xref ref-type="fig" rid="F2">Figure 2d,e</xref>). When we examined an additional metric of neighbourhood preservation (Methods), by taking the Jaccard index of local neighbourhoods of cells according to physical space and the low-dimensional embeddings, we found that, overall, either wSIR or SIR were best able to faithfully recapitulate the local neighbourhoods of cells, especially as the sizes of neighbourhoods increased as a percentage of the test sets (<xref ref-type="fig" rid="F2">Figure 2f,g</xref>). Taken together, this cross-validation approach shows that wSIR has a superior performance in generating low-dimensional embeddings that faithfully recapture spatial proximities and patterns relative to other existing methods.</p></sec><sec id="S7"><label>2.5</label><title>Uncovering relevant spatial biology in embryonic development</title><p id="P12">To further investigate the ability of wSIR in uncovering relevant biological patterns, we performed an exploration of single-cell spatial transcriptomics data of early mouse development (<xref ref-type="bibr" rid="R20">Lohoff et al., 2021</xref>). This dataset contains 351 genes profiled across three biological replicates of sagittal sections of mouse embryos at the stage of early organogenesis, and was annotated with 23 distinct cell types across the entire body plan of the developing embryo. We applied wSIR to this dataset alongside PCA as a comparison (Methods), to generate low-dimensional embeddings for the spatially-resolved cells. We noticed that all cell types were distinguished with wSIR in a similar manner to PCA (<xref ref-type="fig" rid="F3">Figure 3a,b</xref>), but that there were additional subdivisions of cell types such as ‘Forebrain/Midbrain/Hindbrain’ and ‘Gut tube’ compared to PCA, illustrating that wSIR is able to subdivide heterogeneous cell types.</p><p id="P13">When examining the most relevant genes according to wSIR and PCA (Methods), we identified different sets of highly ranked genes, notably, we observed genes such as Hoxb9, Nepn and Meox1 as highly ranked for wSIR. According to visual inspection, these genes are extremely localised to anatomical sites such as the tail, trunk and developing spine, respectively (<xref ref-type="fig" rid="F3">Figure 3c</xref>). For the highly ranked genes in PCA, we did not observe such a marked pattern of localised expression. To examine this pattern further, we extracted the top 50 ranked genes according to wSIR and PCA, and performed functional enrichment analysis using GO terms. We found that the degree of significance for these terms were uncorrelated, and we noted relevant significant terms for wSIR including ‘pattern specification process’, ‘regionalization’, and ‘embryonic morphogenesis’, whereas the terms most significant for the PCA-ranked genes were related to epigenetic regulation and methylation enzymes and not cell type specific (<xref ref-type="fig" rid="F3">Figure 3d</xref>). This indicates that wSIR prioritises gene expression variability relevant to the formation of the body plan, most clearly belonging to the formation of the head-to-tail axis.</p><p id="P14">Following the wSIR analysis of all the cells belonging to the mouse development dataset, we focused on the cells belonging to the ‘Endothelium’ cell type as we noticed these cells were especially diverse according to the wSIR low dimensional embedding (<xref ref-type="fig" rid="F3">Figure 3e</xref>), with some cells appearing closer to ‘Cardiomyocytes’ and ‘Allantois’ in the UMAP representation. We subset the Endothelium cells and performed wSIR followed by graph-based clustering (<xref ref-type="fig" rid="F3">Figure 3f</xref>), resulting in four identified clusters. Visualising the original locations of these cells indicates that the clusters correspond to distinct anatomical regions, such as the posterior region which includes the allantois (cluster 1) and the endocardium (cluster 4) (<xref ref-type="fig" rid="F3">Figure 3g</xref>). Further examination of the marker genes associated with these clusters highlights the common expression of endothelial genes such as Cdh5, Plvap and Eng, alongside unique expression of the clusters. The posterior endothelial cluster expressed high levels of Plac1 and Tbx4, a T-box transcription factor, which plays an important role in vasculogensis within the developing allantois (<xref ref-type="bibr" rid="R22">Naiche and Papaioannou, 2003</xref>; <xref ref-type="bibr" rid="R21">Naiche et al., 2011</xref>). We also observed expression of Gata4, Gata5, and Gata6 in cluster 4 indicating the endocardium (<xref ref-type="bibr" rid="R33">Tremblay et al., 2018</xref>; <xref ref-type="bibr" rid="R26">Rivera-Feliciano et al., 2006</xref>) (<xref ref-type="fig" rid="F3">Figure 3h</xref>). Taken together, our exploration highlights the utility of wSIR in providing access to spatial information during dimensionality reduction. This enables researchers to: (1) identify gene sets with important spatial roles, such as those involved in axial patterning during mouse development, and (2) uncover spatially localised cellular subtypes, such as vascular endothelial subsets arising in distinct anatomical regions. These findings underscore the potential of wSIR as a powerful tool for integrating spatial context into high-dimensional analyses, offering new insights into the spatial organisation of cellular and molecular processes.</p></sec><sec id="S8"><label>2.6</label><title>Spatial prediction approaches are improved by using wSIR</title><p id="P15">Since we have shown wSIR’s ability to generate low-dimensional embeddings that are useful in uncovering spatial biology, we wondered if wSIR, as a linear dimensionality reduction approach, would be useful as an input into more complex modelling approaches. To examine this, we turned to a popular method, named Tangram (<xref ref-type="bibr" rid="R2">Biancalani et al., 2021</xref>), that uses deep learning to map single-cell gene expression data to spatial transcriptomics references. Tangram typically takes in a filtered gene expression matrix as input, and returns a prediction of physical locations of single cells. Using the mouse development dataset, we performed Tangram with four input types, 1) gene expression counts, 2) gene expression logcounts, 3) PCA scores, and 4) wSIR scores. To assess performance, we measured BCDC, mean-squared error, and computational runtime of the Tangram step. Overall, we found that using wSIR as the input to Tangram resulted in better performance in terms of a larger BCDC, smaller MSE, and shorter run time (<xref ref-type="fig" rid="F3">Figure 3i</xref>). Overall, this investigation indicates that wSIR is a useful initial analytical step prior to applying other bespoke analyses, and is versatile in the range of downstream applications that can be employed.</p></sec><sec id="S9"><label>2.7</label><title>Exploration of breast cancer spatial transcriptomics at spot- and single-cell level</title><p id="P16">Following our application of wSIR to single-cell spatial transcriptomics data, we wondered if wSIR would allow us to similarly interrogate spot-level spatial transcriptomics data to derive biologically relevant insights. The human breast cancer dataset stems from an experimental study where slices from the same tissue block were subjected also to spot-level spatial transcriptomics via the 10x Visium platform (<xref ref-type="bibr" rid="R9">Janesick et al., 2023</xref>). Using this spot-level data, we first subset genes to those also captured in the single-cell resolved Xenium data. We performed both wSIR and PCA, and found that we were able to recapitulate the diversity of tissue structure (<xref ref-type="fig" rid="F4">Figure 4a,b</xref>), in particular identifying regions belonging to the tumour invasive region (cluster 6) and DCIS (cluster 2) (<xref ref-type="fig" rid="F4">Figure 4c-e</xref>). Using the gene importance metric for wSIR and PCA (Methods), we found there was a low association between genes identified as strongly relevant by wSIR and PCA, such as MMP12 and OPRPN ranked most relevant by wSIR and PTGDS and SFRP4 ranked most relevant by PCA (<xref ref-type="fig" rid="F4">Figure 4f</xref>). We noted that some of the top-ranked wSIR genes were not necessarily the most prevalently expressed (<xref ref-type="fig" rid="F4">Figure 4g</xref>), for example, MMP12, a matrix metallopeptidase gene, appears to be expressed in distinct small regions of the Visium-resolved tissue, while PTGDS and SFRP4 are more prevalently expressed across the tissue. This suggests that wSIR may be able to prioritise spatial gene expression that is highly localised and potentially biologically relevant.</p><p id="P17">Our next question was whether we could successfully map single-cell resolved data to a low-dimensional embedding that is informed with spot-level spatial transcriptomics data. To do so, we took the Xenium-resolved human breast cancer cells, and projected the gene expression to the low dimensional space as estimated from the Visium data. We observed that the cell types as originally annotated (<xref ref-type="bibr" rid="R9">Janesick et al., 2023</xref>) were preserved among this projection (<xref ref-type="fig" rid="F4">Figure 4h</xref>). Interestingly, we noticed that a set of cells primarily annotated as ‘Macrophages 1’ appeared as a distinct group, and this was not the case for PCA. When we selected these cells and performed differential expression analysis, we observed that the cells were marked by genes including MMP12, CD68, APOC1 and FCER1G, indicating that these cells indeed correspond to a type of macrophage that may be involved in remodelling of the extracellular matrix (<xref ref-type="fig" rid="F4">Figure 4i</xref>). Since this gene expression data came from the Xenium platform, we were able to visualise their original locations (<xref ref-type="fig" rid="F4">Figure 4g</xref>). In doing so, we noted distinct positioning of these cells around some of the DCIS (as annotated in the original publication), suggesting a possible role of these cells in the progression into invasive tumours. Taken together, our in-depth case study of single-cell-resolved and spot-resolved human breast cancer spatial transcriptomics data encapsulates the ability of wSIR to uncover relevant signals for spatial cancer biology.</p></sec></sec><sec id="S10" sec-type="discussion"><label>3</label><title>Discussion</title><p id="P18">In this paper, we have introduced wSIR, an approach to perform spatially-aware dimensionality reduction of single-cell and spot-level spatial transcriptomics data. wSIR can handle multiple distinct biological samples, and enables mapping of non-spatial gene expression data to a low-dimensional embedding that is informed by spatial coordinates. We have implemented wSIR as an R package, with scalability due to efficient Rcpp implementation. We have shown relatively superior performance of wSIR compared to other dimensionality reduction approaches, and demonstrated wSIR’s applicability in two real-world biological contexts.</p><p id="P19">A current limitation of wSIR is that an initial step of feature selection is needed for very large datasets, e.g. whole transcriptome data. While there are works in statistics research on implementing sparsity to SIR via the Lasso (<xref ref-type="bibr" rid="R17">Lin et al., 2019</xref>), future work would focus on incorporating such regularisation approaches to the wSIR context in terms of both the slicing mechanisms for spatial transcriptomics data, and taking the slice-slice correlations into account. Adding further complexity to the modelling step could be met with a decrease in computational scalability, so future work would focus on ensuring that any algorithmic advance is not met with a large drop in computational efficiency.</p><p id="P20">A key advantage to wSIR is its ability to take into account multiple samples to generate a single low-dimensional loading and embedding. We currently do so by assuming that the slice-slice correlation of slices belonging to separate samples is zero. With the increase in throughput of spatial transcriptomics studies and inevitable rise in variety and complexity of the studies (<xref ref-type="bibr" rid="R34">Velten and Stegle, 2023</xref>), it is important to consider different levels of replication. For example, datasets can contain distinct spatial samples that are 2D slices from the same 3D tissue block across multiple individuals, and care will need to be taken to build an appropriate slice-slice correlation matrix in these situations. There are algorithms that computationally ‘register’ 2D samples into a 3D structure, but there is a potential circularity issue in using gene expression data to register spatial coordinates, then using spatial coordinates to reduce dimension of gene expression data. Future work could consider tackling these tasks jointly, potentially leading to more accurate results.</p><p id="P21">We envisage wSIR being used in a variety of contexts, especially as spatial transcriptomics data becomes more widespread. Effectively using spatial information is a challenge in contemporary spatial transcriptomics analyses, and simply using tools designed for scRNA-seq can hinder the ability to draw insight in terms of spatial biology. Therefore, we see the potential of wSIR to ensure that spatially relevant variation is not lost, and to enable more comprehensive understanding of spatial biology in several contexts.</p></sec><sec id="S11" sec-type="materials | methods"><label>4</label><title>Materials and Methods</title><p id="P22">Dimension reduction (DR) refers to statistical methods aiming to reduce the dimension, typically the number of columns, of a dataset to address the curse of dimensionality and remove noise from the data. Let <bold>X</bold> be an <italic>n</italic> × <italic>p</italic> matrix of gene expression features, where <italic>n</italic> is the number of observations (cells) and <italic>p</italic> is the number of genes, where <italic>p</italic> is typically large. Dimension reduction methods aim to find a low– dimensional score <italic>n</italic> × <italic>d</italic> matrix <bold>V</bold>, with <italic>d</italic> ≪ <italic>p</italic>, where different methods differ in what information of <bold>X</bold> (e.g total variances, graph structures) need to be retained as much as possible in <bold>V</bold>.</p><p id="P23">In our spatial transcriptomic context, in addition to <bold>X</bold>, we have an <italic>n</italic> × <italic>q</italic> matrix of response <bold>Y</bold> containing spatial coordinates of cells with <italic>q</italic> = 2 or <italic>q</italic> = 3. Therefore, we aim to find such a matrix <bold>V</bold> so that <bold>V</bold> preserves the ability of <bold>X</bold> to predict <bold>Y</bold> (<xref ref-type="bibr" rid="R11">Li, 2018</xref>), i.e <bold>Y</bold> ⊥ <bold>X</bold> | <bold>V</bold> with ⊥ denoting statistical independence and | denoting conditioning. This is precisely the aim of “sufficient dimension reduction”, which is an active research area that gains increasing popularity among practitioners. Among sufficient dimension reduction methods, SIR is the most widely used due to its generality, simplicity, and computational efficiency. Since its first introduction in <xref ref-type="bibr" rid="R12">Li (1991)</xref>, SIR has been adapted into many complex settings, including missing data (<xref ref-type="bibr" rid="R14">Li and Lu, 2008</xref>; <xref ref-type="bibr" rid="R37">Xiao and Zhang, 2022</xref>) and high-dimensional features with <italic>n</italic> ≪ <italic>p</italic> (<xref ref-type="bibr" rid="R17">Lin et al., 2019</xref>; <xref ref-type="bibr" rid="R15">Li et al., 2023</xref>). Nevertheless, most recent works on SIR assume a univariate response, i.e. <italic>q</italic> = 1. While a few works have extended SIR to the multivariate response settings (<xref ref-type="bibr" rid="R13">Li et al., 2003</xref>; <xref ref-type="bibr" rid="R4">Coudret et al., 2014</xref>), our paper is the first to propose SIR for responses with spatial coordinates.</p><p id="P24">Without the loss of generality, we assume each column of the feature matrix <bold>X</bold> is centered.</p><sec id="S12"><label>4.1</label><title>A brief review of sliced inverse regression</title><p id="P25">As a linear sufficient dimension reduction method, SIR assumes <bold>V</bold> = <bold>XB</bold> where <bold>B</bold> is a <italic>p</italic> × <italic>d</italic> loading matrix <bold>B</bold> such that <bold>Y</bold> ⊥ <bold>X</bold> | <bold>V</bold>. This conditional independence relationship is invariant for any rotation of <bold>V</bold> by an orthonormal <italic>d</italic> × <italic>d</italic> matrix <bold>C</bold>, i.e <bold>Y</bold> ⊥ <bold>X</bold> | <bold>V</bold> is equivalent to <bold>Y</bold> ⊥ <bold>X</bold> | (<bold>VC</bold>), so the loading matrix <bold>B</bold> is only identifiable up to rotation. Compared to non-linear sufficient dimension reduction methods, linear dimension reduction methods are more interpretable and scalable, and they enable a straightforward projection of a new dataset into the lower-dimensional space.</p><p id="P26">The basic algorithm for SIR is as follows. Let <inline-formula><mml:math id="M1"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>⊤</mml:mo></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> be the sample covariance matrix of the gene expression data and <inline-formula><mml:math id="M2"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> be the standardised covariates matrix. In the first step, all of the observations are allocated into one of the <italic>H</italic> slices, where each slice has observations with similar value for the response variables <italic>Y</italic>, where <italic>H</italic> is a pre-specified user input. Let <bold>z</bold><sub><italic>h</italic></sub> be a <italic>p</italic> × 1 column vector consisting of the average of all the standardised covariates within the <italic>h</italic>th slice for <italic>h</italic> = 1, …, <italic>H</italic>. In the second step, let <inline-formula><mml:math id="M3"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>z</mml:mi></mml:mstyle><mml:mi>h</mml:mi></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>z</mml:mi></mml:mstyle><mml:mi>h</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> be a sample covariance matrix of these sliced means, where <italic>n<sub>h</sub></italic> is the number of observations within the <italic>h</italic>th slice. Then, an eigendecomposition is performed on <bold>M</bold> to obtain its eigenvectors <bold>u</bold><sub>1</sub>, …, <bold>u</bold><sub><italic>d</italic></sub>, and each column of the final SIR estimates of the loading matrix <inline-formula><mml:math id="M4"><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is obtained as <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. We note that while any two eigenvectors <bold>u</bold><sub><italic>j</italic></sub> and <bold>u</bold><sub><italic>k</italic></sub> are orthogonal to each other for <italic>j ≠ k</italic>, the columns <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are not. The column space of <bold>B</bold> is finally estimated by the column space of <inline-formula><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p><p id="P27">There are two main challenges of adapting the above basic SIR algorithm to our settings with spatial coordinates responses. First, it is not clear how to form slices, second, each slice in our setting corresponds to one spatial location, so these slices are spatially correlated with each other. Nevertheless, in the basic SIR algorithm, this spatial information is ignored after the slices are formed. To overcome these challenges, we introduce a general weight matrix into the computation of the sample covariance matrix of the sliced mean, where the off-diagonal elements are explicitly used to account for the correlation among the slices.</p><sec id="S13"><title>Slicing methods for spatial coordinates responses</title><p id="P28">To form slices of the data with a multivariate response, for each sample, we assign cells to <italic>H</italic> = <italic>k</italic><sup>2</sup> tiles, where <italic>k</italic> is the number of slices representing the number of non-overlapping bins of equal length along each axis direction in the 2D coordinate. In general, the number of cells/spots within each slice should be large enough to benefit from the SIR mechanism, noting that in the extreme case, if each cell/spot is within its own slice then the approach is akin to PCA. While there are practical discussions around slicing in the SIR literature (<xref ref-type="bibr" rid="R6">Girard et al., 2022</xref>) and general heuristics can be followed (e.g. at least 25 cells), the number of slices is treated as a tuning parameter and a selection is made according to the largest cross-validated BCDC.</p></sec></sec><sec id="S14"><label>4.2</label><title>wSIR: Spatial weighting matrix to handle correlations among the slices</title><p id="P29">In the second step of the basic SIR algorithm, we can write the matrix <bold>M</bold> in the form <disp-formula id="FD1"><mml:math id="M9"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>H</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>H</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <bold>Z</bold><sub><italic>H</italic></sub> is the <italic>H</italic> × <italic>p</italic> matrix whose <italic>h</italic>th row is the vector of average of the standardised covariates and <italic>p<sub>h</sub></italic> = <italic>n<sub>h</sub></italic>/<italic>n</italic> for <italic>h</italic> = 1, …, <italic>H</italic>, and <italic>H</italic> is the number of tiles. Since the matrix D is diagonal, no correlation among the slices are accounted for in this computation of <bold>M</bold>. To allow for the correlation among the slices and preserve the proportion of observations within these slices, we propose to compute <bold>M</bold> to be <disp-formula id="FD2"><mml:math id="M10"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>H</mml:mi><mml:mo>⊤</mml:mo></mml:msubsup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>H</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <bold>W</bold> is a <italic>H</italic> × <italic>H</italic> correlation matrix, whose diagonal elements are one and off-diagonal elements are between 0 (inclusive) and 1. Since these tiles correspond to spatial locations, the higher proximity between two tiles, the more correlated they are. Hence, we construct the off-diagonal elements <italic>w<sub>ij</sub></italic> of <bold>W</bold> from the distance between the centroid of the <italic>i</italic>th and <italic>j</italic>th tile as follows.</p><p id="P30">Let <italic>S<sub>h</sub></italic> be the index set for the <italic>h</italic>th tile, i.e <italic>S<sub>h</sub></italic> = {<italic>i</italic> : <italic>ith</italic> observation belong to the <italic>h</italic>th tile} for <italic>h</italic> = 1, …, <italic>H</italic>. Then the spatial coordinates for the centroid of the <italic>h</italic>th tile is <disp-formula id="FD3"><mml:math id="M11"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mstyle><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P31">Therefore, the Euclidean distance between the centroid of the two tiles (<italic>i, j</italic>) is <inline-formula><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> for <italic>i, j</italic> = 1, …, <italic>H</italic>. We then compute <disp-formula id="FD4"><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>α</italic> &gt; 0 is another tuning parameter. This choice of <italic>w<sub>ij</sub></italic> in the equation above ensures that all the resulting <italic>w<sub>ij</sub></italic> are between 0 and 1, and a higher distance <italic>d<sub>ij</sub></italic> leads to a lower value for <italic>w<sub>ij</sub></italic> as desired. Furthermore, we include the <italic>α</italic> to ensure our resulting method can include the basic SIR as a special case; indeed the basic SIR that ignores all the correlations among the slices correspond to <italic>α</italic> = 0.</p><sec id="S15"><title>Selecting the number of wSIR directions</title><p id="P32">To select the number of directions <italic>d</italic> for the low-dimensional score, we employ a cumulative variance threshold when performing the eigendecomposition of the matrix <italic>M</italic>. Particularly, let <inline-formula><mml:math id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>…</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> be the eigenvalues of <bold>M</bold>, so each <inline-formula><mml:math id="M15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the variance of the score <bold>Z</bold><sub><italic>H</italic></sub><bold>u</bold><sub><italic>k</italic></sub>, for <italic>k</italic> = 1, …, <italic>p</italic>. We then choose an estimate <inline-formula><mml:math id="M16"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to be the minimum number of directions that explains a certain percentage of total variance across all the scores, i.e <disp-formula id="FD5"><mml:math id="M17"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P33">As a default, we look for the minimum number of directions that captures at least 99% of the variance, so <italic>C</italic> = 0.99. Otherwise, as often done in PCA, we can keep the number of wSIR directions to be 50, particularly when we use wSIR embeddings for other downstream analyses (such as clustering or prediction).</p></sec><sec id="S16"><title>Selecting tuning parameters for wSIR</title><p id="P34">For these other parameters in the wSIR algorithm, including the number of tiles <italic>H</italic> and the coefficient <italic>α</italic> in the computation of the weight matrix, we use a 10-fold cross-validation. Specifically, we split our data into a training set (<bold>X</bold><sub>train</sub>, <bold>Y</bold><sub>train</sub>) and a validation set (<bold>X</bold><sub>val</sub>, <bold>Y</bold><sub>val</sub>). For each potential candidate of <italic>H</italic> and <italic>α</italic>, we computed the corresponding wSIR loading <inline-formula><mml:math id="M18"><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> in the training data with the number of components being selected from the above cumulative variance threshold. Then, we computed the score on the test set <inline-formula><mml:math id="M19"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mtext>val</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mtext>val</mml:mtext></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula>, and we choose the combination of (<italic>H, α</italic>) that maximises the distance correlation between the two matrices <bold>Y</bold><sub>val</sub> and <bold>V</bold><sub>val</sub> (<xref ref-type="bibr" rid="R29">Székely et al., 2007</xref>). This distance correlation metric is widely used in the statistics literature to measure the dependence between two datasets, encompassing both linear and non-linear relationship among them (<xref ref-type="bibr" rid="R28">Sheng and Yin, 2016</xref>; <xref ref-type="bibr" rid="R23">Nghiem et al., 2022</xref>; <xref ref-type="bibr" rid="R40">Zeng et al., 2024</xref>). We outlined the computation of this metric below.</p></sec><sec id="S17"><title>Applying wSIR to multiple samples</title><p id="P35">When we use multiple samples in the training set for a dimension reduction procedure, we must account for possible differences between both the gene expression data and the spatial coordinate systems (e.g coordinate (0,0) in one sample may not correspond to coordinate (0,0) in another sample). These concerns can both be addressed by the weight matrix. In the weight matrix, a value of 0 corresponds to no spatial correlation between the tiles. For a pair of tiles from different samples, we set the corresponding entry in the weight matrix to 0.</p><p id="P36">The weight matrix has a dimension <inline-formula><mml:math id="M20"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>×</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, where <italic>S</italic> is the set of all samples, <italic>s</italic> is one of the samples, and <italic>H<sub>s</sub></italic> is the number of tiles in sample <italic>s</italic>. For any entry <italic>w<sub>ij</sub></italic> of the weight matrix <bold>W</bold>, it will take value 0 if tiles <italic>i</italic> and <italic>j</italic> come from different samples. If they are from the same sample, its value will be calculated in the usual way as if there was only one sample in the wSIR computation. As a result, we are not assuming any spatial correlation between tiles from different samples.</p></sec><sec id="S18"><title>Ranking variables by importance in wSIR</title><p id="P37">Following the fitting of wSIR, we examine the estimated loadings matrix <inline-formula><mml:math id="M21"><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to obtain a ranking of the variables that are most relevant in the dimensionality reduction. Recall that the matrix <bold>B</bold> is only identifiable up to an orthogonal rotation, but the ranking of variables within each column of <bold>B</bold> is generally not invariant to such a rotation. Hence, we remove the effect of rotations by computing the corresponding <italic>p</italic> × <italic>p</italic> projection matrix 𝒫(<bold>B</bold>) = <bold>B</bold>(<bold>B</bold><sup>⊤</sup><bold>B</bold>)<sup>−1</sup><bold>B</bold><sup>⊤</sup>. Then, a measure of importance for the <italic>j</italic>th gene expression feature is the corresponding diagonal element of <inline-formula><mml:math id="M22"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, i.e <inline-formula><mml:math id="M23"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>. The values of <italic>a<sub>j</sub></italic> range from 0 to 1, with <inline-formula><mml:math id="M24"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>; a higher value of <italic>a<sub>j</sub></italic> indicates the <italic>j</italic>th feature is more important. Intuitively, a high value of <italic>a<sub>j</sub></italic> indicates a relatively large loading of the <italic>j</italic>th gene expression feature in <italic>at least</italic> one of the <italic>d</italic> dimensions; a low value of <italic>a<sub>j</sub></italic> indicates the corresponding gene expression has a small loading in <italic>all</italic> dimensions. This measure of variable importance is commonly used in sufficient dimension reduction, see for example <xref ref-type="bibr" rid="R30">Tan et al. (2018)</xref>; <xref ref-type="bibr" rid="R24">Nghiem and Hui (2024)</xref>.</p><p id="P38">We then rank the variables in descending order according to these scores. The user may select a set number of top-ranked variables as relevant, e.g. the top 50 genes. We note that this approach to ranking variables is also applied to the loadings estimated using PCA.</p></sec><sec id="S19"><title>Projecting non-spatial data using wSIR</title><p id="P39">Since a fitted wSIR model only involves the feature-level information of spatial omics data, non-spatial data can be projected into the spatially-aware low-dimensional space as estimated from spatial data. This is done by employing the same projection as outlined in the subsection 4.2 below, but for centred and scaled non-spatial gene expression data, <inline-formula><mml:math id="M25"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mtext>val</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mtext>val</mml:mtext></mml:mrow></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula>.</p></sec></sec><sec id="S20"><label>4.3</label><title>Comparison with existing methods</title><p id="P40">We compare wSIR with PCA, LDA, PLS (<xref ref-type="bibr" rid="R1">Abdi, 2010</xref>), and GraphPCA (GPCA) (<xref ref-type="bibr" rid="R38">Yang et al., 2024</xref>). PCA forms the low-dimensional scores <bold>Z</bold> that preserve as much as total variability in <bold>X</bold>; as a common practice, we kept the number of PCs to be 50 (<xref ref-type="bibr" rid="R10">Kobak and Berens, 2019</xref>). For LDA, we create a categorical response variable with <italic>H</italic> categories, each corresponding to one slice. LDA finds <italic>H</italic> − 1 linear combinations of <bold>X</bold> that separate these categories. PLS finds the components that maximise the sample covariance between <bold>X</bold> and the spatial coordinates <bold>Y</bold>; we selected the number of low-dimensional components by cross-validation as implemented in the <monospace>plsr</monospace> function of the <monospace>pls</monospace> R package (<xref ref-type="bibr" rid="R16">Liland et al., 2024</xref>). GPCA is a regularised version of PCA; it aims to construct low-dimensional scores <bold>Z</bold> of <bold>X</bold> that minimise the reconstruction error while preserving the graph structures among the cells. GPCA requires an <italic>n</italic> × <italic>n</italic> cell-cell adjacency matrix, which is obtained from computing <italic>k</italic>-nearest neighbour graph on the spatial coordinates <bold>Y</bold>. As implemented in the <monospace>GraphPCA</monospace> Python package, the default choice is <italic>k</italic> = 5 for ST platform, and the regularisation parameter for the graph constraint is fixed at 0.5.</p></sec></sec><sec id="S21"><label>5</label><title>Datasets and case studies used in this study</title><sec id="S22"><label>5.1</label><title>Synthetic data</title><p id="P41">We generated a simulated dataset where we know the true low-dimensional spaces (ground-truth) and used them to demonstrate wSIR and compare it with other popular dimension reduction methods. Specifically, we generated the spatial coordinates <bold>Y</bold><sub><italic>i</italic></sub> = (<italic>Y</italic><sub><italic>i</italic>1</sub>, <italic>Y</italic><sub><italic>i</italic>2</sub>) from <italic>Y</italic><sub><italic>i</italic>1</sub> = <italic>R<sub>i</sub></italic> cos(<italic>θ<sub>i</sub></italic>) and <italic>Y</italic><sub><italic>i</italic>2</sub> = <italic>R<sub>i</sub></italic> sin(<italic>θ<sub>i</sub></italic>), where the radius <italic>R<sub>i</sub></italic> and <italic>θ<sub>i</sub></italic> are independently random numbers drawn from the Uniform(0.1, 1) distribution and the Uniform(−<italic>π, π</italic>) distribution for <italic>i</italic> = 1, …, <italic>n</italic>. The <italic>n</italic> × <italic>p</italic> gene expression feature matrix <bold>X</bold> is decomposed into three blocks <bold>X</bold> = [<bold>X</bold><sub>1</sub>, <bold>X</bold><sub>2</sub>, <bold>X</bold><sub>3</sub>], where <bold>X</bold><sub>1</sub> is an <italic>n</italic> × <italic>p</italic><sub>1</sub> matrix whose elements are independently generated from <italic>N</italic>(0, 5) distribution, <bold>X</bold><sub>2</sub> is an <italic>n</italic> × <italic>p</italic><sub>2</sub> matrix whose each element in the <italic>i</italic>th row are drawn from <italic>N</italic>(<italic>R<sub>i</sub></italic>, 0.5) distribution, and <bold>X</bold><sub>3</sub> is an <italic>n</italic> × <italic>p</italic><sub>3</sub> matrix whose each element in the <italic>i</italic>th row is independently drawn from <italic>N</italic>(<italic>θ<sub>i</sub></italic>, 0.5) distribution for <italic>i</italic> = 1, …, <italic>n</italic>. We set <italic>n</italic> = 1000, <italic>p</italic><sub>1</sub> = 10, <italic>p</italic><sub>2</sub> = <italic>p</italic><sub>3</sub> = 5, so <italic>p</italic> = <italic>p</italic><sub>1</sub> + <italic>p</italic><sub>2</sub> + <italic>p</italic><sub>3</sub> = 20. In this synthetic data, the ground-truth two-dimensional low-dimensional scores that fully capture the spatial information are <bold>V</bold> = (<bold>X</bold><sub>2</sub>, <bold>X</bold><sub>3</sub>) = <bold>XB</bold>, where <bold>B</bold> = [<bold>B</bold><sub>1</sub>, <bold>B</bold><sub>2</sub>] with <inline-formula><mml:math id="M26"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>⊤</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>1</mml:mn></mml:mstyle><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>⊤</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>⊤</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M27"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>1</mml:mn></mml:mstyle><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊤</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, where <bold>0</bold><sub><italic>k</italic></sub> and <bold>1</bold><sub><italic>q</italic></sub> denote a <italic>k</italic> × 1 and <italic>q</italic> × 1 vectors of zero and one, respectively. <xref ref-type="fig" rid="F2">Figure 2</xref> (panel a, first column) plots a generated sample of spatial coordinates (<italic>Y</italic><sub>1<italic>i</italic></sub>, <italic>Y</italic><sub>2<italic>i</italic></sub>), coloured by the magnitude of <italic>R<sub>i</sub></italic> (top) and <italic>θ<sub>i</sub></italic> (bottom) for <italic>i</italic> = 1, …, <italic>n</italic>.</p></sec><sec id="S23"><label>5.2</label><title>Human breast cancer dataset</title><p id="P42">We downloaded single-cell spatial transcriptomic data for human breast cancer from the 10x Genomics website (see Data Availability). We retained only spatial coordinates and gene expression belonging to replicate 1. We performed filtering of low-quality cells and filtering of lowly expressed genes, prior to performing a logcount normalisation on the retained cells. We used the cell annotation provided in the publication, resulting in a dataset with <italic>n</italic> = 163, 998 cells and <italic>p</italic> = 313 genes. To obtain PCA and wSIR results for this dataset, we performed PCA (50 PCs) using the <monospace>runPCA</monospace> function in the <monospace>scater</monospace> R package, and we performed wSIR with <italic>H</italic> = 30<sup>2</sup> tiles and<italic>α</italic> = 4. When comparing the performance of the wSIR with other methods in dimensionality reduction alone, (such as the results in <xref ref-type="fig" rid="F2">Figure 2</xref>), we used the proportion of explained variance threshold <italic>C</italic> = 0.99 to determine the number of wSIR dimensions. When wSIR low-dimensional embeddings were used for further downstream analyses, we kept the number of dimensions to be 50. To facilitate visualisation, for both PCA and wSIR, we performed UMAP using the <monospace>runUMAP</monospace> function in the <monospace>scater</monospace> R package. We identified the top 50 most relevant genes according to the procedure outlined above, and performed functional enrichment analysis using Gene Ontology (GO) using the <monospace>clusterProfiler</monospace> R package, retaining GO terms containing between 20 and 200 genes, and set all the genes appearing in the dataset as the gene universe. We performed differential expression analysis using the <monospace>findMarkers</monospace> function in the <monospace>scater</monospace> R package.</p><p id="P43">We also downloaded the corresponding spot-level 10x Genomics’ Visium dataset from the same website. We performed wSIR using the same parameters except with <italic>H</italic> = 20<sup>2</sup> tiles and a maximum of 30 directions. We projected the single-cell Xenium data into the Visium-resolved low-dimensional embedding using the <monospace>projectWSIR</monospace> function in our <monospace>wSIR</monospace> R package. We performed differential expression analysis of the macrophage subset using the <monospace>findMarkers</monospace> function in the <monospace>scater</monospace> R package.</p></sec><sec id="S24"><label>5.3</label><title>Mouse development dataset</title><p id="P44">We downloaded single-cell spatial transcriptomic data from a recent study of early organogenesis (<xref ref-type="bibr" rid="R20">Lohoff et al., 2021</xref>) using <monospace>MouseGastrulationData</monospace> Bioconductor package. This dataset comprises three biological replicates of sagittal sections of mouse embryos, totalling <italic>n</italic> = 57, 536 cells measured across <italic>p</italic> = 351 genes. We removed the gene <italic>Xist</italic> from further analysis, since the embryos are a mix of male and female, and filtered cells annotated as ‘Low quality’ as well as cells containing fewer than 10 counts and fewer than five unique genes. We performed normalisation using the <monospace>logNormCounts</monospace> function in the <monospace>scater</monospace> R package. We performed wSIR of the spatial gene expression using <italic>H</italic> = 30<sup>2</sup> slices, <italic>α</italic> = 4, where the number of dimensions were selected as in Section 5.2. Further visualisation using UMAP and GO enrichment testing was the same as for the human breast cancer data. For the endothelium data, we used the same wSIR parameters, and performed clustering of the cells using the <monospace>bluster</monospace> R package with infomap graph-based clustering.</p></sec></sec><sec id="S25"><label>6</label><title>Evaluation metrics</title><sec id="S26"><label>6.1</label><title>Distance correlation</title><p id="P45">First, we are interested in the overall association between the spatial coordinates and the low-dimensional scores, as measured by the bias-corrected distance correlation (BCDC). Given the spatial coordinates <bold>Y</bold> and a low-dimensional score matrix <bold>V</bold>, each with <italic>n</italic> rows, let <bold>Y</bold><sub><italic>i</italic></sub> and <bold>V</bold><sub><italic>i</italic></sub> be the <italic>i</italic>th row of <bold>Y</bold> and <bold>V</bold>, respectively. Let <italic>A<sub>ij</sub></italic> and <italic>B<sub>ij</sub></italic> be the pairwise distance between the <italic>i</italic>th and <italic>j</italic>th row of <bold>Y</bold> and <bold>V</bold>, i.e <italic>A<sub>ij</sub></italic> = ‖<bold>Y</bold><sub><italic>i</italic></sub> − <bold>Y</bold><sub><italic>j</italic></sub>‖ and <italic>B<sub>ij</sub></italic> = ‖<bold>V</bold><sub><italic>i</italic></sub> − <bold>V</bold><sub><italic>j</italic></sub>‖ for <italic>i, j</italic> = 1, …, <italic>n</italic>. The centred distances on <bold>Y</bold> are given by <disp-formula id="FD6"><mml:math id="M28"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> and similar definition holds for <inline-formula><mml:math id="M29"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Hence the bias-corrected distance correlation (BCDC) is defined to be <disp-formula id="FD7"><mml:math id="M30"><mml:mrow><mml:mtext>BCDC</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>dCov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mtext>dVar</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mtext>dVar</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> with the bias-corrected distance covariance <disp-formula id="FD8"><mml:math id="M31"><mml:mrow><mml:mtext>dCov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> and the bias-corrected distance variances dVar(<bold>Y</bold>) = dCov(<bold>Y, Y</bold>) and dVar(<bold>V</bold>) = dCov(<bold>V, V</bold>). A higher BCDC implies a strong association between <bold>Y</bold> and <bold>V</bold>, encompassing both linear and non-linear relationship.</p></sec><sec id="S27"><label>6.2</label><title>Average Jaccard coefficient</title><p id="P46">We also evaluate the performance of dimension reduction methods in how well they preserve the neighbourhood structure among the cells. Particularly, let <inline-formula><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the index set of the <italic>K</italic> nearest neighbours for the <italic>i</italic>th observation from the spatial coordinates matrix <bold>Y</bold>, i.e <disp-formula id="FD9"><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>among</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>the</mml:mtext><mml:mspace width="0.2em"/><mml:mi>K</mml:mi><mml:mtext>the</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>smallest</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>non-zero</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>number</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>of</mml:mtext><mml:mspace width="0.2em"/><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> and similar definition holds for <inline-formula><mml:math id="M34"><mml:mrow><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <italic>A<sub>ij</sub></italic> replaced by <italic>B<sub>ij</sub></italic>. The Jaccard index for the <italic>i</italic>th observations measures the similarity between the two above sets, i.e <disp-formula id="FD10"><mml:math id="M35"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∩</mml:mo></mml:mstyle><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∪</mml:mo></mml:mstyle><mml:msubsup><mml:mi>𝒩</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where ∩, ∪ denote the set intersection and union, respectively, and | · | measures the number of elements in the set. For each value of <italic>K</italic>, we compute the average Jaccard value <inline-formula><mml:math id="M36"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>; in our results, we select different values of <italic>K</italic> corresponding to (0.5, 1, 5, 10, 20)% the number of observations in a test set.</p></sec><sec id="S28"><label>6.3</label><title>As input to Tangram spatial mapping</title><p id="P47">We used Tangram, a deep learning model for alignment, to explore the applicability of wSIR dimensions in downstream analysis. Tangram maps a query <italic>n<sub>sc</sub></italic> × <italic>g</italic> single cell gene expression matrix to a reference <italic>n<sub>sp</sub></italic> × <italic>g</italic> spatial location gene expression matrix, where <italic>n<sub>sc</sub></italic>, <italic>n<sub>sp</sub></italic> and <italic>g</italic> are the number of single cells, the number of spatial spots, and genes used for training, respectively. This mapping is characterised by a <italic>n<sub>sp</sub></italic> × <italic>n<sub>sc</sub></italic> matrix <bold>Q</bold> where each entry <italic>q<sub>ij</sub></italic> is the probability that the <italic>i</italic>th single cell being in the <italic>j</italic>th spatial spot, so <inline-formula><mml:math id="M37"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> for <italic>i</italic> = 1, … <italic>n<sub>sc</sub></italic>. The mapping is performed iteratively under a minimising loss function, according to which the cosine similarity between the gene expressions of the mapped single cells and reference spatial data cells should be as high as possible. We applied Tangram to two embryo replicates from the mouse embryo dataset, by treating replicate 2 as the query single cell dataset, i.e <italic>n<sub>sc</sub></italic> = <italic>n</italic><sub>2</sub> and ignoring the spatial locations, and treating replicate 1 as the reference spatial dataset, i.e. <italic>n<sub>sp</sub></italic> = <italic>n</italic><sub>1</sub>, where <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub> are the number of cells on the replicates 1 and 2, respectively. To predict the location for the query single cell data, we adopted the approach used in <xref ref-type="bibr" rid="R15">Li et al. (2023)</xref>, which assigns the <italic>i</italic>th query single cell to the <italic>j</italic>th spatial location with the highest probability value. We applied this workflow to low-dimensional embeddings generated by wSIR obtained as outlined in Section 5.3 <inline-formula><mml:math id="M38"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, from which we predicted spatial coordinates for query single-cell samples (i.e. embryo 2), and compare the predicted coordinates with the actual spatial coordinates in that embryo. We compared the performance of this approach (wSIR + Tangram) versus (a) the same workflow with input being PCA scores of the same dimensions (PCA + Tangram), and (b) two naïve-Tangram analyses with raw (Count) and normalised (LogCount) gene expression (<italic>g</italic> = <italic>p</italic> = 351).</p></sec></sec></body><back><ack id="S29"><title>Acknowledgements</title><p>We thank our colleagues in the University of Sydney School of Mathematics and Statistics, Charles Perkins Centre, and Sydney Precision Data Science Centre for their support and intellectual engagement. The following sources of funding are gratefully acknowledged. S.G. was supported by an Australian Research Council DECRA Fellowship (DE220100964). P.P. was supported by the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation (2022-249319 to S.G.). L.T.G.H. was supported by a Wellcome Early-Career Award (226309/Z/22/Z). B.G. was supported by Wellcome (206328/Z/17/Z and 203151/Z/16/Z) and UKRI Medical Research Council (MC PC 17230). A.S. is supported by the generosity of Deborah and John McMurtrie and the Petre Foundation and grants from the Breast Cancer Research Foundation (BCRF-23-209), NHMRC (APP2018440) &amp; NBCF (IIRS-23-074). The funding sources mentioned above had no role in the study design; in the collection, analysis and interpretation of data, in the writing of the manuscript and in the decision to submit the manuscript for publication.</p></ack><sec id="S30" sec-type="data-availability"><title>Data Availability</title><p id="P48">This study used publicly available data. The mouse embryo seqFISH data was accesssed via Bioconductor (version 3.19) ExperimentHub package MouseGastrulationData (version 1.18.0). The breast cancer 10x Genomics Xenium data was accessed via the 10x Genomics website (<ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/products/xenium-in-situ/preview-dataset-human-breast">https://www.10xgenomics.com/products/xenium-in-situ/preview-dataset-human-breast</ext-link>) on 2 February 2024 and processed using <monospace>MoleculeExperiment</monospace> (version 1.5.1). The matching Visium data was accessed by the same website on 1 December 2024 and processed using <monospace>DropletUtils</monospace> (version 1.24.0).</p></sec><sec id="S31" sec-type="data-availability"><title>Code Availability</title><p id="P49">All analyses were performed in R (version 4.4.2). The wSIR software is available as an R package at <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/wSIR">https://github.com/SydneyBioX/wSIR</ext-link> and has been submitted to the Bioconductor Project. Scripts for analysis and figure panels in this manuscript are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/wSIR_2024">https://github.com/SydneyBioX/wSIR_2024</ext-link>.</p></sec><fn-group><fn fn-type="conflict" id="FN1"><p id="P50">The authors declare no competing interests.</p></fn><fn fn-type="con" id="FN2"><p id="P51"><bold>Author Contributions</bold></p><p id="P52">L.H.N. and S.G. conceived the study. M.W. developed the method and software and performed data analysis with supervision from L.H.N. and S.G.. P.P. performed the spatial mapping benchmarking. S.G. and L.T.G.H. interpreted the development results with input from B.G. J.M., H.Z. interpreted the breast cancer results with input from A.S. and S.G.. M.W., L.H.N. and S.G. wrote the manuscript. All authors read and approved the final version of the manuscript.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdi</surname><given-names>H</given-names></name></person-group><article-title>Partial least squares regression and projection on latent structure regression (pls regression)</article-title><source>Wiley interdisciplinary reviews: computational statistics</source><year>2010</year><volume>2</volume><issue>1</issue><fpage>97</fpage><lpage>106</lpage></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biancalani</surname><given-names>T</given-names></name><name><surname>Scalia</surname><given-names>G</given-names></name><name><surname>Buffoni</surname><given-names>L</given-names></name><name><surname>Avasthi</surname><given-names>R</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Sanger</surname><given-names>A</given-names></name><name><surname>Tokcan</surname><given-names>N</given-names></name><name><surname>Vanderburg</surname><given-names>CR</given-names></name><name><surname>Segerstolpe</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Avraham-Davidi</surname><given-names>I</given-names></name><etal/></person-group><article-title>Deep learning and alignment of spatially resolved single-cell transcriptomes with tangram</article-title><source>Nature Methods</source><year>2021</year><volume>18</volume><issue>11</issue><fpage>1352</fpage><lpage>1362</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01264-7</pub-id><pub-id pub-id-type="pmcid">PMC8566243</pub-id><pub-id pub-id-type="pmid">34711971</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cantini</surname><given-names>L</given-names></name><name><surname>Zakeri</surname><given-names>P</given-names></name><name><surname>Hernandez</surname><given-names>C</given-names></name><name><surname>Naldi</surname><given-names>A</given-names></name><name><surname>Thieffry</surname><given-names>D</given-names></name><name><surname>Remy</surname><given-names>E</given-names></name><name><surname>Baudot</surname><given-names>A</given-names></name></person-group><article-title>Bench-marking joint multi-omics dimensionality reduction approaches for the study of cancer</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><issue>1</issue><pub-id pub-id-type="doi">10.1038/s41467-020-20430-7</pub-id><pub-id pub-id-type="pmcid">PMC7785750</pub-id><pub-id pub-id-type="pmid">33402734</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coudret</surname><given-names>R</given-names></name><name><surname>Girard</surname><given-names>S</given-names></name><name><surname>Saracco</surname><given-names>J</given-names></name></person-group><article-title>A new sliced inverse regression method for multivariate response</article-title><source>Computational Statistics &amp; Data Analysis</source><year>2014</year><volume>77</volume><fpage>285</fpage><lpage>299</lpage></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgaka</surname><given-names>S</given-names></name><name><surname>Morgans</surname><given-names>WG</given-names></name><name><surname>Zhao</surname><given-names>Q</given-names></name><name><surname>Martinez</surname><given-names>DS</given-names></name><name><surname>Ali</surname><given-names>A</given-names></name><name><surname>Ghafoor</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>S-M</given-names></name><name><surname>Bristow</surname><given-names>R</given-names></name><name><surname>Iqbal</surname><given-names>M</given-names></name><name><surname>Rattray</surname><given-names>M</given-names></name></person-group><article-title>Cellpie: a scalable spatial transcriptomics factor discovery method via joint non-negative matrix factorization</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1093/nar/gkaf251</pub-id><pub-id pub-id-type="pmcid">PMC12086691</pub-id><pub-id pub-id-type="pmid">40167331</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Girard</surname><given-names>S</given-names></name><name><surname>Lorenzo</surname><given-names>H</given-names></name><name><surname>Saracco</surname><given-names>J</given-names></name></person-group><article-title>Advanced topics in sliced inverse regression</article-title><source>Journal of Multivariate Analysis</source><year>2022</year><volume>188</volume><elocation-id>104852</elocation-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haviv</surname><given-names>D</given-names></name><name><surname>Remšík</surname><given-names>J</given-names></name><name><surname>Gatie</surname><given-names>M</given-names></name><name><surname>Snopkowski</surname><given-names>C</given-names></name><name><surname>Takizawa</surname><given-names>M</given-names></name><name><surname>Pereira</surname><given-names>N</given-names></name><name><surname>Bashkin</surname><given-names>J</given-names></name><name><surname>Jovanovich</surname><given-names>S</given-names></name><name><surname>Nawy</surname><given-names>T</given-names></name><name><surname>Chaligne</surname><given-names>R</given-names></name><name><surname>Boire</surname><given-names>A</given-names></name><etal/></person-group><article-title>The covariance environment defines cellular niches for spatial inference</article-title><source>Nature Biotechnology</source><year>2024</year><pub-id pub-id-type="doi">10.1038/s41587-024-02193-4</pub-id><pub-id pub-id-type="pmcid">PMC11445396</pub-id><pub-id pub-id-type="pmid">38565973</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Rudin</surname><given-names>C</given-names></name><name><surname>Browne</surname><given-names>EP</given-names></name></person-group><article-title>Towards a comprehensive evaluation of dimension reduction methods for transcriptomic data visualization</article-title><source>Communications Biology</source><year>2022</year><volume>5</volume><issue>1</issue><pub-id pub-id-type="doi">10.1038/s42003-022-03628-x</pub-id><pub-id pub-id-type="pmcid">PMC9296444</pub-id><pub-id pub-id-type="pmid">35853932</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janesick</surname><given-names>A</given-names></name><name><surname>Shelansky</surname><given-names>R</given-names></name><name><surname>Gottscho</surname><given-names>AD</given-names></name><name><surname>Wagner</surname><given-names>F</given-names></name><name><surname>Williams</surname><given-names>SR</given-names></name><name><surname>Rouault</surname><given-names>M</given-names></name><name><surname>Beliakoff</surname><given-names>G</given-names></name><name><surname>Morrison</surname><given-names>CA</given-names></name><name><surname>Oliveira</surname><given-names>MF</given-names></name><name><surname>Sicherman</surname><given-names>JT</given-names></name><name><surname>Kohlway</surname><given-names>A</given-names></name><etal/></person-group><article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><pub-id pub-id-type="doi">10.1038/s41467-023-43458-x</pub-id><pub-id pub-id-type="pmcid">PMC10730913</pub-id><pub-id pub-id-type="pmid">38114474</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Berens</surname><given-names>P</given-names></name></person-group><article-title>The art of using t-sne for single-cell transcriptomics</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><elocation-id>5416</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-13056-x</pub-id><pub-id pub-id-type="pmcid">PMC6882829</pub-id><pub-id pub-id-type="pmid">31780648</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name></person-group><source>Sufficient dimension reduction: Methods and applications with R</source><publisher-name>Chapman and Hall/CRC</publisher-name><year>2018</year></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>K-C</given-names></name></person-group><article-title>Sliced inverse regression for dimension reduction</article-title><source>Journal of the American Statistical Association</source><year>1991</year><volume>86</volume><issue>414</issue><fpage>316</fpage><lpage>327</lpage></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>KC</given-names></name><name><surname>Aragon</surname><given-names>Y</given-names></name><name><surname>Shedden</surname><given-names>K</given-names></name><name><surname>Thomas Agnan</surname><given-names>C</given-names></name></person-group><article-title>Dimension reduction for multivariate response data</article-title><source>Journal of the American Statistical Association</source><year>2003</year><volume>98</volume><issue>461</issue><fpage>99</fpage><lpage>109</lpage></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Lu</surname><given-names>W</given-names></name></person-group><article-title>Sufficient dimension reduction with missing predictors</article-title><source>Journal of the American Statistical Association</source><year>2008</year><volume>103</volume><issue>482</issue><fpage>822</fpage><lpage>831</lpage></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Jia</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Luo</surname><given-names>R</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name></person-group><article-title>Cellcontrast: Reconstructing spatial relationships in single-cell rna sequencing data via deep contrastive learning</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1016/j.patter.2024.101022</pub-id><pub-id pub-id-type="pmcid">PMC11368686</pub-id><pub-id pub-id-type="pmid">39233694</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liland</surname><given-names>KH</given-names></name><name><surname>Mevik</surname><given-names>B-H</given-names></name><name><surname>Wehrens</surname><given-names>R</given-names></name></person-group><article-title>pls: Partial Least Squares and Principal Component Regression</article-title><source>R package version 2</source><year>2024</year><fpage>8</fpage><lpage>5</lpage></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Q</given-names></name><name><surname>Zhao</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>Sparse sliced inverse regression via lasso</article-title><source>Journal of the American Statistical Association</source><year>2019</year><volume>114</volume><issue>528</issue><fpage>1726</fpage><lpage>1739</lpage><pub-id pub-id-type="doi">10.1080/01621459.2018.1520115</pub-id><pub-id pub-id-type="pmcid">PMC7500493</pub-id><pub-id pub-id-type="pmid">32952234</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Liao</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name><name><surname>Yeong</surname><given-names>J</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Shi</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name></person-group><article-title>Joint dimension reduction and clustering analysis of single-cell rna-seq and spatial transcriptomics data</article-title><source>Nucleic Acids Research</source><year>2022</year><volume>50</volume><issue>12</issue><comment>e72-e72</comment><pub-id pub-id-type="doi">10.1093/nar/gkac219</pub-id><pub-id pub-id-type="pmcid">PMC9262606</pub-id><pub-id pub-id-type="pmid">35349708</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Chai</surname><given-names>X</given-names></name><name><surname>Fan</surname><given-names>Z</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Yeong</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name></person-group><article-title>Fast: a fast and scalable factor analysis for spatially aware dimension reduction of multi-section spatial transcriptomics data</article-title><source>bioRxiv</source><year>2023</year></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lohoff</surname><given-names>T</given-names></name><name><surname>Ghazanfar</surname><given-names>S</given-names></name><name><surname>Missarova</surname><given-names>A</given-names></name><name><surname>Koulena</surname><given-names>N</given-names></name><name><surname>Pierson</surname><given-names>N</given-names></name><name><surname>Griffiths</surname><given-names>JA</given-names></name><name><surname>Bardot</surname><given-names>ES</given-names></name><name><surname>Eng</surname><given-names>C-HL</given-names></name><name><surname>Tyser</surname><given-names>RCV</given-names></name><name><surname>Argelaguet</surname><given-names>R</given-names></name><name><surname>Guibentif</surname><given-names>C</given-names></name><etal/></person-group><article-title>Integration of spatial and single-cell transcriptomic data elucidates mouse organogenesis</article-title><source>Nature Biotechnology</source><year>2021</year><volume>40</volume><issue>1</issue><fpage>74</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1038/s41587-021-01006-2</pub-id><pub-id pub-id-type="pmcid">PMC8763645</pub-id><pub-id pub-id-type="pmid">34489600</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naiche</surname><given-names>L</given-names></name><name><surname>Arora</surname><given-names>R</given-names></name><name><surname>Kania</surname><given-names>A</given-names></name><name><surname>Lewandoski</surname><given-names>M</given-names></name><name><surname>Papaioannou</surname><given-names>VE</given-names></name></person-group><article-title>Identity and fate of tbx4-expressing cells reveal developmental cell fate decisions in the allantois, limb, and external genitalia</article-title><source>Developmental Dynamics</source><year>2011</year><volume>240</volume><issue>10</issue><fpage>2290</fpage><lpage>2300</lpage><pub-id pub-id-type="doi">10.1002/dvdy.22731</pub-id><pub-id pub-id-type="pmcid">PMC3180884</pub-id><pub-id pub-id-type="pmid">21932311</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naiche</surname><given-names>LA</given-names></name><name><surname>Papaioannou</surname><given-names>VE</given-names></name></person-group><article-title>Loss of tbx4 blocks hindlimb development and affects vascularization and fusion of the allantois</article-title><source>Development</source><year>2003</year><volume>130</volume><issue>12</issue><fpage>2681</fpage><lpage>2693</lpage><pub-id pub-id-type="pmid">12736212</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nghiem</surname><given-names>LH</given-names></name><name><surname>Hui</surname><given-names>FK</given-names></name><name><surname>Müller</surname><given-names>S</given-names></name><name><surname>Welsh</surname><given-names>A</given-names></name></person-group><article-title>Sparse sliced inverse regression via cholesky matrix penalization</article-title><source>Statistica Sinica</source><year>2022</year><volume>32</volume><fpage>2431</fpage><lpage>2453</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nghiem</surname><given-names>LH</given-names></name><name><surname>Hui</surname><given-names>FKC</given-names></name></person-group><article-title>Random effects model-based sufficient dimension reduction for independent clustered data</article-title><year>2024</year></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pham</surname><given-names>D</given-names></name><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Grice</surname><given-names>LF</given-names></name><name><surname>Lam</surname><given-names>PY</given-names></name><name><surname>Raghubar</surname><given-names>A</given-names></name><name><surname>Vukovic</surname><given-names>J</given-names></name><name><surname>Ruitenberg</surname><given-names>MJ</given-names></name><name><surname>Nguyen</surname><given-names>Q</given-names></name></person-group><article-title>stlearn: integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues</article-title><source>bioRxiv</source><year>2020</year></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivera-Feliciano</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>K-H</given-names></name><name><surname>Kong</surname><given-names>SW</given-names></name><name><surname>Rajagopal</surname><given-names>S</given-names></name><name><surname>Ma</surname><given-names>Q</given-names></name><name><surname>Springer</surname><given-names>Z</given-names></name><name><surname>Izumo</surname><given-names>S</given-names></name><name><surname>Tabin</surname><given-names>CJ</given-names></name><name><surname>Pu</surname><given-names>WT</given-names></name></person-group><article-title>Development of heart valves requiresgata4expression in endothelial-derived cells</article-title><source>Development</source><year>2006</year><volume>133</volume><issue>18</issue><fpage>3607</fpage><lpage>3618</lpage><pub-id pub-id-type="doi">10.1242/dev.02519</pub-id><pub-id pub-id-type="pmcid">PMC2735081</pub-id><pub-id pub-id-type="pmid">16914500</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shang</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group><article-title>Spatially aware dimension reduction for spatial transcriptomics</article-title><source>Nature Communications</source><year>2022</year><volume>13</volume><issue>1</issue><pub-id pub-id-type="doi">10.1038/s41467-022-34879-1</pub-id><pub-id pub-id-type="pmcid">PMC9684472</pub-id><pub-id pub-id-type="pmid">36418351</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheng</surname><given-names>W</given-names></name><name><surname>Yin</surname><given-names>X</given-names></name></person-group><article-title>Sufficient dimension reduction via distance covariance</article-title><source>Journal of Computational and Graphical Statistics</source><year>2016</year><volume>25</volume><issue>1</issue><fpage>91</fpage><lpage>104</lpage></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Székely</surname><given-names>GJ</given-names></name><name><surname>Rizzo</surname><given-names>ML</given-names></name><name><surname>Bakirov</surname><given-names>NK</given-names></name></person-group><article-title>Measuring and testing dependence by correlation of distances</article-title><source>The Annals of Statistics</source><year>2007</year><volume>35</volume><fpage>2769</fpage><lpage>2794</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>KM</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>H</given-names></name><name><surname>Cook</surname><given-names>RD</given-names></name></person-group><article-title>A convex formulation for high-dimensional sparse sliced inverse regression</article-title><source>Biometrika</source><year>2018</year><volume>105</volume><issue>4</issue><fpage>769</fpage><lpage>782</lpage></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Qian</surname><given-names>K</given-names></name><name><surname>Huang</surname><given-names>S</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Yin</surname><given-names>S</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Ye</surname><given-names>B</given-names></name><name><surname>Zhuang</surname><given-names>Y</given-names></name><name><surname>Meng</surname><given-names>H</given-names></name><name><surname>Xi</surname><given-names>JJ</given-names></name><etal/></person-group><article-title>Interpretable high-resolution dimension reduction of spatial transcriptomics data by spahdmap</article-title><source>bioRxiv</source><year>2024</year></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Townes</surname><given-names>FW</given-names></name><name><surname>Engelhardt</surname><given-names>BE</given-names></name></person-group><article-title>Nonnegative spatial factorization applied to spatial genomics</article-title><source>Nature Methods</source><year>2022</year><volume>20</volume><issue>2</issue><fpage>229</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01687-w</pub-id><pub-id pub-id-type="pmcid">PMC9911348</pub-id><pub-id pub-id-type="pmid">36587187</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname><given-names>M</given-names></name><name><surname>Sanchez-Ferras</surname><given-names>O</given-names></name><name><surname>Bouchard</surname><given-names>M</given-names></name></person-group><article-title>Gata transcription factors in development and disease</article-title><source>Development</source><year>2018</year><volume>145</volume><issue>20</issue><pub-id pub-id-type="pmid">30348673</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velten</surname><given-names>B</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name></person-group><article-title>Principles and challenges of modeling temporal and spatial omics data</article-title><source>Nature Methods</source><year>2023</year><volume>20</volume><issue>10</issue><fpage>1462</fpage><lpage>1474</lpage><pub-id pub-id-type="pmid">37710019</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Wu</surname><given-names>F</given-names></name><name><surname>Song</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name></person-group><article-title>Comparative analysis of dimension reduction methods for cytometry by time-of-flight data</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><pub-id pub-id-type="doi">10.1038/s41467-023-37478-w</pub-id><pub-id pub-id-type="pmcid">PMC10067013</pub-id><pub-id pub-id-type="pmid">37005472</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Woyshner</surname><given-names>K</given-names></name><name><surname>Sriworarat</surname><given-names>C</given-names></name><name><surname>Stein-O’Brien</surname><given-names>G</given-names></name><name><surname>Goff</surname><given-names>LA</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name></person-group><article-title>Multi-sample non-negative spatial factorization</article-title><source>bioRxiv</source><year>2024</year><pub-id pub-id-type="doi">10.1186/s13059-025-03601-x</pub-id><pub-id pub-id-type="pmcid">PMC12128389</pub-id><pub-id pub-id-type="pmid">40457480</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name></person-group><article-title>Dimension reduction for block-missing data based on sparse sliced inverse regression</article-title><source>Computational Statistics &amp; Data Analysis</source><year>2022</year><volume>167</volume><elocation-id>107348</elocation-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Zheng</surname><given-names>X</given-names></name></person-group><article-title>Graphpca: a fast and interpretable dimension reduction algorithm for spatial transcriptomics data</article-title><source>Genome Biology</source><year>2024</year><volume>25</volume><issue>1</issue><pub-id pub-id-type="doi">10.1186/s13059-024-03429-x</pub-id><pub-id pub-id-type="pmcid">PMC11545739</pub-id><pub-id pub-id-type="pmid">39511664</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>You</surname><given-names>Y</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Jia</surname><given-names>S</given-names></name><name><surname>Lu</surname><given-names>S</given-names></name><name><surname>Ren</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Jiang</surname><given-names>F</given-names></name><etal/></person-group><article-title>Systematic comparison of sequencing-based spatial transcriptomic methods</article-title><source>Nature Methods</source><year>2024</year><volume>21</volume><issue>9</issue><fpage>1743</fpage><lpage>1754</lpage><pub-id pub-id-type="doi">10.1038/s41592-024-02325-3</pub-id><pub-id pub-id-type="pmcid">PMC11399101</pub-id><pub-id pub-id-type="pmid">38965443</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>J</given-names></name><name><surname>Mai</surname><given-names>Q</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><article-title>Subspace estimation with automatic dimension and variable selection in sufficient dimension reduction</article-title><source>Journal of the American Statistical Association</source><year>2024</year><volume>119</volume><issue>545</issue><fpage>343</fpage><lpage>355</lpage></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhong</surname><given-names>C</given-names></name><name><surname>Ang</surname><given-names>KS</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><article-title>Interpretable spatially aware dimension reduction of spatial transcriptomics with stamp</article-title><source>Nature Methods</source><year>2024</year><volume>21</volume><issue>11</issue><fpage>2072</fpage><lpage>2083</lpage><pub-id pub-id-type="doi">10.1038/s41592-024-02463-8</pub-id><pub-id pub-id-type="pmcid">PMC11541207</pub-id><pub-id pub-id-type="pmid">39407016</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhuang</surname><given-names>H</given-names></name><name><surname>Gai</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>AR</given-names></name><name><surname>Hou</surname><given-names>W</given-names></name><name><surname>Ji</surname><given-names>Z</given-names></name><name><surname>Shi</surname><given-names>P</given-names></name></person-group><article-title>Trajectory-guided dimensionality reduction for multi-sample single-cell rna-seq data reveals biologically relevant sample-level heterogeneity</article-title><source>bioRxiv</source><year>2024</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Schematic of wSIR algorithm.</title><p><bold>a</bold>, wSIR requires an input of a set of 2D or 3D spatial coordinates for cell-resolved for spot-resolved spatial omics, alongside a normalised and centred gene expression matrix, potentially coming from multiple distinct samples. <bold>b</bold>, wSIR performs slicing of the spatial coordinates per sample, and groups cells/spots into slices according to their proximity in space. <bold>c</bold>, A slice-slice similarity matrix is created where entries correspond to the proximity of slice centroids in space. Slices belonging to different samples are assigned a value of zero, indicating no proximity. The corresponding sets of cells/spots are summarised by taking averages across all of the genes. <bold>d</bold>, wSIR then performs eigendecomposition of the slice-summarised gene expression data and slice-slice similarity. This provides three main outputs, 1. loadings, 2. scores for the input data, and 3. an ability to project new gene expression data into the same low-dimensional space. Overall, wSIR enables downstream analyses for biological discovery.</p></caption><graphic xlink:href="EMS207135-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comparison to other methods.</title><p><bold>a</bold>, Result of illustrative simulation where points are placed according to their simulated spatial position, and points are coloured according to the true simulated value (first column), subsequent columns are arranged according to: wSIR, GraphPCA, linear discriminant analysis (LDA), partial least squares (PLS), and PCA. The first row indicates the first direction or component selected for each method, and the second row indicates the second direction or component. <bold>b</bold>, Heatmap displaying the bias corrected distance correlation (BCDC) for the mouse embryo data with different choices of number of slices and slice-slice weighting alpha. <bold>c</bold>, similar to panel b but for the Xenium breast cancer dataset. <bold>d</bold>, Barplots displaying the BCDC of different dimension reduction (DR) methods for a leave-one-dataset-out evaluation of the three samples of the mouse embryo dataset. wSIR(0) indicates <italic>α</italic> = 0, equivalent to SIR. Error bars indicate bootstrap selection of the training set. <bold>e</bold>, Similar to panel d for Xenium breast cancer dataset. <bold>f</bold>, Line plots indicating the ability to preserve local neighbourhoods for each method, relative to PCA, using the same evaluation strategy as panel d. <bold>g</bold>, Similar to panel f for Xenium breast cancer dataset.</p></caption><graphic xlink:href="EMS207135-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Exploration of mouse development dataset and spatial mapping benchmark with Tangram.</title><p><bold>a</bold>, UMAP of seqFISH mouse development cells using wSIR, coloured by original cell type annotation. <bold>b</bold>, Same as panel a but using PCA as underlying dimension reduction approach. <bold>c</bold>, Spatial expression plots of top 5 genes according to wSIR (left column) and PCA (right column). <bold>d</bold>, Scatterplot displaying GO terms according to − log(p−value) for enrichment of top-ranked genes in PCA (x-axis) and in wSIR (y-axis), where the most significant terms are labelled. <bold>e</bold>, UMAP as in panel a highlighting cells belonging to Endothelium. <bold>f</bold>, UMAP of Endothelium cells using wSIR, coloured by clustering of these cells. <bold>g</bold>, Spatial plots of Endothelium cells coloured by clusters. <bold>h</bold>, Expression dotplot of Endothelium clusters, the first 15 genes correspond to markers of Endothelium, and other genes correspond to specific markers for the clusters. The size of each dot represents the proportion of detected expression, and the colour indicates the average expression level relative to each group. <bold>i</bold>, Tangram benchmarking with the mouse development dataset. Bars correspond to each dimension reduction (DR) method (x-axis), and y-axes correspond to bias-corrected distance correlation (BCDC, left panel), mean-squared error (MSE, middle panel), and running time for Tangram in seconds (right panel).</p></caption><graphic xlink:href="EMS207135-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Exploration of ductal breast cancer dataset.</title><p><bold>a</bold>, Spatial plot of breast cancer Visium data where spots are coloured according to clustering of the wSIR dimension reduction. <bold>b</bold>, Corresponding UMAP plot of Visium spots with spots coloured as in panel a. <bold>c</bold>, Spatial plot coloured by annotation from original publication. <bold>d</bold>, Corresponding UMAP plot with spots coloured as in panel c. <bold>e</bold>, Heatmap of tabulation of number of spots belonging to wSIR clusters and original annotation. <bold>f</bold>, Scatterplot of gene relevance of PCA (x-axis) and wSIR (y-axis), where higher values mean more relevant genes. <bold>h</bold>, Spatial expression plots of selected top-ranked genes according to wSIR (MMP12, OPRPN), both wSIR and PCA (POSTN), and only PCA (PTGDS, SFRP4). <bold>h</bold>, UMAP of breast cancer Xenium cells according to projection to the Visium-informed wSIR low dimensional embedding. Cells belonging to a distinct group made of majority Macrophages 1 are circled in black. <bold>i</bold>, Volcano plot displaying differential expression testing results of the set of cells selected in panel e. <bold>j</bold>, Spatial plot of Xenium cells that belong to the selected group, coloured in black, corresponding to a macrophage subcluster that localise around ducts and express MMP12.</p></caption><graphic xlink:href="EMS207135-f004"/></fig></floats-group></article>