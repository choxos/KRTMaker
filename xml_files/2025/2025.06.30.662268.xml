<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207078</article-id><article-id pub-id-type="doi">10.1101/2025.06.30.662268</article-id><article-id pub-id-type="archive">PPR1045603</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title><italic>DESpace2</italic>: detection of differential spatial patterns in spatial omics data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cai</surname><given-names>Peiying</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Robinson</surname><given-names>Mark D</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tiberi</surname><given-names>Simone</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><aff id="A1"><label>1</label>Department of Molecular Life Sciences and <institution-wrap><institution-id institution-id-type="ror">https://ror.org/002n09z45</institution-id><institution>Swiss Institute of Bioinformatics</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02crff812</institution-id><institution>University of Zurich</institution></institution-wrap>, <city>Zurich</city>, <country country="CH">Switzerland</country></aff><aff id="A2"><label>2</label>Department of Statistical Sciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01111rn36</institution-id><institution>University of Bologna</institution></institution-wrap>, <city>Bologna</city>, <country country="IT">Italy</country></aff></contrib-group><author-notes><corresp id="CR1">
<label>*</label><email>Simone.Tiberi@unibo.it</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>11</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>02</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Spatially resolved transcriptomics (SRT) enables the investigation of mRNA expression in a spatial context. While several SRT analysis frameworks have been developed, the vast majority of them focus on analyzing individual samples, and do not allow for comparisons of spatial gene expression patterns across experimental conditions, such as healthy <italic>vs</italic>. diseased states. Here, we present a novel approach to identify differential spatial patterns (DSP), i.e., genes that exhibit changes in spatial expression patterns between groups of samples across conditions. Our framework processes diverse SRT data types and detects DSP by performing differential gene expression testing across conditions. Notably, this comparison is not currently available in any other spatial omics method. In addition to detecting DSP across conditions, our framework includes two key features. First, it can identify tissue regions where expression changes across conditions. Second, it can detect spatial gene expression pattern changes across more than two experimental conditions, with flexible models. With <italic>ad hoc</italic> simulations, we demonstrate that our approach has good true positive rates and well-calibrated false discovery rates. Applied to experimental data, our method identifies biologically relevant DSP genes while maintaining computational efficiency. Our framework has been implemented within <italic>DESpace</italic> Bioconductor R package (from version 2.0.0).</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">Spatially resolved transcriptomics (SRT) technologies measure gene expression levels while preserving the tissue spatial context, within the local aggregate of multiple cells (termed spots), at the single-cell level, or even at subcellular level. This enables the investigation of spatial gene expression patterns [<xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R36">36</xref>,<xref ref-type="bibr" rid="R38">38</xref>], uncovers cellular heterogeneity [<xref ref-type="bibr" rid="R12">12</xref>], facilitates neighborhood analysis [<xref ref-type="bibr" rid="R9">9</xref>], enhances our understanding of disease mechanisms [<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R43">43</xref>], and even allows for RNA expression analysis at the subcellular level [<xref ref-type="bibr" rid="R4">4</xref>].</p><p id="P3">To fully leverage the potential of SRT data, several analytical methods have been developed. Among these, two standard steps are the identification of spatial domains (also known as spatial clustering), and the detection of spatially variable genes (SVGs). While single-cell RNA sequencing data allows for cell grouping based on transcriptional profiles, SRT data clustering integrates both mRNA information and spatial context to identify spatial regions of coherent gene expression within a tissue. To date, a wide range of spatially resolved clustering methods have been developed for this purpose, including <italic>BayesSpace</italic> [<xref ref-type="bibr" rid="R42">42</xref>], <italic>stLearn</italic> [<xref ref-type="bibr" rid="R23">23</xref>], <italic>Banksy</italic> [<xref ref-type="bibr" rid="R32">32</xref>], <italic>BASS</italic> [<xref ref-type="bibr" rid="R13">13</xref>], <italic>STAGATE</italic> [<xref ref-type="bibr" rid="R8">8</xref>], and <italic>GraphST</italic> [<xref ref-type="bibr" rid="R16">16</xref>]. These methods utilize diverse modeling strategies, such as graph-based deep learning [<xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R16">16</xref>] or Bayesian frameworks [<xref ref-type="bibr" rid="R13">13</xref>, <xref ref-type="bibr" rid="R42">42</xref>]. While most are designed for single-sample analysis, some can also perform joint clustering across multiple samples [<xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R32">32</xref>].</p><p id="P4">Methods for identifying highly variable genes (HVGs) and differentially expressed genes (DEGs), originally developed for bulk and single-cell transcriptomics, are commonly used for feature selection and cluster characterization [<xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R28">28</xref>]. However, these methods cannot explicitly incorporate spatial information. In contrast, SVGs methods [<xref ref-type="bibr" rid="R3">3</xref>, <xref ref-type="bibr" rid="R37">37</xref>, <xref ref-type="bibr" rid="R39">39</xref>] leverage spatial coordinates to identify genes with non-uniform expression patterns across the tissue. These spatially-aware approaches provide an alternative to traditional feature selection tools, and can help identify potentially biologically-informative genes for further experimental validation.</p><p id="P5">Most tools for SRT data can only work with individual samples; among the few exceptions, <italic>DESpace</italic> [<xref ref-type="bibr" rid="R3">3</xref>] supports biological replicates, while <italic>SPADE</italic> [<xref ref-type="bibr" rid="R26">26</xref>] allows comparisons between experimental conditions. Nonetheless, the original version of <italic>DESpace</italic> [<xref ref-type="bibr" rid="R3">3</xref>] does not compare groups of samples, while <italic>SPADE</italic> [<xref ref-type="bibr" rid="R26">26</xref>] is restricted to comparing two individual samples only, and has high computational demands, which makes it impractical for large-scale, multi-sample, multi-condition datasets. As a result, no method can currently compare, from SRT data, spatial patterns across groups of samples.</p><p id="P6">Here, we introduce a framework to compare spatial patterns from multi-sample, multi-condition SRT data, and identify so-called differential spatial pattern (DSP) genes, i.e., genes whose spatial expression profiles vary between two or more experimental conditions (<xref ref-type="fig" rid="F1">Figure 1</xref>). A DSP gene may, for example, be spatially variable (SV) in one condition but not in another one, or, alternatively, it may be SV in all conditions but with different spatial patterns. In contrast, genes with uniform abundance across space in all conditions, and SVGs with unchanged spatial structure between conditions, are not considered DSPs. Identifying DSP genes can provide valuable insight into how gene expression pattern vary across experimental conditions, facilitating the understanding of the underlying biological processes.</p></sec><sec id="S2" sec-type="materials | methods"><label>2</label><title>Materials and methods</title><sec id="S3"><label>2.1</label><title>Overview</title><p id="P7">To detect DSP genes, we expanded our previous framework, <italic>DESpace</italic> [<xref ref-type="bibr" rid="R3">3</xref>], which identifies SVGs using preannotated spatial clusters, and fits <italic>edgeR</italic> [<xref ref-type="bibr" rid="R28">28</xref>] negative binomial model to the mRNA abundance of each spot, either a single cell or a multi-cellular bin, with spatial clusters as covariates. In this work, we still employ the <italic>edgeR</italic> negative binomial model, but use a more complex design, that includes (at least) three covariate sets: spatial domains, conditions, and their interactions. These coefficients capture the average spatial structure of gene expression, condition-specific changes in abundance, and how spatial patterns change between conditions, respectively. To make comparisons between the gene expression spatial structures of multiple conditions (i.e., DSP), we test whether the interaction terms differ from zero via a likelihood ratio test.</p><p id="P8">Our two-step framework shares similarities with DEG and marker gene methods, that, although not originally designed for detecting DSP, can be adapted to perform that task. In particular, the <italic>spatialLIBD</italic> R package [<xref ref-type="bibr" rid="R22">22</xref>] computes pseudo-bulk counts in each spatial cluster (i.e., adding gene counts from all spots/cells in a cluster), and performs differential testing between clusters using <italic>limma</italic> [<xref ref-type="bibr" rid="R27">27</xref>], based on pairwise t-tests or ANOVA F-statistics. To detect DSP, the same strategy can be adapted by testing, in each individual cluster, for differences between experimental conditions, and aggregating results across all clusters (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>). Similarly, marker gene methods, such as <italic>scran</italic>’s <monospace>findMarkers</monospace> [<xref ref-type="bibr" rid="R18">18</xref>] and <italic>Seurat</italic> ‘s <monospace>FindMarkers</monospace> [<xref ref-type="bibr" rid="R30">30</xref>], designed to compare clusters in individual samples, can also be used to detect DSP by comparing groups of samples in individual clusters, and again aggregating results across clusters (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>). However, marker methods treat each spot as an independent replicate, neglecting the dependency between spots from the same sample, which makes them prone to inflated false positive rates [<xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R33">33</xref>, <xref ref-type="bibr" rid="R44">44</xref>].</p><p id="P9">Although our framework is conceptually related to marker gene methods and <italic>spatialLIBD</italic>, it has a key difference: rather than testing for changes within individual clusters individually (i.e., one test per cluster), we evaluate overall changes across all spatial clusters, capturing global spatial effects in a single test. In addition, our framework can also reveal the specific areas of the tissue affected by DSP, identifying the spatial pattern that displays the biggest difference between conditions. Furthermore, our tool can also compare more than two conditions, and the evolution of spatial patterns across time. Finally, because of its pseudo-bulk structure, our approach is computationally efficient and is thus compatible with any type of SRT data. As our current approach has been implemented within the pre-existing <italic>DESpace</italic> Bioconductor/R package (from version 2.0.0); below, we will refer to our DSP framework simply as <italic>DESpace2</italic>.</p></sec><sec id="S4"><label>2.2</label><title>Inference</title><p id="P10">Consider a SRT dataset with <italic>N</italic> total samples, collected under <italic>N</italic><sub><italic>c</italic></sub> experimental conditions, where each tissue section has been partitioned into <italic>D</italic> spatial domains, and where the <italic>d</italic>-th domain is associated to <italic>N</italic><sub><italic>d</italic></sub> spots. Within each sample, we sum the abundance of all spots belonging to a given domain to compute pseudo-bulk abundances, i.e., total abundance of a sample within a domain. For a given gene (index omitted for clarity), let <italic>X</italic><sub><italic>id</italic></sub> denote the pseudo-bulk abundance in sample <italic>i</italic> and domain <italic>d</italic>; we assume that <italic>X</italic><sub><italic>id</italic></sub> is a negative binomial random variable: <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>~</mml:mo><mml:mspace width="0.3em"/><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/></mml:mrow></mml:math></disp-formula> <disp-formula id="FD4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>NB</italic>(<italic>μ, ϕ</italic>) indicates a negative binomial distribution with mean <italic>μ</italic> and variance <italic>μ</italic>(1 + <italic>μϕ</italic>); <italic>ϕ</italic> is the gene-specific dispersion; <italic>M</italic><sub><italic>i</italic></sub> indicates the ‘effective’ library size, calculated as the total count multiplied by the trimmed mean of M values (TMM) normalization factor [<xref ref-type="bibr" rid="R29">29</xref>], for the <italic>i</italic>-th sample; <italic>β</italic><sub><italic>d</italic></sub> represents the coefficient for spatial domain <italic>d</italic>, <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the coefficient for condition <italic>c</italic><sub><italic>i</italic></sub> to which sample <italic>i</italic> belongs, and <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> captures the interaction between domain <italic>d</italic> and condition <italic>c</italic><sub><italic>i</italic></sub>.</p><p id="P11">We use a global test, to determine whether the spatial structure of gene expression varies between conditions; in particular, we test the following system of hypotheses via a likelihood ratio test (LRT) [<xref ref-type="bibr" rid="R41">41</xref>]: <disp-formula id="FD5"><label>(5)</label><mml:math id="M7"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> <disp-formula id="FD6"><label>(6)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="0.2em"/><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="0.2em"/></mml:mrow></mml:math></disp-formula></p><p id="P12">We also employ an individual-domain test to pinpoint the main DSP region, i.e., the domain where spatial patterns vary the most across conditions. To this aim, we use a LRT [<xref ref-type="bibr" rid="R41">41</xref>] to test the interaction terms of each spatial domain; e.g., for domain <italic>d</italic>, we test the following system of hypotheses: <disp-formula id="FD7"><label>(7)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD8"><label>(8)</label><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="0.2em"/><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="0.2em"/></mml:mrow></mml:math></disp-formula></p><p id="P13">In all analyses, model fitting and differential testing use <italic>edgeR</italic> [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R28">28</xref>], while Benjamini-Hochberg p-value correction [<xref ref-type="bibr" rid="R1">1</xref>] is applied to account for multiple testing, and control for the false discovery rate (FDR).</p></sec><sec id="S5"><label>2.3</label><title>Simulation studies - anchor data</title><p id="P14">To assess the performance of our approach, we designed benchmarks utilizing real and semi-simulated data, with all analyses based on one of two SRT datasets, referred to as <italic>LIBD</italic> [<xref ref-type="bibr" rid="R19">19</xref>], and <italic>ARTISTA</italic> [<xref ref-type="bibr" rid="R40">40</xref>].</p><p id="P15">The <italic>LIBD</italic> [<xref ref-type="bibr" rid="R19">19</xref>] dataset, obtained from the Visium platform [<xref ref-type="bibr" rid="R34">34</xref>], consists of 12 samples from three human brain donors. Pathologists manually annotated all samples, separating the tissue into white matter and up to six cortical layers (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). Each sample of this dataset contains, on average, 33,538 genes and 3,973 spots; after filtering (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>), we analyzed 14,628 genes across 3,936 spots (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). The number of genes shared across samples was 33,538 before filtering and 13,743 after filtering.</p><p id="P16">The <italic>ARTISTA</italic> [<xref ref-type="bibr" rid="R40">40</xref>] dataset, obtained from Stereo-seq [<xref ref-type="bibr" rid="R5">5</xref>] technology, captures axolotl telencephalon regeneration at single-cell resolution. The data aims to study brain healing after injury, and includes tissue samples from five distinct regeneration stages (i.e., days post-injury (DPI)), with three to four sections collected from each stage, resulting in 16 samples in total. In the absence of pre-annotated spatial patterns, we applied <italic>Banksy</italic> multisample clustering to group cells into five distinct spatial clusters, which are consistent across samples (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>). On average, each sample includes measurements for 27,077 genes across 9,389 cells (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). After filtering (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>), we retained 13,890 genes common to all samples and an average of 9,215 cells per sample.</p></sec><sec id="S6"><label>2.4</label><title>Simulation studies - SV profiles</title><p id="P17">In order to generate realistic data, we used the <italic>LIBD</italic> and <italic>ARTISTA</italic> datasets as anchors to generate several semi-simulated datasets. In each simulated dataset, we allocated replicate samples to two artificial conditions. Specifically, for the <italic>LIBD</italic> data, one group includes a slice from three samples, while the other condition includes a different slice from the same three donors. For the <italic>ARTISTA</italic> data, we used eight tissue sections from four regeneration stages (2, 5, 10, and 20 DPI), and randomly assigned one section of each stage to one condition, and used the remaining section for the other condition.</p><p id="P18">Using pre-annotated spatial domains (i.e., pathologist annotations for the <italic>LIBD</italic> data, and <italic>Bansky</italic> clusters for the <italic>ARTISTA</italic> data; see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 1-2</xref>), we generated a variety of spatial patterns by re-allocating real measurements across the tissue in different ways (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>). In particular, we obtained uniform as well as SV patterns that correspond to real structures, e.g., the brain cortex layers in the <italic>LIBD</italic> dataset. Uniform structures were generated by randomly permuting observation across the entire tissue, while spatial structures were created by randomly selecting a spatial domain to have higher (main text results) or lower (shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures</xref>) abundance compared to the rest of the tissue (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 3-4</xref>).</p><p id="P19">In this way, we generated four distinct scenarios - <italic>DSP1, DSP2, NULL1</italic>, and <italic>NULL2</italic> (<xref ref-type="fig" rid="F2">Figure 2</xref>) - and randomly assigned genes to each in equal proportions (25% per scenario). In the DSP scenarios, gene expression patterns differ between conditions: <italic>DSP1</italic> genes are highly (or lowly) abundant in a randomly selected spatial domain in one condition (selected at random), and have uniform expression in the other condition; <italic>DSP2</italic> genes are SVGs in both conditions but with different spatial expression structures in the two conditions (two distinct randomly selected spatial domains). In contrast, the NULL scenarios have identical spatial structures in both conditions: <italic>NULL1</italic> genes are spatially uniformly expressed in both conditions, while <italic>NULL2</italic> genes are SVGs sharing the same spatial pattern in both conditions (again, with a randomly selected spatial domain). The consistent spatial structure of <italic>NULL2</italic> genes in the same clusters across samples facilitates accurate detection of spatial domains when combining the four distinct scenarios.</p></sec></sec><sec id="S7" sec-type="results"><label>3</label><title>Results</title><sec id="S8"><label>3.1</label><title>Simulation studies - global test</title><p id="P20">In the <italic>LIBD</italic> and <italic>ARTISTA</italic> simulated dataset, we reestimated the spatial patterns via <italic>BayesSpace</italic> and <italic>Ban-sky</italic>, respectively (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>). In our benchmarks, all methods used these estimated clusters, and not the original domains used to generate the simulated data. The simulated data was analyzed via <italic>DESpace2</italic> (DSP functionality), <italic>scran</italic>’s <monospace>findMarkers</monospace> [<xref ref-type="bibr" rid="R18">18</xref>], <italic>Seurat</italic>’s <monospace>FindMarkers</monospace> [<xref ref-type="bibr" rid="R30">30</xref>] (both in the single-cell and pseudo-bulk version), and <italic>spatialLIBD’s wrapper</italic> [<xref ref-type="bibr" rid="R22">22</xref>]. Since no existing approach is specifically designed to detect changes in the spatial structure of gene expression, between groups of samples, we adapted these methods to identify DSP genes. We excluded <italic>SPADE</italic> [<xref ref-type="bibr" rid="R26">26</xref>] from our analyses because it is designed to only compare individual samples, and has an extreme computational cost: in our tests, it required approximately two hours to fit a single gene with approximately 4,000 spots.</p><p id="P21">The left panels of <xref ref-type="fig" rid="F3">Figure 3</xref> display the true positive rate (TPR) <italic>vs</italic>. false discovery rate (FDR) for all methods in our simulations, which include all four scenarios (i.e., <italic>DSP1, DSP2, NULL1</italic> and <italic>NULL2</italic>) combined. Overall, <italic>DESpace2</italic> controls the false discovery rate and offers great statistical power. <monospace>findMarkers</monospace> and <monospace>FindMarkers</monospace> also achieve a good TPR, but exhibit an inflated FDR, leading to a significant number of false discoveries. The inflation of false positives has been previously reported in the literature [<xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R33">33</xref>, <xref ref-type="bibr" rid="R44">44</xref>], and is possibly due to the fact that marker methods treat each cell/spot as an independent replicate, and neglect the dependency among cells/spots from the same sample. Conversely, pseudobulk-based <monospace>FindMarkers</monospace> and <italic>spatialLIBD</italic>, control the FDR, but have lower statistical power, possibly due to the fact that they compare pairs of clusters rather than jointly capturing global changes across all clusters, as <italic>DESpace2</italic> does.</p><p id="P22">We also studied the impact of clustering by comparing <italic>DESpace2</italic> results obtained on <italic>BayesSpace</italic>/<italic>Banksy</italic> clusters with those obtained using the original patterns the data was simulated from (i.e., the ground truth): we found that the noise arising from the estimated patterns have a small impact on results (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref>), likely because the recomputed clusters were very similar to the original annotation used in simulation.</p><p id="P23">Additionally, we investigated false positive rates; to this aim, we analyzed the distribution of raw p-values for NULL1 and NULL2 genes (i.e., genes with uniform expression or identical spatial patterns across conditions). In all scenarios, <italic>DESpace2</italic> shows no inflation of false positives, while all our competitors display inflated false positive rates (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>); this is likely because our competitors perform a test for each spatial pattern, and the global score is obtained as the minimum of the individual cluster p-values. Indeed, as expected, the individual-domain p-values are more conservative (see next Section).</p><p id="P24"><xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref> presents results from the simulation where the selected spatial domain has lower abundance compared to the rest of the tissue. Here, the spatial signal is diluted because the high abundance region (represented by <italic>D</italic> − 1 domains) is wide, and this makes DSP detection more complex. Results are similar to those shown above (with lower TPRs for all methods), and the ranking of methods is stable.</p></sec><sec id="S9"><label>3.2</label><title>Simulation studies - individual-domain</title><p id="P25">We also evaluated <italic>DESpace2</italic> ‘s ability to identify the domains where gene abundance varies across conditions. The individual-domain test requires at least three clusters (with two it is equivalent to the global test), and may be particularly useful when analyzing datasets with many clusters, as it may help biologists to focus on specific domains of interest.</p><p id="P26">To validate this framework, we considered the same simulation used in the global test above, and aimed to identify the main pattern that varies between conditions. <italic>DSP1</italic> genes are SV in one condition only: the key DSP cluster is the one selected to have higher (or lower) abundance in the SV condition. <italic>DSP2</italic> genes, genes are SVGs under both conditions, but with different spatial structures; in this case, we have two main DSP clusters are the two clusters with higher (or lower) abundance in each condition (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p><p id="P27">For each method, we tested all domains, and counted how often the most significant domain(s) corresponds to the main DSP cluster (for <italic>DSP1</italic> genes), or the main two DSP clusters (for <italic>DSP2</italic> genes). For <italic>DSP1</italic> genes, <italic>DESpace2</italic> identified the main DSP cluster in 98-100% of genes; <monospace>FindMarkers</monospace> and <monospace>findMarkers</monospace> lead to similar percentages, while <italic>pseudo-bulk</italic> <monospace>FindMarkers</monospace> and <italic>spatial-LIBD</italic> displayed lower accuracy. For <italic>DSP2</italic> genes, which generally yields higher scores than <italic>DSP1, DESpace2</italic> identified the two main DSP clusters in 100 (96.8) and 100 (98.4)% of genes in the <italic>LIBD</italic> and <italic>ARTISTA</italic> dataset, respectively, when the main clusters had higher (or lower) abundance, with competitors showing comparable performance (<xref ref-type="table" rid="T1">Table 1</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>). We also generated TPR <italic>vs</italic>. FDR plots (right panel of <xref ref-type="fig" rid="F3">Figure 3</xref>). In this case, in DSP genes all domains are DSP, even if most with minor changes between conditions. Therefore, in DSP genes, we only considered the main spatial clusters involved (i.e., the main cluster for <italic>DSP1</italic>, and main two for <italic>DSP2</italic>); instead, as controls we included all clusters from NULL patterns. Similarly to the global test, <italic>DESpace2</italic> has good FDR control, and higher TPR than competitors.</p><p id="P28">We also plotted the densities of NULL1 and NULL2 p-values (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 8-9</xref>): all methods provide approximately uniform (or slightly conservative) null p-values, except for <monospace>FindMarkers</monospace> and <monospace>findMarkers</monospace> where a general inflation towards 0 is observed, indicating increased false positive rates.</p><p id="P29">In the simulation where the main spatial domain is characterized by lower abundance (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>), results are similar, with lower statistical power for all methods given by the more subtle DSP structure (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref>).</p></sec><sec id="S10"><label>3.3</label><title>Applications to real data</title><p id="P30">We applied all methods to the original <italic>ARTISTA</italic> dataset, comparing two conditions (2 and 20 DPI), which are the earliest and latest time points to have replicates, and may possibly represent the most distinct two groups to analyze. Additionally, for <italic>DESpace2</italic> and <italic>SpatialLIBD</italic>, which both support comparisons across more than two conditions, we also included all five time points (2, 5, 10, 15, and 20 DPI), each with three or four samples (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). In absence of manually annotated clusters, spatial clusters were computed using <italic>Banksy</italic>, which was jointly applied to all 16 samples across five time points. For the two-group comparison, the data were then subset to 2 and 20 DPI, ensuring that both two- and five-group comparisons used the same spatial domain annotations and number of genes. After filtering (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Details</xref>), we analyzed 13,890 genes for both two- and five-group comparisons, respectively. For the two-condition analysis, <italic>DESpace2</italic> and <italic>spatialLIBD</italic> identified a similar number of significant genes (around 250), while <monospace>FindMarkers</monospace> and <monospace>findMarkers</monospace> reported over 7,800 significant genes, out of 13,890, which may reflect the inflation of false positives observed in simulation studies (<xref ref-type="table" rid="T2">Table 2</xref>).</p><p id="P31">Unlike simulations, real data does not have a ground truth; to overcome this, we generated two lists of potentially relevant genes by retrieving the gene sets “GOBP_WOUND_HEALING” and “GOBP_REGENERATION” from the Molecular Signatures Database (MSigDB v2024.1.Hs) [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R35">35</xref>]. We then calculated the top 200 (i.e., most significant) genes from each method, and counted how many of those appear in the two lists. Additionally, for each method, we computed the average ranking of the genes in the wound healing and regeneration lists, where a ranking of 1 indicates the most significant gene returned by a method. The top 200 genes from <italic>DESpace2</italic>, in both its 2-condition and 5-condition comparisons, contains more genes from the wound healing and regeneration lists than competitors; furthermore, those genes also have a smaller average ranking (i.e., more significant) (<xref ref-type="table" rid="T2">Table 2</xref>). We also applied <italic>DESpace2</italic> with a spline model to account for the effect of time (i.e., spline-based <italic>DESpace2</italic>), which, despite detecting fewer interesting genes among the top 200, achieves a better (lower) average ranking.</p><p id="P32">We also retrieved genes related to healing and regeneration using data from The Human Protein Atlas website [<xref ref-type="bibr" rid="R24">24</xref>]. The performance of methods is consistent, with <italic>DESpace2</italic> detecting either more or the same number of healing- and regeneration-related genes as competing methods, while ranking higher (i.e., with a lower average ranking) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>).</p><p id="P33">Finally, we investigated the computational efficiency of each method by measuring their runtime on the <italic>ARTISTA</italic> dataset (<xref ref-type="fig" rid="F4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 10</xref>). As expected, <italic>spatialLIBD, DESpace2</italic>, and pseudobulk-based <monospace>FindMarkers</monospace>, allow of which use pseudobulk counts, have a much lower runtime compared to <italic>scran</italic>’s <monospace>findMarkers</monospace> and spot-level <italic>Seurat</italic> ‘s <monospace>FindMarkers</monospace>, which use single spot/cell data. Notably, <italic>Seurat</italic> ‘s <monospace>FindMarkers</monospace> is substantially slower than <italic>scran</italic>’s <monospace>findMarkers</monospace>, as previosusly reported [<xref ref-type="bibr" rid="R25">25</xref>]. Importantly, for <italic>DESpace2</italic>, we report the costs for performing global test only (i.e., <italic>DESpace_global</italic> ; 14 seconds), and for running individual-pattern tests (i.e., <italic>DESpace_individual</italic> ; 38 seconds). Note that all methods in this analysis rely on precomputed spatial clusters. As such, we do not report for the computational cost of generating these domain annotations, and only consider the runtime of each method. The runtime of <italic>Bansky</italic> spatial clustering was 97 minutes for the 5-group comparison (16 samples).</p></sec></sec><sec id="S11" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P34">We presented a novel framework, based on spatial domains and DEG testing, to identify DSP genes, i.e., genes where spatial expression structures vary between groups of samples, which represents a type of analysis that is absent from the current spatial omics toolbox. We benchmarked our approach against diverse alternatives (e.g., adapting marker and DE methods) in <italic>ad hoc</italic> designed simulated and real data analyses, where our framework demonstrates good statistical power (i.e., TPR), controls for the FDR, and is computationally efficient. Our method can detect differences across the entire tissue (i.e., global test), or test each specific cluster (i.e., individual-pattern test), identifying the main region that varies across conditions. Our tool inputs flexible user-customizable design matrices; this allows users, for instance, to compare more than two conditions, and to model time courses (e.g., via splines). Our DSP framework is freely distributed within the <italic>DESpace</italic> Biocon-ductor R package, which simplifies its usage and integration with other pipelines, and is accompanied by an example usage DSP vignette and <italic>ad hoc</italic> plotting functions. Furthermore, our approach is flexible and can be applied to any spatial transcriptomics technology.</p><p id="P35">We also acknowledge some limitations of our work. Our approach relies on predefined spatial clusters, which is generally manageable in practice: spatial clustering is a standard step in spatial transcriptomics analysis, with over 50 spatial clustering methods developed since 2020 [<xref ref-type="bibr" rid="R21">21</xref>]. Importantly, because of this dependence, our method is more sensitive to detecting DSP genes whose expression aligns with the spatial patterns provided, having lower statistical power to detect genes that do not follow these structures (found to be more rare in previous research [<xref ref-type="bibr" rid="R3">3</xref>, <xref ref-type="bibr" rid="R39">39</xref>]). Additionally, domains that exclusively appear in one condition cannot be analyzed; nonetheless, these domains indicate a condition-specific region (i.e., present in some conditions and absent in others), rather than a DSP region.</p><p id="P36">In some cases, DSP could represent shifts in composition of the cell types within spatial clusters. Such changes may still be of direct interest, or could be adjusted for as covariates.</p><p id="P37">Overall, we believe that our novel DSP framework represents a useful instrument for investigating spatial omics data; additionally, it also represents an initial step for comparing groups of samples from SRT data, and may pave the road for other future methods in the field.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Information</label><media xlink:href="EMS207078-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d98aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgements</title><p>We thank Robinson lab members for helpful discussions and in particular David Wissel for discussions about smooth spline basis parameterizations.</p><sec id="S14"><title>Funding</title><p>MDR acknowledges support from the University Research Priority Program Evolution in Action at the University of Zurich, as well as the Swiss National Science Foundation (project grant 310030_204869).</p></sec></ack><sec id="S12" sec-type="data-availability"><title>Availability</title><p id="P38">Our DSP framework is freely implemented within <italic>DESpace</italic> Bioconductor R package (from version 2.0.0) at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/DESpace">https://bioconductor.org/packages/DESpace</ext-link>; the DSP vignette is titled “Differential Spatial Pattern between conditions”, and also includes examples where time points are compared via smooth splines. The scripts and data used for the analyses presented in this study are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/peicai/DESpace2_manuscript">https://github.com/peicai/DESpace2_manuscript</ext-link>) and Zenodo (DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.15744023">10.5281/zenodo.15744023</ext-link>), respectively. The <italic>LIBD</italic> [<xref ref-type="bibr" rid="R19">19</xref>] dataset was obtained from the <italic>spatialLIBD</italic> R Bioconductor package, and the original <italic>ARTISTA</italic> [<xref ref-type="bibr" rid="R40">40</xref>] dataset is available at <ext-link ext-link-type="uri" xlink:href="https://db.cngb.org/stomics/artista/download/">https://db.cngb.org/stomics/artista/download/</ext-link>. We created an ExperimentHub R Bioconductor package, called <italic>muSpaData</italic>, to store the processed version of the <italic>ARTISTA</italic> data, including the spatial clusters we computed via <italic>Bansky</italic>; the package is available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/muSpaData">https://bioconductor.org/packages/muSpaData</ext-link>.</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P39"><bold>Author contributions</bold></p><p id="P40">P.C. implemented the approach, conducted all analyses, and drafted the manuscript, contributing to the study design. M.D.R. assisted with study design and manuscript revision. S.T. conceived the method, led the study design and contributed to editing. All authors approve the article.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title><source>Journal of the Royal statistical society: series B (Methodological)</source><year>1995</year><volume>57</volume><issue>1</issue><fpage>289</fpage><lpage>300</lpage></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Kołodziejczyk</surname><given-names>AA</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Proserpio</surname><given-names>V</given-names></name><name><surname>Baying</surname><given-names>B</given-names></name><name><surname>Benes</surname><given-names>V</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><etal/></person-group><article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title><source>Nature methods</source><year>2013</year><volume>10</volume><issue>11</issue><fpage>1093</fpage><lpage>1095</lpage><pub-id pub-id-type="pmid">24056876</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>P</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Tiberi</surname><given-names>S</given-names></name></person-group><article-title>DESpace: spatially variable gene detection via differential expression testing of spatial clusters</article-title><source>Bioinformatics</source><year>2024</year><volume>40</volume><issue>2</issue><elocation-id>btae027</elocation-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btae027</pub-id><pub-id pub-id-type="pmcid">PMC10868334</pub-id><pub-id pub-id-type="pmid">38243704</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cassella</surname><given-names>L</given-names></name><name><surname>Ephrussi</surname><given-names>A</given-names></name></person-group><article-title>Subcellular spatial transcriptomics identifies three mechanistically different classes of localizing RNAs</article-title><source>Nature Communications</source><year>2022</year><volume>13</volume><issue>1</issue><elocation-id>6355</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-34004-2</pub-id><pub-id pub-id-type="pmcid">PMC9606379</pub-id><pub-id pub-id-type="pmid">36289223</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name><name><surname>Liao</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>M</given-names></name><name><surname>Ma</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Lai</surname><given-names>Y</given-names></name><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><etal/></person-group><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title><source>Cell</source><year>2022</year><volume>185</volume><issue>10</issue><fpage>1777</fpage><lpage>1792</lpage><pub-id pub-id-type="pmid">35512705</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W-T</given-names></name><name><surname>Lu</surname><given-names>A</given-names></name><name><surname>Craessaerts</surname><given-names>K</given-names></name><name><surname>Pavie</surname><given-names>B</given-names></name><name><surname>Frigerio</surname><given-names>CS</given-names></name><name><surname>Corthout</surname><given-names>N</given-names></name><name><surname>Qian</surname><given-names>X</given-names></name><name><surname>Laláková</surname><given-names>J</given-names></name><name><surname>Kühnemund</surname><given-names>M</given-names></name><name><surname>Voytyuk</surname><given-names>I</given-names></name><etal/></person-group><article-title>Spatial transcriptomics and in situ sequencing to study Alzheimer’s disease</article-title><source>Cell</source><year>2020</year><volume>182</volume><issue>4</issue><fpage>976</fpage><lpage>991</lpage><pub-id pub-id-type="pmid">32702314</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>From reads to genes to pathways: differential expression analysis of RNA-Seq experiments using Rsubread and the edgeR quasi-likelihood pipeline</article-title><source>F1000Research</source><year>2016</year><volume>5</volume><pub-id pub-id-type="doi">10.12688/f1000research.8987.2</pub-id><pub-id pub-id-type="pmcid">PMC4934518</pub-id><pub-id pub-id-type="pmid">27508061</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name></person-group><article-title>Deciphering spatial domains from spatially resolved transcriptomics with an adaptive graph attention auto-encoder</article-title><source>Nature communications</source><year>2022</year><volume>13</volume><issue>1</issue><elocation-id>1739</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-29439-6</pub-id><pub-id pub-id-type="pmcid">PMC8976049</pub-id><pub-id pub-id-type="pmid">35365632</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dries</surname><given-names>R</given-names></name><name><surname>Zhu</surname><given-names>Q</given-names></name><name><surname>Dong</surname><given-names>R</given-names></name><name><surname>Eng</surname><given-names>CHL</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Sarkar</surname><given-names>A</given-names></name><name><surname>Bao</surname><given-names>F</given-names></name><etal/></person-group><article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title><source>Genome biology</source><year>2021</year><volume>22</volume><fpage>1</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1186/s13059-021-02286-2</pub-id><pub-id pub-id-type="pmcid">PMC7938609</pub-id><pub-id pub-id-type="pmid">33685491</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fomitcheva-Khartchenko</surname><given-names>A</given-names></name><name><surname>Kashyap</surname><given-names>A</given-names></name><name><surname>Geiger</surname><given-names>T</given-names></name><name><surname>Kaigala</surname><given-names>GV</given-names></name></person-group><article-title>Space in cancer biology: its role and implications</article-title><source>Trends in Cancer</source><year>2022</year><volume>8</volume><issue>12</issue><fpage>1019</fpage><lpage>1032</lpage><pub-id pub-id-type="pmid">35995681</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Junttila</surname><given-names>S</given-names></name><name><surname>Smolander</surname><given-names>J</given-names></name><name><surname>Elo</surname><given-names>LL</given-names></name></person-group><article-title>Benchmarking methods for detecting differential states between conditions from multi-subject single-cell RNA-seq data</article-title><source>Briefings in bioinformatics</source><year>2022</year><volume>23</volume><issue>5</issue><elocation-id>bbac286</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbac286</pub-id><pub-id pub-id-type="pmcid">PMC9487674</pub-id><pub-id pub-id-type="pmid">35880426</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Liao</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Sun</surname><given-names>S</given-names></name><name><surname>Gao</surname><given-names>X</given-names></name></person-group><article-title>A comprehensive benchmarking with practical guidelines for cellular deconvolution of spatial transcriptomics</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>1548</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-37168-7</pub-id><pub-id pub-id-type="pmcid">PMC10027878</pub-id><pub-id pub-id-type="pmid">36941264</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group><article-title>BASS: multi-scale and multi-sample analysis enables accurate cell type clustering and spatial domain detection in spatial transcriptomic studies</article-title><source>Genome biology</source><year>2022</year><volume>23</volume><issue>1</issue><fpage>168</fpage><pub-id pub-id-type="doi">10.1186/s13059-022-02734-7</pub-id><pub-id pub-id-type="pmcid">PMC9351148</pub-id><pub-id pub-id-type="pmid">35927760</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Birger</surname><given-names>C</given-names></name><name><surname>Ghandi</surname><given-names>M</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name></person-group><article-title>The molecular signatures database hallmark gene set collection</article-title><source>Cell systems</source><year>2015</year><volume>1</volume><issue>6</issue><fpage>417</fpage><lpage>425</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id><pub-id pub-id-type="pmcid">PMC4707969</pub-id><pub-id pub-id-type="pmid">26771021</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Pinchback</surname><given-names>R</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>P</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><article-title>Molecular signatures database (msigdb) 3.0</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><issue>12</issue><fpage>1739</fpage><lpage>1740</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr260</pub-id><pub-id pub-id-type="pmcid">PMC3106198</pub-id><pub-id pub-id-type="pmid">21546393</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>Y</given-names></name><name><surname>Ang</surname><given-names>KS</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Chong</surname><given-names>KLK</given-names></name><name><surname>Sethi</surname><given-names>R</given-names></name><name><surname>Zhong</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Ong</surname><given-names>Z</given-names></name><name><surname>Sachaphibulkij</surname><given-names>K</given-names></name><name><surname>Chen</surname><given-names>A</given-names></name><etal/></person-group><article-title>Spatially informed clustering, integration, and deconvolution of spatial transcriptomics with GraphST</article-title><source>Nature Communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>1155</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-36796-3</pub-id><pub-id pub-id-type="pmcid">PMC9977836</pub-id><pub-id pub-id-type="pmid">36859400</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome biology</source><year>2014</year><volume>15</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><pub-id pub-id-type="pmcid">PMC4302049</pub-id><pub-id pub-id-type="pmid">25516281</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title><source>F1000Research</source><year>2016</year><volume>5</volume><elocation-id>2122</elocation-id><pub-id pub-id-type="doi">10.12688/f1000research.9501.2</pub-id><pub-id pub-id-type="pmcid">PMC5112579</pub-id><pub-id pub-id-type="pmid">27909575</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maynard</surname><given-names>KR</given-names></name><name><surname>Collado-Torres</surname><given-names>L</given-names></name><name><surname>Weber</surname><given-names>LM</given-names></name><name><surname>Uytingco</surname><given-names>C</given-names></name><name><surname>Barry</surname><given-names>BK</given-names></name><name><surname>Williams</surname><given-names>SR</given-names></name><name><surname>Catallini</surname><given-names>JL</given-names></name><name><surname>Tran</surname><given-names>MN</given-names></name><name><surname>Besich</surname><given-names>Z</given-names></name><name><surname>Tippani</surname><given-names>M</given-names></name><etal/></person-group><article-title>Transcriptome-scale spatial gene expression in the human dorsolateral pre-frontal cortex</article-title><source>Nature neuroscience</source><year>2021</year><volume>24</volume><issue>3</issue><fpage>425</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1038/s41593-020-00787-0</pub-id><pub-id pub-id-type="pmcid">PMC8095368</pub-id><pub-id pub-id-type="pmid">33558695</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title><source>Nucleic acids research</source><year>2012</year><volume>40</volume><issue>10</issue><fpage>4288</fpage><lpage>4297</lpage><pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id><pub-id pub-id-type="pmcid">PMC3378882</pub-id><pub-id pub-id-type="pmid">22287627</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moses</surname><given-names>L</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>Museum of spatial transcriptomics</article-title><source>Nature methods</source><year>2022</year><volume>19</volume><issue>5</issue><fpage>534</fpage><lpage>546</lpage><pub-id pub-id-type="pmid">35273392</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pardo</surname><given-names>B</given-names></name><name><surname>Spangler</surname><given-names>A</given-names></name><name><surname>Weber</surname><given-names>LM</given-names></name><name><surname>Page</surname><given-names>SC</given-names></name><name><surname>Hicks</surname><given-names>SC</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Martinowich</surname><given-names>K</given-names></name><name><surname>Maynard</surname><given-names>KR</given-names></name><name><surname>Collado-Torres</surname><given-names>L</given-names></name></person-group><article-title>spatialLIBD: an R/Bioconductor package to visualize spatially-resolved transcriptomics data</article-title><source>BMC genomics</source><year>2022</year><volume>23</volume><issue>1</issue><fpage>434</fpage><pub-id pub-id-type="doi">10.1186/s12864-022-08601-w</pub-id><pub-id pub-id-type="pmcid">PMC9188087</pub-id><pub-id pub-id-type="pmid">35689177</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pham</surname><given-names>D</given-names></name><name><surname>Tan</surname><given-names>X</given-names></name><name><surname>Balderson</surname><given-names>B</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Grice</surname><given-names>LF</given-names></name><name><surname>Yoon</surname><given-names>S</given-names></name><name><surname>Willis</surname><given-names>EF</given-names></name><name><surname>Tran</surname><given-names>M</given-names></name><name><surname>Lam</surname><given-names>PY</given-names></name><name><surname>Raghubar</surname><given-names>A</given-names></name><etal/></person-group><article-title>Robust mapping of spatiotemporal trajectories and cell–cell interactions in healthy and diseased tissues</article-title><source>Nature communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>7739</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-43120-6</pub-id><pub-id pub-id-type="pmcid">PMC10676408</pub-id><pub-id pub-id-type="pmid">38007580</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pontén</surname><given-names>F</given-names></name><name><surname>Jirström</surname><given-names>K</given-names></name><name><surname>Uhlen</surname><given-names>M</given-names></name></person-group><article-title>The Human Protein Atlas—a tool for pathology</article-title><source>The Journal of Pathology: A Journal of the Pathological Society of Great Britain and Ireland</source><year>2008</year><volume>216</volume><issue>4</issue><fpage>387</fpage><lpage>393</lpage></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pullin</surname><given-names>JM</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name></person-group><article-title>A comparison of marker gene selection methods for single-cell RNA sequencing data</article-title><source>Genome Biology</source><year>2024</year><volume>25</volume><issue>1</issue><fpage>56</fpage><pub-id pub-id-type="doi">10.1186/s13059-024-03183-0</pub-id><pub-id pub-id-type="pmcid">PMC10895860</pub-id><pub-id pub-id-type="pmid">38409056</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>F</given-names></name><name><surname>Luo</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>Q</given-names></name><name><surname>Cai</surname><given-names>B</given-names></name><name><surname>Xiao</surname><given-names>F</given-names></name><name><surname>Cai</surname><given-names>G</given-names></name></person-group><article-title>Spatial pattern and differential expression analysis with spatial transcriptomic data</article-title><source>Nucleic Acids Research</source><year>2024</year><volume>52</volume><issue>21</issue><elocation-id>e101</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkae962</pub-id><pub-id pub-id-type="pmcid">PMC11602167</pub-id><pub-id pub-id-type="pmid">39470725</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title><source>Nucleic acids research</source><year>2015</year><volume>43</volume><issue>7</issue><fpage>e47</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><pub-id pub-id-type="pmcid">PMC4402510</pub-id><pub-id pub-id-type="pmid">25605792</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title><source>bioinformatics</source><year>2010</year><volume>26</volume><issue>1</issue><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmcid">PMC2796818</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title><source>Genome biology</source><year>2010</year><volume>11</volume><issue>3</issue><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id><pub-id pub-id-type="pmcid">PMC2864565</pub-id><pub-id pub-id-type="pmid">20196867</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Farrell</surname><given-names>JA</given-names></name><name><surname>Gennert</surname><given-names>D</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nature biotechnology</source><year>2015</year><volume>33</volume><issue>5</issue><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id><pub-id pub-id-type="pmcid">PMC4430369</pub-id><pub-id pub-id-type="pmid">25867923</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shang</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group><article-title>Spatially aware dimension reduction for spatial transcriptomics</article-title><source>Nature communications</source><year>2022</year><volume>13</volume><issue>1</issue><elocation-id>7203</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-34879-1</pub-id><pub-id pub-id-type="pmcid">PMC9684472</pub-id><pub-id pub-id-type="pmid">36418351</pub-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singhal</surname><given-names>V</given-names></name><name><surname>Chou</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Yue</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Chock</surname><given-names>WK</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><name><surname>Chang</surname><given-names>YC</given-names></name><name><surname>Teo</surname><given-names>EML</given-names></name><name><surname>Aow</surname><given-names>J</given-names></name><etal/></person-group><article-title>BANKSY unifies cell typing and tissue domain segmentation for scalable spatial omics data analysis</article-title><source>Nature genetics</source><year>2024</year><volume>56</volume><issue>3</issue><fpage>431</fpage><lpage>441</lpage><pub-id pub-id-type="doi">10.1038/s41588-024-01664-3</pub-id><pub-id pub-id-type="pmcid">PMC10937399</pub-id><pub-id pub-id-type="pmid">38413725</pub-id></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Squair</surname><given-names>JW</given-names></name><name><surname>Gautier</surname><given-names>M</given-names></name><name><surname>Kathe</surname><given-names>C</given-names></name><name><surname>Anderson</surname><given-names>MA</given-names></name><name><surname>James</surname><given-names>ND</given-names></name><name><surname>Hutson</surname><given-names>TH</given-names></name><name><surname>Hudelle</surname><given-names>R</given-names></name><name><surname>Qaiser</surname><given-names>T</given-names></name><name><surname>Matson</surname><given-names>KJ</given-names></name><name><surname>Barraud</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Confronting false discoveries in single-cell differential expression</article-title><source>Nature communications</source><year>2021</year><volume>12</volume><issue>1</issue><elocation-id>5692</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-25960-2</pub-id><pub-id pub-id-type="pmcid">PMC8479118</pub-id><pub-id pub-id-type="pmid">34584091</pub-id></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ståhl</surname><given-names>PL</given-names></name><name><surname>Salmén</surname><given-names>F</given-names></name><name><surname>Vickovic</surname><given-names>S</given-names></name><name><surname>Lundmark</surname><given-names>A</given-names></name><name><surname>Navarro</surname><given-names>JF</given-names></name><name><surname>Magnusson</surname><given-names>J</given-names></name><name><surname>Giacomello</surname><given-names>S</given-names></name><name><surname>Asp</surname><given-names>M</given-names></name><name><surname>Westholm</surname><given-names>JO</given-names></name><name><surname>Huss</surname><given-names>M</given-names></name><etal/></person-group><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title><source>Science</source><year>2016</year><volume>353</volume><issue>6294</issue><fpage>78</fpage><lpage>82</lpage><pub-id pub-id-type="pmid">27365449</pub-id></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proceedings of the National Academy of Sciences</source><year>2005</year><volume>102</volume><issue>43</issue><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmcid">PMC1239896</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>S</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group><article-title>Statistical analysis of spatial expression patterns for spatially resolved transcriptomic studies</article-title><source>Nature methods</source><year>2020</year><volume>17</volume><issue>2</issue><fpage>193</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0701-7</pub-id><pub-id pub-id-type="pmcid">PMC7233129</pub-id><pub-id pub-id-type="pmid">31988518</pub-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name></person-group><article-title>SpatialDE: identification of spatially variable genes</article-title><source>Nature methods</source><year>2018</year><volume>15</volume><issue>5</issue><fpage>343</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id><pub-id pub-id-type="pmcid">PMC6350895</pub-id><pub-id pub-id-type="pmid">29553579</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name></person-group><article-title>The expanding vistas of spatial transcriptomics</article-title><source>Nature Biotechnology</source><year>2023</year><volume>41</volume><issue>6</issue><fpage>773</fpage><lpage>782</lpage><pub-id pub-id-type="doi">10.1038/s41587-022-01448-2</pub-id><pub-id pub-id-type="pmcid">PMC10091579</pub-id><pub-id pub-id-type="pmid">36192637</pub-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname><given-names>LM</given-names></name><name><surname>Saha</surname><given-names>A</given-names></name><name><surname>Datta</surname><given-names>A</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Hicks</surname><given-names>SC</given-names></name></person-group><article-title>nnSVG for the scalable identification of spatially variable genes using nearest-neighbor Gaussian processes</article-title><source>Nature communications</source><year>2023</year><volume>14</volume><issue>1</issue><elocation-id>4059</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-39748-z</pub-id><pub-id pub-id-type="pmcid">PMC10333391</pub-id><pub-id pub-id-type="pmid">37429865</pub-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>X</given-names></name><name><surname>Fu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Feng</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Zeng</surname><given-names>YY</given-names></name><name><surname>Cheng</surname><given-names>M</given-names></name><etal/></person-group><article-title>Single-cell Stereo-seq reveals induced progenitor cells involved in axolotl brain regeneration</article-title><source>Science</source><year>2022</year><volume>377</volume><issue>6610</issue><elocation-id>eabp9444</elocation-id><pub-id pub-id-type="pmid">36048929</pub-id></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilks</surname><given-names>SS</given-names></name></person-group><article-title>The large-sample distribution of the likelihood ratio for testing composite hypotheses</article-title><source>The annals of mathematical statistics</source><year>1938</year><volume>9</volume><issue>1</issue><fpage>60</fpage><lpage>62</lpage></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>E</given-names></name><name><surname>Stone</surname><given-names>MR</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Guenthoer</surname><given-names>J</given-names></name><name><surname>Smythe</surname><given-names>KS</given-names></name><name><surname>Pulliam</surname><given-names>T</given-names></name><name><surname>Williams</surname><given-names>SR</given-names></name><name><surname>Uytingco</surname><given-names>CR</given-names></name><name><surname>Taylor</surname><given-names>SE</given-names></name><name><surname>Nghiem</surname><given-names>P</given-names></name><etal/></person-group><article-title>Spatial transcriptomics at subspot resolution with BayesSpace</article-title><source>Nature biotechnology</source><year>2021</year><volume>39</volume><issue>11</issue><fpage>1375</fpage><lpage>1384</lpage><pub-id pub-id-type="doi">10.1038/s41587-021-00935-2</pub-id><pub-id pub-id-type="pmcid">PMC8763026</pub-id><pub-id pub-id-type="pmid">34083791</pub-id></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>Spatial transcriptomics in development and disease</article-title><source>Molecular Biomedicine</source><year>2023</year><volume>4</volume><issue>1</issue><fpage>32</fpage><pub-id pub-id-type="doi">10.1186/s43556-023-00144-0</pub-id><pub-id pub-id-type="pmcid">PMC10560656</pub-id><pub-id pub-id-type="pmid">37806992</pub-id></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimmerman</surname><given-names>KD</given-names></name><name><surname>Espeland</surname><given-names>MA</given-names></name><name><surname>Langefeld</surname><given-names>CD</given-names></name></person-group><article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title><source>Nature communications</source><year>2021</year><volume>12</volume><issue>1</issue><fpage>738</fpage><pub-id pub-id-type="doi">10.1038/s41467-021-21038-1</pub-id><pub-id pub-id-type="pmcid">PMC7854630</pub-id><pub-id pub-id-type="pmid">33531494</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>Overview of the <italic>DESpace2</italic> framework for DSP analysis. Given spatial transcriptomics data and spatial domain annotations, the workflow first performs pseudo-bulking and then conducts differential expression analyses across multiple samples and experimental conditions to identify DSP genes.</p></caption><graphic xlink:href="EMS207078-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Simulation design of the four simulated categories: <italic>DSP1, DSP2, NULL1</italic>, and <italic>NULL2</italic> using the <italic>ARTISTA</italic> dataset. The first column shows <italic>Banksy</italic> spatial domains, and the next four columns present example of simulations for each category. Two rows correspond to different conditions.</p></caption><graphic xlink:href="EMS207078-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>TPR <italic>vs</italic>. FDR for DSP gene detections in our simulations. Top and bottom rows refer to the <italic>LIBD</italic> and <italic>ARTISTA</italic> data, respectively, while left and right columns indicate the global and individual-domain tests, respectively.</p></caption><graphic xlink:href="EMS207078-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Runtime (in seconds) for each method on the <italic>ARTISTA</italic> dataset using a 2-condition comparison (2 and 20 days post-injury) across six samples.</p></caption><graphic xlink:href="EMS207078-f004"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><p>Individual cluster results. Percentage of times the method identified the main SV cluster in <italic>DSP1</italic> and when the top two detected domains both corresponded to the main SV clusters in <italic>DSP2</italic>, using <italic>BayesSpace</italic> for <italic>LIBD</italic> and <italic>Banksy</italic> for <italic>ARTISTA</italic>.</p></caption><table frame="box" rules="cols"><thead><tr><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid"/><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">Method</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>LIBD</italic></th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000"><italic>ARTISTA</italic></th></tr></thead><tbody><tr><td valign="middle" align="center" rowspan="5" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DSP1</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">98.1</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">99.3</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000"><italic>Seurat</italic>’s <monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-left: 1px solid">94.4</td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-right: 1px solid">98.8</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000"><italic>scran</italic>’s <monospace>findMarkers</monospace></td><td valign="middle" align="center" style="border-left: 1px solid">94.1</td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-right: 1px solid">98.8</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid">pseudobulk-based<break/><monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-left:solid 1px #000000">85.3</td><td valign="middle" align="center" style="border-left:solid 1px #000000;border-right:solid 1px #000000">88.9</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000"><italic>spatialLIBD</italic></td><td valign="middle" align="center" style="border-left: 1px solid">71.5</td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-right: 1px solid">80.4</td></tr><tr><td valign="middle" align="center" rowspan="5" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><italic>DSP2</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">100</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">100</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000"><italic>Seurat</italic>’s <monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-left: 1px solid">99.7</td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-right: 1px solid">100</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000"><italic>scran</italic>’s <monospace>findMarkers</monospace></td><td valign="middle" align="center" style="border-left: 1px solid #000000">99.7</td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-right: 1px solid #000000">100</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid">pseudobulk-based<break/><monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-left:solid 1px #000000">99.6</td><td valign="middle" align="center" style="border-left:solid 1px #000000;border-right:solid 1px #000000">99.6</td></tr><tr><td valign="middle" align="center" style="border-left: 1px solid #000000;border-bottom: 1px solid #000000"><italic>spatialLIBD</italic></td><td valign="middle" align="center" style="border-left: 1px solid #000000;border-bottom: 1px solid">96.2</td><td valign="middle" align="center" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid">99.7</td></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><p>Summary of genes detected by each method in the <italic>ARTISTA</italic> dataset. The table shows the number of genes detected, among the top 200 results returned by each method. Gene sets were retrieved from the Molecular Signatures Database (MSigDB v2024.1.Hs) for the following keywords: “Wound healing” and “Regeneration”. These sets include 434 and 203 genes, respectively, of which 127 and 257 were present in our dataset. “Overall” represents the union of both sets (603 genes total; 366 retained). The table also reports the average ranking of the genes in each list (lower values indicate higher significance), and the total number of genes called significant by each method.</p></caption><table frame="box" rules="rows"><thead><tr><th valign="middle" align="center" rowspan="2" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Method</th><th valign="middle" align="center" colspan="3" style="border-top: 1px solid #000000;border-left: 1px solid">Identified in top 200</th><th valign="middle" align="center" colspan="2" style="border-top: 1px solid #000000;border-left: 1px solid">Average ranking</th><th valign="middle" align="center" rowspan="2" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">#of<break/>genes</th></tr><tr><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">Regeneration</th><th valign="middle" align="center" style="border-top: 1px solid">Wound healing</th><th valign="middle" align="center" style="border-top: 1px solid">Overall</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">Regeneration</th><th valign="middle" align="center" style="border-top: 1px solid">Wound healing</th></tr></thead><tbody><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">5</td><td valign="middle" align="center" style="border-top: 1px solid">12</td><td valign="middle" align="center" style="border-top: 1px solid">17</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">1943</td><td valign="middle" align="center" style="border-top: 1px solid">2016</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">229</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic><break/>(5 groups)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">5</td><td valign="middle" align="center" style="border-top:solid 1px #000000">12</td><td valign="middle" align="center" style="border-top:solid 1px #000000">17</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">3185</td><td valign="middle" align="center" style="border-top:solid 1px #000000">3452</td><td valign="middle" align="center" style="border:solid 1px #000000">1658</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic><break/>(individual test; 5 groups)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">3</td><td valign="middle" align="center" style="border-top:solid 1px #000000">10</td><td valign="middle" align="center" style="border-top:solid 1px #000000">13</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">4979</td><td valign="middle" align="center" style="border-top:solid 1px #000000">5318</td><td valign="middle" align="center" style="border:solid 1px #000000">1322</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>Seurat</italic>’s <monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">7</td><td valign="middle" align="center" style="border-top: 1px solid">6</td><td valign="middle" align="center" style="border-top: 1px solid">13</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">4054</td><td valign="middle" align="center" style="border-top: 1px solid">5100</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">7809</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>spatialLIBD</italic></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">7</td><td valign="middle" align="center" style="border-top: 1px solid">6</td><td valign="middle" align="center" style="border-top: 1px solid">13</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">5865</td><td valign="middle" align="center" style="border-top: 1px solid">6675</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">289</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>DESpace2</italic> (individual test)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">1</td><td valign="middle" align="center" style="border-top:solid 1px #000000">10</td><td valign="middle" align="center" style="border-top:solid 1px #000000">11</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">3574</td><td valign="middle" align="center" style="border-top:solid 1px #000000">3650</td><td valign="middle" align="center" style="border:solid 1px #000000">152</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>scran</italic>’s <monospace>findMarkers</monospace></td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">6</td><td valign="middle" align="center" style="border-top: 1px solid">5</td><td valign="middle" align="center" style="border-top: 1px solid">11</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">4122</td><td valign="middle" align="center" style="border-top: 1px solid">5159</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">7016</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">pseudobulk-based<break/><italic>Seurat</italic>’s <monospace>FindMarkers</monospace></td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">6</td><td valign="middle" align="center" style="border-top:solid 1px #000000">5</td><td valign="middle" align="center" style="border-top:solid 1px #000000">11</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">5277</td><td valign="middle" align="center" style="border-top:solid 1px #000000">6176</td><td valign="middle" align="center" style="border:solid 1px #000000">2957</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">spline-based <italic>DESpace2</italic><break/>(5 groups)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">4</td><td valign="middle" align="center" style="border-top:solid 1px #000000">6</td><td valign="middle" align="center" style="border-top:solid 1px #000000">10</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">1588</td><td valign="middle" align="center" style="border-top:solid 1px #000000">1714</td><td valign="middle" align="center" style="border:solid 1px #000000">261</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>scran</italic>’s <monospace>findMarkers</monospace><break/>(5 groups)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">5</td><td valign="middle" align="center" style="border-top:solid 1px #000000">5</td><td valign="middle" align="center" style="border-top:solid 1px #000000">10</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">3703</td><td valign="middle" align="center" style="border-top:solid 1px #000000">4691</td><td valign="middle" align="center" style="border:solid 1px #000000">8732</td></tr><tr><td valign="middle" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><italic>spatialLIBD</italic><break/>(5 groups)</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-bottom:solid 1px #000000;border-left: 1px solid #000000">0</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-bottom:solid 1px #000000">2</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-bottom:solid 1px #000000">2</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-bottom:solid 1px #000000;border-left: 1px solid #000000">5994</td><td valign="middle" align="center" style="border-top:solid 1px #000000;border-bottom:solid 1px #000000">6526</td><td valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000">6544</td></tr></tbody></table></table-wrap></floats-group></article>