<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207037</article-id><article-id pub-id-type="doi">10.1101/2025.06.25.661303</article-id><article-id pub-id-type="archive">PPR1043249</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Extreme long-range migration distorts flower colour clines in an <italic>Antirrhinum</italic> hybrid zone</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Surendranadh</surname><given-names>Parvathy</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Stankowski</surname><given-names>Sean</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Field</surname><given-names>David L.</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Barton</surname><given-names>Nicholas H.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03gnh5541</institution-id><institution>Institute of Science and Technology Austria (ISTA)</institution></institution-wrap></aff><aff id="A2"><label>2</label>Department of Ecology and Evolution, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/00ayhx656</institution-id><institution>The University of Sussex</institution></institution-wrap>, <city>Brighton</city>, <postal-code>BN19PX</postal-code><country country="GB">UK</country></aff><aff id="A3"><label>3</label>Applied Biosciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01sf06y89</institution-id><institution>Macquarie University</institution></institution-wrap>, <city>Sydney</city>, <state>NSW</state><postal-code>2109</postal-code>, <country country="AU">Australia</country></aff><aff id="A4"><label>4</label>School of Science, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05jhnwe22</institution-id><institution>Edith Cowan University</institution></institution-wrap>, <addr-line>270 Joondalup Drive</addr-line>, <city>Joondalup</city>, <state>WA</state><postal-code>6027</postal-code>, <country country="AU">Australia</country></aff><pub-date pub-type="nihms-submitted"><day>11</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>27</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Hybrid zones are natural laboratories for the study of speciation, allowing researchers to quantify selection, dispersal, and barriers to gene flow in the real world. We analyzed a flower-colour hybrid zone between two varieties of the common snapdragon, <italic>Antirrhinum majus</italic> subspecies <italic>majus</italic>, based on a dataset of 22,494 individuals sampled over 10 consecutive years (Field et al. in prep). We found narrow geographic clines at six SNP markers that are tightly linked to known flower colour loci, with widths ranging from 0.8 to 5.5 km. The clines have a ‘stepped’ shape, which is expected when strong linkage disequilibrium generated by diffusive dispersal into the hybrid zone, increases the effective selection at the cline centre. However, the observed LD (mean <inline-formula><mml:math id="M1"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.027</mml:mn></mml:mrow></mml:math></inline-formula>) was far too weak to explain the stepped cline shapes. Instead, we show that the stepped clines are shaped primarily by the observed long-distance dispersal. We used a novel simulation framework that accounts for realistic dispersal and multilocus selection to estimate the direct selection (1.5% to 18.5%) and indirect selection due to LD (1.2% to 2.4%) on each colour locus. Finally, we show that the barrier to the flow of neutral alleles through diffusive dispersal causes negligible distortion to the clines, while the reduction in gene flow due to selection on long-range migrants is substantial (~50%). The results shed new light onto the processes that shape hybrid zones, and highlight the need to account for the effects of realistic dispersal in theoretical and empirical studies of hybrid zones.</p></abstract><kwd-group><kwd>hybrid zone</kwd><kwd>long-term study</kwd><kwd>stepped clines</kwd><kwd>long-range dispersal</kwd><kwd>linkage disequilibrium</kwd><kwd>flower colour</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">Hybrid zones are narrow areas where genetically differentiated populations come into contact with one another, leading to the production of hybrid offspring (<xref ref-type="bibr" rid="R6">Barton and Hewitt, 1985</xref>; <xref ref-type="bibr" rid="R18">Hewitt, 1988</xref>). They are found in a wide range of organisms and environments, and are considered natural laboratories for studying divergence and speciation in the wild (<xref ref-type="bibr" rid="R18">Hewitt, 1988</xref>; <xref ref-type="bibr" rid="R17">Harrison, 1993</xref>). Most well-studied hybrid zones are thought to reflect the long-term balance between selection, which keeps them narrow, and dispersal, which acts to widen the zone (<xref ref-type="bibr" rid="R6">Barton and Hewitt, 1985</xref>). They have been extensively studied theoretically, providing a framework for inferring evolutionary processes from empirical data Barton (<xref ref-type="bibr" rid="R16">Haldane, 1948</xref>; <xref ref-type="bibr" rid="R37">Slatkin, 1973</xref>; <xref ref-type="bibr" rid="R14">Endler, 1977</xref>; <xref ref-type="bibr" rid="R2">Barton, 1979a</xref>, <xref ref-type="bibr" rid="R4">1983</xref>). Indeed, some of the most detailed inferences of selection, dispersal and barriers to gene flow have come from empirical studies of hybrid zones across diverse organisms, including fire-bellied toads (<italic>Bombina</italic> (e.g. <xref ref-type="bibr" rid="R40">Szymura and Barton (1986)</xref>), <italic>Heliconius</italic> butterflies (<xref ref-type="bibr" rid="R23">Mallet and Barton, 1989</xref>), <italic>Carlia</italic> lizards (<xref ref-type="bibr" rid="R30">Phillips et al., 2004</xref>), <italic>Morabine</italic> grasshoppers (<xref ref-type="bibr" rid="R20">Kawakami et al., 2009</xref>), and house mouse (<xref ref-type="bibr" rid="R36">Searle, 1991</xref>), to name a few.</p><p id="P3">Most inferences from hybrid zones are based on the properties of geographic clines (i.e., gradients in trait means or allele frequencies). When a single locus is under direct selection, and genes diffuse through the habitat, its corresponding allele frequency cline has a sigmoid shape (<xref ref-type="fig" rid="F1">Fig. 1A</xref>), with width, <italic>w</italic>, proportional to the ratio between dispersal and selection. Thus, narrower clines imply stronger selection (<xref ref-type="bibr" rid="R16">Haldane, 1948</xref>; <xref ref-type="bibr" rid="R9">Bazykin, 1969</xref>; <xref ref-type="bibr" rid="R37">Slatkin, 1973</xref>). However, when clines at multiple selected loci coincide in a hybrid zone, they may have a ‘stepped’ shape in which a steep sigmoid gradient is flanked by shallow tails of introgression (<xref ref-type="fig" rid="F1">Fig. 1B</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>, <xref ref-type="bibr" rid="R4">Barton (1983)</xref>; <xref ref-type="bibr" rid="R40">Szymura and Barton (1986)</xref>). When multiple loci influence the trait under selection, each locus experiences an increase in effective selection due to positive associations (i.e., linkage disequilibrium; LD) between them at the cline centre (<xref ref-type="bibr" rid="R4">Barton, 1983</xref>; <xref ref-type="bibr" rid="R21">Kruuk et al., 1999</xref>). Specifically, the total selection experienced by a given locus is determined not only by its own direct effect on fitness, but also by indirect selection, i.e by its associations with other selected loci (even if unlinked). This effect is strongest in the centre of the cline, where LD is strongest, generating a barrier to the flow of alleles from one side of the hybrid zone to the other. However, as alleles escape their associations by recombining onto the alternative genetic background, the strength of indirect selection decreases and loci behave independently (i.e. weaker LD), leading to shallower tails of introgression away from the centre of the zone (<xref ref-type="bibr" rid="R4">Barton, 1983</xref>). The stepped cline model has been applied to a variety of empirical systems, enabling researchers to quantify a range of biological parameters, including the selection acting on each locus (<italic>s</italic>), the strength of the barrier to gene flow in units of geographic distance (<italic>B</italic>), and rates of introgression into the tails (<italic>θ</italic>)(e.g., (<xref ref-type="bibr" rid="R40">Szymura and Barton, 1986</xref>; <xref ref-type="bibr" rid="R20">Kawakami et al., 2009</xref>; <xref ref-type="bibr" rid="R32">Raufaste et al., 2005</xref>; <xref ref-type="bibr" rid="R31">Porter et al., 1997</xref>; <xref ref-type="bibr" rid="R22">Macholán et al., 2007</xref>). However, other factors can cause clines to have a stepped shape, so this need not always indicate a genetic barrier to gene flow.</p><p id="P4">The pattern of dispersal may also influence cline shape. A key assumption of ‘traditional’ cline theory (<xref ref-type="fig" rid="F1">Fig. 1A, B</xref>) is that the distribution of dispersal distance has finite moments, and that selection is weak enough that dispersal can be approximated as diffusion (<xref ref-type="bibr" rid="R26">Nagylaki, 1976</xref>; <xref ref-type="bibr" rid="R37">Slatkin, 1973</xref>). This enables dispersal to be described by a single parameter <italic>σ</italic> – the root mean square of parent-offspring distance along some axis, which can be estimated from mark-recapture studies or from LD at the cline centre (<xref ref-type="bibr" rid="R23">Mallet and Barton, 1989</xref>; <xref ref-type="bibr" rid="R5">Barton and Gale, 1993</xref>; <xref ref-type="bibr" rid="R40">Szymura and Barton, 1986</xref>, <xref ref-type="bibr" rid="R41">1991</xref>). In reality, many species show leptokurtic dispersal, meaning that dispersal mostly occurs over short distances, but occasionally includes long-range movements (<xref ref-type="bibr" rid="R27">Nathan et al., 2008</xref>; <xref ref-type="bibr" rid="R12">Cayuela et al., 2018</xref>). These long-distance events are hard to detect, yet can significantly affect distributions of genetic variation. Not only do they have the potential to distort cline shape (<xref ref-type="bibr" rid="R41">Szymura and Barton (1991)</xref>, <xref ref-type="fig" rid="F1">Fig. 1C, D</xref>), but they also require that we use new approaches to infer dispersal rates, estimate selection, and quantify the strength of barriers to gene flow.</p><p id="P5">In this study, we infer how selection and dispersal have shaped a hybrid zone between two varieties of the snapdragon <italic>Antirrhinum majus</italic> subspecies <italic>majus. A</italic>.<italic>m. majus</italic> has been a model for understanding trait variation dating back to crossing experiments by Mendel and Darwin (<xref ref-type="bibr" rid="R19">Hudson et al., 2008</xref>).</p><p id="P6">The natural range of <italic>A</italic>.<italic>m. majus</italic> is mainly centreed in France and Spain, though its popularity in horticulture has seen populations established throughout Europe and across the globe (<xref ref-type="bibr" rid="R19">Hudson et al., 2008</xref>). We focus on a natural hybrid zone between two varieties, <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> (<xref ref-type="bibr" rid="R35">Rothmaler, 1956</xref>). They have largely distinct geographic ranges, but occupy a similar range of local habitats and are pollinated by the same bee species (<xref ref-type="bibr" rid="R47">Whibley et al., 2006</xref>; <xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>). The only known trait that distinguishes them is their different flower colour patterns, which are thought to be alternate solutions to attracting bees and signposting bee entry into the flower (<xref ref-type="bibr" rid="R47">Whibley et al., 2006</xref>; <xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>): <italic>A.m.m</italic> var. <italic>pseudomajus</italic> has magenta flowers coloured by anthocyanin pigment with a small patch of yellow aurone pigment below the bee entry point (<xref ref-type="fig" rid="F2">Fig. 2A</xref>), whilst <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> has primarily yellow flowers due to widespread presence of aurone pigment, with restricted veins of magenta anthocyanin pigment above the bee entry point (<xref ref-type="fig" rid="F2">Fig. 2A</xref>, <xref ref-type="bibr" rid="R11">Bradley et al. (2017)</xref>). This difference in pattern is determined by a handful of loci that control the production and distribution of anthocyanin and aurone pigment in floral tissue (<xref ref-type="table" rid="T1">Table 1</xref>). Three loci—<italic>ROSEA</italic> (<italic>ROS</italic>) (<xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>), <italic>ELUTA</italic> (<italic>EL</italic>) (<xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>) and <italic>SULFUREA</italic> (<italic>SULF</italic>) (<xref ref-type="bibr" rid="R11">Bradley et al., 2017</xref>)—have major effects, while three others— <italic>RUBIA</italic> (<italic>RUB</italic>) (<xref ref-type="bibr" rid="R15">Field et al., 2025</xref>), <italic>CREMOSA</italic> (CRE) (<xref ref-type="bibr" rid="R33">Richardson et al., 2025</xref>), and <italic>FLAVIA</italic> (<italic>FLA</italic>) (<xref ref-type="bibr" rid="R10">Bradley et al., 2025</xref>) — have more subtle effects on colour pattern and/or intensity.</p><p id="P7">During the last ice age, <italic>A</italic>.<italic>m. majus</italic> was restricted to areas of lower elevation, but subsequently expanded into the Pyrenees as the climate warmed. As a result, <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> have come into contact, forming narrow hybrid zones in multiple valleys separated by mountains that rise above the altitude tolerance of <italic>A</italic>.<italic>m. majus</italic> (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). Segregation and recombination of colour alleles in hybrids has generated a wide range of phenotypes. These include individuals that are phenotypically intermediate between <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic>, as well as unusual phenotypes that fall outside the range seen in the genus Antirrhinum (<xref ref-type="bibr" rid="R43">Tastard et al., 2008</xref>). Selection by pollinators is thought to maintain hybrid zones in two ways. First, experiments have shown that some hybrid colour patterns are less likely to be visited because they do not fit the visual preferences of bee pollinators (<xref ref-type="bibr" rid="R43">Tastard et al., 2008</xref>). <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> colour patterns are also thought to be subject to positive frequency-dependent selection and/or selection against hybrids, each having higher fitness on the side of the hybrid zone where they are more common (<xref ref-type="bibr" rid="R42">Tastard et al., 2014</xref>).</p><p id="P8">Several studies at one hybrid zone in the Val de Ribes suggested that selection acts on flower colour. First, past work has shown that the transition from <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> is abrupt, and is characterised by a steep cline in flower colour only a few km wide (<xref ref-type="bibr" rid="R47">Whibley et al., 2006</xref>; <xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>; <xref ref-type="bibr" rid="R11">Bradley et al., 2017</xref>). Studies of genome-wide sequence variation, including preliminary cline analyses, have revealed strong allele frequency differentiation and steep clines around colour loci (<xref ref-type="bibr" rid="R47">Whibley et al. (2006)</xref>; <xref ref-type="bibr" rid="R15">Field et al. (2025)</xref>). In contrast, the remaining genomic background shows low differentiation, potentially due to the long-term effects of dispersal and recombination between the two subspecies (<xref ref-type="bibr" rid="R47">Whibley et al. (2006)</xref>; <xref ref-type="bibr" rid="R44">Tavares et al. (2018)</xref>; <xref ref-type="bibr" rid="R34">Ringbauer et al. (2018)</xref>; <xref ref-type="bibr" rid="R15">Field et al. (2025)</xref>; <xref ref-type="bibr" rid="R29">Pal et al. (2025)</xref>). Despite this past work, we still lack a robust, quantitative understanding of how selection and dispersal shape this hybrid zone.</p><p id="P9">In this study, we conduct a genetic analysis of the hybrid zone in the Val de Ribes, based on 22,494 individuals sampled and genotyped over 10 years (Field et al. in prep.). Our main aim was to interpret cline shapes and LD among SNP markers that are tightly linked to 6 known colour loci in order to quantitatively understand how selection and dispersal shape the zone. Our analysis is based on one SNP marker per colour locus; we refer to these by the name of the nearby causal locus (<italic>ROS, SULF</italic>, …), but emphasise that these are only markers for causal loci that may have a complex structure. A novel aspect of our approach, made possible by a recently inferred pedigree for this population (Field et al. in prep) and intensive sampling, is that we are able to make use of the full distribution of pollen and seed dispersal, which is highly leptokurtic. We show that long-range dispersal events which are not accounted for in traditional cline theory, substantially distort the cline shape. By incorporating the empirical dispersal into a multilocus simulation, we explain the causes of stepped clines and observed LD and decompose the total effective selection into direct and indirect components. Our results expand our understanding of the processes that shape this hybrid zone, and highlight new approaches to infer dispersal, selection and barriers to gene flow when the assumptions of ‘traditional’ cline analysis do not match reality.</p></sec><sec id="S2" sec-type="results"><label>2</label><title>Results</title><sec id="S3"><label>2.1</label><title>Sampling and description of datasets</title><p id="P10">Our study uses data that was collected as part of a long-term collaborative initiative to survey the hybrid zone started by researchers from the John Innes Centre (Norwich, UK) and the Institute of Science and Technology Austria. We analysed the data collected each year from 2009 to 2019 during the peak of the flowering season (late May to early August), attempting to sample every flowering individual within our core study area (See Methods; <xref ref-type="fig" rid="F2">Fig. 2C and D</xref>). Although the area is large, snapdragons are restricted mainly to south-facing rocky cliffs and disturbed areas that are accessible from two parallel roads. Repeated surveys of adjacent forested slopes, which are heavily shaded and dominated by conifer species of <italic>Pinus</italic> or <italic>Abies</italic>, have found very few individuals, suggesting that we survey most of the suitable habitats in the area. Other suitable habitat includes disturbed deforested areas further from the roads, small side roads, railway embankments, and hiking trails. In some years, we also sampled beyond the core area to improve sampling in the left and right tails of the cline (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). After accounting for individuals that were sampled multiple times (identified by genotype) because they lived more than one year, our dataset includes 22,494 unique individuals used in subsequent analysis.</p><p id="P11">Our analysis is based primarily on three types of data. First, we have the sampling year and spatial position of each plant. Second, each plant has been genotyped at ~ 100 SNP markers. Six of the SNPs (used in the subsequent cline analysis) are tightly associated with causal alleles at six of the known colour loci. These include three loci that influence the production and spread of magenta anthocyanin pigment (<italic>ROS, EL</italic> and <italic>RUB</italic>) and three that influence the production of yellow aurone pigmentation (<italic>SULF, FLA, CRE</italic>). Except for <italic>ROS</italic> and <italic>EL</italic>, which are located about 0.5 cM apart on LG6, the loci are on different chromosomes (<xref ref-type="table" rid="T1">Table 1</xref>). The remaining SNPs were chosen based on their power to identify parent-offspring trios across our temporal dataset. Because the spatial locations of the parents and offspring are known, inferred trios provide us with direct estimates of dispersal in our study area. Third, we have qualitative colour scores for each individual, describing the level of magenta and yellow colouration of one sampled flower. Because these scores are subjective (flowers were scored by different observers over the last decade), we limit our analysis of these scores to a qualitative comparison with the SNP clines. We do not attempt to distinguish alternate forms of selection or analyze phenotypes in detail: we most likely do not have substantial power to distinguish subtly different models despite our very large sample.</p></sec><sec id="S4"><label>2.2</label><title>Clines at flower colour loci have similar positions but different shapes</title><p id="P12">We first fit clines to each of the 6 colour loci separately (see Methods, <xref ref-type="table" rid="T1">Table 1</xref>). To facilitate cline fitting, we first clustered plants into 999 demes and calculated their position along a one-dimensional transect (<italic>z</italic>) (see Methods). A 25m diameter was chosen because it yielded demes with enough individuals to estimate local allele frequencies and LD (mean of 23 individuals per deme; 337 demes with at least 10 individuals, <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>), and minimize departure from Hardy-Weinberg equilibrium (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). We then used the Metropolis-Hastings algorithm to fit three cline models to the allele frequency data, while describing variation around the cline using <italic>F</italic><sub><italic>ST</italic></sub> (see Methods). These included (i) a simple sigmoid model, (ii) a sigmoid model with polymorphism in the tails of the cline, and (iii) a stepped model, characterized by a central sigmoid shape flanked by long exponential tails of introgression which may differ to the left and right (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). Analysis of one locus (<italic>ROS</italic>) found no changes in cline position or width over time (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>, <xref ref-type="supplementary-material" rid="SD1">Table S3</xref>), so we combined individuals across all years. We compared likelihoods to identify the best-fitting model for each locus, and obtained maximum-likelihood estimates (MLE) for each cline parameter (<xref ref-type="table" rid="T2">Table 2</xref>).</p><p id="P13">All six of the colour loci show sharp clines which match the transition in flower colour scores (<xref ref-type="fig" rid="F3">Fig. 3A, B</xref>). The stepped cline model fits the data better than both sigmoid models for all 6 loci (<xref ref-type="supplementary-material" rid="SD1">Table S2</xref>, <xref ref-type="fig" rid="F3">Fig. 3B</xref>). We examined the MLE (see <xref ref-type="table" rid="T2">Table 2</xref>) and the marginal likelihood (equivalent to the posterior distribution) to see how parameters differed among loci. The cline centres were highly similar among loci (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, <xref ref-type="table" rid="T2">Table 2</xref>), ranging from 14.43 km to 15.3 km (mean c = 14.96 km), and differing from one another by an average of 0.34 km (maximum of 0.9 km). Cline widths, on the other hand, differed markedly among loci (<xref ref-type="fig" rid="F3">Fig. 3C</xref>), ranging from 0.76 km (<italic>ROS</italic>) up to 4.5 km (<italic>RUB</italic>). We also found striking differences in the degree of polymorphism and introgression in the tails of the cline. While most SNP markers fix alternate alleles on either side, some loci showed appreciable polymorphism in the yellow flank (i.e., <italic>RUB</italic> and <italic>SULF</italic>, where the <italic>pseudomajus</italic> allele has a frequency around 0.2). Additionally, <italic>FLA</italic> and <italic>CRE</italic> showed strong asymmetries in the cline shape with rates of decay of tails of introgression that are much higher on one side (e.g., <italic>θ</italic><sub>1</sub> <italic>&gt; θ</italic><sub>0</sub>).</p><p id="P14">Taken together, and in the context of the low genome-wide differentiation across this hybrid zone (<xref ref-type="bibr" rid="R44">Tavares et al. 2018</xref>), our results are consistent with the hypothesis that the colour loci are targets of pollinator-mediated selection. The varying widths indicate that some loci experience stronger selection than others, likely owing to their individual effects on colouration and/or variation in their degree of linkage to causal mutations. However, the similar positions of the cline centres are expected, given that the difference in colour pattern between <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> and <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> is determined by interactions between these loci. This coincidence of clines may in addition be due to the presence of associations amongst the six loci, which we examine next.</p></sec><sec id="S5"><label>2.3</label><title>Associations between flower colour markers extend beyond the cline centre</title><p id="P15">Studies of hybrid zones often find strong associations between alleles at unlinked loci (i.e., linkage Szymura and Barton disequilibrium, LD) in areas where clines coincide (e.g., <italic>Bombina</italic>, szymura and Barton (1986, 1991); <italic>Heliconius</italic>, <xref ref-type="bibr" rid="R24">Mallet et al. (1990)</xref>; <italic>Vandiemenella</italic>, <xref ref-type="bibr" rid="R20">Kawakami et al. (2009)</xref>, <italic>Mus musculus</italic>, Macholań et al. (2007)). The LD is usually attributed to the influx of d istinct multilocus genotypes as parental individuals disperse into the zone from both sides (<xref ref-type="bibr" rid="R3">Barton, 1979b</xref>; <xref ref-type="bibr" rid="R7">Barton and Shpak, 1990</xref>). Because LD among unlinked loci is halved each generation by recombination, it should decay rapidly with increasing distance from the cline centre under short-range dispersal.</p><p id="P16">To test for associations in the hybrid zone, we calculated standardised LD within each deme for the five unlinked loci (excluding <italic>EL</italic>, noting that choosing <italic>ROS</italic> or <italic>EL</italic> makes little difference due to their tight association). We used an LD estimator, <inline-formula><mml:math id="M2"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, based on the variance of hybrid index (HI). HI is defined as the number of <italic>pseudomajus</italic> alleles carried by each individual, such that with 5 loci, HI ranges from 0 to 10. The mean HI in each deme, calculated from all 5 loci, is plotted along the transect in <xref ref-type="fig" rid="F4">Fig. 4A</xref>; it shows a clear stepped pattern and has a shape and position qualitatively similar to the single locus clines. The variance of the hybrid index, <italic>V</italic><sub><italic>HI</italic></sub> = 2 ∑<sub><italic>i</italic></sub> <italic>p</italic><sub><italic>i</italic></sub><italic>q</italic><sub><italic>i</italic></sub> + 2 ∑<sub><italic>i</italic></sub> <italic>p</italic><sub><italic>i</italic></sub><italic>q</italic><sub><italic>i</italic></sub><italic>F</italic><sub><italic>IS</italic>,<italic>i</italic></sub> + 2 ∑<sub><italic>i</italic> ≠ <italic>j</italic></sub> <italic>D</italic><sub><italic>ij</italic></sub>, separates into components due to heterozygosity (<italic>V</italic><sub><italic>P</italic><italic>Q</italic></sub>), heterozygote deficit (<italic>V</italic><sub><italic>F</italic></sub>), a nd l inkage disequilibrium respectively (modified from Barton and Gale (1993)). Both LD and heterozygote deficit in flate the variance in the hybrid index, meaning that the excess variance can be used to estimate the standardised LD or correlations relative to linkage equilibrium given as <inline-formula><mml:math id="M3"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. This was calculated separately for each pair of loci (maximum likelihood gives similar results); <inline-formula><mml:math id="M4"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> ranges from -1 to 1. We also calculated heterozygote deficit, <italic>F</italic><sub><italic>IS</italic></sub>, for each locus within each deme. To reduce noise among demes, we calculated mean <inline-formula><mml:math id="M5"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> and <italic>F</italic><sub><italic>IS</italic></sub> in 12 non-overlapping bins along the transect, and 3 coarser bins to examine LD inside and outside the cline centre.</p><p id="P17">Combining individuals from the centre and flanks, we observed significantly positive correlations between all but one pair of loci (permutation test, see Methods). <italic>ROS</italic> had the strongest associations with <italic>FLA</italic> (0.089) and weakest with <italic>RUB</italic> (0.029), while <italic>RUB</italic> and <italic>SULF</italic> showed weak LD (-0.002) (see <xref ref-type="supplementary-material" rid="SD1">Table S7</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). However, the mean correlations <inline-formula><mml:math id="M6"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> across all pairs of loci were variable and non-zero across the 12 bins along the transect, ranging from 0.006 to 0.12 (<xref ref-type="supplementary-material" rid="SD1">Table S6</xref>). <inline-formula><mml:math id="M7"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> was significantly positive but modest in the cline centre, averaging 0.027 across the central 2km region (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). Additionally, we found no evidence for a marked deficit of heterozygotes at the cline centre, as most bins had a mean <italic>F</italic><sub><italic>IS</italic></sub> near 0, after averaging over the 5 loci (<xref ref-type="supplementary-material" rid="SD1">Table S6</xref>, <xref ref-type="fig" rid="F4">Fig. 4C</xref>). However, <italic>ROS</italic> showed a deficit of heterozygotes (<italic>F</italic><sub><italic>IS</italic></sub> = 0.034) possibly due to strong selection or assortative mating (<xref ref-type="supplementary-material" rid="SD1">Table S5</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>). Overall, the low levels of LD and <italic>F</italic><sub><italic>IS</italic></sub> show that there is only a weak genome-wide barrier, consistent with <xref ref-type="bibr" rid="R34">Ringbauer et al. (2018)</xref>, which found no evidence of a barrier to gene flow from non-clinal SNPs.</p><p id="P18">Traditional cline analysis allows the inference of dispersal and selection from associations between loci (LD) and cline widths (<xref ref-type="bibr" rid="R5">Barton and Gale, 1993</xref>). Mean correlations in the centre of the hybrid zone can be used to estimate dispersal as <inline-formula><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>8</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic>w</italic><sub><italic>i</italic></sub> is the cline width of locus <italic>i</italic> and <italic>σ</italic> is the root mean square of parent-offspring dispersal distance along the transect. The mean correlations between all pairs of unlinked loci in the centre, 0.027, implies <italic>σ</italic> = 98m. This estimate of dispersal can in turn be used to infer the strength of selection from <inline-formula><mml:math id="M9"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>8</mml:mn><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, assuming selection against heterozygotes (<xref ref-type="bibr" rid="R9">Bazykin, 1969</xref>). Using MLE for cline width (<xref ref-type="table" rid="T2">Table 2</xref>), estimated selection coefficients ranged from 0.12 in <italic>ROS</italic> to 0.004 in <italic>RUB</italic> (<xref ref-type="table" rid="T3">Table 3</xref>). This is the effective selection that is required to maintain the cline of the observed width. However, these inferences are valid only when the assumptions of basic cline theory are met.</p><p id="P19">Our results highlight two major discrepancies from traditional cline theory and the necessity to adopt a different method, as detailed below. Firstly, the standardised LD in the centre of the hybrid zone is weak (~0.027). In our system, relatively few loci are under selection (<xref ref-type="bibr" rid="R44">Tavares et al. (2018)</xref>), and we show below that the weak LD among them is insufficient to cause a detectable step, as opposed to scenarios where strong LD reflects a genetic barrier to gene flow (see <xref ref-type="supplementary-material" rid="SD1">Fig. S13</xref>). Stepped clines can also reflect a geographical barrier to dispersal (<xref ref-type="bibr" rid="R6">Barton and Hewitt, 1985</xref>; <xref ref-type="bibr" rid="R46">Westram et al., 2022</xref>); however, this seems unlikely, as we see no indication of a strong geographical barrier in this hybrid zone. It is also possible that the stepped shape is caused by introgression of a marker SNP as it recombines away from a tightly linked causal locus (<xref ref-type="bibr" rid="R3">Barton, 1979b</xref>); we return to this issue in the Discussion.</p><p id="P20">A second unexpected finding is the presence of positive LD across the entire transect (<xref ref-type="fig" rid="F4">Fig. 4B</xref>); in fact, the correlation between alleles is higher in the flanks than in the centre (<inline-formula><mml:math id="M10"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.088</mml:mn></mml:mrow></mml:math></inline-formula> in the yellow flank and 0.034 in the magenta flank, compared to 0.027 in the centre). The simplest explanation is that this is generated by long-distance dispersal from one side of the hybrid zone to the other (<xref ref-type="bibr" rid="R40">Szymura and Barton, 1986</xref>, <xref ref-type="bibr" rid="R41">1991</xref>). Long-distance dispersal directly brings in sets of foreign alleles generating introgression and causing local increases in LD away from the cline centre. In such scenarios <italic>σ</italic> may not suffice to de scribe dispersal: the diffusion approximation fails, and inferences from traditional cline analysis may be inaccurate.</p></sec><sec id="S6"><label>2.4</label><title>Snapdragons show extreme long-distance dispersal</title><p id="P21">To understand how dispersal influences the cline shape and LD, we inferred the full pollen and seed dispersal distributions from our long-term dataset. Dispersal up to ~1km (hereafter referred to as short-range dispersal) was obtained using the parent-offspring distances from the 2342 parent-offspring trios inferred in Field et al. in prep. Although this dispersal is leptokurtic, here we refer to the full dispersal distribution-spanning the range of the hybrid zone – which is even more strongly leptokurtic due to the presence of rare long-distance dispersal events far into the tails of the cline.</p><p id="P22">Beyond the range of the pedigree, we identified long-range migrants in the flanks as having multilocus genotypes which are unlikely to be produced locally by random mating, given the local allele frequencies (SM Text S3). Using this approach, we found that 3.7% and 1.1% of individuals in the yellow and magenta flanks respectively were unlikely to be the result of mating between two local parents (<italic>p &lt;</italic> 2 ∗ 10<sup>−4</sup>; <xref ref-type="supplementary-material" rid="SD1">Table S8</xref>). We infer that these ‘improbable individuals’ arose primarily through long-range seed dispersal. This is because pollen dispersal would yield F1-like individuals in the flanks, yet these are relatively rare (<xref ref-type="supplementary-material" rid="SD1">Table S8</xref>); moreover, from the pedigree trios (Field et al. in prep.), seed dispersal is more frequent in the extreme tails (beyond the range shown in <xref ref-type="fig" rid="F5">Fig. 5A</xref>). Therefore, we extrapolate over longer ranges from the shape of the short-range pollen dispersal kernel, which closely matches a log-Gaussian distribution (<xref ref-type="fig" rid="F5">Fig. 5A</xref>).</p><p id="P23">In contrast, we inferred long-range seed dispersal separately for individuals in either direction from the improbable parental genotypes that we see in the flanks. We assumed an exponential function which was spliced onto the short-range distribution at 300m, to give a full seed dispersal kernel, fitting the rates of decay by maximum likelihood (see Methods, Fig S8).</p><p id="P24">Together, these approaches showed that dispersal is highly leptokurtic. Half of fathers were within 18m of the mother, 75% within 55m, and 93% within 200m (<xref ref-type="fig" rid="F5">Fig. 5A</xref>). Seed dispersal was more leptokurtic, with ~60% of dispersal occurring within 5m and ~80% within 10 m (<xref ref-type="fig" rid="F5">Fig. 5A</xref>), but with very long tails in both directions (<xref ref-type="fig" rid="F5">Fig. 5B</xref>); the scale of decay in the tails was inferred to be <italic>λ</italic><sub><italic>left</italic></sub>= 4.5km to the left flank and <italic>λ</italic><sub><italic>right</italic></sub>= 2.6 km to the right. Long-range seed dispersal was higher from magenta to yellow, consistent with the high rate of introgression seen from the hybrid index score and greater LD observed in the yellow flank (<xref ref-type="fig" rid="F4">Fig. 4A,B</xref>). These long-range seed dispersers can directly bring in foreign genotypes, thereby generating positive associations between alleles at different causal loci away from the cline centre.</p></sec><sec id="S7"><label>2.5</label><title>Using simulations with empirical dispersal to explain cline shape and LD</title><p id="P25">We observe associations (LD) even between unlinked loci, and see strongly leptokurtic dispersal. In order to find the relative contribution of these to distorting clines away from a simple sigmoid, and to estimate the strength of selection that best explains our data, we simulate the five unlinked loci, using the observed dispersal kernel (We exclude <italic>EL</italic>, but note that due to tight linkage between <italic>ROS</italic> and <italic>EL</italic>, simulating <italic>ROS</italic> includes the effect of both these loci; <xref ref-type="bibr" rid="R44">Tavares et al. (2018)</xref>), using the observed dispersal kernel. There are a plethora of possible models for selection: with 5 loci, we have 243 diploid genotypes, which can each be assigned a fitness that depends on the frequency of all the genotypes. We are skeptical that we have much power to estimate much more than the net selection on each locus, and so choose as simple a model as possible, at least for this first analysis. We assume random mating, so that diploid genotype frequencies can be constructed from the frequencies of the 2<sup>5</sup>=32 haplotypes. We assume an infinite population, using a deterministic simulation that neglects drift. We also assume that selection is multiplicative across loci, and acts against heterozygotes; it may be asymmetric, so that contribution to fitness at a locus is 1 + <italic>s</italic><sub><italic>left</italic></sub> : 1 : 1 + <italic>s</italic><sub><italic>right</italic></sub>. Though we simulate haplotype frequencies, we find the best fit to the allele frequency clines. Because the clines are strongly stepped, we use unevenly spaced demes, so that we can follow steep gradients in the centre, and shallower tails out at the edges. The migration matrix is constructed from the CDF of the observed dispersal, to give the fraction in each ‘deme’ that derives from each of the other demes in every generation. This scheme should be seen as a surrogate for a range of more detailed models; for example, selection against heterozygotes is equivalent to positive frequency-dependent selection, or to epistasis (<xref ref-type="bibr" rid="R8">Bazykin, 1973</xref>; <xref ref-type="bibr" rid="R2">Barton, 1979a</xref>). Essentially, the selection coefficients give the rate of change of allele frequency on either side, and represent marginal values that absorb the effects of dominance, epistasis and frequency-dependence. Models will differ in the pattern of linkage disequilibrium, but because loci are unlinked, we have littler power to detect such affects, and do not attempt to fit linkage disequilibrium.</p><p id="P26">Clines that are maintained by selection against hybrids, or by positive frequency-dependence, are not tied to any particular location, and so will tend to move. Such movements are likely to be countered by small density gradients; assuming diffusion, a wave speed <italic>v</italic> can be balanced by a gradient in log density <italic>v/σ</italic> (<xref ref-type="bibr" rid="R2">Barton, 1979a</xref>). Therefore, we shift the simulation such that it is always centred in the same place, and find its most likely location with respect to the observed allele frequencies. When we simulate a single locus, asymmetric selection is redundant, since it just shifts the cline without altering its shape (<xref ref-type="bibr" rid="R2">Barton, 1979a</xref>). However, when we simulate multiple loci, they can be held together by LD, so that differences in asymmetry between loci cause differences in position, as well as differences in the rate of decay of tails of introgression on either side. Simulated allele frequencies were fit to the observed allele frequencies after 500 generations, to infer MLE of the strength of selection, cline centre, and <italic>F<sub>ST</sub></italic>. We first validated the simulation by considering Gaussian dispersal with <italic>σ</italic> =200m and <italic>s</italic>= 0.1 and following the allele frequencies at a single locus. As expected, we get a sigmoid cline with width <inline-formula><mml:math id="M11"><mml:mrow><mml:msqrt><mml:mn>8</mml:mn></mml:msqrt><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:msqrt><mml:mi>s</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mn>1800</mml:mn><mml:mtext>m</mml:mtext></mml:mrow></mml:math></inline-formula>(see <xref ref-type="supplementary-material" rid="SD1">Fig. S8</xref>).</p><p id="P27">To understand how long-range dispersal affects cline shape in the absence of LD, we first simulated each locus separately. Simulated clines with only the short-range dispersal (i.e the dispersal inferred in Field et. al (in prep.) from the pedigree trios, up to 300m) failed to generate a strong step (<xref ref-type="supplementary-material" rid="SD1">Fig. S9</xref>). However, inclusion of long range dispersal generated stepped clines at all loci (log <italic>L</italic> = −9385.3 with 15 df, <xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>, <xref ref-type="fig" rid="F6">Fig. 6A</xref>). The inferred selection coefficients for the 5 unlinked loci ranged from 0.196 to 0.024 (<xref ref-type="table" rid="T3">Table 3</xref>). The simulated clines matched the observed step and patterns of introgression in the tails for <italic>ROS</italic> but failed to explain the complete cline shape at other loci (<xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>, <xref ref-type="fig" rid="F6">Fig. 6A</xref>). We next simulated clines at 5 unlinked loci, allowing asymmetric selection, which causes differences in the cline position and rate of introgression. Asymmetric multilocus selection, including long-range dispersal, best explained the observed stepped clines at all loci (log <italic>L</italic> = −9257.8 with 12 df, <italic>F</italic><sub><italic>ST</italic></sub> = 0.067, <xref ref-type="fig" rid="F6">Fig. 6A</xref>). The inferred selection estimates (see <xref ref-type="table" rid="T3">Table 3</xref>) were roughly symmetric for <italic>ROS, SU LF</italic> and <italic>RUB</italic>, and differed only by ~0.02 between the two homozygotes for <italic>FLA</italic> and <italic>CRE</italic>. Similarly, cline centres from cline fitting (<italic>c</italic> = 14.96km) matched closely with that from the simulations (<italic>c</italic> = 14.97 km). However, this simple model does not capture the complete cline shapes, especially at <italic>F LA</italic> and <italic>CRE</italic>.</p><p id="P28">We next compared the observed standardized LD with that seen in multilocus simulations. We found that LD tended to be overestimated by the simulation. One cause of this discrepancy might be dependence of LD on the life stage at which it is measured, which in the simulations is immediately after populations mix. However, there is good agreement between the simulated and observed LD patterns (<xref ref-type="fig" rid="F6">Fig. 6B</xref>): mean LD from the simulations was positive across the entire transect, and stronger in the tails of the cline <inline-formula><mml:math id="M12"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.073</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.053</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> than at the centre <inline-formula><mml:math id="M13"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.051</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We also <italic>right</italic> found that the strength of the simulated pairwise LD varied as expected, with stronger LD among pairs of loci under stronger selection (<xref ref-type="supplementary-material" rid="SD1">Fig. S11</xref>). These results confirm that long-range dispersal can generate both widespread LD and stepped clines.</p></sec><sec id="S8"><label>2.6</label><title>Inferences of the strength of selection and the barrier to gene flow</title><p id="P29">The multilocus simulations allow us to separate the direct, indirect, and total effective selection acting on each locus. The total effective selection at any locus <italic>i</italic> (<italic>s</italic><sub><italic>eff</italic>,<italic>i</italic></sub>) is the sum of direct selection experienced by that locus individually (<italic>s</italic><sub><italic>i</italic></sub>), and the indirect selection due to associations with other selected loci (<italic>s</italic><sub><italic>LD</italic>,<italic>i</italic></sub>), and can be calculated in the cline centre (assuming clines coincide) as <inline-formula><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.2em"/><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="true"><mml:mtext>Σ</mml:mtext></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>s</italic><sub><italic>i</italic></sub> = (<italic>s</italic><sub><italic>left</italic></sub> + <italic>s</italic><sub><italic>right</italic></sub>)<italic>/</italic>2 is the average selection coefficient from asymmetric multilocus simulations at locus <italic>i</italic> and <inline-formula><mml:math id="M15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>is the correlation between locus <italic>i</italic> and <italic>j</italic>. This varied from 0.199 to 0.028 among the 5 loci at the centre of the hybrid zone (<xref ref-type="table" rid="T3">Table 3</xref>). The direct estimates of selection (taken as the average of <italic>s</italic><sub><italic>left</italic></sub> and <italic>s</italic><sub><italic>right</italic></sub> for asymmetric selection) were lower than from the single locus simulations. This is due to the effect of LD (indirect selection) which increases the total effective selection experienced at a locus, thus lowering the inferred direct selection.</p><p id="P30">Effective selection at each locus was similar to that from single locus simulations. Multilocus selection has a weak effect on cline shape: LD due to indirect selection only causes a moderate increase in the step (<xref ref-type="fig" rid="F6">Fig. 6A</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>). This effect of LD is captured by the indirect selection on each locus, <italic>s</italic><sub><italic>LD</italic></sub> and its relative contribution to effective selection is <italic>s</italic><sub><italic>LD</italic></sub><italic>/s</italic><sub><italic>eff</italic></sub>. For each locus, the indirect selection contributed roughly 30% (on average) of the total effective selection. It was weakest in <italic>ROS</italic> (6.7%) and strongest in <italic>RUB</italic> and <italic>SULF</italic> (44%) as expected: the effect of LD is strongest on weakly selected loci.</p><p id="P31">The multilocus simulation scheme also allows us to gain insight into the strength of the barrier to gene flow acting in this system. In traditional cline analysis, the strength of the barrier to gene flow at the centre of the hybrid zone is estimated from the shape of stepped clines. Because we know that long-distance dispersal and LD contribute to the step, we must first estimate how much of the step is due only to LD. To do this, we conducted an additional multilocus simulation that assumed Gaussian dispersal. We used a dispersal rate of <italic>σ</italic> = 161m estimated from <inline-formula><mml:math id="M16"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>8</mml:mn><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, with the cline widths (<italic>w</italic>) estimated from descriptive cline fits and the selection coefficients (<italic>s</italic>) inferred from the multilocus simulation. Although this scenario generated a sharp peak of LD at the cline centre <inline-formula><mml:math id="M17"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.036</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which decayed rapidly with increasing distance (gray curve in <xref ref-type="fig" rid="F6">Fig. 6B</xref>), it generated a negligible step (<xref ref-type="supplementary-material" rid="SD1">Fig. S13</xref>). Thus, while there must be some barrier due to LD, it is likely negligible and below the limits of detection using theory based on cline shape. This further emphasises the importance of long-distance dispersal in generating the stepped clines.</p><p id="P32">Although we were unable to detect a barrier at the cline centre via cline fitting, the net barrier to gene flow across the hybrid zone can still be measured by the ratio <italic>B</italic> = Δ <italic>p/p</italic><italic>′</italic>, but it must be measured across the whole region that is affected by selection, which spans ~ 10km, and this is difficult, even with our very large sample. Gene flow across this hybrid zone consists of two components: diffusion of genes through the central region, and long-range dispersal, which introduces parental genotypes on either side. The barrier due to diffusive gene flow at an unlinked neutral loci is proportional to the central gradient and is determined by the net selection against hybrids. This can be measured by <inline-formula><mml:math id="M18"><mml:mrow><mml:mi>w</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>w</italic> is the cline width, <inline-formula><mml:math id="M19"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>the mean fitness of the hybrid population at the centre relative to the parental type and <italic>r</italic> = 1<italic>/</italic>2 is the recombination rate (Barton 1986). Since mean fitness of the parental types across the cline is 1, this is given by 2Π (1 − <italic>s</italic><sub><italic>i</italic></sub><italic>/</italic>2)<sup>2</sup> ~ 0.71. Thus, this component of the barrier reduces gene flow by 30%.</p><p id="P33">We must also consider the strength of the barrier to gene flow generated by selection against long-range migrants. Here, we obtain a rough estimate by treating the yellow and magenta flanks as discrete demes that exchange migrants at a low rate (<italic>m</italic>). Under this model, the rate of gene flow for an unlinked neutral locus in the presence of selection (<italic>m</italic><sub><italic>e</italic></sub>) relative to that expected without any barriers to gene flow (<italic>m</italic>) is the product of the mean fitnesses of incoming migrants and all successive hybrid classes: <italic>m</italic><sub><italic>e</italic></sub><italic>/m</italic> = <italic>W</italic><sub><italic>m</italic></sub> ∗ <italic>W</italic><sub><italic>F</italic> 1</sub> ∗ <italic>W</italic><sub><italic>bc</italic>1</sub> … (<xref ref-type="bibr" rid="R46">Westram et al. (2022)</xref>). In our study, the fitness of each successive migrant can be calculated from our multilocus simulations using the average selection coefficient for each locus. This yields an estimate of <italic>m</italic><sub><italic>e</italic></sub><italic>/m</italic> = 0.5. Thus, the rate at which an incoming neutral migrant allele associated with the opposite phenotype gets established is half the rate at which they enter through long distance dispersal. In other words, the strength of reproductive isolation (<italic>sensu</italic> <xref ref-type="bibr" rid="R46">Westram et al. (2022)</xref>) <italic>due to selection acting against long range migrants (1</italic> − <italic>me/m</italic>) is 0.5. Thus, both components of the barrier reduce gene flow to a similar degree, but there is a stronger barrier to long-range dispersal, because their offspring suffer stronger selection than do sets of genes flowing through the centre.</p></sec></sec><sec id="S9" sec-type="discussion"><label>3</label><title>Discussion</title><p id="P34">Our analysis of the genotypes of 22,494 individuals provides new insights into the processes shaping the flower colour clines in this hybrid zone. We found patterns typical for hybrid zones, including stepped geographic clines at all six colour loci (<xref ref-type="fig" rid="F3">Fig. 3B</xref>), and significant LD at the cline centre (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). However, some of our results were not predicted by traditional cline theory, including positive LD across the entire transect, and stepped clines despite weak LD in the centre. A multilocus simulation allowed us to estimate both direct and indirect selection, and to show that the stepped clines are caused primarily by long-distance dispersal rather than reflecting a strong genetic barrier to gene flow. Here, we elaborate on some of the key conclusions and highlight the general implications of our work for the study of hybrid zones.</p><p id="P35">Our study shows that these flower color clines are maintained by a balance between dispersal and selection. We also found that the strength of selection obtained from simulations varies among the colour markers, with estimates of direct selection ranging from 1.5% to 19% (<xref ref-type="table" rid="T3">Table 3</xref>). We think that this variation is mostly due to the different effects that each locus has on flower colour. For example, the tightly linked loci <italic>ROS</italic> and <italic>EL</italic>, which have the largest selection coefficient (19%), are the major determinants of magenta colouration. In contrast, <italic>RUB</italic>, which has the smallest selection coefficient (1.5%), has a relatively modest effect on colour (<xref ref-type="bibr" rid="R15">Field et al., 2025</xref>), subtly increasing the intensity of magenta if it is already present (<xref ref-type="table" rid="T1">Table 1</xref>). Although this interpretation makes intuitive sense, because pollinator preferences are thought to be driven by the differences in flower colour, other factors also contribute to variation in our estimates of selection. First, our SNPs may be incompletely associated with causal mutations that influence the pattern of flower colour (as is usually the case for genetic markers used to study local adaptation). Since their association with the underlying causal loci is almost certainly incomplete, we will inevitably underestimate the strength of direct selection. For example, multiple maker SNPs have been developed around the <italic>SULF</italic> locus. We analysed the one with a broader cline, whilst the SNP analysed by <xref ref-type="bibr" rid="R10">Bradley et al. (2025)</xref> shows a narrower cline and a closer association with yellow score, but also has much more missing data (which may be due to a deletion in this region; see <xref ref-type="supplementary-material" rid="SD1">Fig. S14</xref> for comparison of cline shapes between these markers). This partly explains the difference in the estimates of selection for SULF between these studies. Thus, we may be underestimating selection at this locus due to our choice of SNP. Second, the causal loci themselves are complex, and may involve multiple causal sites, and structural variation. There are several coding genes around <italic>ROS</italic> and recombinants with <italic>EL</italic> are found at appreciable frequency (<xref ref-type="bibr" rid="R44">Tavares et al., 2018</xref>); similarly, at <italic>FLA</italic>, a recombinant haplotype is found between the two parental populations (<xref ref-type="bibr" rid="R10">Bradley et al. (2025)</xref>, <xref ref-type="fig" rid="F4">Fig. 4H</xref>). We now have whole genome sequences for a smaller sample of ~1000 individuals from across the cline. In future work, we aim to fit a model using the set of clines surrounding one (or more) selected sites, reflecting the flow of haplotypes past a local genetic barrier.</p><p id="P36">A unique feature of our study, critical to our main findings, is that we inferred the full dispersal distribution by combining parent-offspring trios (from Field et. al, in prep) with identification of long-distance migrants. This showed that dispersal was highly leptokurtic with primarily short range dispersal, but also a long tail of dispersal that extends beyond 1km (<xref ref-type="fig" rid="F5">Fig. 5B</xref>). Leptokurtic pollen dispersal is commonly observed in bee-pollinated plant species, and has already been documented over a smaller scale in a paternity study in snapdragons from our study area (<xref ref-type="bibr" rid="R13">Ellis et al., 2024</xref>). The bees that pollinate snapdragons (<italic>Bombus</italic> spp.) tend to forage locally, but are routinely recorded moving longer distances well beyond 1 km (<xref ref-type="bibr" rid="R45">Walther-Hellwig and Frankl, 2000</xref>; <xref ref-type="bibr" rid="R28">Osborne et al., 2008</xref>). We found that the seed dispersal distribution was also leptokurtic, with a small fraction of dispersal events exceeding 1 km. Although the vector for long range seed dispersal is not clear, the patchy distribution of the species requires long distance seed dispersal. Moreover, snapdragons are often observed growing on the roofs of buildings and high on the stone walls of churches and castles, also suggesting that long distance seed dispersal is quite common. Leptokurtic dispersal is not unique to snapdragons, yet in most cases, direct estimates of the full dispersal distribution, such as those that come from our pedigree, are not feasible in short-term studies. Nevertheless, it may be possible to estimate both short and long-range dispersal from LD in the centre and in the flanks of the hybrid zone, and then use these to estimate the strength of selection required to explain clines in allele frequency. While this approach would require large samples both within and outside the hybrid zone and is sensitive to assumptions about the life cycle, it may give robust estimates of the selection that maintains divergence in nature.</p><p id="P37">We also used a novel approach to estimate the strength of selection. Most studies of hybrid zones infer selection from cline widths which are determined by fitting descriptive cline models to allele frequency data (<xref ref-type="fig" rid="F3">Fig. 3B</xref>). This approach is problematic. First, comparisons between single estimates of the width or centre can be misleading if they are made by fitting different models, and are given without support limits (which may be wide even when sample sizes are large). Moreover, the estimates of width can vary substantially depending upon the cline model that is fitted (<xref ref-type="bibr" rid="R1">Baird and Macholán, 2012</xref>). Indeed, the choice of model partly explains the differences in width between our study and other analyses of this zone which only fit a sigmoid cline (<xref ref-type="bibr" rid="R10">Bradley et al., 2025</xref>; <xref ref-type="bibr" rid="R15">Field et al., 2025</xref>). Second, the more complex descriptive models are not based on an explicit model of selection, and include impossible discontinuities in slope. Rather than relying on estimates of width, we inferred selection using a simulation framework that was underpinned by an explicit model of selection. This allowed us to include the full dispersal kernel together with multilocus selection. Although the diffusion approximation would be accurate in the limit of weak selection (assuming finite moments), here selection is moderate and long-distance dispersal is so strong that <italic>σ</italic> does not accurately describe dispersal in this system. By using the full dispersal kernel, we obtained estimates of selection that are quite different from those obtained using traditional theory, which substantially underestimated <italic>s</italic> for some loci (<xref ref-type="table" rid="T3">Table 3</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S12</xref>).</p><p id="P38">Nevertheless, our framework has important limitations. First, it approximates the effects of dominance, epistasis and frequency dependence by assuming a linear change in selection coefficient across the hybrid zone, and does not include the additional LD that might be generated by epistasis; this might explain why the simulation fails to fully capture the observed cline shapes for some loci. We also assumed selection on diploids and equal haplotype frequencies in seed and pollen, but in reality, selection on flower colour is thought to act mainly through pollination and the actual life cycle depends on movements of both seed and pollen. Finally, the simulation framework ignores the effect of heterogeneous population density, which is known to shape patterns of isolation by distance in the snapdragon hybrid zone (<xref ref-type="bibr" rid="R39">Surendranadh et al., 2022</xref>)). Elaborating the model to include these factors may improve the fit between the observed and simulated data, yielding more precise estimates of selection in future.</p><p id="P39">Our simulation scheme allowed us to disentangle some potential causes of the stepped cline shapes. Specifically, we were able to separate the effects of long-range dispersal and LD on cline shape, showing that long-distance dispersal plays a much greater role. However, other factors may have contributed to the stepped shape. First, cline shape is determined primarily by the effective selection on each allele, which must be negative on one side and positive on the other: our basic model simply estimates these two parameters. However, dominance, epistasis and frequency-dependent selection will cause additional distortions in cline shape, but these are hard to disentangle from the strong effects of dispersal; we are skeptical that we could fit a more complex selection model. Second, our SNPs are only markers, linked to the causal alleles that are actually selected. Although a linked neutral locus will experience a barrier to gene flow due to its association with a selected one, it will inevitably recombine onto the alternative genetic background, allowing it to introgress across the cline. This introgression causes the cline to become stepped, with more pronounced tails of introgression observed for SNPs further along the chromosome from the selected site. As discussed above, future work will aim to explore this effect by jointly fitting the set of marker clines around each selected locus.</p><p id="P40">Finally, our study highlights the need for more nuanced interpretations of cline shape that go beyond explanations from traditional hybrid zone theory. The conventional interpretation of stepped clines is that they reflect a multilocus barrier to gene flow which reduces diffusive gene exchange across the cline centre. In our study, however, we found that stepped clines are instead primarily caused by long distance dispersal. Thus, we would substantially overestimate the strength of the genetic barrier to gene flow if we based this on the ratio between the size of the central step (spanning ~1km), and the gradient in allele frequency on either side (<italic>B</italic> = Δ<italic>p/p</italic>′ ;<xref ref-type="bibr" rid="R40">Szymura and Barton (1986)</xref>; <xref ref-type="bibr" rid="R46">Westram et al. (2022)</xref>). We show that reproductive isolation in snapdragons is due to reductions in two components of dispersal - namely diffusive gene flow and long-range dispersal. Further work is needed to deepen our understanding of how hybrid zones function as barriers to gene exchange, how those barriers can be estimated and to explore the effect of long-distance migrants on RI in other systems.</p></sec><sec id="S10" sec-type="methods"><label>4</label><title>Methods</title><sec id="S11"><label>4.1</label><title>Sample collection and processing</title><p id="P41">The study site was visited annually from 2009 to 2019 during the main flowering season (late May-early August), aiming to sample every flowering individual. Within the study area, the same locations were re-visited several times over the period, to ensure that we captured plants that flowered at different times during the season. The sampling area encompasses a central region where the majority of plants are hybrids, and flanking regions with mainly parental types (<xref ref-type="fig" rid="F2">Fig. 2C, D</xref>).</p><p id="P42">The geographic location of each plant was recorded with GeoXT handheld GPS units (Trimble, Sunnydale, CA, USA). Repeated visits to the sampled plants over the years have allowed us to quantify the mean position error of these GPS units as ±3.7 meters. We also collected leaf tissue for later genotyping, preserved by desiccating in silica gel. Additionally, we collected one flower to score the intensity and pattern of the yellow and magenta pigments.</p></sec><sec id="S12"><label>4.2</label><title>Scoring of flower colour</title><p id="P43">Each flower was visually scored for magenta and yellow colouration based on the intensity and spread of the pigments (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>). The magenta scores ranged from 0.5 to 5, with a score of 0.5 showing no presence of magenta pigment to 5 showing intense magenta pigmentation throughout the corolla. Similarly, each flower was scored for yellow colouration, ranging from 0.5 (no yellow or yellow colour restricted to the bee entry point) to 3 (full yellow).</p></sec><sec id="S13"><label>4.3</label><title>Development of SNPs and genotyping</title><p id="P44">A panel of 248 KASP SNPs spread throughout the genome was developed previously (see Methods in <xref ref-type="bibr" rid="R34">Ringbauer et al. (2018)</xref>; <xref ref-type="bibr" rid="R39">Surendranadh et al. (2022)</xref>; <xref ref-type="bibr" rid="R15">Field et al. (2025)</xref>). These include markers for divergent loci within or tightly linked to genes responsible for colour differences in snapdragons. All genotyping was conducted by LGC Genomics. Furthermore, error rates of these SNPs, estimated from 6000 plants that were genotyped more than once, were found to be low with an average probability 2 ∗ 10<sup>−4</sup> of misassignment to a different genotype (Field et al. in prep). We selected representative SNPs that are linked to known flower colour genes to understand the action of selection and dispersal on spatial genetic variation (<xref ref-type="table" rid="T1">Table 1</xref>). We had multiple linked loci to choose from, so we picked the one that showed the highest allele frequency difference between magenta and yellow ends, while also having low missing data.</p></sec><sec id="S14"><label>4.4</label><title>Clustering individuals into demes</title><p id="P45">Rather than considering the individual position of each plant, we clustered neighboring plants into local demes. This was done for two reasons. First, the precise location of each sampled individual makes hardly any difference to the likelihood of a model in which allele frequencies change over a broad spatial scale but greatly increases the computational burden of cline-fitting. Second, we include fluctuations in the true allele frequency in our cline model, which are generated by the evolutionary process, as well as sampling error, to ensure that large demes are not given undue weight (see <xref ref-type="sec" rid="S16">‘Fitting clines to genetic data’</xref>).</p><p id="P46">Our clustering algorithm randomly selects the first individual, and then groups all individuals within the specified radius <italic>δ</italic> of the focal plant into a deme. It then moves on to the next available individual and repeats the process until all individuals have been grouped. We initially clustered individuals for a range of values of <italic>δ</italic>= <italic>{</italic>10, 15, 20, 25, 30, 40, 50, 75, 100, 120, 150, 175, 200, 250, 300m<italic>}</italic> and calculated the realized number and size of demes (Table. S1). From these, we chose a deme size based on two criteria. First, we checked if there were enough individuals in each deme to estimate local allele frequencies and LD. Second, we checked that <italic>F</italic><sub><italic>IS</italic></sub> was not inflated by the Wahlund effect (Wahlund 1928); (i.e., as <italic>δ</italic> increases, <italic>F</italic><sub><italic>IS</italic></sub> increases, due to isolation by distance). This was assessed by checking for departures from Hardy-Weinberg equilibrium for each deme size (see section ‘Deviations from HWE’ below). The spatial coordinates for each deme were calculated as the average from all plants within the deme.</p></sec><sec id="S15"><label>4.5</label><title>Mapping onto a 1D transect</title><p id="P47">In Val de Ribes, the population of <italic>A</italic>.<italic>m. majus</italic> follows the south-facing slope of the valley, and so is essentially one-dimensional, with snapdragons primarily being found within 100m of two roughly parallel roads. We transform the data by mapping locations {<italic>x, y</italic>} onto a one-dimensional transect line. The distance along the transect is denoted by <italic>z</italic>. We established the transect line by fitting polynomials of degrees 1 to 8 to the deme positions, and minimising the mean square residuals (see SM S1). A polynomial of degree 6 was found to fit the data well (white curve in <xref ref-type="fig" rid="F2">Fig. 2C and D</xref>), with most plants following the curve. We found little improvement from higher-order terms. For each deme, the point on the curve closest to the deme is found, and the new coordinate <italic>z</italic> is the distance to this point along the curve. The transect has an arbitrary starting point <italic>{</italic>410300, 4684000<italic>}</italic> and ranges from 0 to ~30 km.</p></sec><sec id="S16"><label>4.6</label><title>Fitting clines to genetic data</title><p id="P48">We fit three cline models to the frequency of the <italic>pseudomajus</italic> allele along the transect for all clinal SNPs. The first model (sigmoid) has allele frequencies ranging from 0 to 1, as predicted for selection against heterozygotes (<xref ref-type="bibr" rid="R9">Bazykin, 1969</xref>), symmetric epistasis (<xref ref-type="bibr" rid="R8">Bazykin, 1973</xref>) or frequency-dependent selection with no dominance, <inline-formula><mml:math id="M20"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> where <italic>c</italic> is the cline centre and <italic>w</italic> is the cline width (<xref ref-type="fig" rid="F1">Fig. 1A</xref>); other single-locus models give a similar shape (<xref ref-type="bibr" rid="R5">Barton and Gale, 1993</xref>). We also include random variation in allele frequency around the cline, measured by <italic>F</italic><sub><italic>ST</italic></sub> ; sampled frequencies are binomially distributed around the underlying frequency, which follows a Beta distribution with variance <italic>pqF</italic><sub><italic>ST</italic></sub> (<xref ref-type="bibr" rid="R38">Slatkin and Barton, 1989</xref>). Thus, we have three parameters {<italic>c, w, F</italic><sub><italic>ST</italic></sub>}.</p><p id="P49">For the second model (sigmoid with polymorphism), we adjust the sigmoid curve by allowing for polymorphism on either side: <inline-formula><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. This model has 5 parameters {<italic>c, w, p</italic><sub>0</sub>, <italic>p</italic><sub>1</sub>, <italic>F</italic><sub><italic>ST</italic></sub>}. For the third model (stepped), we splice exponential functions onto the left and right sides, <inline-formula><mml:math id="M22"><mml:mrow><mml:mi>A</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msqrt><mml:mi>θ</mml:mi></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="R40">Szymura and Barton (1986</xref>, <xref ref-type="bibr" rid="R41">1991</xref>), <xref ref-type="fig" rid="F1">Fig. 1B</xref>). This provides a model of a stepped cline with a sigmoid shape in the centre and long exponential tails of introgression on either side. The parameter <italic>θ</italic> gives the rate of decay of the tail, slower than predicted by the simple sigmoid model (i.e. <italic>θ</italic> ¡1). The constant <italic>A</italic> is defined by the strength of the barrier to gene flow, defined by <italic>B</italic> = Δ<italic>p/p</italic><italic>′</italic>, where Δ<italic>p</italic> = <italic>p</italic><sub>1</sub> − <italic>p</italic><sub>0</sub> is the difference in allele frequencies at the transition from sigmoid to exponential and <inline-formula><mml:math id="M23"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:msqrt><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is the gradient in allele frequency at the edge of the central segment (see electronic SM code for details). Introgression may be symmetric or asymmetric, and so we estimate <italic>{θ, B}</italic> separately on either side. Thus, we have seven parameters <italic>c, w, θ</italic><sub>0</sub>, <italic>B</italic><sub>0</sub>, <italic>θ</italic><sub>1</sub>, <italic>B</italic><sub>1</sub>, <italic>F</italic><sub><italic>ST</italic></sub>.</p><p id="P50">The parameters are estimated using the Metropolis Hastings algorithm (<xref ref-type="bibr" rid="R25">Metropolis et al., 1953</xref>; <xref ref-type="bibr" rid="R40">Szymura and Barton, 1986</xref>), which generates a random walk that follows the likelihood: random changes are made to the parameter set and the changes are accepted if they increase the likelihood or rejected otherwise. More formally, we start with an initial parameter set and its likelihood <italic>L</italic>. Uniformly random changes [−<italic>δ, δ</italic>] are made to each parameter sequentially and the new likelihood <italic>L</italic><sup><italic>′</italic></sup>is calculated. If <italic>L</italic><italic>′</italic><italic>/L</italic> is greater than a uniform random number between 0 and 1, the change is accepted and parameters and likelihood are reset to the new values. Further, we set <italic>δ</italic> to <italic>λδ</italic>, where <italic>λ</italic> =1.01. If <italic>L</italic><sup><italic>′</italic></sup><italic>/L</italic> is less than the random number, we reject the change, but set <italic>δ</italic> to <italic>δ/λ</italic>. With enough trials, this will generate a distribution proportional to <italic>L</italic>. The size of changes, <italic>δ</italic>, is tuned for efficiency, ensuring that similar numbers of changes are accepted as rejected. Cycling through each set of parameters 3000 times assured convergence.</p><p id="P51">For each locus, this fitting process was conducted separately for each model. The best fit of the three cline models was determined for each locus using likelihood ratio tests (<xref ref-type="bibr" rid="R20">Kawakami et al., 2009</xref>). For the best model, the maximum likelihood estimates (MLE) of the parameters were used to obtain the cline shape. The Metropolis Hastings algorithm not only gives the MLE but also provides the marginal likelihoods of parameters.</p></sec><sec id="S17"><label>4.7</label><title>Comparing clines over time</title><p id="P52">The stepped cline model was employed to fit clines for <italic>ROS</italic> at various time points, since this model gave the best fit when considering all years collectively. 11 years of data are separated into three time points; 2009 to 2012, 2013 to 2015 and 2016 to 2019 with 7690, 12409 and 7384 individuals respectively. Pooling individuals from 3 to 4 years into a single time point is a valid assumption as <italic>A</italic>.<italic>m. majus</italic> has overlapping generations and average dormancy of 3-4 years (as observed from the pedigree trios in Field et al. in prep.).</p></sec><sec id="S18"><label>4.8</label><title>Cline fit for the phenotypic data</title><p id="P53">Magenta and yellow colour scores for each individual were rescaled so that they fell between 0 (minimum) and 1 (maximum). We then calculated the mean colour score for each deme which ranged from 0 to 0.889 for magenta and 0 to 1 for yellow. We fit the same three cline models to these mean values to identify the best-fitting model and MLE of each parameter, as described above for the genetic data (see section <xref ref-type="sec" rid="S16">‘Fitting clines to genetic data’</xref>).</p></sec><sec id="S19"><label>4.9</label><title>Deviations from Hardy Weinberg equilibrium</title><p id="P54">The deficit of heterozygotes relative to the Hardy-Weinberg expectation, <italic>F</italic><sub><italic>IS</italic></sub>, is calculated for each deme, as one minus the ratio of observed and expected number of heterozygotes for each unlinked clinal locus at the clustering scale of <italic>δ</italic> =25m. This was done by first selecting 337 of 999 demes with at least 10 individuals, and then dividing the transect into 12 bins such that each bin contains a roughly equal number of demes (see <xref ref-type="supplementary-material" rid="SD1">Table S4</xref>). The mean and standard deviation of <italic>F</italic><sub><italic>IS</italic></sub> were computed for each bin. A null distribution of <italic>F</italic><sub><italic>IS</italic></sub> was also generated for each locus and deme by making 1000 replicate draws of diploid genotypes, fixing allele counts as observed, but combining alleles at random. The observed and the null distribution were then compared to check for demes (and bins) that showed significant deviations from Hardy Weinberg equilibrium. Significance was based on the p-value for each deme, i.e. the fraction of shuffled replicates with <italic>F</italic><sub><italic>I</italic><italic>S</italic></sub> less than the observed if the latter is less than 0 and greater than observed otherwise.</p></sec><sec id="S20"><label>4.10</label><title>Linkage disequilibrium based on hybrid index</title><p id="P55">Linkage disequilibrium (LD) between two unlinked loci was estimated from the variance in hybrid index (HI) as <inline-formula><mml:math id="M24"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic>V</italic><sub><italic>P</italic><italic>Q</italic></sub> is the variance due to heterozygosity and <italic>V</italic><sub><italic>F</italic></sub> is the variance due to heterozygote deficit. Since missing data could be correlated across loci and generate a positive bias in the estimator, <inline-formula><mml:math id="M25"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> was measured based on pairs of loci. Individuals with missing data at either of the two loci in consideration were deleted and <inline-formula><mml:math id="M26"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was estimated based on HI calculated from the 2 loci. <inline-formula><mml:math id="M27"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is then the average of <inline-formula><mml:math id="M28"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>for <inline-formula><mml:math id="M29"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was first estimated for each locus pair for the whole population to check for significant associations between loci. Next, we looked at how average associations between loci change across the geographic range. <inline-formula><mml:math id="M30"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> was found for the 12 bins as above (see section <xref ref-type="sec" rid="S19">‘Deviations from Hardy Weinberg equilibrium’</xref>) by considering 337 demes with at least 10 individuals. In each case, a null distribution was generated by shuffling genotypes across loci for 1000 replicates, thereby preserving HW deviations but generating linkage equilibrium. A p-value was obtained for each deme by finding the fraction of shuffled replicates that gave values less than observed if the latter is less than 0 and greater than observed otherwise.</p></sec><sec id="S21"><label>4.11</label><title>Estimating long-range dispersal for <italic>A</italic>.<italic>m. majus</italic></title><p id="P56">2342 pedigree trios inferred by Field et al. (in prep.) give estimates of pollen and seed dispersal, which extend out to ~1km. he pollen dispersal is close to a log-Gaussian distribution for distances up to 600 m that can be estimated reliably from the trios (<xref ref-type="fig" rid="F5">Fig. 5</xref>). We used this log-Gaussian distribution for pollen dispersal, <italic>extrapolating it out</italic> to longer distances: <inline-formula><mml:math id="M31"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where the MLE of mean (<italic>z</italic>) and standard deviation (<italic>σ</italic>) of <italic>log</italic><sub><italic>e</italic></sub><italic>r</italic> were 2.88 and 1.64 respectively (corresponding to a geometric mean pollen dispersal distance of <italic>e</italic><sup>2.88</sup> = 17.8m).</p><p id="P57">However, longer-range dispersal will be underestimated from the pedigree trios, because parents are increasingly likely to be outside our study area. We do not make a detailed analysis of this bias, but instead, only consider seed dispersal up to 300m, which is typically much less than the distance to the nearest populations outside our study area. Longer-range seed dispersal beyond 300m is estimated from individuals that have genotypes most likely to come from the opposite side of the hybrid zone. We treat the yellow and magenta flanks separately, and now work in one dimension, since that better describes the transect over large scales.</p><p id="P58">The actual population has a complex spatial distribution, concentrated around two main roads, but spreading out to either side. Estimates based on the pedigree trios (<xref ref-type="fig" rid="F5">Fig. 5A</xref>) approximate short-range dispersal (&lt; 300<italic>m</italic>) as two-dimensional, described by a radial distribution. The one-dimensional distribution along some axis (which required for fitting clines) is derived by convolving with <inline-formula><mml:math id="M32"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>π</mml:mi><mml:msqrt><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> which is the probability of moving −<italic>r &lt; x &lt; r</italic> in a random direction, given <italic>r</italic>. We can then derive the distribution of net short-range dispersal by using the fact that a gene has an equal chance of coming from the mother (via seed dispersal), or the father (via seed plus pollen dispersal). Therefore, the net distribution is an equal mixture of the seed dispersal, and the convolution of seed with pollen dispersal.</p><p id="P59">We estimate longer-range dispersal (up to several km) from individuals that have genotypes typical of the opposite side of the hybrid zone, based on the 5 unlinked SNP; these individuals are presumed to have arrived by seed dispersal. <xref ref-type="supplementary-material" rid="SD1">Table S8</xref> assigns individuals as immediate dispersers, F1, backcross, …, based on the observed allele frequencies in the flanks, and assuming Hardy-Weinberg and linkage equilibrium (HWLE; see S3); this shows that a few percent of the populations in the flanks are likely to have arrived by seed dispersal in the previous generation. However, we estimate long-range dispersal using a more sophisticated method, based on the likelihood of the mother’s location, and assuming exponential tails. (We have little power to distinguish alternative kernels in the tails, so this choice is arbitrary). The probability <italic>P</italic> (<italic>X, z</italic>) of finding an individual with genotype <italic>X</italic> at location <italic>z</italic> is: <inline-formula><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This is an integral over the probability <italic>f</italic><sub><italic>seed</italic></sub>(<italic>x</italic><sub><italic>s</italic></sub>) that the mother was <italic>x</italic><sub><italic>s</italic></sub> away, times the probability <italic>f</italic><sub><italic>pollen</italic></sub>(<italic>x</italic><sub><italic>p</italic></sub>) that the father was <italic>x</italic><sub><italic>p</italic></sub> away from the mother, times the probability <italic>G</italic> that the offspring has genotype <italic>X</italic>, given the allele frequencies at the parents’ locations, assuming HWLE; this is calculated as a product of allele frequencies across loci, with factors <italic>{q</italic><sub><italic>y</italic></sub><italic>q</italic><sub><italic>z</italic></sub>, <italic>p</italic><sub><italic>y</italic></sub><italic>q</italic><sub><italic>z</italic></sub> + <italic>p</italic><sub><italic>z</italic></sub><italic>q</italic><sub><italic>y</italic></sub>, <italic>p</italic><sub><italic>y</italic></sub><italic>p</italic><sub><italic>z</italic></sub><italic>}</italic>, where <italic>p</italic><sub><italic>y</italic></sub> and <italic>p</italic><sub><italic>z</italic></sub> refer to the allele frequencies at locations <italic>y</italic> and <italic>z</italic> respectively predicted from the cline fits at that locus (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>), and <italic>q</italic> = 1 − <italic>p</italic> (see <xref ref-type="supplementary-material" rid="SD1">S3</xref> for more details). <italic>f</italic><sub><italic>seed</italic></sub> is the seed dispersal distribution, which takes the form estimated directly from the trios up to 300m, and is then spliced onto <inline-formula><mml:math id="M34"><mml:mrow><mml:mi>A</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>λ</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> for distances greater than <italic>x</italic>= 300m. The log likelihood for <italic>λ</italic> in either flank is estimated by summing <italic>log</italic>(<italic>P</italic>(<italic>X, z</italic>) across all individuals in the dataset; <italic>A</italic> is determined by splicing at 300m.</p></sec><sec id="S22"><label>4.12</label><title>Estimating strength of selection from simulated clines</title><sec id="S23"><title>Simulation framework</title><p id="P60">We consider a deterministic stepping stone model with 45 unevenly spaced demes that range from -13.5 to +13.5 km. The demes are located at <italic>{</italic>…, −<italic>δϕ</italic><sup>2</sup>, −<italic>δϕ</italic>, 0, <italic>δϕ, δϕ</italic><sup>2</sup>, … <italic>}</italic> where <italic>δ</italic> =50 and <italic>ϕ</italic> =1.2. This spacing was chosen so that demes span the length of the one-dimensional transect, but are concentrated near the centre, where allele frequencies change most rapidly. We start with a sigmoid cline of width 4 km centreed at 0, which gives the initial frequencies of 2<sup><italic>l</italic></sup> haplotypes at each deme, assuming <italic>l</italic> biallelic loci under linkage equilibrium.</p><p id="P61">We use the estimated dispersal distribution to simulate clines along a one-dimensional transect. Each deme is centred at a point, and extends half-way towards its neighbours on either side; the fraction that move is given by integrating over the span of the deme. We assume uniform density, so that the number in each deme is proportional to its span. The backwards migration matrix is calculated from the CDF of net dispersal, by calculating the fraction of genes in each deme that came from every other deme in the previous generation. Because we estimated different exponential tails on either sides, we interpolate their distance scale using a logistic function, such that at distance <italic>z</italic> along the transect from the centre, <inline-formula><mml:math id="M35"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mi>z</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>z</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Asymmetric dispersal causes the clines to move. To overcome the computational burden of recalculating the migration matrix, we fix the locations of demes and shift the clines to be centred at 0 every 10 generations. The cline centre is defined as the location at which the gradient of the interpolated cline is steepest.</p><p id="P62">The simulation follows the haplotype frequencies at each deme for 500 generations; random union of gametes is followed by selection on diploid genotype, meiosis and migration of haploids. Note that the simulations only follow haplotype frequencies under HW equilibrium, assuming the same allele frequencies in pollen and ovule. We simulated clines at a single locus with heterozygote disadvantage and Gaussian dispersal to check that simulations gave results consistent with theory.</p></sec><sec id="S24"><title>Estimating selection coefficients</title><p id="P63">This model was used to simulate clines, either considering a single locus or 5 unlinked loci. As above (see ‘Fitting clines at genetic loci’), we assume that observed allele frequencies are sampled binomially from an underlying Beta distribution, with variance <italic>F<sub>pq</sub></italic>. When we fit single loci, we assume symmetric selection <italic>s</italic>(fitnesses 1+<italic>s</italic> : 1 : 1+<italic>s</italic>), and estimate <italic>s, c</italic> (cline centre), <italic>F</italic> (standardised variance), giving 5*3=15 parameters across 5 loci. For multilocus clines, we allowed asymmetric selection at each locus (fitnesses 1 + <italic>s</italic> <sub><italic>left</italic></sub> : 1 : 1+<italic>s</italic><sub><italic>right</italic></sub>), multiplicative across loci; we assume a single value of <italic>c</italic> and <italic>F</italic> for all loci, giving a total of 2+5*2=12 parameters.</p><p id="P64">For single-locus clines, we first maximise likelihood estimates of <italic>c</italic> and <italic>F</italic> for given <italic>s</italic>, and then find the most likely <italic>s</italic>; this avoids unnecessary simulation. With multiple loci, the MLE of parameters at each locus depends on the allele frequencies at all other loci. We start with the MLE of <italic>s</italic> from the single locus fits, and then follow the single locus procedure for each locus in turn, finding a new set of selection coefficients, now allowing asymmetry (<italic>s</italic><sub><italic>left</italic></sub>, <italic>s</italic><sub><italic>r</italic><italic>ight</italic></sub>). This procedure is repeated until estimates converge.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Materials</label><media xlink:href="EMS207037-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d53aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S25"><title>Acknowledgements</title><p>We thank Enrico Coen, Desmond Bradley, and other members of the Coen Group at the John Innes Centre for their extensive contributions to the fieldwork, development of genetic resources and detailed insights about the genetic basis of colour upon which this study depends. We thank all the interns and field managers, including Eva Cereghetti, Beatriz Pablo Carmona, Mariona Vinyeta, Helena Ramirez, and all volunteers who have helped us with field work and processing over the years. We thank Eva Salmerón Mateu for her help with logistics at the field station in El Serrat, Planoles. We also thank all the members of the Barton Group, especially Tom Ellis, Harald Ringbauer, Melinda Pickup, Carina Baskett, Maria Melo Hurtado for supporting the fieldwork and for feedback on this work.</p><sec id="S26"><title>Funding</title><p>This work was funded by Austrian Science Fund FWF (grant P32166) and ERC grant (101055327).</p></sec></ack><fn-group><fn fn-type="con" id="FN1"><p id="P65"><bold>Author Contributions</bold></p><p id="P66">Team led by Enrico Coen and Nicholas H. Barton established the intensive sampling scheme which was initially funded by a BBSRC grant awarded to EC and later funded by NB. All authors contributed to the fieldwork. PS, DF and NB conceived the idea, DF built the data management pipeline and generated the SNP panel, PS and NB performed the analyses. PS, SS and NB wrote the manuscript. All authors contributed to editing the manuscript.</p></fn><fn fn-type="conflict" id="FN2"><p id="P67"><bold>Conflict of Interest</bold></p><p id="P68">The authors declare no conflict of interest.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Baird</surname><given-names>SJ</given-names></name><name><surname>Macholán</surname><given-names>M</given-names></name></person-group><chapter-title>What can the mus musculus musculus/m. m. domesticus hybrid zone tell us about speciation?</chapter-title><source>Evolution of the House Mouse</source><publisher-name>Cambridge University Press</publisher-name><year>2012</year><fpage>334</fpage><lpage>372</lpage></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>The dynamics of hybrid zones</article-title><source>Heredity</source><year>1979a</year><volume>43</volume><fpage>341</fpage><lpage>359</lpage></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Gene flow past a cline</article-title><source>Heredity</source><year>1979b</year><volume>43</volume><issue>3</issue><fpage>333</fpage><lpage>339</lpage></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Multilocus clines</article-title><source>Evolution</source><year>1983</year><volume>37</volume><fpage>454</fpage><lpage>471</lpage><pub-id pub-id-type="pmid">28563316</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Gale</surname><given-names>KS</given-names></name></person-group><chapter-title>Genetic analysis of hybrid zones</chapter-title><person-group person-group-type="editor"><name><surname>Harrison</surname><given-names>R</given-names></name></person-group><source>Hybrid Zones and the Evolutionary Process</source><publisher-name>Oxford University Press</publisher-name><year>1993</year><fpage>13</fpage><lpage>45</lpage></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Hewitt</surname><given-names>GM</given-names></name></person-group><article-title>Analysis of hybrid zones</article-title><source>Annu Rev Ecol Syst</source><year>1985</year><volume>16</volume><fpage>113</fpage><lpage>148</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Shpak</surname><given-names>M</given-names></name></person-group><article-title>The stability of symmetric solutions in evolutionary models</article-title><source>Theoretical Population Biology</source><year>1990</year><volume>38</volume><fpage>210</fpage><lpage>224</lpage><pub-id pub-id-type="pmid">10828217</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazykin</surname><given-names>A</given-names></name></person-group><article-title>Population genetical analysis of disruptive and stabilizing selection. ii. adjacent populations with continuous area</article-title><source>Genetika, Moskva</source><year>1973</year><volume>9</volume><fpage>156</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">4456620</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bazykin</surname><given-names>AD</given-names></name></person-group><article-title>Hypothetical mechanism of speciation</article-title><source>Evolution</source><year>1969</year><volume>23</volume><fpage>685</fpage><lpage>687</lpage><pub-id pub-id-type="pmid">28562864</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>D</given-names></name><name><surname>Boell</surname><given-names>L</given-names></name><name><surname>Richardson</surname><given-names>D</given-names></name><name><surname>Copsey</surname><given-names>L</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Xu</surname><given-names>T</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Field</surname><given-names>D</given-names></name><name><surname>Coen</surname><given-names>E</given-names></name></person-group><article-title>Shaping of developmental gradients through selection on multiple loci in <italic>Antirrhinum</italic></article-title><source>bioRxiv</source><year>2025</year></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>D</given-names></name><name><surname>Xu</surname><given-names>P</given-names></name><name><surname>Mohorianu</surname><given-names>II</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Field</surname><given-names>D</given-names></name><name><surname>Tavares</surname><given-names>H</given-names></name><name><surname>Couchman</surname><given-names>M</given-names></name><name><surname>Copsey</surname><given-names>L</given-names></name><name><surname>Carpenter</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Evolution of flower color pattern through selection on regulatory small RNAs</article-title><source>Science</source><year>2017</year><volume>358</volume><fpage>925</fpage><lpage>928</lpage><pub-id pub-id-type="pmid">29146812</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cayuela</surname><given-names>H</given-names></name><name><surname>Rougemont</surname><given-names>Q</given-names></name><name><surname>Prunier</surname><given-names>JG</given-names></name><name><surname>Moore</surname><given-names>JS</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Besnard</surname><given-names>A</given-names></name><name><surname>Bernatchez</surname><given-names>L</given-names></name></person-group><article-title>Demographic and genetic approaches to study dispersal in wild animal populations: A methodological review</article-title><source>Molecular Ecology</source><year>2018</year><volume>27</volume><issue>20</issue><fpage>3976</fpage><lpage>4010</lpage><pub-id pub-id-type="pmid">30152121</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellis</surname><given-names>TJ</given-names></name><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Joint estimation of paternity, sibships and pollen dispersal in a snapdragon hybrid zone</article-title><source>bioRxiv</source><year>2024</year></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Endler</surname><given-names>JA</given-names></name></person-group><article-title>Geographic Variation, Speciation, and Clines</article-title><source>Monogr Popul Biol</source><year>1977</year><volume>10</volume><comment>books.google.com</comment><pub-id pub-id-type="pmid">409931</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Stankowski</surname><given-names>S</given-names></name><name><surname>Reiter</surname><given-names>T</given-names></name><name><surname>Polechova</surname><given-names>J</given-names></name><name><surname>Bradley</surname><given-names>D</given-names></name><name><surname>Richardson</surname><given-names>D</given-names></name><name><surname>Pal</surname><given-names>A</given-names></name><name><surname>Shipilina</surname><given-names>D</given-names></name><name><surname>Boell</surname><given-names>L</given-names></name><name><surname>Pickup</surname><given-names>M</given-names></name><etal/></person-group><article-title>Genome-wide cline analysis identifies new locus contributing to a barrier to gene flow across an <italic>Antirrhinum</italic> hybrid zone</article-title><source>bioRxiv</source><year>2025</year></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>JBS</given-names></name></person-group><article-title>The theory of a cline</article-title><source>J Genet</source><year>1948</year><volume>48</volume><fpage>277</fpage><lpage>284</lpage><pub-id pub-id-type="pmid">18905075</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>RG</given-names></name></person-group><article-title>Hybrids and hybrid zones: Historical perspective</article-title><source>Hybrid Zones and the Evolutionary Process, pages</source><year>1993</year><fpage>3</fpage><lpage>12</lpage><comment>books.google.com</comment></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hewitt</surname><given-names>GM</given-names></name></person-group><article-title>Hybrid zones - natural laboratories for evolutionary studies</article-title><source>Trends Ecol Evol</source><year>1988</year><volume>3</volume><fpage>158</fpage><lpage>167</lpage><pub-id pub-id-type="pmid">21227192</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>A</given-names></name><name><surname>Critchley</surname><given-names>J</given-names></name><name><surname>Erasmus</surname><given-names>Y</given-names></name></person-group><article-title>The genus <italic>Antirrhinum</italic> (snapdragon): A flowering plant model for evolution and development</article-title><source>CSH Protoc</source><year>2008</year><volume>2008</volume><elocation-id>db.emo100</elocation-id><pub-id pub-id-type="pmid">21356683</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawakami</surname><given-names>T</given-names></name><name><surname>Butlin</surname><given-names>RK</given-names></name><name><surname>Adams</surname><given-names>M</given-names></name><name><surname>Paull</surname><given-names>DJ</given-names></name><name><surname>Cooper</surname><given-names>SJB</given-names></name></person-group><article-title>Genetic analysis of a chromosomal hybrid zone in the australian morabine grasshoppers (<italic>Vandiemenella, viatica</italic> species group)</article-title><source>Evolution</source><year>2009</year><volume>63</volume><fpage>139</fpage><lpage>152</lpage><pub-id pub-id-type="pmid">18803685</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kruuk</surname><given-names>LEB</given-names></name><name><surname>Baird</surname><given-names>SJE</given-names></name><name><surname>Gale</surname><given-names>KS</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>A comparison of multilocus clines maintained by environmental adaptation or by selection against hybrids</article-title><source>Genetics</source><year>1999</year><volume>153</volume><fpage>1959</fpage><lpage>1971</lpage><pub-id pub-id-type="doi">10.1093/genetics/153.4.1959</pub-id><pub-id pub-id-type="pmcid">PMC1460862</pub-id><pub-id pub-id-type="pmid">10581299</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macholán</surname><given-names>M</given-names></name><name><surname>Munclinger</surname><given-names>P</given-names></name><name><surname>Šugerková</surname><given-names>M</given-names></name><name><surname>Dufková</surname><given-names>P</given-names></name><name><surname>Bímová</surname><given-names>B</given-names></name><name><surname>Božíková</surname><given-names>E</given-names></name><name><surname>Zima</surname><given-names>J</given-names></name><name><surname>Piálek</surname><given-names>J</given-names></name></person-group><article-title>Genetic analysis of autosomal and x-linked markers across a mouse hybrid zone</article-title><source>Evolution</source><year>2007</year><volume>61</volume><issue>4</issue><fpage>746</fpage><lpage>771</lpage><pub-id pub-id-type="pmid">17439609</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Barton</surname><given-names>N</given-names></name></person-group><article-title>Inference from clines stabilized by frequency-dependent selection</article-title><source>Genetics</source><year>1989</year><volume>122</volume><fpage>967</fpage><lpage>976</lpage><pub-id pub-id-type="doi">10.1093/genetics/122.4.967</pub-id><pub-id pub-id-type="pmcid">PMC1203771</pub-id><pub-id pub-id-type="pmid">2759433</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Barton</surname><given-names>N</given-names></name><name><surname>Lamas</surname><given-names>G</given-names></name><name><surname>Santisteban</surname><given-names>J</given-names></name><name><surname>Muedas</surname><given-names>M</given-names></name><name><surname>Eeley</surname><given-names>H</given-names></name></person-group><article-title>Estimates of selection and gene flow from measures of cline width and linkage disequilibrium in <italic>Heliconius</italic> hybrid zones</article-title><source>Genetics</source><year>1990</year><volume>124</volume><issue>4</issue><fpage>921</fpage><lpage>936</lpage><pub-id pub-id-type="doi">10.1093/genetics/124.4.921</pub-id><pub-id pub-id-type="pmcid">PMC1203983</pub-id><pub-id pub-id-type="pmid">2323556</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metropolis</surname><given-names>N</given-names></name><name><surname>Rosenbluth</surname><given-names>AW</given-names></name><name><surname>Rosenbluth</surname><given-names>MN</given-names></name><name><surname>Teller</surname><given-names>AH</given-names></name><name><surname>Teller</surname><given-names>E</given-names></name></person-group><article-title>Equation of state calculations by fast computing machines</article-title><source>The Journal of Chemical Physics</source><year>1953</year><volume>21</volume><issue>6</issue><fpage>1087</fpage><lpage>1092</lpage></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagylaki</surname><given-names>T</given-names></name></person-group><article-title>Clines with asymmetric migration</article-title><source>Genetics</source><year>1976</year><volume>83</volume><fpage>867</fpage><lpage>886</lpage><pub-id pub-id-type="doi">10.1093/genetics/88.4.813</pub-id><pub-id pub-id-type="pmcid">PMC1213819</pub-id><pub-id pub-id-type="pmid">17248820</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nathan</surname><given-names>R</given-names></name><name><surname>Schurr</surname><given-names>FM</given-names></name><name><surname>Spiegel</surname><given-names>O</given-names></name><name><surname>Steinitz</surname><given-names>O</given-names></name><name><surname>Trakhtenbrot</surname><given-names>A</given-names></name><name><surname>Tsoar</surname><given-names>A</given-names></name></person-group><article-title>Mechanisms of long-distance seed dispersal</article-title><source>Trends Ecol Evol</source><year>2008</year><volume>23</volume><fpage>638</fpage><lpage>647</lpage><pub-id pub-id-type="pmid">18823680</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osborne</surname><given-names>JL</given-names></name><name><surname>Martin</surname><given-names>AP</given-names></name><name><surname>Carreck</surname><given-names>NL</given-names></name><name><surname>Swain</surname><given-names>JL</given-names></name><name><surname>Knight</surname><given-names>ME</given-names></name><name><surname>Goulson</surname><given-names>D</given-names></name><name><surname>Hale</surname><given-names>RJ</given-names></name><name><surname>Sanderson</surname><given-names>RA</given-names></name></person-group><article-title>Bumblebee flight distances in relation to the forage landscape</article-title><source>J Anim Ecol</source><year>2008</year><volume>77</volume><fpage>406</fpage><lpage>415</lpage><pub-id pub-id-type="pmid">17986207</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pal</surname><given-names>A</given-names></name><name><surname>Shipilina</surname><given-names>D</given-names></name><name><surname>Moan</surname><given-names>AL</given-names></name><name><surname>McNairn</surname><given-names>AJ</given-names></name><name><surname>Grenier</surname><given-names>JK</given-names></name><name><surname>Kucka</surname><given-names>M</given-names></name><name><surname>Coop</surname><given-names>G</given-names></name><name><surname>Chan</surname><given-names>YF</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Field</surname><given-names>D</given-names></name><etal/></person-group><article-title>Genealogical analysis of replicate flower colour hybrid zones in antirrhinum</article-title><source>bioRxiv</source><year>2025</year><fpage>2025</fpage><lpage>04</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>BL</given-names></name><name><surname>Baird</surname><given-names>SJE</given-names></name><name><surname>Moritz</surname><given-names>C</given-names></name></person-group><article-title>When vicars meet: A narrow contact zone between morphologically cryptic phylogeographic lineages of the rainforest skink, <italic>Carlia rubrigularis</italic></article-title><source>Evolution</source><year>2004</year><volume>58</volume><fpage>1536</fpage><lpage>1548</lpage><pub-id pub-id-type="pmid">15341156</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname><given-names>AH</given-names></name><name><surname>Wenger</surname><given-names>R</given-names></name><name><surname>Geiger</surname><given-names>H</given-names></name><name><surname>Scholl</surname><given-names>A</given-names></name><name><surname>Shapiro</surname><given-names>AM</given-names></name></person-group><article-title>The <italic>Pontia daplidiceedusa</italic> hybrid zone in northwestern Italy</article-title><source>Evolution</source><year>1997</year><volume>51</volume><fpage>1561</fpage><lpage>1573</lpage><pub-id pub-id-type="pmid">28568618</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raufaste</surname><given-names>N</given-names></name><name><surname>Orth</surname><given-names>A</given-names></name><name><surname>Belkhir</surname><given-names>K</given-names></name><name><surname>Senet</surname><given-names>D</given-names></name><name><surname>Smadja</surname><given-names>C</given-names></name><name><surname>Baird</surname><given-names>SJ</given-names></name><name><surname>Boursot</surname><given-names>P</given-names></name></person-group><article-title>Inferences of selection and migration in the Danish house mouse hybrid zone</article-title><source>Biological Journal of the Linnean Society</source><year>2005</year><volume>84</volume><issue>3</issue><fpage>593</fpage><lpage>616</lpage></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>DM</given-names></name><name><surname>Bradley</surname><given-names>D</given-names></name><name><surname>Copsey</surname><given-names>L</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Burrus</surname><given-names>M</given-names></name><name><surname>Andalo</surname><given-names>C</given-names></name><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Xue</surname><given-names>Y</given-names></name><name><surname>Coen</surname><given-names>E</given-names></name></person-group><article-title>Genomic tree scans identify loci underlying adaptive peaks in <italic>Antirrhinum</italic></article-title><source>bioRxiv</source><year>2025</year></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ringbauer</surname><given-names>H</given-names></name><name><surname>Kolesnikov</surname><given-names>A</given-names></name><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Estimating barriers to gene flow from distorted isolation-by-distance patterns</article-title><source>Genetics</source><year>2018</year><volume>208</volume><issue>3</issue><fpage>1231</fpage><lpage>1245</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.300638</pub-id><pub-id pub-id-type="pmcid">PMC5844333</pub-id><pub-id pub-id-type="pmid">29311149</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothmaler</surname><given-names>W</given-names></name></person-group><source>Taxonomische Monographie der Gattung Antirrhinum, &amp;c</source><year>1956</year></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Searle</surname><given-names>JB</given-names></name></person-group><article-title>A hybrid zone comprising staggered chromosomal clines in the house mouse (<italic>Mus musculus domesticus</italic>)</article-title><source>Proceedings of the Royal Society of London Series B: Biological Sciences</source><year>1991</year><volume>246</volume><issue>1315</issue><fpage>47</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">1684667</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Gene flow and selection in a cline</article-title><source>Genetics</source><year>1973</year><volume>75</volume><fpage>733</fpage><lpage>756</lpage><pub-id pub-id-type="doi">10.1093/genetics/75.4.733</pub-id><pub-id pub-id-type="pmcid">PMC1213045</pub-id><pub-id pub-id-type="pmid">4778791</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>A comparison of three indirect methods for estimating average levels of gene flow</article-title><source>Evolution</source><year>1989</year><volume>43</volume><issue>7</issue><fpage>1349</fpage><lpage>1368</lpage><pub-id pub-id-type="pmid">28564250</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Surendranadh</surname><given-names>P</given-names></name><name><surname>Arathoon</surname><given-names>L</given-names></name><name><surname>Baskett</surname><given-names>CA</given-names></name><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Pickup</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Effects of fine-scale population structure on the distribution of heterozygosity in a long-term study of <italic>Antirrhinum majus</italic></article-title><source>Genetics</source><year>2022</year><volume>221</volume><issue>3</issue><elocation-id>iyac083</elocation-id><pub-id pub-id-type="doi">10.1093/genetics/iyac083</pub-id><pub-id pub-id-type="pmcid">PMC9252276</pub-id><pub-id pub-id-type="pmid">35639938</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szymura</surname><given-names>JM</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Genetic analysis of a hybrid zone between the fire-bellied toads, <italic>Bombina bombina</italic> and <italic>B. variegata</italic>, near cracow in southern poland</article-title><source>Evolution</source><year>1986</year><volume>40</volume><fpage>1141</fpage><lpage>1159</lpage><pub-id pub-id-type="pmid">28563502</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szymura</surname><given-names>JM</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>The genetic structure of the hybrid zone between the fire-bellied toads <italic>Bombina bombina</italic> and <italic>B. variegata</italic>: Comparisons between transects and between loci</article-title><source>Evolution</source><year>1991</year><volume>45</volume><fpage>237</fpage><lpage>261</lpage><pub-id pub-id-type="pmid">28567861</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tastard</surname><given-names>E</given-names></name><name><surname>Andalo</surname><given-names>C</given-names></name><name><surname>Burrus</surname><given-names>M</given-names></name><name><surname>Gigord</surname><given-names>L</given-names></name><name><surname>Thébaud</surname><given-names>C</given-names></name></person-group><article-title>Effects of floral diversity and pollinator behaviour on the persistence of hybrid zones between plants sharing pollinators</article-title><source>Plant Ecol Divers</source><year>2014</year><volume>7</volume><fpage>391</fpage><lpage>400</lpage></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tastard</surname><given-names>E</given-names></name><name><surname>Andalo</surname><given-names>C</given-names></name><name><surname>Giurfa</surname><given-names>M</given-names></name><name><surname>Burrus</surname><given-names>M</given-names></name><name><surname>Thébaud</surname><given-names>C</given-names></name></person-group><article-title>Flower colour variation across a hybrid zone in <italic>Antirrhinum</italic> as perceived by bumblebee pollinators</article-title><source>Arthropod Plant Interact</source><year>2008</year><volume>2</volume><fpage>237</fpage><lpage>246</lpage></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tavares</surname><given-names>H</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Field</surname><given-names>DL</given-names></name><name><surname>Bradley</surname><given-names>D</given-names></name><name><surname>Couchman</surname><given-names>M</given-names></name><name><surname>Copsey</surname><given-names>L</given-names></name><name><surname>Elleouet</surname><given-names>J</given-names></name><name><surname>Burrus</surname><given-names>M</given-names></name><name><surname>Andalo</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Selection and gene flow shape genomic islands that control floral guides</article-title><source>Proc Natl Acad Sci U S A</source><year>2018</year><volume>115</volume><fpage>11006</fpage><lpage>11011</lpage><pub-id pub-id-type="doi">10.1073/pnas.1801832115</pub-id><pub-id pub-id-type="pmcid">PMC6205484</pub-id><pub-id pub-id-type="pmid">30297406</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walther-Hellwig</surname><given-names>K</given-names></name><name><surname>Frankl</surname><given-names>R</given-names></name></person-group><article-title>Foraging habitats and foraging distances of bumblebees, <italic>Bombus spp. (Hym., Apidae)</italic>, in an agricultural landscape</article-title><source>J Appl Entomol</source><year>2000</year><volume>124</volume><fpage>299</fpage><lpage>306</lpage></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westram</surname><given-names>AM</given-names></name><name><surname>Stankowski</surname><given-names>S</given-names></name><name><surname>Surendranadh</surname><given-names>P</given-names></name><name><surname>Barton</surname><given-names>N</given-names></name></person-group><article-title>What is reproductive isolation?</article-title><source>Journal of evolutionary biology</source><year>2022</year><volume>35</volume><issue>9</issue><fpage>1143</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1111/jeb.14005</pub-id><pub-id pub-id-type="pmcid">PMC9542822</pub-id><pub-id pub-id-type="pmid">36063156</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whibley</surname><given-names>AC</given-names></name><name><surname>Langlade</surname><given-names>NB</given-names></name><name><surname>Andalo</surname><given-names>C</given-names></name><name><surname>Hanna</surname><given-names>AI</given-names></name><name><surname>Bangham</surname><given-names>A</given-names></name><name><surname>Thébaud</surname><given-names>C</given-names></name><name><surname>Coen</surname><given-names>E</given-names></name></person-group><article-title>Evolutionary paths underlying flower color variation in <italic>Antirrhinum</italic></article-title><source>Science</source><year>2006</year><volume>313</volume><fpage>963</fpage><lpage>966</lpage><pub-id pub-id-type="pmid">16917061</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Illustration of clines under diffusive (left column) vs leptokurtic dispersal (right column)</title><p>The red and blue curves in panels A-D show the cline shapes for 2 selected loci. Panels A and B show expected cline shapes under diffusive gene flow when LD is (A) weak and (B) strong. When LD is weak, clines have a sigmoid shape. The cline width (w) is defined as the inverse of the maximum gradient (<italic>p</italic><italic>′</italic><sub><italic>max</italic></sub>) and is proportional to <inline-formula><mml:math id="M36"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:msqrt><mml:mi>s</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic>σ</italic> is the standard deviation of the parent-offspring distance and <italic>s</italic> is the effective selection at the centre (<italic>c</italic>). When LD among selected loci is strong, it increases the effective selection at the centre, causing a ‘stepped’ cline witha steep central step flanked by shallower tails of introgression (see also <xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). The tails take the form <inline-formula><mml:math id="M37"><mml:mrow><mml:mo>±</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>{</mml:mo><mml:mn>4</mml:mn><mml:mi>x</mml:mi><mml:msqrt><mml:mi>θ</mml:mi></mml:msqrt><mml:mo>/</mml:mo><mml:mi>w</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>where <italic>θ</italic> is the ratio between effective selection at the centre (<italic>s</italic>) and selection against introgressing alleles (<italic>s</italic><sub><italic>e</italic></sub>) away from the centre, and may differ to the left (<italic>θ</italic><sub>0</sub>) and right (<italic>θ</italic><sub>1</sub>). Under this scenario, the step reflects a genetic barrier to gene flow (<italic>B</italic>), described as <italic>B</italic> = Δ<italic>p/p</italic><italic>′</italic>, where Δ<italic>p</italic> is the difference in allele frequency across the central step and <italic>p</italic><italic>′</italic> is the gradient of allele frequency at the edge of the step and the tail. (Panel C) When dispersal is leptokurtic, cline shapes may be stepped even if LD is weak. This is because long distance migration transports foreign alleles to the opposite tail in a single dispersal event, in contrast to diffusion, where alleles must cross the barrier via many small steps. In this scenario, the step is caused only by long-range dispersal, not LD. (Panel D) Both leptokurtic dispersal and LD contribute to the step. This scenario is distinguished from panel B by the presence of correlations between loci (i.e., standardised LD) in the tails of the cline which is generated by long-distance migration (grey distributions in B and D). Under diffusive gene flow, these correlations are only expected at the cline centre (as in panel B). In all four scenarios neutral loci linked to selected loci are expected to show stepped clines (dashed black curve in panel A), indicating a barrier to the flow of neutral alleles.</p></caption><graphic xlink:href="EMS207037-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>The snapdragon hybrid zone in the Spanish Pyrenees</title><p>(A) Typical phenotypes of the varieties. (B) Partial ranges of <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> (magenta), <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic> (yellow) and known hybrid zones (orange) based on sampling in <xref ref-type="bibr" rid="R47">Whibley et al. (2006)</xref>. The magenta flowered <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> is found in northern Spain and south-western France, its range encircling the yellow-flowered <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic>. The dashed black line marks the French-Spanish border; the star indicates our study area. (C) The hybrid zone in the Val de Ribes. For visualisation, the 22,494 individuals have been clustered into 500m demes; pie charts show the mean hybrid index within each deme, defined as the proportion of <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus</italic> alleles at five unlinked colour loci (excluding <italic>EL</italic> which is tightly linked to <italic>ROS</italic>). The dashed white line shows the one-dimensional transect line and the contour lines show altitude. (D) The core sampling area. Individuals are clustered into 999 25m demes, which is the scale used for all analyses. In C and D, pie charts are scaled according to the log of the number of plants that they contain.</p></caption><graphic xlink:href="EMS207037-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Stepped clines in snapdragons</title><p>(A) Phenotypic clines for the mean magenta and yellow colour scores across 999 demes in the hybrid zone. The open circles denote the mean colour scores in each deme and the coloured curve represents the best fit cline from Metropolis-Hastings algorithm. (B) Best fit stepped cline shape and parameters, including the cline width (<italic>w</italic>), cline centre (<italic>c</italic>), and <italic>F</italic><sub><italic>ST</italic></sub>, for the 6 flower colour loci. Gray and light gray circles denote demes with greater and less than 5 individuals respectively. The curves show the asymmetric stepped cline shapes fitted to the observed allele frequencies for all loci. (C) The marginal likelihood of cline centre and width for all 6 loci. Clines roughly coincide, with all cline centres positioned within 1 km. Cline widths vary, with <italic>ROS</italic> narrowest and <italic>RUB</italic> widest. Here, the 1D marginal likelihood distribution is obtained from the last 2500 runs of the Metropolis algorithm.</p></caption><graphic xlink:href="EMS207037-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Little heterozygote deficit and positive correlations across the transect</title><p>(A) Mean hybrid index from 5 unlinked loci shown across geographical distance for 337 demes with at least 10 individuals. (B) Mean correlations <inline-formula><mml:math id="M38"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for all 10 pairs of unlinked loci across geographic distance and (C) Mean heterozygote deficit for the 5 loci (<italic>F</italic><sub><italic>IS</italic></sub>). Each point is the estimate for 1 deme, while the black line represents the mean and standard deviation for the 12 bins across the transect. The legends in B and C show the mean <italic>F</italic><sub><italic>IS</italic></sub> and <inline-formula><mml:math id="M39"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> in the centre (denoted by grey bar), magenta flank (right of the grey bar) and yellow flank (left of the grey bar).</p></caption><graphic xlink:href="EMS207037-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Dispersal is leptokurtic is snapdragons</title><p>(A) Cumulative distribution (CDF) of seed and pollen dispersal estimated from the pedigree trios. The brown curve denotes the CDF of the pollen dispersal (i.e. the distance between the parents). The black dashed line denotes the fitted log-Gaussian distribution. The orange curve denotes the CDF of seed dispersal, estimated from the trios. For each curve, the grey dashed lines denote the median distance, where the probability is 50%. (B) The full seed and pollen dispersal distributions, with the probability of movement of a given distance shown in the Y axis. The brown curve denotes the full pollen dispersal kernel fitted to a log-Gaussian. The magenta and yellow curves denote the seed dispersal kernel estimated by splicing the PDF estimated from the trios (as shown in A) with that estimated from individuals in the magenta and yellow flanks respectively at 300m.</p></caption><graphic xlink:href="EMS207037-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Multilocus cline simulations with the inferred dispersal explain the step and LD</title><p>(A) Cline shapes inferred from simulations with asymmetric selection and full dispersal kernel for each locus. The dashed line is the best fit simulated cline from single locus simulations whereas the solid line represents the fit from multilocus simulations with asymmetric selection. The corresponding selection estimates are given in <xref ref-type="table" rid="T3">Table 3</xref>. The light grey and dark gray circles denote the observed allele frequencies of demes with at least 5 and greater than 5 individuals respectively. (B) Mean correlations from 10 pairs of unlinked loci in the observed data (black) are shown for the 12 bins across the whole transect. The brown and grey curves show the mean correlations from multilocus simulations with the inferred dispersal and Gaussian dispersal (with <italic>σ</italic> =161m) respectively.</p></caption><graphic xlink:href="EMS207037-f006"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Information about the colour loci and corresponding SNP markers studied, with basic descriptions of the effect of each locus. The superscript letters indicate which subspecies the allele is typically associated with: <italic>p</italic> = <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>pseudomajus, s</italic> = <italic>A</italic>.<italic>m</italic>.<italic>m</italic> var. <italic>striatum</italic>. LG is the linkage group where the locus is found. SNP position (cM) is the position of the genotyped SNP in centimorgans. Δ<italic>p</italic> is the allele frequency difference between the left (yellow) and right (magenta) flanks, defined as <italic>z &lt;</italic> 13 km and <italic>z &gt;</italic> 16 km on the 1-D transect respectively, where <italic>z</italic> is the distance along the transect (see below).</title></caption><table frame="box" rules="groups"><thead><tr><th valign="middle" align="left" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Name<break/>(SNP marker)</th><th valign="middle" align="left" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Phenotypic Effect</th><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">LG</th><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">SNP<break/>position (cM)</th><th valign="middle" align="center" style="border:solid 1px #000000">Δ<italic>p</italic></th></tr></thead><tbody><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-left: 1px solid"><italic>ROS</italic><break/><italic>(ros_assembly</italic><break/><italic>_543443)</italic></td><td valign="top" align="left" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Promotes expression of magenta antho-cyanin pigments. The semidominant <italic>ROS<sup>p</sup></italic> allele causes strong magenta pigmentation across the corolla. Individuals homozygous for the <italic>ros<sup>s</sup></italic> allele produce little to no anthocyanin pigment, depending on alleles at other loci (Tavares et al., 2018).</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">6</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">49.29</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">0.855</td></tr><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-left: 1px solid"><italic>EL (ros_assembly</italic><break/><italic>_715001)</italic></td><td valign="top" align="left" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Regulates the distribution of anthocyanin. In the presence of <italic>ROS<sup>p</sup></italic>, the dominant <italic>EL<sup>s</sup></italic> allele restricts magenta colouration to the bee entry point. Individuals homozygous for the <italic>el<sup>p</sup></italic> allele have smooth magenta pigmentation across the corolla (Tavares et al., 2018).</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">6</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">49.86</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">0.759</td></tr><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-left: 1px solid"><italic>SULF (s91_122561)</italic></td><td valign="top" align="left" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Regulates the distribution of yellow aurone pigment. <italic>SULF<sup>p</sup></italic> restricts pigmentation to the bee entry point; The recessive <italic>sulf<sup>s</sup></italic> causes the expression of aurone across the entire corolla (Bradley et al., 2017)).</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">4</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid">9.37</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid">0.614</td></tr><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid"><italic>FLA</italic><break/><italic>(s316_93292)</italic></td><td valign="top" align="left" style="border:solid 1px #000000">An enzyme involved in making yellow aurone pigments. <italic>fla<sup>p</sup></italic> results in yellow pigment restriction to the face of the flower. <italic>fla<sup>p</sup></italic> has a smaller effect on reducing yellow colouration than <italic>SULF<sup>p</sup></italic> (Bradley et al., 2025).</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid">2</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid">43.18</td><td valign="top" align="center" style="border: 1px solid">0.640</td></tr><tr><td valign="top" align="left" style="border-left: 1px solid"><italic>RUB</italic><break/><italic>(s261_720757)</italic></td><td valign="top" align="left" style="border-left:solid 1px #000000">Regulates the production of anthocyanin pigments with the semi-dominant <italic>RUB<sup>p</sup></italic> increasing and <italic>rub<sup>s</sup></italic> decreasing the intensity of magenta pigmentation. The alleles interact with <italic>ROS,</italic> with effect on magenta intensity more pronounced on individuals with strong to moderate magenta in the presence of <italic>ROS<sup>p</sup>,</italic> and with a weaker effect on individuals homozygous for <italic>ros<sup>s</sup></italic> and little magenta pigment (Field et al., 2025)</td><td valign="top" align="center" style="border-left: 1px solid">5</td><td valign="top" align="center" style="border-left: 1px solid">32.32</td><td valign="top" align="center" style="border-left: 1px solid #000000;border-right: 1px solid">0.427</td></tr><tr><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid"><italic>CRE</italic><break/><italic>(s1187_290152)</italic></td><td valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">Encodes an additional regulator that has a subtle effect on yellow patterning. <italic>CRE<sup>p</sup></italic> appears to be dominant and reduces the level of yellow across the petal lobes, while <italic>cre<sup>s</sup></italic> is recessive (Richardson et al., 2025).</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid">1</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid">2.18</td><td valign="top" align="center" style="border: 1px solid">0.654</td></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><title>Maximum likelihood estimates and support limits of the 7 cline parameters for the stepped cline model for each flower colour SNP marker. The cline width is the inverse of the maximum gradient in allele frequency, the cline centre denotes the position on the transect at which both alleles are equally frequent and <italic>F</italic><sub><italic>ST</italic></sub> captures variation in allele frequency around the cline. <italic>B</italic><sub>0</sub> and <italic>B</italic><sub>1</sub> can be interpreted as the strength of the barrier to gene flow to the left (<italic>striatum</italic> side) and right (<italic>pseudomajus</italic> side) of the cline centre, and <italic>θ</italic><sub>0</sub> and <italic>θ</italic><sub>1</sub> are the rate of decay of the exponential tail to the left and right sides, respectively.</title></caption><table frame="box" rules="groups"><thead><tr><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">SNP</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>B</italic><sub>0</sub><break/>(km)</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>B</italic><sub>1</sub><break/>(km)</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>θ</italic><sub>0</sub><break/>(*10<sup>−3</sup>)</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>θ</italic><sub>1</sub><break/>(*10<sup>−3</sup>)</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Width<break/>(km)</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Centre<break/>(km)</th><th valign="middle" align="center" style="border:solid 1px #000000"><italic>F<sub>ST</sub></italic></th></tr></thead><tbody><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>ROS</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">14.4 (8.2 – 21.8)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">6.1 (1.05 – 17.7)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">2.4 (0.7 – 4.3)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">31.2 (9.9 – 82.4)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">0.8 (0.6 – 0.9)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">14.94 (14.91 – 14.95)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">0.075 (0.066 – 0.092)</td></tr><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>EL</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">48.5 (27.4 – 125.5)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">29.6 (17.9 – 57.1)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">0.4 (0.1 – 1.3)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">0.4 (0.2 – 1.1)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">0.8 (0.7 – 0.9)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">14.97 (14.95 – 15.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">0.064 (0.057 – 0.079)</td></tr><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>RUB</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">9.6 (8.2 – 10.5)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">59.8 (30.5 – 67.7)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">8.1 (8.2 – 18.2)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">3.6 (3.5 – 19.4)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">4.5 (4.5 – 6.4)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">14.43 (14.02 – 14.42)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">0.045 (0.04 – 0.059)</td></tr><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>SULF</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">28.3 (16.1 – 51.7)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">9.1 (3.2 – 19.9)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">1.2 (0.5 – 3.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">30.7 (12.6 – 76.5)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">3.5 (3.0 – 3.9)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">14.94 (14.87 – 14.98)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">0.031 (0.025 – 0.039)</td></tr><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000"><italic>FLA</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">29.6 (16.9 – 83.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">2.4 (2.3– 3.1)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">2.0 (0.4 – 3.6)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">10.8 (5.3– 13.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">1.3 (0.9 – 1.4)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">15.18 (15.11 – 15.22)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">0.036 (0.03 – 0.045)</td></tr><tr><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><italic>CRE</italic></td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">19.0 (10.4 – 62.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">2.4 (2.0 – 3.2)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">3.6 (0.5 – 8.7)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">19.0 (11.8 – 29.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">1.7 (1.5 – 2.0)</td><td valign="top" align="center" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000">15.31 (15.25 – 15.37)</td><td valign="top" align="center" style="border: 1px solid #000000">0.032 (0.026 – 0.04)</td></tr></tbody></table></table-wrap><table-wrap id="T3" orientation="portrait" position="float"><label>Table 3</label><caption><title>Inferred selection coefficients from cline fits, single locus cline simulations and multilocus cline simulations with asymmetric selection for the 5 unlinked loci. <italic>s</italic><sub><italic>left</italic></sub> and <italic>s</italic><sub><italic>right</italic></sub> are the selection coefficients for the two homozygotes respectively. <italic>s</italic><sub><italic>LD</italic></sub> is the indirect selection (at the cline centre) at each locus due to its associations (LD) with other selected loci. The last column is the effective selection (<italic>s</italic><sub><italic>eff</italic>,<italic>i</italic></sub>) at each locus at the cline centre due to both its direct effect on fitness and the indirect effect of LD with other selected loci.</title></caption><table frame="box" rules="groups"><thead><tr><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">SNP</th><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Selection from<break/>‘traditional’<break/>cline analysis</th><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Direct selection<break/>from single<break/>locus simulation</th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Direct selection<break/>from multilocus<break/>simulation<break/><italic>s<sub>left</sub></italic></th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-left: 1px solid #000000">Direct selection<break/>from multilocus<break/>simulation<break/><italic>s<sub>right</sub></italic></th><th valign="middle" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">Indirect selection<break/>due to LD<break/><italic>S<sub>LD</sub></italic></th><th valign="middle" align="center" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">Effective selection<break/>(direct+indirect<break/>selection due to LD)<break/><italic>s<sub>eff,i</sub></italic></th></tr></thead><tbody><tr><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000"><italic>ROS</italic></td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.115</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.196</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.187</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.185</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.013</td><td valign="top" align="center" style="border:solid 1px #000000">0.199</td></tr><tr><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000"><italic>RUB</italic></td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.004</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.024</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.016</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.015</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.012</td><td valign="top" align="center" style="border:solid 1px #000000">0.028</td></tr><tr><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000"><italic>SULF</italic></td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.006</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.057</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.033</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.028</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.024</td><td valign="top" align="center" style="border:solid 1px #000000">0.055</td></tr><tr><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000"><italic>FLA</italic></td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.049</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.091</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.076</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.058</td><td valign="top" align="center" style="border-top:solid 1px #000000;border-left:solid 1px #000000">0.023</td><td valign="top" align="center" style="border:solid 1px #000000">0.090</td></tr><tr><td valign="top" align="center" style="border:solid 1px #000000"><italic>CRE</italic></td><td valign="top" align="center" style="border:solid 1px #000000">0.025</td><td valign="top" align="center" style="border:solid 1px #000000">0.097</td><td valign="top" align="center" style="border:solid 1px #000000">0.070</td><td valign="top" align="center" style="border:solid 1px #000000">0.052</td><td valign="top" align="center" style="border:solid 1px #000000">0.022</td><td valign="top" align="center" style="border:solid 1px #000000">0.084</td></tr></tbody></table></table-wrap></floats-group></article>