<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207573</article-id><article-id pub-id-type="doi">10.1101/2025.07.22.664676</article-id><article-id pub-id-type="archive">PPR1055349</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Rethinking scRNA-seq Trajectories in Phylogenetic Paradigms: Overcoming Challenges of Missing Ancestral Information</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Naas</surname><given-names>Julia</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">✉</xref></contrib><contrib contrib-type="author"><name><surname>von Haeseler</surname><given-names>Arndt</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Elgert</surname><given-names>Christiane</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05cz70a34</institution-id><institution>Max Perutz Labs</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03prydq77</institution-id><institution>University of Vienna</institution></institution-wrap> and <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05n3x4p02</institution-id><institution>Medical University of Vienna</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/04khwmr87</institution-id><institution>Vienna BioCenter</institution></institution-wrap>, <city>Vienna</city>, <country country="AT">Austria</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04khwmr87</institution-id><institution>Vienna BioCenter</institution></institution-wrap>, PhD Program, a Doctoral School of the <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03prydq77</institution-id><institution>University of Vienna</institution></institution-wrap> and <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05n3x4p02</institution-id><institution>Medical University of Vienna</institution></institution-wrap>, <city>Vienna</city>, <country country="AT">Austria</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00a2syk23</institution-id><institution>Ludwig Boltzmann Institute</institution></institution-wrap> for Network Medicine at the <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03prydq77</institution-id><institution>University of Vienna</institution></institution-wrap>, <city>Vienna</city>, <country country="AT">Austria</country></aff><author-notes><corresp id="CR1">
<bold>Correspondence: <italic>Julia Naas</italic></bold> (<email>julia.naas@meduniwien.ac.at</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>27</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>25</day><month>07</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">In recent decades, many bioinformatics tools have been developed to reconstruct trajectories of biological processes, e.g., cell differentiation, using single-cell RNA-sequencing (scRNA-seq) data. Most tools tacitly assume that a cell’s ancestral transcriptomic profile can be approximated by means of its neighboring cells in an embedded gene expression space. However, many scRNA-seq datasets lack ancestral information due to missing early or transient states at the time of sequencing. We introduce CellREST, a bioinformatics tool that reformulates trajectory reconstruction as a phylogenetic inference problem. It infers trees linking cells that are assumed to share a common ancestral expression state. Using maximum likelihood tree inference, CellREST uncovers multiple different aspects of the transcriptomic landscape underlying a single scRNA-seq dataset, which can be visualized and combined into a single-cell network. We showcase CellREST’s performance on simulated and experimental scRNA-seq data and recover circular processes as well as cell type converging differentiation scenarios. By introducing and adapting phylogenetic concepts, CellREST provides a framework for interpreting transcriptomic relationships between cells within scRNA-seq data.</p></abstract><kwd-group><kwd>scRNA-seq</kwd><kwd>trajectory inference</kwd><kwd>cell differentiation</kwd><kwd>phylogenetics</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Single-cell RNA sequencing (scRNA-seq) provides in-depth insights into transcriptomic profiles of individual cells, enabling detailed analysis of heterogeneity within and between different cell types. However, one scRNA-seq dataset captures gene expression only as a snapshot, limiting the direct observation of ongoing or past dynamical processes, e.g., cell type differentiation.</p><p id="P3">To infer the transcriptomic history of a cell many bioinformatics methods have been developed, for example Monocle1-3 (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref>), Slingshot (<xref ref-type="bibr" rid="R4">4</xref>), Palantir (<xref ref-type="bibr" rid="R5">5</xref>), STREAM (<xref ref-type="bibr" rid="R6">6</xref>), CellRank1 and 2 (<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R8">8</xref>) or scFates (<xref ref-type="bibr" rid="R9">9</xref>). While extensive efforts have been made to evaluate the performance and applicability of such tools (<xref ref-type="bibr" rid="R10">10</xref>), most rely on approximating a cell’s ancestral gene expression profile using those of its neighbors within method-specific embeddings. This approach implicitly assumes that transcriptomically similar cells follow the same differentiation trajectory, which is a reasonable premise when the process is continuously and evenly sampled. However, in practice, early or transient states are often underrepresented due to rapid progression or limited sampling. In such cases, embedding-based distance measures may fail to relate cells with shared transcriptomic histories if they appear distant in the chosen embedding space.</p><p id="P4">This key limitation of scRNA-seq data, namely the lack of explicit ancestral information, has long been addressed in phylogenomics. Phylogenomics aims to infer evolutionary relationships between biological entities, typically species, by analyzing observed heritable traits, such as morphological characteristics or molecular sequences. Relationships are typically visualized as phylogenetic trees, grouping species to indicate a shared common ancestor.</p><p id="P5">There are two principal approaches to infer a phylogenetic tree. <italic>Distance-based methods</italic>, as for example Neighbor Joining (NJ) (<xref ref-type="bibr" rid="R11">11</xref>) or BIONJ (<xref ref-type="bibr" rid="R12">12</xref>), construct trees by grouping species based on their pairwise distances. In contrast, <italic>character-based methods,</italic> such as Maximum Likelihood (ML) (<xref ref-type="bibr" rid="R13">13</xref>), model the evolution of individual character states, for example, nucleotide bases A, C, G, and T. Maximum Likelihood infers the tree that best explains the observed data, where branch lengths represent the extent of genetic change over time.</p><p id="P6">Tree reconstruction methods based on distances of expression profiles of cells or (pseudo-)bulks have already been used to analyze transcriptomic data (<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref>). However, like the above mentioned trajectory reconstruction methods, they share the limitation to depend on predefined distance or similarity measures. More recently, also ML-based (<xref ref-type="bibr" rid="R17">17</xref>) and Brownian motion–based tree reconstruction methods (<xref ref-type="bibr" rid="R18">18</xref>) have been applied to scRNA-seq data. These available methods either compare transcriptomic trees to those derived from single-nucleotide polymorphisms (SNPs) (<xref ref-type="bibr" rid="R17">17</xref>), or mix information on the evolution of species with transcriptomic changes (<xref ref-type="bibr" rid="R18">18</xref>). While species evolution, cell division into lineages, and transcriptomic changes are undoubtedly interdependent (<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>), we argue that these processes cannot be fully represented within a single tree. Furthermore, methods that rely solely on a single tree structure are insufficient to capture non-tree-like features of the transcriptomic landscape, i.e., the manifold formed by gene expression profiles of cells undergoing a biological process.</p><p id="P7">To close this gap, we introduce <bold>CellREST</bold> (<bold>Cell</bold>ular <bold>R</bold>elationships in <bold>E</bold>xpression-state-based <bold>S</bold>ingle-cell <bold>T</bold>rees), a phylogenetic paradigm for the analysis of single-cell transcriptomic data. CellREST uses a character-based phylogenetic framework for inferring gene expression state transitions between cells in scRNA-seq data. It reconstructs a collection of single-cell-labeled Maximum Likelihood trees that capture alternative and potentially coexisting trajectories. Inferred trees are combined into a single-cell network that displays complex, non-tree-like transcriptomic landscapes in a noise-robust manner. Implemented as an R package, CellREST integrates with the Seurat workflow (<xref ref-type="bibr" rid="R21">21</xref>), allowing further data-driven exploration.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>A Phylogenetic Paradigm for Exploring Transcriptional Landscapes</title><p id="P8">To address the problem of analyzing trajectories on scRNA-seq data in phylogenetic terms, the pre-processed, log-normalized count matrix of a scRNA-seq dataset (<xref ref-type="sec" rid="S13">Methods M.1</xref>) is subset to highly variable genes and transformed into a pseudo-alignment. For each gene, expression levels are discretized into four categorical expression states: Zero expression values are assigned to a ‘no expression’ state and remaining positive expression values are uniformly divided into three bins representing ‘low expression’, ‘medium expression’, and ‘high expression’ states (<xref ref-type="sec" rid="S16">Methods M.2.1</xref>). <xref ref-type="supplementary-material" rid="SD1">Fig. S1A</xref> shows that there is no substantial difference between UMAP (<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>) embeddings for discretized data (in the exemplary downstream analysis encoded as ordered integers 0, 1, 2, and 3) and non-discretized data. This suggests that discretization does not reduce biologically meaningful variation in the data. To enable character-based phylogenetic inference, the four expression states are encoded as pseudo-nucleotides T (no expression), G (low expression), C (medium expression), and A (high expression) (<xref ref-type="fig" rid="F1">Fig. 1A</xref> <xref ref-type="fig" rid="F1">1</xref>-<xref ref-type="fig" rid="F2">2</xref>). This results in a pseudo-alignment in which each column (‘pseudo-site’) corresponds to a gene and each row represents a cell (‘pseudo-taxon’). Encoding expression states as pseudo-nucleotides does not preserve their low to high ordering, but enables the estimation of transition dynamics through phylogenetic inference.</p><p id="P9">A phylogenetic tree is inferred from the pseudo-alignment (<xref ref-type="sec" rid="S17">Methods M.2.2</xref>) using the maximum likelihood approach implemented in IQ-TREE2 (<xref ref-type="bibr" rid="R24">24</xref>). The resulting single-cell-labeled Maximum Likelihood tree (scML-tree) represents likely ancestral transcriptomic relationships among individual cells. In this scML-tree, branch lengths reflect the number of inferred expression state changes and thus serves as a proxy for development time (<xref ref-type="fig" rid="F1">Fig. 1A</xref> <xref ref-type="fig" rid="F3">3</xref>). For any pair of cells, the sum of the branch lengths along the connecting path defines their patristic distance.</p><p id="P10">Across all datasets analyzed in this study, we observed that inferred average transition rates were highest between neighboring expression states, i.e., transitions from no to low, low to medium, and medium to high expression (<xref ref-type="supplementary-material" rid="SD1">Fig. S1B</xref>). This pattern suggests that tree inference primarily captures gradual changes in gene expression across cells, while still allowing occasional transitions from, e.g., no to medium expression.</p><p id="P11">Unlike typical studies of species evolution, single-cell transcriptomic data can introduce additional complexities that can make reliance on a single phylogenetic tree potentially inadequate. These include: <list list-type="order" id="L1"><list-item><p id="P12"><bold>Non-tree-like dynamics:</bold> Dynamical processes, as e.g. the cell cycle (<xref ref-type="bibr" rid="R25">25</xref>) or convergent cell type differentiation, can involve non-tree-like topologies (<xref ref-type="fig" rid="F1">Fig. 1B</xref> <xref ref-type="fig" rid="F1">1</xref>), which cannot be captured by a single tree. As a result, any tree must introduce an artificial ‘cut’ to represent a cycle. The position of this cut depends on both the data support and the heuristics applied during tree reconstruction, leading different trees to resolve the cycle at different locations. This leads to inconsistent placement of cells – in phylo-genetic terms known as rogue taxa – whose placements vary across trees due to limited phylogenetic support.</p></list-item><list-item><p id="P13"><bold>Multiple cell lineages:</bold> Multiple cell lineages may follow the same dynamical process and are not distinguishable based on transcriptomic information alone (<xref ref-type="fig" rid="F1">Fig. 1B</xref> <xref ref-type="fig" rid="F2">2</xref>). Ideally, such cells would be represented as polytomies – unresolved branches reflecting shared, indistinct transcriptomic histories. However, since IQ-TREE returns fully bifurcating trees by default, these relationships are resolved arbitrarily, which can misrepresent the underlying transcriptomic structure.</p></list-item><list-item><p id="P14"><bold>Unrelated processes:</bold> A scRNA-seq dataset may contain cells originating from distinct biological processes (<xref ref-type="fig" rid="F1">Fig. 1B</xref> <xref ref-type="fig" rid="F3">3</xref>). Incorporating these unrelated cells into a single phylogenetic tree can result in rogue taxa or subtrees, often connected by disproportionately long branches.</p></list-item><list-item><p id="P15"><bold>Data sparsity and technical noise:</bold> The inherent sparsity of scRNA-seq data that is caused by dropouts and low sequencing depth (<xref ref-type="bibr" rid="R26">26</xref>) can affect the inferred tree. In particular, technical zeros are misinterpreted as true biological zeros, introducing artificial expression state transitions. This results in longer branch lengths, especially for branches that are connected to the tips of a tree (<xref ref-type="supplementary-material" rid="SD1">Fig. S1C</xref>). To account for this effect, we apply Adaptively Thresholded Low-Rank Approximation (ALRA) imputation (<xref ref-type="bibr" rid="R27">27</xref>) to log-normalized count matrices prior to binning (<xref ref-type="supplementary-material" rid="SD1">Fig. S1D</xref>, <xref ref-type="sec" rid="S13">Methods M.1</xref>), which aims to assign positive expression values to technical zeros. This leads to a reduction in branch lengths overall (<xref ref-type="supplementary-material" rid="SD1">Fig. S1E</xref>).</p></list-item></list>
</p><p id="P16">To overcome the limitations caused by relying on a single phylogenetic tree, we infer multiple scML-trees per dataset (<italic>n<sub>trees</sub></italic> = 100 for all analyses). In contrast to deterministic methods such as NJ, repeated ML tree inference can recover alternative topologies: This diversity arises from the stochasticity of the tree search, which may converge on different, equally plausible trees depending on initial conditions and local optima in the likelihood space. This is particularly relevant when the data reflect non-tree-like trajectories, where no single optimal topology can fully capture the biological complexity. Each tree thus captures different aspects of the underlying transcriptomic landscape, offering a more nuanced representation of uncertainty in single-cell transcriptomic data.</p><p id="P17">To explore both the variability across different scML-trees and the complementary information they provide, we consider two approaches:</p><p id="P18">In the first approach (<xref ref-type="fig" rid="F1">Fig. 1C</xref> <xref ref-type="fig" rid="F2">2</xref>), we quantify similarities and differences between pairs of scML-trees using a path-based correlation measure (<xref ref-type="bibr" rid="R28">28</xref>), which we will refer to as <italic>patristic-correlation</italic> (<xref ref-type="sec" rid="S18">Methods M.2.3</xref>). This measure captures how similarly two trees encode distances between cells. The resulting tree-distance-matrix is visualized using dimensionality reduction techniques such as Principal Coordinates Analysis (PCoA) and UMAP (<xref ref-type="bibr" rid="R29">29</xref>–<xref ref-type="bibr" rid="R32">32</xref>). In these tree-embeddings, scML-trees with similar topologies and branch lengths cluster together, revealing how many scML-trees support similar parts of the underlying transcriptomic landscape (<xref ref-type="fig" rid="F1">Fig. 1C</xref> <xref ref-type="fig" rid="F2">2</xref>).</p><p id="P19">In the second approach (<xref ref-type="fig" rid="F1">Fig. 1C</xref> <xref ref-type="fig" rid="F3">3</xref>), we use a nearest neighbor (nn) strategy to construct a noise-robust representation of a collection of scML-trees. To do so, each scML-tree is transformed into an nn-tree-graph by connecting cells separated by at most <italic>B</italic> branches (<xref ref-type="sec" rid="S22">Methods M.2.4</xref>). For example, if <italic>B</italic> = 2, only tips that share a direct ancestor are connected (cherries). To capture slightly broader local structures as links between adjacent cherries we use <italic>B</italic> = 4 in all analyses presented here (<xref ref-type="fig" rid="F1">Fig. 1D</xref>). For a collection of scML-trees respective nn-tree-graphs are combined into a single-cell network (sc-network) by including any edge that appears in at least one of the nn-tree-graphs (<xref ref-type="sec" rid="S22">Methods M.2.4</xref>). Each edge in the sc-network is assigned the following attributes: The <bold>edge weight</bold> reflects how often the edge occurred across the nn-tree-graphs and can be interpreted as a stability score. The <bold>edge length</bold> is defined as the minimum patristic distance between cells that are connected via an edge across all nn-tree-graphs. The edge length hence represents the extent of tree-informed changes in expression profiles. Alternatively, users may choose other distances, e.g., the count of branches between cells, or different summary statistics than the minimum for the attribution of edge lengths.</p><p id="P20">We define <bold>CellREST distance</bold> as the shortest path distance between cells in the sc-network, measured using edge lengths. This distance metric offers two key advantages over a conventional Euclidean distance between embedded expression profiles: (<xref ref-type="bibr" rid="R1">1</xref>) it relies on model-inferred branch lengths rather than geometric proximity, and (<xref ref-type="bibr" rid="R2">2</xref>) as shortest path distance, it more accurately approximates curved trajectories. Both CellREST distances and alternative shortest path distances can serve as inputs for downstream analyses including cell embeddings, clusterings, and other exploratory tasks.</p></sec><sec id="S4"><title>Recovering Complex Trajectories from Simulated scRNA-seq Data</title><p id="P21">To assess the ability of CellREST to reconstruct non-tree-like trajectories, we simulated scRNA-seq data following a circular topology, such as it occurs, e.g., for cells in cell cycle with respect to cycling genes (<xref ref-type="bibr" rid="R25">25</xref>). To do so, we used dyngen (<xref ref-type="bibr" rid="R33">33</xref>), which simulates gene expression dynamics over continuous time scale using Gillespie’s stochastic simulation algorithm (<xref ref-type="bibr" rid="R34">34</xref>). For a clear and interpretable comparison to the ground truth, we restricted the simulation to a single circular loop (450 cells) and rescaled the simulation time to the interval [0, 1] (<xref ref-type="fig" rid="F2">Fig. 2A</xref>, <xref ref-type="sec" rid="S31">Methods M.3.1</xref>).</p><p id="P22">Following standard pre-processing and dimensionality reduction using Seurat (<xref ref-type="sec" rid="S13">Methods M.1</xref>), the underlying circular topology was already visible in the UMAP embedding (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). However, we also observed uneven data support across simulation time, with notably lower density in certain regions.</p><p id="P23">Applying CellREST, we inferred 100 scML-trees, each representing a plausible scenario with similar likelihoods (<xref ref-type="supplementary-material" rid="SD1">Fig. S2A</xref>, <xref ref-type="sec" rid="S27">Methods M.2.5</xref>). The tree embedding based on patristic-correlation revealed three distinct tree-clusters, each cutting the circular trajectory in a different but consistent region (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). This grouping of scML-trees could not be resolved using splits-based Robinson-Foulds (RF) distances alone (<xref ref-type="supplementary-material" rid="SD1">Fig. S2B</xref>), highlighting the importance of incorporating branch length information. A tip instability analysis (<xref ref-type="bibr" rid="R35">35</xref>), computed within each tree-cluster, enabled localization of the cutting locations through the identification of rogue taxa (see also <xref ref-type="fig" rid="F1">Fig. 1B</xref> <xref ref-type="fig" rid="F3">3</xref>, <xref ref-type="sec" rid="S18">Methods M.2.3</xref>). These cutting locations coincided with areas of reduced data support (<xref ref-type="fig" rid="F2">Fig. 2D</xref>). When combining all 100 scML-trees into a single sc-network, the full circular trajectory was successfully reconstructed, as visible in a UMAP embedding based on CellREST distances (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). Notably, logarithmized edge lengths in the sc-network closely followed a normal distribution (<xref ref-type="supplementary-material" rid="SD1">Fig. S2C</xref>, <xref ref-type="sec" rid="S22">Methods M.2.4</xref>).</p><p id="P24">To quantify how well CellREST distances reflect the simulated ground truth, we conducted a rank-based correlation analysis. Since gene expression changes nonlinearly over simulation time (<xref ref-type="supplementary-material" rid="SD1">Fig. S2D</xref>), we used Kendall’s tau to compare the relative ordering of cells. For each cell, we ranked all other cells by both simulation time and Cell-REST distance, accounting for the circular nature of the trajectory, i.e., treating time differences between 0 and 1 as zero (<xref ref-type="sec" rid="S32">Methods M.3.2</xref>). CellREST distances consistently yielded higher Kendall’s tau correlations with simulation time than corresponding analyses with Euclidean distances computed from log-normalized expression profiles or cells in PC space, or UMAP embeddings. Additionally, CellREST outperformed shortest path distances derived from both nearest neighbor (NN) and shared nearest neighbor (SNN) graphs (<xref ref-type="supplementary-material" rid="SD1">Fig. S2E</xref>, <xref ref-type="sec" rid="S13">Methods M.1</xref>).</p></sec><sec id="S5"><title>Recovering Missing Transient States from Simulated scRNA-seq Data</title><p id="P25">Real-world datasets often lack coverage of the entire trajectory. Hence, we further tested Cell-REST’s robustness by removing cells from two simulation time intervals, <italic>I</italic><sub>1</sub> = (0.45, 0.55) and <italic>I</italic><sub>2</sub> = (0.15, 0.95), to mimic missing transient states (<xref ref-type="fig" rid="F3">Fig. 3A</xref>, <xref ref-type="sec" rid="S33">Methods M.3.3</xref>). The standard UMAP embedding of the remaining cells failed to preserve the original circular topology, indicating its susceptibility in capturing the global structure in case of incomplete data (<xref ref-type="fig" rid="F3">Fig. 3B</xref>).</p><p id="P26">Applying CellREST to the remaining cells, we again inferred 100 scML-tree topologies and identified two distinct tree-clusters. Each cluster effectively bridged one of the artificially introduced gaps (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S3A</xref>). For the larger gap <italic>I</italic><sub>2</sub>, trees attained noticeably longer internal branches to connect distant cell groups. As a result, the gap remained visible in the UMAP embedding based on CellREST distances. Nevertheless, the sc-network correctly reconnected the circular structure, unlike SNN-based graphs, which failed to capture the underlying topology (<xref ref-type="fig" rid="F3">Fig. 3D</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S3B</xref>). Notably, four logarithmized edge lengths in the sc-network exceeded the 99.99% quantile of the fitted normal distribution (<xref ref-type="fig" rid="F3">Fig. 3E</xref>, <xref ref-type="sec" rid="S22">Methods M.2.4</xref>). Crucially, removing these outlier edges preserved the gap-spanning connections and left CellREST distances unchanged, thereby leading to the same UMAP embedding (<xref ref-type="fig" rid="F3">Fig. 3F</xref>). CellREST distances again achieved high Kendall’s tau correlations in comparison with simulation time (<xref ref-type="supplementary-material" rid="SD1">Fig. S3C</xref>).</p><p id="P27">The analyses of the simulated circular process and its subset demonstrate that scML-trees successfully approximate different parts of the underlying transcriptomic landscape (<xref ref-type="supplementary-material" rid="SD1">Fig. S3D</xref>). Together, these trees enable the reconstruction of trajectories that are non-tree-like or incompletely sampled.</p><p id="P28">In datasets containing unrelated cell populations (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>, <xref ref-type="sec" rid="S34">Methods M.3.4</xref>), CellREST may generate connecting edges, as it does not enforce separation by design. However, such edges are typically among the longest in the sc-network, and hence can be identified as their lengths exceed the 99.99% quantile of the fitted normal distribution, as we show in a corresponding simulation scenario (<xref ref-type="supplementary-material" rid="SD1">Fig. S4D</xref>). These edges also tend to have low weights, indicating limited support across the nn-tree-graphs. This characteristic provides a practical strategy for filtering or down-weighting unreliable connections in downstream analyses.</p></sec><sec id="S6"><title>Experimental scRNA-seq Data</title><p id="P29">Simulated scRNA-seq data cannot fully capture the complexity of technical noise and biological variability present in experimental datasets (<xref ref-type="bibr" rid="R36">36</xref>). To complement our simulation-based evaluation, we applied CellREST to two benchmark datasets – mouse pancreatic endocrinogenesis (<xref ref-type="bibr" rid="R37">37</xref>) and peripheral blood mononuclear cells (PBMCs) (<xref ref-type="bibr" rid="R38">38</xref>) – as well as a renal cell carcinoma scRNA-seq data (<xref ref-type="bibr" rid="R39">39</xref>). To ensure comparability, each dataset was processed using the ‘standard’ Seurat and our CellREST workflow (<xref ref-type="sec" rid="S13">Methods M.1</xref>).</p><sec id="S7"><title>Developing Mouse Pancreas</title><p id="P30">The mouse endocrinogenesis dataset (<xref ref-type="bibr" rid="R37">37</xref>) has become a benchmark for trajectory inference methods, as it is continuously sampled along the differentiation process from endocrine progenitors (EPs) to mature endocrine cell types Alpha, Beta, Delta, and Epsilon.</p><p id="P31">For the 3,696-cell dataset, we performed standard preprocessing and the resulting UMAP reflected the expected structure of the differentiation process (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, <xref ref-type="sec" rid="S36">Methods M.4.1</xref>). Applying CellREST using 3,000 highly variable genes, we inferred 100 scML-trees, which revealed continuous but structured variation in a PCo tree-embedding (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). One group of trees displayed caterpillar-like topologies, reflecting a linear transition from early progenitors to terminal states (tree-cluster 3). Other trees captured alternative branching patterns, linking distinct EP subgroups to mature cell types via longer internal branches (tree-clusters 1,2 and 4). Tip instability analyses per cluster indicate that these groups represent different cutting locations in a potentially network-like transcriptomic landscape (<xref ref-type="supplementary-material" rid="SD1">Fig. S5A</xref>).</p><p id="P32">When combining all 100 scML-trees into a single sc-network, we identified a subset of outlier edges (0.42% of all edges), whose logarithmized lengths exceeded the 99.99% quantile of a fitted normal distribution (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). Following the strategy established in our simulations, we removed these edges and proceeded with a pruned version of the sc-network (<xref ref-type="fig" rid="F4">Fig. 4D</xref>,<xref ref-type="fig" rid="F4">E</xref>). Notably, some highly supported edges connecting cells outside the main differentiation wave remained (<xref ref-type="fig" rid="F4">Fig. 4E</xref>) in the pruned sc-network and were also present in comparable SNN graphs (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S5B</xref>). This suggests that the dataset may capture multiple, slightly variable differentiation waves converging to the same mature cell types. Visualizing the sc-network edges within the CellREST-informed UMAPs provides additional insight into sparsely sampled differentiation waves, particularly evident in the UMAP based on shortest path distances using minimal branch counts between cells across nn-tree-graphs (<xref ref-type="fig" rid="F4">Fig. 4E</xref>).</p></sec><sec id="S8"><title>Cell Type Clustering of Peripheral Blood Mononuclear Cells</title><p id="P33">We applied CellREST to a second benchmarking scRNA-seq dataset of peripheral blood mononuclear cells (PBMCs) (<xref ref-type="bibr" rid="R38">38</xref>) (<xref ref-type="sec" rid="S37">Methods M.4.2</xref>), comprising distantly related cell types. In this dataset, cell types were experimentally identified using antibody-coated magnetic beads (<xref ref-type="supplementary-material" rid="SD1">Fig. S6A</xref>).</p><p id="P34">Following the evaluation strategy of Fu et al. (<xref ref-type="bibr" rid="R38">38</xref>), we assessed whether the CellREST-derived scML-trees (<xref ref-type="supplementary-material" rid="SD1">Fig. S6B</xref>) and the corresponding sc-network could be used to perform accurate cell type clustering. For this, we computed the Adjusted Rand Index (ARI) between experimentally identified cell types and computationally obtained cell clusters. Visual inspection of the sc-network before and after pruning of outlier edges (<xref ref-type="supplementary-material" rid="SD1">Fig. S6C</xref>) reveals a clear separation of experimentally defined cell types (<xref ref-type="supplementary-material" rid="SD1">Fig. S6D</xref>,<xref ref-type="supplementary-material" rid="SD1">E</xref>). Notably, several cell types retain dense internal connectivity within the pruned network. However, applying Louvain community detection (<xref ref-type="bibr" rid="R40">40</xref>) (<xref ref-type="sec" rid="S27">Methods M.2.5</xref>) to the pruned sc-network with unweighted edges, produced slightly lower ARI scores compared to clustering on SNN graphs (<xref ref-type="supplementary-material" rid="SD1">Fig. S6F</xref>). This outcome might reflect the limitations of typically applied community detection methods (<xref ref-type="bibr" rid="R41">41</xref>), that do not take advantage of the distance information encoded by CellREST.</p></sec><sec id="S9"><title>Putative Cells of Origin of Renal Cell Carcinoma</title><p id="P35">Finally, we applied CellREST to a renal cell carcinoma scRNA-seq dataset from Zhang et al. (<xref ref-type="bibr" rid="R39">39</xref>) (<xref ref-type="sec" rid="S38">Methods M.4.3</xref>), which includes benign renal and tumor tissue from patients with chromophobe renal cell carcinoma (chRCC, 1 sample) and clear cell renal cell carcinoma (ccRCC, 7 samples). In this study, the authors aimed to identify putative cells of origin (P-COs) for each carcinoma type. Using gene expression profiles of epithelial cell types, they trained a random forest model to assign P-COs based on maximum prediction scores, proposing Proximal Tubule B (PT-B) cells as the P-COs for ccRCC and Intercalated (IC) cells for chRCC.</p><p id="P36">To focus the analysis, we sub-sampled the dataset to include only tumor cells (ccRCC and chRCC) and epithelial cell types. A standard UMAP embedding showed clear separation between epithelial cells and tumor cells, with the latter separating by patient origin (<xref ref-type="fig" rid="F5">Fig. 5A</xref>).</p><p id="P37">Applying CellREST, we reconstructed 100 scML-trees, in which cells from the same RCC samples were often positioned within the same subtree. Additionally, chRCC cells consistently formed a distinct subtree, clearly separated from ccRCC cells (<xref ref-type="fig" rid="F5">Fig. 5B</xref>). After pruning outlier edges (<xref ref-type="fig" rid="F5">Fig. 5C</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S7A</xref>–<xref ref-type="supplementary-material" rid="SD1">C</xref>) the resulting sc-network primarily connected epithelial cells among themselves and tumor cells within their subtype. Notably, we also observed direct connections between ccRCC cells and PT-B cells, including two prominent edges from patient samples SI_18855 and SI_18854 with high weights (weights 45 and weights 79, respectively) and moderate edge lengths (distances 0.251 and 0.306 and distances 0.198 and 0.223, respectively) (<xref ref-type="fig" rid="F5">Fig. 5D</xref>) and lower weight edges from samples SI_19703, SI_22368 and SI_23459 (<xref ref-type="supplementary-material" rid="SD1">Fig. S7D</xref>). Likewise, chRCC cells showed direct but less strongly supported links to IC-A and IC-B cells (<xref ref-type="fig" rid="F5">Fig. 5D</xref>). For two ccRCC samples (SI_22604, and SI_23843), no direct edges to epithelial types remained after pruning.</p><p id="P38">Using CellREST, we obtained a sc-network in which cells are connected if transitions between their gene expression profiles are considered likely based on phylogenetic inference. In the context of the carcinoma dataset, connections between healthy epithelial cells and tumor cells do not merely reflect transcriptomic similarity. Rather, they suggest that the gene expression profile of the linked epithelial cell could plausibly evolve into that of the connected carcinoma cell, providing a framework for identifying putative cells of origin.</p></sec></sec></sec><sec id="S10" sec-type="discussion"><title>Discussion</title><p id="P39">With CellREST, we introduce a phylogenetic paradigm for analyzing single-cell transcriptomic data. CellREST implements a character-based phylogenetic framework that infers and analyzes gene expression state transitions between cells, thereby addressing a central challenge in trajectory inference – the lack of explicit ancestral information of a cell’s transcriptomic profile. Going beyond previous phylogenetic approaches (<xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R18">18</xref>), CellREST utilizes and extends phylogenetic inference to address non-tree-like transcriptomic landscapes by evaluating and integrating multiple similarly plausible single-cell-labeled Maximum Likelihood trees (scML-trees) into a unified single-cell network (sc-network). An implementation of CellREST is available as an R Package and integrates with the Seurat workflow.</p><p id="P40">Through simulation studies, we demonstrate that Cell-REST effectively recovers non-linear, circular trajectories – capabilities beyond many conventional trajectory or single-tree-based methods. In this context, CellREST distances between cells more accurately reflect the underlying temporal information than Euclidean distances computed from expression profiles, PC space, or UMAP embeddings. This improved resolution arises from their basis in model-inferred branch lengths and their definition as shortest paths, allowing them to follow curved transcriptomic trajectories. When applied to experimental data, such as mouse pancreatic endocrinogenesis, CellREST reveals converging differentiation waves and enhances their visualization via sc-network edges. Moreover, by identifying direct connections between cell types, CellREST can help to formulate hypotheses about putative progenitor cells or cells of origin, as shown in our analysis of renal cell carcinoma data.</p><p id="P41">The sc-network constructed by CellREST does not follow classical phylogenetic network approaches such as Neighbor Net (<xref ref-type="bibr" rid="R42">42</xref>, <xref ref-type="bibr" rid="R43">43</xref>). This established method relies on predefined distances and often struggles to capture circular or noisy transcriptomic structures. Consensus Networks and other splits-based techniques (<xref ref-type="bibr" rid="R44">44</xref>) are especially sensitive to rogue taxa and noise, as demonstrated by the biologically uninformative Robinson-Foulds-based embeddings of scML-trees. Additionally, the scale of typical single-cell datasets exceeds the computational capabilities of many existing phylogenetic network implementations (<xref ref-type="bibr" rid="R45">45</xref>).</p><sec id="S11"><title>Open questions and limitations</title><p id="P42">We are convinced that CellREST can be extended to other types of multi-model sequencing data through the use of phylogenetic partition models. Similarly, heterotachy models (<xref ref-type="bibr" rid="R46">46</xref>), which are designed to accommodate rate variation across lineages, may enhance the CellREST performance. However, the high dimensionality of the pseudo-alignments already pushes the limits of existing phylogenetic models and algorithms, and increasing model complexity risks introducing instability into tree inference. Beyond relying on stochastic variation between repeated maximum likelihood tree searches, future directions could include alternative strategies for exploring the scML-tree space, such as identifying terraces of quasi-likely trees (<xref ref-type="bibr" rid="R47">47</xref>) or employing Bayesian frameworks (<xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R50">50</xref>).</p><p id="P43">Currently, CellREST constructs pseudo-alignments by binning log-normalized gene expression values across a limited number of highly variable genes, that can be smaller than the number of considered cells. While variability is crucial for cell type discrimination, we suspect that including moderately or even uniformly expressed genes could benefit phylogenetic signal and contribute to a stable tree inference. Optimizing gene selection, binning strategies, and alternative normalization schemes will be important directions for improving the utility of the resulting pseudo-alignments.</p><p id="P44">The connectivity of the resulting sc-network is determined by the user-defined parameter <italic>B</italic>, comparable to the role of <italic>k</italic> in the construction of <italic>k</italic>-nearest neighbor (NN) and corresponding shared-nearest neighbor (SNN) graphs. However, while <italic>k</italic> is often chosen without clear interpretability, <italic>B</italic> is more directly grounded in tree topology. Additionally, the current strategy for pruning outlier edges – based on the distribution of logarithmized edge lengths – would benefit from further statistical validation or refinement, such as using alternative criteria informed by phylogenetic saturation.</p><p id="P45">Our initial applications, namely CellREST-based visualizations and cell type clustering, represent only a starting point for a refined scRNA-seq analysis. While we value the ongoing developments in the field, such as improved normalization strategies and embedding techniques, we deliberately chose not to benchmark CellREST across diverse preprocessing pipelines. Instead, we focused on a standard workflow to emphasize that CellREST represents a <italic>conceptual shift</italic> in single-cell analysis. Moreover, the lack of appropriate experimental validation datasets currently limits comprehensive benchmarking. We therefore invite the scientific community to explore and build upon CellREST, particularly by utilizing its multi-layered information structure to rethink established analysis routines. At the same time, we acknowledge that the computational demands of repeated large-scale tree inference remain a limitation. However, with ongoing advances in scalable phylogenetic methods (<xref ref-type="bibr" rid="R51">51</xref>), we expect that Cell-REST will become increasingly accessible in practice. By fostering collaboration between the single-cell and phylogenetics communities, we hope to inspire the development of new tools that more accurately reflect the complexity of cell state transitions.</p></sec></sec><sec id="S12" sec-type="methods"><title>Methods</title><sec id="S13"><label>M.1</label><title>Pre-Processing and Downstream Analysis</title><p id="P46">After dataset dependent quality control (see <xref ref-type="sec" rid="S30">Section M.3</xref> and <xref ref-type="sec" rid="S35">Section M.4</xref>), the raw count matrix of a scRNAseq dataset of <italic>m</italic> cells is cell-wise log-normalized (‘<monospace>LogNormalize()</monospace>’) and a dataset dependent number <italic>g</italic> of highly variable genes (‘<monospace>nfeatures = g</monospace>’) is identified (‘<monospace>FindVariableFeatures()</monospace>’) using R package ‘Seurat’ (version 5.1.0) (<xref ref-type="bibr" rid="R21">21</xref>). Read imputation is performed on the complete log-normalized count matrix calling ALRA (<xref ref-type="bibr" rid="R27">27</xref>) via function ‘<monospace>RunALRA()</monospace>’ of R package ‘SeuratWrapper’ (version 0.3.5). ALRA applies singular vector decomposition on the measured count matrix to approximate it via a low-rank matrix. By assuming, that in this low-rank matrix, biological zeros admit values symmetrically distributed around zero, negative values can be used to compute a threshold to assign close-to-zero values as biological zeros.</p><p id="P47">After these pre-processing steps, we obtain an imputed log-normalized count matrix of <italic>m</italic> cells, that we subset to the <italic>g</italic> highly variable genes. Rows of the resulting matrix <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> correspond to cells and columns to genes. This matrix serves as the starting point for the subsequent Cell-REST workflow.</p><p id="P48">For comparative reference, additional Seurat downstream analysis is performed, including gene-wise count scaling (‘<monospace>ScaleData()</monospace>’) and Principal Component Analysis (‘<monospace>RunPCA()</monospace>’), both performed on the selected highly variable genes. If not indicated otherwise, the top 50 principal components, spanning what we refer to the PC space, are used for dimensionality reduction via UMAP (<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>).</p><sec id="S14"><title>Nearest Neighbor Graphs</title><p id="P49">Principal components are also used to construct <italic>k</italic>-nearest neighbor (NN) and the corresponding shared-nearest neighbor (SNN) graphs (‘<monospace>FindNeighbors()</monospace>’). While the NN graph connects each cell to its <italic>k</italic>-nearest neighbors (by default <italic>k</italic> = 20, where the cell itself is counted as <italic>k</italic> = 1), the SNN only connects cells, as soon as they share a certain number of <italic>k</italic>-nearest neighbor. By default, only edges between cells are included in the SNN, as soon as the Jaccard index between the <italic>k</italic>-nearest neighbor sets is greater than 1/15. The Jaccard index is stored as edge attribute ‘weight‘ in the resulting SNN. For the computation of shortest path distances on NN and SNN graphs, edges were additionally assigned an ‘edge length‘ attribute, namely the distance between connected cells in the PC space, in which the graph was constructed. For clustering, by default, Louvain community detection is performed on SNN graph using function ‘<monospace>FindClusters()</monospace>’ for a specified resolution parameter ‘<monospace>res</monospace>’.</p></sec></sec><sec id="S15"><label>M.2</label><title>CellREST Workflow</title><sec id="S16"><label>M.2.1</label><title>Transformation into a Phylogenetic Problem</title><p id="P50">For a scRNA-seq dataset with <italic>m</italic> cells, the log-normalized count matrix <inline-formula><mml:math id="M2"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is subset to <italic>g</italic> highly variable genes and reformulated in phylogenetic terms as follows: For each gene <italic>j</italic>, expression levels across cells <italic>c</italic>.<sub><italic>j</italic></sub> ∈ ℝ<sup><italic>m</italic></sup> are uniformly binned into four discrete expression states (no, low, medium, and high expression) and subsequently renamed into pseudo-nucleotides (T,G,C, and A) by the following scheme:</p><p id="P51">for a cell <italic>i</italic>, where <italic>Q</italic>(<italic>p</italic>) = <italic>p</italic> · (max<sub><italic>i</italic></sub>(<italic>c<sub>ij</sub></italic>) − min<sub><italic>i</italic></sub>(<italic>c<sub>ij</sub></italic>)) + min<sub><italic>i</italic></sub>(<italic>c<sub>ij</sub></italic>) is the theoretical <italic>p</italic>-quantile of the uniform distribution ᵋ[min<sub><italic>i</italic></sub>(<italic>c<sub>ij</sub></italic>), max<sub><italic>i</italic></sub>(<italic>c<sub>ij</sub></italic>)]</p><p id="P52">The resulting pseudo-alignment, which comprises <italic>m</italic> pseudo-taxa (= cells = rows) and <italic>g</italic> pseudo-sites (= genes = columns), is stored as a FASTA file using R package ‘seqinr’ (version 4.2-36) (<xref ref-type="bibr" rid="R52">52</xref>) and can be used for subsequent phylogenetic inference.</p></sec><sec id="S17"><label>M.2.2</label><title>Phylogenetic Inference</title><p id="P53">Preliminary evaluations on test datasets indicated that the Maximum Likelihood (ML) method is best suited for the evaluation of generated pseudo-alignments and identified the nucleotide substitution model GTR+F+G4 as the best-fit using ModelFinder (<xref ref-type="bibr" rid="R53">53</xref>), as implemented in IQ-TREE2 (<xref ref-type="bibr" rid="R24">24</xref>) (version 2.2.2.4). GTR (General Time Reversible) is a flexible model that allows different substitution rates between all pairs of nucleotides, F (empirical base frequencies) incorporates observed nucleotide frequencies from the data, and G4 (Gamma distribution with four rate categories) accounts for rate variation across sites. To maintain consistency and enable comparability across results, this evolutionary model class is fixed for all analyses in this manuscript.</p><p id="P54">For each pseudo-alignment, <italic>n<sub>trees</sub></italic> = 100 single-cell-labeled ML-trees (scML-trees) are inferred using IQ-TREE2 (<xref ref-type="bibr" rid="R24">24</xref>) (version 2.2.2.4). This can be done by calling the IQ-TREE option ‘<monospace>--runs NUM</monospace>’ or using the provided ‘run_iqtree.sh’ script in the CellREST package, which parallelizes the <italic>n<sub>trees</sub></italic> tree inference procedures. To enhance computational efficiency, we perform tree reconstruction using IQ-TREE’s ‘-<monospace>fast</monospace>’ option using a fix number of cores (‘<monospace>N_CORES</monospace>’) and a pre-defined seed (‘<monospace>SEED</monospace>’) for reproducibility: <preformat preformat-type="computer code">iqtree2 -s FASTA_FILE -m GTR+F+G4 -nt N_CORES -seed SEED -fast</preformat>
</p><p id="P55">Reconstructed trees are processed and visualized using R packages ‘ape’ (version 5.8), ‘castor’ (version 1.8.2), ‘ggtree’ (version 3.12.0)(<xref ref-type="bibr" rid="R54">54</xref>) and tips are colored by data-dependent cell annotations.</p></sec><sec id="S18"><label>M.2.3</label><title>Comparing and Integrating scML-trees</title><p id="P56">There are several methods for comparing phylogenetic trees, depending on the specific aspect of interest – such as topology, branch lengths, or leaf labeling. For instance, the Robinson-Foulds (RF) distance (here computed using R package ‘treespace’, version 1.1.4.3 (<xref ref-type="bibr" rid="R30">30</xref>)) measures structural differences between two trees by counting the number of splits (bipartitions) that are unique to each tree. While the RF distance quantifies purely structural differences, the below introduced patristic-correlation is a pseudo-distance that incorporates branch length information.</p><sec id="S19"><title>Patristic Correlation Tree Pseudo-Distance</title><p id="P57">Given one scML-tree, the evolutionary distance – here in the form of expression profile changes – between two different cells can be determined by calculating the sum of the branch lengths along the shortest path that connects them, i.e., the ‘patristic’ distance. By computing the patristic distances between all pairs <italic>i</italic> and <italic>j</italic> of <italic>m</italic> cells given a tree <italic>T</italic>, one obtains a matrix of cell-to-cell patristic distances <disp-formula id="FD1"><label>(1)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mspace width="0.2em"/><mml:mtext>pathdist</mml:mtext><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> which can be vectorized into one high-dimensional patristic distance vector <inline-formula><mml:math id="M4"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p id="P58">Now, to compare two trees <italic>T<sub>i</sub></italic> and <italic>T<sub>j</sub></italic>, that comprise the same set of <italic>m</italic> cells, we first calculate their corresponding patristic cell-distance vectors, denoted by <inline-formula><mml:math id="M5"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M6"><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Following the approach of Chen et al. (<xref ref-type="bibr" rid="R28">28</xref>), we define a similarity measure based on the sample Pearson’s correlation coefficient between the two patristic cell-distance vectors as <disp-formula id="FD2"><label>(2)</label><mml:math id="M7"><mml:mrow><mml:mtext>treedist</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mtext>corr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>vec</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P59">This is a pseudo-distance since there can exist two distinct trees <italic>T<sub>i</sub></italic> ≠ <italic>T<sub>j</sub></italic> for which treedist(<italic>T<sub>i</sub></italic>, <italic>T<sub>j</sub></italic>) = 0. By computing the patristic-correlation between all pairs of <italic>n<sub>trees</sub></italic> trees, one obtains a tree-distance-matrix <disp-formula id="FD3"><label>(3)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>treedist</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo><mml:mspace width="0.2em"/></mml:mrow></mml:math></disp-formula></p><p id="P60">We decided to utilize a correlation measure, since it is more robust to outliers and noise compared to, e.g., the Euclidean distance computed between high-dimensional distance vectors.</p></sec><sec id="S20"><label>Embedding and Hierarchical Clustering of scML-trees</label><p id="P61">A tree-distance-matrix computed via pairwise comparison of all scML-trees can be used to embed the trees into a lower dimension in order to visualize and cluster them. To do so, one can use Principal Coordinate Analysis (PCoA, also called Multidimensional Scaling), which is the equivalent of Principal Component Analysis for distances instead of coordinates, or UMAP, which can be applied on distances as well as on coordinates.</p><p id="P62">For the UMAP computation we use function ‘<monospace>umap()</monospace>’ of R package ‘uwot’ (version 0.2.3) setting parameters as they are the default in UMAP computations with R package ‘Seurat’, i.e., ‘<monospace>n_neighbors = 30</monospace>’, ‘<monospace>min_dist = 1</monospace>’, and ‘<monospace>seed = 42</monospace>’ for reproducibility.</p><p id="P63">For both PCoA and UMAP we use the first two components for visualization and hierarchical clustering of scML-trees with function ‘<monospace>hclust()</monospace>’ of R package ‘stats’ (version 4.4.0) gaining a data-specific number of clusters ‘<monospace>k</monospace>’ using ‘<monospace>cutree()</monospace>’.</p></sec><sec id="S21"><title>Tip-instability Measure</title><p id="P64">To identify rogue taxa, that lead to very different patristic distances across a group of scML-trees, we compute the tip instability measure using function ‘<monospace>TipInstability()</monospace>’ in R package ‘Rogue’ (version 2.1.6) by Smith et al. (<xref ref-type="bibr" rid="R35">35</xref>).</p></sec></sec><sec id="S22"><label>M.2.4</label><title>Single-cell-network Construction</title><sec id="S23"><title>Construction of nn-tree-graphs</title><p id="P65">As a noise-robust representative of a scML-tree we suggest to transform a tree into a nn-tree-graph. To do so, for a tree <italic>T</italic> with <italic>m</italic> cells, we initiate a graph with corresponding <italic>m</italic> vertices. For each cell, we add an edge from the corresponding vertex to all vertices that are at most <italic>B</italic> branches apart. For all analyses of this study, we set <italic>B</italic> = 4. The resulting nn-tree-graph <italic>G</italic> is defined by its adjacency matrix <italic>A</italic>(<italic>G</italic>) ∈ {0, 1}<sup><italic>m</italic>×<italic>m</italic></sup>, where an entry <italic>A</italic>(<italic>G</italic>)<sub><italic>ij</italic></sub> = 1 implies an edge (<italic>i</italic>, <italic>j</italic>) connecting vertices <italic>i</italic> and <italic>j</italic>.</p><p id="P66">For each edge (<italic>i</italic>, <italic>j</italic>), we additionally store the patristic distance between the two connected cells <italic>i</italic> and <italic>j</italic> as <italic>length</italic> attribute <disp-formula id="FD4"><label>(4)</label><mml:math id="M9"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.2em"/><mml:mtext>pathdist</mml:mtext><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S24"><title>Union of nn-tree-graphs into a sc-network</title><p id="P67">For a group of <italic>n<sub>trees</sub></italic> trees <inline-formula><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> defined on the same set of cells <italic>m</italic>, we can construct the union across respective nn-tree-graphs <inline-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> including the same set of vertices <italic>m</italic>. In more detail, we entry-wise sum all adjacency matrices of considered nn-tree-graphs yielding a new, weighted adjacency matrix <disp-formula id="FD5"><label>(5)</label><mml:math id="M12"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>ℕ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P68">This defines the single-cell network (sc-network) <italic>N</italic>, where a positive value <italic>A</italic>(<italic>N</italic>)<sub><italic>ij</italic></sub> &gt; 0 again corresponds to an edges (<italic>i</italic>, <italic>j</italic>) connecting vertices <italic>i</italic> and <italic>j</italic>. The exact value <italic>A</italic>(<italic>N</italic>)<sub><italic>ij</italic></sub> determines the <bold>edge weight</bold> of edge (<italic>i</italic>, <italic>j</italic>), i.e., the number of nn-tree-graphs, in which this edge was observed.</p><p id="P69">For each edge (<italic>i</italic>, <italic>j</italic>) of the sc-network <italic>N</italic>, we additionally compute a representative <bold>edge length</bold> as the minimum of edge lengths across all considered nn-tree-graphs, in which the edge (<italic>i</italic>, <italic>j</italic>) was observed, <disp-formula id="FD6"><label>(6)</label><mml:math id="M13"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>E</italic>(<italic>N</italic>) denotes the set of all edges of graph <italic>N</italic>.</p></sec><sec id="S25"><title>CellREST Distance</title><p id="P70">Finally, the edge lengths of a sc-network can be used to compute a shortest path distance between cells <italic>i</italic> and <italic>j</italic> in the sc-network <italic>N</italic>, which we will refer to as CellREST distance, <disp-formula id="FD7"><label>(7)</label><mml:math id="M14"><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mtext>pathdist</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P71">Computed between all pairs of <italic>m</italic> cells, we obtain the Cell-REST cell-distance-matrix <disp-formula id="FD8"><label>(8)</label><mml:math id="M15"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>pathdist</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S26"><title>Fitting a Normal Distribution to Logarithmized Edge Lengths</title><p id="P72">To fit a theoretical distribution to the empirical distribution of edge lengths <italic>l<sup>N</sup></italic> in sc-network <italic>N</italic>, we first log-transform all edge lengths such that a symmetric normal distribution can be fitted. The median of the log-transformed edge lengths is used as an estimate for the mean of the normal distribution <disp-formula id="FD9"><label>(9)</label><mml:math id="M16"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P73">To ensure robustness against large outliers, we make use of the fact that, under the normal distribution, the interquantile range is proportional to the standard deviation. Therefore, we estimate the standard deviation as <disp-formula id="FD10"><label>(10)</label><mml:math id="M17"><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>IQR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1.349</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where [<italic>l</italic>(<italic>i</italic>, <italic>j</italic>|<italic>N</italic>)]<sub>(<italic>i</italic>, <italic>j</italic>)∈<italic>E</italic>(<italic>N</italic>)</sub> is the vector containing all log-arithmized edge lengths of network <italic>N</italic>, and IQR(<italic>x</italic>) := <italic>Q<sub>x</sub></italic>(3/4) − <italic>Q<sub>x</sub></italic>(1/3) the interquartile range of a vector <italic>x</italic> with <italic>Q<sub>x</sub></italic>(1/4) and <italic>Q<sub>x</sub></italic>(3/4) being the empirical lower and upper quartiles of <italic>x</italic>, respectively.</p><p id="P74">We perform pruning on edges, that have a length greater than the theoretical 99.99% quantile of the fitted normal distribution <inline-formula><mml:math id="M18"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec></sec><sec id="S27"><label>M.2.5</label><title>Sc-network-based Downstream Analysis</title><sec id="S28"><title>Distance-based Embeddings</title><p id="P75">We use the CellREST distance-matrix for visualizations of cells via dimensionality reduction methods PCoA and UMAP (as described for the tree-distance-matrix in <xref ref-type="sec" rid="S18">Section M.2.3</xref>). Using the coordinates of embedded cells, corresponding network edges can be plotted using R package ‘igraph’ (version 2.0.3) (<xref ref-type="bibr" rid="R55">55</xref>) to additionally visualize the connectivity of the sc-network. As an alternative visualization, we also include UMAP embeddings computed on shortest path distances after replacing the minimal patristic distance by the minimal branch count between cells as an edge length attribute in the sc-network.</p></sec><sec id="S29"><title>Cell Clustering</title><p id="P76">To perform clustering on the CellREST sc-network, we transform the network to an unweighted adjacency matrix (entries either 0 or 1 depending on the existence of an edge) and store it as ‘Graph’ object in ‘<monospace>obj@graphs$CellREST</monospace>’ of the corresponding Seurat object ‘<monospace>obj</monospace>’. Subsequently, we perform Louvain clustering by calling Seurat function ‘<monospace>FindClusters()</monospace>’ specifying ‘<monospace>graph.name = ‘CellREST’</monospace>’.</p></sec></sec></sec><sec id="S30"><label>M.3</label><title>Simulation with Dyngen</title><p id="P77">For our simulation studies we use R package ‘dyngen’ (version 1.0.5) (<xref ref-type="bibr" rid="R33">33</xref>) to generate scRNA-seq data following predefined trajectories. Dyngen integrates a gene regulatory network and a module network that defines the ‘backbone’ topology, the main trajectory the simulated cells will follow. To generate realistic gene expression levels along a continuous simulation time scale, transcription, splicing and translation is simulated in a chain of reactions via Gillespie’s stochastic simulation algorithm (<xref ref-type="bibr" rid="R34">34</xref>). Finally, cells and mRNA molecules are sampled to imitate the technical procedure of sequencing.</p><p id="P78">For the CellREST binning procedure 300 highly variable genes are used for all simulated datasets.</p><sec id="S31"><label>M.3.1</label><title>Simple Circular Process</title><p id="P79">Initially, 2,000 cells are simulated based on the ‘cycle_simple’ backbone, the simulation model was initialized using function ‘<monospace>initialise_model()</monospace>’ setting ‘<monospace>num_tfs = 500</monospace>’ (number of transcription factors), ‘<monospace>num_targets = 500</monospace>’ (number of target genes) and ‘<monospace>num_hks = 1000</monospace>’ (number of housekeeping genes) with seed 14 and running 1 simulation with census interval 0.1, i.e., ‘<monospace>simulation_default(experiment_params = simulation_type_wild_type(num_simulations = 1), census_interval = .1)</monospace>’. Since one simulation approximately covers around 2.5 repetitions of the circle backbone, cells are subset to only one cycle loop and sub-sampled to 150 cell from each of the three milestone states <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub> and <italic>s</italic><sub>3</sub>. Finally, the simulation time on the remaining 450 cells is scaled to [0, 1] and Seurat downstream analysis is performed as described above.</p></sec><sec id="S32"><label>M.3.2</label><title>Correlation of Simulation Time Differences in Circular Processes</title><p id="P80">To evaluate how well CellREST distances, Euclidean distances in embeddings and shortest path distances on NN or SNN graphs (construction see <xref ref-type="sec" rid="S13">Section M.1</xref>) encode the simulation time, we performed a correlation based evaluation.</p><p id="P81">First we start by constructing a matrix of cycle-aware simulation time differences between all <italic>m</italic> cells. To do so, we compute differences in simulation time between all pairs of cells and store them in matrix <italic>D<sup>forward</sup></italic> ∈ ℝ<sup><italic>m</italic>×<italic>m</italic></sup>. To take into account the circular shape of the topology, i.e., the fact that simulation time 1 and 0 coincide, we also compute the simulation time differences on the reversed simulation time <italic>D<sup>backward</sup></italic> = −<italic>D<sup>forward</sup></italic>%1, using modulo operator %. The final simulation time difference matrix <italic>D<sup>time</sup></italic> is then defined as entry-wise minimum <disp-formula id="FD11"><label>(11)</label><mml:math id="M19"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P82">To compare <italic>D<sup>time</sup></italic> with other method-specific distance-matrices <italic>D<sup>method</sup></italic>, for each cell <italic>i</italic> we compute the Kendall’s correlation coefficient <italic>τ</italic> between corresponding rows of <italic>D<sup>time</sup></italic> and <italic>D<sup>method</sup></italic> <disp-formula id="FD12"><label>(12)</label><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P83">Across all <italic>m</italic> cells this yields a set of Kendall’s correlation coefficients {<italic>τ<sub>i</sub></italic>}<sub>1≤<italic>i</italic>≤<italic>m</italic></sub> that can be visualized via boxplots using ‘ggplot2’ (version 3.5.1).</p></sec><sec id="S33"><label>M.3.3</label><title>Discontinuous Circular Process</title><p id="P84">To simulated missing ancestral information, simulated cells from a circular process are subset by deleting those cells of scaled simulation time in intervals <italic>I</italic><sub>1</sub> = (0.45, 0.5) and <italic>I</italic><sub>2</sub> = (0.15, 0.95). Downstream analysis is repeated on the remaining 314 cells.</p></sec><sec id="S34"><label>M.3.4</label><title>Disconnected Cell Groups</title><p id="P85">500 cells are simulated based on the ‘disconnected’ backbone, the simulation model was initialized setting ‘<monospace>num_tfs = 500</monospace>’, <monospace>num_targets = 500</monospace>’ and <monospace>num_hks = 1000</monospace>’ with seed 14 and running 10 simulations, i.e., ‘<monospace>simulation_params = simulation_default(experiment_params = simulation_type_wild_type(num_simulations = 10))</monospace>’. Running several simulations mimics the biological scenarios that multiple cell lineages follow and are sampled along the same trajectory.</p></sec></sec><sec id="S35"><label>M.4</label><title>Experimental Datasets</title><p id="P86">For all experimental datasets 3,000 highly variable genes are used for Seurat as well as CellREST analyses. For the visualization of trees, we additionally used function ‘<monospace>groupOTU()</monospace>’ of package ‘ggtree.’</p><sec id="S36"><label>M.4.1</label><title>Mouse Pancreatic Endocrinogenesis</title><p id="P87">The ‘anndata’ object including pre-processed scRNA-seq counts and cell type annotation of the developing mouse pancreas sampled from embryonic day 15.5 published by Bastidas-Ponce et al. (<xref ref-type="bibr" rid="R37">37</xref>) was imported using Python package ‘scvelo’ (version 0.3.3) (<xref ref-type="bibr" rid="R56">56</xref>) via function ‘<monospace>scvelo.datasets.pancreas()</monospace>’ and loaded into R via package ‘anndata’ (version 0.7.5.6). A Seurat object is initialized importing raw counts and metadata, comprising 3,696 cells.</p></sec><sec id="S37"><label>M.4.2</label><title>Benchmark PBMC cells</title><p id="P88">Clustering benchmark PBMC data from Fu et al. (<xref ref-type="bibr" rid="R38">38</xref>) was downloaded from Zenodo (<xref ref-type="bibr" rid="R57">57</xref>). A Seurat object is initialized using raw counts imported from ‘Liu_raw_data.csv’ and cell type annotation imported from ‘Liu_purified_celltype.csv’. Only genes that were measured in at least one cell are retained yielding a dataset comprising 9,266 cells. For the comparison of cell type annotations by Louvain community detection obtained clusterings the Adjusted Rand Index (ARI) is computed using R package <monospace>mclust</monospace> (version 6.1.1).</p></sec><sec id="S38"><label>M.4.3</label><title>Human Renal Carcinoma Cancer</title><p id="P89">Data of clear and chromophobe renal cell carcinoma (RCC) samples and benign tissue published by Zhang et al. (<xref ref-type="bibr" rid="R39">39</xref>) were downloaded from the National Center for Biotechnology Information Gene Expression Omnibus (GEO) under study number GSE159115. Per sample, genes are filtered following the processing described in Zhang et al. (<xref ref-type="bibr" rid="R39">39</xref>), i.e., only genes detected in at least five cells are retained and uninformative mitochondrial, ribosomal, and sex genes are removed. Subsequently, only high-quality cells listed in the provided metadata ‘GSE159115_ccRCC_anno.csv’, ‘GSE159115_chRCC_anno.csv’ and ‘GSE159115_normal_anno.csv’ are kept for the subsequent analysis. All samples are merged (without batch-correction) into one Seurat object comprising 29,474 cells. Prior to Seurat downstream analysis and application of CellREST, the dataset is subset to 5,000 randomly sampled cells, which are assigned as tumor cells, and all 3,956 cells that are assigned as Epithelial cells across all samples.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS207573-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d65aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S39"><title>Acknowledgments</title><p>Work in A.v.H.’s laboratory is supported by the Austrian Science Fund (Special Research Program SFB-F78, F 7811-B) and the Research Platform SinCeReSt - Single cell regulation of stem cells. We thank all members of the A.v.H.’s laboratory for their feedback and especially want to thank Florian Pflug and Stephanie Naas for insightful discussions.</p></ack><sec id="S40" sec-type="data-availability"><title>Data and Code availability</title><p id="P90">The CellREST R package will be accessible on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/jn-goe/CellRESThttps://github.com/jn-goe/CellREST">https://github.com/jn-goe/CellRESThttps://github.com/jn-goe/CellREST</ext-link>).</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P91"><bold>Author contributions</bold></p><p id="P92">Conceptualisation: J.N., C.E. and A.v.H; Methodology: J.N., C.E.; Software: J.N.; Formal analysis: J.N., C.E.; Visualisation: J.N.; Writing - original draft: J.N.; Writing - review and editing: J.N., C.E. and A.v.H.</p></fn><fn id="FN2" fn-type="conflict"><p id="P93"><bold>Competing Interests</bold></p><p id="P94">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title><source>Nature Biotechnology</source><year>2014</year><volume>32</volume><fpage>381</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><pub-id pub-id-type="pmcid">PMC4122333</pub-id><pub-id pub-id-type="pmid">24658644</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><etal/></person-group><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nature Methods</source><year>2017</year><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><pub-id pub-id-type="pmcid">PMC5764547</pub-id><pub-id pub-id-type="pmid">28825705</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>J</given-names></name><etal/></person-group><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title><source>Nature</source><year>2019</year><volume>566</volume><fpage>496</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id><pub-id pub-id-type="pmcid">PMC6434952</pub-id><pub-id pub-id-type="pmid">30787437</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Street</surname><given-names>K</given-names></name><etal/></person-group><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title><source>BMC Genomics</source><year>2018</year><volume>19</volume><fpage>477</fpage><pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id><pub-id pub-id-type="pmcid">PMC6007078</pub-id><pub-id pub-id-type="pmid">29914354</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setty</surname><given-names>M</given-names></name><etal/></person-group><article-title>Characterization of cell fate probabilities in single-cell data with Palantir</article-title><source>Nature Biotechnology</source><year>2019</year><volume>37</volume><fpage>451</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1038/s41587-019-0068-4</pub-id><pub-id pub-id-type="pmcid">PMC7549125</pub-id><pub-id pub-id-type="pmid">30899105</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><etal/></person-group><article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title><source>Nature Communications</source><year>2019</year><volume>10</volume><elocation-id>1903</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-09670-4</pub-id><pub-id pub-id-type="pmcid">PMC6478907</pub-id><pub-id pub-id-type="pmid">31015418</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>M</given-names></name><etal/></person-group><article-title>CellRank for directed single-cell fate mapping</article-title><source>Nature Methods</source><year>2022</year><volume>19</volume><fpage>159</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01346-6</pub-id><pub-id pub-id-type="pmcid">PMC8828480</pub-id><pub-id pub-id-type="pmid">35027767</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiler</surname><given-names>P</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name><name><surname>Theis</surname><given-names>F</given-names></name></person-group><article-title>CellRank 2: unified fate mapping in multiview single-cell data</article-title><source>Nature Methods</source><year>2024</year><volume>21</volume><fpage>1196</fpage><lpage>1205</lpage><pub-id pub-id-type="doi">10.1038/s41592-024-02303-9</pub-id><pub-id pub-id-type="pmcid">PMC11239496</pub-id><pub-id pub-id-type="pmid">38871986</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faure</surname><given-names>L</given-names></name><name><surname>Soldatov</surname><given-names>R</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Adameyko</surname><given-names>I</given-names></name></person-group><article-title>scFates: a scalable python package for advanced pseudotime and bifurcation analysis from single-cell data</article-title><source>Bioinformatics</source><year>2023</year><volume>39</volume><elocation-id>btac746</elocation-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btac746</pub-id><pub-id pub-id-type="pmcid">PMC9805561</pub-id><pub-id pub-id-type="pmid">36394263</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>A comparison of single-cell trajectory inference methods</article-title><source>Nature Biotechnology</source><year>2019</year><volume>37</volume><fpage>547</fpage><lpage>554</lpage><pub-id pub-id-type="pmid">30936559</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saitou</surname><given-names>N</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title><source>Molecular Biology and Evolution</source><year>1987</year><volume>4</volume><fpage>406</fpage><lpage>425</lpage><pub-id pub-id-type="pmid">3447015</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><article-title>BIONJ: an improved version of the NJ algorithm based on a simple model of sequence data</article-title><source>Molecular Biology and Evolution</source><year>1997</year><volume>14</volume><fpage>685</fpage><lpage>695</lpage><pub-id pub-id-type="pmid">9254330</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from DNA sequences: A maximum likelihood approach</article-title><source>Journal of Molecular Evolution</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="pmid">7288891</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parra</surname><given-names>RG</given-names></name><etal/></person-group><article-title>Reconstructing complex lineage trees from scRNA-seq data using MERLoT</article-title><source>Nucleic Acids Research</source><year>2019</year><volume>47</volume><fpage>8961</fpage><lpage>8974</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz706</pub-id><pub-id pub-id-type="pmcid">PMC6755101</pub-id><pub-id pub-id-type="pmid">31428793</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrido</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Visualizing hierarchies in scRNA-seq data using a density tree-biased autoencoder</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><fpage>i316</fpage><lpage>i324</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btac249</pub-id><pub-id pub-id-type="pmcid">PMC9235514</pub-id><pub-id pub-id-type="pmid">35758814</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><etal/></person-group><article-title>A high-resolution transcriptomic and spatial atlas of cell types in the whole mouse brain</article-title><source>Nature</source><year>2023</year><volume>624</volume><fpage>317</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06812-z</pub-id><pub-id pub-id-type="pmcid">PMC10719114</pub-id><pub-id pub-id-type="pmid">38092916</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moravec</surname><given-names>JC</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Spector</surname><given-names>DL</given-names></name><name><surname>Diermeier</surname><given-names>SD</given-names></name><name><surname>Gavryushkin</surname><given-names>A</given-names></name></person-group><article-title>Testing for Phylogenetic Signal in Single-Cell RNA-Seq Data</article-title><source>Journal of Computational Biology</source><year>2023</year><volume>30</volume><fpage>518</fpage><lpage>537</lpage><pub-id pub-id-type="doi">10.1089/cmb.2022.0357</pub-id><pub-id pub-id-type="pmcid">PMC10125402</pub-id><pub-id pub-id-type="pmid">36475926</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mah</surname><given-names>JL</given-names></name><name><surname>Dunn</surname><given-names>CW</given-names></name></person-group><article-title>Cell type evolution reconstruction across species through cell phylogenies of single-cell RNA sequencing data</article-title><source>Nature Ecology &amp; Evolution</source><year>2024</year><volume>8</volume><fpage>325</fpage><lpage>338</lpage><pub-id pub-id-type="pmid">38182680</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domcke</surname><given-names>S</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>A reference cell tree will serve science better than a reference cell atlas</article-title><source>Cell</source><year>2023</year><volume>186</volume><fpage>1103</fpage><lpage>1114</lpage><pub-id pub-id-type="pmid">36931241</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Church</surname><given-names>SH</given-names></name><name><surname>Mah</surname><given-names>JL</given-names></name><name><surname>Dunn</surname><given-names>CW</given-names></name></person-group><article-title>Integrating phylogenies into single-cell RNA sequencing analysis allows comparisons across species, genes, and cells</article-title><source>PLOS Biology</source><year>2024</year><volume>22</volume><elocation-id>e3002633</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3002633</pub-id><pub-id pub-id-type="pmcid">PMC11125556</pub-id><pub-id pub-id-type="pmid">38787797</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Dictionary learning for integrative, multimodal and scalable single-cell analysis</article-title><source>Nature Biotechnology</source><year>2024</year><volume>42</volume><fpage>293</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1038/s41587-023-01767-y</pub-id><pub-id pub-id-type="pmcid">PMC10928517</pub-id><pub-id pub-id-type="pmid">37231261</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name><etal/></person-group><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nature Biotechnology</source><year>2019</year><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">30531897</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>McInnes</surname><given-names>L</given-names></name></person-group><article-title>Uniform manifold approximation and projection</article-title><source>Nature Reviews Methods Primers</source><year>2024</year><volume>4</volume><fpage>82</fpage><pub-id pub-id-type="doi">10.1038/s43586-024-00363-x</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><etal/></person-group><article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title><source>Molecular Biology and Evolution</source><year>2020</year><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage><pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id><pub-id pub-id-type="pmcid">PMC7182206</pub-id><pub-id pub-id-type="pmid">32011700</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwabe</surname><given-names>D</given-names></name><name><surname>Formichetti</surname><given-names>S</given-names></name><name><surname>Junker</surname><given-names>JP</given-names></name><name><surname>Falcke</surname><given-names>M</given-names></name><name><surname>Rajewsky</surname><given-names>N</given-names></name></person-group><article-title>The transcriptome dynamics of single cells during the cell cycle</article-title><source>Molecular Systems Biology</source><year>2020</year><volume>16</volume><elocation-id>e9946</elocation-id><pub-id pub-id-type="doi">10.15252/msb.20209946</pub-id><pub-id pub-id-type="pmcid">PMC7672610</pub-id><pub-id pub-id-type="pmid">33205894</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavel</surname><given-names>A</given-names></name><name><surname>Grønberg</surname><given-names>MG</given-names></name><name><surname>Clemmensen</surname><given-names>LH</given-names></name></person-group><article-title>The impact of dropouts in scRNAseq dense neighborhood analysis</article-title><source>Computational and Structural Biotechnology Journal</source><year>2025</year><volume>27</volume><fpage>1278</fpage><lpage>1285</lpage><pub-id pub-id-type="doi">10.1016/j.csbj.2025.03.033</pub-id><pub-id pub-id-type="pmcid">PMC11992407</pub-id><pub-id pub-id-type="pmid">40225837</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Linderman</surname><given-names>GC</given-names></name><etal/></person-group><article-title>Zero-preserving imputation of single-cell RNA-seq data</article-title><source>Nature Communications</source><year>2022</year><volume>13</volume><fpage>192</fpage><pub-id pub-id-type="doi">10.1038/s41467-021-27729-z</pub-id><pub-id pub-id-type="pmcid">PMC8752663</pub-id><pub-id pub-id-type="pmid">35017482</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Ng</surname><given-names>YK</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>S</given-names></name></person-group><article-title>On triangle inequalities of correlation-based distances for gene expression profiles</article-title><source>BMC Bioinformatics</source><year>2023</year><volume>24</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1186/s12859-023-05161-y</pub-id><pub-id pub-id-type="pmcid">PMC9906874</pub-id><pub-id pub-id-type="pmid">36755234</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>W</given-names></name><etal/></person-group><article-title>TreeScaper: Visualizing and Extracting Phylogenetic Signal from Sets of Trees</article-title><source>Molecular Biology and Evolution</source><year>2016</year><volume>33</volume><fpage>3314</fpage><lpage>3316</lpage><pub-id pub-id-type="pmid">27634869</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jombart</surname><given-names>T</given-names></name><name><surname>Kendall</surname><given-names>M</given-names></name><name><surname>Almagro-Garcia</surname><given-names>J</given-names></name><name><surname>Colijn</surname><given-names>C</given-names></name></person-group><article-title>treespace: Statistical exploration of landscapes of phylogenetic trees</article-title><source>Molecular Ecology Resources</source><year>2017</year><volume>17</volume><fpage>1385</fpage><lpage>1392</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12676</pub-id><pub-id pub-id-type="pmcid">PMC5724650</pub-id><pub-id pub-id-type="pmid">28374552</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>MR</given-names></name></person-group><article-title>Robust Analysis of Phylogenetic Tree Space</article-title><source>Systematic Biology</source><year>2022</year><volume>71</volume><fpage>1255</fpage><lpage>1270</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syab100</pub-id><pub-id pub-id-type="pmcid">PMC9366458</pub-id><pub-id pub-id-type="pmid">34963003</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Rubbi</surname><given-names>A</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Marleen</surname><given-names>I</given-names></name></person-group><source>Pear-EBI</source><year>2024</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://github.com/AndreaRubbi/Pear-EBI">https://github.com/AndreaRubbi/Pear-EBI</ext-link></comment></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Deconinck</surname><given-names>L</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><article-title>Spearheading future omics analyses using dyngen, a multi-modal simulator of single cells</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><elocation-id>3942</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-24152-2</pub-id><pub-id pub-id-type="pmcid">PMC8225657</pub-id><pub-id pub-id-type="pmid">34168133</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><article-title>Exact stochastic simulation of coupled chemical reactions</article-title><source>The Journal of Physical Chemistry</source><year>1977</year><volume>81</volume><fpage>2340</fpage><lpage>2361</lpage><pub-id pub-id-type="doi">10.1021/j100540a008</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>MR</given-names></name></person-group><article-title>Using Information Theory to Detect Rogue Taxa and Improve Consensus Trees</article-title><source>Systematic Biology</source><year>2022</year><volume>71</volume><fpage>1088</fpage><lpage>1094</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syab099</pub-id><pub-id pub-id-type="pmcid">PMC9366444</pub-id><pub-id pub-id-type="pmid">34951650</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crowell</surname><given-names>HL</given-names></name><name><surname>Morillo Leonardo</surname><given-names>SX</given-names></name><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>The shaky foundations of simulating single-cell RNA sequencing data</article-title><source>Genome Biology</source><year>2023</year><volume>24</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1186/s13059-023-02904-1</pub-id><pub-id pub-id-type="pmcid">PMC10061781</pub-id><pub-id pub-id-type="pmid">36991470</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastidas-Ponce</surname><given-names>A</given-names></name><etal/></person-group><article-title>Comprehensive single cell mRNA profiling reveals a detailed roadmap for pancreatic endocrinogenesis</article-title><source>Development</source><year>2019</year><volume>146</volume><elocation-id>dev173849</elocation-id><pub-id pub-id-type="pmid">31160421</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Q</given-names></name><etal/></person-group><article-title>A comparison of scRNA-seq annotation methods based on experimentally labeled immune cell subtype dataset</article-title><source>Briefings in Bioinformatics</source><year>2024</year><volume>25</volume><elocation-id>bbae392</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbae392</pub-id><pub-id pub-id-type="pmcid">PMC11312369</pub-id><pub-id pub-id-type="pmid">39120646</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Single-cell analyses of renal cell cancers reveal insights into tumor microenvironment, cell of origin, and therapy response</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2021</year><volume>118</volume><elocation-id>e2103240118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2103240118</pub-id><pub-id pub-id-type="pmcid">PMC8214680</pub-id><pub-id pub-id-type="pmid">34099557</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title><source>Scientific Reports</source><year>2019</year><volume>9</volume><elocation-id>5233</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id><pub-id pub-id-type="pmcid">PMC6435756</pub-id><pub-id pub-id-type="pmid">30914743</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumos</surname><given-names>L</given-names></name><etal/></person-group><article-title>Best practices for single-cell analysis across modalities</article-title><source>Nature Reviews Genetics</source><year>2023</year><volume>24</volume><fpage>550</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1038/s41576-023-00586-w</pub-id><pub-id pub-id-type="pmcid">PMC10066026</pub-id><pub-id pub-id-type="pmid">37002403</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryant</surname><given-names>D</given-names></name><name><surname>Moulton</surname><given-names>V</given-names></name></person-group><article-title>Neighbor-Net: An Agglomerative Method for the Construction of Phylogenetic Networks</article-title><source>Molecular Biology and Evolution</source><year>2004</year><volume>21</volume><fpage>255</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">14660700</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryant</surname><given-names>D</given-names></name><name><surname>Huson</surname><given-names>DH</given-names></name></person-group><article-title>NeighborNet: improved algorithms and implementation</article-title><source>Frontiers in Bioinformatics</source><year>2023</year><volume>3</volume><pub-id pub-id-type="doi">10.3389/fbinf.2023.1178600</pub-id><pub-id pub-id-type="pmcid">PMC10548196</pub-id><pub-id pub-id-type="pmid">37799982</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><name><surname>Bryant</surname><given-names>D</given-names></name></person-group><article-title>The SplitsTree App: interactive analysis and visualization using phylogenetic trees and networks</article-title><source>Nature Methods</source><year>2024</year><volume>21</volume><fpage>1773</fpage><lpage>1774</lpage><pub-id pub-id-type="pmid">39223398</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hejase</surname><given-names>HA</given-names></name><name><surname>Liu</surname><given-names>KJ</given-names></name></person-group><article-title>A scalability study of phylogenetic network inference methods using empirical datasets and simulations involving a single reticulation</article-title><source>BMC Bioinformatics</source><year>2016</year><volume>17</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1186/s12859-016-1277-1</pub-id><pub-id pub-id-type="pmcid">PMC5064893</pub-id><pub-id pub-id-type="pmid">27737628</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Philippe</surname><given-names>H</given-names></name><name><surname>Lopez</surname><given-names>P</given-names></name></person-group><article-title>On the conservation of protein sequences in evolution</article-title><source>Trends in Biochemical Sciences</source><year>2001</year><volume>26</volume><fpage>414</fpage><lpage>416</lpage><pub-id pub-id-type="pmid">11469218</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>MJ</given-names></name><name><surname>McMahon</surname><given-names>MM</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name><name><surname>Zwickl</surname><given-names>DJ</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><article-title>Impacts of Terraces on Phylogenetic Inference</article-title><source>Systematic Biology</source><year>2015</year><volume>64</volume><fpage>709</fpage><lpage>726</lpage><pub-id pub-id-type="pmid">25999395</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name></person-group><article-title>MRBAYES: Bayesian inference of phylogenetic trees</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>754</fpage><lpage>755</lpage><pub-id pub-id-type="pmid">11524383</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title><source>BMC Evolutionary Biology</source><year>2007</year><volume>7</volume><fpage>214</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id><pub-id pub-id-type="pmcid">PMC2247476</pub-id><pub-id pub-id-type="pmid">17996036</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname><given-names>R</given-names></name><etal/></person-group><article-title>BEAST 2: A Software Platform for Bayesian Evolutionary Analysis</article-title><source>PLOS Computational Biology</source><year>2014</year><volume>10</volume><elocation-id>e1003537</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003537</pub-id><pub-id pub-id-type="pmcid">PMC3985171</pub-id><pub-id pub-id-type="pmid">24722319</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><etal/></person-group><article-title>Maximum likelihood pandemic-scale phylogenetics</article-title><source>Nature Genetics</source><year>2023</year><volume>55</volume><fpage>746</fpage><lpage>752</lpage><pub-id pub-id-type="doi">10.1038/s41588-023-01368-0</pub-id><pub-id pub-id-type="pmcid">PMC10181937</pub-id><pub-id pub-id-type="pmid">37038003</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Charif</surname><given-names>D</given-names></name><name><surname>Lobry</surname><given-names>JR</given-names></name></person-group><chapter-title>SeqinR 1.0-2: A Contributed Package to the R Project for Statistical Computing Devoted to Biological Sequences Retrieval and Analysis</chapter-title><person-group person-group-type="editor"><name><surname>Bastolla</surname><given-names>U</given-names></name><name><surname>Porto</surname><given-names>M</given-names></name><name><surname>Roman</surname><given-names>HE</given-names></name><name><surname>Vendruscolo</surname><given-names>M</given-names></name></person-group><source>Structural Approaches to Sequence Evolution: Molecules, Networks, Populations</source><publisher-name>Springer</publisher-name><publisher-loc>Berlin, Heidelberg</publisher-loc><year>2007</year><fpage>207</fpage><lpage>232</lpage></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalyaanamoorthy</surname><given-names>S</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Wong</surname><given-names>TKF</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Jermiin</surname><given-names>LS</given-names></name></person-group><article-title>ModelFinder: fast model selection for accurate phylogenetic estimates</article-title><source>Nature Methods</source><year>2017</year><volume>14</volume><fpage>587</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4285</pub-id><pub-id pub-id-type="pmcid">PMC5453245</pub-id><pub-id pub-id-type="pmid">28481363</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name></person-group><article-title>Using ggtree to Visualize Data on Tree-Like Structures</article-title><source>Current Protocols in Bioinformatics</source><year>2020</year><volume>69</volume><fpage>e96</fpage><pub-id pub-id-type="pmid">32162851</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csardi</surname><given-names>G</given-names></name><name><surname>Nepusz</surname><given-names>T</given-names></name></person-group><article-title>The igraph software</article-title><source>Complex syst</source><year>2006</year><volume>1695</volume><fpage>1</fpage><lpage>9</lpage></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergen</surname><given-names>V</given-names></name><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Peidli</surname><given-names>S</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Generalizing RNA velocity to transient cell states through dynamical modeling</article-title><source>Nature Biotechnology</source><year>2020</year><volume>38</volume><fpage>1408</fpage><lpage>1414</lpage><pub-id pub-id-type="pmid">32747759</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Q</given-names></name></person-group><source>A Comparison of scRNA-seq Annotation Methods Based on Experimentally Labeled Immune Cell Subtype Dataset</source><year>2024</year><comment>URL <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10947879">https://zenodo.org/records/10947879</ext-link></comment></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>A Phylogenetic view on scRNA-seq data.</title><p><bold>A</bold> CellREST 1. subsets the scRNA-seq log-normalized cell-times-gene matrix to highly variable genes, 2. transforms the resulting data into a pseudo-alignment and 3. infers single-cell-labeled Maximum Likelihood trees (scML-trees). <bold>B</bold> A single tree topology is insufficient to display 1. non-tree-like dynamics, 2. multiple cell lineages, or 3. unrelated processes, leading to phylogenetic challenges such as polytomies and rogue taxa / subtrees. <bold>C</bold> CellREST reconstructs multiple scML-trees and 1. evaluates their variability via pairwise tree-distances and corresponding tree-embeddings, and 2. transforms all or a subset of scML-trees into nn-tree-graphs and combines them into a unified single-cell network (sc-network). The sc-network defines the CellREST distance as the shortest path-distance between cells given the edge lengths of the network. <bold>D</bold> Visualization of different <italic>B</italic> thresholds used in constructing nn-tree-graphs.</p></caption><graphic xlink:href="EMS207573-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>CellREST recovers non-tree-like dynamics in circular trajectories.</title><p>Abbreviations: dist = distances. <bold>A</bold> Dyngen (<xref ref-type="bibr" rid="R33">33</xref>) simulation of a circular differentiation process, restricted to a single loop with simulation time rescaled to the interval [0, 1]. Variation in data support across the trajectory is visible as changes in cell density. <bold>B</bold> Standard UMAP embedding computed on PC space distances. <bold>C</bold> UMAP tree-embedding of 100 scML-trees based on patristic-correlation, with representative tree and cutting location visualized. <bold>D</bold> Tip instability analysis for tree-clusters from panel C. <bold>E</bold> UMAP visualizations of sc-network based on CellREST distances (top) and shortest path distances using minimal branch counts between cells across nn-tree-graphs (bottom); edge widths reflect edge weights. <bold>F</bold> Comparison of Kendall’s tau correlations between simulation time and distances derived from various embeddings, with circular time correction.</p></caption><graphic xlink:href="EMS207573-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>CellREST recovers non-tree-like dynamics under incomplete sampling.</title><p><bold>A</bold> The simulated circular differentiation process is sub-sampled by removing cells from two time intervals to mimic missing transient states. <bold>B</bold> Standard UMAP embedding of the remaining cells suggests an almost linear arrangement of cells. <bold>C</bold> UMAP tree-embedding of 100 scML-trees based on patristic-correlation; representative tree topologies highlight coverage of different trajectory segments. <bold>D</bold> UMAP visualizations of sc-network based on CellREST distances, with outlier edges (exceeding the quantile threshold) shown in red. <bold>E</bold> Histogram of logarithmized edge lengths in the sc-network with fitted normal distribution (top) and 99.99% quantile marked in red; edge weight vs length plot (bottom). <bold>F</bold> UMAP visualizations of the pruned sc-network based on CellREST distances (left) and shortest path distances using minimal branch counts between cells across nn-tree-graphs (right), with edge widths scaled by edge weight.</p></caption><graphic xlink:href="EMS207573-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>CellREST analysis of mouse endocrinogenesis scRNA-seq data.</title><p>Abbreviations: EP = endocrine progenitor. <bold>A</bold> Standard UMAP embedding (top) and corresponding SNN graph edges (bottom), computed on PC space distances. Cells are colored by cell type annotation, edge widths reflect the Jaccard index between <italic>k</italic> neighborhood sets of connected cells. (<xref ref-type="bibr" rid="R37">37</xref>). <bold>B</bold> Principal Coordinates (PCo) tree-embedding of 100 scML-trees based on patristic-correlation, with representative tree visualized. <bold>C</bold> Histogram of logarithmized edge lengths in the sc-network (top), with a fitted normal distribution and the 99.99% quantile marked; edge weight vs length plot (bottom). <bold>D</bold> UMAP visualization of the full sc-network based on CellREST distances, with outlier edges (exceeding the quantile threshold) shown in red. <bold>E</bold> UMAP visualizations of the pruned sc-network based on CellREST distances (left) and shortest path distances using minimal branch counts between cells across nn-tree-graphs (right), with edge widths scaled by edge weight.</p></caption><graphic xlink:href="EMS207573-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>CellREST analysis of renal cell carcinoma data.</title><p>Abbreviations: PT = proximal tubule, DL = descending limb, tAL = thin ascending limb, TAL = thick ascending limb, DCT = distal convoluted tubule, CNT = connecting duct, PC = principal cells, IC = intercalated cells, Podo = podocytes, RCC = renal cell carcinoma, cRCC = chromophobe RCC, ccRCC = clear cell RCC. <bold>A</bold> Standard UMAP embedding generated using Seurat, with cells are colored by original cell type annotations(<xref ref-type="bibr" rid="R39">39</xref>). ccRCC cells are further split by patient sample. <bold>B</bold> UMAP tree-embedding of 100 scML-trees based on patristic-correlation, with representative tree visualized. <bold>C</bold> UMAP visualizations of pruned sc-network based on CellREST distances, edge widths scaled by edge weights. <bold>D</bold> Edge length and weight of sc-network connections between epithelial cell types and ccRCC (left) or chRCC (right) cells from patient sample SI_18855.</p></caption><graphic xlink:href="EMS207573-f005"/></fig><table-wrap id="T1" position="float" orientation="portrait"><table frame="box" rules="groups"><thead><tr><th valign="top" align="right">expression levels</th><th valign="top" align="center">expression state</th><th valign="top" align="center">pseudonucleotide</th></tr></thead><tbody><tr><td valign="top" align="right"><italic>c<sub>ij</sub></italic> = 0</td><td valign="top" align="center">no expression</td><td valign="top" align="center">T</td></tr><tr><td valign="top" align="right"><inline-formula><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td valign="top" align="center">low expression</td><td valign="top" align="center">G</td></tr><tr><td valign="top" align="right"><inline-formula><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td valign="top" align="center">medium expression</td><td valign="top" align="center">C</td></tr><tr><td valign="top" align="right"><inline-formula><mml:math id="M23"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td valign="top" align="center">high expression</td><td valign="top" align="center">A</td></tr></tbody></table></table-wrap></floats-group></article>