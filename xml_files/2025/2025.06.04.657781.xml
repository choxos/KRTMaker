<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS206212</article-id><article-id pub-id-type="doi">10.1101/2025.06.04.657781</article-id><article-id pub-id-type="archive">PPR1030884</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Cell–ECM Graphs: A Graph-Based Method for Joint Analysis of Cells and the Extracellular Matrix</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Ghafoor</surname><given-names>M.</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Parkinson</surname><given-names>JE.</given-names></name><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Sutherland</surname><given-names>TE.</given-names></name><xref ref-type="aff" rid="A4">d</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Rattray</surname><given-names>M.</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib></contrib-group><aff id="A1"><label>a</label>Division of Informatics, Imaging and Data Sciences, Faculty of Biology, Medicine and Health, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/027m9bs27</institution-id><institution>University of Manchester</institution></institution-wrap>, <city>Manchester</city><postal-code>M13 9PL</postal-code>, <country country="GB">UK</country></aff><aff id="A2"><label>b</label>Lydia Becker Institute of Immunology and Inflammation, Faculty of Biology, Medicine and Health, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/027m9bs27</institution-id><institution>University of Manchester</institution></institution-wrap>, <city>Manchester</city><postal-code>M13 9PL</postal-code>, <country country="GB">UK</country></aff><aff id="A3"><label>c</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0094tm228</institution-id><institution>Wellcome Centre for Cell-Matrix Research</institution></institution-wrap>, Faculty of Biology, Medicine and Health, Manchester <institution-wrap><institution-id institution-id-type="ror">https://ror.org/027m9bs27</institution-id><institution>University of Manchester</institution></institution-wrap>, <city>Manchester</city><postal-code>M13 9PL</postal-code>, <country country="GB">UK</country></aff><aff id="A4"><label>d</label>Institute of Medical Sciences, School of Medicine, Medical Sciences and Nutrition, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/016476m91</institution-id><institution>University of Aberdeen</institution></institution-wrap>, <city>Aberdeen</city>, <postal-code>AB25 2ZD</postal-code>, <country country="GB">UK</country></aff><author-notes><corresp id="CR1">Corresponding authors: <email>magnus.rattray@manchester.ac.uk</email>, <email>mohamed.ghafoor@postgrad.manchester.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>06</day><month>06</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>04</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The extracellular matrix (ECM) provides essential structural and biochemical support to tissues, yet its spatial organization is often underrepresented in computational analyses of spatial proteomics. We present Cell–ECM Graphs, a computational framework that integrates ECM and cellular components into a unified graph structure, enabling joint modelling of cell-cell, ECM-ECM, and cell-ECM interactions. Using both simulated and real data, we evaluate performance across interaction profiling, node classification, spatial clustering, and explainable graph neural networks. Incorporating ECM enhances node classification and reveals biologically meaningful spatial patterns, including disrupted immune–ECM connectivity in allergen-exposed lungs. Cell– ECM Graphs offer a novel approach to analysing ECM architecture and its role in shaping the tissue microenvironment in health and disease.</p></abstract><kwd-group><kwd>Cell graphs</kwd><kwd>Cell-ECM graphs</kwd><kwd>Cell-ECM Interactions</kwd><kwd>Extracellular Matrix</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The extracellular matrix (ECM) is a three-dimensional, non-cellular scaffold present in all tissues. It is constructed from proteins, glycoproteins, glycosaminoglycans, and proteoglycans. At the cellular level, the ECM participates in cell adhesion, migration, proliferation, and differentiation. While at the organ level it influences biomechanical properties, such as tensile strength and elasticity<sup><xref ref-type="bibr" rid="R1">1</xref></sup>.</p><p id="P3">The importance of the ECM is highlighted by the spectrum of severe genetic disorders caused by mutations in ECM related genes<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. Furthermore, the lung ECM, which we demonstrate our novel method on, can be remodelled in diseases such as asthma<sup><xref ref-type="bibr" rid="R3">3</xref></sup>, chronic obstructive pulmonary disorder<sup><xref ref-type="bibr" rid="R4">4</xref></sup> and lung cancer<sup><xref ref-type="bibr" rid="R5">5</xref></sup>.</p><p id="P4">Cell graphs<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref></sup> utilize graph theory for the analysis of biological data and aim to learn structurefunction relationships by modelling the structural organization of a tissue<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. Generally, cells are represented as nodes and cell-cell interactions as edges, although the design may be modified by the addition of other biological entities. Cell graphs have been applied to a broad range of tissues (e.g., brain<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, kidney<sup><xref ref-type="bibr" rid="R9">9</xref></sup> and bone<sup><xref ref-type="bibr" rid="R10">10</xref></sup>), experimental techniques (e.g., haematoxylin and eosin (H&amp;E<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, imaging mass cytometry (IMC) and spatial transcriptomics<sup><xref ref-type="bibr" rid="R9">9</xref></sup>), and pathologies (e.g., cancer<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, diabetes<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and fractures<sup><xref ref-type="bibr" rid="R10">10</xref></sup>). The graph representation enables the use of traditional graph analytics such as interaction tests <sup><xref ref-type="bibr" rid="R14">14</xref></sup> and deep learning methods such as graph neural networks (GNN)<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. Furthermore, cell graphs and GNNs have been utilized with explainability techniques to identify important structures within the graph, such as nuclei importance in ductal carcinoma<sup><xref ref-type="bibr" rid="R16">16</xref></sup>. While many tools exist for analysing cells in biological tissues, few focus on the ECM, underscoring the need for novel methods to study the ECM.</p><p id="P5">Despite the vital nature of the ECM there has been little research attempting to incorporate it into cell graphs. ECM-aware cell graphs were created from H&amp;E images whereby cells are nodes and coloured based on ECM surroundings<sup><xref ref-type="bibr" rid="R10">10</xref></sup>. However, this method is still cell-focused and does not have a separate representation of the ECM. Given the ECM’s importance in the structure, function and pathology of organs, in addition to its inherent network-like structure, incorporating the ECM into cell graphs presents significant potential for analysis using graph theory and graph machine learning. Notably, by integrating ECM graphs with cell graphs, the application of graph analytical methods commonly used for cells-graphs can easily be adapted to focus on the ECM and cell-ECM interactions.</p><p id="P6">Our work presents a novel graph design called Cell-ECM graphs, which incorporates the spatial distribution of cells and the ECM into a single graph. Importantly, the graph design includes two types of nodes, cellular and extracellular. This enables the analysis of cell-cell, ECM-ECM and cell-ECM interactions, as well as alterations that may occur in disease. We test our method on both simulated and real datasets and apply GNNs and explainability techniques to identify and visualize key cell-ECM and ECM-ECM interactions. Moreover, we show that cell-ECM graphs can improve node classification and spatial clustering compared to traditional methods. Finally, we show that down-stream graph analytics usually applied to cell graphs, such as interaction tests, can be adapted for use in Cell-ECM graphs.</p></sec><sec id="S2" sec-type="methods"><title>Method</title><sec id="S3"><title>Simulated Spatial Proteomic Dataset with ECM Markers</title><p id="P7">To systematically evaluate cell-ECM Graphs, we generated a simulated IMC dataset with three ECM markers and controlled spatial organization of ECM and cell types. The ECM was simulated on a 500×500 grid by randomly generating 100 points and connecting them via Delaunay triangulation (ECM marker 1). Additionally, a hollow circular structure (ECM marker 2) containing a smaller circle (ECM marker 3) were added at random locations. Each ECM channel was assigned a distinct intensity range (500, 1000, and 1500, respectively) to simulate marker variability.</p><p id="P8">Cell types were then randomly overlaid onto the ECM: 4000 cells of type A on ECM marker 1, 200 cells of type B on ECM marker 2, and 50 cells each of types C and D on ECM marker 3. To test the ability of Cell-ECM Graphs to capture changes in ECM-ECM and cell-ECM interaction, two datasets were generated. The first altered ECM-ECM interactions by either removing or retaining connections between ECM markers 1 and 2. The second altered cell-ECM interactions by adding 50 type E cells to ECM marker 1. To mimic the scale of murine datasets, each dataset contained 40 regions of interest (ROIs), with 20 per condition.</p></sec><sec id="S4"><title>Murine Imaging mass cytometry Dataset</title><p id="P9">The dataset is derived from the murine lung and the markers are outlined in <xref ref-type="table" rid="T1">Table 1</xref>. A total of 36 760 x 790μm regions of interest (ROI) were captured from 5 mice administered Phosphate-Buffered Saline (PBS), as controls, and 6 mice administered a multiallergen cocktail (Dust mite, Ragweed and Aspergillus fumigatus; DRA), both via the intranasal route <sup><xref ref-type="bibr" rid="R17">17</xref></sup>. Additional information regarding the IMC dataset can be found in the original paper <sup><xref ref-type="bibr" rid="R18">18</xref></sup>.</p></sec><sec id="S5"><title>Cell segmentation and annotation</title><p id="P10">Cell segmentation was performed using the Steinbock pipeline [21]. The DeepCell option with min-max normalization was selected. This approach uses a pre-trained model that predicts cell segmentations from cytoplasmic and nuclear markers from the raw image data. Cells were manually annotated using biological knowledge from known cell markers.</p></sec><sec id="S6"><title>Cell-ECM graph generation</title><p id="P11">A schematic of steps required to build a Cell-ECM graph is outlined in <xref ref-type="fig" rid="F1">Fig 1</xref>. The equation for a graph is <italic>G = (V, E)</italic>, where <italic>V</italic> represents a number of vertices and <italic>E</italic> a set of edges between vertices. The cell graph was constructed by treating each cell as a vertex (or node) and the cell type label assigned to each vertex. To define the edges (or links), representing cell-cell interactions, we find the N<sub>edge</sub>(G) nearest neighbouring cells based on spatial proximity. Subsequently, we pruned any edges with a distance greater than <italic>D<sub>max</sub>(CC)</italic> to refine the Cell graph. This “cell-cell distance” hyperparameter controls the length-scale of a cell interaction.</p><p id="P12">To represent the ECM as a graph, only the ECM markers were selected. The image was divided into <italic>P<sub>size</sub></italic> x <italic>P<sub>size</sub></italic> patches with <italic>N</italic> channels, where <italic>N</italic> is the number of ECM markers. K-means clustering, with K<sub>ECM</sub> clusters, was then applied to these patches where patches were represented by a <italic>N</italic>-dimensional vector representing the mean of each marker within each patch. Patches assigned to a background cluster (little or no ECM expression and relabelled as ECM cluster 0) were removed and the remaining patches became vertices with a label determined by the cluster assignment. To create edges representing ECM-ECM interactions, an edge was added if two ECM nodes are neighbouring and no background nodes are between them.</p><p id="P13">The merging of the cell graph and ECM-graph through cell-ECM edges produced the final Cell-ECM graph. Cell-ECM interactions were added based on finding the N<sub>edge</sub>(G) nearest ECM nodes to each cell, If a cell is within <italic>D<sub>max</sub>(CE)</italic> of the ECM node, a link was added (this “cell-ECM distance” is the final hyperparameter which controls the length-scale of the cell-ECM interactions). This integration created a comprehensive graph that captured cell-cell, ECM-ECM and cell-ECM interactions.</p><p id="P14">Several experiments were performed to test the effect of the Cell-ECM graph hyperparameters. The effects of modifying <italic>P<sub>size</sub></italic> and K<sub>ECM</sub> are visualized in (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). The silhouette score was used to select the optimal K<sub>ECM</sub> as 4 and <italic>P<sub>size</sub></italic> as 5. The optimal <italic>D<sub>max</sub>(CC)</italic> and <italic>D<sub>max</sub>(CE)</italic> were selected based on the results of Bayesian optimization during node classification (see <xref ref-type="table" rid="T2">Table 2</xref> for optimized hyperparameters).</p></sec><sec id="S7"><title>Interaction test</title><p id="P15">The interaction test followed that of imcRtools testInteractions function [21]. The ‘classic’ method was used to count and summarize interactions, whereby each count was divided by the total number of cell types or ECM clusters. The labels of these counts were randomly shuffled 1000 times to create a distribution of the interaction count under spatial randomness. The observed interaction count was compared against this Null distribution to derive empirical p-values (p=0.05). A significant value of +1 indicated significant interactions, -1 avoidance and 0 neither.</p><p id="P16">These values were also summed to compare the interactions of multiple ROIs under a specific condition.</p></sec><sec id="S8"><title>Node Classification and Optimization</title><p id="P17">Once the graphs were built, we performed cellular node classification, using either the neighbouring cells (predicting cell types from direct cell-cell interactions), neighbouring ECM cluster (predicting cell types from direct cell-ECM interactions) and neighbouring cell and ECM (predicting cell types from interacting cells and ECM). This was performed using all the ROIs of the real murine dataset, a feature vector was created by counting the number of cellular, ECM or both interactions for a specific node. A K-nearest neighbour classifier was used to assign a label to each node. For Bayesian optimization, the data was split into 80% training, 10% validation and 10% testing split and optimized for 100 iterations using Mango <sup><xref ref-type="bibr" rid="R19">19</xref></sup> by maximizing the F1-score for cell graphs and cell-ECM graphs independently. The hyper parameter search space <italic>D<sub>max</sub>(CC)</italic> and <italic>D<sub>max</sub>(CE)</italic> was from 0 to 50, while the search space for N<sub>edge</sub>(G) and K<sub>classifier</sub> ranged from 3 to 30. Subsequently, with the optimal hyperparameters for each graph type, 5-fold cross validation was performed to generate more robust results.</p></sec><sec id="S9"><title>Benchmarking Spatial Clustering Methods</title><p id="P18">To benchmark various spatial clustering methods, we first constructed a cell-graph and a cell-ECM graph from a simulated dataset containing four spatial regions. These regions differed in their combinations of cell-ECM interactions: two regions consisted of a single cell type on differing ECMs, one featured a unique cell type on a specific ECM, and the last contained two cell types on the same ECM.</p><p id="P19">Cell neighborhood feature vectors were generated for each cell by counting the number of neighboring interactions with each cell type. Similarly, cell-ECM neighborhood feature vectors were generated by counting the number of interactions with both cell and ECM types. These feature vectors were clustered using K-means with K=4.</p><p id="P20">Local Indicators of Spatial Association Clustering (LisaClust) does not use a graph representation. It operates on spatial coordinates and cell type labels by performing local enrichment analysis using Ripley’s K-function and clustering based on spatial autocorrelation. A key hyperparameter is the interaction radius, which was optimized (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S2</xref>). Although originally designed for cell data, we adapted the method by treating ECM nodes analogously to cells.</p><p id="P21">Leiden clustering is a graph-based community detection algorithm that partitions the graph to optimize a quality function such as modularity. It does not use node features (i.e., cell and ECM labels). A key hyperparameter is the resolution, which controls cluster granularity—higher values yield more clusters and lower values yield fewer (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S3</xref> for optimization).</p><p id="P22">Spectral clustering operates by constructing a similarity matrix from the graph, computing its Laplacian, and performing dimensionality reduction via its eigenvectors. K-means is then applied to the resulting low-dimensional representation. Like Leiden, it does not incorporate node features. The primary hyperparameter is the number of clusters K, set to 4 in this benchmark.</p></sec><sec id="S10"><title>Graph Neural Network and Explainability</title><p id="P23">We implemented a graph neural network (GNN) for node classification on Cell-ECM graphs, node features were set as one-hot encoding of the node label (cell type or ECM cluster). The dataset was randomly split into 80% training, 10% validation, and 10% testing. The model consisted of three GCNConv layers followed by two fully connected layers. The hidden dimension was set to 366, and dropout was applied at a rate of 0.5. Message passing was followed by global add pooling to generate graph-level embeddings. The final output was passed through a log-softmax activation to predict graph class probabilities. The model hyperparameters were optimized using Bayesian optimization.</p><p id="P24">Adam optimizer with a learning rate of 1e-3 and negative log-likelihood loss function were used. Early stopping was employed based on validation loss to prevent overfitting.</p><p id="P25">To interpret model predictions, we applied Integrated Gradients<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, which attributes prediction outcomes to edge importance by integrating gradients from a baseline graph (edge weights set to 0) to the actual input graph (edge weights set to 1). For each edge, the attribution is approximate as: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:math></disp-formula> where is <italic>x<sub>α</sub></italic> the graph with edge weights scaled by <italic>a</italic> and (<italic>x<sub>α</sub></italic>) is the model’s output. The integral was estimated using a discrete Riemann sum implemented with the Captum library <sup><xref ref-type="bibr" rid="R21">21</xref></sup>. The GNN was built using PyTorch Geometric <sup><xref ref-type="bibr" rid="R22">22</xref></sup>.</p></sec></sec><sec id="S11" sec-type="results"><title>Results</title><sec id="S12"><title>Overview of the Cell-ECM Graph Method</title><p id="P26">We developed a novel graph-based framework that integrates traditional cell-cell interactions with ECM components, enabling graph based-analysis of cell-cell, ECM-ECM, and cell-ECM interactions within a single graph structure. This method builds upon conventional cell graphs, which use only cellular nodes and cell-cell edges (<xref ref-type="fig" rid="F2">Fig. 2a</xref>). In contrast, cell-ECM graphs incorporate both cell and ECM nodes, along with cell-ECM and ECM-ECM edges (<xref ref-type="fig" rid="F2">Fig. 2b</xref>). From a single region of interest (ROI; <xref ref-type="fig" rid="F2">Fig. 2c</xref>), we constructed both a cell graph (<xref ref-type="fig" rid="F2">Fig. 2d</xref>) and a cell-ECM graph (<xref ref-type="fig" rid="F2">Fig. 2e</xref>), illustrating the enhanced structural information captured by the latter.</p><p id="P27">The cell-ECM Graph was constructed from a real murine IMC dataset. The first step involves generating a cell graph by representing segmented cells as nodes and their spatial interactions as edges (<xref ref-type="fig" rid="F3">Fig. 3a</xref>). An ECM graph was then created by clustering ECM patches and connecting neighbouring clusters (<xref ref-type="fig" rid="F3">Fig. 3b</xref>). Finally, edges were added between spatially interacting cell and ECM nodes (<xref ref-type="fig" rid="F3">Fig. 3c</xref>), resulting in the complete cell-ECM Graph (<xref ref-type="fig" rid="F3">Fig. 3d</xref>). The entire murine IMC dataset ECM patch images (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>), cell graphs (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>), ECM graphs (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>), cell-ECM interactions (<xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>), and cell-ECM graphs (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>) are provided.</p></sec><sec id="S13"><title>Simulated Spatial Proteomic Data for Assessment of Cell-ECM Graphs</title><p id="P28">To evaluate the utility of Cell-ECM Graphs under controlled conditions, we generated simulated spatial proteomic datasets comprising distinct ECM channels and annotated cell types. Specific cell types were localized to defined ECM clusters to establish ground truth cell-ECM relationships. As shown in <xref ref-type="fig" rid="F4">Figure 4a</xref>, the simulation includes three ECM channels and four cell types, with overlaid cell-cell, ECM-ECM, and cell-ECM interactions visualized using the Cell-ECM Graph framework.</p><p id="P29">To assess the method’s sensitivity to structural variation, we introduced two controlled modifications. Firstly, altered ECM-ECM interactions: a subset with ECM clusters 1 and 3 are disconnected; while in the second set, they are linked (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). Secondly, in terms of cell-ECM interactions: A fifth cell type (Cell Type E) was introduced, interacting with ECM cluster 1 alongside the dominant Cell Type A, simulating a rare but specific cell-ECM interaction (<xref ref-type="fig" rid="F4">Fig. 4c</xref>).</p><p id="P30">These controlled variations allow us to benchmark the model’s ability to detect both structural and compositional differences in the ECM microenvironment.</p></sec><sec id="S14"><title>Graph Neural Network with Explainability Highlights Key ECM-ECM and Cell-ECM Interactions</title><p id="P31">Graph neural networks (GNNs) were employed to classify entire graphs, distinguishing conditions such as control versus disease. To aid in identifying key interactions driving classification, we applied an explainability techniques to highlight the most influential graph edges (<xref ref-type="fig" rid="F5">Fig. 5</xref>).</p><p id="P32">We first trained the model on a simulated dataset of ECM graphs representing two distinct interaction patterns mimicking ECM remodelling. Each graph contained three ECM clusters. The key difference between groups was the interaction between ECM clusters 1 and 3: in Group 1, these clusters remained disconnected, whereas in Group 2, they were directly connected (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). The GNN reached 100% accuracy on the test set and the explainer successfully identified this distinction, with ECM 1-3 interactions ranking among the topmost important features in Group 2 (<xref ref-type="fig" rid="F6">Fig. 6a</xref>) and ECM 1-2 interactions being the most important in Group 1. <xref ref-type="supplementary-material" rid="SD1">Figure S7</xref> shows the training and validation loss.</p><p id="P33">Next, we evaluated cell-ECM graphs with a focus on cell-ECM interactions using a simulated dataset where ECM-ECM interactions were unchanged, but cell-ECM interactions varied. To mimic rare immune cell infiltration, Group 1 lacked Cell E, while Group 2 included a small number of Cell E nodes interacting with ECM 1 (<xref ref-type="fig" rid="F4">Fig. 4c</xref>). The model achieved 100% accuracy on the test set and identified Cell E-ECM 1 edges as most important for classification (<xref ref-type="fig" rid="F7">Fig. 7</xref>). <xref ref-type="supplementary-material" rid="SD1">Figure S8</xref> shows the training and validation loss.</p><p id="P34">We then applied the same method to a real dataset, murine tissue treated with PBS or DRA. Focusing on cell-ECM interactions, an accuracy of 75% on the test set was achieved. In PBS tissue, the top-ranked interactions were between Alveolar fibroblasts cells and ECM 2 (<xref ref-type="fig" rid="F8">Fig. 8a</xref>). While in DRA-treated tissue, the most important interactions were between CD11b<sup>+</sup> immune cells with ECM 3 (<xref ref-type="fig" rid="F8">Fig. 8b</xref>) and monocytes with ECM 1 (<xref ref-type="fig" rid="F8">Fig. 8c</xref>).</p></sec><sec id="S15"><title>Benchmarking of cell-ECM graphs in terms of spatial clustering</title><p id="P35">To evaluate cell-ECM graphs ability to identify various spatial regions, we compared three clustering tools (neighbourhood analysis <sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>, LisaClust <sup><xref ref-type="bibr" rid="R25">25</xref></sup>, spectral clustering <sup><xref ref-type="bibr" rid="R26">26</xref></sup> and Leiden clustering <sup><xref ref-type="bibr" rid="R27">27</xref></sup> using normalized mutual information (NMI) and adjusted rand index (ARI). Each method was adapted to incorporate the ECM information for comparison.</p><p id="P36">To assess each tool’s ability to identify regions with different combinations of cell and ECM, we created a simulated dataset with four different spatial regions that differ in cellular and ECM combinations (<xref ref-type="fig" rid="F9">Fig. 9a</xref>). Regions 1 and 4 have the same cell type but different ECM (cell type A on ECM 1 and 2 respectively). Region 2 contains a cell type on a unique ECM (cell type B on ECM 3) while region 3 contains two cell types on the same ECM (cell types C and D on ECM 2). Cell-ECM graphs delivered the best performance across all methods compared to using only the cellular information. In terms of methods, neighbourhood analysis achieved the highest performance.</p></sec><sec id="S16"><title>Cell-ECM Interactions Improves Node Classification</title><p id="P37">To further evaluate whether incorporating ECM information adds to the graph representation, we use node-level predictions to compare cell and cell-ECM graphs in a real dataset. To ensure fairness, all hyperparameters were optimized independently for each graph type. When using hyperparameters optimized for the cell graph, both the cell graph and cell-ECM Graph achieved a macro F1 score of 46.49%. Since removing cell-ECM edges from the cell-ECM graph reproduces the cell graph structure, the same result is expected. However, under cell-ECM graph optimized settings, the cell-ECM graph achieved a higher macro F1 score of 52.53%, while the cell graph scored 45.47% (<xref ref-type="table" rid="T3">Table 3</xref>). In addition, with the optimal hyperparameters for each graph type, we performed 5-fold cross validation, cell-ECM graphs outperformed cell graphs across all 5 folds (<xref ref-type="fig" rid="F10">Fig. 10</xref>). These results indicate that incorporating ECM neighbours adds meaningful information for classifying cell types at the node level.</p><p id="P38">Using the optimal cell-ECM parameters, we further evaluated performance across individual cell types using either neighbouring cell interactions, ECM interactions or combined cell and ECM interactions (<xref ref-type="fig" rid="F11">Fig. 11a</xref>). ECM interactions alone yielded the lowest scores but were still predictive.</p><p id="P39">Using cell-cell interactions improved performance compared to the ECM alone, while combining both cell and ECM interactions performed best across all metrics (<xref ref-type="fig" rid="F11">Fig. 11b</xref>). Cell-type-specific results are shown in <xref ref-type="fig" rid="F11">Fig. 11c</xref>.</p></sec><sec id="S17"><title>Interaction Analysis of Cell-ECM and ECM-ECM interactions with Cell-ECM Graphs</title><p id="P40">Interaction tests are commonly used to identify significant interactions in cell graphs, the same approach can be extended to cell-ECM graphs. This enables the detection of significant ECM-ECM and cell-ECM interactions. When applied to the simulated ECM graphs, the ground truth ECM remodelling was evident through changes in edge counts but was not captured as significant (<xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>).</p><p id="P41">We then applied the permutation test to the real murine dataset, comparing PBS and DRA conditions (<xref ref-type="fig" rid="F12">Fig. 12</xref>). No significant changes in ECM-ECM connectivity were observed. However, altered cell-ECM interactions were detected. DRA exposure increased interactions between ATI, ATII, and fibroblasts with ECM cluster 2. Immune-ECM interactions were also affected: B cells showed reduced interactions with ECM cluster 3, while CD11b<sup>+</sup> immune cells exhibited a significant increase in interactions with ECM cluster 3. Monocytes, absent in PBS, interacted with ECM cluster 1 in DRA.</p></sec></sec><sec id="S18" sec-type="discussion"><title>Discussion</title><p id="P42">Cell-ECM graphs is a graph representation capable of incorporating the cellular and ECM components into a unified graph enabling a more complete tissue representation. To model a tissue, a graph is constructed comprising nodes of cells and ECM clusters, along with cell-cell, ECM-ECM and cell-ECM edges.</p><p id="P43">Several computational methods have been developed for the spatial analysis of cells in spatial proteomics, such as cell segmentation <sup><xref ref-type="bibr" rid="R28">28</xref></sup>, single-cell clustering and visualization <sup><xref ref-type="bibr" rid="R29">29</xref></sup>, interaction analysis <sup><xref ref-type="bibr" rid="R14">14</xref></sup>, spatial community analysis <sup><xref ref-type="bibr" rid="R30">30</xref></sup>, and cellular neighborhood analysis <sup><xref ref-type="bibr" rid="R31">31</xref></sup>. In contrast, there is a lack of computational tools to aid ECM analysis. Studies that have included ECM markers have tended to conduct comparatively limited ECM analysis compared to cellular analysis, such as visualization of co localization <sup><xref ref-type="bibr" rid="R32">32</xref></sup> and measurement of intensity by expansion around biological structures<sup><xref ref-type="bibr" rid="R34">34</xref></sup>.</p><p id="P44">Methods commonly used for spatial analysis of cells can be adapted for use in cell-ECM graphs. We illustrate this by using an interaction test on cell-ECM graphs, which allowed the visualization of significant cell-cell, ECM-ECM and cell-ECM interactions. We also extend cellular neighbourhood analysis to incorporate ECM, resulting in cell-ECM and ECM neighbourhood analyses. Among all methods benchmarked, cell–ECM neighbourhood analysis performed best. Both cell–ECM neighbourhood analysis and LisaClust (adapted to include ECM) successfully identified all four spatial regions. Although LisaClust is not graph-based, it effectively captures local spatial associations and improved with incorporating the ECM. In contrast, Leiden and spectral clustering are graph-based but do not incorporate cell type or ECM cluster labels, likely contributing to their lower performance. Even with these methods cell-ECM graphs outperformed the cell only representations.</p><p id="P45">Graph deep learning methods with explainability were adapted to focus on the ECM and cell-ECM interactions. GNN explainers have been applied to a range of biological datasets, such as the mutagenicity of molecules 35, drug-disease therapeutic mechanisms 36, EEG data of schizophrenia <sup><xref ref-type="bibr" rid="R37">37</xref></sup> and breast cancer cell graphs <sup><xref ref-type="bibr" rid="R38">38</xref></sup>. However, to the best of our knowledge, we are the first to apply it to the ECM. Our GNN explainer successfully identified ECM remodeling and rare cell-ECM interactions in the simulated dataset. In terms of the real murine lung dataset, alterations in monocyte/CD11b+immune cell ECM interactions were highlighted. The role of monocytes and CD11b<sup>+</sup> immune cells in DRA exposed mice has been previously documented <sup><xref ref-type="bibr" rid="R39">39</xref></sup>.</p><p id="P46">In summary, cell-ECM graphs represent a tool for the analysis of ECM and cell-ECM interactions in spatial proteomic datasets. It is the first graph design that incorporates both cells and the ECM into a single graph in high dimensional spatial proteomics. Alternative graph designs should be considered in future work, with modified node and edge features.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Combined supplementary</label><media xlink:href="EMS206212-supplement-Combined_supplementary.pdf" mimetype="application" mime-subtype="pdf" id="d44aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S19"><title>Acknowledgements</title><p>MG was supported by the Wellcome Trust Immunomatrix in Complex Disease PhD programme (WT ref. 218491/Z/19/Z).</p></ack><sec id="S20" sec-type="data-availability"><title>Code</title><p id="P47">The graphs were generated using Python, and the code for the Cell-ECM Graphs tool is publicly available at GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/moeghaf/CEGs">https://github.com/moeghaf/CEGs</ext-link>. The fully executed notebooks to generate the main and supplementary results have been provided.</p></sec><sec id="S21" sec-type="data-availability"><title>Data</title><p id="P48">The simulated datasets have been made publicly (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/15523468">https://zenodo.org/records/15523468</ext-link>), and the murine IMC dataset will be provided upon reasonable request.</p></sec><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frantz</surname><given-names>C</given-names></name><name><surname>Stewart</surname><given-names>KM</given-names></name><name><surname>Weaver</surname><given-names>VM</given-names></name></person-group><article-title>The extracellular matrix at a glance</article-title><source>J CellSci</source><year>2010</year><volume>123</volume><fpage>4195</fpage><lpage>4200</lpage><pub-id pub-id-type="pmcid">PMC2995612</pub-id><pub-id pub-id-type="pmid">21123617</pub-id><pub-id pub-id-type="doi">10.1242/jcs.023820</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lamandé</surname><given-names>SR</given-names></name><name><surname>Bateman</surname><given-names>JF</given-names></name></person-group><article-title>Genetic Disorders of the Extracellular Matrix</article-title><source>Anat Rec Hoboken Nj</source><year>2020</year><volume>303</volume><fpage>1527</fpage><lpage>1542</lpage><comment>2007</comment><pub-id pub-id-type="pmcid">PMC7318566</pub-id><pub-id pub-id-type="pmid">30768852</pub-id><pub-id pub-id-type="doi">10.1002/ar.24086</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="web"><source>The role of the extracellular matrix and specific growth factors in the regulation of inflammation and remodelling in asthma - ScienceDirect</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0163725809000023?casa_token=irz5kRf-B_wAAAAA:mOOqIVtFfqnByFYqninq1Izua8-LAXtzZPR7B3UaCPbLoV5YdzVEg87jOrHXSo8HJdIBoztRs1U">https://www.sciencedirect.com/science/article/pii/S0163725809000023?casa_token=irz5kRf-B_wAAAAA:mOOqIVtFfqnByFYqninq1Izua8-LAXtzZPR7B3UaCPbLoV5YdzVEg87jOrHXSo8HJdIBoztRs1U</ext-link></comment></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karakioulaki</surname><given-names>M</given-names></name><name><surname>Papakonstantinou</surname><given-names>E</given-names></name><name><surname>Stolz</surname><given-names>D</given-names></name></person-group><article-title>Extracellular matrix remodelling in COPD</article-title><source>Eur Respir Rev</source><year>2020</year><volume>29</volume><pub-id pub-id-type="pmcid">PMC9488912</pub-id><pub-id pub-id-type="pmid">33208482</pub-id><pub-id pub-id-type="doi">10.1183/16000617.0124-2019</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Götte</surname><given-names>M</given-names></name><name><surname>Kovalszky</surname><given-names>I</given-names></name></person-group><article-title>Extracellular matrix functions in lung cancer</article-title><source>Matrix Biol</source><year>2018</year><volume>73</volume><fpage>105</fpage><lpage>121</lpage><pub-id pub-id-type="pmid">29499357</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gunduz</surname><given-names>C</given-names></name><name><surname>Yener</surname><given-names>B</given-names></name><name><surname>Gultekin</surname><given-names>SH</given-names></name></person-group><article-title>The cell graphs of cancer</article-title><source>ISMB/ECCB (Supplement of Bioinformatics)</source><year>2004</year><fpage>145</fpage><lpage>151</lpage><pub-id pub-id-type="pmid">15262793</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demir</surname><given-names>C</given-names></name><name><surname>Gultekin</surname><given-names>SH</given-names></name><name><surname>Yener</surname><given-names>B</given-names></name></person-group><article-title>Augmented cell-graphs for automated cancer diagnosis</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>ii7</fpage><lpage>ii12</lpage><pub-id pub-id-type="pmid">16204128</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><source>Cell-graphs: image-driven modeling of structure-function relationship: Communications of the ACM</source><volume>60</volume><issue>1</issue><pub-id pub-id-type="doi">10.1145/2960404</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shao</surname><given-names>X</given-names></name><etal/></person-group><article-title>Knowledge-graph-based cell-cell communication inference for spatially resolved transcriptomic data with SpaTalk</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><elocation-id>4429</elocation-id><pub-id pub-id-type="pmcid">PMC9338929</pub-id><pub-id pub-id-type="pmid">35908020</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-32111-8</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilgin</surname><given-names>CC</given-names></name><name><surname>Bullough</surname><given-names>P</given-names></name><name><surname>Plopper</surname><given-names>GE</given-names></name><name><surname>Yener</surname><given-names>B</given-names></name></person-group><article-title>ECM-aware cell-graph mining for bone tissue modeling and classification</article-title><source>Data Min Knowl Discov</source><year>2010</year><volume>20</volume><fpage>416</fpage><lpage>438</lpage><pub-id pub-id-type="pmcid">PMC2883793</pub-id><pub-id pub-id-type="pmid">20543911</pub-id><pub-id pub-id-type="doi">10.1007/s10618-009-0153-2</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Studer</surname><given-names>L</given-names></name><name><surname>Wallau</surname><given-names>J</given-names></name><name><surname>Dawson</surname><given-names>H</given-names></name><name><surname>Zlobec</surname><given-names>I</given-names></name><name><surname>Fischer</surname><given-names>A</given-names></name></person-group><source>Classification of intestinal gland cell-graphs using graph neural networks</source><conf-name>2020 25th International conference on pattern recognition (ICPR)</conf-name><year>2021</year><fpage>3636</fpage><lpage>3643</lpage><conf-sponsor>IEEE</conf-sponsor></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bilgin</surname><given-names>C</given-names></name><name><surname>Demir</surname><given-names>C</given-names></name><name><surname>Nagi</surname><given-names>C</given-names></name><name><surname>Yener</surname><given-names>B</given-names></name></person-group><source>Cell-Graph Mining for Breast Tissue Modeling and Classification</source><conf-name>2007 29th Annual International Conference of the IEEE Engineering in Medicine and Biology Society</conf-name><year>2007</year><fpage>5311</fpage><lpage>5314</lpage><pub-id pub-id-type="doi">10.1109/IEMBS.2007.4353540</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Striegel</surname><given-names>DA</given-names></name><name><surname>Hara</surname><given-names>M</given-names></name><name><surname>Periwal</surname><given-names>V</given-names></name></person-group><article-title>The Beta Cell in Its Cluster: Stochastic Graphs of Beta Cell Connectivity in the Islets of Langerhans</article-title><source>PLOS Comput Biol</source><year>2015</year><volume>11</volume><elocation-id>e1004423</elocation-id><pub-id pub-id-type="pmcid">PMC4534467</pub-id><pub-id pub-id-type="pmid">26266953</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004423</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schapiro</surname><given-names>D</given-names></name><etal/></person-group><article-title>histoCAT: analysis of cell phenotypes and interactions in multiplex image cytometry data</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>873</fpage><lpage>876</lpage><pub-id pub-id-type="pmcid">PMC5617107</pub-id><pub-id pub-id-type="pmid">28783155</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4391</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corso</surname><given-names>G</given-names></name><name><surname>Stark</surname><given-names>H</given-names></name><name><surname>Jegelka</surname><given-names>S</given-names></name><name><surname>Jaakkola</surname><given-names>T</given-names></name><name><surname>Barzilay</surname><given-names>R</given-names></name></person-group><article-title>Graph neural networks</article-title><source>Nat Rev Methods Primer</source><year>2024</year><volume>4</volume><fpage>1</fpage><lpage>13</lpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jaume</surname><given-names>G</given-names></name><etal/></person-group><source>Quantifying explainers of graph neural networks in computational pathology</source><conf-name>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</conf-name><year>2021</year><fpage>8106</fpage><lpage>8116</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="web"><source>Combined sensitization of mice to extracts of dust mite, ragweed, and Aspergillus species breaks through tolerance and establishes chronic features of asthma - ScienceDirect</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0091674909002358?casa_token=z1CuV2pt6Q8AAAAA:v5nJVIKAX05O-xKpj5I1_iBQlEaelSAwh65TARMA9Vj0pHO1ESZfZPMg_dY8jJ11KB_KrrMo8io">https://www.sciencedirect.com/science/article/pii/S0091674909002358?casa_token=z1CuV2pt6Q8AAAAA:v5nJVIKAX05O-xKpj5I1_iBQlEaelSAwh65TARMA9Vj0pHO1ESZfZPMg_dY8jJ11KB_KrrMo8io</ext-link></comment></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parkinson</surname><given-names>JE</given-names></name><etal/></person-group><article-title>Extracellular matrix phenotyping by imaging mass cytometry defines distinct cellular matrix environments associated with allergic airway inflammation</article-title><source>bioRxiv</source><year>2024</year><fpage>2024</fpage><lpage>11</lpage></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Sandha</surname><given-names>SS</given-names></name><name><surname>Aggarwal</surname><given-names>M</given-names></name><name><surname>Fedorov</surname><given-names>I</given-names></name><name><surname>Srivastava</surname><given-names>M</given-names></name></person-group><source>Mango: A Python Library for Parallel Hyperparameter Tuning</source><conf-name>ICASSP 2020 -2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</conf-name><year>2020</year><fpage>3987</fpage><lpage>3991</lpage><pub-id pub-id-type="doi">10.1109/ICASSP40776.2020.9054609</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sundararajan</surname><given-names>M</given-names></name><name><surname>Taly</surname><given-names>A</given-names></name><name><surname>Yan</surname><given-names>Q</given-names></name></person-group><source>Axiomatic Attribution for Deep Networks</source><year>2017</year><comment>Preprint</comment><pub-id pub-id-type="doi">10.48550/arXiv.1703.01365</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kokhlikyan</surname><given-names>N</given-names></name><etal/></person-group><source>Captum: A unified and generic model interpretability library for PyTorch</source><year>2020</year><comment>Preprint</comment><pub-id pub-id-type="doi">10.48550/arXiv.2009.07896</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fey</surname><given-names>M</given-names></name><name><surname>Lenssen</surname><given-names>JE</given-names></name></person-group><source>Fast Graph Representation Learning with PyTorch Geometric</source><year>2019</year><comment>Preprint</comment><pub-id pub-id-type="doi">10.48550/arXiv.1903.02428</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goltsev</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Deep Profiling of Mouse Splenic Architecture with CODEX Multiplexed Imaging</article-title><source>Cell</source><year>2018</year><volume>174</volume><fpage>968</fpage><lpage>981</lpage><elocation-id>e15</elocation-id><pub-id pub-id-type="pmcid">PMC6086938</pub-id><pub-id pub-id-type="pmid">30078711</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.07.010</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schürch</surname><given-names>CM</given-names></name><etal/></person-group><article-title>Coordinated Cellular Neighborhoods Orchestrate Antitumoral Immunity at the Colorectal Cancer Invasive Front</article-title><source>Cell</source><year>2020</year><volume>182</volume><fpage>1341</fpage><lpage>1359</lpage><elocation-id>e19</elocation-id><pub-id pub-id-type="pmcid">PMC7479520</pub-id><pub-id pub-id-type="pmid">32763154</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.07.005</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patrick</surname><given-names>E</given-names></name><etal/></person-group><article-title>Spatial analysis for highly multiplexed imaging data to identify tissue microenvironments</article-title><source>Cytometry A</source><year>2023</year><volume>103</volume><fpage>593</fpage><lpage>599</lpage><pub-id pub-id-type="pmid">36879360</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>A</given-names></name><name><surname>Jordan</surname><given-names>M</given-names></name><name><surname>Weiss</surname><given-names>Y</given-names></name></person-group><chapter-title>On Spectral Clustering: Analysis and an algorithm</chapter-title><source>Advances in Neural Information Processing Systems</source><year>2001</year><volume>14</volume><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title><source>Sci Rep</source><year>2019</year><volume>9</volume><elocation-id>5233</elocation-id><pub-id pub-id-type="pmcid">PMC6435756</pub-id><pub-id pub-id-type="pmid">30914743</pub-id><pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bannon</surname><given-names>D</given-names></name><etal/></person-group><article-title>DeepCell Kiosk: scaling deep learning-enabled cellular image analysis with Kubernetes</article-title><source>Nat Methods</source><year>2021</year><volume>18</volume><fpage>43</fpage><lpage>45</lpage><pub-id pub-id-type="pmcid">PMC8759612</pub-id><pub-id pub-id-type="pmid">33398191</pub-id><pub-id pub-id-type="doi">10.1038/s41592-020-01023-0</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levine</surname><given-names>JH</given-names></name><etal/></person-group><article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title><source>Cell</source><year>2015</year><volume>162</volume><fpage>184</fpage><lpage>197</lpage><pub-id pub-id-type="pmcid">PMC4508757</pub-id><pub-id pub-id-type="pmid">26095251</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>HW</given-names></name><etal/></person-group><article-title>The single-cell pathology landscape of breast cancer</article-title><source>Nature</source><year>2020</year><volume>578</volume><fpage>615</fpage><lpage>620</lpage><pub-id pub-id-type="pmid">31959985</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goltsev</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Deep profiling of mouse splenic architecture with CODEX multiplexed imaging</article-title><source>Cell</source><year>2018</year><volume>174</volume><fpage>968</fpage><lpage>981</lpage></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elaldi</surname><given-names>R</given-names></name><etal/></person-group><article-title>High Dimensional Imaging Mass Cytometry Panel to Visualize the Tumor Immune Microenvironment Contexture</article-title><source>Front Immunol</source><year>2021</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC8085494</pub-id><pub-id pub-id-type="pmid">33936105</pub-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.666233</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramaglia</surname><given-names>V</given-names></name><etal/></person-group><article-title>Multiplexed imaging of immune cells in staged multiple sclerosis lesions by mass cytometry</article-title><source>eLife</source><year>2019</year><volume>8</volume><elocation-id>e48051</elocation-id><pub-id pub-id-type="pmcid">PMC6707785</pub-id><pub-id pub-id-type="pmid">31368890</pub-id><pub-id pub-id-type="doi">10.7554/eLife.48051</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>YJ</given-names></name><etal/></person-group><article-title>Multiplexed In Situ Imaging Mass Cytometry Analysis of the Human Endocrine Pancreas and Immune System in Type 1 Diabetes</article-title><source>Cell Metab</source><year>2019</year><volume>29</volume><fpage>769</fpage><lpage>783</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC6436557</pub-id><pub-id pub-id-type="pmid">30713110</pub-id><pub-id pub-id-type="doi">10.1016/j.cmet.2019.01.003</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ying</surname><given-names>Z</given-names></name><name><surname>Bourgeois</surname><given-names>D</given-names></name><name><surname>You</surname><given-names>J</given-names></name><name><surname>Zitnik</surname><given-names>M</given-names></name><name><surname>Leskovec</surname><given-names>J</given-names></name></person-group><chapter-title>GNNExplainer: Generating Explanations for Graph Neural Networks</chapter-title><source>Advances in Neural Information Processing Systems</source><year>2019</year><volume>32</volume><publisher-name>Curran Associates, Inc</publisher-name><pub-id pub-id-type="pmcid">PMC7138248</pub-id><pub-id pub-id-type="pmid">32265580</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><source>DDTExplainer: Mining Drug-Disease Therapeutic Mechanisms based on GNN Explainability</source><conf-name>2024 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</conf-name><year>2024</year><fpage>1350</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1109/BIBM62325.2024.10822060</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Zhdanov</surname><given-names>M</given-names></name><name><surname>Steinmann</surname><given-names>S</given-names></name><name><surname>Hoffmann</surname><given-names>N</given-names></name></person-group><source>Investigating Brain Connectivity with Graph Neural Networks and GNNExplainer</source><conf-name>2022 26th International Conference on Pattern Recognition (ICPR)</conf-name><year>2022</year><fpage>5155</fpage><lpage>5161</lpage><pub-id pub-id-type="doi">10.1109/ICPR56361.2022.9956201</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jaume</surname><given-names>G</given-names></name><etal/></person-group><source>Quantifying Explainers of Graph Neural Networks in Computational Pathology</source><conf-name>2021 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</conf-name><year>2021</year><fpage>8102</fpage><lpage>8112</lpage><conf-sponsor>Nashville, TN, USA</conf-sponsor><conf-loc>IEEE</conf-loc><pub-id pub-id-type="doi">10.1109/CVPR46437.2021.00801</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="web"><source>Plantinga: Conventional and monocyte-derived CD11b+... -Google Scholar</source><comment><ext-link ext-link-type="uri" xlink:href="https://scholar.google.com/scholar_lookup?doi=10.1016%2Fj.immuni.2012.10.016&amp;pmid=23352232">https://scholar.google.com/scholar_lookup?doi=10.1016%2Fj.immuni.2012.10.016&amp;pmid=23352232</ext-link></comment></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Cell-ECM graph Method.</title><p>All the markers are divided into cellular (bottom, blue) and extracellular markers (top, orange). The cellular markers are first used to segment (DeepCell) and annotate cells, which subsequently become cellular nodes. Cell-cell interaction edges based on the 5 closest cells and pruned based on <italic>D<sub>max</sub>(CC)</italic> creating a cell graph. The image only using the ECM markers (top, orange) is then split into Nx5x5 patches, where N is the number of ECM markers. Next, the mean is taken creating an average of ECM markers per patch and clustered into ECM clusters. After background removal, the remaining ECM patches become ECM nodes. ECM-ECM interaction edges are added if neighbouring. Next, cell-ECM interaction edges are added and pruned using <italic>D<sub>max</sub>(CE)</italic> to produce the final Cell-ECM graph (centre, green).</p></caption><graphic xlink:href="EMS206212-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Overview of cell-ECM graph.</title><p><bold>a)</bold> Cell graph illustration showing cells as nodes and cell-cell interactions as edges. <bold>b)</bold> Cell-ECM Graph illustration, with cells (circle) and ECM (triangle) as nodes and cell-cell, ECM-ECM and cell-ECM interactions as edges. <bold>c)</bold> Visualization of single ROI with DNA (blue), collagen-IV (green) and collagen-VI (red) markers <bold>d)</bold> Cell graph and <bold>e)</bold> Cell-ECM Graph built from the same ROI with same region enlarged.</p></caption><graphic xlink:href="EMS206212-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Visualization of Cell-ECM Graphs.</title><p><bold>a)</bold> Traditional cell graph representing cell-cell interactions as edges and cells depicted as nodes. <bold>b)</bold> ECM graph representing ECM-ECM interactions as edges, with ECM clusters as nodes and ECM molecule expression per ECM cluster. <bold>c)</bold> Both cells and ECM are nodes with cell-ECM interactions as edges<bold>. d)</bold> The full Cell-ECM graph with cells and ECM clusters as nodes and cell-cell, ECM-ECM and cell-ECM interactions as edges with a region enlarged.</p></caption><graphic xlink:href="EMS206212-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Simulated dataset.</title><p><bold>a)</bold> Generation of a simulated dataset with 3 different ECM markers, and cell types placement. Creation of cell-ECM graph from the simulated dataset. <bold>b)</bold> Simulated ECM remodelling, with ECM clusters 1 and 3 interaction in one scenario, and not in the other. <bold>c)</bold> Simulated cell-ECM interactions, with a rare cell type (cell E) being introduced those interactions with ECM 1, along with cell type A.</p></caption><graphic xlink:href="EMS206212-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Explainable AI overview.</title><p>A graph neural network is first trained to classify two groups of graphs with different interaction patterns. Subsequently a GNN explainer is used to highlight the important interactions used to distinguish the two groups.</p></caption><graphic xlink:href="EMS206212-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>GNN Explainer on simulated ECM-Graphs.</title><p>Visualization of GNN explainer results on simulated ECM graphs, highlighting the ECM remodelling: <bold>a)</bold> ECM 1 and 3 interactions present and <bold>b)</bold> absent.</p></caption><graphic xlink:href="EMS206212-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>GNN Explainer on simulated cell-ECM Graphs.</title><p>Visualization of GNN explainer results on simulated cell-ECM interactions, highlighting the ground truth modification of cell-ECM interactions, cell-E interacting with ECM cluster 1.</p></caption><graphic xlink:href="EMS206212-f007"/></fig><fig id="F8" position="float"><label>Figure 8</label><caption><title>GNN Explainer on real cell-ECM Graphs.</title><p>Visualization of GNN explainer results on real cell-ECM interactions in <bold>a) PBS</bold>, where alveolar fibroblasts interactions with ECM 2 were ranked important edges. Important cell-ECM interactions in <bold>DRA</bold> highlight <bold>b)</bold> CD11B immune cell interactions with ECM 3 and <bold>c)</bold> Monocyte interactions with ECM 1 as important interactions.</p></caption><graphic xlink:href="EMS206212-f008"/></fig><fig id="F9" position="float"><label>Figure 9</label><caption><title>Benchmarking Spatial Clustering.</title><p><bold>a)</bold> Simulated dataset with i) 4 spatial regions that differ in cell and ECM combinations. Region 1 and 4 consists of the same cell type on different ECM, region 2 has a specific cell type on a unique ECM, while region 3 contains the two cell types on the same ECM. Visualize of the ii) cell-graph and iii) ECM graph. <bold>b)</bold> Visualization and results of benchmarking spatial clustering.</p></caption><graphic xlink:href="EMS206212-f009"/></fig><fig id="F10" position="float"><label>Figure 10</label><caption><title>Five-fold cross validation of Node Classification.</title><p>Using all available ROIs in the real murine dataset, fivefold cross validation was performed to compare performance of cell and cell-ECM graphs and node classification with the optimized hyperparameters for each graph type.</p></caption><graphic xlink:href="EMS206212-f010"/></fig><fig id="F11" position="float"><label>Figure 11</label><caption><title>Node Classification through cell, ECM and cell-ECM neighbourhoods.</title><p><bold>a)</bold> Schematic showing how cell, ECM and cell-ECM neighbourhood features are calculated. <bold>b)</bold> Macro performance of each graph design and <bold>c)</bold> cell-specific performance.</p></caption><graphic xlink:href="EMS206212-f011"/></fig><fig id="F12" position="float"><label>Figure 12</label><caption><title>Interaction test on cell-ECM graphs.</title><p>Interaction test was performed on cell-ECM graphs which enable significant ECM-ECM and cell-ECM interactions to be found in PBS vs DRA.</p></caption><graphic xlink:href="EMS206212-f012"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Cellular and ECM markers</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Target Alias</th><th align="left" valign="top">Metal Ion</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Hyaluronic acid binding protein</bold></td><td align="left" valign="top">HABP</td><td align="left" valign="top"><sup>89</sup>Y</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>Chitinase-like protein 4</bold></td><td align="left" valign="top">Ym2</td><td align="left" valign="top"><sup>115</sup>In</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Actin smooth muscle actin</bold></td><td align="left" valign="top">aSMA</td><td align="left" valign="top"><sup>141</sup>Pr</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Collagen VI</bold></td><td align="left" valign="top">Col-VI</td><td align="left" valign="top"><sup>142</sup>Nd</td><td align="left" valign="top">ECM</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Heparan Sulfate</bold></td><td align="left" valign="top">HepSul</td><td align="left" valign="top"><sup>143</sup>Nd</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>Desmin</bold></td><td align="left" valign="top">Desmin</td><td align="left" valign="top"><sup>144</sup>Nd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Protein S100-A4</bold></td><td align="left" valign="top">s100a4</td><td align="left" valign="top"><sup>145</sup>Nd</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Surfactant Protein C</bold></td><td align="left" valign="top">SPC</td><td align="left" valign="top"><sup>146</sup>Nd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>B220-PE</bold></td><td align="left" valign="top">B220-PE</td><td align="left" valign="top"><sup>147</sup>Sm</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Pan-cytokeratin</bold></td><td align="left" valign="top">Pan-cyto</td><td align="left" valign="top"><sup>148</sup>Nd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>CD11b</bold></td><td align="left" valign="top">CD11b</td><td align="left" valign="top"><sup>149</sup>Sm</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>RELM alpha</bold></td><td align="left" valign="top">RELMa</td><td align="left" valign="top"><sup>151</sup>Eu</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Chitinase-like protein 3</bold></td><td align="left" valign="top">Ym1</td><td align="left" valign="top"><sup>152</sup>Sm</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Collagen IV</bold></td><td align="left" valign="top">Col-IV</td><td align="left" valign="top"><sup>153</sup>Eu</td><td align="left" valign="top">ECM</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Chondroitin Sulphate</bold></td><td align="left" valign="top">Chon-Sul</td><td align="left" valign="top"><sup>154</sup>Sm</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>SCGB1A1</bold></td><td align="left" valign="top">Scgb1a1</td><td align="left" valign="top"><sup>155</sup>Gd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Vimentin</bold></td><td align="left" valign="top">Vimentin</td><td align="left" valign="top"><sup>156</sup>Gd</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>E-cadherin</bold></td><td align="left" valign="top">E-Cad</td><td align="left" valign="top"><sup>158</sup>Gd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Fibrinogen</bold></td><td align="left" valign="top">Fibrinogen</td><td align="left" valign="top"><sup>159</sup>Tb</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>CD44</bold></td><td align="left" valign="top">CD44</td><td align="left" valign="top"><sup>160</sup>Gd</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Ly-6C</bold></td><td align="left" valign="top">Ly6C</td><td align="left" valign="top"><sup>162</sup>Dy</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Major Histocompatibility Complex class II</bold></td><td align="left" valign="top">MHCII</td><td align="left" valign="top"><sup>163</sup>Dy</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Von Willebrand Factor</bold></td><td align="left" valign="top">vWF</td><td align="left" valign="top"><sup>164</sup>Dy</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Collagen III</bold></td><td align="left" valign="top">Col-III</td><td align="left" valign="top"><sup>166</sup>Er</td><td align="left" valign="top">ECM</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Fibronectin</bold></td><td align="left" valign="top">Fibronectin</td><td align="left" valign="top"><sup>167</sup>Er</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>Laminin γ1</bold></td><td align="left" valign="top">lamgl</td><td align="left" valign="top"><sup>168</sup>Er</td><td align="left" valign="top">ECM</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Collagen I</bold></td><td align="left" valign="top">Col-I</td><td align="left" valign="top"><sup>169</sup>Tm</td><td align="left" valign="top">ECM</td></tr><tr><td align="left" valign="top"><bold>Podoplanin -FITC</bold></td><td align="left" valign="top">Podo-FITC</td><td align="left" valign="top"><sup>170</sup>Er</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Mucin 1</bold></td><td align="left" valign="top">Muc1</td><td align="left" valign="top"><sup>172</sup>Yb</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Tyrosine-protein kinase Mer</bold></td><td align="left" valign="top">MerTK</td><td align="left" valign="top"><sup>174</sup>Yb</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Platelet-derived growth factor receptor alpha</bold></td><td align="left" valign="top">PDGFRa</td><td align="left" valign="top"><sup>175</sup>Lu</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Lymphocyte antigen 6G</bold></td><td align="left" valign="top">Ly6G</td><td align="left" valign="top"><sup>176</sup>Lu</td><td align="left" valign="top">Cellular</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><bold>Intercalator - (DNA)</bold></td><td align="left" valign="top">DNA1</td><td align="left" valign="top"><sup>191</sup>Ir</td><td align="left" valign="top">Cellular</td></tr><tr><td align="left" valign="top"><bold>Intercalator - (DNA)</bold></td><td align="left" valign="top">DNA3</td><td align="left" valign="top"><sup>193</sup>Ir</td><td align="left" valign="top">Cellular</td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><title>Optimized hyperparameters of Cell-ECM Graphs</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Hyperparameter</th><th align="left" valign="top">Definition</th><th align="left" valign="top">Default</th></tr></thead><tbody><tr style="background-color:#F2F2F2"><td align="left" valign="top"><italic>D<sub>max</sub>(CC)</italic></td><td align="left" valign="top">Max cell-cell distance to be considered an interaction</td><td align="left" valign="top">17</td></tr><tr><td align="left" valign="top"><italic>D<sub>max</sub>(CE)</italic></td><td align="left" valign="top">Max cell-ECM distance to be considered an interaction</td><td align="left" valign="top">7</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top"><italic>P<sub>size</sub></italic></td><td align="left" valign="top">Patch size of ECM clusters</td><td align="left" valign="top">5</td></tr><tr><td align="left" valign="top">N<sub>edge</sub>(G)</td><td align="left" valign="top">Number of nearest neighbour interactions</td><td align="left" valign="top">24</td></tr><tr style="background-color:#F2F2F2"><td align="left" valign="top">K<sub>ECM</sub></td><td align="left" valign="top">Number of ECM clusters for patch clustering</td><td align="left" valign="top">4</td></tr></tbody></table></table-wrap><table-wrap id="T3" position="float" orientation="portrait"><label>Table 3</label><caption><title>Cell vs Cell-ECM Node Classification HP after optimization</title></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top">Optimized</th><th align="left" valign="top">D<sub>max</sub>CC</th><th align="left" valign="top">D<sub>max</sub>CE</th><th align="left" valign="top">N<sub>graph</sub></th><th align="left" valign="top">K<sub>classifier</sub></th><th align="left" valign="top">CEG F1</th><th align="left" valign="top">CG F1</th></tr></thead><tbody><tr style="background-color:#F2F2F2"><td align="left" valign="top">Cell graph</td><td align="left" valign="top">50</td><td align="left" valign="top">0</td><td align="left" valign="top">3</td><td align="left" valign="top">29</td><td align="left" valign="top">0.4649</td><td align="left" valign="top">0.4649</td></tr><tr><td align="left" valign="top">Cell-ECM graph</td><td align="left" valign="top">17</td><td align="left" valign="top">7</td><td align="left" valign="top">24</td><td align="left" valign="top">15</td><td align="left" valign="top"><bold>0.5253</bold></td><td align="left" valign="top">0.4547</td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><p id="P49"><list id="L1" list-type="bullet"><list-item><p id="P50">CG = Cell graph</p></list-item><list-item><p id="P51">CEG = Cell-ECM graph</p></list-item></list></p></fn></table-wrap-foot></table-wrap></floats-group></article>