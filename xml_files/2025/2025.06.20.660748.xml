<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS207016</article-id><article-id pub-id-type="doi">10.1101/2025.06.20.660748</article-id><article-id pub-id-type="archive">PPR1039530</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>The evolution of allostery in a protein family</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Martí-Aranda</surname><given-names>Aina</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lehner</surname><given-names>Ben</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05cy4wa09</institution-id><institution>Wellcome Sanger Institute</institution></institution-wrap>, <city>Cambridge</city>, <country country="GB">UK</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03wyzt892</institution-id><institution>Centre for Genomic Regulation (CRG)</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03kpps236</institution-id><institution>Barcelona Institute for Science and Technology (BIST)</institution></institution-wrap>, <city>Barcelona</city>, <country country="ES">Spain</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04n0g0b29</institution-id><institution>Universitat Pompeu Fabra (UPF)</institution></institution-wrap>, <city>Barcelona</city>, <country country="ES">Spain</country></aff><aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0371hy230</institution-id><institution>Institució Catalana de Recerca i Estudis Avançats (ICREA)</institution></institution-wrap>, <city>Barcelona</city>, <country country="ES">Spain</country></aff><author-notes><corresp id="CR1">
<label>*</label>correspondence: <email>bl11@sanger.ac.uk</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>11</day><month>07</month><year>2025</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>06</month><year>2025</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Allosteric interactions in proteins are key to biological regulation and the efficacy of many drugs. The extent to which allostery is conserved in evolutionarily-related proteins is unknown, with implications for predicting, engineering and therapeutically targeting allostery. Here we directly address this question by constructing seven comprehensive allosteric maps for five homologous human proteins. The comparative maps reveal a modular allosteric architecture with conserved distant-dependent allosteric decay across the protein core connecting to protein-specific allosteric extensions to surfaces. These allosteric augmentations use both structurally-conserved residues and homolog-specific domain extensions. Our data provide the first comparative multidimensional protein energy landscapes and suggest that allostery evolves via the gain-and-loss of peripheral extensions to a conserved allosteric core.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The transmission of information spatially from one site to another in a protein is termed allostery<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. Allostery is central to biological regulation, allowing protein activities to be controlled by covalent modifications, the binding of other molecules, and mutations outside of active sites. As a consequence, Monod infamously termed allostery ‘the second secret of life’<sup><xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R3">3</xref></sup>. Many disease-causing mutations, including cancer driver mutations, are pathogenic because of their allosteric effects. Reciprocally, many effective therapeutics target allosteric sites<sup><xref ref-type="bibr" rid="R4">4</xref></sup>. Allosteric drugs can have higher specificity than orthosteric drugs targeting highly-conserved active sites. Moreover they also allow activation of proteins and finer control, modulating the response to endogenous regulation rather than blocking catalytic centres<sup><xref ref-type="bibr" rid="R4">4</xref></sup></p><p id="P3">It is often stated that allosteric sites are less conserved than active sites<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup>. Whilst there is evidence that this is true at the sequence level<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup>, the structural conservation of allosteric sites is less clear<sup><xref ref-type="bibr" rid="R6">6</xref></sup>, and the functional conservation of allostery in proteins is, to our knowledge, largely unknown. The reason for this is simple: methods to comprehensively quantify allosteric communication in proteins have only recently been developed and no comprehensive allosteric maps have, to date, been produced for any homologous proteins. As such, we do not know the extent to which the same positions in evolutionarily-related proteins have allosteric effects when perturbed.</p><p id="P4">At one extreme it could be that allosteric coupling is highly conserved in proteins with the same fold. At the other extreme, allostery may be fast evolving, with each member of a protein family having different allosteric sites. An alternative possibility is that allostery is conserved in a subset of sites but fast evolving in others. Based on testing individual mutations, both conservation and divergence of allosteric effects has been reported<sup><xref ref-type="bibr" rid="R9">9</xref></sup>.</p><p id="P5">A second interesting question about allostery is how the addition of extra residues to a protein couples to the existing allosteric network. Domains are considered evolutionary modules of proteins that can fold and function independently. However, individual protein domains quite frequently have additional secondary structure elements<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref></sup> and each protein typically consists of multiple domains as well as more dynamic intrinsically disordered regions. In at least some cases, these extensions can have important allosteric effects<sup><xref ref-type="bibr" rid="R11">11</xref></sup>.</p><p id="P6">The extent to which allostery is conserved in evolutionarily-related proteins has important implications for predicting, engineering, and therapeutically targeting allosteric sites. For example, if the accessible allosteric sites differ among members of a protein family this should allow therapeutics binding these sites to specifically inhibit or activate one member of the family, even if they physically bind to multiple homologous proteins.</p><p id="P7">Here we directly test the conservation of allostery in homologous proteins by generating seven comprehensive allosteric maps for five homologous human protein domains. As a model protein family we use PDZ domains (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). The domain is named for three proteins—postsynaptic density protein (PSD-95), Drosophila discs large tumor suppressor (DlgA), and zonula occludens-1 protein (ZO-1)<sup><xref ref-type="bibr" rid="R12">12</xref></sup>. PDZ domains are the largest family of human protein-protein interaction domains<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and so provide an ideal model system for investigating energetic and allosteric conservation in homologous proteins. More than 270 PDZ domains in 155 different proteins participate in a wide range of cellular processes, including signal transduction, cell polarity, cell adhesion, and neuronal synaptic transmission, often functioning as scaffolds that mediate protein-protein assembly<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. Many of these domains are considered high-value therapeutic targets, but very few have been successfully targeted<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R15">15</xref></sup>. Despite low sequence identity, PDZ domains share a canonical fold composed of five to six β-strands and two or three α-helices. PDZ domains bind diverse, predominantly C-terminal peptide ligands, often classified into three classes by the identity of ligand positions, based on ligand residues at positions 0 and -2 (position 0 is the C-terminal residue; position -1 is the residue before)<sup><xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R17">17</xref></sup>. Ligand recognition occurs in a pocket composed of the β2 strand, the α2 helix and the carboxylate-binding β1-β2 loop<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup> (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p><p id="P8">The seven comprehensive energetic and allosteric maps reported here allow comparative analysis of homologous binding interfaces and reveal a modular evolutionary architecture of allostery, with a conserved allosteric core connected to protein-specific allosteric extensions. We propose a model whereby allostery evolves via the gain-and-loss of peripheral extensions to a conserved allosteric core.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Generating seven complete allosteric and energetic maps</title><p id="P9">To test the conservation of the energetic effects of mutations and allostery in homologous proteins we quantified changes in folding energy and binding energy for all mutations in five different human PDZ domains and a total of seven different protein interactions (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). The five human PDZ domains - PSD95-PDZ3, PSD95-PDZ2, NHERF3-PDZ1, NHERF3-PDZ2, and ERBIN-PDZ1 (<xref ref-type="fig" rid="F1">Fig. 1a</xref>) - have 29.6% mean sequence identity (range from 23.5% to 38.1%) and mean backbone RMSD of 2.61Å in pairwise structural alignments (range 1.85Å to 5.65Å). Our experimental design has a three tiered structure, quantifying the energetic effects of mutations on the same PDZ domain binding to different ligands (PSD95-PDZ2 binding peptides from CRIPT and NMDAR2A; NHERF3-PDZ1 binding peptides from UHMK1 and DAP-1), different PDZ domains binding to the same ligand (PSD95-PDZ3, PSD95-PDZ2, NHERF3-PDZ1, and ERBIN-PDZ1 binding CRIPT), and different PDZ domains binding different ligands. All ligands are class 1 ligands, except CEP164 which is a class 2 ligand<sup><xref ref-type="bibr" rid="R17">17</xref></sup> (see <xref ref-type="sec" rid="S16">methods</xref> for the design strategy). The data for six interactions were generated for this study, with the data for PSD95-PDZ3 previously reported in Faure et al. 2022<sup><xref ref-type="bibr" rid="R19">19</xref></sup>.</p><p id="P10">For each PDZ domain we generated two overlapping libraries containing both single and double amino acid (aa) substitutions using NNK (N=[A,G,T,C], K=[G,T]) codons to encode all 20 amino acids at each position in combination with a second NNK codon to encode all 20 aa at a second fixed site (<xref ref-type="fig" rid="F1">Fig. 1c</xref> and Methods). The effect of each aa substitution at each position is thus tested alone and in combination with 19 additional substitutions. As previously described, quantifying how mutations interact in double mutants allows us to infer the underlying additive causal free energy changes for each variant<sup><xref ref-type="bibr" rid="R19">19</xref>–<xref ref-type="bibr" rid="R23">23</xref></sup>.</p><p id="P11">To quantify the cellular abundance and peptide binding of each variant we used two extensively validated pooled protein-fragment complementation assays (PCA)<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>. In the first assay, AbundancePCA (aPCA), variants are expressed in yeast cells fused to a short fragment of the enzyme dihydrofolate reductase (DHFR), with the concentration of the fusion protein controlling the cellular growth rate<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>. In the second assay, BindingPCA (bPCA), the PDZ variants are fused to one fragment of DHFR and the peptide ligand is expressed fused to the remaining DHFR sequence such that the cellular growth rate is controlled by the concentration of the protein-peptide complex<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup> (<xref ref-type="fig" rid="F1">Fig. 1d</xref>). Mutational effects on protein abundance and binding are quantified using sequencing to quantify the change in frequency of each variant during selection (<xref ref-type="fig" rid="F1">Fig. 1e</xref>).</p><p id="P12">In total, the data analysed here derive from 22 different pooled selections with three replicate abundance measurements for a total of 172,200 amino acid (424,512 nucleotide) genotypes and triplicate binding measurements for 248,200 amino acid (619,072 nucleotide) genotypes. After selections and quality filtering (see <xref ref-type="sec" rid="S16">Methods</xref>) we obtained reliable abundance and binding measurements for a total of 153,562 and 241,200 protein variants, respectively (<xref ref-type="fig" rid="F1">Fig 1f</xref>, <xref ref-type="fig" rid="F7">Extended Data Fig. 1c</xref> and <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 4</xref>).</p><p id="P13">The measurements of abundance and binding were highly reproducible, with median Pearson correlation coefficient, <italic>r</italic> = 0.88 and 0.92 for abundance and binding, respectively (<xref ref-type="fig" rid="F1">Fig. 1f,g</xref>, and Extended Data <xref ref-type="fig" rid="F1">Fig. 1a</xref>), excellent block measurements overlap (Fig1c, and <xref ref-type="fig" rid="F7">Extended Data Fig. 1b</xref>), and excellent separation of synonymous and stop variants (<xref ref-type="fig" rid="F1">Fig. 1h</xref> and <xref ref-type="fig" rid="F7">Extended Data Fig. 1a</xref>).</p><p id="P14">Plotting binding against abundance shows, as expected<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup>, that many changes in binding are caused by reduced protein abundance. However, a large number of mutations in each protein have larger effects on binding than can be explained by changes in abundance, particularly for mutations in the binding interface (<xref ref-type="fig" rid="F7">Extended Data Fig. 1d</xref>). Quantifying the median change in abundance and binding for mutations at each position suggests conservation of mutational effects across the seven interactions (<xref ref-type="fig" rid="F1">Fig. 1j</xref>, <xref ref-type="fig" rid="F7">Extended Data Fig. 1c</xref>).</p></sec><sec id="S4"><title>From molecular phenotypes to free energy changes</title><p id="P15">We used MoCHI<sup><xref ref-type="bibr" rid="R20">20</xref></sup> to fit a three-state thermodynamic model to the data for each protein to infer the underlying causal changes in folding and binding energies for each mutation. The model accounts for the non-linear relationships between the Gibbs free energy of folding (ΔG<sub>f</sub>) and binding (ΔG<sub>b</sub>) and the observed molecular phenotypes, while assuming that the energetic effects of mutations (ΔΔG<sub>f</sub> and ΔΔG<sub>b</sub>) combine additively in double mutants. The additive energy models are highly predictive with a median <italic>r</italic> = 0.96 between observed and predicted fitness effects across all experiments, evaluated by ten-fold cross-validation (<xref ref-type="fig" rid="F1">Fig. 1l,o</xref>, <xref ref-type="fig" rid="F2">2a</xref>, <xref ref-type="fig" rid="F8">Extended Data Fig. 2a-c</xref>). The free energy measurements also agree with independent measurements made using different experiments<sup><xref ref-type="bibr" rid="R26">26</xref></sup> (<italic>r</italic> = 0.89 for n=171 ΔΔG<sub>b</sub> measurements for PSD95-PDZ2 binding NMDAR2A and <italic>r</italic> = 0.76 for n=168 ΔΔG<sub>b</sub> measurements for PSD95-PDZ3 binding CRIPT) (<xref ref-type="fig" rid="F2">Fig. 2b</xref>).</p><p id="P16">The final dataset quantifies 21,802 free energy changes - 9,064 changes in fold stability (ΔΔG<sub>f</sub>) for five PDZ domains and 12,738 changes in binding energy (ΔΔG<sub>b</sub>) across seven interactions (<xref ref-type="supplementary-material" rid="SD6">Supplementary Table 5</xref>). To our knowledge, this dataset represents the first large-scale measurement of free energy changes for the interactions of homologous proteins (<xref ref-type="fig" rid="F2">Fig. 2a</xref>).</p><p id="P17">Mapping the median change in free energy onto the molecular structures of the PDZ domains reveals, as expected, that mutations causing large changes in fold stability (ΔΔG<sub>f</sub>) are enriched in the buried protein cores whereas mutations in surface-exposed residues produce comparatively milder effects on folding (<xref ref-type="fig" rid="F2">Fig. 2c</xref>, <xref ref-type="fig" rid="F8">Extended Data Fig. 2d</xref>). Also as expected, mutations causing large changes in binding energy (ΔΔG<sub>b</sub>) are highly enriched in the binding interfaces (<xref ref-type="fig" rid="F2">Fig. 2c</xref>, <xref ref-type="fig" rid="F8">Extended Data Fig. 2e</xref>).</p></sec><sec id="S5"><title>Binding interface energy landscapes for seven interactions</title><p id="P18">The seven comprehensive mutational effect binding energy matrices provide a unique opportunity for a comparative analysis of the binding interfaces of homologous proteins. It has previously been reported that mutations in only a subset of the structural contacts in a protein interaction interface strongly affect the binding energy<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>. These sites are referred to as binding interface ‘hotspots’<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R29">29</xref></sup>.</p><p id="P19">The data for the seven PDZ domain interactions is consistent with the hotspot concept, with a bimodal distribution of ΔΔG<sub>b</sub> values for mutations in each interface (defined as those residues making direct contacts with the ligand, <xref ref-type="fig" rid="F3">Fig. 3a</xref>) and mutations in only a subset of these structural contacts strongly affect the binding energy (<xref ref-type="fig" rid="F3">Fig. 3b</xref>).</p><p id="P20">Defining hotspots as residues where mutations cause changes in binding energy larger than the median of all interface residues (0.75 kcal/mol) identifies a median of six hotspots per interface (false discovery rate (FDR, Benjamini-Hochberg method) &lt; 0.1, one-sided t-test). This is a median of 41.7% of interface residues (range 29.4% to 61.5% <xref ref-type="fig" rid="F3">Fig. 3b</xref>). The interface hotspots are, however, not identical in all interactions: only two residues are hotspots in all seven interactions (structural alignment positions 25 in the carboxylate binding loop, and 86 in the α2 helix), and an additional four are conserved in more than half of the interactions (positions 24 in the carboxylate binding loop, 26 and 28 in β2, and 82 in α2, <xref ref-type="fig" rid="F3">Fig. 3b,c,d</xref>).</p><p id="P21">Hotspots are enriched in contacts with ligand positions 0 or -2, the two aa positions used to define the three main classes of PDZ domain ligands (OR=13.71, <italic>P</italic>=2.61x10<sup>-7</sup>, one-sided Fisher’s Exact Test (FET) <xref ref-type="fig" rid="F3">Fig. 3e</xref>)<sup><xref ref-type="bibr" rid="R17">17</xref></sup>. Indeed all six conserved hotspots contact at least one of these two ligand positions in all interactions, except Y24 in NHERF3-PDZ2 binding CEP164. The conserved hotspot positions also have higher sequence and structural conservation (<xref ref-type="fig" rid="F3">Fig. 3f,g</xref>), and have highly conserved structural contacts, with five out of six positions contacting the ligand in all seven interactions (OR=60.54, <italic>P</italic>=5.3x10<sup>-04</sup>, one-sided FET).</p><p id="P22">The conserved hotspots are also buried deeper in the hydrophobic binding pocket (median rSASA = 0.14 vs. 0.33 for conserved and non-conserved hotspots, respectively, Wilcoxon rank-sum test <italic>P=</italic>5.8x10<sup>-03</sup>; median rSASA for non-hotspots=0.58, <italic>P</italic>=1.5x10<sup>-14</sup>, <xref ref-type="fig" rid="F3">Fig. 3h</xref>). The hotspot residues occupy central positions at the interface, surrounded by a shell of energetically less important contacts across all protein interfaces analyzed (<xref ref-type="fig" rid="F3">Fig. 3i</xref>, <xref ref-type="fig" rid="F9">Extended Data Fig. 3a</xref>). This pattern is consistent with the ‘O-ring’ model of binding interface architectures, where surrounding residues exclude bulk solvent from central hotspots, enhancing binding affinity<sup><xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. However, our data also show that residues in this outer ring can themselves evolve to become hotspots for certain interactions, for example positions 49 and 27 for PSD96-PDZ2, position 89 in NHERF3-PDZ2, and 36 and 38 in ERBIN-PDZ2 (<xref ref-type="fig" rid="F9">Extended Data Fig. 3a,b</xref>).</p></sec><sec id="S6"><title>Interface hotspot evolution</title><p id="P23">A total of 15 interface residues are never classified as hotspots, including eight (positions 23, 29, 32, 34, 41, 50, 83, and 90) that make contacts with a ligand in multiple PDZ domains (<xref ref-type="fig" rid="F3">Fig. 3b</xref>, <xref ref-type="fig" rid="F9">Extended Data Fig. 3a,c</xref>). These non-hotspot contacts are more solvent accessible (<xref ref-type="fig" rid="F3">Fig. 3h</xref>) and they are particularly enriched in the highly variable β2–β3 loop<sup><xref ref-type="bibr" rid="R31">31</xref></sup> (OR=6.23, <italic>P</italic>=0.04, one-sided FET, <xref ref-type="fig" rid="F3">Fig. 3b</xref> and <xref ref-type="fig" rid="F9">Extended Data Fig. 3a</xref>). However, residues in the β2-β3 loop can also function as hotspots. For example, positions G36 and P38 in the β2-β3 loop extension of ERBIN-PDZ1 add two additional protein-specific hotspots that recognise ligand position Y-5 (<xref ref-type="fig" rid="F9">Extended Data Fig. 3a</xref>). These new hostposts outside of the canonical binding site contribute to a novel binding specificity by engaging non-canonical ligand positions<sup><xref ref-type="bibr" rid="R31">31</xref></sup>. The redistribution of binding energy to these new hotspots is accompanied by reduced energetic effects of mutations in the conserved residues L24, F26, and I28, resulting in a highly diverged interface energy landscape.</p><p id="P24">The energy landscape of NHERF3-PDZ2 binding a class 2 ligand is also highly diverged, with large energetic effects for mutations at V89, which contacts the class II ligand-defining phenylalanine ligand side chain at position 0 (<xref ref-type="fig" rid="F3">Fig. 3b</xref> and <xref ref-type="fig" rid="F9">Extended Data Fig. 3a,b</xref>). The bulky F0 side chain requires small hydrophobic residues at V89 (such as V or I) (<xref ref-type="fig" rid="F9">Extended Data Fig. 3a,b</xref>). Once again, this new interaction is associated with reduced dependence on conserved hotspots L24, F26, and I28. Finally, two additional sites are only hotspots in PSD95-PDZ2: position S27 in the β2 strand and T49 in the β3 helix. These sites form non-canonical contacts with position -1 and -3, respectively.</p></sec><sec id="S7"><title>Seven comparative allosteric maps</title><p id="P25">We next focussed on changes in binding energy caused by mutations outside of the binding interfaces. These indirect effects on binding affinity are, by definition, allosteric<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>, allowing us to comprehensively compare allosteric communication in homologous proteins for the first time (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). In all five PDZ domains and for all seven interactions mutations outside of the binding interface can have strong effects on binding energy, (<xref ref-type="fig" rid="F4">Fig. 4b</xref>), often comparable in magnitude to mutations in the binding interfaces (<xref ref-type="fig" rid="F4">Fig. 4b,g</xref>).</p></sec><sec id="S8"><title>Conserved distant-dependent allosteric decay</title><p id="P26">We first considered how the effects of mutations on binding energy relate to their distance to the ligand. Plotting absolute ΔΔG<sub>b</sub> against. the Euclidean distance to the nearest ligand residue reveals a strikingly conserved relationship across all seven interactions: the probability of a mutation causing a change in binding energy decays with the distance from the binding interface, with a 50% reduction of allosteric effects over a median distance d<sub>1/2</sub> = 6.9 Å (<xref ref-type="fig" rid="F4">Fig. 4b,c</xref>).</p><p id="P27">This decay is similar to that quantified for allostery in the SRC kinase domain<sup><xref ref-type="bibr" rid="R23">23</xref></sup> (d<sub>1/2</sub> = 8.3 Å, <xref ref-type="fig" rid="F10">Extended Data Fig. 4a</xref>), KRAS for six interaction partners<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (median d<sub>1/2</sub> = 9.50Å, <xref ref-type="fig" rid="F10">Extended Data Fig. 4b</xref>), GB1<sup><xref ref-type="bibr" rid="R19">19</xref></sup> (d<sub>1/2</sub> = 5.6 Å), and GRB2-SH3 domain<sup><xref ref-type="bibr" rid="R19">19</xref></sup> (d<sub>1/2</sub> = 13.6 Å, <xref ref-type="fig" rid="F10">Extended Data Fig. 4c</xref>). This conserved distance-dependent decay of allosteric efficacy in nine different proteins suggests it is a general principle of allosteric communication (<xref ref-type="fig" rid="F4">Fig. 4c</xref>).</p></sec><sec id="S9"><title>Allostery beyond distance-dependent decay</title><p id="P28">We next quantified the allosteric effect of each mutation beyond that expected from its distance to the ligand. For each mutation we calculated the residual between its measured change in binding energy, ΔΔG<sub>b</sub>, and that expected given the fitted distance-dependent decay (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). These ΔΔG<sub>b</sub>-residuals quantify how much more allosteric each mutation is than expected given the Euclidean distance to the ligand.</p><p id="P29">The ΔΔG<sub>b</sub>-residuals for mutations outside of the binding interfaces are well correlated for the same PDZ domains binding to two different ligands (median Pearson’s <italic>r</italic> = 0.81) but are less conserved when comparing between two different PDZ domains (median <italic>r</italic> = 0.50, <xref ref-type="fig" rid="F10">Extended Data Fig. 4d</xref>). For each interaction, a median of 14.4% of mutations have effects larger than expected given the distance-dependent decay (one-sided Z-test for residual&gt;0, <italic>FDR</italic>&lt;0.1). Across pairwise comparisons, only a median of 7.3% of these unusually strong allosteric mutations identified in one interaction are also classified as unexpectedly allosteric in a second PDZ domain. However, the overlap for the same PDZ domain binding different ligands is larger, increasing to a median of 41.4% (<xref ref-type="fig" rid="F10">Extended Data Fig. 4e</xref>).</p></sec><sec id="S10"><title>Allosteric hotspots</title><p id="P30">We define allosteric hotspots as positions where mutations cause larger changes in ΔΔG<sub>b</sub> than expected at their distance from the ligand (<italic>FDR</italic>&lt;0.05, one-sided t-test; median |ΔΔG<sub>b</sub>| &gt; 0.2kcal/mol) (see <xref ref-type="sec" rid="S16">methods</xref>, <xref ref-type="fig" rid="F4">Fig. 4d,f</xref> and <xref ref-type="fig" rid="F10">Extended Data Fig. 4f</xref>). For each interaction, this defines a median of 19.6% of the positions outside the binding interface as allosteric hotspots (range 17.4% to 24.7%). Mutations in these allosteric hotspots cause changes in binding energy comparable in magnitude to mutations in the binding interface (<xref ref-type="fig" rid="F4">Fig. 4g</xref> and <xref ref-type="fig" rid="F10">Extended Data Fig. 4g</xref>).</p><p id="P31">Across the five proteins, 43 different positions are allosteric hotspots for at least one interaction while 78 positions are not hotspots for any interaction (<xref ref-type="fig" rid="F4">Fig. 4e</xref>). One position (A57 in α1 helix) is an allosteric hotspot in all seven PDZ domain interactions tested (<xref ref-type="fig" rid="F4">Fig. 4e,h</xref> &amp; <xref ref-type="fig" rid="F10">Extended Data Fig. 4f</xref>). Position A57 contacts the carboxylate-binding loop in all interactions and was previously reported as allosteric in PTP-BL-PDZ2 (A46) and PSD95-PDZ3 (A347)<sup><xref ref-type="bibr" rid="R32">32</xref></sup>. 16 residues are hotspots in three or more domains, nine are hotspots in two domains, and 18 are only hotspots in a single protein (<xref ref-type="fig" rid="F4">Fig. 4e</xref>). The hotspots are enriched in β-strands (OR=2.90, <italic>P</italic>=1.01x10<sup>-06</sup>, two-sided FET) and depleted in loops (OR=0.49, <italic>P</italic>=5.88x10<sup>-04</sup>, <xref ref-type="fig" rid="F4">Fig 4i</xref>). The allosteric hotspots for PSD95-PDZ3 strongly overlap with residues reported and predicted as allosteric in previous experimental and computational studies (<xref ref-type="fig" rid="F10">Extended Data Fig. 4h</xref>).</p></sec><sec id="S11"><title>A conserved allosteric core</title><p id="P32">The 43 allosteric hotspot residues are strongly enriched in the previously described ‘sector’ of co-evolving residues in PDZ domains<sup><xref ref-type="bibr" rid="R33">33</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup> (n=11, OR=26.13, <italic>P</italic>=2.96x10<sup>-05</sup>, one-sided FET considering all residues outside of the binding interface), and this enrichment is stronger for the 15 most conserved hotspots (OR=30.02, <italic>P</italic>=3.64x10<sup>-06</sup>). Similarly, the most conserved six binding interface hotspots are also enriched in the co-evolving sector (OR=17.16, <italic>P</italic>=9.6x10<sup>-03</sup>). The complete set of allosteric hotspots is also enriched in the protein core (rSASA&lt;0.25, OR=8.91, <italic>P</italic>&lt;2.2x10<sup>-16</sup>, one-sided FET, <xref ref-type="fig" rid="F4">Fig. 4i</xref>, <xref ref-type="fig" rid="F10">extended Data Fig.4i</xref>). Indeed 14 of the 16 most conserved allosteric hotspots are always classified as buried in the core in domains where they are classified as hotspots (OR=13.77, <italic>P</italic>&lt;2.2x10<sup>-16</sup>), with the only exceptions being surface residues at positions 73 and 61 (<xref ref-type="fig" rid="F4">Fig. 4h</xref>). The most conserved hotspots are also more likely to be core residues compared to hotspots only classified in one or two PDZ domains (OR=3.35, <italic>P</italic>=1.10x10<sup>-02</sup>, <xref ref-type="fig" rid="F5">Fig. 5a-g</xref>). The most functionally conserved allosteric hotspots are also more conserved in sequence and structure (<xref ref-type="fig" rid="F4">Fig. 4j,k</xref>).</p><p id="P33">The PDZ domains therefore contain a conserved allosteric core of co-evolving residues. However, each individual protein also contains additional allosteric residues. We turn to these in the next section.</p></sec><sec id="S12"><title>Allosteric innovation in a protein family</title><p id="P34">In addition to the functionally conserved hotspots, for each interaction there is a median of seven additional hotspots only present in one or two PDZ domains. Binding energy changes in these more protein-specific hotspots are well-correlated for the same PDZ domain binding to different ligands (Pearson’s <italic>r</italic> = 0.93 for PSD95-PDZ2 and <italic>r</italic> = 0.71 for NHERF3-PDZ1, <xref ref-type="fig" rid="F10">Extended Data Fig. 4j,k</xref>) but are less correlated when comparing different proteins binding the same ligand (median <italic>r</italic> = 0.45) or different proteins binding to different ligands (median <italic>r</italic> = 0.32, <xref ref-type="fig" rid="F10">Extended Data Fig. 4l</xref>). We next examined the structural location of these less conserved hotspots.</p><p id="P35">In NHERF3-PDZ1 the less conserved hotspots are spatially clustered in a region that contains an insertion of an extra α-helix (<xref ref-type="fig" rid="F5">Fig. 5a,b</xref>). Domain insertions containing additional secondary structure elements are quite frequent in PDZ<sup><xref ref-type="bibr" rid="R11">11</xref></sup> and other<sup><xref ref-type="bibr" rid="R10">10</xref></sup> domains and NHERF3-PDZ1 illustrates how these insertions can connect to the conserved allosteric network. Interestingly, this same region contains a spatial cluster of novel hotspots in ERBIN-PDZ1, despite this domain not containing an additional α-helix (<xref ref-type="fig" rid="F5">Fig. 5c</xref>). The domain does, however, contain multiple aa insertions in the β2-β3 loop in this region. The β2-β3 loop of ERBIN-PDZ1 contains two protein-specific hotspots and one hotspot shared with NHERF3-PDZ1.</p><p id="P36">The spatial cluster of novel allosteric hotspots in NHERF3-PDZ1 and ERBIN-PDZ1 link the binding interface to the opposite surface of the domain (<xref ref-type="fig" rid="F5">Fig. 5a,b</xref> and 6b). ERBIN-PDZ1 has the most distinct set of allosteric hotspots of any of the domains, with 10 novel hotspots shared with at most one other PDZ domain and only five hotspots shared with three or more domains (compared to a median of 10 for the other interactions). Thus, the loop extension in this domain appears to have expanded and partly replaced the typical allosteric network.</p><p id="P37">Not all domain extensions are, however, strongly coupled to the core allosteric network. NHERF3-PDZ2 contains a 21 aa C-terminal extension but mutations in only one residue (E119) have larger effects on binding than expected (<xref ref-type="fig" rid="F5">Fig. 5d</xref>), with a median ΔΔG<sub>b</sub> = -0.20 kcal/mol. (Note that this extension is likely disordered, see <xref ref-type="sec" rid="S16">methods</xref>, and may potentially dynamically directly contact the ligand rather than being allosteric, so we conservatively do not classify it as an allosteric hotspot.)</p><p id="P38">Other protein-specific hotspots in the PDZ domains are structurally conserved sites, so the mechanisms underlying their allosteric evolution are less clear. For example, in PSD95-PDZ3, a less conserved set of hotspots extends the conserved allosteric core to the protein surface opposite to the binding interface (surface residues R12, N73 and D76, <xref ref-type="fig" rid="F5">Fig. 5e</xref>, <xref ref-type="fig" rid="F6">Fig. 6b</xref>). In contrast, for both interactions of PSD95-PDZ2, most of the novel allosteric hotspots are buried in the protein core (G30, I69, A85, L89 and L98) with two novel hotspots on the surface (K18 and V95).</p></sec><sec id="S13"><title>Gain-of-function allosteric mutations</title><p id="P39">Across all five domains and seven interactions there is only one allosteric hotspot where mutations on average increase ligand binding (median ΔΔG<sub>b</sub>&lt;0): position V95 of PSD95-PDZ2 (<xref ref-type="fig" rid="F10">Extended Data Fig. 4f</xref>). V95 is solvent-exposed and located in the β5 strand and all mutations increase binding (ΔΔG<sub>b</sub>&lt;0, <italic>FDR</italic> &lt; 0.1, Z-test), with a median ΔΔG<sub>b</sub> of -0.45 kcal/mol for binding to CRIPT and -0.45 for binding to NMDAR2A (<xref ref-type="fig" rid="F5">Fig. 5f,g</xref>).</p><p id="P40">Interestingly, the V95 surface site in PSD95-PDZ2 does not directly contact any other hotspot residues for binding to CRIPT and contacts only one hotspot for binding to NMDAR2A (L16).</p><p id="P41">To further investigate the characteristics of GOF mutations we considered all mutations in all domains causing a decrease in binding energy (ΔΔG<sub>b</sub>&lt;0). The distance-dependent decay for these GOF mutations is weaker than for mutations that are detrimental for binding (median decay rate b=-0.054 and d<sub>1/2</sub>=11.89 Å for ΔΔG<sub>b</sub>&lt;0, and b=-0.096, d<sub>1/2</sub>=7.23 Å for ΔΔG<sub>b</sub>&gt;0) (<xref ref-type="fig" rid="F11">Extended Data Fig. 5a</xref>). Interestingly, GOF allosteric mutations in the Src protein kinase domain also show a much weaker distance-dependence than loss-of-function mutations<sup><xref ref-type="bibr" rid="R23">23</xref></sup>.</p><p id="P42">To further investigate the spatial location of GOF mutations we considered all mutations in all domains causing a strong decrease in binding energy (ΔΔG<sub>b</sub> &lt; -0.2 kcal/mol and FDR &lt; 0.1, one-sided Z-test for ΔΔG<sub>b</sub>&lt;0). Across domains, between one (PSD95-PDZ3) and 19 (PSD95-PDZ2 binding NMDAR2A) residues are enriched for these GOF mutations (FDR&lt;0.1, one-sided FET, <xref ref-type="fig" rid="F11">Extended Data Fig. 5b</xref>), including multiple surface and in loop residues (<xref ref-type="fig" rid="F11">Extended Data Fig. 5b,c</xref>), but their location is dispersed and varies across PDZ domains and interactions (<xref ref-type="fig" rid="F11">Extended Data Fig. 5c</xref>). GOF mutations in PSD95-PDZ2 do, however, show spatial clustering in the β4 strand, β4-α2 loop, and α2-β5 loop, regions that are close to the V95 GOF allosteric hotspot (<xref ref-type="fig" rid="F11">Extended Data Fig. 5</xref>).</p><p id="P43">The dynamic range of our selections provides less power to detect GOF variants than variants that decrease binding. However, their spatial architecture does seem different, as has previously been reported for Src<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, with the strong protein-specific GOF allosteric hotspot in PSD95-PDZ2 illustrating how surface-exposed sites can evolve to have strong positive effects on binding when perturbed.</p></sec><sec id="S14"><title>Evolution of allosteric surfaces</title><p id="P44">Finally we considered the accessible allosteric surfaces of the five homologous domains. Surface sites are particularly important for regulation and also provide accessible sites to be targeted by therapeutics<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R35">35</xref></sup>. We therefore more comprehensively compared the allosteric surfaces of the five PDZ domains (<xref ref-type="fig" rid="F6">Fig. 6</xref>). In all five PDZ domains there are at least two solvent-exposed allosteric hotspots, with between 4.3% and 9.1% of the surface residues defined as hotspots (median of 7.3%) and a total of 14 unique solvent accessible hotspots. Two surface positions are hotspots in a majority of domains: positions 61 and 73 in the structural alignment (<xref ref-type="fig" rid="F4">Fig. 4h</xref>). Position 61 is a hotspot for 4/7 interactions and is a glycine in all domains except ERBIN-PDZ1 where it is deleted. G61 is located in the α1-β4 loop, a median of 13.94 Å from the ligand and mutations in this residue cause a median ΔΔG<sub>b</sub>=0.70 kcal/mol (<xref ref-type="fig" rid="F6">Fig. 6a,b</xref>). Position 73 is a hotspot for 5/7 interactions and is located in the β4-α2 loop, at a median distance of 11.56 Å from the ligand (median ΔΔG<sub>b</sub> = 0.86 kcal/mol, <xref ref-type="fig" rid="F6">Fig. 6b,c</xref>). Changes in binding energy (ΔΔG<sub>b</sub>) for mutations in surface hotspot positions correlate strongly for the same domain binding to different ligands (median Pearson’s <italic>r</italic> = 0.87), but more weakly between different PDZ domains (median <italic>r</italic> = 0.23), further emphasising the protein-specificity of surface allostery.</p><p id="P45">Approximating PDZ domains as a cuboid, all three of the largest faces - the ‘left’, ‘right’ and ‘back’ surfaces with respect to the binding interface - contain allosteric hotspots in multiple domains (<xref ref-type="fig" rid="F6">Fig. 6</xref>). However, the allosteric surfaces differ quite extensively across the five domains, indicating again that the peripheral allostery is quite fast evolving.</p><p id="P46">Considering the ‘left’ surface, the allosteric map is quite similar for PSD95-PDZ2 and PSD95-PDZ3, with a small allosteric pocket containing I51, A57 and L63 (<xref ref-type="fig" rid="F6">Fig. 6a</xref>). However, PSD95-PDZ3 also contains an additional protein-specific hotspot, position R12. I51 is also an allosteric hotspot in NHERF3-PDZ2, but its context has changed (<xref ref-type="fig" rid="F6">Fig. 6a</xref>). For NHERF3-PDZ1 the left allosteric surface has extended ‘down’ in the direction towards more N-terminal ligand residues, and in ERBIN-PDZ1 allosteric residues are now concentrated in this lower region including a pocket created by the β2-β3 loop extension (<xref ref-type="fig" rid="F6">Fig. 6a</xref>).</p><p id="P47">The ‘back’ surface opposite the binding interface is less allosterically active in most of the domains. However, PSD95-PDZ3 contains a novel strong allosteric hotspot on this surface, residue R12, that forms a salt bridge with D67 (<xref ref-type="fig" rid="F6">Fig. 6b</xref>). Other allosteric hotspots visible on the back surface have much smaller solvent accessibility and/or small median mutational effects (<xref ref-type="fig" rid="F6">Fig. 6b</xref>).</p><p id="P48">Considering the ‘right’ surface (<xref ref-type="fig" rid="F6">Fig. 6c</xref>), position N73 is a highly conserved allosteric hotspot. This residue is located on the surface in all interactions. In addition, in three PDZ domains - PSD95-PDZ2, PSD95-PDZ3, and NHERF3-PDZ2 - the adjacent and less solvent-accessible residue, V72, is also allosteric. NHERF3-PDZ1 has evolved two additional allosteric patches lower down the right surface (residues F76, G45, Y115, and L128). Residue 76 in the lower right surface is also allosteric in PSD95-PDZ3. In contrast, PSD95-PDZ2 and NHERF3-PDZ2 have additional hotspots towards the top of the right surface, with V95 in PSD95-PDZ2 the only positive allosteric hotspot across all domains. Finally, ERBIN-PDZ1 contains no allosteric hotspots on the right surface with mutations across the entire surface having very limited effects on binding energy. Indeed in ERBIN-PDZ1 the β2-β3 loop extension appears to have shifted the allosteric network ‘down’ and ‘left’.</p><p id="P49">In summary, all five PDZ domains contain multiple allosteric surface sites but this surface allostery appears to be quite fast evolving. The shift of allostery ‘up’ and ‘down’ or ‘left’ and ‘right’ in the homologous domains means that each has a unique allosteric surface for cellular regulation and a unique allosteric surface to therapeutically target.</p></sec></sec><sec id="S15" sec-type="discussion"><title>Discussion</title><p id="P50">We have presented here the first comprehensive energetic and allosteric maps for homologous proteins. Using pooled selection and sequencing experiments we quantified 424,512 changes in abundance and 619,072 changes in binding for single and double mutant variants of five human PDZ domains interacting with seven different ligands, allowing us to infer the changes in free energy of folding and binding for all amino acid substitutions, a total of 21,802 free energy measurements. The resulting data provide a number of important insights into the evolution of allostery.</p><p id="P51">First, despite their small size, all five PDZ domains are allosteric and all five show a strong distance-dependent decay of allostery away from the binding interface. This distance-dependent decay is also observed in all four published experimental allosteric maps<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup> (<xref ref-type="fig" rid="F10">Extended Data Fig. 4a,b,c</xref>), for energetic couplings in molecular dynamics simulations<sup><xref ref-type="bibr" rid="R36">36</xref></sup>, for evolutionary conservation around enzyme active sites<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, and for chemical shift perturbations in NMR experiments<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. We believe therefore it is likely to be a general and conserved principle of protein biophysics.</p><p id="P52">Second, our data reveal a modular allosteric architecture of PDZ domains, with a conserved allosteric core connecting to protein-specific extensions to surface sites. This modular architecture is also highly consistent with evolutionary analyses, which have revealed a conserved co-evolving core (or ‘sector’) of PDZ and other domains<sup><xref ref-type="bibr" rid="R33">33</xref>,<xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R38">38</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup>, and experiments identifying allosteric surface sites connected to co-evolving sectors<sup><xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup>. Our data suggest that allostery primarily evolves via the gain-and-loss of peripheral extensions to a conserved allosteric core. It will be interesting in future work to test if this conservation of an allosteric core with faster evolution of the allosteric surface is also observed in other protein families.</p><p id="P53">Third, we believe the faster evolution of the allosteric surface has important implications for drug development. In each protein a median of 7.3% of solvent-exposed surface sites are allosterically active and so potentially targetable. However, the most allosteric surface sites change across the five proteins, suggesting that the best sites to engage therapeutically differ in different members of the protein family. If this principle of fast evolving allosteric surfaces extends to other protein families it should allow the development of both more allosteric drugs and more specific allosteric drugs that target one protein without inhibiting or activating other family members, even if they are bound. The faster structural evolution of surface sites compared to orthosteric sites<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup> provides another mechanism to increase specificity. It will be important in future work to test this hypothesis in other large protein families, including those of high therapeutic value such as protein kinases and G-protein coupled receptors (GPCRs).</p><p id="P54">Our dataset also provides - to our knowledge - the first complete comparative energy maps for homologous protein interaction interfaces. Most of the hotspot residues important for binding are conserved across the PDZ domains. However, additional hotspots have evolved, including by the insertion of amino acids into a loop. In future work it will be important to extend this comparative mapping of binding interface energy landscapes to additional protein families.</p><p id="P55">We believe comprehensive comparative energy landscapes such as those presented here are important for understanding both protein evolution and how to therapeutically target proteins from large families. Moreover, scaling the production of energy maps should produce well-calibrated datasets that will allow the full potential of machine learning to be brought to bear on biological discovery, drug development, and biotechnology.</p><p id="P56">Targeting allosteric sites has enormous potential for the development of therapeutics, allowing the development of inhibitors, activators and modulators of proteins previously considered ‘undruggable’ and also allowing the development of more specific and less toxic treatments<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R35">35</xref></sup>. Moreover, engineering allosteric control is important in biotechnology, facilitating the engineering of biosensors, control circuits and metabolic pathways<sup><xref ref-type="bibr" rid="R41">41</xref>–<xref ref-type="bibr" rid="R43">43</xref></sup>. The modular allosteric architecture that we have identified here for PDZ domains further reinforces this potential for targeting and engineering allostery across a protein family. In future work it will be important to explore the comparative allosteric architectures of additional protein families and functions, including those of high therapeutic and technological value such as receptors, enzymes, and transcription factors.</p></sec><sec id="S16" sec-type="methods"><title>Methods</title><sec id="S17"><title>Media</title><list list-type="bullet" id="L1"><list-item><p id="P57">LB: 10 g/L Bacto-tryptone, 5 g/L Yeast extract, 10 g/L NaCl. Filter sterilised</p></list-item><list-item><p id="P58">YPD: 20 g/L glucose, 20 g/L Peptone, 10 g/L Yeast extract.</p></list-item><list-item><p id="P59">YPDA: 20 g/L glucose, 20 g/L Peptone, 10 g/L Yeast extract, 40 mg/L adenine sulphate. Filter sterilised.</p></list-item><list-item><p id="P60">SORB: 100 mM LiOAc, 10 mM Tris pH 8.0, 1 mM EDTA, 1 M sorbitol</p></list-item><list-item><p id="P61">Plate mixture: 100 mM LiOAc, 10 mM Tris-HCl pH 8.0, 1 mM EDTA pH 8, 40% PEG3350. Filter sterilised.</p></list-item><list-item><p id="P62">Recovery medium: YPD + Sorbitol 0.5M. Filter sterilised.</p></list-item><list-item><p id="P63">SC -URA: 6.7 g/L Yeast Nitrogen base without amino acid, 20 g/L glucose, 0.77 g/L complete supplement mixture drop-out without uracil. Filter sterilised.</p></list-item><list-item><p id="P64">SC -URA/ADE: 6.7 g/L Yeast Nitrogen base without amino acid, 20 g/L glucose, 0.76 g/L complete supplement mixture drop-out without uracil, and adenine. Filter sterilised.</p></list-item><list-item><p id="P65">SC -URA/MET/ADE: 6.7 g/L Yeast Nitrogen base without amino acid, 20 g/L glucose, 0.74 g/L complete supplement mixture drop-out without uracil, adenine and methionine. Filter sterilised.</p></list-item><list-item><p id="P66">MTX competition medium: SC -URA/ADE + 200 ug/mL methotrexate (BioShop Canada Inc., Canada), 2% DMSO.</p></list-item><list-item><p id="P67">DNA extraction buffer: 2% Triton-X, 1% SDS, 100mM NaCl, 10mM Tris-HCl pH8, 1mM EDTA pH8.</p></list-item></list></sec><sec id="S18"><title>Wild-type PDZ domain testing</title><p id="P68">To design the libraries used, we first tested 20 PDZ wild-type sequences, 4 from Salinas and Ranganathan 2018<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, and 16 from Teyra et al. 2020<sup><xref ref-type="bibr" rid="R45">45</xref></sup>. PDZ domain boundaries were manually defined, taking into account those used in Teyra et al. 2020<sup><xref ref-type="bibr" rid="R45">45</xref></sup>, and available PDB structures, ensuring that secondary structure elements were not truncated or excluded.</p><p id="P69">These sequences were tested for signal in AbundancePCA<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. Of the 13 wild type PDZ domains that showed signal, we further tested 24 interactions in BindingPCA. These included: natural ligands, top-scoring natural proteins identified from optimal motif matches in Teyra et al. 2020<sup><xref ref-type="bibr" rid="R45">45</xref></sup>, and the CRIPT ligand tested across several of the assayed PDZ domains. Ligand sequences include the C-terminal 9 amino acids of the interaction proteins.</p><p id="P70">The domain and ligand wild type nucleotide sequences were obtained from a custom randomised back translation algorithm to increase codon complexity, which also avoided the restriction sites used in the cloning process: NheI, HindIII, SpeI and BamHI (see below). Gibson complementarity regions were fused to the extremes of the designed sequences. Common 5’ acatttccccgaaaagtggggaggtggagctagc and 3’ taaaagcttcgcaggaaagaacatgtgagcaaaa for PDZ domains. Common 5’ aaaagtgactagttta and 3’ ggatccgcaatgtaaa for ligand sequences. These added regions also introduced NheI, and HindIII for PDZ sequences, and SpeI and BamHI for ligand sequences (see below). Designed PDZ wild type sequences oligos were ordered through TWIST and ligand sequences through IDT as an oligo pool.</p><p id="P71">Three main plasmids were used to clone the wild type PDZ sequences; the two generic plasmids for AbundancePCA (pGJJ001) and BindingPCA (pGJJ045) as in<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, and a generic mutagenesis plasmid (pGJJ191), which contained a streptomycin resistance gene cassette.</p><p id="P72">Ligands designed for each interaction were inserted into the target BindingPCA plasmid by using a two-step cloning strategy. All single stranded ligand sequences, obtained in a pool, were amplified using oGJJ789 primer in one single PCR cycle. pGJJ191 empty backbone was linearised using oGJJ787 and oGJJ788 primers, which introduced SpeI and BamHI restriction sites (all the primers used are described in <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 1</xref>). The pool of ligand sequences was then inserted into the pGJJ191 vector by a Gibson (NEB) reaction at 50°C for 3h. Single transformants were individually checked by Sanger sequencing and correct ones were later cloned in separate reactions into the binding vector pGJJ001 by digestion ligation using the SpeI and BamHI restriction enzymes and T4 ligase (NEB). Digested ligand sequences were gel purified using minElute gel extraction kit (QIAGEN). Empty digested vector pGJJ001 was verified through gel electrophoresis and purified using QIAquick PCR purification kit (QIAGEN). This reaction cloned the ligand N-terminally fused to DHFR3.</p><p id="P73">The wild-type sequences of the several PDZs were amplified using a common reverse PCR primer oGJJ718, and assembled by Gibson (NEB) reaction at 50°C for 3h into the pGJJ191 vector previously linearised using oGJJ728 and oGJJ734 primers, which introduced NheI and HindIII restriction sites. Later, PDZ wild type sequences from pGJJ191, the empty pGJJ045 abundance and the already-containing ligand pGJJ001 binding vector were digested using NheI and HindIII restriction enzymes. Digested PDZ sequences were gel purified using minElute gel extraction kit (QIAGEN). Empty digested vectors (pGJJ045 and pGJJ001) were verified through gel electrophoresis and purified using QIAquick PCR purification kit (QIAGEN). Final digested wild-type PDZ sequences were assembled into the empty pGJJ045 abundance and the already-containing ligand pGJJ001 binding vector using T4 ligase (NEB). This reaction cloned the ligand N-terminally fused to DHFR1,2.</p><p id="P74">At each step, gibson products were dialyzed, concentrated to 5μL using a SpeedVac machine, and transformed into NEB 10β competent <italic>E. coli</italic> cells according to the manufacturer’s protocol. Cells were recovered in SOC (NEB 10β Stable Outgrowth Medium) for 30 minutes and plated for later DNA extractions from single colonies. Correct plasmid construction was verified at each step using Sanger sequencing (GATC, Eurofins Genomics) from mini prep products.</p><p id="P75">Cloned plasmids were then individually transformed into yeast using a small scale yeast transformation standard protocol as in Faure et al. 2022<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. After 48 hours, transformed cells were subject to selection in the presence of methotrexate (see below). By measuring the optical densities at 600nm (OD600) every 15 minutes for a minimum of 60 hours, we calculate the growth curve under selection for each transformation. Half-growth times were calculated as the time required for the culture to reach half of its maximum OD600. Domains with mean half-growth time lower than 40 hours in both AbundancePCA and their interactions in BindingPCA were considered for further experimental mutagenesis.</p></sec><sec id="S19"><title>Library designs</title><p id="P76">From the tested wild types, we finally designed mutagenesis libraries on 4 different PDZ domains (PSD95-PDZ2, NHERF3-PDZ2, NHERF3-PDZ1 and ERBIN-PDZ1) that were proven to grow in abundance and binding assays against several interaction partners. This set of libraries included also the following PDZ interactions: PSD95-PDZ2 binding CRIPT (Uniprot IDs: P78352 and Q9P021, respectively), PSD95-PDZ2 binding NMDAR2A (P78352 and Q12879, alternative name NR2A), NHERF3-PDZ2 binding CEP164 (Q5T2W1 and Q9UPV0), NHERF3-PDZ1 binding DAP-1 (Q5T2W1 and O14490), NHERF3-PDZ1 binding UHMK1 (Q5T2W1 and Q8TAS1), and ERBIN-PDZ1 binding CRIPT (Q96RT1 and Q9P021) (<xref ref-type="supplementary-material" rid="SD3">Supplementary Table 2</xref>). We did this in addition to the already existing data for PSD95-PDZ3 binding CRIPT (P78352 and Q9P021) from Faure et al. 2022<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. This makes a final dataset of 5 PDZs assayed in AbundancePCA and a total of 7 interactions tested in BindingPCA.</p><p id="P77">Those libraries were splitted into two blocks, for the 1st and 2nd halves of the PDZ sequences respectively (<xref ref-type="fig" rid="F1">Fig. 1C</xref>). The two blocks mutagenise overlapping parts of the sequences for further normalization of results (see below). The overlapping region between blocks included 5 amino acids in each case. Each library consisted of an oligo pool ordered through IDT where each codon was mutagenised to the degenerate NNK codon, to include all possible mutations in each position, and together with 32 genetic backgrounds, also codified as an additional fixed NNK position. Final oligos were a maximum length of 220 nucleotides.</p></sec><sec id="S20"><title>Plasmid library construction</title><p id="P78">This first step consisted of introducing the mutagenised oligos for each library block (ordered as oligo pools through Integrated DNA Technologies, IDT) into the mutagenesis plasmid already containing the wild-type version of the protein. This step is needed to build the mutagenesis library on each half of the protein sequence, whilst maintaining the other half untouched. Block2 libraries were amplified using the common oGJJ718 primer. Each of the block1 libraries was amplified using a distinct PCR primer, specific for each PDZ constant region, as shown in <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 1</xref>. Library amplification was performed in 10 cycles for block1 libraries, and 1 PCR cycle for block2 libraries. Amplified products were purified using MinElute PCR purification kit. Plasmid mutagenesis backbones (PDZ wild-type containing pGJJ191) were also linearised using different sets of primers for each library’s constant regions, as shown in <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 1</xref>. Primers annealing to constant regions outside of the PDZ sequences were common for each block of libraries; common reverse primer oGJJ891 for the block1 libraries, and common forward primer pGJJ720 for the block2 libraries. In separate reactions, each library was inserted by Gibson (NEB) reaction at 50°C for 3h into the PCR linearised pGJJ191 containing the other half of the wild type PDZ sequence. Gibson reactions were performed using in-house made master mix and a 1:5 vector-to-library ratio was used. Gibson products were dialyzed, concentrated to 10μL using a SpeedVac machine, and transformed into NEB 10β High-efficiency Electrocompetent <italic>E. coli</italic> cells according to the manufacturer’s protocol. Cells were recovered in SOC medium (NEB 10β Stable Outgrowth Medium) for 30 minutes. From the recovered product, 1μL of transformed cells were plated into LB spectinomycin plates to estimate the number of transformants. A minimum 20x coverage was aimed at each transformation, as shown in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref>. The remaining volume was transferred to 200mL of LB with spectinomycin to grow overnight. 50mL of grown culture was collected the next morning for DNA extraction using the QIAfilter Plasmid Midi Kit (QIAGEN).</p><p id="P79">Second step of this cloning strategy consisted of introducing the whole protein sequences (with half of their sequence mutagenised) into the AbundancePCA (pGJJ045) and BindingPCA plasmids (pGJJ001 already containing the corresponding ligand). Extracted library-containing plasmids were digested at NheI and HindIII restriction sites. Digested libraries were gel purified using Minelute gel extraction kit (QIAGEN), and digested plasmids were verified through gel electrophoresis and purified using QIAquick PCR purification kit (QIAGEN). Purified products were assembled using an overnight temperature-cycling ligation reaction with T4 ligase (NEB). As in the previous step, products were transformed into NEB 10β High-efficiency Electrocompetent <italic>E. coli</italic> cells according to the manufacturer’s protocol. A minimum 20x coverage was aimed at each transformation (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref>). Cells were recovered in SOC medium (NEB 10β Stable Outgrowth Medium) for 30 minutes. From the recovered product, 1μL of transformed cells were plated to estimate the number of transformants, and the remaining volume was transferred to 200mL of LB with ampicillin to grow overnight. 50mL of grown culture was collected the next morning for DNA extraction using the QIAfilter Plasmid Midi Kit (QIAGEN). Cloned libraries at each step were verified using oxford nanopore sequencing (Plasmidsaurus and Source Biosciences).</p></sec><sec id="S21"><title>Library pooling</title><p id="P80">Library selections, including AbundancePCA and BindingPCA libraries, were pooled based on the time needed to reach half OD600. Libraries with similar growth times were combined into the same competition assay to ensure proper selection at the output harvesting time. Since each PDZ was present in more than one library (e.g. in at least two assays), library groups were arranged to ensure that no PDZ sequence was repeated within the same pooling group, as shown in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref>. This arrangement ensured proper separation of libraries in later sequencing steps.</p></sec><sec id="S22"><title>Large-scale transformations of libraries into yeast</title><p id="P81">Each pool of libraries was transformed in triplicate using a high-efficiency yeast transformation protocol as described in<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. The protocol described below (adjusted to a pre-culture of 1L of YPDA) was scaled up or down in volume depending on the targeted number of transformants of each library pool, as reported in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref>.</p><p id="P82">For each selection assay, three independent pre-cultures of BY4742 (Saccharomyces cerevisiae, MATα his3Δ1 leu2Δ0 lys2Δ0 ura3Δ0) were grown in 100 ml standard YPDA at 30°C overnight. The next morning, three replicates of 1L of YPDA were inoculated at optical density at OD600 of 0.3. After incubation at 30°C for 4h, the cells were collected and centrifuged for 5 min at 3,000g, washed with sterile water, and later with SORB medium, the cells were resuspended in 43ml of SORB and incubated 30 minutes at room temperature on a rotating wheel. Later, 875μL of 10 mg/mL boiled salmon sperm DNA (Agilent Genomics) was added to each tube of cells, along with 17.5 μg of equimolarly pooled plasmid libraries, pooling volumes adjusted based on both library complexity and DNA concentration. Then, 175 mL of plate mixture were added and incubated at room temperature for 30 minutes on a rotating wheel. After incubation, 17.5mL of DMSO were added and each sample was splitted into 5 equal 50mL falcon tubes. After gently mixing, samples were heat shocked at 42 °C for 20 min while gently inverting the tubes regularly. Later, cells were pooled again into the previous 1L rotor tubes to centrifuge for 5 minutes at 3000rpm. Supernatant was carefully removed, cells were resuspended in 250mL of recovery media and incubated at 30 °C for 1h. Once recovered, cells were again centrifuged 5 minutes at 4000rpm, and resuspended in 1L of plasmid selection media SC-URA. From this sample, 10μL were plated on SC-URA petri dishes and incubated for ~48 h at 30°C to measure the transformation efficiency, aiming at 20X for each transformation (See <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref> for variant coverages).</p><p id="P83">The transformed pool of cells was grown for at least 24 hours before initiating the second round of plasmid selection. Input cultures were established by inoculating fresh SC–URA/MET/ADE medium at an OD600 of 0.2 from the saturated culture and incubated at 30 °C overnight. After input plasmid selection, the competition cycle started by inoculating 1L SC-URA/MET/ADE + 200 μg/ml methotrexate at an OD600 of 0.05 from the input culture. The volume equivalent to 1L at an OD600 of 1.6 from the input cultures were splitted in two equal tubes and centrifuged for 10 min at 5,000g at 4°C. Collected cells were washed twice, pelleted and stored at -20°C for later DNA extraction.</p><p id="P84">Competition cell cultures were incubated at 30 °C until reaching an OD600 of 1.6 (output), thus ~5 generations since inoculation (see <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 3</xref> for OD600 values, and timings of each experiment). After incubation, output cell cultures were splitted in two equal tubes and centrifuged for 10 min at 5,000g at 4°C. Collected cells were washed twice, pelleted and stored at -20°C for later DNA extraction.</p></sec><sec id="S23"><title>DNA extraction, plasmid quantification and library preparation</title><p id="P85">DNA was extracted from pelleted yeast input and output stored cells using a big scale yeast DNA extraction protocol as described in<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, scaled proportionally to the volume of harvested cells from the competition cultures. Since the final DNA samples contain both yeast genomic DNA and the target plasmids carrying the mutagenised libraries, plasmid concentrations were quantified in triplicate by qPCR. Quantification was performed using primers oGJJ152 and oGJJ153, which amplify a region within the origin of replication of the standard doubledeepPCA plasmids used in this study.</p><p id="P86">To prepare the libraries for illumina sequencing, we performed two PCR amplification cycles. In the first PCR (PCR1) we amplify the mutant library from the extracted samples while adding the illumina adapters. Primers for this were designed to add increased nucleotide complexity to the products by introducing frame-shift bases. PCRs for each library and block were performed independently with different sets of primers for each library’s constant regions, as shown in <xref ref-type="supplementary-material" rid="SD2">Supplementary Table 1</xref>. Primers annealing to constant regions outside of the PDZ sequences were common for each block of libraries; common reverse primer oGJJ052-58 for the block1 libraries, and common forward primer oGJJ084-89 for the block2 libraries.</p><p id="P87">In order to avoid PCR biases, each reaction was started with a minimum amount of 20X more initial template plasmid molecules than the number of illumina reads aimed per sample. These calculations accounted for the fact that multiple selection conditions were pooled within each sample. For each PCR reaction, the amount of input plasmid was estimated based solely on the representation of the specific library being amplified. For example, if a sample contained four pooled libraries assumed to be equally represented, a 4x plasmid input was used to ensure 1x coverage of the target library. Up to 50-60e6 target plasmid molecules were used per 50μL reaction of PCR1, so the number of PCR1 tube reactions was scaled according to the complexity of each library. For each sample, 15 PCR1 cycles were performed using Q5 Hot Start High-Fidelity DNA Polymerase (NEB). Excess of primers were cleaned by using 2μL of ExoSap per 50μL reaction and incubating 30 min at 37ºC and 20 min at 80ºC for heat inactivation. The multiple PCR1 product tubes of each sample were pooled and purified using a MinElute PCR purification kit (QIAGEN).</p><p id="P88">PCR1 product was then run through a second round of PCR (PCR2) to add the remainder of the Illumina adapter and demultiplexing indexes. Each 50 μL PCR2 reaction included 1.25 μL of PCR1 product. A total of half the number of PCR1 reactions was used in PCR2. PCR2 was run for 10 cycles at 62ºC of annealing temperature using common P5 and P7 Illumina adapters with different barcode indexes. PCR products were run on a 2% agarose gel and purified using the QIAEX II Gel Extraction Kit. The final purified product was subjected to illumina paired end 2x150 sequencing. For all downstream sequencing analyses, we targeted a minimum median coverage of 100 reads per variant</p><p id="P89">Alongside the preparation of all mutagenised libraries, the same protocol was applied to the original wild-type plasmids. These were sequenced in parallel to enable later correction of variant counts based on wild-type sequencing data.</p></sec><sec id="S24"><title>Sequencing data processing</title><p id="P90">FastQ files from all libraries and all blocks were processed using DiMSum pipeline<sup><xref ref-type="bibr" rid="R46">46</xref></sup>. FASTQ files corresponding to the same sample but originating from different sequencing runs or lanes were treated as technical replicates. Two rounds of DiMSum runs were performed. In the first round, all input and output samples were analyzed together with wild-type sequencing data using default DiMSum parameters.</p><p id="P91">Following this initial run, variant counts were corrected based on the wild-type sequencing. Variants observed in the wild-type plasmid, primarily single-nucleotide substitutions, are assumed to arise from sequencing or PCR errors. Their calculated proportions with respect to the wild type were removed from the datasets, under the assumption that they result from sequencing errors of the abundant wild-type background.</p><p id="P92">Once the new variant count files were calculated, the next dimsum run was performed. Restarting at stage 4, the modified variant count files were given as input. Together with this, barcode-variant identity files were also provided to restrict the analysis to designed variants only (option “barcodeIdentityPath”). In the cases where the nucleotide wild-type variant was not present, the most abundant synonymous variant was selected as the new wild type. Additional input count filters (“fitnessMinInputCountAny”) were manually adjusted for each library based on the first DiMSum run’s report of variant count distributions, aiming to minimise the proportion of reads per variant attributed to sequencing errors of lower order mutants. Filtering thresholds were informed by the input count distribution plots (Stage 4.1) and expected read counts of variants arising from sequencing errors, included in the DiMSum report<sup><xref ref-type="bibr" rid="R46">46</xref></sup>.</p></sec><sec id="S25"><title>Normalization of fitness scores across experiments</title><p id="P93">Normalised and processed fitness scores were only used for visualization purposes in <xref ref-type="fig" rid="F1">Fig. 1</xref> and <xref ref-type="fig" rid="F7">Extended Data Fig. 1</xref>. To ensure comparable fitness value ranges, those were first normalised between blocks of the same protein library, and further normalised across different assays.</p><p id="P94">Normalization was performed by using stop codon variants, which represent the lowest expected fitness values, and synonymous variants, expected to have fitness around 0, as lower and upper bounds, respectively. For each protein, we calculated the median fitness of all stop codon variants in the overlapping region between blocks (regardless of background mutations), along with the median of all synonymous variants. If synonymous variants were not present, the upper bound was set to zero. A linear regression model was then used to scale the fitness values of each block relative to block 1, which was taken as the reference. After normalizing within blocks, a second linear regression model was applied to scale fitness effect values across all assays. The PSD95-PDZ2 binding NMDAR2A assay was used as the reference. This model was based on the median fitness values of all stop codon variants and all synonymous variants from both blocks.</p></sec><sec id="S26"><title>Free energy inference with MoCHI</title><p id="P95">We used MoCHI v0.9<sup><xref ref-type="bibr" rid="R20">20</xref></sup> to fit global mechanistic models to the complete dataset, including 22 doubledeepPCA assay datasets accross multiple PDZ domain homologs and their respective binding partners.</p><p id="P96">We fitted five models, one per PDZ domain. Each model was fitted by simultaneously incorporating selection data from both AbundancePCA and BindingPCA assays and both mutagenised blocks. For domains with a single binding partner, four datasets were included in the fit, two AbundancePCA blocks and two BindingPCA blocks. For domains with two binding partners, six datasets were fitted simultaneously, consisting of two abundancePCA blocks and two bindingPCA blocks for each interaction. This model assumes that folding free energy changes are independent of the bound ligand, allowing folding energies to be shared across interactions. Consequently, for PDZ domains with multiple binding partners (PSD95-PDZ2 and NHERF3-PDZ1), a single folding energy model was fitted simultaneously with separate binding datasets for each interaction.</p><p id="P97">In this model, the protein is assumed to exist in three distinct states: unfolded and unbound, folded and unbound, and folded and bound. The probability of the unfolded and bound state is considered negligible. This model fits single mutation Gibbs free energy of folding (ΔG<sub>f</sub>) and binding (ΔG<sub>b</sub>) effects, and works under the assumption that the changes in free energy of variants (ΔΔG<sub>f</sub> and ΔΔG<sub>b</sub>) are additive. This means that the effect of mutations from a multi-mutant are simply the sum of effects of the single mutations.</p><p id="P98">The mochi parameters used were set to default as explained in previous work<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup>. Each model architecture consisted of one additive layer representing folding energy, and one additive layer per binding assay. Accordingly, models for PSD95-PDZ3, NHERF3-PDZ2, and ERBIN-PDZ1 included two additive layers (one for folding and one for binding), while models for PSD95-PDZ2 and NHERF3-PDZ1, which have two binding partners, included three additive layers. The non-linear transformations used, “TwoStateFractionFolded” (for AbundancePCA data) and “ThreeStateFractionFolded” (for BindingPCA data), were derived from the Boltzmann distribution, relating fraction of protein folded/bound to the underlying free energy changes.</p><p id="P99">The input to the models consisted of raw fitness scores from both single and double mutants, calculated prior to any normalization. Each dataset was manually adjusted so that variant entries contained the full-length amino acid sequence of the corresponding PDZ domain, rather than just the mutated region of the block.</p></sec><sec id="S27"><title>Protein structures, structure metrics, and contacts</title><p id="P100">The PDZ domain structures, alone and in complex with the ligands, were all obtained from AlphaFold3 predictions<sup><xref ref-type="bibr" rid="R44">44</xref></sup>. Given the low plDDT score of the predicted C-terminal tail extension from NHERF3-PDZ2 (70 &gt; plDDT &gt; 50), for visualization purposes it was manually adjusted to remove the secondary structure annotation, reflecting as well prior evidence of its intrinsic disorder and dynamic nature in NMR PDB entry for the solution structure of Second PDZ domain of PDZ Domain Containing Protein 1 (PDB ID: 2EEI; Niraula et al., 2008, unpublished)<sup><xref ref-type="bibr" rid="R47">47</xref></sup>.</p><p id="P101">Relative solvent accessible surface area was calculated for each unbound structure using freeSASA python package (v2.2.1)<sup><xref ref-type="bibr" rid="R48">48</xref></sup>. All residues with rSASA&lt;0.25 were defined as core.</p><p id="P102">Minimum ligand-residue distances were calculated as the shortest distance between any side chain heavy atom of the respective PDZ residue and any ligand side chain heavy atom. Residue contacts were defined using getContacts (<ext-link ext-link-type="uri" xlink:href="https://getcontacts.github.io/">https://getcontacts.github.io/</ext-link>) on the AlphaFold3 predicted structures, by using get_static_contacts.py with parameters --itypes all.</p><p id="P103">Finally, binding interface residues were defined as those with at least one predicted contact with the ligand.</p></sec><sec id="S28"><title>Structure visualizations</title><p id="P104">ChimeraX<sup><xref ref-type="bibr" rid="R49">49</xref></sup> was used to visualise all protein structures presented. Contacts in these structures display the predictions from getContacts(<ext-link ext-link-type="uri" xlink:href="https://getcontacts.github.io/">https://getcontacts.github.io/</ext-link>), which are drawn using the distance command.</p><p id="P105">We used SSDraw<sup><xref ref-type="bibr" rid="R50">50</xref></sup> for the 2D secondary structure representation of the mutated PDZ domains, using as input the corresponding AlphaFold3 structure predictions.</p></sec><sec id="S29"><title>Structural alignments</title><p id="P106">Structural alignments were performed using T-Coffee<sup><xref ref-type="bibr" rid="R51">51</xref></sup> Expresso with default parameters. Residue conservation was calculated from the structural alignment using the BLOSUM62 substitution matrix to quantify residue similarity.</p></sec><sec id="S30"><title>Classification of binding interface hotspots</title><p id="P107">Hotspots were defined as interface residues whose distribution of ΔΔG<sub>b</sub> values was significantly greater than the median ΔΔG<sub>b</sub> value across all binding interface residues (0.75kcal/mol). Statistical significance was assessed using a one-sided t-test, and p-values were corrected for multiple testing using the false discovery rate (FDR) method Benjamini-Hochberg, with a significance threshold of <italic>FDR</italic>&lt;0.1. Classification of hotspots can be found in <xref ref-type="supplementary-material" rid="SD7">supplementary table 6</xref>.</p></sec><sec id="S31"><title>Quantification of distance dependence effects of mutations</title><p id="P108">To quantify the dependence of mutation effects on the distance from the ligand, we computed the minimum heavy atom side chain distance between each residue and the ligand, using AlphaFold3-predicted<sup><xref ref-type="bibr" rid="R44">44</xref></sup> structures. To quantify this dependence, an exponential decay function was fitted to the data using the nls() function from the R stats package, with initial parameter estimates obtained via the optim() function. In exponential decay model <italic>y = a</italic> · <italic>e<sup>bx</sup>, a</italic> represents the estimated |ΔΔG<sub>b</sub>| at distance 0 Å from the ligand, <italic>b</italic> is the decay rate and x is the minimum heavy atom side chain distance to the ligand. The model was fit to all data points excluding those corresponding to binding interface residues.</p><p id="P109">The same analysis procedure was applied to previously published datasets for KRAS<sup><xref ref-type="bibr" rid="R22">22</xref></sup>, GB1 and GRB2<sup><xref ref-type="bibr" rid="R19">19</xref></sup>, using previously defined annotations. For these datasets, distances were calculated as the minimum side chain heavy atom distance to each interaction partner, and binding interfaces were defined as any residue within 5 Å of the interaction partner.</p><p id="P110">Similarly, the procedure was applied to SRC data<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, where distances were annotated as the minimum distance between each residue’s Cα and three functional features: (1) the non-hydrolyzable ATP analog AMP-PNP (from PDB: 2SRC), (2) the catalytic residue D388, and (3) the proposed phosphosite substrate positioning residue P428. Binding interface residues for SRC were defined based on previously annotated active sites from the literature<sup><xref ref-type="bibr" rid="R23">23</xref></sup>.</p></sec><sec id="S32"><title>Classification of allosteric hotspots</title><p id="P111">To identify allosteric hotspots, we first calculated the expected ΔΔG<sub>b</sub> at each residue based on its minimum side-chain heavy atom distance to the ligand, using the previously fitted exponential decay model. Residuals were then computed as the difference between observed and expected ΔΔG<sub>b</sub> values. Residues were classified as allosteric hotspots if their residual distribution was significantly greater than zero, using a one-sided t-test with FDR correction (<italic>FDR </italic>&lt; 0.05). To avoid false positives from small effects at long distances, we further required a median of the absolute ΔΔG<sub>b</sub>&gt; 0.2. Classification of hotspots can be found in <xref ref-type="supplementary-material" rid="SD7">Supplementary table 6</xref>.</p></sec></sec><sec id="S33" sec-type="extended-data"><title>Extended Data</title><fig id="F7" position="anchor"><label>Extended Data Figure 1</label><caption><title>Energetic landscapes of multiple PDZ domains homologs</title><p id="P112"><bold>a.</bold> Triplicate fitness Pearson correlations and fitness density distributions for all libraries, including AbundancePCA, BindingPCA, and two blocks each. <bold>b.</bold> Pearson correlation of fitness measurements in overlapping regions between blocks (i.e. repeated variants measurements in independent experiments). Fitness values are shown after normalization between blocks and libraries. Red scatter points indicate libraries lacking single amino acid substitutions for the wild-type background; for visualization, data from the most wild-type-like background is shown (ΔΔG<sub>b</sub> of the background ~0). Error bars indicate 95% CI (n = 3 biological replicates). <bold>c.</bold> Fitness heat maps for single mutants for AbundancePCA and BindingPCA results. As in panel b, for blocks lacking single variants on the wild-type background, data is shown for the most wild-type-like background. Dashes indicate wild-type residues. Residue numbering follows UniProt protein sequence annotation <bold>d.</bold> Scatter plots comparing abundancePCA and bindingPCA fitness measurements for single amino acid substitutions from the same PDZ domain.</p></caption><graphic xlink:href="EMS207016-f007"/></fig><fig id="F8" position="anchor"><label>Extended Data Figure 2</label><caption><title>From molecular phenotypes to free energy changes</title><p id="P113"><bold>a.</bold> Performance of models fit to ddPCA data for all libraries. Pearson correlation is reported per library and block. <bold>b.</bold> Non-linear relationships (global epistasis) between observed AbundancePCA fitness and changes in free energy of folding. <bold>c.</bold> Non-linear relationships (global epistasis) between observed BindingPCA fitness and both changes in free energy of folding and binding <bold>d.</bold> Free energy changes distributions of core vs surface residues. “****” annotation refers to <italic>P</italic>&lt;2.2x10-16 for Wilcoxon rank-sum test. <bold>e.</bold> Scatter plots comparing folding and binding free energy changes for single amino acid substitutions for the same PDZ domain.</p></caption><graphic xlink:href="EMS207016-f008"/></fig><fig id="F9" position="anchor"><label>Extended Data Figure 3</label><caption><title>Binding interface energy landscapes for seven interactions</title><p id="P114"><bold>a.</bold> Structure representation of hotspots in every interaction. All highlighted residues are ligand contacts. Colors indicate non-hotspots (white), hotspots in 1 PDZ domain (purple), and recurrent hotspots in at least 3 (red). Ligand is represented in light grey. Dashed black lines show all predicted structural contacts with the ligand. <bold>b.</bold> Heat map of all structurally aligned residues that are classified as binding interface hotspots in at least one interaction. Letter labels refer to wild type residues in each position and interaction. Scatter points overlaid on the heat map represent ligand wild-type amino acids that make direct contact with the corresponding PDZ domain residue. Scatter points below the heat map represent the residue’s minimum side chain heavy atom distance to the ligand. <bold>c.</bold> Same heat map for residues never classified as binding interface hotspots.</p></caption><graphic xlink:href="EMS207016-f009"/></fig><fig id="F10" position="anchor"><label>Extended Data Figure 4</label><caption><title>Seven comparative allosteric maps</title><p id="P115"><bold>a.</bold> Relationships between the absolute ΔΔG<sub>a</sub> and the minimum distances to the binding partner. Lines represent exponential decay fits (<italic>y = a</italic> · <italic>e<sup>bx</sup></italic>), calculated excluding mutations within the binding interface for SRC, <bold>b.</bold> for KRAS and all interaction partners, and <bold>c.</bold> for GB1 and GRB2-SH3 domains. <bold>d.</bold> Pearson correlation of ΔΔG<sub>b</sub> residuals across all pairwise comparisons of libraries. <bold>e.</bold> Percentage of shared mutations with significantly positive ΔΔG<sub>b</sub> residuals (<italic>FDR</italic>&lt;0.1, one-sided Z-test) for each pairwise library comparison. <bold>f</bold>. Boxplots of ΔΔG<sub>b</sub> values for all residues across all tested interactions. For each residue, the blue dot indicates the expected ΔΔG<sub>b</sub> based on its distance to the ligand, derived from interaction-specific distance decay fits. Boxplots outlined in black represent conserved allosteric hotspots found in three or more PDZ domains (<italic>FDR</italic> &lt; 0.05, one-sided t-test); green outlines indicate hotspots present in one or two PDZ domains. Red box plots correspond to binding interface residues. <bold>g</bold>. Distribution of ΔΔG<sub>b</sub> values per interaction across five residue categories: non-hotspots outside the binding interface (gray), allosteric hotspots found in one or two PDZ domains (green), conserved allosteric hotspots found in three or more (purple), binding interface hotspots (orange), and binding interface non-hotspots (yellow). “*” indicate <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test) <bold>h</bold>. Enrichment test for identified hotspots defined by previously reported allosteric networks in PSD95-PDZ3. Bars represent the most significant result out of four one-sided Fisher’s exact tests conducted per dataset. Tests include: enrichment of hotspots identified in PSD95-PDZ3 binding CRIPT, excluding this interaction’s binding interface residues (blue); enrichment of conserved hotspots (i.e., those identified in at least three PDZ domains in this study), excluding PSD95-PDZ3 binding interface residues (green); enrichment of hotspots identified in PSD95-PDZ3 binding CRIPT, including binding interface residues and hotspots (orange); and enrichment of the most conserved hotspots, including binding interface residues (purple). <bold>i.</bold> One-sided Fisher’s exact test enrichments of allosteric hotspots in core (rSASA&lt;0.25) and surfaces, calculated separately for each interaction. <bold>j</bold>. ΔΔG<sub>b</sub> Pearson correlation for PSD95-PDZ2 binding two different partners; error bars indicate 95% confidence intervals from a Monte Carlo simulation approach (n = 10 experiments), and the same for <bold>k</bold>. NHERF3-PDZ1. <bold>l.</bold> ΔΔG<sub>b</sub> Pearson’s correlation for ΔΔG<sub>b</sub> of mutations in hotspots present in one or two PDZs.</p></caption><graphic xlink:href="EMS207016-f010"/></fig><fig id="F11" position="anchor"><label>Extended Data Figure 5</label><caption><title>Gain of function allosteric sites.</title><p id="P116"><bold>a.</bold> Relationship between absolute ΔΔG<sub>b</sub> and the minimum side chain heavy atom distance to the ligand for gain-of-function (ΔΔG<sub>b</sub>&lt;0, top) and loss-of-function (ΔΔG<sub>b</sub>&gt;0, bottom) mutations. Curves show exponential decay fits (<italic>y = a</italic> · <italic>e<sup>bx</sup></italic>), calculated excluding mutations within the binding interface. <bold>b</bold>. Number of mutations per residue with ΔΔG<sub>b</sub>&lt; -0.2 and significantly ΔΔG<sub>b</sub>&lt;0 effects (FDR&lt;0.1, one-sided Z-test). Blue bars indicate surface residues; grey bars indicate core residues (rSASA&lt;0.25). Black outlines mark residues significantly enriched in GOF mutations (FDR&lt;0.1, one-sided FET). <bold>c</bold>. Structural visualization of residues enriched in mutations with significantly ΔΔG<sub>b</sub>&lt;0 (FDR&lt;0.1, One-sided FET).</p></caption><graphic xlink:href="EMS207016-f011"/></fig></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary figures</label><media xlink:href="EMS207016-supplement-Supplementary_figures.pdf" mimetype="application" mime-subtype="pdf" id="d17aAcFbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary table 1</label><media xlink:href="EMS207016-supplement-Supplementary_table_1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d17aAcFcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary table 2</label><media xlink:href="EMS207016-supplement-Supplementary_table_2.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d17aAcFdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplementary table 3</label><media xlink:href="EMS207016-supplement-Supplementary_table_3.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d17aAcFeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary table 4</label><media xlink:href="EMS207016-supplement-Supplementary_table_4.txt" mimetype="text" mime-subtype="plain; charset=utf-8" id="d17aAcFfB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>Supplementary table 5</label><media xlink:href="EMS207016-supplement-Supplementary_table_5.txt" mimetype="text" mime-subtype="plain; charset=utf-8" id="d17aAcFgB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>Supplementary table 6</label><media xlink:href="EMS207016-supplement-Supplementary_table_6.txt" mimetype="text" mime-subtype="plain; charset=utf-8" id="d17aAcFhB" position="anchor"/></supplementary-material></sec></body><back><ack id="S34"><title>Acknowledgements</title><p>This work was funded by Wellcome (220540/Z/20/A), European Research Council (ERC, Advanced Grant 883742), Spanish Ministry of Science and Innovation (LCF/PR/HR21/52410004, EMBL Partnership, Severo Ochoa Centre of Excellence), AGAUR (2021 SGR 01226), and the CERCA Program/Generalitat de Catalunya. A.M.-A. was funded in part by a fellowship from “laCaixa” Foundation (ID 100010434, fellowship code B006052). We thank all members of the Lehner Lab for helpful discussions and suggestions.</p></ack><sec id="S35" sec-type="data-availability"><title>Data availability</title><p id="P117">All DNA sequencing data have been deposited in the European Nucleotide Archive (ENA) at EMBL-EBI under accession number PRJEB90582</p></sec><sec id="S36" sec-type="data-availability"><title>Code availability</title><p id="P118">Source code to reproduce the analyses is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lehner-lab/PDZ_homologs">https://github.com/lehner-lab/PDZ_homologs</ext-link></p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P119">Author contributions</p><p id="P120">A.M. performed all experiments and analyses. A.M. and B.L. designed experiments and analyses and wrote the manuscript.</p></fn><fn id="FN2" fn-type="conflict"><p id="P121">Competing interests</p><p id="P122">B.L. is a founder and shareholder of ALLOX.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Motlagh</surname><given-names>HN</given-names></name><name><surname>Wrabl</surname><given-names>JO</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Hilser</surname><given-names>VJ</given-names></name></person-group><article-title>The ensemble nature of allostery</article-title><source>Nature</source><year>2014</year><volume>508</volume><fpage>331</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1038/nature13001</pub-id><pub-id pub-id-type="pmcid">PMC4224315</pub-id><pub-id pub-id-type="pmid">24740064</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ullmann</surname><given-names>A</given-names></name></person-group><article-title>In memoriam: Jacques Monod (1910-1976)</article-title><source>Genome Biol Evol</source><year>2011</year><volume>3</volume><fpage>1025</fpage><lpage>1033</lpage><pub-id pub-id-type="doi">10.1093/gbe/evr024</pub-id><pub-id pub-id-type="pmcid">PMC3264052</pub-id><pub-id pub-id-type="pmid">21979155</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monod</surname><given-names>J</given-names></name><name><surname>Changeux</surname><given-names>JP</given-names></name><name><surname>Jacob</surname><given-names>F</given-names></name></person-group><article-title>Allosteric proteins and cellular control systems</article-title><source>J Mol Biol</source><year>1963</year><volume>6</volume><fpage>306</fpage><lpage>329</lpage><pub-id pub-id-type="pmid">13936070</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nussinov</surname><given-names>R</given-names></name><name><surname>Tsai</surname><given-names>C-J</given-names></name></person-group><article-title>Allostery in disease and in drug discovery</article-title><source>Cell</source><year>2013</year><volume>153</volume><fpage>293</fpage><lpage>305</lpage><pub-id pub-id-type="pmid">23582321</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuriyan</surname><given-names>J</given-names></name><name><surname>Eisenberg</surname><given-names>D</given-names></name></person-group><article-title>The origin of protein interactions and allostery in colocalization</article-title><source>Nature</source><year>2007</year><volume>450</volume><fpage>983</fpage><lpage>990</lpage><pub-id pub-id-type="pmid">18075577</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fenton</surname><given-names>AW</given-names></name><name><surname>Hoffpauir</surname><given-names>ZA</given-names></name><name><surname>Martin</surname><given-names>TA</given-names></name><name><surname>Harris</surname><given-names>RA</given-names></name><name><surname>Lamb</surname><given-names>AL</given-names></name></person-group><article-title>Are allosteric mechanisms conserved among homologues?</article-title><source>J Mol Biol</source><year>2025</year><elocation-id>169176</elocation-id><pub-id pub-id-type="pmid">40306405</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J-S</given-names></name><name><surname>Seo</surname><given-names>SW</given-names></name><name><surname>Jang</surname><given-names>S</given-names></name><name><surname>Jung</surname><given-names>GY</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name></person-group><article-title>Rational engineering of enzyme allosteric regulation through sequence evolution analysis</article-title><source>PLoS Comput Biol</source><year>2012</year><volume>8</volume><elocation-id>e1002612</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002612</pub-id><pub-id pub-id-type="pmcid">PMC3395594</pub-id><pub-id pub-id-type="pmid">22807670</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leander</surname><given-names>M</given-names></name><name><surname>Yuan</surname><given-names>Y</given-names></name><name><surname>Meger</surname><given-names>A</given-names></name><name><surname>Cui</surname><given-names>Q</given-names></name><name><surname>Raman</surname><given-names>S</given-names></name></person-group><article-title>Functional plasticity and evolutionary adaptation of allosteric regulation</article-title><source>Proc Natl Acad Sci U S A</source><year>2020</year><volume>117</volume><fpage>25445</fpage><lpage>25454</lpage><pub-id pub-id-type="doi">10.1073/pnas.2002613117</pub-id><pub-id pub-id-type="pmcid">PMC7568325</pub-id><pub-id pub-id-type="pmid">32999067</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hultqvist</surname><given-names>G</given-names></name><etal/></person-group><article-title>Energetic pathway sampling in a protein interaction domain</article-title><source>Structure</source><year>2013</year><volume>21</volume><fpage>1193</fpage><lpage>1202</lpage><pub-id pub-id-type="pmid">23810696</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandhya</surname><given-names>S</given-names></name><etal/></person-group><article-title>Length variations amongst protein domain superfamilies and consequences on structure and function</article-title><source>PLoS One</source><year>2009</year><volume>4</volume><elocation-id>e4981</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0004981</pub-id><pub-id pub-id-type="pmcid">PMC2659687</pub-id><pub-id pub-id-type="pmid">19333395</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>CK</given-names></name><name><surname>Pan</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name></person-group><article-title>Extensions of PDZ domains as important structural and functional elements</article-title><source>Protein Cell</source><year>2010</year><volume>1</volume><fpage>737</fpage><lpage>751</lpage><pub-id pub-id-type="doi">10.1007/s13238-010-0099-6</pub-id><pub-id pub-id-type="pmcid">PMC4875201</pub-id><pub-id pub-id-type="pmid">21203915</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname><given-names>MB</given-names></name></person-group><article-title>Origin of PDZ (DHR, GLGF) domains</article-title><source>Trends Biochem Sci</source><year>1995</year><volume>20</volume><fpage>350</fpage><pub-id pub-id-type="pmid">7482701</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amacher</surname><given-names>JF</given-names></name><name><surname>Brooks</surname><given-names>L</given-names></name><name><surname>Hampton</surname><given-names>TH</given-names></name><name><surname>Madden</surname><given-names>DR</given-names></name></person-group><article-title>Specificity in PDZ-peptide interaction networks: Computational analysis and review</article-title><source>J Struct Biol X</source><year>2020</year><volume>4</volume><elocation-id>100022</elocation-id><pub-id pub-id-type="doi">10.1016/j.yjsbx.2020.100022</pub-id><pub-id pub-id-type="pmcid">PMC7138185</pub-id><pub-id pub-id-type="pmid">32289118</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christensen</surname><given-names>NR</given-names></name><etal/></person-group><article-title>PDZ domains as drug targets</article-title><source>Adv Ther (Weinh)</source><year>2019</year><volume>2</volume><elocation-id>1800143</elocation-id><pub-id pub-id-type="doi">10.1002/adtp.201800143</pub-id><pub-id pub-id-type="pmcid">PMC7161847</pub-id><pub-id pub-id-type="pmid">32313833</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nardella</surname><given-names>C</given-names></name><etal/></person-group><article-title>Targeting PDZ domains as potential treatment for viral infections, neurodegeneration and cancer</article-title><source>Biol Direct</source><year>2021</year><volume>16</volume><fpage>15</fpage><pub-id pub-id-type="doi">10.1186/s13062-021-00303-9</pub-id><pub-id pub-id-type="pmcid">PMC8506081</pub-id><pub-id pub-id-type="pmid">34641953</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tonikian</surname><given-names>R</given-names></name><etal/></person-group><article-title>A specificity map for the PDZ domain family</article-title><source>PLoS Biol</source><year>2008</year><volume>6</volume><fpage>e239</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0060239</pub-id><pub-id pub-id-type="pmcid">PMC2553845</pub-id><pub-id pub-id-type="pmid">18828675</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>H-J</given-names></name><name><surname>Zheng</surname><given-names>JJ</given-names></name></person-group><article-title>PDZ domains and their binding partners: structure, specificity, and modification</article-title><source>Cell Commun Signal</source><year>2010</year><volume>8</volume><fpage>8</fpage><pub-id pub-id-type="doi">10.1186/1478-811X-8-8</pub-id><pub-id pub-id-type="pmcid">PMC2891790</pub-id><pub-id pub-id-type="pmid">20509869</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doyle</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Crystal structures of a complexed and peptide-free membrane protein-binding domain: molecular basis of peptide recognition by PDZ</article-title><source>Cell</source><year>1996</year><volume>85</volume><fpage>1067</fpage><lpage>1076</lpage><pub-id pub-id-type="pmid">8674113</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faure</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Mapping the energetic and allosteric landscapes of protein binding domains</article-title><source>Nature</source><year>2022</year><volume>604</volume><fpage>175</fpage><lpage>183</lpage><pub-id pub-id-type="pmid">35388192</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faure</surname><given-names>AJ</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>MoCHI: neural networks to fit interpretable models and quantify energies, energetic couplings, epistasis, and allostery from deep mutational scanning data</article-title><source>Genome Biol</source><year>2024</year><volume>25</volume><fpage>303</fpage><pub-id pub-id-type="doi">10.1186/s13059-024-03444-y</pub-id><pub-id pub-id-type="pmcid">PMC11610129</pub-id><pub-id pub-id-type="pmid">39617885</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>Biophysical ambiguities prevent accurate genetic prediction</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>4923</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-18694-0</pub-id><pub-id pub-id-type="pmcid">PMC7529754</pub-id><pub-id pub-id-type="pmid">33004824</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weng</surname><given-names>C</given-names></name><name><surname>Faure</surname><given-names>AJ</given-names></name><name><surname>Escobedo</surname><given-names>A</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>The energetic and allosteric landscape for KRAS inhibition</article-title><source>Nature</source><year>2024</year><volume>626</volume><fpage>643</fpage><lpage>652</lpage><pub-id pub-id-type="doi">10.1038/s41586-023-06954-0</pub-id><pub-id pub-id-type="pmcid">PMC10866706</pub-id><pub-id pub-id-type="pmid">38109937</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beltran</surname><given-names>A</given-names></name><name><surname>Faure</surname><given-names>AJ</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>The allosteric landscape of the Src kinase</article-title><source>bioRxiv</source><year>2024</year><elocation-id>2024.04.26.591297</elocation-id><pub-id pub-id-type="doi">10.1101/2024.04.26.591297</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>ED</given-names></name><name><surname>Kowarzyk</surname><given-names>J</given-names></name><name><surname>Michnick</surname><given-names>SW</given-names></name></person-group><article-title>High-resolution mapping of protein concentration reveals principles of proteome architecture and adaptation</article-title><source>Cell Rep</source><year>2014</year><volume>7</volume><fpage>1333</fpage><lpage>1340</lpage><pub-id pub-id-type="pmid">24813894</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarassov</surname><given-names>K</given-names></name><etal/></person-group><article-title>An in vivo map of the yeast protein interactome</article-title><source>Science</source><year>2008</year><volume>320</volume><fpage>1465</fpage><lpage>1470</lpage><pub-id pub-id-type="pmid">18467557</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salinas</surname><given-names>VH</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Coevolution-based inference of amino acid interactions underlying protein function</article-title><source>Elife</source><year>2018</year><volume>7</volume><pub-id pub-id-type="doi">10.7554/eLife.34300</pub-id><pub-id pub-id-type="pmcid">PMC6117156</pub-id><pub-id pub-id-type="pmid">30024376</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clackson</surname><given-names>T</given-names></name><name><surname>Wells</surname><given-names>JA</given-names></name></person-group><article-title>A hot spot of binding energy in a hormone-receptor interface</article-title><source>Science</source><year>1995</year><volume>267</volume><fpage>383</fpage><lpage>386</lpage><pub-id pub-id-type="pmid">7529940</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bogan</surname><given-names>Andrew A</given-names></name><name><surname>Thorn</surname><given-names>Kurt S</given-names></name></person-group><article-title>Anatomy of hot spots in protein interfaces</article-title><source>Journal of Molecular Biology</source><year>1998</year><volume>280</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">9653027</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><article-title>Hot Regions in Protein–Protein Interactions: The Organization and Contribution of Structurally Conserved Hot Spot Residues</article-title><source>Journal of Molecular Biology</source><year>2005</year><volume>345</volume><fpage>1281</fpage><lpage>1294</lpage><pub-id pub-id-type="pmid">15644221</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name></person-group><article-title>‘Double water exclusion’: a hypothesis refining the O-ring theory for the hot spots at protein interfaces</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>743</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp058</pub-id><pub-id pub-id-type="pmcid">PMC2654803</pub-id><pub-id pub-id-type="pmid">19179356</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mostarda</surname><given-names>S</given-names></name><name><surname>Gfeller</surname><given-names>D</given-names></name><name><surname>Rao</surname><given-names>F</given-names></name></person-group><article-title>Beyond the binding site: the role of the β<sub>2</sub>-β<sub>3</sub> loop and extra-domain structures in PDZ domains</article-title><source>PLoS Comput Biol</source><year>2012</year><volume>8</volume><elocation-id>e1002429</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002429</pub-id><pub-id pub-id-type="pmcid">PMC3297566</pub-id><pub-id pub-id-type="pmid">22412368</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevens</surname><given-names>AO</given-names></name><name><surname>He</surname><given-names>Y</given-names></name></person-group><article-title>Allosterism in the PDZ family</article-title><source>Int J Mol Sci</source><year>2022</year><volume>23</volume><elocation-id>1454</elocation-id><pub-id pub-id-type="doi">10.3390/ijms23031454</pub-id><pub-id pub-id-type="pmcid">PMC8836106</pub-id><pub-id pub-id-type="pmid">35163402</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLaughlin</surname><given-names>RN</given-names><suffix>Jr</suffix></name><name><surname>Poelwijk</surname><given-names>FJ</given-names></name><name><surname>Raman</surname><given-names>A</given-names></name><name><surname>Gosal</surname><given-names>WS</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>The spatial architecture of protein function and adaptation</article-title><source>Nature</source><year>2012</year><volume>491</volume><fpage>138</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1038/nature11500</pub-id><pub-id pub-id-type="pmcid">PMC3991786</pub-id><pub-id pub-id-type="pmid">23041932</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halabi</surname><given-names>N</given-names></name><name><surname>Rivoire</surname><given-names>O</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title><source>Cell</source><year>2009</year><volume>138</volume><fpage>774</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.07.038</pub-id><pub-id pub-id-type="pmcid">PMC3210731</pub-id><pub-id pub-id-type="pmid">19703402</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><article-title>Allosteric drugs and mutations: chances, challenges, and necessity</article-title><source>Current Opinion in Structural Biology</source><year>2020</year><volume>62</volume><fpage>149</fpage><lpage>157</lpage><pub-id pub-id-type="pmid">32062398</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajasekaran</surname><given-names>N</given-names></name><name><surname>Naganathan</surname><given-names>AN</given-names></name></person-group><article-title>A self-consistent structural perturbation approach for determining the magnitude and extent of allosteric coupling in proteins</article-title><source>Biochem J</source><year>2017</year><volume>474</volume><fpage>2379</fpage><lpage>2388</lpage><pub-id pub-id-type="pmid">28522638</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jack</surname><given-names>BR</given-names></name><name><surname>Meyer</surname><given-names>AG</given-names></name><name><surname>Echave</surname><given-names>J</given-names></name><name><surname>Wilke</surname><given-names>CO</given-names></name></person-group><article-title>Functional sites induce long-range evolutionary constraints in enzymes</article-title><source>PLoS Biol</source><year>2016</year><volume>14</volume><elocation-id>e1002452</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002452</pub-id><pub-id pub-id-type="pmcid">PMC4854464</pub-id><pub-id pub-id-type="pmid">27138088</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lockless</surname><given-names>SW</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Evolutionarily conserved pathways of energetic connectivity in protein families</article-title><source>Science</source><year>1999</year><volume>286</volume><fpage>295</fpage><lpage>299</lpage><pub-id pub-id-type="pmid">10514373</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>KA</given-names></name><name><surname>McLaughlin</surname><given-names>RN</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><article-title>Hot spots for allosteric regulation on protein surfaces</article-title><source>Cell</source><year>2011</year><volume>147</volume><fpage>1564</fpage><lpage>1575</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.10.049</pub-id><pub-id pub-id-type="pmcid">PMC3414429</pub-id><pub-id pub-id-type="pmid">22196731</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCormick</surname><given-names>JW</given-names></name><name><surname>Russo</surname><given-names>MAX</given-names></name><name><surname>Thompson</surname><given-names>S</given-names></name><name><surname>Blevins</surname><given-names>A</given-names></name><name><surname>Reynolds</surname><given-names>KA</given-names></name></person-group><article-title>Structurally distributed surface sites tune allosteric regulation</article-title><year>2021</year><pub-id pub-id-type="doi">10.7554/eLife.68346</pub-id><pub-id pub-id-type="pmcid">PMC8324303</pub-id><pub-id pub-id-type="pmid">34132193</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>AB</given-names></name><etal/></person-group><article-title>Deep learning—guided design of dynamic proteins</article-title><source>Science</source><year>2025</year><pub-id pub-id-type="pmid">40403060</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillai</surname><given-names>A</given-names></name><etal/></person-group><article-title>De novo design of allosterically switchable protein assemblies</article-title><source>Nature</source><year>2024</year><volume>632</volume><fpage>911</fpage><lpage>920</lpage><pub-id pub-id-type="doi">10.1038/s41586-024-07813-2</pub-id><pub-id pub-id-type="pmcid">PMC11338832</pub-id><pub-id pub-id-type="pmid">39143214</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pincus</surname><given-names>D</given-names></name><etal/></person-group><article-title>Engineering allosteric regulation in protein kinases</article-title><source>Science Signaling</source><year>2018</year><pub-id pub-id-type="doi">10.1126/scisignal.aar3250</pub-id><pub-id pub-id-type="pmcid">PMC6662207</pub-id><pub-id pub-id-type="pmid">30401787</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abramson</surname><given-names>J</given-names></name><etal/></person-group><article-title>Accurate structure prediction of biomolecular interactions with AlphaFold 3</article-title><source>Nature</source><year>2024</year><volume>630</volume><fpage>493</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1038/s41586-024-07487-w</pub-id><pub-id pub-id-type="pmcid">PMC11168924</pub-id><pub-id pub-id-type="pmid">38718835</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teyra</surname><given-names>J</given-names></name><etal/></person-group><article-title>Large-scale survey and database of high affinity ligands for peptide recognition modules</article-title><source>Mol Syst Biol</source><year>2020</year><volume>16</volume><elocation-id>e9310</elocation-id><pub-id pub-id-type="doi">10.15252/msb.20199310</pub-id><pub-id pub-id-type="pmcid">PMC7724964</pub-id><pub-id pub-id-type="pmid">33438817</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faure</surname><given-names>AJ</given-names></name><name><surname>Schmiedel</surname><given-names>JM</given-names></name><name><surname>Baeza-Centurion</surname><given-names>P</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name></person-group><article-title>DiMSum: an error model and pipeline for analyzing deep mutational scanning data and diagnosing common experimental pathologies</article-title><source>Genome Biol</source><year>2020</year><volume>21</volume><fpage>207</fpage><pub-id pub-id-type="doi">10.1186/s13059-020-02091-3</pub-id><pub-id pub-id-type="pmcid">PMC7429474</pub-id><pub-id pub-id-type="pmid">32799905</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Bank</surname><given-names>RPD</given-names></name></person-group><source>RCSB PDB - 2EEI: Solution Structure of Second PDZ domain of PDZ Domain Containing Protein 1</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/structure/2EEI">https://www.rcsb.org/structure/2EEI</ext-link></comment></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitternacht</surname><given-names>S</given-names></name></person-group><article-title>FreeSASA: An open source C library for solvent accessible surface area calculations</article-title><source>F1000Res</source><year>2016</year><volume>5</volume><fpage>189</fpage><pub-id pub-id-type="doi">10.12688/f1000research.7931.1</pub-id><pub-id pub-id-type="pmcid">PMC4776673</pub-id><pub-id pub-id-type="pmid">26973785</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname><given-names>EC</given-names></name><etal/></person-group><article-title>UCSF ChimeraX: Tools for structure building and analysis</article-title><source>Protein Sci</source><year>2023</year><volume>32</volume><elocation-id>e4792</elocation-id><pub-id pub-id-type="doi">10.1002/pro.4792</pub-id><pub-id pub-id-type="pmcid">PMC10588335</pub-id><pub-id pub-id-type="pmid">37774136</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>EA</given-names></name><name><surname>Porter</surname><given-names>LL</given-names></name></person-group><article-title>SSDraw: Software for generating comparative protein secondary structure diagrams</article-title><source>Protein Sci</source><year>2023</year><volume>32</volume><elocation-id>e4836</elocation-id><pub-id pub-id-type="doi">10.1002/pro.4836</pub-id><pub-id pub-id-type="pmcid">PMC10680343</pub-id><pub-id pub-id-type="pmid">37953705</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Tommaso</surname><given-names>P</given-names></name><etal/></person-group><article-title>T-Coffee: a web server for the multiple sequence alignment of protein and RNA sequences using structural information and homology extension</article-title><source>Nucleic Acids Res</source><year>2011</year><volume>39</volume><fpage>W13</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/nar/gkr245</pub-id><pub-id pub-id-type="pmcid">PMC3125728</pub-id><pub-id pub-id-type="pmid">21558174</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Seven complete energetic and allosteric landscapes for PDZ domains</title><p><bold>a.</bold> Energetic surface map for PSD95-PDZ3 binding CRIPT <sup><xref ref-type="bibr" rid="R19">19</xref></sup> alongside six homologous interactions. Structures are AlphaFold3 <sup><xref ref-type="bibr" rid="R44">44</xref></sup> predictions. <bold>b.</bold> Canonical fold and binding of the PDZ domain family (PSD95-PDZ2 binding CRIPT). Ligand residues numbered in orange. <bold>c.</bold> Library design. For each PDZ domain, two overlapping library blocks, incorporating NNK codons at every position and an NNK codon in a fixed position. Schematics were created using BioRender.com. <bold>d.</bold> AbundancePCA (aPCA) and BindingPCA (bPCA) selections. Schematics were created using BioRender.com. <bold>e.</bold> Deep mutational scanning experimental workflow. Schematics were created using BioRender.com. <bold>f.</bold> Heat maps for fitness effects of single amino acid substitutions for ERBIN-PDZ1 from aPCA (top) and bPCA (bottom). Dashes indicate wild-type residues. Residue numbering from UniProt. Stacked heat maps represent data across 20 genetic backgrounds. <bold>g.</bold> Example of triplicate fitness Pearson correlations for ERBIN-PDZ1 binding CRIPT (library block 2). <bold>h.</bold> Distribution of Pearson correlation coefficients for triplicate fitness measurements for all libraries. <bold>i.</bold> Example of fitness density distributions for libraries for ERBIN-PDZ1. Fitness measurements shown after normalization between blocks and libraries. <bold>j.</bold> Median of the normalised fitness values mapped onto PDZ structural alignment. Residue numbering corresponds to alignment positions. <bold>k.</bold> Neural network architecture used to fit thermodynamic models to the PCA data (bottom, target and output data), thereby inferring the causal changes in free energy of folding and binding associated with single amino acid substitutions (top, input values). <bold>l.</bold> Example of non-linear relationships (global epistasis) between observed aPCA fitness and changes in free energy of folding for EBRIN-PDZ1. <bold>m</bold>. Examples of performance of models fit to PCA data for EBRIN-PDZ1 libraries. <bold>n.</bold> Distribution of Pearson correlation coefficients for MoCHI observed vs predicted fitness measurements. <bold>o</bold>. Example of non-linear relationships (global epistasis) between observed BindingPCA fitness and both changes in free energy of folding and binding for EBRIN-PDZ1 binding CRIPT.</p></caption><graphic xlink:href="EMS207016-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comprehensive PDZ domain energy landscapes</title><p><bold>a.</bold> Free energy heat maps for all PDZ domain interactions. Dashes indicate wild-type residues. Residue numbering follows UniProt protein sequence annotation. <bold>b.</bold> Correlations with independent energy measurements from Salinas and Ranganathan 2018<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. BindingPCA free energies are from a single model; error bars indicate 95% confidence intervals from a Monte Carlo simulation approach (n = 10 experiments). Pearson’s R is shown together with a linear model fit with 95% confidence intervals shown with green shading. <bold>c.</bold> PDZ domain structures colored by median free energy changes (ΔΔG) at each residue position. For each domain, the first structure highlights median ΔΔG<sub>f</sub> values in the core residues. The second and third structures are oriented towards the ligand-binding interface, displaying surface coloring based on ΔΔG<sub>f</sub> and ΔΔG<sub>b</sub>, respectively.</p></caption><graphic xlink:href="EMS207016-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Comparative binding interface energy maps</title><p><bold>a.</bold> Distribution of ΔΔG<sub>b</sub> values for mutations in residues contacting each ligand. <bold>b.</bold> Distribution of ΔΔG<sub>b</sub> values for mutations in each binding interface residue per interaction. Facets group structurally aligned residues from each interaction. The horizontal red line indicates the median ΔΔG<sub>b</sub> across all the binding interfaces. Boxplots outlined in black highlight residues with significantly higher ΔΔG<sub>b</sub> values than the median (ΔΔG<sub>b</sub>&gt;0.75 kcal/mol, FDR &lt; 0.1, one-sided t-test). <bold>c.</bold> Number of positions that are hotspots in 0 to 5 PDZ domains. Colors indicate non-hotspots (grey), hotspots in 1 domain (black), and recurrent hotspots in at least 3 (red). <bold>d.</bold> Structural view of hotspots conserved in at least 3 domains. <bold>e</bold>. Total number of PDZ residues contacting each ligand position. Facets separate contact counts from non-hotspots (grey), hotspots in 1 PDZ (black), and recurrent hotspots in at least 3 (red). <bold>f</bold>. Distribution of sequence conservation score per position in the alignment. “*” indicates <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test). <bold>g</bold>. Distributions of Root-Mean-Square Deviation (RMSD) of residues within each group, computed for each pairwise comparison of binding interfaces. “*” indicate <italic>P</italic>&lt;0.05 (Wilcoxon signed-rank test). <bold>h</bold>. Distribution of relative solvent accessible surface area (rSASA) per residue and interaction, grouped by hotspot classification. “*” indicate <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test). <bold>i</bold>. Structural representation of the O-ring-like arrangement of hotspots in the binding interface. Residue labels correspond to structural alignment positions. Colors indicate non-hotspots (white), hotspots in 1 or 2 PDZ domains (dark grey), and recurrent hotspots in at least 3 PDZ domains (red).</p></caption><graphic xlink:href="EMS207016-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Seven comparative allosteric maps</title><p><bold>a.</bold> Distribution of ΔΔG<sub>b</sub> values for mutations in residues outside of the binding interface. <bold>b.</bold> Relationships between absolute ΔΔG<sub>b</sub> and the minimum side chain heavy atom distance to the ligand. Curves represent exponential decay fits (<italic>y = a</italic> · <italic>e</italic><italic><sup>bx</sup></italic>), calculated excluding mutations within the binding interface. <bold>c.</bold> Structural visualization of ΔΔG<sub>b</sub> decay by distances to the ligand. ERBIN-PDZ1 binding CRIPT is shown, colored by absolute ΔΔG<sub>b</sub> values. The second panel shows a sliced view highlighting internal residues. <bold>d</bold>. Examples of the ΔΔG<sub>b</sub> (left) and ΔΔG<sub>b</sub> residuals (right) distributions for structural alignment positions 57 and 63. Left panel shows the data for PSD95-PDZ2 binding CRIPT, and the right panel shows the distributions for all interactions. <bold>e</bold>. Number of positions that are allosteric hotspots in 0 to 5 PDZ domains. Colors indicate non-hotspots (grey), hotspots in 1-2 PDZs (green), and recurrent hotspots in at least 3 (purple). <bold>f.</bold> Structural alignment where residues are coloured by the per-residue median ΔΔG<sub>b</sub>. Binding interface residues are presented in black dashed lines. Green outlines indicate positions classified as hotspots in only one or two PDZ domains; purple outlines indicate conserved hotspots present in at least three PDZ domains. <bold>g.</bold> Distribution of ΔΔG<sub>b</sub> values across five residue categories: non-hotspots outside the binding interface (gray), allosteric hotspots found in one or two PDZ domains (green), conserved allosteric hotspots found in three or more (purple), binding interface hotspots (orange), and binding interface non-hotspots (yellow). “*” indicate <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test). <bold>h.</bold> Structure visualization of residues A57, G61, and N73. A57 is classified as an allosteric hotspot in all interactions tested. G61 is a surface-exposed allosteric hotspot in 3 out of 5 PDZ domains, and N73 is a surface-exposed allosteric hotspot in 4 out of 5 PDZ domains. <bold>i</bold>. Two-sided Fisher’s exact test for enrichments of allosteric hotspots in alpha helices, loops, beta strands, and One-sided Fisher’s exact test for enrichment in core (rSASA&lt;0.25) and surfaces. Tests are based on the complete dataset aggregated from all libraries. <bold>j</bold>. Distribution of sequence conservation score per position in the alignment. “*” indicates <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test). <bold>k</bold>. Distributions of Root-Mean-Square Deviation (RMSD) of residues within each group, computed for each pairwise comparison of structures. “*” indicates <italic>P</italic>&lt;0.05 (Wilcoxon signed-rank test). <bold>l</bold>. Distribution of relative solvent accessible surface area (rSASA) per residue and interaction, grouped by hotspot classification. “*” indicate <italic>P</italic>&lt;0.05 (Wilcoxon rank-sum test).</p></caption><graphic xlink:href="EMS207016-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Allosteric innovation in a protein family</title><p>Binding interface residues (ligand-contacting) are shown in red. Allosteric hotspots present in at least 3 PDZ domains are shown in purple; those found in only 1-2 PDZs are shown in green. Non-conserved hotspots located in canonical PDZ fold regions are labelled in pink. β2-β3 loop regions are shown in yellow, and additional C-terminal α-helix extensions are in blue. Predicted direct contacts between hotspots are indicated with grey dashed lines. Structure for <bold>a.</bold> NHERF3-PDZ1 binding DAP-1 <bold>b</bold>. for NHERF3-PDZ1 binding UHMK1 <bold>c</bold>. ERBIN-PDZ1 binding CRIPT <bold>d</bold>. NHERF3-PDZ2 binding CEP164 <bold>e</bold>. PSD95-PDZ3 binding CRIPT <bold>f.</bold> PSD95-PDZ2 binding CRIPT <bold>g.</bold> PSD95-PDZ2 binding NMDAR2A.</p></caption><graphic xlink:href="EMS207016-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Evolution of allosteric surfaces</title><p>Surfaces are colored by the per-residue median ΔΔG<sub>b</sub>. The binding interface is highlighted in orange. Residues outlined in purple are allosteric hotspots present in at least three PDZ domains; green outlines indicate hotspots identified in only one or two domains. The allosteric surface map is shown from three orientations relative to the reference structure, viewed facing the ligand with the C-terminus pointing upward: <bold>a</bold>. from the left, <bold>b</bold>. from the back, <bold>c</bold>. from the right.</p></caption><graphic xlink:href="EMS207016-f006"/></fig></floats-group></article>