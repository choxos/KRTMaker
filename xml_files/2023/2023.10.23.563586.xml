<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS190117</article-id><article-id pub-id-type="doi">10.1101/2023.10.23.563586</article-id><article-id pub-id-type="archive">PPR746984</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Data-driven regularisation lowers the size barrier of cryo-EM structure determination</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kimanius</surname><given-names>Dari</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Jamali</surname><given-names>Kiarash</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wilkinson</surname><given-names>Max E</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Lövestam</surname><given-names>Sofia</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Velazhahan</surname><given-names>Vaithish</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Nakane</surname><given-names>Takanori</given-names></name><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Scheres</surname><given-names>Sjors H.W.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>MRC Laboratory of Molecular Biology, Francis Crick Avenue, Cambridge, CB2 0QH, UK</aff><aff id="A2"><label>2</label>CZ Imaging Institute, 3400 Bridge Parkway, Redwood City, CA 94065, USA</aff><aff id="A3"><label>3</label>Broad Institute of MIT and Harvard, Cambridge, MA 02142, USA</aff><aff id="A4"><label>4</label>McGovern Institute for Brain Research, Massachusetts Institute of Technology, Cambridge, MA 02139, USA</aff><aff id="A5"><label>5</label>Howard Hughes Medical Institute, Cambridge, MA 02139, USA</aff><aff id="A6"><label>6</label>School of Medicine, Stanford University, 291 Campus Drive, Li Ka Shing Building, Stanford, CA 94305-5101, USA</aff><aff id="A7"><label>7</label>Institute for Protein Research, Osaka University, Osaka, 3-2, Yamadaoka, Suita-shi, Osaka 565-0871, Japan</aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author(s). <email>dari@mrc-lmb.cam.ac.uk</email>; <email>scheres@mrc-lmb.cam.ac.uk</email>;</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>26</day><month>10</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>24</day><month>10</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Macromolecular structure determination by electron cryo-microscopy (cryo-EM) is limited by the alignment of noisy images of individual particles. Because smaller particles have weaker signals, alignment errors impose size limitations on its applicability. Here, we explore how image alignment is improved by the application of deep-learning to exploit prior knowledge about biological macromolecular structures that would otherwise be difficult to express mathematically. We train a denoising convolutional neural network on pairs of half-set reconstructions from the electron microscopy data bank (EMDB) and use this denoiser as an alternative to a commonly used smoothness prior. We demonstrate that this approach, which we call Blush regularisation, yields better reconstructions than existing algorithms, in particular for data with low signal-to-noise ratios. The reconstruction of a protein-nucleic acid complex with a molecular weight of 40 kDa, which was previously intractable, illustrates that regularisation through denoising will expand the applicability of cryo-EM structure determination for a wide range of biological macromolecules.</p></abstract><kwd-group><kwd>Cryo-EM</kwd><kwd>Structural Biology</kwd><kwd>Machine Learning</kwd><kwd>Computer Vision</kwd><kwd>Inverse Problems</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Despite rapid progress in the past decade [<xref ref-type="bibr" rid="R1">1</xref>], many biological macromolecules of interest are still too small to allow reliable cryo-EM structure determination. To limit the damage that electrons cause to the biological structures of interest, cryo-EM images are taken under low-dose conditions, which leads to high levels of experimental noise. The noise in the images impedes their alignment, resulting in an ill-posed optimisation problem, where many (noisy or artifactual) reconstructions are equally likely given the data. Nevertheless, the correct solution may still be identified through the incorporation of prior knowledge in the reconstruction process. Most cryo-EM structures are calculated using explicit regularisation of a likelihood function in Fourier space, which assumes cryo-EM reconstructions are smooth in real space [<xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R4">4</xref>].</p><p id="P3">Although we know a lot more about the structures of biological macromolecules than that their density varies smoothly, it has been difficult to incorporate richer sources of prior knowledge in the optimisation. Denoising convolutional neural networks provide a mechanism to incorporate complicated prior knowledge into an iterative optimisation process [<xref ref-type="bibr" rid="R5">5</xref>]. By training a denoising network on simulated pairs of noisy and ground-truth images, we previously provided a proof-of-principle that prior knowledge about protein structures can be exploited to improve cryo-EM structure determination [<xref ref-type="bibr" rid="R6">6</xref>]. However, we also observed problems with overfitting and the hallucination of protein-like features in the resulting reconstructions. Moreover, because experimental cryo-EM structures often comprise regions of well-ordered proteins and nucleic acid domains alongside less structured regions, including for example membrane patches or flexible domains, it was not clear how one would generate ground-truth pairs for experimental cryo-EM data.</p><p id="P4">Here, we demonstrate how denoising convolutional neural networks, trained and deployed in an application-specific manner, can improve cryo-EM structure determination with experimental data. Similar to the noise2noise approach [<xref ref-type="bibr" rid="R7">7</xref>], we trained a denoiser using pairs of noisy reconstructions that are generated as part of standard procedures in cryo-EM structure determination [<xref ref-type="bibr" rid="R8">8</xref>]. This approach improves cryo-EM structure determination of a wide variety of biological macromolecules and reduces current size limitations of cryo-EM structure determination.</p></sec><sec id="S2" sec-type="methods"><title>Method</title><sec id="S3"><title>Rationale</title><p id="P5">The noise2noise framework [<xref ref-type="bibr" rid="R7">7</xref>] facilitates the training of a denoising convolutional neural network in the absence of explicit access to ground-truth images. Instead, it relies on pairs of noisy images to extract information about their shared signal. Here, we present an application-specific approach that incorporates this aspect from the noise2noise framework. We trained a denoiser on a set of 422 pairs of noisy half-maps that we downloaded from the electron microscopy data bank (EMDB) [<xref ref-type="bibr" rid="R9">9</xref>]. Only entries with reported resolutions higher than 4 Å that had both unfiltered half-maps deposited where selected.</p><p id="P6">We tailored data augmentation and training of the denoiser to integrate with the iterative expectation-maximisation algorithm for cryo-EM reconstruction. All pairs of half-maps, <inline-formula><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, with <italic>k</italic> ∈ {0, 1}, were re-scaled to a uniform voxel size of 1.5 Å, and augmented by generating new pairs <inline-formula><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> : <disp-formula id="FD1"><label>(1)</label><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>H</mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula><disp-formula id="FD2"><label>(2)</label><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>H</mml:mtext><mml:mrow><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>⊙</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mtext>h</mml:mtext><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>⊙</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where, <italic>e</italic> ∈ ℝ<sup><italic>N</italic></sup> is random coloured noise, <italic>M</italic><sub><italic>i</italic></sub> ∈ [0, 1]<sup><italic>N</italic></sup> is a smooth mask encapsulating the molecules of interest, represents ⊙ voxel-wise multiplication, and h(.) is a low-pass filter to 15 Å. H<sub><italic>C,A</italic></sub>[.] applies an anisotropic Gaussian filter with covariance matrix <italic>C</italic>, an affine transform <italic>A</italic> that includes rotation and translation, a crop to a cube of 64<sup>3</sup> voxels, and a voxel-value standardisation. Data augmentation was achieved through random assignments of <italic>C</italic>, <inline-formula><mml:math id="M5"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, <italic>A, e</italic>, and <italic>r</italic>.</p><p id="P7">By using a range of resolution cutoffs for <italic>C</italic> and <inline-formula><mml:math id="M6"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, the denoiser explicitly learns to handle maps with varying resolutions. This is needed for its application inside the iterative expectation-maximisation algorithm, which typically starts at relatively low resolutions and gradually progresses to higher resolutions. Although using a lower resolution cut-off for <italic>C</italic> than for <inline-formula><mml:math id="M7"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> could have produced a network that enhances the resolution of the half-maps, similar to deblurring networks [<xref ref-type="bibr" rid="R10">10</xref>], we opted not to do so in order to minimize the risk of hallucinating high-resolution features.</p><p id="P8">Using different degrees of anisotropy in <italic>C</italic> and <inline-formula><mml:math id="M8"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, the denoiser learns to deal with the artifacts that arise from non-uniform orientational distributions, while random orientations and affine transformations in <italic>A</italic> lead to invariance with respect to rotations, translations, and intensity scale. By applying h(.) on <inline-formula><mml:math id="M9"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, the denoiser learns to enforce fewer features in the solvent region. By filling solvent regions with a 15 Å low-pass filtered version of the map, as opposed to a straightforward voxel-wise multiplication with the mask <italic>M</italic><sub><italic>i</italic></sub>, higher density values in regions with disordered molecules, such as detergent micelles, are maintained.</p></sec><sec id="S4"><title>Training the denoiser</title><p id="P9">Our denoiser <italic>f</italic><sub><italic>θ</italic></sub> consists of a U-net with approximately 13 million trainable parameters <italic>θ</italic> (<xref ref-type="fig" rid="F1">Figure 1</xref>). It is trained using residual learning [<xref ref-type="bibr" rid="R11">11</xref>] and with a dropout rate of 50% [<xref ref-type="bibr" rid="R12">12</xref>]. Instance normalization [<xref ref-type="bibr" rid="R13">13</xref>] is used to handle small mini-batches <italic>ℬ</italic>, with <italic>b</italic> = 8 samples from the training dataset, during training. We minimise the following loss: <disp-formula id="FD3"><label>(3)</label><mml:math id="M10"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">B</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>R</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where, R<sub><italic>r</italic></sub>[<italic>f</italic><sub><italic>θ</italic></sub>, <italic>y</italic>] returns the output of the denoiser <italic>f</italic><sub><italic>θ</italic></sub> after recursively calling it <italic>r</italic> ∈ {0, …, 5} times with <inline-formula><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> as the initial input. This enables the denoiser to recognize and suppress artifacts brought about by its repeated usage, thereby limiting the amplification of artifacts in the reconstruction that are introduced by the denoiser during subsequent iterations of the expectation-maximisation algorithm [<xref ref-type="bibr" rid="R6">6</xref>].</p><p id="P10">Training for 950,000 steps took 6 days on a single Nvidia A100 GPU.</p></sec><sec id="S5"><title>Iterative denoising with spectral trailing</title><p id="P11">Our pre-trained denoiser expresses prior knowledge about cryo-EM reconstructions. Its iterative use within the expectation-maximisation algorithm that underlies cryo-EM structure determination is called <italic>Blush regularisation</italic>. Blush regularisation has been implemented in the open-source software RELION-5. It can be used for 3D classification, multi-body refinement, and 3D auto-refinement jobs, including particles with point-group or helical symmetry.</p><p id="P12">At every iteration, the denoiser is applied separately to each intermediate half-map reconstruction, where it replaces the 3D Wiener filter that results from regularisation in Fourier space [<xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R3">3</xref>]. Although one effect of the denoiser is that it tends to dampen Fourier components at higher spatial frequencies, the amount by which it does so is not well defined. Therefore, we employ a heuristic, here referred to as <italic>spectral trailing</italic>, to prevent overfitting in 3D auto-refinement and multi-body refinement. First, we calculate the Fourier shell correlation (FSC) between two independently refined half-maps before the application of the denoiser and determine the resolution <italic>ρ</italic> where the solvent-corrected FSC drops below 0.143. We then apply the denoiser to both half-maps and subsequently apply a low-pass filter at a resolution that is 2 Fourier shells lower than <italic>ρ</italic>. If <italic>ρ</italic> exceeds the Nyquist frequency of the denoiser, here set to 3Å, the remaining Fourier shells at higher frequencies are populated with the reconstruction from the standard regularisation in Fourier space. The resulting denoised, low-pass filtered maps are then used as references for alignment in the next iteration. The denoiser is not applied to the output of the final refinement step.</p><p id="P13">For 3D classification, where data is not separated into independent half-sets, the filtered map from the regularised likelihood approach is used as input for the denoiser. No additional low-pass filtering is applied. In this job type, the denoiser is also applied in the last iteration.</p></sec></sec><sec id="S6" sec-type="results"><title>Results</title><sec id="S7"><title>Blush improves reconstruction without overfitting</title><p id="P14">We first tested Blush regularisation on a cryo-EM data set (EMPIAR-10330) [<xref ref-type="bibr" rid="R14">14</xref>] of the <italic>Plasmodium falciparum</italic> Chloroquine Resistance Transporter (PfCRT) [<xref ref-type="bibr" rid="R15">15</xref>]. This data set has been used as a standard to demonstrate the performance of several approaches to reduce overfitting in cryo-EM refinement [<xref ref-type="bibr" rid="R16">16</xref>, <xref ref-type="bibr" rid="R17">17</xref>]. Standard refinement using regularized likelihood optimisation in RELION, which we refer to as the baseline, yields an overall resolution of 3.8 Å for this data set.</p><p id="P15">Application of Blush regularisation (<xref ref-type="fig" rid="F2">Figure 2</xref>) yielded an overall resolution estimate of 3.4 Å.Spectral trailing was applied with a cut-off at 3.5 Å, beyond which no information from the denoiser was used. Compared to the baseline reconstruction, local resolution improved for most regions of the map, with a corresponding increase in visible side-chain densities. The improvement in resolution as measured by half-map FSC was confirmed by FSCs between both maps and the atomic model that was deposited for this dataset (PDB-ID 6UKJ). Throughout this paper, FSCs between the map and atomic model are calculated using Servalcat [<xref ref-type="bibr" rid="R18">18</xref>]. In addition, we also assessed the relative quality of both maps by application of our automated model-building software ModelAngelo [<xref ref-type="bibr" rid="R19">19</xref>], which generated a model with 84% completeness in the baseline map and 97% completeness in the Blush map. Model completeness is defined as the percentage of residues that match the reference model with a C<italic>α</italic>-distance of 3 Å or less.</p><p id="P16">To assess the potential for overfitting by the denoiser, we also performed a phase-randomisation test [<xref ref-type="bibr" rid="R20">20</xref>]. We applied Blush regularisation without spectral trailing for refinement of the PfCRT dataset with phase-randomisation beyond 4 Å. Even though spectral trailing was not used, no overfitting was observed. Switching off spectral trailing led to a marginal improvement in the quality of reconstruction, as quantified by the FSC between the map and the atomic model (<xref ref-type="fig" rid="F2">Fig 2d</xref>). These results indicate that the denoiser can prevent overfitting for this dataset, even without spectral trailing. In the general ase, we still recommend running Blush regularisation with spectral trailing because the gains of switching it off are small and overfitting may be more prominent for other datasets. Consequently, in the following sections, we only present results obtained using spectral trailing.</p></sec><sec id="S8"><title>Blush expands the applicability of cryo-EM structure determination</title><p id="P17">We subsequently assessed the broader applicability of Blush regularisation by applying it to four different types of structures and refinement methods.</p><p id="P18">First, we tested Blush regularisation on a small membrane protein, Ste2, which is a dimeric G-protein coupled receptor (GPCR) [<xref ref-type="bibr" rid="R21">21</xref>] (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="table" rid="T1">Extended Data Table 1</xref>). The full-length monomeric Ste2 has a molecular weight of 47.85 kDa, which includes a long disordered C-terminal tail that comprises 125 amino acids. The total mass of the ordered dimeric Ste2 that contributes to alignment is roughly 67 kDa, most of which lies embedded in a detergent micelle.</p><p id="P19">The data set was acquired on a similar complex to PDB entry 7QB9 reported in [<xref ref-type="bibr" rid="R21">21</xref>], but with different biochemical conditions that impact the stability of the structure. Alignment of images of Ste2 is difficult because not many protein features extend from the smooth detergent micelle. Baseline reconstruction yielded a map with an overall resolution of 3.8 Å, with limited densities for side chains. Application of Blush regularisation led to a structure with an overall resolution of 3.4Å. Spectral trailing ensured that no information from the denoiser was inserted beyond 3.7 Å resolution. Compared to the baseline reconstruction, the density of the trans-membrane helices is improved. Loops at the top and bottom of the structure are still relatively poorly resolved, probably due to molecular flexibility. In agreement with the visibility of improved side-chain densities and local resolution estimates, the completeness of models built by ModelAngelo in these maps improved from 19% to 43%.</p><p id="P20">Second, we tested Blush regularisation in multi-body refinement [<xref ref-type="bibr" rid="R22">22</xref>]. Multi-body refinement uses partial signal subtraction to align independently moving domains of a larger complex. Reconstructions from subtracted images were not part of the training set of the denoiser. Moreover, signal subtraction reduces the amount of signal in each image, placing stringent limitations on the minimal size of domains that can be aligned in multi-body refinement. We applied Blush in multi-body refinement to a publicly available data set (EMPIAR-10180) of the <italic>Saccharomyces cerevisiae</italic> pre-catalytic spliceosomal B complex [<xref ref-type="bibr" rid="R23">23</xref>] (<xref ref-type="fig" rid="F4">Figure 4</xref>). Using four bodies, for the core, the foot, the helicase and the SF3b regions, Blush regularisation improved all domains compared to baseline multi-body refinement, as measured by local resolution, half-map FSCs and FSCs with the reference atomic model (PDB-ID 5NRL). The improvements in resolution were largest in the helicase and SF3b regions, which are the most flexible and thus the hardest to reconstruct. The improvements in resolution were reflected by automated model building in ModelAngelo, which increased model completeness of the entire complex from 32% to 48%. In particular, the model completeness for the SF3b region was improved from 3% to 29%.</p><p id="P21">Third, we assessed the performance of Blush regularisation for a biological assembly that differed from the types of structures the denoiser was trained on: the first intermediate amyloid (FIA) that forms during the <italic>in vitro</italic> assembly of recombinant tau (residues 297-391) [<xref ref-type="bibr" rid="R24">24</xref>]. This data set is also publicly available (EMPIAR-11720). Unlike any of the structures in the training set, the FIA has helical symmetry. It is an amyloid filament, with parallel <italic>β</italic>-strands repeating every 4.7 Å in the direction of the helical axis. Besides deviating from the types of structures in the training set, the FIA is also one of the smallest amyloid structures solved to date, with only 15 ordered residues in each of two opposing <italic>β</italic>-sheets. Baseline helical refinement yielded a 5.0 Å map, in which the density for <italic>β</italic>-strands along the helical axis was not separated, and no atomic model could be built. Blush regularisation improved the resolution to 2.8 Å, and ModelAngelo built all 15 ordered residues in the resulting map.</p><p id="P22">Fourth, we applied Blush to a protein-nucleic acid complex with a combined molecular weight of 40 kDa (<xref ref-type="fig" rid="F6">Figure 6</xref>; <xref ref-type="table" rid="T1">Extended Data Table 1</xref>). Using multiple different classification and refinement strategies in baseline RELION and CryoSPARC, we were unable to obtain a reliable reconstruction (results not shown). Even though an initial model generated using the standard VDAM algorithm in RELION [<xref ref-type="bibr" rid="R25">25</xref>] suffered from anisotropy, a first 3D classification with Blush regularisation resulted in one class with recognizable protein features. Refinement of the corresponding class yielded a better initial model for a second 3D classification, from which a single class was selected for subsequent CTF refinement [<xref ref-type="bibr" rid="R26">26</xref>] and particle polishing [<xref ref-type="bibr" rid="R26">26</xref>]. A 3D classification was performed without alignment, followed by a final 3D refinement. All 3D classifications with alignment and 3D refinements used Blush regularisation. The final map achieved a resolution of 2.5 Å, with ModelAngelo successfully building 97% of the protein sequence, and 33 out of 42 nucleotides.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P23">Our results demonstrate that denoising convolutional neural networks can be used as a source of extended prior information in the reconstruction of experimental cryo-EM images. A previous approach that used noise2noise, implemented in the M software [<xref ref-type="bibr" rid="R27">27</xref>], exclusively trained a denoising network on half-maps from the dataset to which it was also applied. As a result, unlike our approach, it did not express general prior knowledge about cryo-EM reconstructions. When we tried to express prior knowledge about protein structures by training a denoiser on pairs of noisy and ground-truth maps that were calculated from atomic models, we observed problems with overfitting and hallucinations [<xref ref-type="bibr" rid="R6">6</xref>]. Similar problems may also explain why the application of the DeepEMhancer neural network [<xref ref-type="bibr" rid="R28">28</xref>] inside the iterative reconstruction algorithm of RELION had to be restricted to only a few iterations at the end of refinement [<xref ref-type="bibr" rid="R29">29</xref>]. The approach described in this paper reduces the risk of hallucinating protein-like features in the reconstruction by using a neural network that is trained on experimental cryo-EM half-maps only, i.e. without using atomic models or the geometrical restraints that are used to describe them.</p><p id="P24">Instead of forcing the map to resemble densities derived from atomic models, our denoiser is trained to introduce more subtle modifications to cryo-EM maps, such as smoothing out density in solvent regions or within detergent micelles. The network also removes artifacts that are commonly encountered in difficult cryo-EM refinements, e.g. anisotropic densities that result from uneven angular distributions, or radially extending, streaky features that are often observed in overfitted maps (<xref ref-type="fig" rid="F1">Figs 1f-g</xref>). Our findings illustrate that, even though the effect of a single application of the denoiser is relatively small, its cumulative impact over multiple iterations enhances the performance of cryo-EM structure determination across a diverse range of test cases. As machine-learning methods get better at extracting knowledge from large datasets, it may be tempting to exploit more knowledge about the structures of biological macro-molecules in the reconstruction process. However, doing so may ultimately also take away one of the most powerful ways of assessing whether a reconstruction is correct: the presence of expected features in the map. We thus anticipate that the cryo-EM community will continue to explore the question of how much prior knowledge should inform the reconstruction process and how much should be kept aside for validation.</p><p id="P25">Within the framework of Blush regularisation, the denoiser replaces the exponential prior that traditionally constrains the power of Fourier-space components in the baseline algorithm. As a result, the FSC between independently refined subsets no longer influences the weighting of Fourier components in intermediate reconstructions. Instead, this FSC is used to determine a resolution cutoff <italic>ρ</italic>, beyond which the Fourier components of the two denoised half-maps are set to zero. Because Fourier components near the resolution estimate of the final map will not have been affected by the denoiser, protein-like features at these frequencies cannot be the result of hallucination or overfitting by the denoiser. Future investigations will explore alternative approaches that do not rely on heuristics, like choosing a specific <italic>ρ</italic>, which arises from the observation that the dampening effect of the network is not well defined in Fourier space. Future adaptation of the VDAM algorithm [<xref ref-type="bibr" rid="R25">25</xref>] will also allow the use of Blush regularisation for initial model generation.</p><p id="P26">In all our tests, Blush regularisation outperformed or equaled the baseline implementation in RELION, with the differences being largest for cases where the baseline approach tends to overfit the data. Consequently, Blush regularisation will be most useful for refinements of data sets with low signal-to-noise ratios, like those of small complexes or complexes embedded in thick ice layers, multi-body refinements involving relatively small bodies, and refinements of maps exhibiting pronounced variations in local resolution. For example, Blush regularisation allowed reconstruction of an amyloid with only 30 residues in its ordered core and a protein-nucleic acid complex with a molecular weight of 40 kDa. Although nucleic acids result in higher signal-to-noise ratios than proteins, 40 kDa approaches predictions of the minimum size protein that is amenable to cryo-EM structure determination [<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R31">31</xref>]. These results illustrate that the use of prior knowledge through denoising convolutional neural networks expands the applicability of cryo-EM structure determination.</p></sec><sec id="S10" sec-type="extended-data"><title>Extended Data</title><table-wrap id="T1" orientation="portrait" position="anchor"><label>Extended Data Table 1</label><caption><title>Details on cryo-EM data collection and processing of the Ste2 and 40 kDa complex datasets.</title></caption><table frame="void" rules="none"><thead><tr><th valign="top" align="left"/><th valign="top" align="left">Ste2</th><th valign="top" align="left">40 kDa complex</th></tr></thead><tbody><tr><td valign="top" align="left" colspan="2"><bold>Data collection</bold></td></tr><tr><td valign="top" align="left">Microscope</td><td valign="top" align="left">Thermo Scientific Krios G3i</td><td valign="top" align="left">Thermo Scientific Krios G3i</td></tr><tr><td valign="top" align="left">Camera</td><td valign="top" align="left">Falcon 4i</td><td valign="top" align="left">Gatan K3</td></tr><tr><td valign="top" align="left">Magnification</td><td valign="top" align="left">96,000x</td><td valign="top" align="left">165,000x</td></tr><tr><td valign="top" align="left">Voltage (kV)</td><td valign="top" align="left">300</td><td valign="top" align="left">300</td></tr><tr><td valign="top" align="left">Pixel size (Å)</td><td valign="top" align="left">0.824</td><td valign="top" align="left">0.531</td></tr><tr><td valign="top" align="left">Total electron exposure (<italic>e</italic><sup>−</sup>/Å<sup>2</sup>)</td><td valign="top" align="left">56</td><td valign="top" align="left">72</td></tr><tr><td valign="top" align="left">Exposure rate (e-/pixel/sec)</td><td valign="top" align="left">7.9</td><td valign="top" align="left">15</td></tr><tr><td valign="top" align="left">Defocus range (<italic>μ</italic>m)</td><td valign="top" align="left">0.8 - 2.4</td><td valign="top" align="left">0.8 - 1.5</td></tr><tr><td valign="top" align="left">Automation software</td><td valign="top" align="left">EPU</td><td valign="top" align="left">EPU</td></tr><tr><td valign="top" align="left">Energy filter slit width</td><td valign="top" align="left">N/A</td><td valign="top" align="left">20 eV</td></tr><tr><td valign="top" align="left">Micrographs collected (no.)</td><td valign="top" align="left">13,254</td><td valign="top" align="left">11,232</td></tr><tr><td valign="top" align="left"><bold>3D reconstruction</bold></td><td valign="top" align="left" colspan="2"/></tr><tr><td valign="top" align="left">Number of frames for motion correction</td><td valign="top" align="left">70</td><td valign="top" align="left">40</td></tr><tr><td valign="top" align="left">Total extracted particles (no.)</td><td valign="top" align="left">2,608,181</td><td valign="top" align="left">6,449,613</td></tr><tr><td valign="top" align="left">Final particle images (no.)</td><td valign="top" align="left">147,797</td><td valign="top" align="left">301,833</td></tr><tr><td valign="top" align="left">Symmetry imposed</td><td valign="top" align="left">C2</td><td valign="top" align="left">C1</td></tr><tr><td valign="top" align="left">Resolution (FSC 0.143; unmasked/masked)</td><td valign="top" align="left">3.9 / 3.4</td><td valign="top" align="left">2.8 / 2.6</td></tr><tr><td valign="top" align="left">Sharpening B-factor (Å<sup>2</sup>)</td><td valign="top" align="left">-160</td><td valign="top" align="left">-90</td></tr></tbody></table></table-wrap></sec></body><back><ack id="S11"><title>Acknowledgements</title><p>We thank Johannes Schwab, Keitaro Yamashita, Carola-Bibiane Schönlieb, and Ozan Öktem for helpful discussions; Jake Grimmett, Toby Darling, and Ivan Clayson for help with high-performance computing; the EM facility of the Medical Research Council Laboratory of Molecular Biology for support with cryo-EM; and Ed Brignole and Chris Borsa for the smooth running of the MIT.nano cryo-EM facility, established in part with financial support from the Arnold and Mabel Beckman Foundation. MEW is grateful to Feng Zhang for funding support. TN is a member of the JEOL YOKOGUSHI Research Alliance Laboratories. This work was supported by the Medical Research Council as part of the United Kingdom Research and Innovation (MC_UP_A025_1013 to SHWS); the European Union’s Horizon 2020 research and innovation programme (under grant agreement no. 895412 to DK); a Helen Hay Whitney Foundation Postdoctoral Fellowship (to MEW); the Howard Hughes Medical Institute (to MEW) and a Research Fellowship at Gonville and Caius College of Cambridge University (to VV). For the purpose of open access, the MRC Laboratory of Molecular Biology has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising.</p></ack><sec id="S12" sec-type="data-availability"><title>Code availability</title><p id="P27">Blush regularisation has been implemented in the open-source software RELION-5, which is distributed for free under the GPLv2 license and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/3dem/relion">https://github.com/3dem/relion</ext-link>.</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P28"><bold>Author contributions</bold></p><p id="P29">DK designed and implemented Blush regularization, ran most experiments and analysed the results. KJ contributed to data preprocessing. MEW contributed and analysed the dataset of the 40kDa protein-nucleic acid complex, and contributed to analysis of the PfCRT dataset. SL contributed the FIA dataset. VV contributed the Ste2 dataset. SHWS supervised the project and contributed to RELION integration. All authors contributed to the writing of the manuscript.</p></fn><fn fn-type="conflict" id="FN2"><p id="P30"><bold>Competing interests</bold></p><p id="P31">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kühlbrandt</surname><given-names>W</given-names></name></person-group><article-title>The resolution revolution</article-title><source>Science</source><year>2014</year><volume>343</volume><issue>6178</issue><fpage>1443</fpage><lpage>1444</lpage><pub-id pub-id-type="pmid">24675944</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>A bayesian view on cryo-em structure determination</article-title><source>Journal of molecular biology</source><year>2012</year><volume>415</volume><issue>2</issue><fpage>406</fpage><lpage>418</lpage><pub-id pub-id-type="pmcid">PMC3314964</pub-id><pub-id pub-id-type="pmid">22100448</pub-id><pub-id pub-id-type="doi">10.1016/j.jmb.2011.11.010</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>Relion: implementation of a bayesian approach to cryo-em structure determination</article-title><source>Journal of structural biology</source><year>2012</year><volume>180</volume><issue>3</issue><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="pmcid">PMC3690530</pub-id><pub-id pub-id-type="pmid">23000701</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2012.09.006</pub-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Punjani</surname><given-names>A</given-names></name><name><surname>Rubinstein</surname><given-names>JL</given-names></name><name><surname>Fleet</surname><given-names>DJ</given-names></name><name><surname>Brubaker</surname><given-names>MA</given-names></name></person-group><article-title>cryosparc: algorithms for rapid unsupervised cryo-em structure determination</article-title><source>Nature methods</source><year>2017</year><volume>14</volume><issue>3</issue><fpage>290</fpage><lpage>296</lpage><pub-id pub-id-type="pmid">28165473</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romano</surname><given-names>Y</given-names></name><name><surname>Elad</surname><given-names>M</given-names></name><name><surname>Milanfar</surname><given-names>P</given-names></name></person-group><article-title>The little engine that could: Regularization by denoising (red)</article-title><source>SIAM Journal on Imaging Sciences</source><year>2017</year><volume>10</volume><issue>4</issue><fpage>1804</fpage><lpage>1844</lpage></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>Zickert</surname><given-names>G</given-names></name><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Lunz</surname><given-names>S</given-names></name><name><surname>SchÖnlieb</surname><given-names>CB</given-names></name><name><surname>Öktem</surname><given-names>O</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>Exploiting prior knowledge about biological macromolecules in cryo-em structure determination</article-title><source>IUCrJ</source><year>2021</year><volume>8</volume><issue>1</issue><fpage>60</fpage><lpage>75</lpage><pub-id pub-id-type="pmcid">PMC7793004</pub-id><pub-id pub-id-type="pmid">33520243</pub-id><pub-id pub-id-type="doi">10.1107/S2052252520014384</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehtinen</surname><given-names>J</given-names></name><name><surname>Munkberg</surname><given-names>J</given-names></name><name><surname>Hasselgren</surname><given-names>J</given-names></name><name><surname>Laine</surname><given-names>S</given-names></name><name><surname>Karras</surname><given-names>T</given-names></name><name><surname>Aittala</surname><given-names>M</given-names></name><name><surname>Aila</surname><given-names>T</given-names></name></person-group><article-title>Noise2noise: Learning image restoration without clean data</article-title><source>arXiv preprint</source><elocation-id>arXiv:180304189</elocation-id><year>2018</year></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>SH</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name></person-group><article-title>Prevention of overfitting in cryo-em structure determination</article-title><source>Nature methods</source><year>2012</year><volume>9</volume><issue>9</issue><fpage>853</fpage><lpage>854</lpage><pub-id pub-id-type="pmcid">PMC4912033</pub-id><pub-id pub-id-type="pmid">22842542</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.2115</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>CL</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name><name><surname>Baker</surname><given-names>ML</given-names></name><name><surname>Hryc</surname><given-names>C</given-names></name><name><surname>Garcia</surname><given-names>ES</given-names></name><name><surname>Hudson</surname><given-names>BP</given-names></name><name><surname>Lagerstedt</surname><given-names>I</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name><name><surname>Pintilie</surname><given-names>G</given-names></name><name><surname>Sala</surname><given-names>R</given-names></name><etal/></person-group><article-title>Emdatabank unified data resource for 3dem</article-title><source>Nucleic acids research</source><year>2016</year><volume>44</volume><issue>D1</issue><fpage>396</fpage><lpage>403</lpage><pub-id pub-id-type="pmcid">PMC4702818</pub-id><pub-id pub-id-type="pmid">26578576</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkv1126</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Albluwi</surname><given-names>F</given-names></name><name><surname>Krylov</surname><given-names>VA</given-names></name><name><surname>Dahyot</surname><given-names>R</given-names></name></person-group><source>Image deblurring and super-resolution using deep convolutional neural networks</source><conf-name>2018 IEEE 28th International Workshop on Machine Learning for Signal Processing (MLSP)</conf-name><year>2018</year><conf-sponsor>IEEE</conf-sponsor><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Zuo</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Meng</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>Beyond a gaussian denoiser: Residual learning of deep cnn for image denoising</article-title><source>IEEE transactions on image processing</source><year>2017</year><volume>26</volume><issue>7</issue><fpage>3142</fpage><lpage>3155</lpage><pub-id pub-id-type="pmid">28166495</pub-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>GE</given-names></name><name><surname>Srivastava</surname><given-names>N</given-names></name><name><surname>Krizhevsky</surname><given-names>A</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name><name><surname>Salakhutdinov</surname><given-names>RR</given-names></name></person-group><article-title>Improving neural networks by preventing co-adaptation of feature detectors</article-title><source>arXiv preprint</source><elocation-id>arXiv:12070580</elocation-id><year>2012</year></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulyanov</surname><given-names>D</given-names></name><name><surname>Vedaldi</surname><given-names>A</given-names></name><name><surname>Lempitsky</surname><given-names>V</given-names></name></person-group><article-title>Instance normalization: The missing ingredient for fast stylization</article-title><source>arXiv preprint</source><elocation-id>arXiv:160708022</elocation-id><year>2016</year></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iudin</surname><given-names>A</given-names></name><name><surname>Korir</surname><given-names>PK</given-names></name><name><surname>Somasundharam</surname><given-names>S</given-names></name><name><surname>Weyand</surname><given-names>S</given-names></name><name><surname>Cattavitello</surname><given-names>C</given-names></name><name><surname>Fonseca</surname><given-names>N</given-names></name><name><surname>Salih</surname><given-names>O</given-names></name><name><surname>Kleywegt</surname><given-names>GJ</given-names></name><name><surname>Patwardhan</surname><given-names>A</given-names></name></person-group><article-title>Empiar: the electron microscopy public image archive</article-title><source>Nucleic Acids Research</source><year>2023</year><volume>51</volume><issue>D1</issue><fpage>1503</fpage><lpage>1511</lpage><pub-id pub-id-type="pmcid">PMC9825465</pub-id><pub-id pub-id-type="pmid">36440762</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkac1062</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Tan</surname><given-names>YZ</given-names></name><name><surname>Wicht</surname><given-names>KJ</given-names></name><name><surname>Erramilli</surname><given-names>SK</given-names></name><name><surname>Dhingra</surname><given-names>SK</given-names></name><name><surname>Okombo</surname><given-names>J</given-names></name><name><surname>Vendome</surname><given-names>J</given-names></name><name><surname>Hagenah</surname><given-names>LM</given-names></name><name><surname>Giacometti</surname><given-names>SI</given-names></name><name><surname>Warren</surname><given-names>AL</given-names></name><etal/></person-group><article-title>Structure and drug resistance of the plasmodium falciparum transporter pfcrt</article-title><source>Nature</source><year>2019</year><volume>576</volume><issue>7786</issue><fpage>315</fpage><lpage>320</lpage><pub-id pub-id-type="pmcid">PMC6911266</pub-id><pub-id pub-id-type="pmid">31776516</pub-id><pub-id pub-id-type="doi">10.1038/s41586-019-1795-x</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramlaul</surname><given-names>K</given-names></name><name><surname>Palmer</surname><given-names>CM</given-names></name><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Aylett</surname><given-names>CH</given-names></name></person-group><article-title>Mitigating local over-fitting during single particle reconstruction with sidesplitter</article-title><source>Journal of structural biology</source><year>2020</year><volume>211</volume><issue>2</issue><elocation-id>107545</elocation-id><pub-id pub-id-type="pmcid">PMC7369633</pub-id><pub-id pub-id-type="pmid">32534144</pub-id><pub-id pub-id-type="doi">10.1016/j.jsb.2020.107545</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Punjani</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Fleet</surname><given-names>DJ</given-names></name></person-group><article-title>Non-uniform refinement: adaptive regularization improves single-particle cryo-em reconstruction</article-title><source>Nature methods</source><year>2020</year><volume>17</volume><issue>12</issue><fpage>1214</fpage><lpage>1221</lpage><pub-id pub-id-type="pmid">33257830</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamashita</surname><given-names>K</given-names></name><name><surname>Palmer</surname><given-names>CM</given-names></name><name><surname>Burnley</surname><given-names>T</given-names></name><name><surname>Murshudov</surname><given-names>GN</given-names></name></person-group><article-title>Cryo-em single-particle structure refinement and map calculation using servalcat</article-title><source>Acta Crystal-lographica Section D: Structural Biology</source><year>2021</year><volume>77</volume><issue>10</issue><fpage>1282</fpage><lpage>1291</lpage><pub-id pub-id-type="pmcid">PMC8489229</pub-id><pub-id pub-id-type="pmid">34605431</pub-id><pub-id pub-id-type="doi">10.1107/S2059798321009475</pub-id></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Jamali</surname><given-names>K</given-names></name><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><source>A graph neural network approach to automated model building in cryo-EM maps</source><conf-name>The Eleventh International Conference on Learning Representations</conf-name><year>2023</year></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Faruqi</surname><given-names>AR</given-names></name><name><surname>Murshudov</surname><given-names>GN</given-names></name><name><surname>Short</surname><given-names>JM</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name><name><surname>Henderson</surname><given-names>R</given-names></name></person-group><article-title>High-resolution noise substitution to measure overfitting and validate resolution in 3d structure determination by single particle electron cryomicroscopy</article-title><source>Ultramicroscopy</source><year>2013</year><volume>135</volume><fpage>24</fpage><lpage>35</lpage><pub-id pub-id-type="pmcid">PMC3834153</pub-id><pub-id pub-id-type="pmid">23872039</pub-id><pub-id pub-id-type="doi">10.1016/j.ultramic.2013.06.004</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velazhahan</surname><given-names>V</given-names></name><name><surname>Ma</surname><given-names>N</given-names></name><name><surname>Vaidehi</surname><given-names>N</given-names></name><name><surname>Tate</surname><given-names>CG</given-names></name></person-group><article-title>Activation mechanism of the class d fungal gpcr dimer ste2</article-title><source>Nature</source><year>2022</year><volume>603</volume><issue>7902</issue><fpage>743</fpage><lpage>748</lpage><pub-id pub-id-type="pmcid">PMC8942848</pub-id><pub-id pub-id-type="pmid">35296853</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04498-3</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>Lindahl</surname><given-names>E</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>Characterisation of molecular motions in cryo-em single-particle data by multi-body refinement in relion</article-title><source>elife</source><year>2018</year><volume>7</volume><elocation-id>36861</elocation-id><pub-id pub-id-type="pmcid">PMC6005684</pub-id><pub-id pub-id-type="pmid">29856314</pub-id><pub-id pub-id-type="doi">10.7554/eLife.36861</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plaschka</surname><given-names>C</given-names></name><name><surname>Lin</surname><given-names>P-C</given-names></name><name><surname>Nagai</surname><given-names>K</given-names></name></person-group><article-title>Structure of a pre-catalytic spliceosome</article-title><source>Nature</source><year>2017</year><volume>546</volume><issue>7660</issue><fpage>617</fpage><lpage>621</lpage><pub-id pub-id-type="pmcid">PMC5503131</pub-id><pub-id pub-id-type="pmid">28530653</pub-id><pub-id pub-id-type="doi">10.1038/nature22799</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LÖvestam</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>D</given-names></name><name><surname>Wagstaff</surname><given-names>JL</given-names></name><name><surname>Kotecha</surname><given-names>A</given-names></name><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>McLaughlin</surname><given-names>SH</given-names></name><name><surname>Murzin</surname><given-names>AG</given-names></name><name><surname>Freund</surname><given-names>SM</given-names></name><name><surname>Goedert</surname><given-names>M</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>Disease-specific tau filaments assemble via polymorphic intermediates</article-title><source>bioRxiv</source><year>2023</year><fpage>2023</fpage><lpage>07</lpage><pub-id pub-id-type="pmid">38030728</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>Dong</surname><given-names>L</given-names></name><name><surname>Sharov</surname><given-names>G</given-names></name><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>New tools for automated cryo-em single-particle analysis in relion-4.0</article-title><source>Biochemical Journal</source><year>2021</year><volume>478</volume><issue>24</issue><fpage>4169</fpage><lpage>4185</lpage><pub-id pub-id-type="pmcid">PMC8786306</pub-id><pub-id pub-id-type="pmid">34783343</pub-id><pub-id pub-id-type="doi">10.1042/BCJ20210708</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zivanov</surname><given-names>J</given-names></name><name><surname>Nakane</surname><given-names>T</given-names></name><name><surname>Forsberg</surname><given-names>BO</given-names></name><name><surname>Kimanius</surname><given-names>D</given-names></name><name><surname>Hagen</surname><given-names>WJ</given-names></name><name><surname>Lindahl</surname><given-names>E</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><article-title>New tools for automated high-resolution cryo-em structure determination in relion-3</article-title><source>elife</source><year>2018</year><volume>7</volume><elocation-id>42166</elocation-id><pub-id pub-id-type="pmcid">PMC6250425</pub-id><pub-id pub-id-type="pmid">30412051</pub-id><pub-id pub-id-type="doi">10.7554/eLife.42166</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tegunov</surname><given-names>D</given-names></name><name><surname>Xue</surname><given-names>L</given-names></name><name><surname>Dienemann</surname><given-names>C</given-names></name><name><surname>Cramer</surname><given-names>P</given-names></name><name><surname>Mahamid</surname><given-names>J</given-names></name></person-group><article-title>Multi-particle cryo-em refinement with m visualizes ribosome-antibiotic complex at 3.5 å in cells</article-title><source>Nature Methods</source><year>2021</year><volume>18</volume><issue>2</issue><fpage>186</fpage><lpage>193</lpage><pub-id pub-id-type="pmcid">PMC7611018</pub-id><pub-id pub-id-type="pmid">33542511</pub-id><pub-id pub-id-type="doi">10.1038/s41592-020-01054-7</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez-Garcia</surname><given-names>R</given-names></name><name><surname>Gomez-Blanco</surname><given-names>J</given-names></name><name><surname>Cuervo</surname><given-names>A</given-names></name><name><surname>Carazo</surname><given-names>JM</given-names></name><name><surname>Sorzano</surname><given-names>COS</given-names></name><name><surname>Vargas</surname><given-names>J</given-names></name></person-group><article-title>Deepemhancer: a deep learning solution for cryo-em volume post-processing</article-title><source>Communications biology</source><year>2021</year><volume>4</volume><issue>1</issue><fpage>874</fpage><pub-id pub-id-type="pmcid">PMC8282847</pub-id><pub-id pub-id-type="pmid">34267316</pub-id><pub-id pub-id-type="doi">10.1038/s42003-021-02399-1</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramírez-Aportela</surname><given-names>E</given-names></name><name><surname>Carazo</surname><given-names>JM</given-names></name><name><surname>Sorzano</surname><given-names>COS</given-names></name></person-group><article-title>Higher resolution in cryoem by the combination of macromolecular prior knowledge and image-processing tools</article-title><source>IUCrJ</source><year>2022</year><volume>9</volume><issue>5</issue><pub-id pub-id-type="pmcid">PMC9438491</pub-id><pub-id pub-id-type="pmid">36071808</pub-id><pub-id pub-id-type="doi">10.1107/S2052252522006959</pub-id></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henderson</surname><given-names>R</given-names></name></person-group><article-title>The potential and limitations of neutrons, electrons and x-rays for atomic resolution microscopy of unstained biological molecules</article-title><source>Quarterly reviews of biophysics</source><year>1995</year><volume>28</volume><issue>2</issue><fpage>171</fpage><lpage>193</lpage><pub-id pub-id-type="pmid">7568675</pub-id></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickerson</surname><given-names>JL</given-names></name><name><surname>Lu</surname><given-names>PH</given-names></name><name><surname>Hristov</surname><given-names>D</given-names></name><name><surname>Dunin-Borkowski</surname><given-names>RE</given-names></name><name><surname>Russo</surname><given-names>CJ</given-names></name></person-group><article-title>Imaging biological macromolecules in thick specimens: The role of inelastic scattering in cryoem</article-title><source>Ultramicroscopy</source><year>2022</year><volume>237</volume><elocation-id>113510</elocation-id><pub-id pub-id-type="pmcid">PMC9355893</pub-id><pub-id pub-id-type="pmid">35367900</pub-id><pub-id pub-id-type="doi">10.1016/j.ultramic.2022.113510</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Schematic illustration of Blush and slices of example volumes.</title><p><bold>(a)</bold> Training procedure, showing two passes for both half-maps and recycling (R<sub><italic>r</italic></sub>) of the denoiser output (in pink). <bold>(b)</bold> Iterative reconstruction with spectral trailing. Each half-map is reconstructed separately. At each iteration, the Fourier Shell Correlation (FSC) is used to estimate a cutoff frequency <italic>ρ</italic>, which is subsequently used to low-pass filter the denoiser output. The final output does not pass through the denoiser but is subject to a Wiener filter, similar to baseline reconstruction. <bold>(c)</bold> Denoiser U-net architecture, consisting of five consecutive encoder blocks, a convolution block, followed by five consecutive decoder blocks. <bold>(d-e)</bold> Slices through maps before (left) and after (right) a single application of the denoiser to the final iteration of the reconstruction for PfCRT <bold>(d)</bold> and the Spliceosome <bold>(e)</bold>. <bold>(f-g)</bold> Showing slices through maps of baseline reconstruction (left) and Blush regularisation (right) of the FIA <bold>(f)</bold> and a 40kDa protein-nucleic acid complex <bold>(g)</bold>. The scale bar indicates 30 Å in all slices.</p></caption><graphic xlink:href="EMS190117-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Single-particle reconstruction of the PfCRT dataset.</title><p><bold>(a)</bold> Maps coloured by local resolution, comparing baseline (left) and Blush (right). <bold>(b)</bold> Automated atomic modeling by ModelAngelo for the baseline (left) and Blush (right) maps. Colored by chain. <bold>(c)</bold> FSCs between the masked maps and deposited model (ID: 6UKJ). <bold>(d)</bold> Solvent-corrected half-map FSCs. Both plots show FSCs for Blush (purple), Blush without spectral trailing (pink) and baseline (black). Dashed (pink) line show solvent-corrected half-map FSC for Blush without spectral trailing when applied to data with phase randomisation beyond 4 Å resolution.</p></caption><graphic xlink:href="EMS190117-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><p>Single-particle reconstruction of the Ste2 dataset. Reconstructions coloured by local resolution, comparing baseline <bold>(a)</bold> and Blush <bold>(b)</bold>. Automated atomic modeling by ModelAngelo, using the baseline <bold>(c)</bold> and Blush <bold>(d)</bold> maps. <bold>(e)</bold> Solvent-corrected half-map FSCs.</p></caption><graphic xlink:href="EMS190117-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><p>Multibody reconstruction of the spliceosome dataset. Combined maps of the individual bodies, coloured by local resolution, comparing baseline <bold>(a)</bold> and Blush <bold>(b)</bold>. <bold>(c)</bold> FSCs between the masked maps of each body and the corresponding region in the deposited model (ID: 5NRL). <bold>(d)</bold> Solvent-corrected half-map FSCs for the individual bodies. In <bold>(c-d)</bold> dashed and solid lines correspond to baseline and Blush maps, respectively. FSCs are shown for each body: core (grey), foot (black), helicase (purple) and SF3b (red). <bold>(e)</bold> Completeness of atomic models built by ModelAngelo for each body, using baseline (grey) and Blush (red) maps. <bold>(f)</bold> Gold-standard half-map resolutions of each body for baseline (grey) and Blush (red) maps.</p></caption><graphic xlink:href="EMS190117-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><p>Helical reconstruction of the FIA, coloured by local resolution, for the baseline <bold>(a)</bold> and Blush <bold>(b)</bold> maps. <bold>(c)</bold> Automated atomic modeling by ModelAngelo, comprising tau residues 302-316. <bold>(d)</bold> Solvent-corrected half-map FSCs of the reconstructed maps.</p></caption><graphic xlink:href="EMS190117-f005"/></fig><fig id="F6" position="float"><label>Fig. 6</label><caption><title>Single-particle reconstruction of the protein-nucleic acid complex with a molecular weight of 40 kDa.</title><p><bold>(a)</bold> Blush regularisation local resolution. <bold>(b)</bold> Automated atomic model assignment with ModelAngelo. <bold>(c)</bold> Detailed view of an alpha-helical segment in the reconstructed map and refined atomic model. <bold>(d)</bold> Solid line shows FSC to a reference atomic model and the dashed line shows half-map FSC. Solvent-corrected resolution is 2.8 Å using a spectral trailing cut-off at 3.0 Å. <bold>(e)</bold> Processing pipeline from initial model to final reconstruction. Numbers indicate the number of particles assigned to each map. Purple squares indicate reconstructions using Blush regularization.</p></caption><graphic xlink:href="EMS190117-f006"/></fig></floats-group></article>