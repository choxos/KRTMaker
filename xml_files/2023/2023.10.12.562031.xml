<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS189773</article-id><article-id pub-id-type="doi">10.1101/2023.10.12.562031</article-id><article-id pub-id-type="archive">PPR743009</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Branching topology of the human embryo transcriptome revealed by entropy sort feature weighting</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Radley</surname><given-names>Arthur</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">†</xref></contrib><contrib contrib-type="author"><name><surname>Smith</surname><given-names>Austin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Living Systems Institute, University of Exeter, Stocker Road, Exeter, EX4 4QD, UK</aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author. <email>austin.smith@exeter.ac.uk</email>
</corresp><fn fn-type="present-address" id="FN1"><label>†</label><p id="P1">Current address: The Francis Crick Institute, London, NW1 1AT, UK</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>19</day><month>10</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>16</day><month>10</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Single cell transcriptomics (scRNA-seq) transforms our capacity to define cell states and reveal developmental trajectories. Resolution is challenged, however, by high dimensionality and noisy data. Analysis is therefore typically performed after sub-setting to highly variable genes (HVGs). However, existing HVG selection techniques have been found to have poor agreement with one another, and tend to be biased towards highly expressed genes. Entropy sorting provides an alternative mathematical framework for feature subset selection. Here we implement continuous entropy sort feature weighting (cESFW). On synthetic datasets, cESFW outperforms HVG selection in distinguishing cell state specific genes. We apply cESFW to six merged scRNA-seq datasets spanning human early embryo development. Without smoothing or augmenting the raw counts matrices, cESFW generates a high-resolution embedding displaying coherent developmental progression from 8-cell to post-implantation stages, delineating 15 distinct cell states. The embedding highlights sequential lineage decisions during blastocyst development while unsupervised clustering identifies branch point populations. Cells previously claimed to lack a developmental trajectory reside in the first branching region where morula differentiates into Inner Cell Mass (ICM) or Trophectoderm (TE). We quantify the relatedness of pluripotent stem cell cultures to embryo cell types and identify naïve and primed marker genes conserved across culture conditions and the human embryo. Finally, by identifying genes with specifically enriched and dynamic expression during blastocyst formation, we provide markers for staging lineage progression from morula to blastocyst. Together these analyses indicate that cESFW provides the ability to reveal gene expression dynamics in scRNA-seq data that HVG selection can fail to elucidate.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P3">Single cell RNA sequencing (scRNA-seq) was first described in 2009 (<xref ref-type="bibr" rid="R31">Tang et al. 2009</xref>), and has since become a cornerstone of stem cell and developmental biology research. scRNA-seq in principle allows the expression levels of the entire transcriptome of individual cells to be measured in an unbiased manner. The mRNA profiles can then be used as a proxy to define the identity of each cell. A key application is to assess how transcriptomes change as cells transition from one cell state to another and thereby obtain insight into regulatory genes and networks.</p><p id="P4">Computational tools have been developed to extract useful information from the large and complex datasets that scRNA-seq generates. These bioinformatics pipelines can be broadly broken down into three main steps (<xref ref-type="bibr" rid="R14">Haque et al. 2017</xref>): <list list-type="order" id="L1"><list-item><p id="P5">Sequencing alignment - Conversion of the experimentally derived sequencing libraries into an mRNA counts matrix by aligning the detected sequences to a reference genome.</p></list-item><list-item><p id="P6">Counts matrix processing - Apply quality control and processing techniques to the counts matrix, with the aim of maximising the contribution of biologically relevant expression signals and minimising the presence of technical noise.</p></list-item><list-item><p id="P7">Data analysis - Combine bioinformatics/data science techniques with domain knowledge to uncover interesting gene expression patterns and dynamics.</p></list-item></list></p><p id="P8">There are several well described challenges when working with complex high dimensional datasets such as scRNA-seq data (<xref ref-type="bibr" rid="R16">Lähnemann et al. 2020</xref>). Here, we focus on the counts matrix processing stage of scRNA-seq analysis, which is a critical step for increasing ability to extract biologically relevant insights from the data. Due to the importance of counts matrix processing, several open source packages have been released. Notably, Seurat, Scanpy and Scran (<xref ref-type="bibr" rid="R15">Heumos et al. 2023</xref>) each provide easy to use workflows for counts matrix processing, which can be further divided into three stages: <list list-type="order" id="L2"><list-item><p id="P9">Basic quality control - Remove low quality cells (low counts per cell, genes per cell, high mitochondrial counts), remove genes expressed in a very low number of cells, etc.</p></list-item><list-item><p id="P10">Highly variable gene (HVG) selection - Identify a subset of the tens of thousands of genes that are believed to be more informative of cell identity than the rest of the genes.</p></list-item><list-item><p id="P11">Data denoising - Apply methods such as principal component analysis (PCA) and data regression/smoothing to mitigate the presence of technical artefacts such as stochastic noise or batch effects.</p></list-item></list></p><p id="P12">In these conventional workflows, the primary aim of HVG selection is to address the curse of dimensionality (<xref ref-type="bibr" rid="R3">Bellman 1957</xref>) by trying to find a subset of the genes in the original scRNA-seq counts matrix that are more discriminative of cell identity. However, poor reproducibility between different HVG methodologies has brought into question the robustness of HVG selection (<xref ref-type="bibr" rid="R41">Yip, Sham, and Wang 2019</xref>). Furthermore, HVG selection has been found to be biased towards selecting highly expressed genes over lowly expressed genes.</p><p id="P13">Following HVG selection, methods that augment or transform the data, such as feature extraction, data smoothing and batch integration are employed to maximise the biologically relevant information that can be extracted (<xref ref-type="bibr" rid="R6">Chu et al. 2022</xref>). The prevailing view is that scRNA-seq data has such high levels of inherent experimental noise and/or gene expression stochasticity, that computational methods must be applied to amplify biological signals of interest. While there are many examples where this approach has successfully aided the identification of interesting gene expression profiles, any computational technique that changes/augments the values in the counts matrix prior to downstream analysis has the potential to introduce spurious artefacts. For example, PCA is a feature extraction method that creates a completely new set of features from the gene expression counts matrix, based on a linear transformation of the data. Compression of scRNA-seq data in this manner can lead to undesirable effects, such as combining distinct groups of cells into a single cluster, or removing gradients of gene expression dynamics (<xref ref-type="bibr" rid="R40">Yeung and Ruzzo 2001</xref>). Likewise, smoothing techniques that try to impute/repair spurious gene expression values in a scRNA-seq counts matrix based on cell-cell similarities or gene-gene relationships, may introduce computational false negative or false positive expression values that obfuscate real biological signals of interest (<xref ref-type="bibr" rid="R2">Andrews and Hemberg 2018</xref>). Similarly, batch correction methods attempt to integrate datasets from different sources by leveraging their commonalities and then changing the values within the datasets so that they become more similar to one another. However, batch correction in this manner risks unintentionally removing heterogeneous biological signals of interest.</p><p id="P14">The overall aim of HVG selection, feature extraction, data smoothing and batch integration is to try to amplify the biological signal to noise ratio in scRNA-seq data so that downstream analysis can more easily identify gene expression patterns of interest. We hypothesised that it may be possible to obtain a higher resolution of gene expression dynamics in scRNA-seq data through improved feature (gene) selection. We sought to evaluate whether improved feature selection in isolation could increase the biological signal to noise ratio in scRNA-seq data in a manner that mitigates or removes the need for further counts matrix processing via feature extraction, data smoothing or batch integration. A key benefit of reducing the usage of data augmenting processes is that we may be more confident that patterns identified in further downstream analysis are not present due to the introduction of computational artefacts.</p><p id="P15">We recently outlined a mathematical framework termed Entropy Sorting (ES), and incorporated it into two software packages, Functional Feature Amplification Via Entropy Sorting (FFAVES) and Entropy Sort Feature Weighting (ESFW) (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). Together FFAVES and ESFW seek to identify genes that are highly structured within the data and hence are more more likely to be predictive of cell identity. Gene selection using these tools exposed the hitherto ambiguous Inner Cell Mass (ICM) population in human pre-implantation embryo data (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). However, FFAVES and ESFW operate on binarised data such that genes are considered active or inactive in individual cells. Abstracting the data in such a way meant that FFAVES was used to correct sub-optimal gene discretisation, prior to the application of ESFW which assigned feature importance weights. The ESFW weights were then used to select for a subset of all the genes in the data that are more informative of cell identity, in a similar manner to HVG selection. Here, we update ES so that it can be applied to continuous data. We formulate this into a new software package, continuous Entropy Sort Feature Weighting (cESFW) and outline a workflow that utilises cESFW to perform feature selection on scRNA-seq counts matrices. We validate cESFW on synthetic data and then apply the cESFW workflow to human embryo scRNA-seq datasets, achieving high resolution of cell types and developmental trajectories without augmentation or smoothing of the original data. Our analysis provides clear evidence of the existence of the two step model (<xref ref-type="bibr" rid="R7">Cockburn and Rossant 2010</xref>) in early human embryo development by elucidating branch points from morula to ICM or TE, and ICM to epiblast (Epi) or hypoblast (Hyp).</p><p id="P16">These findings demonstrate that cESFW can reveal gene expression states and transitions in scRNA-seq data that were previously unobservable through conventional data analysis techniques.</p></sec><sec id="S2" sec-type="results"><label>2</label><title>Results</title><sec id="S3"><title>Proposed cESFW feature selection workflow for scRNA-seq data</title><p id="P17">Data analysis packages such as Seurat/Scanpy/Scran usually involve multiple steps (<xref ref-type="fig" rid="F1">Fig 1</xref>). Many of these steps alter the values in the original counts matrix. For example, HVG selection is highlighted in green because although it reduces the size of the counts matrix by subsetting it down to a smaller set of genes, none of the expression values within the matrix are changed. Conversely, PCA and batch correction methods are highlighted in red because they augment the scRNA-seq counts matrix before passing the data onto the next step of analysis, and hence have a higher potential to introduce spurious computational artefacts.</p><p id="P18">As an alternative to conventional workflows, we propose cESFW (<xref ref-type="fig" rid="F1">Fig 1</xref>). This workflow facilitates unsupervised gene importance weighting that more robustly identifies genes indicative of cell type than HVG selection. Below we demonstrate that the cESFW gene selection methodology leads to improved downstream analysis, without the need to change any of the expression values in the original counts matrix. This reduces the potential for computational artefacts to be introduced into the analysis of a scRNA-seq dataset compared to Seurat/Scanpy/Scran workflows. A key difference between cESFW and our previous approach, ESFW (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>), is that cESFW can be applied to data with continuous values, whereas ESFW could only be applied to data with binarised values. For a description of how ESFW was adapted into cESFW see <xref ref-type="supplementary-material" rid="SD2">SI 1</xref>, and for a detailed breakdown of each step of our cESFW workflow, see <xref ref-type="sec" rid="S23">MATERIALS AND METHODS</xref>.</p></sec><sec id="S4"><title>cESFW robustly discriminates between significant and non-significant gene correlation signals</title><p id="P19">The foundation of the cESFW workflow is the use of cESFW to perform feature selection in place of HVG feature selection. Both cESFW and HVG feature selection aim to take a high dimensional scRNA-seq dataset and subset it down to a set of genes that are believed to be more informative of cellular identity than the entire gene set. We used synthetic data to perform a side by side analysis of cESFW and the HVG implementations of Scran and Seurat. The Scanpy protocol was excluded because rather than providing a ranked list of genes, Scanpy provides a true/false index for selected HVGs, making it difficult to quantify performance.</p><p id="P20">We used Dyngen (<xref ref-type="bibr" rid="R5">Cannoodt et al. 2021</xref>) to create 4 synthetic datasets (SD) with known ground truths as to which genes relate to cell type specific transcription factor (TF) networks and which are part of ubiquitous housekeeping (HK) gene networks. Dyngen generates synthetic scRNA-seq data by simulating empirically derived gene regulatory networks (GRNs), while allowing control over the size and shape of the generated data. We generated 4 synthetic datasets (<xref ref-type="fig" rid="F2">Fig 2A</xref>). The column labeled “High housekeeping gene expression” refers to a property of Dyngen such that at different random seeds, the average expression of the simulated genes can vary significantly. We took advantage of this to intentionally find random seeds that generated data where either the house keeping (HK) genes had comparable expression levels to the TFs (High housekeeping gene expression = No) or the HK genes had relatively high expression levels compared to the TFs (High housekeeping gene expression = Yes). For example, the average non-zero expression of SD3 TFs and HKs are 9.75 and 1.26 respectively, whereas for SD4 they are 1.74 and 115 respectively. We introduced this layer of analysis because previous evaluations of HVG selection methods have highlighted that the gene selection processes can be biased towards genes that have higher mean expression (<xref ref-type="bibr" rid="R41">Yip, Sham, and Wang 2019</xref>). The effect of highly expressed HK genes are shown in <xref ref-type="fig" rid="F2">Figures 2B and C</xref>. In <xref ref-type="fig" rid="F2">Fig 2B</xref> the UMAP generated for SD4 using just the TFs shows the expected branching trajectories, whereas in <xref ref-type="fig" rid="F2">Fig 2C</xref>, including the HK genes for UMAP generation obscures the branching gene expression dynamics.</p><p id="P21">Dyngen allows us to differentiate between genes informative of cell type (TFs) and ubiquitously expressed genes (HKs). We used this to quantify the performance of the ranked gene lists generated by cESFW, Scran and Seurat using receiver operating characteristic (ROC) and Precision-Recall (PR) curves (<xref ref-type="bibr" rid="R11">Grau, Grosse, and Keilwagen 2015</xref>). For this analysis, the area under (AU) the ROC and PR curves give scores between 0 and 1, where 1 means that the feature selection method is perfect at discriminating between cell type informative TF genes and non-informative HK genes. We show both the ROC and PR curves because ROC is more readily comparable across datasets, whereas PR provides a comparable metric of method performance that is more sensitive to class imbalance (many more HK genes compared to TF genes). <xref ref-type="fig" rid="F2">Figures 2D and E</xref> show the AUROC and PR curves respectively for SD4. In both cases, the area under the blue cESFW curve is largest, indicating that cESFW outperforms Scran or Seurat at ranking TFs as more informative of cell identity than HKs. For SD1 we find that, although cESFW outperforms Seurat and Scran on the AUROC curve, it has the lowest performance on the PR curve (<xref ref-type="supplementary-material" rid="SD2">Fig S1C and D</xref>). The results of all the ROC and PR curves are summarised in <xref ref-type="fig" rid="F2">Fig 2F-H</xref>. The AUROC scores of cESFW are higher than Scran and Seurat on all 4 synthetic datasets (<xref ref-type="fig" rid="F2">Fig 2F</xref>). High AUROC scores can be thought of as enriching highly ranked genes with genes that are indicative of cell type.</p><p id="P22">Although cESFW does not have the highest PR-AUCs score for SD 1 and 3 (<xref ref-type="fig" rid="F2">Fig 2G</xref>), we note that the drop in PR-AUCs compared to SD 2 and 4 is relatively small compared to Scran and Seurat. Since SD 2 and 4 are the datasets where HK gene expression is relatively high compared to TF expression, this reinforces previous findings that HVG selection can be biased towards highly expressed genes (<xref ref-type="bibr" rid="R41">Yip, Sham, and Wang 2019</xref>). Hence, the results in <xref ref-type="fig" rid="F2">Fig 2G</xref> suggest that cESFW is less sensitive to the presence of highly expressed genes than HVG selection methods.</p><p id="P23">These results on 4 independent synthetic datasets show that cESFW can provide more robust feature selection than HVG selection.</p><sec id="S5"><title>cESFW helps reveal high resolution gene expression dynamics in the early human embryo</title><p id="P24">We next incorporated cESFW into the proposed workflow (<xref ref-type="fig" rid="F1">Fig 1</xref>, right hand column) and applied it to 6 merged independent scRNA-seq datasets of early human embryo development (<xref ref-type="bibr" rid="R37">Yan et al. 2013</xref>; <xref ref-type="bibr" rid="R9">Fogarty et al. 2017</xref>; <xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref>; <xref ref-type="bibr" rid="R38">Yanagida et al. 2021</xref>; <xref ref-type="bibr" rid="R20">Meistermann et al. 2021</xref>; <xref ref-type="bibr" rid="R35">Xiang et al. 2020</xref>). These datasets have previously been characterised (<xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref>; <xref ref-type="bibr" rid="R29">Giuliano G. Stirparo et al. 2018</xref>; <xref ref-type="bibr" rid="R20">Meistermann et al. 2021</xref>; <xref ref-type="bibr" rid="R27">M. Singh et al. 2023</xref>; <xref ref-type="bibr" rid="R34">Wei et al. 2023</xref>), and there is a foundation of experimental knowledge defining the expected distinct cell types and stages.</p></sec><sec id="S6"><title>Generation of a high resolution day 3-14 human embryo UMAP</title><p id="P25">The cESFW workflow identified a set of 3012 genes. For details and code see <xref ref-type="sec" rid="S23">MATERIALS AND METHODS</xref>. Gene set enrichment analysis found gene ontology (GO) terms relating to regulation and development (<xref ref-type="supplementary-material" rid="SD2">Fig S10B</xref>). Using this gene set we obtained a smooth, high resolution UMAP embedding (<xref ref-type="supplementary-material" rid="SD2">Fig S2A</xref>). Importantly, the UMAP embedding was generated by simply sub-setting down to the 3012 cESFW workflow genes, without any data augmentation or smoothing. The observed structure should therefore reflect biologically significant gene expression patterns, free of computational artefacts that may be introduced through conventional scRNA-seq counts matrix processing workflows (<xref ref-type="fig" rid="F1">Fig 1</xref>, left hand column).</p><p id="P26">The UMAP clearly displays continuous progression along the developmental time course. Cells from the 5 pre-implantation embryo datasets are intermingled across the UMAP space, indicating minimal contribution of batch effects (<xref ref-type="supplementary-material" rid="SD2">Fig S2B</xref>). Cells from the post-implantation extended culture samples (<xref ref-type="bibr" rid="R35">Xiang et al. 2020</xref>) form groups adjacent to distinct regions of pre-implantation cells, indicating that related gene expression patterns have been identified across the pre- and post-implantation datasets.</p><p id="P27">We performed unsupervised agglomerative clustering on the scRNA-seq counts matrix subset down to the 3012 cESFW genes. Overlaying these clusters onto the UMAP embedding (<xref ref-type="supplementary-material" rid="SD2">Fig S2A</xref>) provides an unsupervised foundation to label samples with 15 distinct cell type/stage annotations (<xref ref-type="fig" rid="F3">Fig 3C</xref>, <xref ref-type="supplementary-material" rid="SD2">Fig S2B, C</xref>). Comparison with annotations from previous studies (<xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref>; <xref ref-type="bibr" rid="R29">Giuliano G. Stirparo et al. 2018</xref>) corroborated our annotations and UMAP embedding (<xref ref-type="supplementary-material" rid="SD1">Fig S2D, E</xref>). Notably, the unsupervised clusters were readily annotated, whereas previous annotations were generated through supervised analysis focused on a handful of candidate marker genes. A gene expression heatmap of the cESFW genes grouped by our 15 cell type annotations shows cell type specific gene expression profiles (<xref ref-type="fig" rid="F3">Fig 3D</xref>). Genes implicated in the literature to correspond with 13 of our cell type annotations are represented in the 3012 cESFW gene set (<xref ref-type="bibr" rid="R7">Cockburn and Rossant 2010</xref>; <xref ref-type="bibr" rid="R32">Taubenschmid-Stowers et al. 2022</xref>; <xref ref-type="bibr" rid="R29">Giuliano G. Stirparo et al. 2018</xref>; <xref ref-type="bibr" rid="R27">M. Singh et al. 2023</xref>; <xref ref-type="bibr" rid="R8">Corujo-Simon, A. H. Radley, and Nichols 2023</xref>; <xref ref-type="bibr" rid="R17">Liu et al. 2022</xref>; <xref ref-type="bibr" rid="R43">Zadora et al. 2017</xref>; <xref ref-type="bibr" rid="R42">Yue et al. 2020</xref>; <xref ref-type="bibr" rid="R36">Yabe et al. 2016</xref>; <xref ref-type="bibr" rid="R39">Yang et al. 2021</xref>). Such genes show specific gene expression in the UMAP embedding (<xref ref-type="fig" rid="F3">Fig 3E</xref>, <xref ref-type="fig" rid="F5">Fig 5A</xref> <xref ref-type="supplementary-material" rid="SD2">Fig S3</xref>). Mural trophectoderm (TE) lacks validated specific markers but is known to express HAND1 (<xref ref-type="bibr" rid="R17">Liu et al. 2022</xref>). Although HAND1 is not captured in the cESFW gene set, it shows relatively specific day 6/7 Mural TE expression on our UMAP embedding <xref ref-type="supplementary-material" rid="SD2">Fig S3</xref>).</p><p id="P28">Visualisation of chronological embryo progression with gene expression patterns consistent with the literature demonstrates that the cESFW workflow identifies a set of genes that is highly descriptive of the transcriptional landscape of day 3-14 developing human early embryos.</p></sec><sec id="S7"><title>Feature selection via cESFW outperforms HVG selection</title><p id="P29">To compare the performance of cESFW with the popular Scran and Seurat workflows using the same input data, we identified the 3012 top ranked genes for each technique.</p><p id="P30">Previous studies comparing HVG selection methods have shown that there is often poor concordance between gene sets selected by different methods (<xref ref-type="bibr" rid="R41">Yip, Sham, and Wang 2019</xref>). Intersecting the sets of 3012 genes from the cESFW, Scran and Seurat workflows, we find only 290/3012 (9.63%) of the genes are common to all 3 gene sets (<xref ref-type="supplementary-material" rid="SD2">Fig S4A</xref>).</p><p id="P31">UMAPs generated using the Scran and Seurat HVGs were able to broadly separate samples by their embryo time points, but did not provide a smooth embedding with a coherent progression of cell types and developmental trajectories (<xref ref-type="supplementary-material" rid="SD2">Fig S4C, D</xref>).</p><p id="P32">We used silhouette scores to quantify how well each of the 3012 gene sets formed distinct clusters of samples, using our UMAP cell type annotations (<xref ref-type="fig" rid="F3">Fig 3C</xref>) as cluster labels. Silhouette scores measure how similar samples are to their designated clusters, with positive scores indicating samples are most similar to the cluster they are a member of, and negative scores designating samples that would be better assigned to a different cluster. The average of the silhouette scores for all samples within a cluster then quantifies the quality of the cluster as whole. The cESFW genes produced higher silhouette scores than the Seurat or Scran gene sets for 14 out of the 15 clusters with similar scores for ICM (<xref ref-type="supplementary-material" rid="SD2">Fig S4B</xref>). Notably the Epi/Hyp branch, Hyp and Mid TE score positive with cESFW but have negative silhouette scores using HVG, signifying that the HVG gene sets are unable to identify these cell types as distinct from other cells in the data.</p><p id="P33">These results show qualitatively and quantitatively that cESFW gene selection outperforms popular HVG selection workflows on these human embryo scRNA-seq data and help explain why the UMAP generated using the 3012 cESFW gene set is able to readily separate known cell types from one another.</p></sec></sec><sec id="S8"><title>Lineage branching blastocyst development</title><p id="P34">The textbook model of blastocyst formation derived from studies in the mouse embryo entails sequential lineage bifurcations that generate first trophectoderm (TE) and inner cell mass (ICM), and then hypoblast (Hyp) and epiblast (Epi) (<xref ref-type="bibr" rid="R7">Cockburn and Rossant 2010</xref>). However, the existence of two branch points in human embryogenesis has been questioned in previous analyses of scRNA-seq data (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). More recent studies have proposed two bifurcations, but have not demonstrated separate branch point populations (<xref ref-type="bibr" rid="R38">Yanagida et al. 2021</xref>; <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>; <xref ref-type="bibr" rid="R34">Wei et al. 2023</xref>).</p><p id="P35">The cESFW embedding unambiguously reveals two binary branch points in pre-implantation embryogenesis; from morula to ICM or early TE, and from ICM to Epi or Hyp.</p><p id="P36">Furthermore, unsupervised clustering identifies populations of cells at these intersections which we labeled ICM/TE and Epi/Hyp branch cells, respectively (<xref ref-type="fig" rid="F3">Fig 3A</xref>). Silhouette scores quantify both as distinct groups of cells according to transcriptional profile (<xref ref-type="supplementary-material" rid="SD2">Fig S4B</xref>). To examine the inferred lineage trajectories we performed RNA velocity analysis (<xref ref-type="bibr" rid="R4">Bergen et al. 2020</xref>) (<xref ref-type="fig" rid="F4">Fig 4D</xref>). The RNA velocity vectors are aligned well with temporal ordering and lineage divergence across the embedding (<xref ref-type="fig" rid="F4">Fig 4B</xref>). Notably, RNA velocities show a progression of morula samples towards the ICM/TE branch cells, which then diverge either towards the ICM or to early TE.</p><p id="P37">In <xref ref-type="fig" rid="F4">Fig 4E</xref>, we use our UMAP and ranked gene list (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>) to highlight 3 genes that show relatively specific upregulation within the ICM/TE branch population.</p><p id="P38">In a recent publication, <xref ref-type="bibr" rid="R27">M. Singh et al. 2023</xref> re-analysed the <xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref> human embryo scRNA-seq dataset and found a distinct and previously undescribed group of day 4/5 cells. However these authors were unable to place this cluster in a chronological differentiation trajectory and noted upregulation of several proposed apoptosis markers, leading them to hypothesise that this group of cells had accumulated DNA damage and was fated to apoptose. They therefore refer to them as “REject” cells. However, when we inspected the REject cells in the cEFSW embedding we found that they do not constitute a separate cluster, but were almost entirely within the ICM/TE branch (<xref ref-type="fig" rid="F4">Fig 4C</xref>). We therefore investigated the markers suggested to indicate that the REject cells are pre-apoptotic. We found that most of these genes are expressed equally highly elsewhere in the developing human embryo, suggesting either that they are not strong discriminators of pre-apoptotic versus non-apoptotic cells, or that apoptosis is distributed across cell types (<xref ref-type="supplementary-material" rid="SD2">Fig S5</xref>). For example, although suggested apoptosis markers BIK, ATG2A and ATF3 are up-regulated in the ICM/TE branch when compared against the early TE, ICM, preIm-Epi and Hyp populations, these 3 genes are more highly expressed in the 8-cell and/or morula populations (<xref ref-type="supplementary-material" rid="SD2">Fig S5B</xref>). In a similar vein, BAK1, CTSB and CASP6 were suggested as apoptotic markers specific to the REject population, but we find these genes to be broadly expressed across several cell types of day 3-14 human embryos (<xref ref-type="supplementary-material" rid="SD2">Fig S5C</xref>). Thus, we do not find strong indications that the proposed REject cells are specifically fated for apoptosis.</p><p id="P39">Overall, these findings substantiate the occurrence of an initial lineage bifurcation between TE and ICM on day 4/day 5 that precedes segregation of ICM to hypoblast and epiblast between day 5 and day 6.</p></sec><sec id="S9"><title>Comparison of human pluripotent stem cell cultures to reference human embryo scRNA-seq embedding</title><p id="P40">Human pluripotent stem cells (PSCs) are generally considered to be analogues of the pluripotent lineage in the embryo, the epiblast. However, PSCs exist in different states that are propagated in distinct signaling environments (<xref ref-type="bibr" rid="R28">Smith 2017</xref>; <xref ref-type="bibr" rid="R23">Nichols and Smith 2009</xref>). Correlation of PSCs with developmental stages of epiblast in the human embryo has been problematic due to the scarcity of relevant data, and the limited resolution provided by previous analysis methods. We took the opportunity provided by our high-resolution embedding to re-evaluate the transcriptome relatedness of various cultures of human PSCs to cell types in the day 3-14 embryo, highlighting pre- and post-implantation epiblast (<xref ref-type="fig" rid="F5">Fig 5A</xref>, <xref ref-type="supplementary-material" rid="SD2">Fig S3</xref>).</p><p id="P41">We examined published scRNA-seq datasets from conventional primed PSCs and cells in two naïve culture conditions (PXGL (<xref ref-type="bibr" rid="R13">Guo, Giuliano Giuseppe Stirparo, et al. 2021</xref>) and its predecessor t2iLGö (<xref ref-type="bibr" rid="R21">Messmer et al. 2019</xref>)). We also assessed data for expanded potential stem cells (EPSCs), originally suggested to be related to the 8-cell stage (<xref ref-type="bibr" rid="R10">Gao et al. 2019</xref>). We used the <italic>umap.transform</italic> function of the Python UMAP package (<xref ref-type="bibr" rid="R19">McInnes et al. 2018</xref>) to map the query cells from the PSC cultures onto our reference human embryo UMAP. This method places individual query samples closest to their most transcriptionally similar counterparts in the UMAP in an unsupervised manner based on all 3012 cESFW genes. <xref ref-type="fig" rid="F5">Figure 5B</xref> shows the projections of individual cells from the query scRNA-seq datasets onto the embedding. Conventional primed PSCs are placed in the vicinity of the d10-14 embryonic disk epiblast. EPSCs are similarly positioned close to post-implantation epiblast with &lt; 2% of cells adjacent to earlier stages. These findings are consistent with previous comparative analyses with non-human primate embryos (<xref ref-type="bibr" rid="R13">Guo, Giuliano Giuseppe Stirparo, et al. 2021</xref>; <xref ref-type="bibr" rid="R22">Nakamura et al. 2017</xref>). In contrast, naïve PSCs overlie pre-implantation epiblast (d6-7). Notably cells in PXGL (<xref ref-type="bibr" rid="R12">Guo, Meyenn, et al. 2017</xref>) are more homogeneous than cells in t2iLGö (<xref ref-type="bibr" rid="R30">Takashima et al. 2014</xref>). Quantification using a k-nearest neighbour classifier trained on the embryo cell type annotations (<xref ref-type="fig" rid="F5">Fig 5C</xref>) assigns 97% of PXGL cells to pre-implantation epiblast compared with 77% for t2iLGö.</p><p id="P42">We also evaluated published data for recently reported 4CL and e4CL cells that are proposed to be related to d5 ICM and 8-cell stages (<xref ref-type="bibr" rid="R18">Mazid et al. 2022</xref>). These samples are more heterogeneous than other PSC cultures. They comprise pre-implantation epiblast-like proportions of 48% for 4CL and 60% for e4CL. A substantial fraction (39%) of 4CL cells are post-implantation epiblast-like while many e4CL cells are positioned between pre- and post-implantation epiblast, indicating either an indeterminate mixed identity or potentially transitioning between states. e4CL cultures contain only 5% of cells which are related to d5 ICM and 5% of cells related to the 8-cell embryo.</p></sec><sec id="S10"><title>Identifying naïve and primed hPSC markers</title><p id="P43">Previous studies have identified gene markers for naïve and primed hPSCs by examining differential expression between these two PSC types specifically. We sought to characterise markers in the context of the entire day 3-14 human embryo. We started by taking the top 3 naïve versus primed PSC markers identified by <xref ref-type="bibr" rid="R21">Messmer et al. 2019</xref> and plotted them on our UMAP embedding (<xref ref-type="supplementary-material" rid="SD2">Fig S6</xref>). We saw that although these 6 markers were clearly up/down-regulated between the preImp-Epi and embryonic disc samples, for 5 out of the 6 genes the up/down-regulation is not restricted to epiblast lineage. In contrast, the top 3 ranked genes for our UMAP annotated preImp-Epi and embryonic disc cell types (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>, <xref ref-type="fig" rid="F3">Fig 3C</xref>), show more restricted expression to the preImp-Epi or embryonic disc regions (<xref ref-type="supplementary-material" rid="SD2">Fig S6</xref>).</p><p id="P44">We then proceeded to use our rank gene lists to identify genes that showed specific up-regulation in the preImp-Epi or embryonic disc, while also showing differential expression in naïve versus conventional hPSCs. In <xref ref-type="fig" rid="F5">Fig 5D</xref> we present a heatmap of 8 naïve and 8 primed marker genes that have consistent cell type specific differential expression across the cell line datasets, and in our reference human embryo embedding. We also note that in this heatmap, the 4CL cells show upregulation of both naïve and primed markers, consistent with our previous observation that this culture condition displays mixed identity (<xref ref-type="fig" rid="F5">Fig 5B, C</xref>).</p><p id="P45">This analysis of naïve, primed and EPSC stem cells from different research groups demonstrates how access to an unbiased view of the early human embryo can facilitate classification of in vitro cell cultures. Furthermore, we show that taking a more holistic approach to cell type marker identification can provide more specific cell type marker genes.</p></sec><sec id="S11"><title>Emergence of epiblast, hypoblast and trophectoderm signatures during blastocyst formation</title><p id="P46">Between days 3 and 7 post fertilisation, the morula of the human embryo develops into the blastocyst, comprising three distinct lineages, Epi, Hyp and TE. We sought to use the cESFW embedding to identify genes that may be useful markers for staging cell identities during blastocyst formation.</p><p id="P47">The Entropy Sort Score (ESS), is a correlation metric derived from Entropy Sorting (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). A potential benefit of the ESS for gene ranking compared to other typical methods such as the t-test or Wilcoxon test is that the ESS was specifically derived to reduce whenever gene expression is observed outside of a specific population of interest. Therefore, when there are multiple cell types within a dataset, the ESS can be better suited for identifying regions of specific gene expression, as opposed to more general up/down regulation. Using the ESS we rank genes by how well their expression profiles overlap with the Epi, Hyp or TE morula to blastocyst trajectories, while also progressively restricting the analysis to the terminal Epi, Hyp or TE populations. For examples and details regarding this progressive restriction, see <xref ref-type="supplementary-material" rid="SD2">Fig S7</xref> and EXPERIMENTAL PROCEDURES.</p><p id="P48">In <xref ref-type="fig" rid="F6">Figures 6A-C</xref> we present heatmaps highlighting sets of genes that show sequential up-regulation as the morula differentiates into Epi (A), Hyp (B) or TE (C). Day 7 TE comprises both mural and polar TE. <xref ref-type="fig" rid="F6">Figures 6D-F</xref> and <xref ref-type="supplementary-material" rid="SD2">Fig S7</xref> show example genes with specific up-regulation along each trajectory. For example during the emergence of TE cells during blastocyst formation, SLC28A3 (<xref ref-type="fig" rid="F6">Figures 6F</xref>) is first upregualted in the morula and maintains expression until day 7 TE, whilst being downregulated in the ICM, Epi and Hyp lineages. Conversely, the TE marker HAPLN1 (<xref ref-type="supplementary-material" rid="SD2">Fig S7B</xref>) is upregulated later than SLC28A3 at around day 6 and is maintained in day 7 of TE.</p><p id="P49">These findings illustrate how ES and our UMAP embedding can be used to identify new gene expression patterns that may aid future experiments and analyses.</p></sec></sec><sec id="S12" sec-type="discussion"><label>3</label><title>Discussion</title><p id="P50">In this work, we introduced cESFW, a feature selection method designed for distinguishing between cell state informative and uninformative genes in high dimensional scRNA-seq data. A key ethos of the cESFW workflow is that the final scRNA-seq counts matrix does not have its values changed in any way. We show that using cESFW to subset down to a set of informative genes is not only sufficient to identify dynamic gene expression states, but can outperform more complex methods that augment the values of the counts matrix. These findings challenge the view that scRNA-seq data is inherently too noisy to identify high resolution gene expression dynamics without repairing, smoothing, or transforming the data first.</p><p id="P51">On synthetic scRNA-seq data we found that cESFW performs comparably or better than conventional HVG selection. Whereas HVG selection is particularly sensitive to the presence of highly expressed genes (<xref ref-type="bibr" rid="R41">Yip, Sham, and Wang 2019</xref>), which lead to a significant drop in ability to distinguish between cell type specific genes and housekeeping genes, cESFW is relatively agnostic to the presence of genes with high mean expression, with a minimal drop in performance. Less influence of expression level when ranking gene importance may be a significant contributor to cESFW’s superior performance on biological data, since evidence is lacking that more highly expressed genes are generally more discriminatory of cellular identity. In addition, the multivariate approach of cESFW may be more robust than univariate HVG feature selection. In the univariate approach, genes are considered in isolation, leading to their importance ranking being more sensitive to fluctuations in properties such as mean expression. cESFW, in contrast, considers pairwise the expression profile of an inspected gene with every other gene in the data, and generates a gene importance weight by quantifying the degree to which the inspected gene forms networks of significantly co-expressing genes.</p><p id="P52">Applying our cESFW workflow to early human embryo scRNA-seq data generates a high resolution UMAP embedding of different cell types, trajectories and branch points in the developing embryo. Our cell type annotations formed quantifiably more distinct clusters when using top rank genes selected by cESFW compared to the top ranked genes from conventional HVG selection. Furthermore, we observe coherent dataset integration without having to apply batch correction methods as in previous analyses (<xref ref-type="bibr" rid="R20">Meistermann et al. 2021</xref>; <xref ref-type="bibr" rid="R34">Wei et al. 2023</xref>). We propose that cESFW achieves good integration of datasets from different sources because improved feature selection tips the biological signal to noise ratio in favour of the biologically relevant expression profiles in the data. Thus, cell similarity metrics may be less affected by confounding gene expression signals</p><p id="P53">Our high resolution map of the early human embryo transcriptome allowed us to substantiate the existence of two distinct branching populations, at the intersections of morula with ICM and TE, and of ICM with epiblast and hypoblast. Their identification and the general topology of the cESFW embedding indicate that human embryogenesis proceeds via the sequence of lineage bifurcations demonstrated in the mouse embryo (<xref ref-type="bibr" rid="R7">Cockburn and Rossant 2010</xref>). The branching populations reside at critical junctures in blastocyst formation, the partitioning of extraembryonic and embryonic lineages. Cells in these clusters become specified to alternative fates but may not be committed. For example, PDGFRA has been implicated as a hypoblast marker (<xref ref-type="bibr" rid="R8">Corujo-Simon, A. H. Radley, and Nichols 2023</xref>), whereas NANOG has been demonstrated as an epiblast marker (<xref ref-type="bibr" rid="R1">Allègre et al. 2022</xref>), yet both markers are heterogeneous in Epi/Hyp branching population. Notably the cluster boundaries extend beyond the topological branch point, which may indicate that cells remain plastic and could be respecified. Further analytical and experimental studies may focus on heterogeneity and gene expression dynamics in these populations to expose the process of lineage choice and commitment.</p><p id="P54">We also noted that the ICM/TE branch population includes cells previously unannotated and therefore conjectured to be rejected from embryo development. Those cells do express various markers of a pre-apoptotic state, but so do other cells throughout the data. Quantitative immunostaining analyses are needed to reveal if there is a consistently higher frequency of in the embryo.</p><p id="P55">We used the cESFW gene set and embedding as a reference point to evaluate the identity of various hPSC cultures. Quantifying proportional relatedness of cell lines to embryo populations, confirmed that conventional hPSCs and EPSCs are most related to post-implantation embryonic disc while naïve PSCs are similar to pre-implantation epiblast. This analysis also demonstrated that PXGL naïve PSCs have a very high (97%) representation of pre-implantation epiblast-like cells.</p><p id="P56">Finally, we used ESSs and our UMAP embedding to suggest sets of genes that may aid cell type staging during days 3-7 of lineage progression during human blastocyst formation. Immunostaining will be of interest to assess protein expression dynamics for these genes.</p><p id="P57">To conclude, this study demonstrates that cESFW, an algorithm derived from the mathematical framework of ES, has the ability to reveal gene expression dynamics in scRNA-seq data that were previously unobservable. Our characterisation of early human embryo scRNA-seq data has provided ranked gene lists for multiple cell types and a high resolution UMAP embedding. We provide a proposed workflow for incorporating cESFW into general scRNA-seq analysis. We envisage that the cESFW technique and workflow will readily be adapted and improved for application to datasets of varying complexity and type, such as multi-omics or spatial transcriptomics studies.</p></sec><sec id="S13"><label>4</label><title>Limitations of the study</title><p id="P58">The benefits of improved feature selection through cESFW, do not preclude the use of other data analysis techniques such as batch integration and data repair. We suggest that more accurate feature selection has the potential to further improve results of all downstream steps. We anticipate that researchers will create adaptations of our proposed cESFW workflow that incorporate a range of data analysis methodologies.</p><p id="P59">We expect that as more embryo scRNA-seq datasets become publicly available, re-analysis should yield greater resolution. A higher density of samples from day 4-6 embryos will be particular value for better delineation of ICM progression lineage branch points. Further data from extended cultures will enable greater resolution of embryonic disc progression and emergence of extraembryonic mesenchyme and amnion.</p><p id="P60">The genes we have highlighted for staging of cells during blastocyst formation were picked through semi-supervised analysis. The initial gene sets were curated from ranked gene lists output based on the ESS. However, the final sets of selected genes were subject to manual inspection of the top 30 ESS ranked genes, and genes that appeared to be poorly expressed in the cell populations of interest were manually excluded. Therefore the presented gene sets may be incomplete.</p></sec><sec id="S14" sec-type="methods"><label>5</label><title>Experimental Procedures</title><sec id="S15"><title>Synthetic data generation</title><p id="P61">The 4 synthetic datasets used in this study were generated using the Dyngen software (<xref ref-type="bibr" rid="R5">Cannoodt et al. 2021</xref>). Synthetic dataset size and shapes were all controlled using out of box Dyngen functions.</p></sec><sec id="S16"><title>UMAPs</title><p id="P62">For consistency, or all UMAPs presented in this work were created with the Python <italic>umap-learn</italic> package, with <italic>n_neighbors</italic> and <italic>min_dist</italic> set to 50 and 0.1 respectively. The correlation distance metric was used instead of the default euclidean distance metric.</p><p id="P63">All UMAPs displaying gene expression profiles show the <italic>log</italic><sub>2</sub> normalised gene expression. No data smoothing or clipping were applied.</p></sec><sec id="S17"><title>Unsupervised clustering</title><p id="P64">Unsupervised clustering of scRNA-seq embryo data (<xref ref-type="supplementary-material" rid="SD2">Fig S2A</xref>) was performed using the Python package, <italic>sklearn.cluster. AgglomerativeClustering</italic>, with <italic>k</italic> = 30 clusters and the correlation distance metric.</p></sec><sec id="S18"><title>Gene marker identification</title><p id="P65">Identification of markers for UMAP plotting and our ranked gene list (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>) was performed by using the Entropy Sort Score (ESS) correlation metric to rank genes that are enriched to a cell type or cell types of interest. For details see <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>, and for examples see the workflows provided alongside this paper.</p></sec><sec id="S19"><title>RNA velocity</title><p id="P66">RNA velocity was carried out using the scVelo (<xref ref-type="bibr" rid="R4">Bergen et al. 2020</xref>) with default parameters, expect for the cell nearest neighbour matrix, which we manually substituted with the cell nearest neighbour matrix according to the 3012 cESFW genes and the correlation distance metric.</p></sec><sec id="S20"><title>Query cell classification</title><p id="P67">Query scRNA-seq samples were transformed onto our UMAP embedding using the out of box <italic>umap.transform</italic> function. After query samples are placed on the UMAP embedding, we may predict their cell type in the low dimensional UMAP space.</p><p id="P68">To predict cell identity, we used the <italic>sklearn.neighbors. KNeighborsClassifier</italic> Python function. A knn classifier was trained using our UMAP embedding and cell type annotations. The number of neighbours used to train the classifier was 20. The trained classifier was then applied to the query samples to get their predicted cell identities.</p></sec><sec id="S21"><title>Lineage emergence during blastocyst formation</title><p id="P69">To identify the emergence of Epi, Hyp and TE gene expression profiles during human blastocyst formation, we used the ESS to rank genes by how well their expression profiles overlap with the morula to Epi, Hyp or TE trajectories, and then progressively restricted the late blastocyst Epi, Hyp or TE populations. As an example, to identify Epi staging genes, we started by ranking genes based on their enrichment in the combined morula, ICM/TE branch, ICM and preImp-epi samples from our cell UMAP annotations (<xref ref-type="fig" rid="F4">Fig 4A</xref>). This was followed by ranking against the combined ICM/TE branch, ICM and preImp-Epi population, and then by the combined ICM and preImp-Epi samples, and finally the preImp-Epi samples in isolation (<xref ref-type="supplementary-material" rid="SD2">Fig S7A</xref>). A similar process was repeated for the Hyp and TE trajectories. For each ranked gene list generated, we inspected the top 30 ranked genes and manually confirmed the gene expression profile using the UMAP embedding. Through this process we were able to identify sets of genes that delineate the emergence of Epi, Hyp and TE lineages from the morula progenitor population.</p></sec></sec><sec id="S22" sec-type="materials | methods" specific-use="web-only"><label>6</label><title>Materials and Methods</title><sec id="S23"><title>From discrete data Entropy Sorting to continuous data Entropy Sorting</title><p id="P70">A key distinction between the ESFW algorithm outlined in our previous work (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>) and the cESFW algorithm presented in this work is that cESFW updates the theory behind ES so that it can be readily applied to continuous data. For a detailed explanation of how ES has been adapted for continuous data, see <xref ref-type="supplementary-material" rid="SD2">SI 1</xref>.</p></sec><sec id="S24"><title>A fifth entropy sorting error scenario</title><p id="P71">In addition to expanding the ES framework so that it may be applied to continuous data, we also introduce a fifth error scenario where ES ‘divergence can be observed through the ES parabola in a manner that indicates that samples may be displaying false negative (FN) expression levels. We present this new error scenario in <xref ref-type="supplementary-material" rid="SD2">Fig S8</xref> (black box), alongside the 4 maximum entropy error scenarios introduced in our previous manuscript (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). The error scenarios are important because they provide implicit logic that determines how we calculate divergence and error potential for any pair of features.</p><p id="P72">As an example, in our newly proposed fifth error scenario, there are two features being compared against one another. The top feature (blue and red) is denoted the RF and the bottom feature (green and purple) is denoted the query feature (QF), because according to the maximum entropy principle, the QF should always be the feature with the larger cardinality for it’s observed minority state (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>). For this pair of features, we see a strong but imperfect conditional relationship between the co-occurrence of ground truth (absent of X symbols) RF and QF minority states. However, the presence of RF majority states overlapping with QF minority states introduces uncertainty into the system, which manifests as a non-zero conditional entropy between the two features. Hence, we can hypothesise that the samples diverging from the ground truth (indicated by the blue X’s) are either real, or are present due to the introduction of erroneous data points. This allows us to set up a hypothesis test, which we introduce in <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref> as the ES hypothesis test. The ES hypothesis test allows us to quantify whether it is more likely or not than random chance that the overlapping RF majority and QF minority states are present due to sampling/measurement error.</p><p id="P73">All 5 of these error scenarios are encoded into our cESFW algorithm, which can be inspected to gain further insights into the algorithmic application of the error scenarios. However, prior to looking at our cESFW code, we advise reading the relevant error scenario sections in the supplemental of our <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref> publication for a detailed description.</p></sec><sec id="S25"><title>Continuous Entropy Sort Feature Weighting (cESFW) workflow</title><p id="P74">In <xref ref-type="fig" rid="F1">Figure 1</xref> we outlined the main steps in our proposed cESFW scRNA-seq data processing workflow. In this section we will provide further details for each step. Executable code to apply our cESFW workflow to the synthetic and human embryo scRNA-seq data presented in this paper can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/aradley/cESFW_Embryo_Topology_Paper">https://github.com/aradley/cESFW_Embryo_Topology_Paper</ext-link>. The primary purpose of this section and our workflow is to give readers an insight into how cESFW can be successfully applied to scRNA-seq data. It is expected that users will find other ways to incorporate cESFW into their omics data analysis pipelines for the plethora of data that is now available to the community.</p><sec id="S26"><title>Temporary minority state normalisation</title><p id="P75">For features to be compared to one another with cESFW, they must each be converted into their minority state feature activity vectors (<xref ref-type="supplementary-material" rid="SD2">Fig S9A</xref>). Practically, converting features into their minority state vectors amounts to normalising each feature so that their values are within the same range, in a manner that meaningfully captures how features co-occur with one another. For gene expression data, this could be two genes where when one feature displays expression values close to its maximum expression in the data, the other gene also shows values close to its maximum expression. In this example, to convert these features to their minority state feature activity vectors, we could simply divide all the values of each feature by their respective feature maximums (<xref ref-type="supplementary-material" rid="SD2">Fig S9C</xref>). However, now consider that there is a third gene where when the first two genes have values close to 0, the third gene has values close to its maximum expression, and when the first two features have values close to their maximum, the third feature has values close to 0 (<xref ref-type="supplementary-material" rid="SD2">Fig S9A, B</xref>). This is equivalent to the high expression of the third gene being the majority state feature activity (<xref ref-type="supplementary-material" rid="SD2">Fig S9B</xref>), which is implicitly defined by the sum of activities in the third gene’s normalised vector being greater than half the number of samples. Hence, to convert the third gene to its minority state activity vector, we simply deduct each value of the vector from 1 (<xref ref-type="supplementary-material" rid="SD2">Fig S9A, B</xref>).</p><p id="P76">This logic is generally applicable to any dataset where we can justifiably convert each feature into active versus inactive states. How this abstraction is done and whether this is meaningful for different datasets is context dependent and ultimately left to the user. In this work, we found the relatively simple normalisation method presented in <xref ref-type="fig" rid="F7">Fig. 7</xref> is effective.</p><p id="P77">Having obtained <italic>M<sub>m</sub></italic>, we may now use it as the input for ES calculations to quantify the correlations between features.</p></sec><sec id="S27"><title>Exclude genes significantly enriched within a dataset [Optional]</title><p id="P78">Sometimes when analysing scRNA-seq data we would like to combine datasets from different sequencing experiments. Combining datasets from different experiments can introduce batch effects as a significant confounder in differentiating biological signal from experimental noise. To mitigate the contribution of batch effects on downstream analysis of scRNA-seq data, several methods have been developed (<xref ref-type="bibr" rid="R33">Tran et al. 2020</xref>). Many of these methods focus on smoothing or regressing the counts matrices with the aim of making samples with similar cellular states that are derived from different datasets, look more similar to one another than samples of different cellular states that are from the same dataset. While there are scenarios where smoothing/imputation methods can be successfully employed to gain greater insights into scRNA-seq datasets, they always incur the risk of adding computational artefacts or unintentionally removing biological signal of interest.</p><p id="P79">In this cESFW workflow, we address the issue of batch effects in a different manner. Rather than change the values of the counts matrix, we hypothesised that genes that are significantly enriched in any individual dataset constitute genes that contribute to batch effects and hence should be removed from the data. In doing so, we aim to reduce batch effect signals to the point that biological patterns of interest that are common between datasets have a larger signal than dataset specific noise, which should in turn lead to more biologically relevant insights in downstream analysis.</p><p id="P80">To identify which genes are considered significantly enriched in a specific dataset in an unsupervised manner, we turn to the Error Potential (EP). The EP is a metric derived from Entropy Sorting and described in detail by <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>. Given two minority state activity feature vectors, the EP between the two features can be calculated, and if the EP &gt; 0, the features can be considered to be co-occurring with each other in a manner that is greater than random chance. In <xref ref-type="fig" rid="F8">Fig 8</xref> we provide pseudocode for how we use the EP for excluding features that are significantly enriched in any of the datasets comprising a scRNA-seq counts matrix of interest.</p><p id="P81">A limitation with this batch specific gene exclusion methodology is that if there are datasets within the combined counts matrix (<italic>M<sub>m</sub></italic>) that are comprised of almost entirely one cell type, and that cell type has a distinct gene signature that is not present in any other dataset, these genes may be unwantingly identified as batch effect genes and removed from the data. In such a scenario, it would be up to the researcher to modify the workflow accordingly or seek alternative methodologies.</p></sec><sec id="S28"><title>Calculate ESS and EP feature matrices</title><p id="P82">Having created the <italic>M<sub>m</sub></italic>, we use it to calculate the Entropy Sort Score (ESS) and Error Potential (EP) pairwise for each gene in <italic>M<sub>m</sub></italic>. In doing so we generate the Entropy Sort Scores (<italic>ESSs</italic>) and Error Potentials (<italic>EPs</italic>) matrices, which are <italic>j</italic> by <italic>j</italic> matricies where <italic>j</italic> is the number of genes present in <italic>M<sub>m</sub></italic>. The ESS uses ES theory to quantify the correlation between two features with a value between -1 and 1. The EP uses a hypothesis test between the prospect of two features being completely independent versus the two features being dependent, to quantify the significance of the correlation between the two features. When EP &lt; 0, it is more likely that the observed correlation between two features occurred through a random relationship between two independent features than the features having a dependent relationship. Conversely, when EP &gt; 0, the correlation between the two features is more likely to have been observed due to some dependent relationship.</p><p id="P83">For further details regarding the theory and derivation behind the ESS and EP, see <xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>. In the next steps of our cESFW workflow, we use the <italic>ESSs</italic> and <italic>EPs</italic> matrices to get a feature importance weight for each of the <italic>j</italic> genes, and use these weights to decide which genes should be retained in the scRNA-seq counts matrix, and which should be excluded.</p></sec><sec id="S29"><title>Calculate cESFW feature weights</title><p id="P84">Having generated the <italic>ESSs</italic> and <italic>EPs</italic> matrices, we now calculate the cESFW feature weights for each of the <italic>j</italic> genes. To calculate gene weights, we combine the <italic>ESSs</italic> and <italic>EPs</italic> matrices derived from ES theory, with the concept of node centrality from graph theory. In the context of scRNA-seq data, node centrality can be used to try to distinguish between genes (nodes) that form networks with relatively high correlations with other genes in the dataset, from genes that form weak correlative networks. The assumption is that genes that are members of highly correlating networks are more likely to be involved in cellular function/identity.</p><p id="P85">Because the ESS is a symmetric correlation metric, the <italic>ESSs</italic> matrix can be thought of as a weighted undirected graph in the same manner as other correlation metrics (Pearson’s correlation, mutual information, etc.), where <italic>ESSs</italic>[2,4] = <italic>ESSs</italic>[4,2] = 0.7 would quantify the weight of the edge between genes 2 and 4 as 0.7. However, practical limitations of node centrality often force users to apply supervision to the analysis of complex datasets such as scRNA-seq data. For example, <xref ref-type="bibr" rid="R26">A. Singh, R. R. Singh, and Iyengar 2020</xref> discuss how node centrality measures that use weighted edges can fail to account for the number of edges that each gene has to other genes. In the following we show that with the <italic>ESSs<sub>jx j</sub></italic> and <italic>EPs<sub>jx j</sub></italic> matrices we can calculate node centralities of weighted networks in a manner that is unsupervised and accounts for the number of edges that each gene has to other genes.</p><p id="P86">As stated, <italic>ESSs</italic> can be used as the weighted graph. Now note that each entry of <italic>EPs</italic> quantifies to what degree the corresponding correlation value in <italic>ESSs<sub>jx j</sub></italic> is likely to have occurred by random chance or a dependent relationship between a pair of features. According to ES hypothesis testing (<xref ref-type="bibr" rid="R25">A. Radley et al. 2023</xref>), whenever EP &lt; 0, the feature pair correlation can be assumed to have occurred by random chance. We utilise this property to create a dependent <italic>EPs</italic> matrix, <italic>dEPs</italic>, where <italic>dEPs</italic> is created by setting all values in <italic>EPs</italic> &lt; 0 to 0. <italic>dEPs</italic> now quantifies all the pairwise gene relationships whose co-expression occurs to a degree greater than random chance. Now we can calculate the weighted node centrality of each gene as the weighted column averages of <italic>ESSs</italic> with <italic>dEPs</italic> as weights such that; <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:msub><mml:mrow><mml:mtext>Weighted</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>node</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>centrality</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>∗</mml:mo><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:math></disp-formula> where <italic>j</italic> denotes the column/gene index in <italic>ESSs</italic> and <italic>dEPs</italic>. By weighting each value in <italic>ESSs</italic> by the corresponding values in <italic>dEPs</italic>, we mitigate the contribution of uninformative/random correlative patterns to the calculation of gene centrality.</p><p id="P87">Finally, we encode a biologically inspired assumption into the Weighted node centrality <italic><sub>j</sub></italic> to get our final cESFW gene weights. Because every non-zero value in <italic>dEPs</italic> indicates that a pair of genes have a quantifiably significant relationship, we can count the number of quantifiably meaningful edges a gene has with other genes in the data. We then seek to penalise genes that have significantly more edges than others through the following; <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:msub><mml:mrow><mml:mtext>cESFW</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>gene</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>weights</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>Weighted</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>node</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>centrality</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∑</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi>P</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P88">The biological assumption behind <xref ref-type="disp-formula" rid="FD2">Eqn 2</xref> is that cell identity and differentiation is controlled by relatively small networks of tightly controlled genes. Hence, genes with relatively high weighted node centralities (<xref ref-type="disp-formula" rid="FD1">Eqn. 1</xref>) and relatively low numbers of significant gene co-regulation edges, should be more informative of cellular identity. Conversely, genes that have relatively low weighted node centralities and/or relatively high numbers of significant gene co-regulation edges should constitute genes that are weakly or non-informative of cell identity.</p><p id="P89">In summary, we have calculated a vector of cESFW gene weights, for each gene in <italic>ESSs<sub>jx j</sub></italic>, such that a larger cESFW gene weight indicates that a gene’s expression in the original scRNA-seq counts matrix are more likely to be part of a small network of highly correlated genes than other genes with lower cESFW gene weights. As such, we can use the cESFW gene weights to form a ranked list of genes for downstream analysis.</p></sec><sec id="S30"><title>Select gene cluster with branching network</title><p id="P90">The final step of our proposed cESFW workflow is to take the cESFW gene weights and use them to select the top most informative genes for downstream analysis. In a similar manner to HVG analysis, we can simply take a subset of the top highest ranking genes according to the cESFW gene weights. Up until this point, the cESFW workflow has been entirely unsupervised, i.e., no subjective user decisions were applied, and no prior knowledge regarding cell type or gene importance was used when deciding which genes to exclude from downstream analysis. As with HVG analysis, the final step of the cESFW workflow where we choose how many genes to select based on the cESFW gene weights is an iterative process where researchers use domain knowledge to settle on the final gene set, based on the assumption that the cESFW ranked gene list provides a meaningful proxy for thresholding. Below we provide a description of our rational for using the cESFW gene weights to identify a set of biologically informative genes for the human embryo scRNA-seq data within this manuscript. We present this description as a guide to aid analysis on other datasets.</p><p id="P91">For the human embryo scRNA-seq data presented in this manuscript, we selected the top 4000 genes by taking the 4000 genes with the highest cESFW gene weights. The selection threshold of 4000 was chosen by looking at UMAPs of the genes in the ESSs matrix at varying cESFW gene weight cutoffs (<xref ref-type="supplementary-material" rid="SD2">Fig S10A</xref>). In these UMAPs we qualitatively look for two main properties. Firstly we are looking for a clusters of genes that have significant branching patterns, rather than smooth “blob” like clusters. In <xref ref-type="supplementary-material" rid="SD2">Fig S10A</xref> we see that as we decease the number of top ranked genes that we include, the darker blue coloured cluster forms increasingly distinct branches. These branches indicate that there are genes that form fully connected networks, with some genes being very specifically connected to each other without being directly connected to many other genes in the network. Biologically we infer that these represent genes that are specifically expressed in a subset of cells present in the entire dataset, and are hence genes of interest when dissecting cellular identity. The top 4000 genes was chosen relatively arbitrarily as the point at which a clear branching pattern appears in the dark blue cluster. Readers will notice that choosing values smaller than 4000 can result in even more distinct branches in the blue cluster. We suggest users of our cESFW workflow aim to find a balance between keeping as many genes as possible while increasing the qualitative property of branching structure.</p><p id="P92">The second feature of these UMAPs that we are interested in is that a separate cluster of genes with significantly higher weighted node centrality scores can appear (yellow). Empirically we find that failure to remove these clusters of genes prevents the emergence of high resolution scRNA-seq embeddings (see the online GitHub workflow for examples). Gene set enrichment analysis of the final 3012 gene set used throughout this manuscript, comprising the blue cluster of the top 4000 genes in (<xref ref-type="supplementary-material" rid="SD2">Fig S10A</xref>, red square), showed that these genes were enriched for gene ontology (GO) terms relating to regulation and development (<xref ref-type="supplementary-material" rid="SD2">Fig S10B</xref>). Conversely, the GO terms of the 988 genes comprising the yellow cluster were dominated by terms relating to transcription, translation and metabolism (<xref ref-type="supplementary-material" rid="SD2">Fig S10C</xref>). Hence we hypothesise that the genes present in the relatively highly correlated yellow clusters represent expression signals relating to generic cell transcription, translation and metabolism processes which are less discriminating of cellular identity/function than genes that are part of the blue branching cluster. By excluding the genes from the yellow cluster in downstream analysis, we appear to further increase the signal to noise ratio of cell type specific expression, which ultimately improves our ability to discriminate different cell identities in the data.</p><p id="P93">We emphasise that this final step of the cESFW workflow is supervised and subject user interpretation/dataset variability. We hope that our transparency regarding this step helps guide potential users of our cESFW workflow to improved resolution in their datasets, or to develop new cESFW feature weight based selection criteria themselves.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplemental Table S1</label><media xlink:href="EMS189773-supplement-Supplemental_Table_S1.csv" mimetype="text" mime-subtype="csv; charset=utf-8" id="d30aAdGbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Materials</label><media xlink:href="EMS189773-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d30aAdGcB" position="anchor"/></supplementary-material></sec></body><back><ack id="S31"><title>Acknowledgements</title><p>We would like to thank Professor Marc Goodfellow, Professor Linus Schumacher and Dr. James Briscoe for their helpful discussions and insightful comments.</p><p>We thank Dr Dimitri Meistermann, Dr Cheng Zhao and Professor Fredrik Lanner for helping us obtain the spliced and unspliced scRNA-seq matrices used for RNA velocity analysis.</p><p>We thank Dr Manvendra Singh for providing cell label IDs for the <xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref> scRNA-seq data used in <xref ref-type="bibr" rid="R27">M. Singh et al. 2023</xref>.</p><p>Thank you to Dr Pengtao Liu and Dr Xi Chen for providing the human EPSCs scRNA-seq counts matrix used in <xref ref-type="bibr" rid="R10">Gao et al. 2019</xref>.</p><sec id="S32"><title>Funding</title><p>This research was supported by the Medical Research Council Programme Grant (MR/W025310/1) and European Research Council Advanced Grant (Plastinet, contract 835312) funding to A.S.</p><p>A.S. is a Medical Research Council Professor (G1100526/2).</p></sec></ack><sec id="S33" sec-type="data-availability"><title>Data and code availability</title><p id="P94">Instructions to install cESFW can be found at, <ext-link ext-link-type="uri" xlink:href="https://github.com/aradley/cESFW">https://github.com/aradley/cESFW</ext-link>.</p><p id="P95">Computational workflows and data used for the generation of results in this article may be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/aradley/cESFW_Embryo_Topology_Paper">https://github.com/aradley/cESFW_Embryo_Topology_Paper</ext-link>.</p><p id="P96">A copy of the human pre and post implantation embryo data used in this work may be found in the following permanent Mendeley Data repository <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/34td4ds2r9/draft?a=c464ae1c-08a6-430a-8bb2-6dc8146d61f5">https://data.mendeley.com/datasets/34td4ds2r9/draft?a=c464ae1c-08a6-430a-8bb2-6dc8146d61f5</ext-link>. (<bold>Please note that until this work is peer reviewed, this Mendeley Data repository link will be in preview mode, and may be subject to change</bold>.)</p><p id="P97">The data used to create our the UMAP embedding are a combination of human embryo pre-implantation and post-implantation embryo (extended culture) scRNA-seq data. The pre-implantation raw counts scRNA-seq data from <xref ref-type="bibr" rid="R37">Yan et al. 2013</xref>, <xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref>, <xref ref-type="bibr" rid="R9">Fogarty et al. 2017</xref>, and <xref ref-type="bibr" rid="R20">Meistermann et al. 2021</xref>, were compiled into a single gene expression matrix kindly provided by (<xref ref-type="bibr" rid="R20">Meistermann et al. 2021</xref>). The <xref ref-type="bibr" rid="R38">Yanagida et al. 2021</xref> human pre-implantation embryo data are available via GEO accession number GSE171820. The 3D cultured post-implantation human embryo raw counts scRNA-seq data are from <xref ref-type="bibr" rid="R35">Xiang et al. 2020</xref>, available at GSE136447. For our analysis, we removed <xref ref-type="bibr" rid="R35">Xiang et al. 2020</xref>’s day 6 and 7 cultured embryo samples to mitigate the contribution of batch effects and uncertainty over timings of embryo stages.</p></sec><fn-group><fn id="FN2" fn-type="con"><p id="P98"><bold>Author contributions statement</bold></p><p id="P99">Conceptualisation: A.R., A.S.; Data curation: A.R.; Formal Analysis: A.R.; Funding acquisition: A.S.; Investigation: A.R.; Methodology: A.R.; Project administration: A.S.; Resources: A.S.; Software: A.R.; Supervision: A.S.; Validation:A.R.; Visualisation: A.R.; Writing – original draft: A.R.; Writing – review &amp; editing: A.R., A.S.</p></fn><fn id="FN3" fn-type="conflict"><p id="P100"><bold>Declaration of Interests</bold></p><p id="P101">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allègre</surname><given-names>Nicolas</given-names></name><etal/></person-group><article-title>NANOG initiates epiblast fate through the coordination of pluripotency genes expression</article-title><source>Nature Communications</source><year>2022</year><volume>13</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><comment>2022 13:1</comment><pub-id pub-id-type="pmcid">PMC9213552</pub-id><pub-id pub-id-type="pmid">35729116</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-30858-8</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>Tallulah S</given-names></name><name><surname>Hemberg</surname><given-names>Martin</given-names></name></person-group><article-title>False signals induced by single-cell imputation</article-title><source>F1000Research</source><year>2018</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC6415334</pub-id><pub-id pub-id-type="pmid">30906525</pub-id><pub-id pub-id-type="doi">10.12688/f1000research.16613.2</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bellman</surname><given-names>Richard</given-names></name></person-group><article-title>Dynamic Programming</article-title><source>Science</source><year>1957</year><volume>153</volume><issue>3731</issue><fpage>34</fpage><lpage>37</lpage><pub-id pub-id-type="pmid">17730601</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergen</surname><given-names>Volker</given-names></name><etal/></person-group><article-title>Generalizing RNA velocity to transient cell states through dynamical modeling</article-title><source>Nature biotechnology</source><year>2020</year><volume>38</volume><issue>12</issue><fpage>1408</fpage><lpage>1414</lpage><pub-id pub-id-type="pmid">32747759</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannoodt</surname><given-names>Robrecht</given-names></name><etal/></person-group><article-title>Spearheading future omics analyses using dyngen, a multi-modal simulator of single cells</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><issue>1</issue><fpage>1</fpage><lpage>9</lpage><comment>2021 12:1</comment><pub-id pub-id-type="pmcid">PMC8225657</pub-id><pub-id pub-id-type="pmid">34168133</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-24152-2</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chu</surname><given-names>Shih Kai</given-names></name><etal/></person-group><article-title>Comprehensive evaluation of noise reduction methods for single-cell RNA sequencing data</article-title><source>Briefings in Bioinformatics</source><year>2022</year><volume>23</volume><issue>2</issue><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC8921632</pub-id><pub-id pub-id-type="pmid">35048125</pub-id><pub-id pub-id-type="doi">10.1093/bib/bbab565</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cockburn</surname><given-names>Katie</given-names></name><name><surname>Rossant</surname><given-names>Janet</given-names></name></person-group><article-title>Making the blastocyst: lessons from the mouse</article-title><source>The Journal of Clinical Investigation</source><year>2010</year><volume>120</volume><issue>4</issue><fpage>995</fpage><pub-id pub-id-type="pmcid">PMC2846056</pub-id><pub-id pub-id-type="pmid">20364097</pub-id><pub-id pub-id-type="doi">10.1172/JCI41229</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corujo-Simon</surname><given-names>Elena</given-names></name><name><surname>Radley</surname><given-names>Arthur H</given-names></name><name><surname>Nichols</surname><given-names>Jennifer</given-names></name></person-group><article-title>Evidence implicating sequential commitment of the founder lineages in the human blastocyst by order of hypoblast gene activation</article-title><source>Development (Cambridge)</source><year>2023</year><volume>150</volume><issue>10</issue><pub-id pub-id-type="pmcid">PMC10233721</pub-id><pub-id pub-id-type="pmid">37102672</pub-id><pub-id pub-id-type="doi">10.1242/dev.201522</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fogarty</surname><given-names>Norah ME</given-names></name><etal/></person-group><article-title>Genome editing reveals a role for OCT4 in human embryogenesis</article-title><source>Nature</source><year>2017</year><volume>550</volume><issue>7674</issue><fpage>67</fpage><lpage>73</lpage><comment>2017 550:7674</comment><pub-id pub-id-type="pmcid">PMC5815497</pub-id><pub-id pub-id-type="pmid">28953884</pub-id><pub-id pub-id-type="doi">10.1038/nature24033</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>Xuefei</given-names></name><etal/></person-group><article-title>Establishment of porcine and human expanded potential stem cells</article-title><source>Nature Cell Biology</source><year>2019</year><volume>21</volume><issue>6</issue><fpage>687</fpage><lpage>699</lpage><comment>2019 21:6</comment><pub-id pub-id-type="pmcid">PMC7035105</pub-id><pub-id pub-id-type="pmid">31160711</pub-id><pub-id pub-id-type="doi">10.1038/s41556-019-0333-2</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grau</surname><given-names>Jan</given-names></name><name><surname>Grosse</surname><given-names>Ivo</given-names></name><name><surname>Keilwagen</surname><given-names>Jens</given-names></name></person-group><article-title>PRROC: computing and visualizing precision-recall and receiver operating characteristic curves in R</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><issue>15</issue><fpage>2595</fpage><lpage>2597</lpage><pub-id pub-id-type="pmcid">PMC4514923</pub-id><pub-id pub-id-type="pmid">25810428</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btv153</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>Ge</given-names></name><name><surname>von Meyenn</surname><given-names>Ferdinand</given-names></name><etal/></person-group><article-title>Epigenetic resetting of human pluripotency</article-title><source>Development</source><year>2017</year><volume>144</volume><issue>15</issue><fpage>2748</fpage><lpage>2763</lpage><pub-id pub-id-type="pmcid">PMC5560041</pub-id><pub-id pub-id-type="pmid">28765214</pub-id><pub-id pub-id-type="doi">10.1242/dev.146811</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>Ge</given-names></name><name><surname>Stirparo</surname><given-names>Giuliano Giuseppe</given-names></name><etal/></person-group><article-title>Human naive epiblast cells possess unrestricted lineage potential</article-title><source>Cell Stem Cell</source><year>2021</year><volume>28</volume><issue>6</issue><fpage>1040</fpage><lpage>1056</lpage><pub-id pub-id-type="pmcid">PMC8189439</pub-id><pub-id pub-id-type="pmid">33831366</pub-id><pub-id pub-id-type="doi">10.1016/j.stem.2021.02.025</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haque</surname><given-names>Ashraful</given-names></name><etal/></person-group><article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title><source>Genome Medicine</source><year>2017</year><volume>9</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC5561556</pub-id><pub-id pub-id-type="pmid">28821273</pub-id><pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumos</surname><given-names>Lukas</given-names></name><etal/></person-group><article-title>Best practices for single-cell analysis across modalities</article-title><source>Nature Reviews Genetics</source><year>2023</year><volume>2023</volume><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="pmcid">PMC10066026</pub-id><pub-id pub-id-type="pmid">37002403</pub-id><pub-id pub-id-type="doi">10.1038/s41576-023-00586-w</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lähnemann</surname><given-names>David</given-names></name><etal/></person-group><article-title>Eleven grand challenges in single-cell data science</article-title><source>Genome Biology</source><year>2020</year><volume>21</volume><issue>1</issue><fpage>1</fpage><lpage>35</lpage><comment>2020 21:1</comment><pub-id pub-id-type="pmcid">PMC7007675</pub-id><pub-id pub-id-type="pmid">32033589</pub-id><pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Dandan</given-names></name><etal/></person-group><article-title>Primary specification of blastocyst trophectoderm by scRNA-seq: New insights into embryo implantation</article-title><source>Science Advances</source><year>2022</year><volume>8</volume><issue>31</issue><fpage>3725</fpage><pub-id pub-id-type="pmcid">PMC9365277</pub-id><pub-id pub-id-type="pmid">35947672</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.abj3725</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazid</surname><given-names>Md Abdul</given-names></name><etal/></person-group><article-title>Rolling back human pluripotent stem cells to an eight-cell embryo-like stage</article-title><source>Nature</source><year>2022</year><volume>605</volume><issue>7909</issue><fpage>315</fpage><lpage>324</lpage><comment>2022 605:7909</comment><pub-id pub-id-type="pmid">35314832</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>Leland</given-names></name><etal/></person-group><article-title>UMAP: Uniform Manifold Approximation and Projection</article-title><source>Journal of Open Source Software</source><year>2018</year><volume>3</volume><issue>29</issue><fpage>861</fpage><pub-id pub-id-type="doi">10.21105/JOSS.00861</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meistermann</surname><given-names>Dimitri</given-names></name><etal/></person-group><article-title>Integrated pseudotime analysis of human pre-implantation embryo single-cell transcriptomes reveals the dynamics of lineage specification</article-title><source>Cell Stem Cell</source><year>2021</year><volume>28</volume><issue>9</issue><fpage>1625</fpage><lpage>1640</lpage><pub-id pub-id-type="pmid">34004179</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Messmer</surname><given-names>Tobias</given-names></name><etal/></person-group><article-title>Transcriptional Heterogeneity in Naive and Primed Human Pluripotent Stem Cells at Single-Cell Resolution</article-title><source>Cell Reports</source><year>2019</year><volume>26</volume><issue>4</issue><fpage>815</fpage><pub-id pub-id-type="pmcid">PMC6344340</pub-id><pub-id pub-id-type="pmid">30673604</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2018.12.099</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakamura</surname><given-names>Tomonori</given-names></name><etal/></person-group><article-title>Single-cell transcriptome of early embryos and cultured embryonic stem cells of cynomolgus monkeys</article-title><source>Scientific Data</source><year>2017</year><volume>4</volume><issue>1</issue><fpage>1</fpage><lpage>9</lpage><comment>2017 4:1</comment><pub-id pub-id-type="pmcid">PMC5477564</pub-id><pub-id pub-id-type="pmid">28649393</pub-id><pub-id pub-id-type="doi">10.1038/sdata.2017.67</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nichols</surname><given-names>Jennifer</given-names></name><name><surname>Smith</surname><given-names>Austin</given-names></name></person-group><article-title>Naive and Primed Pluripotent States</article-title><source>Cell Stem Cell</source><year>2009</year><volume>4</volume><issue>6</issue><fpage>487</fpage><lpage>492</lpage><pub-id pub-id-type="pmid">19497275</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petropoulos</surname><given-names>Sophie</given-names></name><etal/></person-group><article-title>Single-Cell RNA-Seq Reveals Lineage and X Chromosome Dynamics in Human Preimplantation Embryos</article-title><source>Cell</source><year>2016</year><volume>165</volume><issue>4</issue><fpage>1012</fpage><lpage>1026</lpage><pub-id pub-id-type="pmcid">PMC4868821</pub-id><pub-id pub-id-type="pmid">27062923</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radley</surname><given-names>Arthur</given-names></name><etal/></person-group><article-title>Entropy sorting of single-cell RNA sequencing data reveals the inner cell mass in the human pre-implantation embryo</article-title><source>Stem Cell Reports</source><year>2023</year><volume>18</volume><issue>1</issue><fpage>47</fpage><lpage>63</lpage><pub-id pub-id-type="pmcid">PMC9859930</pub-id><pub-id pub-id-type="pmid">36240776</pub-id><pub-id pub-id-type="doi">10.1016/j.stemcr.2022.09.007</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>Anuj</given-names></name><name><surname>Singh</surname><given-names>Rishi Ranjan</given-names></name><name><surname>Iyengar</surname><given-names>SRS</given-names></name></person-group><article-title>Node-weighted centrality: a new way of centrality hybridization</article-title><source>Computational Social Networks</source><year>2020</year><volume>7</volume><issue>1</issue><fpage>1</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1186/S40649-020-00081-W/TABLES/16</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>Manvendra</given-names></name><etal/></person-group><article-title>A new human embryonic cell type associated with activity of young transposable elements allows definition of the inner cell mass</article-title><source>PLOS Biology</source><year>2023</year><volume>21</volume><issue>6</issue><elocation-id>e3002162</elocation-id><pub-id pub-id-type="pmcid">PMC10281584</pub-id><pub-id pub-id-type="pmid">37339119</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3002162</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>Austin</given-names></name></person-group><article-title>Formative pluripotency: the executive phase in a developmental continuum</article-title><source>Development</source><year>2017</year><volume>144</volume><issue>3</issue><fpage>365</fpage><lpage>373</lpage><pub-id pub-id-type="pmcid">PMC5430734</pub-id><pub-id pub-id-type="pmid">28143843</pub-id><pub-id pub-id-type="doi">10.1242/dev.142679</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stirparo</surname><given-names>Giuliano G</given-names></name><etal/></person-group><article-title>Integrated analysis of single-cell embryo data yields a unified transcriptome signature for the human pre-implantation epiblast</article-title><source>Development (Cambridge)</source><year>2018</year><volume>145</volume><issue>3</issue><comment>/2054356/DEV{\_}158501V1.PDF</comment><pub-id pub-id-type="pmcid">PMC5818005</pub-id><pub-id pub-id-type="pmid">29361568</pub-id><pub-id pub-id-type="doi">10.1242/dev.158501</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takashima</surname><given-names>Yasuhiro</given-names></name><etal/></person-group><article-title>Resetting Transcription Factor Control Circuitry toward Ground-State Pluripotency in Human</article-title><source>Cell</source><year>2014</year><volume>158</volume><issue>6</issue><fpage>1254</fpage><lpage>1269</lpage><pub-id pub-id-type="pmcid">PMC4162745</pub-id><pub-id pub-id-type="pmid">25215486</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2014.08.029</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Fuchou</given-names></name><etal/></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title><source>Nature Methods</source><year>2009</year><volume>6</volume><issue>5</issue><fpage>377</fpage><lpage>382</lpage><comment>2009 6:5</comment><pub-id pub-id-type="pmid">19349980</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taubenschmid-Stowers</surname><given-names>Jasmin</given-names></name><etal/></person-group><article-title>8C-like cells capture the human zygotic genome activation program in vitro</article-title><source>Cell Stem Cell</source><year>2022</year><volume>29</volume><issue>3</issue><fpage>449</fpage><pub-id pub-id-type="pmcid">PMC8901440</pub-id><pub-id pub-id-type="pmid">35216671</pub-id><pub-id pub-id-type="doi">10.1016/j.stem.2022.01.014</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>Hoa Thi Nhu</given-names></name><etal/></person-group><article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title><source>Genome Biology</source><year>2020</year><volume>21</volume><issue>1</issue><fpage>1</fpage><lpage>32</lpage><pub-id pub-id-type="pmcid">PMC6964114</pub-id><pub-id pub-id-type="pmid">31948481</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1850-9</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>Xinshu</given-names></name><etal/></person-group><article-title>Integrative analysis of single-cell embryo data reveals transcriptome signatures for the human preimplantation inner cell mass</article-title><source>Developmental Biology</source><year>2023</year><volume>502</volume><fpage>39</fpage><lpage>49</lpage><pub-id pub-id-type="pmid">37437860</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>Lifeng</given-names></name><etal/></person-group><article-title>A developmental landscape of 3D-cultured human pre-gastrulation embryos</article-title><source>Nature</source><year>2020</year><volume>577</volume><issue>7791</issue><fpage>537</fpage><lpage>542</lpage><pub-id pub-id-type="pmid">31830756</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yabe</surname><given-names>Shinichiro</given-names></name><etal/></person-group><article-title>Comparison of syncytiotrophoblast generated from human embryonic stem cells and from term placentas</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2016</year><volume>113</volume><issue>19</issue><fpage>E2598</fpage><lpage>E2607</lpage><pub-id pub-id-type="pmcid">PMC4868474</pub-id><pub-id pub-id-type="pmid">27051068</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1601630113</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Liying</given-names></name><etal/></person-group><article-title>Single-cell RNA-Seq profiling of human preimplantation embryos and embryonic stem cells</article-title><source>Nature Structural Molecular Biology</source><year>2013</year><volume>20</volume><issue>9</issue><fpage>1131</fpage><lpage>1139</lpage><comment>2013 20:9</comment><pub-id pub-id-type="pmid">23934149</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yanagida</surname><given-names>Ayaka</given-names></name><etal/></person-group><article-title>Naive stem cell blastocyst model captures human embryo lineage segregation</article-title><source>Cell Stem Cell</source><year>2021</year><volume>28</volume><issue>6</issue><fpage>1016</fpage><lpage>1022</lpage><pub-id pub-id-type="pmcid">PMC8189436</pub-id><pub-id pub-id-type="pmid">33957081</pub-id><pub-id pub-id-type="doi">10.1016/j.stem.2021.04.031</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Ran</given-names></name><etal/></person-group><article-title>Amnion signals are essential for mesoderm formation in primates</article-title><source>Nature Communications</source><year>2021</year><volume>12</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><comment>2021 12:1</comment><pub-id pub-id-type="pmcid">PMC8390679</pub-id><pub-id pub-id-type="pmid">34446705</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-25186-2</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeung</surname><given-names>KY</given-names></name><name><surname>Ruzzo</surname><given-names>WL</given-names></name></person-group><article-title>Principal component analysis for clustering gene expression data</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><issue>9</issue><fpage>763</fpage><lpage>774</lpage><pub-id pub-id-type="pmid">11590094</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yip</surname><given-names>Shun H</given-names></name><name><surname>Sham</surname><given-names>Pak Chung</given-names></name><name><surname>Wang</surname><given-names>Junwen</given-names></name></person-group><article-title>Evaluation of tools for highly variable gene discovery from single-cell RNA-seq data</article-title><source>Briefings in Bioinformatics</source><year>2019</year><volume>20</volume><issue>4</issue><fpage>1583</fpage><pub-id pub-id-type="pmcid">PMC6781572</pub-id><pub-id pub-id-type="pmid">29481632</pub-id><pub-id pub-id-type="doi">10.1093/bib/bby011</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yue</surname><given-names>Chaomin</given-names></name><etal/></person-group><article-title>Human embryonic stem cell-derived blastocyst-like spheroids resemble human trophectoderm during early implantation process</article-title><source>Fertility and Sterility</source><year>2020</year><volume>114</volume><issue>3</issue><fpage>653</fpage><lpage>664</lpage><pub-id pub-id-type="pmid">32444068</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zadora</surname><given-names>Julianna</given-names></name><etal/></person-group><article-title>Disturbed placental imprinting in preeclampsia leads to altered expression of DLX5, a human-specific early trophoblast marker</article-title><source>Circulation</source><year>2017</year><volume>136</volume><issue>19</issue><fpage>1824</fpage><lpage>1839</lpage><pub-id pub-id-type="pmcid">PMC5671803</pub-id><pub-id pub-id-type="pmid">28904069</pub-id><pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.117.028110</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>scRNA-seq counts matrix processing workflows.</title><p>Left hand column shows a high level outline of the workflows implemented by widely used scRNA-seq bioinformatics pipelines such as Scran, Seurat and Scanpy. Right hand column outlines the steps of our cESFW workflow. Colours indicate the degree to which the steps alter expression counts values in the original scRNA-seq counts matrix before the data are passed onto downstream analysis steps.</p></caption><graphic xlink:href="EMS189773-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comparison of cESFW and HVG feature selection techniques.</title><p><bold>A</bold>. Summary of the 4 synthetic datasets (SD) of varying size and shape created using the Dyngen software. <bold>B</bold>. UMAP of SD4 created using only the TF genes. <bold>C</bold>. UMAP of SD4 created using all genes (TFs and HKs). <bold>D</bold>. AUROC curve generated using the ranked gene lists from application of cESFW, Scran and Seurat gene selection to SD4. <bold>E</bold>. Precision-Recall curve using the same inputs as D. <bold>F</bold>. AUROC scores after applying cESFW, Scran and Seurat gene selection to all 4 SDs. Green stars indicate that cESFW had the highest score for a SD and red indicate when a different method had a higher score than cESFW. <bold>G</bold>. Precision-Recall AUCs using the same inputs as F. <bold>H</bold>. Summary of all AUC results. Green boxes indicate that cESFW had the highest score for a SD and red indicate when a different method had a higher score than cESFW. For UMAPs and AUC curves relating to SD 1-3, see <xref ref-type="supplementary-material" rid="SD2">Fig S1</xref>.</p></caption><graphic xlink:href="EMS189773-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>High-resolution UMAP embedding of early human embryo development.</title><p><bold>A-C</bold>. UMAP embedding generated using the 3012 genes identified by our cESFW workflow, <bold>A</bold>. coloured by time point labels from data source papers, <bold>B</bold>. coloured by dataset sources, <bold>C</bold>. coloured by our cell type cluster annotations. preIm-Epi = pre-implantation epiblast, ExE-Mes = extraembryonic mesenchyme, Hyp = hypoblast, cTB = cytotrophoblast, sTB = syncytiotrophoblast. See <xref ref-type="supplementary-material" rid="SD2">Fig S2 and Fig S3</xref> for further details regarding the cluster annotations. <bold>D</bold>. Heatmap of the 3012 cESFW selected genes, grouped by our cell cluster annotations. <bold>E</bold>. Known cell type marker expression profiles validate our UMAP annotations. See <xref ref-type="supplementary-material" rid="SD2">Fig S3</xref> for more examples</p></caption><graphic xlink:href="EMS189773-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>REject cells are within the ICM/TE branch point cluster.</title><p>UMAP embedding generated using the 3012 genes identified by our cESFW workflow, <bold>A</bold>. coloured by time point labels from data source papers, <bold>B</bold>. coloured by dataset sources, <bold>C</bold>. coloured by <xref ref-type="bibr" rid="R27">M. Singh et al. 2023</xref>’s NCC sample labels. <bold>D</bold>. RNA velocity vectors overlaid onto the UMAP embedding. Samples in grey were not part of the RNA velocity analysis owing to the scRNA-seq spliced and unspliced counts matrices only being available for the <xref ref-type="bibr" rid="R24">Petropoulos et al. 2016</xref> dataset. <bold>E</bold>. Proposed ICM/TE branch marker genes.</p></caption><graphic xlink:href="EMS189773-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Characterising the human embryo counterparts of <italic>in vitro</italic> stem cell cultures.</title><p><bold>A</bold>. UMAP embedding highlighting the embryo 8-cell, preIm-Epi and Embryonic disc populations. FBP1 and SFRP2 shown as previously identified preIm-Epi and Embryonic disc markers respectively (<xref ref-type="bibr" rid="R21">Messmer et al. 2019</xref>). <bold>B</bold>. Projection of cultured naïve, primed and EPSC scRNA-seq datasets onto our UMAP embedding. To aid interpretation, sample transparencies are scaled by the density of samples on the embedding from the same condition, such that samples in the densest region are completely opaque. Abbreviations in brackets denote relevant culture media. <bold>C</bold>. Quantification of cultured naïve, primed and EPSC scRNA-seq sample identities. <bold>D</bold>. Heatmap of z-score normalised gene expression of 8 naïve specific and 8 primed specific gene markers. All values are pseudo-bulk expression values, generated by grouping single cells by their dataset and predicted cell type labels from panel C., and taking the average expression of each group.</p></caption><graphic xlink:href="EMS189773-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Emerging epiblast, hypoblast and trophectoderm signatures during blastocyst development.</title><p><bold>A-C</bold>. Heatmaps of pseudobulk, z-score normalised human embryo data, displaying genes that show blocks of sequential up-regulation between morula and Epi (A.), Hyp (B.) or TE (C.) lineages. Pink boxes highlight most relevant cell types for each lineage. Green highlighted genes are presented in UMAPs within this figure and in <xref ref-type="supplementary-material" rid="SD2">Fig S7</xref>. <bold>D-E</bold>. UMAP gene expression profiles for example genes showing expression from morula to Epi (D.), Hyp (E.) or TE (F.) lineages.</p></caption><graphic xlink:href="EMS189773-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><p>Where input <italic>M</italic> is the <italic>i</italic> by <italic>j</italic> raw scRNA-seq counts matrix (<italic>i</italic> = samples/cells, <italic>j</italic> = genes), <italic>N</italic> is the number of samples/cells comprising (<italic>N</italic> = <italic>j</italic>), and <italic>p</italic> is the percentile used to clip the maximum expression of each gene. In this work, <italic>p</italic> was set as the 97.5th percentile. The output, <italic>M<sub>m</sub></italic>, is the normalised minority state activity <italic>i</italic> by <italic>j</italic> matrix.</p></caption><graphic xlink:href="EMS189773-f007"/></fig><fig id="F8" position="float"><label>Figure 8</label><caption><p>Where input <italic>M<sub>m</sub></italic> is the <italic>i</italic> by <italic>j</italic> normalised minority state activity (<italic>i</italic> = samples/cells, <italic>j</italic> = genes), <italic>N</italic> is the number of samples/cells comprising (<italic>N</italic> = <italic>j</italic>) and <italic>k</italic> is the number of datasets the were combined to create <italic>M<sub>m</sub></italic>.</p></caption><graphic xlink:href="EMS189773-f008"/></fig></floats-group></article>