<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS192649</article-id><article-id pub-id-type="doi">10.1101/2023.12.05.570120</article-id><article-id pub-id-type="archive">PPR770793</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>GeneExt: a gene model extension tool for enhanced single-cell RNA-seq analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zolotarov</surname><given-names>Grygoriy</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Grau-Bové</surname><given-names>Xavier</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Sebé-Pedrós</surname><given-names>Arnau</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">#</xref></contrib></contrib-group><aff id="A1"><label>1</label>Centre for Genomic Regulation (CRG), Barcelona Institute of Science and Technology (BIST), Barcelona, Spain</aff><aff id="A2"><label>2</label>Universitat Pompeu Fabra (UPF), Barcelona, Spain</aff><aff id="A3"><label>3</label>ICREA, Barcelona, Spain</aff><author-notes><corresp id="CR1"><label>#</label>Correspondence to <email>arnau.sebe@crg.eu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>09</day><month>12</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>07</day><month>12</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license><license><ali:license_ref>https://europepmc.org/downloads/openaccess</ali:license_ref><license-p>This preprint is made available via the <ext-link ext-link-type="uri" xlink:href="https://europepmc.org/downloads/openaccess">Europe PMC open access subset</ext-link>, for unrestricted research re-use and secondary analysis in any form or by any means with acknowledgement of the original preprint source.</license-p></license></permissions><abstract><p id="P1">Incomplete gene models negatively impact single-cell gene expression quantification. This is particularly true in non-model species where often gene 3′ ends are inaccurately annotated, while most scRNA-seq methods only capture the 3′ transcript region. This results in many genes being incorrectly quantified or not detected. GeneExt leverages scRNA-seq data to refine gene annotations, enhancing biological interpretation and cross-species comparisons of cell type expression atlases.</p></abstract></article-meta></front><body><p id="P2">Single-cell transcriptomics has transformed the study of cell type diversity across organisms. This technology enables the large-scale and minimally biased molecular characterization of cell types at the whole-organism level, opening the window to cross-species comparisons, discovery of novel cell types, and understanding of gene regulatory programs<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. An important problem that hampers the analysis and interpretation of scRNA-seq data in non-model species is the inaccuracy of gene annotations (missing genes, partial genes, etc.)<sup><xref ref-type="bibr" rid="R2">2</xref>–<xref ref-type="bibr" rid="R4">4</xref></sup>. The problem is aggravated by the fact that most scRNA-seq methods profile the 3′ end of the transcript, where UTRs are often particularly difficult to annotate<sup><xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>. Thus, a large fraction of sequencing reads map to non-genic regions of the genome and many genes are missing from single-cell expression matrices. This affects both downstream analysis (e.g. cell clustering) and the biological interpretation of the data (e.g. the possibility to miss-quantify key marker genes, or to randomly miss orthologs in cross-species comparisons<sup><xref ref-type="bibr" rid="R9">9</xref></sup>). Here, we introduce GeneExt, a tool that solves 3′ end annotation and other related gene annotation problems typically associated with non-model organism single-cell RNA-seq data analysis.</p><p id="P3">GeneExt takes as input scRNA-seq mapped reads and a gene annotation file (GTF or GFF, any version) and outputs extended gene annotation file ready for scRNA-seq analysis. The main functions of GeneExt are (<xref ref-type="fig" rid="F1">Fig. 1</xref>): <list list-type="order" id="L1"><list-item><p id="P4">Extension of 3′ regions of known genes to better capture reads from 3′-biased scRNA-seq technologies. This is the core functionality of GeneExt and is performed by default. First, GeneExt will define transcriptionally active regions using a user-provided BAM alignment file (e.g. the one produced by CellRanger or other tools) and MACS2<sup><xref ref-type="bibr" rid="R10">10</xref></sup> to identify stranded peaks, which are classified as genic (mapping to previously annotated gene regions) and intergenic. Intergenic peaks are used to extend the 3′ regions of nearby genes in the same strand, up to a certain distance (<italic>--m</italic> flag). Spurious peaks are removed by excluding those with low coverage (by default, intergenic peaks with coverage below the 25th percentile of the genic peak coverage distribution are excluded; <italic>--peak_perc</italic> flag).</p></list-item><list-item><p id="P5">Identification of orphan peaks that could constitute unannotated genes or longer 3′ UTRs. This is enabled with the <italic>--orphan</italic> flag. Here, GeneExt uses the intergenic peaks not previously assigned to an upstream gene (and passing the coverage filter threshold) to add putative new genes to the final annotation. GeneExt attempts to merge these peaks into clusters defined by a maximum distance between the peaks (-<italic>-orphan_maxdist</italic> parameter, 95th quantile of intron length distribution by default) and filtering out peak clusters above a maximum size (<italic>--orphan_maxsize</italic> parameter, median gene length by default). The idea is to avoid peaks representing exons from the same unannotated gene to contribute independently with the same expression signal in the final UMI count matrix. Clustering of orphan peaks can be disabled with the <italic>--nomerge</italic> flag.</p></list-item><list-item><p id="P6">Clipping of 5′ regions in cases where they overlap with the 3′ regions of nearby genes. Depending on the behavior of the UMI demultiplexing software used, this overlap can cause (i) the upstream gene to not be quantified (if 3′ biased scRNA-seq reads mapped into the overlapping region are discarded) or (ii) the downstream gene to have two distinct confounding expression signals (if reads are assigned to both). This optional clipping procedure resolves this ambiguity and is enabled by the <italic>--clip_5prime</italic> flag.</p></list-item><list-item><p id="P7">In addition, GeneExt will also fix non-standard GTF/GFF files provided by the user (e.g. adding gene features if needed), so as to produce outputs compatible with commonly used UMI demultiplexing software (e.g. 10X CellRanger, STARsolo<sup><xref ref-type="bibr" rid="R11">11</xref></sup>). By default, it will only report the longest isoform of each gene (accordingly extended).</p></list-item></list>
</p><p id="P8">We tested the effects of these gene annotation modification using published whole-organism scRNA-seq atlases from diverse species (<xref ref-type="fig" rid="F2">Fig. 2</xref>): the sponge <italic>Amphimedon queenslandica</italic>, the ctenophore <italic>Mnemiopsis leidyi</italic>, the placozoan <italic>Trichoplax adhaerens</italic><sup><xref ref-type="bibr" rid="R12">12</xref></sup>, the cnidarians <italic>Nematostella vectensis</italic><sup><xref ref-type="bibr" rid="R13">13</xref></sup>, <italic>Stylophora pistillata</italic><sup><xref ref-type="bibr" rid="R14">14</xref></sup> and <italic>Xenia</italic> sp.<sup><xref ref-type="bibr" rid="R15">15</xref></sup>, the cephalopod <italic>Octopus vulgaris</italic> (in this case only neural tissues)<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, and the rat <italic>Rattus norvergicus</italic> (nucleus accumbens cells)<sup><xref ref-type="bibr" rid="R17">17</xref></sup>. Together, they represent not only divergent animal lineages, but also diverse scRNA-seq technologies and different genome assembly and annotation qualities. For each species, we quantified single-cell gene UMI counts for three sets of gene annotations: (<italic>i</italic>) the original annotation, (<italic>ii</italic>) GeneExt-extended gene models, and (<italic>iii</italic>) extended gene models plus orphan peaks. In all cases we used default GeneExt parameters, e.g. to filter out intergenic peaks based on genic peak coverage distributions (<xref ref-type="fig" rid="F2">Fig. 2a</xref>).</p><p id="P9">The fraction of extended genes (<xref ref-type="fig" rid="F2">Fig. 2b</xref>) varies greatly across species, from 3.2% in <italic>A. queenslandica</italic> to 39.9% in <italic>Xenia sp</italic>., while the number of remaining intergenic orphan peaks goes from 416 in <italic>A. queenslandica</italic> to 9,079 in <italic>R. norvegicus</italic>. Similar differences can be found in the length of gene extension (<xref ref-type="fig" rid="F2">Fig. 2c</xref>). This reflects the fact that incomplete or inaccurate gene models, gene over-annotation and/or under-annotation will affect each species differently. For example, the high fraction of modified genes in <italic>Xenia sp</italic>. probably reflects the systematic mis-annotation of 3′ UTRs in this genome. The different sources of annotation biases are also reflected by observed differences in intergenic mapping reduction after extension (<xref ref-type="fig" rid="F2">Fig. 2d</xref>). The high reduction in <italic>T. adhaerens</italic> and <italic>M. leidyi</italic> suggests that most missing information came from 3′-incomplete gene models rather than missing genes. In <italic>S. pistillata</italic>, on the other hand, we observed only a small reduction of intergenic reads after extension, which could be explained by a substantial number of missing genes.</p><p id="P10">Finally, we tested the gain of UMI counts in each single-cell (<xref ref-type="fig" rid="F2">Fig. 2e</xref>) and for each cell type. As expected, inclusion of orphan peaks results in higher UMI gains than simply performing 3′ gene extension. It is apparent that these effects are highly species-specific (again, related with the varying quality of gene annotations in different species), but also cell type-specific, indicating that GeneExt can rescue transcriptomic signal from previously undercounted cell types. This latter effect could be explained by different factors: (<italic>i</italic>) genes that are expressed in rare cell types could be absent in the bulk RNA-seq experiments commonly used for evidence-based gene annotation; or (<italic>ii</italic>) some specialized cell types dedicate a large fraction of their transcriptional output to one or a few genes (e.g. secretory or digestive cells producing proteases), and if these genes belong to families that are systematically mis-annotated for any reason (e.g. they are short or repetitive), this bias will have an outsized effect on these particular cells. Overall, these analyses demonstrate that GeneExt is able to ameliorate the often unanticipated effects that gene annotation inaccuracies can have in the transcriptomes of particular species and cell types.</p><p id="P11">In summary, GeneExt is a versatile tool to adjust existing gene annotations in order to improve scRNA-seq quantification across species. The software requires minimal input (a pre-existing annotation in any format and scRNA-seq reads) and can be used with default parameters suitable for most species. The result is improved gene detection that facilitates the interpretation of single-cell atlases. Moreover, homogenizing gene detection and quantification in different species is crucial for comparative analysis of cell type gene expression, which is particularly relevant in the context of the taxonomic expansion in cell type atlases across the tree of life.</p><p id="P12">GeneExt is freely available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/sebepedroslab/GeneExt">https://github.com/sebepedroslab/GeneExt</ext-link>) under a GNU General Public license, together with test data and usage instructions.</p><sec id="S1" sec-type="methods" specific-use="web-only"><title>Methods</title><sec id="S2"><title>GTF/GFF pre-processing</title><p id="P13">Genome annotation is usually represented by a tabular file where each row corresponds to a single genomic feature. The hierarchical relationships between features are stored in the 9-th column of the file. Thus, any re-ordering of the file creates problems for the downstream tools that aim to infer such relationships. Another relatively common problem is missing unique IDs for the features. In the case of one-transcript-per-gene annotations, the transcripts are often assigned the same IDs as their parenting genes which makes these IDs non-unique. GeneExt attempts to solve some of these problems by the following: <list list-type="order" id="L2"><list-item><p id="P14">It uses gffutils to parse the hierarchical relationships between the features</p></list-item><list-item><p id="P15">It adds missing “gene” features</p></list-item><list-item><p id="P16">It selects a single (longest) transcript per gene</p></list-item><list-item><p id="P17">It only outputs relevant attributes such as “ID” and “Parent”, in case of GFF or “gene_id”/“transcript_id” in case of GTF</p></list-item></list></p><p id="P18">In addition, GeneExt tries to resolve the overlaps between genes on the same strand by: <list list-type="order" id="L3"><list-item><p id="P19">Removing the genes fully contained within another gene</p></list-item><list-item><p id="P20">Giving priority to the upstream gene</p></list-item></list>
</p><p id="P21">Giving priority to an upstream gene is motivated by the 3′ bias in the single-cell RNA-seq data. A signal is more likely to come from a 3′-UTR of an upstream gene than from the 5′-UTR of the downstream gene.</p></sec><sec id="S3"><title>BAM file processing and peak calling and filtering</title><p id="P22">If requested, the alignment file is subsampled (<italic>--subsamplebam</italic>). The reads are then split by strand and peaks are called in each strand using MACS2 software<sup><xref ref-type="bibr" rid="R10">10</xref></sup> using the following parameters: <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mtext>macs2</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>callpeak</mml:mtext><mml:mo>−</mml:mo><mml:mtext>t</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>tmp</mml:mtext><mml:mo>/</mml:mo><mml:mtext>minus</mml:mtext><mml:mo>.</mml:mo><mml:mtext>bam</mml:mtext><mml:mo>−</mml:mo><mml:mtext>f</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>BAM</mml:mtext><mml:mo>−−</mml:mo><mml:mtext>keep</mml:mtext><mml:mo>−</mml:mo><mml:mtext>dup</mml:mtext><mml:mspace width="0.2em"/><mml:mn>20</mml:mn><mml:mo>−</mml:mo><mml:mtext>q</mml:mtext><mml:mspace width="0.2em"/><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mtext>shift</mml:mtext><mml:mspace width="0.2em"/><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mtext>extsize</mml:mtext><mml:mspace width="0.2em"/><mml:mn>100</mml:mn><mml:mo>−−</mml:mo><mml:mtext>broad</mml:mtext><mml:mo>−−</mml:mo><mml:mtext>nomodel</mml:mtext><mml:mo>−−</mml:mo><mml:mi>min</mml:mi><mml:mo>−</mml:mo><mml:mtext>length</mml:mtext><mml:mspace width="0.2em"/><mml:mn>30</mml:mn><mml:mspace width="0.2em"/><mml:mo>−</mml:mo><mml:mtext>n</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>minus</mml:mtext></mml:mrow></mml:math></disp-formula></p></sec><sec id="S4"><title>Gene extension and peak clustering</title><p id="P23">Called peaks are filtered based on the scRNA-seq coverage, calculated per peak as the total coverage divided by the length of the peak. Then, the coverage of the intergenic peaks is compared to the coverage of the peaks falling within genic regions. Intergenic peaks with normalized coverage exceeding the n-th percentile of genic peak coverage (<italic>--peak_perc</italic>; 25th percentile by default) are then kept for extension.</p></sec><sec id="S5"><title>Re-analysis of non-model organism single-cell atlases. For each of the species, three versions of the gene annotations were generated</title><list list-type="order" id="L4"><list-item><p id="P24">Original annotation refined by GeneExt (<italic>--clip_5prime</italic>)</p></list-item><list-item><p id="P25">Output of GeneExt (<italic>--clip_5prime, -m</italic> 5000, <italic>--subsamplebam</italic> 100000000)</p></list-item><list-item><p id="P26">Output of GeneExt (<italic>--clip_5prime, -m</italic> 5000, <italic>--subsamplebam</italic> 100000000, <italic>--orphan</italic>)</p></list-item></list><p id="P27">That is: subsample the dataset to 100M reads, extend the genes to maximum 5000 bp downstream; clip 5′ overlaps in the genome annotation; use 25th coverage percentile for peak filtering; keep orphan peaks.</p><p id="P28">For single-cell atlases obtained with the MARS-seq scRNA-seq technology (<italic>A. queenslandica, M. leidyi, T. adhaerens, N. vectensis</italic>, and <italic>S. pistillata</italic>), we first mapped reads onto the corresponding genome using STAR 2.7.3<sup><xref ref-type="bibr" rid="R18">18</xref></sup>, with parameters: <italic>--outFilterMultimapNmax</italic> 20 <italic>---outFilterMismatchNmax</italic> 8 <italic>--alignIntronMax</italic> 3500. Then we quantified gene expression for each of the three interval sets described above using the MARS-seq pipeline as previously described <sup><xref ref-type="bibr" rid="R19">19</xref></sup>.</p><p id="P29">For <italic>Xenia</italic> sp. we only used the tentacle dataset (10x Chromium v2) and for <italic>O. vulgaris</italic> we only used the single-cell RNA-seq dataset (10x Chromium v3), not single-nuclei data. The R2 reads from each dataset were aligned using STAR v2.7.10a<sup><xref ref-type="bibr" rid="R18">18</xref></sup> to the corresponding genomes<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>. The resulting alignment files were used as an input for GeneExt with the parameters specified above. The resulting genome annotations were used as an input to STARsolo<sup><xref ref-type="bibr" rid="R11">11</xref></sup> with default parameters <italic>(--soloCBlen</italic> 16 <italic>--soloUMIlen</italic> 12 was used in the case of <italic>O. vulgaris</italic> to account for v3 Chromium chemistry).</p></sec></sec></body><back><ack id="S7"><title>Acknowledgements</title><p>Research in A.S-P. group was supported by the European Research Council (ERC-StG 851647) and the Spanish Ministry of Science and Innovation (PID2021-124757NB-I00). We also acknowledge support of the Spanish Ministry of Science and Innovation to the EMBL partnership, the Centro de Excelencia Severo Ochoa and the CERCA Programme (Generalitat de Catalunya). G.Z. is supported INPhINIT PhD fellowship from LaCaixa Foundation LCF/BQ/DI21/11860036. X.G-B. is supported by the European Union’s H2020 research and innovation program under Marie Skłodowska-Curie grant agreement 101031767.</p></ack><ref-list><title>References</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanay</surname><given-names>A</given-names></name><name><surname>Sebé-Pedrós</surname><given-names>A</given-names></name></person-group><article-title>Evolutionary cell type mapping with single-cell genomics</article-title><source>Trends in Genetics</source><year>2021</year><volume>37</volume><fpage>919</fpage><lpage>932</lpage><pub-id pub-id-type="pmid">34020820</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mudge</surname><given-names>JM</given-names></name><name><surname>Harrow</surname><given-names>J</given-names></name></person-group><article-title>The state of play in higher eukaryote gene annotation</article-title><source>Nat Rev Genet</source><year>2016</year><volume>17</volume><fpage>758</fpage><lpage>772</lpage><pub-id pub-id-type="pmcid">PMC5876476</pub-id><pub-id pub-id-type="pmid">27773922</pub-id><pub-id pub-id-type="doi">10.1038/nrg.2016.119</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guigó</surname><given-names>R</given-names></name></person-group><article-title>Genome annotation: From human genetics to biodiversity genomics</article-title><source>Cell Genomics</source><year>2023</year><volume>3</volume><elocation-id>100375</elocation-id><pub-id pub-id-type="pmcid">PMC10435374</pub-id><pub-id pub-id-type="pmid">37601977</pub-id><pub-id pub-id-type="doi">10.1016/j.xgen.2023.100375</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amaral</surname><given-names>P</given-names></name><etal/></person-group><article-title>The status of the human gene catalogue</article-title><source>Nature</source><year>2023</year><volume>622</volume><fpage>41</fpage><lpage>47</lpage><pub-id pub-id-type="pmcid">PMC10575709</pub-id><pub-id pub-id-type="pmid">37794265</pub-id><pub-id pub-id-type="doi">10.1038/s41586-023-06490-x</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zolotarov</surname><given-names>G</given-names></name><etal/></person-group><article-title>MicroRNAs are deeply linked to the emergence of the complex octopus brain</article-title><source>Sci Adv</source><year>2022</year><volume>8</volume><pub-id pub-id-type="pmcid">PMC9699675</pub-id><pub-id pub-id-type="pmid">36427315</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.add9938</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Legnini</surname><given-names>I</given-names></name><name><surname>Alles</surname><given-names>J</given-names></name><name><surname>Karaiskos</surname><given-names>N</given-names></name><name><surname>Ayoub</surname><given-names>S</given-names></name><name><surname>Rajewsky</surname><given-names>N</given-names></name></person-group><article-title>FLAM-seq: full-length mRNA sequencing reveals principles of poly(A) tail length control</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>879</fpage><lpage>886</lpage><pub-id pub-id-type="pmid">31384046</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>MFZ</given-names></name><etal/></person-group><article-title>Uncovering transcriptional dark matter via gene annotation independent single-cell RNA sequencing analysis</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><elocation-id>2158</elocation-id><pub-id pub-id-type="pmcid">PMC8042062</pub-id><pub-id pub-id-type="pmid">33846360</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-22496-3</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haese-Hill</surname><given-names>W</given-names></name><name><surname>Crouch</surname><given-names>K</given-names></name><name><surname>Otto</surname><given-names>TD</given-names></name></person-group><article-title>peaks2utr: a robust Python tool for the annotation of 3′ UTRs</article-title><source>Bioinformatics</source><year>2023</year><volume>39</volume><fpage>2</fpage><lpage>3</lpage><pub-id pub-id-type="pmcid">PMC10008064</pub-id><pub-id pub-id-type="pmid">36864613</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btad112</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weisman</surname><given-names>CM</given-names></name><name><surname>Murray</surname><given-names>AW</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Mixing genome annotation methods in a comparative analysis inflates the apparent number of lineage-specific genes</article-title><source>Current Biology</source><year>2022</year><volume>32</volume><fpage>2632</fpage><lpage>2639</lpage><elocation-id>e2</elocation-id><pub-id pub-id-type="pmcid">PMC9346927</pub-id><pub-id pub-id-type="pmid">35588743</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2022.04.085</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Model-based analysis of ChIP-Seq (MACS)</article-title><source>Genome Biol</source><year>2008</year><volume>9</volume><elocation-id>R137</elocation-id><pub-id pub-id-type="pmcid">PMC2592715</pub-id><pub-id pub-id-type="pmid">18798982</pub-id><pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaminow</surname><given-names>B</given-names></name><name><surname>Yunusov</surname><given-names>D</given-names></name><name><surname>Dobin</surname><given-names>A</given-names></name></person-group><article-title>STARsolo: accurate, fast and versatile mapping/quantification of single-cell and single-nucleus RNA-seq data</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021.05.05.442755</elocation-id><pub-id pub-id-type="doi">10.1101/2021.05.05.442755</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sebé-Pedrós</surname><given-names>A</given-names></name><etal/></person-group><article-title>Early metazoan cell type diversity and the evolution of multicellular gene regulation</article-title><source>Nat Ecol Evol</source><year>2018</year><volume>2</volume><fpage>1176</fpage><lpage>1188</lpage><pub-id pub-id-type="pmcid">PMC6040636</pub-id><pub-id pub-id-type="pmid">29942020</pub-id><pub-id pub-id-type="doi">10.1038/s41559-018-0575-6</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sebé-Pedrós</surname><given-names>A</given-names></name><etal/></person-group><article-title>Cnidarian Cell Type Diversity and Regulation Revealed by Whole-Organism Single-Cell RNA-Seq</article-title><source>Cell</source><year>2018</year><volume>173</volume><fpage>1520</fpage><lpage>1534</lpage><elocation-id>e20</elocation-id><pub-id pub-id-type="pmid">29856957</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>S</given-names></name><etal/></person-group><article-title>A stony coral cell atlas illuminates the molecular and cellular basis of coral symbiosis, calcification, and immunity</article-title><source>Cell</source><volume>184</volume><year>2021</year><fpage>2973</fpage><lpage>2987</lpage><elocation-id>e18</elocation-id><pub-id pub-id-type="pmcid">PMC8162421</pub-id><pub-id pub-id-type="pmid">33945788</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.005</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>M</given-names></name><name><surname>Zheng</surname><given-names>X</given-names></name><name><surname>Fan</surname><given-names>C-M</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name></person-group><article-title>Lineage dynamics of the endosymbiotic cell type in the soft coral Xenia</article-title><source>Nature</source><year>2020</year><volume>582</volume><fpage>534</fpage><lpage>538</lpage><pub-id pub-id-type="pmcid">PMC7332420</pub-id><pub-id pub-id-type="pmid">32555454</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2385-7</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Styfhals</surname><given-names>R</given-names></name><etal/></person-group><article-title>Cell type diversity in a developing octopus brain</article-title><source>Nat Commun</source><year>2022</year><volume>13</volume><elocation-id>7392</elocation-id><pub-id pub-id-type="pmcid">PMC9712504</pub-id><pub-id pub-id-type="pmid">36450803</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-35198-1</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savell</surname><given-names>KE</given-names></name><etal/></person-group><article-title>A dopamine-induced gene expression signature regulates neuronal function and cocaine response</article-title><source>Sci Adv</source><year>2020</year><volume>6</volume><pub-id pub-id-type="pmcid">PMC7314536</pub-id><pub-id pub-id-type="pmid">32637607</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.aba4221</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A</given-names></name><etal/></person-group><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC3530905</pub-id><pub-id pub-id-type="pmid">23104886</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keren-Shaul</surname><given-names>H</given-names></name><etal/></person-group><article-title>MARS-seq2.0: an experimental and analytical pipeline for indexed sorting combined with single-cell RNA sequencing</article-title><source>Nat Protoc</source><year>2019</year><volume>14</volume><fpage>1841</fpage><lpage>1862</lpage><pub-id pub-id-type="pmid">31101904</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destanović</surname><given-names>D</given-names></name><etal/></person-group><article-title>A chromosome-level reference genome for the common octopus, Octopus vulgaris (Cuvier, 1797)</article-title><source>G3: Genes, Genomes, Genetics</source><year>2023</year><elocation-id>jkad220</elocation-id><pub-id pub-id-type="pmcid">PMC10700109</pub-id><pub-id pub-id-type="pmid">37850903</pub-id><pub-id pub-id-type="doi">10.1093/g3journal/jkad220</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>GeneExt tool overview.</title><p><bold>a</bold>, GeneExt main function. <bold>n</bold>, Schematic representation of the main steps and associated options.</p></caption><graphic xlink:href="EMS192649-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>GeneExt application to cell atlases from different species.</title><p><bold>a</bold>, Read coverage in called peaks intersecting known exons (“genic peaks”) and intergenic regions. The dashed line indicates the default 25th percentile of genic peaks coverage distribution used to filter intergenic peaks. <bold>b</bold>, Barplots indicating the number of extended genes and number of orphan peaks called in different species using GeneExt default parameters. <bold>c</bold>, Distributions of gene extension lengths across species. The number of extended genes and the median extension length are indicated. <bold>d</bold>, Barplots indicating the percentage of scRNA-seq reads mapping to intergenic regions before and after extending gene annotations in each species. <bold>e</bold>, Boxplots indicating median single-cell UMI gains after extending gene annotations and stratified by cell types (individual dots). Gains are calculated as a median percentage of increase relative to the original UMI counts in each cell.</p></caption><graphic xlink:href="EMS192649-f002"/></fig></floats-group></article>