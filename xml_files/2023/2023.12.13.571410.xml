<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS192797</article-id><article-id pub-id-type="doi">10.1101/2023.12.13.571410</article-id><article-id pub-id-type="archive">PPR773642</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Knowing what you don’t know: Estimating the uncertainty of feedforward and feedback inputs with prediction-error circuits</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hertäg</surname><given-names>Loreen</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Wilmes</surname><given-names>Katharina A.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Clopath</surname><given-names>Claudia</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib></contrib-group><aff id="A1"><label>1</label>Modeling of Cognitive Processes, TU Berlin, Berlin, Germany</aff><aff id="A2"><label>2</label>Department of Physiology, University of Bern, Switzerland</aff><aff id="A3"><label>3</label>Bioengineering Department, Imperial College London, London, UK</aff><author-notes><corresp id="CR1">
<label>*</label><email>loreen.hertaeg@tu-berlin.de</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>15</day><month>12</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>14</day><month>12</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">At any moment, our brains receive a stream of sensory stimuli arising from the world we interact with. Simultaneously, neural circuits are shaped by feedback signals carrying predictions about the same inputs we experience. Those feedforward and feedback inputs often do not perfectly match. Thus, our brains have the challenging task of integrating these conflicting streams of information according to their reliabilities. However, how neural circuits keep track of both the stimulus and prediction uncertainty is not well understood. Here, we propose a network model whose core is a hierarchical prediction-error circuit. We show that our network can estimate the variance of the sensory stimuli and the uncertainty of the prediction using the activity of negative and positive prediction-error neurons. In line with previous hypotheses, we demonstrate that neural circuits rely strongly on feedback predictions if the perceived stimuli are noisy and the underlying generative process, that is, the environment is stable. Moreover, we show that predictions modulate neural activity at the onset of a new stimulus, even if this sensory information is reliable. In our network, the uncertainty estimation, and, hence, how much we rely on predictions, can be influenced by perturbing the intricate interplay of different inhibitory interneurons. We, therefore, investigate the contribution of those inhibitory interneurons to the weighting of feedforward and feedback inputs. Finally, we show that our network can be linked to biased perception and unravel how stimulus and prediction uncertainty contribute to the contraction bias.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">To survive in an ever-changing environment, animals must flexibly adapt their behavior based on previously encoded and novel information. This adaptation is reflected in the information processing of neural networks underlying context-dependent behavior. For instance, when you walk down an unknown staircase in a fully lit basement, your brain might entirely rely on the feedforward (bottom-up) input your senses receive (<xref ref-type="fig" rid="F1">Fig. 1A</xref>, left). In contrast, when you walk down the same stairs in complete darkness, your brain might rely entirely on feedback (top-down) signals generated from a staircase model it has formed over previous experiences (<xref ref-type="fig" rid="F1">Fig. 1A</xref>, middle). But how do neural networks switch between a feedforward-dominated and a feedback-dominated processing mode? And how do neural networks in the brain combine both input streams wisely? For instance, if you hike down an unexplored mountain in very foggy conditions, your brain receives unreliable visual information. In addition, it can only draw on a shaky prediction about what to expect (<xref ref-type="fig" rid="F1">Fig. 1A</xref>, right).</p><p id="P3">A common hypothesis is that the brain weights different inputs according to their reliabilities. A prominent example of this hypothesis is Bayesian multisensory integration (see, e.g., <xref ref-type="bibr" rid="R16">Deneve and Pouget, 2004</xref>). According to this theory, neural networks represent information from multiple modalities by a linear combination of the uncertainty-weighted single-modality estimates. Multisensory integration is supported by several observations showing that animals can combine information from different modalities in a fashion that minimizes the variance of the final estimate (<xref ref-type="bibr" rid="R18">Ernst and Banks, 2002</xref>; <xref ref-type="bibr" rid="R9">Battaglia et al., 2003</xref>; <xref ref-type="bibr" rid="R44">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="R2">Alais and Burr, 2004</xref>; <xref ref-type="bibr" rid="R67">Rowland et al., 2007</xref>; <xref ref-type="bibr" rid="R23">Gu et al., 2008</xref>; <xref ref-type="bibr" rid="R20">Fetsch et al., 2012</xref>). Here, we propose that the same concepts could be employed for the weighting of sensory inputs and predictions thereof (<xref ref-type="bibr" rid="R44">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). A central point in the weighting of inputs is the estimation of their variances as a measure of uncertainty. However, how the variance of both the sensory input and the prediction can be computed on the circuit level is not resolved yet.</p><p id="P4">We hypothesized that prediction error (PE) neurons provide the basis for the neural computation of variances. PEs are an integral part of the theory of predictive processing which states that the brain constantly compares incoming sensory information with predictions. If those predictions are wrong, the resulting PEs allow the network to revise the model of the world, thereby ensuring that the predictions become more accurate (<xref ref-type="bibr" rid="R40">Keller and Mrsic-Flogel, 2018</xref>). Experimental evidence suggests that these PEs may be represented in the activity of distinct groups of neurons, termed PE neurons (<xref ref-type="bibr" rid="R17">Eliades and Wang, 2008</xref>; <xref ref-type="bibr" rid="R39">Keller and Hahnloser, 2009</xref>; <xref ref-type="bibr" rid="R7">Ayaz et al., 2019</xref>; <xref ref-type="bibr" rid="R5">Audette et al., 2021</xref>). Moreover, these neurons may come in two types when excitatory neurons exhibit near-zero, spontaneous firing rates (<xref ref-type="bibr" rid="R65">Rao and Ballard, 1999</xref>; <xref ref-type="bibr" rid="R40">Keller and Mrsic-Flogel, 2018</xref>): negative PE (nPE) neurons only increase their activity when the prediction is <italic>stronger</italic> than the sensory input, while positive PE (pPE) neurons only increase their activity when the prediction is <italic>weaker</italic> than the sensory input. Indeed, it has been shown that excitatory neurons in rodent primary sensory areas can encode negative or positive PEs (<xref ref-type="bibr" rid="R41">Keller et al., 2012</xref>; <xref ref-type="bibr" rid="R4">Attinger et al., 2017</xref>; <xref ref-type="bibr" rid="R37">Jordan and Keller, 2020</xref>; <xref ref-type="bibr" rid="R5">Audette et al., 2021</xref>).</p><p id="P5">Here, we show that the unique response patterns of nPE and pPE neurons may provide the backbone for computing both the mean and the variance of sensory stimuli. Furthermore, we suggest a network model with a hierarchy of PE circuits to estimate the variance of the prediction, in addition to the variance of the sensory inputs. We show that in line with the ideas of multisensory integration, predictions are weighted more strongly than the sensory stimuli when the environment is stable (that is, predictable) and the sensory inputs are noisy. Moreover, we find that predictions are taken into account more at the beginning of a new trial than at the end, especially when the new sensory stimulus is reliable. In addition, we unravel the mechanisms underlying a neuromodulator-induced shift in the weighting of sensory inputs and predictions. In our model, these neuromodulators activate groups of inhibitory neurons such as parvalbumin-expressing (PV), somatostatin-expressing (SOM), and vasoactive intestinal peptide-expressing (VIP) interneurons (<xref ref-type="bibr" rid="R50">Markram et al., 2004</xref>; <xref ref-type="bibr" rid="R68">Rudy et al., 2011</xref>; <xref ref-type="bibr" rid="R62">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="R35">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="R76">Tremblay et al., 2016</xref>; <xref ref-type="bibr" rid="R12">Campagnola et al., 2022</xref>). These interneurons have been suggested to establish a multi-pathway balance of excitation and inhibition that is the basis for nPE and pPE neurons (<xref ref-type="bibr" rid="R30">Hertäg and Sprekeler, 2020</xref>; <xref ref-type="bibr" rid="R29">Hertäg and Clopath, 2022</xref>). By breaking this balance, the PE neurons change their baseline firing rate and gain, leading to a biased variance estimation. Finally, we show that this weighting can be understood as a neural manifestation of the contraction bias, that is, the magnitude of the represented sensory input is biased towards the mean of the past stimuli experienced (<xref ref-type="bibr" rid="R31">Hollingworth, 1910</xref>; <xref ref-type="bibr" rid="R34">Jazayeri and Shadlen, 2010</xref>; <xref ref-type="bibr" rid="R3">Ashourian and Loewenstein, 2011</xref>; <xref ref-type="bibr" rid="R61">Petzschner and Glasauer, 2011</xref>; <xref ref-type="bibr" rid="R1">Akrami et al., 2018</xref>; <xref ref-type="bibr" rid="R52">Meirhaeghe et al</xref>.).</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Prediction-error neurons as the basis for estimating the mean and variance of sensory stimuli</title><p id="P6">We hypothesize that the distinct response patterns of negative and positive prediction-error (nPE/pPE) neurons act as a backbone for estimating the mean and the variance of sensory stimuli. An nPE neuron only increases its activity relative to a baseline when the sensory input is weaker than predicted, while a pPE neuron only increases its activity relative to a baseline when the sensory input is stronger than predicted. Moreover, both nPE and pPE neurons remain at their baseline activities when the sensory input is fully predicted (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). If the prediction equals the mean of the sensory stimulus, the PE neurons, hence, encode the deviation from the mean. Thus, the squared sum of nPE and pPE neuron activity represents the variance of the feedforward input (provided that the PE neurons are silent without sensory stimulation).</p><p id="P7">To test our hypothesis, we study a rate-based mean-field network: the core network is a prediction-error (PE) circuit with excitatory nPE and pPE neurons, as well as inhibitory parvalbumin-expressing (PV), somatostatin-expressing (SOM), and vasoactive intestinal peptide-expressing (VIP) interneurons (<xref ref-type="fig" rid="F1">Fig. 1B</xref>). While the excitatory neurons are simulated as two coupled point compartments to emulate the soma and dendrites of elongated pyramidal cells, respectively, all inhibitory cell types were modeled as point neurons. The connectivity of and inputs to the network were chosen such that the excitatory (E) and inhibitory (I) pathways onto the pyramidal cells were partially balanced. This balance that is only temporarily broken during mismatches has been shown to be necessary for nPE and pPE neurons to emerge (<xref ref-type="bibr" rid="R30">Hertäg and Sprekeler, 2020</xref>; <xref ref-type="bibr" rid="R29">Hertäg and Clopath, 2022</xref>, see Methods).</p><p id="P8">We assume that this core circuit is shaped by feedback connections (<xref ref-type="bibr" rid="R46">Larkum, 2013</xref>; <xref ref-type="bibr" rid="R25">Harris and Shepherd, 2015</xref>) that have been hypothesized to carry information about expectations or predictions (<xref ref-type="bibr" rid="R54">Mumford, 1992</xref>; <xref ref-type="bibr" rid="R46">Larkum, 2013</xref>; <xref ref-type="bibr" rid="R21">Friston, 2008</xref>). To account for predictions, we model a memory (M) neuron that integrates the activity of the PE neurons (<xref ref-type="fig" rid="F1">Fig. 1C</xref>). Following <xref ref-type="bibr" rid="R40">Keller and Mrsic-Flogel (2018)</xref>, we assume that the pPE neuron excites the memory neuron, while the nPE neuron inhibits this neuron (for instance, through lateral inhibition, here not modeled explicitly). Because feedback connections are shown to target the apical dendrites of pyramidal cells (<xref ref-type="bibr" rid="R46">Larkum, 2013</xref>) and interneurons located in superficial layers of the cortex (see, e.g. <xref ref-type="bibr" rid="R76">Tremblay et al., 2016</xref>), the memory neuron makes connections with the dendritic compartment of the PE neurons and some of the interneurons (here, VIP and PV neurons, see Methods for more details). We, furthermore, simulate a downstream neuron (termed V neuron), modeled as a leaky integrator with a quadratic activation function, that receives excitatory synapses from the PE neurons. In this setting, the V neuron encodes the variance of the sensory stimuli (see the lower-level subnetwork in <xref ref-type="fig" rid="F1">Fig. 1C</xref>, the higher-level circuit is described later).</p><p id="P9">To show that this network can indeed represent the mean and the variance in the respective neurons, we stimulate it with a sequence of step-wise constant inputs drawn from a uniform distribution (<xref ref-type="fig" rid="F2">Fig. 2A</xref>). We, hence, assume that the sensory stimulus varies over time. In line with the distinct response patterns for nPE and pPE neurons, these neurons change only slightly with increasing stimulus mean but increase strongly with input variance (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). In contrast, the three interneurons strongly increase with stimulus mean and only moderately increase with stimulus variance (<xref ref-type="fig" rid="F2">Fig. 2C</xref>). The activity of the memory neuron gradually approaches the mean of the sensory inputs (<xref ref-type="fig" rid="F2">Fig. 2D</xref>, middle), while the activity of the V neuron approaches the variance of those inputs (<xref ref-type="fig" rid="F2">Fig. 2E</xref>, middle). We show that this holds for a wide range of input statistics (<xref ref-type="fig" rid="F2">Fig. 2D-E</xref>, right) and input distributions (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). Small deviations from the true mean occur mainly for large input variances, while the estimated variance is fairly independent of the input statistics tested.</p><p id="P10">We verified our results in a heterogeneous network in which a population of neurons belongs to each neuron type of the PE circuit, and the synaptic connection strengths from each PE neuron onto the M and V neuron are different (see Methods, <xref ref-type="supplementary-material" rid="SD1">Fig. S2A</xref>). As before, the network can correctly estimate the mean and the variance of the sensory stimuli (<xref ref-type="supplementary-material" rid="SD1">Fig. S2B</xref>). Furthermore, we show that the errors with which the M and V neurons encode the stimulus statistics are independent of uncorrelated modulations of those connection strengths (<xref ref-type="supplementary-material" rid="SD1">Fig. S2C</xref>) and the sparsity of the network (<xref ref-type="supplementary-material" rid="SD1">Fig. S2E</xref>). When all connection strengths are collectively shifted to higher values, the error increases for the variance neuron, while it remains unaffected for the memory neuron.</p><p id="P11">While our mean-field network was designed to track the mean and the variance of stimuli that vary in time, we reasoned that the same principles apply to stimuli that vary across space. To show that, we simulated a population network that consists of unconnected replicates of the mean-field network described above (<xref ref-type="supplementary-material" rid="SD1">Fig. S3A</xref>). Each mean-field network receives a short, constant input from a different part of the receptive field. If the connection strengths from the PE neurons to the M and V neurons are adjusted accordingly (see Methods), the network correctly estimates the stimulus average and spatial uncertainty (<xref ref-type="supplementary-material" rid="SD1">Fig. S3B-C</xref>).</p><p id="P12">In summary, nPE and pPE neurons can serve as a basis to estimate the mean and the variance of sensory stimuli which vary over time and space.</p></sec><sec id="S4"><title>Estimating the uncertainty of both the sensory input and the prediction requires a hierarchy of PE circuits</title><p id="P13">Following the ideas of Bayesian multisensory integration, the weighting of sensory stimuli and predictions would require knowledge about their uncertainties. As we have shown in the previous section, the variance of the sensory stimulus can be estimated using PE neurons. We hypothesize that the same principles apply to computing the variance of the prediction. To show this, we augment the network with a <italic>higher</italic> PE circuit that receives feedforward synapses from the memory (M) neuron of the <italic>lower</italic> PE circuit (<xref ref-type="fig" rid="F1">Fig. 1D</xref>). Both subnetworks are identical except for the M neuron in the higher PE circuit which is modeled with slower dynamics than the one in the lower PE circuit.</p><p id="P14">To test the network’s ability to estimate the variances correctly, we stimulated the network with a sequence of inputs whose mean can vary from trial to trial. More precisely, in each trial, the network is given a stimulus that is composed of <italic>N</italic><sub>in</sub> constant values, each drawn from a normal distribution and presented for <italic>N</italic><sub>step</sub> consecutive time steps. The variance of this distribution represents the stimulus noise. To account for potential changes in the environment, we draw the stimulus mean from a uniform distribution (<xref ref-type="fig" rid="F3">Fig. 3A</xref>). Hence, the inputs change on two different time scales.</p><p id="P15">Following the formalism of multisensory integration (see, e.g. <xref ref-type="bibr" rid="R63">Pouget et al., 2013</xref>), we assume that the network’s output is a weighted sum of the feedforward sensory input and the feedback prediction. The weights assigned to each input stream are functions of the uncertainties, that is, the activities of the V neurons. The sensory weight captures how much the network relies on the sensory input (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). To test our network, we first consider two limit cases. In the first limit case, we show a low-variance stimulus that differs in each trial (low stimulus uncertainty, high trial-to-trial uncertainty, see <xref ref-type="fig" rid="F3">Fig. 3C</xref>, left). According to the theory, the network should follow the sensory inputs closely and ignore the predictions. When we arithmetically calculate the weighted output (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, middle) and the sensory weight (<xref ref-type="fig" rid="F3">Fig. 3C</xref>, right), the network indeed shows a clear preference for the sensory input. In the second limit case, we show a high-variance stimulus, the mean of which does not change from trial to trial (high stimulus uncertainty, low trial-to-trial uncertainty, see <xref ref-type="fig" rid="F3">Fig. 3D</xref>, left). According to the theory, the network should downscale the sensory feedforward input and weight the prediction more strongly. Indeed, the weighted output of the network shows a clear tendency to the mean of the stimuli (<xref ref-type="fig" rid="F3">Fig. 3D</xref>, middle), also reflected in the low sensory weight (<xref ref-type="fig" rid="F3">Fig. 3D</xref>, right).</p><p id="P16">To validate the network responses fully, we systematically varied the trial and stimulus variability independently. If both variances are similar, the sensory weight approaches <italic>0</italic>.<italic>5</italic>, reflecting equal contribution of the sensory input and the prediction to the weighted output. Only if both variances are zero, the network represents the sensory input perfectly. In line with the limit case examples above, if the stimulus variance is larger than the trial variance, the network weights the prediction more strongly than the sensory input (<xref ref-type="fig" rid="F3">Fig. 3E</xref>). Because the network dynamically estimates the sensory and prediction uncertainty, the sensory weight changes when the input statistics shifts (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>).</p><p id="P17">Inspecting closely the dynamics of our network, we noticed that the prediction is typically weighted higher at the beginning of a new trial than in the steady state. This is particularly pronounced in a sensory-driven input regime (see <xref ref-type="fig" rid="F3">Fig. 3C</xref>). This is further confirmed in simulations in which the trail duration was shortened (<xref ref-type="fig" rid="F3">Fig. 3F</xref>). Our model makes therefore the following experimentally testable prediction: sensory predictions influence neural activity more significantly in experiments that rely on fast stimulus changes.</p><p id="P18">It has been hypothesized, that some symptoms in psychiatric disorders like autism and schizophrenia can be ascribed to a pathological weighting of sensory inputs and predictions (<xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). We thus wondered which network properties might bias the estimation of the variances, and, consequently, the weighting of different input streams. We identified the time scales at which the memory neurons incorporate new information as a decisive factor in the integration of inputs. To show this, we varied the weights from the PE neurons onto the lower-level memory neuron. If the weights are too small (the memory neuron updates too slowly), the system relies too much on feedback predictions. In contrast, if the weights are too large (the memory neuron updates too fast), the system relies too much on the feedforward sensory information (<xref ref-type="supplementary-material" rid="SD1">Fig. S5A</xref>). While the speeds at which the activity of the memory neurons evolve influence the weighting of inputs, the precise activation function of the variance neurons is less pivotal. When we replaced the quadratic activation function with a linear, rectified function, the V neurons did not encode the variance but the average absolute deviation of the sensory stimuli. However, the sensory weight is only slightly shifted to larger values for low trial/high stimulus variability (<xref ref-type="supplementary-material" rid="SD1">Fig. S5B</xref>).</p><p id="P19">In summary, we show that the variances of both the sensory inputs and predictions thereof can be dynamically computed in networks comprising a lower and higher PE circuit. In such a network, predictions are given more weight at the beginning of a new stimulus, and if the sensory inputs are noisy while the environment is stable.</p></sec><sec id="S5"><title>Biasing the weighting of sensory inputs and predictions by neuromodulators</title><p id="P20">The brain’s flexibility and adaptability are supported by a plethora of neuromodulators which influence the activity of neurons in a variety of ways (<xref ref-type="bibr" rid="R6">Avery and Krichmar, 2017</xref>). A prominent target of neuromodulatory inputs is inhibitory neurons (<xref ref-type="bibr" rid="R13">Cardin, 2019</xref>; <xref ref-type="bibr" rid="R27">Hattori et al., 2017</xref>; <xref ref-type="bibr" rid="R75">Swanson and Maffei, 2019</xref>). Moreover, distinct interneuron types are differently (in-)activated by those neuromodulators (<xref ref-type="bibr" rid="R79">Wester and McBain, 2014</xref>; <xref ref-type="bibr" rid="R27">Hattori et al., 2017</xref>; <xref ref-type="bibr" rid="R75">Swanson and Maffei, 2019</xref>). We, therefore, wondered if and how the weighting of sensory inputs and predictions thereof may be biased when neuromodulators activate distinct interneuron types.</p><p id="P21">To this end, we modeled the presence of a neuromodulator by injecting an additional excitatory input into an interneuron type (while a neuromodulator can also suppress neuronal activity, we focus on the more common excitatory effects that have been described). We reasoned that the network effect of a neuromodulator not only depends on the interneuron type it targets but also on the inputs this neuron receives and the connections it makes with other neurons in the network. We, therefore, tested different mean-field networks that differ in the distribution of sensory inputs and predictions onto the interneurons, and the underlying connectivity. The commonality across those networks is that they exhibit an E/I balance of excitatory and inhibitory pathways onto the PE neurons (<xref ref-type="bibr" rid="R29">Hertäg and Clopath, 2022</xref>).</p><p id="P22">Across the different mean-field networks tested, increasing the activity of PV neurons biases the network’s output toward predictions (<xref ref-type="fig" rid="F4">Fig. 4A</xref> left). In contrast, increasing VIP activity forces the networks to weigh both inputs more equally. As a consequence, predictions are overrated in a sensory-driven input regime, and, sensory inputs are overrated in a prediction-driven input regime (<xref ref-type="fig" rid="F4">Fig. 4A</xref> right). Increasing SOM neuron activity, while qualitatively similar to increasing VIP neuron activity, depends on the mean-field network tested and the strength of activation (<xref ref-type="fig" rid="F4">Fig. 4A</xref> middle).</p><p id="P23">Neuromodulators are most likely increasing the activity of more than one interneuron type. To account for the co-activation of interneurons, we injected an excitatory input into two interneuron types at the same time and varied the strength with which each interneuron was modulated (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). If PV neurons are the major target of a neuromodulator, the network is still biased toward predictions. If SOM and VIP neurons are equally stimulated, the weighting of sensory inputs and predictions remains largely unaffected (<xref ref-type="fig" rid="F4">Fig. 4B</xref>), suggesting that the individual effects cancel out.</p><p id="P24">What are the network mechanisms underlying these observations? The sensory weight is a function of the lower and higher variance (V) neuron activity. Hence, any changes to the sensory weight result from changes to the neurons encoding the variances. In our network, the V neurons only receive excitatory synapses from PE neurons. As a consequence, any changes in the sensory weights upon activation of interneurons must be due to changes in the PE neurons. To disentangle the effect of nPE and pPE neurons, we perturbed those neurons individually in both the lower or higher subnetwork by injecting either an inhibitory or excitatory additional input (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). Stimulating either PE neuron in the lower subnetwork increases the activity of the lower-level V neuron strongly. Moreover, the higher-level V neuron is also slightly affected. This is because the lower-level memory neuron is also modulated by the lower-level PE neurons and makes feedforward connections to the higher-level PE circuit. In contrast, stimulating either PE neuron in the higher subnetwork increases the activity of the higher-level V neuron but leaves the lower-level neurons unaffected.</p><p id="P25">This suggests that to understand the effect of neuromodulators on the sensory weight, we need to unravel the effect of interneuron activation on PE neurons. Increasing interneuron activity leads to changes in the baseline and gain of PE neurons that bias the estimation of mean and variance (<xref ref-type="supplementary-material" rid="SD1">Fig. S8</xref>, see Methods). In all three networks tested, activating PV neurons decreases both baseline and gain of the PE neurons, leading to a decrease in the estimated variance (<xref ref-type="fig" rid="F4">Fig. 4D</xref> &amp; <xref ref-type="supplementary-material" rid="SD1">Fig. S9</xref>). Stimulating the SOM or VIP neuron decreases the gain in either nPE or pPE neuron. However, the baseline of those neurons can either decrease or increase depending on the connectivity with other neurons in the network. The summed effect over nPE and pPE neuron (<xref ref-type="supplementary-material" rid="SD1">Fig. S9</xref>) suggests that whether the activity of the V neuron increases or decreases depends on the input statistics: for low-mean stimuli, the elevated baseline activity dominates the changes in the variance, while for high-mean stimuli the changes in the gain dominate.</p><p id="P26">Altogether, we show that neuromodulators increasing the activity of interneurons bias the weighting of sensory inputs and predictions by changing the gain and baseline of PE neurons. Whether the sensory weight increases or decreases depends not only on the interneuron it targets but also on the network it is embedded in and the input regime.</p></sec><sec id="S6"><title>Explaining the contraction bias with the weighting of sensory inputs and predictions</title><p id="P27">We hypothesized that the weighted integration of sensory inputs and predictions thereof manifests in all-day behavior, in the form of a phenomenon called <italic>contraction bias</italic>. The contraction bias describes the tendency to overestimate sensory stimuli drawn from the lower end of a stimulus distribution and to underestimate stimuli drawn from the upper end of the same distribution. This <italic>bias toward the mean</italic> has been reported in different species and modalities (<xref ref-type="bibr" rid="R31">Hollingworth, 1910</xref>; <xref ref-type="bibr" rid="R34">Jazayeri and Shadlen, 2010</xref>; <xref ref-type="bibr" rid="R3">Ashourian and Loewenstein, 2011</xref>; <xref ref-type="bibr" rid="R61">Petzschner and Glasauer, 2011</xref>; <xref ref-type="bibr" rid="R1">Akrami et al., 2018</xref>; <xref ref-type="bibr" rid="R52">Meirhaeghe et al</xref>.).</p><p id="P28">We first investigated whether the network’s output can be interpreted as a neuronal manifestation of the contraction bias (see Methods for an illustrative analysis). To this end, we define the contraction bias as the trial-averaged difference between the weighted output and the sensory stimulus. When plotted over the trail-averaged stimuli, the bias is positive for stimuli below the mean of the input distribution and negative for stimuli above the mean (<xref ref-type="fig" rid="F5">Fig. 5A</xref>), in line with a <italic>bias toward the mean</italic>. To measure the amount of bias in the network, we use the slope of the linear fit to the relationship between bias and trial stimulus. The larger the absolute slope, the larger the bias.</p><p id="P29">What are the underlying network factors that contribute to the neuronal contraction bias in the network? We have seen that how much the prediction is taken into account is determined by both the lower and higher-level V neurons encoding the variance of the stimulus and the prediction. Hence, the bias must be similarly influenced by these factors. When we increase the stimulus uncertainty, the bias increases (<xref ref-type="fig" rid="F5">Fig. 5B</xref>). In contrast, when we increase the trial-to-trial uncertainty, the bias decreases (<xref ref-type="fig" rid="F5">Fig. 5B</xref>).</p><p id="P30">To further disentangle the different sources of the bias, we first simulated a network without stimulus uncertainty (variance set to zero) for two trial-to-trail variances (volatility of the environment). In this case, the emerging contraction bias is independent of the volatility of the environment (<xref ref-type="fig" rid="F5">Fig. 5C</xref>). We show mathematically that the bias results from the network output not yet reaching its new steady state within the trial duration (see Methods). In other words, the bias is the difference between the weighted output at the end of the trial and its steady state (the shown stimulus). How fast the new steady state is reached depends only on the time constants in the network and not the trial-to-trial variability. We next resume the limit case in which the stimulus uncertainty is high while the trial-to-trial uncertainty is zero. In this case, the contraction bias is also largely independent of the stimulus variance (<xref ref-type="fig" rid="F5">Fig. 5D</xref>). Our mathematical analysis reveals that the bias is well described by the difference between the prediction, that is, mean stimulus over the history of all stimuli shown, and the current stimulus, weighted by a function of the trial duration.</p><p id="P31">The analysis of both limit cases suggests that the bias also depends on the trial duration. To confirm this, we extended the trial duration for either limit case. As expected from the analysis, the bias decreases steadily in the simulations (<xref ref-type="fig" rid="F5">Fig. 5E</xref>). We, therefore, predict that the contraction bias can be reduced for sufficiently long trials.</p><p id="P32">So far, we assumed that the stimulus variance is independent of the stimulus mean. A consequence of this choice is that the bias on either end of the input distribution is largely the same (but with reversed signs). However, behavioral data (see, e.g. <xref ref-type="bibr" rid="R64">Rakitin et al., 1998</xref>) shows that the bias increases for stimuli drawn from the upper end of the distribution, a phenomenon usually attributed to <italic>scalar variability</italic>. To capture this in the model, we assume that the stimulus standard deviation linearly increases with the stimulus mean. In these simulations, as expected, the bias increases for a stimulus distribution shifted to higher trial means (<xref ref-type="supplementary-material" rid="SD1">Fig. S10</xref>).</p><p id="P33">In summary, we show that the weighted integration of sensory inputs and predictions can be interpreted as a neural manifestation of the contraction bias. While the stimulus and trial-to-trial variability shape the contraction bias, their contributions differ. Moreover, we reveal that the trial duration contributes to the bias.</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P34">Our work has been driven by the puzzling question of how the brain integrates top-down feedback predictions with the sensory feedforward bottom-up inputs it constantly receives during behavior. This task may be particularly challenging when the prediction and the sensory information differ (<xref ref-type="bibr" rid="R24">Han and Helmchen, 2023</xref>). Conflicting information may be caused by noise in the sensory feedforward inputs or by changes in the environment that could not be predicted. A prominent hypothesis is that how much we rely on our predictions and new sensory evidence is determined by an intricate balance between both, based on how reliable they are (see e.g. <xref ref-type="bibr" rid="R44">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>).</p><p id="P35">This idea is consistent with Bayesian theories on the optimal integration of multiple sensory cues (multisensory integration). <xref ref-type="bibr" rid="R18">Ernst and Banks (2002)</xref> showed that to estimate the height of a bar humans combine visual and haptic information in a fashion that minimizes the variance of the final estimate. Similar studies confirmed that animals can optimally combine multiple sensory information by taking into account their uncertainties (<xref ref-type="bibr" rid="R9">Battaglia et al., 2003</xref>; <xref ref-type="bibr" rid="R44">Körding and Wolpert, 2004</xref>; <xref ref-type="bibr" rid="R2">Alais and Burr, 2004</xref>; <xref ref-type="bibr" rid="R67">Rowland et al., 2007</xref>; <xref ref-type="bibr" rid="R23">Gu et al., 2008</xref>; <xref ref-type="bibr" rid="R20">Fetsch et al., 2012</xref>). These behavioral studies were accompanied by neural recordings identifying populations of neurons that can form the basis of multisensory integration (<xref ref-type="bibr" rid="R78">Wallace et al., 1998</xref>; <xref ref-type="bibr" rid="R23">Gu et al., 2008</xref>; <xref ref-type="bibr" rid="R20">Fetsch et al., 2012</xref>).</p><sec id="S8"><title>Summary of findings</title><p id="P36">Here, we show that PE neurons can serve as the backbone for estimating the uncertainty of both the feedforward sensory inputs and the feedback predictions (<xref ref-type="fig" rid="F2">Figs. 2</xref> &amp; <xref ref-type="fig" rid="F3">3</xref>). In our model, we assume a hierarchy of PE circuits that are feed-forwardly connected through the lower-order memory neuron whose activity encodes the mean of the sensory bottom-up inputs. This local prediction is fed back to the lower-order circuit and at the same time feed-forwarded to the higher-order subnetwork (<xref ref-type="fig" rid="F1">Fig. 1</xref>). With this architecture in place, we show that we rely more strongly on our internal signals when the perceived sensory cues are noisier than the predictions. Moreover, our work suggests that predictions modulate neural activity more at the onset of a new sensory input, even if the stimulus is not noisy. As a consequence, studying neural signatures of predictions in the brain might require experiments that involve sufficiently short trials.</p><p id="P37">Furthermore, we show that the weighting of sensory inputs and predictions can be biased by neuromodulators, as has been suggested before (see, e.g., <xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). In our model, those modulatory signals act through interneurons (<xref ref-type="bibr" rid="R13">Cardin, 2019</xref>) whose activities increase in the presence of neuromodulators. When PV neuron activity increases, the network weighs predictions stronger than without modulation. In contrast, when VIP neuron activity increases, the network underestimates the uncertainty of the prediction in a sensory-driven regime, and it underestimates the uncertainty of the sensory input in a prediction-driven regime. Hence, the system leans toward weighting sensory inputs and predictions more equally (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). When SOM and VIP neuron activities are modulated to the same degree, the weighting remains unaffected, suggesting that the individual contributions cancel (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). We show that these findings can be explained by changes in the baseline and gain of PE neurons arising through the modulation of interneuron activity (<xref ref-type="fig" rid="F4">Fig. 4D</xref>). These results can be tested experimentally by optogenetically or pharmacologically stimulating specific interneuron types.</p><p id="P38">Finally, we illustrate that the weighted integration of feedforward and feedback inputs can be interpreted as a neural manifestation of the contraction bias. We show that the bias is strongly driven by the variances of the sensory cue and the prediction, as well as the trial duration. While the sensory noise increases the contraction bias, the uncertainty in the prediction or long trials decreases the bias (<xref ref-type="fig" rid="F5">Fig. 5</xref>). However, we note that we only consider a neural representation of the stimulus and do not account for other sources of noise, like execution noise, that surely impacts the contraction bias observed in behavioral studies.</p></sec><sec id="S9"><title>Biological evidence for model choices and assumptions</title><p id="P39">In our model, we assumed that there are dedicated neurons that encode the variance of the feedforward sensory inputs and the prediction (see also <xref ref-type="bibr" rid="R81">Wilmes et al., 2023</xref>). This assumption is consistent with the idea that neurons explicitly encode in their activity the parameters (for instance, mean or variance) of a probability distribution (<xref ref-type="bibr" rid="R57">O’Neill and Schultz, 2010</xref>; <xref ref-type="bibr" rid="R58">O’Reilly et al., 2012</xref>). However, how variances of signals are represented in the brain is still not comprehensively understood and alternative ideas have been put forward. For instance, it is conceivable that the variance is encoded in a population of neurons, each differently tuned to a specific parameter (<xref ref-type="bibr" rid="R43">Knill and Pouget, 2004</xref>). The neurons’ activities represent how close the sensory input is to the preferred (predicted) input of each neuron. Similarly, a neuron’s response variability has been suggested to be related to the uncertainty of sensory stimuli (<xref ref-type="bibr" rid="R32">Hoyer and Hyvärinen, 2002</xref>; <xref ref-type="bibr" rid="R49">Ma et al., 2006</xref>).</p><p id="P40">There has been evidence that indeed (population of) neurons can encode uncertainty (<xref ref-type="bibr" rid="R73">Soltani and Izquierdo, 2019</xref>). For instance, neurons in the parietal cortex in monkeys encode the degree of confidence in a perceptual decision (<xref ref-type="bibr" rid="R42">Kiani and Shadlen, 2009</xref>). Similarly, the firing rate of neurons in the orbitofrontal cortex have been shown to encode confidence irrespective of sensory modality (<xref ref-type="bibr" rid="R52">Masset et al., 2020</xref>). Neural signatures of uncertainty have been found in regions of the prefrontal cortex (<xref ref-type="bibr" rid="R70">Rushworth and Behrens, 2008</xref>), the rat insular and orbitofrontal cortex (<xref ref-type="bibr" rid="R36">Jo and Jung, 2016</xref>), or the dorsal striatum in monkeys (<xref ref-type="bibr" rid="R80">White and Monosov, 2016</xref>). Moreover, the accuracy of memory recalls is encoded in single neurons of the human parietal and temporal lobes <xref ref-type="bibr" rid="R71">Rutishauser et al. (2015</xref>, <xref ref-type="bibr" rid="R72">2018</xref>).</p><p id="P41">In our model, we assume a hierarchy of predictions that are locally computed in memory neurons. These memory neurons are consistent with the idea of internal representation neurons hypothesized in predictive processing theories (<xref ref-type="bibr" rid="R8">Bastos et al., 2012</xref>; <xref ref-type="bibr" rid="R40">Keller and Mrsic-Flogel, 2018</xref>). While it has been hypothesized that these internal representation neurons might be deeper L5 neurons (<xref ref-type="bibr" rid="R8">Bastos et al., 2012</xref>; <xref ref-type="bibr" rid="R28">Heindorf and Keller, 2022</xref>), there is also evidence that a group of excitatory L2/3 neurons integrates over negative and positive prediction errors (<xref ref-type="bibr" rid="R59">O’Toole et al., 2022</xref>).</p><p id="P42">The core hypothesis of our model is the presence of sensory PE neurons. Those neurons have been found in different cortical areas in various species (<xref ref-type="bibr" rid="R17">Eliades and Wang, 2008</xref>; <xref ref-type="bibr" rid="R39">Keller and Hahnloser, 2009</xref>; <xref ref-type="bibr" rid="R7">Ayaz et al., 2019</xref>; <xref ref-type="bibr" rid="R5">Audette et al., 2021</xref>). Moreover, while first only hypothesized theoretically (<xref ref-type="bibr" rid="R65">Rao and Ballard, 1999</xref>), the presence of two types of PE neurons, the negative and positive PE neurons, has been confirmed in several recent studies (<xref ref-type="bibr" rid="R41">Keller et al., 2012</xref>; <xref ref-type="bibr" rid="R4">Attinger et al., 2017</xref>; <xref ref-type="bibr" rid="R37">Jordan and Keller, 2020</xref>; <xref ref-type="bibr" rid="R5">Audette et al., 2021</xref>). In our model, the nPE neuron inhibits the memory neuron while the pPE neuron excites it, in line with <xref ref-type="bibr" rid="R40">Keller and Mrsic-Flogel (2018)</xref>. The weights from those PE neurons onto the memory neuron are larger for the lower than the higher PE circuit, so that the lower-order memory neuron evolves faster than the higher-order counterpart. This assumption is consistent with the observation that time constants increase along the cortical hierarchy (<xref ref-type="bibr" rid="R55">Murray et al., 2014</xref>; <xref ref-type="bibr" rid="R14">Chaudhuri et al., 2015</xref>; <xref ref-type="bibr" rid="R69">Runyan et al., 2017</xref>).</p><p id="P43">If the relation of the paces at which the memory neurons evolve is strongly modulated, the network either shows a bias towards the sensory cues or the prediction (<xref ref-type="supplementary-material" rid="SD1">Figs. S5</xref>). It has been hypothesized that symptoms in psychiatric diseases may derive from an erroneous uncertainty estimation (<xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). For instance, hallucinations may arise from an underestimation of the expectation uncertainty or an overestimation of the sensory uncertainty. Conversely, a fixation on the environment, even when the sensory cues indicate a switch in the environment, may originate from an overestimation of the expectation uncertainty or an underestimation of the sensory uncertainty (<xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>).</p></sec><sec id="S10"><title>Neuromodulators and uncertainty</title><p id="P44">A popular hypothesis is that neuromodulators shape the weighting of sensory inputs and predictions thereof (<xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). Theoretical work by <xref ref-type="bibr" rid="R85">Yu and Dayan (2005)</xref> suggests that acetylcholine (ACh) correlates with <italic>expected uncertainty</italic>, while noradrenaline (NA) correlates with <italic>unexpected uncertainty</italic>. Expected uncertainty is usually interpreted as known cue-outcome unreliabilities. In contrast, unexpected uncertainty relates to the changes in the environment that produce large PEs outside the expected range of uncertainties (<xref ref-type="bibr" rid="R85">Yu and Dayan, 2005</xref>). While in our network the stimulus and trail-to-trial variability can only be loosely interpreted as ‘expected’ and ‘unexpected’ uncertainty, we want to compare the effects of ACh and NA on the weighting with the effects hypothesized in the literature.</p><p id="P45">It is assumed that NA increases in more volatile environments and enhances bottom-up processes (<xref ref-type="bibr" rid="R26">Hasselmo et al., 1997</xref>; <xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). In line with this idea, NA blockade impairs cognitive flexibility (<xref ref-type="bibr" rid="R66">Ridley et al., 1981</xref>; <xref ref-type="bibr" rid="R33">Janitzky et al., 2015</xref>). In recent work by <xref ref-type="bibr" rid="R47">Lawson et al. (2021)</xref>, it has been shown that humans receiving propranolol (blocking NA) rely more strongly on their expectations and are slower to update these predictions despite new sensory evidence (<xref ref-type="bibr" rid="R84">Yon and Frith, 2021</xref>). A main target for noradrenergic inputs is SOM neurons whose activity increases in the presence of NA (reviewed in, e.g., <xref ref-type="bibr" rid="R77">Urban-Ciecko and Barth, 2016</xref>; <xref ref-type="bibr" rid="R27">Hattori et al., 2017</xref>; <xref ref-type="bibr" rid="R75">Swanson and Maffei, 2019</xref>). In our model, activating SOM neurons does not enhance sensory bottom-up input. In a volatile environment, that is, a sensory-driven regime, the system takes into account predictions slightly more than without SOM modulation (<xref ref-type="fig" rid="F4">Figs. 4A</xref> and <xref ref-type="supplementary-material" rid="SD1">S6</xref>).</p><p id="P46">However, we note that in our simulations, we assumed that neuromodulators act globally, that is, on the interneurons in both the lower and the higher PE circuit. While this agrees with the view that neuromodulators can control network states globally, there is also evidence that they can have a more local, finely adjusted impact on neural circuits (<xref ref-type="bibr" rid="R56">Nadim and Bucher, 2014</xref>). In our model, increasing SOM activity only in the lower-order circuit shows a slight enhancement of the sensory weight (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>), that is, the bottom-up inputs. This suggests that whether a neuromodulator biases the network toward feedforward bottom-up or feedback top-down inputs depends on its spatial and temporal scale of influence.</p><p id="P47">Similarly to NA, ACh has also been shown to enhance bottom-up, feedforward inputs (reviewed in, e.g., <xref ref-type="bibr" rid="R85">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="R51">Marshall et al., 2016</xref>). For instance, subjects relied more strongly on prior beliefs when given cholinergic receptor antagonists (<xref ref-type="bibr" rid="R51">Marshall et al., 2016</xref>). A major target for cholinergic inputs is VIP neurons whose activity increases in the presence of ACh (reviewed in, e.g., <xref ref-type="bibr" rid="R79">Wester and McBain, 2014</xref>; <xref ref-type="bibr" rid="R27">Hattori et al., 2017</xref>; <xref ref-type="bibr" rid="R75">Swanson and Maffei, 2019</xref>). In our model, activating VIP neurons globally only enhances bottom-up input in stable environments for noisy stimuli. However, increasing VIP activity only in the higher-order PE circuit generally enhances sensory bottom-up inputs (<xref ref-type="supplementary-material" rid="SD1">Fig. S7</xref>).</p></sec><sec id="S11"><title>Limitations &amp; future steps</title><p id="P48">As for any computational model, we brush over several biological details to keep the model simple and interpretable. However, those details, while beyond the scope of this study, may be well investigated in future work. For instance, neuromodulatory systems have been suggested to gate plasticity (<xref ref-type="bibr" rid="R60">Pawlak et al., 2010</xref>). In a recent study by <xref ref-type="bibr" rid="R38">Jordan and Keller (2023)</xref>, locus coeruleus (LC) axon activity is shown to correlate with the magnitude of unsigned visuomotor prediction errors. The authors hypothesize that LC output modulates the learning rate at which the internal model evolves (<xref ref-type="bibr" rid="R38">Jordan and Keller, 2023</xref>). In our model, we do not consider precision-weighted PEs (but see <xref ref-type="bibr" rid="R81">Wilmes et al., 2023</xref>; <xref ref-type="bibr" rid="R22">Granier et al., 2023</xref>). Hence, a sensible extension to our work would be to adjust the weights from PE neurons onto the memory neurons by a function of the stimulus and prediction uncertainty, respectively. This would allow us to compare our results more closely to work showing that ACh and NA can adjust the rate at which new sensory evidence is incorporated when environments change (<xref ref-type="bibr" rid="R51">Marshall et al., 2016</xref>; <xref ref-type="bibr" rid="R10">Bruckner et al., 2022</xref>).</p><p id="P49">Our model suggests <italic>one</italic> potential neuronal circuit mechanism for the estimation of sensory inputs and predictions. However, in the light of evidence showing that the integration of feedforward and feedback inputs is species- and modality-dependent, it is conceivable that a plethora of neural mechanisms are used in neural circuits. For multisensory integration, <xref ref-type="bibr" rid="R83">Wong et al. (2023)</xref> showed that in Drosophila larva the chosen cue-combination strategy varies depending on the type of sensory information available. Also, humans put typically more weight on visual than auditory cues (<xref ref-type="bibr" rid="R9">Battaglia et al., 2003</xref>; <xref ref-type="bibr" rid="R2">Alais and Burr, 2004</xref>), but trust vestibular information more than visual information about head direction (<xref ref-type="bibr" rid="R11">Butler et al., 2010</xref>), a finding also observed for monkeys (<xref ref-type="bibr" rid="R19">Fetsch et al., 2009</xref>). Moreover, <xref ref-type="bibr" rid="R74">Summerfield et al. (2011)</xref> showed that humans diverge from an optimal Bayesian strategy in very volatile environments and act according to their experience in the last trial. It has been suggested that the brain may use different strategies to combine signals depending on the task demands (<xref ref-type="bibr" rid="R58">O’Reilly et al., 2012</xref>). While these behavioral results cannot speak to the underlying circuit mechanisms, it is conceivable that neural implementations for the integration of feedforward and feedback inputs may also vary.</p><p id="P50">Furthermore, while we provide a neuronal circuit model for estimating the mean and variance of both sensory signals and predictions, we do not explicitly model the weighting of inputs. A respective neural circuit model would require nested inhibitory interneurons providing divisive inhibition. How this subnetwork interacts with the PE circuits, and how the presence of neuromodulators acting on the interneurons directly involved in the weighting, impacts our findings is subject to future work.</p></sec><sec id="S12"><title>Relation to other work &amp; conclusions</title><p id="P51">Many normative models have been proposed for state estimation and prediction under uncertainty (<xref ref-type="bibr" rid="R73">Soltani and Izquierdo, 2019</xref>), ranging from the classical Kalman filter to more recent models like <italic>Bayes Factor Surprise</italic> (<xref ref-type="bibr" rid="R48">Liakoni et al., 2021</xref>). For instance, the Bayes factor surprise formularizes the trade-off between integrating new observations in an existing belief system and resetting this belief system with novel evidence. The surprise factor captures how much an animal’s current belief deviates from the new observation.</p><p id="P52">In recent years, normative models have been squared with biological constraints. For instance, <xref ref-type="bibr" rid="R45">Kutschireiter et al. (2023)</xref> showed that a <italic>Bayesian ring attractor</italic> model can encode uncertainty in the amplitude of the network activity and matches the performance of a circular Kalman filter when the recurrent connections are tuned appropriately. In other seminal work, it has been proposed that Bayesian inference in time can be linked to the dynamics of leaky integrate-and-fire neurons with spike-dependent adaptation (<xref ref-type="bibr" rid="R15">Deneve, 2008</xref>).</p><p id="P53">Here, we proposed an alternative view in which PE neurons serve as the backbone for estimating both the uncertainty of the feedforward sensory stimuli arising from the external world and the feedback signals carrying predictions about the same feedforward inputs our brains receive. Our work is an important step toward a better understanding of the brain’s ability to integrate these unreliable feedforward and feedback signals that often do not match perfectly.</p></sec></sec><sec id="S13"><title>Models and methods</title><sec id="S14"><title>Network model</title><p id="P54">The mean-field network model consists of a <italic>lower</italic> and <italic>higher</italic> PE circuit (<xref ref-type="fig" rid="F1">Fig. 1C-D</xref>). Each PE circuit contains an excitatory nPE neuron and pPE neuron (N<sub>nPE</sub> = N<sub>pPE</sub> = 1), as well as inhibitory neurons. The inhibitory neurons comprise PV, SOM and VIP neurons (N<sub>SOM</sub> = N<sub>VIP</sub> = 1, N<sub>PV</sub> = 2), further explained in <xref ref-type="bibr" rid="R29">Hertäg and Clopath (2022)</xref>. In addition to the core PE circuit, each subnetwork also includes one memory neuron <italic>M</italic> and one variance neuron <italic>V</italic>.</p><p id="P55">The excitatory neurons in the PE circuit are simulated as two coupled point compartments, representing the soma and the dendrites of elongated pyramidal cells. All other neurons are modeled as point neurons. The activities of all neurons are represented by a set of differential equations describing the network dynamics.</p><p id="P56">The dynamics of the neurons in the lower and higher PE circuits <inline-formula><mml:math id="M1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mtext>and</mml:mtext><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are given by <disp-formula id="FD1"><label>(1)</label><mml:math id="M2"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:munder accentunder="true"><mml:mi>h</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:munder accentunder="true"><mml:mi>h</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> with <disp-formula id="FD2"><label>(2)</label><mml:math id="M3"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munderover><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:mo>*</mml:mo></mml:munderover><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>h</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>FF</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>I</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>h</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>h</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo>←</mml:mo><mml:mtext>FF</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>I</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P57">We follow the notation that column and row vectors are indicated by letters with an underscore <underline>•</underline>, matrices are denoted by capital letters, and scalars are given by small letters without an underscore. Furthermore, a time derivative (e.g., <inline-formula><mml:math id="M4"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>) is denoted by a dot above the letter (e.g., <inline-formula><mml:math id="M5"><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>). The rate vector <inline-formula><mml:math id="M6"><mml:mrow><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>pE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nD</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>pD</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>PV</mml:mtext></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mtext>PV</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>SOM</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>VIP</mml:mtext></mml:mrow><mml:mrow><mml:mtext>loc</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> with loc ∈ [low, high] contains the activities of all neurons or compartments in the PE circuit (soma of nPE/pPE neurons: nE/pE, dendrites of nPE/pPE neurons: nD/pD). The network receives time-dependent stimuli <italic>s</italic> and neuron/compartment-specific external background input <italic><underline>I</underline></italic><sub>PE</sub>. The connection strengths between the <italic>pre</italic>-synaptic population and the neurons of the PE circuit are denoted by <italic>W</italic><sub>PE←pre</sub> (if <italic>r</italic> is a vector) or <italic><underline>w</underline></italic><sub>PE←<italic>pre</italic></sub> (if <italic>r</italic> is a scalar). The activities of the neurons evolve with time constants summarized in <italic>T</italic><sub><italic>c</italic></sub>.</p><p id="P58">The activities of the lower and higher memory (M) neuron evolve according to a perfect integrator. The M neurons receive synapses from both nPE and pPE neurons of the same subnetwork, <disp-formula id="FD3"><label>(3)</label><mml:math id="M7"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>τ</mml:mo></mml:mover><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>pPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>pPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>τ</mml:mo></mml:mover><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>pPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>pPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>←</mml:mo><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P59">The activities of the lower and higher V neuron evolve according to a leaky integrator with quadratic activation function. The variance neurons receive synapses from both nPE and pPE neurons of the same subnetwork, <disp-formula id="FD4"><label>(4)</label><mml:math id="M8"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>τ</mml:mo></mml:mover><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>pPE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>nPE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>τ</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>τ</mml:mo></mml:mover><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:munder accentunder="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>PE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>pPE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>PE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>←</mml:mo><mml:mtext>nPE</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mtext>nPE</mml:mtext></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P60">All values for neuron and network parameters, details on the model equations for the mean-field and the population network, as well as supporting analyses can be found in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p></sec><sec id="S15"><title>Weighting of sensory inputs and predictions</title><p id="P61">We arithmetically calculated the weighted output of sensory inputs and predictions, <italic>r</italic><sub>out</sub>, based on ideas of Bayesian multisensory integration (see, e.g. <xref ref-type="bibr" rid="R63">Pouget et al., 2013</xref>), <disp-formula id="FD5"><label>(5)</label><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>⋅</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>M</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>α</italic> denotes the sensory weight (that is, the reliability of the sensory input) and is given by <disp-formula id="FD6"><label>(6)</label><mml:math id="M10"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>V</mml:mtext><mml:mrow><mml:mtext>high</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S16"><title>Inputs</title><p id="P62">The network receives feedforward stimuli <italic>s</italic> that may vary between trials. To account for noise, each stimulus is composed of N<sub>in</sub> constant values drawn from a normal distribution with mean <italic>μ</italic><sub>in</sub> and standard deviation <italic>σ</italic><sub>in</sub>, and are presented for N<sub>step</sub> consecutive time steps. To account for changes in the environment, <italic>μ</italic><sub>in</sub> is drawn from a uniform distribution <italic>U</italic> (<italic>a, b</italic>) with mean <inline-formula><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>trial</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>trial</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The parameterization of both distributions varies across the experiments. All stimulus/input parameters can be found in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p></sec><sec id="S17"><title>Simulations</title><p id="P63">All simulations were performed in customized Python code written by LH. Source code to reproduce the simulations, analyses, and figures will be available after publication at <ext-link ext-link-type="uri" xlink:href="https://github.com/lhertaeg/weighted_sensory_prediction">https://github.com/lhertaeg/weighted_sensory_prediction</ext-link>. Differential equations were numerically integrated using a 2<sup>nd</sup>-order Runge-Kutta method. Neurons were initialized with <italic>r</italic> = 0/<italic>s</italic>. Further details and values for simulation parameters can be found in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supporting Information</label><media xlink:href="EMS192797-supplement-Supporting_Information.pdf" mimetype="application" mime-subtype="pdf" id="d217aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S18"><title>Acknowledgments</title><p>We thank Inês C. Guerreiro for comments on earlier versions of this manuscript. This work was supported by Deutsche Forschungsgemeinschaft (DFG) Grant 460088091, Biotechnology and Biological Sciences Research Council (BBSRC) Grants BB/N013956/1 and BB/N019008/1, Wellcome Trust Grant 200790/Z/16/Z, Simons Foundation Grant 564408, and Engineering and Physical Sciences Research Council (EPSRC) Grant EP/R035806/1.</p></ack><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akrami</surname><given-names>Athena</given-names></name><name><surname>Kopec</surname><given-names>Charles D</given-names></name><name><surname>Diamond</surname><given-names>Mathew E</given-names></name><name><surname>Brody</surname><given-names>Carlos D</given-names></name></person-group><article-title>Posterior parietal cortex represents sensory history and mediates its effects on behaviour</article-title><source>Nature</source><year>2018</year><volume>554</volume><issue>7692</issue><fpage>368</fpage><lpage>372</lpage><pub-id pub-id-type="pmid">29414944</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alais</surname><given-names>David</given-names></name><name><surname>Burr</surname><given-names>David</given-names></name></person-group><article-title>The ventriloquist effect results from near-optimal bimodal integration</article-title><source>Current biology</source><year>2004</year><volume>14</volume><issue>3</issue><fpage>257</fpage><lpage>262</lpage><pub-id pub-id-type="pmid">14761661</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashourian</surname><given-names>Paymon</given-names></name><name><surname>Loewenstein</surname><given-names>Yonatan</given-names></name></person-group><article-title>Bayesian inference underlies the contraction bias in delayed comparison tasks</article-title><source>PloS one</source><year>2011</year><volume>6</volume><issue>5</issue><elocation-id>e19551</elocation-id><pub-id pub-id-type="pmcid">PMC3093393</pub-id><pub-id pub-id-type="pmid">21589867</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0019551</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Attinger</surname><given-names>Alexander</given-names></name><name><surname>Wang</surname><given-names>Bo</given-names></name><name><surname>Keller</surname><given-names>Georg B</given-names></name></person-group><article-title>Visuomotor coupling shapes the functional development of mouse visual cortex</article-title><source>Cell</source><year>2017</year><volume>169</volume><issue>7</issue><fpage>1291</fpage><lpage>1302</lpage><pub-id pub-id-type="pmid">28602353</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Audette</surname><given-names>Nicholas J</given-names></name><name><surname>Zhou</surname><given-names>WenXi</given-names></name><name><surname>Schneider</surname><given-names>David M</given-names></name></person-group><article-title>Temporally precise movement-based predictions in the mouse auditory cortex</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021-12</elocation-id><pub-id pub-id-type="pmcid">PMC9691550</pub-id><pub-id pub-id-type="pmid">36283411</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2022.09.064</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avery</surname><given-names>Michael C</given-names></name><name><surname>Krichmar</surname><given-names>Jeffrey L</given-names></name></person-group><article-title>Neuromodulatory systems and their interactions: a review of models, theories, and experiments</article-title><source>Frontiers in neural circuits</source><year>2017</year><volume>11</volume><fpage>108</fpage><pub-id pub-id-type="pmcid">PMC5744617</pub-id><pub-id pub-id-type="pmid">29311844</pub-id><pub-id pub-id-type="doi">10.3389/fncir.2017.00108</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayaz</surname><given-names>Aslı</given-names></name><name><surname>Stäuble</surname><given-names>Andreas</given-names></name><name><surname>Hamada</surname><given-names>Morio</given-names></name><name><surname>Wulf</surname><given-names>Marie-Angela</given-names></name><name><surname>Saleem</surname><given-names>Aman B</given-names></name><name><surname>Helmchen</surname><given-names>Fritjof</given-names></name></person-group><article-title>Layer-specific integration of locomotion and sensory information in mouse barrel cortex</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><elocation-id>2585</elocation-id><pub-id pub-id-type="pmcid">PMC6565743</pub-id><pub-id pub-id-type="pmid">31197148</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-10564-8</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastos</surname><given-names>Andre M</given-names></name><name><surname>Usrey</surname><given-names>W Martin</given-names></name><name><surname>Adams</surname><given-names>Rick A</given-names></name><name><surname>Mangun</surname><given-names>George R</given-names></name><name><surname>Fries</surname><given-names>Pascal</given-names></name><name><surname>Friston</surname><given-names>Karl J</given-names></name></person-group><article-title>Canonical microcircuits for predictive coding</article-title><source>Neuron</source><year>2012</year><volume>76</volume><issue>4</issue><fpage>695</fpage><lpage>711</lpage><pub-id pub-id-type="pmcid">PMC3777738</pub-id><pub-id pub-id-type="pmid">23177956</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.038</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battaglia</surname><given-names>Peter W</given-names></name><name><surname>Jacobs</surname><given-names>Robert A</given-names></name><name><surname>Aslin</surname><given-names>Richard N</given-names></name></person-group><article-title>Bayesian integration of visual and auditory signals for spatial localization</article-title><source>Josa a</source><year>2003</year><volume>20</volume><issue>7</issue><fpage>1391</fpage><lpage>1397</lpage><pub-id pub-id-type="pmid">12868643</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bruckner</surname><given-names>Rasmus</given-names></name><name><surname>Heekeren</surname><given-names>Hauke R</given-names></name><name><surname>Nassar</surname><given-names>Matt</given-names></name></person-group><article-title>Understanding learning through uncertainty and bias</article-title><year>2022</year></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>John S</given-names></name><name><surname>Smith</surname><given-names>Stuart T</given-names></name><name><surname>Campos</surname><given-names>Jennifer L</given-names></name><name><surname>Bülthoff</surname><given-names>Heinrich H</given-names></name></person-group><article-title>Bayesian integration of visual and vestibular signals for heading</article-title><source>Journal of vision</source><year>2010</year><volume>10</volume><issue>11</issue><fpage>23</fpage><pub-id pub-id-type="pmid">20884518</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campagnola</surname><given-names>Luke</given-names></name><name><surname>Seeman</surname><given-names>Stephanie C</given-names></name><name><surname>Chartrand</surname><given-names>Thomas</given-names></name><name><surname>Kim</surname><given-names>Lisa</given-names></name><name><surname>Hoggarth</surname><given-names>Alex</given-names></name><name><surname>Gamlin</surname><given-names>Clare</given-names></name><name><surname>Ito</surname><given-names>Shinya</given-names></name><name><surname>Trinh</surname><given-names>Jessica</given-names></name><name><surname>Davoudian</surname><given-names>Pasha</given-names></name><name><surname>Radaelli</surname><given-names>Cristina</given-names></name><etal/></person-group><article-title>Local connectivity and synaptic dynamics in mouse and human neocortex</article-title><source>Science</source><year>2022</year><volume>375</volume><issue>6585</issue><elocation-id>eabj5861</elocation-id><pub-id pub-id-type="pmcid">PMC9970277</pub-id><pub-id pub-id-type="pmid">35271334</pub-id><pub-id pub-id-type="doi">10.1126/science.abj5861</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardin</surname><given-names>Jessica A</given-names></name></person-group><article-title>Functional flexibility in cortical circuits</article-title><source>Current opinion in neurobiology</source><year>2019</year><volume>58</volume><fpage>175</fpage><lpage>180</lpage><pub-id pub-id-type="pmcid">PMC6981226</pub-id><pub-id pub-id-type="pmid">31585330</pub-id><pub-id pub-id-type="doi">10.1016/j.conb.2019.09.008</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaudhuri</surname><given-names>Rishidev</given-names></name><name><surname>Knoblauch</surname><given-names>Kenneth</given-names></name><name><surname>Gariel</surname><given-names>Marie-Alice</given-names></name><name><surname>Kennedy</surname><given-names>Henry</given-names></name><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></person-group><article-title>A large-scale circuit mechanism for hierarchical dynamical processing in the primate cortex</article-title><source>Neuron</source><year>2015</year><volume>88</volume><issue>2</issue><fpage>419</fpage><lpage>431</lpage><pub-id pub-id-type="pmcid">PMC4630024</pub-id><pub-id pub-id-type="pmid">26439530</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.008</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deneve</surname><given-names>Sophie</given-names></name></person-group><article-title>Bayesian spiking neurons i: inference</article-title><source>Neural computation</source><year>2008</year><volume>20</volume><issue>1</issue><fpage>91</fpage><lpage>117</lpage><pub-id pub-id-type="pmid">18045002</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deneve</surname><given-names>Sophie</given-names></name><name><surname>Pouget</surname><given-names>Alexandre</given-names></name></person-group><article-title>Bayesian multisensory integration and cross-modal spatial links</article-title><source>Journal of Physiology-Paris</source><year>2004</year><volume>98</volume><issue>1-3</issue><fpage>249</fpage><lpage>258</lpage><pub-id pub-id-type="pmid">15477036</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eliades</surname><given-names>Steven J</given-names></name><name><surname>Wang</surname><given-names>Xiaoqin</given-names></name></person-group><article-title>Neural substrates of vocalization feedback monitoring in primate auditory cortex</article-title><source>Nature</source><year>2008</year><volume>453</volume><issue>7198</issue><fpage>1102</fpage><pub-id pub-id-type="pmid">18454135</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>Marc O</given-names></name><name><surname>Banks</surname><given-names>Martin S</given-names></name></person-group><article-title>Humans integrate visual and haptic information in a statistically optimal fashion</article-title><source>Nature</source><year>2002</year><volume>415</volume><issue>6870</issue><fpage>429</fpage><lpage>433</lpage><pub-id pub-id-type="pmid">11807554</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fetsch</surname><given-names>Christopher R</given-names></name><name><surname>Turner</surname><given-names>Amanda H</given-names></name><name><surname>DeAngelis</surname><given-names>Gregory C</given-names></name><name><surname>Angelaki</surname><given-names>Dora E</given-names></name></person-group><article-title>Dynamic reweighting of visual and vestibular cues during self-motion perception</article-title><source>Journal of Neuroscience</source><year>2009</year><volume>29</volume><issue>49</issue><fpage>15601</fpage><lpage>15612</lpage><pub-id pub-id-type="pmcid">PMC2824339</pub-id><pub-id pub-id-type="pmid">20007484</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2574-09.2009</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fetsch</surname><given-names>Christopher R</given-names></name><name><surname>Pouget</surname><given-names>Alexandre</given-names></name><name><surname>DeAngelis</surname><given-names>Gregory C</given-names></name><name><surname>Angelaki</surname><given-names>Dora E</given-names></name></person-group><article-title>Neural correlates of reliability-based cue weighting during multisensory integration</article-title><source>Nature neuroscience</source><year>2012</year><volume>15</volume><issue>1</issue><fpage>146</fpage><lpage>154</lpage><pub-id pub-id-type="pmcid">PMC3398428</pub-id><pub-id pub-id-type="pmid">22101645</pub-id><pub-id pub-id-type="doi">10.1038/nn.2983</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>Karl</given-names></name></person-group><article-title>Hierarchical models in the brain</article-title><source>PLoS computational biology</source><year>2008</year><volume>4</volume><issue>11</issue><elocation-id>e1000211</elocation-id><pub-id pub-id-type="pmcid">PMC2570625</pub-id><pub-id pub-id-type="pmid">18989391</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000211</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granier</surname><given-names>Arno</given-names></name><name><surname>Petrovici</surname><given-names>Mihai A</given-names></name><name><surname>Senn</surname><given-names>Walter</given-names></name><name><surname>Wilmes</surname><given-names>Katharina A</given-names></name></person-group><article-title>Precision estimation and second-order prediction errors in cortical circuits</article-title><source>arXiv preprint</source><year>2023</year><elocation-id>arXiv:2309.16046</elocation-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Yong</given-names></name><name><surname>Angelaki</surname><given-names>Dora E</given-names></name><name><surname>DeAngelis</surname><given-names>Gregory C</given-names></name></person-group><article-title>Neural correlates of multisensory cue integration in macaque mstd</article-title><source>Nature neuroscience</source><year>2008</year><volume>11</volume><issue>10</issue><fpage>1201</fpage><lpage>1210</lpage><pub-id pub-id-type="pmcid">PMC2713666</pub-id><pub-id pub-id-type="pmid">18776893</pub-id><pub-id pub-id-type="doi">10.1038/nn.2191</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>Shuting</given-names></name><name><surname>Helmchen</surname><given-names>Fritjof</given-names></name></person-group><article-title>Behavior-relevant top-down cross-modal predictions in mouse neocortex</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023-04</elocation-id><pub-id pub-id-type="pmid">38177341</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>Kenneth D</given-names></name><name><surname>Shepherd</surname><given-names>Gordon MG</given-names></name></person-group><article-title>The neocortical circuit: themes and variations</article-title><source>Nature neuroscience</source><year>2015</year><volume>18</volume><issue>2</issue><fpage>170</fpage><pub-id pub-id-type="pmcid">PMC4889215</pub-id><pub-id pub-id-type="pmid">25622573</pub-id><pub-id pub-id-type="doi">10.1038/nn.3917</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasselmo</surname><given-names>Michael E</given-names></name><name><surname>Linster</surname><given-names>Christiane</given-names></name><name><surname>Patil</surname><given-names>Madhvi</given-names></name><name><surname>Ma</surname><given-names>Daveena</given-names></name><name><surname>Cekic</surname><given-names>Milos</given-names></name></person-group><article-title>Noradrenergic suppression of synaptic transmission may influence cortical signal-to-noise ratio</article-title><source>Journal of neurophysiology</source><year>1997</year><volume>77</volume><issue>6</issue><fpage>3326</fpage><lpage>3339</lpage><pub-id pub-id-type="pmid">9212278</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hattori</surname><given-names>Ryoma</given-names></name><name><surname>Kuchibhotla</surname><given-names>Kishore V</given-names></name><name><surname>Froemke</surname><given-names>Robert C</given-names></name><name><surname>Komiyama</surname><given-names>Takaki</given-names></name></person-group><article-title>Functions and dysfunctions of neocortical inhibitory neuron subtypes</article-title><source>Nature neuroscience</source><year>2017</year><volume>20</volume><issue>9</issue><fpage>1199</fpage><lpage>1208</lpage><pub-id pub-id-type="pmcid">PMC7082034</pub-id><pub-id pub-id-type="pmid">28849791</pub-id><pub-id pub-id-type="doi">10.1038/nn.4619</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heindorf</surname><given-names>Matthias</given-names></name><name><surname>Keller</surname><given-names>Georg B</given-names></name></person-group><article-title>Reduction of layer 5 mediated long-range cortical communication by antipsychotic drugs</article-title><source>bioRxiv</source><year>2022</year></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertäg</surname><given-names>Loreen</given-names></name><name><surname>Clopath</surname><given-names>Claudia</given-names></name></person-group><article-title>Prediction-error neurons in circuits with multiple neuron types: Formation, refinement, and functional implications</article-title><source>Proceedings of the National Academy of Sciences</source><year>2022</year><volume>119</volume><issue>13</issue><elocation-id>e2115699119</elocation-id><pub-id pub-id-type="pmcid">PMC9060484</pub-id><pub-id pub-id-type="pmid">35320037</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2115699119</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hertäg</surname><given-names>Loreen</given-names></name><name><surname>Sprekeler</surname><given-names>Henning</given-names></name></person-group><article-title>Learning prediction error neurons in a canonical interneuron circuit</article-title><source>Elife</source><year>2020</year><volume>9</volume><elocation-id>e57541</elocation-id><pub-id pub-id-type="pmcid">PMC7442488</pub-id><pub-id pub-id-type="pmid">32820723</pub-id><pub-id pub-id-type="doi">10.7554/eLife.57541</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollingworth</surname><given-names>Harry Levi</given-names></name></person-group><article-title>The central tendency of judgment</article-title><source>The Journal of Philosophy, Psychology and Scientific Methods</source><year>1910</year><volume>7</volume><issue>17</issue><fpage>461</fpage><lpage>469</lpage></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoyer</surname><given-names>Patrik</given-names></name><name><surname>Hyvärinen</surname><given-names>Aapo</given-names></name></person-group><article-title>Interpreting neural response variability as monte carlo sampling of the posterior</article-title><source>Advances in neural information processing systems</source><year>2002</year><volume>15</volume></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janitzky</surname><given-names>Kathrin</given-names></name><name><surname>Lippert</surname><given-names>Michael T</given-names></name><name><surname>Engelhorn</surname><given-names>Achim</given-names></name><name><surname>Tegtmeier</surname><given-names>Jennifer</given-names></name><name><surname>Goldschmidt</surname><given-names>Jürgen</given-names></name><name><surname>Heinze</surname><given-names>Hans-Jochen</given-names></name><name><surname>Ohl</surname><given-names>Frank W</given-names></name></person-group><article-title>Optogenetic silencing of locus coeruleus activity in mice impairs cognitive flexibility in an attentional set-shifting task</article-title><source>Frontiers in behavioral neuroscience</source><year>2015</year><volume>9</volume><fpage>286</fpage><pub-id pub-id-type="pmcid">PMC4631833</pub-id><pub-id pub-id-type="pmid">26582980</pub-id><pub-id pub-id-type="doi">10.3389/fnbeh.2015.00286</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jazayeri</surname><given-names>Mehrdad</given-names></name><name><surname>Shadlen</surname><given-names>Michael N</given-names></name></person-group><article-title>Temporal context calibrates interval timing</article-title><source>Nature neuroscience</source><year>2010</year><volume>13</volume><issue>8</issue><fpage>1020</fpage><lpage>1026</lpage><pub-id pub-id-type="pmcid">PMC2916084</pub-id><pub-id pub-id-type="pmid">20581842</pub-id><pub-id pub-id-type="doi">10.1038/nn.2590</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>Xiaolong</given-names></name><name><surname>Shen</surname><given-names>Shan</given-names></name><name><surname>Cadwell</surname><given-names>Cathryn R</given-names></name><name><surname>Berens</surname><given-names>Philipp</given-names></name><name><surname>Sinz</surname><given-names>Fabian</given-names></name><name><surname>Ecker</surname><given-names>Alexander S</given-names></name><name><surname>Patel</surname><given-names>Saumil</given-names></name><name><surname>Tolias</surname><given-names>Andreas S</given-names></name></person-group><article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title><source>Science</source><year>2015</year><volume>350</volume><issue>6264</issue><elocation-id>aac9462</elocation-id><pub-id pub-id-type="pmcid">PMC4809866</pub-id><pub-id pub-id-type="pmid">26612957</pub-id><pub-id pub-id-type="doi">10.1126/science.aac9462</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jo</surname><given-names>Suhyun</given-names></name><name><surname>Jung</surname><given-names>Min Whan</given-names></name></person-group><article-title>Differential coding of uncertain reward in rat insular and orbitofrontal cortex</article-title><source>Scientific reports</source><year>2016</year><volume>6</volume><issue>1</issue><elocation-id>24085</elocation-id><pub-id pub-id-type="pmcid">PMC4823699</pub-id><pub-id pub-id-type="pmid">27052943</pub-id><pub-id pub-id-type="doi">10.1038/srep24085</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>Rebecca</given-names></name><name><surname>Keller</surname><given-names>Georg B</given-names></name></person-group><article-title>Opposing influence of top-down and bottom-up input on excitatory layer 2/3 neurons in mouse primary visual cortex</article-title><source>Neuron</source><year>2020</year><volume>108</volume><issue>6</issue><fpage>1194</fpage><lpage>1206</lpage><pub-id pub-id-type="pmcid">PMC7772056</pub-id><pub-id pub-id-type="pmid">33091338</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2020.09.024</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>Rebecca</given-names></name><name><surname>Keller</surname><given-names>Georg B</given-names></name></person-group><article-title>The locus coeruleus broadcasts prediction errors across the cortex to promote sensorimotor plasticity</article-title><source>Elife</source><year>2023</year><volume>12</volume><elocation-id>RP85111</elocation-id><pub-id pub-id-type="pmcid">PMC10328511</pub-id><pub-id pub-id-type="pmid">37285281</pub-id><pub-id pub-id-type="doi">10.7554/eLife.85111</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>Georg B</given-names></name><name><surname>Hahnloser</surname><given-names>Richard HR</given-names></name></person-group><article-title>Neural processing of auditory feedback during vocal practice in a songbird</article-title><source>Nature</source><year>2009</year><volume>457</volume><issue>7226</issue><fpage>187</fpage><pub-id pub-id-type="pmid">19005471</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>Georg B</given-names></name><name><surname>Mrsic-Flogel</surname><given-names>Thomas D</given-names></name></person-group><article-title>Predictive processing: A canonical cortical computation</article-title><source>Neuron</source><year>2018</year><volume>100</volume><issue>2</issue><fpage>424</fpage><lpage>435</lpage><pub-id pub-id-type="pmcid">PMC6400266</pub-id><pub-id pub-id-type="pmid">30359606</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2018.10.003</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>Georg B</given-names></name><name><surname>Bonhoeffer</surname><given-names>Tobias</given-names></name><name><surname>Hübener</surname><given-names>Mark</given-names></name></person-group><article-title>Sensorimotor mismatch signals in primary visual cortex of the behaving mouse</article-title><source>Neuron</source><year>2012</year><volume>74</volume><issue>5</issue><fpage>809</fpage><lpage>815</lpage><pub-id pub-id-type="pmid">22681686</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiani</surname><given-names>Roozbeh</given-names></name><name><surname>Shadlen</surname><given-names>Michael N</given-names></name></person-group><article-title>Representation of confidence associated with a decision by neurons in the parietal cortex</article-title><source>science</source><year>2009</year><volume>324</volume><issue>5928</issue><fpage>759</fpage><lpage>764</lpage><pub-id pub-id-type="pmcid">PMC2738936</pub-id><pub-id pub-id-type="pmid">19423820</pub-id><pub-id pub-id-type="doi">10.1126/science.1169405</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knill</surname><given-names>David C</given-names></name><name><surname>Pouget</surname><given-names>Alexandre</given-names></name></person-group><article-title>The bayesian brain: the role of uncertainty in neural coding and computation</article-title><source>TRENDS in Neurosciences</source><year>2004</year><volume>27</volume><issue>12</issue><fpage>712</fpage><lpage>719</lpage><pub-id pub-id-type="pmid">15541511</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körding</surname><given-names>Konrad P</given-names></name><name><surname>Wolpert</surname><given-names>Daniel M</given-names></name></person-group><article-title>Bayesian integration in sensorimotor learning</article-title><source>Nature</source><year>2004</year><volume>427</volume><issue>6971</issue><fpage>244</fpage><lpage>247</lpage><pub-id pub-id-type="pmid">14724638</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kutschireiter</surname><given-names>Anna</given-names></name><name><surname>Basnak</surname><given-names>Melanie A</given-names></name><name><surname>Wilson</surname><given-names>Rachel I</given-names></name><name><surname>Drugowitsch</surname><given-names>Jan</given-names></name></person-group><article-title>Bayesian inference in ring attractor networks</article-title><source>Proceedings of the National Academy of Sciences</source><year>2023</year><volume>120</volume><issue>9</issue><elocation-id>e2210622120</elocation-id><pub-id pub-id-type="pmcid">PMC9992764</pub-id><pub-id pub-id-type="pmid">36812206</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2210622120</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkum</surname><given-names>Matthew</given-names></name></person-group><article-title>A cellular mechanism for cortical associations: an organizing principle for the cerebral cortex</article-title><source>Trends in neurosciences</source><year>2013</year><volume>36</volume><issue>3</issue><fpage>141</fpage><lpage>151</lpage><pub-id pub-id-type="pmid">23273272</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>Rebecca P</given-names></name><name><surname>Bisby</surname><given-names>James</given-names></name><name><surname>Nord</surname><given-names>Camilla L</given-names></name><name><surname>Burgess</surname><given-names>Neil</given-names></name><name><surname>Rees</surname><given-names>Geraint</given-names></name></person-group><article-title>The computational, pharmacological, and physiological determinants of sensory learning under uncertainty</article-title><source>Current Biology</source><year>2021</year><volume>31</volume><issue>1</issue><fpage>163</fpage><lpage>172</lpage><pub-id pub-id-type="pmcid">PMC7808754</pub-id><pub-id pub-id-type="pmid">33188745</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2020.10.043</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liakoni</surname><given-names>Vasiliki</given-names></name><name><surname>Modirshanechi</surname><given-names>Alireza</given-names></name><name><surname>Gerstner</surname><given-names>Wulfram</given-names></name><name><surname>Brea</surname><given-names>Johanni</given-names></name></person-group><article-title>Learning in volatile environments with the bayes factor surprise</article-title><source>Neural Computation</source><year>2021</year><volume>33</volume><issue>2</issue><fpage>269</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">33400898</pub-id></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>Wei Ji</given-names></name><name><surname>Beck</surname><given-names>Jeffrey M</given-names></name><name><surname>Latham</surname><given-names>Peter E</given-names></name><name><surname>Pouget</surname><given-names>Alexandre</given-names></name></person-group><article-title>Bayesian inference with probabilistic population codes</article-title><source>Nature neuroscience</source><year>2006</year><volume>9</volume><issue>11</issue><fpage>1432</fpage><lpage>1438</lpage><pub-id pub-id-type="pmid">17057707</pub-id></element-citation></ref><ref id="R50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markram</surname><given-names>Henry</given-names></name><name><surname>Toledo-Rodriguez</surname><given-names>Maria</given-names></name><name><surname>Wang</surname><given-names>Yun</given-names></name><name><surname>Gupta</surname><given-names>Anirudh</given-names></name><name><surname>Silberberg</surname><given-names>Gilad</given-names></name><name><surname>Wu</surname><given-names>Caizhi</given-names></name></person-group><article-title>Interneurons of the neocortical inhibitory system</article-title><source>Nature reviews neuroscience</source><year>2004</year><volume>5</volume><issue>10</issue><fpage>793</fpage><pub-id pub-id-type="pmid">15378039</pub-id></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshall</surname><given-names>Louise</given-names></name><name><surname>Mathys</surname><given-names>Christoph</given-names></name><name><surname>Ruge</surname><given-names>Diane</given-names></name><name><surname>De Berker</surname><given-names>Archy O</given-names></name><name><surname>Dayan</surname><given-names>Peter</given-names></name><name><surname>Stephan</surname><given-names>Klaas E</given-names></name><name><surname>Bestmann</surname><given-names>Sven</given-names></name></person-group><article-title>Pharmacological fingerprints of contextual uncertainty</article-title><source>PLoS Biology</source><year>2016</year><volume>14</volume><issue>11</issue><elocation-id>e1002575</elocation-id><pub-id pub-id-type="pmcid">PMC5113004</pub-id><pub-id pub-id-type="pmid">27846219</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002575</pub-id></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masset</surname><given-names>Paul</given-names></name><name><surname>Ott</surname><given-names>Torben</given-names></name><name><surname>Lak</surname><given-names>Armin</given-names></name><name><surname>Hirokawa</surname><given-names>Junya</given-names></name><name><surname>Kepecs</surname><given-names>Adam</given-names></name></person-group><article-title>Behavior-and modality-general representation of confidence in orbitofrontal cortex</article-title><source>Cell</source><year>2020</year><volume>182</volume><issue>1</issue><fpage>112</fpage><lpage>126</lpage><pub-id pub-id-type="pmcid">PMC8083070</pub-id><pub-id pub-id-type="pmid">32504542</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.05.022</pub-id></element-citation></ref><ref id="R53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Meirhaeghe</surname><given-names>Nicolas</given-names></name><name><surname>Sohn</surname><given-names>Hansem</given-names></name><name><surname>Jazayeri</surname><given-names>Mehrdad</given-names></name></person-group><article-title>A precise and adaptive neural mechanism for predictive temporal processing in the frontal cortex</article-title><volume>109</volume><issue>18</issue><fpage>2995</fpage><lpage>3011</lpage><elocation-id>e5</elocation-id><publisher-name>Elsevier</publisher-name><comment>ISSN 0896-6273 URL 10.1016/j.neuron.2021.08.025. Publisher</comment><pub-id pub-id-type="pmcid">PMC9737059</pub-id><pub-id pub-id-type="pmid">34534456</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2021.08.025</pub-id></element-citation></ref><ref id="R54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mumford</surname><given-names>David</given-names></name></person-group><article-title>On the computational architecture of the neocortex</article-title><source>Biological cybernetics</source><year>1992</year><volume>66</volume><issue>3</issue><fpage>241</fpage><lpage>251</lpage><pub-id pub-id-type="pmid">1540675</pub-id></element-citation></ref><ref id="R55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murray</surname><given-names>John D</given-names></name><name><surname>Bernacchia</surname><given-names>Alberto</given-names></name><name><surname>Freedman</surname><given-names>David J</given-names></name><name><surname>Romo</surname><given-names>Ranulfo</given-names></name><name><surname>Wallis</surname><given-names>Jonathan D</given-names></name><name><surname>Cai</surname><given-names>Xinying</given-names></name><name><surname>Padoa-Schioppa</surname><given-names>Camillo</given-names></name><name><surname>Pasternak</surname><given-names>Tatiana</given-names></name><name><surname>Seo</surname><given-names>Hyojung</given-names></name><name><surname>Lee</surname><given-names>Daeyeol</given-names></name><etal/></person-group><article-title>A hierarchy of intrinsic timescales across primate cortex</article-title><source>Nature neuroscience</source><year>2014</year><volume>17</volume><issue>12</issue><fpage>1661</fpage><lpage>1663</lpage><pub-id pub-id-type="pmcid">PMC4241138</pub-id><pub-id pub-id-type="pmid">25383900</pub-id><pub-id pub-id-type="doi">10.1038/nn.3862</pub-id></element-citation></ref><ref id="R56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadim</surname><given-names>Farzan</given-names></name><name><surname>Bucher</surname><given-names>Dirk</given-names></name></person-group><article-title>Neuromodulation of neurons and synapses</article-title><source>Current opinion in neurobiology</source><year>2014</year><volume>29</volume><fpage>48</fpage><lpage>56</lpage><pub-id pub-id-type="pmcid">PMC4252488</pub-id><pub-id pub-id-type="pmid">24907657</pub-id><pub-id pub-id-type="doi">10.1016/j.conb.2014.05.003</pub-id></element-citation></ref><ref id="R57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Neill</surname><given-names>Martin</given-names></name><name><surname>Schultz</surname><given-names>Wolfram</given-names></name></person-group><article-title>Coding of reward risk by orbitofrontal neurons is mostly distinct from coding of reward value</article-title><source>Neuron</source><year>2010</year><volume>68</volume><issue>4</issue><fpage>789</fpage><lpage>800</lpage><pub-id pub-id-type="pmid">21092866</pub-id></element-citation></ref><ref id="R58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Reilly</surname><given-names>Jill X</given-names></name><name><surname>Jbabdi</surname><given-names>Saad</given-names></name><name><surname>Behrens</surname><given-names>Timothy EJ</given-names></name></person-group><article-title>How can a bayesian approach inform neuroscience?</article-title><source>European Journal of Neuroscience</source><year>2012</year><volume>35</volume><issue>7</issue><fpage>1169</fpage><lpage>1179</lpage><pub-id pub-id-type="pmid">22487045</pub-id></element-citation></ref><ref id="R59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Toole</surname><given-names>Sean M</given-names></name><name><surname>Oyibo</surname><given-names>Hassana K</given-names></name><name><surname>Keller</surname><given-names>Georg B</given-names></name></person-group><article-title>Prediction error neurons in mouse cortex are molecularly targetable cell types</article-title><source>BioRxiv</source><year>2022</year><elocation-id>2022-07</elocation-id><pub-id pub-id-type="pmid">37708892</pub-id></element-citation></ref><ref id="R60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pawlak</surname><given-names>Verena</given-names></name><name><surname>Wickens</surname><given-names>Jeffery R</given-names></name><name><surname>Kirkwood</surname><given-names>Alfredo</given-names></name><name><surname>Kerr</surname><given-names>Jason ND</given-names></name></person-group><article-title>Timing is not everything: neuromodulation opens the stdp gate</article-title><source>Frontiers in synaptic neuroscience</source><year>2010</year><volume>2</volume><fpage>146</fpage><pub-id pub-id-type="pmcid">PMC3059689</pub-id><pub-id pub-id-type="pmid">21423532</pub-id><pub-id pub-id-type="doi">10.3389/fnsyn.2010.00146</pub-id></element-citation></ref><ref id="R61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petzschner</surname><given-names>Frederike H</given-names></name><name><surname>Glasauer</surname><given-names>Stefan</given-names></name></person-group><article-title>Iterative bayesian estimation as an explanation for range and regression effects: a study on human path integration</article-title><source>Journal of Neuroscience</source><year>2011</year><volume>31</volume><issue>47</issue><fpage>17220</fpage><lpage>17229</lpage><pub-id pub-id-type="pmcid">PMC6623840</pub-id><pub-id pub-id-type="pmid">22114288</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2028-11.2011</pub-id></element-citation></ref><ref id="R62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname><given-names>Carsten K</given-names></name><name><surname>Xue</surname><given-names>Mingshan</given-names></name><name><surname>He</surname><given-names>Miao</given-names></name><name><surname>Huang</surname><given-names>Z Josh</given-names></name><name><surname>Scanziani</surname><given-names>Massimo</given-names></name></person-group><article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title><source>Nature neuroscience</source><year>2013</year><volume>16</volume><issue>8</issue><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="pmcid">PMC3729586</pub-id><pub-id pub-id-type="pmid">23817549</pub-id><pub-id pub-id-type="doi">10.1038/nn.3446</pub-id></element-citation></ref><ref id="R63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pouget</surname><given-names>Alexandre</given-names></name><name><surname>Beck</surname><given-names>Jeffrey M</given-names></name><name><surname>Ma</surname><given-names>Wei Ji</given-names></name><name><surname>Latham</surname><given-names>Peter E</given-names></name></person-group><article-title>Probabilistic brains: knowns and unknowns</article-title><source>Nature neuroscience</source><year>2013</year><volume>16</volume><issue>9</issue><fpage>1170</fpage><lpage>1178</lpage><pub-id pub-id-type="pmcid">PMC4487650</pub-id><pub-id pub-id-type="pmid">23955561</pub-id><pub-id pub-id-type="doi">10.1038/nn.3495</pub-id></element-citation></ref><ref id="R64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rakitin</surname><given-names>Brian C</given-names></name><name><surname>Gibbon</surname><given-names>John</given-names></name><name><surname>Penney</surname><given-names>Trevor B</given-names></name><name><surname>Malapani</surname><given-names>Chara</given-names></name><name><surname>Hinton</surname><given-names>Sean C</given-names></name><name><surname>Meck</surname><given-names>Warren H</given-names></name></person-group><article-title>Scalar expectancy theory and peak-interval timing in humans</article-title><source>Journal of Experimental Psychology: Animal Behavior Processes</source><year>1998</year><volume>24</volume><issue>1</issue><fpage>15</fpage><pub-id pub-id-type="pmid">9438963</pub-id></element-citation></ref><ref id="R65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>Rajesh PN</given-names></name><name><surname>Ballard</surname><given-names>Dana H</given-names></name></person-group><article-title>Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects</article-title><source>Nature neuroscience</source><year>1999</year><volume>2</volume><issue>1</issue><fpage>79</fpage><pub-id pub-id-type="pmid">10195184</pub-id></element-citation></ref><ref id="R66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ridley</surname><given-names>RM</given-names></name><name><surname>Haystead</surname><given-names>TAJ</given-names></name><name><surname>Baker</surname><given-names>HF</given-names></name><name><surname>Crow</surname><given-names>TJ</given-names></name></person-group><article-title>A new approach to the role of noradrenaline in learning: problem-solving in the marmoset after α-noradrenergic receptor blockade</article-title><source>Pharmacology Biochemistry and Behavior</source><year>1981</year><volume>14</volume><issue>6</issue><fpage>849</fpage><lpage>855</lpage><pub-id pub-id-type="pmid">6114497</pub-id></element-citation></ref><ref id="R67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rowland</surname><given-names>Benjamin</given-names></name><name><surname>Stanford</surname><given-names>Terrence</given-names></name><name><surname>Stein</surname><given-names>Barry</given-names></name></person-group><article-title>A bayesian model unifies multisensory spatial localization with the physiological properties of the superior colliculus</article-title><source>Experimental Brain Research</source><year>2007</year><volume>180</volume><fpage>153</fpage><lpage>161</lpage><pub-id pub-id-type="pmid">17546470</pub-id></element-citation></ref><ref id="R68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudy</surname><given-names>Bernardo</given-names></name><name><surname>Fishell</surname><given-names>Gordon</given-names></name><name><surname>Lee</surname><given-names>SooHyun</given-names></name><name><surname>Hjerling-Leffler</surname><given-names>Jens</given-names></name></person-group><article-title>Three groups of interneurons account for nearly 100% of neocortical gabaergic neurons</article-title><source>Developmental neurobiology</source><year>2011</year><volume>71</volume><issue>1</issue><fpage>45</fpage><lpage>61</lpage><pub-id pub-id-type="pmcid">PMC3556905</pub-id><pub-id pub-id-type="pmid">21154909</pub-id><pub-id pub-id-type="doi">10.1002/dneu.20853</pub-id></element-citation></ref><ref id="R69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Runyan</surname><given-names>Caroline A</given-names></name><name><surname>Piasini</surname><given-names>Eugenio</given-names></name><name><surname>Panzeri</surname><given-names>Stefano</given-names></name><name><surname>Harvey</surname><given-names>Christopher D</given-names></name></person-group><article-title>Distinct timescales of population coding across cortex</article-title><source>Nature</source><year>2017</year><volume>548</volume><issue>7665</issue><fpage>92</fpage><lpage>96</lpage><pub-id pub-id-type="pmcid">PMC5859334</pub-id><pub-id pub-id-type="pmid">28723889</pub-id><pub-id pub-id-type="doi">10.1038/nature23020</pub-id></element-citation></ref><ref id="R70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rushworth</surname><given-names>Matthew FS</given-names></name><name><surname>Behrens</surname><given-names>Timothy EJ</given-names></name></person-group><article-title>Choice, uncertainty and value in prefrontal and cingulate cortex</article-title><source>Nature neuroscience</source><year>2008</year><volume>11</volume><issue>4</issue><fpage>389</fpage><lpage>397</lpage><pub-id pub-id-type="pmid">18368045</pub-id></element-citation></ref><ref id="R71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutishauser</surname><given-names>Ueli</given-names></name><name><surname>Ye</surname><given-names>Shengxuan</given-names></name><name><surname>Koroma</surname><given-names>Matthieu</given-names></name><name><surname>Tudusciuc</surname><given-names>Oana</given-names></name><name><surname>Ross</surname><given-names>Ian B</given-names></name><name><surname>Chung</surname><given-names>Jeffrey M</given-names></name><name><surname>Mamelak</surname><given-names>Adam N</given-names></name></person-group><article-title>Representation of retrieval confidence by single neurons in the human medial temporal lobe</article-title><source>Nature neuroscience</source><year>2015</year><volume>18</volume><issue>7</issue><fpage>1041</fpage><lpage>1050</lpage><pub-id pub-id-type="pmcid">PMC4482779</pub-id><pub-id pub-id-type="pmid">26053402</pub-id><pub-id pub-id-type="doi">10.1038/nn.4041</pub-id></element-citation></ref><ref id="R72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutishauser</surname><given-names>Ueli</given-names></name><name><surname>Aflalo</surname><given-names>Tyson</given-names></name><name><surname>Rosario</surname><given-names>Emily R</given-names></name><name><surname>Pouratian</surname><given-names>Nader</given-names></name><name><surname>Andersen</surname><given-names>Richard A</given-names></name></person-group><article-title>Single-neuron representation of memory strength and recognition confidence in left human posterior parietal cortex</article-title><source>Neuron</source><year>2018</year><volume>97</volume><issue>1</issue><fpage>209</fpage><lpage>220</lpage><pub-id pub-id-type="pmcid">PMC5754243</pub-id><pub-id pub-id-type="pmid">29249283</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2017.11.029</pub-id></element-citation></ref><ref id="R73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soltani</surname><given-names>Alireza</given-names></name><name><surname>Izquierdo</surname><given-names>Alicia</given-names></name></person-group><article-title>Adaptive learning under expected and unexpected uncertainty</article-title><source>Nature Reviews Neuroscience</source><year>2019</year><volume>20</volume><issue>10</issue><fpage>635</fpage><lpage>644</lpage><pub-id pub-id-type="pmcid">PMC6752962</pub-id><pub-id pub-id-type="pmid">31147631</pub-id><pub-id pub-id-type="doi">10.1038/s41583-019-0180-y</pub-id></element-citation></ref><ref id="R74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Summerfield</surname><given-names>Christopher</given-names></name><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><name><surname>Koechlin</surname><given-names>Etienne</given-names></name></person-group><article-title>Perceptual classification in a rapidly changing environment</article-title><source>Neuron</source><year>2011</year><volume>71</volume><issue>4</issue><fpage>725</fpage><lpage>736</lpage><pub-id pub-id-type="pmcid">PMC3975575</pub-id><pub-id pub-id-type="pmid">21867887</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2011.06.022</pub-id></element-citation></ref><ref id="R75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swanson</surname><given-names>Olivia K</given-names></name><name><surname>Maffei</surname><given-names>Arianna</given-names></name></person-group><article-title>From hiring to firing: activation of inhibitory neurons and their recruitment in behavior</article-title><source>Frontiers in molecular neuroscience</source><year>2019</year><volume>12</volume><fpage>168</fpage><pub-id pub-id-type="pmcid">PMC6617984</pub-id><pub-id pub-id-type="pmid">31333413</pub-id><pub-id pub-id-type="doi">10.3389/fnmol.2019.00168</pub-id></element-citation></ref><ref id="R76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tremblay</surname><given-names>Robin</given-names></name><name><surname>Lee</surname><given-names>Soohyun</given-names></name><name><surname>Rudy</surname><given-names>Bernardo</given-names></name></person-group><article-title>Gabaergic interneurons in the neocortex: from cellular properties to circuits</article-title><source>Neuron</source><year>2016</year><volume>91</volume><issue>2</issue><fpage>260</fpage><lpage>292</lpage><pub-id pub-id-type="pmcid">PMC4980915</pub-id><pub-id pub-id-type="pmid">27477017</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2016.06.033</pub-id></element-citation></ref><ref id="R77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urban-Ciecko</surname><given-names>Joanna</given-names></name><name><surname>Barth</surname><given-names>Alison L</given-names></name></person-group><article-title>Somatostatin-expressing neurons in cortical networks</article-title><source>Nature Reviews Neuroscience</source><year>2016</year><volume>17</volume><issue>7</issue><fpage>401</fpage><lpage>409</lpage><pub-id pub-id-type="pmcid">PMC5635659</pub-id><pub-id pub-id-type="pmid">27225074</pub-id><pub-id pub-id-type="doi">10.1038/nrn.2016.53</pub-id></element-citation></ref><ref id="R78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallace</surname><given-names>Mark T</given-names></name><name><surname>Meredith</surname><given-names>M Alex</given-names></name><name><surname>Stein</surname><given-names>Barry E</given-names></name></person-group><article-title>Multisensory integration in the superior colliculus of the alert cat</article-title><source>Journal of neurophysiology</source><year>1998</year><volume>80</volume><issue>2</issue><fpage>1006</fpage><lpage>1010</lpage><pub-id pub-id-type="pmid">9705489</pub-id></element-citation></ref><ref id="R79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wester</surname><given-names>Jason C</given-names></name><name><surname>McBain</surname><given-names>Chris J</given-names></name></person-group><article-title>Behavioral state-dependent modulation of distinct interneuron subtypes and consequences for circuit function</article-title><source>Current opinion in neurobiology</source><year>2014</year><volume>29</volume><fpage>118</fpage><lpage>125</lpage><pub-id pub-id-type="pmcid">PMC4268408</pub-id><pub-id pub-id-type="pmid">25058112</pub-id><pub-id pub-id-type="doi">10.1016/j.conb.2014.07.007</pub-id></element-citation></ref><ref id="R80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>J Kael</given-names></name><name><surname>Monosov</surname><given-names>Ilya E</given-names></name></person-group><article-title>Neurons in the primate dorsal striatum signal the uncertainty of object–reward associations</article-title><source>Nature communications</source><year>2016</year><volume>7</volume><issue>1</issue><elocation-id>12735</elocation-id><pub-id pub-id-type="pmcid">PMC5027277</pub-id><pub-id pub-id-type="pmid">27623750</pub-id><pub-id pub-id-type="doi">10.1038/ncomms12735</pub-id></element-citation></ref><ref id="R81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilmes</surname><given-names>Katharina A</given-names></name><name><surname>Petrovici</surname><given-names>Mihai A</given-names></name><name><surname>Sachidhanandam</surname><given-names>Shankar</given-names></name><name><surname>Senn</surname><given-names>Walter</given-names></name></person-group><article-title>Uncertainty-modulated prediction errors in cortical microcircuits</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023-05</elocation-id></element-citation></ref><ref id="R82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>Hugh R</given-names></name><name><surname>Cowan</surname><given-names>Jack D</given-names></name></person-group><article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title><source>Biophysical journal</source><year>1972</year><volume>12</volume><issue>1</issue><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="pmcid">PMC1484078</pub-id><pub-id pub-id-type="pmid">4332108</pub-id><pub-id pub-id-type="doi">10.1016/S0006-3495(72)86068-5</pub-id></element-citation></ref><ref id="R83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>Philip</given-names></name><name><surname>Braun</surname><given-names>Andreas</given-names></name><name><surname>Malagarriga</surname><given-names>Daniel</given-names></name><name><surname>Moehlis</surname><given-names>Jeff</given-names></name><name><surname>Bote</surname><given-names>Ruben Moreno</given-names></name><name><surname>Pouget</surname><given-names>Alexandre</given-names></name><name><surname>Louis</surname><given-names>Matthieu</given-names></name></person-group><article-title>Computational principles of adaptive multisensory combination in the drosophila larva</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023-05</elocation-id></element-citation></ref><ref id="R84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yon</surname><given-names>Daniel</given-names></name><name><surname>Frith</surname><given-names>Chris D</given-names></name></person-group><article-title>Precision and the bayesian brain</article-title><source>Current Biology</source><year>2021</year><volume>31</volume><issue>17</issue><fpage>R1026</fpage><lpage>R1032</lpage><pub-id pub-id-type="pmid">34520708</pub-id></element-citation></ref><ref id="R85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Angela J</given-names></name><name><surname>Dayan</surname><given-names>Peter</given-names></name></person-group><article-title>Uncertainty, neuromodulation, and attention</article-title><source>Neuron</source><year>2005</year><volume>46</volume><issue>4</issue><fpage>681</fpage><lpage>692</lpage><pub-id pub-id-type="pmid">15944135</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Neural network model to track both the uncertainty of sensory inputs and predictions.</title><p><bold>(A)</bold> Example illustration for context-dependent integration of information. Left: When walking down an unfamiliar staircase that is visible, the brain might rely solely on external sensory information. Middle: When walking down the same stairs without visual information, the brain might rely on predictions formed by previous experience. Right: When climbing down an unexplored mountain in foggy conditions, the brain might need to integrate sensory information and predictions simultaneously. <bold>(B)</bold> Top: Illustration of a prediction-error (PE) circuit with both negative and positive PE (nPE/pPE) neurons that receive inhibition from three different inhibitory interneuron types: parvalbumin-expressing (PV), somatostatin-expressing (SOM), and vasoactive intestinal peptide-expressing (VIP) interneurons. Local excitatory connections are not shown for clarity. Bottom: Responses of an nPE and pPE neuron. The nPE neuron only increases its activity relative to a baseline when the sensory input is weaker than predicted, while the pPE neuron only increases its activity relative to a baseline when the sensory input is stronger than predicted. <bold>(C)</bold> Illustration of network model that estimates the mean and variance of the external sensory stimuli. The core of this network model is the PE circuit shown in (B). The lower-level V neuron encodes the variance, while the lower-level M neuron encodes the mean of the sensory input. <bold>(D)</bold> Same as in (C) but the feedforward input is the activity of the lower-level M neuron.</p></caption><graphic xlink:href="EMS192797-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Prediction-error neurons as the basis for estimating mean and variance of sensory stimuli.</title><p><bold>(A)</bold> Illustration of the inputs with which the network (<xref ref-type="fig" rid="F1">Fig. 1C</xref>) is stimulated. Network is exposed to a sequence of constant stimuli drawn from a uniform distribution. The gray shaded boxes symbolize different values from the distribution. <bold>(B)</bold> PE neuron activity hardly changes with stimulus strength (left) but strongly increases with stimulus variability (right). <bold>(C)</bold> Interneuron activity strongly changes with stimulus strength (left) but hardly changes with stimulus variability (right). <bold>(D)</bold> M neuron correctly encodes the mean of the sensory stimuli. Left: Illustration of the input synapses onto the M neuron. Middle: Activity of the M neuron over time for one example distribution (black star in right panel). Right: Normalised absolute difference between the averaged mean and the activity of the M neuron in the steady state for different parametrizations of the stimulus distribution. <bold>(E)</bold> V neuron correctly encodes the variance of the sensory stimuli. Left: Illustration of the input synapses onto the V neuron. Middle: Activity of the V neuron over time for one example distribution (black star in right panel). Right: Normalised absolute difference between the averaged variance and the activity of the V neuron in the steady state for different parametrizations of the stimulus distribution.</p></caption><graphic xlink:href="EMS192797-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Estimating the uncertainty of both the sensory input and the prediction.</title><p><bold>(A)</bold> Illustration of the stimulation protocol. The network is exposed to a sequence of stimuli (one stimulus per trial). To account for stimulus variability, each stimulus is represented by 10 stimulus values drawn from a normal distribution. To account for the volatility of the environment, in each trial, the stimulus mean is drawn from a uniform distribution (denoted trial-to-trial variability). <bold>(B)</bold> Illustration of how the weighted output is calculated. The sensory weight <italic>α</italic> lies between zero (system relies perfectly on prediction) and one (system relies solely on the sensory input). <bold>(C)</bold> Limit case example in which the stimulus variability is zero but the trial-to-trial variability is high. Left: Illustration of the stimulation protocol. Middle: Weighted output follows closely the sensory stimuli. Right: Sensory weight (function of the variances, see B) close to 1, indicating that the network ignores the prediction. Input statistics shown in E. <bold>(D)</bold> Limit case example in which the stimulus variability is high but the trial-to-trial variability is zero. Left: Illustration of the stimulation protocol. Middle: Weighted output pushed towards the mean of the sensory stimuli. Right: Sensory weight close to zero, indicating that the network ignores the sensory stimuli. Input statistics shown in E. <bold>(E)</bold> Sensory weight for different input statistics. Predictions are weighted more strongly when the stimulus variability is larger than the trial-to-trial variability. <bold>(F)</bold> Sensory weight, averaged over many trials, for two different trial durations. Gray shading denotes the SEM. Predictions are weighted more strongly at the beginning of a new trial.</p></caption><graphic xlink:href="EMS192797-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Neuromodulator-based shifts in the weighting of sensory inputs and predictions.</title><p><bold>(A)</bold> Neuromodulators acting on the interneurons can shift the weighting of sensory inputs and predictions. The changes depend on the type of interneuron targeted and the modulation strength (here simulated through an additional excitatory input). Considered are two limit cases (upper row: more sensory-driven before modulation, lower row: more prediction-driven before modulation). The results are shown for three different PE circuits (denotes by different markers). <bold>(B)</bold> When SOM and VIP neurons are equally modulated, the sensory weight remains unaffected. <bold>(C)</bold> The V neurons’ activities depend on the PE neurons. Hence, perturbing the nPE and pPE neuron changes the uncertainty estimation. Left: stimulating the pPE (triangle) or nPE (upside down triangle) affects the V neuron of the same subnetwork, denoted by matching marker and line colors (dark brown: lower circuit, light brown: higher circuit). Right: while stimulating the lower PE neurons affects the higher-order V neuron, stimulating the higher-order PE neurons does not change the activity of the lower-order V neuron (denoted by not matching marker and line colors). <bold>(D)</bold> The V neuron activity, and hence the sensory weight, changes as a result of the modulated PE neuron activity. The PE neuron activity, on the other hand, changes as a result of the interneurons being modulated. The interneurons change the baseline (left) and the gain (right) of the PE neurons. Whether an interneuron increases or decreases the estimated variance depends on both factors.</p></caption><graphic xlink:href="EMS192797-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Mechanisms underlying the contraction bias.</title><p><bold>(A)</bold> Contraction bias in the model for two different stimulus uncertainties depicted in the inset. Bias is defined as the weighted output minus the stimulus mean. The absolute value of the slope of the linear fit, <italic>m</italic>, is a measure of the bias. The larger the slope, the larger the bias. <bold>(B)</bold> As a consequence of the sensory weight, the slope increases with stimulus variability (bias increases) and decreases with trial-to-trial variability (bias decreases). <bold>(C)</bold> Bias is independent of the trial-to-trial variability when the stimulus variability is zero. <bold>(D)</bold> Bias is independent of the stimulus variability when the trial-to-trial variability is zero. <bold>(E)</bold> The slope depends on the trial duration.</p></caption><graphic xlink:href="EMS192797-f005"/></fig></floats-group></article>