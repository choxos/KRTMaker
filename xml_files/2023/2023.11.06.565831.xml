<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS190791</article-id><article-id pub-id-type="doi">10.1101/2023.11.06.565831</article-id><article-id pub-id-type="archive">PPR754181</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Inference of Locus-Specific Population Mixtures From Linked Genome-Wide Allele Frequencies</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Reyna-Blanco</surname><given-names>Carlos S.</given-names></name><xref ref-type="aff" rid="A1">b</xref><xref ref-type="aff" rid="A2">c</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Caduff</surname><given-names>Madleina</given-names></name><xref ref-type="aff" rid="A1">b</xref><xref ref-type="aff" rid="A2">c</xref></contrib><contrib contrib-type="author"><name><surname>Galimberti</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="A3">d</xref></contrib><contrib contrib-type="author"><name><surname>Leuenberger</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="A4">e</xref></contrib><contrib contrib-type="author"><name><surname>Wegmann</surname><given-names>Daniel</given-names></name><xref ref-type="aff" rid="A1">b</xref><xref ref-type="aff" rid="A2">c</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>b</label> Department of Biology, University of Fribourg, 1700 Fribourg, Switzerland</aff><aff id="A2"><label>c</label> Swiss Institute of Bioinformatics, 1700 Fribourg, Switzerland</aff><aff id="A3"><label>d</label> Yale School of Medicine, New Haven, CT</aff><aff id="A4"><label>e</label> Department of Mathematics, University of Fribourg, 1700 Fribourg, Switzerland</aff><author-notes><corresp id="CR1">
<label>*</label> Corresponding author, <email>daniel.wegmann@unifr.ch</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>09</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>06</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Admixture between populations and species is common in nature. Since the influx of new genetic material might be either facilitated or hindered by selection, variation in mixture proportions along the genome is expected in organisms undergoing recombination. Various graph-based models have been developed to better understand these evolutionary dynamics of population splits and mixtures. However, current models assume a single mixture rates for the entire genome and do not explicitly account for linkage. Here, we introduce <monospace>TreeSwirl</monospace>, a novel method for inferring branch lengths and locus-specific mixture proportions by using genome-wide allele frequency data, assuming that the admixture graph is known or has been inferred. <monospace>TreeSwirl</monospace> builds upon <monospace>TreeMix</monospace> that uses Gaussian processes to estimate the presence of gene flow between diverged populations. However, in contrast to <monospace>TreeMix</monospace>, our model infers locus-specific mixture proportions employing a Hidden Markov Model that accounts for linkage. Through simulated data, we demonstrate that <monospace>TreeSwirl</monospace> can accurately estimate locus-specific mixture proportions and handle complex demographic scenarios. It also outperforms related D- and f-statistics in terms of accuracy and sensitivity to detect introgressed loci.</p></abstract><kwd-group><kwd>Gene flow</kwd><kwd>Admixture</kwd><kwd>Introgression rate</kwd><kwd>Gaussian process</kwd><kwd>Linkage</kwd><kwd>Hidden Markov Model</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>2</label><title>Introduction</title><p id="P2">Gene flow, the exchange of genetic material between populations or different species (<xref ref-type="bibr" rid="R69">Slatkin, 1985a</xref>), can occur through various mechanisms, such as migration, admixture, hybridization, cross-fertilization, or even by the dispersal of diaspores and pollinators (<xref ref-type="bibr" rid="R6">Barton and Hewitt, 1985</xref>; <xref ref-type="bibr" rid="R20">Ellstrand et al., 2003</xref>; <xref ref-type="bibr" rid="R78">Tung and Barreiro, 2017</xref>; <xref ref-type="bibr" rid="R9">Burgarella et al., 2019</xref>). This exchange may play a significant role in the maintenance of genetic variation, but also in the adaptation to multiple ecological niches (<xref ref-type="bibr" rid="R2">Anderson, 1949</xref>; <xref ref-type="bibr" rid="R70">Slatkin, 1985b</xref>, <xref ref-type="bibr" rid="R71">1987</xref>; <xref ref-type="bibr" rid="R64">Rieseberg and Wendel, 1993</xref>; <xref ref-type="bibr" rid="R5">Barton, 2001</xref>). At sufficient levels, gene flow can lead to homogenization of populations, particularly in the face of opposing genetic drift (<xref ref-type="bibr" rid="R19">Ellstrand, 2014</xref>). Gene flow might also increase genetic variation at a much higher rate than mutation (<xref ref-type="bibr" rid="R27">Grant and Grant, 1994</xref>) and impact the process of speciation by becoming a primary source of genetic diversity and adaptive novelty for a population (<xref ref-type="bibr" rid="R20">Ellstrand et al., 2003</xref>; <xref ref-type="bibr" rid="R1">Abbott et al., 2013</xref>). Several genetic analyses have shown that gene flow, both ancient and present, is a common phenomenon in nature (<xref ref-type="bibr" rid="R26">Grant and Grant, 1992</xref>; <xref ref-type="bibr" rid="R42">Mallet, 2005</xref>; <xref ref-type="bibr" rid="R52">Patterson et al., 2006</xref>; <xref ref-type="bibr" rid="R82">Wegmann and Excoffier, 2010</xref>; <xref ref-type="bibr" rid="R78">Tung and Barreiro, 2017</xref>; <xref ref-type="bibr" rid="R44">Marchi et al., 2022</xref>), and a bifurcating tree, representing population or species historical relationships, fails to account for it (<xref ref-type="bibr" rid="R33">Kulathinal et al., 2009</xref>; <xref ref-type="bibr" rid="R62">Reich et al., 2009</xref>; <xref ref-type="bibr" rid="R73">Sousa et al., 2009</xref>; <xref ref-type="bibr" rid="R28">Green et al., 2010</xref>; <xref ref-type="bibr" rid="R15">Durand et al., 2011</xref>; <xref ref-type="bibr" rid="R61">Reich et al., 2012</xref>). This led to the development of methods that use allele-frequency data and graph-based models to infer population splits and test for the presence of gene flow between divergent populations or species (<xref ref-type="bibr" rid="R54">Pickrell and Pritchard, 2012</xref>; <xref ref-type="bibr" rid="R51">Patterson et al., 2012</xref>; <xref ref-type="bibr" rid="R86">Yang et al., 2012</xref>; <xref ref-type="bibr" rid="R18">Eaton and Ree, 2013</xref>; <xref ref-type="bibr" rid="R37">Lipson et al., 2013</xref>, <xref ref-type="bibr" rid="R38">2014</xref>; <xref ref-type="bibr" rid="R45">Martin et al., 2013</xref>; <xref ref-type="bibr" rid="R31">Kozak et al., 2021</xref>), which, for instance, confidently settled the long-standing question whether gene flow occurred between modern humans and archaic hominins. However, these methods assume a genome-wide gene flow rate per migration edge, which is unrealistic in the presence of selection. In theory, the effective gene flow may vary significantly along the genome because of selection and genetic drift (<xref ref-type="bibr" rid="R85">Yamamichi and Innan, 2012</xref>), making it essential to quantify these variations to better understand the dynamics that lead to introgression (<xref ref-type="bibr" rid="R60">Racimo et al., 2015</xref>, <xref ref-type="bibr" rid="R59">2017</xref>; <xref ref-type="bibr" rid="R75">Suarez-Gonzalez et al., 2018</xref>; <xref ref-type="bibr" rid="R65">Sankararaman, 2020</xref>).</p><p id="P3">Introgression is a lasting consequence of gene flow that leads to the assimilation of variants into the local gene pool through repeated back-crossing, resulting in their permanent inclusion (<xref ref-type="bibr" rid="R3">Anderson and Hubricht, 1938</xref>). When introgressed loci increase the fitness of the recipient population, this is known as “adaptive introgression”. Unlike neutral introgression, which can be lost over time due to drift, adaptive introgression is sustained by selection and can eventually lead to fixation (<xref ref-type="bibr" rid="R87">Zhang et al., 2021</xref>). But selection may also prevent introgression if it reduces fitness (<xref ref-type="bibr" rid="R12">Christe et al., 2016</xref>). While introgressed loci may be identified through explicit demographic modelling (<xref ref-type="bibr" rid="R39">Luqman et al., 2021</xref>), the classic way is via population genetic summary statistics. Patterson’s D, for example, has been estimated in sliding windows along the genome to identify introgressed loci (<xref ref-type="bibr" rid="R14">Dasmahapatra et al., 2012</xref>; <xref ref-type="bibr" rid="R32">Kronforst et al., 2013</xref>; <xref ref-type="bibr" rid="R72">Smith and Kronforst, 2013</xref>; <xref ref-type="bibr" rid="R63">Rheindt et al., 2014</xref>; <xref ref-type="bibr" rid="R24">Fontaine et al., 2015</xref>). Since it was originally intended for genome-wide analysis (<xref ref-type="bibr" rid="R46">Martin et al., 2015</xref>), more suitable related statistics have been used for analyzing specific short genomic regions, such as <italic>f<sub>d</sub></italic>, <italic>f<sub>dM</sub></italic>, and <italic>d<sub>f</sub></italic> (<xref ref-type="bibr" rid="R46">Martin et al., 2015</xref>; <xref ref-type="bibr" rid="R40">Malinsky et al., 2015</xref>; <xref ref-type="bibr" rid="R53">Pfeifer and Kapan, 2019</xref>; <xref ref-type="bibr" rid="R41">Malinsky et al., 2021</xref>). There are other statistics, for instance, S* and its variants that use linkage disequilibrium information to detect long introgressed haplotypes (<xref ref-type="bibr" rid="R55">Plagnol and Wall, 2006</xref>; <xref ref-type="bibr" rid="R81">Wall et al., 2009</xref>; <xref ref-type="bibr" rid="R79">Vernot and Akey, 2014</xref>; <xref ref-type="bibr" rid="R80">Vernot et al., 2016</xref>; <xref ref-type="bibr" rid="R8">Browning et al., 2018</xref>) or ArchIE that combines diverse summary statistics to detect introgressed haplotypes without a reference (<xref ref-type="bibr" rid="R16">Durvasula and Sankararaman, 2019</xref>, <xref ref-type="bibr" rid="R17">2020</xref>). However, outlier scans based on such statistics are likely to ignore valuable information present in the full data, do not model linkage explicitly or require an arbitrary choice of large window-size and outliers identification. To overcome these constraints, probabilistic frameworks such as Hidden Markov Models (HMMs) (<xref ref-type="bibr" rid="R58">Rabiner and Juang, 1986</xref>; <xref ref-type="bibr" rid="R57">Prüfer et al., 2014</xref>; <xref ref-type="bibr" rid="R67">Seguin-Orlando et al., 2014</xref>; <xref ref-type="bibr" rid="R68">Skov et al., 2018</xref>; <xref ref-type="bibr" rid="R74">Steinrücken et al., 2018</xref>), and Conditional Random Fields (CRF) (<xref ref-type="bibr" rid="R66">Sankararaman et al., 2014</xref>) have been applied to infer the ancestry state of each site. These methods are extensions of models that infer local ancestry from genotyping data (<xref ref-type="bibr" rid="R76">Tang et al., 2006</xref>; <xref ref-type="bibr" rid="R56">Price et al., 2009</xref>; <xref ref-type="bibr" rid="R83">Wegmann et al., 2011</xref>; <xref ref-type="bibr" rid="R35">Lawson et al., 2012</xref>; <xref ref-type="bibr" rid="R43">Maples et al., 2013</xref>) and while explicitly accounting for demographic history and linkage, they rely on phased and training sequence data, unadmixed or archaic reference, and detailed demographic models. As a consequence, such approaches are not easily applicable to non-model species for which only limited data and knowledge is available.</p><p id="P4">To complement these methods, we here propose a model that makes use of Gaussian processes to infer locus-specific mixture proportions. Gaussian processes have a rather long history to model allele frequency differences between populations (<xref ref-type="bibr" rid="R11">Cavalli-Sforza and Edwards, 1967</xref>; <xref ref-type="bibr" rid="R23">Felsenstein, 1981</xref>), but have recently seen a surge in applications due to the development of the popular tool <monospace>TreeMix</monospace> (<xref ref-type="bibr" rid="R54">Pickrell and Pritchard, 2012</xref>). Our method, <monospace>TreeSwirl</monospace>, explicitly takes an admixture graph (e.g. inferred by <monospace>TreeMix</monospace>) and genome-wide allele frequencies to infer locus-specific mixture proportions. To account for linkage, we make use of a Hidden Markov Model (HMM), wherein the hidden states are represented by the proportion of the mixture at a particular site and the observed data is represented by the sampled allele frequencies. To evaluate the performance of our method against other tools, we simulated data using various demographic models. We estimated the mixture proportions with <monospace>TreeSwirl</monospace> and computed related D- and F-statistics using D-suite Dinvestigate (<xref ref-type="bibr" rid="R41">Malinsky et al., 2021</xref>). Our findings revealed that <monospace>TreeSwirl</monospace> surpasses the summary statistics estimates in detecting the simulated signal of introgression under different scenarios, although at an additional computational cost. Furthermore, by applying <monospace>TreeSwirl</monospace> to real data cases, we successfully identified candidate genomic regions where migration rates fluctuate and may be subject to selection.</p></sec><sec id="S2" sec-type="materials | methods"><label>3</label><title>Materials and Methods</title><sec id="S3"><label>3.1</label><title>The Model</title><p id="P5">Consider a set of populations <italic>m</italic> = 1, 2, …, <italic>M</italic> that are linked by a graph 𝓖 which represents their population history in terms of population splits and migration events. Consider as well a series of diploid, bi-allelic loci <italic>l</italic> = 1, 2, …, <italic>L</italic>, where the total number of loci <italic>L</italic> might constitute, for instance, consecutive SNPs along the genome. At each locus <italic>l</italic>, a total number of <italic><bold>N</bold><sub>l</sub></italic> = (<italic>N<sub>l</sub></italic><sub>1</sub>, …, <italic>N<sub>lM</sub></italic>) alleles have been observed across the <italic>M</italic> populations, of which <italic><bold>n</bold><sub>l</sub></italic> = (<italic>n<sub>l</sub></italic><sub>1</sub>, …, <italic>n<sub>lM</sub></italic>) were derived and the remaining ancestral (or otherwise polarized). To model sampled allele counts <italic><bold>n</bold><sub>l</sub></italic>|<italic><bold>N</bold><sub>l</sub></italic> we distinguish two processes: the first models the distribution of the vector of the actual but unknown population frequencies <italic><bold>y</bold><sub>l</sub></italic> = (<italic>y<sub>l</sub></italic><sub>1</sub>, …, <italic>y<sub>lM</sub></italic>)′ given the graph 𝓖, and the second the distribution of the sampled allele counts <italic><bold>n</bold><sub>l</sub></italic>|<italic><bold>N</bold><sub>l</sub></italic> given <italic><bold>y</bold><sub>l</sub></italic> (<xref ref-type="fig" rid="F1">Fig 1A</xref>).</p><sec id="S4"><label>3.1.1</label><title>Evolution along the graph 𝓖</title><p id="P6">We assume, as in <xref ref-type="bibr" rid="R54">Pickrell and Pritchard (2012)</xref>, that the change in allele frequencies from the root to the tips of 𝓖 is modeled as a Brownian motion (BM) process. For each locus <italic>l</italic>, the BM process starts at the root of 𝓖 at a value of allele frequency which we denote by <italic>ν<sub>l</sub></italic>. It proceeds along the branches of 𝓖 and finally gives rise to the above-mentioned random vector <italic><bold>y</bold><sub>l</sub></italic> at the leaves of 𝓖. The probability of <italic><bold>y</bold><sub>l</sub></italic> is given by the multivariate normal density <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>𝒩</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic><bold>ν</bold><sub>l</sub></italic> = (<italic>ν<sub>l</sub>, …, ν<sub>l</sub></italic>)′ is the mean vector and <bold><italic>V</italic></bold> (<italic>ν<sub>l</sub></italic>) is the variance-covariance matrix corresponding to the BM on 𝓖. For the construction of <bold><italic>V</italic></bold> (<italic>ν<sub>l</sub></italic>), which depends on the topology of 𝓖, the lengths of the branches in 𝓖 and the migration rates, we follow <xref ref-type="bibr" rid="R54">Pickrell and Pritchard (2012)</xref>. We set <disp-formula id="FD2"><label>(1)</label><mml:math id="M2"><mml:mstyle><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic><bold>W</bold><sub>l</sub></italic> only depends on the graph topology, the branch lengths and the migration rates.</p><p id="P7">However, it was long recognized that BM with constant variance is not adequately describing allele frequency changes, especially close to boundaries and various transformations to alleviate the problem have been proposed (<xref ref-type="bibr" rid="R23">Felsenstein, 1981</xref>). Here we will consider the transformation <disp-formula id="FD3"><label>(2)</label><mml:math id="M3"><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>arcsin</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> from the interval [0, 1] onto [−<italic>π</italic>/2, <italic>π</italic>/2]. This has the advantage that all factors of <italic>ν<sub>l</sub></italic>(1 − <italic>ν<sub>l</sub></italic>) in front of the variance matrices will be canceled. We thus replace (<xref ref-type="disp-formula" rid="FD2">eq. 1</xref>) by <disp-formula id="FD4"><label>(3)</label><mml:math id="M4"><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mstyle><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P8">Let <italic><bold>x</bold><sub>l</sub></italic> = (<italic>x<sub>l</sub></italic><sub>1</sub>, …, <italic>x<sub>lM</sub></italic>), <italic>x<sub>lm</sub></italic> = arcsin(2<italic>y<sub>lm</sub></italic> − 1) denote the transformed population allele frequencies. The distribution of <italic><bold>x</bold><sub>l</sub></italic> thus follows the multivariate normal density <disp-formula id="FD5"><label>(4)</label><mml:math id="M5"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> with <italic><bold>μ</bold><sub>l</sub></italic> = (<italic>μ<sub>l</sub></italic>, …, <italic>μ<sub>l</sub></italic>) = <italic>μ<sub>l</sub></italic><bold>1</bold>.</p><p id="P9">The matrix <italic><bold>W</bold><sub>l</sub></italic> is constructed as follows. Let 𝓖 be a rooted population graph with <italic>K</italic> oriented branches <italic>k</italic> = 1, …, <italic>K</italic> of length <italic>c<sub>k</sub></italic>, <bold><italic>c</italic></bold> = (<italic>c</italic><sub>1</sub>, …, <italic>c<sub>K</sub></italic>)′; the orientation of the branches points in direction of the leaves. We assume that the graph also contains <italic>I</italic> oriented migration edges <italic>τ<sub>i</sub></italic>, <italic>i</italic> = 1, …, <italic>I</italic>, to which we assign no branch length. The migration edges should be placed such that there are no cycles in the graph. However, we allow for bi-directional migration edges, which, to avoid cycles, we model effectively as two migration edges, of which the starting point of one precedes the end point of the other by an infinitesimally small branch.</p><p id="P10">We now consider paths leading from the root of the graph to a leaf taking some of the migration edges (open edges) and leaving others out (closed edges). More precisely, let <disp-formula id="FD6"><mml:math id="M6"><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> be a binary vector indicating a certain configuration of open and closed migration edges: a bit <italic>b<sub>i</sub></italic> = 1 indicates that the migration edge <italic>τ<sub>i</sub></italic> is open and <italic>b<sub>i</sub></italic> = 0 that the migration edge <italic>τ<sub>i</sub></italic> is closed (<xref ref-type="fig" rid="F1">Fig 1B</xref>). We denote by <italic>w<sub>li</sub></italic> the migration rate, i.e. the probability of edge <italic>τ<sub>i</sub></italic> to be open, and thus we assign to the configuration <bold><italic>b</italic></bold> the probability <disp-formula id="FD7"><label>(5)</label><mml:math id="M7"><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P11">Now, for a given configuration <bold><italic>b</italic></bold>, pick a population (leaf) <italic>m</italic> and a branch <italic>k</italic>. There is at most one path leading from the root to the population <italic>m</italic> and taking exactly the open migration edges according to <bold><italic>b</italic></bold>. If, moreover, this path contains the branch <italic>k</italic>, we set the indicator function <italic>I<sub>mk</sub></italic>(<bold><italic>b</italic></bold>) equal to 1. Otherwise we set <italic>I<sub>mk</sub></italic>(<bold><italic>b</italic></bold>) = 0.</p><p id="P12">Using this notation, we can now define the <italic>M</italic> × <italic>M</italic> -matrices <italic><bold>J</bold><sub>lk</sub></italic> for each branch <italic>k</italic> element-wise by <disp-formula id="FD8"><label>(6)</label><mml:math id="M8"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:msup><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo>′</mml:mo></mml:msup></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where each sum runs over all the 2<italic><sup>I</sup></italic> possible configurations of <bold><italic>b</italic></bold> and <italic><bold>b</bold><sup>′</sup></italic>, respectively. Each matrix <italic><bold>J</bold><sub>lk</sub></italic> thus reflects the probabilities that branch <italic>k</italic> was common for any pair of leaves.</p><p id="P13">The matrix <italic><bold>W</bold><sub>l</sub></italic>, after all, is given by <disp-formula id="FD9"><label>(7)</label><mml:math id="M9"><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">J</mml:mi></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P14">This construction of the variance matrix <italic><bold>W</bold><sub>l</sub></italic>(<italic><bold>w</bold><sub>l</sub></italic>) is a generalized reformulation of an argument given in <xref ref-type="bibr" rid="R54">Pickrell and Pritchard (2012)</xref>.</p><p id="P15">To unclutter the notation, we will use <italic><bold>W</bold><sub>l</sub></italic> = <italic><bold>W</bold><sub>l</sub></italic>(<italic><bold>w</bold><sub>l</sub></italic>) in the rest of this article and thus not indicate its dependence on the migration rates <italic><bold>w</bold><sub>l</sub></italic> = (<italic>w<sub>l</sub></italic><sub>1</sub>, …, <italic>w<sub>lI</sub></italic>).</p></sec><sec id="S5"><label>3.1.2</label><title>Sampling</title><p id="P16">We assume that the observed allele counts <italic>n<sub>lm</sub></italic> at locus <italic>l</italic> and population <italic>m</italic> follow a binomial distribution with parameters <italic>N<sub>lm</sub></italic> and <italic>y<sub>lm</sub></italic>, where <italic>y<sub>lm</sub></italic> is the true allele frequency in population <italic>m</italic>. By independence of the samples, we have <disp-formula id="FD10"><label>(8)</label><mml:math id="M10"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P17">If the sample sizes are sufficiently large, we can approximate this distribution by a multivariate normal density. Let <bold>f</bold><italic><sub>l</sub></italic> = (<italic>f<sub>l</sub></italic><sub>1</sub>, …, <italic>f<sub>lM</sub></italic>) with <italic>f<sub>lm</sub></italic> = <italic>n<sub>lm</sub>/N<sub>lm</sub></italic> denote the observed allele frequencies at locus <italic>l</italic>, which are approximately normally distributed with with mean <italic><bold>y</bold><sub>l</sub></italic> and a diagonal variance-covariance matrix: <disp-formula id="FD11"><label>(9)</label><mml:math id="M11"><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P18">The transformed observed allele frequencies <bold>d</bold><italic><sub>l</sub></italic> = (<italic>d<sub>l</sub></italic><sub>1</sub>, …, <italic>d<sub>lM</sub></italic>) with <italic>d<sub>lm</sub></italic> = arcsin(2<italic>f<sub>lm</sub></italic> − 1), are then approximated by the multivariate normal density <disp-formula id="FD12"><label>(10)</label><mml:math id="M12"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> with <disp-formula id="FD13"><mml:math id="M13"><mml:msub><mml:mstyle><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula> because the factors <italic>y<sub>l</sub></italic><sub>1</sub>(1 − <italic>y<sub>l</sub></italic><sub>1</sub>) are transformed away from the variance-covariance matrix (<xref ref-type="disp-formula" rid="FD11">eq. 9</xref>) similar to (<xref ref-type="disp-formula" rid="FD4">eq. 3</xref>).</p></sec><sec id="S6"><label>3.1.3</label><title>Full likelihood for one locus</title><p id="P19">Given the ancestral frequency <italic>μ<sub>l</sub></italic>, we obtain the likelihood by combining (<xref ref-type="disp-formula" rid="FD5">eq. 4</xref>) and (<xref ref-type="disp-formula" rid="FD12">eq. 10</xref>) and integrating out: <disp-formula id="FD14"><label>(11)</label><mml:math id="M14"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P20">Using well-known formulae for linear systems (see Thm. 4.4.1 in <xref ref-type="bibr" rid="R48">Murphy (2012)</xref>) we obtain for the likelihood (<xref ref-type="disp-formula" rid="FD14">eq. 11</xref>) the following approximation: <disp-formula id="FD15"><label>(12)</label><mml:math id="M15"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle><mml:mo mathvariant="bold">Σ</mml:mo></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P21">We now set a normal prior on <italic>μ<sub>l</sub></italic>, namely we assume that <disp-formula id="FD16"><mml:math id="M16"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P22">Again from Thm. 4.4.1 in <xref ref-type="bibr" rid="R48">Murphy (2012)</xref> we conclude that <disp-formula id="FD17"><label>(13)</label><mml:math id="M17"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>𝒩</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> with <disp-formula id="FD18"><label>(14)</label><mml:math id="M18"><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>1</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mn>11</mml:mn><mml:mo>′</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P23">Explicitly <disp-formula id="FD19"><label>(15)</label><mml:math id="M19"><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>𝒢</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:msubsup><mml:mi>S</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P24">We note that the above model accounts for variation in sample size among loci, but assumes that at least one sample was observed per locus and population.</p></sec></sec><sec id="S7"><label>3.2</label><title>Hidden Markov Model</title><p id="P25">We develop a Hidden Markov Model (HMM) for multiple loci <italic>l</italic> = 1, …, <italic>L</italic> with varying migration rates for each of the <italic>I</italic> migration edges of graph 𝓖. We assume that the locus and specific migration rates <italic>w<sub>li</sub></italic> take values out of a small set of discrete numbers between 0 and 1: <disp-formula id="FD20"><mml:math id="M20"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P26">We thus have <italic>J</italic><sub>1</sub> · <italic>J</italic><sub>2</sub> · … · <italic>J<sub>I</sub></italic> possible combinations and these combinations will constitute the hidden states of our Markov model. We denote the hidden state at locus <italic>l</italic> by <italic>z<sub>l</sub></italic>. Each state <italic>z<sub>l</sub></italic> corresponds to a multiindex <disp-formula id="FD21"><mml:math id="M21"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> that defines the migration values <inline-formula><mml:math id="M22"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the migration edges. Thus, knowing the state <italic>z<sub>l</sub></italic> is tantamount to knowing the combination of migration rates at the given site which in turn determines the matrix <bold><italic>W</italic></bold> in eq. (<xref ref-type="disp-formula" rid="FD9">eq. 7</xref>) via (<xref ref-type="disp-formula" rid="FD7">eq. 5</xref>) and (<xref ref-type="disp-formula" rid="FD8">eq. 6</xref>).</p><p id="P27">To account for linkage between loci, we assume that the locus-specific transition matrix ℙ(<italic>z<sub>l</sub></italic> = <italic>j</italic>′|<italic>z</italic><sub><italic>l</italic>−1</sub> = <italic>j</italic>) is based on physical or genetic distances <italic>δ<sub>l</sub></italic> between loci. We assume independence of the transition probabilities of the different migration edges: <disp-formula id="FD22"><mml:math id="M23"><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∣</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ℙ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:msub><mml:mstyle><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P28">Each one of the factors in this product is an element of a ladder-type Markov matrix <italic><bold>P</bold><sub>li</sub></italic> which is defined via a transition rate matrix <italic>κ<sub>i</sub></italic><bold>Λ</bold><sub><italic>i</italic></sub>: <disp-formula id="FD23"><label>(16)</label><mml:math id="M24"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:msub><mml:mi>κ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P29">Here, <italic>κ<sub>i</sub></italic> is a positive scaling parameter pertaining to migration edge <italic>i</italic>, the distances <italic>δ<sub>l</sub></italic> are known constants corresponding to the linking distances. Further, the <italic>J<sub>i</sub></italic> × <italic>J<sub>i</sub></italic>-matrices <bold>Λ</bold><italic><sub>i</sub></italic> reflect a transition model for infinitesimal steps.</p><p id="P30">We consider two transition models: The first is a standard ladder-type model in which transitions are only allowed to neighboring states and at equal rates: <disp-formula id="FD24"><label>(17)</label><mml:math id="M25"><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P31">Under this transition matrix, only <italic>κ<sub>i</sub></italic> is inferred, for which we maximize the Q-function using a linear search.</p><p id="P32">The second is also a ladder-type model, but which includes an attractor state <inline-formula><mml:math id="M26"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> reflecting the background migration rate. Similar to <xref ref-type="bibr" rid="R25">Galimberti et al. (2020)</xref>, we use two parameters to describe the fraction of loci deviating from the attractor state and the degree of that deviation, but chose a slightly different parametrization. Specifically, and given the two parameters <italic>ϕ<sub>i</sub></italic> and <italic>ζ<sub>i</sub></italic>, we have <disp-formula id="FD25"><label>(18)</label><mml:math id="M27"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mo>ζ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> with the attractor row given by <disp-formula id="FD26"><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mo>…</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mo>…</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P33">Note that the <italic>κ<sub>i</sub></italic>, <italic>ϕ<sub>i</sub></italic> and <italic>ζ<sub>i</sub></italic> all must be strictly positive. However, we limit <italic>ϕ<sub>i</sub></italic> and <italic>ζ<sub>i</sub></italic> to the range (0,1] to ensure that the stationary probability of the attractor state <italic>a<sub>i</sub></italic> is higher than for any other state.</p><p id="P34">Finally, the emission probabilities are generated via the marginal likelihood (<xref ref-type="disp-formula" rid="FD19">eq. 15</xref>): <disp-formula id="FD27"><label>(19)</label><mml:math id="M29"><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mo>𝒢</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where 𝓖<italic><sub>j</sub></italic> denotes the population graph with migration rates according to the state <italic>z<sub>l</sub></italic> = <italic>j</italic> and <italic>μ<sub>l</sub></italic> is the root state at site <italic>l</italic>.</p></sec><sec id="S8"><label>3.3</label><title>Inference</title><p id="P35">We developed an empirical Bayes inference scheme for the hidden states under the assumption that the topology of the admixture graph is either known or was previously obtained. Specifically, we first infer both the emission and transition probabilities using the Baum-Welch algorithm (<xref ref-type="bibr" rid="R7">Baum et al., 1970</xref>) and then posterior state probabilities under the inferred parameters. As detailed in the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref> (see section "Inference"), the Baum-Welch algorithm requires numerical optimization in each iteration. While the parameter of the root prior <italic>μ</italic> can be optimized analytically, we resort to Newton-Raphson optimization (<xref ref-type="bibr" rid="R50">Nocedal and Wright, 2006</xref>; <xref ref-type="bibr" rid="R34">Lange, 2010</xref>) for the root prior <italic>σ</italic><sub>2</sub> and for parameters of the population graph (i.e. the branch lengths <bold><italic>c</italic></bold>) and to Nelder-Mead optimization (<xref ref-type="bibr" rid="R49">Nelder and Mead, 1965</xref>) for the parameters regarding the transition matrices with attractors (i.e. the <italic>κ<sub>i</sub></italic>, <italic>ϕ<sub>i</sub></italic>, <italic>ζ<sub>i</sub></italic>) or a linear search for transition matrices with no attractors (i.e. the <italic>κ<sub>i</sub></italic>).</p><p id="P36">The Baum-Welch algorithm may be sensitive to initial conditions. We obtain initial estimates of all parameter values as follows (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref> for more details):</p><list list-type="order" id="L1"><list-item><p id="P37">We use the observed variance-covariance matrix of the transformed observed frequencies as an initial guess of the variance covariance matrix <bold><italic>W</italic></bold>.</p></list-item><list-item><p id="P38">To account for variation in <bold><italic>W</italic></bold> among loci, we refine this initial estimate using a Gaussian Mixture Model (GMM) under which the transformed observed frequencies are modeled by one of <italic>r</italic> = 1, …, <italic>R</italic> multivariate Gaussian distributions with variance-covariances matrices <italic><bold>W</bold><sub>r</sub></italic> but shared root priors <italic>μ</italic> and <italic>σ</italic><sub>2</sub>. This model assumes no constraints regarding the structure of the <italic><bold>W</bold><sub>r</sub></italic> and can be optimized with an Expectation-Maximization (EM) algorithm with analytic updates. The hidden states <bold><italic>s</italic></bold> = (<italic>s</italic><sub>1</sub>, …, <italic>s<sub>L</sub></italic>) with <italic>s<sub>l</sub></italic> ∈ {1, …, <italic>R</italic>} are assumed to follow a Categorical distribution <bold><italic>s</italic></bold> ∼ Cat(<bold><italic>π</italic></bold>) with <bold><italic>π</italic></bold> = (<italic>π</italic><sub>1</sub>, …, <italic>π<sub>R</sub></italic>). We impose the constraint that each <italic>π<sub>r</sub></italic> is larger than some threshold, which we set to 0.2 by default. If this constraint is not met upon convergence, we decrease <italic>R</italic> = <italic>R</italic> − 1 and repeat this step.</p></list-item><list-item><p id="P39">We next use a Nelder-Mead algorithm to coerce the inferred variance-covariance matrices <bold><italic>W</italic></bold><sub>1</sub>, …, <italic><bold>W</bold><sub>R</sub></italic> onto the population graph. Specifically, we seek to find the set of branch lengths <bold><italic>c</italic></bold> and partition-specific migration rate <italic><bold>w</bold><sub>r</sub></italic> that best explain the previously learned variance-covariance matrices using the weighted Residuals Sum of Squares. To mitigate convergence problems, we repeat the Nelder-Mead <italic>C</italic> times and use different initial values each time. We set <italic>C</italic> = 1000 by default.</p></list-item><list-item><p id="P40">We then run a Baum-Welch algorithm to infer the branch lengths <bold><italic>c</italic></bold>, the root prior <italic>μ</italic> and <italic>σ</italic><sub>2</sub> and the transition parameters <italic>κ<sub>i</sub></italic> for the attractor-free, ladder-type transition matrix (<xref ref-type="disp-formula" rid="FD24">eq. 17</xref>). Upon convergence, we identify the top <italic>T</italic> states with the highest average posterior probabilities across all loci, and consider each of these states as a potential attractor. We set <italic>T</italic> = 5 by default.</p></list-item><list-item><p id="P41">To identify the best attractor, we then run individual Baum-Welch optimization for each potential attractor, thereby identifying the best values for the branch lengths <bold><italic>c</italic></bold>, the root prior <italic>μ</italic> and <italic>σ</italic><sub>2</sub> and the transition parameters <italic>κ<sub>i</sub></italic>, <italic>ϕ<sub>i</sub></italic> and <italic>ζ<sub>i</sub></italic> for the full transition matrix (<xref ref-type="disp-formula" rid="FD25">eq. 18</xref>). The final result, as relevant to the user, are the results with the transition matrix that resulted in the highest likelihood, which may either be the ladder-type matrix or one with a specific attractor state.</p></list-item></list><p id="P42">Once maximum likelihood estimates for the branch lengths <bold><italic>c</italic></bold>, the transition parameters <italic>κ<sub>i</sub></italic>, <italic>ϕ<sub>i</sub></italic>, <italic>ζ<sub>i</sub></italic> and <italic>a<sub>i</sub></italic> as well as the root prior <italic>μ</italic> and <italic>σ</italic><sub>2</sub> are obtained, we infer state posterior probabilities <italic>P</italic> (<italic>z<sub>l</sub></italic>|<bold>d</bold>, <italic><bold>θ</bold></italic>) given the full data <bold>d</bold> and the learned parameters collectively denoted by <bold><italic>θ</italic></bold>, see <xref ref-type="fig" rid="F1">Fig 1C</xref>. We further determined the posterior mean migration rates as <disp-formula id="FD28"><label>(20)</label><mml:math id="M30"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P43">To identify regions exhibiting either excess or dearth introgression compared to the genome-wide average, and are hence candidate regions to have experienced selection, we summarized these posterior probabilities as <disp-formula id="FD29"><mml:math id="M31"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>ℐ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>ℙ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>ℐ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where 𝓘(·) denotes the indicator function. We then determined for each locus <italic>l</italic> the false discovery rates (FDR) for excess (<italic>q<sub>e</sub></italic>(<italic>l</italic>)) and dearth (<italic>q<sub>d</sub></italic>(<italic>l</italic>)) introgression as <disp-formula id="FD30"><mml:math id="M32"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ℙ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ℙ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mstyle><mml:mtext mathvariant="bold">d</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></sec><sec id="S9"><label>3.4</label><title>Implementation</title><p id="P44">We implemented the proposed inference scheme as a user-friendly <monospace>C++</monospace> program <monospace>TreeSwirl</monospace>, which is available, along with documentation, through a git repository at <monospace>bitbucket.org/wegmannlab/treeswirl</monospace>. Our implementation makes heavy use of the HMM framework of the statistical library <monospace>stattools</monospace> available at <monospace>bitbucket.org/wegmannlab/stattools</monospace>.</p><p id="P45">To streamline computations, we employ a straightforward clustering method to reduce the number of sampling size variance matrices <bold>Σ</bold><italic><sub>l</sub></italic> that need to be considered: <list list-type="order" id="L2"><list-item><p id="P46">We sort the vector of sample sizes according to the frequency of each occurrence.</p></list-item><list-item><p id="P47">To cluster, we identify the pair of vectors with the least occurrences and compute their weighted average.</p></list-item><list-item><p id="P48">We retain the weighted vector of sample sizes, remove the pair, and update the occurrence count as the sum of the deleted pair counts.</p></list-item><list-item><p id="P49">We repeat steps 1 through 3 until the desired number of <bold>Σ</bold><italic><sub>l</sub></italic> is obtained.</p></list-item></list>
</p><p id="P50">Given a limited number <italic>u</italic> of such matrices and given that we use a finite number of discrete migration rates, there exist also an only finite number of matrices <italic><bold>S</bold><sub>l</sub></italic> that can be pre-computed in each Baum-Welch iteration to speed up the forward-backward pass through the HMM.</p></sec><sec id="S10"><label>3.5</label><title>Simulations</title><sec id="S11"><label>3.5.1</label><title>Simulations under model assumptions</title><p id="P51">To demonstrate the power and limitations of our methods with respect to different demographic scenarios, we simulated data under the <monospace>TreeSwirl</monospace> model for population graphs of four populations under four different topologies, visualized in <xref ref-type="fig" rid="F2">Figure 2</xref>. In the first two cases, we designed a tree with a single migration event starting ancestral to Population 2 and directed to either Population 3 (Topology 1) or ancestral to Population 3 (Topology 2). The remaining two cases had two migration events, either bidirectional migration ancestral to the Populations 2 and 3, or two unrelated events from ancestral of Population 2 and 4 to ancestral of Populations 3 and 1, respectively. For each tree, we simulated a single chromosome and considered both a scenario with a constant, genome-wide migration rate, as well as a scenario where the migration rate varied. For all cases, we ran 20 replicates with <italic>N</italic> = 100, <italic>μ</italic> = −0.5, <italic>σ</italic> = 0.3 and <italic>J</italic> = 21.</p></sec><sec id="S12"><label>3.5.2</label><title><monospace>fastsimcoal2</monospace></title><p id="P52">To compare <monospace>TreeSwirl</monospace> to competing methods, we used <monospace>fastsimcoal2</monospace> (<xref ref-type="bibr" rid="R22">Excoffier et al., 2021</xref>) to simulate genomic data under five different demographic scenarios only consisting of population splits and admixture pulses (but no population growth or continuous migration, <xref ref-type="fig" rid="F3">Figure 3</xref>). We maintained a constant effective population size of <italic>N<sub>e</sub></italic> = 10, 000 and used a sample size of <italic>N</italic> = 100 for each population in all cases.</p><p id="P53">To simulate variation in admixture pulses along chromosomes, we composed each chromosome of seven blocks, each containing many independent DNA segments of length 1000 bp, fully-linked (i.e. within-locus recombination rate of 0.0), a mutation rate of 1e-8, and a transition rate of 0.33. Odd-numbered blocks reflected the neutral genomic background, each containing <italic>n<sub>b</sub></italic> = 3, 500 loci and an admixture pulse of <italic>α<sub>b</sub></italic> = 0.05. Conversely, even-numbered blocks reflected loci under selection. While all three selected blocks shared the same parameters in one simulation, we varied their number of DNA segments <italic>n<sub>s</sub></italic> and migration rates <italic>α<sub>s</sub></italic> across different simulations.</p><p id="P54">We generated 10 replicates for each parameter combination and used a custom script to transform the generated output files into standard VCF files and concatenating the seven blocks corresponding to a single chromosome. We then applied a minimum allele frequency filter of maf = 0.05 with VCFtools (<xref ref-type="bibr" rid="R13">Danecek et al., 2011</xref>), resulting in a variable but rather low (0-3) number of loci per DNA segment and thus resulted in data similar to what would be obtained after LD-pruning.</p><p id="P55">The filtered VCFs served as input for estimating sliding window <italic>F<sub>st</sub></italic> for simulated data only consisting of two or three populations as well as for running <monospace>D-suite Dinvestigate</monospace> (<xref ref-type="bibr" rid="R41">Malinsky et al., 2021</xref>) with varying window sizes <italic>s</italic> = (10, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500), a sliding locus of 1, and the true trio and corresponding outgroup for demographic scenarios with more than three populations. Concurrently, we executed <monospace>TreeSwirl</monospace> using the same filtered data and the expected tree topology.</p><p id="P56">We employed a receiver operating characteristic (ROC) curve analysis to assess the area under the curve (AUC), which summarizes the performance of the method in distinguishing introgression from the “neutral state” <italic>ix</italic>. For the ROC analysis, we used the estimated mean posteriors obtained from <monospace>TreeSwirl</monospace>, along with the computed values of <italic>F<sub>st</sub></italic>, Patterson’s D, <italic>f<sub>d</sub></italic>, <italic>f<sub>dM</sub></italic>, and <italic>d<sub>f</sub></italic>. For each comparison, we used the statistics and window-size that resulted in the best AUC.</p></sec></sec><sec id="S13"><label>3.6</label><title>Real data application</title><p id="P57">We re-analyzed whole genome sequencing from a recent study that identified putatively adaptive introgression from domestic goat into Alpine ibex (<xref ref-type="bibr" rid="R47">Münger et al., 2023</xref>). We restricted our analysis to species with at least four individuals: modern Alpine ibex (29 individuals), the Iberian ibex (four individuals), Bezoar ibex (six individuals) and domestic goats (16 individuals). We further focused on Chromosomes 23 on which significant introgression was previously reported for gene regions with immune-related genes such as MHC (<xref ref-type="bibr" rid="R29">Grossen et al., 2014</xref>; <xref ref-type="bibr" rid="R47">Münger et al., 2023</xref>), and included the flanking chromosomes 21, 22, 24 and 25 for comparison. We used a VCF file provided by the authors. This file was previously filtered to a minimum minor allele frequency (MAF) of 0.05 and a maximal missingness of 0.9 across all samples studied in <xref ref-type="bibr" rid="R47">Münger et al. (2023)</xref>, and was further thinned to have a minimal distance of 100 bp between consecutive SNPs (see <xref ref-type="bibr" rid="R47">Münger et al., 2023</xref>, for details). The admixture graph used was derived from the demographic model inferred by <xref ref-type="bibr" rid="R47">Münger et al. (2023)</xref>, but we modelled two migration events starting ancestral to domestic goat and directed to Alpine ibex and one to Iberian ibex, respectively, since hybridization between domestic goats and Iberian ibex has also been reported (<xref ref-type="bibr" rid="R10">Cardoso et al., 2021</xref>). We used the physical positions of markers provided in the VCF file and set <italic>J</italic> = 21.</p></sec></sec><sec id="S14" sec-type="results"><label>4</label><title>Results</title><sec id="S15"><label>4.1</label><title>Simulations under the <monospace>TreeSwirl</monospace> model</title><p id="P58">We conducted simulations under the above model to investigate the power of <monospace>TreeSwirl</monospace> to infer branch lengths and locus-specific migration rates. We focused on a tree of four populations and considered several cases of migration events of increasing complexity (<xref ref-type="fig" rid="F2">Fig 2</xref>) and simulated a case with and without variation in migration rates along the simulated chromosome.</p><p id="P59">The first case contains a single migration event from a population ancestral to Population 2 to Population 3. In this case, the most challenging branch lengths to estimate are those leading to and from the source of the migration edge (branches 2a and 2b in <xref ref-type="fig" rid="F2">Fig 2A</xref>) since only their sum is relevant for the variance across loci in Population 2. However, additional information about their lengths comes from the covariance between populations 2 and 3, and as a result their lengths as well as locus-specific migration rates are well estimated both when using a constant or a variable migration rate (<xref ref-type="fig" rid="F2">Fig 2A</xref>).</p><p id="P60">The second case is similar to the first, except that the migration edge now ends ancestral to Population 3, leading to two pairs of branches that are challenging to infer: branches 2a and 2b and branches 3a and 3b (marked in blue and pink in <xref ref-type="fig" rid="F2">Fig 2B</xref>, respectively). As in the first case, information about the lengths of branches 2a and 2b stems from the variance of Population 2 and the covariance between populations 2 and 3. In contrast, information about the lengths of branches 3a and 3b only stems from the variance of Population 3, and they are thus non-identifiable in the case of constant migration with some branch lengths often inferred to be negative (<xref ref-type="fig" rid="F2">Fig 2B</xref>). This non-identifiability issue has been previously observed by <xref ref-type="bibr" rid="R54">Pickrell and Pritchard (2012)</xref>, and <monospace>TreeMix</monospace> consequently only allows for migration edges that end at tips or the end of branches. As shown in <xref ref-type="fig" rid="F2">Fig 2B</xref>, however, these branch lengths do become identifiable if loci vary in their migration rates and if that variation is explicitly modelled.</p><p id="P61">And as shown in <xref ref-type="fig" rid="F2">Fig 2C</xref>, variation in migration rates renders all branch lengths identifiably also in the case of bi-directional migration, which led to an accurate inference of locus-specific migration rates in all simulated replicates. While variation in migration rates renders all branch lengths identifiable also in the case of two migration events involving all four populations, our inference framework fails to identify the correct solutions in about 2/3 of all replicates (<xref ref-type="fig" rid="F2">Fig 2D</xref>). Closer inspection reveals that this mostly affects the branch lengths and migration rates related to the migration edge that is more ancient and has both lower average and less variability in migration rates. We note that these cases often result in negative branch lengths, which we found to be a good indicator that the population graph used has too many degrees of freedom for the data analyzed.</p></sec><sec id="S16"><label>4.2</label><title>Comparison to related D- and f-statistic methods</title><p id="P62">We generated coalescent simulations from five demographic histories of population splits and mixtures with <monospace>fastsimcoal2</monospace>. We used an effective population size of <italic>N<sub>e</sub></italic> = 10, 000, a sample size of <italic>N</italic> = 100 and a shared common ancestor for all populations dating back approximately 2,000 generations (<xref ref-type="fig" rid="F3">Fig 3</xref>, first column). Each simulated chromosome involved seven genomic blocks: odd blocks were 3,500 loci long and simulated using a background migration rate of <italic>α<sub>b</sub></italic> = 0.05, while even blocks were shorter and had elevated migration rates. We used a range of block lengths and elevated migration rates to evaluate the power of <monospace>TreeSwirl</monospace> and commonly used summary statistics to identify regions with elevated migration rates, namely <italic>F<sub>st</sub></italic> and f-statistics. We calculated these statistics using <monospace>D-suite Dinvestigate</monospace> (<xref ref-type="bibr" rid="R41">Malinsky et al., 2021</xref>) for various window sizes and, in case of more than four populations, for all population combinations possible. To render our comparison conservative, wen then always kept the summary statistics, window size and population combination resulting in highest power. The second column of <xref ref-type="fig" rid="F3">Fig 3</xref> shows the population graph used for <monospace>TreeSwirl</monospace>.</p><p id="P63">As shown in the third and fourth column of <xref ref-type="fig" rid="F3">Fig 3</xref>, <monospace>TreeSwirl</monospace> has overall higher power to identified regions with elevated migration rates (candidates for adaptive introgression) than competing summary statistics, with a much lower false-positive rate, particularly if the background and elevated migration rates were rather similar. Importantly, <monospace>TreeSwirl</monospace> also had considerably power in identifying loci with elevated migration rates for models with two- and three-taxon topologies. This presents a significant advantage over <italic>f</italic><sub>4</sub>-stat methods, which are constrained to four-taxon configurations and require a pre-defined outgroup.</p><p id="P64">The most difficult scenario was the case of only two populations, in which <monospace>TreeSwirl</monospace> needs to estimate migration rates along four branch lengths. In the case of no variation in migration rates, the information in the data corresponds to only two variances and one covariance term, thus considerably less than the degrees of freedom in the model. By only simulating two different migration rates in the genome, as done here, there is still not enough information to render branch lengths and migration rates identifiable as evidence by the failure of <monospace>TreeSwirl</monospace> to accurately infer the migration strength. Nonetheless, <monospace>TreeSwirl</monospace> was more accurate in identifying the loci with elevated migration rates than <italic>F<sub>st</sub></italic> in all cases except when the blocks with elevated migration were very short (100 loci) or when the elevated migration rate was very close to the background rate (<xref ref-type="fig" rid="F3">Fig 3A</xref>).</p><p id="P65">As more populations are included, the number of variances and covariances increases faster than the number of branch lengths (<italic>M</italic> (<italic>M</italic> + 1)/2 vs. 2<italic>M</italic> − 1 for a strictly bifurcating graph without migration), rendering model parameters easier to infer (but see above for how migration edges complicate things). Consequently, <monospace>TreeSwirl</monospace> also inferred migration rates much more accurately for simulations conducted with more populations (<xref ref-type="fig" rid="F3">Fig 3B-D</xref>), although it remained difficult in the case of very short blocks of elevated migration (100 loci).</p><p id="P66">As illustrated in <xref ref-type="fig" rid="F3">Fig 3E</xref>, also models with many populations may be challenging to infer. In that scenario, the migration edge is more ancient and the populations Pop1 and Pop2 do not help to resolve the difficulty in inferring the length of the branches leading to and from the source and destination of the migration edge. The scenario thus corresponds to that explored above in <xref ref-type="fig" rid="F2">Fig 2B</xref>, which is only identifiable with sufficient variation in migration rates. Interestingly, and despite its rather low power, <monospace>TreeSwirl</monospace> still outperformed all summary statistics tested in identifying the loci with elevated migration rates.</p></sec><sec id="S17"><label>4.3</label><title>Introgression from domestic goats into Alpine ibex</title><p id="P67">Alpine ibex are a wild goat species native to the European alps. It suffered from a near-extinction two centuries ago, but has since recovered thanks to re-population efforts. It is known that Alpine ibex occasionally hybridize with domestic goats and adaptive introgression has been reported for several genomic regions, particularly for a region on Chromosome 23 that contains immune-related genes such as MHC (<xref ref-type="bibr" rid="R29">Grossen et al., 2014</xref>; <xref ref-type="bibr" rid="R47">Münger et al., 2023</xref>). Here we used <monospace>TreeSwirl</monospace> to re-analyze whole-genome sequencing data of Alpine ibex, Iberian ibex, Bezoar ibex and domestic goat to quantify locus-specific rates of introgression from domestic goat into Alpine and Iberian ibex along chromosomes 21-25. As shown in <xref ref-type="fig" rid="F4">Figure 4</xref>, we generally inferred very low migration rates from domestic goat into Alpine ibex with an inferred attractor state at zero. Nonetheless, we identified a clear signal of introgression on Chromosomes 23 between 20-24Mb, corresponding well to the region previously reported (<xref ref-type="bibr" rid="R47">Münger et al., 2023</xref>) and containing MHC. We also identified and additional, smaller region of introgression on Chromosome 21.</p><p id="P68">We also inferred rather low overall migration rates from domestic goat into Iberian ibex, again with the attractor state estimated at zero. Interestingly, the region on Chromosome 23 inferred as introgressed in Alpine ibex was also inferred as strongly introgressed in Iberian ibex, this time along an additional, smaller region on Chromosome 25. Since the two ibex species likely diverged prior to the domestication of goats, the signal on Chromosome 23 is thus indicative of independent adaptive introgression in both ibex species. But we note that given the frequency dependent selection likely acting on the MHC region, the signal may also be indicative of shared ancient polymorphisms among all goat species, although the high migration rates we inferred (close to 1.0) suggest this scenario to be less likely.</p></sec><sec id="S18"><label>4.4</label><title>Runtime considerations</title><p id="P69">The computational performance of <monospace>TreeSwirl</monospace> is influenced by multiple factors, such as the number of discrete states <italic>J</italic>, the number of matrices <bold>Σ</bold>, and the total number of sites and migration edges. Computation times scale exponentially with the number of migration edges, quadratically with the number of states <italic>J</italic> and linearly with the number of loci. Computations may be efficiently distributed across multiple computer nodes by dividing the genome into independent segments, such as individual chromosomes or chromosome arms. This approach is valid because linkage does not persist across chromosome boundaries and is typically weak across the centromere.</p></sec></sec><sec id="S19" sec-type="discussion"><label>5</label><title>Discussion</title><p id="P70">One approach to infer historical relationships among populations is to model allele frequency changes along a phylogenetic tree as a Gaussian process (<xref ref-type="bibr" rid="R11">Cavalli-Sforza and Edwards, 1967</xref>; <xref ref-type="bibr" rid="R23">Felsenstein, 1981</xref>). This rather old concept was recently revived by extending the model to a graph with migration edges and by providing a user-friendly tool <monospace>TreeMix</monospace> to infer parameters under such a graph (<xref ref-type="bibr" rid="R54">Pickrell and Pritchard, 2012</xref>). However, the <monospace>TreeMix</monospace> model assumes migration rates to be constant along the genome, an assumption that may not hold in the face of selection or strong genetic drift. Indeed, theory predicts variation in the rate of effective gene flow along the genome (<xref ref-type="bibr" rid="R30">Harrison, 1993</xref>), in which local barriers to gene flow are anticipated to emerge from the random accumulation of Dobzhansky-Muller incompatibilities, both under models of secondary contact after isolation (<xref ref-type="bibr" rid="R4">Barton and Gale, 1993</xref>) as well as under models of continuous gene flow during speciation (<xref ref-type="bibr" rid="R84">Wu, 2001</xref>). In the case of gene flow between highly divergent gene pools, selection is likely to act as the primary driving force for variation in effective gene flow along the genome, with rates of introgression being particularly low in genomic regions involved in adaptation, so called islands of speciation, but potentially much higher in regions free from the selection pressure (<xref ref-type="bibr" rid="R14">Dasmahapatra et al., 2012</xref>).</p><p id="P71">In light of these considerations, we here present <monospace>TreeSwirl</monospace>, an extension of the model described in <xref ref-type="bibr" rid="R54">Pickrell and Pritchard (2012)</xref> that allows for mixture proportions to vary along the genome in an auto-correlated way that reflects the effect of linkage. We evaluated the performance of our model to identify such variation in comparison to existing methods related to <italic>D</italic>- and <italic>f</italic>-statistics, such as <italic>F<sub>st</sub></italic>, Patterson’s <italic>D</italic> (<xref ref-type="bibr" rid="R51">Patterson et al., 2012</xref>), <italic>f<sub>d</sub></italic> (<xref ref-type="bibr" rid="R46">Martin et al., 2015</xref>), <italic>f<sub>dM</sub></italic> (<xref ref-type="bibr" rid="R40">Malinsky et al., 2015</xref>), and <italic>d<sub>f</sub></italic> (<xref ref-type="bibr" rid="R53">Pfeifer and Kapan, 2019</xref>), which have been frequently applied to identify signatures of introgression using arbitrary genomic window sizes. As we show using extensive simulations, our method had superior accuracy and sensitivity in detecting retrogressed loci under a wide range of demographic histories characterized by single admixture pulses.</p><p id="P72">The approach presented here also addresses numerous constraints inherent to the use of related <italic>D</italic>- and <italic>f</italic>-statistics. First, these summary statistics are limited to bifurcating four-population topologies. In cases involving graphs of five or more populations, the simplest option is to subsample a section of the graph in the appropriate configuration, as done in <monospace>Dsuite</monospace> (<xref ref-type="bibr" rid="R41">Malinsky et al., 2021</xref>) used here. In cases involving two- or three-population topologies, one would need to resort to <italic>F<sub>ST</sub></italic>-based metrics. In contrast, the method presented here is not constraint by topology, working well with any number of populations and also under topologies that include polytomies.</p><p id="P73">Second, our HMM-based approach to model linkage eliminates the need to specify window sizes. Instead, the parameters governing auto-correlation are directly inferred from the data along with introgression rates. In our simulations, the choice of window sizes, as well as the choice of the specific statistics to use, had a big impact on power. To ensure a fair comparison between methods, we thus tested all available summary statistics for a wide range of window sizes and only report the results of the combination of summary statistics and window size that was optimal for each individual case. In applications to real data, however, such explorations are not possible, likely leading to an even larger difference in power between <monospace>TreeSwirl</monospace> and these summary statistics.</p><p id="P74">Third, <monospace>TreeSwirl</monospace> supports graphs with multiple migration edges for which introgression rates are learned simultaneously. However, it is important to note that the performance of <monospace>TreeSwirl</monospace> is likely dependent on the quality of the tree topology used as input and may not perform well if the tree topology is poorly resolved or incorrect. Similarly, we caution that <monospace>TreeSwirl</monospace> just as <monospace>TreeMix</monospace> assumes that population allele frequencies can be explained through a population graph with splits, drift along branches and potential mixtures. While this approach has been proved useful in many cases, it is easy to think of scenarios that violate these assumptions. One such scenario consists of populations that have diverged long enough to hardly share any polymorphisms. This leads to negative covariance between populations (the presence of a mutation in one population implies its absence in the others), which can not be captured by a population graph. While experimenting with such cases showed <monospace>TreeSwirl</monospace> to be remarkably robust, it should not be confused with phylogenetic approaches.</p><p id="P75">Other scenarios that violate the underlying model assumptions are cases of extensive continuous gene flow as well as cases of population structure not well captured with a graph. Such scenarios were shown to lead to spurious inference of introgression using other methods (e.g. <xref ref-type="bibr" rid="R21">Eriksson and Manica, 2014</xref>; <xref ref-type="bibr" rid="R36">Lawson et al., 2018</xref>; <xref ref-type="bibr" rid="R77">Tournebize and Chikhi, 2023</xref>), and while we have not explored these scenarios in detail here, we are convinced they can lead to spurious inference by both <monospace>TreeSwirl</monospace> and <monospace>TreeMix</monospace> and appeal to users to carefully assess model assumptions of these any other tools they use. Nonetheless, and as we showed through both simulations and a data application, the model introduced here is powerful to identify introgressed loci under many scenarios and will thereby contribute to a better understanding of the role of introgression in evolution, which is expected to act as a major driver in adaptation to ongoing global changes (<xref ref-type="bibr" rid="R75">Suarez-Gonzalez et al., 2018</xref>).</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS190791-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d16aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgments</title><p>We thank Christine Grossen for sharing the ibex data and two anonymous reviewer for their helpful comments on an earlier version of this manuscript. This work was supported by Swiss National Science Foundation grants 31003A_173062 and 310030_200420 to DW.</p></ack><sec id="S21" sec-type="data-availability"><title>Data and code availability</title><p id="P76">The authors affirm that all data required to validate the conclusions of this article are either included within the article itself or accessible through the indicated repositories. The source code for <monospace>TreeSwirl</monospace> can be found in the following Git repository: bitbucket.org/wegmannlab/treeswirl2, which also contains a user manual. This study did not generate any new data.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P77"><bold>Author contributions</bold></p><p id="P78">DW conceived the idea; DW, CL and CSRB developed the model; CSRB and MC implemented the method in collaboration with MG; CSRB and MC conducted all simulations and data analyses; CSRB, MC and DW led the writing of the manuscript. All authors contributed critically to the draft and gave final approval for publication.</p></fn><fn id="FN2" fn-type="conflict"><p id="P79"><bold>Declaration of interests</bold></p><p id="P80">The authors declare no competing interests</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>R</given-names></name><name><surname>Albach</surname><given-names>D</given-names></name><name><surname>Ansell</surname><given-names>S</given-names></name><name><surname>Arntzen</surname><given-names>JW</given-names></name><name><surname>Baird</surname><given-names>SJ</given-names></name><name><surname>Bierne</surname><given-names>N</given-names></name><name><surname>Boughman</surname><given-names>J</given-names></name><name><surname>Brelsford</surname><given-names>A</given-names></name><name><surname>Buerkle</surname><given-names>CA</given-names></name><name><surname>Buggs</surname><given-names>R</given-names></name><name><surname>Butlin</surname><given-names>RK</given-names></name><etal/></person-group><article-title>Hybridization and speciation</article-title><source>Journal of Evolutionary Biology</source><year>2013</year><volume>26</volume><issue>2</issue><fpage>229</fpage><lpage>246</lpage><pub-id pub-id-type="pmid">23323997</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>E</given-names></name></person-group><source>Introgressive hybridization</source><publisher-name>J Wiley</publisher-name><publisher-loc>New York</publisher-loc><year>1949</year></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>E</given-names></name><name><surname>Hubricht</surname><given-names>L</given-names></name></person-group><article-title>Hybridization in Tradescantia. III. The Evidence for Introgressive Hybridization</article-title><source>American Journal of Botany</source><year>1938</year><volume>25</volume><issue>6</issue><fpage>396</fpage></element-citation></ref><ref id="R4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>N</given-names></name><name><surname>Gale</surname><given-names>K</given-names></name></person-group><chapter-title>Genetic analysis of hybrid zones</chapter-title><person-group person-group-type="editor"><name><surname>Harrison</surname><given-names>RG</given-names></name></person-group><source>Hybrid Zones and the Evolutionary Process</source><publisher-name>Oxford University Press</publisher-name><year>1993</year><fpage>13</fpage><lpage>45</lpage></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>The role of hybridization in evolution</article-title><source>Molecular Ecology</source><year>2001</year><volume>10</volume><issue>3</issue><fpage>551</fpage><lpage>568</lpage><pub-id pub-id-type="pmid">11298968</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Hewitt</surname><given-names>GM</given-names></name></person-group><article-title>Analysis of Hybrid Zones</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><year>1985</year><fpage>113</fpage><lpage>148</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baum</surname><given-names>LE</given-names></name><name><surname>Petrie</surname><given-names>T</given-names></name><name><surname>Soules</surname><given-names>G</given-names></name><name><surname>Weiss</surname><given-names>N</given-names></name></person-group><article-title>A Maximization Technique Occurring in the Statistical Analysis of Probabilistic Functions of Markov Chains</article-title><source>The Annals of Mathematical Statistics</source><year>1970</year><volume>41</volume><issue>1</issue><fpage>164</fpage><lpage>171</lpage></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Tucci</surname><given-names>S</given-names></name><name><surname>Akey</surname><given-names>JM</given-names></name></person-group><article-title>Analysis of Human Sequence Data Reveals Two Pulses of Archaic Denisovan Admixture</article-title><source>Cell</source><year>2018</year><volume>173</volume><issue>1</issue><fpage>53</fpage><lpage>61</lpage><elocation-id>e9</elocation-id><pub-id pub-id-type="pmcid">PMC5866234</pub-id><pub-id pub-id-type="pmid">29551270</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.031</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgarella</surname><given-names>C</given-names></name><name><surname>Barnaud</surname><given-names>A</given-names></name><name><surname>Kane</surname><given-names>NA</given-names></name><name><surname>Jankowski</surname><given-names>F</given-names></name><name><surname>Scarcelli</surname><given-names>N</given-names></name><name><surname>Billot</surname><given-names>C</given-names></name><name><surname>Vigouroux</surname><given-names>Y</given-names></name><name><surname>Berthouly-Salazar</surname><given-names>C</given-names></name></person-group><article-title>Adaptive introgression: An untapped evolutionary mechanism for crop adaptation</article-title><source>Frontiers in Plant Science</source><year>2019</year><volume>10</volume><fpage>4</fpage><pub-id pub-id-type="pmcid">PMC6367218</pub-id><pub-id pub-id-type="pmid">30774638</pub-id><pub-id pub-id-type="doi">10.3389/fpls.2019.00004</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardoso</surname><given-names>TF</given-names></name><name><surname>Luigi-Sierra</surname><given-names>MG</given-names></name><name><surname>Castelló</surname><given-names>A</given-names></name><name><surname>Cabrera</surname><given-names>B</given-names></name><name><surname>Noce</surname><given-names>A</given-names></name><name><surname>Mármol-Sánchez</surname><given-names>E</given-names></name><name><surname>García-González</surname><given-names>R</given-names></name><name><surname>Fernández-Arias</surname><given-names>A</given-names></name><name><surname>Alabart</surname><given-names>JL</given-names></name><name><surname>López-Olvera</surname><given-names>JR</given-names></name><name><surname>Mentaberre</surname><given-names>G</given-names></name><etal/></person-group><article-title>Assessing the levels of intraspecific admixture and interspecific hybridization in iberian wild goats (capra pyrenaica)</article-title><source>Evolutionary Applications</source><year>2021</year><volume>14</volume><issue>11</issue><fpage>2618</fpage><lpage>2634</lpage><pub-id pub-id-type="pmcid">PMC8591326</pub-id><pub-id pub-id-type="pmid">34815743</pub-id><pub-id pub-id-type="doi">10.1111/eva.13299</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavalli-Sforza</surname><given-names>LL</given-names></name><name><surname>Edwards</surname><given-names>AW</given-names></name></person-group><article-title>Phylogenetic analysis. Models and estimation procedures</article-title><source>American Journal of Human Genetics</source><year>1967</year><volume>19</volume><issue>3 Pt 1</issue><fpage>233</fpage><pub-id pub-id-type="pmcid">PMC1706274</pub-id><pub-id pub-id-type="pmid">6026583</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christe</surname><given-names>C</given-names></name><name><surname>Stölting</surname><given-names>KN</given-names></name><name><surname>Bresadola</surname><given-names>L</given-names></name><name><surname>Fussi</surname><given-names>B</given-names></name><name><surname>Heinze</surname><given-names>B</given-names></name><name><surname>Wegmann</surname><given-names>D</given-names></name><name><surname>Lexer</surname><given-names>C</given-names></name></person-group><article-title>Selection against recombinant hybrids maintains reproductive isolation in hybridizing populus species despite f1 fertility and recurrent gene flow</article-title><source>Molecular Ecology</source><year>2016</year><volume>25</volume><issue>11</issue><fpage>2482</fpage><lpage>2498</lpage><pub-id pub-id-type="pmid">26880192</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname><given-names>P</given-names></name><name><surname>Auton</surname><given-names>A</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Albers</surname><given-names>CA</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Handsaker</surname><given-names>RE</given-names></name><name><surname>Lunter</surname><given-names>G</given-names></name><name><surname>Marth</surname><given-names>GT</given-names></name><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><etal/></person-group><article-title>The variant call format and VCFtools</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><issue>15</issue><fpage>2156</fpage><lpage>2158</lpage><pub-id pub-id-type="pmcid">PMC3137218</pub-id><pub-id pub-id-type="pmid">21653522</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Walters</surname><given-names>JR</given-names></name><name><surname>Briscoe</surname><given-names>AD</given-names></name><name><surname>Davey</surname><given-names>JW</given-names></name><name><surname>Whibley</surname><given-names>A</given-names></name><name><surname>Nadeau</surname><given-names>NJ</given-names></name><name><surname>Zimin</surname><given-names>AV</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Ferguson</surname><given-names>LC</given-names></name><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Lewis</surname><given-names>JJ</given-names></name><etal/></person-group><article-title>Butterfly genome reveals promiscuous exchange of mimicry adaptations among species</article-title><source>Nature</source><year>2012</year><volume>487</volume><issue>7405</issue><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="pmcid">PMC3398145</pub-id><pub-id pub-id-type="pmid">22722851</pub-id><pub-id pub-id-type="doi">10.1038/nature11041</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durand</surname><given-names>EY</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Testing for ancient admixture between closely related populations</article-title><source>Molecular Biology and Evolution</source><year>2011</year><volume>28</volume><issue>8</issue><fpage>2239</fpage><lpage>2252</lpage><pub-id pub-id-type="pmcid">PMC3144383</pub-id><pub-id pub-id-type="pmid">21325092</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msr048</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durvasula</surname><given-names>A</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name></person-group><article-title>A statistical model for reference-free inference of archaic local ancestry</article-title><source>PLOS Genetics</source><year>2019</year><volume>15</volume><issue>5</issue><elocation-id>e1008175</elocation-id><pub-id pub-id-type="pmcid">PMC6555542</pub-id><pub-id pub-id-type="pmid">31136573</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1008175</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durvasula</surname><given-names>A</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name></person-group><article-title>Recovering signals of ghost archaic introgression in African populations</article-title><source>Science Advances</source><year>2020</year><volume>6</volume><issue>7</issue><pub-id pub-id-type="pmcid">PMC7015685</pub-id><pub-id pub-id-type="pmid">32095519</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.aax5097</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eaton</surname><given-names>DA</given-names></name><name><surname>Ree</surname><given-names>RH</given-names></name></person-group><article-title>Inferring Phylogeny and Introgression using RADseq Data: An Example from Flowering Plants (Pedicularis: Orobanchaceae)</article-title><source>Systematic Biology</source><year>2013</year><volume>62</volume><issue>5</issue><fpage>689</fpage><lpage>706</lpage><pub-id pub-id-type="pmcid">PMC3739883</pub-id><pub-id pub-id-type="pmid">23652346</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syt032</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellstrand</surname><given-names>NC</given-names></name></person-group><article-title>Is gene flow the most important evolutionary force in plants?</article-title><source>American Journal of Botany</source><year>2014</year><volume>101</volume><issue>5</issue><fpage>737</fpage><lpage>753</lpage><pub-id pub-id-type="pmid">24752890</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellstrand</surname><given-names>NC</given-names></name><name><surname>Barrett</surname><given-names>SC</given-names></name><name><surname>Linington</surname><given-names>S</given-names></name><name><surname>Stephenson</surname><given-names>AG</given-names></name><name><surname>Comai</surname><given-names>L</given-names></name></person-group><article-title>Current knowledge of gene flow in plants: implications for transgene flow</article-title><source>Philosophical Transactions of the Royal Society of London Series B: Biological Sciences</source><year>2003</year><volume>358</volume><issue>1434</issue><fpage>1163</fpage><lpage>1170</lpage><pub-id pub-id-type="pmcid">PMC1693201</pub-id><pub-id pub-id-type="pmid">12831483</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2003.1299</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eriksson</surname><given-names>A</given-names></name><name><surname>Manica</surname><given-names>A</given-names></name></person-group><article-title>The Doubly Conditioned Frequency Spectrum Does Not Distinguish between Ancient Population Structure and Hybridization</article-title><source>Molecular Biology and Evolution</source><year>2014</year><volume>31</volume><issue>6</issue><fpage>1618</fpage><lpage>1621</lpage><pub-id pub-id-type="pmcid">PMC4032131</pub-id><pub-id pub-id-type="pmid">24627034</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msu103</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L</given-names></name><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Marques</surname><given-names>DA</given-names></name><name><surname>Matthey-Doret</surname><given-names>R</given-names></name><name><surname>Gouy</surname><given-names>A</given-names></name><name><surname>Sousa</surname><given-names>VC</given-names></name></person-group><article-title>fastsim-coal2: demographic inference under complex evolutionary scenarios</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><issue>24</issue><fpage>4882</fpage><lpage>4885</lpage><pub-id pub-id-type="pmcid">PMC8665742</pub-id><pub-id pub-id-type="pmid">34164653</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btab468</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from gene frequencies and quantitative characters: Finding maximum likelihood estimates</article-title><source>Evolution; international journal of organic evolution</source><year>1981</year><volume>35</volume><issue>6</issue><fpage>1229</fpage><lpage>1242</lpage><pub-id pub-id-type="pmid">28563384</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fontaine</surname><given-names>MC</given-names></name><name><surname>Pease</surname><given-names>JB</given-names></name><name><surname>Steele</surname><given-names>A</given-names></name><name><surname>Waterhouse</surname><given-names>RM</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Sharakhov</surname><given-names>IV</given-names></name><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Hall</surname><given-names>AB</given-names></name><name><surname>Catteruccia</surname><given-names>F</given-names></name><name><surname>Kakani</surname><given-names>E</given-names></name><name><surname>Mitchell</surname><given-names>SN</given-names></name><etal/></person-group><article-title>Extensive introgression in a malaria vector species complex revealed by phylogenomics</article-title><source>Science</source><year>2015</year><volume>347</volume><issue>6217</issue><elocation-id>1258524</elocation-id><pub-id pub-id-type="pmcid">PMC4380269</pub-id><pub-id pub-id-type="pmid">25431491</pub-id><pub-id pub-id-type="doi">10.1126/science.1258524</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galimberti</surname><given-names>M</given-names></name><name><surname>Leuenberger</surname><given-names>C</given-names></name><name><surname>Wolf</surname><given-names>B</given-names></name><name><surname>Szilágyi</surname><given-names>SM</given-names></name><name><surname>Foll</surname><given-names>M</given-names></name><name><surname>Wegmann</surname><given-names>D</given-names></name></person-group><article-title>Detecting Selection from Linked Sites Using an F-Model</article-title><source>Genetics</source><year>2020</year><volume>216</volume><issue>4</issue><fpage>1205</fpage><lpage>1215</lpage><pub-id pub-id-type="pmcid">PMC7768260</pub-id><pub-id pub-id-type="pmid">33067324</pub-id><pub-id pub-id-type="doi">10.1534/genetics.120.303780</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>PR</given-names></name><name><surname>Grant</surname><given-names>BR</given-names></name></person-group><article-title>Hybridization of Bird Species</article-title><source>Science</source><year>1992</year><volume>256</volume><issue>5054</issue><fpage>193</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">17744718</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>PR</given-names></name><name><surname>Grant</surname><given-names>BR</given-names></name></person-group><article-title>Phenotypic and genetic effects of hybridization in Darwin’s finches</article-title><source>Evolution</source><year>1994</year><volume>48</volume><issue>2</issue><fpage>297</fpage><lpage>316</lpage><pub-id pub-id-type="pmid">28568290</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>RE</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>Briggs</surname><given-names>AW</given-names></name><name><surname>Maricic</surname><given-names>T</given-names></name><name><surname>Stenzel</surname><given-names>U</given-names></name><name><surname>Kircher</surname><given-names>M</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhai</surname><given-names>W</given-names></name><name><surname>Fritz</surname><given-names>MHY</given-names></name><name><surname>Hansen</surname><given-names>NF</given-names></name><etal/></person-group><article-title>A draft sequence of the neandertal genome</article-title><source>Science</source><year>2010</year><volume>328</volume><issue>5979</issue><fpage>710</fpage><lpage>722</lpage><pub-id pub-id-type="pmcid">PMC5100745</pub-id><pub-id pub-id-type="pmid">20448178</pub-id><pub-id pub-id-type="doi">10.1126/science.1188021</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grossen</surname><given-names>C</given-names></name><name><surname>Keller</surname><given-names>L</given-names></name><name><surname>Biebach</surname><given-names>I</given-names></name><collab>Consortium, TIGG</collab><name><surname>Croll</surname><given-names>D</given-names></name></person-group><article-title>Introgression from domestic goat generated variation at the major histocompatibility complex of alpine ibex</article-title><source>PLOS Genetics</source><year>2014</year><volume>10</volume><issue>6</issue><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC4063738</pub-id><pub-id pub-id-type="pmid">24945814</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004438</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>RG</given-names></name></person-group><source>Hybrid Zones and the Evolutionary Process</source><publisher-name>Oxford University Press</publisher-name><year>1993</year></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>KM</given-names></name><name><surname>Joron</surname><given-names>M</given-names></name><name><surname>McMillan</surname><given-names>WO</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><article-title>Rampant Genome-Wide Admixture across the Heliconius Radiation</article-title><source>Genome Biology and Evolution</source><year>2021</year><volume>13</volume><issue>7</issue><pub-id pub-id-type="pmcid">PMC8283734</pub-id><pub-id pub-id-type="pmid">33944917</pub-id><pub-id pub-id-type="doi">10.1093/gbe/evab099</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kronforst</surname><given-names>MR</given-names></name><name><surname>Hansen</surname><given-names>ME</given-names></name><name><surname>Crawford</surname><given-names>NG</given-names></name><name><surname>Gallant</surname><given-names>JR</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Kulathinal</surname><given-names>RJ</given-names></name><name><surname>Kapan</surname><given-names>DD</given-names></name><name><surname>Mullen</surname><given-names>SP</given-names></name></person-group><article-title>Hybridization Reveals the Evolving Genomic Architecture of Speciation</article-title><source>Cell reports</source><year>2013</year><volume>5</volume><issue>3</issue><fpage>666</fpage><pub-id pub-id-type="pmcid">PMC4388300</pub-id><pub-id pub-id-type="pmid">24183670</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2013.09.042</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kulathinal</surname><given-names>RJ</given-names></name><name><surname>Stevison</surname><given-names>LS</given-names></name><name><surname>Noor</surname><given-names>MA</given-names></name></person-group><article-title>The Genomics of Speciation in Drosophila: Diversity, Divergence, and Introgression Estimated Using Low-Coverage Genome Sequencing</article-title><source>PLOS Genetics</source><year>2009</year><volume>5</volume><issue>7</issue><elocation-id>e1000550</elocation-id><pub-id pub-id-type="pmcid">PMC2696600</pub-id><pub-id pub-id-type="pmid">19578407</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000550</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>K</given-names></name></person-group><chapter-title>Numerical Analysis for Statisticians</chapter-title><source>Statistics and Computing</source><publisher-name>Springer New York</publisher-name><publisher-loc>New York, NY</publisher-loc><year>2010</year></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>DJ</given-names></name><name><surname>Hellenthal</surname><given-names>G</given-names></name><name><surname>Myers</surname><given-names>S</given-names></name><name><surname>Falush</surname><given-names>D</given-names></name></person-group><article-title>Inference of Population Structure using Dense Haplotype Data</article-title><source>PLOS Genetics</source><year>2012</year><volume>8</volume><issue>1</issue><elocation-id>e1002453</elocation-id><pub-id pub-id-type="pmcid">PMC3266881</pub-id><pub-id pub-id-type="pmid">22291602</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002453</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>DJ</given-names></name><name><surname>Van Dorp</surname><given-names>L</given-names></name><name><surname>Falush</surname><given-names>D</given-names></name></person-group><article-title>A tutorial on how not to over-interpret structure and admixture bar plots</article-title><source>Nature communications</source><year>2018</year><volume>9</volume><issue>1</issue><elocation-id>3258</elocation-id><pub-id pub-id-type="pmcid">PMC6092366</pub-id><pub-id pub-id-type="pmid">30108219</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-05257-7</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lipson</surname><given-names>M</given-names></name><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Levin</surname><given-names>A</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name></person-group><article-title>Efficient Moment-Based Inference of Admixture Parameters and Sources of Gene Flow</article-title><source>Molecular Biology and Evolution</source><year>2013</year><volume>30</volume><issue>8</issue><fpage>1788</fpage><lpage>1802</lpage><pub-id pub-id-type="pmcid">PMC3708505</pub-id><pub-id pub-id-type="pmid">23709261</pub-id><pub-id pub-id-type="doi">10.1093/molbev/mst099</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lipson</surname><given-names>M</given-names></name><name><surname>Loh</surname><given-names>PR</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Moorjani</surname><given-names>P</given-names></name><name><surname>Ko</surname><given-names>YC</given-names></name><name><surname>Stoneking</surname><given-names>M</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>Reconstructing Austronesian population history in Island Southeast Asia</article-title><source>Nature Communications</source><year>2014</year><volume>5</volume><issue>1</issue><fpage>1</fpage><lpage>7</lpage><comment>2014 5:1</comment><pub-id pub-id-type="pmcid">PMC4143916</pub-id><pub-id pub-id-type="pmid">25137359</pub-id><pub-id pub-id-type="doi">10.1038/ncomms5689</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luqman</surname><given-names>H</given-names></name><name><surname>Widmer</surname><given-names>A</given-names></name><name><surname>Fior</surname><given-names>S</given-names></name><name><surname>Wegmann</surname><given-names>D</given-names></name></person-group><article-title>Identifying loci under selection via explicit demographic models</article-title><source>Molecular Ecology Resources</source><year>2021</year><volume>21</volume><issue>8</issue><fpage>2719</fpage><lpage>2737</lpage><pub-id pub-id-type="pmcid">PMC8596768</pub-id><pub-id pub-id-type="pmid">33964107</pub-id><pub-id pub-id-type="doi">10.1111/1755-0998.13415</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinsky</surname><given-names>M</given-names></name><name><surname>Challis</surname><given-names>RJ</given-names></name><name><surname>Tyers</surname><given-names>AM</given-names></name><name><surname>Schiffels</surname><given-names>S</given-names></name><name><surname>Terai</surname><given-names>Y</given-names></name><name><surname>Ngatunga</surname><given-names>BP</given-names></name><name><surname>Miska</surname><given-names>EA</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Genner</surname><given-names>MJ</given-names></name><name><surname>Turner</surname><given-names>GF</given-names></name></person-group><article-title>Genomic islands of speciation separate cichlid ecomorphs in an East African crater lake</article-title><source>Science</source><year>2015</year><volume>350</volume><issue>6267</issue><fpage>1493</fpage><lpage>1498</lpage><pub-id pub-id-type="pmcid">PMC4700518</pub-id><pub-id pub-id-type="pmid">26680190</pub-id><pub-id pub-id-type="doi">10.1126/science.aac9927</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malinsky</surname><given-names>M</given-names></name><name><surname>Matschiner</surname><given-names>M</given-names></name><name><surname>Svardal</surname><given-names>H</given-names></name></person-group><article-title>Dsuite - Fast D-statistics and related admixture evidence from VCF files</article-title><source>Molecular Ecology Resources</source><year>2021</year><volume>21</volume><issue>2</issue><fpage>584</fpage><lpage>595</lpage><pub-id pub-id-type="pmcid">PMC7116594</pub-id><pub-id pub-id-type="pmid">33012121</pub-id><pub-id pub-id-type="doi">10.1111/1755-0998.13265</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mallet</surname><given-names>J</given-names></name></person-group><article-title>Hybridization as an invasion of the genome</article-title><source>Trends in Ecology &amp; Evolution</source><year>2005</year><volume>20</volume><issue>5</issue><fpage>229</fpage><lpage>237</lpage><pub-id pub-id-type="pmid">16701374</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maples</surname><given-names>BK</given-names></name><name><surname>Gravel</surname><given-names>S</given-names></name><name><surname>Kenny</surname><given-names>EE</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name></person-group><article-title>RFMix: A Discriminative Modeling Approach for Rapid and Robust Local-Ancestry Inference</article-title><source>The American Journal of Human Genetics</source><year>2013</year><volume>93</volume><issue>2</issue><fpage>278</fpage><lpage>288</lpage><pub-id pub-id-type="pmcid">PMC3738819</pub-id><pub-id pub-id-type="pmid">23910464</pub-id><pub-id pub-id-type="doi">10.1016/j.ajhg.2013.06.020</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchi</surname><given-names>N</given-names></name><name><surname>Winkelbach</surname><given-names>L</given-names></name><name><surname>Schulz</surname><given-names>I</given-names></name><name><surname>Brami</surname><given-names>M</given-names></name><name><surname>Hofmanová</surname><given-names>Z</given-names></name><name><surname>Blöcher</surname><given-names>J</given-names></name><name><surname>Reyna-Blanco</surname><given-names>CS</given-names></name><name><surname>Diekmann</surname><given-names>Y</given-names></name><name><surname>Thiéry</surname><given-names>A</given-names></name><name><surname>Kapopoulou</surname><given-names>A</given-names></name><name><surname>Link</surname><given-names>V</given-names></name><etal/></person-group><article-title>The genomic origins of the world’s first farmers</article-title><source>Cell</source><year>2022</year><volume>185</volume><issue>11</issue><fpage>1842</fpage><lpage>1859</lpage><elocation-id>e18</elocation-id><pub-id pub-id-type="pmcid">PMC9166250</pub-id><pub-id pub-id-type="pmid">35561686</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2022.04.008</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Dasmahapatra</surname><given-names>KK</given-names></name><name><surname>Nadeau</surname><given-names>NJ</given-names></name><name><surname>Salazar</surname><given-names>C</given-names></name><name><surname>Walters</surname><given-names>JR</given-names></name><name><surname>Simpson</surname><given-names>F</given-names></name><name><surname>Blaxter</surname><given-names>M</given-names></name><name><surname>Manica</surname><given-names>A</given-names></name><name><surname>Mallet</surname><given-names>J</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><article-title>Genome-wide evidence for speciation with gene flow in Heliconius butterflies</article-title><source>Genome research</source><year>2013</year><volume>23</volume><issue>11</issue><fpage>1817</fpage><lpage>1828</lpage><pub-id pub-id-type="pmcid">PMC3814882</pub-id><pub-id pub-id-type="pmid">24045163</pub-id><pub-id pub-id-type="doi">10.1101/gr.159426.113</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>SH</given-names></name><name><surname>Davey</surname><given-names>JW</given-names></name><name><surname>Jiggins</surname><given-names>CD</given-names></name></person-group><article-title>Evaluating the Use of ABBA–BABA Statistics to Locate Introgressed Loci</article-title><source>Molecular Biology and Evolution</source><year>2015</year><volume>32</volume><issue>1</issue><fpage>244</fpage><lpage>257</lpage><pub-id pub-id-type="pmcid">PMC4271521</pub-id><pub-id pub-id-type="pmid">25246699</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msu269</pub-id></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Münger</surname><given-names>X</given-names></name><name><surname>Robin</surname><given-names>M</given-names></name><name><surname>Dalén</surname><given-names>L</given-names></name><name><surname>Grossen</surname><given-names>C</given-names></name></person-group><article-title>Facilitated introgression from domestic goat into alpine ibex at immune loci</article-title><source>bioRxiv</source><year>2023</year></element-citation></ref><ref id="R48"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Murphy</surname><given-names>KP</given-names></name></person-group><source>Machine learning: a probabilistic perspective</source><year>2012</year></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nelder</surname><given-names>JA</given-names></name><name><surname>Mead</surname><given-names>R</given-names></name></person-group><article-title>A simplex method for function minimization</article-title><source>The Computer Journal</source><year>1965</year><volume>7</volume><issue>4</issue><fpage>308</fpage><lpage>313</lpage></element-citation></ref><ref id="R50"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nocedal</surname><given-names>J</given-names></name><name><surname>Wright</surname><given-names>S</given-names></name></person-group><source>Numerical Optimization</source><publisher-name>Springer Science &amp; Business Media</publisher-name><year>2006</year></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Moorjani</surname><given-names>P</given-names></name><name><surname>Luo</surname><given-names>Y</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Rohland</surname><given-names>N</given-names></name><name><surname>Zhan</surname><given-names>Y</given-names></name><name><surname>Genschoreck</surname><given-names>T</given-names></name><name><surname>Webster</surname><given-names>T</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>Ancient admixture in human history</article-title><source>Genetics</source><year>2012</year><volume>192</volume><issue>3</issue><fpage>1065</fpage><lpage>1093</lpage><pub-id pub-id-type="pmcid">PMC3522152</pub-id><pub-id pub-id-type="pmid">22960212</pub-id><pub-id pub-id-type="doi">10.1534/genetics.112.145037</pub-id></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Richter</surname><given-names>DJ</given-names></name><name><surname>Gnerre</surname><given-names>S</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>Genetic evidence for complex speciation of humans and chimpanzees</article-title><source>Nature</source><year>2006</year><volume>441</volume><issue>7097</issue><fpage>1103</fpage><lpage>1108</lpage><comment>2006 441:7097</comment><pub-id pub-id-type="pmid">16710306</pub-id></element-citation></ref><ref id="R53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeifer</surname><given-names>B</given-names></name><name><surname>Kapan</surname><given-names>DD</given-names></name></person-group><article-title>Estimates of introgression as a function of pairwise distances</article-title><source>BMC Bioinformatics</source><year>2019</year><volume>20</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC6480520</pub-id><pub-id pub-id-type="pmid">31014244</pub-id><pub-id pub-id-type="doi">10.1186/s12859-019-2747-z</pub-id></element-citation></ref><ref id="R54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pickrell</surname><given-names>JK</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><article-title>Inference of Population Splits and Mixtures from Genome-Wide Allele Frequency Data</article-title><source>PLOS Genetics</source><year>2012</year><volume>8</volume><issue>11</issue><elocation-id>e1002967</elocation-id><pub-id pub-id-type="pmcid">PMC3499260</pub-id><pub-id pub-id-type="pmid">23166502</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002967</pub-id></element-citation></ref><ref id="R55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plagnol</surname><given-names>V</given-names></name><name><surname>Wall</surname><given-names>JD</given-names></name></person-group><article-title>Possible ancestral structure in human populations</article-title><source>Plos Genetics</source><year>2006</year><volume>2</volume><issue>7</issue><fpage>e105</fpage><pub-id pub-id-type="pmcid">PMC1523253</pub-id><pub-id pub-id-type="pmid">16895447</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0020105</pub-id></element-citation></ref><ref id="R56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Helgason</surname><given-names>A</given-names></name><name><surname>Palsson</surname><given-names>S</given-names></name><name><surname>Stefansson</surname><given-names>H</given-names></name><name><surname>St Clair</surname><given-names>D</given-names></name><name><surname>Andreassen</surname><given-names>OA</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Kong</surname><given-names>A</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name></person-group><article-title>The Impact of Divergence Time on the Nature of Population Structure: An Example from Iceland</article-title><source>PLOS Genetics</source><year>2009</year><volume>5</volume><issue>6</issue><elocation-id>e1000505</elocation-id><pub-id pub-id-type="pmcid">PMC2684636</pub-id><pub-id pub-id-type="pmid">19503599</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000505</pub-id></element-citation></ref><ref id="R57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prüfer</surname><given-names>K</given-names></name><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Jay</surname><given-names>F</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name><name><surname>Sawyer</surname><given-names>S</given-names></name><name><surname>Heinze</surname><given-names>A</given-names></name><name><surname>Renaud</surname><given-names>G</given-names></name><name><surname>Sudmant</surname><given-names>PH</given-names></name><name><surname>De Filippo</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The complete genome sequence of a Neanderthal from the Altai Mountains</article-title><source>Nature</source><year>2014</year><volume>505</volume><issue>7481</issue><fpage>43</fpage><lpage>49</lpage><comment>2013 505:7481</comment><pub-id pub-id-type="pmcid">PMC4031459</pub-id><pub-id pub-id-type="pmid">24352235</pub-id><pub-id pub-id-type="doi">10.1038/nature12886</pub-id></element-citation></ref><ref id="R58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name><name><surname>Juang</surname><given-names>BH</given-names></name></person-group><article-title>An Introduction to Hidden Markov Models</article-title><source>IEEE ASSP Magazine</source><year>1986</year><volume>3</volume><issue>1</issue><fpage>4</fpage><lpage>16</lpage></element-citation></ref><ref id="R59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Marnetto</surname><given-names>D</given-names></name><name><surname>Huerta-Sánchez</surname><given-names>E</given-names></name></person-group><article-title>Signatures of Archaic Adaptive Introgression in Present-Day Human Populations</article-title><source>Molecular Biology and Evolution</source><year>2017</year><volume>34</volume><issue>2</issue><fpage>296</fpage><lpage>317</lpage><pub-id pub-id-type="pmcid">PMC5400396</pub-id><pub-id pub-id-type="pmid">27756828</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msw216</pub-id></element-citation></ref><ref id="R60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Racimo</surname><given-names>F</given-names></name><name><surname>Sankararaman</surname><given-names>S</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Huerta-Sánchez</surname><given-names>E</given-names></name></person-group><article-title>Evidence for archaic adaptive introgression in humans</article-title><source>Nature Reviews Genetics</source><year>2015</year><volume>16</volume><issue>6</issue><fpage>359</fpage><lpage>371</lpage><comment>2015 16:6</comment><pub-id pub-id-type="pmcid">PMC4478293</pub-id><pub-id pub-id-type="pmid">25963373</pub-id><pub-id pub-id-type="doi">10.1038/nrg3936</pub-id></element-citation></ref><ref id="R61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Campbell</surname><given-names>D</given-names></name><name><surname>Tandon</surname><given-names>A</given-names></name><name><surname>Mazieres</surname><given-names>S</given-names></name><name><surname>Ray</surname><given-names>N</given-names></name><name><surname>Parra</surname><given-names>MV</given-names></name><name><surname>Rojas</surname><given-names>W</given-names></name><name><surname>Duque</surname><given-names>C</given-names></name><name><surname>Mesa</surname><given-names>N</given-names></name><name><surname>García</surname><given-names>LF</given-names></name><etal/></person-group><article-title>Reconstructing Native American population history</article-title><source>Nature</source><year>2012</year><volume>488</volume><issue>7411</issue><fpage>370</fpage><lpage>374</lpage><pub-id pub-id-type="pmcid">PMC3615710</pub-id><pub-id pub-id-type="pmid">22801491</pub-id><pub-id pub-id-type="doi">10.1038/nature11258</pub-id></element-citation></ref><ref id="R62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Thangaraj</surname><given-names>K</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Singh</surname><given-names>L</given-names></name></person-group><article-title>Reconstructing Indian population history</article-title><source>Nature</source><year>2009</year><volume>461</volume><issue>7263</issue><fpage>489</fpage><lpage>494</lpage><pub-id pub-id-type="pmcid">PMC2842210</pub-id><pub-id pub-id-type="pmid">19779445</pub-id><pub-id pub-id-type="doi">10.1038/nature08365</pub-id></element-citation></ref><ref id="R63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rheindt</surname><given-names>FE</given-names></name><name><surname>Fujita</surname><given-names>MK</given-names></name><name><surname>Wilton</surname><given-names>PR</given-names></name><name><surname>Edwards</surname><given-names>SV</given-names></name></person-group><article-title>Introgression and phenotypic assimilation in Zimmerius flycatchers (Tyrannidae): population genetic and phylogenetic inferences from genome-wide SNPs</article-title><source>Systematic biology</source><year>2014</year><volume>63</volume><issue>2</issue><fpage>134</fpage><lpage>152</lpage><pub-id pub-id-type="pmid">24304652</pub-id></element-citation></ref><ref id="R64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rieseberg</surname><given-names>LH</given-names></name><name><surname>Wendel</surname><given-names>JF</given-names></name></person-group><chapter-title>Introgression and Its Consequences in Plants</chapter-title><person-group person-group-type="editor"><name><surname>Harrison</surname><given-names>RG</given-names></name></person-group><source>Hybrid zones and the evolutionary process</source><publisher-name>Oxford University Press</publisher-name><year>1993</year><fpage>70</fpage><lpage>109</lpage><comment>chapter 4</comment></element-citation></ref><ref id="R65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sankararaman</surname><given-names>S</given-names></name></person-group><article-title>Methods for detecting introgressed archaic sequences</article-title><source>Current Opinion in Genetics &amp; Development</source><year>2020</year><volume>62</volume><fpage>85</fpage><lpage>90</lpage><pub-id pub-id-type="pmcid">PMC7484293</pub-id><pub-id pub-id-type="pmid">32717667</pub-id><pub-id pub-id-type="doi">10.1016/j.gde.2020.05.026</pub-id></element-citation></ref><ref id="R66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sankararaman</surname><given-names>S</given-names></name><name><surname>Mallick</surname><given-names>S</given-names></name><name><surname>Dannemann</surname><given-names>M</given-names></name><name><surname>Prüfer</surname><given-names>K</given-names></name><name><surname>Kelso</surname><given-names>J</given-names></name><name><surname>Pääbo</surname><given-names>S</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name></person-group><article-title>The genomic landscape of Neanderthal ancestry in present-day humans</article-title><source>Nature</source><year>2014</year><volume>507</volume><issue>7492</issue><fpage>354</fpage><lpage>357</lpage><comment>2014 507:7492</comment><pub-id pub-id-type="pmcid">PMC4072735</pub-id><pub-id pub-id-type="pmid">24476815</pub-id><pub-id pub-id-type="doi">10.1038/nature12961</pub-id></element-citation></ref><ref id="R67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seguin-Orlando</surname><given-names>A</given-names></name><name><surname>Korneliussen</surname><given-names>TS</given-names></name><name><surname>Sikora</surname><given-names>M</given-names></name><name><surname>Malaspinas</surname><given-names>AS</given-names></name><name><surname>Manica</surname><given-names>A</given-names></name><name><surname>Moltke</surname><given-names>I</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Ko</surname><given-names>A</given-names></name><name><surname>Margaryan</surname><given-names>A</given-names></name><name><surname>Moiseyev</surname><given-names>V</given-names></name><name><surname>Goebel</surname><given-names>T</given-names></name><etal/></person-group><article-title>Genomic structure in Europeans dating back at least 36,200 years</article-title><source>Science</source><year>2014</year><volume>346</volume><issue>6213</issue><fpage>1113</fpage><lpage>1118</lpage><pub-id pub-id-type="pmid">25378462</pub-id></element-citation></ref><ref id="R68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skov</surname><given-names>L</given-names></name><name><surname>Hui</surname><given-names>R</given-names></name><name><surname>Shchur</surname><given-names>V</given-names></name><name><surname>Hobolth</surname><given-names>A</given-names></name><name><surname>Scally</surname><given-names>A</given-names></name><name><surname>Schierup</surname><given-names>MH</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Detecting archaic introgression using an unadmixed outgroup</article-title><source>PLOS Genetics</source><year>2018</year><volume>14</volume><issue>9</issue><elocation-id>e1007641</elocation-id><pub-id pub-id-type="pmcid">PMC6161914</pub-id><pub-id pub-id-type="pmid">30226838</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007641</pub-id></element-citation></ref><ref id="R69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Gene Flow in Natural Populations</article-title><source>Source: Annual Review of Ecology and Systematics</source><year>1985a</year><volume>16</volume><fpage>393</fpage><lpage>430</lpage></element-citation></ref><ref id="R70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Rare alleles indicators of gene flow</article-title><source>Evolution; international journal of organic evolution</source><year>1985b</year><volume>39</volume><issue>1</issue><fpage>53</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">28563643</pub-id></element-citation></ref><ref id="R71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Gene Flow and the Geographic Structure of Natural Populations</article-title><source>Science</source><year>1987</year><volume>236</volume><issue>4803</issue><fpage>787</fpage><lpage>792</lpage><pub-id pub-id-type="pmid">3576198</pub-id></element-citation></ref><ref id="R72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>J</given-names></name><name><surname>Kronforst</surname><given-names>MR</given-names></name></person-group><article-title>Do Heliconius butterfly species exchange mimicry alleles?</article-title><source>Biology letters</source><year>2013</year><volume>9</volume><issue>4</issue><pub-id pub-id-type="pmcid">PMC3730661</pub-id><pub-id pub-id-type="pmid">23864282</pub-id><pub-id pub-id-type="doi">10.1098/rsbl.2013.0503</pub-id></element-citation></ref><ref id="R73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sousa</surname><given-names>VC</given-names></name><name><surname>Fritz</surname><given-names>M</given-names></name><name><surname>Beaumont</surname><given-names>MA</given-names></name><name><surname>Chikhi</surname><given-names>L</given-names></name></person-group><article-title>Approximate Bayesian Computation Without Summary Statistics: The Case of Admixture</article-title><source>Genetics</source><year>2009</year><volume>181</volume><issue>4</issue><fpage>1507</fpage><lpage>1519</lpage><pub-id pub-id-type="pmcid">PMC2666516</pub-id><pub-id pub-id-type="pmid">19189952</pub-id><pub-id pub-id-type="doi">10.1534/genetics.108.098129</pub-id></element-citation></ref><ref id="R74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinrücken</surname><given-names>M</given-names></name><name><surname>Spence</surname><given-names>JP</given-names></name><name><surname>Kamm</surname><given-names>JA</given-names></name><name><surname>Wieczorek</surname><given-names>E</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>Model-based detection and analysis of introgressed Neanderthal ancestry in modern humans</article-title><source>Molecular Ecology</source><year>2018</year><volume>27</volume><issue>19</issue><fpage>3873</fpage><lpage>3888</lpage><pub-id pub-id-type="pmcid">PMC6165692</pub-id><pub-id pub-id-type="pmid">29603507</pub-id><pub-id pub-id-type="doi">10.1111/mec.14565</pub-id></element-citation></ref><ref id="R75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suarez-Gonzalez</surname><given-names>A</given-names></name><name><surname>Lexer</surname><given-names>C</given-names></name><name><surname>Cronk</surname><given-names>QC</given-names></name></person-group><article-title>Adaptive introgression: a plant perspective</article-title><source>Biology Letters</source><year>2018</year><volume>14</volume><issue>3</issue><pub-id pub-id-type="pmcid">PMC5897607</pub-id><pub-id pub-id-type="pmid">29540564</pub-id><pub-id pub-id-type="doi">10.1098/rsbl.2017.0688</pub-id></element-citation></ref><ref id="R76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Coram</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Risch</surname><given-names>N</given-names></name></person-group><article-title>Reconstructing Genetic Ancestry Blocks in Admixed Individuals</article-title><source>The American Journal of Human Genetics</source><year>2006</year><volume>79</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC1474129</pub-id><pub-id pub-id-type="pmid">16773560</pub-id><pub-id pub-id-type="doi">10.1086/504302</pub-id></element-citation></ref><ref id="R77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournebize</surname><given-names>R</given-names></name><name><surname>Chikhi</surname><given-names>L</given-names></name></person-group><article-title>Questioning neanderthal admixture: on models, robustness and consensus in human evolution</article-title><source>bioRxiv</source><year>2023</year></element-citation></ref><ref id="R78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tung</surname><given-names>J</given-names></name><name><surname>Barreiro</surname><given-names>LB</given-names></name></person-group><article-title>The contribution of admixture to primate evolution</article-title><source>Current Opinion in Genetics &amp; Development</source><year>2017</year><volume>47</volume><fpage>61</fpage><lpage>68</lpage><pub-id pub-id-type="pmid">28923540</pub-id></element-citation></ref><ref id="R79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vernot</surname><given-names>B</given-names></name><name><surname>Akey</surname><given-names>JM</given-names></name></person-group><article-title>Resurrecting surviving Neandertal lineages from modern human genomes</article-title><source>Science</source><year>2014</year><volume>343</volume><issue>6174</issue><fpage>1017</fpage><lpage>1021</lpage><pub-id pub-id-type="pmid">24476670</pub-id></element-citation></ref><ref id="R80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vernot</surname><given-names>B</given-names></name><name><surname>Tucci</surname><given-names>S</given-names></name><name><surname>Kelso</surname><given-names>J</given-names></name><name><surname>Schraiber</surname><given-names>JG</given-names></name><name><surname>Wolf</surname><given-names>AB</given-names></name><name><surname>Gittelman</surname><given-names>RM</given-names></name><name><surname>Dannemann</surname><given-names>M</given-names></name><name><surname>Grote</surname><given-names>S</given-names></name><name><surname>McCoy</surname><given-names>RC</given-names></name><name><surname>Norton</surname><given-names>H</given-names></name><name><surname>Scheinfeldt</surname><given-names>LB</given-names></name><etal/></person-group><article-title>Excavating Neandertal and Denisovan DNA from the genomes of Melanesian individuals</article-title><source>Science</source><year>2016</year><volume>352</volume><issue>6282</issue><fpage>235</fpage><lpage>239</lpage><pub-id pub-id-type="pmcid">PMC6743480</pub-id><pub-id pub-id-type="pmid">26989198</pub-id><pub-id pub-id-type="doi">10.1126/science.aad9416</pub-id></element-citation></ref><ref id="R81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wall</surname><given-names>JD</given-names></name><name><surname>Lohmueller</surname><given-names>KE</given-names></name><name><surname>Plagnol</surname><given-names>V</given-names></name></person-group><article-title>Detecting Ancient Admixture and Estimating Demographic Parameters in Multiple Human Populations</article-title><source>Molecular Biology and Evolution</source><year>2009</year><volume>26</volume><issue>8</issue><fpage>1823</fpage><lpage>1827</lpage><pub-id pub-id-type="pmcid">PMC2734152</pub-id><pub-id pub-id-type="pmid">19420049</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msp096</pub-id></element-citation></ref><ref id="R82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wegmann</surname><given-names>D</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group><article-title>Bayesian Inference of the Demographic History of Chimpanzees</article-title><source>Molecular Biology and Evolution</source><year>2010</year><volume>27</volume><issue>6</issue><fpage>1425</fpage><lpage>1435</lpage><pub-id pub-id-type="pmid">20118191</pub-id></element-citation></ref><ref id="R83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wegmann</surname><given-names>D</given-names></name><name><surname>Kessner</surname><given-names>DE</given-names></name><name><surname>Veeramah</surname><given-names>KR</given-names></name><name><surname>Mathias</surname><given-names>RA</given-names></name><name><surname>Nicolae</surname><given-names>DL</given-names></name><name><surname>Yanek</surname><given-names>LR</given-names></name><name><surname>Sun</surname><given-names>YV</given-names></name><name><surname>Torgerson</surname><given-names>DG</given-names></name><name><surname>Rafaels</surname><given-names>N</given-names></name><name><surname>Mosley</surname><given-names>T</given-names></name><name><surname>Becker</surname><given-names>LC</given-names></name><etal/></person-group><article-title>Recombination rates in admixed individuals identified by ancestry-based inference</article-title><source>Nature Genetics</source><year>2011</year><volume>43</volume><issue>9</issue><fpage>847</fpage><lpage>853</lpage><comment>2011 43:9</comment><pub-id pub-id-type="pmcid">PMC8582322</pub-id><pub-id pub-id-type="pmid">21775992</pub-id><pub-id pub-id-type="doi">10.1038/ng.894</pub-id></element-citation></ref><ref id="R84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>CI</given-names></name></person-group><article-title>The genic view of the process of speciation</article-title><source>Journal of Evolutionary Biology</source><year>2001</year><volume>14</volume><issue>6</issue><fpage>851</fpage><lpage>865</lpage></element-citation></ref><ref id="R85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamamichi</surname><given-names>M</given-names></name><name><surname>Innan</surname><given-names>H</given-names></name></person-group><article-title>Estimating the migration rate from genetic variation data</article-title><source>Heredity</source><year>2012</year><volume>108</volume><issue>4</issue><fpage>362</fpage><lpage>363</lpage><pub-id pub-id-type="pmcid">PMC3313046</pub-id><pub-id pub-id-type="pmid">21934701</pub-id><pub-id pub-id-type="doi">10.1038/hdy.2011.83</pub-id></element-citation></ref><ref id="R86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>MA</given-names></name><name><surname>Malaspinas</surname><given-names>AS</given-names></name><name><surname>Durand</surname><given-names>EY</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Ancient structure in Africa unlikely to explain Neanderthal and non-African genetic similarity</article-title><source>Molecular biology and evolution</source><year>2012</year><volume>29</volume><issue>10</issue><fpage>2987</fpage><lpage>2995</lpage><pub-id pub-id-type="pmcid">PMC3457770</pub-id><pub-id pub-id-type="pmid">22513287</pub-id><pub-id pub-id-type="doi">10.1093/molbev/mss117</pub-id></element-citation></ref><ref id="R87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Witt</surname><given-names>KE</given-names></name><name><surname>Bañuelos</surname><given-names>MM</given-names></name><name><surname>Ko</surname><given-names>A</given-names></name><name><surname>Yuan</surname><given-names>K</given-names></name><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Huerta-Sanchez</surname><given-names>E</given-names></name></person-group><article-title>The history and evolution of the Denisovan-EPAS1 haplotype in Tibetans</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2021</year><volume>118</volume><issue>22</issue><elocation-id>e2020803118</elocation-id><pub-id pub-id-type="pmcid">PMC8179186</pub-id><pub-id pub-id-type="pmid">34050022</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2020803118</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Inference example.</title><p>A: admixture graph with two migration edges marked in different colors. Parameters of interest are shown on the graph (root prior and branch lengths) as well as the untransformed and transformed ancient, sampling and population allele frequency variables. B: All possible configurations of <bold>b</bold> for two migration events when they are open or closed. C: Example of inference under our <monospace>TreeSwirl</monospace> model for each migration event. The top panel shows the posterior mean mixture proportions <inline-formula><mml:math id="M33"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> compared to simulated estimates and the bottom panel shows the identified candidate regions under possible selection, where the false discovery rates (FDR) for excess (<italic>q<sub>e</sub></italic>) and dearth (<italic>q<sub>d</sub></italic>) introgression was determined for each locus as explained in the "Inference" section.</p></caption><graphic xlink:href="EMS190791-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Performance of <monospace>TreeSwirl</monospace> as assessed by simulations under the <monospace>TreeSwirl</monospace> model. Shown are, for each of four cases of migration scenarios, the population graph (first column), estimates of locus-specific migration rates (posterior means, second and third column) and estimates of selected branch lengths (fourth and fifth column) for a case with variable (third and fifth column) and for a case without (second and fourth column) variation in migration rates along the simulated chromosome. Colors correspond to the migration edges and branch lengths of the same color in the population graph. Simulated migration rates are shown as a thick line and the estimates as a thin line per replicate. For branch lengths the simulated values are shown as a cross and estimates as open circles.</p></caption><graphic xlink:href="EMS190791-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>Performance of <monospace>TreeSwirl</monospace> and <italic>f</italic><sub>4</sub>-stats methods to measure the amount of introgression under different demographic histories with an background migration rate <italic>α<sub>b</sub></italic> = 0.05. First column: simulated demographic histories. Second column: schematic of the topology models. Third column: AUC measures for <monospace>TreeSwirl</monospace> as a function of the migration rate of blocks with elevated migration rates. Fourth column: AUC measure for the combination of summary statistic (<italic>F<sub>ST</sub></italic>, <italic>D</italic>− or <italic>f</italic>-related), window size and population subset (in case E only) that led to the highest AUC. Symbols indicate the size of the blocks with elevated migration rates compared to the background rate.</p></caption><graphic xlink:href="EMS190791-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Inference of introgressed loci in Alpine and Iberian ibex. Shown is the inferred population graph along with inferred migration rates (posterior means) along chromosomes 21-25 for Alpine ibex (top, orange) and Iberian ibex (bottom, pink). The region reported by <xref ref-type="bibr" rid="R47">Münger et al. (2023)</xref> on Chromosome 23 is marked with a gray background.</p></caption><graphic xlink:href="EMS190791-f004"/></fig></floats-group></article>