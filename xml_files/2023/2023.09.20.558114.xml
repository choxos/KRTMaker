<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS188444</article-id><article-id pub-id-type="doi">10.1101/2023.09.20.558114</article-id><article-id pub-id-type="archive">PPR728988</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>ANS: Adjusted Neighborhood Scoring to improve gene signature-based cell annotation in single-cell RNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ciernik</surname><given-names>Laure</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Kraft</surname><given-names>Agnieszka</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Barkmann</surname><given-names>Florian</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Yates</surname><given-names>Josephine</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Boeva</surname><given-names>Valentina</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zurich</institution></institution-wrap>, Department of Computer Science, Institute for Machine Learning, <postal-code>8092</postal-code><city>Zurich</city>, <country country="CH">Switzerland</country></aff><aff id="A2"><label>2</label>Machine Learning Group, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v4gjf40</institution-id><institution>Technische Universität Berlin</institution></institution-wrap>, <postal-code>10587</postal-code><city>Berlin</city>, <country country="DE">Germany</country></aff><aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05dsfb086</institution-id><institution>Berlin Institute for the Foundations of Learning and Data (BIFOLD)</institution></institution-wrap>, <postal-code>10587</postal-code><city>Berlin</city>, <country country="DE">Germany</country></aff><aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f4frq91</institution-id><institution>Hector Fellow Academy</institution></institution-wrap>, <postal-code>76131</postal-code><city>Karlsruhe</city>, <country country="DE">Germany</country></aff><aff id="A5"><label>5</label>ETH AI Center, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>ETH Zürich</institution></institution-wrap>, <city>Zurich</city><country country="CH">Switzerland</country></aff><aff id="A6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vjkv261</institution-id><institution>INSERM</institution></institution-wrap>, U1016, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/051sk4035</institution-id><institution>Cochin Institute</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02feahw73</institution-id><institution>CNRS</institution></institution-wrap> UMR8104, Paris Descartes University, <city>Paris</city>, <country country="FR">France</country></aff><aff id="A7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/002n09z45</institution-id><institution>Swiss Institute of Bioinformatics (SIB)</institution></institution-wrap>, <city>Zurich</city>, <country country="CH">Switzerland</country></aff><aff id="A8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01462r250</institution-id><institution>University Hospital Zurich</institution></institution-wrap>, Department of Thoracic Surgery, <postal-code>8092</postal-code><city>Zurich</city></aff></contrib-group><author-notes><corresp id="CR1">
<label>*</label>Corresponding author: Correspondence to Valentina Boeva: <email>valentina.boeva@inf.ethz.ch</email>. ETH Zurich, Universitatstrasse 6, 8092 Zurich, Switzerland</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>24</day><month>09</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>22</day><month>09</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">In the field of single-cell RNA sequencing (scRNA-seq), gene signature scoring is integral for pinpointing and characterizing distinct cell populations. However, challenges arise in ensuring the robustness and comparability of scores across various gene signatures and across different batches and conditions. Here, we evaluated the stability of established methods such as Scanpy, UCell, and JASMINE in the context of scoring cells of different types and states. On eight cancer and healthy scRNA-seq datasets, we reported that none of the existing methods provide fair gene signature scores that can be used in unsupervised cell state annotation based on the highest signature values. Addressing this challenge, we introduced a new scoring method, the Adjusted Neighbourhood Scoring (ANS), that builds on the traditional Scanpy method and improves the handling of the control gene sets. We further exemplified the usability of ANS scoring in differentiating between cancer-associated fibroblasts and malignant cells undergoing epithelial-mesenchymal transition (EMT) in four cancer types, and evidenced excellent classification performance (AUCPR train: 0.95-0.99, AUCPR test: 0.91-0.99). In summary, our research introduces ANS as a robust and deterministic scoring approach that enables the comparison of diverse gene signatures and score-based annotation of cell types and states. The results of our study contribute to the development of more accurate and reliable methods for analyzing scRNA-seq data.</p></abstract><kwd-group><kwd>scRNA-seq</kwd><kwd>gene signatures</kwd><kwd>scoring methods</kwd><kwd>cell type annotation</kwd><kwd>cell state annotation</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">High-throughput single-cell RNA sequencing (scRNA-seq) is a powerful technology to profile the transcriptome at the cellular level<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. Gene expression from single cells allows for quantifying cell types and states, analyzing inter- and intra-sample heterogeneity, discovering cell differentiation trajectories, and constructing gene regulatory networks<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. The interpretation of scRNA-seq data can be challenging due to high dimensionality, batch effects, dropout, and transcriptional noise<sup><xref ref-type="bibr" rid="R3">3</xref></sup>. To work reliably on scRNA-seq measurements, the methods must address the inherent variability and noise in these data. This is especially important when evaluating cell states and programs through gene signature scoring. Thus, robust scoring tools are essential for the reliable characterization of cell states and programs.</p><p id="P3">Gene signature scoring on scRNA-seq data measures the activity of biological processes and transcriptional cell states for each cell profiled. Gene signatures are sets of genes associated with a specific biological signal, transcriptional state, cell type, or cell state and are used as a surrogate representation for a biological phenotype<sup><xref ref-type="bibr" rid="R4">4</xref></sup>. During gene signature scoring, the information in the high-dimensional gene expression data is condensed into a per-cell score, which can then be used for downstream analysis. One key application is cell annotation as it offers a highly efficient and reliable method for classifying cells into types and states<sup><xref ref-type="bibr" rid="R5">5</xref></sup>. By ranking the scores for potential cell types and states, a higher score indicates a stronger match to a specific cell type’s phenotype. Cells can then be labelled using various strategies, such as setting a score threshold, selecting the highest score, or comparing the relative difference between scores. Notably, the quality of gene signatures plays a critical role in this process, as the accuracy of the score depends on how well the selected genes reflect the underlying biological process, regardless of the performance of the scoring method itself.</p><p id="P4">Numerous techniques for gene signature scoring in bulk RNA-seq and scRNA-seq have been developed lately. Recent studies, however, showed that signature scoring methods created for bulk RNA-seq, such as ssGSEA<sup><xref ref-type="bibr" rid="R6">6</xref></sup> and GSVA<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, were not fit for scRNA-seq data since they were more susceptible to dropouts, and suffered from imbalanced expressions of genes in cancer cells versus non-malignant cells in tumor samples<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. Therefore, researchers were advised to use single cell-specific methods, such as signature scoring methods of Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup>, Seurat<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, UCell<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, and JASMINE (Jointly Assessing Signature Mean and Inferring Enrichment)<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. Gibbs et al. propose an alternative approach to address the challenges of applying scoring methods designed for bulk data to single-cell datasets. They introduce GSSNNG, a method which overcomes sparsity and technical noise in single-cell data by using a nearest neighbor graph of cells for gene expression matrix smoothing before gene signature scoring<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. While smoothing reduces noise, it is important to note the trade-off between removing variance and introducing bias in single-cell studies<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>. Additionally, this method requires the user to define cell groupings, which can be challenging and may significantly impact the resulting neighbor graphs.</p><p id="P5">The scoring methods implemented in the scRNA-seq analysis packages Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup> and Seurat<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, are based on the procedure described by Tirosh <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, which computes scores by averaging the difference in expression of the signature and control genes. Due to slight implementation differences, we distinguish between the Scanpy and the Seurat methods in this study (<xref ref-type="sec" rid="S10">Methods</xref>). Although widely used, these scoring approaches may show some drawbacks. As in Scanpy and Seurat the control genes are selected by binning genes based on comparable mean expression, the scores may be biased by the number of bins and the behavior of the mean expression curve.</p><p id="P6">Two other popular scoring approaches, UCell<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, which is an extension of AUCell<sup><xref ref-type="bibr" rid="R18">18</xref></sup>, and JASMINE<sup><xref ref-type="bibr" rid="R8">8</xref></sup>, use rank statistics to increase the stability of results in case of strong technical variation and batch effects. UCell is solely based on Mann-Whitney U statistics<sup><xref ref-type="bibr" rid="R13">13</xref></sup>. It is expected to be robust against technical variation as it only uses per-cell gene rank information. JASMINE computes scores by averaging the mean of signature gene ranks and an enrichment value<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. The enrichment values can correspond to odds ratios or the likelihood, referred to as OR and LH in our benchmarks.</p><p id="P7">Although Noureen et al.<sup><xref ref-type="bibr" rid="R8">8</xref></sup> investigated the robustness of various signature scoring methods for bulk and single-cell RNA-seq, focusing on sensitivity and specificity across <italic>in silico</italic> datasets, the study did not address score range comparability. In contrast, Wang and Thakar<sup><xref ref-type="bibr" rid="R19">19</xref></sup> provided a broad comparison of several methods, including UCell, AUCell, JASMINE, and Seurat scoring, analyzing their performance under different factors, such as cell count, gene set size, noise, condition-specific genes, and zero imputation. However, their study did not include cancer datasets or evaluate these methods for score-based cell labeling. Therefore, a novel benchmark is needed to interrogate the robustness of gene signature scoring methods under the variation in sample cell composition and batch effects, ensuring their reliability and utility for score-based annotation of cell types and states in downstream analysis.</p><p id="P8">In this work, we benchmark and analyze the stability of gene signature scores provided by the most popular cell scoring methods, Scanpy, Seurat, UCell, and JASMINE. Using eight human healthy and cancer scRNA-seq datasets, we find that accurate unsupervised cell state annotation using gene signature scores is not possible based on scores calculated by the benchmarked methods, due to biased score ranges returned by all methods tested. We present an improvement of Tirosh’s scoring method, Adjusted Neighbourhood Scoring (ANS), which is more resistant to single-cell technology biases than the original approach. We show that ANS is robust with regard to most influencing factors, and returns comparable scores for multiple signatures that can be used for accurate cell type and cell state annotation. To showcase the usability of ANS to differentiate cells with related gene signatures, we use our method to devise a signature for mesenchymal-like cancer cells that discriminates mesenchymal-like malignant cells from tumor-infiltrating fibroblasts across different cancer types. Overall, our improvement to signature scoring methods, generating accurate and comparable gene signature scores, enables more reliable cell type and cell state annotation in single-cell data across diverse cell types and conditions.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Adjusted Neighbourhood Scoring (ANS) method</title><p id="P9">We proposed to improve the widely used gene signature scoring method suggested by Tirosh <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, which had been implemented in Seurat<sup><xref ref-type="bibr" rid="R11">11</xref></sup>, and with minor modifications in Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref></sup>. In brief, the Tirosh method computes the gene signature scores for each cell by subtracting a control expression from the signature genes’ expressions. The major drawback of the Tirosh signature scoring method comes from the procedure of choosing control genes using fixed binning of genes according to their average gene expression (default: 25 bins, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S1</xref>). As verified by our benchmarking, this procedure may create artifacts for the estimates of expression gain, specifically for highly expressed genes frequently used in gene signatures. Our proposed method, called Adjusted Neighborhood scoring (ANS), solved this issue by selecting control gene sets separately for each signature gene so that the averaged expression of the control gene set and the signature gene matches (<xref ref-type="sec" rid="S10">Methods</xref>). The ANS method was implemented in Python and R (package <ext-link ext-link-type="uri" xlink:href="https://github.com/lciernik/ANS_signature_scoring">https://github.com/lciernik/ANS_signature_scoring</ext-link>).</p></sec><sec id="S4"><title>Design of the benchmark</title><p id="P10">We benchmarked ANS and other gene signature scoring methods, including the original Tirosh method, assessed the stability of the signature scores, and highlighted the importance of the choice of control genes. We compared eight gene signature scoring methods: JASMINE<sup><xref ref-type="bibr" rid="R8">8</xref></sup> (using the likelihood or odds-ratio settings, Jasmine_LH and Jasmine_OR, respectively), UCell<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, the original method by Tirosh et al.<sup><xref ref-type="bibr" rid="R17">17</xref></sup> implemented in Seurat<sup><xref ref-type="bibr" rid="R11">11</xref></sup> (Seurat), a similar method implemented in Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref></sup> (Scanpy), its alternative that used all genes as control genes (Seurat_AG), an alternative that used least variable genes as control genes (Seurat_LVG), and our proposed method Adjusted Neighbourhood Scoring (ANS). Like Seurat and Scanpy, Seurat_AG and Seurat_LVG first compute the average expression of the genes, sort them in increasing order, and divide them into 25 equally sized expression bins. While Seurat_AG selects all genes from an expression bin as control genes, Seurat_LVG chooses genes with the smallest dispersion. Conversely, ANS avoids binning and selects control genes in an average-expression neighborhood closest to the signature genes’ average expression values (<xref ref-type="sec" rid="S10">Methods</xref>). We implemented all methods originally developed for the R language in Python (<xref ref-type="fig" rid="F1">Figure 1a</xref>) and showed their identical behavior (<xref ref-type="fig" rid="F1">Figure 1b</xref>, <xref ref-type="sec" rid="S10">Methods</xref>). The Python package complementing this work provides access to all implemented methods.</p><p id="P11">We benchmarked the methods in six scenarios (<xref ref-type="fig" rid="F1">Figure 1a</xref>, <xref ref-type="table" rid="T1">Table 1</xref>). In the first scenario, we showed the implication of control gene selection on gene signature scoring. In the second and third, we investigated the influence of the data composition and batch effects on scoring. In the fourth and fifth scenarios, we analyzed the impact of the variability in the gene signature length on the resulting scores. In the sixth scenario, we examined the scores produced by different methods when scoring multiple gene signatures and evaluated the performance of cell score-based classifiers to annotate cell types and cell states. The initial scenario involved a preprocessed dataset of peripheral blood mononuclear cells<sup><xref ref-type="bibr" rid="R20">20</xref></sup> (PBMC); the next four scenarios were carried out on preprocessed datasets of colorectal carcinoma<sup><xref ref-type="bibr" rid="R21">21</xref></sup> (CRC) and squamous cell carcinoma of the esophagus<sup><xref ref-type="bibr" rid="R1">1</xref></sup> (ESCC); the sixth scenario used PBMC scRNA-seq data<sup><xref ref-type="bibr" rid="R20">20</xref></sup> and scRNA-seq data from four cancer types: breast carcinoma<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (BRCA), high-grade serous ovarian cancer<sup><xref ref-type="bibr" rid="R23">23</xref></sup> (HGSOC), cutaneous squamous cell carcinoma<sup><xref ref-type="bibr" rid="R24">24</xref></sup>(cSCC), and lung adenocarcinoma<sup><xref ref-type="bibr" rid="R25">25</xref></sup> (LUAD) (<xref ref-type="sec" rid="S10">Methods</xref>).</p><p id="P12">We also evaluated the time requirements for the eight methods as a function of the increasing number of cells and the increasing number of genes in the signature (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S2</xref>). All methods exhibited linear scalability with dataset size. For short signatures (up to 10 genes), Seurat, Scanpy, and ANS performed the fastest (&lt;10 sec for 150,000 cells), while Seurat and Scanpy remained the quickest for longer signatures (1,000 genes). In contrast, UCell and Jasmine took approximately seven times longer, while ANS took about three times longer in this case. Nevertheless, these methods consistently operated within seconds to a few minutes, even with large signatures and datasets.</p></sec><sec id="S5"><title>Control genes selection bias in gene signature scoring</title><p id="P13">All scoring methods based on Tirosh <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, <italic>i.e</italic>., all methods except JASMINE and UCell, use control genes for gene signature scoring. Typically, genes whose average expressions are similar to the average expression of the signature gene are used as control genes. Consequently, these control genes exhibit a mean average expression, referred to as the mean control value, that is the closest approximation to the average expression of the signature gene itself. The selection of an optimal control set is crucial, as inappropriate selection can introduce a bias and lead to unreliable scores for all cells. We compared strategies for the control gene selection of the methods ANS, Seurat, Seurat_AG, and Seurat_LVG across diverse preprocessed subsets of cell subtypes within the PBMC dataset for the top expressed genes where the effects of the control gene selection were expected to be the most pronounced; we chose the 8% of genes with the highest average expression values corresponding to the last two bins of the Tirosh-based methods (<xref ref-type="fig" rid="F1">Figure 1c</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S3</xref>, <xref ref-type="sec" rid="S10">Methods</xref>). We scored each gene in the last two expression bins (top ~900 genes) for each scoring method. On homogeneous datasets, scores of single-gene signatures are expected to be distributed around zero. While we observed minimal score biases in the last but one expression bin, the last bin showed large biases in the score values for all published methods due to the significant variance of the genes’ average expressions. Whereas Seurat, Seurat_AG, and Scanpy first underestimated two-thirds of the gene scores and overestimated one third, Seurat_LVG overestimated almost all scores in the last expression bin (<xref ref-type="fig" rid="F1">Figure 1c</xref>). All methods showed notable score biases for the top fifty expressed genes; these genes get typically excluded from gene signatures by ANS due to the impossibility of constructing a valid control gene set. Overall, ANS induced the smallest bias and thus used the optimal control gene sets.</p></sec><sec id="S6"><title>The influence of cell type proportions, batch effects, signature length, and inclusion of irrelevant genes on gene signature scoring</title><p id="P14">The mean control values and, thus, the choice of control genes depend on the dataset composition of the tissue or sample analyzed. Consequently, when utilizing methods that employ control genes, we anticipated greater variability in gene signature scoring values when scoring was conducted on a per-sample basis compared to a scenario when all cells from all samples were assessed collectively.</p><p id="P15">To highlight this effect, we calculated scores of 100-gene signatures associated with the malignant cell phenotype of CRC and ESCC (<xref ref-type="sec" rid="S10">Methods</xref>). We compared the distributions of the mean scores per sample and cell type under two scenarios: when scoring was conducted on a per-sample basis and on all samples together (<xref ref-type="fig" rid="F1">Figure 1d</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4</xref>). We observed a reduction of score variance for all scoring methods and both CRC and ESCC datasets, except for Seurat_LVG and UCell in the ESCC dataset, when scoring was performed on cells of all the samples together (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S5</xref>), leading to more comparable score ranges over all samples. Additionally, we assessed how scoring on all samples together contributed to diminishing the batch effects for the Tirosh-based scoring methods. For this, we evaluated the differences in score distributions across two batches representing different sequencing chemistry, called SC3Pv2 and SC3Pv3 (<xref ref-type="fig" rid="F1">Figure 1d</xref>). Batch effects significantly affected the score values of all Tirosh-based scoring methods when the scoring procedure was performed on a per-sample basis. In contrast, we observed decreased distribution shifts between chemistry-related batches when scoring on all samples. Therefore, our results suggest that scoring should be performed on all cells in the dataset simultaneously for all methods using control gene sets, including ANS.</p><p id="P16">Next, we assessed scoring methods’ robustness to changes in the signature length using CRC and ESCC datasets. Methods were compared based on the minimum number of signature genes needed to perfectly classify malignant and non-malignant cells (AUCROC, <xref ref-type="sec" rid="S10">Methods</xref>). Most methods, including ANS, achieved perfect classification with only 12-15 top differentially expressed genes chosen on both datasets as genes with the highest log2FC and significant adjusted p-values (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4 and S6</xref>). The only outlier, Jasmine_OR, required ~11 times more genes for an accurate cell type annotation in CRC. The small length of these effective signatures might be due to the relative ease of distinguishing malignant from non-malignant cells, <italic>i.e</italic>., that the signatures contain genes with strong separating signals between the two populations. This can also be attributed to the signature selection process (<xref ref-type="sec" rid="S10">Methods</xref>).</p><p id="P17">To test the methods’ robustness to the presence of irrelevant genes in a signature, we progressively replaced genes in a “pure” 100-gene malignant signature with random genes (<xref ref-type="sec" rid="S10">Methods</xref>). All methods, including ANS and except Seurat_LVG, maintained high performance (AUCROC &gt; 0.9) with up to 85% noise, requiring only ~15 informative genes (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4 and S6</xref>). Seurat_LVG consistently underperformed, needing at least twice as many correct genes for comparable results in both datasets.</p></sec><sec id="S7"><title>Assessing score-range comparability for score-based cell type and state annotation</title><p id="P18">The most important application of gene signature scoring is to measure the activation of different transcriptional programs and use the scores to make statements about cells’ association with cell states or cell types. However, interpreting cell scores and assigning cells to states or types requires gene signatures that yield scores with high information quantity and comparable score ranges. To assess the information quantity and the comparability of score ranges produced by ANS and other scoring methods, we analyzed the accuracy of cell-type and cell-state annotation based on gene signature scores produced by different methods across four cancer datasets (BRCA, HGSOC, LUAD, and sCC) and four PBMC subsets<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. We used cell-type or cell-state-specific non-overlapping gene signatures provided with the datasets (cancer) or selected gene signatures based on a provided list of differentially expressed genes per subtype (PBMC dataset, <xref ref-type="sec" rid="S10">Methods</xref>)(<xref ref-type="supplementary-material" rid="SD1">Suppl. Table S1</xref>). The fairness of produced scores was estimated by evaluating the accuracy of an unsupervised cell annotation based on the argmax assignment of cells to states from signature scores. Additionally, we evaluated the information quantity of scores produced by each scoring method using a cross-validated supervised logistic regression predicting cell state based on signature scores (<xref ref-type="sec" rid="S10">Methods</xref>).</p><p id="P19">We observed that score-based cell annotation—labeling cells with the cell type or state corresponding to the highest scoring signature—was accurate for distinguishing cell types (B cells, monocytes, and NK cells) in the PBMC dataset using scores produced by most methods (<xref ref-type="fig" rid="F2">Figure 2a</xref>). All methods achieved high balanced accuracies ranging from 0.921 (Jasmine_OR) to 0.999 (Scanpy and UCell) and F1-scores from 0.958 (Seurat) to 0.999 (UCell), demonstrating robust performance in distinguishing these distinct cell types (<xref ref-type="supplementary-material" rid="SD1">Suppl. Table S2</xref>). Indeed, most scoring methods produced comparable score ranges, with the highest scores being observed for cells of matched cell type; JASMINE was an exception, showing overlapping ranges for B-cell and other signatures in B cells (<xref ref-type="fig" rid="F2">Figure 2a</xref>).</p><p id="P20">However, when we applied the score-based annotation approach to assigning cells to cell states—naive, intermediate, and memory B-cells—we revealed limitations in using scores produced by all methods except ANS. Indeed, ANS was the only approach to produce informative and comparable score ranges for matched cell types that can be used for cell state classification based on the cell assignment to the state with the highest score (<xref ref-type="fig" rid="F2">Figure 2b</xref>). Tirosh-based methods (Seurat, Seurat_AG, Seurat_LVG, and Scanpy) consistently scored highest for the B memory cell signature, regardless of the true cell type, resulting in poor labeling performance (<xref ref-type="fig" rid="F2">Figure 2c</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S7</xref>). UCell showed higher B memory cell scores than B-intermediate-cell scores when applied to B intermediate cells. Conversely, JASMINE scored highest for the B-intermediate-cell signature in B intermediate cells but failed to produce distinguishable score ranges for other cells.</p><p id="P21">To comprehensively evaluate this pattern, we expanded our analysis and assessed the performance of the score-based cell state classifier on four datasets of malignant cells with ground-truth assignments of cells to malignant cell states (BRCA, HGSOC, LUAD, and sCC) and two additional PBMC subsets comprising CD4 and CD8 cell state annotations. Across these six additional datasets, ANS maintained strong performance, providing unbiased gene signature scores that were useful for cell annotation, achieving the highest balanced accuracy in five cases (BRCA: 0.560, HGSOC: 0.638, cSCC: 0.843, CD4 T-cells: 0.645, CD8 T-cells: 0.823) and performing competitively in LUAD (0.897 vs. Scanpy’s 0.914)(<xref ref-type="fig" rid="F2">Figure 2f</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S7-S8, Suppl. Table S2</xref>).</p><p id="P22">We then compared the cell classification accuracy of the unsupervised score-based approach with a supervised approach of a trained score-based linear classifier. We refer to the cross-validated accuracy of the best linear classifier based on the gene signature scores as information quantity of the gene signatures (<xref ref-type="sec" rid="S10">Methods</xref>). Information quantity close to 1 corresponded to the perfect supervised annotation of cell states or types based on gene signature scores. Methods with original score label assignment performance close to the information quantity were considered to produce fair gene signatures within comparable ranges, indicating a small score scale imbalance. In this experiment on eight datasets, ANS consistently ranked among the best-performing methods, showing the closest alignment of balance accuracy of the unsupervised score-based annotation with information quantity across (<xref ref-type="fig" rid="F2">Figure 2d</xref>). Notably, ANS demonstrated substantially better performance for sCC, CD8, and B-cell subtype classification compared to other scoring methods.</p><p id="P23">Furthermore, across both cancer and PBMC datasets, ANS exhibited minimal scale imbalance measured as the difference between information quantity and balanced accuracy of score-based cell annotation, also with the smallest standard deviation, suggesting fairly comparable score ranges (<xref ref-type="fig" rid="F2">Figure 2e</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Table S2</xref>). While these results are based on non-overlapping gene signatures to avoid bias from redundant genes, similar outcomes were observed for signatures that shared certain genes (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S9-S10, Suppl. Table S3</xref>).</p><p id="P24">In conclusion, while all methods excel in discriminating distinct cell types based on gene signature scores, the task becomes significantly more challenging when discriminating signals from different cell states. ANS demonstrated the best performance and consistency across various cancer and healthy datasets by providing gene signature scores useful for unsupervised score-based cell annotation.</p></sec><sec id="S8"><title>Devising cancer cell-specific EMT signature: a case study for the ANS application</title><p id="P25">As we demonstrated the robustness and performance of the ANS method in the challenging scenario of gene signature scoring on related cell states, we chose to showcase the ability of ANS to help extract biologically relevant gene signatures in a similarly difficult setting. Specifically, we applied ANS to address the problem of the lack of malignant cell-specific EMT signature applicable across cancer types. The difficulty in constructing such a gene signature comes from the high similarity of transcriptional states of malignant EMT-exhibiting cells with malignant non-EMT cells, on the one hand, and with non-malignant mesenchymal cells, such as cancer-associated fibroblasts (CAFs), on the other hand. Building a cancer cell-specific signature for EMT would allow scoring bulk RNA-seq tumor datasets to quantify the degree of EMT transformation in human tumors while minimizing the bias induced by the presence of non-malignant cells of mesenchymal origin in the tumors.</p><p id="P26">Indeed, when we explored the behavior of previously published EMT signatures using the ANS scoring method on single cells from the ESCC<sup><xref ref-type="bibr" rid="R1">1</xref></sup>, lung adenocarcinoma<sup><xref ref-type="bibr" rid="R26">26</xref></sup> (LUAD_Xing), CRC<sup><xref ref-type="bibr" rid="R21">21</xref></sup> and breast carcinoma<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (BRCA) tumors, we observed that the pan-cancer EMT signatures, such as the Hallmark EMT<sup><xref ref-type="bibr" rid="R27">27</xref></sup>, the pEMT signature<sup><xref ref-type="bibr" rid="R28">28</xref></sup>, and five other EMT signatures<sup><xref ref-type="bibr" rid="R29">29</xref>–<xref ref-type="bibr" rid="R33">33</xref></sup>, resulted in extremely high scores in CAFs in addition to the mesenchymal-like (MES-like) malignant cells (<xref ref-type="fig" rid="F3">Figure 3a</xref> and <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S8</xref>). This bias was likely due to the high expression in CAFs of such mesenchymal markers as <italic>ACTA2, CDH2, FN1, SNAI2</italic>, and <italic>VIM</italic> for the Hallmark EMT signature<sup><xref ref-type="bibr" rid="R34">34</xref></sup>, and <italic>PDPN, TNC</italic>, and <italic>VIM</italic> for the pEMT signature<sup><xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R36">36</xref></sup>. The other cancer EMT gene signatures produced high scores also for other cell types, <italic>e.g</italic>., the signatures of Foroutan <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R32">32</xref></sup>, Gröger <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R29">29</xref></sup>, Mak <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R31">31</xref></sup>, and Tan <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R30">30</xref></sup> resulted in high scores for pericytes in CRC and ESCC, and the former also scored high in endothelial cells for all datasets (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S8</xref>).</p><p id="P27">To build a cancer cell-specific EMT signature, we leveraged two public scRNA-seq datasets, the ESCC and LUAD_Xing, for training and then validated the signature on the single cells of CRC and BRCA. To devise a cancer-specific EMT signature that scores high for MES-like malignant cells but low for non-malignant CAFs and malignant cells not undergoing EMT, we extracted genes with the abovementioned properties in ESCC and LUAD_Xing single-cell datasets (<xref ref-type="sec" rid="S10">Methods</xref>). The devised cancer cell-specific EMT signature included many known EMT-related genes. We found 8 of the 135 signature genes intersecting with the Hallmark EMT and the pEMT signatures (<xref ref-type="fig" rid="F3">Figure 3b</xref>). Moreover, 43 out of 135 genes appeared to be in at least one of the previously considered pan-cancer EMT signatures (<xref ref-type="supplementary-material" rid="SD1">Suppl. Table S4</xref>). By construction, the devised signature scored highly for the MES-like malignant cells in these two cancer types used for training (<xref ref-type="fig" rid="F3">Figure 3a</xref>). We observed its strong discriminative power on the validation datasets CRC and BREAST (<xref ref-type="fig" rid="F3">Figure 3a</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Table S5</xref>). The accuracy of our gene signature discriminating MES-like malignant cells versus all remaining cells measured with the area under the precision-recall curve (AUCPRC) on CRC and BRCA datasets was 0.701 and 0.511, respectively; it was slightly outperformed on CRC only by the gene signature proposed by Hollern <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R33">33</xref></sup> (AUCPRC 0.707) (<xref ref-type="supplementary-material" rid="SD1">Suppl. Table S5</xref>). However, this signature performed sub-optimally in our ESCC and LUAD_Xing training datasets (AUCPRC 0.028 versus 0.592 of our gene signature in ESCC, and 0.244 versus 0.513 in LUAD_Xing).</p><p id="P28">To investigate the clinical significance of the proposed cancer cell-specific EMT signature, we used bulk RNA-seq and clinical information from The Cancer Genome Atlas (TCGA) datasets. Specifically, we were interested in analyzing the link between the extent of cancer cells expressing EMT and the molecular subtypes of analyzed samples. Calculation of cancer cell-specific phenotypes using bulk RNA-seq data poses a significant advantage in cases when corresponding single-cell data is not available for a number of reasons. First, since EMT plays a crucial role as one of the main drivers of tumor plasticity and invasiveness, accurately measuring its activity in both TME and cancer cells is essential for designing successful targeted therapies. Second, an association between the cancer cell-specific EMT activity and histological subtypes may highlight the role of the cancer cell EMT phenotype in promoting, likely more invasive, molecular subtypes, and expand our understanding thereof. We selected 24 TCGA datasets for which more than one histological subtype was available, scored the cancer cell-specific EMT signature, and associated the scores with histological subtypes (independently in each cancer type). We found our signature to be significantly associated with the histological subtype of 10 cancer datasets (<xref ref-type="fig" rid="F3">Figure 3c</xref>, <xref ref-type="supplementary-material" rid="SD1">Supp. Table S6</xref>). These results highlight the biological relevance of the proposed signature and its potential utility in further exploration of cancer molecular subtypes.</p><p id="P29">This example demonstrated how gene signature scoring on single-cell data could be applied to design meaningful gene signatures and annotate cells according to their transcriptional states for further biological exploration.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P30">In the present work, we developed a deterministic and robust gene signature scoring method, Adjusted Neighborhood Scoring (ANS), which improves the approach introduced by Tirosh <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R17">17</xref></sup>. In contrast to the Tirosh approach, ANS avoids binning genes by mean gene expression values and, by construction, chooses the optimal control gene sets to normalize gene expression values for technical effects. We demonstrated that the issue of sub-optimal stability of ANS and all methods based on the Tirosh approach, such as Scanpy and Seurat, when scoring gene signatures on samples with variable proportions of different cell types, can be solved by scoring all cells simultaneously using all samples in the dataset.</p><p id="P31">We compared ANS with other scoring methods developed for single-cell data to demonstrate the robustness and stability of the proposed scoring procedure. All scoring methods were shown to be stable upon scoring small signatures, and to be robust against noise, allowing up to 85% of noise in the signature if the remaining genes belong to the most differentially expressed gene discriminating the cell types tested. ANS was the top-performing approach in terms of providing high information quantity and comparable ranges of calculated scores for matched gene signatures and cell types. The remaining Tirosh-based scoring approaches showed high information quantity in their scores. However, they suffered from large scale imbalances, possibly influenced by the biased selection of the control sets and lack of score normalization. We also showed that scale imbalance could be avoided in Tirosh-based scoring methods through unsupervised clustering, converting signature scores to cluster assignments correlating with the matched cell state. Nonetheless, it is worth noting that the underlying assumption of exclusive state activation within individual cells could be limiting in certain situations. Furthermore, we have included all scRNA-seq signature scoring techniques within a signature scoring package, enabling the utilization of methods originally implemented in R in Python.</p><p id="P32">It is important to emphasize that gene signature scoring is only as reliable as the provided signatures. To generate confident and biologically meaningful scores, the signature must accurately capture the biological phenotype of interest. This is especially important when using signature scores for cell labeling, as an unreliable signature can result in misclassification. Poor gene signatures inevitably lead to poor labeling performance, as observed in BRCA, HGSOC, and CD4 signatures (<xref ref-type="fig" rid="F2">Figure 2d</xref>). When using related gene signatures, scores may appear similar, which makes the selection of optimal control genes a critical step for distinguishing between closely related states and ensuring accurate results. ANS fulfills this need with a reliable control gene selection strategy, ensuring greater accuracy compared to other tested methods.</p><p id="P33">We showcased the use of the ANS scoring method to derive a gene signature specific to MES-like malignant cells that we validated in CRC and BRCA. Building a cancer cell-specific signature for EMT could allow scoring bulk RNA-seq tumor datasets to quantify the degree of EMT transformation in human tumors while minimizing the bias induced by the presence of non-malignant cells of mesenchymal origin in the tumors. Our ESCC- and LUAD_Xing-specific cancer EMT signature outperformed others in distinguishing MES-like malignant cells from CAFs across all datasets. When comparing MES-like malignant cells with other malignant cells, our signature ranked among the top four in terms of AUCPR for ESCC, LUAD_Xing, and CRC but placed sixth for BRCA (<xref ref-type="supplementary-material" rid="SD1">Suppl. Table S4</xref>). Notably, the Hallmark EMT<sup><xref ref-type="bibr" rid="R27">27</xref></sup> signature displayed the highest discriminatory power in this context. The difficulty in discrimination may arise from the signature’s reliance on epithelial markers, lacking strong mesenchymal-related markers, which results in closer scores between malignant epithelial cells. Our cancer MES-like signature included a transcriptional factor, which so far has not been considered in any of the used pan-cancer EMT signatures: <italic>PITX1. PITX1</italic> encodes a member of the RIEG/PITX homeobox family and plays a crucial role in organ development and left-right asymmetry<sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup>. Previous research on <italic>PITX1</italic> in cancer has revealed cancer-type-specific effects. While upregulation of <italic>PITX1</italic> has been shown to be associated with tumor progression in lung adenocarcinoma<sup><xref ref-type="bibr" rid="R39">39</xref></sup>, kidney renal clear cell carcinoma<sup><xref ref-type="bibr" rid="R40">40</xref></sup>, breast<sup><xref ref-type="bibr" rid="R41">41</xref></sup>, epithelial ovarian<sup><xref ref-type="bibr" rid="R42">42</xref></sup>, and prostate cancer<sup><xref ref-type="bibr" rid="R43">43</xref></sup>, interestingly, in other cancer types, such as melanoma<sup><xref ref-type="bibr" rid="R44">44</xref></sup>, ESCC <sup><xref ref-type="bibr" rid="R45">45</xref></sup>, osteosarcoma<sup><xref ref-type="bibr" rid="R46">46</xref></sup> and head and neck squamous cell carcinoma<sup><xref ref-type="bibr" rid="R47">47</xref></sup>, down-regulation of <italic>PITX1</italic> has been found to enhance tumor progression. Other EMT-related genes exclusively present in our signature included two long-non-coding RNA genes: <italic>ABHD11-AS1</italic> and <italic>BCYRN1. ABHD11-AS1</italic> has previously been suggested as a prognostic biomarker for pancreatic cancer<sup><xref ref-type="bibr" rid="R48">48</xref></sup>, while <italic>BCYRN1</italic> was shown to promote cell migration and invasion in lung and colorectal cancers<sup><xref ref-type="bibr" rid="R49">49</xref>–<xref ref-type="bibr" rid="R52">52</xref></sup>. Additionally, the protein-coding genes <italic>FAM83A, ITGA3, ITGB4, L1CAM, MUC16</italic>, and <italic>SAA1</italic> have been reported to promote cancer progression in CRC<sup><xref ref-type="bibr" rid="R53">53</xref>,<xref ref-type="bibr" rid="R54">54</xref></sup>, lung cancer<sup><xref ref-type="bibr" rid="R55">55</xref>,<xref ref-type="bibr" rid="R56">56</xref></sup>, head-neck squamous cell carcinoma<sup><xref ref-type="bibr" rid="R57">57</xref>,<xref ref-type="bibr" rid="R58">58</xref></sup>, breast<sup><xref ref-type="bibr" rid="R59">59</xref></sup>, ovarian<sup><xref ref-type="bibr" rid="R60">60</xref>,<xref ref-type="bibr" rid="R61">61</xref></sup> and endometrial cancer<sup><xref ref-type="bibr" rid="R62">62</xref></sup>. Lastly, our analysis has revealed that the identified cancer cell-specific EMT signature corresponds to histological subtypes in several TCGA datasets, highlighting the potential role of EMT-expressing cancer cells in their molecular characteristics. This finding highlights the biological significance of the proposed signature; however, future work is needed to verify its clinical applicability.</p><p id="P34">We acknowledge the limitations inherent in our study. Due to the exclusive assignment of each cell to a specific cell type and the difficulty in capturing cells transitioning between states—such as from naive B cells to memory B cells—our benchmarking did not include evaluating performance for such transitions. An alternative approach for such scenarios could involve associating scores with cell trajectories. However, our primary objective in this work was to assess the scoring specifically for cell annotation. Also, when applying our method to establish the cancer-specific EMT signature in the three datasets, LUAD_Xing, ESCC, and CRC, we relied on the selection of the cancer cells expressing previously published EMT-related genes. In contrast, in the basal-like breast cancer dataset, we relied on the original annotation of cell states and used the GM3 state strongly associated with EMT to label the EMT-presenting malignant cells. The selection procedure might have biased the downstream analysis.</p><p id="P35">In summary, this work presents an improved version of the scoring method proposed by Tirosh<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, called Adjusted Neighborhood Scoring (ANS). ANS is a deterministic and robust scoring method that outputs comparable scores for multiple gene expression signatures, which can be used for cell type and cell state annotation in an unsupervised way. The ANS method is implemented in a user-friendly way to be integrated into R and Python single-cell analysis pipelines. By employing this technique, one can confidently evaluate cellular programs and develop highly specific cell state signatures, as exemplified by the proposed cancer EMT signature.</p></sec><sec id="S10" sec-type="methods"><title>Methods</title><sec id="S11"><title>Dataset and Preprocessing</title><p id="P36">We used eight different single-cell RNA sequencing (scRNA-seq) datasets, comprising seven cancer datasets and one peripheral blood mononuclear cell (PBMC) dataset<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. For control genes selection and basic robustness experiments, we utilized a squamous cell carcinoma of the esophagus<sup><xref ref-type="bibr" rid="R1">1</xref></sup> (ESCC, 54 samples) and a colorectal carcinoma<sup><xref ref-type="bibr" rid="R21">21</xref></sup> (CRC, 60 samples) dataset. To assess signature score range comparability, we considered malignant cells from four cancer datasets: breast carcinoma<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (BRCA, 20 samples), high-grade serous ovarian cancer<sup><xref ref-type="bibr" rid="R23">23</xref></sup> (HGSOC, 134 samples), cutaneous squamous cell carcinoma<sup><xref ref-type="bibr" rid="R24">24</xref></sup>(cSCC, 7 samples), and lung adenocarcinoma<sup><xref ref-type="bibr" rid="R25">25</xref></sup> (LUAD, 9 samples), as well as the PBMC dataset consisting of 24 samples collected at three different time points from eight patients. The case study included the ESCC and CRC datasets, along with another lung adenocarcinoma dataset<sup><xref ref-type="bibr" rid="R26">26</xref></sup> (LUAD_Xing, 19 samples including 12 from subsolid-nodules and 7 from primary lung adenocarcinoma) and the 7 basal-like samples from BRCA. Cell type distributions for each sample used in the case study are presented in <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S12</xref>.</p><p id="P37">Preprocessing scRNA-seq data is crucial to address inherent biases and enable downstream analysis. Cancer datasets and the PBMC dataset were preprocessed differently. For the cancer datasets, except HGSOC,we used the preprocessing module of <monospace>CanSig<sup><xref ref-type="bibr" rid="R63">63</xref></sup></monospace> with the default parameter as the first preprocessing step (<ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CanSig">https://github.com/BoevaLab/CanSig</ext-link>). In brief, we applied standard quality control metrics and removed potential misannotated cells using CNV inference; the preprocessing steps are extensively described in the original paper. Additionally, we filtered genes based on a minimum expression in 1% of cells, and normalized cell reads using a shift logarithm log<sub>2</sub>(x+1) with the mean total raw count per cell as the target sum, as described and implemented by Ahlmann-Eltze and Huber<sup><xref ref-type="bibr" rid="R64">64</xref></sup>. For HGSOC, due to its size, we directly applied the 1% gene filtering and log-normalization on the cancer cells from the GEO data (GSE180661), skipping the CanSig preprocessing step. We demonstrated that these preprocessing choices are robust, as replacing the CanSig preprocessing pipeline with alternative approaches (e.g., Curated Cancer Cell Atlas preprocessing, <ext-link ext-link-type="uri" xlink:href="https://www.weizmann.ac.il/sites/3CA/">https://www.weizmann.ac.il/sites/3CA/</ext-link>) or omitting it did not significantly affect the relative performance of the scoring methods (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S13-S15</xref>). Regarding the PBMC dataset, we created several sub-datasets based on cell type and state annotations. The first sub-dataset consisted of B-cells, monocytes, and natural killer cells, while the second subdataset contained B-cell states (B-naive, B-intermediate, and B-memory cells). The third and fourth sub-datasets consist of CD4 T-cell states (CTL, naive, proliferating, TCM, TEM, and Treg) and CD8 T-cell states (naive, proliferating, TCM, TEM).</p><p id="P38">All sub-datasets were preprocessed as follows: Initially, we filtered low-quality reads according to the guidelines provided in chapter 6.3 of the book “Single-cell Best Practices” by Heumos <italic>et al</italic>.<sup><xref ref-type="bibr" rid="R65">65</xref></sup>. A threshold of 5 median absolute deviations (MADs) was selected for filtering covariates, including total counts, number of genes with positive counts in a cell, and the percentage of mitochondrial counts. Similar to the cancer datasets, we filtered genes based on a minimum expression in 1% of cells and normalized the cell reads using the shift logarithm with the mean total raw count per cell as the target sum.</p></sec><sec id="S12"><title>Gene signature selection for malignant cells in benchmark</title><p id="P39">To select gene signatures for malignant cells in CRC and ESCC, we adopted the following approach. To address data imbalance caused by varying sample sizes (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S11</xref>), we bulkified the datasets per sample using the method <monospace>get_pseudobulk</monospace> from the Python package decoupleR<sup><xref ref-type="bibr" rid="R66">66</xref></sup> with the parameters <monospace>mode=sum</monospace>, <monospace>min_cells=10</monospace>, and <monospace>min_counts=1000</monospace>. Bulkifikation of the samples prevented the dominance of genes expressed in the majority sample and minimized batch effects. As described in the “Pseudo-bulk functional analysis” tutorial of <monospace>decoupleR<sup><xref ref-type="bibr" rid="R66">66</xref></sup></monospace> (version 1.4.0), we further filtered genes by expression using the default parameters. We then applied the <monospace>PyDESeq2<sup><xref ref-type="bibr" rid="R67">67</xref></sup></monospace> (version 0.3.3) workflow (Python version of <monospace>DESeq2<sup><xref ref-type="bibr" rid="R68">68</xref></sup></monospace>), a differential gene expression analysis (DGEX) tool, to the bulkified samples. Using <monospace>DESeq2</monospace>, we identified genes with significant differential expression (log<sub>2</sub>FC &gt; 2 and adjusted p-value &lt; 0.01) between malignant and non-malignant cells. This process helped us pinpoint gene signatures strongly associated with the malignant cell phenotype in CRC, and ESCC, which were used during the benchmark.</p></sec><sec id="S13"><title>Control genes selection in Tirosh-based gene signature scoring and ANS</title><p id="P40">The methods implemented in the scRNA-seq analysis packages <monospace>Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref></sup></monospace> (in Python) and <monospace>Seurat<sup><xref ref-type="bibr" rid="R11">11</xref></sup></monospace> (in R) were built upon the procedure first described by Tirosh <italic>et al</italic>.<sup><xref ref-type="sec" rid="S17">17</xref></sup> Here, we recall this procedure in a formal manner. Let <inline-formula><mml:math id="M1"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the preprocessed expression matrix for <italic>n</italic> cells and <italic>p</italic> genes, generally representing log-transformed normalized read counts. Let <italic>S</italic>={<italic>s</italic><sub>1</sub>,…<italic>s</italic><sub><italic>m</italic></sub>} be a given gene signature, <italic>i.e</italic>., a set of <italic>m</italic> genes. Let <inline-formula><mml:math id="M2"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> be the average expression vector for each gene <italic>i</italic> over all cells ordered by increasing average expression (i.e., <inline-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for any <italic>i</italic>).</p><p id="P41">In Tirosh-based gene signature scoring methods, <inline-formula><mml:math id="M4"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mstyle></mml:math></inline-formula> is split into 25 equally sized bins, called expression bins. For each signature gene <italic>s</italic>, we sample <italic>c</italic> (control size) genes from <italic>s</italic>’s expression bin. Let <italic>C</italic><sub><italic>s</italic></sub> be the set of control genes for the signature gene <italic>s</italic>. The score for a cell <italic>j</italic> is then computed as follows: <disp-formula id="FD1"><mml:math id="M5"><mml:mrow><mml:msub><mml:mrow><mml:mtext>score</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munder><mml:mrow><mml:mi>∑</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:mfrac><mml:munder><mml:mrow><mml:mi>∑</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P42">In this work, we kept the main idea of the scoring approach proposed by Tirosh <italic>et al</italic>. but suggested and validated three alternatives to select control genes.</p><p id="P43">When implementing the first two alternatives, we preserved the gene binning approach. In the “all genes as control genes” alternative (Seurat_AG), we selected all non-signature genes from an expression bin as control genes. Note that Seurat_AG was not using the control genes size parameter. In the Least Variable control Genes alternative (Seurat_LVG), we first computed the least variable genes for each expression bin. The least variable genes were calculated with Scanpy’s <monospace>highly_variable_genes<sup><xref ref-type="bibr" rid="R69">69</xref></sup></monospace> method (flavor ‘seurat’) and selected by taking the <italic>c</italic> genes with the smallest dispersion.</p><p id="P44">In the third alternative, called Adjusted Neighborhood scoring (ANS), the control genes for a signature gene are selected based on the average expression neighborhood. Let <inline-formula><mml:math id="M6"><mml:mrow><mml:mover accent="true"><mml:mtext mathvariant="bold">g</mml:mtext><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> be equal to <inline-formula><mml:math id="M7"><mml:mrow><mml:mover accent="true"><mml:mtext mathvariant="bold">g</mml:mtext><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, but excludes the signature genes <italic>S</italic>. Let <inline-formula><mml:math id="M8"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the set of windows of size <italic>c</italic> (control size) of <inline-formula><mml:math id="M9"><mml:mrow><mml:mover><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>g</mml:mi></mml:mstyle><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. For each signature gene <italic>s</italic>, we computed the control set as follows: <disp-formula id="FD2"><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:mfrac><mml:munder><mml:mrow><mml:mi>∑</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P45">In other words, for each signature gene, we selected <italic>c</italic> control genes around this gene whose average mean expression closely matched the mean expression of the signature gene. Of note, ANS excluded signature genes within the <inline-formula><mml:math id="M11"><mml:mrow><mml:mfrac><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> genes with the highest average expression to avoid invalid control gene selection.</p></sec><sec id="S14"><title>Evaluation of scoring methods for score-based cell type and cell state annotation</title><p id="P46">We performed unsupervised cell type/state annotation using gene signature scoring in all experiments. For a dataset with <italic>n</italic> signatures associated with <italic>n</italic> cell types/states, we assigned cell identity based on the highest scoring signature (argmax). Performance was assessed using <monospace>scikit-learn<sup><xref ref-type="bibr" rid="R70">70</xref></sup></monospace> (version 1.2.0.) metrics: AUCROC for balanced datasets, AUCPRC for unbalanced datasets, along with balanced accuracy and weighted F1-score.</p></sec><sec id="S15"><title>Scoring Methods in R and Python</title><p id="P47">We implemented the R methods UCell (<ext-link ext-link-type="uri" xlink:href="https://github.com/carmonalab/UCell">https://github.com/carmonalab/UCell</ext-link>) and JASMINE (<ext-link ext-link-type="uri" xlink:href="https://github.com/NNoureen/JASMINE">https://github.com/NNoureen/JASMINE</ext-link>), as well as the original method proposed by Tirosh et al.<sup><xref ref-type="bibr" rid="R17">17</xref></sup>, in Python. Additionally, we provided the ANS method in both Python and R. We showed that the scoring methods yield identical scores for both Python and R. We selected a 100-gene signature for malignant cells based on the genes with the lowest adjusted p-value and the highest log<sub>2</sub>FC. We then scored this signature on preprocessed datasets of two cancer types: CRC and ESCC. To ensure consistency, we converted these datasets into <monospace>SingleCellExperiments<sup><xref ref-type="bibr" rid="R71">71</xref></sup></monospace> and employed the original R versions of the scoring methods. Notably, the R implementation of the Seurat method based on the original version of Trisoh <italic>et al</italic>., known as <monospace>AddModuleScore<sup><xref ref-type="bibr" rid="R72">72</xref></sup></monospace>, is included in the scRNA-seq package <monospace>Seurat<sup><xref ref-type="bibr" rid="R20">20</xref></sup></monospace>. To evaluate the concordance between the R and Python scores, we computed the Pearson correlation coefficient using the <monospace>scipy</monospace> package<sup><xref ref-type="bibr" rid="R73">73</xref></sup> (version 1.9.3) in Python (<xref ref-type="fig" rid="F1">Figure 1b</xref>). The implementations can be found in our software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/lciernik/ANS_signature_scoring">https://github.com/lciernik/ANS_signature_scoring</ext-link>).</p></sec><sec id="S16"><title>Benchmark experiments</title><p id="P48">In the first part of the study, we compared the properties and resistance to influencing factors of eight gene signature scoring methods: JASMINE<sup><xref ref-type="bibr" rid="R8">8</xref></sup> using the likelihood or odds-ratio (Jasmine_LH and Jasmine_OR), UCell<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, the original method by Tirosh et al.<sup><xref ref-type="bibr" rid="R17">17</xref></sup> implemented in Seurat<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup> (Seurat), the method implemented in Scanpy<sup><xref ref-type="bibr" rid="R9">9</xref></sup> (Scanpy), Seurat using all genes as control genes (Seurat_AG), Seurat using the least variable genes as control genes (Seurat_LVG), and our proposed method Adjusted Neighbourhood Scoring (ANS). Unless stated differently, we chose signatures of desired lengths associated with the malignant cell phenotype for the cancer datasets CRC and ESCC. This selection was based on identifying genes with the smallest adjusted p-value and the largest log<sub>2</sub>FC.</p></sec><sec id="S17"><title>Control gene selection bias on Tirosh-based gene signature scoring</title><p id="P49">The Tirosh-based scoring methods rely on the selection of control genes. However, Seurat, Seurat_AG, Seurat_LVG, and Scanpy can introduce biases in scoring when there is substantial variability in gene expression averages within expression bins, which is especially visible in the top 8% of the highest expressed genes (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S1</xref>). The ANS method was motivated to reduce the issue of bias induced by control genes. We compared the strategies for the control gene selection of the methods ANS, Seurat, Seurat_AG, and Seurat_LVG across the four preprocessed single-cell-type PBMC sub-datasets: B memory kappa, CD8 TM2, CD14 Mono, and NK 3 (Dataset preprocessing in <xref ref-type="sec" rid="S10">Methods</xref>). For each dataset, we scored each gene in the top 8% of the highest expressed genes and, thus, converted the expression matrix to a score matrix. On homogeneous datasets, scores of a gene are expected to be distributed around zero. We visualized the mean scores and standard variation for each gene in increasing average expression order with the <monospace>lineplot</monospace> function of the plotting package <monospace>searborn<sup><xref ref-type="bibr" rid="R74">74</xref></sup></monospace> (<xref ref-type="fig" rid="F1">Figure 1c</xref>, <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S3</xref>).</p></sec><sec id="S18"><title>The influence of the cell type proportions and batch effects on gene signature scoring</title><p id="P50">The two following experiments explored the influence of dataset composition on gene signature scoring. The first experiment investigated the influence of different cell type proportions. The second experiment tested the influence of batch effects on scoring methods. Both experiments used the preprocessed CRC dataset and a 100-gene signature for malignant cells with the smallest adjusted p-values and the highest log<sub>2</sub>FCs. The CRC dataset contains samples sequenced with two different sequencing chemistries. We used the different sequencing chemistries as surrogates for batch effects. We scored each sample individually and the entire dataset. For each scoring method, we averaged the cell scores for each sample, cell type (malignant or non-malignant), scoring mode (scoring samples individually or all together), and sequencing chemistry (SC3Pv2 or SC3Pv3). We compared the variance between the sample score averages for each scoring method and scoring mode in the first experiment and observed reduced or equal variance when scoring on the entire dataset. In order to evaluate the impact of batch effects, we utilized Mann-Whitney U testing to compare the sample score averages of malignant cells between the two sequencing chemistries for each scoring method and scoring mode. We used the Python package <monospace>statannotations<sup><xref ref-type="bibr" rid="R75">75</xref></sup></monospace> (version 0.4.4.) to compute the Mann-Whitney U tests and add statistical annotations in <xref ref-type="fig" rid="F1">Figure 1d</xref>. Scoring samples individually showed significant differences in score ranges between chemistries. We performed identical experiments on the preprocessed ESCC dataset, excluding the batch effect component because of using uniform sequencing chemistries for all samples in those datasets (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4</xref>).</p></sec><sec id="S19"><title>The influence of signature length on gene signature scoring</title><p id="P51">The next experiment aimed to assess the robustness of scoring methods to small signatures. Specifically, we sought to determine the minimum number of genes necessary to achieve perfect discrimination between malignant and non-malignant genes using scores, thereby enabling binary classification. For each scoring method, we followed a systematic approach. We began by selecting a base signature for the malignant phenotype. Subsequently, we removed genes for which a valid control set could not be constructed, specifically those belonging to the <inline-formula><mml:math id="M12"><mml:mrow><mml:mfrac><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> smallest or highest expressed genes. The remaining genes were then sorted based on ascending adjusted p-value and descending log<sub>2</sub>FC. We iterated over the signature to ascertain the number of genes required, progressively expanding the range of elements considered from the initial subset containing only the first element until the final iteration encompassing the entire list. Utilizing the methodology outlined in the Method section <italic>Evaluation of scoring methods</italic>, we computed the area under the receiver operating characteristic curve (AUCROC) for each signature length, using both the scores and malignancy annotations. We ceased computing as soon as an AUCROC value of 1 was achieved. We conducted the analysis for the preprocessed CRC and ESCC datasets (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4 &amp; S6</xref>).</p></sec><sec id="S20"><title>Robustness to noise in gene expression signature</title><p id="P52">To compare the robustness of the gene signature scoring methods to noise, we utilized a 100-gene base signature, which achieved an AUCROC of 1 for all scoring methods and iteratively replaced genes by noise. We selected noise genes based on their adjusted p-value &gt; 0.01 and their |log2FC| &lt;= 0.5 during DGEX, indicating that these genes lacked statistical significance in distinguishing malignant and non-malignant cells. During each simulation run, we iteratively and randomly substituted the signature genes with noise genes, starting from the pure signature and progressing until the entire signature consisted of noise genes. We conducted 20 simulation runs for each gene signature scoring method to ensure comprehensive results. The experiment was performed on preprocessed CRC and ESCC datasets (<xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S4 &amp; S6</xref>).</p></sec><sec id="S21"><title>Comparability of signature score ranges for cell type and state annotation</title><p id="P53">To assess the information quantity and ranges of scores when scoring for multiple signatures, we considered unsupervised and score-based cell type and state annotation of four cancer datasets (BRCA, sCC, HGSOC, LUAD) and four PBMC dataset subsets. As previously mentioned, only malignant cells from cancer datasets have been used for the annotation task. We used cancer cell state signatures published with the datasets. For the PBMC datasets, we constructed cell type-/ state-specific signatures using differential gene expression data accompanying the scRNA-seq dataset (<ext-link ext-link-type="uri" xlink:href="https://atlas.fredhutch.org/nygc/multimodal-pbmc/">https://atlas.fredhutch.org/nygc/multimodal-pbmc/</ext-link>). The PBMC dataset annotates cells at three levels of granularity: level one for broad cell types, level two for intermediate subtypes, and level three for the most detailed subtypes. For each selected cell type in our PBMC subset datasets, we built signatures by identifying all corresponding level-3 subtypes and selecting differentially expressed genes (DEGs) with log2 fold change &gt; 0.05 and p-value &lt; 0.01. We created the final signature by combining DEGs from these level-3 subtypes through set union operations. When comparing overlapping versus non-overlapping signatures, we additionally created a version where genes appearing in multiple cell type signatures were removed, as these shared genes could bias scoring across cells.</p><p id="P54">For each dataset, we calculated scores for every cell using all signatures and scoring methods, each signature being associated with a distinct cell type/state (score distributions in <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S8</xref>). We assigned each cell to the state associated with that cell’s highest-scoring signature (argmax), enabling unsupervised annotation.</p><p id="P55">To evaluate the information content within the scores, we employed scikit-learn’s (v1.2.0) cross-validated supervised logistic regression (LogisticRegressionCV with C=None and stratified k-fold cross-validation where k=10, random_state=42) to assess the predictive power of the scores. We used balanced accuracy and weighted F1-score metrics to evaluate both supervised and unsupervised approaches. We defined scale imbalance as the difference between the cross-validated supervised classification performance and unsupervised score-based annotation performance. Results for non-overlapping and overlapping signatures are presented in <xref ref-type="supplementary-material" rid="SD1">Suppl. Tables S2 and S3</xref>, respectively.</p></sec><sec id="S22"><title>Case study: selection of cancer EMT cells and cancer-specific EMT signature establishment</title><p id="P56">For the entire case study, we used ANS for evaluation with control sets of size c=100. The generation of the cancer-specific EMT signature consisted of two main steps. In the first step, we classified the malignant cells as EMT-expressing or non-expressing. Based on this classification, we explored the genetic differences between these two groups and between EMT cancer cells and cancer-associated fibroblasts.</p></sec><sec id="S23"><title>Classification of cancer EMT cells</title><p id="P57">As a first step in the signature establishment, we selected cancer cells expressing EMT, called cancer EMT cells. We computed scores for ESCC with the dataset-specific mesenchymal signature<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. We scored the entire dataset and the subset of malignant cells. Cancer cells being within the 10% highest scoring cells on the entire dataset and in the subset were classified as cancer EMT cells. The 3’860 cancer EMT cells out of 41’399 cancer cells (9.32%) and 178’109 total cells (2.17%), stem from 53 out of 54 samples. For LUAD_Xing and CRC, no dataset-specific mesenchymal signatures were reported. Therefore, we selected the cancer cells expressing EMT as follows. We scored the datasets for seven pan-cancer EMT signatures: Hallmark EMT signature <sup><xref ref-type="bibr" rid="R27">27</xref></sup>, pEMT gene module <sup><xref ref-type="bibr" rid="R28">28</xref></sup>, and five other EMT signatures <sup><xref ref-type="bibr" rid="R29">29</xref>–<xref ref-type="bibr" rid="R33">33</xref></sup>. The pan-cancer EMT signatures were found on EMTome <sup><xref ref-type="bibr" rid="R76">76</xref></sup>. For each pan-cancer signature, we ranked the cancer cells by ANS scores and computed for each cell the median rank. Finally, 10% of cancer cells with the smallest median signature ranks were classified as cancer EMT cells. We selected the median to avoid outlier ranks of the pan-cancer signature. For BRCA, we used the program labels provided by the original paper<sup><xref ref-type="bibr" rid="R22">22</xref></sup> and excluded cells falling in the “grey zone” of the EMT program expression (“GM3” in the original paper). We considered only samples assigned to the “Basal” subtype and defined the “grey zone” to be cells not labeled with “GM3”, but having a signature score for GM3 above 0.15 (scoring was applied on all samples similar in the original paper). In the LUAD_Xing dataset, 822 out of 8’205 cancer (10.02%) and 55’659 total (1.48%) cells were classified as EMT. All 19 samples contained cancer EMT cells. In the CRC dataset, 4’328 out of 43’252 cancer (10.01%) and 140’090 total (3.09%) cells were classified as cancer EMT cells distributed over all 60 samples. In the BRCA dataset, 2031 out of 5115 cancer (39,71%) and 27458 total (7,40%) cells were classified as cancer EMT cells distributed over all 7 samples. Dataset compositions are shown in <xref ref-type="supplementary-material" rid="SD1">Suppl. Figure S8</xref>.</p></sec><sec id="S24"><title>Gene signature refinement with scores of single signature genes</title><p id="P58">Gene signature refinement aims to remove genes from a signature to achieve a higher discriminating power of the signature scores. We mainly used gene signature refinement in the case study, however, it could be applied to any signature. During the refinement of a signature associated with a subset of cells, gene signature scoring is applied to each signature gene individually. A signature gene remained in the signature only if the scores for the desired subset of cells were significantly higher than those for another subset of interest. To test for distributional shifts, we used the Mann-Whitney U (<monospace>scipy</monospace>, version 1.9.3) with Benjamini-Hochberg correction for p-values (<monospace>statsmodels</monospace>, version 0.13.5)) with <monospace>alpha</monospace> 1e-5. The process required available cell annotations for the desired subsets of cells.</p></sec><sec id="S25"><title>Establishment of a cancer-specific EMT signature in ESCC and LUAD_Xing</title><p id="P59">The signature establishment consisted of finding differentially expressed genes between cancer cells expressing EMT and CAFs as well as cancer cells not expressing EMT in ESCC and LUAD_Xing. The cancer EMT cell classification for all datasets is provided in the <xref ref-type="supplementary-material" rid="SD1">supplementary information</xref>. We first started by finding a cancer-specific signature for ESCC, then found one for LUAD_Xing. Finally, we unioned the ESCC and LUAD_Xing-specific cancer EMT signature and refined it again on ESCC. For differential gene expression (DGEX) analysis between two cell groups of interest, we used Wilcoxon rank-sum (Mann-Whitney U) tests <sup><xref ref-type="bibr" rid="R77">77</xref></sup> with tie correction and Benjamini-Hochberg correction implemented in Scanpy’s <monospace>rank_genes_groups</monospace>.</p><sec id="S26"><title>Cancer-specific EMT signature for ESCC</title><p id="P60">First, we created two subsets of the ESCC dataset: cancer EMT cells and CAFs and all cancer cells. Let <italic>A</italic> be the set of DGEX genes (<italic>logFC</italic> ≥ 2 and an adjusted p-value &lt; 0.001) between cancer EMT cells and CAFs. Let <italic>B</italic> be the set of DGEX genes (<italic>logFC</italic>≥1.5 and an adjusted p-value &lt; 0.001) between cancer EMT cells and cancer cells not expressing EMT. We joined sets <italic>A</italic> and <italic>B</italic>, called gene set <italic>C</italic>, and removed all genes from <italic>C</italic> that are DGEX (<italic>logFC</italic> ≥ 2 and an adjusted p-value &lt; 0.001) in T- and Myeloid cells versus cancer EMT cells. The reduced gene set <italic>C</italic>, called gene set <italic>D</italic>, scored high for many cancer cells and thus required more refinement to distinguish the cancer EMT cells from the other cancer cells. Let the set <italic>X</italic> be all cancer cells that scored above 0.2 for the gene set <italic>D</italic>. We selected all DGEX genes (<italic>logFC</italic> ≥ 1.5 and an adjusted p-value &lt; 0.001), called gene set <italic>E</italic>, in <italic>X</italic> between cancer EMT cells and cancer cells not expressing EMT. We scored each gene in <italic>E</italic> − <italic>D</italic> (n=451) independently and kept genes with significantly higher scores for cancer EMT cells than for CAFs, cancer cells not expressing EMT, and the rest of the cells. We unioned the gene sets <italic>D</italic> and <italic>E</italic>, resulting in our ESCC-specific cancer EMT signature (signature refinement). The detailed procedure can be found in the Jupyter Notebook <monospace>find_cancer_emt_signature_ESCC.ipynb</monospace> in the <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/ANS_supplementary_information">Supplementary material GitHub repository</ext-link>.</p></sec><sec id="S27"><title>Cancer-specific EMT signature for LUAD_Xing</title><p id="P61">For the LUAD_Xing-specific cancer EMT signature, we followed a procedure similar to that for ESCC. First we created two subsets of the LUAD_Xing dataset: cancer EMT cells and CAFs and all cancer cells. Let <italic>A</italic> be the set of DGEX genes (<italic>logFC</italic> ≥ 2 and an adjusted p-value &lt; 0.001) between cancer EMT cells and CAFs. Let <italic>B</italic> be the set of DGEX genes (<italic>logFC</italic> ≥ 1 and an adjusted p-value &lt; 0.001) between cancer EMT cells and cancer cells not expressing EMT. We unioned gene sets <italic>A</italic> and <italic>B</italic>, called gene set <italic>C</italic>. For each cell type <italic>X</italic> not equal to cancer EMT cells, we selected DGEX genes (<italic>logFC</italic> ≥ 1 and an adjusted p-value &lt; 0.001) of <italic>X</italic> versus cancer EMT cells and removed them from gene set <italic>C</italic>. The resulting gene set corresponded to our LUAD_Xing-specific cancer EMT signature. The detailed procedure can be found in the Jupyter Notebook <monospace>find_cancer_emt_signature_LUAD.ipynb</monospace> in the <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/ANS_supplementary_information">supplementary material GitHub repository</ext-link>.</p></sec><sec id="S28"><title>Joining cancer-specific EMT signatures for ESCC and LUAD_Xing and refinement on ESCC</title><p id="P62">To obtain a signature that can distinguish between cancer EMT cells and CAFs, and cancer EMT cells and cancer cells that do not express EMT, we unioned the ESCC- and LUAD_Xing-specific cancer EMT signatures. We scored for each gene in the unioned signature in ESCC (n=267) and only kept a gene if it had significantly higher scores for cancer EMT cells than for CAFs, cancer cells not expressing EMT, and the rest of the cells (signature refinement). We excluded the insignificant genes and incorporated the LUAD_Xing-specific cancer EMT signature genes absent in the preprocessed ESCC dataset and the ESCC-specific cancer EMT signature genes absent in the preprocessed LUAD_Xing dataset. <xref ref-type="supplementary-material" rid="SD1">Suppl. Table S4</xref> shows the 135 ESCC- and LUAD_Xing-specific cancer EMT signature genes. The detailed procedure of signature union and refinement can be found in the Jupyter Notebook <monospace>union_ESCC_and_LUAD_specific_EMT_signature_and_refine_on_ESCC.ipynb</monospace> in the <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/ANS_supplementary_information">supplementary material github repository</ext-link>.</p></sec></sec><sec id="S29"><title>Validation of cancer-specific EMT signature</title><p id="P63">We applied the ESCC and LUAD_Xing-specific cancer EMT signature on the CRC and BRCA datasets for validation. For all datasets, we computed the AUCPRC (<italic>Evaluation of scoring methods</italic> in <xref ref-type="sec" rid="S10">Methods</xref>) for the signature scores between cancer EMT cells and CAFS, cancer cells not expressing EMT, and all other cells (rest) (<xref ref-type="fig" rid="F3">Figure 3a</xref>).</p></sec><sec id="S30"><title>Correlation of cancer-specific EMT signature to histological types</title><p id="P64">To analyze the link between de novo EMT signature and histological subtype of TCGA datasets, we downloaded pan-cancer normalized RSEM (RNA-Seq by Expectation Maximization) gene expression data from the GDC portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">https://portal.gdc.cancer.gov/</ext-link>). Clinical information on the histological subtypes was retrieved from Liu et al.<sup><xref ref-type="bibr" rid="R78">78</xref></sup>. The EMT signature was scored in each corresponding cancer type for which more than one histological subtype was available. The signature was scored using the <italic>ssgsea</italic> method from the <monospace>GSVA</monospace> R package<sup><xref ref-type="bibr" rid="R7">7</xref></sup>. The association between EMT scores and histological subtypes was evaluated using the Kruskal-Wallis test with FDR correction. The analysis was performed using R Statistical Software (v4.1.2; R Core Team 2021).</p></sec><sec id="S31"><title>Statistical information</title><p id="P65">The statistical tools, methods, and threshold for each analysis are explicitly described with the results or detailed in the figure legends or Materials and Methods.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS188444-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d2aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S32"><title>Acknowledgments</title><p>This work was supported by the Stiftung für angewandte Krebsforschung (SAKF) at the University Hospital Zurich (to A.K.), Swiss National Science Foundation (SNF) (projects CRSII5_209524 and 205321_207931 to F.B. and J.Y.), and the Hector Fellow Academy (L.C.).</p></ack><sec id="S33" sec-type="data-availability"><title>Data availability</title><p id="P66">The preprocessed datasets for CRC, ESCC, LUAD_Xing, BRCA, sCC, HGSOC, LUAD, and PBMC and the used signatures can be downloaded: <ext-link ext-link-type="uri" xlink:href="https://drive.google.com/drive/folders/10L2gqapJbyOn_MbrZRHQG--n0Xj7wIyg?usp=sharing">https://drive.google.com/drive/folders/10L2gqapJbyOn_MbrZRHQG--n0Xj7wIyg?usp=sharing</ext-link>. The raw transcript count matrices can be found at GEO: GSE178341 for CRC, GSE176078 for breast cancer, and GSE160269 for ESCC. The raw transcripts for LUAD_Xing can be found with the accession number HRA000154 at <ext-link ext-link-type="uri" xlink:href="http://bigd.big.ac.cn/gsa-human">http://bigd.big.ac.cn/gsa-human</ext-link>. The raw transcripts for the remaining datasets can be found at GEO: sCC (GSE144240, GSE144236), HGSOC (GSE180661), LUAD (GSE131907). The raw PBMC dataset can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://atlas.fredhutch.org/nygc/multimodal-pbmc/">https://atlas.fredhutch.org/nygc/multimodal-pbmc/</ext-link>. TCGA pan-cancer normalized RSEM gene expression data was downloaded from the GDC portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/">htts://portal.gdc.cancer.gov/</ext-link>). TCGA clinical information was retrieved from Liu et al.<sup><xref ref-type="bibr" rid="R78">78</xref></sup>.</p></sec><sec id="S34" sec-type="data-availability"><title>Code availability</title><p id="P67">The code for the experiments and visualizations can be found in the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/ANS_supplementary_information">https://github.com/BoevaLab/ANS_supplementary_information</ext-link>. The Python package published in the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/lciernik/ANS_signature_scoring">https://github.com/lciernik/ANS_signature_scoring</ext-link> includes the implementations of all considered scoring methods. The repository also contains the R implementation of ANS.</p></sec><fn-group><fn id="FN1"><p id="P68">Contributions</p><p id="P69">V.B., A.K., and L.C. conceived the study. J.Y. and F.B. preprocessed the cancer datasets and helped in the analysis and interpretation of results. L.C. developed the ANS scoring method and performed the analysis and interpretation of the benchmark and case study with the assistance of V.B. and A.K. A.K. conducted the association study of cancer EMT scores with histopathological types. L.C. wrote the paper with input from all authors.</p></fn><fn id="FN2" fn-type="conflict"><p id="P70">Ethics declarations</p><p id="P71">Competing interests</p><p id="P72">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><etal/></person-group><article-title>Dissecting esophageal squamous-cell carcinoma ecosystem by single-cell transcriptomic analysis</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>5291</fpage><pub-id pub-id-type="pmcid">PMC8421382</pub-id><pub-id pub-id-type="pmid">34489433</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-25539-x</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Z-H</given-names></name><name><surname>Wang</surname><given-names>X-Y</given-names></name><name><surname>Schatten</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>Q-Y</given-names></name></person-group><article-title>Single cell RNA sequencing techniques and applications in research of ovary development and related diseases</article-title><source>Reprod Toxicol</source><year>2022</year><volume>107</volume><fpage>97</fpage><lpage>103</lpage><pub-id pub-id-type="pmid">34896591</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>MB</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="pmcid">PMC6289068</pub-id><pub-id pub-id-type="pmid">30504886</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nevins</surname><given-names>JR</given-names></name><name><surname>Potti</surname><given-names>A</given-names></name></person-group><article-title>Mining gene expression profiles: expression signatures as cancer phenotypes</article-title><source>Nat Rev Genet</source><year>2007</year><volume>8</volume><fpage>601</fpage><lpage>609</lpage><pub-id pub-id-type="pmid">17607306</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><article-title>An Integrative Model of Cellular States, Plasticity, and Genetics for Glioblastoma</article-title><source>Cell</source><year>2019</year><volume>178</volume><fpage>835</fpage><lpage>849</lpage><elocation-id>e21</elocation-id><pub-id pub-id-type="pmcid">PMC6703186</pub-id><pub-id pub-id-type="pmid">31327527</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2019.06.024</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbie</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1</article-title><source>Nature</source><year>2009</year><volume>462</volume><fpage>108</fpage><lpage>112</lpage><pub-id pub-id-type="pmcid">PMC2783335</pub-id><pub-id pub-id-type="pmid">19847166</pub-id><pub-id pub-id-type="doi">10.1038/nature08460</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hänzelmann</surname><given-names>S</given-names></name><name><surname>Castelo</surname><given-names>R</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name></person-group><article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title><source>BMC Bioinformatics</source><year>2013</year><volume>14</volume><fpage>7</fpage><pub-id pub-id-type="pmcid">PMC3618321</pub-id><pub-id pub-id-type="pmid">23323831</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noureen</surname><given-names>N</given-names></name><name><surname>Ye</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name></person-group><article-title>Signature-scoring methods developed for bulk samples are not adequate for cancer single-cell RNA sequencing data</article-title><source>Elife</source><year>2022</year><volume>11</volume><elocation-id>e71994</elocation-id><pub-id pub-id-type="pmcid">PMC8916770</pub-id><pub-id pub-id-type="pmid">35212622</pub-id><pub-id pub-id-type="doi">10.7554/eLife.71994</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><fpage>15</fpage><pub-id pub-id-type="pmcid">PMC5802054</pub-id><pub-id pub-id-type="pmid">29409532</pub-id><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="web"><source>scanpy.tl.score_genes — Scanpy 1.10.0.dev documentation</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.scanpy.readthedocs.io/en/latest/generated/scanpy.tl.score_genes.html">https://scanpy.readthedocs.io/en/latest/generated/scanpy.tl.score_genes.html</ext-link></comment></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satija</surname><given-names>R</given-names></name><name><surname>Farrell</surname><given-names>JA</given-names></name><name><surname>Gennert</surname><given-names>D</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title><source>Nat Biotechnol</source><year>2015</year><volume>33</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="pmcid">PMC4430369</pub-id><pub-id pub-id-type="pmid">25867923</pub-id><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="web"><collab>AddModuleScore function - RDocumentation</collab><comment><ext-link ext-link-type="uri" xlink:href="https://www.rdocumentation.org/packages/Seurat/versions/2.3.4/topics/AddModuleScore">https://www.rdocumentation.org/packages/Seurat/versions/2.3.4/topics/AddModuleScore</ext-link></comment></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andreatta</surname><given-names>M</given-names></name><name><surname>Carmona</surname><given-names>SJ</given-names></name></person-group><article-title>UCell: Robust and scalable single-cell gene signature scoring</article-title><source>Comput Struct Biotechnol J</source><year>2021</year><volume>19</volume><fpage>3796</fpage><lpage>3798</lpage><pub-id pub-id-type="pmcid">PMC8271111</pub-id><pub-id pub-id-type="pmid">34285779</pub-id><pub-id pub-id-type="doi">10.1016/j.csbj.2021.06.043</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibbs</surname><given-names>DL</given-names></name><name><surname>Strasser</surname><given-names>MK</given-names></name><name><surname>Huang</surname><given-names>S</given-names></name></person-group><article-title>Single-cell gene set scoring with nearest neighbor graph smoothed data (gssnng)</article-title><source>Bioinform Adv</source><year>2023</year><volume>3</volume><elocation-id>vbad150</elocation-id><pub-id pub-id-type="pmcid">PMC10599965</pub-id><pub-id pub-id-type="pmid">37886712</pub-id><pub-id pub-id-type="doi">10.1093/bioadv/vbad150</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>WV</given-names></name><name><surname>Li</surname><given-names>JJ</given-names></name></person-group><article-title>An accurate and robust imputation method scImpute for single-cell RNA-seq data</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><fpage>997</fpage><pub-id pub-id-type="pmcid">PMC5843666</pub-id><pub-id pub-id-type="pmid">29520097</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-03405-7</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>M</given-names></name><etal/></person-group><article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="pmcid">PMC6030502</pub-id><pub-id pub-id-type="pmid">29941873</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0033-z</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><etal/></person-group><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title><source>Science</source><year>2016</year><volume>352</volume><fpage>189</fpage><lpage>196</lpage><pub-id pub-id-type="pmcid">PMC4944528</pub-id><pub-id pub-id-type="pmid">27124452</pub-id><pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><etal/></person-group><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><fpage>1083</fpage><lpage>1086</lpage><pub-id pub-id-type="pmcid">PMC5937676</pub-id><pub-id pub-id-type="pmid">28991892</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>RH</given-names></name><name><surname>Thakar</surname><given-names>J</given-names></name></person-group><article-title>Comparative analysis of single-cell pathway scoring methods and a novel approach</article-title><source>NAR Genom Bioinform</source><year>2024</year><volume>6</volume><elocation-id>lqae124</elocation-id><pub-id pub-id-type="pmcid">PMC11420841</pub-id><pub-id pub-id-type="pmid">39318507</pub-id><pub-id pub-id-type="doi">10.1093/nargab/lqae124</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Integrated analysis of multimodal single-cell data</article-title><source>Cell</source><year>2021</year><volume>184</volume><fpage>3573</fpage><lpage>3587</lpage><elocation-id>e29</elocation-id><pub-id pub-id-type="pmcid">PMC8238499</pub-id><pub-id pub-id-type="pmid">34062119</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pelka</surname><given-names>K</given-names></name><etal/></person-group><article-title>Spatially organized multicellular immune hubs in human colorectal cancer</article-title><source>Cell</source><year>2021</year><volume>184</volume><fpage>4734</fpage><lpage>4752</lpage><elocation-id>e20</elocation-id><pub-id pub-id-type="pmcid">PMC8772395</pub-id><pub-id pub-id-type="pmid">34450029</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2021.08.003</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>SZ</given-names></name><etal/></person-group><article-title>A single-cell and spatially resolved atlas of human breast cancers</article-title><source>Nat Genet</source><year>2021</year><volume>53</volume><fpage>1334</fpage><lpage>1347</lpage><pub-id pub-id-type="pmcid">PMC9044823</pub-id><pub-id pub-id-type="pmid">34493872</pub-id><pub-id pub-id-type="doi">10.1038/s41588-021-00911-1</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vázquez-García</surname><given-names>I</given-names></name><etal/></person-group><article-title>Ovarian cancer mutational processes drive site-specific immune evasion</article-title><source>Nature</source><year>2022</year><volume>612</volume><fpage>778</fpage><lpage>786</lpage><pub-id pub-id-type="pmcid">PMC9771812</pub-id><pub-id pub-id-type="pmid">36517593</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05496-1</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>AL</given-names></name><etal/></person-group><article-title>Multimodal analysis of composition and spatial architecture in human squamous cell carcinoma</article-title><source>Cell</source><year>2020</year><volume>182</volume><fpage>497</fpage><lpage>514</lpage><elocation-id>e22</elocation-id><pub-id pub-id-type="pmcid">PMC7505493</pub-id><pub-id pub-id-type="pmid">32946785</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.08.043</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>N</given-names></name><etal/></person-group><article-title>Single-cell RNA sequencing demonstrates the molecular and cellular reprogramming of metastatic lung adenocarcinoma</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><fpage>2285</fpage><pub-id pub-id-type="pmcid">PMC7210975</pub-id><pub-id pub-id-type="pmid">32385277</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-16164-1</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xing</surname><given-names>X</given-names></name><etal/></person-group><article-title>Decoding the multicellular ecosystem of lung adenocarcinoma manifested as pulmonary subsolid nodules by single-cell RNA sequencing</article-title><source>Sci Adv</source><year>2021</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC7840134</pub-id><pub-id pub-id-type="pmid">33571124</pub-id><pub-id pub-id-type="doi">10.1126/sciadv.abd9738</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><etal/></person-group><article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title><source>Cell Syst</source><year>2015</year><volume>1</volume><fpage>417</fpage><lpage>425</lpage><pub-id pub-id-type="pmcid">PMC4707969</pub-id><pub-id pub-id-type="pmid">26771021</pub-id><pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barkley</surname><given-names>D</given-names></name><etal/></person-group><article-title>Cancer cell states recur across tumor types and form specific interactions with the tumor microenvironment</article-title><source>Nat Genet</source><year>2022</year><volume>54</volume><fpage>1192</fpage><lpage>1201</lpage><pub-id pub-id-type="pmcid">PMC9886402</pub-id><pub-id pub-id-type="pmid">35931863</pub-id><pub-id pub-id-type="doi">10.1038/s41588-022-01141-9</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gröger</surname><given-names>CJ</given-names></name><name><surname>Grubinger</surname><given-names>M</given-names></name><name><surname>Waldhör</surname><given-names>T</given-names></name><name><surname>Vierlinger</surname><given-names>K</given-names></name><name><surname>Mikulits</surname><given-names>W</given-names></name></person-group><article-title>Meta-analysis of gene expression signatures defining the epithelial to mesenchymal transition during cancer progression</article-title><source>PLoS One</source><year>2012</year><volume>7</volume><elocation-id>e51136</elocation-id><pub-id pub-id-type="pmcid">PMC3519484</pub-id><pub-id pub-id-type="pmid">23251436</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0051136</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>TZ</given-names></name><etal/></person-group><article-title>Epithelial-mesenchymal transition spectrum quantification and its efficacy in deciphering survival and drug responses of cancer patients</article-title><source>EMBO Mol Med</source><year>2014</year><volume>6</volume><fpage>1279</fpage><lpage>1293</lpage><pub-id pub-id-type="pmcid">PMC4287932</pub-id><pub-id pub-id-type="pmid">25214461</pub-id><pub-id pub-id-type="doi">10.15252/emmm.201404208</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mak</surname><given-names>MP</given-names></name><etal/></person-group><article-title>A Patient-Derived, Pan-Cancer EMT Signature Identifies Global Molecular Alterations and Immune Target Enrichment Following Epithelial-to-Mesenchymal Transition</article-title><source>Clin Cancer Res</source><year>2016</year><volume>22</volume><fpage>609</fpage><lpage>620</lpage><pub-id pub-id-type="pmcid">PMC4737991</pub-id><pub-id pub-id-type="pmid">26420858</pub-id><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-15-0876</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foroutan</surname><given-names>M</given-names></name><name><surname>Cursons</surname><given-names>J</given-names></name><name><surname>Hediyeh-Zadeh</surname><given-names>S</given-names></name><name><surname>Thompson</surname><given-names>EW</given-names></name><name><surname>Davis</surname><given-names>MJ</given-names></name></person-group><article-title>A Transcriptional Program for Detecting TGFβ-Induced EMT in Cancer</article-title><source>Mol Cancer Res</source><year>2017</year><volume>15</volume><fpage>619</fpage><lpage>631</lpage><pub-id pub-id-type="pmid">28119430</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollern</surname><given-names>DP</given-names></name><name><surname>Swiatnicki</surname><given-names>MR</given-names></name><name><surname>Andrechek</surname><given-names>ER</given-names></name></person-group><article-title>Histological subtypes of mouse mammary tumors reveal conserved relationships to human cancers</article-title><source>PLoS Genet</source><year>2018</year><volume>14</volume><elocation-id>e1007135</elocation-id><pub-id pub-id-type="pmcid">PMC5773092</pub-id><pub-id pub-id-type="pmid">29346386</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007135</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="web"><collab>Epithelial-Mesenchymal Transition (EMT) markers</collab><source>Novus Biologicals</source><year>2016</year><comment><ext-link ext-link-type="uri" xlink:href="https://www.novusbio.com/antibody-news/antibodies/antibodies-for-epithelial-mesenchymal-transition-emt-marker">https://www.novusbio.com/antibody-news/antibodies/antibodies-for-epithelial-mesenchymal-transition-emt-marker</ext-link></comment></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Yin</surname><given-names>R</given-names></name></person-group><article-title>Biomarkers for cancer-associated fibroblasts</article-title><source>Biomark Res</source><year>2020</year><volume>8</volume><fpage>64</fpage><pub-id pub-id-type="pmcid">PMC7661188</pub-id><pub-id pub-id-type="pmid">33292666</pub-id><pub-id pub-id-type="doi">10.1186/s40364-020-00245-w</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nurmik</surname><given-names>M</given-names></name><name><surname>Ullmann</surname><given-names>P</given-names></name><name><surname>Rodriguez</surname><given-names>F</given-names></name><name><surname>Haan</surname><given-names>S</given-names></name><name><surname>Letellier</surname><given-names>E</given-names></name></person-group><article-title>In search of definitions: Cancer-associated fibroblasts and their markers</article-title><source>Int J Cancer</source><year>2020</year><volume>146</volume><fpage>895</fpage><lpage>905</lpage><pub-id pub-id-type="pmcid">PMC6972582</pub-id><pub-id pub-id-type="pmid">30734283</pub-id><pub-id pub-id-type="doi">10.1002/ijc.32193</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="web"><source>PITX1 paired like homeodomain 1 [Homo sapiens (human)] - Gene - NCBI</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/gene/5307">https://www.ncbi.nlm.nih.gov/gene/5307</ext-link></comment></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="web"><collab>GeneCards Human Gene Database</collab><source>PITX1 Gene - GeneCards</source><comment><ext-link ext-link-type="uri" xlink:href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=PITX1">https://www.genecards.org/cgi-bin/carddisp.pl?gene=PITX1</ext-link></comment></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>X</given-names></name><etal/></person-group><article-title>High PITX1 expression in lung adenocarcinoma patients is associated with DNA methylation and poor prognosis</article-title><source>Pathol Res Pract</source><year>2018</year><volume>214</volume><fpage>2046</fpage><lpage>2053</lpage><pub-id pub-id-type="pmid">30322808</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Bao</surname><given-names>G</given-names></name></person-group><article-title>Upregulated Transcription Factor PITX1 Predicts Poor Prognosis in Kidney Renal Clear Cell Carcinoma-Based Bioinformatic Analysis and Experimental Verification</article-title><source>Dis Markers</source><year>2021</year><volume>2021</volume><elocation-id>7694239</elocation-id><pub-id pub-id-type="pmcid">PMC8633854</pub-id><pub-id pub-id-type="pmid">34868397</pub-id><pub-id pub-id-type="doi">10.1155/2021/7694239</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Gan</surname><given-names>L</given-names></name><name><surname>Zhuang</surname><given-names>Z</given-names></name></person-group><article-title>Bioinformatics analysis of prognostic value of PITX1 gene in breast cancer</article-title><source>Biosci Rep</source><year>2020</year><volume>40</volume><pub-id pub-id-type="pmcid">PMC7494990</pub-id><pub-id pub-id-type="pmid">32830857</pub-id><pub-id pub-id-type="doi">10.1042/BSR20202537</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Differential gene expression identifies a transcriptional regulatory network involving ER-alpha and PITX1 in invasive epithelial ovarian cancer</article-title><source>BMC Cancer</source><year>2021</year><volume>21</volume><fpage>768</fpage><pub-id pub-id-type="pmcid">PMC8254236</pub-id><pub-id pub-id-type="pmid">34215221</pub-id><pub-id pub-id-type="doi">10.1186/s12885-021-08276-8</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poos</surname><given-names>AM</given-names></name><etal/></person-group><article-title>PITX1 Is a Regulator of TERT Expression in Prostate Cancer with Prognostic Power</article-title><source>Cancers</source><year>2022</year><volume>14</volume><pub-id pub-id-type="pmcid">PMC8909694</pub-id><pub-id pub-id-type="pmid">35267575</pub-id><pub-id pub-id-type="doi">10.3390/cancers14051267</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohira</surname><given-names>T</given-names></name><name><surname>Nakagawa</surname><given-names>S</given-names></name><name><surname>Takeshita</surname><given-names>J</given-names></name><name><surname>Aburatani</surname><given-names>H</given-names></name><name><surname>Kugoh</surname><given-names>H</given-names></name></person-group><article-title>PITX1 inhibits the growth and proliferation of melanoma cells through regulation of SOX family genes</article-title><source>Sci Rep</source><year>2021</year><volume>11</volume><elocation-id>18405</elocation-id><pub-id pub-id-type="pmcid">PMC8443576</pub-id><pub-id pub-id-type="pmid">34526609</pub-id><pub-id pub-id-type="doi">10.1038/s41598-021-97791-6</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsubo</surname><given-names>T</given-names></name><etal/></person-group><article-title>DNA hypermethyation and silencing of PITX1 correlated with advanced stage and poor postoperative prognosis of esophageal squamous cell carcinoma</article-title><source>Oncotarget</source><year>2017</year><volume>8</volume><fpage>84434</fpage><lpage>84448</lpage><pub-id pub-id-type="pmcid">PMC5663609</pub-id><pub-id pub-id-type="pmid">29137437</pub-id><pub-id pub-id-type="doi">10.18632/oncotarget.21375</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>PITX1 suppresses osteosarcoma metastasis through exosomal LINC00662-mediated M2 macrophage polarization</article-title><source>Clin Exp Metastasis</source><year>2023</year><volume>40</volume><fpage>79</fpage><lpage>93</lpage><pub-id pub-id-type="pmcid">PMC9898340</pub-id><pub-id pub-id-type="pmid">36334221</pub-id><pub-id pub-id-type="doi">10.1007/s10585-022-10192-5</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>Y</given-names></name><name><surname>Qin</surname><given-names>X</given-names></name></person-group><article-title>Paired like homeodomain 1 and SAM and SH3 domain-containing 1 in the progression and prognosis of head and neck squamous cell carcinoma</article-title><source>Int J Biochem Cell Biol</source><year>2020</year><volume>127</volume><elocation-id>105846</elocation-id><pub-id pub-id-type="pmid">32905855</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiao</surname><given-names>X</given-names></name><etal/></person-group><article-title>Long noncoding RNA ABHD11-AS1 predicts the prognosis of pancreatic cancer patients and serves as a promoter by activating the PI3K-AKT pathway</article-title><source>Eur Rev Med Pharmacol Sci</source><year>2018</year><volume>22</volume><fpage>8630</fpage><lpage>8639</lpage><pub-id pub-id-type="pmid">30575903</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>T</given-names></name><name><surname>Lu</surname><given-names>Y-R</given-names></name></person-group><article-title>BCYRN1, a c-MYC-activated long non-coding RNA, regulates cell metastasis of non-small-cell lung cancer</article-title><source>Cancer Cell Int</source><year>2015</year><volume>15</volume><fpage>36</fpage><pub-id pub-id-type="pmcid">PMC4392634</pub-id><pub-id pub-id-type="pmid">25866480</pub-id><pub-id pub-id-type="doi">10.1186/s12935-015-0183-3</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S</given-names></name><etal/></person-group><article-title>LncRNA BCYRN1 promotes cell migration and invasion of non-small cell lung cancer via the miR-30b-3p/ROCK1 axis</article-title><source>Neoplasma</source><year>2022</year><volume>69</volume><fpage>583</fpage><lpage>593</lpage><pub-id pub-id-type="pmid">35225646</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>L</given-names></name><name><surname>Lu</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name></person-group><article-title>Long Noncoding RNA BCYRN1 Promotes the Proliferation of Colorectal Cancer Cells via Up-Regulating NPR3 Expression</article-title><source>Cell Physiol Biochem</source><year>2018</year><volume>48</volume><fpage>2337</fpage><lpage>2349</lpage><pub-id pub-id-type="pmid">30114690</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>J-H</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name></person-group><article-title>Clinical significance of lncRNA BCYRN1 in colorectal cancer and its role in cell metastasis</article-title><source>Eur Rev Med Pharmacol Sci</source><year>2019</year><volume>23</volume><fpage>9371</fpage><lpage>9378</lpage><pub-id pub-id-type="pmid">31773686</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>He</surname><given-names>Q</given-names></name><name><surname>Yan</surname><given-names>Q</given-names></name><name><surname>Zhai</surname><given-names>C</given-names></name></person-group><article-title>MicroRNA-199a-5p suppresses cell proliferation, migration and invasion by targeting ITGA3 in colorectal cancer</article-title><source>Mol Med Rep</source><year>2020</year><volume>22</volume><fpage>2307</fpage><lpage>2317</lpage><pub-id pub-id-type="pmcid">PMC7411411</pub-id><pub-id pub-id-type="pmid">32705201</pub-id><pub-id pub-id-type="doi">10.3892/mmr.2020.11323</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheriyamundath</surname><given-names>S</given-names></name><name><surname>Ben-Ze’ev</surname><given-names>A</given-names></name></person-group><article-title>Wnt/β-Catenin Target Genes in Colon Cancer Metastasis: The Special Case of L1CAM</article-title><source>Cancers</source><year>2020</year><volume>12</volume><pub-id pub-id-type="pmcid">PMC7699470</pub-id><pub-id pub-id-type="pmid">33228199</pub-id><pub-id pub-id-type="doi">10.3390/cancers12113444</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>Y-W</given-names></name><etal/></person-group><article-title>FAM83A Promotes Lung Cancer Progression by Regulating the Wnt and Hippo Signaling Pathways and Indicates Poor Prognosis</article-title><source>Front Oncol</source><year>2020</year><volume>10</volume><fpage>180</fpage><pub-id pub-id-type="pmcid">PMC7066079</pub-id><pub-id pub-id-type="pmid">32195172</pub-id><pub-id pub-id-type="doi">10.3389/fonc.2020.00180</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname><given-names>Y</given-names></name><etal/></person-group><article-title>ERO1L promotes IL6/sIL6R signaling and regulates MUC16 expression to promote CA125 secretion and the metastasis of lung cancer cells</article-title><source>Cell Death Dis</source><year>2020</year><volume>11</volume><fpage>853</fpage><pub-id pub-id-type="pmcid">PMC7560734</pub-id><pub-id pub-id-type="pmid">33056994</pub-id><pub-id pub-id-type="doi">10.1038/s41419-020-03067-8</pub-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>H</given-names></name><etal/></person-group><article-title>FAM83A promotes proliferation and metastasis via Wnt/β-catenin signaling in head neck squamous cell carcinoma</article-title><source>J Transl Med</source><year>2021</year><volume>19</volume><fpage>423</fpage><pub-id pub-id-type="pmcid">PMC8507380</pub-id><pub-id pub-id-type="pmid">34641907</pub-id><pub-id pub-id-type="doi">10.1186/s12967-021-03089-6</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schinke</surname><given-names>H</given-names></name><etal/></person-group><article-title>A transcriptomic map of EGFR-induced epithelial-to-mesenchymal transition identifies prognostic and therapeutic targets for head and neck cancer</article-title><source>Mol Cancer</source><year>2022</year><volume>21</volume><fpage>178</fpage><pub-id pub-id-type="pmcid">PMC9454230</pub-id><pub-id pub-id-type="pmid">36076232</pub-id><pub-id pub-id-type="doi">10.1186/s12943-022-01646-1</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Cui</surname><given-names>X</given-names></name><name><surname>Cao</surname><given-names>A’na</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>L</given-names></name></person-group><article-title>ITGA3 interacts with VASP to regulate stemness and epithelial-mesenchymal transition of breast cancer cells</article-title><source>Gene</source><year>2020</year><volume>734</volume><elocation-id>144396</elocation-id><pub-id pub-id-type="pmid">31987909</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhai</surname><given-names>Y</given-names></name><etal/></person-group><article-title>MUC16 affects the biological functions of ovarian cancer cells and induces an antitumor immune response by activating dendritic cells</article-title><source>Ann Transl Med</source><year>2020</year><volume>8</volume><fpage>1494</fpage><pub-id pub-id-type="pmcid">PMC7729312</pub-id><pub-id pub-id-type="pmid">33313239</pub-id><pub-id pub-id-type="doi">10.21037/atm-20-6388</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Serum amyloid a, a potential biomarker both in serum and tissue, correlates with ovarian cancer progression</article-title><source>J Ovarian Res</source><year>2020</year><volume>13</volume><fpage>67</fpage><pub-id pub-id-type="pmcid">PMC7285470</pub-id><pub-id pub-id-type="pmid">32517794</pub-id><pub-id pub-id-type="doi">10.1186/s13048-020-00669-w</pub-id></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Gao</surname><given-names>F</given-names></name><name><surname>Liu</surname><given-names>N</given-names></name></person-group><article-title>L1CAM promotes epithelial to mesenchymal transition and formation of cancer initiating cells in human endometrial cancer</article-title><source>Exp Ther Med</source><year>2018</year><volume>15</volume><fpage>2792</fpage><lpage>2797</lpage><pub-id pub-id-type="pmcid">PMC5795538</pub-id><pub-id pub-id-type="pmid">29456682</pub-id><pub-id pub-id-type="doi">10.3892/etm.2018.5747</pub-id></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>J</given-names></name><etal/></person-group><article-title>CanSig: Discovering de novo shared transcriptional programs in single cancer cells</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.04.14.488324</elocation-id><pub-id pub-id-type="doi">10.1101/2022.04.14.488324</pub-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlmann-Eltze</surname><given-names>C</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Comparison of transformations for single-cell RNA-seq data</article-title><source>Nat Methods</source><year>2023</year><pub-id pub-id-type="pmcid">PMC10172138</pub-id><pub-id pub-id-type="pmid">37037999</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01814-1</pub-id></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumos</surname><given-names>L</given-names></name><etal/></person-group><article-title>Best practices for single-cell analysis across modalities</article-title><source>Nat Rev Genet</source><year>2023</year><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="pmcid">PMC10066026</pub-id><pub-id pub-id-type="pmid">37002403</pub-id><pub-id pub-id-type="doi">10.1038/s41576-023-00586-w</pub-id></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badia-I-Mompel</surname><given-names>P</given-names></name><etal/></person-group><article-title>decoupleR: ensemble of computational methods to infer biological activities from omics data</article-title><source>Bioinform Adv</source><year>2022</year><volume>2</volume><elocation-id>vbac016</elocation-id><pub-id pub-id-type="pmcid">PMC9710656</pub-id><pub-id pub-id-type="pmid">36699385</pub-id><pub-id pub-id-type="doi">10.1093/bioadv/vbac016</pub-id></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muzellec</surname><given-names>B</given-names></name><name><surname>Teleńczuk</surname><given-names>M</given-names></name><name><surname>Cabeli</surname><given-names>V</given-names></name><name><surname>Andreux</surname><given-names>M</given-names></name></person-group><article-title>PyDESeq2: a python package for bulk RNA-seq differential expression analysis</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.12.14.520412</elocation-id><pub-id pub-id-type="pmcid">PMC10502239</pub-id><pub-id pub-id-type="pmid">37669147</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btad547</pub-id></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><fpage>550</fpage><pub-id pub-id-type="pmcid">PMC4302049</pub-id><pub-id pub-id-type="pmid">25516281</pub-id><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="web"><collab>scanpy.pp.highly_variable_genes — Scanpy 1.9.1 documentation</collab><comment><ext-link ext-link-type="uri" xlink:href="https://www.scanpy.readthedocs.io/en/stable/generated/scanpy.pp.highly_variable_genes.html">https://scanpy.readthedocs.io/en/stable/generated/scanpy.pp.highly_variable_genes.html</ext-link></comment></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><collab>Pedregosa, Varoquaux &amp; Gramfort</collab><article-title>Scikit-learn: Machine learning in Python</article-title><source>of machine Learning …</source><pub-id pub-id-type="pmcid">PMC3930868</pub-id><pub-id pub-id-type="pmid">24600388</pub-id><pub-id pub-id-type="doi">10.3389/fninf.2014.00014</pub-id></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amezquita</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Orchestrating single-cell analysis with Bioconductor</article-title><source>Nat Methods</source><year>2020</year><volume>17</volume><fpage>137</fpage><lpage>145</lpage><pub-id pub-id-type="pmcid">PMC7358058</pub-id><pub-id pub-id-type="pmid">31792435</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0654-x</pub-id></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="web"><source>Calculate module scores for feature expression programs in single cells</source><comment><ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/reference/addmodulescore">https://satijalab.org/seurat/reference/addmodulescore</ext-link></comment></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P</given-names></name><etal/></person-group><article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title><source>Nat Methods</source><year>2020</year><volume>17</volume><fpage>261</fpage><lpage>272</lpage><pub-id pub-id-type="pmcid">PMC7056644</pub-id><pub-id pub-id-type="pmid">32015543</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waskom</surname><given-names>M</given-names></name></person-group><article-title>seaborn: statistical data visualization</article-title><source>J Open Source Softw</source><year>2021</year><volume>6</volume><fpage>3021</fpage></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charlier</surname><given-names>F</given-names></name><etal/></person-group><source>Trevismd/statannotations: v05</source><year>2022</year><pub-id pub-id-type="doi">10.5281/zenodo.7213391</pub-id></element-citation></ref><ref id="R76"><label>76</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vasaikar</surname><given-names>SV</given-names></name><etal/></person-group><article-title>EMTome: a resource for pan-cancer analysis of epithelial-mesenchymal transition genes and signatures</article-title><source>Br J Cancer</source><year>2021</year><volume>124</volume><fpage>259</fpage><lpage>269</lpage><pub-id pub-id-type="pmcid">PMC7782839</pub-id><pub-id pub-id-type="pmid">33299129</pub-id><pub-id pub-id-type="doi">10.1038/s41416-020-01178-9</pub-id></element-citation></ref><ref id="R77"><label>77</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>255</fpage><lpage>261</lpage><pub-id pub-id-type="pmid">29481549</pub-id></element-citation></ref><ref id="R78"><label>78</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><etal/></person-group><article-title>An Integrated TCGA Pan-Cancer Clinical Data Resource to Drive High-Quality Survival Outcome Analytics</article-title><source>Cell</source><year>2018</year><volume>173</volume><fpage>400</fpage><lpage>416</lpage><elocation-id>e11</elocation-id><pub-id pub-id-type="pmcid">PMC6066282</pub-id><pub-id pub-id-type="pmid">29625055</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.052</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Performance and robustness analysis of gene signature scoring methods.</title><p><bold>a</bold>, Benchmark questions for the gene signature scoring methods and availability of the methods in Python (blue) and R (red). <bold>b</bold>, The scores obtained from R and Python implementations compared for two cancer datasets (CRC, ESCC). Discrepancies in Seurat scores between R (AddModuleScore of Seurat) and Python are attributed to randomization in the scoring method. <bold>c</bold>, Control gene selection bias of the scoring methods for the top 8% of highly expressed genes in B memory kappa cells within the PBMC dataset. The x-axis shows genes sorted by their average expression levels; the y-axis shows the mean score across all cells for a single-gene signature. Vertical dashed lines indicate the expression bin boundary and the top 50 highly expressed genes. The bias of a scoring method is indicated by how far the mean score of a gene deviates from zero. <bold>d</bold>, The influence of dataset composition and batch effect on scoring CRC cells using a 100-gene signature associated with malignant cells. Each dot represents the mean score for all cells within a sample, grouped by cell type (malignant in blue or non-malignant in orange), sequencing chemistry type (SC3Pv2 in grey or SC3Pv3 in beige), and scoring mode (scoring all the samples together or individually). The black horizontal bar represents the mean value of all dots within each group. P-value annotation: ns: p &gt; 0.05, *: 0.01 &lt; p &lt;= 0.05, **: 1e-3 &lt; p &lt;= 0.01, ***: 1e-4 &lt; p &lt;= 1e-3, ****: p &lt;= 1e-4.</p></caption><graphic xlink:href="EMS188444-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>Comparative analysis of scoring methods for cell type and state annotation. Only non-overlapping cell type- or state-specific signatures were used. <bold>a</bold>, Score distributions for cell-type-specific signatures (B cells, monocytes, and NK cells) separated by true cell type annotations, calculated for each scoring method. <bold>b</bold>, Score distributions for B-cell subtype signatures separated by true cell subtypes, calculated by each scoring method. <bold>c</bold>, Row-normalized confusion matrix of B-cell subtype annotation based on the highest scores. <bold>d</bold>, Relationship between hard labeling performance and score information quantity in cancer vs. PBMC datasets. Scatterplots show balanced accuracy (x-axis) against score information quantity (y-axis) for various scoring method-dataset combinations. Balanced accuracy quantifies hard labeling performance, while score information quantity indicates the scores’ effectiveness in subtype classification. The diagonal line indicates perfect metric alignment, with vertical distances from this line representing scale imbalance. <bold>e</bold>, Quantitative analysis of scale imbalance across scoring methods and tissue types (cancer vs. PBMC). The mean and standard deviation of scale imbalance for each method are shown. Scale imbalance is the absolute difference between score information quantity and balanced accuracy in direct label assignment. The method with the lowest mean scale imbalance, indicating optimal consistency between information content and labeling accuracy, is highlighted in bold. <bold>f</bold>, Cell-state and -type annotation performance overview for all eight datasets and scoring methods.</p></caption><graphic xlink:href="EMS188444-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Application of ANS to devise EMT signature specific to malignant cells.</title><p><bold>a</bold>, Score distributions of the Hallmark EMT, the pEMT, and our proposed ESCC- and LUAD_Xing-specific cancer EMT gene signatures in different cell types of ESCC, LUAD_Xing, CRC, and BRCA. <bold>b</bold>, Venn diagram for the overlap in gene lists for the Hallmark EMT, pEMT signatures, and the signature we designed. <bold>c</bold>, Association of ESCC- and LUAD_Xing-specific cancer EMT signature scores and histological subtypes in TCGA (only cancer types with at least 1 histotype are included). Significant associations (qvalue &lt; 0.05) are represented by dots above the dotted line. The FDR-adjusted p-values from the Kruskal-Wallis test were -log_10 transformed and sorted in decreasing value, with a higher y-value indicating higher significance.</p></caption><graphic xlink:href="EMS188444-f003"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Qualitative comparison of signature scoring methods based on their properties, influencing factors, and score comparability.</title><p>✓ means a scoring method fulfills property or resists an influencing factor. ✕ means the opposite. NA stands for a property or an influencing factor that cannot be evaluated for a scoring method. These results are discussed in detail in Results.</p></caption><table frame="box" rules="groups"><thead><tr><th valign="top" align="left" style="border-top: 1px solid #000000;border-bottom: 1px solid #000000;border-right: 1px solid #000000;border-left: 1px solid #000000">Scoring method</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Deterministic</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Optimal<break/>control<break/>genes<break/>selection</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Independent<break/>of total cell<break/>number<break/>and cell type<break/>proportions</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Robust to<break/>batch effect<break/>when<break/>scoring all<break/>samples<break/>together</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Robust<break/>when<break/>scoring for<break/>small<break/>signatures</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Robust to<break/>unrelated<break/>genes in<break/>the<break/>signature</th><th valign="top" align="left" style="border-top: 1px solid #000000;border-right: 1px solid #000000;border-bottom: 1px solid #000000">Provides<break/>comparable<break/>scores for<break/>multiple<break/>cell-type<break/>signatures</th></tr></thead><tbody><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>ANS: Adjusted</bold><break/><bold>Neighborhood</bold><break/><bold>Scoring</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Scanpy</bold><sup><xref ref-type="bibr" rid="R9">9</xref></sup><bold>: based on</bold><break/><bold>Tirosh <italic>et al.</italic></bold><sup><italic>17</italic></sup></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Seurat</bold><sup><xref ref-type="bibr" rid="R11">11</xref></sup><bold>: based on Tirosh</bold><break/><bold><italic>et al.</italic></bold><sup><xref ref-type="bibr" rid="R17">17</xref></sup></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Seurat_AG:</bold><break/><bold>Seurat scoring</bold><break/><bold>with all genes as</bold><break/><bold>control</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Seurat_LVG:</bold><break/><bold>Seurat scoring</bold><break/><bold>with least</bold><break/><bold>variable genes as</bold><break/><bold>control</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Jasmine_LH:</bold><break/><bold>JASMINE with</bold><break/><bold>likelihood</bold><break/><bold>computation</bold><sup><xref ref-type="bibr" rid="R8">8</xref></sup></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f3f3f3"><bold>NA</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>Jasmine_OR:</bold><break/><bold>JASMINE with</bold><break/><bold>odds-ratio</bold><break/><bold>computation</bold><sup><xref ref-type="bibr" rid="R8">8</xref></sup></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f3f3f3"><bold>NA</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr><tr><td valign="top" align="left" style="border-right: 1px solid #000000;border-bottom: 1px solid #000000;border-left: 1px solid #000000"><bold>UCell</bold><sup><xref ref-type="bibr" rid="R13">13</xref></sup></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f3f3f3"><bold>NA</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #d9ead3"><bold>✓</bold></td><td valign="top" align="center" style="border-bottom: 1px solid #000000;border-right: 1px solid #000000;background: #f4cccc"><bold>✕</bold></td></tr></tbody></table></table-wrap></floats-group></article>