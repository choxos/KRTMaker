<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS191756</article-id><article-id pub-id-type="doi">10.1101/2023.11.24.568574</article-id><article-id pub-id-type="archive">PPR764196</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">4</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>rsofun v5.0: A model-data integration framework for simulating ecosystem processes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Paredes</surname><given-names>Josefa Arán</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Hufkens</surname><given-names>Koen</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Marcadella</surname><given-names>Mayeul</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Bernhard</surname><given-names>Fabian</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Stocker</surname><given-names>Benjamin D.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institute of Geography, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02k7v4d05</institution-id><institution>University of Bern</institution></institution-wrap>, <addr-line>Hallerstrasse, 12</addr-line>, <postal-code>3012</postal-code><city>Bern</city>, <country country="CH">Switzerland</country></aff><aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0329s8h62</institution-id><institution>Oeschger Center for Climate Change Research (OCCR)</institution></institution-wrap>, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/02k7v4d05</institution-id><institution>University of Bern</institution></institution-wrap>, <addr-line>Hochschulstrasse, 6</addr-line><postal-code>3012</postal-code><city>Bern</city>, <country country="CH">Switzerland</country></aff><author-notes><corresp id="CR1">
<label>*</label>
<italic>Correspondence to</italic>: Benjamin D. Stocker (<email>benjamin.stocker@unibe.ch</email>)</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>25</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>24</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Mechanistic vegetation models serve to estimate terrestrial carbon fluxes and climate impacts on ecosystems across diverse biotic and abiotic conditions. Systematically informing them with data is key for enhancing their predictive accuracy and estimating uncertainty. Here we present the Simulating Optimal FUNctioning {rsofun} R package, providing a computationally efficient and parallelizable implementation of the P-model for site-scale simulations of ecosystem photosynthesis, complemented with functionalities for Bayesian model-data integration and estimation of parameters and uncertainty. We describe a use case to demonstrate the package functionalities for modelling ecosystem gross CO<sub>2</sub> uptake at one flux measurement site, including model sensitivity analysis, Bayesian parameter calibration, and prediction uncertainty estimation. {rsofun} lowers the bar of entry to ecosystem modelling and model-data integration and serves as an open-access resource for model development and dissemination.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">The modelling of land ecosystem processes and structure, water, and carbon fluxes relies on both mechanistic and statistical approaches (<xref ref-type="bibr" rid="R6">Dietze et al., 2018</xref>; <xref ref-type="bibr" rid="R11">Hartig et al., 2012</xref>; <xref ref-type="bibr" rid="R24">Van Oijen et al., 2005</xref>). Mechanistic models are formulated as mathematical descriptions of functional relationships between the abiotic environment and ecosystem states, rates, and dynamics. These descriptions reflect available theory and general empirical patterns and provide a means for “translating” hypotheses about governing principles and causal relationships into testable predictions (<xref ref-type="bibr" rid="R14">Marquet et al., 2014</xref>), and for upscaling model-based estimates in geographical space and to novel environmental conditions. However, mechanistic models rely also on statistical (empirical) descriptions of processes at varying levels of abstraction.</p><p id="P3">Mechanistic models have model parameters that are either specified directly or fitted to data. A great advantage of mechanistic models is that they explicitly link known physical constants with process representations (e.g., molecular mass of CO<sub>2</sub> for diffusion and assimilation, or the gravitational constant and viscosity of water for its transport and transpiration). Other parameters may be specified based on independent measurements under controlled conditions (e.g., the activation energy of Arrhenius-type metabolic rates), or represent measurable plant functional traits, taken as constant over time and within plant functional types (PFTs - the basic unit in mechanistic vegetation models). Both types of parameters have traditionally been specified in models directly (‘direct parameterization’, (<xref ref-type="bibr" rid="R11">Hartig et al., 2012</xref>)). Yet other model parameters may not be directly observable and describe processes that are not explicitly resolved but can be described at a higher level of abstraction. Such parameters are often fitted to data such that the agreement between one (or several) related model predictions and observations is optimised. Parameter estimation for mechanistic vegetation models typically employs generic optimization algorithms or Bayesian statistical approaches and is often used for specifying diverse types of parameters (except for universal physical constants). Bayesian methods have the advantage that they enable a systematic assessment of the correlation structure among multiple fitted parameters, provide a means for considering uncertainty in observations and available prior information, and generate probabilistic parameter estimations and model predictions (<xref ref-type="bibr" rid="R6">Dietze et al., 2018</xref>; <xref ref-type="bibr" rid="R11">Hartig et al., 2012</xref>; <xref ref-type="bibr" rid="R24">Van Oijen et al., 2005</xref>).</p><p id="P4">As the number of parameters increases in state-of-the-art mechanistic vegetation models, taking into account multiple PFTs and ecosystem components (e.g. soil, microbes, hydrology), larger amounts of data and computing resources are required to fully explore the parameter space (<xref ref-type="bibr" rid="R11">Hartig et al., 2012</xref>). This poses a limitation for systematic model-data integration and Bayesian parameter estimation. Eco-evolutionary optimality (EEO) principles have been proposed for reducing model complexity and for a robust grounding of models in governing principles (<xref ref-type="bibr" rid="R8">Franklin et al., 2020</xref>; <xref ref-type="bibr" rid="R10">Harrison et al., 2021</xref>). They enable parameter-sparse representations, limit the distinction of separate PFTs, and may enable better model generalisations to novel environmental regimes. EEO principles make predictions of plant functional traits that would otherwise have to be prescribed – typically as temporally fixed model parameters. However, although parameter-sparse, EEO-based vegetation models are not devoid of model parameters. Ideally, remaining parameters represent known physical constants or quantities that can be measured independently. But remaining parameters in optimality models typically also represent quantities that are not directly measurable – e.g., the marginal cost of water in (<xref ref-type="bibr" rid="R3">Cowan and Farquhar, 1977</xref>), or the unit cost ratio in (<xref ref-type="bibr" rid="R18">Prentice et al., 2014</xref>). These are considered to be more universally valid (e.g., without distinctions between PFTs), but still must be fitted to data.</p><p id="P5">The P-model (<xref ref-type="bibr" rid="R18">Prentice et al., 2014</xref>; <xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>; Wang et al., 2017) is an example of an EEO-guided model for terrestrial photosynthesis and its acclimation. It avoids the requirement for prescribing PFT-specific parameters of photosynthesis and stomatal regulation but instead predicts them from universal EEO principles for the full range of environmental conditions across the Earth’s (C<sub>3</sub> photosynthesis-dominated) biomes. However, not directly observable parameters of the underlying EEO theory and of additional empirical parameterizations employed in the P-model (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>) remain and must be specified or fitted to data (<xref ref-type="table" rid="T2">Tab. 2</xref>).</p><p id="P6">Here, we provide a solution for this challenge, acknowledging that the data is an integral part of the modelling process (<xref ref-type="bibr" rid="R5">Dietze et al., 2013</xref>) - even in theory-based models of ecosystem processes. We show how the most important parameters contributing to uncertainty in the P-model can be estimated using observations of ecosystem-level photosynthetic CO<sub>2</sub> uptake (gross primary productivity, GPP). We provide a brief description of the theory embodied in the P-model and introduce the P-model implementation in the Simulating Optimal FUNctioning {rsofun} version v5.0 modelling framework, made available as an R package. A more comprehensive P-model description can be found in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>). We demonstrate the functionalities of {rsofun} through a case study for simulating GPP at a single flux measurement site. The case study includes sensitivity analysis, Bayesian model calibration, and inference – the prediction of GPP with an estimation of its uncertainty. This paper presents the calibration to GPP observations only, but the package allows calibration to multiple targets simultaneously, including fluxes and leaf traits.</p></sec><sec id="S2"><label>2</label><title>P-model description</title><p id="P7">The P-model predicts the acclimation of leaf-level photosynthesis to a (slowly varying) environment based on EEO principles. It thereby yields a parameter-sparse representation of ecosystem-level quantities, generalising across (C<sub>3</sub> photosynthesis-dominated) vegetation types and biomes. The P-model combines established theory for C<sub>3</sub> photosynthesis following the Farquhar-von Caemmerer-Berry (FvCB, (<xref ref-type="bibr" rid="R7">Farquhar et al., 1980</xref>)) model with the Least-Cost hypothesis for the optimal balancing of water loss and carbon gain (<xref ref-type="bibr" rid="R18">Prentice et al., 2014</xref>), and the coordination hypothesis (Wang et al., 2017), which states that the light and Rubisco-limited assimilation rates (as described by the FvCB model) are equal for representative daytime environmental conditions. Based on these theoretical foundations, gross primary productivity (GPP) can be modelled as the product of absorbed photosynthetically active radiation, specified by the locally measured photosynthetically active radiation (PAR) and remotely sensed fAPAR, and the theory-based prediction of the ecosystem-level light use efficiency (LUE) (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>; Wang et al., 2017). LUE acclimates to preceding environmental conditions with a characteristic, empirically determined (calibrated), time scale <italic>τ</italic>. Two latent (not directly observable) parameters govern the optimality-guided water-carbon trade-off: the unit cost ratio <italic>β</italic> (governing the balancing of maintaining the carboxylation capacity versus the transpiration stream) and <italic>c</italic>* (the marginal cost of maintaining the electron transport rate). These have previously been calibrated separately to data and specified as fixed model parameters in the P-model (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>; Wang et al., 2017). The theory for predicting acclimated LUE then requires only the atmospheric environment to be specified (meteorological variables and CO<sub>2</sub>). A set of corollary predictions, physically and physiologically consistent with the simulated LUE, follows. These include the acclimated base rates of photosynthetic capacities in the FvCB model (<italic>V</italic><sub>cmax25</sub> and <italic>J</italic><sub>max25</sub>), the acclimated average ratio of leaf internal-to-ambient CO<sub>2</sub> concentration (<italic>c</italic><sub>i</sub>:<italic>c</italic><sub>a</sub>), acclimated average daytime stomatal conductance (<italic>g</italic><sub>s</sub>), and the acclimated base rate of leaf dark respiration (<italic>R</italic><sub>d25</sub>). Physical constants and additional parameters that determine the instantaneous temperature dependence of <italic>V</italic><sub>cmax</sub>, <italic>J</italic><sub>max</sub>, <italic>R</italic><sub>d</sub>, and parameters in the FvCB model are prescribed and held fixed in the P-model (<xref ref-type="supplementary-material" rid="SD1">Tab. A2</xref> in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)).</p><p id="P8">For simulating GPP, the P-model is conceived as a single-big-leaf model (<xref ref-type="fig" rid="F1">Fig. 1</xref>). While describing leaf-level quantities at relatively high mechanistic detail, the link between the leaf and the canopy-scale is not explicitly resolved. Instead, an empirical approach for leaf-to-canopy scaling of CO<sub>2</sub> uptake is employed by treating the quantum yield parameter <italic>φ</italic><sub>0</sub> to be representative for the canopy-scale and allowing it to be calibrated to ecosystem-level CO<sub>2</sub> flux data. The implementation of the P-model in the {rsofun} package (version v5.0) further includes an empirical parameterization of the temperature dependency of the quantum yield <italic>φ</italic><sub>0</sub>, generalising the approach taken in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)), and an empirical soil moisture stress function, generalising the approach taken in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)) (Appendix A). Acclimating quantities are derived by employing the P-model theory to gradually varying environmental conditions where variations are damped and lagged by a characteristic (calibrated) time scale <italic>τ</italic>. The continuous treatment of the acclimation time scale is different from (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>), where monthly mean values of environmental variables were considered for the acclimation. The temperature dependency of <italic>φ</italic><sub>0</sub> can be turned off by setting <italic>a</italic> (see <xref ref-type="table" rid="T2">Tab. 2</xref> and <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>) to 0 (‘ORG’ model setup in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)). The soil moisture stress function can be turned off by setting <italic>β</italic><sub>0</sub> (see <xref ref-type="table" rid="T2">Tab. 2</xref> and <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>) to 1 (‘BRC’ model setup in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)). Taken together, the P-model approach is guided by EEO and thus yields predictions for quantities that otherwise must be prescribed and fitted to data. Yet, a small set of model parameters, related to empirical parametrizations and latent quantities remain and must be calibrated to data. See <xref ref-type="table" rid="T2">Tab. 2</xref> for a list of all (calibratable) model parameters of the P-model implementation in the {rsofun} package.</p></sec><sec id="S3"><label>3</label><title>The {rsofun} model framework</title><p id="P9">{rsofun} implements the P-model (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>) and provides off-the-shelf methods for Bayesian (probabilistic) parameter and prediction uncertainty estimation. {rsofun} is distributed as an R package on R’s central and public package repository. {rsofun} also implements the BiomeE vegetation demography model (Weng et al., 2019, <xref ref-type="bibr" rid="R27">2015</xref>). The latter is not further described here and is implemented at an experimental stage in {rsofun} version v5.0. The P-model implementation in {rsofun} is designed for time series simulations by accounting for temporal dependencies in the acclimation to a continuously varying environment (<xref ref-type="table" rid="T1">Tab. 1</xref>). Function wrappers in R make the simulation workflow user-friendly and all functions and input forcing data structures are comprehensively documented (<ext-link ext-link-type="uri" xlink:href="https://geco-bern.github.io/rsofun/">https://geco-bern.github.io/rsofun/</ext-link>).</p><p id="P10">In {rsofun}, model parameters can be calibrated using a calibration function `calib_sofun()`, providing two modes of calibration, one based on generalised simulated annealing ({GenSA} R package) for global optimization (<xref ref-type="bibr" rid="R28">Xiang et al., 2013</xref>) and one based on Markov chain Monte Carlo (MCMC) implemented by the {BayesianTools} R package, giving access to a wide variety of Bayesian methods (<xref ref-type="bibr" rid="R12">Hartig et al., 2023</xref>). The former being fast, while the latter provides more informed parameter optimization statistics (<xref ref-type="bibr" rid="R2">Clark, 2004</xref>; <xref ref-type="bibr" rid="R5">Dietze et al., 2013</xref>). This gives the option for both exploratory and more in-depth analysis of estimated parameters. A set of standard cost functions are provided for the calibration, facilitating the exploration of various metrics or target variables and the specification of calibrated model parameters. Furthermore, the vignettes accompanying the package (<ext-link ext-link-type="uri" xlink:href="https://geco-bern.github.io/rsofun/articles/">https://geco-bern.github.io/rsofun/articles/</ext-link>) explain how to customise the calibration cost functions and interpret the calibration results.</p></sec><sec id="S4"><label>4</label><title>Case study</title><p id="P11">We use {rsofun} to model GPP as estimated from ecosystem flux measurements taken at one site using the eddy-covariance technique. The site, selected here for demonstration purposes, is Puéchabon (<xref ref-type="bibr" rid="R19">Rambal et al., 2004</xref>), an evergreen Mediterranean forest, dominated by <italic>Quercus ilex</italic>, growing on relatively shallow soil on karstic bedrock, and located in southern France. The climate is governed by a distinct seasonality in solar radiation and temperature, peaking in summer, and a dry period during summer months with recurrent ecosystem water limitation in late summer (<xref ref-type="bibr" rid="R19">Rambal et al., 2004</xref>). Data used here cover years 2007-2012. Both the model target data (GPP) and model forcing data (see <xref ref-type="fig" rid="F1">Fig. 1</xref>) were measured at the site and obtained from the FLUXNET2015 dataset (Pastorello et al., 2021). Data for years 2013 and 2014 were available from FLUXNET2015 but removed here due to unexpectedly low GPP measurements (<italic>pers. comm. Jean-Marc Limousin</italic>).</p><sec id="S5"><label>4.1</label><title>Sensitivity analysis</title><p id="P12">The P-model implementation in {rsofun} has a total of nine model parameters that are available for calibration (<xref ref-type="table" rid="T2">Tab. 2</xref>). Due to the relatively high computational cost of simultaneously calibrating all nine model parameters, we start by performing a sensitivity analysis to determine the most influential parameters on the model fit and exclude the least influential ones for the subsequent calibration step. Here, we apply the Morris method for global sensitivity analysis (Morris, 1991) from the {sensitivity} R package (Looss et al., 2023) and compute the sensitivity metrics <italic>μ</italic>*, indicating the magnitude of the overall influence of a given parameter on the prediction, and <italic>σ</italic>, a measure of the heterogeneity of a parameter’s influence on the prediction across the parameter space. We assume an additive and normally distributed model error term for the GPP prediction by the P-model (<xref ref-type="bibr" rid="R23">Trotsiuk et al., 2020</xref>) and express the fit to observed data via the Gaussian log-likelihood. The sensitivity analysis result (<xref ref-type="fig" rid="F2">Fig. 2</xref>) indicates that the quantum yield intercept parameter <italic>φ</italic><sub>0</sub> is the most influential parameter, followed by the unit cost of electron transport <italic>c*</italic> and the optimal temperature for the quantum yield <italic>b</italic>. The remaining parameters have relatively little influence on the evaluation of daily GPP predictions from the single site considered here and <italic>b</italic><sub>0</sub>, the ratio of dark respiration to the temperature-normalised maximum carboxylation rate, has no influence on GPP predictions, which follows from the model structure. Additional analyses (not shown here) indicated that the convergence of the parameter calibration (shown in the next section) is undermined when calibrating <italic>β</italic> and <italic>c</italic>* simultaneously with other model parameters. Therefore, and based on the sensitivity analysis (<xref ref-type="fig" rid="F2">Fig. 2</xref>), we chose to hold <italic>c</italic>, <italic>β, τ</italic>, and <italic>b</italic><sub>0</sub> constant and thereby excluded them from the Bayesian calibration procedure described in the next section.</p></sec><sec id="S6"><label>4.2</label><title>Bayesian calibration</title><p id="P13">We simultaneously calibrate a subset of the model parameters that have been identified as particularly influential (<xref ref-type="sec" rid="S5">Sec. 4.1.</xref>). These include the model error term, <italic>φ</italic><sub>0</sub>, <italic>a, b, θ</italic>* and <italic>β</italic><sub>0</sub>. We use the Differential-Evolution MCMC zs (DEzs) sampler (<xref ref-type="bibr" rid="R22">Ter Braak and Vrugt, 2008</xref>), implemented in {BayesianTools} (<xref ref-type="bibr" rid="R12">Hartig et al., 2023</xref>), to estimate the posterior distribution of the calibrated parameters (<xref ref-type="fig" rid="F3">Fig. 3</xref>). All parameters are given a uniform prior with bounds informed by their physical interpretations (<xref ref-type="table" rid="T2">Tab. 2</xref>). The prediction error is assumed to be normally distributed, as in the Morris analysis. On a 12th Gen Intel Core i7-1270P processor, it took 1100 sec. to run 3 independent MCMC chains of 24000 iterations (of which 12000 are discarded as burn-in period). The algorithm converged with a scale reduction factor (<xref ref-type="bibr" rid="R9">Gelman and Rubin, 1992</xref>) of 1.05 (≤1.1). More detail, examples, and explanations of calibration diagnostics are provided through the example vignettes in the package documentation or can be inferred directly from archived the scripts used to create the results (for both, see Sections on <xref ref-type="sec" rid="S11">Code availability</xref> and <xref ref-type="sec" rid="S12">Data availability</xref>). The calculation of the log-likelihood is implemented in the function `cost_likelihood_pmodel()`, enabling custom calibrations, also for multiple target variables that are considered simultaneously during model calibration (examples also provided in the package documentation).</p></sec><sec id="S7"><label>4.3</label><title>Inference and prediction uncertainty estimation</title><p id="P14">The parameter sets generated by the MCMC chains provide the basis for inference (model prediction) and prediction uncertainty estimation, allowing us to get insights into the sources of uncertainty. We consider a simple representation of the uncertainty, split between the parameter uncertainty and the model error (<xref ref-type="bibr" rid="R4">Dietze, 2017</xref>).</p><p id="P15">Retaining 600 samples from the combined Markov chains, statistically representative of the joint parameter posterior distribution (estimated during the calibration), we ran the P-model for each set of parameters to predict GPP. The credible interval was computed for each time step from the posterior distribution of predicted GPP. The prediction interval for GPP was computed by adding the Gaussian error standard deviation error, to the predicted GPP. <xref ref-type="fig" rid="F4">Fig. 4</xref> shows that the uncertainty ascribable to the parameters (in green) is much smaller than the uncertainty due to the model error (orange area). A point estimate of GPP at each time step is calculated as the median of the posterior distribution of GPP (dark orange line).</p></sec></sec><sec id="S8" sec-type="discussion"><label>5</label><title>Discussion</title><p id="P16">The {rsofun} R package provides a user-friendly and fast implementation of the P-model. It implements off-the-shelf model-data assimilation routines with simple function calls, while maintaining flexibility for future experiments and further development of model uncertainty estimation. The {rsofun} vegetation modelling framework is designed to strike a balance between integration and flexibility, enabled by extensible and user-defined calibration specifications and the parallelizable and fast low-level code implementation in Fortran. Its high computational efficiency offers the potential for effective model parameter and uncertainty estimation using Bayesian statistical methods - as demonstrated here.</p><p id="P17">With the function `calib_sofun()`, {rsofun} provides a blueprint for model-data assimilation and an implementation of the likelihood function with flexibility in selecting among a predefined list of model parameters and target observations. We have demonstrated here how ecosystem flux measurements of GPP from a single site can be used to estimate model parameters of the P-model and generate estimations of prediction uncertainty. The approach taken here (as in previous studies with the P-model) was to specify latent parameters directly, based on independent observations. In (Wang et al., 2017), <italic>β</italic> and <italic>c</italic>* were determined from observations of <italic>V</italic><sub>cmax</sub>, <italic>J</italic><sub>max</sub>, and <italic>c</italic><sub>i</sub><italic>:c</italic><sub>a</sub>. These were then used as constants for modelling GPP, while additional parameters related to empirical photosynthesis stress parameterizations were calibrated to GPP observations. Exploratory analyses (not shown) indicated that complementary observational constraints are necessary when calibrating <italic>β</italic> and <italic>c</italic>* simultaneously with other model parameters. We have thus followed a simplified setup - used here for demonstration purposes. Future applications may use <italic>V</italic><sub>cmax</sub>, <italic>J</italic><sub>max</sub>, or <italic>c</italic><sub>i</sub><italic>:c</italic><sub>a</sub> data directly as additional calibration targets to provide such complementary constraints. Note also that the FvCB photosynthesis model contains additional parameters (see <xref ref-type="supplementary-material" rid="SD1">Tab. A2</xref> in (<xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>)) that are treated as constants here - as in previous publications (<xref ref-type="bibr" rid="R1">Bloomfield et al., 2023</xref>; <xref ref-type="bibr" rid="R16">Mengoli et al., 2022</xref>; <xref ref-type="bibr" rid="R20">Stocker et al., 2020</xref>; <xref ref-type="bibr" rid="R21">Tan et al., 2021</xref>; Wang et al., 2017).</p><p id="P18">Our model implementation as an R package takes inspiration from the {r3PG} forest model (<xref ref-type="bibr" rid="R23">Trotsiuk et al., 2020</xref>), and our implementation of model-data integration on the basis of ecosystem data serves similar, yet reduced, aims and functionalities compared to PEcAn (<ext-link ext-link-type="uri" xlink:href="https://pecanproject.github.io/index.html">https://pecanproject.github.io/index.html</ext-link>) (<xref ref-type="bibr" rid="R13">LeBauer et al., 2013</xref>). {rsofun} is designed to be minimally reliant on package dependencies and connections to specific data, while limiting the scope to a predefined set of process models (currently P-model, BiomeE at an experimentation stage). Note that the {rpmodel} R package (available on CRAN) also provides an implementation of the P-model but is written fully in R and in the form of a function of a given environment - without a treatment of temporal dependencies and without the functionalities for model-data integration.</p></sec><sec id="S9" sec-type="conclusions"><label>6</label><title>Conclusions</title><p id="P19">We have demonstrated how important parameters contributing to uncertainty in GPP predictions by the P-model can be estimated using observations of ecosystem-level photosynthetic CO<sub>2</sub> uptake flux time series. The Bayesian approach to model-data integration enables a probabilistic prediction of GPP and estimation of model parameters. The {rsofun} model implementation as an R package makes it possible to leverage a set of methods and complementary libraries for parameter estimation, sensitivity analysis, and calibration diagnostics - as demonstrated here. Its low-level code in Fortran is geared towards computational efficiency. Provision of {rsofun} as an open-access library aims at lowering the bar of entry to vegetation modelling for both field ecologists and computational ecologists and serves as an Open Science resource for future model development and experimentation and the further development of model uncertainty estimation.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Materials</label><media xlink:href="EMS191756-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d29aAcGbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S10"><title>Acknowledgements</title><p>We thank Florian Hartig for advice on uncertainty modelling and the maintenance of the BayesianTools package, Volodymyr Trotsiuk for an initial template of the R package, and Colin Prentice for comments on the manuscript. B.D.S. was funded by the Swiss National Science Foundation grant PCEFP2_181115. This work is a contribution to the LEMONTREE (Land Ecosystem Models based On New Theory, obseRvations and ExperimEnts) project, funded through the generosity of Eric and Wendy Schmidt by recommendation of the Schmidt Futures program (K.H., B.D.S.).</p></ack><sec id="S11" sec-type="data-availability"><title>Data availability</title><p id="P20">The model forcing and evaluation data is based on the publicly available FLUXNET2015 data for the site FR-Pue, prepared by FluxDataKit v3.4.2 (10.5281/zenodo.14808331), taken here as a subset of the originally published data for years 2007-2012. It is accessible through the {rsofun} R package and contained as part of the repository (subdirectory ‘data/’) as CSV and as files. Outputs of the analysis presented here are archived in the ‘analysis/paper_results_files/’ subfolder.</p></sec><sec id="S12" sec-type="data-availability"><title>Code availability</title><p id="P21">The {rsofun} R package can be installed from CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=rsofun">https://cran.r-project.org/package=rsofun</ext-link>) or directly from its source code on GitHub (publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/geco-bern/rsofun">https://github.com/geco-bern/rsofun</ext-link> under an AGPLv3 licence). Versioned releases of the GitHub repository are deposited on Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.14264892">https://doi.org/10.5281/zenodo.14264892</ext-link>). Code to reproduce the analysis and plots presented here is contained in the repository (subdirectory ‘analysis/’) and is demonstrated on the model documentation website (<ext-link ext-link-type="uri" xlink:href="https://geco-bern.github.io/rsofun/">https://geco-bern.github.io/rsofun/</ext-link>, article ‘Sensitivity analysis and calibration interpretation’).</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P22"><bold>Author contribution</bold></p><p id="P23">B.D.S. wrote the Fortran code and designed the study. K.H. initiated the implementation of the calibration procedure and wrote the initial draft of the manuscript. J.A.P. documented the package, implemented the Bayesian calibration, sensitivity analysis and uncertainty estimation, and contributed to manuscript writing. M.M. and F.B. prepared the package for publication to CRAN and finalized the manuscript.</p></fn><fn fn-type="conflict" id="FN2"><p id="P24"><bold>Competing interests</bold></p><p id="P25">The authors declare that they have no conflict of interest.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloomfield</surname><given-names>KJ</given-names></name><name><surname>van Hoolst</surname><given-names>R</given-names></name><name><surname>Balzarolo</surname><given-names>M</given-names></name><name><surname>Janssens</surname><given-names>IA</given-names></name><name><surname>Vicca</surname><given-names>S</given-names></name><name><surname>Ghent</surname><given-names>D</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name></person-group><article-title>Towards a General Monitoring System for Terrestrial Primary Production: A Test Spanning the European Drought of 2018</article-title><source>Remote Sensing</source><year>2023</year><volume>15</volume><fpage>1693</fpage><pub-id pub-id-type="doi">10.3390/rs15061693</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>JS</given-names></name></person-group><article-title>Why environmental scientists are becoming Bayesians: Modelling with Bayes</article-title><source>Ecology Letters</source><year>2004</year><volume>8</volume><fpage>2</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2004.00702.x</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname><given-names>IR</given-names></name><name><surname>Farquhar</surname><given-names>GD</given-names></name></person-group><article-title>Stomatal function in relation to leaf metabolism and environment</article-title><source>Integration of Activity in the Higher Plant</source><year>1977</year><fpage>471</fpage><lpage>505</lpage><pub-id pub-id-type="pmid">756635</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dietze</surname><given-names>MC</given-names></name></person-group><source>Ecological Forecasting</source><publisher-name>Princeton University Press</publisher-name><year>2017</year><pub-id pub-id-type="doi">10.2307/j.ctvc7796h</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dietze</surname><given-names>MC</given-names></name><name><surname>Lebauer</surname><given-names>DS</given-names></name><name><surname>Kooper</surname><given-names>R</given-names></name></person-group><article-title>On improving the communication between models and data</article-title><source>Plant, Cell &amp; Environment</source><year>2013</year><volume>36</volume><fpage>1575</fpage><lpage>1585</lpage><pub-id pub-id-type="pmid">23181765</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dietze</surname><given-names>MC</given-names></name><name><surname>Fox</surname><given-names>A</given-names></name><name><surname>Beck-Johnson</surname><given-names>LM</given-names></name><name><surname>Betancourt</surname><given-names>JL</given-names></name><name><surname>Hooten</surname><given-names>MB</given-names></name><name><surname>Jarnevich</surname><given-names>CS</given-names></name><name><surname>Keitt</surname><given-names>TH</given-names></name><name><surname>Kenney</surname><given-names>MA</given-names></name><name><surname>Laney</surname><given-names>CM</given-names></name><name><surname>Larsen</surname><given-names>LG</given-names></name><name><surname>Loescher</surname><given-names>HW</given-names></name><etal/></person-group><article-title>Iterative near-term ecological forecasting: Needs, opportunities, and challenges</article-title><source>Proc Natl Acad Sci USA</source><year>2018</year><volume>115</volume><fpage>1424</fpage><lpage>1432</lpage><pub-id pub-id-type="pmcid">PMC5816139</pub-id><pub-id pub-id-type="pmid">29382745</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1710231115</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farquhar</surname><given-names>GD</given-names></name><name><surname>Caemmerer</surname><given-names>S</given-names></name><name><surname>Berry</surname><given-names>J</given-names></name></person-group><article-title>A biochemical model of photosynthetic CO 2 assimilation in leaves of C 3 species</article-title><source>Planta</source><year>1980</year><volume>149</volume><fpage>78</fpage><lpage>90</lpage><pub-id pub-id-type="pmid">24306196</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname><given-names>O</given-names></name><name><surname>Harrison</surname><given-names>SP</given-names></name><name><surname>Dewar</surname><given-names>R</given-names></name><name><surname>Farrior</surname><given-names>CE</given-names></name><name><surname>Brännström</surname><given-names>Å</given-names></name><name><surname>Dieckmann</surname><given-names>U</given-names></name><name><surname>Pietsch</surname><given-names>S</given-names></name><name><surname>Falster</surname><given-names>D</given-names></name><name><surname>Cramer</surname><given-names>W</given-names></name><name><surname>Loreau</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><etal/></person-group><article-title>Organizing principles for vegetation dynamics</article-title><source>Nat Plants</source><year>2020</year><volume>6</volume><fpage>444</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">32393882</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Inference from Iterative Simulation Using Multiple Sequences</article-title><source>Statist Sci</source><year>1992</year><volume>7</volume><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrison</surname><given-names>SP</given-names></name><name><surname>Cramer</surname><given-names>W</given-names></name><name><surname>Franklin</surname><given-names>O</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Brännström</surname><given-names>Å</given-names></name><name><surname>de Boer</surname><given-names>H</given-names></name><name><surname>Dieckmann</surname><given-names>U</given-names></name><name><surname>Joshi</surname><given-names>J</given-names></name><name><surname>Keenan</surname><given-names>TF</given-names></name><name><surname>Lavergne</surname><given-names>A</given-names></name><etal/></person-group><article-title>Eco-evolutionary optimality as a means to improve vegetation and land-surface models</article-title><source>New Phytologist</source><year>2021</year><volume>231</volume><fpage>2125</fpage><lpage>2141</lpage><pub-id pub-id-type="pmid">34131932</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartig</surname><given-names>F</given-names></name><name><surname>Dyke</surname><given-names>J</given-names></name><name><surname>Hickler</surname><given-names>T</given-names></name><name><surname>Higgins</surname><given-names>SI</given-names></name><name><surname>O’Hara</surname><given-names>RB</given-names></name><name><surname>Scheiter</surname><given-names>S</given-names></name><name><surname>Huth</surname><given-names>A</given-names></name></person-group><article-title>Connecting dynamic vegetation models to data - an inverse perspective: Dynamic vegetation models - an inverse perspective</article-title><source>J Biogeogr</source><year>2012</year><volume>39</volume><fpage>2240</fpage><lpage>2252</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2699.2012.02745.x</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartig</surname><given-names>F</given-names></name><name><surname>Minunno</surname><given-names>F</given-names></name><name><surname>Paul</surname><given-names>S</given-names></name><name><surname>Cameron</surname><given-names>D</given-names></name><name><surname>Ott</surname><given-names>T</given-names></name><name><surname>Pichler</surname><given-names>M</given-names></name></person-group><article-title>BayesianTools: General-Purpose MCMC and SMC Samplers and Tools for Bayesian Statistics</article-title><year>2023</year></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeBauer</surname><given-names>DS</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Richter</surname><given-names>KT</given-names></name><name><surname>Davidson</surname><given-names>CC</given-names></name><name><surname>Dietze</surname><given-names>MC</given-names></name></person-group><article-title>Facilitating feedbacks between field measurements and ecosystem models</article-title><source>Ecological Monographs</source><year>2013</year><volume>83</volume><fpage>133</fpage><lpage>154</lpage></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marquet</surname><given-names>PA</given-names></name><name><surname>Allen</surname><given-names>AP</given-names></name><name><surname>Brown</surname><given-names>JH</given-names></name><name><surname>Dunne</surname><given-names>JA</given-names></name><name><surname>Enquist</surname><given-names>BJ</given-names></name><name><surname>Gillooly</surname><given-names>JF</given-names></name><name><surname>Gowaty</surname><given-names>PA</given-names></name><name><surname>Green</surname><given-names>JL</given-names></name><name><surname>Harte</surname><given-names>J</given-names></name><name><surname>Hubbell</surname><given-names>SP</given-names></name><name><surname>O’Dwyer</surname><given-names>J</given-names></name><etal/></person-group><article-title>On Theory in Ecology</article-title><source>BioScience</source><year>2014</year><volume>64</volume><fpage>701</fpage><lpage>710</lpage><pub-id pub-id-type="doi">10.1093/biosci/biu098</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Medlyn</surname><given-names>BE</given-names></name><name><surname>Dreyer</surname><given-names>E</given-names></name><name><surname>Ellsworth</surname><given-names>D</given-names></name><name><surname>Forstreuter</surname><given-names>M</given-names></name><name><surname>Harley</surname><given-names>PC</given-names></name><name><surname>Kirschbaum</surname><given-names>MUF</given-names></name><name><surname>Le Roux</surname><given-names>X</given-names></name><name><surname>Montpied</surname><given-names>P</given-names></name><name><surname>Strassemeyer</surname><given-names>J</given-names></name><name><surname>Walcroft</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><etal/></person-group><article-title>Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data</article-title><source>Plant, Cell &amp; Environment</source><year>2002</year><volume>25</volume><fpage>1167</fpage><lpage>1179</lpage><pub-id pub-id-type="doi">10.1046/j.1365-3040.2002.00891.x</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mengoli</surname><given-names>G</given-names></name><name><surname>Agustí-Panareda</surname><given-names>A</given-names></name><name><surname>Boussetta</surname><given-names>S</given-names></name><name><surname>Harrison</surname><given-names>SP</given-names></name><name><surname>Trotta</surname><given-names>C</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name></person-group><article-title>Ecosystem Photosynthesis in Land-Surface Models: A First-Principles Approach Incorporating Acclimation</article-title><source>Journal of Advances in Modeling Earth Systems</source><year>2022</year><volume>14</volume><elocation-id>e2021MS002767</elocation-id><pub-id pub-id-type="doi">10.1029/2021MS002767</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastorello</surname><given-names>G</given-names></name><name><surname>Trotta</surname><given-names>C</given-names></name><name><surname>Canfora</surname><given-names>E</given-names></name><name><surname>Chu</surname><given-names>H</given-names></name><name><surname>Christianson</surname><given-names>D</given-names></name><name><surname>Cheah</surname><given-names>Y-W</given-names></name><name><surname>Poindexter</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Elbashandy</surname><given-names>A</given-names></name><name><surname>Humphrey</surname><given-names>M</given-names></name><name><surname>Isaac</surname><given-names>P</given-names></name><etal/></person-group><article-title>The FLUXNET2015 dataset and the ONEFlux processing pipeline for eddy covariance data</article-title><source>Sci Data</source><year>2020</year><volume>7</volume><fpage>225</fpage><pub-id pub-id-type="pmcid">PMC7347557</pub-id><pub-id pub-id-type="pmid">32647314</pub-id><pub-id pub-id-type="doi">10.1038/s41597-020-0534-3</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prentice</surname><given-names>IC</given-names></name><name><surname>Dong</surname><given-names>N</given-names></name><name><surname>Gleason</surname><given-names>SM</given-names></name><name><surname>Maire</surname><given-names>V</given-names></name><name><surname>Wright</surname><given-names>IJ</given-names></name></person-group><article-title>Balancing the costs of carbon gain and water transport: testing a new theoretical framework for plant functional ecology</article-title><source>Ecol Lett</source><year>2014</year><volume>17</volume><fpage>82</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">24215231</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rambal</surname><given-names>S</given-names></name><name><surname>Joffre</surname><given-names>R</given-names></name><name><surname>Ourcival</surname><given-names>JM</given-names></name><name><surname>Cavender-Bares</surname><given-names>J</given-names></name><name><surname>Rocheteau</surname><given-names>A</given-names></name></person-group><article-title>The growth respiration component in eddy CO2 flux from a Quercus ilex mediterranean forest</article-title><source>Global Change Biology</source><year>2004</year><volume>10</volume><fpage>1460</fpage><lpage>1469</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2486.2004.00819.x</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stocker</surname><given-names>BD</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Smith</surname><given-names>NG</given-names></name><name><surname>Harrison</surname><given-names>SP</given-names></name><name><surname>Keenan</surname><given-names>TF</given-names></name><name><surname>Sandoval</surname><given-names>D</given-names></name><name><surname>Davis</surname><given-names>T</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name></person-group><article-title>P-model v1.0: an optimality-based light use efficiency model for simulating ecosystem gross primary production</article-title><source>Geoscientific Model Development</source><year>2020</year><volume>13</volume><fpage>1545</fpage><lpage>1581</lpage><pub-id pub-id-type="doi">10.5194/gmd-13-1545-2020</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name><name><surname>Yang</surname><given-names>K</given-names></name></person-group><article-title>Land-surface evapotranspiration derived from a first-principles primary production model</article-title><source>Environ Res Lett</source><year>2021</year><volume>16</volume><elocation-id>104047</elocation-id><pub-id pub-id-type="doi">10.1088/1748-9326/ac29eb</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braak</surname><given-names>Ter</given-names></name><name><surname>Vrugt</surname><given-names>JA</given-names></name></person-group><article-title>Differential Evolution Markov Chain with snooker updater and fewer chains</article-title><source>Stat Comput</source><year>2008</year><volume>18</volume><fpage>435</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1007/s11222-008-9104-9</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trotsiuk</surname><given-names>V</given-names></name><name><surname>Hartig</surname><given-names>F</given-names></name><name><surname>Forrester</surname><given-names>DI</given-names></name></person-group><article-title>r3PG – An r package for simulating forest growth using the 3-PG process-based model</article-title><source>Methods Ecol Evol</source><year>2020</year><volume>11</volume><fpage>1470</fpage><lpage>1475</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.13474</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Oijen</surname><given-names>M</given-names></name><name><surname>Rougier</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>R</given-names></name></person-group><article-title>Bayesian calibration of process-based forest models: bridging the gap between models and data</article-title><source>Tree Physiology</source><year>2005</year><volume>25</volume><fpage>915</fpage><lpage>927</lpage><pub-id pub-id-type="pmid">15870058</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name><name><surname>Davis</surname><given-names>TW</given-names></name><name><surname>Keenan</surname><given-names>TF</given-names></name><name><surname>Wright</surname><given-names>IJ</given-names></name><name><surname>Peng</surname><given-names>C</given-names></name></person-group><article-title>Photosynthetic responses to altitude: an explanation based on optimality principles</article-title><source>New Phytol</source><year>2017a</year><volume>213</volume><fpage>976</fpage><lpage>982</lpage><pub-id pub-id-type="pmid">27859388</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Prentice</surname><given-names>IC</given-names></name><name><surname>Keenan</surname><given-names>TF</given-names></name><name><surname>Davis</surname><given-names>TW</given-names></name><name><surname>Wright</surname><given-names>IJ</given-names></name><name><surname>Cornwell</surname><given-names>WK</given-names></name><name><surname>Evans</surname><given-names>BJ</given-names></name><name><surname>Peng</surname><given-names>C</given-names></name></person-group><article-title>Towards a universal model for carbon dioxide uptake by plants</article-title><source>Nature Plants</source><year>2017b</year><volume>3</volume><fpage>734</fpage><lpage>741</lpage><pub-id pub-id-type="pmid">29150690</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weng</surname><given-names>ES</given-names></name><name><surname>Malyshev</surname><given-names>S</given-names></name><name><surname>Lichstein</surname><given-names>JW</given-names></name><name><surname>Farrior</surname><given-names>CE</given-names></name><name><surname>Dybzinski</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Shevliakova</surname><given-names>E</given-names></name><name><surname>Pacala</surname><given-names>SW</given-names></name></person-group><article-title>Scaling from individual trees to forests in an Earth system modeling framework using a mathematically tractable model of height-structured competition</article-title><source>Biogeosciences</source><year>2015</year><volume>12</volume><fpage>2655</fpage><lpage>2694</lpage><pub-id pub-id-type="doi">10.5194/bg-12-2655-2015</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>Y</given-names></name><name><surname>Gubian</surname><given-names>S</given-names></name><name><surname>Suomela</surname><given-names>B</given-names></name><name><surname>Hoeng</surname><given-names>J</given-names></name></person-group><article-title>Generalized Simulated Annealing for Global Optimization: The GenSA Package</article-title><source>The R Journal</source><year>2013</year><volume>5</volume><fpage>13</fpage><pub-id pub-id-type="doi">10.32614/RJ-2013-002</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>P-model inputs, outputs, and target observations for the calibration.</title><p>The model takes as inputs static site information (longitude, latitude, elevation and root zone water storage capacity), time series of meteorological forcings (listed in <xref ref-type="table" rid="T1">Tab. 1</xref>), simulation parameters (spinup years, recycle period length, vegetation type (evergreen, deciduous, grass (C3/C4) with/without N-fixation) and, common for all sites, model parameters (listed in <xref ref-type="table" rid="T2">Tab. 2</xref>). The simulation returns a time series of several ecosystem fluxes, acclimating leaf traits and ecosystem water balance quantities. By comparing these outputs to field measurements and flux data in a Bayesian calibration routine, model parameters can be estimated.</p></caption><graphic xlink:href="EMS191756-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Results from the Morris sensitivity analysis.</title><p>The y-axis represents all nine model parameters and the Gaussian error standard deviation (error_gpp) and the x-axis the values of the statistics <italic>μ</italic>* and <italic>σ</italic> (unitless, like the log-likelihood). <italic>μ</italic>* indicates the magnitude of the overall influence of a certain parameter on the P-model output, while <italic>σ</italic> measures the heterogeneity of such influence across the parameter space. The parameter names are described and identified with corresponding symbols in <xref ref-type="table" rid="T2">Tab. 2</xref>.</p></caption><graphic xlink:href="EMS191756-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Prior and posterior distributions of the calibrated model parameters and error term.</title><p>The maximum a posteriori (MAP) estimate for the gaussian error standard deviation is 1.06 and the estimate for each calibrated parameter are given in <xref ref-type="table" rid="T2">Tab. 2</xref>.</p></caption><graphic xlink:href="EMS191756-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Predicted and observed daily mean GPP.</title><p>The comparison is provided for the first year of GPP observations (black dots) at the site FR-Pue against GPP predictions (red line), calculated as the median of the posterior distribution. A light green band indicates the 90% credible interval for GPP predictions, which captures parameter uncertainty, while the 90% predictive interval for GPP predictions (in orange) captures model uncertainty.</p></caption><graphic xlink:href="EMS191756-f004"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Forcing time series.</title><p>Daily time series of the following meteorological variables are required for simulation. If a spin-up period is specified, the corresponding years are recycled for the spin-up.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top" align="left">Parameter name</th><th valign="top" align="left">Description</th><th valign="top" align="left">Units</th></tr></thead><tbody><tr><td valign="top" align="left">temp</td><td valign="top" align="left">Daytime average air temperature</td><td valign="top" align="left">°C</td></tr><tr><td valign="top" align="left">tmin</td><td valign="top" align="left">Daily minimum air temperature</td><td valign="top" align="left">°C</td></tr><tr><td valign="top" align="left">tmax</td><td valign="top" align="left">Daily maximum air temperature</td><td valign="top" align="left">°C</td></tr><tr><td valign="top" align="left">vpd</td><td valign="top" align="left">Daytime average vapour pressure deficit</td><td valign="top" align="left">Pa</td></tr><tr><td valign="top" align="left">ppfd</td><td valign="top" align="left">Photosynthetic photon flux density (PPFD)</td><td valign="top" align="left">mol m<sup>−2</sup> s <sup>−1</sup></td></tr><tr><td valign="top" align="left">netrad</td><td valign="top" align="left">Net radiation</td><td valign="top" align="left">W m<sup>−2</sup></td></tr><tr><td valign="top" align="left">patm</td><td valign="top" align="left">Atmospheric pressure</td><td valign="top" align="left">Pa</td></tr><tr><td valign="top" align="left">rain</td><td valign="top" align="left">Rainfall as precipitation in liquid form</td><td valign="top" align="left">mm s<sup>−1</sup></td></tr><tr><td valign="top" align="left">snow</td><td valign="top" align="left">Snowfall in water equivalents</td><td valign="top" align="left">mm s<sup>−1</sup></td></tr><tr><td valign="top" align="left">fapar</td><td valign="top" align="left">Fraction of photosynthetic active radiation (fAPAR)</td><td valign="top" align="left">unitless</td></tr><tr><td valign="top" align="left">ccov</td><td valign="top" align="left">Cloud coverage</td><td valign="top" align="left">%</td></tr><tr><td valign="top" align="left">co2</td><td valign="top" align="left">Atmospheric CO<sub>2</sub> concentration</td><td valign="top" align="left">ppm</td></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="float"><label>Table 2</label><caption><title>Calibratable parameters in the {rsofun} P-model implementation.</title><p>The maximum a posteriori (MAP) estimates from the Bayesian model calibration (Sec. 4.2) are listed in column ‘Values’. The bounds of uniform prior distributions are given in parentheses. Parameters that were held fixed for the calibration are marked with an asterisk (*). Fixed site information was: longitude = 3.6°E, latitude = 43.7°N, elevation = 270 m a.s.l., and total root zone water storage capacity = 432 mm.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top" align="left">Symbol</th><th valign="top" align="left">Parameter name</th><th valign="top" align="left">Description</th><th valign="top" align="left">Units</th><th valign="top" align="left">Values</th></tr></thead><tbody><tr><td valign="top" align="left"><italic>φ</italic><sub>0</sub></td><td valign="top" align="left">kphio</td><td valign="top" align="left">Quantum yield at optimal temperature</td><td valign="top" align="left">mol mol<sup>−1</sup></td><td valign="top" align="left">0.041<break/>(0.02, 0.15)</td></tr><tr><td valign="top" align="left"><italic>a</italic></td><td valign="top" align="left">kphio_par_a</td><td valign="top" align="left">Shape parameter for the temperature dependence of the quantum yield</td><td valign="top" align="left">°C<sup>−2</sup></td><td valign="top" align="left">-0.0023<break/>(-0.004, -0.001)</td></tr><tr><td valign="top" align="left"><italic>b</italic></td><td valign="top" align="left">kphio_par_b</td><td valign="top" align="left">Optimal temperature for the quantum yield</td><td valign="top" align="left">°C</td><td valign="top" align="left">15.3<break/>(10, 30)</td></tr><tr><td valign="top" align="left"><italic>θ</italic>*</td><td valign="top" align="left">soilm_thetastar</td><td valign="top" align="left">Threshold plant-available soil water content in the soil moisture stress function</td><td valign="top" align="left">mm</td><td valign="top" align="left">158 (4.3, 432)</td></tr><tr><td valign="top" align="left"><italic>β</italic><sub>0</sub></td><td valign="top" align="left">soilm_betao</td><td valign="top" align="left">Stress factor at low soil moisture, intercept for the soil moisture stress function</td><td valign="top" align="left">unitless</td><td valign="top" align="left">0.0001<break/>(0, 1)</td></tr><tr><td valign="top" align="left"><italic>β</italic></td><td valign="top" align="left">beta_unitcostratio</td><td valign="top" align="left">Unit cost ratio of carboxylation (maintenance of <italic>V</italic><sub>cmax</sub>) to transpiration</td><td valign="top" align="left">unitless</td><td valign="top" align="left">146*</td></tr><tr><td valign="top" align="left"><italic>b</italic><sub>0</sub></td><td valign="top" align="left">rd_to_vcmax</td><td valign="top" align="left">Ratio of temperature-normalised dark respiration (<italic>R</italic><sub>d25</sub>) to the temperature-normalised maximum carboxylation rate <italic>V</italic><sub>cmax25</sub> (eq. C8 in <xref ref-type="bibr" rid="R20">Stocker et al. 2020</xref>)</td><td valign="top" align="left">unitless</td><td valign="top" align="left">0.014*</td></tr><tr><td valign="top" align="left"><italic>τ</italic></td><td valign="top" align="left">tau_acclim</td><td valign="top" align="left">Acclimation time scale of photosynthesis</td><td valign="top" align="left">days</td><td valign="top" align="left">20*</td></tr><tr><td valign="top" align="left"><italic>c*</italic></td><td valign="top" align="left">kc_jmax</td><td valign="top" align="left">Unit cost of electron transport (maintenance of <italic>J</italic><sub>max</sub>)</td><td valign="top" align="left">unitless</td><td valign="top" align="left">0.41*</td></tr></tbody></table></table-wrap></floats-group></article>