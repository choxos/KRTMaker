<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS190630</article-id><article-id pub-id-type="doi">10.1101/2023.11.02.565261</article-id><article-id pub-id-type="archive">PPR753509</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">3</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Predicting subject traits from brain spectral signatures: an application to brain ageing</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Jarnea</surname><given-names>Cecilia</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Griffin</surname><given-names>Ben</given-names></name><xref ref-type="aff" rid="A5">e</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Vidaurre</surname><given-names>Diego</given-names></name><xref ref-type="aff" rid="A3">c</xref></contrib></contrib-group><aff id="A1"><label>a</label>Departamento de Ciencia y Tecnologia de la Universidad Nacional de Quilmes, Bernal, Buenos Aires, Argentina</aff><aff id="A2"><label>b</label>CONICET, Buenos Aires, Argentina</aff><aff id="A3"><label>c</label>Center of Functionally Integrative Neuroscience, Department of Clinical Medicine, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/01aj84f44</institution-id><institution>Aarhus University</institution></institution-wrap>, <city>Aarhus</city>, <country country="DK">Denmark</country></aff><aff id="A4"><label>d</label>Nuffield Department of Clinical Neurosciences, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>Oxford University</institution></institution-wrap>, <city>Oxford</city>, <country country="GB">UK</country></aff><aff id="A5"><label>e</label>Oxford Centre for Human Brain Activity, Department of Psychiatry, <institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>Oxford University</institution></institution-wrap>, <city>Oxford</city>, <country country="GB">UK</country></aff><author-notes><corresp id="CR1"><email>dvidaurre@cfin.au.dk</email> (Diego Vidaurre) (Corresponding author))</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>06</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>04</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The prediction of subject traits using brain data is an important goal in neuroscience, with relevant applications in clinical research, as well as in the study of differential psychology and cognition. While previous prediction work has predominantly been done on neuroimaging data, our focus is on electroencephalography (EEG), a relatively inexpensive, widely available and non-invasive data modality. However, EEG data is complex and needs some form of feature extraction for subsequent prediction. This process is sometimes done manually, risking biases and suboptimal decisions. Here we investigate the use of data-driven kernel methods for prediction from single-channels using the the EEG spectrogram, which reflects macro-scale neural oscillations in the brain. Specifically, we introduce the idea of reinterpreting the the spectrogram of each channel as a probability distribution, so that we can leverage advanced machine learning techniques that can handle probability distributions with mathematical rigour and without the need for manual feature extraction. We explore how the resulting technique, Kernel Mean Embedding Regression, compares to a standard application of Kernel Ridge Regression as well as to a non-kernelised approach. Overall, we found that the kernel methods exhibit improved performance thanks to their capacity to handle nonlinearities in the relation between the EEG spectrogram and the trait of interest. We leveraged this method to predict biological age in a multinational EEG data set, HarMNqEEG, showing the method’s capacity to generalise across experiments and acquisition setups.</p></abstract><kwd-group><kwd>Kernel Mean Embedding Regression</kwd><kwd>Brain age</kwd><kwd>EEG</kwd><kwd>Machine Learning</kwd><kwd>Kernel methods</kwd><kwd>Maximum Mean Discrepancy</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">Predicting behavioural and cognitive traits from brain data in a way that generalises to unseen subjects and is robust to acquisition idiosyncrasies is important because it can offer objective measures to otherwise elusive neurobiological constructs (<xref ref-type="bibr" rid="R11">Haynes and Rees (2006)</xref>). A widely studied example is brain age. While measuring actual age is a straightforward task, the concept of brain age provides a marker of mental health by quantifying how much a subject’s brain appears to have aged with respect to the population average; that is, a predicted age that is lower than the individual’s chronological age, for example, may indicate that the person has a brain that appears younger than expected for their actual age (<xref ref-type="bibr" rid="R8">Franke and Gaser (2019)</xref>; <xref ref-type="bibr" rid="R22">Smith et al. (2019)</xref>).</p><p id="P3">Much of the work on the prediction of subject traits (such as age) from brain data has been done with resting-state fMRI data (<xref ref-type="bibr" rid="R6">Dosenbach et al. (2010)</xref>). Since we cannot straightforwardly predict from the raw data, an intermediate representation is typically used for prediction. In the case of fMRI, this is often a simple description of functional connectivity (<xref ref-type="bibr" rid="R19">Rosenberg et al. (2016)</xref>) or some model of brain dynamics (<xref ref-type="bibr" rid="R17">Liegeois et al. (2019)</xref>; <xref ref-type="bibr" rid="R28">Vidaurre et al. (2021)</xref>; <xref ref-type="bibr" rid="R1">Ahrends et al. (2023)</xref>). Here, we focus on EEG, a considerably less costly technique. As an intermediate representation, we consider the EEG frequency spectrum, reflecting neural oscillations that are well-known correlates of different behavioural and cognitive states (<xref ref-type="bibr" rid="R4">Buzsáki and Draguhn (2004)</xref>). How to meaningfully extract features for prediction from an EEG spectrum is an open question. Some current efforts are based on manual feature extraction (<xref ref-type="bibr" rid="R2">Al Zoubi et al. (2018)</xref>; <xref ref-type="bibr" rid="R7">Engemann et al. (2022)</xref>); or are based on models that need to be estimated from raw data and whose properties depend on the choice of configuration and hyperparameters (<xref ref-type="bibr" rid="R27">Vidaurre et al. (2013)</xref>).</p><p id="P4">In this paper, we present a method to predict from single-channel spectrograms, i.e. with no need of the raw data. In contrast to other works that make the predictions on whole brain’s signals (<xref ref-type="bibr" rid="R5">Dimitriadis and Salis (2017)</xref>; <xref ref-type="bibr" rid="R26">Vandenbosch et al. (2019)</xref>; <xref ref-type="bibr" rid="R20">Sabbagh et al. (2019)</xref>), sometimes with complex methods such as deep learning (<xref ref-type="bibr" rid="R14">Khayretdinova et al. (2022)</xref>), our approach has not only benefits in terms of computational simplicity but also for interpretation, as it allows us to compare the predictive power across sensors or brain regions. Specifically, with no prior predefinition of frequency bands or any manual feature engineering besides basic preprocessing, we propose the idea of interpreting the EEG spectrogram as a probability distribution. This way, we can fully leverage all the powerful machinery of kernel learning on probability distributions. We consider Kernel Mean Embeddings (KME), a technique used to construct a representation of the data in a high-dimensional feature space (<xref ref-type="bibr" rid="R23">Smola et al. (2007)</xref>; <xref ref-type="bibr" rid="R13">Iyer et al. (2014)</xref>; <xref ref-type="bibr" rid="R3">Borgwardt et al. (2006)</xref>). The KME technique maps joint, marginal and conditional probability distributions to vectors in a high (or even infinite) dimensional feature space that completely characterises the distribution (<xref ref-type="bibr" rid="R9">Fukumizu et al. (2011)</xref>). Building upon KME, we used the Maximum Mean Discrepancy (MMD) (<xref ref-type="bibr" rid="R23">Smola et al. (2007)</xref>), a distance metric defined on the space of probability measures (here, EEG spectrograms) in combination with kernel ridge regression (<xref ref-type="bibr" rid="R21">Saunders et al. (1998)</xref>). We refer to our approach as Kernel Mean Embedding Regression (KMER), which we compare to Kernel Ridge Regression (KRR) and Ridge Regression (RR).</p><p id="P5">We demonstrate the superior performance of the kernel approaches (both KMER and KRR) for age prediction. Using a multisite, public resting-state EEG dataset with a very wide distribution of age (HarMNqEEG, <xref ref-type="bibr" rid="R16">Li et al. (2022)</xref>), we show that these lead to better predictions, which can be projected on the EEG scalp for interpretation. Focusing on KMER, we show that parietal sensors are the most accurate in predicting age, with slightly greater accuracy in men. We also showed that the predictions generalise well across experiments and acquisition sites, even considering the large differences in age distribution across sites (a well-known problem in machine learning referred to as prior shift). Overall, by demonstrating its predictive capacity and interpretability, kernel methods can help unveil insights about brain age or other neurobiological constructs.</p></sec><sec id="S2" sec-type="results"><label>2</label><title>Results</title><sec id="S3"><label>2.1</label><title>Kernel mean embedding regression</title><p id="P6">We developed KMER, a novel method to predict subject traits from EEG spectrograms; see Methods and <xref ref-type="fig" rid="F1">Figure 1</xref>. In short, KMER is based on the idea of interpreting EEG spectrograms as probability distributions so that techniques based on kernel learning of distributions are readily applicable. By forming a subject-by-subject kernel matrix of similarities between subjects (using a Gaussian kernel; see Methods), this technique allowed us to derive predictions for each EEG channel that can naturally accommodate non-linearities in a data-driven way without the need for manual feature extraction.</p></sec><sec id="S4"><label>2.2</label><title>Comparison of performance between methods</title><p id="P7">First, compared KMER to: (i) RR, a regularised, linear regression method that uses the frequency bins’ power as features; and (ii) KRR, the kernelised version of RR, which allows the modelling of nonlinearities by the use of an appropriate kernel. Our experiments were based on the prediction of age in the HarMNqEEG dataset (<xref ref-type="bibr" rid="R16">Li et al. (2022)</xref>), a multibatch, multicountry resting-state EEG dataset of 1966 subjects encompassing people across the entire lifespan (excluding the very youngest and using only subjects between 5 and 97 years old); see <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref> and <xref ref-type="supplementary-material" rid="SD1">Table S1 (SI)</xref> for some basic statistics about the dataset in terms of age, gender, and geography. The performance of the methods was assessed using cross-validation, such that the acquisition batches were never split across folds. The hyperparameters (described in Methods) were chosen using nested cross-validation for all approaches. We assessed the performance of the three methods per EEG channel using two measures of accuracy: prediction explained variance (<italic>R</italic><sup>2</sup>) and mean absolute error (MAE), which offer complementary information (<xref ref-type="bibr" rid="R7">Engemann et al. (2022)</xref>).</p><p id="P8"><xref ref-type="fig" rid="F2">Figure 2</xref> summarises the results per EEG channel. <xref ref-type="fig" rid="F2">Figure 2A</xref> illustrates an example of age vs. predicted age for a given channel (T3). <xref ref-type="fig" rid="F2">Figure 2B</xref> and <xref ref-type="fig" rid="F2">2C</xref> show a comparison of the three methods across channels in terms of MAE and explained variance, respectively. As shown, MAE oscillates between 11 and 12.5 years approximately for all channels. There is a larger variation in terms of explained variance, ranging from <italic>R</italic><sup>2</sup> = 0.24 for sensor Fp1 to <italic>R</italic><sup>2</sup> = 0.44 for sensor C3. KRR and KMER outperform RR for all channels, and KMER outperforms KRR only for some channels. The advantage of KRR and KMER over RR is highly significant (p-value = 1 <italic>×</italic> 10 − 5; permutation testing), but the advantage of KMER over KRR is not significant (p-value=0.093). This improvement of the kernel methods over RR is likely due to the presence of nonlinearities in the relation between EEG spectrograms and age. Results for the linear and polynomial kernel (referring to the kernel used to construct the kernel matrix, <italic>f</italic> (·); see Methods) are shown in <xref ref-type="supplementary-material" rid="SD1">Figures S2</xref> and <xref ref-type="supplementary-material" rid="SD1">S3 (SI)</xref>; these performed worse than the radial basis function (Gaussian) kernel.</p><p id="P9">An important observation, as seen in <xref ref-type="fig" rid="F2">Figure 2A</xref>, is that age differences are less well predicted at older ranges. To try to address this problem, we considered the prediction of age in log space (such the differences in the younger are amplified). As observed in <xref ref-type="supplementary-material" rid="SD1">Figure S4</xref>, we obtained moderate improvements in <italic>R</italic><sup>2</sup> and MAE.</p><p id="P10">A posthoc bias correction, where we removed the age dependence on the residual in a second step using linear regression (<xref ref-type="bibr" rid="R22">Smith et al. (2019)</xref>), however resulted in a more substantial improvement; see <xref ref-type="supplementary-material" rid="SD1">Figure S5</xref>. This correction is performed by training a linear regression model on the residuals of the training data to decrease the bias of the predictions in the testing data, typically improving performance across metrics like <italic>R</italic><sup>2</sup> and MAE. Specifically, we first calculate the residuals of the training data by subtracting the predictions from the actual training values. Then, we fit a linear regression model, where the chronological age is the independent variable and the residual is the dependent variable. This makes the (new) residual and age orthogonal (<xref ref-type="bibr" rid="R22">Smith et al. (2019)</xref>). Here, the correction is incorporated to the original KRR/KMER predictions to generate bias-corrected predictions.</p><p id="P11">We also studied the effect of normalising each frequency bins across subjects, such that the variance is equal for all bins. As shown in <xref ref-type="supplementary-material" rid="SD1">Figure S7</xref>, the results did not change substantially.</p><p id="P12">Finally, <xref ref-type="fig" rid="F2">Figure 2D</xref> shows the explained variance in sensor space for KMER (MAE has a similar but inverted topography; not shown). We can observe that the parietal sensors are the most predictive of chronological age, whereas prefrontal and occipital sensors are the least predictive.</p></sec><sec id="S5"><label>2.3</label><title>Sex differences</title><p id="P13">Females and males have previously been shown to exhibit differences in their ageing trajectories (<xref ref-type="bibr" rid="R12">Hägg and Jylhävä (2021)</xref>). Here, using KMER, we investigated the differences between sexes in prediction accuracy across channels for 884 females and 905 males (for 137 individuals, sex is non-specified).</p><p id="P14"><xref ref-type="fig" rid="F3">Figure 3</xref> presents the results. <xref ref-type="fig" rid="F3">Figure 3A</xref> and <xref ref-type="fig" rid="F3">3B</xref> show example scatter plots between age and predicted age per sex. <xref ref-type="fig" rid="F3">Figure 3B</xref> and <xref ref-type="fig" rid="F3">3C</xref> show <italic>R</italic><sup>2</sup> across sensors in both barplot and sensor space format. Analogously, <xref ref-type="fig" rid="F3">Figure 3D</xref> and <xref ref-type="fig" rid="F3">3E</xref> show MAE per sex. As observed, males generally exhibited a higher prediction accuracy than females (p-value=0.002), potentially suggesting that their pace of biological change corresponds more closely to chronological age; see <xref ref-type="supplementary-material" rid="SD1">Figure S6</xref> for a side-by-side comparison.</p></sec><sec id="S6"><label>2.4</label><title>Performance variations across scanning sites</title><p id="P15">The HarMNqEEG dataset encompasses a wide range of age groups across various sites or geographical locations (14 different sites/experiments), each with a different number of individuals and specific age distributions; see <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref> and <xref ref-type="supplementary-material" rid="SD1">Table S1</xref>. Despite efforts made by the data curators to ensure homogeneity, it is possible that differences in practice and instrumentation between the sites leak into the data. In our reported results so far, sites were never split across cross-validation folds; that is, when predicting the age of subjects in a given site (e.g. Colombia), none of the subjects of that site were part of the training data. Given that substantial differences in age distribution between sites may potentially coexist with other between-site differences (e.g. instrumentation), this approach was performed to ensure that the reported prediction accuracies were purely reflective of age and not mixed with other factors. However, this conservative approach makes the prediction more difficult, inducing what is known in the machine learning literature as a prior shift (<xref ref-type="bibr" rid="R15">Kouw (2018)</xref>), where the distribution of the dependent variable (here, age) changes between training and test.</p><p id="P16">To illustrate the issue, <xref ref-type="fig" rid="F4">Figure 4A</xref> shows predicted age vs. chronological age with colours indicating stratification by site, with two different perspectives: 3D to better appreciate each site individually and 2D to compare the sites side-by-side. Here, we can observe substantial differences between sites in both accuracy and age distribution. <xref ref-type="fig" rid="F4">Figure 4B</xref> shows distributions of delta across sites, defined as the difference between predicted and chronological age (<xref ref-type="bibr" rid="R8">Franke and Gaser (2019)</xref>; <xref ref-type="bibr" rid="R22">Smith et al. (2019)</xref>). When compared with <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref>, where we show the age distributions explicitly, we can observe that the distribution of errors is contingent on the age range within each group, underestimating the age of older individuals (see Switzerland as an example, which has the oldest population in the data set). The observed pattern is consistent across different channels (not shown).</p><p id="P17">We compared the cross-site to a within-site prediction, where we ran a cross-validated prediction within one given site without using data from the other sites. While this can only be done effectively for sites with a sufficient number of subjects, we observed substantial increases in accuracy in this type of prediction. <xref ref-type="fig" rid="F4">Figure 4CD</xref> shows the case of New York, where, the explained variance went up to 0.63 and MAE became as small as 5.1.</p><p id="P18">Overall, these results demonstrate the challenges of predicting across sites when the age distributions is very different, but also that KMER and KRR can still produce reasonable accuracies even in this adverse situation.</p></sec><sec id="S7"><label>2.5</label><title>Comparison with other studies</title><p id="P19">To further compare with existing work on age prediction, <xref ref-type="table" rid="T1">Table 1</xref> presents the prediction accuracies from other studies that performed age estimation from EEG data, using other methodological approaches and data sets. Considering that our method operates at the single channel level, that it only has access to the spectrograms, and that our reported accuracies are primarily across sites (which, as mentioned, is harder), the present accuracies fare well in relation to those reported elsewhere.</p></sec></sec><sec id="S8" sec-type="methods | materials"><label>3</label><title>Methods and Materials</title><p id="P20">The general workflow of our analysis is presented in <xref ref-type="fig" rid="F1">Figure 1</xref>. In summary, we considered the spectrogram from every subject as the only input. Predictions of age were made per channel in a cross-validation fashion, where the acquisition sites (e.g. Russia) were used as folds. We used three approaches to predict age from the EEG spectrograms: RR, KRR, and KMER. For scoring prediction performance, we used explained variance (<italic>R</italic><sup>2</sup>) and the MAE, which offer complementary information (<xref ref-type="bibr" rid="R7">Engemann et al. (2022)</xref>). We also computed the so-called delta, defined as the signed difference between predicted and actual age, which is often used to quantify brain age. In this Section, we describe the data set and KMER; RR and KRR are standard and their description can be found elsewhere. All code used in this paper is open and publicly available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/katejarne/Kernel_Max_mean_discrepancy_EEG_Age">https://github.com/katejarne/Kernel_Max_mean_discrepancy_EEG_Age</ext-link>.</p><sec id="S9"><label>3.1</label><title>The HarMNqEEG dataset</title><p id="P21">We used EEG spectrograms from the HarMNqEEG dataset (<xref ref-type="bibr" rid="R16">Li et al. (2022)</xref>), which originated from a legacy dataset associated with the Cuban Human Brain Mapping initiative (<xref ref-type="bibr" rid="R25">Valdes-Sosa et al. (2021)</xref>). The data used in our study were collected from 9 countries, 12 EEG systems, and 14 experiments, which here we refer to as batches or sites. Overall, there are 1966 subjects, of which 40 subjects without a recorded age were excluded. Also, we discarded babies and toddlers, considering only subjects between 5 and 97 years old. For prediction, we used the rescaled raw spectrogram, such that (just like a probability distribution) the values integrate to 1.0. Additional details of the data set are described in <xref ref-type="supplementary-material" rid="SD1">SI</xref>, including batch names in the repository (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref> and <xref ref-type="supplementary-material" rid="SD1">Figure S1</xref>).</p><p id="P22">Recordings were taken from the 19 channels of the 10/20 International Electrodes Positioning System: Fp1, Fp2, F3, F4, C3, C4, P3, P4, O1, O2, F7, F8, T3/T7, T4/T8, T5/P7, T6/P8, Fz, Cz, Pz, where Cz was the reference electrode in some batches, while in others average-referencing was applied. We therefore discarded Cz from the analysis and performed the predictions for the other 18 channels. Data was formatted as cross-spectral matrices sampled from 1.17 to 19.14 Hz, with a 0.39 Hz resolution. The scalp EEG cross-spectrum was calculated by the data set curators using Bartlett’s method (<xref ref-type="bibr" rid="R18">Møller (1986)</xref>), by averaging the periodograms of more than 20 consecutive and non-overlapping segments. Because the spectra from different sites have different maximum cutoff frequencies, we used the lowest maximum cutoff frequency across sites for full compatibility. Thus, the histogram of each of the 18 channels has 49 bins corresponding to a maximum cutoff frequency of 19.13 Hz.</p></sec><sec id="S10"><label>3.2</label><title>Maximum Mean Discrepancy</title><p id="P23">This section describes the mathematical foundations of KME, which the next section will use to elaborate how KME can be applied for prediction using EEG spectrograms.</p><p id="P24">Kernel mean embeddings fully characterise the distributions by mapping joint, marginal, and conditional probability distributions to vectors in a high (or infinite) dimensional feature space (<xref ref-type="bibr" rid="R9">Fukumizu et al. (2011)</xref>; <xref ref-type="bibr" rid="R23">Smola et al. (2007)</xref>). This implies that any two distributions <italic>P</italic> and <italic>Q</italic> with differences in any moment are mapped to separate points on a reproducing kernel Hilbert space ℋ (<xref ref-type="bibr" rid="R9">Fukumizu et al. (2011)</xref>), which is essentially a space of functions. On this space, we can for instance perform classification, regression or and clustering of probability distributions, with no loss of information.</p><p id="P25">In practice, we do not have access to the distributions <italic>P</italic> or <italic>Q</italic>, so we use the available samples <bold><italic>X</italic></bold> = <italic>{x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>n</italic></sub><italic>}</italic> and <bold><italic>Z</italic></bold> = <italic>{z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>m</italic></sub><italic>}</italic>. The empirical estimate of the kernel mean embedding <italic>µ</italic><sub><italic>P</italic></sub> (i.e. the projection of the probability distribution on the reproducing kernel Hilbert space) is given by <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>⋅</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P26">where <italic>k</italic>(·, ·) is a kernel function.</p><p id="P27">Now, the Maximum Mean Discrepancy (MMD), which is a distance metric established on the space of probability measures (<xref ref-type="bibr" rid="R10">Gretton et al. (2012)</xref>), is defined as <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>MMD</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mi mathvariant="script">H</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P28">The empirical estimate of the MMD, which we use here, is given by: <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>MMD</mml:mtext></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P29">where <italic>n</italic> and <italic>m</italic> are the number of samples in distributions <italic>P</italic> and <italic>Q</italic>, respectively. In words, this formula is based in similarities between samples, and quantifies the similarities within- (first two terms) vs. between-distributions (third term). In what follows, we considered this estimate of the MMD as our distance metric between distributions (EEG spectrograms). We use a radial basis function kernel, lineal and polynomial as kernel functions.</p></sec><sec id="S11"><label>3.3</label><title>Kernel Mean Embedding Regression</title><p id="P30">In this section we link the above concepts to prediction using EEG spectrograms. We interpret the EEG spectrograms (rescaled to sum up to 1.0) as probability distributions (denoted above as <italic>P</italic> or <italic>Q</italic>). We expect these to vary across age, so that we can leverage these differences for prediction. We deterministically generated samples (above, referred to as e.g. <bold><italic>X</italic></bold>) from each rescaled spectrogram (which bin heights sum up to 1.0) so that we can compute the MMD following <xref ref-type="disp-formula" rid="FD3">Equation 3</xref>. For example, for a given channel, if the bin ”10Hz” has height equal to 0.2, and we assume that we have <italic>n</italic> = 1000 samples, then we have 0.2 <italic>×</italic> 1000 = 200 samples equal to 10. This way, we can apply the empirical estimator <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mtext>MMD</mml:mtext></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> defined in <xref ref-type="disp-formula" rid="FD3">Equation 3</xref> to each pair of spectrograms in the HarMNqEEG data set, considering different kernel functions <italic>k</italic>(·, ·). This produced a (<italic>N × N</italic>) distance matrix <bold><italic>D</italic></bold> per kernel, where <italic>N</italic> is the number of subjects. This distance matrix needs then to be converted to a kernel matrix <bold><italic>K</italic></bold>, as required for any kernelised algorithm. For this, we use a second kernel function, denoted as <italic>f</italic> (·, ·), that takes a distance between two subjects to produce a quantification of similarity. Specifically, we use a radial basis function kernel, <disp-formula id="FD4"><label>(4)</label><mml:math id="M5"><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P31">where the two subjects in question have been denoted as <italic>P</italic> and <italic>Q</italic> for continuity in the notation, and <italic>γ</italic> is a hyperparameter of the kernel function <italic>f</italic> (·). The resulting kernel matrix <bold><italic>K</italic></bold> can then be used to estimate prediction weights as <disp-formula id="FD5"><label>(5)</label><mml:math id="M6"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></disp-formula></p><p id="P32">where <bold><italic>y</italic></bold> is the response variable (age), <italic>α</italic> is a regularisation hyperparameter (which we select using cross-validation) and <bold><italic>I</italic></bold> is the identity matrix. A prediction for an incoming subject <italic>T</italic> is then made as <disp-formula id="FD6"><label>(6)</label><mml:math id="M7"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munderover><mml:mstyle><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P33">where <italic>P</italic><sub>1</sub>, …, <italic>P</italic><sub><italic>N</italic></sub> denote the training subjects.</p></sec></sec><sec id="S12" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P34">In this paper, we have explored the use of kernel methods for the prediction of individual traits from EEG spectrograms; and we have introduced KMER, a prediction method based on the idea of interpreting channel spectrograms as probability distributions. By doing this, we could leverage mathematical principles from kernel learning. Although not pursued in this paper, the same principles can also be applied to other problems, such as unsupervised clustering of subjects from EEG spectral information. Even though the mathematical foundations of the method are not particularly trivial, KMER is simple to implement and use, provides spatial interpretation at the sensor or source space, and it is not computationally costly in comparison to more complex (e.g. deep learning) approaches that are estimated on the raw data. The fact that it only necessitates the spectrograms has additional practical benefits in terms of data sharing. These benefits are shared, nonetheless, by KRR.</p><p id="P35">We tested the methods in the prediction of age in the HarMNqEEG dataset, a recently published international initiative that made EEG spectrograms available across different cohorts and countries. In these data, we observed that KMER and KRR performed similarly, although they both outperformed non-kernelised regression (RR), highlighting the benefits of kernel methods in this context. We note that, compared to other works that predicted age within a single cohort, predicting across sites (i.e. such that models were trained on some sites and tested in others) presents a more challenging problem because the distribution of age across sites varies substantially and potentially also because of protocol or infrastructure differences between the sites. Despite these difficulties, the presented results are comparable to previous EEG studies; see <xref ref-type="sec" rid="S7">Subsection 2.5</xref>. Furthermore, when training and testing within one site only (New York, with a large number of subjects and the broadest age range), the accuracy for some of the individual sensors attained the state-of-the-art accuracies reported in the literature, some of which used more complex models and whole-brain data.</p><p id="P36">An overarching limitation of all the methods is that, while differences at younger ages are well-predicted, their predictive capacity is much reduced for the older age ranges. A conceivable possibility is that the ageing process is comprised of two separate components of change: a developmental and an ageing part, with more salient differences within development. To investigate this, we performed predictions on the logarithm of the age, which improved results moderately, and we carried out a post hoc bias correction (<xref ref-type="bibr" rid="R22">Smith et al. (2019)</xref>), which did improve the results substantially. While the cause of this phenomenon may be important, it falls out of the scope of this work and will require further investigation.</p><p id="P37">Although we did not exhaustively explored it here, KMER could be further optimised by expanding the selection of the kernel functions and hyperparameters. For instance, while for KMER we optimised for the kernel hyperparameter that generates the kernel matrix from the distance matrix (<italic>f</italic> (·, ·), <xref ref-type="disp-formula" rid="FD4">Equation 4</xref>), the kernel used in the construction of the MMD metric (<italic>k</italic>(·, ·), <xref ref-type="disp-formula" rid="FD3">Equation 3</xref>) also has a kernel hyperparameter which we set to 1.0 by default. Improving the hyperparameter tuning thus may be a potential avenue for KMER to outperform the simpler KRR approach. Future work will also explore extensions for multichannel predictions and prediction in source spaces.</p><p id="P38">Finally, it is worth noting that, although we here demonstrated the performance of the tested methods on EEG, KMER (as well as KRR) can be applied to other modalities such as MEG or ECoG; and can be used to predict other individual traits besides age, including cognitive and clinical variables.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>SI</label><media xlink:href="EMS190630-supplement-SI.pdf" mimetype="application" mime-subtype="pdf" id="d53aAcEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgments</title><p>D. Vidaurre is supported by a Novo Nordisk Foundation Emerging Investigator Fellowship (NNF19OC-0054895), an ERC Starting Grant (ERC-StG-2019-850404), and a DFF Project 1 from the Independent Research Fund of Denmark (2034-00054B). This research was funded in part by the Wellcome Trust (215573/Z/19/Z). For the purpose of Open Access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. We acknowledge support from PICT 2020-01413. We also thank Sonsoles Alonso for her help.</p></ack><sec id="S14" sec-type="data-availability"><title>Data Availability Statement</title><p id="P39">The data that support the findings of this study are available in <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/">https://www.synapse.org/</ext-link> with id: <italic>syn</italic>26712693. Complete public access is available by registering and logging into the system.</p></sec><fn-group><fn id="FN1" fn-type="conflict"><p id="P40"><bold>Conflict of interest statement</bold></p><p id="P41">The authors declare no competing conflicts of interest.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrends</surname><given-names>C</given-names></name><name><surname>Woolrich</surname><given-names>M</given-names></name><name><surname>Vidaurre</surname><given-names>D</given-names></name></person-group><article-title>Predicting individual traits from models of brain dynamics accurately and reliably using the fisher kernel</article-title><source>bioRxiv</source><year>2023</year></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Al Zoubi</surname><given-names>O</given-names></name><name><surname>Ki Wong</surname><given-names>C</given-names></name><name><surname>Kuplicki</surname><given-names>RT</given-names></name><name><surname>Yeh</surname><given-names>H-w</given-names></name><name><surname>Mayeli</surname><given-names>A</given-names></name><name><surname>Refai</surname><given-names>H</given-names></name><name><surname>Paulus</surname><given-names>M</given-names></name><name><surname>Bodurka</surname><given-names>J</given-names></name></person-group><article-title>Predicting age from brain eeg signals—a machine learning approach</article-title><source>Frontiers in Aging Neuroscience</source><year>2018</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC6036180</pub-id><pub-id pub-id-type="pmid">30013472</pub-id><pub-id pub-id-type="doi">10.3389/fnagi.2018.00184</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borgwardt</surname><given-names>KM</given-names></name><name><surname>Gretton</surname><given-names>A</given-names></name><name><surname>Rasch</surname><given-names>MJ</given-names></name><name><surname>Kriegel</surname><given-names>H-P</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name><name><surname>Smola</surname><given-names>AJ</given-names></name></person-group><article-title>Integrating structured biological data by Kernel Maximum Mean Discrepancy</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><issue>14</issue><fpage>e49</fpage><lpage>e57</lpage><pub-id pub-id-type="pmid">16873512</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buzsáki</surname><given-names>G</given-names></name><name><surname>Draguhn</surname><given-names>A</given-names></name></person-group><article-title>Neuronal oscillations in cortical networks</article-title><source>Science</source><year>2004</year><volume>304</volume><issue>5679</issue><fpage>1926</fpage><lpage>1929</lpage><pub-id pub-id-type="pmid">15218136</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimitriadis</surname><given-names>SI</given-names></name><name><surname>Salis</surname><given-names>CI</given-names></name></person-group><article-title>Mining time-resolved functional brain graphs to an eeg-based chronnectomic brain aged index (cbai)</article-title><source>Frontiers in Human Neuroscience</source><year>2017</year><volume>11</volume><pub-id pub-id-type="pmcid">PMC5594081</pub-id><pub-id pub-id-type="pmid">28936168</pub-id><pub-id pub-id-type="doi">10.3389/fnhum.2017.00423</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dosenbach</surname><given-names>NUF</given-names></name><name><surname>Nardos</surname><given-names>B</given-names></name><name><surname>Cohen</surname><given-names>AL</given-names></name><name><surname>Fair</surname><given-names>DA</given-names></name><name><surname>Power</surname><given-names>JD</given-names></name><name><surname>Church</surname><given-names>JA</given-names></name><name><surname>Nelson</surname><given-names>SM</given-names></name><name><surname>Wig</surname><given-names>GS</given-names></name><name><surname>Vogel</surname><given-names>AC</given-names></name><name><surname>Lessov-Schlaggar</surname><given-names>CN</given-names></name><name><surname>Barnes</surname><given-names>KA</given-names></name><etal/></person-group><article-title>Prediction of individual brain maturity using fmri</article-title><source>Science</source><year>2010</year><volume>329</volume><issue>5997</issue><fpage>1358</fpage><lpage>1361</lpage><pub-id pub-id-type="pmcid">PMC3135376</pub-id><pub-id pub-id-type="pmid">20829489</pub-id><pub-id pub-id-type="doi">10.1126/science.1194144</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engemann</surname><given-names>DA</given-names></name><name><surname>Mellot</surname><given-names>A</given-names></name><name><surname>Höchenberger</surname><given-names>R</given-names></name><name><surname>Banville</surname><given-names>H</given-names></name><name><surname>Sabbagh</surname><given-names>D</given-names></name><name><surname>Gemein</surname><given-names>L</given-names></name><name><surname>Ball</surname><given-names>T</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name></person-group><article-title>A reusable benchmark of brain-age prediction from m/eeg resting-state signals</article-title><source>NeuroImage</source><year>2022</year><volume>262</volume><elocation-id>119521</elocation-id><pub-id pub-id-type="pmid">35905809</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franke</surname><given-names>K</given-names></name><name><surname>Gaser</surname><given-names>C</given-names></name></person-group><article-title>Ten years of brainage as a neuroimaging biomarker of brain aging: What insights have we gained?</article-title><source>Frontiers in Neurology</source><year>2019</year><month>JUL</month><volume>10</volume><pub-id pub-id-type="pmcid">PMC6702897</pub-id><pub-id pub-id-type="pmid">31474922</pub-id><pub-id pub-id-type="doi">10.3389/fneur.2019.00789</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fukumizu</surname><given-names>K</given-names></name><name><surname>Song</surname><given-names>L</given-names></name><name><surname>Gretton</surname><given-names>A</given-names></name></person-group><chapter-title>Kernel bayes'rule</chapter-title><person-group person-group-type="editor"><name><surname>Shawe-Taylor</surname><given-names>J</given-names></name><name><surname>Zemel</surname><given-names>R</given-names></name><name><surname>Bartlett</surname><given-names>P</given-names></name><name><surname>Pereira</surname><given-names>F</given-names></name><name><surname>Weinberger</surname><given-names>K</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc</publisher-name><year>2011</year><volume>24</volume></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gretton</surname><given-names>A</given-names></name><name><surname>Borgwardt</surname><given-names>KM</given-names></name><name><surname>Rasch</surname><given-names>MJ</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name><name><surname>Smola</surname><given-names>A</given-names></name></person-group><article-title>A kernel two-sample test</article-title><source>J Mach Learn Res</source><year>2012</year><volume>13</volume><issue>1</issue><fpage>723</fpage><lpage>773</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haynes</surname><given-names>J-D</given-names></name><name><surname>Rees</surname><given-names>G</given-names></name></person-group><article-title>Decoding mental states from brain activity in humans</article-title><source>Nature Reviews Neuroscience</source><year>2006</year><volume>7</volume><issue>7</issue><fpage>523</fpage><lpage>534</lpage><pub-id pub-id-type="pmid">16791142</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hägg</surname><given-names>S</given-names></name><name><surname>Jylhävä</surname><given-names>J</given-names></name></person-group><article-title>Sex differences in biological aging with a focus on human studies</article-title><source>eLife</source><year>2021</year><volume>10</volume><elocation-id>e63425</elocation-id><pub-id pub-id-type="pmcid">PMC8118651</pub-id><pub-id pub-id-type="pmid">33982659</pub-id><pub-id pub-id-type="doi">10.7554/eLife.63425</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Iyer</surname><given-names>AS</given-names></name><name><surname>Jagarlapudi</surname><given-names>S</given-names></name><name><surname>Sarawagi</surname><given-names>S</given-names></name></person-group><source>Maximum mean discrepancy for class ratio estimation: Convergence bounds and kernel selection</source><conf-name>International Conference on Machine Learning</conf-name><year>2014</year></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khayretdinova</surname><given-names>M</given-names></name><name><surname>Shovkun</surname><given-names>A</given-names></name><name><surname>Degtyarev</surname><given-names>V</given-names></name><name><surname>Kiryasov</surname><given-names>A</given-names></name><name><surname>Pshonkovskaya</surname><given-names>P</given-names></name><name><surname>Zakharov</surname><given-names>I</given-names></name></person-group><article-title>Predicting age from resting-state scalp eeg signals with deep convolutional neural networks on td-brain dataset</article-title><source>Frontiers in Aging Neuroscience</source><year>2022</year><volume>14</volume><pub-id pub-id-type="pmcid">PMC9764861</pub-id><pub-id pub-id-type="pmid">36561135</pub-id><pub-id pub-id-type="doi">10.3389/fnagi.2022.1019869</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kouw</surname><given-names>WM</given-names></name></person-group><article-title>An introduction to domain adaptation and transfer learning</article-title><source>CoRR</source><year>2018</year><elocation-id>abs/1812.11806</elocation-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Lopez-Naranjo</surname><given-names>C</given-names></name><name><surname>Hu</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>RCG</given-names></name><name><surname>Paz-Linares</surname><given-names>D</given-names></name><name><surname>Areces-Gonzalez</surname><given-names>A</given-names></name><name><surname>Hamid</surname><given-names>AIA</given-names></name><name><surname>Evans</surname><given-names>AC</given-names></name><name><surname>Savostyanov</surname><given-names>AN</given-names></name><name><surname>Calzada-Reyes</surname><given-names>A</given-names></name><etal/></person-group><article-title>Harmonized-multinational qeeg norms (harmnqeeg)</article-title><source>NeuroImage</source><year>2022</year><volume>256</volume><elocation-id>119190</elocation-id><pub-id pub-id-type="pmid">35398285</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liegeois</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Kong</surname><given-names>R</given-names></name><name><surname>Orban</surname><given-names>C</given-names></name><name><surname>Van De Ville</surname><given-names>D</given-names></name><name><surname>Ge</surname><given-names>T</given-names></name><name><surname>Sabuncu</surname><given-names>MR</given-names></name><name><surname>Yeo</surname><given-names>BTT</given-names></name></person-group><article-title>Resting brain dynamics at different timescales capture distinct aspects of human behavior</article-title><source>Nature Communications</source><year>2019</year><volume>10</volume><issue>1</issue><elocation-id>2317</elocation-id><pub-id pub-id-type="pmcid">PMC6534566</pub-id><pub-id pub-id-type="pmid">31127095</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-10317-7</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Møller</surname><given-names>J</given-names></name></person-group><article-title>Bartlett adjustments for structured covariances</article-title><source>Scand J Statist</source><year>1986</year><volume>13</volume><fpage>1</fpage><lpage>15</lpage><comment>Cited by: 17</comment></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>MD</given-names></name><name><surname>Finn</surname><given-names>ES</given-names></name><name><surname>Scheinost</surname><given-names>D</given-names></name><name><surname>Papademetris</surname><given-names>X</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Constable</surname><given-names>RT</given-names></name><name><surname>Chun</surname><given-names>MM</given-names></name></person-group><article-title>A neuromarker of sustained attention from whole-brain functional connectivity</article-title><source>Nature Neuroscience</source><year>2016</year><volume>19</volume><issue>1</issue><fpage>165</fpage><lpage>171</lpage><pub-id pub-id-type="pmcid">PMC4696892</pub-id><pub-id pub-id-type="pmid">26595653</pub-id><pub-id pub-id-type="doi">10.1038/nn.4179</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sabbagh</surname><given-names>D</given-names></name><name><surname>Ablin</surname><given-names>P</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Engemann</surname><given-names>DA</given-names></name></person-group><chapter-title>Manifold-regression to predict from meg/eeg brain signals without source modeling</chapter-title><person-group person-group-type="editor"><name><surname>Wallach</surname><given-names>H</given-names></name><name><surname>Larochelle</surname><given-names>H</given-names></name><name><surname>Beygelzimer</surname><given-names>A</given-names></name><name><surname>d’Alché-Buc</surname><given-names>F</given-names></name><name><surname>Fox</surname><given-names>E</given-names></name><name><surname>Garnett</surname><given-names>R</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><publisher-name>Curran Associates, Inc</publisher-name><year>2019</year><volume>32</volume></element-citation></ref><ref id="R21"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>C</given-names></name><name><surname>Gammerman</surname><given-names>A</given-names></name><name><surname>Vovk</surname><given-names>V</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Shavlik</surname><given-names>J</given-names></name></person-group><source>Ridge regression learning algorithm in dual variables</source><conf-name>Proceedings of the Fifteenth International Conference on Machine Learning</conf-name><conf-sponsor>Morgan Kaufmann</conf-sponsor><year>1998</year><fpage>515</fpage><lpage>521</lpage></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>SM</given-names></name><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Alfaro-Almagro</surname><given-names>F</given-names></name><name><surname>Nichols</surname><given-names>TE</given-names></name><name><surname>Miller</surname><given-names>KL</given-names></name></person-group><article-title>Estimation of brain age delta from brain imaging</article-title><source>NeuroImage</source><year>2019</year><volume>200</volume><fpage>528</fpage><lpage>539</lpage><pub-id pub-id-type="pmcid">PMC6711452</pub-id><pub-id pub-id-type="pmid">31201988</pub-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.06.017</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smola</surname><given-names>A</given-names></name><name><surname>Gretton</surname><given-names>A</given-names></name><name><surname>Song</surname><given-names>L</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name></person-group><chapter-title>A hilbert space embedding for distributions</chapter-title><person-group person-group-type="editor"><name><surname>Hutter</surname><given-names>M</given-names></name><name><surname>Servedio</surname><given-names>RA</given-names></name><name><surname>Takimoto</surname><given-names>E</given-names></name></person-group><source>Algorithmic Learning Theory</source><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin, Heidelberg</publisher-loc><year>2007</year><fpage>13</fpage><lpage>31</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Paixao</surname><given-names>L</given-names></name><name><surname>Oliva</surname><given-names>JT</given-names></name><name><surname>Goparaju</surname><given-names>B</given-names></name><name><surname>Carvalho</surname><given-names>DZ</given-names></name><name><surname>van Leeuwen</surname><given-names>KG</given-names></name><name><surname>Akeju</surname><given-names>O</given-names></name><name><surname>Thomas</surname><given-names>RJ</given-names></name><name><surname>Cash</surname><given-names>SS</given-names></name><name><surname>Bianchi</surname><given-names>MT</given-names></name><name><surname>Westover</surname><given-names>MB</given-names></name></person-group><article-title>Brain age from the electroencephalogram of sleep</article-title><source>Neurobiology of Aging</source><year>2019</year><volume>74</volume><fpage>112</fpage><lpage>120</lpage><pub-id pub-id-type="pmcid">PMC6478501</pub-id><pub-id pub-id-type="pmid">30448611</pub-id><pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2018.10.016</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valdes-Sosa</surname><given-names>PA</given-names></name><name><surname>Galan-Garcia</surname></name><name><surname>Lidice AU own</surname><given-names>S</given-names></name><name><surname>Valdes-Urrutia</surname><given-names>L</given-names></name><name><surname>Evans</surname><given-names>AC</given-names></name><name><surname>Valdes-Sosa</surname><given-names>MJ</given-names></name></person-group><article-title>The cuban human brain mapping project, a young and middle age population-based eeg, mri, and cognition dataset</article-title><source>Scientific Data</source><year>2021</year><volume>8</volume><issue>1</issue><fpage>45</fpage><pub-id pub-id-type="pmcid">PMC7865011</pub-id><pub-id pub-id-type="pmid">33547313</pub-id><pub-id pub-id-type="doi">10.1038/s41597-021-00829-7</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandenbosch</surname><given-names>MMLJZ</given-names></name><name><surname>van ’t Ent</surname><given-names>D</given-names></name><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>Anokhin</surname><given-names>AP</given-names></name><name><surname>Smit</surname><given-names>DJA</given-names></name></person-group><article-title>Eeg-based age-prediction models as stable and heritable indicators of brain maturational level in children and adolescents</article-title><source>Human Brain Mapping</source><year>2019</year><volume>40</volume><issue>6</issue><fpage>1919</fpage><lpage>1926</lpage><pub-id pub-id-type="pmcid">PMC6865765</pub-id><pub-id pub-id-type="pmid">30609125</pub-id><pub-id pub-id-type="doi">10.1002/hbm.24501</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Bielza</surname><given-names>C</given-names></name><name><surname>Larrañaga</surname><given-names>P</given-names></name></person-group><article-title>Classification of neural signals from sparse autoregressive features</article-title><source>Neurocomputing</source><year>2013</year><volume>111</volume><fpage>21</fpage><lpage>26</lpage></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vidaurre</surname><given-names>D</given-names></name><name><surname>Llera</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>S</given-names></name><name><surname>Woolrich</surname><given-names>M</given-names></name></person-group><article-title>Behavioural relevance of spontaneous, transient brain network interactions in fmri</article-title><source>NeuroImage</source><year>2021</year><volume>229</volume><elocation-id>117713</elocation-id><pub-id pub-id-type="pmcid">PMC7994296</pub-id><pub-id pub-id-type="pmid">33421594</pub-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.117713</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>General workflow of the analysis.</title><p>We used the HarMNqEEG dataset collected across multiple sites (batches), which contains rescaled power densities per sensor and participant, as well as information on gender and age. We considered three prediction approaches, which we run separately per EEG sensor: (i) Ridge Regression (RR) using the power estimates at each frequency bin of the spectrogram as features; (ii) Kernel Ridge Regression (KRR), a kernelised version of RR (based on a non-linear radial basis function kernel); and (iii) our Kernel Mean Embedding Regression (KMER) approach, where we interpreted the power spectral estimates across bins as probability distributions so that we can leverage the mathematical machinery of kernel learning on probability measures for prediction.</p></caption><graphic xlink:href="EMS190630-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Comparison between the methods.</title><p><bold>A)</bold> Illustration of predicted vs. real age for example channel T3 for KMER. <bold>B)</bold> Mean Absolute Error (MAE) per channel for KMER, RR and KRR. <bold>C)</bold> Explained variance <italic>R</italic><sup>2</sup>. <bold>D)</bold> <italic>R</italic><sup>2</sup> projected on sensor space for KMER.</p></caption><graphic xlink:href="EMS190630-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Sex differences (left panels, male; right panels, female).</title><p><bold>A)</bold> and <bold>B)</bold> Predicted vs. real age per sex for example channel T3; results are consistent for all channels (not shown). <bold>C)</bold> and <bold>D)</bold> Explained variance <italic>R</italic><sup>2</sup> per sex and channel, in barplot format and in a topographic map. <bold>E)</bold> and <bold>F)</bold> MAE per sex and channel.</p></caption><graphic xlink:href="EMS190630-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Differences between sites and their effect on the prediction.</title><p><bold>A)</bold> Predicted vs. real age in 3D (left) and 2D (right), separated by site (batch). <bold>B)</bold> Distribution of delta (defined as predicted minus real age) per site. <bold>C</bold> and <bold>D)</bold> <italic>R</italic><sup>2</sup> and MAE where training and testing come from a single site (New York).</p></caption><graphic xlink:href="EMS190630-f004"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Other results from the literature of age estimation using EEG.</title><p>These figures were obtained using different methods, age ranges and datasets. EO and EC, respectively, denote eyes open and eyes closed. The results are compared with ours for the best channel in age space, for NY, in log space and using bias correction (See <xref ref-type="supplementary-material" rid="SD1">Figure S5</xref>).</p></caption><table frame="box" rules="all"><thead><tr><th align="center" valign="middle">Work</th><th align="center" valign="middle">Individuals</th><th align="center" valign="middle">Range</th><th align="center" valign="middle">MAE</th><th align="center" valign="middle">R<sup>2</sup> / R</th><th align="center" valign="middle">Details</th></tr></thead><tbody><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R14">Khayretdinova et al. (2022)</xref></td><td align="left" valign="middle">1335</td><td align="left" valign="middle">[5, 88]</td><td align="left" valign="middle">6 ± 0.33 yr</td><td align="left" valign="middle">R<sup>2</sup> = 0.81</td><td align="left" valign="middle">(EO and EC) Neural networks</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R26">Vandenbosch et al. (2019)</xref></td><td align="left" valign="middle">702</td><td align="left" valign="middle">[5, 18]</td><td align="left" valign="middle">-</td><td align="left" valign="middle">0.53 &lt; r &lt; 0.74</td><td align="left" valign="middle">Random Forest</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R5">Dimitriadis and Salis (2017)</xref></td><td align="left" valign="middle">94</td><td align="left" valign="middle">[19, 67]</td><td align="left" valign="middle">-</td><td align="left" valign="middle">R<sup>2</sup> = 0.60 / R<sup>2</sup> = 0.48</td><td align="left" valign="middle">EO / EC SV Regression + Clasifier</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R2">Al Zoubi et al. (2018)</xref></td><td align="left" valign="middle">468</td><td align="left" valign="middle">[18, 58]</td><td align="left" valign="middle">6.68 ± 0.69</td><td align="left" valign="middle">R<sup>2</sup> = 0.37</td><td align="left" valign="middle">nested-cross-validation (NCV) and stack-ensemble</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R24">Sun et al. (2019)</xref> I</td><td align="left" valign="middle">2535</td><td align="left" valign="middle">[18, 80]</td><td align="left" valign="middle">7.4 yr</td><td align="left" valign="middle">R = 0.83</td><td align="left" valign="middle">(all electrodes)</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R24">Sun et al. (2019)</xref> II</td><td align="left" valign="middle">1974</td><td align="left" valign="middle">[40, 80]</td><td align="left" valign="middle">same I</td><td align="left" valign="middle">same I</td><td align="left" valign="middle">same I</td></tr><tr><td align="left" valign="middle"><xref ref-type="bibr" rid="R7">Engemann et al. (2022)</xref></td><td align="left" valign="middle">2500</td><td align="left" valign="middle">[25, 75]</td><td align="left" valign="middle">depends on data set</td><td align="left" valign="middle">R<sup>2</sup> in range 0.60-0.74 (best)</td><td align="left" valign="middle">3 EEG data sets: (LEMON, CHBP, TUAB)</td></tr><tr><td align="left" valign="middle">HarMNqEEG data set(present work)</td><td align="left" valign="middle">1926</td><td align="left" valign="middle">[5, 97]</td><td align="left" valign="middle">10.78 yr 5.24 yr (NY best)</td><td align="left" valign="middle">R<sup>2</sup> = 0.44 (best in age space) R<sup>2</sup> = 0.59 (NY best)</td><td align="left" valign="middle">R<sup>2</sup> = 0.53 (best in log space) R<sup>2</sup> = 0.73 (best with Bias correction)</td></tr></tbody></table></table-wrap></floats-group></article>