<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS190579</article-id><article-id pub-id-type="doi">10.1101/2023.10.31.564945</article-id><article-id pub-id-type="archive">PPR752787</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Fast and robust 3D MINFLUX excitation with a variable phase plate</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Deguchi</surname><given-names>Takahiro</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Ries</surname><given-names>Jonas</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>European Molecular Biology Laboratory, Cell Biology and Biophysics, Heidelberg, Germany</aff><aff id="A2"><label>2</label>Max Perutz Labs, Vienna Biocenter Campus (VBC), Vienna, Austria</aff><aff id="A3"><label>3</label>University of Vienna, Center for Molecular Biology, Department of Structural and Computational Biology, Vienna, Austria</aff><aff id="A4"><label>4</label>University of Vienna, Faculty of Physics, Vienna, Austria</aff><author-notes><corresp id="CR1"><label>*</label>Correspondence: <email>Jonas.ries@univie.ac.at</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>04</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>01</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">MINFLUX has achieved record resolution in superresolution imaging and single fluorophore tracking. It is based on localizing single fluorophores by rapid probing with a patterned beam that features a local intensity minimum. Current implementations, however, are complex and expensive and are limited in speed and robustness.</p><p id="P2">Here, we show that a combination of an electro-optical modulator with a segmented birefringent element such as a spatial light modulator produces a variable phase plate for which the phase can be scanned on the MHz timescale. Bisected or top-hat phase patterns generate high-contrast compact excitation point-spread functions for MINFLUX localization in the x,y, and z-direction, respectively, which can be scanned around a fluorophore within a microsecond and alternated among different excitation wavelengths.</p><p id="P3">We discuss how to compensate for non-optimal performance of the components and present a robust 3D and multi-color MINFLUX excitation module with record speed, which we envision as an integral component of a high-performance and cost-effective open-source MINFLUX.</p></abstract></article-meta></front><body><p id="P4">MINFLUX<sup><xref ref-type="bibr" rid="R1">1</xref></sup> is a super-resolution microscopy technique in which a patterned beam featuring a local intensity minimum, typically a donut beam, probes the signal around a single fluorophore. From the intensities measured at different locations, the position of the fluorophore can be estimated. Recentering of the scan pattern on the estimated position and decreasing its size in an iterative way proves to be a more effective means of enhancing localization precision compared to increasing photon numbers. This means that for a given number of photons emitted by the fluorophore MINFLUX effectively outperforms camera-based Single-Molecule Localization Microscopy (SMLM)<sup><xref ref-type="bibr" rid="R2">2</xref></sup> in terms of localization precision. MINFLUX has been used for high-resolution imaging in fixed<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref></sup> and live<sup><xref ref-type="bibr" rid="R2">2</xref></sup> cells and for tracking single molecules with unprecedented spatio-temporal resolution<sup><xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R7">7</xref></sup>.</p><p id="P5">For optimal performance, a MINFLUX microscope requires fast and repeated scanning of the pattern to average over potential intensity fluctuations of the fluorophore, fast feedback of the position estimate on the scan pattern, a high contrast of the intensity minimum and a very stable setup combined with active drift stabilization. In most custom<sup><xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R5">5</xref></sup> and commercial<sup><xref ref-type="bibr" rid="R8">8</xref></sup> microscopes, a donut-shaped beam, created by a vortex phase pattern, is scanned laterally using electro-optical deflectors. For 3D MINFLUX, typically a top-hat phase pattern that results in a ‘3D donut’ is employed and axial scanning is performed with an electro-optically actuated varifocal lens<sup><xref ref-type="bibr" rid="R2">2</xref></sup> or a deformable mirror<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. All these fast 3D scanning solutions require expensive components. Standard confocal microscopes with galvo scanners can be upgraded to the MINFLUX mode by insertion of a vortex phase plate<sup><xref ref-type="bibr" rid="R9">9</xref></sup>, but these implementations might not easily reach the resolution and speed of dedicated MINFLUX instruments. Pulsed interleaved MINFLUX<sup><xref ref-type="bibr" rid="R10">10</xref></sup> replaces the lateral scanning with four optical fibers of different lengths at the cost of flexible scan patterns, which in combination with a pulsed laser allow switching between donut positions within 12.5 ns and provides information on fluorescence lifetime. Recently, interference of two beams was used to create bilobed excitation patterns that could be rapidly scanned across a single fluorophore by changing the interference phase with an electro-optical modulator (EOM)<sup><xref ref-type="bibr" rid="R6">6</xref></sup>. Still, generating a pattern for 3D MINFLUX in multiple colors that features rapid scanning with sub-nanometer accuracy and stability is challenging and can be costly.</p><p id="P6">Here, we overcome this challenge by developing a MINFLUX excitation module based on a novel variable phase plate, which enables 3D multi-color MINFLUX with high spatio-temporal resolution using a simple, robust, and economic setup.</p><sec id="S1" sec-type="results"><title>Results</title><sec id="S2"><title>Simple phase patterns for one-dimensional MINFLUX localization</title><p id="P7">As shown by Wolff et al.<sup><xref ref-type="bibr" rid="R6">6</xref></sup>, the use of distinctive PSFs for each dimension can outperform the donut-shaped beam profiles generated by a vortex phase pattern. In this work, we use 3 simple binary phase patterns that generate compact MINFLUX beams for x-, y-, and z-localization, respectively (<xref ref-type="fig" rid="F1">Figure 1 A</xref>). For 2D MINFLUX theses bilobed PSFs achieve a similar localization precision compared to donut or interference phase patterns for a given number of detected photons (<xref ref-type="fig" rid="F1">Figure 1B</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). Due to their small size, they require lower laser powers than the donut beam (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2C</xref>), which reduces background due to auto-fluorescence and out-of-focus fluorescence, enabling an increase in the density of fluorophores. For 3D MINFLUX the combination of specific patterns achieves a substantially better localization precision compared to using the ‘3D donut’ alone (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>).</p><p id="P8">Phase differences of π give rise to symmetric patterns with the minimum on the optical axis (x, y pattern) or in the focus of the objective lens (z pattern), because here the π phase shift leads to destructive interference. Phase differences different from π displace the position of the minimum because these rays must acquire an additional path difference to reach a phase difference of π (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>). Simulations show that for the bilobed PSFs a true zero at the minimum is preserved even for large scanning, whereas for the 3D donut the contrast stays high over a z range of a few hundred nm (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>).</p><p id="P9">The phase patterns can be created with a spatial light modulator (SLM), which, in principle, can scan the position of the intensity minimum by changing the phase. However, SLMs that produce continuous phase delays are too slow (&lt;1kHz) for the rapid scanning required for MINFLUX, thus a fast scanner like an electro optical deflector would still be required.</p></sec><sec id="S3"><title>A fast variable phase plate based on polarization optics</title><p id="P10">Here we overcome this limitation by combining an EOM, an SLM and a polarizer to generate binary phase patterns with variable phase delay, where the phase delay can be changed on the sub-microsecond time scale by the EOM phase (<xref ref-type="fig" rid="F1">Figure 1C</xref>). The input laser beam is polarized under 45° and enters the EOM for which the polarization axis is oriented vertically under 0°. The EOM can thus cause a phase delay between the vertical and the horizontal polarization component of the beam. The SLM is oriented in a way that the ‘off’-pixels do not change the polarization state, whereas the ‘on’ pixels act as a half-wave plate (HWP) oriented at 45°, which rotate the vertical polarization component into the horizontal polarization. This component carries the extra phase imposed by the EOM. A polarizer (e.g., a polarizing beam splitter) transmits only the horizontal component, which has no extra phase for ‘off’-pixels of the SLM and the phase imposed by the EOM for ‘on’-pixels.</p><p id="P11">Using Jones matrices, we can calculate in the horizontal/vertical coordinate system that an input beam of <inline-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> acquires a phase of <inline-formula><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> after the EOM. The ‘on’-pixels of the SLM result in <inline-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, while the ‘off’-pixels do not change the polarization state. After the polarizer the state is <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the ‘off’-pixels and <inline-formula><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the ‘on’-pixels. When both components interfere in the vicinity of the focus of the objective lens, the intensity is <inline-formula><mml:math id="M6"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mtext>E</mml:mtext><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mtext>E</mml:mtext><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>E</mml:mtext><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. ξ describes an additional phase difference depending on distance to the focal point.</p></sec><sec id="S4"><title>Non-ideal performance of optical components</title><p id="P12">The simple setup in <xref ref-type="fig" rid="F1">Figure 1</xref> is based on ideal performance of the optical elements. Here we discuss the impact of non-ideal performance and experimental challenges and present mitigation strategies.</p><sec id="S5"><title>SLM</title><p id="P13">The binary Ferroelectric Liquid Crystal on Silicon (FLCoS) SLM used here has the birefringent axis of the ‘on’-pixels oriented under 33.5° compared to the ‘off’-pixels, instead of the ideal 45°. Additionally, the phase delay might deviate slightly from π. By calculations and experimentally we found that the addition of a HWP in the beam path before the SLM can perfectly compensate for both imperfections (<xref ref-type="fig" rid="F2">Figure 2A</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref>). In addition, the SLM requires ‘balancing’, meaning that for every pixel the time in the ‘on’-state needs to be equal to the time in the ‘off’-state within a 50 ms window. By adjusting the static offset of the EOM phase, the inverse phase map can be matched to the original one, avoiding a reduced duty cycle due to balancing. Finally, the SLM has a finite switching time between different patterns of ~50 μs, leading to a tradeoff between switching speed and duty cycle.</p></sec><sec id="S6"><title>EOM</title><p id="P14">The EOM phase delay is wavelength dependent, leading to larger displacements of the minima for shorter wavelengths for a given EOM voltage. To compensate this, the static offset of the EOM phase, as well as the amplitude of the phase scan can be set separately for different excitation colors. If necessary, temperature induced phase drifts can be monitored and recalibrated in a separate test beam with a polarizer under 45° and an EOM phase scan around zero phase delay, for instance during dead times caused by switching of the SLM, or with a pinhole and photo diode as in <xref ref-type="fig" rid="F2">Figure 2A</xref>.</p></sec><sec id="S7"><title>Silver mirrors</title><p id="P15">Most mirrors, including silver mirrors, lead to a phase delay between the s and p polarization components, which can spoil carefully engineered polarization states. By aligning the EOM in along the s/p coordinate system and placing the polarizer directly after the SLM, any phase imposed by the mirrors can be compensated by adjusting the static offset of the EOM phase.</p></sec><sec id="S8"><title>Aberrated wave fronts</title><p id="P16">Laser sources, especially free space diode lasers, can have an imperfect beam profile. Additionally, optical components (wave plates, EOM, mirrors) can further deteriorate the wave front, leading to aberrated PSFs and a reduced contrast of the intensity minimum. Here, whenever possible, we place optical components (EOM, waveplate) before the mode cleaner, which then produces a close to ideal wavefront. To reduce astigmatism and coma introduced by a slightly curved SLM, we choose a small beam size on the SLM. In the future, we will insert a second SLM before the microscope to compensate for aberrations from the objective lens or sample.</p></sec><sec id="S9"><title>Polarization of MINFLUX PSFs</title><p id="P17">The x and y phase pattern require the polarization to be parallel to the phase boundary, which can be fulfilled only for one of the directions. One solution is to reflect the beam for a second time on the SLM and rotate the polarization state only for the x pattern (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>). The non-ideal direction of the birefringent axis can only rotate the polarization by 67° leading to a calculated deviation of at least 11.5° from the optimal polarization for both the x and y patterns. This results in a contrast of not better than 0.6% (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>), which however is still acceptable (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2C</xref>). A more accurate alternative is to add a second EOM to the output beam path to generate an optimal polarization state for each phase pattern.</p></sec></sec><sec id="S10"><title>Experimental demonstration</title><p id="P18">To experimentally validate our idea without the need of implementing a complete MINFLUX microscope, we designed a beam path in which we replaced the objective lens by an f = 400 mm achromat and the single fluorophore by a small pinhole and photo detector that reports the intensity at the putative single-fluorophore position (<xref ref-type="fig" rid="F2">Figure 2A</xref>). Additionally, we imaged the MINFLUX PSFs with a CMOS camera.</p><p id="P19">The bisected phase patterns produced the expected bilobed PSFs (<xref ref-type="fig" rid="F2">Figure 2B,C</xref>) with high contrast. By changing the EOM phase, we could scan these patterns laterally with only a minimal loss in contrast (<xref ref-type="fig" rid="F2">Figure 2C</xref>). The top-hat phase pattern produced a high-contrast circular illumination pattern in the focus, and a change in the EOM phase led to an increased signal in the center (<xref ref-type="fig" rid="F2">Figure 2B</xref>). Indeed, when placing the achromat at different distances from the pinhole which effectively changes the pinhole’s z-position, the signal was minimal at different EOM phases, demonstrating that the minimum of the ‘3D donut’ can be scanned in z without degradation (<xref ref-type="fig" rid="F2">Figure 2D</xref>).</p><p id="P20">To mimic the excitation signal seen by a single fluorophore, we placed a tiny pinhole (0.03 Airy Units) in the focus of the achromat, which transmits the intensity in the central part of the PSF (<xref ref-type="fig" rid="F3">Figure 3A</xref>). We measured the intensity with an amplified photo diode while changing the EOM phase. Specifically, we alternated the x, y and z phase patterns on the SLM and produced a linear EOM phase ramp for each pattern. The intensity trace showed pronounced minima for each phase pattern with an excellent contrast (minimum relative to the intensity detected from a Airy PSF created by a flat phase pattern) of 0.2%, 0.3%, and 0.2 % for the x, y, and z phase patterns, respectively (<xref ref-type="fig" rid="F3">Figure 3B</xref>).</p><p id="P21">Next, we tested the speed of our MINFLUX excitation module by repeatedly applying three different EOM phases, mimicking the positioning of the x-PSF at 3 positions around the fluorophore. With excitation times as low as 1 μs per position we could reliably detect three different intensity values with high contrast (<xref ref-type="fig" rid="F3">Figure 3C</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref>). Note that our time resolution is currently limited by the electronics for EOM scanning and the bandwidth of the photo diode and can in principle be at least one order of magnitude faster. But even the current implementation is sufficiently fast to not limit any MINFLUX application, as it allows ~60 scanning cycles within the 180 μs localization time we use for each coordinate.</p><p id="P22">Multi-color MINFLUX excitation can be realized with the same setup without modifications by using as an input co-linear laser beams. In case of small distances between the fluorophores and low spectral dependence of the phase delay <italic>φ</italic>, both lasers can be used simultaneously. Otherwise, both lasers can be alternated (<xref ref-type="fig" rid="F3">Figure 3E</xref>). As switching between the lasers takes less than one microsecond, the colors can be alternated many times within one MINFLUX localization time, leading to quasi-simultaneous localization of two or more fluorophores.</p></sec></sec><sec id="S11" sec-type="discussion"><title>Discussion</title><p id="P23">We developed an excitation module for 3D and multi-color MINFLUX that combines fast and precise positioning of the intensity minimum with a robust and affordable setup. Probing intensities around the single fluorophore takes as little as one microsecond. This enables averaging over fluorophore flickering or a temporally varying background, which otherwise would lead to a bias in the localization. The ability to switch quickly between different phase patterns allowed us to use an optimized PSF for each dimension. The bilobed PSFs that we use for lateral localization result in a high precision for a given number of detected photons (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). They have a smaller footprint compared to donut<sup><xref ref-type="bibr" rid="R1">1</xref></sup> or interferometric PSFs<sup><xref ref-type="bibr" rid="R6">6</xref></sup>, and especially compared to the 3D donut used for 3D MINFLUX<sup><xref ref-type="bibr" rid="R2">2</xref></sup>, and are thus more robust for higher densities of fluorophores. More importantly, they require lower laser powers, leading to a reduced background and ultimately improved localization precisions (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>). The high probing speed also allows for more complex scanning patterns with a higher number of positions. It remains to be explored if this can improve the background estimation and localization precision.</p><p id="P24">Currently, multi-color MINFLUX is performed sequentially with different fluorophores, or using a single excitation laser in combination with fluorophores of slightly different emission wavelengths<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. This however precludes using MINFLUX for co-tracking of two colors simultaneously. In principle, multi-color MINFLUX could be implemented by duplicating the excitation beam path for each color. With our implementation, however, this is not necessary, as the same excitation module can be used for simultaneous or quasi-simultaneous MINFLUX localization of two fluorophores or more.</p><p id="P25">As all beams are colinear and are not split up to generate different patterns, colors, or interference phases, they cannot misalign with respect to each other. Thus, our setup is intrinsically robust and stable, which is essential to reach sub-nanometer accuracies in MINFLUX and to use it for routine biological applications. Stability is further supported by the simplicity of the setup with few components and short beam paths. Compared to components employed for pattern generation and 3D scanning in commercial and custom instruments, our solution is very cost-effective, making it a key element for the future development of an affordable open-source MINFLUX instrument with highest performance.</p></sec><sec id="S12" sec-type="methods"><title>Methods</title><sec id="S13"><title>Calculation of polarization states and point spread functions</title><sec id="S14"><title>Calculation of polarization states</title><p id="P26">The polarization state of the beam was calculated in Mathematica (Wolfram) using Jones matrices (<bold>Data and code availability</bold>). Here, a linearly polarized beam is described by <disp-formula id="FD1"><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula> in the horizontal / vertical coordinate system, and a beam with 45° linear polarization by <disp-formula id="FD2"><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mn>45</mml:mn></mml:mrow><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P27">A waveplate (e.g., halfwave plate or SLM) with a phase delay of <italic>φ</italic> and an angle of <italic>α</italic> with respect to the horizontal axis is described by <disp-formula id="FD3"><mml:math id="M9"><mml:mrow><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mi>cos</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>sin</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>α</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>cos</mml:mi><mml:mi>α</mml:mi><mml:mi>sin</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mi>sin</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>cos</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P28">The EOM with a phase delay of <italic>φ</italic> is described by <disp-formula id="FD4"><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P29">A polarizer transmitting horizontal polarization is described by <disp-formula id="FD5"><mml:math id="M11"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="1.0em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="1.0em"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P30">The simple setup (<xref ref-type="fig" rid="F1">Figure 1</xref>) can then be modeled for on-pixels as: <disp-formula id="FD6"><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>4</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mn>45</mml:mn></mml:mrow><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p id="P31">A realistic setup with experimental imperfections is modeled as: <disp-formula id="FD7"><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext>out</mml:mtext><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>4</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>φ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mn>45</mml:mn></mml:mrow><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p id="P32">For <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref> we summed up the field for on- and off-pixels to calculate the intensity after destructive interference. For a given combination of <italic>dϕ</italic><sub><italic>SLM</italic></sub> and <italic>dα</italic><sub><italic>SLM</italic></sub> we determined numerically the HWP angle <italic>α</italic> and EOM phase <italic>φ</italic> that minimized this intensity.</p></sec><sec id="S15"><title>Calculation of MINFLUX point-spread functions</title><p id="P33">For the numerical calculations of the electromagnetic field near the focus of an objective lens, we used MATLAB (R2022a, MathWorks) and a software package<sup><xref ref-type="bibr" rid="R11">11</xref></sup>. We used the following parameters: 100x objective lens, aperture diameter 6.5 mm, numerical aperture 1.35; refractive index 1.406 for the immersion and mounting media; wavelength 635 nm; beam diameter 7.0 mm; flat illumination intensity profile; circular polarization for 3D donut and linear polarization for the rest; and voxel size 2 nm, unless otherwise specified. For the calculation of the interferometric PSF used in Wolff et al.<sup><xref ref-type="bibr" rid="R6">6</xref></sup>, we used two beams with a Gaussian intensity profile, a beam diameter of 2.3 mm, the beam offset from the center of 2.3 mm, and a relative phase delay of <italic>π</italic> between the two beams<sup><xref ref-type="bibr" rid="R12">12</xref></sup>.</p></sec><sec id="S16"><title>Calculation of Cramer-Rao-Bounds (CRBs)</title><p id="P34">For calculating the theoretically best possible localization precision for specific PSFs, scanning schemes, detected photons and signal to background ratios we followed Masullo et al.<sup><xref ref-type="bibr" rid="R13">13</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>, <bold>Data and code availability</bold>). During MINFLUX localization, the fluorophore at position <bold><italic>r</italic></bold><sub><italic>E</italic></sub> is probed with different PSFs <italic>I</italic><sub><italic>i</italic></sub> (<bold><italic>r</italic></bold><sub><italic>E</italic></sub>) to result in <italic>K</italic> emitter intensities <bold><italic>n</italic></bold> = [<italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, …, <italic>n</italic><sub><italic>K</italic></sub>]. This includes the case when the PSF is positioned to coordinates <bold><italic>r</italic></bold><sub><italic>i</italic></sub>, then <italic>I</italic><sub><italic>i</italic></sub> (<bold><italic>r</italic></bold><sub><italic>E</italic></sub>) = <italic>I</italic>(<bold><italic>r</italic></bold><sub><italic>E</italic></sub> − <bold><italic>r</italic></bold><sub><italic>i</italic></sub>), but also the case where the <italic>I</italic><sub><italic>i</italic></sub> (<bold><italic>r</italic></bold><sub><italic>E</italic></sub>) are calculated explicitly. With <disp-formula id="FD8"><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mrow><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mrow><mml:msub><mml:mi>∑</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mrow/></mml:munder></mml:mrow><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow/></mml:munder><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> the log-likelihood (after dropping of constant terms) can be written as <disp-formula id="FD9"><mml:math id="M15"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>ln</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mrow/><mml:mrow/></mml:munderover></mml:mrow></mml:math></disp-formula></p><p id="P35">The Fisher information matrix can then be written as: <disp-formula id="FD10"><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1.0em"/><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1.0em"/><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1.0em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1.5em"/><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1.0em"/><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1.0em"/><mml:mspace width="0.4em"/><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P36">The CRB is then <disp-formula id="FD11"><mml:math id="M17"><mml:mrow><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mspace width="0.2em"/></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">J</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P37">To account for imperfect contrast and a fluorescent background, we modeled the background explicitly by adding an offset to the PSF. To make the background comparable for different PSFs, we calculated the maximum value <italic>I</italic><sub><italic>A</italic></sub>(0) of an Airy PSF with a flat phase pattern and equal summed intensity and added the offset <italic>b. I</italic><sub><italic>A</italic></sub>(0) to the PSF. We chose this approach over using the signal-to-background (SBR) ratio<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, because the latter varies strongly across the PSF. The reported maximum localization precisions are normalized to the input photon counts <italic>N</italic> as <inline-formula><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> and averaged over the dimensions, with <inline-formula><mml:math id="M19"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M20"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. They thus report the localization precision of a single photon.</p></sec></sec><sec id="S17"><title>Optical setup</title><p id="P38">See <xref ref-type="fig" rid="F2">Figure 2A</xref>. As a light source we used either an iBeam smart 640 nm laser (Toptica) together with an achromatic halfwave plate (AHWP10M-600, Thorlabs) or a multi-color laser engine (MLE HP, Toptica) together with a collimator and beam expander (GBE05-A, Thorlabs) to achieve a beam diameter of approx. 1 mm and a polarization direction of around 45°. The beam was adjusted through a Glan-Thompson polarizer aligned at 45° (GTH10M-A, Thorlabs) and an EOM (EO-AM-NR-C4, Thorlabs) that was mounted under 45° with a custom holder so that its birefringent axis was vertical. As the MgO-doped lithium niobate in this EOM displays a slow negation to an applied DC field for wavelengths shorter than approx. 600 nm, we used a different EOM (LM0202 KD*P 3x3, LINOS) for multi-color measurements, also mounted with its birefringent axis aligned along the vertical direction. The beam then passed an achromatic halfwave plate (AHWP10M-600, Thorlabs) that was used to compensate for imperfections of the SLM and a mode cleaner/beam expander consisting of an f = 40 mm achromat (Thorlabs), a 20 μm pinhole (Thorlabs) and an f = 150 mm achromat (Thorlabs). An iris (SM1D12D, Thorlabs) with a diameter of approx. 2.3 mm resulted in a nearly homogenous beam profile.</p><p id="P39">The beam was then reflected off the SLM (SXGA-R12-STR, Fourth Dimension Displays) under an angle of approx. 5°, passed a polarizing beam splitter (PBS251, Thorlabs), and was focused onto a 10 μm pinhole (Thorlabs) with an f = 400 mm achromat (Thorlabs). The intensity after the pinhole was monitored with an amplified photo diode (PDA100A2, Thorlabs). Alternatively, the beam was focused onto a CMOS camera (Chameleon CM3-U3-50S5M-CS, Edmund Optics).</p></sec><sec id="S18"><title>Electronic control</title><p id="P40">The EOM was driven by a voltage amplifier (HVA200, Thorlabs), which was controlled by a function generator (SDG1062X, Siglent). Intensity signals from the photo diode were acquired with an oscilloscope (SDS2104X-Plus, Siglent). The function generator and the oscilloscope were triggered by the SLM at the start of an image sequence. Additionally, the SLM produces a trigger signal when a valid pattern is established, which was used to switch off the lasers during the pattern switching via a TTL signal. Camera images were recorded asynchronously. For dual-color measurements, we used a custom TTL signal converter in combination with the function generator to alternate between the 561 nm and 638 nm laser line.</p></sec><sec id="S19"><title>Alignment</title><p id="P41">We used a polarization analyzer (PAX1000VIS/M, Thorlabs) to align the Glen-Thompson polarizer to 45°. Using a flat phase pattern and large iris diameter, the camera was positioned in the focus of the f = 400 mm achromat. The pinhole was then positioned at an equal distance from the achromat.</p><p id="P42">Using the top-hat phase pattern, the beam was aligned on the SLM to produce a symmetric PSF. Then the iris diameter and EOM phase were optimized to maximize the contrast of the 3D-donut in focus. The contrast was further maximized by aligning the angle of the half wave plate and the EOM phase.</p><p id="P43">The pinhole, mounted in an x-y translation stage (ST1XY-D/M, Thorlabs), was adjusted in the lateral directions to maximize the signal on the photo diode.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS190579-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d2aAdGbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgements</title><p>We thank Giuseppe Vicidomini and Eli Slenders for their kind feedback on the manuscript, Luciano Masullo for help with the CRB calculations and the EMBL electronic and mechanic workshops for contributing to the setup. This work was supported by H2020 Marie Sklodowska-Curie Actions (RobMin grant no. 101031734 to T.D.); the European Research Council (grant no. ERC CoG-724489 to J.R.); and the European Molecular Biology Laboratory (T.D. and J.R.).</p></ack><sec id="S21" sec-type="data-availability"><title>Data and code availability</title><p id="P44">Simulated PSFs, scripts to calculate CRBs and a script to calculate the polarization state are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ries-lab/MINFLUXexcitation">https://github.com/ries-lab/MINFLUXexcitation</ext-link>.</p></sec><fn-group><fn fn-type="conflict" id="FN1"><p id="P45"><bold>Competing interests</bold></p><p id="P46">The EMBL has deposited the European patent application 23193790.5 on the 28 July 2023 to protect this work. T.D. and J.R. are co-inventors.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balzarotti</surname><given-names>F</given-names></name><etal/></person-group><article-title>Nanometer resolution imaging and tracking of fluorescent molecules with minimal photon fluxes</article-title><source>Science</source><year>2017</year><volume>355</volume><fpage>606</fpage><lpage>612</lpage><pub-id pub-id-type="pmid">28008086</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gwosch</surname><given-names>KC</given-names></name><etal/></person-group><article-title>MINFLUX nanoscopy delivers 3D multicolor nanometer resolution in cells</article-title><source>Nature Methods</source><year>2020</year><volume>17</volume><fpage>217</fpage><lpage>224</lpage><pub-id pub-id-type="pmid">31932776</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pape</surname><given-names>JK</given-names></name><etal/></person-group><article-title>Multicolor 3D MINFLUX nanoscopy of mitochondrial MICOS proteins</article-title><source>Proc Natl Acad Sci USA</source><year>2020</year><volume>117</volume><fpage>20607</fpage><lpage>20614</lpage><pub-id pub-id-type="pmcid">PMC7456099</pub-id><pub-id pub-id-type="pmid">32788360</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2009364117</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostersehlt</surname><given-names>LM</given-names></name><etal/></person-group><article-title>DNA-PAINT MINFLUX nanoscopy</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>1072</fpage><lpage>1075</lpage><pub-id pub-id-type="pmcid">PMC9467913</pub-id><pub-id pub-id-type="pmid">36050490</pub-id><pub-id pub-id-type="doi">10.1038/s41592-022-01577-1</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eilers</surname><given-names>Y</given-names></name><name><surname>Ta</surname><given-names>H</given-names></name><name><surname>Gwosch</surname><given-names>KC</given-names></name><name><surname>Balzarop</surname><given-names>F</given-names></name><name><surname>Hell</surname><given-names>SW</given-names></name></person-group><article-title>MINFLUX monitors rapid molecular jumps with superior spatiotemporal resolution</article-title><source>Proceedings of the National Academy of Sciences</source><year>2018</year><volume>115</volume><fpage>6117</fpage><lpage>6122</lpage><pub-id pub-id-type="pmcid">PMC6004438</pub-id><pub-id pub-id-type="pmid">29844182</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1801672115</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolff</surname><given-names>JO</given-names></name><etal/></person-group><article-title>MINFLUX dissects the unimpeded walking of kinesin-1</article-title><source>Science</source><year>2023</year><volume>379</volume><fpage>1004</fpage><lpage>1010</lpage><pub-id pub-id-type="pmid">36893244</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deguchi</surname><given-names>T</given-names></name><etal/></person-group><article-title>Direct observation of motor protein stepping in living cells using MINFLUX</article-title><source>Science</source><year>2023</year><volume>379</volume><fpage>1010</fpage><lpage>1015</lpage><pub-id pub-id-type="pmcid">PMC7614483</pub-id><pub-id pub-id-type="pmid">36893247</pub-id><pub-id pub-id-type="doi">10.1126/science.ade2676</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>R</given-names></name><etal/></person-group><article-title>MINFLUX nanometer-scale 3D imaging and microsecond-range tracking on a common fluorescence microscope</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>1478</fpage><pub-id pub-id-type="pmcid">PMC7935904</pub-id><pub-id pub-id-type="pmid">33674570</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-21652-z</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masullo</surname><given-names>LA</given-names></name><name><surname>Stefani</surname><given-names>FD</given-names></name></person-group><article-title>Multiphoton single-molecule localization by sequential excitation with light minima</article-title><source>Light Sci Appl</source><year>2022</year><volume>11</volume><fpage>70</fpage><pub-id pub-id-type="pmcid">PMC8948360</pub-id><pub-id pub-id-type="pmid">35332123</pub-id><pub-id pub-id-type="doi">10.1038/s41377-022-00763-2</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masullo</surname><given-names>LA</given-names></name><etal/></person-group><article-title>Pulsed Interleaved MINFLUX</article-title><source>Nano Le&gt;</source><year>2021</year><volume>21</volume><fpage>840</fpage><lpage>846</lpage><pub-id pub-id-type="pmid">33336573</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leutenegger</surname><given-names>M</given-names></name><name><surname>Rao</surname><given-names>R</given-names></name><name><surname>Leitgeb</surname><given-names>RA</given-names></name><name><surname>Lasser</surname><given-names>T</given-names></name></person-group><article-title>Fast focus field calculations</article-title><source>Opt Express</source><year>2006</year><volume>14</volume><fpage>11277</fpage><lpage>11291</lpage><pub-id pub-id-type="pmid">19529543</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Engelhardt</surname><given-names>T</given-names></name></person-group><source>MINFLUX Nanoscopy with Interferometric Approach</source><publisher-name>University of Heidelberg</publisher-name><year>2023</year></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Masullo</surname><given-names>LA</given-names></name><name><surname>Lopez</surname><given-names>LF</given-names></name><name><surname>Stefani</surname><given-names>FD</given-names></name></person-group><article-title>A common framework for single-molecule localization using sequential structured illumination</article-title><source>Biophysical Reports</source><year>2022</year><volume>2</volume><elocation-id>100036</elocation-id><pub-id pub-id-type="pmcid">PMC9680809</pub-id><pub-id pub-id-type="pmid">36425082</pub-id><pub-id pub-id-type="doi">10.1016/j.bpr.2021.100036</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Idea.</title><p><bold>A: Phase patterns and point-spread functions (PSFs)</bold> for MINFLUX localization in the x-, y- and z-direction, respectively. The phase <italic>φ</italic> determines the position of the intensity minimum (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>). <bold>B: Theoretical localization precision limit</bold>, the Cramér-Rao bound, for 2D MINFLUX for sequential localization with the bilobed x and y patterns (left) and 3D MINFLUX with the bilobed x and y patterns plus the 3D donut (right), in a region at the centre of the PSF as denoted in A. Simulation parameters: scan range L = 50 nm in the lateral and L<sub>z</sub> = 150 nm in the axial direction and a background of 0.5% of the maximum intensity when <italic>φ</italic> = 0. The calculated localization precisions are normalized by <inline-formula><mml:math id="M21"><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, and thus report the localization precision for a single photon. Circles indicate the positions of the minimum during probing. <bold>C: A fast spatially varying phase plate</bold> for MINFLUX excitation comprising an electro-optical modulator (EOM), a spatial light modulator (SLM) and a polarizer. The input beam is polarized under 45° and the output is focused onto the single fluorophore by the microscope objective lens. <bold>D: Illustration of principle</bold>. The vertical polarization component experiences a phase shift of <italic>φ</italic> by the EOM. The ‘on’-pixels of the SLM turn the vertical component into the horizontal component and vice versa, whereas the ‘off’-pixels leave the state unchanged. The horizontal state transmitted by the polarizer thus has the phase <italic>φ</italic> of the EOM for the ‘on’-pixels and no additional phase for the ‘off’-pixels. Scale bars 500 nm (A), 100 nm (B).</p></caption><graphic xlink:href="EMS190579-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Experimental demonstration with camera detection. A: Beam path of the test setup.</title><p>The laser is polarized under 45°, passes the electro-optical modulator (EOM), a halfwave plate (HWP) to compensate for imperfections of the Spatial Light Modulator (SLM) and a beam expander comprising achromatic lenses and a pinhole. After the SLM, it passes another polarizer and is focused by an achromat either onto a CMOS camera or onto a small pinhole with a photo diode that detects the intensity a fluorophore would see. <bold>B:</bold> PSFs recorded with the camera for different phases (as indicated) imposed by the EOM for the bilobed x pattern and the 3D-donut z pattern. The scale bar and values in nm are rescaled corresponding to an implementation in a microscope with an NA 1.35 objective lens. <bold>C:</bold> Profiles through the x-PSF as indicated in B for different EOM phases with a difference of 5° between consecutive profiles. <bold>D</bold>. Intensities at the center pixel of the z-PSF for different EOM voltages. Each profile was measured with the last lens positioned at a different distance from the camera (step size 2 mm) and corresponds to measurements with a fluorophore at different z positions (corresponding to a step size of 18 nm in z when integrated in a microscope). Inset: Cross-section through the PSF as indicated in B for different phases <italic>φ</italic> imposed by the EOM.</p></caption><graphic xlink:href="EMS190579-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title><bold>Demonstration of fast scanning using a pinhole</bold>, see <xref ref-type="fig" rid="F2">Figure 2</xref> for the beam path.</title><p><bold>A:</bold> An experimental x-PSF acqiured by a camera with the position of the pinhole indicated by a circle. <bold>B:</bold> Intensity (normalized to the intensity measured for a flat phase pattern) recorded through the pinhole for a linear ramp in the EOM voltage. The intensity reaches a minimum (contrast value indicated in the graph) when the minimum of the PSF is at the pinhole position. The measurement is repeated for the different phase patterns (insets) for y- and z-localization, respectively. Switching between phase patterns takes 60 μs. <bold>C:</bold> Mimicking of a MINFLUX measurement. By imposing three different voltages, each lasting for 1 μs, the minimum of the phase pattern is positioned at three distinct positions around the fluorophore. x<sub>0</sub> indicates the position of the minimum for the case when the setup is used in conjunction with a microsope objective, L is the diameter of the scan pattern. <bold>D:</bold> By changing the amplitude of the voltage, the scan range L can be reduced to improve the localization precision. <bold>E:</bold> By using two colinear laser beams of different colors which are alternated (in this case every 9 μs correspodning to 3 scan patterns), dual-color MINFLUX excitation can be realized without further modifications of the setup.</p></caption><graphic xlink:href="EMS190579-f003"/></fig></floats-group></article>