<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS189721</article-id><article-id pub-id-type="doi">10.1101/2023.10.12.562040</article-id><article-id pub-id-type="archive">PPR742462</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Tracking neurons across days with high-density probes</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>van Beest</surname><given-names>Enny H.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Bimbard</surname><given-names>Célian</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Fabre</surname><given-names>Julie M.J.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Takács</surname><given-names>Flóra</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Coen</surname><given-names>Philip</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lebedeva</surname><given-names>Anna</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Harris</surname><given-names>Kenneth</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Carandini</surname><given-names>Matteo</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><aff id="A1"><label>1</label>UCL Institute of Ophthalmology, University College London</aff><aff id="A2"><label>2</label>UCL Queen Square Institute of Neurology, University College London</aff><aff id="A3"><label>3</label>Sainsbury-Wellcome Centre, University College London</aff></contrib-group><pub-date pub-type="nihms-submitted"><day>18</day><month>10</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>16</day><month>10</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license><license><ali:license_ref>https://europepmc.org/downloads/openaccess</ali:license_ref><license-p>This preprint is made available via the <ext-link ext-link-type="uri" xlink:href="https://europepmc.org/downloads/openaccess">Europe PMC open access subset</ext-link>, for unrestricted research re-use and secondary analysis in any form or by any means with acknowledgement of the original preprint source.</license-p></license></permissions><abstract><p id="P1">Neural activity spans multiple scales from milliseconds to months. Its evolution can be recorded with chronic electrodes, and especially with high-density arrays such as Neuropixels probes, which measure each spike at tens of sites and record hundreds of neurons. These arrays often record units with consistent spike waveforms over time, but produce vast amounts of data that require new approaches for tracking neurons across recordings. To meet this need, we developed UnitMatch, an open-access pipeline that operates after spike sorting, based only on each unit’s average spike waveform. We tested UnitMatch in Neuropixels recordings from the mouse brain, where it tracked neurons across weeks. In visual cortex, a neuron’s selectivity for visual stimuli and correlation with other neurons remained stable over days. In striatum, neuronal responses changed across days during learning of a task. UnitMatch is thus a promising tool to reveal invariance or plasticity in neural activity across days.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Neural activity spans a multitude of time scales, from the milliseconds that separate spikes to the days or months that characterize memory, learning, or aging. Changes at these longer timescales can be studied with two-photon imaging, where the same neurons can be visually tracked across days<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R5">5</xref></sup>. However, imaging methods miss the fast timescales and are hard to implement outside of cortex or in multiple areas at once. To cover all time scales across the brain, the ideal method is to use chronic electrodes.</p><p id="P3">Recordings with chronic electrodes reveal units (putative neurons) with consistent spike waveforms across days<sup><xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R20">20</xref></sup>. This constancy indicates that the units track the same neurons over time, particularly when the spikes are measured at multiple locations with stereotrodes<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, tetrodes<sup><xref ref-type="bibr" rid="R14">14</xref>,<xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R21">21</xref>–<xref ref-type="bibr" rid="R26">26</xref></sup>, microwire bundles<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>, silicon probes<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R29">29</xref></sup> and Neuropixels probes<sup><xref ref-type="bibr" rid="R30">30</xref></sup>.</p><p id="P4">In addition to spike waveform, the tracked units can maintain distinctive firing properties such as inter-spike interval distribution<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>, and functional properties such as sensory, cognitive, or motor correlates<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>. Consistent functional properties across days can provide a strong indication that a neuron has been tracked, but functional properties are not necessarily constant over time, and their variation is often the scientific question being investigated<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R31">31</xref>–<xref ref-type="bibr" rid="R33">33</xref></sup>.</p><p id="P5">Tracking neurons across days has become more appealing with high-density arrays such as Neuropixels probes<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup>. These probes are readily implanted chronically<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R35">35</xref>–<xref ref-type="bibr" rid="R38">38</xref></sup>, yielding hundreds of potentially matchable neurons across days. In addition, their geometry and density allow for reliable correction of electrode drift. All electrodes tend to drift relative to the brain, so that recorded neurons may appear and disappear, or change their apparent spike waveform. With rigid probes such as Neuropixels, however, most of the movement is likely to be parallel to the probe, causing the spikes to move from some recording sites to others. It is possible to compensate for this movement in software, so that neurons can be tracked robustly both within and across days<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R39">39</xref></sup>.</p><p id="P6">However, the current methods for matching neurons across days cannot process the vast amounts of data produced by multiple days of Neuropixels recordings. For example, one method relies on concatenating two recordings and spike sorting the resulting file<sup><xref ref-type="bibr" rid="R29">29</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. This method is robust for pairs of recordings but becomes unwieldy for longer sequences: it does not scale to dozens of recordings obtained across weeks or months.</p><p id="P7">To solve this problem, we developed a pipeline called UnitMatch, which operates after spike sorting: each recording is spike sorted independently, without concatenation, with the user’s preferred algorithm. UnitMatch then deploys a fast and scalable naïve Bayes classifier on the units’ average spatiotemporal waveform in each recording, and tracks units across recordings assigning a probability to each match.</p><p id="P8">We tested UnitMatch in cortical and subcortical brain regions and found that it reliably tracked neurons across days and weeks. Its performance compares well to the concatenated method and to manual curation by human experts, while being both much faster and applicable to larger numbers of recordings.</p><p id="P9">Because UnitMatch does not rely on any properties of a unit beyond its spike waveform, it can be used to test whether these properties change over time. We used it to examine simple distinctive properties of neurons in mouse visual cortex, such as the correlation with other neurons or with visual stimuli. These properties remained remarkably stable, further confirming the ability of UnitMatch to track neurons across days. We also used UnitMatch to characterize the changes of neural representations in striatum neurons during learning, showing that UnitMatch can track neural dynamics in multiple brain regions on both fast and slow time scales.</p></sec><sec id="S2" sec-type="methods | results"><title>Methods and Results</title><p id="P10">UnitMatch tracks units across recordings that have been individually spike sorted (<xref ref-type="fig" rid="F1">Figure 1</xref>). It takes as input the average spatiotemporal spike waveform of each unit in each half of each recording (Step 0). It then extracts key parameters from this waveform (Step 1) and uses them to compute similarity scores for each possible pair of units (Step 2). It performs within-day cross-validation to identify a similarity score threshold for putative matches (Step 3). It then corrects for drift (Step 4) across recordings and repeats Steps 1-3 to recompute the putative matches. Finally, it builds probability distributions for the similarity scores for putative matches and feeds them to a classifier to assign a probability to every possible match, suggesting unique identities to all units across recordings (Step 5).</p><p id="P11">Below, we describe these steps and illustrate them on a large body of data obtained in our laboratory. The description in the text is qualitative, and the equations are provided in Supplementary Information, section Mathematical definitions. We then assess the quality of matches by comparing the results with other approaches, and by measuring functional properties of the neurons that were remarkably consistent across days. Furthermore, we show that UnitMatch can track functional properties that change during learning.</p><sec id="S3"><title>Step 0. Spike sorting</title><p id="P12">Before using UnitMatch, the users record neural activity in multiple sessions, and use their preferred software to spike sort each recording independently. For each recording, the results are put in a directory where each unit contributes a file with the average spatiotemporal spike waveform in the first and in the second half of the recording. These files have no information on individual spikes.</p><p id="P13">To develop, test, and illustrate UnitMatch, we used over 1,500 recording sessions performed over multiple days (up to 183) in mice implanted with chronic Neuropixels probes<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R34">34</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup> in multiple brain regions including cortex, hippocampus, striatum, and superior colliculus (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>). Each recording session was individually spike sorted with Kilosort<sup><xref ref-type="bibr" rid="R40">40</xref></sup>, which provides drift correction within each session<sup><xref ref-type="bibr" rid="R30">30</xref></sup>. After spike sorting, we used a set of quality measures<sup><xref ref-type="bibr" rid="R41">41</xref></sup> to select 21.9 ± 11.5% (mean ± s.d. n = 1,514 recording sessions across 17 mice) units that were well isolated and distinct from noise (<xref ref-type="supplementary-material" rid="SD1">Figure S1</xref>).</p></sec><sec id="S4"><title>Step 1: Waveform parameters</title><p id="P14">High-density recording arrays such as Neuropixels probes (<xref ref-type="fig" rid="F2">Figure 2A</xref>) sample the spikes of an individual unit at many recording sites, revealing the unit’s characteristic spatiotemporal waveform (<xref ref-type="fig" rid="F2">Figure 2B</xref>). The amplitude of the waveform peaks at a maximum site and decays gradually with distance from that site (<xref ref-type="fig" rid="F2">Figure 2B,C</xref>). UnitMatch fits this decay with an exponential function and obtains the distance <italic>d</italic><sub>10</sub> at which the amplitude reaches 10% of the maximum (<xref ref-type="fig" rid="F2">Figure 2C</xref>). In the example recordings, this value ranged between 30 and 114 μm (95% confidence interval, <xref ref-type="fig" rid="F2">Figure 2D</xref>). For each unit, UnitMatch considers the recording sites closer than <italic>d</italic><sub>10</sub> (but at most 150 μm away) from the maximum site. In our data, this typically resulted in 6-24 sites arranged in two columns (e.g., <xref ref-type="fig" rid="F2">Figure 2A-B</xref>).</p><p id="P15">For each unit, UnitMatch uses the spatiotemporal spike waveform measured at the selected recording sites to extract seven attributes: <list list-type="bullet" id="L1"><list-item><p id="P16">The spatial <bold>decay</bold>, i.e., the rate at which amplitude decreases with distance from the maximum site (<xref ref-type="fig" rid="F2">Figure 2C</xref>, Equation 8).</p></list-item><list-item><p id="P17">The weighted-average <bold>waveform</bold> (<xref ref-type="fig" rid="F2">Figure 2E</xref>; Equation 9) obtained by averaging waveforms across sites, weighted by the maximum amplitude of each site.</p></list-item><list-item><p id="P18">The <bold>amplitude</bold> of that weighted-average waveform (<xref ref-type="fig" rid="F2">Figure 2E</xref>, Equation 10).</p></list-item><list-item><p id="P19">The average <bold>centroid</bold> (<xref ref-type="fig" rid="F2">Figure 2F</xref>, Equation 6), defined as the average position weighted by the maximum amplitude on each recording site.</p></list-item><list-item><p id="P20">The <bold>trajectory</bold> of the spatial centroid from 0.2 ms before the peak to 0.5 ms after the peak (<xref ref-type="fig" rid="F2">Figure 2F</xref>, Equation 4).</p></list-item><list-item><p id="P21">The <bold>distance</bold> travelled at each time point (<xref ref-type="fig" rid="F2">Figure 2F</xref>).</p></list-item><list-item><p id="P22">The travel <bold>direction</bold> of the spatial centroid at each time point (<xref ref-type="fig" rid="F2">Figure 2F</xref>, Equation 5).</p></list-item></list></p></sec><sec id="S5"><title>Step 2: Similarity scores</title><p id="P23">After extracting the spatiotemporal waveform parameters, UnitMatch compares these parameters for every pair of waveforms within and across days, computing six similarity scores using the extracted parameters: <list list-type="bullet" id="L2"><list-item><p id="P24"><bold>Decay</bold> similarity (<italic>D</italic>; Equation 14); spatial <italic>decay</italic>.</p></list-item><list-item><p id="P25"><bold>Waveform</bold> similarity (<italic>W</italic>, Equation 18); <italic>waveform</italic> correlation and normalized difference averaged.</p></list-item><list-item><p id="P26"><bold>Amplitude</bold> similarity (<italic>A</italic>; Equation 13)</p></list-item><list-item><p id="P27"><bold>Centroid</bold> similarity (<italic>C</italic>, Equation 20)</p></list-item><list-item><p id="P28"><bold>Volatility</bold> similarity (<italic>V</italic>, Equation 23); captures the stability of the difference between <italic>centroids</italic> over time.</p></list-item><list-item><p id="P29"><bold>Route</bold> similarity (<italic>R</italic>; Equation 24): captures the overall similarity of the <italic>trajectory</italic>: <italic>direction</italic> and <italic>distance</italic> travelled.</p></list-item></list></p><p id="P30">Each similarity score is scaled between zero and one, with one indicating the highest similarity. Finally, in addition to the six individual scores, we also average the scores to compute a <bold>total</bold> similarity score <italic>T</italic>.</p><p id="P31">To gain an intuition for these scores, consider their values for two example pairs of units. The first example involves two neighboring units recorded on the same day (<xref ref-type="fig" rid="F3">Figure 3A,B</xref>). Because they are near each other, they have high centroid similarity <italic>C</italic>. However, their spike waveforms are not similar (low value of <italic>W</italic>), and so are their spatial decays (low value of <italic>D</italic>) and routes (low value of <italic>R</italic>). As a result, the total similarity score <italic>T</italic> is well below 1 (<xref ref-type="fig" rid="F3">Figure 3C</xref>). Conversely, in the case of a single unit recorded in two different days we observed similar waveforms and trajectories (<xref ref-type="fig" rid="F3">Figure 3D,E</xref>), with high values of most similarity scores and consequently a total similarity score <italic>T</italic> near the maximal value of 1 (<xref ref-type="fig" rid="F3">Figure 3F</xref>).</p></sec><sec id="S6"><title>Step 3: Putative matches</title><p id="P32">We can now measure the total similarity score <italic>T</italic> for each pair of units within and across days. <italic>T</italic> tended to be high when applied to the same unit recorded across the two halves of a recording (main diagonal in <xref ref-type="fig" rid="F3">Figure 3G</xref>).</p><p id="P33">To identify putative matches, we defined a threshold as the value of <italic>T</italic> above which there were more pairs of waveforms from the same unit (green curve in <xref ref-type="fig" rid="F3">Figure 3H</xref>, <italic>top</italic>) than pairs of waveforms from neighboring units (average centroid distance &lt;50 μm, blue curve in <xref ref-type="fig" rid="F3">Figure 3H</xref>, <italic>top</italic>) (Equation 28).</p><p id="P34">The distribution of <italic>T</italic> across days resembled the neighbor distribution measured within days (red curve in <xref ref-type="fig" rid="F3">Figure 3H</xref>, <italic>bottom</italic>), with larger tail above the data-driven threshold. We thus select pairs with values of <italic>T</italic> beyond this threshold as putative matches across days.</p></sec><sec id="S7"><title>Step 4: Drift correction</title><p id="P35">First, we equalized the means of the distributions within and across days, to account for overall lower scores across days prior to drift correction. Then, we computed the median centroid displacement of the population of the putative matches across days. After applying this rigid transformation to all parameters affected by position, we then recalculated all the values computed in the previous three steps, thus finding a more robust set of putative matches. Results shown in <xref ref-type="fig" rid="F3">Figure 3</xref> are after this drift correction. Note that within-recording drift correction is taken care of by the spike sorting algorithm we used.</p></sec><sec id="S8"><title>Step 5: Match probabilities</title><p id="P36">Having used the total similarity score <italic>T</italic> to identify putative matches (<xref ref-type="fig" rid="F3">Figure 3H</xref>), UnitMatch then goes back to the individual similarity scores and uses their distributions to train a classifier. The total similarity score identifies putative matches (<italic>T</italic>&gt;threshold) and putative non-matches (<italic>T</italic>&lt;threshold, <xref ref-type="fig" rid="F3">Figure 3H</xref>). Plotting the distributions of the six similarity scores for these pairs reveals major differences (<xref ref-type="fig" rid="F3">Figure 3I</xref>). Based on these distributions, we defined a naïve Bayes classifier (Equation 29), which takes as input the values of the six similarity scores for two spike waveforms and outputs the ‘match probability’: the posterior probability of the two waveforms coming from the same unit.</p><p id="P37">This classifier correctly identified matches within a day and indicated that some pairs of units had a high probability of match across days. Within a day, matching probabilities were close to 1 for the same units measured in the first and second half of the recording (main diagonal in <xref ref-type="fig" rid="F3">Figure 3J</xref>, <italic>green curve</italic> in <xref ref-type="fig" rid="F3">Figure 3K</xref>, <italic>top</italic>), and were close to zero for neighboring units (<italic>blue</italic> in <xref ref-type="fig" rid="F3">Figure 3K</xref>, <italic>top</italic>). Across days, most pairs of unit waveforms are also expected to come from different neurons, which is reflected in a large fraction of matching probabilities close to 0 (<xref ref-type="fig" rid="F3">Figure 3K</xref>, <italic>bottom</italic>). However, a small proportion of unit pairs across days had a matching probability close to 1. These matches reflect units tracked across days.</p></sec><sec id="S9"><title>Performance metrics</title><p id="P38">We first evaluated UnitMatch’s performance using the cross-validation of the units’ waveforms within days, and found low percentages of false positives and false negatives (Supplementary analyses, <xref ref-type="supplementary-material" rid="SD1">Figure S3A</xref>). From the maximum possible number of units recorded across two consecutive days, UnitMatch found 31.3 ± 11.2% (median ± m.a.d., n = 446 pairs of days) to be a match. Reassuringly, when we applied UnitMatch to acute recordings, where the probe was reinserted daily and had negligible chance of finding the same unit, finding a match was rare (4.0 ± 2.8%, n = 18 pairs of consecutive days; Wilcoxon rank sum comparing chronic and acute: p &lt; 10<sup>-10</sup>; <xref ref-type="supplementary-material" rid="SD1">Figure S3B</xref>). Note that this was when UnitMatch was pushed to find matches by pretending the probe was in the same location between the recording sessions.</p><p id="P39">Next, we compared the performance of UnitMatch to expert manual curation and to spike sorting performed on stitched recordings<sup><xref ref-type="bibr" rid="R29">29</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. We found that UnitMatch performed more similarly to manual curation than to the sorting on stitched recordings (Supplementary analysis, <xref ref-type="supplementary-material" rid="SD1">Figure S3C-D</xref>). Sorting the stitched recordings with Kilosort tended to overestimate the number of matches across recordings, specifically for noisier datasets. The higher similarity between UnitMatch and manual curation is reassuring because the latter is generally regarded more highly than automated spike sorting. However, neither can be considered ground truth.</p></sec><sec id="S10"><title>Validation with stable functional properties</title><p id="P40">A more reliable estimate can be found by assessing the stability of the neurons’ functional activity. If this activity is found to be distinctive across neurons and stable across days, one can conclude that the tracking algorithm performed well. However, if the activity is found to change over days, then one cannot make such an inference. In our case, we found functional activity to be remarkably stable, yet distinctive across neurons, and thus could use this stability to validate UnitMatch performance.</p><p id="P41">We thus looked for functional ‘fingerprints’, i.e., patterns of activity that are known to be distinctive and are potentially stable across days. We considered three such fingerprints: a unit’s autocorrelogram (the correlation of the unit’s firing rate with its own firing rate at nearby times<sup><xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>), a unit’s response to a large set of visual stimuli (when the unit was in visual cortex<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>), and a unit’s population coupling (the correlation of its firing rate with the other units recorded at the same time<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R42">42</xref>,<xref ref-type="bibr" rid="R43">43</xref></sup>).</p><p id="P42">The autocorrelogram (ACG) of tracked units remained highly consistent across days. It has been used as a feature to track units across days<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup> or as a diagnostic of this tracking<sup><xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>. Accordingly, the ACGs were typically different for neighboring units but similar for units matched across days (<xref ref-type="fig" rid="F4">Figure 4A</xref>), which are two properties that are necessary for a good fingerprint. In an example mouse, we observed that the distribution of correlation for a pair of ACGs coming from matches across days was high (<xref ref-type="fig" rid="F4">Figure 4B</xref>), and to the same extent as cross-validated within-day comparisons. On the contrary, different units had much lower ACG correlations.</p><p id="P43">We quantified the separation of the distributions of the correlations of matched and non-matched pairs by computing the receiver operating characteristic (ROC) curve (<xref ref-type="fig" rid="F4">Figure 4C</xref>) and quantified the discriminability index as the area under the ROC curve (AUC). The AUC was high for this example pair of days (0.76), suggesting that the value of the ACGs correlation for a pair was predictive of whether it was a match or not. This held true even when increasing the number of days between recordings (<xref ref-type="fig" rid="F4">Figure 4D</xref>), and across all mice (<xref ref-type="fig" rid="F4">Figure 4E</xref>). On average, the AUC was 0.78 ± 0.01 across days (0.80 ± 0.01 within days, mean ± s.e., n = 17 mice) and decayed slowly with each additional day between recordings (-0.003 ± 0.049, median ± m.a.d., n = 17 mice). For the example mouse, the AUC remained at 0.78 after 183 days.</p><p id="P44">Units in visual cortex that were tracked across two days also typically showed consistent responses to visual stimuli. Neurons in mouse visual cortex give distinctive responses to natural images, and these responses are reproduced across days<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>. Consistent with this, a typical “match” returned by UnitMatch across days gave similar responses to natural images on each day (<xref ref-type="fig" rid="F4">Figure 4F</xref>). This set of responses provides a signature that was consistent both within and across days. In the example mouse, it yielded AUCs of 0.94 across days vs. 0.96 within days (<xref ref-type="fig" rid="F4">Figure 4G-H</xref>). Similar results were seen across mice, with AUCs of 0.86 ± 0.02 vs. 0.90 ± 0.02 (mean ± s.e., n = 10 mice). This held true even with long intervals between recordings (slope of -0.002 ± 0.009, median ± m.a.d., n = 10 mice, <xref ref-type="fig" rid="F4">Figure 4I-J</xref>). For the example mouse, the AUC was still 0.70 after 183 days.</p><p id="P45">Finally, the population coupling of tracked units was also highly consistent across days. The population coupling is the instantaneous correlation of a unit’s activity with the activity of other neurons in the population<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R42">42</xref>,<xref ref-type="bibr" rid="R43">43</xref></sup>. The cross-correlation of spikes of a unit to a population of reference units (tracked across the two days) was highly consistent across days (<xref ref-type="fig" rid="F4">Figure 4K</xref>). This cross-correlation with a reference population provided a distinctive ‘fingerprint’ that was highly correlated both within and across days (<xref ref-type="fig" rid="F4">Figure 4L</xref>), and not for neighboring units. The discriminability of this measure was particularly high, with AUC indices close to 1 (0.96 across days vs. 0.98 within days), indicating that the pairs found by UnitMatch were indeed highly likely to be the same across days (<xref ref-type="fig" rid="F4">Figure 4M</xref>). Again, this held true across mice (0.92 ± 0.01 vs. 0.96 ± 0.01 across mice, mean ± s.e., n = 17 mice) and even across weeks and months (-0.006 ± 0.030, median ± m.a.d., n = 17 mice), suggesting that the correlation patterns of the population of neurons were highly stable over time (<xref ref-type="fig" rid="F4">Figure 4N,O</xref>). For the example mouse, the AUC was still 0.80 after 183 days. This fingerprint, along with the ACG, can be used in any region of the brain since it does not depend on the area’s responses to external stimuli.</p><p id="P46">Using the stability of functional properties, we once more compared the performance of UnitMatch to running our spike sorting algorithm on stitched recordings. This time we ran both algorithms on four concatenated recording sessions and evaluated their accuracy using functional measures. In line with the earlier curation results, there was a larger overlap between functional response stability and UnitMatch than with spike sorting the concatenated data. This was especially the case with recording sessions further apart (<xref ref-type="supplementary-material" rid="SD1">Figure S3E-F</xref>).</p></sec><sec id="S11"><title>Tracking units across learning</title><p id="P47">We have shown that UnitMatch can be used to track units across days, and this can be validated by stable functional scores. An important application of this algorithm is to track units as their functional responses evolve over time, particularly as a result of learning. To illustrate its potential, we applied UnitMatch to an exploratory dataset captured during a learning process.</p><p id="P48">We trained a mouse (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>) in a visuomotor operant task and recorded neural activity in the dorsomedial striatum using a chronically implanted Neuropixels probe. After implantation, the mouse was water-restricted and head-fixed in front of three screens with its forelimbs resting on a steering wheel. When the stimulus appeared on the left screen, moving the wheel clockwise moved the stimulus to the center, resulting in a sucrose water reward (<xref ref-type="fig" rid="F5">Figure 5A</xref>). After each training day, we recorded passive responses to the presentation of the center stimulus. The mouse learned to correctly move the wheel over a two-day training period (<xref ref-type="fig" rid="F5">Figure 5B</xref>).</p><p id="P49">We analyzed data recorded during passive viewing of the same set of stimuli on day 0 (pre-training), day 1 (after the first training session), and day 2 (after the second training session). Without tracking neurons, it is possible to demonstrate that responses to the target stimulus increase over learning (<xref ref-type="fig" rid="F5">Figure 5C</xref>). However, using the UnitMatch pipeline as described here, we were able to track individual units over multiple recording days (example units in <xref ref-type="fig" rid="F5">Figure 5D</xref>). We found that responses of individual units to the target stimulus were highly variable. For example, some units (e.g., units 1 and 2) would not respond to the target stimulus prior to training, but developed a visual response with learning, either gradually (unit 1), or abruptly (unit 2). Conversely, other units (e.g., unit 3) initially had a strong visual response to the target, which decreased with learning.</p><p id="P50">This proof of concept shows that UnitMatch is a promising tool to reveal invariance or plasticity in neural activity across days.</p></sec></sec><sec id="S12" sec-type="discussion"><title>Discussion</title><p id="P51">We have shown that UnitMatch can track populations of neurons across days in data obtained with high-density arrays such as Neuropixels probes. UnitMatch is highly scalable because it operates after spike sorting, and because it makes few assumptions: it uses only the average spike waveform of each unit, without knowledge of its spike train. Additionally, rather than giving a binary output, UnitMatch provides a matching probability. Our tests with Neuropixels recordings from various mouse brain regions indicate that it successfully tracks neurons across weeks, and that it compares favorably to manual curation and to spike sorting on concatenated sessions.</p><p id="P52">UnitMatch revealed that distinctive functional properties of each neuron – autocorrelation, responses to visual stimuli, and population coupling – remain remarkably stable over days. Because these properties are highly distinctive across neurons, their stability is not only of interest by itself, but also indicates that UnitMatch indeed finds the same neurons across days. The population coupling fingerprint, especially, was highly accurate and could be used across various brain areas, without the need of any external stimuli. Using these functional metrics, we showed that UnitMatch performed better than spike sorting on concatenated recordings on long time scales.</p><p id="P53">Since functional properties of neurons are so stable over time, it is tempting to use functional properties themselves to track neurons. However, this would prevent any evaluation of the variation in functional properties across time, and such a variation has been documented<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>. For example, the slow decrease in AUC values that we observed across days could be explained either by a decrease in the quality of matching, or changes in functional properties of the units. Therefore, unless there is reason to believe that the functional properties are constant<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>, it is prudent to exclude these properties from the criteria that determine the tracking of units, and only consider them as a possible validation<sup><xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup> or as a separate question<sup><xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R21">21</xref>,<xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R31">31</xref>,<xref ref-type="bibr" rid="R32">32</xref></sup>. UnitMatch operates exclusively on the units’ waveforms and thus avoids circularity when addressing such questions. To illustrate this, we also tracked units that changed their functional responses over learning.</p><p id="P54">Though UnitMatch could track the same units over months, the number of units that were tracked declined with time. This decline could derive from numerous sources independent of the algorithm, such as a decline in recording quality, accumulation of uncorrected drift across recordings, neurons becoming silent or dying, or changes in waveform properties. Indeed, tracking of units was more stable when recordings were more stable, suggesting recording quality and drift are partially responsible (<xref ref-type="supplementary-material" rid="SD1">Figure S5</xref>). Ideally, further work will reveal the contribution of each of these factors to the quality of the tracking.</p><p id="P55">Taken together, these findings show that chronic high-density recordings and UnitMatch combined are a powerful tool to characterize neural activity spanning a multitude of brain regions and time scales, such as memory, learning, and aging.</p></sec><sec id="S13"><title>Experimental methods</title><p id="P56">Experimental procedures were conducted at UCL according to the UK Animals Scientific Procedures Act (1986) and under personal and project licenses released by the Home Office following appropriate ethics review.</p><sec id="S14"><title>Mice</title><p id="P57">We analyzed the data from 18 chronically implanted mice. During the experiments, mice were typically head fixed and exposed to sensory stimuli, engaged in a task, or resting. The mice were recorded from different experimental rigs, implanted, and recorded by different experimenters using different devices (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>).</p></sec><sec id="S15"><title>Surgeries and implants</title><sec id="S16"><title>Headplate surgery</title><p id="P58">A brief (around 1 h) initial surgery was performed under isoflurane (1–3% in O<sub>2</sub>) anesthesia to implant either a titanium headplate (∼ 25 × 3 × 0.5 mm, 0.2 g in the case of the Apollo implant) or a steel headplate (∼ 25 × 5 × 1 mm, xx g in the case of the Ultralight and Cemented implants). In brief, the dorsal surface of the skull was cleared of skin and periosteum. A thin layer of cyanoacrylate was applied to the skull and allowed to dry. Thin layers of UV-curing optical glue (Norland Optical Adhesives #81, Norland Products) were applied and cured until the exposed skull was covered. The head plate was attached to the skull over the interparietal bone with Super-Bond polymer. In one mouse (ID 2/19), a silver wire was implanted in the mouse’s skull in order to ground the mouse during recordings. After recovery, mice were treated with carprofen or meloxicam for three days, then acclimated to handling and head-fixation. Mice were then implanted with either a modular recoverable<sup><xref ref-type="bibr" rid="R38">38</xref></sup>, Ultralight or cemented implant (see below). Briefly, craniotomies were performed on the day of the implantation, under isoflurane (1–3% in O2) anesthesia, and after injection of Colvasone and Rimadyl. The UV glue was removed, and the skull cleaned and scarred for best adhesion of the cement. The skull was levelled, before opening the craniotomies using a drill or a biopsy punch. Once exposed, the brain was then covered with Dura-Gel (Cambridge Neurotech).</p></sec><sec id="S17"><title>Cemented implant</title><p id="P59">The data from four animals was already published<sup><xref ref-type="bibr" rid="R30">30</xref></sup>. In short, these four animals were implanted by holding and inserting the probes using a cemented dovetail and applying dental cement to encase the probe PCB and reliably attach it to the skull. The recordings were made in external reference mode, using the Ag wire or the headplate as the reference signal.</p></sec><sec id="S18"><title>Recoverable modular implants</title><p id="P60">Three different recoverable, modular implants were used. The methods for the Apollo implant<sup><xref ref-type="bibr" rid="R38">38</xref></sup> and the ‘Haesler’ implant<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R37">37</xref></sup> have been described in their respective papers. The third implant (‘Isogai’ implant) is conceptually similar. In short, the implant was held using the 3D-printed payload holder and positioned using a micromanipulator (Sensapex). After carefully positioning of the shanks at the surface of the brain, avoiding blood vessels, probes were inserted at slow speed (3-5 µm/s). Prior to surgery, the probes were coated with DiI by either manually brushing each probe with a droplet of DiI or dipping them in directly in DiI, for histological reconstruction. Once the desired depth was reached (optimally just before the docking module touched the skull), the implant was sealed using UV glue, then covered with Super-Bond polymer, ensuring that only the docking module was cemented. After finishing all recording sessions, the probes were explanted and cleaned before reusing. The recordings were made in external or internal reference mode, using the headplate as the reference signal.</p></sec><sec id="S19"><title>Ultralight implant</title><p id="P61">To record chronically while a mouse (ID 19) learned a task and up to 3 probes simultaneously, we developed an ultralight implant (<ext-link ext-link-type="uri" xlink:href="https://github.com/Julie-Fabre/ultralight_implant">https://github.com/Julie-Fabre/ultralight_implant</ext-link>). Briefly, an implant was constructed using between 1 to 3 Neuropixels probes encased in rigid-resin K custom-made 3D printed parts. A thin square of sorbuthane sheet was added to the front of the implant. Special care was taken to ensure all shanks were parallel to each other and to the implant. This implant was then slowly lowered into the brain. At the target depth, the implant base was covered in vaseline to protect the shanks from subsequent cement applications. We then applied cement to the implant and mouse skull. To explant, we carefully drilled the implant out in the areas where Vaseline had been applied.</p></sec></sec><sec id="S20"><title>Data processing</title><p id="P62">Electrophysiology data were acquired using SpikeGLX (<ext-link ext-link-type="uri" xlink:href="https://billkarsh.github.io/SpikeGLX/">https://billkarsh.github.io/SpikeGLX/</ext-link>) and each session was spike sorted with Kilosort<sup><xref ref-type="bibr" rid="R40">40</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>). Data were preprocessed using ‘<italic>ExtractKilosortData.m’</italic>, meaning that all relevant information was extracted (e.g., positions of recording sites, information on extracted clusters and their spike times) and common noise was removed. Well-isolated units were selected using Bombcell (<ext-link ext-link-type="uri" xlink:href="https://github.com/Julie-Fabre/bombcell">https://github.com/Julie-Fabre/bombcell</ext-link>, using parameters defined in bc_qualityParamValuesForUnitMatch.m). For each session the average waveform on every recording site for each unit was extracted, either through Bombcell or through Unitmatch’s <italic>‘ExtractAndSaveAverageWaveforms.m’</italic>.</p><p id="P63">Input to the core of UnitMatch, which is matching units purely based on waveforms, was information on the clusters, at least 1) cluster identity, 2) a Boolean on which clusters to include – typically well isolated units, 3) which recording session it was recorded in, and 4) on which probe it was recorded. Additionally, it requires parameters (we used default parameters available using <italic>‘DefaultParametersUnitMatch.m’</italic>), containing information on where to find the raw waveforms.</p><p id="P64">Example analysis pipelines from raw electrophysiology recorded using SpikeGLX all the way to using and validating UnitMatch are provided in the UnitMatch repository. A minimal use case scenario is also pro-vided in <italic>‘DEMO_UNITMATCH.m’</italic>, which is also useful for electrophysiological data recorded and prepro-cessed using other probes and software.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Information</label><media xlink:href="EMS189721-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d21aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S21"><title>Acknowledgments</title><p>We thank Magdalena Robacha for help with experiments and histology, Bex Terry for animal husbandry, and Charu Bai Reddy for lab management. This work was funded by Wellcome Trust (Investigator Award 223144 to MC and KDH), Biotechnology and Biological Sciences Research Council (Grant BB/T016639/1 to MC and PC), European Council (Marie Skłodowska fellowship 101022757 to EvB), and European Molecular Biology Organization (ALTF 740-2019 to CB). MC holds the GlaxoSmithKline / Fight for Sight Chair in Visual Neuroscience.</p></ack><sec id="S22" sec-type="data-availability"><title>Code availability</title><p id="P65">UnitMatch software is published via Zenodo (DOI: 10.5281/zenodo.8435312) and available via GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/EnnyvanBeest/UnitMatch/tree/v1.0.0_UnitMatch">https://github.com/EnnyvanBeest/UnitMatch/tree/v1.0.0_UnitMatch</ext-link>).</p></sec><fn-group><fn fn-type="con" id="FN1"><p id="P66"><bold>CRediT contributions</bold>
<table-wrap id="T1" orientation="portrait" position="anchor"><table frame="box" rules="rows"><thead><tr><th valign="top" align="left"/><th valign="top" align="left">Bimbard</th><th valign="top" align="left">Carandini</th><th valign="top" align="left">Coen</th><th valign="top" align="left">Fabre</th><th valign="top" align="left">Harris</th><th valign="top" align="left">Lebedeva</th><th valign="top" align="left">Takacs</th><th valign="top" align="left">van Beest</th></tr></thead><tbody><tr><td valign="top" align="center">Conceptual-ization</td><td valign="top" align="center">•</td><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Methodology</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center">•</td><td valign="top" align="center"/><td valign="top" align="center"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Software</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Formal Analysis</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Investigation</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Resources</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Data Curation</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Writing -- Original Draft</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Writing -- Re-view &amp; Editing</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left">•</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left">•</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Visualization</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr><tr><td valign="top" align="left">Supervision</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="left"/></tr><tr><td valign="top" align="left">Funding Acquisition</td><td valign="top" align="center">•</td><td valign="top" align="center">•</td><td valign="top" align="left">•</td><td valign="top" align="left"/><td valign="top" align="center">•</td><td valign="top" align="left"/><td valign="top" align="left"/><td valign="top" align="center">•</td></tr></tbody></table></table-wrap>
</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziv</surname><given-names>Y</given-names></name><name><surname>Burns</surname><given-names>LD</given-names></name><name><surname>Cocker</surname><given-names>ED</given-names></name><name><surname>Hamel</surname><given-names>EO</given-names></name><name><surname>Ghosh</surname><given-names>KK</given-names></name><name><surname>Kitch</surname><given-names>LJ</given-names></name><name><surname>El</surname><given-names>A</given-names></name><name><surname>Schnitzer</surname><given-names>MJ</given-names></name></person-group><article-title>Long-term dynamics of CA1 hippocampal place codes</article-title><source>Nat Neurosci</source><year>2013</year><volume>16</volume><fpage>264</fpage><lpage>266</lpage><pub-id pub-id-type="pmcid">PMC3784308</pub-id><pub-id pub-id-type="pmid">23396101</pub-id><pub-id pub-id-type="doi">10.1038/nn.3329</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname><given-names>AJ</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Hedrick</surname><given-names>NG</given-names></name><name><surname>O’neil</surname><given-names>K</given-names></name><name><surname>Komiyama</surname><given-names>T</given-names></name></person-group><article-title>Reorganization of corticospinal output during motor learning</article-title><source>Nat Neurosci</source><year>2017</year><volume>20</volume><fpage>1133</fpage><lpage>1141</lpage><pub-id pub-id-type="pmcid">PMC5656286</pub-id><pub-id pub-id-type="pmid">28671694</pub-id><pub-id pub-id-type="doi">10.1038/nn.4596</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JJ</given-names></name><name><surname>Krumin</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name></person-group><article-title>Task specificity in mouse parietal cortex</article-title><source>Neuron</source><year>2022</year><volume>110</volume><fpage>2961</fpage><lpage>2969</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="pmcid">PMC9616730</pub-id><pub-id pub-id-type="pmid">35963238</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2022.07.017</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deitch</surname><given-names>D</given-names></name><name><surname>Rubin</surname><given-names>A</given-names></name><name><surname>Ziv</surname><given-names>Y</given-names></name></person-group><article-title>Representational drift in the mouse visual cortex</article-title><source>Current Biology</source><year>2021</year><volume>31</volume><fpage>4327</fpage><lpage>4339</lpage><elocation-id>e6</elocation-id><pub-id pub-id-type="pmid">34433077</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marks</surname><given-names>TD</given-names></name><name><surname>Goard</surname><given-names>MJ</given-names></name></person-group><article-title>Stimulus-dependent representational drift in primary visual cortex</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="pmcid">PMC8397766</pub-id><pub-id pub-id-type="pmid">34453051</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-25436-3</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>RU</given-names></name><name><surname>Kubie</surname><given-names>JL</given-names></name><name><surname>Ranck</surname><given-names>JB</given-names></name></person-group><article-title>Spatial firing patterns of hippocampal complex-spike cells in a fixed environment</article-title><source>Journal of Neuroscience</source><year>1987</year><volume>7</volume><fpage>1935</fpage><lpage>1950</lpage><pub-id pub-id-type="pmcid">PMC6568929</pub-id><pub-id pub-id-type="pmid">3612225</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.07-07-01935.1987</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>LT</given-names></name><name><surname>Best</surname><given-names>PJ</given-names></name></person-group><article-title>Long-term stability of the place-field activity of single units recorded from the dorsal hippocampus of freely behaving rats</article-title><source>Brain Res</source><year>1990</year><volume>509</volume><fpage>299</fpage><lpage>308</lpage><pub-id pub-id-type="pmid">2322825</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>JC</given-names></name><name><surname>Rennaker</surname><given-names>RL</given-names></name><name><surname>Kipke</surname><given-names>DR</given-names></name></person-group><article-title>Stability of chronic multichannel neural recordings: Implications for a long-term neural interface</article-title><source>Neurocomputing</source><year>1999</year><volume>26–27</volume><fpage>1069</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1016/S0925-2312(99)00106-X</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>DM</given-names></name><name><surname>Tillery</surname><given-names>SIH</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><article-title>Direct cortical control of 3D neuroprosthetic devices</article-title><source>Science</source><year>2002</year><volume>296</volume><fpage>1829</fpage><lpage>1832</lpage><comment>(1979)</comment><pub-id pub-id-type="pmid">12052948</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickey</surname><given-names>AS</given-names></name><name><surname>Suminski</surname><given-names>A</given-names></name><name><surname>Amit</surname><given-names>Y</given-names></name><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name></person-group><article-title>Single-unit stability using chronically implanted multielectrode arrays</article-title><source>J Neurophysiol</source><year>2009</year><volume>102</volume><fpage>1331</fpage><lpage>1339</lpage><pub-id pub-id-type="pmcid">PMC2724357</pub-id><pub-id pub-id-type="pmid">19535480</pub-id><pub-id pub-id-type="doi">10.1152/jn.90920.2008</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname><given-names>GW</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name></person-group><article-title>Recording from the same neurons chronically in motor cortex</article-title><source>J Neurophysiol</source><year>2012</year><volume>107</volume><fpage>1970</fpage><lpage>1978</lpage><pub-id pub-id-type="pmcid">PMC3331662</pub-id><pub-id pub-id-type="pmid">22190623</pub-id><pub-id pub-id-type="doi">10.1152/jn.01012.2010</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Eleryan</surname><given-names>A</given-names></name><name><surname>Vaidya</surname><given-names>M</given-names></name><name><surname>Southerland</surname><given-names>J</given-names></name><name><surname>Badreldin</surname><given-names>I</given-names></name><name><surname>Balasubramanian</surname><given-names>K</given-names></name><name><surname>Fagg</surname><given-names>A</given-names></name><name><surname>Hatsopoulos</surname><given-names>N</given-names></name><name><surname>Oweiss</surname><given-names>K</given-names></name></person-group><source>Tracking chronically recorded single-units in cortically controlled brain machine interfaces</source><conf-name>International IEEE/EMBS Conference on Neural Engineering, NER</conf-name><year>2013</year><fpage>427</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1109/NER.2013.6695963</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eleryan</surname><given-names>A</given-names></name><name><surname>Vaidya</surname><given-names>M</given-names></name><name><surname>Southerland</surname><given-names>J</given-names></name><name><surname>Badreldin</surname><given-names>IS</given-names></name><name><surname>Balasubramanian</surname><given-names>K</given-names></name><name><surname>Fagg</surname><given-names>AH</given-names></name><name><surname>Hatsopoulos</surname><given-names>N</given-names></name><name><surname>Oweiss</surname><given-names>K</given-names></name></person-group><article-title>Tracking single units in chronic, large scale, neural recordings for brain machine interface applications</article-title><source>Front Neuroeng</source><year>2014</year><volume>7</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC4086297</pub-id><pub-id pub-id-type="pmid">25071546</pub-id><pub-id pub-id-type="doi">10.3389/fneng.2014.00023</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>FAW</given-names></name><name><surname>Ma</surname><given-names>YY</given-names></name><name><surname>Greenberg</surname><given-names>PA</given-names></name><name><surname>Ryou</surname><given-names>JW</given-names></name><name><surname>Kim</surname><given-names>BH</given-names></name></person-group><article-title>A micro-electrode drive for long term recording of neurons in freely moving and chaired monkeys</article-title><source>J Neurosci Methods</source><year>2003</year><volume>127</volume><fpage>49</fpage><lpage>61</lpage><pub-id pub-id-type="pmid">12865148</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmitzer-Torbert</surname><given-names>N</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name></person-group><article-title>Neuronal Activity in the Rodent Dorsal Striatum in Sequential Navigation: Separation of Spatial and Reward Responses on the Multiple T Task</article-title><source>J Neurophysiol</source><year>2004</year><volume>91</volume><fpage>2259</fpage><lpage>2272</lpage><pub-id pub-id-type="pmid">14736863</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenberg</surname><given-names>PA</given-names></name><name><surname>Wilson</surname><given-names>FAW</given-names></name></person-group><article-title>Functional stability of dorsolateral prefrontal neurons</article-title><source>J Neurophysiol</source><year>2004</year><volume>92</volume><fpage>1042</fpage><lpage>1055</lpage><pub-id pub-id-type="pmid">15084637</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>McCreery</surname><given-names>DB</given-names></name><name><surname>Bullara</surname><given-names>LA</given-names></name><name><surname>Agnew</surname><given-names>WF</given-names></name></person-group><article-title>Evaluation of the stability of intracortical microelectrode arrays</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><year>2006</year><volume>14</volume><fpage>91</fpage><lpage>100</lpage><pub-id pub-id-type="pmid">16562636</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Linderman</surname><given-names>MD</given-names></name><name><surname>Gilja</surname><given-names>V</given-names></name><name><surname>Afshar</surname><given-names>A</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Meng</surname><given-names>TH</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><article-title>HermesB: A continuous neural recording system for freely behaving primates</article-title><source>IEEE Trans Biomed Eng</source><year>2007</year><volume>54</volume><fpage>2037</fpage><lpage>2050</lpage><pub-id pub-id-type="pmid">18018699</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tolias</surname><given-names>AS</given-names></name><name><surname>Ecker</surname><given-names>AS</given-names></name><name><surname>Siapas</surname><given-names>AG</given-names></name><name><surname>Hoenselaar</surname><given-names>A</given-names></name><name><surname>Keliris</surname><given-names>GA</given-names></name><name><surname>Logothetis</surname><given-names>NK</given-names></name></person-group><article-title>Recording chronically from the same neurons in awake, behaving primates</article-title><source>J Neurophysiol</source><year>2007</year><volume>98</volume><fpage>3780</fpage><lpage>3790</lpage><pub-id pub-id-type="pmid">17942615</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schoonover</surname><given-names>CE</given-names></name><name><surname>Ohashi</surname><given-names>SN</given-names></name><name><surname>Axel</surname><given-names>R</given-names></name><name><surname>Fink</surname><given-names>AJP</given-names></name></person-group><article-title>Representational drift in primary olfactory cortex</article-title><source>Nature</source><year>2021</year><volume>594</volume><fpage>541</fpage><lpage>546</lpage><pub-id pub-id-type="pmid">34108681</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lever</surname><given-names>C</given-names></name><name><surname>Wills</surname><given-names>T</given-names></name><name><surname>Cacucci</surname><given-names>F</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>Keefe</surname><given-names>JO</given-names></name></person-group><article-title>Long-term plasticity in hippocampal place-cell representation of environmental geometry</article-title><source>Nature</source><year>2002</year><volume>416</volume><fpage>236</fpage><lpage>238</lpage><pub-id pub-id-type="pmid">11882899</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muzzio</surname><given-names>IA</given-names></name><name><surname>Levita</surname><given-names>L</given-names></name><name><surname>Kulkarni</surname><given-names>J</given-names></name><name><surname>Monaco</surname><given-names>J</given-names></name><name><surname>Kentros</surname><given-names>C</given-names></name><name><surname>Stead</surname><given-names>M</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Kandel</surname><given-names>ER</given-names></name></person-group><article-title>Attention enhances the retrieval and stability of visuospatial and olfactory representations in the dorsal hippocampus</article-title><source>PLoS Biol</source><year>2009</year><volume>7</volume><pub-id pub-id-type="pmcid">PMC2696347</pub-id><pub-id pub-id-type="pmid">19564903</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000140</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhawale</surname><given-names>AK</given-names></name><name><surname>Poddar</surname><given-names>R</given-names></name><name><surname>Wolff</surname><given-names>SBE</given-names></name><name><surname>Normand</surname><given-names>VA</given-names></name><name><surname>Kopelowitz</surname><given-names>E</given-names></name><name><surname>Ölveczky</surname><given-names>BP</given-names></name></person-group><article-title>Automated long-Term recording and analysis of neural activity in behaving animals</article-title><source>Elife</source><year>2017</year><volume>6</volume><fpage>1</fpage><lpage>40</lpage><pub-id pub-id-type="pmcid">PMC5619984</pub-id><pub-id pub-id-type="pmid">28885141</pub-id><pub-id pub-id-type="doi">10.7554/eLife.27702</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>KT</given-names></name><name><surname>Harpaz</surname><given-names>NK</given-names></name><name><surname>Dhawale</surname><given-names>AK</given-names></name><name><surname>Wolff</surname><given-names>SBE</given-names></name><name><surname>Ölveczky</surname><given-names>BP</given-names></name></person-group><article-title>Long-term stability of single neuron activity in the motor system</article-title><year>2022</year><volume>25</volume><pub-id pub-id-type="pmid">36357811</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akritas</surname><given-names>M</given-names></name><name><surname>Armstrong</surname><given-names>AG</given-names></name><name><surname>Lebert</surname><given-names>JM</given-names></name><name><surname>Meyer</surname><given-names>AF</given-names></name><name><surname>Linden</surname><given-names>JF</given-names></name></person-group><article-title>Contextual modulation is a stable feature of the neural code in auditory cortex of awake mice</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1101/2023.04.22.537782</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emondi</surname><given-names>AA</given-names></name><name><surname>Rebrik</surname><given-names>SP</given-names></name><name><surname>Kurgansky</surname><given-names>AV</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name></person-group><article-title>Tracking neurons recorded from tetrodes across time</article-title><source>J Neurosci Methods</source><year>2004</year><volume>135</volume><fpage>95</fpage><lpage>105</lpage><pub-id pub-id-type="pmid">15020094</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMahon</surname><given-names>DBT</given-names></name><name><surname>Bondar</surname><given-names>IV</given-names></name><name><surname>Afuwape</surname><given-names>OAT</given-names></name><name><surname>Ide</surname><given-names>DC</given-names></name><name><surname>Leopold</surname><given-names>DA</given-names></name></person-group><article-title>One month in the life of a neuron: Longitudinal single-unit electrophysiology in the monkey visual system</article-title><source>J Neurophysiol</source><year>2014</year><volume>112</volume><fpage>1748</fpage><lpage>1762</lpage><pub-id pub-id-type="pmcid">PMC4157170</pub-id><pub-id pub-id-type="pmid">24966298</pub-id><pub-id pub-id-type="doi">10.1152/jn.00052.2014</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bondar</surname><given-names>IV</given-names></name><name><surname>Leopold</surname><given-names>DA</given-names></name><name><surname>Richmond</surname><given-names>BJ</given-names></name><name><surname>Victor</surname><given-names>JD</given-names></name><name><surname>Logothetis</surname><given-names>NK</given-names></name></person-group><article-title>Long-term stability of visual pattern selective responses of monkey temporal lobe neurons</article-title><source>PLoS One</source><year>2009</year><volume>4</volume><pub-id pub-id-type="pmcid">PMC2784294</pub-id><pub-id pub-id-type="pmid">20011035</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0008222</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Lak</surname><given-names>A</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><article-title>Long term recordings with immobile silicon probes in the mouse cortex</article-title><source>PLoS One</source><year>2016</year><volume>11</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC4784879</pub-id><pub-id pub-id-type="pmid">26959638</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0151180</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Aydin</surname><given-names>C</given-names></name><name><surname>Lebedeva</surname><given-names>A</given-names></name><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Bauza</surname><given-names>M</given-names></name><name><surname>Beau</surname><given-names>M</given-names></name><name><surname>Bhagat</surname><given-names>J</given-names></name><name><surname>Böhm</surname><given-names>C</given-names></name><name><surname>Broux</surname><given-names>M</given-names></name><etal/></person-group><article-title>Neuropixels 2.0: A miniaturized high-density probe for stable, long-term brain recordings</article-title><source>Science</source><year>2021</year><volume>372</volume><comment>(1979)</comment><pub-id pub-id-type="pmcid">PMC8244810</pub-id><pub-id pub-id-type="pmid">33859006</pub-id><pub-id pub-id-type="doi">10.1126/science.abf4588</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMahon</surname><given-names>DBT</given-names></name><name><surname>Jones</surname><given-names>AP</given-names></name><name><surname>Bondar</surname><given-names>IV</given-names></name><name><surname>Leopold</surname><given-names>DA</given-names></name></person-group><article-title>Face-selective neurons maintain consistent visual responses across months</article-title><source>Proc Natl Acad Sci U S A</source><year>2014</year><volume>111</volume><fpage>8251</fpage><lpage>8256</lpage><pub-id pub-id-type="pmcid">PMC4050553</pub-id><pub-id pub-id-type="pmid">24799679</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1318331111</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kentros</surname><given-names>C</given-names></name><name><surname>Hargreaves</surname><given-names>E</given-names></name><name><surname>Hawkins</surname><given-names>RD</given-names></name><name><surname>Kandel</surname><given-names>ER</given-names></name><name><surname>Shapiro</surname><given-names>M</given-names></name><name><surname>Muller</surname><given-names>RV</given-names></name></person-group><article-title>Abolition of long-term stability of new hippocampal place cell maps by NMDA receptor blockade</article-title><source>Science</source><year>1998</year><volume>280</volume><fpage>2121</fpage><lpage>2126</lpage><comment>(1979)</comment><pub-id pub-id-type="pmid">9641919</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cacucci</surname><given-names>F</given-names></name><name><surname>Wills</surname><given-names>TJ</given-names></name><name><surname>Lever</surname><given-names>C</given-names></name><name><surname>Giese</surname><given-names>KP</given-names></name><name><surname>O’Keefe</surname><given-names>J</given-names></name></person-group><article-title>Experience-dependent increase in CA1 place cell spatial information, but not spatial reproducibility, is dependent on the autophosphorylation of the α-isoform of the calcium/calmodulin-dependent protein kinase II</article-title><source>Journal of Neuroscience</source><year>2007</year><volume>27</volume><fpage>7854</fpage><lpage>7859</lpage><pub-id pub-id-type="pmcid">PMC2680063</pub-id><pub-id pub-id-type="pmid">17634379</pub-id><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1704-07.2007</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname><given-names>JJ</given-names></name><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Siegle</surname><given-names>JH</given-names></name><name><surname>Denman</surname><given-names>DJ</given-names></name><name><surname>Bauza</surname><given-names>M</given-names></name><name><surname>Barbarits</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><name><surname>Anastassiou</surname><given-names>CA</given-names></name><name><surname>Andrei</surname><given-names>A</given-names></name><name><surname>Aydin</surname><given-names>Ç</given-names></name><etal/></person-group><article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title><source>Nature</source><year>2017</year><volume>551</volume><fpage>232</fpage><lpage>236</lpage><pub-id pub-id-type="pmcid">PMC5955206</pub-id><pub-id pub-id-type="pmid">29120427</pub-id><pub-id pub-id-type="doi">10.1038/nature24636</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Juavinett</surname><given-names>AL</given-names></name><name><surname>Bekheet</surname><given-names>G</given-names></name><name><surname>Churchland</surname><given-names>AK</given-names></name></person-group><article-title>Chronically implanted neuropixels probes enable high-yield recordings in freely moving mice</article-title><source>Elife</source><year>2019</year><volume>8</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="pmcid">PMC6707768</pub-id><pub-id pub-id-type="pmid">31411559</pub-id><pub-id pub-id-type="doi">10.7554/eLife.47188</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>TZ</given-names></name><name><surname>Bondy</surname><given-names>AG</given-names></name><name><surname>Gupta</surname><given-names>D</given-names></name><name><surname>Elliott</surname><given-names>VA</given-names></name><name><surname>Kopec</surname><given-names>CD</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><article-title>An approach for long-term, multi-probe neuropixels recordings in unrestrained rats</article-title><source>Elife</source><year>2020</year><volume>9</volume><fpage>1</fpage><lpage>54</lpage><pub-id pub-id-type="pmcid">PMC7721443</pub-id><pub-id pub-id-type="pmid">33089778</pub-id><pub-id pub-id-type="doi">10.7554/eLife.59716</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Daal</surname><given-names>RJJ</given-names></name><name><surname>Aydin</surname><given-names>Ç</given-names></name><name><surname>Michon</surname><given-names>F</given-names></name><name><surname>Aarts</surname><given-names>AAA</given-names></name><name><surname>Kraft</surname><given-names>M</given-names></name><name><surname>Kloosterman</surname><given-names>F</given-names></name><name><surname>Haesler</surname><given-names>S</given-names></name></person-group><article-title>Implantation of Neuropixels probes for chronic recording of neuronal activity in freely behaving mice and rats</article-title><source>Nat Protoc</source><year>2021</year><volume>16</volume><fpage>3322</fpage><lpage>3347</lpage><pub-id pub-id-type="pmid">34108732</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bimbard</surname><given-names>C</given-names></name><name><surname>Takacs</surname><given-names>F</given-names></name><name><surname>Fabre</surname><given-names>JMJ</given-names></name><name><surname>Melin</surname><given-names>MD</given-names></name><name><surname>O’Neill</surname><given-names>N</given-names></name><name><surname>Robacha</surname><given-names>M</given-names></name><name><surname>Street</surname><given-names>JS</given-names></name><name><surname>van Beest</surname><given-names>EH</given-names></name><name><surname>Churchland</surname><given-names>AK</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name><etal/></person-group><article-title>Reusable, flexible, and lightweight chronic implants for Neuropixels probes</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.08.03.551752</elocation-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boussard</surname><given-names>J</given-names></name><name><surname>Windolf</surname><given-names>C</given-names></name><name><surname>Hurwitz</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>HD</given-names></name><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Winter</surname><given-names>O</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><article-title>DARTsort: A modular drift tracking spike sorter for high-density multi-electrode probes</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="doi">10.1101/2023.08.11.553023</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>N</given-names></name><name><surname>Kadir</surname><given-names>S</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><article-title>Ki-losort: realtime spike-sorting for extracellular electrophysiology with hundreds of channels</article-title><source>bioRxiv</source><year>2016</year><elocation-id>061481</elocation-id><pub-id pub-id-type="doi">10.1101/061481</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabre</surname><given-names>JMJ</given-names></name><name><surname>van Beest</surname><given-names>EH</given-names></name><name><surname>Peters</surname><given-names>AJ</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><article-title>Bombcell: automated curation and cell classification of spike-sorted electrophysiology data (1.0.0</article-title><source>Zenodo</source><year>2023</year></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>IC</given-names></name><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><article-title>The Nature of Shared Cortical Variability</article-title><source>Neuron</source><year>2015</year><volume>87</volume><fpage>644</fpage><lpage>656</lpage><pub-id pub-id-type="pmcid">PMC4534383</pub-id><pub-id pub-id-type="pmid">26212710</pub-id><pub-id pub-id-type="doi">10.1016/j.neuron.2015.06.035</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Okun</surname><given-names>M</given-names></name><name><surname>Steinmetz</surname><given-names>NA</given-names></name><name><surname>Cossell</surname><given-names>L</given-names></name><name><surname>Iacaruso</surname><given-names>MF</given-names></name><name><surname>Ko</surname><given-names>H</given-names></name><name><surname>Barthó</surname><given-names>P</given-names></name><name><surname>Moore</surname><given-names>T</given-names></name><name><surname>Hofer</surname><given-names>SB</given-names></name><name><surname>Mrsic-Flogel</surname><given-names>TD</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name><etal/></person-group><article-title>Diverse coupling of neurons to populations in sensory cortex</article-title><source>Nature</source><year>2015</year><volume>521</volume><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="pmcid">PMC4449271</pub-id><pub-id pub-id-type="pmid">25849776</pub-id><pub-id pub-id-type="doi">10.1038/nature14273</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>UnitMatch workflow.</title><p>UnitMatch is an algorithm to find matches across multiple recording sessions. It operates after spike sorting (step 0), and it comprises of 5 steps done in two iterations.</p></caption><graphic xlink:href="EMS189721-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Extracting spike waveform parameters.</title><p>(A) A 4-shank Neuropixels 2.0 probe (<italic>left</italic>), showing the bottom of one shank (<italic>right</italic>) and its recording sites (<italic>squares</italic>).</p><p>(B) Average spike waveform for an example unit, in the 24 recording sites marked in <italic>black</italic> in A and in 12 adjacent sites (<italic>gray</italic>).</p><p>(C) Amplitude of the waveform as a function of distance to ‘max site’ for the example unit. Using an exponential decay fit (<italic>curve</italic>), we defined the distance d<sub>10</sub> at which the amplitude drops to 10% of the maximum. <underline>Spatial decay</underline> is computed from the slope of the amplitude decrease over distance.</p><p>(D) Distribution of d<sub>10</sub> for all units in two example recordings, showing the median (<italic>dashed red line</italic>) and the 95% confidence interval (<italic>dashed black lines</italic>).</p><p>(E) Weighted-average waveform for the example unit in B, C, computed by giving larger weight to sites near the maximum site. The unit’s amplitude is taken from this waveform.</p><p>(F) <underline>Centroid trajectory</underline> of the example waveform from 0.2 ms before the peak (<italic>bottom</italic>) to 0.5 ms after the peak (<italic>top</italic>), showing the <underline>average centroid</underline> (<italic>circle</italic>). <underline>Travel direction and distance</underline> are calculated at each time point.</p></caption><graphic xlink:href="EMS189721-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Computing similarity scores and setting up the classifier.</title><p>(A) Average weighted waveform for the example unit in <xref ref-type="fig" rid="F2">Figure 2</xref> (<italic>black</italic>) and for a different unit (the nearest physical neighbor) from the same recording (<italic>blue</italic>).</p><p>(B) Centroid trajectories for the two units.</p><p>(C) The six similarity scores between the two units and their average, the total similarity score <italic>T</italic>.</p><p>(D-F) Same as (A-C), comparing the example unit (<italic>black</italic>) with the most similar unit across days (<italic>red</italic>), which was very likely the same neuron.</p><p>(G) Total similarity score for all pairs of units within days (<italic>blue squares</italic>) and across days (<italic>red squares</italic>), for an example pair of recordings, showing the 1<sup>st</sup> half of each recording (<italic>columns</italic>) vs. the second half (<italic>rows</italic>).</p><p>(H) <italic>Top</italic>: Distribution of total similarity scores in the two halves of a recording day, showing for the same units the two halves (<italic>green</italic>) and for other neighboring units (<italic>blue</italic>; centroid &lt;50 μm away). <italic>Bottom</italic>: same, for units measured across days (<italic>red</italic>) after drift correction. The threshold for putative matching (<italic>dashed line</italic>) depends on the number of units and of recordings.</p><p>(I) Probability densities of each similarity score, for putative matches (<italic>black</italic>) and for putative non-matches (<italic>gray</italic>).</p><p>(J) Match probability computed by the naïve Bayes classifier trained with the probability distributions in (I). Format as in G.</p><p>(K) <italic>Top</italic>: Distribution of match probabilities within two halves of the same day for same units (<italic>green</italic>) and neighbors (<italic>blue</italic>). Format as in H. <italic>Bottom</italic> same, for units recorded across days (<italic>red</italic>). If probability is &gt;0.5, UnitMatch defines a pair as a match.</p></caption><graphic xlink:href="EMS189721-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Validation with stable functional properties.</title><p>(A) Autocorrelogram (ACG) of an example a unit and one of its neighbors (<italic>top</italic>) or its match on the next day (<italic>bottom</italic>).</p><p>(B) Distribution of the ACGs correlation for pairs of waveforms coming from the same unit (<italic>green</italic>) or different units (<italic>blue</italic>) within days and matches across days (<italic>red</italic>). Data from two consecutive days in an example mouse.</p><p>(C) Receiver operating characteristic (ROC) curves when classifying the ACGs correlations of the same vs. different units within days (<italic>green</italic>) or matching versus non-matching units across days (<italic>red</italic>). Data from two consecutive days in an example mouse.</p><p>(D) Area under the curve (AUC) for many pairs of days, spaced by different amounts (<italic>red dots</italic>). The AUC of the same vs. different units within recordings is also shown (<italic>green</italic>). Stability was estimated with a linear fit (<italic>curve</italic>). The discriminability remained highly stable, even across months. Data from an example mouse.</p><p>(E) AUC for many pairs of days, across many mice and recording locations.</p><p>(F) Comparison of the responses to natural images for a unit and one of its neighbors (<italic>top</italic>) or its match on the next day (<italic>bottom</italic>). The responses to the images were summarized by averaging over all images to obtain the time course (<italic>left</italic>) or averaging over time to obtain the responses to individual images (<italic>right</italic>). These two profiles were then concatenated to form a single fingerprint, which was compared across units. Images were ordered by decreasing response of the black unit.</p><p>(G-J) Same as (B-E) but using the responses to natural images as a fingerprint.</p><p>(K) Correlation of the firing rate of a unit with other units forming a reference population that was tracked across days using UnitMatch. The correlation of a unit (<italic>black</italic>), one of its neighbors (<italic>top, blue</italic>) or its match on the next day (<italic>bottom, red</italic>) is shown. The neurons in the reference population were ordered by decreasing correlation with the unit from day 1 (<italic>black</italic>).</p><p>(L-O) Same as (B-E) but using the correlation with a reference population as a fingerprint.</p></caption><graphic xlink:href="EMS189721-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Tracking units across learning.</title><p>(A) Task trial structure.</p><p>(B) Fraction of correct trials as a function of training day (n=1 mouse).</p><p>(C) Average baseline (-0.2-0 s before stimulus onset) normalized firing rate (dR/R) aligned to stimulus onset during passive viewing, sorted by training day (left: day 0, middle: day 1, right: day 2) for average population. Red line indicates stimulus onset.</p><p>(D) Mean raw waveform for each training day for 3 example units (top: unit 1, middle: unit 2, and bottom: unit 3).</p><p>(E) Same as C) but for three example units tracked across days by UnitMatch.</p></caption><graphic xlink:href="EMS189721-f005"/></fig></floats-group></article>