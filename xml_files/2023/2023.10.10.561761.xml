<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS189531</article-id><article-id pub-id-type="doi">10.1101/2023.10.10.561761</article-id><article-id pub-id-type="archive">PPR739631</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Using Encrypted Genotypes and Phenotypes for Collaborative Genomic Analyses to Maintain Data Confidentiality</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Tianjing</given-names></name><xref ref-type="aff" rid="A1">*</xref><xref ref-type="aff" rid="A2">§</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Fangyi</given-names></name><xref ref-type="aff" rid="A2">§</xref></contrib><contrib contrib-type="author"><name><surname>Mott</surname><given-names>Richard</given-names></name><xref ref-type="aff" rid="A3">†</xref></contrib><contrib contrib-type="author"><name><surname>Dekkers</surname><given-names>Jack</given-names></name><xref ref-type="aff" rid="A4">‡</xref></contrib><contrib contrib-type="author"><name><surname>Cheng</surname><given-names>Hao</given-names></name><xref ref-type="aff" rid="A1">*</xref><xref ref-type="corresp" rid="CR1">1</xref></contrib></contrib-group><aff id="A1"><label>*</label>Department of Animal Science, University of California, Davis, CA, USA</aff><aff id="A2"><label>§</label>Integrative Genetics and Genomics Graduate Group, University of California, Davis, CA, USA</aff><aff id="A3"><label>†</label>Genetics Institute, University College London, UK</aff><aff id="A4"><label>‡</label>Department of Animal Science, Iowa State University, IA, USA</aff><author-notes><corresp id="CR1"><label>1</label>Department of Animal Science, University of California, Davis, CA, USA <email>qtlcheng@ucdavis.edu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>13</day><month>10</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>10</day><month>10</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">To adhere to and capitalize on the benefits of the FAIR (Findable, Accessible, Interoperable and Reusable) principles in agricultural genome-to-phenome studies, it is crucial to address privacy and intellectual property issues that prevent sharing and reuse of data in research and industry. Direct sharing of genotype and phenotype data is often prohibited due to intellectual property and privacy concerns. Thus there is a pressing need for encryption methods that obscure confidential aspects of the data, without affecting the outcomes of certain statistical analyses. A homomorphic encryption method for genotypes and phenotypes (HEGP) has been proposed for single-marker regression in genome-wide association studies using linear mixed models with Gaussian errors. This methodology permits frequentist likelihood-based parameter estimation and inference. In this paper, we extend HEGP to broader applications in genome-to-phenome analyses. We show that HEGP is suited to commonly used linear mixed models for genetic analyses of quantitative traits including GBLUP and RR-BLUP, as well as Bayesian variable selection methods (e.g., those in Bayesian Alphabet), for genetic parameter estimation, genomic prediction, and genome-wide association studies. By advancing the capabilities of HEGP, we offer researchers and industry professionals a secure and efficient approach for collaborative genomic analyses while preserving data confidentiality.</p></abstract><kwd-group><kwd>homomorphic encryption</kwd><kwd>mixed model</kwd><kwd>genomic prediction</kwd><kwd>GWAS</kwd><kwd>joint analysis</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Background</title><p id="P2">To conform to and capitalize on the benefits of the FAIR (Findable, Accessible, Interoperable and Reusable) principles in agricultural genome-to-phenome studies, it is necessary to address privacy and intellectual property issues that may prevent sharing and reuse of data in research and industry. First, sharing and reuse of genotypic and phenotypic data enables reproducible research, where researchers can confirm published analyses with minimal effort. Second, for traits that are hard or expensive to measure, a single research group may have limited data for genetic analysis, which may lead to less reliable and underpowered results. This problem may be alleviated by joint analyses that include data from multiple contributors.</p><p id="P3">Although data sharing and reuse will bring significant benefits to genome-to-phenome studies in both academia and industry, it is often prohibitive to directly share raw genotype and phenotype data due to privacy concerns, commercial interests, and data sharing policies, and because the risks of sharing raw data may not be fully understood by the data owners. For example, although individual identifiers can be anonymized, information about an anonymized individual might still be disclosed by comparing its genotypes to known genotyped relatives. To avoid the concerns about sharing raw data, consortia are often established, and raw data are only shared with members of the consortium or with researchers who are approved for access. In other cases, external researchers may perform analysis on the data owner’s computer system without access to the raw data. These approaches, however, still pose risks to privacy and intellectual property, hampering widespread data sharing and reuse.</p><p id="P4">Homomorphic encryption (HE) refers to a type of encryption of raw data (hereafter referred to as “plaintext”) in a manner that obscures confidential aspects of the data, while certain computations on the encrypted data (hereafter referred to as "cyphertext") match the results from the plaintext, when decrypted. While several methods for homomorphic encryption have been proposed for genomic analysis, most limit the types of computations and analyses that can be conducted on the encrypted data (cyphertext). For example, for case-control GWAS, HE schemes were proposed to calculate allelic chi-square test and perform logistic regression (<xref ref-type="bibr" rid="R23">Lu <italic>et al</italic>. 2015</xref>; <xref ref-type="bibr" rid="R5">Chen <italic>et al</italic>. 2018</xref>; <xref ref-type="bibr" rid="R33">Sim <italic>et al</italic>. 2020</xref>; <xref ref-type="bibr" rid="R2">Blatt <italic>et al</italic>. 2020</xref>). However, these methods ignore random and fixed effects that account for family and population admixture. Although linear mixed models are widely used in genetic analyses such as genomic prediction and GWAS (<xref ref-type="bibr" rid="R3">Bradbury <italic>et al</italic>. 2007</xref>), the use of HE for mixed models is scarce.</p><p id="P5">Recently, Mott et al. (<xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. 2020b</xref>) proposed an encryption method, called homomorphic encryption for genotypes and phenotypes (HEGP), that is specifically suited to single-marker regression in GWAS using linear mixed models with Gaussian errors. HEGP is based on high-dimensional random orthogonal transformations of the plaintext that encrypts phenotypes, genotypes, and specified covariates by replacing them with random linear superpositions, such that cyphertext genotypes and phenotypes cannot be linked back to individual identifiers. HEGP preserves linkage disequilibrium between markers but scrambles the genomic relationship between individuals. Moreover, under a linear mixed model with Gaussian errors, the likelihood of the cyphertext is unchanged, such that the encryption does not affect the outcomes of single-marker regression in GWAS analyses. HEGP differs conceptually from other HE methods in that some outputs (particularly the parameter estimates) are unaffected by encryption and do not need to be decrypted.</p><p id="P6">In this paper, we extend the HEGP scheme for wider application in genome-to-phenome analyses. We demonstrate that HEGP can be effectively applied to many popular mixed models, beyond single-marker regression. These models, including Bayesian variable selection methods such as those in Bayesian Alphabet, are routinely employed in the fields of animal and crop improvement, for genetic analyses of quantitative traits, including genetic parameter estimation, genomic prediction, and GWAS. We show how most of the quantitative genetics tool-box used by animal and plant breeders can be integrated with data-sharing protocols and performed while protecting important types of potentially confidential or commercially sensitive information.</p></sec><sec id="S2" sec-type="methods"><title>Methods</title><sec id="S3"><title>Homomorphic encryption using high-dimensional random or-thogonal matrix</title><p id="P7">We will use <bold>y</bold>, a vector of length <italic>n</italic>, to denote the plaintext phenotypes for <italic>n</italic> observations, and <bold>M</bold> to denote the <italic>n</italic> × <italic>p</italic> plaintext genotype covariate matrix for the <italic>n</italic> observations across <italic>p</italic> SNPs. To infer unknowns in mixed models, these quantities will typically be used in the multiplicative forms <bold>M</bold><sup><italic>T</italic></sup><bold>M</bold> and <bold>M</bold><sup><italic>T</italic></sup><bold>y</bold>. Thus, intuitively, any data encryption scheme that leaves the above multiplications unchanged would produce the same GWAS and genomic prediction outcomes.</p><p id="P8">HEGP uses a high-dimensional random <italic>n</italic> × <italic>n</italic> orthogonal matrix <bold>P</bold>, such that <bold>P</bold><sup><italic>T</italic></sup><bold>P</bold> = <bold>I</bold> and the determinant |<bold>P</bold>| = 1. The suitable choices of <bold>P</bold> for the purpose of encryption are discussed in a later section. The plaintext genotypes and phenotypes are encrypted as <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>y</mml:mi></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> because <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mrow><mml:mo>∗</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula> and <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula></p><p id="P9">In contrast to other methods of homomorphic encryption, the outputs of HEGP (i.e., marker effect estimates and p-values) are automatically plaintext, regardless of whether the inputs are plaintext or cyphertext. This means that there is no need to decrypt the outputs such as marker effect estimates and hence no decryption key is distributed. In a later section we will show that the HEGP does not affect the inference of marker effects, thus with the plaintext of genotypes, the estimated breeding values (EBV) can be calculated. Otherwise, the EBV calculated from the cybertext of genotypes remains cybertext EBV.</p><sec id="S4"><title>Conceptual overview</title><p id="P10"><xref ref-type="fig" rid="F1">Figure 1</xref> illustrates HEGP for a small example of 4 individuals (a-d) and 6 SNPs. By multiplying by the random orthogonal matrix <bold>P</bold>, phenotypes and genotypes in the encrypted data become ‘random’ linear combinations of phenotypes and genotypes of the original four individuals a-d.</p><p id="P11"><xref ref-type="fig" rid="F2">Figure 2</xref> compares plaintext and cyphertext genotypes from a larger pig data set (<xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. 2012</xref>). <xref ref-type="fig" rid="F2">Figure 2(a) and (b)</xref> present the heat maps of the plaintext and cyphertext genotypes. For the plaintext, each row represents an individual and each column represents the genotypes for a SNP across individuals. As shown in <xref ref-type="fig" rid="F2">Figure 2(c) and Figure 2(d)</xref>, after encryption, the genotypes transform from trimodal values (0/1/2) to continuous values that closely resemble a sample from a normal distribution.</p><p id="P12">The set of orthogonal <italic>n</italic> × <italic>n</italic> matrices forms a group under multiplication and includes the identity matrix, which is clearly ineffective for encryption. Therefore it is necessary for <bold>P</bold> to be randomly generated and independent of the plaintext. A suitable method is derived from the Stiefel manifold, or Haar measure (<xref ref-type="bibr" rid="R19">Hoff 2009</xref>; <xref ref-type="bibr" rid="R8">Chikuse and Chikuse 2003</xref>), which is measure-preserving, meaning that the measure (loosely speaking, the sampling probability) of any data matrix <bold>M</bold> is the same as the measure of <bold>PM</bold>. For this method, first an <italic>n</italic> × <italic>n</italic> matrix <bold>B</bold> is generated, whose entries are sampled independently from a standard normal distribution. Next, an <italic>n</italic> × <italic>n</italic> random orthogonal matrix is generated as <inline-formula><mml:math id="M4"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> In detail, <inline-formula><mml:math id="M5"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is computed as <inline-formula><mml:math id="M6"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <bold>Q</bold> and <bold>Λ</bold> are obtained from the eigen decomposition of <bold>B</bold><sup><italic>T</italic></sup><bold>B</bold>, i.e., <bold>B</bold><sup><italic>T</italic></sup><bold>B</bold> = <bold>QΛQ</bold><sup><italic>T</italic></sup>. Matrix <bold>P</bold> is easily seen to be orthogonal (by checking that <bold>P</bold><sup><italic>T</italic></sup><bold>P</bold> = <bold>I</bold>) and furthermore can be shown to be randomly sampled from the Stiefel manifold.</p></sec><sec id="S5"><title>Relationships between SNPs and between individuals</title><p id="P13">HEGP preserves relationships between genotypes (i.e., linkage disequilibrium, <italic>r</italic><sup>2</sup>), but scrambles relationships between individuals. Any orthogonal transformation preserves the dot product of two vectors and, geometrically, acts as a rotation of a hypersphere in which SNP genotype vectors and phenotype vectors are represented as points on its surface. The cosine of the angle between any pair of points subtended at the origin equals their Pearson correlation coefficient, or dot product and a rotation merely changes the coordinate system while leaving angles unchanged. In HEGP, all marker genotypes (and phenotypes) are rotated by the same orthogonal matrix as <bold>PM</bold> = [<bold>Pm</bold><sub>1</sub>, …, <bold>Pm</bold><sub><italic>p</italic></sub>]. Thus, the LD between <italic>j</italic>th and <italic>k</italic>th marker is preserved since <disp-formula id="FD4"><label>(4)</label><mml:math id="M7"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where we use the fact that for any orthogonal matrix, <bold>P</bold><sup><italic>T</italic></sup><bold>P</bold> = <bold>I</bold>. For illustration, the LD matrices based on the raw and the encrypted genotypes for 5,000 markers in the pig dataset of <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref> are shown in <xref ref-type="fig" rid="F3">Figure 3(a)</xref>. The LD matrix is calculated as <inline-formula><mml:math id="M8"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <bold>H</bold> is the normalized genotype matrix. The <italic>j</italic>th marker of the <italic>i</italic>th individual is normalized as <inline-formula><mml:math id="M9"><mml:mrow><mml:msub><mml:mtext>H</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mtext>M</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>p<sub>j</sub></italic> is the allele frequency. In <xref ref-type="fig" rid="F3">Figure 3(a)</xref>, the two LD matrices are almost identical, and the correlation between elements in the two LD matrices is 1.0.</p><p id="P14">In contrast to LD relationships, HEGP scrambles relationships between individuals since (<bold>PM</bold>)(<bold>PM</bold>)<sup><italic>T</italic></sup> = <bold>P</bold>(<bold>MM</bold><sup><italic>T</italic></sup>)<bold>P</bold><sup><italic>T</italic></sup> and, after transformation, individual records are random linear combinations of the original records. For demonstration, genomic relationship matrices (GRM), calculated as <inline-formula><mml:math id="M10"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> based on plaintext and cyphertext genotypes, are shown in <xref ref-type="fig" rid="F3">Figure 3(b)</xref> for a subset of the pig dataset. The elementwise correlation between the two GRM is ~ 0.</p></sec></sec><sec id="S6"><title>Statistical preliminaries</title><p id="P15">As we will demonstrate, in addition to single-marker regression for GWAS using linear mixed models with Gaussian errors, HEGP is compatible with most genetic analyses that use mixed models, including GBLUP, SNP-BLUP, Bayesian Alphabet, and others.</p><sec id="S7"><title>Mixed models</title><p id="P16">The mixed model is a cornerstone for many quantitative genetic analyses, including genetic parameter estimation, genomic prediction, and GWAS (<xref ref-type="bibr" rid="R26">Meuwissen <italic>et al</italic>. 2001</xref>; <xref ref-type="bibr" rid="R35">VanRaden 2008</xref>;?; <xref ref-type="bibr" rid="R12">Fernando <italic>et al</italic>. 2017</xref>; <xref ref-type="bibr" rid="R37">Wang <italic>et al</italic>. 2012</xref>, <xref ref-type="bibr" rid="R38">2016</xref>; <xref ref-type="bibr" rid="R27">Moser <italic>et al</italic>. 2015a</xref>; <xref ref-type="bibr" rid="R21">Legarra <italic>et al</italic>. 2018</xref>). In particular, GBLUP (<xref ref-type="bibr" rid="R15">Habier <italic>et al</italic>. 2007</xref>; <xref ref-type="bibr" rid="R35">VanRaden 2008</xref>; <xref ref-type="bibr" rid="R18">Hayes <italic>et al</italic>. 2009</xref>) is one of the most widely used linear mixed models for genomic prediction. The GBLUP model can be written as <disp-formula id="FD5"><label>(5)</label><mml:math id="M11"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula> where <bold>y</bold> is a vector of phenotypes of length <italic>n</italic>, and <bold>X</bold> is the incidence matrix for non-genetic fixed effects, denoted by <bold><italic>β</italic></bold>. Vector <bold>u</bold> contains additive genetic values for <italic>n</italic> individuals and follows a multivariate normal distribution <inline-formula><mml:math id="M12"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>G</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <bold>G</bold> is the genomic relationship matrix proportional to <bold>MM</bold><sup><italic>T</italic></sup>, where <bold>M</bold> is an <italic>n</italic> × <italic>p</italic> genotype covariate matrix, and <inline-formula><mml:math id="M13"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the genetic variance. Vector <bold>e</bold> includes <italic>n</italic> random residuals and follows a normal distribution, <inline-formula><mml:math id="M14"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the residual variance. Narrow sense he itability is defined to be <inline-formula><mml:math id="M16"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p><p id="P17">The GBLUP model is equivalent to the following marker effects model (hereinafter referred to as SNP-BLUP) in terms of predicting genetic values (<xref ref-type="bibr" rid="R11">Fernando 1998</xref>; <xref ref-type="bibr" rid="R15">Habier <italic>et al</italic>. 2007</xref>; <xref ref-type="bibr" rid="R34">Strandén and Garrick 2009</xref>): <disp-formula id="FD6"><label>(6)</label><mml:math id="M17"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula> where <bold><italic>α</italic></bold> is a vector of <italic>p</italic> additive marker effects, with <inline-formula><mml:math id="M18"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The same point estimates of marker effects <inline-formula><mml:math id="M19"><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:math></inline-formula> can be obtained from the estimated genetic values <bold>û</bold> in GBLUP as <inline-formula><mml:math id="M20"><mml:mrow><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p><p id="P18">The Gaussian prior distribution of marker effects in SNP-BLUP is just one, analytically tractable, member of the "Bayesian Alphabet", in which a range of prior distributions, reflecting different assumptions about the genetic architecture of the trait, are assigned to the marker effects (<xref ref-type="bibr" rid="R26">Meuwissen <italic>et al</italic>. 2001</xref>; <xref ref-type="bibr" rid="R20">Kizilkaya <italic>et al</italic>. 2010</xref>; <xref ref-type="bibr" rid="R16">Habier <italic>et al</italic>. 2011</xref>; <xref ref-type="bibr" rid="R10">Erbe <italic>et al</italic>. 2012</xref>; <xref ref-type="bibr" rid="R28">Moser <italic>et al</italic>. 2015b</xref>; <xref ref-type="bibr" rid="R31">Park and Casella 2008</xref>; <xref ref-type="bibr" rid="R14">Gianola and Fernando 2019</xref>). For example, it is sometimes desirable to model the majority of marker effects as being zero, and to allow occasional markers with large effects. For some traits, such priors are more biologically meaningful than SNP-BLUP and have been widely used in genomic prediction and genome-wide association studies.</p><p id="P19">In this paper, we demonstrate the effectiveness of HEGP using both SNP-BLUP and BayesC<italic>π</italic> (<xref ref-type="bibr" rid="R20">Kizilkaya <italic>et al</italic>. 2010</xref>; <xref ref-type="bibr" rid="R16">Habier<italic>et al</italic>. 2011</xref>). BayesC<italic>π</italic> is a representative of the other "Bayesian Alphabet" models, so the extension of HEGP to other priors for marker effects (<xref ref-type="bibr" rid="R26">Meuwissen <italic>et al</italic>. 2001</xref>; <xref ref-type="bibr" rid="R10">Erbe <italic>et al</italic>. 2012</xref>; <xref ref-type="bibr" rid="R28">Moser <italic>et al</italic>.2015b</xref>; <xref ref-type="bibr" rid="R31">Park and Casella 2008</xref>; <xref ref-type="bibr" rid="R14">Gianola and Fernando 2019</xref>) does not present further challenges. BayesC<italic>π</italic>(<xref ref-type="bibr" rid="R20">Kizilkaya <italic>et al</italic>. 2010</xref>; <xref ref-type="bibr" rid="R16">Habier <italic>et al</italic>. 2011</xref>) is typical in that it assigns mixture priors to marker effects, which are multiplied by the Gaussian likelihood of the data to generate the posterior. The BayesC<italic>π</italic> model must be fitted using Gibbs sampling, and therefore we must show that HEGP does not perturb the algorithm and produces numerically stable and accurate estimates.</p><p id="P20">At each step of the Gibbs sampler, a given unknown is sampled from its full conditional posterior distributions given the latest sampled values of all other unknowns. Below we will show that the full conditional posterior distributions of marker effects are identical when using raw or encrypted data, such that the same posterior distributions will be obtained (this also holds for other parameters of interest). Derivations for other parameters of interest in SNP-BLUP and BayesC<italic>π</italic> can be found in the <xref ref-type="supplementary-material" rid="SD1">Appendix</xref>.</p></sec></sec><sec id="S8"><title>Unchanged likelihood using HEGP</title><p id="P21">In HEGP, the plaintext phenotypes, covariates, and genotype dosages, and the design matrix for fixed effects are encrypted by pre-multiplication by the same random orthogonal matrix, <bold>P</bold>. The mixed model using cyphertext for both SNP-BLUP and BayesC<italic>π</italic> can be written as <disp-formula id="FD7"><label>(7)</label><mml:math id="M21"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P22">In this model, <bold>y</bold><sup>∗</sup> = <bold>Py</bold> are the encrypted phenotypes, <bold>M</bold><sup>∗</sup> = <bold>PM</bold> = <bold>u</bold><sup>∗</sup> the encrypted genotypes, and <bold>X</bold><sup>∗</sup> = <bold>PX</bold> the encrypted design matrix for fixed effects. After encryption, the residual variance remains unchanged, represented as <inline-formula><mml:math id="M22"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The genetic variance becomes <inline-formula><mml:math id="M23"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>G</mml:mi><mml:mi>P</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> after encryption.</p><p id="P23">We next show that the likelihood of the data is invariant under orthogonal transformation. Define the plaintext variance matrix <inline-formula><mml:math id="M24"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>G</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and its cyphertext equivalent <inline-formula><mml:math id="M25"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>G</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> Then the determinant of the variance matrix is invariant because |<bold>V</bold><sup>∗</sup> | = |<bold>P</bold><sup><italic>T</italic></sup><bold>VP</bold>| = |<bold>P</bold><sup><italic>T</italic></sup>||<bold>V</bold>||<bold>P</bold>| = |<bold>V</bold>| and hence the Gaussian log-likelihood of the plaintext equals that of the cyphertext: <disp-formula id="FD8"><label>(8)</label><mml:math id="M26"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi><mml:mi>P</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:msup><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P24">Hence all parameter inference in SNP-BLUP is invariant under orthogonal transformation in the mixed model, resulting in unchanged estimates for <italic>β</italic>, for the variance components <inline-formula><mml:math id="M27"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and heritability <italic>h</italic><sup>2</sup>.</p></sec><sec id="S9"><title>Inference of unknowns in mixed model</title><p id="P25">In BayesC<italic>π</italic>, the prior for the marker effects is a mixture of a point mass at zero and a univariate normal distribution with a null mean and a common locus variance <inline-formula><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> The full conditional posterior distribution of the marker effect for locus <italic>j</italic> when it is non-zero (i.e., the full conditional posterior distribution of the marker effect for locus <italic>j</italic> in SNP-BLUP) can be expressed as <disp-formula id="FD9"><label>(9)</label><mml:math id="M29"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>ELSE</italic> stands for all the other parameters and <inline-formula><mml:math id="M30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the solution to <disp-formula id="FD10"><label>(10)</label><mml:math id="M31"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P26">When encrypted genotypic and phenotypic data are used, the full conditional posterior distribution of <italic>α<sub>j</sub></italic>, when it is non-zero, can be written as <disp-formula id="FD11"><label>(11)</label><mml:math id="M32"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>ELSE</italic> stands for all the other parameters, and <inline-formula><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is the solution to <disp-formula id="FD12"><label>(12)</label><mml:math id="M34"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P27">We have previously shown that <inline-formula><mml:math id="M35"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> Similarly, <disp-formula id="FD13"><label>(13)</label><mml:math id="M36"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>y</mml:mi></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> and <disp-formula id="FD14"><label>(14)</label><mml:math id="M37"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mtext>.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P28">Therefore, the full conditional posterior distribution of <italic>aj</italic> using cyphertext, as per equations (<xref ref-type="disp-formula" rid="FD11">11</xref>) and (<xref ref-type="disp-formula" rid="FD12">12</xref>), is identical to that obtained using the plaintext, as shown in equations (<xref ref-type="disp-formula" rid="FD9">9</xref>) and (<xref ref-type="disp-formula" rid="FD10">10</xref>). Thus, because HEGP does not change the full conditional posterior distributions in Gibbs sampling, the posterior distributions of marker effects are also identical using plaintext or cyphertext. The same conclusion holds for all other parameters of interest (see <xref ref-type="supplementary-material" rid="SD1">Appendix</xref>). Note that once estimates of marker effects are obtained, the plaintext of genotypes, if available, should be used to calculate the estimated breeding values.</p></sec><sec id="S10"><title>Joint analysis using encrypted data from multiple contributors</title><p id="P29">A single research study may only contain a limited amount of data that is underpowered for genetic analysis. This issue can be mitigated through federated analyses using data from multiple studies, e.g. <xref ref-type="bibr" rid="R42">Yengo <italic>et al</italic>. (2022a)</xref>. An attractive feature of HEGP is that it allows each component of the federated data to be encrypted independently. Thus, each contributor generates its own private key and uses it to encrypt its own plaintext prior to sharing it for joint analysis. The keys are never shared. The process for joint analysis then proceeds as described in the following.</p><p id="P30">For clarity, let’s assume there are three contributors. Assuming variance components, such as the marker effect variance and the residual variance, are identical for all parties, the mixed model for the joint analysis of cyphertext can be written as <disp-formula id="FD15"><label>(15)</label><mml:math id="M38"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>β</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>α</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where the matrices related to the <italic>t</italic>-th contributor are labeled with subscript "<italic>t</italic>". This equation can be re-written as <disp-formula id="FD16"><label>(16)</label><mml:math id="M39"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mstyle mathvariant="bold-italic" mathsize="normal"><mml:mi>α</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <bold>P</bold> is a block-diagonal orthogonal matrix <disp-formula id="FD17"><label>(17)</label><mml:math id="M40"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P31">Thus, conceptually, the stacked cyphertexts are equivalent to the stacked plaintexts after encryption by the block diagonal matrix <bold>P</bold>, which is the orthogonal matrix assembled from the component random orthogonal matrices <bold>P</bold><sub>1</sub>, <bold>P</bold><sub>2</sub>, and <bold>P</bold><sub>3</sub>. Thus, as shown in the previous section, unknowns inferred from joint cyphertext will be identical to those inferred using the joint plaintext. Note that genomic predictions of the original individuals require the plaintext genotypes and, thus, each contributor can only generate these for their own individuals, but using estimates of marker effects obtained from the combined data for additional accuracy of predictions.</p></sec><sec id="S11"><title>Security of HEGP</title><p id="P32">The correlation between the centered plaintext genotypes, represented as <bold>m</bold><sub><italic>j</italic></sub>, and the cyphertext genotypes, represented as <bold>Pm</bold><sub><italic>j</italic></sub>, is proportional to <inline-formula><mml:math id="M41"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>m</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> When <bold>P</bold> is "far from" an identity matrix (or scaled identity matrix), such correlations resemble those between two random vectors. For example, using the pig genotypes from <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref> (<italic>n</italic> = 3534, <italic>p</italic> = 50, 436), the empirical distribution of Pearson correlations between the plaintext and cyphertext genotypes for each marker are shown in <xref ref-type="fig" rid="F4">Figure 4</xref>. On average, the correlation between raw and encrypted genotypes is about 0.001, which is very close to 0, and almost all correlations are inside the interval [−0.03, 0.03]. Thus, without decryption, cybertext genotypes and phenotypes are uninterpretable.</p><sec id="S12"><title>Decryption without knowledge of the key</title><p id="P33">To obtain the raw genotypes from the encrypted genotypes, an orthogonal matrix <bold>Q</bold> ~ <bold>P</bold><sup><italic>T</italic></sup> should be estimated as the key for decryption. When <bold>Q</bold> = <bold>P</bold><sup><italic>T</italic></sup>, exactly, the plaintext genotypes will be recovered, since then <bold>QM</bold><sup>∗</sup> = <bold>P</bold><sup><italic>T</italic></sup><bold>PM</bold> = <bold>M</bold>. The distance between <bold>QM</bold><sup>∗</sup> and <bold>M</bold> measures how close the decryption is to the raw data. However, because neither <bold>M</bold> nor <bold>P</bold> are shared, it is difficult to evaluate attempted decryption without a suitable objective function to minimize. Assuming the distance between the attempted decrypted genotype matrix and the plaintext genotype matrix is known (although it is unknown in practice), several strategies to decrypt the genotypes were discussed in <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref>. First, in a brute-force approach, numerous random orthogonal matrices (i.e., keys) were generated for decryption. However, massive computing resources would be required to generate and test all possible keys. <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref> reported that even for a dataset with 8 individuals, they could not brute-force the key. A second approach to uncover the decryption key relies on the trimodal distribution of the plaintext genotype frequencies of each marker, assuming all markers are in Hardy-Weinberg equilibrium with publicly-available allele frequencies (such as <xref ref-type="fig" rid="F2">Figure 2(c)</xref>). <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref> attempted to infer the key by maximizing the kernel density estimator of those non-Gaussian distributions. However, the results were unsuccessful. Finally, 302 a decryption challenge for HEGP (<xref ref-type="bibr" rid="R29">Mott <italic>et al</italic>. 2020a</xref>), in which attempts were invited to decrypt HEGP-encrypted plaintext 304 genotypes, has so far failed to elicit a successful attack. More 305 discussion can be found in <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref>.</p><p id="P34">The only identified weakness of HEGP occurs when the data includes variants that are private to an individual. In an extreme case, when each individual has a private variant coded as 1, the 309 plaintext genotype matrix can be written as <bold>M</bold> = [<bold>I</bold> | <bold>M</bold><sub><italic>sub</italic></sub>], where <bold>I</bold> represents genotypes of the <italic>n</italic> private variants, and <bold>M</bold><sub><italic>sub</italic></sub> represents genotypes of all the other markers. In this situation, <bold>P</bold> itself will be included in the encrypted genotypes since <inline-formula><mml:math id="M42"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mspace width="0.2em"/><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> In practice, this extreme case can be avoided by using common variants. However, it suggests that useful information might be extracted from the encrypted data of lower-frequency variants, suggesting it is best to remove any variant with a frequency under 0.01 or that is private to fewer than about 10 individuals. Since these variants are typically removed during quality control processing, there should be minimal loss of information.</p></sec></sec><sec id="S13"><title>Data analysis</title><p id="P35">The pig dataset in <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref> was used to validate the equivalent outcomes from both genomic prediction and GWAS analyses using plaintext and cyphertext. This dataset contains 3534 genotyped individuals and the number of SNP markers is 50,436. We simulated phenotypes based on different values for heritability and numbers of quantitative trait loci (QTL) (i.e., causal variants). In detail, phenotypes with heritability equal 0.1, 0.3, 0.5, and 0.7 were simulated, and 1, 10, 50, and 100% of SNPs were randomly sampled as QTL (16 scenarios). Contemporary group effects were included to simulate phenotypes on individuals from 4 groups. For each simulated scenario, 10 replicates were applied. The genotypes of each marker were centered to have zero mean. The incidence matrix of fixed effects, the genotypes, and the simulated phenotypes were encrypted using a random orthogonal matrix generated as described above. SNP-BLUP and BayesC<italic>π</italic> were applied to analyze the plaintext and cyphertext using the JWAS package (<xref ref-type="bibr" rid="R6">Cheng <italic>et al</italic>. 2018</xref>, <xref ref-type="bibr" rid="R7">2022</xref>). In all scenarios, 500,000 MCMC iterations were applied to ensure convergence.</p><p id="P36">We first show that the estimated marker effects <inline-formula><mml:math id="M43"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> remain unchanged with the cybertext. Using the plaintext of genotypes (<bold>M</bold>), the estimated breeding values (EBV) are calculated as <inline-formula><mml:math id="M44"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which equals <bold>M<italic>α</italic></bold>, confirming that the EBVs also remain unchanged. Below we only present the results from BayesC<italic>π</italic>, and the conclusions drawn were consistent with those from RR-BLUP results.</p></sec></sec><sec id="S14" sec-type="results"><title>Results</title><sec id="S15"><title>Estimated marker effects and breeding values</title><p id="P37">Overall, the marker effects estimated from plaintext and cyphertext were very similar, with a Pearson correlation of 0.9929. The results from one replicate in the scenario with <italic>h</italic><sup>2</sup> = 0.3, <italic>QTL</italic>% = 1% are presented in <xref ref-type="fig" rid="F5">Figure 5(a)</xref>, and similar results were observed across all other scenarios. The results for all scenarios are detailed in <xref ref-type="table" rid="T1">Table 1</xref>, where each value represents the averaged correlation across 10 replicates.</p><p id="P38">The estimated breeding values (EBV) for all individuals with genotypes <bold>M</bold> were calculated as <inline-formula><mml:math id="M45"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> using marker effects estimated from plaintext, and as <inline-formula><mml:math id="M46"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> using marker effects estimated from cyphertext. Overall, the correlation between EBV calculated using the plaintext and those calculated using the cyphertext was about 0.9996. The results of one replicate from the scenario with <italic>h</italic><sup>2</sup> = 0.3, <italic>QTL</italic>% = 1% are shown in <xref ref-type="fig" rid="F5">Figure 5(b)</xref>, and similar results were observed for all the other scenarios. The results for all scenarios are listed in <xref ref-type="table" rid="T2">Table 2</xref>, where each value is the average correlation from 10 replicates.</p></sec><sec id="S16"><title>Local genetic variances</title><p id="P39">For GWAS, the genetic variance captured by a genomic window is of interest due to the fact that highly correlated SNPs within a genomic window jointly affect the phenotype, and it is difficult to identify the effect of a single marker (<xref ref-type="bibr" rid="R17">Hayes <italic>et al</italic>. 2010</xref>). In GWAS, local genetic variances can be used to estimate window-based posterior probabilities of association (WPPA) (<xref ref-type="bibr" rid="R12">Fernando <italic>et al</italic>. 2017</xref>). Here we divided the pig reference genome into 2522 non-overlapping genomic windows, where each window contains about 20 SNPs. The genetic values that are attributed to each genomic window were sampled from their posterior distributions using MCMC.</p><p id="P40">Overall, the correlation between local genetic variances estimated using plaintext or cyphertext was about 0.9923. The results of one replicate from the scenario with <italic>h</italic><sup>2</sup> = 0.3, <italic>QTL</italic>% = 1% are presented in <xref ref-type="fig" rid="F5">Figure 5(c)</xref>, and similar results were observed for all other scenarios. The results for each scenario are listed in <xref ref-type="table" rid="T3">Table 3</xref>, where each value represents the average correlation from 10 replicates.</p></sec><sec id="S17"><title>Joint analysis of cyphertext from multiple contributors</title><p id="P41">To perform joint cyphertext analysis, the 3,534 individuals in the pig dataset were split into two datasets (<italic>n</italic><sub>1</sub> = 500, <italic>n</italic><sub>2</sub> = 3034), modelling the scenario of two data contributors. The genotypes were independently centered within each contributor to have zero means. The simulated phenotypes data in the scenario with heritability of 0.3 and a 10% QTLs were used. The plaintext phenotypes, genotypes, and covariates were independently encrypted by each contributor. For example, for contributor 1, the encrypted genotype data is <inline-formula><mml:math id="M47"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>P</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>M</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> with <bold>P</bold><sub>1</sub> of size <italic>n</italic><sub>1</sub> × <italic>n</italic><sub>1</sub>, and for contributor 2 the encrypted genotype data is <inline-formula><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>2</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>P</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mtext>M</mml:mtext><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> with <bold>P</bold><sub>2</sub> of size <italic>n</italic><sub>2</sub> × <italic>n</italic><sub>2</sub>. Only the cyphertexts were shared, not the encryption keys <bold>P</bold><sub>1</sub> or <bold>P</bold><sub>2</sub>. We repeated the previous analyses using the joint cyphertexts and the joint plaintexts. Using the joint cyphertexts yielded results very similar to those using the joint plaintexts.</p><p id="P42">Moreover, using joint cyphertexts to estimate parameters resulted in significantly higher prediction accuracies than only using the data from a single data contributor. This is to be expected, as a larger sample size improves parameter inference. For the 500 individuals in contributor 1, we calculated their EBV using marker effects estimated from the joint data <inline-formula><mml:math id="M49"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> as well as using marker effects estimated from only contributor 1’s data <inline-formula><mml:math id="M50"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The comparison between the accuracy of <inline-formula><mml:math id="M51"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M52"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is shown in <xref ref-type="fig" rid="F6">Figure 6</xref>, where each dot represents the result of one replicate. The joint data resulted in significantly higher accuracy than using data from a single contributor (pairwise t-test <italic>P</italic>-value &lt; 0.0005). The same conclusions were drawn for contributor 2.</p></sec></sec><sec id="S18" sec-type="discussion"><title>Discussion</title><sec id="S19"><title>Overview</title><p id="P43">In this study we have built on the HEGP methodology introduced in <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref> to show how it can be extended to the wide class of mixed models including Bayesian Alphabet models that are commonly used in animal and crop quantitative genetics. We have also shown how federated data sets fit into this framework and confirmed the increase in prediction accuracy of breeding values expected from joint analyses with plaintext analyses also holds for cyphertext. Note that the estimated marker effects using encrypted data are the same as those using the raw data.</p><p id="P44">HEGP enables adherence to, and capitalizes on, the benefits of the FAIR principles in genome-to-phenome studies. In the context of animal and crop breeding, it also addresses many of the privacy, intellectual property, and commercial interest issues that prevent the sharing and reuse of data for both research and industry applications.</p></sec><sec id="S20"><title>Alternatives</title><p id="P45">The principal alternative strategy to sharing genotype and phenotype data is to share GWAS summary statistics, for example, marker regression coefficient estimates and their standard errors. This approach is most suited to single-marker regression analyses that are typical in human studies (<xref ref-type="bibr" rid="R25">MacArthur <italic>et al</italic>. 2021</xref>). To this end, databases have been built to collect GWAS summary statistics (<xref ref-type="bibr" rid="R39">Welter <italic>et al</italic>. 2014</xref>; <xref ref-type="bibr" rid="R24">MacArthur <italic>et al</italic>. 2017</xref>; <xref ref-type="bibr" rid="R4">Buniello <italic>et al</italic>.2019</xref>), and methods have been proposed to facilitate large metaanalyses needed for the increased power in dissecting the genetic basis of complex traits (<xref ref-type="bibr" rid="R41">Yang <italic>et al</italic>. 2012</xref>; <xref ref-type="bibr" rid="R36">Vilhjálmsson <italic>et al</italic>. 2015</xref>; <xref ref-type="bibr" rid="R1">Barbeira <italic>et al</italic>. 2018</xref>; <xref ref-type="bibr" rid="R22">Lloyd-Jones <italic>et al</italic>. 2019</xref>; <xref ref-type="bibr" rid="R32">Privé <italic>et al</italic>. 2020</xref>; <xref ref-type="bibr" rid="R43">Yengo <italic>et al</italic>. 2022b</xref>; <xref ref-type="bibr" rid="R40">Werme <italic>et al</italic>. 2022</xref>). However, meta-analyses based on these summary statistics rely heavily on approximations due to unavailability of the individual-level data. Homomorphic encryption methods such as HEGP do not require such approximations, provided they factorize into a prior distribution of the markers multiplied by the Gaussian likelihood of the data, and can be fitted by MCMC methods such as Gibbs sampling.</p></sec><sec id="S21"><title>Rounding Errors</title><p id="P46">In HEGP, the individuals’ plaintext identities, phenotypes, and genotypes are obscured by pre-multiplying by a high-dimensional random orthogonal matrix. In the resulting cyphertext, the relationships between SNPs, and between SNPs and phenotypes are preserved, but the relationships between individuals are scrambled - in fact, the concept of an individual is nonsensical after encryption, as records in the encrypted data are random linear combinations of the original individuals’ records. Theoretically, plaintext and cyphertext should yield identical estimates of marker effects and other parameters, but due to rounding errors, as well as Monte Carlo errors in the case of models using MCMC, the estimated marker effects are not identical but rather very similar, with correlations close to 1.0. In detail, rounding errors occur because the off-diagonal elements of <bold>P</bold><sup><italic>T</italic></sup><bold>P</bold> are very small values, ~ 10<sup>−13</sup>. <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>. (2020b)</xref> reported that rounding errors were negligible for <bold>P</bold> with dimensions up to 10, 000 × 10, 000. To alleviate the problem of rounding errors for a very large dataset, <bold>P</bold> can be constructed as a block-diagonal matrix, where each block is a random orthogonal matrix.</p></sec><sec id="S22"><title>Time complexity</title><p id="P47">The time taken to generate a random <italic>n</italic> × <italic>n</italic> orthogonal matrix <bold>P</bold> from the Stiefel manifold is proportional to <italic>n</italic><sup>3</sup>, where <italic>n</italic> is the number of individuals, being dominated by the eigen decomposition. The time taken to multiply the plaintext by <bold>P</bold> to produce the cyphertext is proportional to <italic>pn</italic><sup>2</sup>, where <italic>p</italic> is the number of markers. In a computer server with five cores, generating <bold>P</bold> for the pig dataset (<italic>n</italic> = 3, 534) took less than one minute. For a dataset with 10,000 individuals, the time to generate <bold>P</bold> was about 5 minutes. However, the time to generate <bold>P</bold> for 50,000 individuals was about 8 hours. As shown in <xref ref-type="fig" rid="F7">Figure 7</xref>, running time increased rapidly as sample size increased.</p><p id="P48">In practice, with hundreds of thousands of individuals, many relatively small random orthogonal matrices (e.g., 50, 000 × 50, 000) could be generated in parallel, and then a large block-diagonal orthogonal matrix could be constructed, with each block being a random orthogonal matrix (i.e, a block-diagonal random orthogonal matrix). This larger block-diagonal orthogonal matrix, as well as any permutation of such a matrix, can be used as the encryption key.</p><p id="P49">The size of the cyphertext is the same as the plaintext and, therefore, the computational effort required for each iteration in MCMC is comparable. In our analysis of the pig dataset (<xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. 2012</xref>), the number of MCMC iterations necessary to ensure the convergence of the MCMC process was also similar between analysis of the plaintext and the cyphertext.</p></sec><sec id="S23"><title>Security</title><p id="P50">With an appropriately sampled HEGP encryption key, the correlation between raw and encrypted data resembles that between two random vectors. For the pig dataset (<xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. 2012</xref>), the absolute Pearson correlation between raw and encrypted marker genotypes was almost always less than 0.03. To increase the security of the encrypting and lower the risk of discovery of the decryption key, genotypes for SNPs with very low minor allele frequencies should not be shared. Since only cyphertext are shared, the unknown nature of the plaintext genotypes <bold>M</bold> makes it difficult to evaluate decryption attempts. To date, decryption attacks have been proven ineffective <xref ref-type="bibr" rid="R30">Mott <italic>et al</italic>.(2020b)</xref>, even when <bold>M</bold> was available for evaluation. However, further exploration is still needed to determine whether HEGP is cryptographically secure.</p></sec><sec id="S24"><title>Protocols for data sharing in HEGP</title><p id="P51">Finally, we mention some points to consider when sharing HEGP cyphertext. First, it is necessary for all contributors to agree on a common set of markers and covariates to be shared, and on whether phenotypes are to be residualised by removing covariate effects before sharing - in which case the cyphertext versions of covariates need not be shared - or afterwards, during the joint analysis. Second, missing genotypes, covariates and phenotypes must be imputed, either for markers not genotyped in a particular contributor’s data, or to fill in sporadic missing values (HEGP does not allow missing data). Third, the sharing topology must be agreed upon: each cyphertext could be shared with all contributors, so that each participant could conduct their own analysis, or instead, it could be shared only with a trusted third party who would perform the agreed-upon analysis. Fourth, although the joint analysis’ parameter estimates etc do not need decrypting, the parties may want to agree beforehand on their subsequent use and dissemination.</p><p id="P52">These considerations would likely require the contributors to set up a protocol for data sharing, reflecting the sensitivity and value of the component data sets, and which will likely vary depending on circumstances and commercial considerations. Notwithstanding the HEGP-specific technical requirements, such a protocol should be simpler to implement than agreements involving the sharing of plaintext data.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Appendix</label><media xlink:href="EMS189531-supplement-Appendix.pdf" mimetype="application" mime-subtype="pdf" id="d203aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S25"><title>Acknowledgements</title><sec id="S26"><title>Funding</title><p>This work was supported by a UKRI BBSRC grant BB/V00767X/1 awarded to Richard Mott, by Agricultural Genome to Phenome Initiative (AG2PI) under USDA-NIFA awards 2020-70412-32615 and 2021-70412-35233, and by USDA-NIFA awards 2021-67015-33412, 2023-67015-39564, 2023-70412-41054.</p></sec></ack><sec id="S27" sec-type="data-availability"><title>Availability of data and materials</title><p id="P53">Pig genotypes used in the analysis are publicly available in <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref>. The simulated phenotypes and all scripts are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zhaotianjing/encryption">https://github.com/zhaotianjing/encryption</ext-link>. The authors state that all data necessary for confirming the conclusions presented in the article are represented fully within the article.</p></sec><fn-group><fn id="FN1" fn-type="conflict"><p id="P54"><bold>Competing interests</bold></p><p id="P55">The authors declare that they have no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbeira</surname><given-names>AN</given-names></name><name><surname>Dickinson</surname><given-names>SP</given-names></name><name><surname>Bonazzola</surname><given-names>R</given-names></name><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Wheeler</surname><given-names>HE</given-names></name><etal/></person-group><article-title>Exploring the phenotypic consequences of tissue specific gene expression variation inferred from gwas summary statistics</article-title><source>Nature communications</source><year>2018</year><volume>9</volume><fpage>1</fpage><lpage>20</lpage><pub-id pub-id-type="pmcid">PMC5940825</pub-id><pub-id pub-id-type="pmid">29739930</pub-id><pub-id pub-id-type="doi">10.1038/s41467-018-03621-1</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blatt</surname><given-names>M</given-names></name><name><surname>Gusev</surname><given-names>A</given-names></name><name><surname>Polyakov</surname><given-names>Y</given-names></name><name><surname>Goldwasser</surname><given-names>S</given-names></name></person-group><article-title>Secure large-scale genome-wide association studies using homomorphic encryption</article-title><source>Proceedings of the National Academy of Sciences</source><year>2020</year><volume>117</volume><fpage>11608</fpage><lpage>11613</lpage><pub-id pub-id-type="pmcid">PMC7261120</pub-id><pub-id pub-id-type="pmid">32398369</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1918257117</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradbury</surname><given-names>PJ</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Kroon</surname><given-names>DE</given-names></name><name><surname>Casstevens</surname><given-names>TM</given-names></name><name><surname>Ramdoss</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Tassel: software for association mapping of complex traits in diverse samples</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2633</fpage><lpage>2635</lpage><pub-id pub-id-type="pmid">17586829</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buniello</surname><given-names>A</given-names></name><name><surname>MacArthur</surname><given-names>JAL</given-names></name><name><surname>Cerezo</surname><given-names>M</given-names></name><name><surname>Harris</surname><given-names>LW</given-names></name><name><surname>Hayhurst</surname><given-names>J</given-names></name><etal/></person-group><article-title>The nhgri-ebi gwas catalog of published genome-wide association studies, targeted arrays and summary statistics 2019</article-title><source>Nucleic acids research</source><year>2019</year><volume>47</volume><fpage>D1005</fpage><lpage>D1012</lpage><pub-id pub-id-type="pmcid">PMC6323933</pub-id><pub-id pub-id-type="pmid">30445434</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky1120</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Gilad-Bachrach</surname><given-names>R</given-names></name><name><surname>Han</surname><given-names>K</given-names></name><name><surname>Huang</surname><given-names>Z</given-names></name><name><surname>Jalali</surname><given-names>A</given-names></name><etal/></person-group><article-title>Logistic regression over encrypted data from fully homomorphic encryption</article-title><source>BMC medical genomics</source><year>2018</year><volume>11</volume><fpage>3</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC6180402</pub-id><pub-id pub-id-type="pmid">30309350</pub-id><pub-id pub-id-type="doi">10.1186/s12920-018-0397-z</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>H</given-names></name><name><surname>Fernando</surname><given-names>R</given-names></name><name><surname>Garrick</surname><given-names>D</given-names></name></person-group><article-title>Jwas: Julia implementation of whole-genome analysis software</article-title><source>Proceedings of the world congress on genetics applied to livestock production</source><year>2018</year><volume>11</volume><fpage>859</fpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>H</given-names></name><name><surname>Fernando</surname><given-names>R</given-names></name><name><surname>Garrick</surname><given-names>D</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Qu</surname><given-names>J</given-names></name></person-group><article-title>Jwas version 2: leveraging biological information and highthrough-put phenotypes into genomic prediction and association</article-title><source>Proceedings of the world congress on genetics applied to livestock production</source><year>2022</year><volume>12</volume><fpage>1519</fpage><lpage>1522</lpage></element-citation></ref><ref id="R8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chikuse</surname><given-names>Y</given-names></name><name><surname>Chikuse</surname><given-names>Y</given-names></name></person-group><source>Statistics on special manifolds</source><publisher-name>Springer</publisher-name><year>2003</year><volume>1</volume></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cleveland</surname><given-names>MA</given-names></name><name><surname>Hickey</surname><given-names>JM</given-names></name><name><surname>Forni</surname><given-names>S</given-names></name></person-group><article-title>A common dataset for genomic analysis of livestock populations</article-title><source>G3: Genes| Genomes| Genetics</source><year>2012</year><volume>2</volume><fpage>429</fpage><lpage>435</lpage><pub-id pub-id-type="pmcid">PMC3337471</pub-id><pub-id pub-id-type="pmid">22540034</pub-id><pub-id pub-id-type="doi">10.1534/g3.111.001453</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erbe</surname><given-names>M</given-names></name><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Matukumalli</surname><given-names>LK</given-names></name><name><surname>Goswami</surname><given-names>S</given-names></name><name><surname>Bowman</surname><given-names>PJ</given-names></name><etal/></person-group><article-title>Improving accuracy of genomic predictions within and between dairy cattle breeds with imputed high-density single nucleotide polymorphism panels</article-title><source>J Dairy Sci</source><year>2012</year><volume>95</volume><fpage>4114</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">22720968</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fernando</surname><given-names>R</given-names></name></person-group><chapter-title>Genetic evaluation and selection using genotypic, phenotypic and pedigree information</chapter-title><source>6th Wld Cong Genet App Liv Prod</source><publisher-loc>Armidale, Australia</publisher-loc><year>1998</year><volume>26</volume><fpage>329</fpage><lpage>336</lpage></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernando</surname><given-names>R</given-names></name><name><surname>Toosi</surname><given-names>A</given-names></name><name><surname>Wolc</surname><given-names>A</given-names></name><name><surname>Garrick</surname><given-names>D</given-names></name><name><surname>Dekkers</surname><given-names>J</given-names></name></person-group><article-title>Application of whole-genome prediction methods for genome-wide association studies: a bayesian approach</article-title><source>J Agric Biol Environ Stat</source><year>2017</year><volume>22</volume><issue>2</issue><fpage>172</fpage><lpage>93</lpage></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernando</surname><given-names>RL</given-names></name><name><surname>Garrick</surname><given-names>D</given-names></name></person-group><article-title>Bayesian methods applied to gwas</article-title><source>Genome-wide association studies and genomic prediction</source><year>2013</year><fpage>237</fpage><lpage>274</lpage></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gianola</surname><given-names>D</given-names></name><name><surname>Fernando</surname><given-names>RL</given-names></name></person-group><article-title>A Multiple-Trait Bayesian Lasso for Genome-Enabled Analysis and Prediction of Complex Traits</article-title><source>Genetics</source><year>2019</year><volume>214</volume><comment>genetics.302934.2019 – 331</comment><pub-id pub-id-type="pmcid">PMC7017027</pub-id><pub-id pub-id-type="pmid">31879318</pub-id><pub-id pub-id-type="doi">10.1534/genetics.119.302934</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Habier</surname><given-names>D</given-names></name><name><surname>Fernando</surname><given-names>RL</given-names></name><name><surname>Dekkers</surname><given-names>JC</given-names></name></person-group><article-title>The impact of genetic relationship information on genome-assisted breeding values</article-title><source>Genetics</source><year>2007</year><volume>177</volume><fpage>2389</fpage><lpage>2397</lpage><pub-id pub-id-type="pmcid">PMC2219482</pub-id><pub-id pub-id-type="pmid">18073436</pub-id><pub-id pub-id-type="doi">10.1534/genetics.107.081190</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Habier</surname><given-names>D</given-names></name><name><surname>Fernando</surname><given-names>RL</given-names></name><name><surname>Kizilkaya</surname><given-names>K</given-names></name><name><surname>Garrick</surname><given-names>D</given-names></name></person-group><article-title>Extension of the bayesian alphabet for genomic selection</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>186</fpage><pub-id pub-id-type="pmcid">PMC3144464</pub-id><pub-id pub-id-type="pmid">21605355</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-12-186</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Pryce</surname><given-names>J</given-names></name><name><surname>Chamberlain</surname><given-names>AJ</given-names></name><name><surname>Bowman</surname><given-names>PJ</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name></person-group><article-title>Genetic architecture of complex traits and accuracy of genomic prediction: Coat colour, milk-fat percentage, and type in holstein cattle as contrasting model traits</article-title><source>PLoS Genet</source><year>2010</year><volume>6</volume><issue>9</issue><elocation-id>e1001139</elocation-id><pub-id pub-id-type="pmcid">PMC2944788</pub-id><pub-id pub-id-type="pmid">20927186</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1001139</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Visscher</surname><given-names>PM</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name></person-group><article-title>Increased accuracy of artificial selection by using the realized relationship matrix</article-title><source>Genetics research</source><year>2009</year><volume>91</volume><fpage>47</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">19220931</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoff</surname><given-names>PD</given-names></name></person-group><article-title>Simulation of the matrix bingham-von mises-fisher distribution, with applications to multivariate and relational data</article-title><source>Journal of Computational and Graphical Statistics</source><year>2009</year><volume>18</volume><fpage>438</fpage><lpage>456</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kizilkaya</surname><given-names>K</given-names></name><name><surname>Fernando</surname><given-names>RL</given-names></name><name><surname>Garrick</surname><given-names>DJ</given-names></name></person-group><article-title>Genomic prediction of simulated multibreed and purebred performance using observed fifty thousand single nucleotide polymorphism genotypes</article-title><source>J Anim Sci</source><year>2010</year><volume>88</volume><fpage>544</fpage><lpage>51</lpage><pub-id pub-id-type="pmid">19820059</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Legarra</surname><given-names>A</given-names></name><name><surname>Ricard</surname><given-names>A</given-names></name><name><surname>Varona</surname><given-names>L</given-names></name></person-group><article-title>Gwas by gblup: single and multimarker emmax and bayes factors, with an example in detection of a major gene for horse gait</article-title><source>G3: Genes, Genomes, Genetics</source><year>2018</year><volume>8</volume><fpage>2301</fpage><lpage>2308</lpage><pub-id pub-id-type="pmcid">PMC6027892</pub-id><pub-id pub-id-type="pmid">29748199</pub-id><pub-id pub-id-type="doi">10.1534/g3.118.200336</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lloyd-Jones</surname><given-names>LR</given-names></name><name><surname>Zeng</surname><given-names>J</given-names></name><name><surname>Sidorenko</surname><given-names>J</given-names></name><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Moser</surname><given-names>G</given-names></name><etal/></person-group><article-title>Improved polygenic prediction by bayesian multiple regression on summary statistics</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC6841727</pub-id><pub-id pub-id-type="pmid">31704910</pub-id><pub-id pub-id-type="doi">10.1038/s41467-019-12653-0</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>W-J</given-names></name><name><surname>Yamada</surname><given-names>Y</given-names></name><name><surname>Sakuma</surname><given-names>J</given-names></name></person-group><chapter-title>Privacy-preserving genome-wide association studies on cloud environment using fully homomorphic encryption</chapter-title><source>BMC medical informatics and decision making</source><publisher-name>Springer</publisher-name><year>2015</year><volume>15</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC4699111</pub-id><pub-id pub-id-type="pmid">26732892</pub-id><pub-id pub-id-type="doi">10.1186/1472-6947-15-S5-S1</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacArthur</surname><given-names>J</given-names></name><name><surname>Bowler</surname><given-names>E</given-names></name><name><surname>Cerezo</surname><given-names>M</given-names></name><name><surname>Gil</surname><given-names>L</given-names></name><name><surname>Hall</surname><given-names>P</given-names></name><etal/></person-group><article-title>The new nhgri-ebi catalog of published genome-wide association studies (gwas catalog)</article-title><source>Nucleic acids research</source><year>2017</year><volume>45</volume><fpage>D896</fpage><lpage>D901</lpage><pub-id pub-id-type="pmcid">PMC5210590</pub-id><pub-id pub-id-type="pmid">27899670</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkw1133</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacArthur</surname><given-names>JA</given-names></name><name><surname>Buniello</surname><given-names>A</given-names></name><name><surname>Harris</surname><given-names>LW</given-names></name><name><surname>Hayhurst</surname><given-names>J</given-names></name><name><surname>McMahon</surname><given-names>A</given-names></name><etal/></person-group><article-title>Workshop proceedings: Gwas summary statistics standards and sharing</article-title><source>Cell Genomics</source><year>2021</year><volume>1</volume><elocation-id>100004</elocation-id><pub-id pub-id-type="pmcid">PMC9451133</pub-id><pub-id pub-id-type="pmid">36082306</pub-id><pub-id pub-id-type="doi">10.1016/j.xgen.2021.100004</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meuwissen</surname><given-names>THE</given-names></name><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name></person-group><article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title><source>Genetics</source><year>2001</year><volume>157</volume><fpage>1819</fpage><lpage>1829</lpage><pub-id pub-id-type="pmcid">PMC1461589</pub-id><pub-id pub-id-type="pmid">11290733</pub-id><pub-id pub-id-type="doi">10.1093/genetics/157.4.1819</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Wray</surname><given-names>NR</given-names></name><etal/></person-group><article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a bayesian mixture model</article-title><source>PLoS Genet</source><year>2015a</year><volume>11</volume><elocation-id>e1004969</elocation-id><pub-id pub-id-type="pmcid">PMC4388571</pub-id><pub-id pub-id-type="pmid">25849665</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004969</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Hayes</surname><given-names>BJ</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Wray</surname><given-names>NR</given-names></name><etal/></person-group><article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a Bayesian mixture model</article-title><source>PLOS Genet</source><year>2015b</year><volume>11</volume><elocation-id>e1004969</elocation-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mott</surname><given-names>R</given-names></name><name><surname>Fischer</surname><given-names>C</given-names></name><name><surname>Prins</surname><given-names>P</given-names></name><name><surname>Davies</surname><given-names>RW</given-names></name></person-group><source>Hegp challenge</source><year>2020a</year><comment>Available from: <ext-link ext-link-type="uri" xlink:href="https://hegp.genenetwork.org/challenge">https://hegp.genenetwork.org/challenge</ext-link></comment></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mott</surname><given-names>R</given-names></name><name><surname>Fischer</surname><given-names>C</given-names></name><name><surname>Prins</surname><given-names>P</given-names></name><name><surname>Davies</surname><given-names>RW</given-names></name></person-group><article-title>Private Genomes and Public SNPs: Homomorphic Encryption of Genotypes and Phenotypes for Shared Quantitative Genetics</article-title><source>Genetics</source><year>2020b</year><volume>215</volume><fpage>359</fpage><lpage>372</lpage><pub-id pub-id-type="pmcid">PMC7268998</pub-id><pub-id pub-id-type="pmid">32327562</pub-id><pub-id pub-id-type="doi">10.1534/genetics.120.303153</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>T</given-names></name><name><surname>Casella</surname><given-names>G</given-names></name></person-group><article-title>The bayesian lasso</article-title><source>Journal of the American Statistical Association</source><year>2008</year><volume>103</volume><fpage>681</fpage><lpage>686</lpage></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Privé</surname><given-names>F</given-names></name><name><surname>Arbel</surname><given-names>J</given-names></name><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name></person-group><article-title>Ldpred2: better, faster, stronger</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>5424</fpage><lpage>5431</lpage><pub-id pub-id-type="pmcid">PMC8016455</pub-id><pub-id pub-id-type="pmid">33326037</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa1029</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sim</surname><given-names>JJ</given-names></name><name><surname>Chan</surname><given-names>FM</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Meng Tan</surname><given-names>BH</given-names></name><name><surname>Mi Aung</surname><given-names>KM</given-names></name></person-group><article-title>Achieving gwas with homomorphic encryption</article-title><source>BMC medical genomics</source><year>2020</year><volume>13</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC7372823</pub-id><pub-id pub-id-type="pmid">32693823</pub-id><pub-id pub-id-type="doi">10.1186/s12920-020-0717-y</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strandén</surname><given-names>I</given-names></name><name><surname>Garrick</surname><given-names>DJ</given-names></name></person-group><article-title>Technical note: Derivation of equivalent computing algorithms for genomic predictions and reliabilities of animal merit</article-title><source>J Dairy Sci</source><year>2009</year><volume>92</volume><fpage>2971</fpage><lpage>2975</lpage><pub-id pub-id-type="pmid">19448030</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>VanRaden</surname><given-names>PM</given-names></name></person-group><article-title>Efficient methods to compute genomic predictions</article-title><source>Journal of dairy science</source><year>2008</year><volume>91</volume><fpage>4414</fpage><lpage>4423</lpage><pub-id pub-id-type="pmid">18946147</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vilhjálmsson</surname><given-names>BJ</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Finucane</surname><given-names>HK</given-names></name><name><surname>Gusev</surname><given-names>A</given-names></name><name><surname>Lind-ström</surname><given-names>S</given-names></name><etal/></person-group><article-title>Modeling linkage disequilibrium increases accuracy of polygenic risk scores</article-title><source>The american journal of human genetics</source><year>2015</year><volume>97</volume><fpage>576</fpage><lpage>592</lpage><pub-id pub-id-type="pmcid">PMC4596916</pub-id><pub-id pub-id-type="pmid">26430803</pub-id><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.09.001</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Misztal</surname><given-names>I</given-names></name><name><surname>Aguilar</surname><given-names>I</given-names></name><name><surname>Legarra</surname><given-names>A</given-names></name><name><surname>Muir</surname><given-names>W</given-names></name></person-group><article-title>Genome-wide association mapping including phenotypes from relatives without genotypes</article-title><source>Genetics Research</source><year>2012</year><volume>94</volume><fpage>7383</fpage><pub-id pub-id-type="pmid">22624567</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>Y-PP</given-names></name><name><surname>Bowman</surname><given-names>PJ</given-names></name><name><surname>Goddard</surname><given-names>ME</given-names></name><name><surname>Hayes</surname><given-names>BJ</given-names></name></person-group><article-title>A hybrid expectation maximisation and mcmc sampling algorithm to implement bayesian mixture model based genomic prediction and qtl mapping</article-title><source>BMC genomics</source><year>2016</year><volume>17</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC5031345</pub-id><pub-id pub-id-type="pmid">27654580</pub-id><pub-id pub-id-type="doi">10.1186/s12864-016-3082-7</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welter</surname><given-names>D</given-names></name><name><surname>MacArthur</surname><given-names>J</given-names></name><name><surname>Morales</surname><given-names>J</given-names></name><name><surname>Burdett</surname><given-names>T</given-names></name><name><surname>Hall</surname><given-names>P</given-names></name><etal/></person-group><article-title>The nhgri gwas catalog, a curated resource of snp-trait associations</article-title><source>Nucleic acids research</source><year>2014</year><volume>42</volume><fpage>D1001</fpage><lpage>D1006</lpage><pub-id pub-id-type="pmcid">PMC3965119</pub-id><pub-id pub-id-type="pmid">24316577</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkt1229</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werme</surname><given-names>J</given-names></name><name><surname>van der Sluis</surname><given-names>S</given-names></name><name><surname>Posthuma</surname><given-names>D</given-names></name><name><surname>de Leeuw</surname><given-names>CA</given-names></name></person-group><article-title>An integrated framework for local genetic correlation analysis</article-title><source>Nature genetics</source><year>2022</year><volume>54</volume><fpage>274</fpage><lpage>282</lpage><pub-id pub-id-type="pmid">35288712</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Ferreira</surname><given-names>T</given-names></name><name><surname>Morris</surname><given-names>AP</given-names></name><name><surname>Medland</surname><given-names>SE</given-names></name><name><surname>Madden</surname><given-names>PA</given-names></name><etal/></person-group><article-title>Conditional and joint multiple-snp analysis of gwas summary statistics identifies additional variants influencing complex traits</article-title><source>Nature genetics</source><year>2012</year><volume>44</volume><fpage>369</fpage><lpage>375</lpage><pub-id pub-id-type="pmcid">PMC3593158</pub-id><pub-id pub-id-type="pmid">22426310</pub-id><pub-id pub-id-type="doi">10.1038/ng.2213</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Vedantam</surname><given-names>S</given-names></name><name><surname>Marouli</surname><given-names>E</given-names></name><name><surname>Sidorenko</surname><given-names>J</given-names></name><name><surname>Bartell</surname><given-names>E</given-names></name><etal/></person-group><article-title>A saturated map of common genetic variants associated with human height</article-title><source>Nature</source><year>2022a</year><volume>610</volume><fpage>704</fpage><lpage>712</lpage><pub-id pub-id-type="pmcid">PMC9605867</pub-id><pub-id pub-id-type="pmid">36224396</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05275-y</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yengo</surname><given-names>L</given-names></name><name><surname>Vedantam</surname><given-names>S</given-names></name><name><surname>Marouli</surname><given-names>E</given-names></name><name><surname>Sidorenko</surname><given-names>J</given-names></name><name><surname>Bartell</surname><given-names>E</given-names></name><etal/></person-group><article-title>A saturated map of common genetic variants associated with human height from 5.4 million individuals of diverse ancestries</article-title><source>bioRxiv</source><year>2022b</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>Illustration of homomorphic encryption for genotypes and phenotypes. For 4 individuals (a-d), the raw genotypes for 6 SNPs and the raw phenotypes are provided in the upper part of the figure. The raw data are encrypted by pre-multiplying with a random orthogonal encryption matrix <bold>P</bold>, which is displayed in the middle of the figure. The encrypted phenotypes and genotypes, shown in the lower part of the figure, are "random" linear combinations of the raw phenotypes and genotypes of the original four individuals a-d.</p></caption><graphic xlink:href="EMS189531-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>(a) A subset of pig genotypes provided in the data set of <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref>. Genotypes are coded as 0, 1, and 2, which are presented by white, grey, and black colors, respectively. Each row represents one individual, and each column represents one marker. (b) The corresponding encrypted genotypes, encrypted via a high-dimension random orthogonal matrix. The encrypted genotypes are a continuum of real numbers presented by different colors. (c) Sorted genotypes of one marker, coded as 0/1/2 (left), and its trimodal distribution (right). (d) The corresponding encrypted genotypes (same order as in (c)) and their bell-shaped distribution.</p></caption><graphic xlink:href="EMS189531-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>(a) Linkage disequilibrium (LD) matrix calculated using raw genotypes (up), and encrypted genotypes (down). The LD matrix is preserved using encrypted data, and the correlation between the two LD matrices is 1.0. (b) Genomic relationship matrix (GRM) calculated using the raw genotypes (up), and encrypted genotypes (down). The GRM is scrambled using encrypted data, and the correlation between two GRM matrices is close to 0.</p></caption><graphic xlink:href="EMS189531-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Distribution of correlations between 50,436 pairs of plaintext and cyphertext genotypes using pig dataset in <xref ref-type="bibr" rid="R9">Cleveland <italic>et al</italic>. (2012)</xref> (<italic>n</italic> = 3534, <italic>p</italic> = 50, 436). The average correlation is less than 0.001.</p></caption><graphic xlink:href="EMS189531-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Results from one replicate in the simulation scenario with <italic>h</italic><sup>2</sup> = 0.3 and <italic>QTL</italic>% = 1%. Each dot represents a pair of results calculated from plaintext (x-axis) vs cyphertext (y-axis). The diagonal line was used for reference such that a dot close to this line represents similar estimates. (a) Comparison between estimated marker effects <inline-formula><mml:math id="M53"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M54"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (correlation=0.9971). (b) Comparison between estimated breeding values <inline-formula><mml:math id="M55"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M56"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (correlation=0.9997). The pig genotypes data was used (<bold>M</bold>). (c) Comparison between local genetic variances of 2,522 non-overlapped genomic windows (correlation=0.9983).</p></caption><graphic xlink:href="EMS189531-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p>The prediction accuracies of estimated breeding values for 500 individuals in a single data contributor. Each dot represents a pair of results calculated either using only this contributor’s data (x-axis) or using the joint data from all contributors (y-axis). Joint analyses had significantly higher accuracies than those using data from a single contributor (pairwise t-test <italic>P</italic>-value &lt; 0.0005).</p></caption><graphic xlink:href="EMS189531-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><p>Time to generate a random orthogonal matrix from the Stiefel manifold. The x-axis is the size of <bold>P</bold> matrix (i.e., number of individuals), and the y-axis is the computation time.</p></caption><graphic xlink:href="EMS189531-f007"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><p>Pearson correlations between estimated marker effects from plaintext vs ciphertext in different simulation scenarios. Each value is the averaged correlation from 10 replicates.</p></caption><table frame="box" rules="groups"><thead><tr><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" colspan="4"><italic>h</italic><sup>2</sup></th></tr><tr style="border-top: solid thin"><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top">0.1</th><th align="center" valign="top">0.3</th><th align="center" valign="top">0.5</th><th align="center" valign="top">0.7</th></tr></thead><tbody><tr><td align="center" valign="middle" rowspan="4" style="border-right: solid thin">QTL%</td><td align="center" valign="top" style="border-right: solid thin">1%</td><td align="center" valign="top">0.9937</td><td align="center" valign="top">0.9950</td><td align="center" valign="top">0.9957</td><td align="center" valign="top">0.9961</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">10%</td><td align="center" valign="top">0.9928</td><td align="center" valign="top">0.9927</td><td align="center" valign="top">0.9926</td><td align="center" valign="top">0.9928</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">50%</td><td align="center" valign="top">0.9898</td><td align="center" valign="top">0.9937</td><td align="center" valign="top">0.9916</td><td align="center" valign="top">0.9911</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">100%</td><td align="center" valign="top">0.9906</td><td align="center" valign="top">0.9932</td><td align="center" valign="top">0.9925</td><td align="center" valign="top">0.9920</td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><p>Person correlations between estimated breeding values (EBV) calculated using marker effects estimated from cyphertext <inline-formula><mml:math id="M57"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and EBV calculated using the marker effects estimated from plaintext <inline-formula><mml:math id="M58"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. Each value represents the average correlation across 10 replicates.</p></caption><table frame="box" rules="groups"><thead><tr><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" colspan="4"><italic>h</italic><sup>2</sup></th></tr><tr style="border-top: solid thin"><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top">0.1</th><th align="center" valign="top">0.3</th><th align="center" valign="top">0.5</th><th align="center" valign="top">0.7</th></tr></thead><tbody><tr><td align="center" valign="middle" rowspan="4" style="border-right: solid thin">QTL%</td><td align="center" valign="top" style="border-right: solid thin">1%</td><td align="center" valign="top">0.9993</td><td align="center" valign="top">0.9997</td><td align="center" valign="top">0.9998</td><td align="center" valign="top">0.9998</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">10%</td><td align="center" valign="top">0.9992</td><td align="center" valign="top">0.9996</td><td align="center" valign="top">0.9997</td><td align="center" valign="top">0.9997</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">50%</td><td align="center" valign="top">0.9992</td><td align="center" valign="top">0.9996</td><td align="center" valign="top">0.9997</td><td align="center" valign="top">0.9997</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">100%</td><td align="center" valign="top">0.9992</td><td align="center" valign="top">0.9995</td><td align="center" valign="top">0.9997</td><td align="center" valign="top">0.9997</td></tr></tbody></table></table-wrap><table-wrap id="T3" position="float" orientation="portrait"><label>Table 3</label><caption><title>Person correlations between local genetic variances of 2,522 non-overlapping genomic windows calculated from plaintext or cyphertext. Each value represents the average correlation from 10 replicates.</title></caption><table frame="box" rules="groups"><thead><tr><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" colspan="4"><italic>h</italic><sup>2</sup></th></tr><tr style="border-top: solid thin"><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top" style="border-right: solid thin"/><th align="center" valign="top">0.1</th><th align="center" valign="top">0.3</th><th align="center" valign="top">0.5</th><th align="center" valign="top">0.7</th></tr></thead><tbody><tr><td align="center" valign="middle" rowspan="4" style="border-right: solid thin">QTL%</td><td align="center" valign="top" style="border-right: solid thin">1%</td><td align="center" valign="top">0.9954</td><td align="center" valign="top">0.9950</td><td align="center" valign="top">0.9966</td><td align="center" valign="top">0.9968</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">10%</td><td align="center" valign="top">0.9895</td><td align="center" valign="top">0.9923</td><td align="center" valign="top">0.9929</td><td align="center" valign="top">0.9943</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">50%</td><td align="center" valign="top">0.9908</td><td align="center" valign="top">0.9946</td><td align="center" valign="top">0.9932</td><td align="center" valign="top">0.9924</td></tr><tr><td align="center" valign="top" style="border-right: solid thin">100%</td><td align="center" valign="top">0.9728</td><td align="center" valign="top">0.9934</td><td align="center" valign="top">0.9936</td><td align="center" valign="top">0.9933</td></tr></tbody></table></table-wrap></floats-group></article>