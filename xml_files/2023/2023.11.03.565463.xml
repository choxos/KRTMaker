<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS190624</article-id><article-id pub-id-type="doi">10.1101/2023.11.03.565463</article-id><article-id pub-id-type="archive">PPR753440</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Integrating single-cell RNA-seq datasets with substantial batch effects</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hrovatin</surname><given-names>Karin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Moinfar</surname><given-names>Amir Ali</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Zappia</surname><given-names>Luke</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Lapuerta</surname><given-names>Alejandro Tejada</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Lengerich</surname><given-names>Ben</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Kellis</surname><given-names>Manolis</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Theis</surname><given-names>Fabian J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institute of Computational Biology, Helmholtz Zentrum München, Neuherberg, Germany</aff><aff id="A2"><label>2</label>TUM School of Life Sciences Weihenstephan, Technical University of Munich, Freising, Germany</aff><aff id="A3"><label>3</label>Computer Science and Artificial Intelligence Lab, Massachusetts Institute of Technology, Cambridge, MA</aff><aff id="A4"><label>4</label>Broad Institute of MIT and Harvard, Cambridge, MA</aff><aff id="A5"><label>5</label>School of Computation, Information and Technology, Technical University of Munich, Garching, Germany</aff><author-notes><corresp id="CR1">
<label>*</label>Correspondence should be addressed to F.J.T.: <email>fabian.theis@helmholtz-muenchen.de</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>06</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>05</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Integration of single-cell RNA-sequencing (scRNA-seq) datasets has become a standard part of the analysis, with conditional variational autoencoders (cVAE) being among the most popular approaches. Increasingly, researchers are asking to map cells across challenging cases such as cross-organs, species, or organoids and primary tissue, as well as different scRNA-seq protocols, including single-cell and single-nuclei. Current computational methods struggle to harmonize datasets with such substantial differences, driven by technical or biological variation. Here, we propose to address these challenges for the popular cVAE-based approaches by introducing and comparing a series of regularization constraints.</p><p id="P2">The two commonly used strategies for increasing batch correction in cVAEs, that is Kullback–Leibler divergence (KL) regularization strength tuning and adversarial learning, suffer from substantial loss of biological information. Therefore, we adapt, implement, and assess alternative regularization strategies for cVAEs and investigate how they improve batch effect removal or better preserve biological variation, enabling us to propose an optimal cVAE-based integration strategy for complex systems. We show that using a VampPrior instead of the commonly used Gaussian prior not only improves the preservation of biological variation but also unexpectedly batch correction. Moreover, we show that our implementation of cycle-consistency loss leads to significantly better biological preservation than adversarial learning implemented in the previously proposed GLUE model. Additionally, we do not recommend relying only on the KL regularization strength tuning for increasing batch correction, as it removes both biological and batch information without discriminating between the two. Based on our findings, we propose a new model that combines VampPrior and cycle-consistency loss. We show that using it for datasets with substantial batch effects improves downstream interpretation of cell states and biological conditions. To ease the use of the newly proposed model, we make it available in the scvi-tools package as an external model named sysVI. Moreover, in the future, these regularization techniques could be added to other established cVAE-based models to improve the integration of datasets with substantial batch effects.</p></abstract><kwd-group><kwd>single-cell RNA sequencing (scRNA-seq)</kwd><kwd>data integration</kwd><kwd>VampPrior</kwd><kwd>latent cycle-consistency</kwd><kwd>KL regularization strength</kwd><kwd>adversarial learning</kwd><kwd>benchmarking</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P3">The joint analysis of multiple single-cell RNA sequencing (scRNA-seq) datasets has recently provided new insights that could not have been obtained from individual datasets. For example, pooling of datasets generated in different studies enabled cross-condition comparisons<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup>, population-level analysis<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref></sup>, and revealed evolutionary relationships between individual cell types5. The selection of pre-clinical models, such as organoids and animals, and the characterization of their limitations likewise rely on comparison with human tissues<sup><xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R14">14</xref></sup>. Similarly, the selection of the optimal sequencing protocols requires a comparison of datasets generated with different protocols<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>. Lastly, currently arising large-scale “atlases” that are posed to serve as references of cell biology are aimed to combine public datasets with substantial technical and biological variation, including multiple organs and developmental stages17. Overall, with the increasing number of publicly available scRNA-seq datasets18, the number of such cross-dataset analyses is also increasing.</p><p id="P4">These analyses can be complicated due to technical and biological differences between samples<sup><xref ref-type="bibr" rid="R19">19</xref>–<xref ref-type="bibr" rid="R21">21</xref></sup>. To overcome this, computational methods for single-cell specific data integration have been developed<sup><xref ref-type="bibr" rid="R22">22</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup> and previous benchmarks have evaluated their integration performance generally<sup><xref ref-type="bibr" rid="R20">20</xref></sup> and on cross-species datasets specifically<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. Among the most popular and best-performing methods are conditional variational autoencoder (cVAE) based models, which are able to correct non-linear batch effects, are flexible in the choice of batch covariates, and are particularly scalable to large datasets<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup>. Thus, they are also a method of choice for single-cell atlases<sup><xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>. However, while cVAE-based and other non-deep-learning methods enable good integration of batch effects caused by processing similar samples in different laboratories, they do not enable sufficient integration when differences between datasets are more substantial due to datasets originating from distinct biological or technical “systems”, such as multiple species or sequencing technologies (e.g. cell-nuclei)<sup><xref ref-type="bibr" rid="R19">19</xref>–<xref ref-type="bibr" rid="R21">21</xref></sup> (<xref ref-type="fig" rid="F1">Figure 1a,b</xref>), as demonstrated later. To enable more comprehensive single-cell atlasing efforts that will integrate diverse samples with stronger batch effects, it is thus vital to further improve the performance of the commonly used cVAE-based integration models.</p><p id="P5">Increased batch integration can be achieved via multiple extensions of cVAE models, including Kullback–Leibler divergence (KL) regularization strength tuning<sup><xref ref-type="bibr" rid="R26">26</xref></sup>, batch distributions alignment approaches<sup><xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R29">29</xref></sup> (with latent space adversarial learning<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref></sup> being the prime example), and latent space cycle-consistency that was previously only used for multi-omic integration in combination with adversarial learning<sup><xref ref-type="bibr" rid="R33">33</xref>–<xref ref-type="bibr" rid="R35">35</xref></sup> (<xref ref-type="fig" rid="F1">Figure 1d</xref>). For increasing biological preservation in scRNA-seq representation learning without supervision, we previously proposed the use of the multimodal variational mixture of posteriors (VampPrior)<sup><xref ref-type="bibr" rid="R36">36</xref></sup> as the prior for the latent space (<xref ref-type="fig" rid="F1">Figure 1d</xref>) in a workshop paper<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, but this extension has not been explored in integration models. While cycle consistency and the VampPrior have been previously applied to single-cell data, it is unclear what their strengths and weaknesses are for integration and how they compare when used under different data scenarios.</p><p id="P6">Here, we explore the shortcomings of popular cVAE-based integration strategies, namely KL regularization tuning and adversarial learning, and show how these can be overcome by using cycle-consistency loss and the VampPrior. We systematically evaluate batch correction and biological preservation on cell type and sub-cell type levels, with existing<sup><xref ref-type="bibr" rid="R20">20</xref></sup> metrics and a newly proposed metric for assessing within-cell-type variation. We study these across three scenarios with substantial batch effects: cross-species, organoid-tissue, and cell-nuclei. In short, we find that the combination of the VampPrior and cycle-consistency (VAMP+CYC model) improves batch correction while retaining high biological preservation, making VAMP+CYC the method of choice for integrating datasets with substantial batch effects. The VAMP+CYC model also empowers post-integration analysis of cell states and biological conditions. Our model is easily accessible to the community as part of the sciv-tools package<sup><xref ref-type="bibr" rid="R38">38</xref></sup> under the name sysVI, short for “integration of diverse <underline>sys</underline>tems with <underline>v</underline>ariational <underline>i</underline>nference”, and the here-proposed strategies could be likewise easily added to other cVAE-based integration methods.</p></sec><sec id="S2" sec-type="results"><title>Results</title><p id="P7">We explored shortcomings of existing methods for integrating substantial batch effects and subsequently developed an improved method to suit diverse use cases. We selected multiple datasets where batch effects are more substantial than what is commonly observed between samples within a dataset or between similar datasets generated in different laboratories (<xref ref-type="fig" rid="F1">Figure 1a,c</xref>). This includes three between-system data use cases: organoids (N samples = 21, N cells = 43,505) and adult human tissue samples (N samples = 20, N cells = 54,491) of the retina (organoid-tissue), scRNA-seq (N samples = 9, N cells = 28,465) and single-nuclei RNA-seq (snRNA-seq) (N samples = 9, N nuclei = 57,599) from subcutaneous adipose tissue (cell-nuclei), and mouse (N datasets = 8, N samples = 52, N cells = 263,140) and human (N samples = 65, N cells = 192,203) pancreatic islets (mouse-human). We confirmed that in all three data cases, the per-cell type distances between samples on non-integrated data are significantly smaller within systems, both within and between datasets, than between systems (<xref ref-type="fig" rid="F1">Figure 1c</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S1</xref>).</p><sec id="S3"><title>Existing methods struggle with the loss of biological information when increasing batch correction</title><p id="P8">Tuning of KL regularization strength is the most widely adopted approach for tuning batch correction strength as it is part of the standard cVAE architecture. It regulates how much the cell embeddings may deviate from the standard Gaussian distribution. By definition, KL regularization does not distinguish between biological and batch information, jointly removing both of them. To assess this, we measured batch correction via graph integration local inverse Simpson’s index (iLISI)<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, which evaluates batch composition in the local neighborhoods of individual cells, and cell-type level biological preservation with a modified version of normalized mutual information (NMI)<sup><xref ref-type="bibr" rid="R20">20</xref></sup> metric, which compares clusters from a single clustering resolution (NMI fixed) to grounded-truth annotation. Indeed, increased KL regularization strength led to higher batch correction and lower biological preservation (<xref ref-type="fig" rid="F2">Figure 2a</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). In particular, we observed that increased KL regularization strength led to some latent dimensions being set close to zero in all cells, resulting in information loss (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S2</xref>). Thus, the higher batch correction score is simply a consequence of fewer embedding dimensions that were effectively used in downstream analyses. This was reflected by standard scaling of individual embedding features resulting in the loss of KL regularization-induced changes in integration scores in all three data use cases (<xref ref-type="fig" rid="F2">Figure 2a</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S3, Supplementary Note S1</xref>). In particular, on the scaled data higher KL regularization strength did not lead to increased batch correction or reduced biological preservation. Thus, KL weight is not a favorable approach for removing batch effects as it removes both biological and batch variation without discrimination.</p><p id="P9">The most popular cVAE extensions for actively pushing together cells from different batches are based on batch distribution alignment<sup><xref ref-type="bibr" rid="R27">27</xref>–<xref ref-type="bibr" rid="R29">29</xref></sup>, especially adversarial learning<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref>,<xref ref-type="bibr" rid="R39">39</xref>,<xref ref-type="bibr" rid="R40">40</xref></sup>. However, these approaches are prone to mix embeddings of unrelated cell types with unbalanced proportions across batches. Namely, if we want to achieve indistinguishability of batches in the latent space, a cell type underrepresented in one of the systems must be mixed with a cell type present in the second system<sup><xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. We show this with an existing single-cell integration model that leverages adversarial learning, called GLUE<sup><xref ref-type="bibr" rid="R30">30</xref></sup>, for which it was previously shown to be among the best integration models<sup><xref ref-type="bibr" rid="R41">41</xref></sup>. This behavior was present in all three datasets, especially when increasing batch correction strength. For example, we observed mixing of delta, acinar, and immune cells in the mouse-human pancreatic dataset; astrocytes with Mueller cells in the organoid-tissue retinal dataset; and adipocyte and ASPC cells in cell-nuclei adipose dataset (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5, Supplementary Figure S6</xref>). In contrast, these cells could be easily separated by our baseline cVAE implementation (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5</xref>). To address this issue, the authors of the GLUE method aimed to improve the adversarial loss objective by down-weighting the contribution of cells from unbalanced populations. However, this requires prior population identity knowledge, which is in GLUE initialized by a preliminary integration round. Our results show that this strategy does not guarantee good integration performance, which may be explained by biases introduced through imperfect cell cluster prior information. Therefore, adversarial learning may be problematic as a general integration strategy as datasets often have unbalanced cell population proportions due to biological differences or differences in technical protocol capture<sup><xref ref-type="bibr" rid="R42">42</xref>,<xref ref-type="bibr" rid="R43">43</xref></sup>.</p></sec><sec id="S4"><title>Multimodal priors and cycle-consistency for better integration</title><p id="P10">To tackle the two above-mentioned challenges of existing methods, that is the joint removal of batch and biological variation and mixing of cell populations with unbalanced proportions across systems, we propose to adapt the prior regularization of the cVAE model and add additional batch correction constraints to the general loss. In particular, we selected the VampPrior<sup><xref ref-type="bibr" rid="R36">36</xref></sup> and latent cycle-consistency loss<sup><xref ref-type="bibr" rid="R44">44</xref></sup>, as they are able to better preserve biological variation.</p><p id="P11">The VampPrior was initially proposed as an alternative to standard Gaussian prior for generating more expressive latent representations due to the use of multiple prior components<sup><xref ref-type="bibr" rid="R36">36</xref></sup> (see methods and <xref ref-type="fig" rid="F1">Figure 1d</xref>). It was previously shown that this also applies to single-cell data<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, where it increases biological preservation, similar to other flexible priors, such as Gaussian mixtures (GM)<sup><xref ref-type="bibr" rid="R45">45</xref>–<xref ref-type="bibr" rid="R47">47</xref></sup>. Therefore, we here tested whether the VampPrior could be used to achieve a better batch correction and biological preservation tradeoff compared to a cVAE with standard Gaussian prior. We observed that while biological preservation was relatively similar in both models, the model with the VampPrior (VAMP model) had much higher batch correction performance (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). As the VampPrior has not previously been used for batch effect removal, we investigated the cause of improved batch correction. We explored the relationship between individual prior components and cell metadata. We assigned individual cells into groups based on the prior component with the highest support for each cell and assessed whether this led to the grouping of cells by either cell types or systems. Prior component groups corresponded more strongly to cell type identity than systems (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S7</xref>). This suggests that in contrast to the standard Gaussian prior that attracts cells from different systems and different cell types, using multiple priors allows individual prior components to attract cells from only a subset of cell types that nevertheless originate from both systems, which could explain the improved batch correction at a similar biological preservation score.</p><p id="P12">To test if batch correction is improved due to the multimodal nature of the VampPrior or its other properties, we compared to a VampPrior model with only one prior component that resembles a normal cVAE, but in contrast to cVAE the prior parameters are learned, and a GM prior model (GMM) as a simpler multimodal prior alternative where prior and posterior distributions are not coupled. We also tested if trainable prior components are key for integration by fixing prior component parameters and inspected if the identity of cells used for pseudoinputs initialization affects the performance.</p><p id="P13">Across integration data use cases, we find that the batch correction was lower when using only one prior component, compared to two or more for both the VAMP and GMM models (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S8</xref>), with the one-component version being more similar to cVAE with standard normal prior (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). However, the performance of GMM, but not VAMP, dropped again at very high prior component numbers (N=5000). Therefore, even a relatively small number of prior components (e.g. five) enables good integration while keeping the number of model parameters low. Fixing of prior components had little effect on VAMP performance (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S8, Supplementary Note S2</xref>) and likewise, the initialization of prior components with cells from a single cell type or system did not affect performance (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S9, Supplementary Note S2</xref>). This indicates that the number of prior components is key for improved batch correction. Nevertheless, VAMP outperformed GMM both in the achieved batch correction as well as in the robustness to a varying number of prior components, underlining the importance of coupling the prior and the posterior.</p><p id="P14">We propose latent cycle-consistency loss as an alternative to adversarial learning. The cycle-consistency loss directly compares only cells with an identical biological background, that is a cell and its counterfactual representation from another system (<xref ref-type="fig" rid="F1">Figure 1d</xref>). Thus, biologically distinct cell populations are not forced to overlap, unlike in models that aim to align whole system distributions in a cell identity-agnostic manner. While previous publications already used cycle-consistency for integration across modalities (e.g. scRNA-seq and scATAC-seq)<sup><xref ref-type="bibr" rid="R33">33</xref>,<xref ref-type="bibr" rid="R35">35</xref></sup>, they always combined it with adversarial learning, thus overlooking the potential benefits of using cycle-consistency alone.</p><p id="P15">We validated our hypothesis about cycle-consistency outperforming adversarial learning in the presence of cell populations with unbalanced proportions across systems by implementing a cVAE model with added cycle-consistency loss (CYC model) and comparing it to adversarial model GLUE. For both models, we gradually increased the weight of the loss responsible for batch correction and measured cell type preservation by comparing prior annotation and post-integration clusters with the Jaccard index. When increasing batch correction strength, we observed multiple cell types whose clusters had a lower Jaccard index in the GLUE than the CYC model, thus being merged with other cell types in GLUE (<xref ref-type="fig" rid="F4">Figure 4</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5, Supplementary Figure S6</xref>). Examples are acinar cells mixed with immune cells in mouse-human data, which are not biologically related, adipocytes mixed with adipose stem and progenitor cells (ASPC) in cell-nuclei data, and two glial populations (astrocytes and Mueller cells) in organoid-tissue data. However, some cell types were hard to distinguish for both models, regardless of integration strength. In the mouse-human data, these corresponded to technical doublets, which can be explained by their similarity to individual contributing cell types. Similarly, in the cell-nuclei data neutrophils co-localized with monocytes, likely due to their biological similarity, with both of them being immune cells (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5</xref>). Therefore, none of the models exhibited perfect cell type resolution based on the Jaccard index metric, which is expected as highly similar cell types often require more detailed analysis, including subclustering, for their annotation<sup><xref ref-type="bibr" rid="R48">48</xref></sup>. Nevertheless, the CYC model was less prone to mix both related and unrelated cell types than GLUE.</p></sec><sec id="S5"><title>Integration with the VampPrior and cycle-consistency offers a good tradeoff between batch correction and biological preservation</title><p id="P16">Our analysis showed that both the VampPrior and latent cycle-consistency loss improved integration performance. Moreover, both approaches are complementary, with VampPrior providing a more expressive latent space than standard Gaussian prior and cycle-consistency loss pushing together batches without incurring cell population mixing in contrast to adversarial learning. Therefore, we propose a new integration approach that combines the two (VAMP+CYC, <xref ref-type="fig" rid="F5">Figure 5c</xref>).</p><p id="P17">We compared VAMP+CYC against ablated versions VAMP and CYC, a cVAE baseline, and two established models: scVI<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, which is a cVAE-based model that models raw expression counts and is among the most popular integration methods, and GLUE, which is an example of a model that uses adversarial learning. We tuned model hyperparameters that directly regulate batch correction, as described in the methods. Every model was run three times with different random seeds to capture random variation in model performance. To complement our integration evaluation via iLISI and NMI, we proposed an additional metric, Moran’s I, aimed to assess fine biological preservation on the sub-cell-type level via preservation of gene expression patterns after integration. Evaluating the fine variation is of special importance as many downstream questions rely on within-cell-type population shifts that arise due to different biological conditions, such as in health and disease.</p><p id="P18">As hypothesized above, the standard cVAE-based models and the model with adversarial loss could not achieve a good tradeoff between batch correction and biological preservation. The baseline cVAE model had poor batch correction across all tested datasets (<xref ref-type="fig" rid="F5">Figure 5a</xref>), in comparison to other models (adjusted p-value &lt; 0.1 for most comparisons against VAMP+CYC, CYC, VAMP, and GLUE, <xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>), and the systems were clearly visually separated on the UMAP (<xref ref-type="fig" rid="F5">Figure 5b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5</xref>), indicating that it alone is unsuitable for integrating substantial batch effects. In comparison, the cVAE-based model scVI<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, which is regarded as a state-of-the-art model for scRNA-seq integration<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, consistently had excellent biological preservation (<xref ref-type="fig" rid="F5">Figure 5a</xref>), in many cases significantly higher than other models (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). However, it had a relatively low batch correction compared to other models, including VAMP+CYC, CYC, VAMP, and GLUE (<xref ref-type="fig" rid="F5">Figure 5a</xref>), especially in the mouse-human and organoid-tissue datasets that were harder to integrate than the cell-nuclei dataset due to more substantial batch effects (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S10</xref>). GLUE had the highest batch correction overall (<xref ref-type="fig" rid="F5">Figure 5a</xref>), which was in most cases significantly higher than other models (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>), and it also had comparable cell type preservation (NMI) to other models in most cases. However, as described above, it led to the mixing of unrelated cell types. It also had lower performance on finer within-cell type variation (Moran’s I) (<xref ref-type="fig" rid="F5">Figure 5a</xref>), which was in all cases significantly lower than other models, except for the below-described SATURN model (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). As we saw at the cell type level, poor preservation of within-cell-type variation can be explained by the mixing of cell states with unbalanced proportions across systems. Thus, it is likely that the high batch correction of GLUE is not biologically meaningful as it comes at the cost of mixing unrelated cell populations. Integration with adversarial learning is thus less suited for downstream cell state analyses.</p><p id="P19">In contrast, the VAMP+CYC model, as well as CYC and VAMP models, were able to achieve a better tradeoff between the three integration metrics (<xref ref-type="fig" rid="F5">Figure 5a</xref>) and had across data use cases similar performance characteristics in relation to hyperparameter settings (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). They consistently outperformed the base cVAE in batch correction (adjusted p-values &lt; 0.1 in most comparisons, <xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>) while retaining similar biological preservation. The VAMP+CYC model was able to achieve higher batch correction at comparable biological preservation than the individual CYC and VAMP models (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). Namely, the selected VAMP+CYC model had significantly higher batch correction than the two ablated models in the mouse-human and cell-nuclei datasets (<xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). In comparison to GLUE, the VAMP+CYC model showed lower batch correction but had higher fine biological preservation (<xref ref-type="fig" rid="F5">Figure 5a</xref>) and was not prone to mixing of cell types with different proportions across systems, as described above. Thus, the VAMP+CYC model is better balanced than GLUE as it has relatively good performance in both biological preservation and batch correction. Overall, these results recommend the VAMP+CYC model as the method of choice.</p></sec><sec id="S6"><title>Models specific for cross-species integration do not outperform VAMP+CYC</title><p id="P20">As one of our use cases was cross-species integration, which is complicated by different gene sets across species, we further assessed models that accept different input genes across systems, namely GLUE and SATURN<sup><xref ref-type="bibr" rid="R49">49</xref></sup>, an example of a model designed specifically for cross-species integration. We ran both models with one-to-one orthologues (OTO) as well as with a flexible orthology (FO) gene set that included different types of orthologues and non-orthologous genes. Integration with FO input genes did not outperform the OTO approach in either GLUE or SATURN (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>). Furthermore, despite SATURN using protein embeddings to improve gene linking across species, it had significantly lower batch correction than either VAMP+CYC or GLUE (<xref ref-type="fig" rid="F5">Figure 5a</xref>, adjusted p-values &lt; 0.05, <xref ref-type="supplementary-material" rid="SD2">Supplementary Table S2</xref>). Overall, this indicates that a more advanced gene mapping may not be needed for mouse-human integration, as VAMP+CYC was able to outperform even dedicated cross-species integration methods. However, for more divergent species or species with lower-quality genome annotation and orthology information, using FO genes could still be beneficial<sup><xref ref-type="bibr" rid="R19">19</xref></sup>.</p><p id="P21">As SATURN requires prior cell type labels for every system, we ran it with clustering-based labels to make it comparable to other models that are likewise not given prior cell type information, which is in practice often not available. Besides that, we also added a version with ground-truth cell type labels (SATURN-CT). However, using ground-truth labels may lead to a positive bias in the NMI metric. Both SATURN and SATURN-CT performed poorly in biological preservation, with SATURN-CT having a bias towards higher NMI scores while retaining low Moran’s I (<xref ref-type="fig" rid="F5">Figure 5a</xref>). The poor preservation of within-cell-type structure was also evident from UMAPs. For example, the numerous immune subclusters observed on the VAMP+CYC embedding were not present after integration with SATURN and SATURN-CT (<xref ref-type="fig" rid="F5">Figure 5b</xref>). The poor biological preservation can be explained by over-reliance on prior cell cluster labels in the contrastive learning objective, which pushes all cells with the same label together, thus neglecting within-cell-type variation (<xref ref-type="supplementary-material" rid="SD3">Supplementary Note S3</xref>).</p></sec><sec id="S7"><title>High-quality integration is key for downstream biological interpretation</title><p id="P22">To ensure that a model is of good quality, it must not only have relatively high integration metrics, but it must also be able to provide meaningful biological interpretations. Therefore, we used the integrated embeddings of the evaluated methods for multiple downstream tasks, including cross-system comparison of cell types and conditions as well as the discovery of molecular heterogeneity within individual cell types.</p><p id="P23">Direct comparison of systems on the integrated embedding requires striking a balance between under and over-integration, that is, to align only biologically related, but not biologically distinct cells. To achieve this, the model’s objective must also reflect this balance by jointly optimizing batch correction and biological preservation (<xref ref-type="supplementary-material" rid="SD3">Supplementary Note S4</xref>). Here, we assess how well models achieve this balance by inspecting individual cases where systems should, in fact, not be completely integrated due to biological differences. We saw that all evaluated models correctly separated retinal pigment epithelial cells between organoid and tissue data7 (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5a</xref>). We assessed the preservation of finer cross-system biological differences on the example of Mueller cells, for which it was reported that <italic>RHCG</italic>-expressing fovea cells from primary tissue are distinct from the tissue periphery and organoid cells7. This more subtle biological variation was lost in some models, such as GLUE, leading to the co-localization of cells from all three populations (<xref ref-type="fig" rid="F6">Figure 6a</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S11</xref>). In contrast, VAMP+CYC correctly aligned Mueller cells from tissue periphery and organoid samples while separating cells from tissue fovea samples. This indicates its ability to correctly account for biological differences across systems during integration, making it better suited for comparative studies.</p><p id="P24">Another important characteristic of integration is to preserve within-sample variation, which is not related to batch effects. This is key for studying different cell states that arise due to cell specialization or spatial niches. We examined this on pancreatic beta cells, for which within-sample heterogeneity in the expression of multiple gene programs has been previously reported1. This heterogeneity was much better preserved by VAMP+CYC than GLUE (<xref ref-type="fig" rid="F6">Figure 6b</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S12c</xref>) and was similar to the heterogeneity observed in the non-integrated data. Therefore, VAMP+CYC has low information loss during integration, empowering post-integration analysis.</p></sec></sec><sec id="S8"><title>Discussion and outlook</title><p id="P25">In order to improve the integration of scRNA-seq datasets, in particular in the presence of substantial batch effects such as different protocols, species, or <italic>in vitro</italic> vs <italic>in vivo</italic>, we explored the shortcomings of commonly used cVAE-based approaches for increasing bath correction, namely KL regularization strength and adversarial learning. Both of these models struggled with retaining sufficient biological information when increasing batch correction. To overcome these challenges, we proposed the use of the VampPrior and latent cycle-consistency loss. We performed evaluation in three data scenarios (cross-species, organoid-tissue, and cell-nuclei) and observed consistent model performance characteristics and failure modes, enabling us to make recommendations regarding individual models. We found that our model, which combines the VampPrior and cycle-consistency loss, had an overall good performance in both batch correction and biological preservation as well as enabled truthful interpretation of the integrated embedding, making it our method of choice. To make this model easily accessible to the community, we also implemented it in scvi-tools under the name sysVI.</p><p id="P26">Based on the findings presented in this work, there are multiple directions of cross-system integration that could be further explored. The VampPrior and cycle-consistency loss could be easily added to other cVAE-based integration tools. Therefore, we urge the method-development community to switch from using batch distribution-matching techniques, such as adversarial learning, to cycle-consistency-based approaches and to replace the standard Gaussian prior with the VampPrior. Combining these approaches with other cVAE extensions may contribute towards achieving the goal of holistic whole-organism and cross-species atlases. The flexibility of the VampPrior holds promise for representation learning on complex datasets with diverse cell types and the cycle-consistency loss further improves the removal of substantial batch effects present in such datasets. To achieve population-wide integration, these two approaches could be combined with scPoli<sup><xref ref-type="bibr" rid="R50">50</xref></sup>, which enables integration of a large number of batches via learning individual batch embeddings rather than relying on the commonly used one-hot encoding. As a step towards this goal, we included batch embedding in our implementation of sysVI. Furthermore, we here focused on integration strategies that do not require any prior cell type annotation, which is often not available and may lead to biases. Nevertheless, supervised label-aware integration methods such as scANVI<sup><xref ref-type="bibr" rid="R51">51</xref></sup>, may outperform non-supervised models<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. Thus, future work could explore the combination of different prior-knowledge-based strategies with the unsupervised techniques proposed here. Additionally, while we heere did not observe a benefit in more complex orthologue mapping for cross-species integration, this may be of greater importance when integrating more evolutionary divergent species. Thus, future work could explore the effect of different gene mapping strategies, both as part of data preprocessing<sup><xref ref-type="bibr" rid="R19">19</xref></sup> as well as in the model internally, such as by enabling flexible gene relationships<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup> or using gene embeddings<sup><xref ref-type="bibr" rid="R49">49</xref>,<xref ref-type="bibr" rid="R52">52</xref></sup>.</p><p id="P27">One unexpected finding of this work was that the VampPrior led not only to improved biological preservation, as would be expected, but also to increased batch correction. A similar effect was also observed when using a simpler GM prior. However, the VampPrior showed overall better performance and higher robustness to varying numbers of prior components. Further work will be needed to fully understand the mechanisms of this phenomenon. These results may not only have applications for scRNA-seq integration but also in other domains using cVAE models for covariate effect removal.</p><p id="P28">While we have shown that VAMP+CYC model enables good cross-system integration in comparison to existing methods, it is not obvious which combination of data analysis decisions will lead to optimal performance and whether integration is the ideal approach at all. For example, here we have focused on evaluating different model architectures but did not analyze alternative data preprocessing decisions that may affect the final result, such as the approach used for selecting features across systems. While previous work assessed some preprocessing options<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref></sup>, it is unclear if the findings translate to all cross-system data use cases, which can make different assumptions about relationships between systems and their features. Moreover, while our results show that the optimal hyperparameter ranges are relatively similar across data use cases, the preferred setting will depend on the downstream application at hand. For example, annotation transfer across systems would benefit from stronger batch correction, while comparative analysis of systems may require preserving more biological differences in order to assess their true similarity. Furthermore, the coarse biological preservation metric we used (NMI) relies on matching cell type annotation across systems. However, as shown above, sometimes cell types with the same name in different systems are, in fact, biologically distinct and should thus not be aligned, leading to biases in metric interpretation. Instead, one cold use simulated data for evaluation. However, as simulations often cannot fully encompass the complexity of the real data they are likewise not an optimal solution. Therefore, the community would highly benefit from standard benchmarking datasets where proper alignment is more carefully studied, reducing biases in integration evaluation.</p><p id="P29">While integration eases cross-system comparisons, there are also arguments against performing integration. For example, how strongly to integrate depends on downstream applications and is commonly assessed based on assumptions about the correct system alignment. Therefore, since the final integration is biased toward analysts’ expectations, it may not represent the biological ground truth. The integration also always removes some biological information. This is especially problematic if the integrated systems have substantial biological differences, as much of the biological variation would be lost to enable system alignment. One such example could be the integration of early-stage organoids with adult human tissue, as it is likely that the overlaps between biological functions of cell populations are minimal. In this case, per-system analysis followed by between-system comparison may be preferred. Lastly, recently emerging foundation models claim to obtain batch-free representations of cells via training on a large number of diverse datasets<sup><xref ref-type="bibr" rid="R53">53</xref>,<xref ref-type="bibr" rid="R54">54</xref></sup>, potentially removing the need for future data-use-case-specific integrations. However, as optimal integration strength often depends on the application, it is unlikely that one-size-fits-all models will be able to fully replace data-specific integration. Data-specific tuning of foundation models could improve performance, however this is computationally expensive due to the large number of parameters. Therefore, classical integration models are likely to remain of importance in the foreseeable future.</p><p id="P30">In conclusion, we proposed an improved strategy for integrating datasets with substantial batch effects that combines a cVAE model with VampPrior and cycle consistency loss. This will ease comparative analyses across a wide spectrum of biological questions, thus better leveraging available scRNA-seq datasets.</p></sec><sec id="S9" sec-type="methods"><title>Methods</title><sec id="S10"><title>Overview of cVAE-based integration approaches</title><p id="P31">In this study we focused on cVAE-based integration approaches and their extensions that improve integration by modifying the VAE objective (<xref ref-type="fig" rid="F1">Figure 1d</xref>). Here we provide a brief description of these methods.</p><p id="P32">In cVAE models, the encoder (<italic>E<sub>ϕ</sub></italic>) embeds cell expression (<italic>x</italic>) and batch information (<italic>c</italic>), into a batch-effect corrected latent representation (<italic>z</italic>). Then, a decoder (<italic>G<sub>θ</sub></italic>) reconstructs the expression based on latent representation and batch information. Two opposing losses are used to train the model (combined as <italic>L<sub>cVAE(θ,ϕ))</sub></italic>, the expression reconstruction loss that promotes information preservation during encoding and decoding and <italic>KL</italic> loss-based regularization of latent space that encourages information compression towards a Gaussian prior distribution. <disp-formula id="FD1"><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mo>𝔼</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>~</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>∣</mml:mo><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><sec id="S11"><title>Tuning of KL regularization strength in cVAEs</title><p id="P33">The most straightforward approach for increasing batch correction strength is using a higher <italic>KL</italic> regularization loss weight. This leads to lower preservation of information within the latent space, as it pushes samples’ latent representations towards the Gaussian prior distribution. The information is removed not only for technical or batch variation, which is desired, but as a side effect also for biological variation<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. To enable good initialization of biological representation the KL regularization loss weight can be gradually increased during training via annealing, as done in scvi-tools<sup><xref ref-type="bibr" rid="R38">38</xref></sup>.</p></sec><sec id="S12"><title>Adversarial loss</title><p id="P34">Multiple approaches have been proposed for promoting indistinguishability of latent distributions across batches, such as maximum mean discrepancy<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R55">55</xref></sup>, contrastive mixture of posteriors misalignment penalty<sup><xref ref-type="bibr" rid="R28">28</xref></sup>, and disentanglement of batch and biology-related latent components<sup><xref ref-type="bibr" rid="R29">29</xref></sup>. We here chose adversarial learning as an example due to its popularity in the single-cell community<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref></sup>. The adversarial classification loss (<italic>L<sub>ADV</sub></italic>) can be added to the <italic>L<sub>cVAE</sub></italic> objective to promote indistinguishability of latent embeddings from different batches, with the number of batches <italic>K</italic><sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref></sup>. For this, a discriminator (<italic>D<sub>k,ψ</sub></italic>) is added, which is trained by minimizing classification loss (<italic>L<sub>ADV</sub></italic>), while the encoder of the cVAE is trained by maximizing <italic>L<sub>ADV</sub></italic>, opposing the discriminator’s ability to distinguish between batches. <disp-formula id="FD2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>~</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.2em"/><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>;</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec><sec id="S13"><title>Cycle-consistency loss</title><p id="P35">Latent space cycle-consistency is an alternative to adversarial learning that works by pushing together the latent representation of matched cells from two batches. Cell <italic>x<sub>i</sub></italic> belonging to the batch <italic>i</italic> is encoded into a latent representation <italic>z<sub>i</sub></italic>. That latent representation is then decoded with batch covariate <italic>j</italic> into the cell <italic>x′<sub>j</sub></italic>, which represents the cell <italic>x<sub>i</sub></italic> as if it originated from the batch <italic>j</italic>. The cell <italic>x′<sub>j</sub></italic> is encoded into the latent representation <italic>z′<sub>j</sub></italic>. Finally, the model penalizes the distance between the original representation <italic>z′<sub>j</sub></italic> and the cycle-generated Zy via an additional loss component (<italic>L<sub>cyc</sub></italic>). Here, different distance minimization losses can be applied, with our choice being the mean squared error (MSE) on standardized data. <disp-formula id="FD3"><mml:math id="M3"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>Y</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>~</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></sec><sec id="S14"><title>The VampPrior</title><p id="P36">The VampPrior replaces the unimodal Gaussian prior <italic>p<sub>θ</sub></italic>(<italic>z</italic>) with a mixture of trainable Gaussian prior components (with the number of components <italic>L</italic>), giving it more representation flexibility. Their prior parameters are not defined in the latent space, as is usually done in cVAEs, but rather in the input cell space as “pseudoinputs” (<italic>xpi<sub>l</sub></italic>), which are passed through the encoder to obtain latent representations (mean, variance) used to parametrize the Gaussian components of the prior distribution. This thus directly couples the prior and the posterior. Additionally, the weights (<italic>w</italic>) of the prior components are likewise learned<sup><xref ref-type="bibr" rid="R36">36</xref>–<xref ref-type="bibr" rid="R56">56</xref></sup>. <disp-formula id="FD4"><mml:math id="M4"><mml:msub><mml:mi>p</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S15"><title>Cell type supervision</title><p id="P37">Another strategy that was previously proposed for improving integration uses prior information about cell type labels for supervised training, thus improving cell type cluster separation. Two main approaches for cell type supervision are contrastive training, where cells from the same cell type are pushed together and cells from different cell types may be pushed apart<sup><xref ref-type="bibr" rid="R49">49</xref>,<xref ref-type="bibr" rid="R50">50</xref></sup>, and classification loss, which ensures that latent space enables good cell type classification performance<sup><xref ref-type="bibr" rid="R51">51</xref></sup>. Moreover, other approaches were also proposed, such as constraining the cVAE’s prior distribution with prior knowledge about cell types<sup><xref ref-type="bibr" rid="R57">57</xref></sup>. While in some cases cell type labels can be replaced by unsupervised cell clusters<sup><xref ref-type="bibr" rid="R49">49</xref></sup>, supervised learning nevertheless depends on the prior information being of high quality. When this is not the case serious integration mistakes may occur, as described above for SATURN. Therefore, supervised approaches are not well suited for new data without annotation. For this reason, we did not focus on cell population supervision in our method comparison.</p></sec><sec id="S16"><title>Data preprocessing</title><p id="P38">Data for each of the three use cases was prepared separately as described below. For the mouse-human data, we used pancreatic islet datasets of mouse<sup><xref ref-type="bibr" rid="R1">1</xref></sup> (without embryonic and low-quality cells) and human<sup><xref ref-type="bibr" rid="R58">58</xref></sup>, for the organoid-tissue scenario we used a retinal dataset<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, and for the cell-nuclei scenario we used adipose dataset<sup><xref ref-type="bibr" rid="R59">59</xref></sup> (using the SAT fat type). We obtained published count data and cell annotation for all datasets (see <italic>Data availability</italic> section) and removed unannotated cells. Where necessary we manually curated cell population names to match across studies used within individual integration settings. In each system, we kept genes expressed in more than 20 cells, and in the mouse-human OTO setting we also only kept OTO genes, while in the FO setting, we removed genes without unique gene symbols (required for SATURN). Data was normalized with Scanpy <italic>normalize_total</italic> and log-transformed, and 3000 HVGs (4000 HVGs for organoid-tissue) were selected per system, keeping the union of HVGs across systems, similarly as proposed before<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. For GLUE we computed a non-integrated principal component analysis (PCA) per system on scaled data using 15 principal components (PCs) and for SATURN we used this data to compute prior clusters per system.</p><p id="P39">Non-integrated embeddings were computed on the same cells as used for integration evaluation (described below). The normalized expression prepared for integration was standardized per gene, followed by computing 15 PCs, neighbors, and UMAP.</p></sec><sec id="S17"><title>Evaluation of batch effect strength in unintegrated data</title><p id="P40">Batch effect strength comparison within and between systems within a data se case was performed by computing Euclidean distances between mean embeddings of cell type and sample groups in the PC space (15 PCs on scaled OTO data). We used only groups with at least 50 cells and cell types where both systems had at least three remaining samples. The significance of differences in distance distributions within and between systems was computed per cell type with the one-sided Mann–Whitney U test.</p><p id="P41">Batch effect strength analysis of the three data types was performed using average silhouette width (ASW) with systems as the batch covariates for individual cell types of every data use case, using the non-integrated embeddings. We adapted scIB metrics function<sup><xref ref-type="bibr" rid="R20">20</xref></sup> so that ASW scores were not reported as absolute values. We used ASW rather than iLISI metric as iLISI was not discriminative enough for the substantial pre-integration batch effects. As the computation was performed on the PCA space with comparable dimension ranges across data use cases, the dimension range bias described in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note S5</xref> does not affect the comparison.</p></sec><sec id="S18"><title>Integration</title><p id="P42">We corrected sample and system-level batch effects during integration by adding them to the model inputs as one-hot encoded vectors. The <italic>L<sub>cyc</sub></italic> and <italic>L<sub>ADV</sub></italic> were computed only on the system covariate. We ran each model with any given hyperparameter setting, as described below, three times with different random seeds.</p><p id="P43">Our custom cVAE implementation was based on the scVI framework<sup><xref ref-type="bibr" rid="R38">38</xref></sup>. Unlike in scVI, we used the Gaussian log-likelihood on normalized log-transformed data for reconstruction loss and did not use KL weight annealing. We used the same number of layers and dimensions as for scVI. To regulate batch correction strength we tuned the KL loss weight.</p><p id="P44">Additional extensions were added on top of our cVAE model. We implemented the VampPrior as described by the authors of the original publication<sup><xref ref-type="bibr" rid="R36">36</xref></sup> and did likewise for the GM prior, but with prior components representing points in the latent space. For the VampPrior we initialized prior components by randomly sampling cells from the data and for GM prior we either used sampled data that we passed through the encoder before training or used random initialization with mean in the range [0,1) and variance of one. As in cVAE, we also tuned KL loss weight for the VAMP model. The cycle-consistency loss was computed between the latent representation of a cell (<italic>z<sub>c=i</sub></italic>) and its cycle-pair coming from the other system (<italic>z′<sub>c=j</sub></italic>) using MSE on data standardized within a minibatch separately for cells and their cycle pairs. In both CYC and VAMP+CYC models we tuned the cycle-consistency loss weight.</p><p id="P45">All previously published models (scVI, GLUE, and SATURN) were run with default parameters, except for the following changes. For scVI we used <italic>n_layers</italic>=2, <italic>n_hidden</italic>=256, <italic>n_latent</italic>=15, <italic>n_steps_kl_warmup</italic>=1600, and <italic>gene_likelihood</italic>=nb and we tuned <italic>max_kl_weight</italic> (KL loss weight). In GLUE we tuned <italic>rel_gene_weight</italic> (gene graph weights), <italic>lam_graph</italic> (graph loss weight), and <italic>lam_align</italic> (alignment loss weight). In SATURN we used the provided ESM2 protein embeddings and tuned <italic>pe_sim_penalty</italic> (protein similarity loss weight). The number of epochs was set to a fixed value per method and dataset, depending on the number of cells.</p></sec><sec id="S19"><title>Integration evaluation</title><p id="P46">We performed evaluations on at most 100,000 randomly selected cells per dataset to reduce the computational cost, except for Moran’s I where cells were selected as described below. We computed neighbors on the latent embedding directly except where we specified that the embedding dimensions were standardized prior to neighbors computation. This data was also used for UMAPs. The non-integrated embedding was computed with 15 PCs on scaled OTO data, using the same set of cells as for the integrated data.</p><p id="P47">We describe the rationale for metric selection in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note S5</xref>. For LISI and ASW metrics we used implementations from scib-metrics Python package (<ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/scib-metrics">https://github.com/YosefLab/scib-metrics</ext-link>) and for NMI we adapted their implementation to set a random seed. We computed the NMI-fixed and Jaccard index by first computing Leiden clusters at high resolution (r=2) and then assigning a cell type label to each cluster based on the most common ground-truth label. This annotation was used for comparison to ground-truth labels. For Moran’s I we compared Moran’s I values between non-integrated and integrated data as follows. For the pre-integration Moran’s I computation we kept sample and cell type groups with at least 500 cells and excluded doublets. For each group, we removed genes expressed in less than 10% of the group’s cells, computed 15 PCs and neighbors per group, and used them to compute Moran’s I on all genes. We set a cutoff on Moran’s I per dataset to keep from around a dozen to around 150 genes per group for integration evaluation. On integrated data, we then repeated Moran’s I calculation on the same cell groups and the selected genes. The final score (<italic>mi</italic>) was defined as a ratio of post-(<italic>mi<sub>post</sub></italic>) and pre-integration (<italic>mi<sub>pre</sub></italic>) values averaged across genes (<italic>G</italic>), samples (<italic>G</italic>), and cell types (<italic>CT</italic>). <disp-formula id="FD5"><mml:math id="M5"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mtext>avg</mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>avg</mml:mtext></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>avg</mml:mtext></mml:mrow><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P48">We selected the best hyperparameter setting per model over all tested hyperparameters. For every model, we scaled individual metrics to [0,1] across all runs computed for hyperparameter optimization and then computed the biological preservation score as the average of Moran’s I and NMI and batch correction as iLISI alone. The overall score was computed as a weighted average of biological preservation (weight=0.6) and batch correction (weight=0.4), similar to a previous benchmark<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. The best hyperparameter setting was selected based on the average overall score across runs and for every hyperparameter setting we selected a representative run for UMAP plots as the run with the median overall score. We observed that optimal hyperparameter ranges were similar across datasets (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>) and we further discuss considerations for hyperparameter tuning in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note S6</xref>.</p><p id="P49">We compared the integration performance of all the benchmarked integration methods with their top-performing hyperparameter settings as described above. We used Welch’s t-test followed by multiple test correction per dataset and integration metric with the two-stage Benjamini and Hochberg method. However, a limitation of our analysis is that we always had only three samples per group due to the resource intensiveness of integration benchmarking, reducing the statistical power.</p><p id="P50">Preservation of gene groups known to be variable within pancreatic islet beta cells of healthy adult mice was evaluated with Moran’s I on the control sample from the mSTZ dataset1. We used Scanpy <italic>score_genes</italic> to obtain a single score for every gene group and computed Moran’s I on these scores for every embedding.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Table S1</label><media xlink:href="EMS190624-supplement-Supplementary_Table_S1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" id="d78aAdEbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Table S2</label><media xlink:href="EMS190624-supplement-Supplementary_Table_S2.tsv" mimetype="text" mime-subtype="tab-separated-values; charset=utf-8" id="d78aAdEcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Material</label><media xlink:href="EMS190624-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d78aAdEdB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgments</title><p>We thank members of Theis lab for providing feedback, especially Sabrina Richter. This work was supported by funds from the Helmholtz Association and Helmholtz Munich. F.J.T. acknowledges support from the European Union (ERC, DeepCell—101054957, BetaRegeneration—101054564). Views and opinions expressed are those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council. Neither the European Union nor the granting authority can be held responsible for them. K.H. acknowledges financial support from Joachim Herz Stiftung via Add-on Fellowships for Interdisciplinary Life Science and support from Helmholtz Association under the joint research school ‘Munich School for Data Science’. M.K. acknowledges support from grants AG081017, NS129032, NS115064, AG074003, NS127187, and AG067151. B.L. acknowledges support from Alana Down Syndrome Center. A.T.L. acknowledges support from ERC Grant DeepCell.</p></ack><sec id="S21" sec-type="data-availability"><title>Availability of data and code</title><p id="P51">The datasets were retrieved from public repositories: GEO (GSE211799), www.isletgenomics.org, Single Cell Portal (SCP1376), and <ext-link ext-link-type="uri" xlink:href="https://cellxgene.cziscience.com/collections/2f4c738f-e2f3-4553-9db2-0582a38ea4dc">https://cellxgene.cziscience.com/collections/2f4c738f-e2f3-4553-9db2-0582a38ea4dc</ext-link>.</p><p id="P52">The model and analysis code as well as the conda environments are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/cross_system_integration">https://github.com/theislab/cross_system_integration</ext-link>. We implemented our method in scvi-tools package as an external model named sysVI (<ext-link ext-link-type="uri" xlink:href="https://github.com/Hrovatin/scvi-tools/tree/main/scvi/external/sysvi">https://github.com/Hrovatin/scvi-tools/tree/main/scvi/external/sysvi</ext-link>, pull request under review) and provided a tutorial at: <ext-link ext-link-type="uri" xlink:href="https://github.com/Hrovatin/scvi-tutorials/blob/main/scrna/SysVI.ipynb">https://github.com/Hrovatin/scvi-tutorials/blob/main/scrna/SysVI.ipynb</ext-link>.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P53"><bold>Author contributions</bold></p><p id="P54">Conception: K.H. and L.Z.; data curation and illustrations: K.H.; methodology, formal analysis, figures, and original paper draft: K.H. and A.A.M.; supervision: A.T.L., L.Z., B.L., M.K., F.J.T.; funding acquisition: M.K., F.J.T; paper review: all authors.</p></fn><fn id="FN2" fn-type="conflict"><p id="P55"><bold>Competing interests</bold></p><p id="P56">F.J.T. consults for Immunai Inc., Singularity Bio B.V., CytoReason Ltd and Cellarity; and has an ownership interest in Dermagnostix GmbH and Cellarity. L.Z. has consulted for Lamin Labs GmbH. The remaining authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hrovatin</surname><given-names>K</given-names></name><name><surname>Bastidas-Ponce</surname><given-names>A</given-names></name><name><surname>Bakhti</surname><given-names>M</given-names></name><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Sallino</surname><given-names>C</given-names></name><name><surname>Sterr</surname><given-names>M</given-names></name><name><surname>Böttcher</surname><given-names>A</given-names></name><name><surname>Migliorini</surname><given-names>A</given-names></name><name><surname>Lickert</surname><given-names>H</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Delineating mouse β-cell identity during lifetime and in diabetes with a single cell atlas</article-title><source>Nat Metab</source><year>2023</year><volume>5</volume><fpage>1615</fpage><lpage>1637</lpage><pub-id pub-id-type="pmcid">PMC10513934</pub-id><pub-id pub-id-type="pmid">37697055</pub-id><pub-id pub-id-type="doi">10.1038/s42255-023-00876-x</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buechler</surname><given-names>MB</given-names></name><name><surname>Pradhan</surname><given-names>RN</given-names></name><name><surname>Krishnamurty</surname><given-names>AT</given-names></name><name><surname>Cox</surname><given-names>C</given-names></name><name><surname>Calviello</surname><given-names>AK</given-names></name><name><surname>Wang</surname><given-names>AW</given-names></name><name><surname>Yang</surname><given-names>YA</given-names></name><name><surname>Tam</surname><given-names>L</given-names></name><name><surname>Caothien</surname><given-names>R</given-names></name><name><surname>Roose-Girma</surname><given-names>M</given-names></name><name><surname>Modrusan</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Cross-tissue organization of the fibroblast lineage</article-title><source>Nature</source><year>2021</year><volume>593</volume><fpage>575</fpage><lpage>579</lpage><pub-id pub-id-type="pmid">33981032</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nieto</surname><given-names>P</given-names></name><name><surname>Elosua-Bayes</surname><given-names>M</given-names></name><name><surname>Trincado</surname><given-names>JL</given-names></name><name><surname>Marchese</surname><given-names>D</given-names></name><name><surname>Massoni-Badosa</surname><given-names>R</given-names></name><name><surname>Salvany</surname><given-names>M</given-names></name><name><surname>Henriques</surname><given-names>A</given-names></name><name><surname>Nieto</surname><given-names>J</given-names></name><name><surname>Aguilar-Fernández</surname><given-names>S</given-names></name><name><surname>Mereu</surname><given-names>E</given-names></name><name><surname>Moutinho</surname><given-names>C</given-names></name><etal/></person-group><article-title>A single-cell tumor immune atlas for precision oncology</article-title><source>Genome Res</source><year>2021</year><volume>31</volume><fpage>1913</fpage><lpage>1926</lpage><pub-id pub-id-type="pmcid">PMC8494216</pub-id><pub-id pub-id-type="pmid">34548323</pub-id><pub-id pub-id-type="doi">10.1101/gr.273300.120</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sikkema</surname><given-names>L</given-names></name><name><surname>Ramírez-Suástegui</surname><given-names>C</given-names></name><name><surname>Strobl</surname><given-names>DC</given-names></name><name><surname>Gillett</surname><given-names>TE</given-names></name><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Madissoon</surname><given-names>E</given-names></name><name><surname>Markov</surname><given-names>NS</given-names></name><name><surname>Zaragosi</surname><given-names>L-E</given-names></name><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Ansari</surname><given-names>M</given-names></name><name><surname>Arguel</surname><given-names>M-J</given-names></name><etal/></person-group><article-title>An integrated cell atlas of the lung in health and disease</article-title><source>Nat Med</source><year>2023</year><volume>29</volume><fpage>1563</fpage><lpage>1577</lpage><pub-id pub-id-type="pmcid">PMC10287567</pub-id><pub-id pub-id-type="pmid">37291214</pub-id><pub-id pub-id-type="doi">10.1038/s41591-023-02327-2</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarashansky</surname><given-names>AJ</given-names></name><name><surname>Musser</surname><given-names>JM</given-names></name><name><surname>Khariton</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>P</given-names></name><name><surname>Arendt</surname><given-names>D</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name></person-group><article-title>Mapping single-cell atlases throughout Metazoa unravels cell type evolution</article-title><source>Elife</source><year>2021</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC8139856</pub-id><pub-id pub-id-type="pmid">33944782</pub-id><pub-id pub-id-type="doi">10.7554/eLife.66747</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tritschler</surname><given-names>S</given-names></name><name><surname>Thomas</surname><given-names>M</given-names></name><name><surname>Böttcher</surname><given-names>A</given-names></name><name><surname>Ludwig</surname><given-names>B</given-names></name><name><surname>Schmid</surname><given-names>J</given-names></name><name><surname>Schubert</surname><given-names>U</given-names></name><name><surname>Kemter</surname><given-names>E</given-names></name><name><surname>Wolf</surname><given-names>E</given-names></name><name><surname>Lickert</surname><given-names>H</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>A transcriptional cross species map of pancreatic islet cells</article-title><source>Mol Metab</source><year>2022</year><volume>66</volume><elocation-id>101595</elocation-id><pub-id pub-id-type="pmcid">PMC9526148</pub-id><pub-id pub-id-type="pmid">36113773</pub-id><pub-id pub-id-type="doi">10.1016/j.molmet.2022.101595</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowan</surname><given-names>CS</given-names></name><name><surname>Renner</surname><given-names>M</given-names></name><name><surname>De Gennaro</surname><given-names>M</given-names></name><name><surname>Gross-Scherf</surname><given-names>B</given-names></name><name><surname>Goldblum</surname><given-names>D</given-names></name><name><surname>Hou</surname><given-names>Y</given-names></name><name><surname>Munz</surname><given-names>M</given-names></name><name><surname>Rodrigues</surname><given-names>TM</given-names></name><name><surname>Krol</surname><given-names>J</given-names></name><name><surname>Szikra</surname><given-names>T</given-names></name><name><surname>Cuttat</surname><given-names>R</given-names></name><etal/></person-group><article-title>Cell Types of the Human Retina and Its Organoids at Single-Cell Resolution</article-title><source>Cell</source><year>2020</year><volume>182</volume><fpage>1623</fpage><lpage>1640</lpage><elocation-id>e34</elocation-id><pub-id pub-id-type="pmcid">PMC7505495</pub-id><pub-id pub-id-type="pmid">32946783</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2020.08.013</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sridhar</surname><given-names>A</given-names></name><name><surname>Hoshino</surname><given-names>A</given-names></name><name><surname>Finkbeiner</surname><given-names>CR</given-names></name><name><surname>Chitsazan</surname><given-names>A</given-names></name><name><surname>Dai</surname><given-names>L</given-names></name><name><surname>Haugan</surname><given-names>AK</given-names></name><name><surname>Eschenbacher</surname><given-names>KM</given-names></name><name><surname>Jackson</surname><given-names>DL</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Bermingham-McDonogh</surname><given-names>O</given-names></name><name><surname>Glass</surname><given-names>I</given-names></name><etal/></person-group><article-title>Single-Cell Transcriptomic Comparison of Human Fetal Retina, hPSC-Derived Retinal Organoids, and Long-Term Retinal Cultures</article-title><source>Cell Rep</source><year>2020</year><volume>30</volume><fpage>1644</fpage><lpage>1659</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmcid">PMC7901645</pub-id><pub-id pub-id-type="pmid">32023475</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2020.01.007</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georges</surname><given-names>A</given-names></name><name><surname>Lavergne</surname><given-names>A</given-names></name><name><surname>Mandai</surname><given-names>M</given-names></name><name><surname>Lepiemme</surname><given-names>F</given-names></name><name><surname>Karim</surname><given-names>L</given-names></name><name><surname>Demeulenaere</surname><given-names>L</given-names></name><name><surname>Aguilar</surname><given-names>D</given-names></name><name><surname>Schyns</surname><given-names>M</given-names></name><name><surname>Nguyen</surname><given-names>L</given-names></name><name><surname>Rakic</surname><given-names>J-M</given-names></name><name><surname>Takahashi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Comparing the transcriptome of developing native and iPSC-derived mouse retinae by single cell RNA sequencing</article-title><source>Sci Rep</source><year>2023</year><volume>13</volume><elocation-id>1223</elocation-id><pub-id pub-id-type="pmcid">PMC9867755</pub-id><pub-id pub-id-type="pmid">36681719</pub-id><pub-id pub-id-type="doi">10.1038/s41598-023-28429-y</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balboa</surname><given-names>D</given-names></name><name><surname>Barsby</surname><given-names>T</given-names></name><name><surname>Lithovius</surname><given-names>V</given-names></name><name><surname>Saarimäki-Vire</surname><given-names>J</given-names></name><name><surname>Omar-Hmeadi</surname><given-names>M</given-names></name><name><surname>Dyachok</surname><given-names>O</given-names></name><name><surname>Montaser</surname><given-names>H</given-names></name><name><surname>Lund</surname><given-names>P-E</given-names></name><name><surname>Yang</surname><given-names>M</given-names></name><name><surname>Ibrahim</surname><given-names>H</given-names></name><name><surname>Näätänen</surname><given-names>A</given-names></name><etal/></person-group><article-title>Functional, metabolic and transcriptional maturation of human pancreatic islets derived from stem cells</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>1042</fpage><lpage>1055</lpage><pub-id pub-id-type="pmcid">PMC9287162</pub-id><pub-id pub-id-type="pmid">35241836</pub-id><pub-id pub-id-type="doi">10.1038/s41587-022-01219-z</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>N</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name></person-group><article-title>Single-cell transcriptome in silico analysis reveals conserved regulatory programs in macrophages/monocytes of abdominal aortic aneurysm from multiple mouse models and human</article-title><source>Front Cardiovasc Med</source><year>2022</year><volume>9</volume><elocation-id>1062106</elocation-id><pub-id pub-id-type="pmcid">PMC9868255</pub-id><pub-id pub-id-type="pmid">36698942</pub-id><pub-id pub-id-type="doi">10.3389/fcvm.2022.1062106</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ton</surname><given-names>M-LN</given-names></name><name><surname>Keitley</surname><given-names>D</given-names></name><name><surname>Theeuwes</surname><given-names>B</given-names></name><name><surname>Guibentif</surname><given-names>C</given-names></name><name><surname>Ahnfelt-Rønne</surname><given-names>J</given-names></name><name><surname>Andreassen</surname><given-names>TK</given-names></name><name><surname>Calero-Nieto</surname><given-names>FJ</given-names></name><name><surname>Imaz-Rosshandler</surname><given-names>I</given-names></name><name><surname>Pijuan-Sala</surname><given-names>B</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Benito-Gutiérrez</surname><given-names>È</given-names></name><etal/></person-group><article-title>An atlas of rabbit development as a model for single-cell comparative genomics</article-title><source>Nat Cell Biol</source><year>2023</year><volume>25</volume><fpage>1061</fpage><lpage>1072</lpage><pub-id pub-id-type="pmid">37322291</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Q</given-names></name><name><surname>Halle</surname><given-names>L</given-names></name><name><surname>Hediyeh-zadeh</surname><given-names>S</given-names></name><name><surname>Kuijs</surname><given-names>M</given-names></name><name><surname>Kilik</surname><given-names>U</given-names></name><name><surname>Yu</surname><given-names>Q</given-names></name><name><surname>Frum</surname><given-names>T</given-names></name><name><surname>Adam</surname><given-names>L</given-names></name><name><surname>Parikh</surname><given-names>S</given-names></name><name><surname>Gander</surname><given-names>M</given-names></name><name><surname>Kfuri-Rubens</surname><given-names>R</given-names></name><etal/></person-group><article-title>An integrated transcriptomic cell atlas of human endoderm-derived organoids</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.11.20.567825</elocation-id><pub-id pub-id-type="doi">10.1101/2023.11.20.567825</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Dony</surname><given-names>L</given-names></name><name><surname>Fleck</surname><given-names>JS</given-names></name><name><surname>Szałata</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>KX</given-names></name><name><surname>Slišković</surname><given-names>I</given-names></name><name><surname>Lin</surname><given-names>H-C</given-names></name><name><surname>Santel</surname><given-names>M</given-names></name><name><surname>Atamian</surname><given-names>A</given-names></name><name><surname>Quadrato</surname><given-names>G</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><etal/></person-group><article-title>An integrated transcriptomic cell atlas of human neural organoids</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.10.05.561097</elocation-id><pub-id pub-id-type="doi">10.1101/2023.10.05.561097</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basile</surname><given-names>G</given-names></name><name><surname>Kahraman</surname><given-names>S</given-names></name><name><surname>Dirice</surname><given-names>E</given-names></name><name><surname>Pan</surname><given-names>H</given-names></name><name><surname>Dreyfuss</surname><given-names>JM</given-names></name><name><surname>Kulkarni</surname><given-names>RN</given-names></name></person-group><article-title>Using single-nucleus RNA-sequencing to interrogate transcriptomic profiles of archived human pancreatic islets</article-title><source>Genome Med</source><year>2021</year><volume>13</volume><fpage>128</fpage><pub-id pub-id-type="pmcid">PMC8356387</pub-id><pub-id pub-id-type="pmid">34376240</pub-id><pub-id pub-id-type="doi">10.1186/s13073-021-00941-8</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lake</surname><given-names>BB</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name><name><surname>Yung</surname><given-names>YC</given-names></name><name><surname>Gao</surname><given-names>D</given-names></name><name><surname>Chun</surname><given-names>J</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><article-title>A comparative strategy for single-nucleus and single-cell transcriptomes confirms accuracy in predicted cell-type expression from nuclear RNA</article-title><source>Sci Rep</source><year>2017</year><volume>7</volume><elocation-id>6031</elocation-id><pub-id pub-id-type="pmcid">PMC5519641</pub-id><pub-id pub-id-type="pmid">28729663</pub-id><pub-id pub-id-type="doi">10.1038/s41598-017-04426-w</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Teichmann</surname><given-names>S</given-names></name><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Stubbington</surname><given-names>M</given-names></name><name><surname>Ardlie</surname><given-names>K</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Arlotta</surname><given-names>P</given-names></name><name><surname>Bader</surname><given-names>G</given-names></name><name><surname>Benoist</surname><given-names>C</given-names></name><name><surname>Biton</surname><given-names>M</given-names></name><name><surname>Bodenmiller</surname><given-names>B</given-names></name><etal/></person-group><article-title>The Human Cell Atlas White Paper</article-title><source>arXiv [q-bio.TO]</source><year>2018</year><comment>at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.05192">http://arxiv.org/abs/1810.05192</ext-link></comment></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>da Veiga Beltrame</surname><given-names>E</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>A curated database reveals trends in single-cell transcriptomics</article-title><source>Database</source><year>2020</year><volume>2020</volume><pub-id pub-id-type="pmcid">PMC7698659</pub-id><pub-id pub-id-type="pmid">33247933</pub-id><pub-id pub-id-type="doi">10.1093/database/baaa073</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Miao</surname><given-names>Z</given-names></name><name><surname>Brazma</surname><given-names>A</given-names></name><name><surname>Papatheodorou</surname><given-names>I</given-names></name></person-group><article-title>Benchmarking strategies for cross-species integration of single-cell RNA sequencing data</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2022.09.27.509674</elocation-id><pub-id pub-id-type="pmcid">PMC10576752</pub-id><pub-id pub-id-type="pmid">37838716</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-41855-w</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luecken</surname><given-names>MD</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Chaichoompu</surname><given-names>K</given-names></name><name><surname>Danese</surname><given-names>A</given-names></name><name><surname>Interlandi</surname><given-names>M</given-names></name><name><surname>Mueller</surname><given-names>MF</given-names></name><name><surname>Strobl</surname><given-names>DC</given-names></name><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Dugas</surname><given-names>M</given-names></name><name><surname>Colomé-Tatché</surname><given-names>M</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>41</fpage><lpage>50</lpage><pub-id pub-id-type="pmcid">PMC8748196</pub-id><pub-id pub-id-type="pmid">34949812</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01336-8</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lütge</surname><given-names>A</given-names></name><name><surname>Zyprych-Walczak</surname><given-names>J</given-names></name><name><surname>Brykczynska Kunzmann</surname><given-names>U</given-names></name><name><surname>Crowell</surname><given-names>HL</given-names></name><name><surname>Calini</surname><given-names>D</given-names></name><name><surname>Malhotra</surname><given-names>D</given-names></name><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>CellMixS: quantifying and visualizing batch effects in single-cell RNA-seq data</article-title><source>Life Sci Alliance</source><year>2021</year><volume>4</volume><pub-id pub-id-type="pmcid">PMC7994321</pub-id><pub-id pub-id-type="pmid">33758076</pub-id><pub-id pub-id-type="doi">10.26508/lsa.202001004</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>Y</given-names></name><name><surname>Han</surname><given-names>GH</given-names></name><name><surname>Jung</surname><given-names>E</given-names></name><name><surname>Hwang</surname><given-names>D</given-names></name></person-group><article-title>Integration of Single-Cell RNA-Seq Datasets: A Review of Computational Methods</article-title><source>Mol Cells</source><year>2023</year><volume>46</volume><fpage>106</fpage><lpage>119</lpage><pub-id pub-id-type="pmcid">PMC9982060</pub-id><pub-id pub-id-type="pmid">36859475</pub-id><pub-id pub-id-type="doi">10.14348/molcells.2023.0009</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>MB</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="pmcid">PMC6289068</pub-id><pub-id pub-id-type="pmid">30504886</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steuernagel</surname><given-names>L</given-names></name><name><surname>Lam</surname><given-names>BYH</given-names></name><name><surname>Klemm</surname><given-names>P</given-names></name><name><surname>Dowsett</surname><given-names>GKC</given-names></name><name><surname>Bauder</surname><given-names>CA</given-names></name><name><surname>Tadross</surname><given-names>JA</given-names></name><name><surname>Hitschfeld</surname><given-names>TS</given-names></name><name><surname>Del Rio Martin</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>de Solis</surname><given-names>AJ</given-names></name><name><surname>Fenselau</surname><given-names>H</given-names></name><etal/></person-group><article-title>HypoMap-a unified single-cell gene expression atlas of the murine hypothalamus</article-title><source>Nat Metab</source><year>2022</year><volume>4</volume><fpage>1402</fpage><lpage>1419</lpage><pub-id pub-id-type="pmcid">PMC9584816</pub-id><pub-id pub-id-type="pmid">36266547</pub-id><pub-id pub-id-type="doi">10.1038/s42255-022-00657-y</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swamy</surname><given-names>VS</given-names></name><name><surname>Fufa</surname><given-names>TD</given-names></name><name><surname>Hufnagel</surname><given-names>RB</given-names></name><name><surname>McGaughey</surname><given-names>DM</given-names></name></person-group><article-title>Building the mega single-cell transcriptome ocular meta-atlas</article-title><source>Gigascience</source><year>2021</year><volume>10</volume><pub-id pub-id-type="pmcid">PMC8514335</pub-id><pub-id pub-id-type="pmid">34651173</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giab061</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Rybakov</surname><given-names>S</given-names></name><name><surname>Hrovatin</surname><given-names>K</given-names></name><name><surname>Hediyeh-Zadeh</surname><given-names>S</given-names></name><name><surname>Talavera-López</surname><given-names>C</given-names></name><name><surname>Misharin</surname><given-names>AV</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Biologically informed deep learning to query gene programs in single-cell atlases</article-title><source>Nat Cell Biol</source><year>2023</year><volume>25</volume><fpage>337</fpage><lpage>350</lpage><pub-id pub-id-type="pmcid">PMC9928587</pub-id><pub-id pub-id-type="pmid">36732632</pub-id><pub-id pub-id-type="doi">10.1038/s41556-022-01072-x</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Naghipourfar</surname><given-names>M</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Alexander Wolf</surname><given-names>F</given-names></name></person-group><article-title>Conditional out-of-distribution generation for unpaired data using transfer VAE</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>i610</fpage><lpage>i617</lpage><pub-id pub-id-type="pmid">33381839</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>A</given-names></name><name><surname>Vezer</surname><given-names>A</given-names></name><name><surname>Glastonbury</surname><given-names>CA</given-names></name><name><surname>Creed</surname><given-names>P</given-names></name><name><surname>Abujudeh</surname><given-names>S</given-names></name><name><surname>Sim</surname><given-names>A</given-names></name></person-group><source>Contrastive Mixture of Posteriors for Counterfactual Inference, Data Integration and Fairness</source><person-group person-group-type="editor"><name><surname>Chaudhuri</surname><given-names>K</given-names></name><name><surname>Jegelka</surname><given-names>S</given-names></name><name><surname>Song</surname><given-names>L</given-names></name><name><surname>Szepesvari</surname><given-names>C</given-names></name><name><surname>Niu</surname><given-names>G</given-names></name><name><surname>Sabato</surname><given-names>S</given-names></name></person-group><conf-name>Proceedings of the 39th International Conference on Machine Learning</conf-name><conf-sponsor>PMLR</conf-sponsor><conf-date>17--23 Jul 2022</conf-date><volume>162</volume><fpage>6578</fpage><lpage>6621</lpage></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aliee</surname><given-names>H</given-names></name><name><surname>Kapl</surname><given-names>F</given-names></name><name><surname>Hediyeh-Zadeh</surname><given-names>S</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Conditionally Invariant Representation Learning for Disentangling Cellular Heterogeneity</article-title><source>arXiv [cs.LG]</source><year>2023</year><comment>at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2307.00558">http://arxiv.org/abs/2307.00558</ext-link></comment></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Z-J</given-names></name><name><surname>Gao</surname><given-names>G</given-names></name></person-group><article-title>Multi-omics single-cell data integration and regulatory inference with graph-linked embedding</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>1458</fpage><lpage>1466</lpage><pub-id pub-id-type="pmcid">PMC9546775</pub-id><pub-id pub-id-type="pmid">35501393</pub-id><pub-id pub-id-type="doi">10.1038/s41587-022-01284-4</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Klimovskaia Susmelj</surname><given-names>A</given-names></name><name><surname>De Donno</surname><given-names>C</given-names></name><name><surname>Hetzel</surname><given-names>L</given-names></name><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Ibarra</surname><given-names>IL</given-names></name><name><surname>Srivatsan</surname><given-names>SR</given-names></name><name><surname>Naghipourfar</surname><given-names>M</given-names></name><name><surname>Daza</surname><given-names>RM</given-names></name><name><surname>Martin</surname><given-names>B</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name><etal/></person-group><article-title>Predicting cellular responses to complex perturbations in high-throughput screens</article-title><source>Mol Syst Biol</source><year>2023</year><volume>19</volume><elocation-id>e11517</elocation-id><pub-id pub-id-type="pmcid">PMC10258562</pub-id><pub-id pub-id-type="pmid">37154091</pub-id><pub-id pub-id-type="doi">10.15252/msb.202211517</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopp</surname><given-names>W</given-names></name><name><surname>Akalin</surname><given-names>A</given-names></name><name><surname>Ohler</surname><given-names>U</given-names></name></person-group><article-title>Simultaneous dimensionality reduction and integration for single-cell ATAC-seq data using deep learning</article-title><source>Nature Machine Intelligence</source><year>2022</year><volume>4</volume><fpage>162</fpage><lpage>168</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Wei</surname><given-names>Y</given-names></name><name><surname>Shu</surname><given-names>J</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name></person-group><article-title>Con-AAE: contrastive cycle adversarial autoencoders for single-cell multi-omics alignment and integration</article-title><source>Bioinformatics</source><year>2023</year><volume>39</volume><pub-id pub-id-type="pmcid">PMC10101696</pub-id><pub-id pub-id-type="pmid">36975610</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btad162</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Brombacher</surname><given-names>E</given-names></name><name><surname>Hackenberg</surname><given-names>M</given-names></name><name><surname>Kreutz</surname><given-names>C</given-names></name><name><surname>Binder</surname><given-names>H</given-names></name><name><surname>Treppner</surname><given-names>M</given-names></name></person-group><source>The Performance of Deep Generative Models for Learning Joint Embeddings of Single-cell Multi-omics Data</source><publisher-name>Universität</publisher-name><year>2022</year><pub-id pub-id-type="pmcid">PMC9643784</pub-id><pub-id pub-id-type="pmid">36387277</pub-id><pub-id pub-id-type="doi">10.3389/fmolb.2022.962644</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Begoli</surname><given-names>E</given-names></name><name><surname>McCord</surname><given-names>RP</given-names></name></person-group><article-title>sciCAN: single-cell chromatin accessibility and gene expression data integration via cycle-consistent adversarial network</article-title><source>NPJ Syst Biol Appl</source><year>2022</year><volume>8</volume><fpage>33</fpage><pub-id pub-id-type="pmcid">PMC9464763</pub-id><pub-id pub-id-type="pmid">36089620</pub-id><pub-id pub-id-type="doi">10.1038/s41540-022-00245-6</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomczak</surname><given-names>JM</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><article-title>VAE with a VampPrior</article-title><source>arXiv [cs.LG]</source><year>2017</year><comment>at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1705.07120">http://arxiv.org/abs/1705.07120</ext-link></comment></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Dony</surname><given-names>L</given-names></name><name><surname>König</surname><given-names>M</given-names></name><name><surname>Fischer</surname><given-names>DS</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><source>Variational autoencoders with flexible priors enable robust distribution learning on single-cell RNA sequencing data</source><comment>at <ext-link ext-link-type="uri" xlink:href="https://icml-compbio.github.io/icml-website-2020/2020/papers/WCBICML2020_paper_37.pdf">https://icml-compbio.github.io/icml-website-2020/2020/papers/WCBICML2020_paper_37.pdf</ext-link></comment></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gayoso</surname><given-names>A</given-names></name><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Xing</surname><given-names>G</given-names></name><name><surname>Boyeau</surname><given-names>P</given-names></name><name><surname>Valiollah Pour Amiri</surname><given-names>V</given-names></name><name><surname>Hong</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Jayasuriya</surname><given-names>M</given-names></name><name><surname>Mehlman</surname><given-names>E</given-names></name><name><surname>Langevin</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A Python library for probabilistic analysis of single-cell omics data</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>163</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">35132262</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shree</surname><given-names>A</given-names></name><name><surname>Pavan</surname><given-names>MK</given-names></name><name><surname>Zafar</surname><given-names>H</given-names></name></person-group><article-title>scDREAMER for atlas-level integration of single-cell datasets using deep generative model paired with adversarial classifier</article-title><source>Nat Commun</source><year>2023</year><volume>14</volume><elocation-id>7781</elocation-id><pub-id pub-id-type="pmcid">PMC10682386</pub-id><pub-id pub-id-type="pmid">38012145</pub-id><pub-id pub-id-type="doi">10.1038/s41467-023-43590-8</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Zhong</surname><given-names>Y</given-names></name><name><surname>Shang</surname><given-names>X</given-names></name></person-group><article-title>A versatile and scalable single-cell data integration algorithm based on domain-adversarial and variational approximation</article-title><source>Brief Bioinform</source><year>2022</year><volume>23</volume><pub-id pub-id-type="pmid">34585247</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>MYY</given-names></name><name><surname>Kaestner</surname><given-names>KH</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><article-title>Benchmarking algorithms for joint integration of unpaired and paired single-cell RNA-seq and ATAC-seq data</article-title><source>Genome Biol</source><year>2023</year><volume>24</volume><fpage>244</fpage><pub-id pub-id-type="pmcid">PMC10594700</pub-id><pub-id pub-id-type="pmid">37875977</pub-id><pub-id pub-id-type="doi">10.1186/s13059-023-03073-x</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denisenko</surname><given-names>E</given-names></name><name><surname>Guo</surname><given-names>BB</given-names></name><name><surname>Jones</surname><given-names>M</given-names></name><name><surname>Hou</surname><given-names>R</given-names></name><name><surname>de Kock</surname><given-names>L</given-names></name><name><surname>Lassmann</surname><given-names>T</given-names></name><name><surname>Poppe</surname><given-names>D</given-names></name><name><surname>Clément</surname><given-names>O</given-names></name><name><surname>Simmons</surname><given-names>RK</given-names></name><name><surname>Lister</surname><given-names>R</given-names></name><name><surname>Forrest</surname><given-names>ARR</given-names></name></person-group><article-title>Systematic assessment of tissue dissociation and storage biases in single-cell and single-nucleus RNA-seq workflows</article-title><source>Genome Biol</source><year>2020</year><volume>21</volume><fpage>130</fpage><pub-id pub-id-type="pmcid">PMC7265231</pub-id><pub-id pub-id-type="pmid">32487174</pub-id><pub-id pub-id-type="doi">10.1186/s13059-020-02048-6</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Dowbaj</surname><given-names>AM</given-names></name><name><surname>Sljukic</surname><given-names>A</given-names></name><name><surname>Bratlie</surname><given-names>K</given-names></name><name><surname>Lin</surname><given-names>L</given-names></name><name><surname>Fong</surname><given-names>ELS</given-names></name><name><surname>Balachander</surname><given-names>GM</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Soragni</surname><given-names>A</given-names></name><name><surname>Huch</surname><given-names>M</given-names></name><etal/></person-group><article-title>Organoids</article-title><source>Nat Rev Methods Primers</source><year>2022</year><volume>2</volume><pub-id pub-id-type="pmcid">PMC10270325</pub-id><pub-id pub-id-type="pmid">37325195</pub-id><pub-id pub-id-type="doi">10.1038/s43586-022-00174-y</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J-Y</given-names></name><name><surname>Park</surname><given-names>T</given-names></name><name><surname>Isola</surname><given-names>P</given-names></name><name><surname>Efros</surname><given-names>AA</given-names></name></person-group><article-title>Unpaired image-to-image translation using cycleconsistent adversarial networks</article-title><source>arXiv [cs.CV]</source><year>2017</year><comment>at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1703.10593">http://arxiv.org/abs/1703.10593</ext-link></comment></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grønbech</surname><given-names>CH</given-names></name><name><surname>Vording</surname><given-names>MF</given-names></name><name><surname>Timshel</surname><given-names>PN</given-names></name><name><surname>Sønderby</surname><given-names>CK</given-names></name><name><surname>Pers</surname><given-names>TH</given-names></name><name><surname>Winther</surname><given-names>O</given-names></name></person-group><article-title>scVAE: variational auto-encoders for single-cell gene expression data</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>4415</fpage><lpage>4422</lpage><pub-id pub-id-type="pmid">32415966</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Meng</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>C</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name><name><surname>Zeng</surname><given-names>X</given-names></name><name><surname>Nussinov</surname><given-names>R</given-names></name><name><surname>Cheng</surname><given-names>F</given-names></name></person-group><article-title>Graph embedding and Gaussian mixture variational autoencoder network for end-to-end analysis of single-cell RNA sequencing data</article-title><source>Cell Rep Methods</source><year>2023</year><volume>3</volume><elocation-id>100382</elocation-id><pub-id pub-id-type="pmcid">PMC9939381</pub-id><pub-id pub-id-type="pmid">36814845</pub-id><pub-id pub-id-type="doi">10.1016/j.crmeth.2022.100382</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopf</surname><given-names>A</given-names></name><name><surname>Fortuin</surname><given-names>V</given-names></name><name><surname>Somnath</surname><given-names>VR</given-names></name><name><surname>Claassen</surname><given-names>M</given-names></name></person-group><article-title>Mixture-of-Experts Variational Autoencoder for clustering and generating from similarity-based representations on single cell data</article-title><source>PLoS Comput Biol</source><year>2021</year><volume>17</volume><elocation-id>e1009086</elocation-id><pub-id pub-id-type="pmcid">PMC8277074</pub-id><pub-id pub-id-type="pmid">34191792</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009086</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luecken</surname><given-names>MD</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title><source>Mol Syst Biol</source><year>2019</year><volume>15</volume><elocation-id>e8746</elocation-id><pub-id pub-id-type="pmcid">PMC6582955</pub-id><pub-id pub-id-type="pmid">31217225</pub-id><pub-id pub-id-type="doi">10.15252/msb.20188746</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname><given-names>Y</given-names></name><name><surname>Brbić</surname><given-names>M</given-names></name><name><surname>Roohani</surname><given-names>Y</given-names></name><name><surname>Swanson</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Leskovec</surname><given-names>J</given-names></name></person-group><article-title>Towards Universal Cell Embeddings: Integrating Single-cell RNA-seq Datasets across Species with SATURN</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="pmid">38366243</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Donno</surname><given-names>C</given-names></name><name><surname>Hediyeh-Zadeh</surname><given-names>S</given-names></name><name><surname>Wagenstetter</surname><given-names>M</given-names></name><name><surname>Moinfar</surname><given-names>AA</given-names></name><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Population-level integration of single-cell datasets enables multi-scale analysis across samples</article-title><source>Nat Methods</source><year>2023</year><volume>20</volume><fpage>1683</fpage><lpage>1692</lpage><pub-id pub-id-type="pmcid">PMC10630133</pub-id><pub-id pub-id-type="pmid">37813989</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-02035-2</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Mehlman</surname><given-names>E</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Probabilistic harmonization and annotation of single-cell transcriptomics data with deep generative models</article-title><source>Mol Syst Biol</source><year>2021</year><volume>17</volume><elocation-id>e9620</elocation-id><pub-id pub-id-type="pmcid">PMC7829634</pub-id><pub-id pub-id-type="pmid">33491336</pub-id><pub-id pub-id-type="doi">10.15252/msb.20209620</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosen</surname><given-names>Y</given-names></name><name><surname>Roohani</surname><given-names>Y</given-names></name><name><surname>Agarwal</surname><given-names>A</given-names></name><name><surname>Samotorčan</surname><given-names>L</given-names></name><collab>Tabula Sapiens Consortium</collab><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Leskovec</surname><given-names>J</given-names></name></person-group><article-title>Universal Cell Embeddings: A Foundation Model for Cell Biology</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.11.28.568918</elocation-id><pub-id pub-id-type="doi">10.1101/2023.11.28.568918</pub-id></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Maan</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name></person-group><article-title>scGPT: Towards Building a Foundation Model for Single-Cell Multi-omics Using Generative AI</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.04.30.538439</elocation-id><pub-id pub-id-type="doi">10.1101/2023.04.30.538439</pub-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theodoris</surname><given-names>CV</given-names></name><name><surname>Xiao</surname><given-names>L</given-names></name><name><surname>Chopra</surname><given-names>A</given-names></name><name><surname>Chaffin</surname><given-names>MD</given-names></name><name><surname>Al Sayed</surname><given-names>ZR</given-names></name><name><surname>Hill</surname><given-names>MC</given-names></name><name><surname>Mantineo</surname><given-names>H</given-names></name><name><surname>Brydon</surname><given-names>EM</given-names></name><name><surname>Zeng</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>XS</given-names></name><name><surname>Ellinor</surname><given-names>PT</given-names></name></person-group><article-title>Transfer learning enables predictions in network biology</article-title><source>Nature</source><year>2023</year><volume>618</volume><fpage>616</fpage><lpage>624</lpage><pub-id pub-id-type="pmid">37258680</pub-id></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Shim</surname><given-names>H</given-names></name><name><surname>Wei</surname><given-names>S</given-names></name></person-group><article-title>Trade-off between conservation of biological variation and batch effect removal in deep generative modeling for single-cell transcriptomics</article-title><source>BMC Bioinformatics</source><year>2022</year><volume>23</volume><fpage>460</fpage><pub-id pub-id-type="pmcid">PMC9635149</pub-id><pub-id pub-id-type="pmid">36329399</pub-id><pub-id pub-id-type="doi">10.1186/s12859-022-05003-3</pub-id></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Alemi</surname><given-names>A</given-names></name><name><surname>Poole</surname><given-names>B</given-names></name><name><surname>Fischer</surname><given-names>I</given-names></name><name><surname>Dillon</surname><given-names>J</given-names></name><name><surname>Saurus</surname><given-names>RA</given-names></name><name><surname>Murphy</surname><given-names>K</given-names></name></person-group><source>An information-theoretic analysis of deep latent-variable models</source><year>2018</year><comment>at <ext-link ext-link-type="uri" xlink:href="https://openreview.net/pdf?id=H1rRWl-Cb">https://openreview.net/pdf?id=H1rRWl-Cb</ext-link></comment></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Keren-Shaul</surname><given-names>H</given-names></name><name><surname>Boyeau</surname><given-names>P</given-names></name><name><surname>Kedmi</surname><given-names>M</given-names></name><name><surname>Pilzer</surname><given-names>D</given-names></name><name><surname>Jelinski</surname><given-names>A</given-names></name><name><surname>Yofe</surname><given-names>I</given-names></name><name><surname>David</surname><given-names>E</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name><name><surname>Ergen</surname><given-names>C</given-names></name><etal/></person-group><article-title>DestVI identifies continuums of cell types in spatial transcriptomics data</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>1360</fpage><lpage>1369</lpage><pub-id pub-id-type="pmcid">PMC9756396</pub-id><pub-id pub-id-type="pmid">35449415</pub-id><pub-id pub-id-type="doi">10.1038/s41587-022-01272-8</pub-id></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgamal</surname><given-names>RM</given-names></name><name><surname>Kudtarkar</surname><given-names>P</given-names></name><name><surname>Melton</surname><given-names>RL</given-names></name><name><surname>Mummey</surname><given-names>HM</given-names></name><name><surname>Benaglio</surname><given-names>P</given-names></name><name><surname>Okino</surname><given-names>M-L</given-names></name><name><surname>Gaulton</surname><given-names>KJ</given-names></name></person-group><article-title>An integrated map of cell type-specific gene expression in pancreatic islets</article-title><source>bioRxiv</source><year>2023</year><pub-id pub-id-type="pmcid">PMC10588282</pub-id><pub-id pub-id-type="pmid">37582230</pub-id><pub-id pub-id-type="doi">10.2337/db23-0130</pub-id></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emont</surname><given-names>MP</given-names></name><name><surname>Jacobs</surname><given-names>C</given-names></name><name><surname>Essene</surname><given-names>AL</given-names></name><name><surname>Pant</surname><given-names>D</given-names></name><name><surname>Tenen</surname><given-names>D</given-names></name><name><surname>Colleluori</surname><given-names>G</given-names></name><name><surname>Di Vincenzo</surname><given-names>A</given-names></name><name><surname>Jørgensen</surname><given-names>AM</given-names></name><name><surname>Dashti</surname><given-names>H</given-names></name><name><surname>Stefek</surname><given-names>A</given-names></name><name><surname>McGonagle</surname><given-names>E</given-names></name><etal/></person-group><article-title>A single-cell atlas of human and mouse white adipose tissue</article-title><source>Nature</source><year>2022</year><volume>603</volume><fpage>926</fpage><lpage>933</lpage><pub-id pub-id-type="pmcid">PMC9504827</pub-id><pub-id pub-id-type="pmid">35296864</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04518-2</pub-id></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumos</surname><given-names>L</given-names></name><name><surname>Schaar</surname><given-names>AC</given-names></name><name><surname>Lance</surname><given-names>C</given-names></name><name><surname>Litinetskaya</surname><given-names>A</given-names></name><name><surname>Drost</surname><given-names>F</given-names></name><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Lücken</surname><given-names>MD</given-names></name><name><surname>Strobl</surname><given-names>DC</given-names></name><name><surname>Henao</surname><given-names>J</given-names></name><name><surname>Curion</surname><given-names>F</given-names></name><collab>Single-cell Best Practices Consortium</collab><etal/></person-group><article-title>Best practices for single-cell analysis across modalities</article-title><source>Nat Rev Genet</source><year>2023</year><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="pmcid">PMC10066026</pub-id><pub-id pub-id-type="pmid">37002403</pub-id><pub-id pub-id-type="doi">10.1038/s41576-023-00586-w</pub-id></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>scGen predicts single-cell perturbation responses</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>715</fpage><lpage>721</lpage><pub-id pub-id-type="pmid">31363220</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>The challenge of integrating datasets with substantial batch effects.</title><p>(<bold>a</bold>) Substantial batch effects are present between different biological “systems”, such as cross-species, organoid-tissue, and cell-nuclei datasets. We selected one dataset for each of these three between-system integration types as shown in panel <bold>c</bold>. (<bold>b</bold>) Integrating datasets with substantial batch effects poses a bigger challenge than integrating datasets of similar samples across laboratories, where the batch effect is smaller. In this study, we evaluate different approaches for improving cVAE-based batch correction. (<bold>c</bold>) Pre-integration distances between samples from the same or different systems. Points show mean per cell type. (<bold>d</bold>) Overview of approaches for improving batch removal in cVAE-based models: KL-loss-based regularization of the latent space, the use of the VampPrior as a replacement for the standard Gaussian prior, and adversarial learning and cycle-consistency loss that actively push together samples from different systems. Parts of the cVAE model were omitted from individual panels for brevity. For a detailed description of the standard cVAE and its extensions, see the <xref ref-type="sec" rid="S9">methods</xref> section <italic>Overview of cVAE-based integration approaches</italic>.</p></caption><graphic xlink:href="EMS190624-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Adversarial learning and KL regularization strength tuning struggle with retaining biological variation when increasing batch correction.</title><p>(<bold>a</bold>) Integration performance of scaled and unscaled cVAE embedding with different KL regularization loss weights. Shown are batch correction (iLISI, higher is better) and cell type level biological preservation (NMI fixed, higher is better) metrics scaled to [0,1] per metric. Individual runs with different seeds are shown as points and their averages (avg.) as lines. Results are presented for mouse-human data, with similar performance trends observed in other data use cases as reported in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S4</xref>. (b) UMAP visualization of mouse-human dataset integrated with standard cVAE model and GLUE with the best hyperparameter setting, colored by cell type. Red circles mark examples of cell types that are mixed in the GLUE but not the cVAE integration.</p></caption><graphic xlink:href="EMS190624-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Multimodal priors improve batch correction and biological preservation.</title><p>Scatter plots of cell-type level biological preservation metric (NMI, higher is better) and batch correction metric (iLISI, higher is better) scores for different models (panels), including a VampPrior model with fixed prior components. Small circles represent individual runs with different seeds and crosses their averages. Points are colored by the number of prior components. The average performances of the models with a single prior component are encircled. Results are shown for the mouse-human data, with other data use cases exhibiting similar trends as presented in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S8</xref>.</p></caption><graphic xlink:href="EMS190624-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Adversarial learning is more prone to cell type mixing than cycle-consistency loss.</title><p>Shown is cell type mixing score measured with the Jaccard index between clusters and ground-truth labels (higher is better) and iLISI score. Jaccard index was min-max-scaled per cell type. Results are presented for integration of the mouse-human dataset with GLUE and CYC models with different loss weights of losses that regulate batch correction. Individual cell types are annotated with the number of cells in the more abundant system and the ratio of cells between the less and the more abundant system. Red boxes mark example cell types that are commonly mixed by the adversarial model, especially when increasing batch correction strength. Cell populations representing technical doublets are marked with “+” in their name.</p></caption><graphic xlink:href="EMS190624-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>While existing models struggle with over- or under-integration, the VAMP+CYC model achieves a good trade-off between batch correction and biological preservation.</title><p>(<bold>a</bold>) We show the integration performance of individual models using the best hyperparameter settings, with different integration metrics in columns (larger values indicate better integration performance) and cross-system data cases in rows, showing the average performance (vertical line) of three runs (dots). The results of all hyperparameter settings are in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S1</xref>. (<bold>b</bold>) UMAPs of representative runs for the best hyperparameter setting in the mouse-human dataset. A legend for sample colors is not shown due to the large number of samples. UMAPs for the other two data use cases are shown in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S5</xref>. (<bold>c</bold>) Schematic representation of the VAMP+CYC model in accordance to the explanation of the VampPrior and latent cycle-consistency loss from <xref ref-type="fig" rid="F1">Figure 1d</xref>.</p></caption><graphic xlink:href="EMS190624-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>VAMP+CYC empowers post-integration analysis of biological variation.</title><p>(<bold>a</bold>) UMAPs of Mueller cells based on representative runs for the best hyperparameter setting in the organoid-tissue dataset. The UMAPs are colored by the cell density of organoid and tissue periphery cells, which are expected to overlap, and of tissue fovea cells expressing <italic>RHCG</italic>, which are expected to separate from the other two cell populations. Results for all models are shown in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S11</xref>. (<bold>b</bold>) Expression of gene groups known to be heterogeneous within individuals, shown on UMAPs of beta cells from one healthy adult mouse pancreatic sample from the mouse-human data. We compare the heterogeneity before and after integration and quantitatively asses gene group variability with Moran’s I (MI). For every model, one representative run from the best hyperparameter setting was selected (as shown in <xref ref-type="fig" rid="F5">Figure 5b</xref>). Results for all models and remaining gene groups are shown in <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure S12c</xref>.</p></caption><graphic xlink:href="EMS190624-f006"/></fig></floats-group></article>