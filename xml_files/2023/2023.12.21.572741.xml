<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS193102</article-id><article-id pub-id-type="doi">10.1101/2023.12.21.572741</article-id><article-id pub-id-type="archive">PPR778227</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>FlowAtlas.jl: an interactive tool bridging FlowJo with computational tools in Julia</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Coppard</surname><given-names>Valerie</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">+</xref></contrib><contrib contrib-type="author"><name><surname>Szep</surname><given-names>Grisha</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN1">+</xref></contrib><contrib contrib-type="author"><name><surname>Georgieva</surname><given-names>Zoya</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">+</xref></contrib><contrib contrib-type="author"><name><surname>Howlett</surname><given-names>Sarah K.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Jarvis</surname><given-names>Lorna B.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Rainbow</surname><given-names>Daniel B.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Suchanek</surname><given-names>Ondrej</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Needham</surname><given-names>Edward J.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Mousa</surname><given-names>Hani S.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Menon</surname><given-names>David K.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Feyertag</surname><given-names>Felix</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Mahbubani</surname><given-names>Krishna T.</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Saeb-Parsy</surname><given-names>Kourosh</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Jones</surname><given-names>Joanne L.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib></contrib-group><aff id="A1"><label>1</label>University of Cambridge, Department of Clinical Neurosciences, Cambridge, UK</aff><aff id="A2"><label>2</label>King’s College London, Randall Centre for Cell &amp; Molecular Biophysics, London, UK</aff><aff id="A3"><label>3</label>University of Cambridge, Department of Medicine, Cambridge UK</aff><aff id="A4"><label>4</label>Department of Anaesthesia, University of Cambridge, Cambridge, UK</aff><aff id="A5"><label>5</label>Department of Surgery, University of Cambridge, and Cambridge NIHR Biomedical Research Centre, Cambridge, UK</aff><aff id="A6"><label>6</label>Freelance Bioinformatician, Oxford, UK</aff><author-notes><fn id="FN1"><label>+</label><p id="P1">Cofirst authors</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>31</day><month>12</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>22</day><month>12</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">As the dimensionality, throughput, and complexity of cytometry data increases, so does the demand for user-friendly, interactive analysis tools that leverage high-performance machine learning frameworks. Here we introduce FlowAtlas.jl: an interactive web application that bridges the user-friendly environment of FlowJo and computational tools in Julia developed by the scientific machine learning community. We demonstrate the capabilities of FlowAtlas using a novel human multi-tissue, multi-donor immune cell dataset, highlighting key immunological findings.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P3">Rapid advancements in flow and mass cytometry have brought about a new era of high-dimensional cell phenotyping. However, this has not been matched by developments in free-access, coding-free, user-friendly, interactive data analysis tools. Computational pipelines built in scripting languages such as R or Python, require significant coding literacy, hampering their adoption by the wider biomedical community. Additionally, the limited computing power of most laboratory computers often demands data down-sampling to run commonly used dimensionality reduction (DR) methods, risking loss of rare cell populations.</p><p id="P4">Although DR and cell population clustering algorithms have gradually been integrated into popular analysis platforms such as FCS Express and FlowJo as core features or add-on plugins, these implementations of algorithms such as FlowSOM and tSNE can lack downstream interactivity with the dimensionality-reduced data and still require substantial data down-sampling, ultimately reducing their utility. In addition, as open data access becomes the standard, there is a need for computational tools that allow datasets, acquired using different cytometry panels, to be integrated to facilitate data re-use and validation.</p><p id="P5">Here we introduce FlowAtlas — a free-access, graphical data analysis environment that aims to address these problems. We chose to write FlowAtlas in Julia [<xref ref-type="bibr" rid="R1">1</xref>], a programming language specifically designed for high-performance scientific computing and machine learning applications. This gave us access to some of the fastest algorithms available today [<xref ref-type="bibr" rid="R1">1</xref>],[<xref ref-type="bibr" rid="R2">2</xref>]. We showcase the capabilities of FlowAtlas using a novel, human flow cytometry dataset, consisting of immune cells extracted from tissues of five deceased organ donors and immunophenotyped using three different antibody panels.</p></sec><sec id="S2"><title>FlowAtlas Design</title><sec id="S3"><title>FlowAtlas integrates with FlowJo</title><p id="P6">We designed FlowAtlas to be an open source, fully graphical, interactive high-dimensional data exploration tool that does not rely on command-line input or coding literacy. FlowAtlas links the familiar FlowJo workflow with a high-performance machine learning framework enabling rapid computation of millions of high-dimensional events without the need for down-sampling (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><p id="P7">FlowAtlas parses user-defined individual channel transformation settings from FlowJo as well as channel, gate and sample group names, ensuring optimal embedding geometry and ease of data exploration. The resulting embedding is highly interactive, offering zooming to explore deeper cluster structures, colouring and filtering of embedded events by custom conditions, generation of frequency statistics and drawing of regions of interest (ROIs) to perform comparative analysis of marker expression using violin plots. Moreover, FlowAtlas allows merging and concurrent analysis of non-identical panels. Individual samples remain identifiable in the embedding, since the files are not concatenated.</p><p id="P8">Data exploration happens in an iterative, user-guided discovery loop with FlowJo, where traditional FlowJo gating strategies provide the initial annotation of main cell populations, experimental conditions, and sample groupings to enable the identification of new subpopulations in the interactive embedding. The user periodically returns to FlowJo to add new population annotations as they are discovered in FlowAtlas.</p></sec><sec id="S4"><title>FlowAtlas enables rapid dimensionality reduction without data downsampling</title><p id="P9">We eliminated the need for data down-sampling and enabled visual exploration of hundreds of millions of cells by utilising methods within the GigaSOM.jl<sup>3</sup> library and the interactive web libraries OpenLayers [<xref ref-type="bibr" rid="R3">3</xref>] and D3.js [<xref ref-type="bibr" rid="R4">4</xref>].</p><p id="P10">GigaSOM.jl library and its constituent algorithms implement the functionality of self-organising map (SOM)-based clustering [<xref ref-type="bibr" rid="R5">5</xref>] and dimensionality reduction in Julia programming language. This enables considerable improvements in computational performance [<xref ref-type="bibr" rid="R6">6</xref>] over the current gold-standard SOM and metaclustering-based R package FlowSOM [<xref ref-type="bibr" rid="R7">7</xref>], utilised by the majority of open-source analysis workflows and commercial software platforms including FlowJo and Cytobank [<xref ref-type="bibr" rid="R8">8</xref>]. The dimensionality reduction algorithm, EmbedSOM, used in the GigaSOM library, has demonstrated a reduction in the computational time requirements of 10-30-fold against popular dimensionality reduction algorithms including UMAP and tSNE [<xref ref-type="bibr" rid="R9">9</xref>].</p><p id="P11">We compared the computational performance of FlowAtlas to two alternative tools for dimensionality reduction that also do not require command-line input on a laboratory laptop with the following identical configuration: Dell XPS15, 64-bit Windows OS, 32GB RAM, 8<sup>th</sup> generation core i7-8750H processor, 2.20 GHz. Examples graphical outputs from DR with each tool are shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>.</p><p id="P12">Our tissue-derived immune cell conventional flow cytometry dataset, which is presented as an example throughout this manuscript, consists of 3.88 million total live single cell events (32 FCS files, 19 fluorescence parameters). Donor characteristics, panels and antibodies used are shown in <xref ref-type="supplementary-material" rid="SD8">Supplementary Table 1</xref>, <xref ref-type="supplementary-material" rid="SD9">Supplementary Table 2</xref> and <xref ref-type="supplementary-material" rid="SD10">Supplementary Table 3</xref>.</p><p id="P13">Dimensionality reduction of samples stained with panel C (2.32 million events) in FlowJo (v10.8.1), using the inbuilt tSNE function, took 49 min. In FCS Express (v7.18.0025), the same subset of samples was processed in 125 min. The full dataset could not be subjected to DR on these platforms due to panel differences preventing file concatenation.</p><p id="P14">The full dataset (panel A, B, and C 3.88 million events) was processed in FlowAtlas in 18 min, which included DR and clustering steps (<xref ref-type="table" rid="T1">Table 1</xref>). When analysed as individual files or group of files concatenated by panel, FlowJo tSNE processed the full dataset of 3.88 million events in 6 hours. We did not attempt the same procedure in FCS Express, but it was expected to exceed 125 min required for DR of panel C samples.</p><p id="P15">Additionally, we compared the performance of FlowAtlas against two other non-command line clustering tools: the EmbedSOM clustering algorithm (v2.1.7) implemented as a plugin in FlowJo; and the FlowSOM algorithm implemented in the popular subscription-based cloud analysis platform Cytobank. For this test, we utilised a spectral cytometry dataset of whole human blood, which is publicly available as a demonstration experiment in Cytobank repository [<xref ref-type="bibr" rid="R10">10</xref>]. This dataset contains whole peripheral blood samples in 3 FCS files (23 fluorescence parameters, 512,000 events). The published data were fully unmixed and compensated; we cleaned them of debris based on scatter parameters prior to analysis, leaving 449,488 events. In FlowJo (v10.8.1), we recreated the basic gating strategy demonstrated in the Cytobank analysis to identify large major cell populations including granulocytes, B-cells, T-cells and NK cells (<xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 2</xref>). We then subjected the total single cell events to DR and clustering in FlowAtlas, according to the procedure described in “Recommended FlowAtlas workflow: iterative interactive cell population discovery integrated with FlowJo”. In parallel, we replicated the demonstrated DR analysis in Cytobank (FlowSOM-on-viSNE, consensus clustering, 23 clustering parameters, without normalisation, 20 metaclusters and 100 clusters, seed 770593711). Analysis in Cytobank recommended downsampling to 420,000 events by equal random sampling (actual number of sampled events= 421,669). Lastly, we subjected the same cleaned FCS files to EmbedSOM clustering in FlowJo (v10.8.1, EmbedSOM v2.1.7; k nearest neighbours = 25, SOM grid= 20 x 20).</p><p id="P16">Clustering in Cytobank was executed in 12 minutes, excluding time required for prior viSNE dimensionality reduction. Computation in FlowAtlas took 2.5min, including embedding time. Computation in FlowJo completed in 5min 30s and, as expected, it created three embeddings with different topography (one per file, since files were not concatenated prior to analysis).</p></sec><sec id="S5"><title>Recommended FlowAtlas workflow: iterative interactive cell population discovery integrated with FlowJo</title><p id="P17">A typical analysis workflow using FlowAtlas concurrently with FlowJo is described in <xref ref-type="fig" rid="F1">Figure 1</xref>. We recommend to quality control raw FCS files and remove anomalous events using dedicated tools such as FlowAI [<xref ref-type="bibr" rid="R11">11</xref>] or FlowCut [<xref ref-type="bibr" rid="R12">12</xref>]. The cleaned files should then be opened in FlowJo where the compensation accuracy is verified and live, single cells are gated and exported as new FCS files. If merging of datasets from different experiments is required for the analysis, it is recommended to consider batch-correcting the data using tools such as cyCombine [<xref ref-type="bibr" rid="R13">13</xref>] or CytoNorm [<xref ref-type="bibr" rid="R14">14</xref>] before proceeding to FlowAtlas. Following these pre-processing steps (<xref ref-type="fig" rid="F1">Figure 1 a, b</xref>- Step1), the dataset is opened in a new FlowJo workspace and antibody labels are assigned to fluorescence channels (<xref ref-type="fig" rid="F1">Figure 1 b</xref>- Step 2). Resolving naming discrepancies between channels of non-identical panels, as shown in our example, is critical because, to perform panel merging, FlowAtlas uses user-specified channel labels. FlowAtlas defaults to native fluorescence detector names when labels are not provided, which will prevent the panel merge.</p><p id="P18">Next, panel-specific gating hierarchy is created in FlowJo to define known populations of interest across all datasets (<xref ref-type="fig" rid="F1">Figure 1 b</xref>, Step- 3 and <xref ref-type="fig" rid="F2">Figure 2</xref>). This is a user-supervised population-defining step and initial annotations typically represent large populations, such as naïve/memory B-cells, or CD4/CD8 memory cells. Biexponential transformations can be applied to each channel in FlowJo, visually selecting the most appropriate co-factor for each parameter in the dataset. FlowAtlas parses the biexponential transformation directly from FlowJo for each channel, enabling the user to set optimal population separation. This in turn has been shown to dictate the quality of dimensionality reduction and metaclustering [<xref ref-type="bibr" rid="R15">15</xref>].</p><p id="P19">Matching populations, irrespective of panel, are assigned the same annotation to enable cross-dataset pooling in FlowAtlas and analysis. Cells that fall outside of FlowJo-defined gates are auto-annotated as ”Unlabelled” by FlowAtlas and can still be explored. Finally, to facilitate data exploration, samples are grouped by conditions enabling FlowAtlas to filter and colour-code embedded events (<xref ref-type="fig" rid="F1">Figure 1 b</xref>- Step 4). For our analysis, samples were grouped by donors and tissues. The FlowJo workspace file is then imported into FlowAtlas, which triggers panel merging, calculation of the embedding and launches an interactive browser interface (<xref ref-type="fig" rid="F1">Figure 1c</xref>).</p><p id="P20">The user interface displays the embedding map, which can be zoomed and panned, and is rendered efficiently using OpenLayers [<xref ref-type="bibr" rid="R3">3</xref>].</p><p id="P21">The left-hand panel menu was designed with D3.js [<xref ref-type="bibr" rid="R4">4</xref>] and has four tabs: ”Annotations”, ”Expression”, ”Frequency” and ”Settings”. The ”Annotations” tab enables cell filtering and re-colouring by population, condition, or by heat-map of marker expression. The filters can also be renamed or re-ordered here by dragging-and-dropping. The ”Expression” tab has a polygon tool that enables drawing of multiple ROIs directly in the embedding to produce overlaid violin plots (<xref ref-type="fig" rid="F1">Figure 1 c</xref>, <xref ref-type="fig" rid="F3">Figure 3c</xref>, <xref ref-type="supplementary-material" rid="SD3">Supplementary Figure 3</xref> and <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 4</xref>) that reveal differences in marker expression thus enabling rapid identification of clusters with unique signatures. In the ”Frequency” tab frequency box plots can be generated with a few clicks (<xref ref-type="fig" rid="F3">Figure 3a</xref> and <xref ref-type="supplementary-material" rid="SD5">Supplementary Figure 5</xref>) showing frequencies of selected populations relative to their sum or any other population. Box plot marker colours and categories displayed on the x-axis are defined by filter selections in the “Annotations” tab. These features enable ”on-the-fly”, intuitive exploration and analysis of complex datasets. All figures can be exported as publication-quality scalable vector graphics (SVG).</p><p id="P22">Once unique subpopulations have been identified, they can be validated in FlowJo with targeted two-parameter plots and new gates created to be read by FlowAtlas at rerun. This ”iterative discovery loop” substantially simplifies discovery.</p><p id="P23">Embedding is performed only once when the workspace file is first imported and is stored in a cache file with a ”.som” extension, allowing users to return to their analysis quickly. The embedding can also be re-calculated to change cluster geometry. Sharing the “.som” cache file together with the FlowJo workspace and FCS files enables collaboration, allowing colleagues to work on the same embedding map.</p><p id="P24">Hereafter, we demonstrate the capabilities of FlowAtlas using our novel conventional cytometry dataset of multi-donor multi-tissue derived immune cells. Utilisation of FlowAtlas for analysis of spectral and CyTOF data is shown in <xref ref-type="fig" rid="F4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="SD6">Supplementary Figure 6</xref> respectively.</p></sec></sec><sec id="S6"><title>Demonstrating the utility of FlowAtlas</title><sec id="S7"><title>Example cell population exploration</title><p id="P25">Our dataset consists of 32 files of tissue-derived immune cells obtained from 5 deceased transplant organ donors (<xref ref-type="supplementary-material" rid="SD8">Supplementary Table 1</xref>), stained with 3 different panels (<xref ref-type="supplementary-material" rid="SD9">Supplementary Table 2</xref>). The data were pre-processed in FlowJo to remove anomalous events, debris and aggregates; compensation was checked; and live, single T cells were exported as new FCS files for downstream analysis. These files were imported into a new FlowJo workspace and each channel was biexponentially transformed, basic populations were gated (<xref ref-type="fig" rid="F2">Figure 2</xref>), and samples were grouped by donor ID and source tissue. Next, DR and clustering were performed in FlowAtlas. After generating relative abundance boxplots of the major lymphocyte populations in our dataset (<xref ref-type="supplementary-material" rid="SD5">Supplementary Figure 5</xref>), we elected to zoom into the CD4 regulatory T-cell (Treg) compartment, defined as CD3<sup>+</sup>CD4<sup>+</sup>CD127<sup>-/lo</sup>FOXP3<sup>+</sup> cells, as an exemplar.</p><p id="P26">As a proportion of all CD4<sup>+</sup> T-cells,Tregs were demonstrated to be enriched in lymph nodes, particularly mesenteric lymph nodes where they accounted for more than 20% of CD4 T-cells in all studied donors (<xref ref-type="fig" rid="F3">Figure 3 a</xref>).</p><p id="P27">The embedding of Tregs for Panel C donors, recoloured by the expression of the transcription factor HELIOS (<xref ref-type="fig" rid="F3">Figure 3 b</xref>), revealed the presence of HELIOS<sup>+</sup> and HELIOS<sup>-</sup> subpopulations as expected [<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R17">17</xref>], with additional subcluster structures. Next, we filtered the embedding by panel C samples and used it to explore Treg subcluster characteristics further. We coloured embedded events by tissue of origin and drew ROIs around four main subclusters seen in the embedding (<xref ref-type="fig" rid="F3">Figure 3 c</xref>). Auto-generated violin plots quickly allowed us to observe differences in expression of CD45RA, CCR7, CCR4 and CD69 between these subclusters, with the red ROI having a naive phenotype (CD45RA<sup>+</sup>CCR7<sup>+</sup>) and lacking CCR4 and CD69 expression, while yellow, grey and violet ROIs showed characteristics of memory subsets (CD45RA<sup>-/lo</sup>CCR7<sup>-</sup>) with and without CD69 and CCR4 expression. Filtering the embedding by tissue with the above ROIs superimposed (<xref ref-type="fig" rid="F3">Figure 3 d</xref>), revealed tissue-specific enrichment patterns; for example, CD69<sup>+</sup> subsets were largely absent from blood, consistent with the role of CD69 in promoting tissue retention [<xref ref-type="bibr" rid="R18">18</xref>] [<xref ref-type="bibr" rid="R19">19</xref>] [<xref ref-type="bibr" rid="R20">20</xref>], whereas liver, lung, and thoracic lymph nodes contained a high proportion of Tregs expressing the chemokine receptor CCR4<sup>+</sup> (with or without CD69 co-expression).</p><p id="P28">CCR4 has been implicated in T-cell trafficking to the lung [<xref ref-type="bibr" rid="R21">21</xref>], and in the infiltration of Tregs into tumours [<xref ref-type="bibr" rid="R22">22</xref>]. Next, we validated the presence of these four Treg subsets in FlowJo (<xref ref-type="fig" rid="F3">Figure 3 e</xref>) and created new gates using CCR4 and CD69- now in all samples stained with these markers, irrespective of panel- for further exploration in FlowAtlas. Returning to FlowAtlas, we re-coloured the Treg embedding by these newly annotated subsets and generated frequency box plots (<xref ref-type="fig" rid="F3">Figure 3 f</xref>), which further highlighted tissue-specific expression patterns.</p><p id="P29">FlowAtlas allowed us to obtain deep insights into the Treg population rapidly and intuitively. Therefore, we applied a similar analysis strategy to CD4<sup>+</sup> Th1 and CD8<sup>+</sup> memory cells, producing further data in a matter of minutes (<xref ref-type="supplementary-material" rid="SD3">Supplementary Figure 3</xref> and <xref ref-type="supplementary-material" rid="SD4">Supplementary Figure 4</xref>). This contrasts with analysis solely performed within FlowJo, where the computation of our full dataset embedding of 3.88 million events using tSNE would have been prohibitively slow (6h, see <xref ref-type="table" rid="T1">Table 1</xref> for comparison of performance) and assessing all possible combinations of markers using two-dimensional plots would have been a laborious process.</p><p id="P30">Although EmbedSOM is now implemented as a FlowJo plugin, downstream exploration of the resulting embedding still relies on classic 2-way scatter plots and cannot be zoomed or easily filtered by custom conditions. Furthermore, preserving a consistent topography across samples requires either file concatenation, or clustering by FlowSOM first- both of which impose that all samples are stained with the same panel. FlowAtlas overcomes these barriers, making the embedded data interactive, and patterns within it- quickly visible.</p></sec><sec id="S8"><title>Detection of rare cell subsets using FlowAtlas</title><p id="P31">Current DR computational pipelines reduce computation time by downsampling large datasets using random uniform sampling, which may not optimally reflect the distribution of the original data [<xref ref-type="bibr" rid="R23">23</xref>]. Rare cell subsets may be missed by data downsampling and underfitting in existing unsupervised clustering approaches. Since FlowAtlas does not downsample, it potentially circumvents this problem.</p><p id="P32">Accordingly, we tested the ability of FlowAtlas to discover novel rare cell populations in the above-mentioned 23-parameter spectral cytometry dataset of whole human blood [<xref ref-type="bibr" rid="R10">10</xref>]. As described, we performed the analysis in FlowAtlas and then replicated the example analysis demonstrated in Cytobank from curated experiment number 191382. The gating strategy for this dataset is shown in <xref ref-type="supplementary-material" rid="SD2">Supplementary Figure 2</xref>. Using FlowAtlas, we identified a subset of HLA-DR<sup>+</sup> NK cells, comprising only 0.69% of total NK cells in under 30 min (<xref ref-type="fig" rid="F4">Figure 4</xref>, steps 1a-4a). The same population was not resolved as a separate metacluster in Cytobank FlowSOM-on-viSNE analysis at the implemented settings (<xref ref-type="fig" rid="F4">Figure 4</xref>, steps 1b and 2b). Furthermore, CD56<sup>bright</sup> NK cells, which are well known to be phenotypically and functionally distinct [<xref ref-type="bibr" rid="R24">24</xref>], also did not segregate from the main NK cell population at these analysis settings. In order to find the missing HLA-DR<sup>+</sup> CD56<sup>+</sup> subpopulation in Cytobank, it was necessary to review the 10 individual clusters comprising CD56<sup>+</sup> events in the minimum spanning tree (MST), coloured by each channel median fluorescence intensity (MFI), which was a time-consuming process. We noted that cluster 15 within metacluster 4 was located away from the main metacluster 4 nodes and that it contained a small subset of HLA-DR<sup>+</sup> CD56<sup>+</sup> NK cells (<xref ref-type="fig" rid="F4">Figure 4</xref>, step 3b and 4b). These may be the equivalent population to the cells discovered in FlowAtlas. We verified that the other 9 neighbouring NK-cell clusters did not contain this population, by examining scatter plots of their key identifying markers (HLA-DR, CD11c) versus cluster number (not shown). Finally, we isolated the subpopulation manually based on its cluster number. This process took several hours and was informed by our prior identification of this population in FlowAtlas.</p><p id="P33">Resolution of other rare populations would potentially require each of the 100 clusters in the MST to be individually examined, as above. Once discovered, a rare subpopulation would either need to be manually isolated by combining the clusters that contain it with Boolean commands, or a new clustering would need to be undertaken with optimised settings or starting with a purer cell population. By contrast, FlowAtlas allows the user to simply zoom in on the existing embedding to study the substructure of clusters without needing to re-embed the data.</p></sec><sec id="S9"><title>FlowAtlas can integrate multiple flow cytometry panels, but protocol-driven experiment harmonisation remains critical</title><p id="P34">Due to an evolution of panel design, our tissue-derived immune cell dataset consisted of 3 different panels. Most existing computational tools require the concatenation of files prior to analysis, which is impossible when different markers have been assigned to the same channel. This would typically cause researchers to exclude precious data that they cannot integrate.</p><p id="P35">FlowAtlas enables data re-use and concomitant analysis of datasets acquired with non-identical antibody panels by imputing missing values using random sampling with replacement before DR. Algorithmic bias is prevented by excluding imputed values from the embedding visualisation or any downstream analyses.</p><p id="P36">To demonstrate the capability to merge panels, we acquired 2 healthy control blood samples and stained them with the 3 panels previously used in our main tissue-derived dataset. We integrated the 6 new FCS files (1.28 million live single T-cell events) into the existing embedding of tissue-derived immune cells. The use of the same two donors eliminated any biological variation, enabling us to isolate the effect of panel differences within the healthy control group.</p><p id="P37">We filtered the embedded data by “healthy control”, then coloured the embedding by panel and inspected differences in cluster position, geometry and marker mean fluorescence intensity (MFI). Violin plots revealed variation in marker expression due to panel design differences, e.g. lower CD4 MFI for panels B and C compared to panel A, due to use of different fluorochromes (see <xref ref-type="supplementary-material" rid="SD9">Supplementary Table 2</xref>). The overall embedding geometry was highly conserved across the three panels (<xref ref-type="fig" rid="F5">Figure 5a</xref>).</p><p id="P38">Next, we filtered samples stained with panel C, displayed only blood-derived cells, and coloured the samples by batch (healthy controls vs deceased organ donors, <xref ref-type="fig" rid="F5">Figure 5b</xref>). We noted significant qualitative differences in the embedding geometry for these two sets of samples. The resulting violin plots showed differences in several chemokine receptors, CD127, CD4 and CD8. Although biological differences between healthy and deceased donor blood could account for this observation, the magnitude of the differences strongly suggested an additional batch effect, potentially due to the fact that, unlike the tissue-derived dataset, healthy PBMCs had been cryopreserved and acquired on a cytometer with a different optical configuration (See <xref ref-type="sec" rid="S11">Methods</xref> and <xref ref-type="supplementary-material" rid="SD11">Supplementary Table 4</xref>). This was unsurprising, but important to highlight, given that FlowAtlas does not perform MFI normalisation.</p><p id="P39">We have noted that panels with very few shared markers and/or fluorochromes can still be processed but in this case, equivalent populations will likely fail to co-localise adequately due to a lack of common landmarks (<xref ref-type="supplementary-material" rid="SD7">Supplementary Figure 7</xref>).</p><p id="P40">In summary, FlowAtlas is relatively robust at handling samples with moderately different panels where marker MFIs have not been normalised, but optimum co-localisation of equivalent populations requires batch-normalisation at pre-processing, and that panel differences are minimal.</p></sec></sec><sec id="S10" sec-type="discussion"><title>Discussion</title><p id="P41">FlowAtlas is a novel open-source data exploration tool, which combines the computational power of the GigaSOM library and Julia programming language with the widely used software FlowJo, expanding its capabilities in a completely graphical, fast, user-friendly interface. This approach removes all entry barriers imposed by command-line analysis pipelines that currently hold many users back from taking advantage of powerful computational tools. FlowAtlas brings a new iterative analysis concept to biomedical scientists by linking the familiar FlowJo workflow with a high-performance machine learning framework. FlowAtlas allows rapid computation of millions of high-dimensional events without the need for down-sampling. The highly interactive embedding enables zooming and intuitive exploration of population substructure, considerably speeding up population discovery. Missing-data handling methods enable concomitant analysis of datasets with non-identical panel designs or markers.</p><p id="P42">Importantly, FlowAtlas does not incorporate batch normalisation, and, to prevent algorithmic bias, does not display imputed values in the embedding. Here, we briefly discuss the rationale behind our design decision.</p><p id="P43">Firstly, we designed FlowAtlas without a data normalisation step so that users can select the most appropriate method for eliminating technical variability for their specific experimental context at the data pre-processing step.</p><p id="P44">Best practice currently relies on inter-laboratory protocol harmonisation through the use of standardised antibody cocktails, identical staining procedures, calibration of cytometers using fluorescence standards or Application Settings [<xref ref-type="bibr" rid="R25">25</xref>] and internal biological “anchor” controls stained with each batch of samples. Anchor controls enable batch correction using pipelines such as swiftReg in R [<xref ref-type="bibr" rid="R26">26</xref>] and CytoNorm [<xref ref-type="bibr" rid="R14">14</xref>]. The latter is available as a FlowJo plugin and circumvents the need for coding expertise. These protocol-based approaches, which we used to acquire our tissue-derived immune cell dataset, would likely best suit the primary target user demographic of FlowAtlas.</p><p id="P45">In the absence of internal anchor controls, the currently available computational methods of batch correction mostly require considerable command-line competence. For example, GaussNorm (in R) aligns cellular landmarks (positive and negative population peaks) across samples [<xref ref-type="bibr" rid="R27">27</xref>]. This approach may eliminate biologically relevant MFI differences and is only suitable when population frequency is the variable of interest. Powerful batch correction tools rooted in single-cell genomics packages are now finding application in flow and mass cytometry, e.g. Seurat (in R) [<xref ref-type="bibr" rid="R28">28</xref>] and Pytometry (in Python) [<xref ref-type="bibr" rid="R29">29</xref>]. The stringency of batch effect removal versus biological effect preservation varies widely between these methods [<xref ref-type="bibr" rid="R30">30</xref>], so the optimum analysis pipeline may vary between datasets. These pipelines were originally developed to handle very high-dimensional data with thousands of observations per parameter and high batch variability (e.g. different technology platforms). Datasets with very few observations per sample, in which batch effects are driven by few parameters, as was the case in our tissue-derived dataset, may not be amenable to these correction methods.</p><p id="P46">Secondly, panel merging and missing-data handling methods in FlowAtlas ensure it is relatively robust to moderate panel differences, enabling dataset integration in selected circumstances. We substituted some markers in our panels with completely spectrally unique fluorochromes and demonstrated that FlowAtlas can preserve the embedding geometry under the tested conditions. Nevertheless, panels with little overlap in markers or fluorochromes are unlikely to integrate successfully. Where multiple markers differ, users are advised to test the effectiveness of panel integration by staining a single donor sample with their panels of interest and assessing the resulting embedding geometry. Tools have been developed, which aim to combine panels through marker imputation, e.g. CytoBackBone [<xref ref-type="bibr" rid="R31">31</xref>], CyTOFMerge [<xref ref-type="bibr" rid="R32">32</xref>], Infinicyt (Cytognos, BD) and CyCombine [<xref ref-type="bibr" rid="R13">13</xref>]. Nevertheless, we chose not to display imputed values in the FlowAtlas embedding to protect against bias. A critical assessment of these methods has recently reported relatively poor approximation of known expression values [<xref ref-type="bibr" rid="R33">33</xref>], justifying our decision.</p><p id="P47">In conclusion, FlowAtlas is a novel data exploration tool, which leverages advanced machine learning methods, rapid computational speed, and a near-complete lack of a user learning curve before data exploration can commence. The highly interactive and intuitive workflow eliminates the need for command-line coding and brings high-dimensional data exploration and population discovery to the non-bioinformatician biologist.</p></sec><sec id="S11" sec-type="methods"><title>Methods</title><sec id="S12"><title>Ethical statement</title><p id="P48">All work was completed under ethically approved studies. Healthy human PBMCs were isolated from volunteers having given informed consent under CAMSAFE (REC-11/33/0007). All deceased organ donor tissue samples were collected via the Cambridge Biorepository for Translational Medicine under Research Ethics Committee approval 15/EE/0152. In addition, two donor-matched blood samples were collected prior to withdrawal of life support, under Ethics Committee approval 97/290.</p></sec><sec id="S13"><title>Tissue acquisition and dissociation, and preparation of healthy control PBMCs</title><p id="P49">Tissue was obtained from five deceased organ donors following circulatory death. Donor metadata is given in <xref ref-type="supplementary-material" rid="SD8">Supplementary Table 1</xref>. Briefly, following cessation of circulation, human donor organs were perfused in situ with cold organ preservation solution and cooled with topical application of ice. Samples for the study were obtained within 60 minutes of cessation of circulation and placed in University of Wisconsin organ preservation solution for transport at 4°C to the laboratory. Lung and liver samples were obtained from the left lower lobe of the lung and the right lobe of the liver. In addition, two donor-matched blood samples were collected prior to withdrawal of life support (under REC approval 97/290). To minimise the possibility of processing-dependent differences in cell surface marker expression, all samples, including blood, were processed using enzymatic digestion protocol. Briefly, solid tissues were weighed, transferred into 10cm tissue culture dishes, and cut into small pieces. Up to 5g of tissue was then transferred into a GentleMACS C tube (Miltenyi Biotec) prefilled with 5mL of dissociation media composed of X-VIVO15 with 0.13U/mL Liberase TL (Roche), 10U/mL Benzonase nuclease (Millipore/Merck), 2% (v/v) heat-inactivated foetal bovine serum (FBS, Gibco), penicillin (100 U/ml, Sigma-Aldrich), streptomycin (0.1 mg/ml, Sigma-Aldrich), and 10mM HEPES (Sigma Aldrich). The samples were then homogenised using a GentleMACS Octo dissociator (Miltenyi Biotec) running a protocol that provided gradual ramping up of homogenisation speed and two 15-minute heating/mixing steps at 37°C. Digested tissue was passed through a 70μm MACS Smartstrainer (Miltenyi Biotec) and the flow-through was first washed with X-VIVO15 supplemented with 2 mM EDTA and then with PBS. Mononuclear cells were enriched by Ficoll-Paque (GE Healthcare) density centrifugation according to the manufacturer’s instructions. Following density centrifugation, mononuclear layer was collected, washed once with PBS and the cell pellet was resuspended in FACS buffer (PBS, 2.5% FBS). Bone marrow aspirates and peripheral blood samples were first subjected to Ficoll-Paque density centrifugation, according to manufacturer’s instructions, the mononuclear layer was then collected, washed with PBS and cells were treated with the same dissociation media as solid tissues for 30 min at 37°C prior to washing and resuspension in FACS buffer.</p><p id="P50">Healthy control PBMCs were prepared by Ficoll-gradient centrifugation and cryopreserved in cell freezing medium (Sigma) containing 10% DMSO for future use.</p></sec><sec id="S14"><title>Flow cytometry of tissue-derived mononuclear cells</title><p id="P51">Depending on the cell yield, up to 1x10<sup>6</sup> mononuclear cells/tissue were stained with antibodies shown in <xref ref-type="supplementary-material" rid="SD10">Supplementary Table 3</xref>. Not all donors were stained with the same panel. To expand the total number of markers, sentinel panel design was implemented where CD3 and IgD were detected with antibodies conjugated to BUV395 and FOXP3 and IgM were detected with antibodies conjugated to PE in some donors. Refer to <xref ref-type="supplementary-material" rid="SD9">Supplementary Table 2</xref> for details. Single cell suspensions were washed once in PBS, transferred into 96 v-bottom plate and stained with Zombie UV viability dye for 30 min at 4°C followed by a wash with FACS buffer. Cell pellets were resuspended in 50μl FACS buffer with Human FcR block (BD Biosciences) and incubated for 10 min at 4°C. Next, cells were pelleted, excess buffer removed and 100μl of antibody master mix composed of cell-surface antibody cocktail (see <xref ref-type="supplementary-material" rid="SD9">Supplementary Table 2</xref>), BV buffer (BD) and True-Stain Monocyte Blocker (Biolegend) and incubated for 1h at 4°C. Following incubation, cells were washed three times in PBS and prepared for intracellular staining using transcription factor fixation/permeabilisation kit (eBioscience) according to the manufacturer’s instructions. Following intracellular staining, cells were resuspended in PBS and analysed on BD FACSymphony A3 cell analyser within 10 hours.</p></sec><sec id="S15"><title>Flow cytometry of healthy PBMCs</title><p id="P52">In contrast to tissue-derived samples, which were processed <italic>ex vivo</italic>, healthy PBMC samples were thawed in X-VIVO15/10% FCS at room temperature and stained according to the procedure above. Analysis was performed on a BD FACSymphony A5 cell analyser within 10 hours. The optical configuration of the two cytometers used in this study is shown in <xref ref-type="supplementary-material" rid="SD11">Supplementary Table 4</xref>. The cytometers were not cross-calibrated for comparable measurement of MFI, but each underwent individual CS&amp;T bead quality control before sample acquisition.</p></sec><sec id="S16"><title>Computational methods and step-by-step instructions for FlowAtlas use</title><sec id="S17"><title>Flow cytometry data pre-processing</title><p id="P53">Raw FCS data were cleaned using FlowAI [<xref ref-type="bibr" rid="R11">11</xref>] to remove acquisition anomalies. High-quality files were saved and imported into FlowJo for data pre-processing. In this step, compensation matrices were curated; aggregates and dead cells were gated out; and remaining cells were gated on lymphocytes and T-cells (see <xref ref-type="fig" rid="F2">Figure 2</xref>). The live T-cell gate of each sample was exported as a new FCS file containing only compensated fluorescence channels. The pre-processed files were then opened in a new FlowJo workspace, where antibody labels were assigned to all fluorescence channels.</p><p id="P54">Compensated parameters were exported for live single aggregate-free T-cells from all panels for dimensionality reduction, since we found that this produced optimal geometry for analysing the T-cell population, which was of particular interest. Therefore, we labelled the PE channel as FOXP3 in all files. Also, CD4 was used on either BUV661 (Panel A) or BUV805 (Panels B and C).</p><p id="P55">It is possible to subject the entire Live Singlet aggregate-free population to DR analysis if desired. In this case, CD19<sup>+</sup> events would only be identifiable in samples labelled with panel C; equivalent cells would appear as “Ungated” in other panels. For this workflow, we would recommend labelling the PE channel in all datasets as FOXP3-IgM; this would display both PE-labelled markers on a single violin plot; separate downstream differential expression analysis of each marker is made possible by filtering events by cell type (B-cell or T-cell) in FlowAtlas.</p></sec><sec id="S18"><title>FlowAtlas code availability</title><p id="P56">The code for FlowAtlas is open-source and is available at our GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/gszep/FlowAtlas.jl.git">https://github.com/gszep/FlowAtlas.jl.git</ext-link></p></sec><sec id="S19"><title>Installation and Loading of FlowAtlas</title><p id="P57">FlowAtlas is compatible with FlowJo version 10.8.1.</p><p id="P58">FlowAtlas requires Julia language, which is easily installed on any operating system by downloading an installer available here: <ext-link ext-link-type="uri" xlink:href="https://julialang.org/downloads">https://julialang.org/downloads</ext-link> and following the on-screen instructions. Tick the option to add Julia to PATH environment when prompted.</p><p id="P59">Once Julia is installed, FlowAtlas can be installed and run in three lines of code as follows: <list list-type="order" id="L1"><list-item><p id="P60">Windows: open Run (Windows Key + R), type <bold>cmd</bold> and hit enter. MacOS: open command prompt (Cmd Key + Space), type <bold>terminal</bold> and hit enter. This will launch Windows/MacOS command prompt.</p></list-item><list-item><p id="P61">In the prompt type <bold>Julia</bold> and hit enter. This will launch the Julia environment.</p></list-item><list-item><p id="P62">Type <bold>]</bold> and the prompt will change to display that package manager is now active.</p></list-item><list-item><p id="P63">Type <bold>add FlowAtlas</bold> and hit enter. This will download and install FlowAtlas.jl. Once installation is complete, you can close the command prompt window.</p></list-item></list></p><p id="P64">To start using FlowAtlas, navigate to the folder containing your pre-processed FCS files (make sure that the FlowJo workspace file is there as well) and launch command prompt: in Windows by typing <bold>cmd</bold> in the File Explorer address bar (where file path is usually displayed) and hitting enter or in MacOS launch terminal and navigate to the folder by typing cd followed by the folder path. In the prompt, type <bold>Julia</bold> and hit enter to start it, then type <bold>using FlowAtlas</bold> and hit enter. Once FlowAtlas is loaded, type <bold>FlowAtlas.run(“workspace.wsp”; files=”*/*.fcs”)</bold> where <bold>workspace.wsp</bold> is the name of your FlowJo analysis file with .wsp extension. Adding new files into the workspace after initial analysis will force a recalculation of the embedding.</p><p id="P65">A short video demonstrating the use of FlowAtlas can be watched here: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=FeYrFKgP91s">https://www.youtube.com/watch?v=FeYrFKgP91s</ext-link></p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figure 1</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_1.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Figure 2</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_2.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Figure 3</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_3.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplementary Figure 4</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_4.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary Figure 5</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_5.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFfB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>Supplementary Figure 6</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_6.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFgB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>Supplementary Figure 7</label><media xlink:href="EMS193102-supplement-Supplementary_Figure_7.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFhB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD8"><label>Supplementary Table 1</label><media xlink:href="EMS193102-supplement-Supplementary_Table_1.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFiB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD9"><label>Supplementary Table 2</label><media xlink:href="EMS193102-supplement-Supplementary_Table_2.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFjB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD10"><label>Supplementary Table 3</label><media xlink:href="EMS193102-supplement-Supplementary_Table_3.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFkB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD11"><label>Supplementary Table 4</label><media xlink:href="EMS193102-supplement-Supplementary_Table_4.pdf" mimetype="application" mime-subtype="pdf" id="d81aAdFlB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgements</title><p>We thank the deceased organ donors, donor families, the extended Cambridge Biorepository for Translational Medicine team, and the transplant coordinators for access to the tissue samples. We also thank Professor Linda Wicker (University of Oxford) for her academic insights. This work was funded in part by the Wellcome Trust (Grant number 105924/Z/14/Z; RG79413 to JLJ). For the purpose of open access, the authors have applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. This work was also supported by the NIHR Cambridge Biomedical Research Centre (BRC121520014), and by the Cambridge NIHR BRC Cell Phenotyping Hub. The views expressed are those of the author(s) and not necessarily those of the NIHR or the Department of Health and Social Care. GS was supported by Microsoft Research and by the EPSRC Centre for Doctoral Training in Cross-Disciplinary Approaches to Non-Equilibrium Systems (CANES, EP/L015854/1). ZG was supported by the Wellcome Trust (Grant number 220554/Z/20/Z). HSM was supported by The Rosetrees Trust (RG82826, JS16/M589).</p></ack><sec id="S21" sec-type="data-availability"><title>Data availability</title><p id="P66">All data are made available in FlowRepository <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-Z74D">http://flowrepository.org/id/FR-FCM-Z74D</ext-link>.</p></sec><fn-group><title>Declarations</title><fn id="FN2" fn-type="conflict"><p id="P67"><bold><italic>Ethics</italic></bold></p><p id="P68">JLJ reports receiving consultancy fees and grant support from Sanofi Genzyme. All other authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bezanson</surname><given-names>J</given-names></name><name><surname>Edelman</surname><given-names>A</given-names></name><name><surname>Karpinski</surname><given-names>S</given-names></name><name><surname>Shah</surname><given-names>VB</given-names></name></person-group><article-title>Julia: A Fresh Approach to Numerical Computing</article-title><source>SIAM Rev</source><year>2017</year><month>Jan</month><volume>59</volume><issue>1</issue><fpage>65</fpage><lpage>98</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roesch</surname><given-names>E</given-names></name><name><surname>Greener</surname><given-names>JG</given-names></name><name><surname>MacLean</surname><given-names>AL</given-names></name><name><surname>Nassar</surname><given-names>H</given-names></name><name><surname>Rackauckas</surname><given-names>C</given-names></name><name><surname>Holy</surname><given-names>TE</given-names></name><etal/></person-group><article-title>Julia for Biologists</article-title><source>Nat Methods</source><year>2023</year><month>May</month><volume>20</volume><issue>5</issue><fpage>655</fpage><lpage>64</lpage><pub-id pub-id-type="pmcid">PMC10216852</pub-id><pub-id pub-id-type="pmid">37024649</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01832-z</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="web"><collab>OpenLayers</collab><date-in-citation>cited 2023 Nov 19</date-in-citation><comment>Internet Available from: <ext-link ext-link-type="uri" xlink:href="https://openlayers.org/">https://openlayers.org/</ext-link></comment></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bostock</surname><given-names>M</given-names></name><name><surname>Ogievetsky</surname><given-names>V</given-names></name><name><surname>Heer</surname><given-names>J</given-names></name></person-group><article-title>D<sup>3</sup> Data-Driven Documents</article-title><source>IEEE Trans Visual Comput Graphics</source><year>2011</year><month>Dec</month><volume>17</volume><issue>12</issue><fpage>2301</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">22034350</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohonen</surname><given-names>T</given-names></name></person-group><article-title>Essentials of the self-organizing map</article-title><source>Neural Networks</source><year>2013</year><month>Jan</month><volume>37</volume><fpage>52</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">23067803</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kratochvíl</surname><given-names>M</given-names></name><name><surname>Hunewald</surname><given-names>O</given-names></name><name><surname>Heirendt</surname><given-names>L</given-names></name><name><surname>Verissimo</surname><given-names>V</given-names></name><name><surname>Vondrášek</surname><given-names>J</given-names></name><name><surname>Satagopam</surname><given-names>VP</given-names></name><etal/></person-group><article-title>GigaSOM.jl: High-performance clustering and visualization of huge cytometry datasets</article-title><source>GigaScience</source><year>2020</year><month>Nov</month><day>18</day><volume>9</volume><issue>11</issue><elocation-id>giaa127</elocation-id><pub-id pub-id-type="pmcid">PMC7672468</pub-id><pub-id pub-id-type="pmid">33205814</pub-id><pub-id pub-id-type="doi">10.1093/gigascience/giaa127</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Gassen</surname><given-names>S</given-names></name><name><surname>Callebaut</surname><given-names>B</given-names></name><name><surname>Van Helden</surname><given-names>MJ</given-names></name><name><surname>Lambrecht</surname><given-names>BN</given-names></name><name><surname>Demeester</surname><given-names>P</given-names></name><name><surname>Dhaene</surname><given-names>T</given-names></name><etal/></person-group><article-title>FlowSOM: Using self-organizing maps for visualization and interpretation of cytometry data</article-title><source>Cytometry Part A</source><year>2015</year><volume>87</volume><issue>7</issue><fpage>636</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">25573116</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>T</given-names></name><name><surname>Kotecha</surname><given-names>N</given-names></name></person-group><chapter-title>Cytobank: Providing an Analytics Platform for Community Cytometry Data Analysis and Collaboration</chapter-title><source>High-Dimensional Single Cell Analysis</source><series>Current Topics in Microbiology and Immunology</series><volume>377</volume><publisher-name>Springer</publisher-name><publisher-loc>Berlin, Heidelberg</publisher-loc><comment>Internet</comment><pub-id pub-id-type="pmid">24590675</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kratochvíl</surname><given-names>M</given-names></name><name><surname>Koladiya</surname><given-names>A</given-names></name><name><surname>Vondrášek</surname><given-names>J</given-names></name></person-group><article-title>Generalized EmbedSOM on quadtree-structured self-organizing maps</article-title><source>F1000Res</source><year>2020</year><month>May</month><day>19</day><volume>8</volume><elocation-id>2120</elocation-id><pub-id pub-id-type="pmcid">PMC7255855</pub-id><pub-id pub-id-type="pmid">32518625</pub-id><pub-id pub-id-type="doi">10.12688/f1000research.21642.2</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="book"><collab>Cytobank</collab><source>Cytek Aurora - 23 color immunophenotyping (FlowSOM demo) - Experiment summary - Cytobank</source><publisher-name>Cytobank Premium</publisher-name><date-in-citation>cited 2023 Nov 19</date-in-citation><comment>Internet Available from: <ext-link ext-link-type="uri" xlink:href="https://premium.cytobank.org/cytobank/experiments/191379">https://premium.cytobank.org/cytobank/experiments/191379</ext-link></comment></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monaco</surname><given-names>G</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Poidinger</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>De Magalhães</surname><given-names>JP</given-names></name><name><surname>Larbi</surname><given-names>A</given-names></name></person-group><article-title>flowAI: automatic and interactive anomaly discerning tools for flow cytometry data</article-title><source>Bioinformatics</source><year>2016</year><month>Aug</month><day>15</day><volume>32</volume><issue>16</issue><fpage>2473</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">27153628</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meskas</surname><given-names>J</given-names></name><name><surname>Yokosawa</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Segat</surname><given-names>GC</given-names></name><name><surname>Brinkman</surname><given-names>RR</given-names></name></person-group><article-title>flowCut: An R package for automated removal of outlier events and flagging of files based on time versus fluorescence analysis</article-title><source>Cytometry Part A</source><year>2023</year><volume>103</volume><issue>1</issue><fpage>71</fpage><lpage>81</lpage><pub-id pub-id-type="pmcid">PMC9823164</pub-id><pub-id pub-id-type="pmid">35796000</pub-id><pub-id pub-id-type="doi">10.1002/cyto.a.24670</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedersen</surname><given-names>CB</given-names></name><name><surname>Dam</surname><given-names>SH</given-names></name><name><surname>Barnkob</surname><given-names>MB</given-names></name><name><surname>Leipold</surname><given-names>MD</given-names></name><name><surname>Purroy</surname><given-names>N</given-names></name><name><surname>Rassenti</surname><given-names>LZ</given-names></name><etal/></person-group><article-title>cyCombine allows for robust integration of single-cell cytometry datasets within and across technologies</article-title><source>Nat Commun</source><year>2022</year><month>Mar</month><day>31</day><volume>13</volume><issue>1</issue><elocation-id>1698</elocation-id><pub-id pub-id-type="pmcid">PMC8971492</pub-id><pub-id pub-id-type="pmid">35361793</pub-id><pub-id pub-id-type="doi">10.1038/s41467-022-29383-5</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Gassen</surname><given-names>S</given-names></name><name><surname>Gaudilliere</surname><given-names>B</given-names></name><name><surname>Angst</surname><given-names>MS</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Aghaeepour</surname><given-names>N</given-names></name></person-group><article-title>CytoNorm: A Normalization Algorithm for Cytometry Data</article-title><source>Cytometry Part A</source><year>2020</year><volume>97</volume><issue>3</issue><fpage>268</fpage><lpage>78</lpage><pub-id pub-id-type="pmcid">PMC7078957</pub-id><pub-id pub-id-type="pmid">31633883</pub-id><pub-id pub-id-type="doi">10.1002/cyto.a.23904</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finak</surname><given-names>G</given-names></name><name><surname>Perez</surname><given-names>JM</given-names></name><name><surname>Weng</surname><given-names>A</given-names></name><name><surname>Gottardo</surname><given-names>R</given-names></name></person-group><article-title>Optimizing transformations for automated, high throughput analysis of flow cytometry data</article-title><source>BMC Bioinformatics</source><year>2010</year><month>Nov</month><day>4</day><volume>11</volume><issue>1</issue><fpage>546</fpage><pub-id pub-id-type="pmcid">PMC3243046</pub-id><pub-id pub-id-type="pmid">21050468</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-546</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Himmel</surname><given-names>ME</given-names></name><name><surname>MacDonald</surname><given-names>KG</given-names></name><name><surname>Garcia</surname><given-names>RV</given-names></name><name><surname>Steiner</surname><given-names>TS</given-names></name><name><surname>Levings</surname><given-names>MK</given-names></name></person-group><article-title>HELIOS+ and HELIOS− Cells Coexist within the Natural FOXP3+ T Regulatory Cell Subset in Humans</article-title><source>The Journal of Immunology</source><year>2013</year><month>Mar</month><day>1</day><volume>190</volume><issue>5</issue><fpage>2001</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">23359504</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornton</surname><given-names>A</given-names></name></person-group><article-title>HELIOS+ and HELIOS− Treg subpopulations are phenotypically and functionally distinct and express dissimilar TCR repertoires</article-title><source>European Journal of Immunology</source><year>2019</year><volume>49</volume><fpage>398</fpage><lpage>412</lpage><pub-id pub-id-type="pmcid">PMC6402968</pub-id><pub-id pub-id-type="pmid">30620397</pub-id><pub-id pub-id-type="doi">10.1002/eji.201847935</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shiow</surname><given-names>LR</given-names></name><name><surname>Rosen</surname><given-names>DB</given-names></name><name><surname>Brdičková</surname><given-names>N</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>An</surname><given-names>J</given-names></name><name><surname>Lanier</surname><given-names>LL</given-names></name><etal/></person-group><article-title>CD69 acts downstream of interferon-α/β to inhibit S1P1 and lymphocyte egress from lymphoid organs</article-title><source>Nature</source><year>2006</year><month>Mar</month><volume>440</volume><issue>7083</issue><fpage>540</fpage><lpage>4</lpage><pub-id pub-id-type="pmid">16525420</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>BV</given-names></name><name><surname>Ma</surname><given-names>W</given-names></name><name><surname>Miron</surname><given-names>M</given-names></name><name><surname>Granot</surname><given-names>T</given-names></name><name><surname>Guyer</surname><given-names>RS</given-names></name><name><surname>Carpenter</surname><given-names>DJ</given-names></name><etal/></person-group><article-title>Human Tissue-Resident Memory T Cells Are Defined by Core Transcriptional and Functional Signatures in Lymphoid and Mucosal Sites</article-title><source>Cell Reports</source><year>2017</year><month>Sep</month><volume>20</volume><issue>12</issue><fpage>2921</fpage><lpage>34</lpage><pub-id pub-id-type="pmcid">PMC5646692</pub-id><pub-id pub-id-type="pmid">28930685</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2017.08.078</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sathaliyawala</surname><given-names>T</given-names></name><name><surname>Kubota</surname><given-names>M</given-names></name><name><surname>Yudanin</surname><given-names>N</given-names></name><name><surname>Turner</surname><given-names>D</given-names></name><name><surname>Camp</surname><given-names>P</given-names></name><name><surname>Thome</surname><given-names>JJC</given-names></name><etal/></person-group><article-title>Distribution and Compartmentalization of Human Circulating and Tissue-Resident Memory T Cell Subsets</article-title><source>Immunity</source><year>2013</year><month>Jan</month><volume>38</volume><issue>1</issue><fpage>187</fpage><lpage>97</lpage><pub-id pub-id-type="pmcid">PMC3557604</pub-id><pub-id pub-id-type="pmid">23260195</pub-id><pub-id pub-id-type="doi">10.1016/j.immuni.2012.09.020</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mikhak</surname><given-names>Z</given-names></name><name><surname>Strassner</surname><given-names>JP</given-names></name><name><surname>Luster</surname><given-names>AD</given-names></name></person-group><article-title>Lung dendritic cells imprint T cell lung homing and promote lung immunity through the chemokine receptor CCR4</article-title><source>Journal of Experimental Medicine</source><year>2013</year><month>Aug</month><day>19</day><volume>210</volume><issue>9</issue><fpage>1855</fpage><lpage>69</lpage><pub-id pub-id-type="pmcid">PMC3754856</pub-id><pub-id pub-id-type="pmid">23960189</pub-id><pub-id pub-id-type="doi">10.1084/jem.20130091</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bromley</surname><given-names>SK</given-names></name><name><surname>Mempel</surname><given-names>TR</given-names></name><name><surname>Luster</surname><given-names>AD</given-names></name></person-group><article-title>Orchestrating the orchestrators: chemokines in control of T cell traffic</article-title><source>Nat Immunol</source><year>2008</year><month>Sep</month><volume>9</volume><issue>9</issue><fpage>970</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">18711434</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lötsch</surname><given-names>J</given-names></name><name><surname>Malkusch</surname><given-names>S</given-names></name><name><surname>Ultsch</surname><given-names>A</given-names></name></person-group><article-title>Optimal distribution-preserving downsampling of large biomedical data sets (opdisDownsampling)</article-title><source>PLoS One</source><year>2021</year><month>Aug</month><day>5</day><volume>16</volume><issue>8</issue><elocation-id>e0255838</elocation-id><pub-id pub-id-type="pmcid">PMC8341664</pub-id><pub-id pub-id-type="pmid">34352006</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0255838</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angelo</surname><given-names>LS</given-names></name><name><surname>Banerjee</surname><given-names>PP</given-names></name><name><surname>Monaco-Shawver</surname><given-names>L</given-names></name><name><surname>Rosen</surname><given-names>JB</given-names></name><name><surname>Makedonas</surname><given-names>G</given-names></name><name><surname>Forbes</surname><given-names>LR</given-names></name><etal/></person-group><article-title>Practical NK cell phenotyping and variability in healthy adults</article-title><source>Immunol Res</source><year>2015</year><month>Jul</month><volume>62</volume><issue>3</issue><fpage>341</fpage><lpage>56</lpage><pub-id pub-id-type="pmcid">PMC4470870</pub-id><pub-id pub-id-type="pmid">26013798</pub-id><pub-id pub-id-type="doi">10.1007/s12026-015-8664-y</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalina</surname><given-names>T</given-names></name><name><surname>Flores-Montero</surname><given-names>J</given-names></name><name><surname>van der Velden</surname><given-names>VHJ</given-names></name><name><surname>Martin-Ayuso</surname><given-names>M</given-names></name><name><surname>Böttcher</surname><given-names>S</given-names></name><name><surname>Ritgen</surname><given-names>M</given-names></name><etal/></person-group><article-title>EuroFlow standardization of flow cytometer instrument settings and immunophenotyping protocols</article-title><source>Leukemia</source><year>2012</year><month>Sep</month><volume>26</volume><issue>9</issue><fpage>1986</fpage><lpage>2010</lpage><pub-id pub-id-type="pmcid">PMC3437409</pub-id><pub-id pub-id-type="pmid">22948490</pub-id><pub-id pub-id-type="doi">10.1038/leu.2012.122</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rebhahn</surname><given-names>JA</given-names></name><name><surname>Quataert</surname><given-names>SA</given-names></name><name><surname>Sharma</surname><given-names>G</given-names></name><name><surname>Mosmann</surname><given-names>TR</given-names></name></person-group><article-title>SwiftReg cluster registration automatically reduces flow cytometry data variability including batch effects</article-title><source>Commun Biol</source><year>2020</year><month>May</month><day>7</day><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC7205614</pub-id><pub-id pub-id-type="pmid">32382076</pub-id><pub-id pub-id-type="doi">10.1038/s42003-020-0938-9</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahne</surname><given-names>F</given-names></name><name><surname>Khodabakhshi</surname><given-names>AH</given-names></name><name><surname>Bashashati</surname><given-names>A</given-names></name><name><surname>Wong</surname><given-names>CJ</given-names></name><name><surname>Gascoyne</surname><given-names>RD</given-names></name><name><surname>Weng</surname><given-names>AP</given-names></name><etal/></person-group><article-title>Per-channel basis normalization methods for flow cytometry data</article-title><source>Cytometry A</source><year>2010</year><month>Feb</month><volume>77</volume><issue>2</issue><fpage>121</fpage><lpage>31</lpage><pub-id pub-id-type="pmcid">PMC3648208</pub-id><pub-id pub-id-type="pmid">19899135</pub-id><pub-id pub-id-type="doi">10.1002/cyto.a.20823</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="web"><collab>Satija Lab</collab><source>Tools for Single Cell Genomics</source><date-in-citation>cited 2023 Nov 19</date-in-citation><comment>Internet Available from: <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/">https://satijalab.org/seurat/</ext-link></comment></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Hempel</surname><given-names>F</given-names></name><name><surname>Ryborz</surname><given-names>T</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Schultze</surname><given-names>JL</given-names></name></person-group><article-title>Pytometry: Flow and mass cytometry analytics in Python</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.10.10.511546</elocation-id><date-in-citation>cited 2023 Nov 19</date-in-citation><comment>Internet Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.10.10.511546v1">https://www.biorxiv.org/content/10.1101/2022.10.10.511546v1</ext-link></comment></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luecken</surname><given-names>MD</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Chaichoompu</surname><given-names>K</given-names></name><name><surname>Danese</surname><given-names>A</given-names></name><name><surname>Interlandi</surname><given-names>M</given-names></name><name><surname>Mueller</surname><given-names>MF</given-names></name><etal/></person-group><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title><source>Nat Methods</source><year>2022</year><month>Jan</month><volume>19</volume><issue>1</issue><fpage>41</fpage><lpage>50</lpage><pub-id pub-id-type="pmcid">PMC8748196</pub-id><pub-id pub-id-type="pmid">34949812</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01336-8</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leite Pereira</surname><given-names>A</given-names></name><name><surname>Lambotte</surname><given-names>O</given-names></name><name><surname>Le Grand</surname><given-names>R</given-names></name><name><surname>Cosma</surname><given-names>A</given-names></name><name><surname>Tchitchek</surname><given-names>N</given-names></name></person-group><article-title>CytoBackBone: an algorithm for merging of phenotypic information from different cytometric profiles</article-title><person-group person-group-type="editor"><name><surname>Wren</surname><given-names>J</given-names></name></person-group><source>Bioinformatics</source><year>2019</year><month>Oct</month><day>15</day><volume>35</volume><issue>20</issue><fpage>4187</fpage><lpage>9</lpage><comment>editor</comment><pub-id pub-id-type="pmcid">PMC6792066</pub-id><pub-id pub-id-type="pmid">30903138</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btz212</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdelaal</surname><given-names>T</given-names></name><name><surname>Höllt</surname><given-names>T</given-names></name><name><surname>Van Unen</surname><given-names>V</given-names></name><name><surname>Lelieveldt</surname><given-names>BPF</given-names></name><name><surname>Koning</surname><given-names>F</given-names></name><name><surname>Reinders</surname><given-names>MJT</given-names></name><etal/></person-group><article-title>CyTOFmerge: integrating mass cytometry data across multiple panels</article-title><person-group person-group-type="editor"><name><surname>Wren</surname><given-names>J</given-names></name></person-group><source>Bioinformatics</source><year>2019</year><month>Oct</month><day>15</day><volume>35</volume><issue>20</issue><fpage>4063</fpage><lpage>71</lpage><comment>editor</comment><pub-id pub-id-type="pmcid">PMC6792069</pub-id><pub-id pub-id-type="pmid">30874801</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btz180</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mocking</surname><given-names>TR</given-names></name><name><surname>Duetz</surname><given-names>C</given-names></name><name><surname>van Kuijk</surname><given-names>BJ</given-names></name><name><surname>Westers</surname><given-names>TM</given-names></name><name><surname>Cloos</surname><given-names>J</given-names></name><name><surname>Bachas</surname><given-names>C</given-names></name></person-group><article-title>Merging and imputation of flow cytometry data: A critical assessment</article-title><source>Cytometry Part A</source><year>2023</year><volume>103</volume><issue>10</issue><fpage>818</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">37338802</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of FlowAtlas workflow with FlowJo.</title><p><bold>a</bold>, First, anomalous events are removed from the raw data. <bold>b</bold>, High-quality files are then pre-processed in FlowJo (Step 1) and exported. Exported files are then opened in a new FlowJo workspace and prepared for FlowAtlas-assisted analysis. Step 2: annotation of fluorescence channels; Step 3: panel-specific gating of matched populations across all datasets; Step 4: grouping of samples by desired conditions. Importing the updated workspace file into FlowAtlas triggers automatic panel merging, embedding calculation, and launches interactive web interface (<bold>c</bold>), where embedded events can be re-coloured and filtered by conditions and groups that were defined in FlowJo. ROIs can be drawn directly in the embedding generating violin plots showing marker expression. Box plots can be generated to show frequencies of selected populations and conditions. Novel populations identified in FlowAtlas can be validated and annotated in FlowJo. The updated workspace file can then be reopened in FlowAtlas to import new annotations; FJ - FlowJo; FA - FlowAtlas.</p></caption><graphic xlink:href="EMS193102-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Panel-specific gating strategies created in FlowJo.</title><p>For downstream DR analysis in FlowAtlas, we exported only live single T-cell events from each panel, indicated with a dashed line gate (panel A: Live CD3+ CD45+; panel B: Live CD3+; panel C: Live CD19- CD3+ events). Compensated parameters were exported, <bold>excluding</bold> CD45, CD19, Viability stain, FSC and SSC. Downstream gating for main population identification in FlowAtlas is shown. All channels have been biexponentially transformed. Note that other FlowJo transformations (e.g. logarithmic, ArcSinh) are not compatible with FlowAtlas.</p></caption><graphic xlink:href="EMS193102-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Treg subpopulation discovery in FlowAtlas.</title><p><bold>a</bold>, Relative abundance of Tregs by donor and tissue calculated as % of total CD4<sup>+</sup> T-cells. <bold>b</bold>, Self-organised map embedding of Tregs from all tissues, all donors and all panels, coloured by HELIOS expression. <bold>c,</bold> Marker expression in four ROIs of the composite Treg embedding of all tissues stained with panel C; inset shows Tregs from all tissues stained with panel C, coloured by CCR4 expression. <bold>d</bold>, ROI population distributions by filtered by individual tissue. <bold>e</bold>, Validation and creation of new Treg sub-gates for the four ROIs in FlowJo. Gates should be created in all samples that contain the markers of interest, regardless of panel, at equivalent levels in the gating tree hierarchy (in this case, total Tregs as the parent gate). The new gates can then be opened and explored in FlowAtlas, as shown- Treg embedding re-coloured by the newly annotated Treg populations. <bold>f</bold>, Frequencies of the newly identified Treg subpopulations across tissues and donors. BM - bone marrow; mLN - mesenteric lymph nodes; tLN - thoracic lymph nodes; ROI - region of interest; FJ - FlowJo; FA - FlowAtlas.</p></caption><graphic xlink:href="EMS193102-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Comparison of workflow for the detection of rare cell subsets in FlowAtlas</title><p>(a) and Cytobank (b) using a published spectral cytometry 23-colour dataset of whole human blood. In FlowAtlas, embedding the data is quick, and basic populations are created using the familiar workflow of FlowJo (Step 1a). The eye is immediately drawn to heterogeneity in the embedding, for example in the NK cell population (Step 2a). A small cluster of NK cells (magenta ROI and violins) is close to the myeloid populations, and expresses HLA-DR, CD11c and CD1c (Step 3a). Checking that it exists in FlowJo (Step 4a) is easy- and it is quickly added to the updated FlowAtlas embedding. The user can now also zoom in on three other larger NK subsets (CD56bright, CD57+ CD56dim and CD57- CD56dim). The equivalent workflow in Cytobank is as follows: after a relatively fast embedding of the data (step 1b), the user needs to identify each of the 20 metacluster identities first (step 2b), using heatmaps and violin plots of marker expression (not shown). Rare populations may not have segregated. They can be discovered by examining the MST, coloured by channel (Step 3b and 4b)- looking for heterogeneity in a metacluster. For example, metacluster 4 contains cluster 15, which appears to express HLA-DR and CD56.The user can either re-run the analysis, or create new metaclusters by manually combining cluster numbers (Step 5b). Equivalent major cell populations are coloured identically in the two embeddings and in the minimum-spanning trees (in Step 4b); ROI colour in FlowAtlas matches the corresponding violin plots.</p></caption><graphic xlink:href="EMS193102-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Merging of panels and detection of batch variance.</title><p>a, Two healthy control donors were stained with our 3 panels as one batch, and data were processed in FlowAtlas as recommended. Events are coloured by panel and show minimum differences in population geometry, driven by our choice of CD4 fluorochrome (BUV661 on panel A, BUV805 on panels B and C). Spread from BUV661 into CD25-APC and CXCR5-APCR700 is visible in panel A in violin plots. The three panels integrate well without normalisation.b) Blood samples stained with panel C are shown as embedding and violin plots (yellow= deceased organ donor blood, processed ex vivo is designated “batch 1”; cyan= healthy control blood, processed after cryopreservation and designated “batch 2”). FlowAtlas has successfully merged the panels, but the topography is very different between the two batches. This likely represents a mixture of biological differences, and in large part- batch differences due to different sample handling and cytometer configurations.</p></caption><graphic xlink:href="EMS193102-f005"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Best computational times with FlowAtlas and other high-dimensional data processing tools.</title><p>CPU usage and time required by FlowAtlas, FlowJo, and FCS Express to perform dimensionality reduction on a Dell XPS15 9570 laptop with 32Gb RAM, i7-8750H CPU 2.20GHz processor. FlowJo version 10.8.1 using native tSNE tool; FCS Express version 7.18.0025. opt-tSNE settings in both platforms: all fluorescence channels, perplexity 30, iterations 1000, learning rate (eta): automatic; KNN algorithm: ANNOY, with Barnes-hut approximation (=0.5). In FlowJo and FCSExpress, different embedding topographies were produced for each sample unless samples were concatenated prior to DR. Samples stained with different panels cannot be concatenated. Times represent best results from 2-3 independent attempts. NR= not run.</p></caption><table frame="hsides" rules="groups"><tbody><tr style="border-top: solid thin"><td align="left" valign="middle"><bold>Dimensionality reduction</bold></td><td align="center" valign="top"/><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>FlowAtlas</bold></td><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>FlowJo tSNE (native)</bold></td><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>FCS Express</bold></td></tr><tr><td align="left" valign="top">Samples</td><td align="center" valign="top" style="border-top: solid thin">Events</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td><td align="center" valign="top" style="border-top: solid thin">% CPU</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td><td align="center" valign="top" style="border-top: solid thin">% CPU</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td><td align="center" valign="top" style="border-top: solid thin">% CPU</td></tr><tr style="border-top: solid thin"><td align="left" valign="top">423C Spleen</td><td align="center" valign="top">379,994</td><td align="center" valign="top">2 min</td><td align="center" valign="top">8.3</td><td align="center" valign="top">7 min 15 s</td><td align="center" valign="top">90 %</td><td align="center" valign="top">9 min 30 s</td><td align="center" valign="top">100%</td></tr><tr><td align="left" valign="top">412C, 423C, 428C all tissues</td><td align="center" valign="top">2.32 million</td><td align="center" valign="top">9 min 30 s</td><td align="center" valign="top">8.5</td><td align="center" valign="top">49 min</td><td align="center" valign="top">90 %</td><td align="center" valign="top">125 min<xref ref-type="table-fn" rid="TFN1">*</xref></td><td align="center" valign="top">100%</td></tr><tr><td align="left" valign="top">Full dataset</td><td align="center" valign="top">3.88 million</td><td align="center" valign="top">18 min</td><td align="center" valign="top">8.5</td><td align="center" valign="top">Up to 6 hours<xref ref-type="table-fn" rid="TFN2">†</xref></td><td align="center" valign="top">100%</td><td align="center" valign="top">NR<xref ref-type="table-fn" rid="TFN1">*</xref><xref ref-type="table-fn" rid="TFN2">†</xref></td><td align="center" valign="top">NR</td></tr><tr style="border-top: solid thin"><td align="left" valign="top"><bold>Clustering</bold></td><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>FlowAtlas EmbedSOM</bold></td><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>FlowJo EmbedSOM</bold></td><td align="center" valign="top" colspan="2" style="border-bottom: solid thin;"><bold>Cytobank FlowSOM</bold></td></tr><tr><td align="left" valign="top">Samples</td><td align="center" valign="top" style="border-top: solid thin">Events</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td><td align="center" valign="top" style="border-top: solid thin">Events</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td><td align="center" valign="top" style="border-top: solid thin">Events</td><td align="center" valign="top" style="border-top: solid thin">Compute time</td></tr><tr style="border-top: solid thin"><td align="left" valign="top">23 colour spectral human blood (3 files)</td><td align="center" valign="top">449, 488</td><td align="center" valign="top">2 min 30 s</td><td align="center" valign="top">449, 488</td><td align="center" valign="top">5min 30 s</td><td align="center" valign="top">421,669<xref ref-type="table-fn" rid="TFN3">**</xref></td><td align="center" valign="top">12 min</td></tr><tr style="border-bottom: solid thin"><td align="left" valign="top">Downsampling</td><td align="center" valign="top" colspan="2">no</td><td align="center" valign="top" colspan="2">no</td><td align="center" valign="top" colspan="2"><xref ref-type="table-fn" rid="TFN3">**</xref>Yes, required</td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><label>*</label><p id="P69">Software became unresponsive on 2 of 3 previous trials.</p></fn><fn id="TFN2"><label>†</label><p id="P70">Different panels cannot be merged, so embedding geometry varies by file.</p></fn><fn id="TFN3"><label>**</label><p id="P71">Downsampling required. Computation time for clustering of the indicated number of events from a publicly available spectral dataset in FlowAtlas, FlowJo, and Cytobank. The dataset is from Cytobank experiment number 191382. Time in Cytobank excludes the DR step. CPU usage is not reported for clustering analysis since it is not relevant to the cloud-based Cytobank platform.</p></fn></table-wrap-foot></table-wrap></floats-group></article>