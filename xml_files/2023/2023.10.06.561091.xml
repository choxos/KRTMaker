<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS189362</article-id><article-id pub-id-type="doi">10.1101/2023.10.06.561091</article-id><article-id pub-id-type="archive">PPR738011</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>AleRax: A tool for gene and species tree co-estimation and reconciliation under a probabilistic model of gene duplication, transfer, and loss</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Morel</surname><given-names>Benoit</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Williams</surname><given-names>Tom A.</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Stamatakis</surname><given-names>Alexandros</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Szöllősi</surname><given-names>Gergely J.</given-names></name><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref></contrib><aff id="A1"><label>1</label>Computational Molecular Evolution group, Heidelberg Institute for Theoretical Studies, Heidelberg, Germany</aff><aff id="A2"><label>2</label>Institute for Theoretical Informatics, Karlsruhe Institute of Technology, Karlsruhe, Germany</aff><aff id="A3"><label>3</label>School of Biological Sciences, University of Bristol, Bristol, UK</aff><aff id="A4"><label>4</label>Biodiversity Computing Group, Institute of Computer Science, Foundation for Research and Technology - Hellas</aff><aff id="A5"><label>5</label>ELTE-MTA “Lendület” Evolutionary Genomics Research Group, Pázmány P. stny. 1A., H-1117 Budapest, Hungary</aff><aff id="A6"><label>6</label>Institute of Evolution, Centre for Ecological Research, Konkoly-Thege M. út 29-33. H-1121 Budapest, Hungary</aff><aff id="A7"><label>7</label>Model-Based Evolutionary Genomics Unit, Okinawa Institute of Science and Technology Graduate University, Okinawa, Japan</aff></contrib-group><pub-date pub-type="nihms-submitted"><day>11</day><month>10</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>08</day><month>10</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Motivation</title><p id="P1">Genomes are a rich source of information on the pattern and process of evolution across biological scales. How best to make use of that information is an active area of research in phylogenetics. Ideally, phylogenetic methods should not only model substitutions along gene trees, which explain differences between homologous gene sequences, but also the processes that generate the gene trees themselves along a shared species tree. To conduct accurate inferences, one needs to account for uncertainty at both levels, that is, in gene trees estimated from inherently short sequences and in their diverse evolutionary histories along a shared species tree.</p></sec><sec id="S2"><title>Results</title><p id="P2">We present AleRax, a software that can infer reconciled gene trees together with a shared species tree using a simple, yet powerful, probabilistic model of gene duplication, transfer, and loss. A key feature of AleRax is its ability to account for uncertainty in the gene tree and its reconciliation by using an efficient approximation to calculate the joint phylogenetic - reconciliation likelihood and sample reconciled gene trees accordingly. Simulations and analyses of empirical data show that AleRax is one order of magnitude faster than competing gene tree inference tools while attaining the same accuracy. It is consistently more robust than species tree inference methods such as SpeciesRax and ASTRAL-Pro 2 under gene tree uncertainty. Finally, AleRax can process multiple gene families in parallel thereby allowing users to compare competing phylogenetic hypotheses and estimate model parameters, such as DTL probabilities for genome-scale datasets with hundreds of taxa.</p></sec><sec id="S3"><title>Availability and Implementation</title><p id="P3">GNU GPL at <ext-link ext-link-type="uri" xlink:href="https://github.com/BenoitMorel/AleRax">https://github.com/BenoitMorel/AleRax</ext-link> and data are made available at <ext-link ext-link-type="uri" xlink:href="https://cme.h-its.org/exelixis/material/alerax_data.tar.gz">https://cme.h-its.org/exelixis/material/alerax_data.tar.gz</ext-link>.</p></sec><sec id="S4"><title>Contact</title><p id="P4"><email>Benoit.Morel@h-its.org</email></p></sec></abstract></article-meta></front><body><sec id="S5" sec-type="intro"><label>1</label><title>Introduction</title><p id="P5">Simultaneously inferring gene trees and the species tree is challenging. Genomes contain abundant information about evolutionary history, but, single gene sequences are often too short to reliably resolve gene trees (<xref ref-type="bibr" rid="R5">Haag <italic>et al</italic>., 2022</xref>). Moreover, gene trees are not species trees, but each is the unique result of series of evolutionary events. Starting from an individual site in a genome up to the species level, a hierarchy of evolutionary processes generate genomic sequences, with each level of the hierarchy contributing to the phylogenetic signal that can induce differences between reconstructed gene trees (<xref ref-type="bibr" rid="R15">Szöllősi <italic>et al</italic>., 2015</xref>). Segregating mutations that cross speciation events (a process called incomplete lineage sorting) leave topological signatures in gene trees. Duplications, transfers, and losses of genes (DTL) lead to substantial differences in both, the size, and phylogenetic distribution, of families of homologous genes, and at the same time produce patent phylogenetic discord.</p><p id="P6">While most species tree inference methods take single-copy genes as input that are assumed <italic>a priori</italic> to be orthologous (i.e., to have originated from a common ancestral gene solely through speciation), more recent methods are able to handle more general homologous gene families (i.e., genes that originated from a common ancestor through speciation, gene duplication and possibly transfer events) including multi-copy ones (<xref ref-type="bibr" rid="R1">Boussau <italic>et al</italic>., 2013</xref>; <xref ref-type="bibr" rid="R16">Zhang and Mirarab, 2022</xref>; <xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>). In particular, we recently developed SpeciesRax (<xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>), a tool that models gene duplication, transfer, and loss (DTL) events and that estimates a maximum likelihood (ML) rooted species tree under the so-called UndatedDTL model. Another promising recent method is ASTRAL-Pro 2 (<xref ref-type="bibr" rid="R16">Zhang and Mirarab, 2022</xref>), which infers a species tree from multi-copy gene trees by maximizing a duplication-aware quartet score. However, SpeciesRax and ASTRAL-Pro 2 only consider a single <italic>estimated</italic> gene tree per gene family as input, and are thus sensitive to gene tree uncertainty. Alternative methods such as Phyldog (<xref ref-type="bibr" rid="R1">Boussau <italic>et al</italic>., 2013</xref>) jointly estimate the species tree <italic>and</italic> the gene trees that evolved along it via speciation, duplication, and loss. However, Phyldog does not scale to large datasets and does not model gene transfer.</p><p id="P7">Another challenge is to infer a reconciled gene tree, a gene tree together with a reconciliation, a series of DTL and speciation events that trace its evolution along the species tree. To this end, we previously developed GeneRax (<xref ref-type="bibr" rid="R9">Morel <italic>et al</italic>., 2020</xref>), a probabilistic method that searches for the reconciled gene trees that maximize the joint likelihood, defined as the product of the phylogenetic likelihood (the probability of the multiple sequence alignment (MSA) given the gene tree) and the reconciliation likelihood (the probability of the gene tree given the species tree under UndateDTL). However, GeneRax does not provide a confidence measure for the inferred gene trees. Amalgamated Likelihood Estimation (ALE) (<xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>) is an alternative two-step approach that sums the joint likelihood over all reconciled gene trees that can be amalgamated as a combination of clades observed in a sample of gene trees previously inferred from the sequences using conditional clade probabilities (<xref ref-type="bibr" rid="R6">Höhna and Drummond, 2012</xref>; <xref ref-type="bibr" rid="R7">Larget, 2013</xref>) to approximate the phylogenetic likelihood. Confidence in a particular DTL event can then be estimated by counting how frequently it appears in the different reconciled gene trees. However, ALE is not able to simultaneously process multiple gene families, or to infer the species tree.</p><p id="P8">Here we present AleRax, a novel probabilistic method for phylogenetic tree inference that can perform both species tree inference <italic>and</italic> reconciled gene tree inference from a sample of gene trees. We first present the method and the key features of AleRax. Then, we present the results of our benchmarks: we found that AleRax is on par with ALE in terms of gene tree reconstruction accuracy, but an order of magnitude faster and robust to numerical underflow that causes ALE to fail. Finally AleRax is 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2 for species tree inference.</p></sec><sec id="S6" sec-type="methods"><label>2</label><title>Method</title><sec id="S7"><label>2.1</label><title>Likelihood definition and computation</title><p id="P9">Let <italic>S</italic> be the species tree, and <italic>A</italic> be an alignment of homologous genes, that is, a gene family alignment. The probability of observing <italic>A</italic> given <italic>S</italic> is obtained by summing over all possible rooted gene trees <italic>G</italic> for alignment <italic>A</italic>: <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mi>∑</mml:mi><mml:mi>G</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>∣</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P10">(<xref ref-type="bibr" rid="R4">Felsenstein, 1988</xref>; <xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>).</p><p id="P11">AleRax approximates <italic>P</italic> (<italic>A</italic> | <italic>S</italic>) by using the ALE (<xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>) algorithm, which takes as input a sample of gene trees for each gene family, ideally computed via a Bayesian inference tool such as Phylobayes (<xref ref-type="bibr" rid="R8">Lartillot <italic>et al</italic>., 2013</xref>) or MrBayes (<xref ref-type="bibr" rid="R13">Ronquist <italic>et al</italic>., 2012</xref>) prior to running AleRax. The gene trees in the samples can be rooted or unrooted. Instead of naïvely computing the sum Σ<sub><italic>G</italic></sub> <italic>P</italic> (<italic>A</italic> | <italic>G</italic>)<italic>P</italic> (<italic>G</italic> | <italic>S</italic>), AleRax uses the sample of gene trees provided to estimate a nonzero probability for all gene tree topologies that can be “amalgamated” (<xref ref-type="bibr" rid="R2">David and Alm, 2011</xref>) from clades present in the sample using conditional clade probabilities (CCPs) (<xref ref-type="bibr" rid="R6">Höhna and Drummond, 2012</xref>; <xref ref-type="bibr" rid="R7">Larget, 2013</xref>). This corresponds to the maximum entropy distribution given marginal split frequencies in the sample of gene trees provided as input (<xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>). Using CCPs allows AleRax to exploit a joint dynamic programming recursion that efficiently and accurately approximates <xref ref-type="disp-formula" rid="FD1">Equation 1</xref> (<xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>). An in-depth description of this algorithm is provided in the Supplementary Material. Importantly, unlike ALE, AleRax uses arbitrary-precision floating point values when necessary, allowing it to process datasets that cause ALE to fail due to numerical underflow. AleRax can also process multiple gene families in parallel given a sample of genes for each family allowing it to infer the species tree as well as more realistic DTL models, e.g., branch-wise DTL parameters on the species tree, by maximizing the likelihood of the species tree, which can be written as the product over all per-family alignment probabilities: <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>ℒ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S8"><label>2.2</label><title>Species tree inference</title><p id="P12">AleRax searches for the rooted ML species tree. It implements the same tree search strategy as SpeciesRax (<xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>), which applies hill-climbing subtree prune and regraft (SPR) moves until it cannot find a move that yields a tree with a better likelihood. However, unlike SpeciesRax, which relies on a single gene tree per gene family, AleRax uses a sample of per family gene trees to integrate over gene tree uncertainty by approximating <italic>P</italic> (<italic>A</italic><sub><italic>i</italic></sub> | <italic>S</italic>). AleRax recomputes the model parameters (described in the next subsection) after each round of SPR moves. The starting species tree can be generated at random, estimated with MiniNJ (<xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>) (a duplication-aware distance method), or specified by the user.</p></sec><sec id="S9"><label>2.3</label><title>Model parameter estimation</title><p id="P13">In general, the reconciliation model used by AleRax, the so called UndatedDTL model (<xref ref-type="bibr" rid="R9">Morel <italic>et al</italic>., 2020</xref>) can have three free parameters per gene family <italic>k</italic> and per species tree branch <inline-formula><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, representing the duplication, transfer, and loss probabilities, respectively. However, estimating such a large number of free parameters (proportional to the product of the number of species in <italic>S</italic> multiplied by the number of genes families) can lead to over-parameterization. Hence, AleRax implements three distinct approaches to parameter estimation that can be chosen by the user. In the <italic>global parameters</italic> mode, all families and all species share the same set of parameters {<italic>δ, τ, λ</italic>}, resulting in only three free parameters. In the <italic>per-family parameters</italic> mode, AleRax optimizes a different set of parameters {<italic>δ</italic><sub><italic>k</italic></sub>, <italic>τ</italic><sub><italic>k</italic></sub>, <italic>λ</italic><sub><italic>k</italic></sub>} for each gene family <italic>k</italic>. This corresponds to 3<italic>K</italic> free parameters, where <italic>K</italic> is the number of gene families. In the <italic>per-species parameter</italic> mode, the user can provide a list of species groupings that share the same set of parameters. In this mode, the model has 3<italic>n</italic> free parameters, where <italic>n</italic> is the number of groupings defined. In each mode, AleRax optimizes the model parameter values with respect to the likelihood via gradient descent.</p></sec><sec id="S10"><label>2.4</label><title>Sampling reconciled gene trees</title><p id="P14">AleRax samples, per gene family, <italic>r</italic> reconciled gene trees proportional to their joint likelihood using stochastic backtracking following the dynamic programming recursion (<xref ref-type="bibr" rid="R1">Szöllősi <italic>et al</italic>., 2013</xref>) used to approximate <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>. We describe the algorithm in the Supplementary Material. The number of gene trees <italic>r</italic> to sample is specified by the user. For each gene family, AleRax outputs the <italic>r</italic> reconciled gene trees, the rooted majority-rule consensus gene tree, and the number of gene events per species, averaged over all output samples for this specific gene family. The reconciliations are stored in RecPhyloXML format (<xref ref-type="bibr" rid="R3">Duchemin <italic>et al</italic>., 2018</xref>) and can be converted into SVG figures using Thirdkind (<xref ref-type="bibr" rid="R12">Penel <italic>et al</italic>., 2022</xref>), as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>. AleRax also outputs the species pairs involved in horizontal gene transfers, sorted by the number of times those transfers have been sampled (per family and summed over all families). In addition, for each species, it returns the number of ancestral gene copies and the number of DTL events. We also provide scripts to extract lists of families that were involved in transfers between specific species pairs, or families that experienced a specific event for a given species (e.g., all families with a gene duplication in <italic>Arabidopsis thaliana</italic>).</p></sec></sec><sec id="S11" sec-type="results"><label>3</label><title>Results</title><p id="P15">Here we only provide a summary of the experiments and their results. We describe them in detail in the Supplementary Material.</p><sec id="S12"><label>3.1</label><title>Gene tree reconciliation</title><p id="P16">We ran both ALE and AleRax on the simulated datasets used to benchmark SpeciesRax (<xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>). As expected, ALE and AleRax perform analogously in terms of accuracy (<xref ref-type="fig" rid="F2">Fig. 2</xref>). We also executed both tools on a real dataset derived from the HOGENOM (<xref ref-type="bibr" rid="R11">Penel <italic>et al</italic>., 2009</xref>) database’s HOGENOM-CORE subdataset, which contains 666 representative genomes spanning the diversity of cellular life. ALE failed for 25 families (out of 12, 408) because of numerical underflow. AleRax in contrast successfully processed all families. In terms of runtime, AleRax was on average an order of magnitude faster than ALE, both on simulated and empirical datasets (<xref ref-type="fig" rid="F2">Fig. 2</xref>).</p></sec><sec id="S13"><label>3.2</label><title>Species tree inference</title><p id="P17">We investigated the impact of using gene tree distributions instead of single ML gene trees by comparing AleRax, SpeciesRax, and ASTRAL-Pro 2 on simulated datasets. We used the same benchmarks that were employed for assessing SpeciesRax (<xref ref-type="bibr" rid="R10">Morel <italic>et al</italic>., 2022</xref>), that is, we varied different simulation parameters individually while keeping the rest fixed, and measured the distance between the true and the inferred species trees. We ran AleRax on gene tree distributions inferred with MrBayes (<xref ref-type="bibr" rid="R13">Ronquist <italic>et al</italic>., 2012</xref>). We found that, over all conditions tested, AleRax is on average 25% more accurate than SpeciesRax and twice as accurate as ASTRAL-Pro 2. For instance, <xref ref-type="fig" rid="F2">Fig. 2</xref> compares the accuracy of the different methods when varying the number of sites per gene family. This accuracy improvement is due to the ability of AleRax to accommodate phylogenetic uncertainty.</p></sec></sec><sec id="S14"><label>4</label><title>Conclusion and Future Work</title><p id="P18">AleRax is an efficient and user-friendly tool for species tree inference and gene tree-species tree reconciliation that can be applied to datasets from across the tree of life. It is particularly useful in biological applications where not only the species tree, but also the histories individual gene families are of interest. We showed that AleRax is on par with ALE in terms of reconciled gene tree accuracy, while being one order of magnitude faster and more robust to numerical errors. Furthermore, it infers more accurate species trees than SpeciesRax and ASTRAL-Pro 2, because it can accommodate gene tree uncertainty. In the future, we plan to improve our model to accommodate DTL rate heterogeneity over species, incomplete lineage sorting, and horizontal gene transfer time constraints.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary material</label><media xlink:href="EMS189362-supplement-Supplementary_material.pdf" mimetype="application" mime-subtype="pdf" id="d198aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Acknowledgement</title><p>BM and AS are financially supported by the Klaus Tschira Foundation, by DFG grant STA 860/6-2, and by the European Union (EU) under Grant Agreement No 101087081 (Comp-Biodiv-GR). GSz received funding from the European Research Council under the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 714774 and the grant GINOP-2.3.2.-15-2016-00057. This work was funded by the Gordon and Betty Moore Foundation through grant GBMF9741 to TAW and GSz.</p></ack><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name><name><surname>Gouy</surname><given-names>M</given-names></name><name><surname>Tannier</surname><given-names>E</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name></person-group><article-title>Genome-scale coestimation of species and gene trees</article-title><source>Genome research</source><year>2013</year><volume>23</volume><issue>2</issue><fpage>323</fpage><lpage>330</lpage><pub-id pub-id-type="pmcid">PMC3561873</pub-id><pub-id pub-id-type="pmid">23132911</pub-id><pub-id pub-id-type="doi">10.1101/gr.141978.112</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>David</surname><given-names>LA</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><article-title>Rapid evolutionary innovation during an archaean genetic expansion</article-title><source>Nature</source><year>2011</year><volume>469</volume><issue>7328</issue><fpage>93</fpage><lpage>96</lpage><pub-id pub-id-type="pmid">21170026</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duchemin</surname><given-names>W</given-names></name><name><surname>Gence</surname><given-names>G</given-names></name><name><surname>Arigon Chifolleau</surname><given-names>A-M</given-names></name><name><surname>Arvestad</surname><given-names>L</given-names></name><name><surname>Bansal</surname><given-names>MS</given-names></name><name><surname>Berry</surname><given-names>V</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Chevenet</surname><given-names>F</given-names></name><name><surname>Comte</surname><given-names>N</given-names></name><name><surname>Davín</surname><given-names>AA</given-names></name><name><surname>Dessimoz</surname><given-names>C</given-names></name><etal/></person-group><article-title>RecPhyloXML: a format for reconciled gene trees</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><issue>21</issue><fpage>3646</fpage><lpage>3652</lpage><pub-id pub-id-type="pmcid">PMC6198865</pub-id><pub-id pub-id-type="pmid">29762653</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bty389</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Phylogenies from molecular sequences: inference and reliability</article-title><source>Annual review of genetics</source><year>1988</year><volume>22</volume><issue>1</issue><fpage>521</fpage><lpage>565</lpage><pub-id pub-id-type="pmid">3071258</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haag</surname><given-names>J</given-names></name><name><surname>Höhler</surname><given-names>D</given-names></name><name><surname>Bettisworth</surname><given-names>B</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>From easy to hopeless—predicting the difficulty of phylogenetic analyses</article-title><source>Molecular Biology and Evolution</source><year>2022</year><volume>39</volume><issue>12</issue><elocation-id>msac254</elocation-id><pub-id pub-id-type="pmcid">PMC9728795</pub-id><pub-id pub-id-type="pmid">36395091</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msac254</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Guided tree topology proposals for bayesian phylogenetic inference</article-title><source>Systematic biology</source><year>2012</year><volume>61</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmid">21828081</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larget</surname><given-names>B</given-names></name></person-group><article-title>The estimation of tree posterior probabilities using conditional clade probability distributions</article-title><source>Systematic biology</source><year>2013</year><volume>62</volume><issue>4</issue><fpage>501</fpage><lpage>511</lpage><pub-id pub-id-type="pmcid">PMC3676676</pub-id><pub-id pub-id-type="pmid">23479066</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syt014</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Rodrigue</surname><given-names>N</given-names></name><name><surname>Stubbs</surname><given-names>D</given-names></name><name><surname>Richer</surname><given-names>J</given-names></name></person-group><article-title>Phylobayes mpi: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title><source>Systematic biology</source><year>2013</year><volume>62</volume><issue>4</issue><fpage>611</fpage><lpage>615</lpage><pub-id pub-id-type="pmid">23564032</pub-id></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morel</surname><given-names>B</given-names></name><name><surname>Kozlov</surname><given-names>AM</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name></person-group><article-title>GeneRax: A Tool for Species-Tree-Aware Maximum Likelihood-Based Gene Family Tree Inference under Gene Duplication, Transfer, and Loss</article-title><source>Molecular Biology and Evolution</source><year>2020</year><volume>37</volume><issue>9</issue><fpage>2763</fpage><lpage>2774</lpage><pub-id pub-id-type="pmcid">PMC8312565</pub-id><pub-id pub-id-type="pmid">32502238</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msaa141</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morel</surname><given-names>B</given-names></name><name><surname>Schade</surname><given-names>P</given-names></name><name><surname>Lutteropp</surname><given-names>S</given-names></name><name><surname>Williams</surname><given-names>TA</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>Speciesrax: a tool for maximum likelihood species tree inference from gene family trees under duplication, transfer, and loss</article-title><source>Molecular biology and evolution</source><year>2022</year><volume>39</volume><issue>2</issue><elocation-id>msab365</elocation-id><pub-id pub-id-type="pmcid">PMC8826479</pub-id><pub-id pub-id-type="pmid">35021210</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msab365</pub-id></element-citation></ref><ref id="R11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Penel</surname><given-names>S</given-names></name><name><surname>Arigon</surname><given-names>A-M</given-names></name><name><surname>Dufayard</surname><given-names>J-F</given-names></name><name><surname>Sertier</surname><given-names>A-S</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name><name><surname>Gouy</surname><given-names>M</given-names></name><name><surname>Perrière</surname><given-names>G</given-names></name></person-group><article-title>Databases of homologous gene families for comparative genomics</article-title><source>BMC bioinformatics</source><publisher-name>BioMed Central</publisher-name><year>2009</year><volume>10</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC2697650</pub-id><pub-id pub-id-type="pmid">19534752</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-10-S6-S3</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penel</surname><given-names>S</given-names></name><name><surname>Menet</surname><given-names>H</given-names></name><name><surname>Tricou</surname><given-names>T</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name><name><surname>Tannier</surname><given-names>E</given-names></name></person-group><article-title>Thirdkind: displaying phylogenetic encounters beyond 2-level reconciliation</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><issue>8</issue><fpage>2350</fpage><lpage>2352</lpage><pub-id pub-id-type="pmid">35139153</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Teslenko</surname><given-names>M</given-names></name><name><surname>van der Mark</surname><given-names>P</given-names></name><name><surname>Ayres</surname><given-names>DL</given-names></name><name><surname>Darling</surname><given-names>A</given-names></name><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Larget</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group><article-title>MrBayes 3.2: Efficient Bayesian Phylogenetic Inference and Model Choice Across a Large Model Space</article-title><source>Systematic Biology</source><year>2012</year><volume>61</volume><issue>3</issue><fpage>539</fpage><lpage>542</lpage><pub-id pub-id-type="pmcid">PMC3329765</pub-id><pub-id pub-id-type="pmid">22357727</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/sys029</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Rosikiewicz</surname><given-names>W</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Tannier</surname><given-names>E</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name></person-group><article-title>Efficient exploration of the space of reconciled gene trees</article-title><source>Systematic Biology</source><year>2013</year><volume>62</volume><issue>6</issue><fpage>901</fpage><lpage>912</lpage><pub-id pub-id-type="pmcid">PMC3797637</pub-id><pub-id pub-id-type="pmid">23925510</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syt054</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Tannier</surname><given-names>E</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name></person-group><article-title>The inference of gene trees with species trees</article-title><source>Systematic biology</source><year>2015</year><volume>64</volume><issue>1</issue><fpage>e42</fpage><lpage>e62</lpage><pub-id pub-id-type="pmcid">PMC4265139</pub-id><pub-id pub-id-type="pmid">25070970</pub-id><pub-id pub-id-type="doi">10.1093/sysbio/syu048</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Mirarab</surname><given-names>S</given-names></name></person-group><article-title>Astral-pro 2: ultrafast species tree reconstruction from multi-copy gene family trees</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><issue>21</issue><fpage>4949</fpage><lpage>4950</lpage><pub-id pub-id-type="pmid">36094339</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><p>One reconciled gene tree sampled with AleRax and visualized with Thirdkind. The orange labels correspond to species labels, and the blue labels to gene lables.</p></caption><graphic xlink:href="EMS189362-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><p>Results on simulated datasets for varying numbers of sites per gene family: gene tree accuracy, runtimes for gene tree inference, and species tree accuracy.</p></caption><graphic xlink:href="EMS189362-f002"/></fig></floats-group></article>