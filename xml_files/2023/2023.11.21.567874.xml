<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS191500</article-id><article-id pub-id-type="doi">10.1101/2023.11.21.567874</article-id><article-id pub-id-type="archive">PPR763314</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>FluoroTensor: identification and tracking of colocalised molecules and their stoichiometries in multi-colour single molecule imaging via deep learning</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wills</surname><given-names>Max F.K.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Alejo</surname><given-names>Carlos Bueno</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Hundt</surname><given-names>Nikolas</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Hudson</surname><given-names>Andrew J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Eperon</surname><given-names>Ian C.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institute for Structural and Chemical Biology, University of Leicester, UK</aff><aff id="A2"><label>2</label>Department of Molecular and Cell Biology, University of Leicester, UK</aff><aff id="A3"><label>3</label>Department of Chemistry, University of Leicester, UK</aff><aff id="A4"><label>4</label>Department of Cellular Physiology, Ludwig-Maximilians-Universität München, Germany</aff><pub-date pub-type="nihms-submitted"><day>23</day><month>11</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>11</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The identification of photobleaching steps in single molecule fluorescence imaging is a well-established procedure for analysing the stoichiometries of molecular complexes. Nonetheless, the method is challenging with protein fluorophores because of the high levels of noise, rapid bleaching and very variable signal intensities, all of which complicate methods based on statistical analyses of intensities to identify bleaching steps. It has recently been shown that deep learning by convolutional neural networks can yield an accurate analysis with a relatively short computational time. We describe here an improved use of such an approach that detects bleaching events even in the first time point of observation, and we have included this within an integrated software package incorporating fluorescence spot detection, colocalisation, tracking, FRET and photobleaching step analyses of single molecules or complexes. This package, known as FluoroTensor, is written in Python with a self-explanatory user interface.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">Single molecule methods provide a potent approach to examine macromolecular complexes. In particular, using total internal reflection fluorescence (TIRF) microscopy to visualize fluorophores, one can determine whether different specific molecules are present concurrently in a complex, and measure their stoichiometries, rates of association and dissociation, rates of conformational transitions and rates of diffusion in two dimensions<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R4">4</xref></sup>. The measurement of exact stoichiometries is a particular strength of the method, since they can be inferred by identifying successive steps in the stochastic photobleaching of individual molecules in a complex. Photobleaching has been used very widely to examine, for example, the numbers of subunits in membrane-bound protein complexes in prokaryotic and eukaryotic cells, the number of RNA or protein molecules in RNA splicing complexes and the numbers of molecules of a ligand bound to multi-subunit proteins<sup><xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R13">13</xref></sup>.</p><p id="P3">The photobleaching steps of dye-labelled macromolecules can often be assigned fairly easily by eye<sup><xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R14">14</xref></sup>. However, protein fluorophores have lower rates of emission, and so the signal/noise ratio is less favourable. Nonetheless, unassisted assignments can be made<sup><xref ref-type="bibr" rid="R11">11</xref></sup>. Assignment by eye has three disadvantages: it is subjective, and different observers may make different assignments; it is slow, which is of especial importance when the statistics require hundreds or thousands of traces to be analysed from each experiment; and it is often difficult to make assignments because observers look for plateaus on either side of a step and may not be able to judge whether, for example, there has been bleaching within the first frame or two of the recording or whether two events have taken place simultaneously or in close succession.</p><p id="P4">Several alternatives to visual inspection have been developed. One alternative is to measure the intensity of fluorescence from the single particles or spots prior to photobleaching, and divide this by the intensity of an individual (unitary) bleaching step. A number of methods have been developed to measure the unitary step, including a pairwise-difference distribution function<sup><xref ref-type="bibr" rid="R1">1</xref></sup>, an iterative search for statistically significant change points and a Gaussian fit to the distribution of step heights<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R16">16</xref></sup>, and the use of the last step in a bleaching curve to measure the statistical parameters of a step and then use of Bayesian methods to find models that best fit the observed curves <sup><xref ref-type="bibr" rid="R17">17</xref></sup>. A related method is the use of purified fluorescent protein to provide the single step data, and comparison of these with step spacings derived by edge-preserving filters and Fourier analysis<sup><xref ref-type="bibr" rid="R18">18</xref></sup> These methods are most appropriate where the step size is roughly constant, or where the numbers of fluorophores in each spot are so high that any variation in step size can be assumed to be averaged <sup><xref ref-type="bibr" rid="R17">17</xref></sup>. However, the absorption of excitation light depends strongly on the orientation of the molecular dipole; dipoles aligned in the direction of propagation of the field experience a field only around 10% of that experienced by dipoles perpendicular to the surface, and the rate of emission will be correspondingly reduced<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. Protein fluorophores on complexes that have been captured on a surface may have restricted orientations, and so the rate of emission and thus the magnitude of bleaching steps may show very wide variation among molecules and cannot be relied upon to reveal the numbers of molecules in a complex.</p><p id="P5">An alternative approach that is initially less dependent on knowledge of the unit step size is to model the bleaching time course by identifying the plateaus, or states, that flank the steps. An advantage of defining plateaus is that blinking or reactivation of fluorophores after bleaching does not affect the number of steps identified. Plateaus have been identified by hidden Markov models<sup><xref ref-type="bibr" rid="R20">20</xref></sup> or by measuring the mean and standard deviation for short segments of the curve, followed by iterative steps in which the segment was expanded<sup><xref ref-type="bibr" rid="R21">21</xref></sup>. Recursive binary segmentation has also been applied, with Student’s t or other statistical tests being used to maximise the difference in the means between the halves. In one recent method, this was followed by k-means clustering of segments, and then the use of a Viterbi algorithm to determine the most probable sequence of states<sup><xref ref-type="bibr" rid="R22">22</xref></sup>. These methods still required the amplitudes of the steps to be relatively consistent, and they perform better with increasing numbers of data points in each plateau. We have used a related method involving a Bayesian step point detector, requiring only a minimum but still arbitrary step height<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup>. A serious limitation with all these methods is that bleaching is stochastic, i.e., the probability is the same for every photon absorbed. Thus, more molecules will bleach in the first time-frame than in any other, but these will be missed in any method based on detecting statistical plateaus. Moreover, it is possible that all the methods summarised above will tend to lose molecules that bleach very rapidly or that have very small step heights, implying that there might be inadvertent selection of molecules with a restricted range of dipole orientations.</p><p id="P6">Deep learning could bypass some of the limitations or assumptions required in most of the above methods, if the training set were to include stochastic bleaching events and appropriately distributed step sizes. A program incorporating convolutional neural networks has been reported that performed well on samples labelled with dye or protein fluorophores, and reduced the time required for processing by two orders of magnitude<sup><xref ref-type="bibr" rid="R23">23</xref></sup>. However, in this case each state of the dataset used for training and testing included at least five time points, which would compromise its ability to detect bleaching in the first frame or very close frames. We describe a similar program here that enables these events to be detected accurately. Moreover, bleaching steps can be detected even with a signal/noise ratio as low as 1.1, when an accuracy of 75% was achieved. We have incorporated this programme into an integrated package for the detection of spots, colocalization, step measurement and downstream analysis, FRET and 2D tracking. We anticipate that this package will be useful in a wide range of single molecule experiments.</p></sec><sec id="S2" sec-type="methods"><label>2</label><title>Methods</title><sec id="S3"><label>2.1</label><title>Image Processing</title><p id="P7">The images acquired from the microscope were initially enhanced by summing the first 20% of frames for each channel to improve the signal-to-noise ratio of fluorescent foci. Additionally, the maximum projection was taken also to avoid missing foci from fluorophores that bleach rapidly. These projections were combined together and enhanced. Two alternative enhancement techniques were used. One is described in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 1 and 2</xref> (more detail in Supplementary Methods); the other is a wavelet transform. The correlation of the wavelet and image was computed for every pixel such that the output image is zero for all regions apart from fluorescent foci where the overlap integral was high.</p></sec><sec id="S4"><label>2.2</label><title>Detection of Fluorescent Foci</title><p id="P8">Fluorescent foci (spots) were detected in a four-step algorithm involving a number of thresholds; the steps are shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>. The enhanced image was split into a grid of 8x8 pixel boxes. Each potential spot was compared with a precomputed kernel to discard aberrant bright regions such as noise or dead pixels for computational efficiency. The remaining foci are then fitted with Gaussians and kept or rejected based on fitting criteria such as width, eccentricity, and residual.</p></sec><sec id="S5"><label>2.3</label><title>Correcting for Chromatic Aberration</title><p id="P9">To maintain focus when switching from 640 nm excitation to 488 nm excitation, the stage controller compensates in the z axis. This very minor change in z height between the channels, in tandem with lateral and spherical aberration, results in a slight difference in perceived magnification between the channels as shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>. A linear transform to correct for chromatic aberration is defined by <xref ref-type="disp-formula" rid="FD1">equations 1a</xref> and <xref ref-type="disp-formula" rid="FD2">1b</xref> below<sup><xref ref-type="bibr" rid="R9">9</xref></sup>: <disp-formula id="FD1"><label>(1a)</label><mml:math id="M1"><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula> <disp-formula id="FD2"><label>(1b)</label><mml:math id="M2"><mml:mrow><mml:mtext>Δ</mml:mtext><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula> where Δ<italic>x</italic>,Δ<italic>y</italic> is the shift in coordinates of a spot due to chromatic aberration, <italic>F</italic> is the shift factor which scales the whole transformation based on the wavelength difference (<italic>F</italic> = 1 for 640 nm → 488 nm and 0.35 for 640 nm → 561 nm corrections), (<italic>x,y</italic>) are the coordinates of the spot, (<italic>x<sub>c</sub>, y<sub>c</sub></italic>) are the coordinates of the origin of the transformation (where spots perfectly superimpose), and (<italic>S<sub>x</sub>, S<sub>y</sub></italic>) are scale factors of the stretch and are equal to the distance from the origin of the transformation which results in a 1 pixel shift in the respective axis. Note that here we refer to the channels by their excitation wavelengths, whereas the chromatic shift correction factors were calculated from peak emission wavelengths.</p></sec><sec id="S6"><label>2.4</label><title>Calculating Fluorescence Intensity Time Traces</title><p id="P10">Fluorescence intensity time traces were calculated from the raw data without enhancement. The background was subtracted locally around the spot for each frame as shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref>. The background subtraction ensures that if all the fluorophores in a fluorescent focus bleach, the mean intensity of the trace after that point will be zero. This is important as the neural network will only confidently assign stoichiometries where all the fluorophores have bleached. If one or more fluorophores don’t bleach within the recording time, the intensity will be above zero and the stoichiometry will be undecided.</p></sec><sec id="S7"><label>2.5</label><title>Neural Network Architecture</title><p id="P11">The architecture of the convolutional recurrent neural network (CRNN) is shown in <xref ref-type="fig" rid="F1">figure 1</xref>. The fluorescence intensity trace was convolved with a set of filters learned during training. This produces a set of feature maps which were then further convolved deeper in the network by even larger sets of filters. The feature maps were then passed to a long-short-term-memory (LSTM) layer. This increases prediction accuracy as the LSTM can ignore photo-blinking by the presence of features such as an upwards step when the fluorophore switches back on followed or preceded by a photobleaching event of a similar magnitude<sup><xref ref-type="bibr" rid="R23">23</xref></sup>. The output of the LSTM was passed to a multilayer perceptron which classifies the trace as having zero, one, two, three, four, five or more, or an undefined number of steps based on the combinations of features found by the LSTM.</p><p id="P12">A dropout layer was added between the LSTM and the dense layers to reduce overfitting <sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>. During training, 50% of neurons in the dropout layer were ignored at random during forward propagation. This prevents the network from over-relying on specific weights which effectively regularizes the model.</p></sec><sec id="S8"><label>2.2</label><title>Network Training</title><p id="P13">CRNN models were implemented in TensorFlow 2.7 using the Keras API. Models were trained on a Gigabyte GeForce 1070 and took approximately 24 hours to converge. To prevent overfitting, real-time validation was computed on an unseen validation set during training. Model weights were only saved if the validation sparse categorical accuracy had improved from the previous best epoch. The model was optimised using Adam with a learning rate of 0.0001 and the sparse categorical cross entropy loss function.</p><p id="P14">The CRNN architecture was trained independently on three separate artificial datasets to create three models tailored to different fluorophores, namely Cyanine 5 (Cy5), monomeric Cherry (mCherry), and monomeric enhanced green fluorescent protein (mEGFP). Cy5-like traces were simulated with constant step heights ± 20% allowing for some variation, and mCherry / mEGFP – like traces were synthesized with intensities drawn from a cos<sup>2</sup> distribution<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. Each training set was also synthesized over a range of signal-to-noise ratios to account for almost every case typically encountered with our experimental setup. <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref> shows examples of synthesized Cy5 traces and signal-to-noise ratio distributions of the training sets for each type of fluorophore. Traces were synthesized by first generating an idealized trace with stochastic photobleaching where the probabilities of virtual fluorophores based on the number of photons absorbed. Noise was then superimposed on the ideal trace. The simulation method is covered in more detail in Supplementary Materials. Average signal to noise ratios (aSNRs) of the steps of a trace were calculated using <xref ref-type="disp-formula" rid="FD3">equation 2</xref><sup><xref ref-type="bibr" rid="R23">23</xref></sup>: <disp-formula id="FD3"><label>(2)</label><mml:math id="M3"><mml:mrow><mml:mtext>aSNR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>k</italic> is the number of plateaus (number of steps + 1), <italic>u<sub>i</sub></italic> is the absolute difference between the mean of the i<sup>th</sup> plateau and the (i+1)<sup>th</sup> plateau, and <italic>σ<sub>i</sub></italic> is the standard deviation of the i<sup>th</sup> plateau.</p></sec><sec id="S9"><label>2.7</label><title>SM Tracking</title><p id="P15">Initially each frame was enhanced using a high pass filter. This was achieved by convolving the frame with a normalized Gaussian kernel (128x128, σ = 32, with padding) which acts as a low pass filter which was then subtracted from the original (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref> for example). The signal-to-noise ratio of the spot in the raw image data was calculated as the background subtracted mean intensity of the spot masked at the full-width-half-maximum of its Gaussian fit divided by the standard deviation of the surrounding background noise (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 8</xref>).</p><p id="P16">Molecules are detected on a framewise basis using the same detection algorithm as previously described for colocalization experiments. The fitting criteria are more relaxed for tracking experiments owing to the lower signal to noise ratio of individual frames compared to averaged frames in colocalization experiments. Tracks are connected by a temporal nearest neighbour algorithm. A spot was deemed to be the same molecule from a previous frame if it was the nearest to the previous position and within a threshold distance to prevent tracks connecting to other molecules across the image. If a molecule photo-blinks and is not detected for several frames, the algorithm will continue tracking it when it comes back within a small (typically 1 frame) time window and if it was still within the threshold distance, but otherwise it was treated as the beginning of a new track.</p><p id="P17">The diffusion coefficient for each track was calculated by taking the linear regression of the MSD plot and dividing the gradient by 4 for 2D diffusion. The method for calculating the MSD for different lag times (tau) is shown in <xref ref-type="disp-formula" rid="FD4">equations 3a</xref>/<xref ref-type="disp-formula" rid="FD5">b</xref><sup><xref ref-type="bibr" rid="R27">27</xref></sup>. <disp-formula id="FD4"><label>(3a)</label><mml:math id="M4"><mml:mrow><mml:mtext>MSD</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>τ</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mtext>Δ</mml:mtext><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula> <disp-formula id="FD5"><label>(3b)</label><mml:math id="M5"><mml:mrow><mml:mtext>τ</mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mtext>Δ</mml:mtext><mml:mi>n</mml:mi></mml:mrow></mml:math></disp-formula> where MSD(τ) is the mean square displacement at lag time τ, Δ<italic>n</italic> is a nonzero positive integer equal to the number of frames between the position of the spot at frame <italic>n</italic> and its position at frame <italic>n</italic> + Δ<italic>n</italic>, <italic>N</italic> is the total number of frames, <italic>x</italic> and <italic>y</italic> are the coordinates of the spot in the respective frame, <italic>t<sub>f</sub></italic> is the frame duration. The MSD was then plotted against τ for every possible Δ<italic>n</italic>.</p></sec><sec id="S10"><label>2.8</label><title>Sample Prep</title><p id="P18">Proteins fused to mCherry and mEGFP were expressed in HEK293T cells. Nuclear extracts were prepared and samples were injected into chambers on the cover slip as describe<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup>. Images were acquired as described <sup><xref ref-type="bibr" rid="R9">9</xref></sup> with a minor change – the number of frames recorded was standardized to 300 in line with the neural network’s input domain. For the analysis of 2D diffusion, dye-conjugated oligonucleotides were conjugated to a hydrophobic moiety and injected onto a hydrophobic surface as described (Santana Vega et al, manuscript in preparation). Images were acquired by TIRF.</p></sec></sec><sec id="S11" sec-type="results"><label>3</label><title>Results</title><p id="P19">The overall purposes of this work were to use deep learning to develop an improved method for detecting the numbers of bleaching steps in time courses of fluorescence and to embed it in an integrated software package that could facilitate and accelerate much of the data analysis associated with TIRF microscopy. Prior to the extraction of time course data, images need to be processed to reveal faint signals and, in the case of multicolour fluorescence experiments in which molecules or complexes might contain more than one fluorophore, colocalized signals need to be identified. These steps are followed by extraction of the intensity data for each spot detected and identification of the number of steps in which each colour bleached (<xref ref-type="fig" rid="F1">Figure 1</xref>).</p><sec id="S12"><label>3.1</label><title>Detection of fluorescent molecules or complexes</title><p id="P20">Since protein fluorescence intensities can vary widely, FluoroTensor incorporates a set of operations designed to detect signals over a wide range. The detection of dim signals is important to avoid under-representation of weak emitters, which are likely to contain only a single fluorophore. Initial trials showed that a high-pass filter did not produce an image with a satisfactory background removal and sufficient contrast for weak emitters such as mCherry (<xref ref-type="fig" rid="F2">Figure 2</xref>). Instead, the signal/noise ratio is improved by summing the frames for a user-specified proportion of the acquisition (usually the first 20%, which reduces the inclusion of frames acquired after bleaching of the spots). In addition, the maximum pixel values in this region are taken, to improve the visibility of spots that bleach rapidly. The summation and maximum values are combined and normalised. This image is enhanced in either of two ways (as described in methods).</p><p id="P21">Spots are detected using a pre-computed Gaussian kernel and calculation of the residual between the spot and the kernel. Those spots that satisfy this criterion are fitted by a Gaussian curve to calculate the coordinates of the spot with sub-pixel precision. This procedure involves less computation than the alternative of trying to fit all possible regions of the field of view to a Gaussian. Any remaining false positives are discarded during downstream analysis of the fluorescence trace due to the absence of photo-bleaching steps.</p><p id="P22">The colocalization of spots in images acquired at different wavelengths is often complicated by chromatic aberration. This arises from the different angles of refraction at those wavelengths. resulting in a difference in focal depth between the channels. This effect is generally counteracted either by the use of fiducial beads in the sample or by prior calibration of the system (<xref ref-type="disp-formula" rid="FD1">equations 1a</xref> and <xref ref-type="disp-formula" rid="FD2">1b</xref>) with beads or dual-labelled molecules. However, we observed that, when the stage was automatically moved to a new area on the slide, in some cases the autofocus would keep the field of view in focus but at a slightly different focal height, resulting in a change in chromatic aberration with slightly different parameters. This change could result in some spots not being identified as colocalized. To solve this, we incorporated an additional optional solution in which an optimizer is implemented directly into the program to solve the parameters to <xref ref-type="disp-formula" rid="FD1">equations 1a</xref>/<xref ref-type="disp-formula" rid="FD2">b</xref> for each field of view during automated analysis. The approach is to solve the parameters for maximum colocalization. However, the colocalization count is not a continuous function of the parameters and as such, unsuitable for optimization by commonly used solvers such as Simplex. The first step is to test an array of transformation origins and scale factors to find an approximate set of parameters which maximises the number of colocalized spots via grid search. Next, a Simplex solver minimizes the distances between colocalized spots, taking the crude parameters as an input and refining them. A minimum of 4 colocalized spots is required for this to work reliably and spots should be sparsely populated, especially if the colocalization percentage is low, to discourage the solver from attempting to colocalize randomly proximal spots.</p></sec><sec id="S13"><label>3.2</label><title>Determination of stoichiometry by a convolutional neural network</title><p id="P23">The architecture was designed to be efficient as well as accurate. The FluoroTensor platform enables users to quickly train their own models from this architecture. The architecture is small, totalling only 220K parameters, and yet it shows improved accuracy (<xref ref-type="fig" rid="F3">Figure 3</xref>) when compared with larger models <sup><xref ref-type="bibr" rid="R23">23</xref></sup>. Our models were trained independently on 3 different datasets totalling 18 million synthetic traces. Each model took 24-48 hours to train on an NVIDIA GTX 1070 GPU using a modified Keras generator to load datasets of 240,000 traces sequentially during training. The use of synthetic traces was mandated by the need to know the number of steps in each trace and to ensure equal representation of traces with the different numbers of steps being classified. A plateau length restriction was placed on traces with very low signal to noise ratios (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 9</xref>), such that if two bleaching steps were indistinguishable from a single step, the intermediate plateau was extended, and no other fluorophores were allowed to bleach in the simulation until the intermediate plateau becomes resolvable. Statistically only a small proportion of the training data has these extended plateaus based on the SNR distribution. Of great importance to note is that these restrictions were only imposed on the training dataset to prevent the model from overpredicting steps. All synthetic testing data was simulated with stochastic bleaching, allowing for simultaneous bleaching events that would be present in real data unless explicitly stated otherwise.</p><p id="P24">The network was tested using simulated data for organic fluorophores that lacked constraints and therefore included some simultaneous bleaching events. These tests were done on sets of data with a range of signal/noise ratios and various mean fluorescence intensities (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 10</xref>). The accuracies recorded increased with the signal/noise ratio, as expected, from 74% at a ratio of 1.105 to 98.1% at a ratio of 8.853. Accuracy will never reach 100% due to the inherent uncertainty of simultaneous photo-bleaching events regardless of the signal to noise ratio. To gain insights into the feature extractor part of the neural network, the 128-dimensional feature vectors (the outputs of the LSTM layer of the model) of a dataset of 20,000 traces were processed by t-distributed stochastic neighbour embedding (t-SNE) dimensionality reduction algorithm to produce a 2-dimensional map clustering the feature vectors by similarity (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 11</xref>). Comparing the feature vector t-SNE plots with the t-SNE plots built from the traces themselves (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 12</xref>) it is clear that the convolutional and LSTM layers of the network are working as intended, reducing the extremely high intra-class variance of the traces significantly into highly conserved feature vectors which can then be decoded by the multilayer-perceptron classifier. Crucially, the intra-class variance is hugely reduced while the inter-class variance is increased, i.e., feature vectors are highly correlated between members of the same class and highly uncorrelated between members of different classes.</p><p id="P25">The experimental setup and operating procedure described here have been optimised for recordings of 300 frames (time points in the traces) for each colour channel. Convolutional Neural networks have a fixed size input domain and thus any trace entering the model needs to be resampled to 300 frames to match the 300 neurons of the input layer. As shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 13C</xref>, resampling a trace from 100 frames to 300 frames using a linear interpolator introduces extra time points between plateaus. Once the number of interpolated points is on the order of the number of frames of the shortest plateaus, the neural network is unable to distinguish the interpolated frames from a true plateau and begins to overpredict the number of steps in the trace resulting in significantly reduced accuracy, as shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 13A and 13B</xref>. Interestingly, when the bleaching half-life is sufficiently short such that a number of steps would be missed due to simultaneous bleaching events, the accuracy of the 200-frame dataset interpolated to 300 frames was slightly greater than the accuracy of the native 300-frame dataset. This effect can be attributed to overprediction caused by resampling the 200-frame that was compensating for the underprediction due to simultaneous bleaching events. The inverse linear correlation between the probability of a fluorophore bleaching per frame and the accuracy of the neural network is shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 13D</xref>. Almost all errors were due to underpredictions where the network is unable to distinguish bleaching steps with more than one bleaching event. For this reason, it would be advisable to choose a frame rate and laser power that maximises the mean time interval between bleaching events while also ensuring that bleaching is likely to be complete for all likely numbers of bleaching steps by the end of the 300 frames.</p></sec><sec id="S14"><label>3.3</label><title>Comparisons of performance</title><p id="P26">To compare the performance of FluoroTensor with a previous neural network model (CLDNN<sup><xref ref-type="bibr" rid="R23">23</xref></sup>) and with a statistical method<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>, time courses were simulated for complexes containing 0 to 4 protein-like fluorophores across a range of mean signal/noise ratios (mean bleaching half-life was 40.5 frames, see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 14 and 15</xref>). The percentage of complexes predicted correctly by each of these methods is shown in <xref ref-type="fig" rid="F3">Figure 3</xref>. In addition to simulations of stochastic bleaching, a second set of simulations was made with a minimum of 5 frames between each bleaching step. The results show that FluoroTensor was significantly more accurate for each dataset than the other two methods. Interestingly, in both data sets the CLDNN model performed better than the statistical method, based on maximum likelihood estimation<sup><xref ref-type="bibr" rid="R29">29</xref></sup>, at low signal/noise ratios whereas the MLE method was superior at higher signal/noise ratios.</p><p id="P27">A further comparison was done to analyse whether the abilities of the methods to determine the distributions of complexes with various numbers of fluorophores would indicate the reasons behind the differences in performance. Three SM TIFF stacks were simulated with virtual complexes formed with a number of dye-like fluorophores drawn from binomial distributions based on the numbers of molecules in a complex (2, 3 and 4) and the proportion of these that were labelled (p = 0.5, 0.4 and 0.6 respectively; <xref ref-type="fig" rid="F4">Figure 4A</xref>). Complexes were modelled as Gaussian functions with sigma = 1.3 and an amplitude equal to the sum of the intensity of the virtual emitters. The fluorophores were allowed to bleach stochastically. Gaussian noise was added to simulate dark current, a non-uniform autofluorescence was added to each frame and shot noise was modelled with a gamma distribution to account for EMCCD gain.</p><p id="P28">The three stacks were analysed automatically by FluoroTensor to identify the spots and the stoichiometries of the simulated complexes. The distributions observed matched the expected binomial distributions (<xref ref-type="fig" rid="F4">Figure 4B</xref>). These distributions were then used to predict the numbers of molecules in the complexes, producing answers of 2 (with a confidence of 78%), 3 (with a confidence of 83%), and 4 (with a confidence of 80%). The analysis was repeated on the same set of extracted traces using the computation neural network<sup><xref ref-type="bibr" rid="R23">23</xref></sup>, with the results shown in <xref ref-type="fig" rid="F4">Figure 4C</xref>. This underestimated the complexes with three or four steps, and the number two was overestimated, possibly because close bleaching steps were not assigned to distinct molecules. The TIFF stacks were also analysed using a MATLAB suite of programs that enabled spot detection and assigned stoichiometries using an automated step detection algorithm based on maximum likelihood estimation (MLE; <xref ref-type="fig" rid="F4">Figure 4D</xref>)<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>. In contrast to CLDNN, this analysis tended to overestimate the abundance of complexes with higher stoichiometries, possibly because of the signal/noise ratio (distribution shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 16</xref>).</p><p id="P29">Apart from the accuracy, there are two further advantages of FluoroTensor compared with statistical methods: the speed of the analysis and the ability to correct automatically for chromatic aberration. An example illustrating these advantages is shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 17A</xref>. A dataset from TIRF microscopy of a sample of nuclear extract containing regulatory splicing complexes with fluorescently labelled components of interest and fluorescently labelled RNA was analysed both with FluoroTensor (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 17A</xref>) and the MLE-based method (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 17B</xref>). The FluoroTensor automated run was complete within 45 minutes of elapsed time on the dataset. No calibration file was used for chromatic aberration. Instead, the built-in optimizer detailed in section 3.1 solved the correction parameters for chromatic aberration and built up the dataset of colocalized traces. This process was entirely unsupervised apart from the final step where the program was prompted to detect the steps using the neural networks and then export the data to a preformatted excel template. In the MATLAB program, the analysis needed to be supervised with manual corrections to the spots detected and the process took over 16 hours. The software also relied on a calibration file which had pre-solved parameters from a set of calibration movies meaning that it does not accommodate any variations in the chromatic aberration from one file to the next due to subtle changes in focus. Errors in steps detected by maximum likelihood compared to the neural network model are shown for some traces in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 18</xref>. These errors are thought to be made because MLE requires a threshold step size. Since these step sizes are highly variable in FP-like traces some weaker steps will be missed and brighter ones overcounted due to the necessity of setting a low enough threshold as not to miss the weaker emitters. Thus, we propose MLE could be a viable alternative for organic dyes with constant step sizes.</p></sec><sec id="S15"><label>3.4</label><title>Localization Accuracy of 2D Tracking Algorithm</title><p id="P30">The spots representing macromolecular complexes are not always stationary. TIRF microscopy is used to track components undergoing lateral diffusion in membranes<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref></sup> or other surfaces onto which complexes are adsorbed without covalent tethering. In such cases, estimates can be made of the diffusion coefficients of the complexes, and they may reveal heterogeneity in the surface or the interactions of the fluorescent component. However, the accuracy with which the position of a spot can be determined in a single frame is critical. In FluoroTensor, the background in each frame is removed with a high pass filter, and the location of each spot is determined as described above, beginning with a pre-computed Gaussian kernel. The analysis of simulated spots (see Materials and Methods) showed, as expected, that the mislocalization error shows a strong dependence on the signal to noise ratio of the spot in each frame (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 19, 20, and 21</xref>). With a mean SNR of less than ~2.9, some spots almost disappeared into the noise in some frames, leading to outliers with very high mislocalization. Measured spots from real single molecule data, collected from Alexa-647 ® tagged oligonucleotides diffusing on a surface typically had a mean SNR of 5 or higher, which according to our findings would have a mean mislocalization of ~20nm on our SM TIRF microscope, with 99.7% of measured positions being localized within 50nm within a time bin of 100ms. Tracking is done by connecting each spot in a frame with the spot in the closest location in the succeeding frame (<xref ref-type="fig" rid="F5">Figure 5</xref>). A maximum jump distance per frame is set based on observed motion of the moving particles to ensure valid connections of a particle one frame to the next.</p></sec><sec id="S16"><label>3.5</label><title>Estimation of Error in MSD Fit and Diffusion Histograms</title><p id="P31">Mean square displacement is calculated according to <xref ref-type="disp-formula" rid="FD4">equation 3a</xref> for each track found by the program. To ensure accurate distributions of diffusion coefficients of molecules in the sample to a degree where heterogeneity in motion can be distinguished, the quality of the MSD fit must be assessed over its range and maximised. As Δn→N (<xref ref-type="disp-formula" rid="FD4">equation 3a</xref>), the mean displacement no longer represents the RMS Brownian diffusion distance of a model random walk of indefinite length. This results in severe deviation of MSD vs τ from a linear fit, especially when the end-to-end distance of the track is far from the expected RMS separation (<xref ref-type="fig" rid="F5">Figure 5</xref>; <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 22B</xref>). For this reason, only the initial portion of the beginning of the MSD plot is fitted. The proportion of the MSD plot to fit is decided on a track-by-track basis by calculating a linear regression for proportions of the data points in the MSD plot. The fitted region of the plot ends where the derivative of the coefficient of determination (R<sup>2</sup>) becomes negative. The final MSD fit is taken as the linear regression of all points of the MSD plot before this point. The standard deviation of the diffusion coefficients for all fitting percentages up until the point at which the derivative of R<sup>2</sup> becomes negative is calculated to be used as a rough estimate of the error in the diffusion coefficient calculated by the final MSD fit (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 22B/C</xref>).</p><p id="P32">To resolve the diffusion coefficients of a heterogeneous mixture, all tracks where the standard deviation as a percentage of the diffusion coefficient was greater than a specified value are rejected. This strategy results in histograms where the distribution of diffusion coefficients in a heterogeneous mixture of diffusing molecules with two or more distinct diffusivities is more easily resolved in a Gaussian mixture model than the unfiltered distribution. <xref ref-type="fig" rid="F6">Figure 6</xref> shows the effect of filtering by rejecting tracks with various estimated fitting errors. The most accurate fit was obtained with the most stringently selected data, albeit at the expense of a reduced number of data points (<xref ref-type="fig" rid="F6">Figure 6</xref>; <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 22, D-F</xref>). This technique will be of particular use when tracks are short due to transient binding to a surface or short bleaching times of the fluorophores.</p></sec><sec id="S17"><title>Fluorescence Resonance Energy Transfer</title><p id="P33">FRET involving two components is detected using the same Gaussian mixture model that was used above for resolving the diffusion coefficients in a heterogeneous mixture. This detects FRET states lasting for four or more frames, and, assuming a first order process, produces rate constants for the two steps. An example is shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 23</xref>.</p></sec></sec><sec id="S18" sec-type="discussion"><label>4</label><title>Discussion</title><p id="P34">We have presented a versatile new software package written in python for single molecule total internal reflection fluorescence (SM TIRF) microscopy. The FluoroTensor software package will be of particular use in two main areas. Primarily this software was designed to provide an automated analysis pipeline for single molecule multicolour colocalization microscopy with automatic correction for chromatic aberration, high contrast enhancement capable of resolving extremely weak signals from fluorescent proteins and the ability to detect photobleaching events in consecutive frames, i.e., without the requirement for identifying a statistical plateau. Within FluoroTensor, we present a neural network architecture for determining the number of photobleaching steps in the fluorescence traces extracted in the aforementioned automated analysis of SM data with 96% fewer parameters than the previous state of the art model for this purpose<sup><xref ref-type="bibr" rid="R23">23</xref></sup> and with improved accuracy. The model is much more efficient to train, and our pre-trained versions are not limited to a minimum number of frames per plateau. A primary aim for this project was creating a ‘plug and play’ platform for these neural networks such that end users could train their own models based on our architecture on custom datasets, or even develop the architecture further with a relatively simple python script. Alternatively, users may finetune one of our pretrained models with their data. In addition, The SM tracking extension is well suited for tracking SM diffusion in noisy conditions where particles of interest are transient or photo-bleach rapidly. The tracking add-in which can be launched from within the main GUI also allows for automated chaining of raw data which is analysed sequentially and saved as a document file that can be reloaded and exported to Excel. We believe the tracking add-in is of most use in the analysis of heterogenous mixtures of molecules with a rage of diffusivities as our MSD fitting and filtering algorithm cleans up ‘messy’ distributions and allows fitting with a Gaussian mixture model within the GUI allowing for fast and straightforward preliminary analysis. Finally, a basic FRET add-in extends the usefulness of the package for a very common application of single molecule TIRF microscopy.</p><p id="P35">The package contains two different methods for enhancing the image to allow detection of weak spots. The wavelet transform is computed more rapidly, but the convolution method appears to be more reliable with faint spots in a noisy background, such as might be seen using mCherry as a fluorophore. The choice between these two is left for the user. The automated colocalization procedure to compensate for chromatic aberration is a major practical advantage. However, if colocalization is very low, below the threshold of four spots, then a calibration file will have to be created and used. The display shows the transformation vectors across the screen, which is helpful in reassuring the user that any two spots in different colours are properly related for colocalization.</p><p id="P36">The improvement in accuracy of step detection was surprisingly large, reaching 20-30% higher than the other methods tested at a signal/noise ratio of 3.5 (<xref ref-type="fig" rid="F3">Figure 3</xref>). Some of the remaining error is the result of close or simultaneous bleaching events that could not be resolved, even though the performance is better than that of a trained observer. This is consistent with the tendency to under-count the number of steps at low signal/noise ratios and the decrease in accuracy as the number of steps increases and the likelihood of events in close proximity increases (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 24</xref>). The results also suggest that any measurement of stoichiometries is likely to be unreliable for three steps or more if the signal/noise ratio is lower than 2.</p><p id="P37">The measurement of diffusion rates for single molecules presented several difficulties. First, the localization has to be accurate. Again, a signal/noise ratio of &gt;2.5 is helpful. Stage drift needs to be measured and, if sufficiently large, will need to be taken into account. Wobbles or perturbations in focal height should also be avoided. Also of importance is the tuning of the spot-fitting parameters of the program before beginning tracking to ensure that coalescence cannot occur. If two spots coalesce and then separate, the program will not be able to distinguish which particle was which. Setting the maximum jump distance per frame based on the observed motion of the moving particles is also important, especially in fields of view with a high spot density, to ensure valid connections of a particle from one frame to the next. If the value is set too low, the particle will not be tracked as its new position will be treated as a separate object; too high, and the path may jump to a different object.</p></sec><sec id="S19" sec-type="conclusions"><label>5</label><title>Conclusion</title><p id="P38">We conclude that FluoroTensor is a versatile and useful tool for the analysis of single molecules by wide-field microscopy: its performance in measuring stoichiometry is the best currently available, and innovations such as the automated colocalization and the method for establishing the most reliable measurements of diffusion for each molecule improve the convenience and reliability of methods for analysing the behaviour of single molecules.</p><sec id="S20"><title>Recommended System Requirements</title><p id="P39"><table-wrap id="T1" position="anchor" orientation="portrait"><table frame="void" rules="none"><tbody><tr><td align="left" valign="top">OS:</td><td align="left" valign="top">Windows 10 64 bit</td></tr><tr><td align="left" valign="top">CPU:</td><td align="left" valign="top">8<sup>th</sup> GEN intel i5-8500 / AMD Ryzen 5 3600XT or newer</td></tr><tr><td align="left" valign="top">RAM:</td><td align="left" valign="top">16GB DDR4 / 32GB DDR4 (recommended for large datasets.)</td></tr><tr><td align="left" valign="top">GPU:</td><td align="left" valign="top">(not required) / NVIDIA GTX 1070 (minimum for model training of datasets larger than 1M traces.)</td></tr><tr><td align="left" valign="top">Storage:</td><td align="left" valign="top">Minimum 1TB permanent storage for single molecule data (recommend SSD. Use permanent storage for fastest data load times instead of networked storage where possible.)</td></tr></tbody></table></table-wrap></p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Figures comprising Supplementary Methods and Results</label><media xlink:href="EMS191500-supplement-Figures_comprising_Supplementary_Methods_and_Results.pdf" mimetype="application" mime-subtype="pdf" id="d3aAdFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S21"><title>Acknowledgements</title><p>Dr B. Xu (Informetis, Cambridge) provided insights in the early stages of our AI development. Dr A. Revyakin and Dr D. Cherny provided helpful pointers and discussions on enhancement techniques for single molecule images. Dr T.J. Ragan provided insights into data analysis methods. Mr C. Lucas, Dr V. Paschalis and Dr S. Tubasum supplied single molecule TIRF data. Prof. X. Fang and Dr J. Xu kindly provided their CLDNN model for our comparisons.</p><sec id="S22"><title>Funding</title><p>MW was supported by a University of Leicester studentship form the College of Life Sciences. The research was supported by BBSRC sLoLa award BB/T000627/1 to AJH and ICE.</p></sec></ack><sec id="S23" sec-type="data-availability"><title>Code Availability</title><p id="P40">We propose to release FluoroTensor alongside this publication (final GITHUB repository link to be confirmed). Video tutorials will be made available on the SpliceSelect website (<ext-link ext-link-type="uri" xlink:href="https://www.spliceselect.org">https://www.spliceselect.org</ext-link>).</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P41"><bold>CRediT authorship contribution statement</bold></p><p id="P42">MFKW: Conceptualization, Methodology, Software, Validation, Formal analysis, Writing-original draft, Writing-review and editing, Visualization. CBA: Resources. NH: Methodology, Software, Writing-review and editing. AJH: Conceptualization, Methodology, Writing-review and editing, Supervision. ICE: Conceptualization, Writing-original draft, Writing-review and editing, Supervision, Project administration, Funding acquisition.</p></fn><fn id="FN2" fn-type="conflict"><p id="P43"><bold>Declaration of Competing Interest</bold></p><p id="P44">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leake</surname><given-names>MC</given-names></name><etal/></person-group><article-title>Stoichiometry and turnover in single, functioning membrane protein complexes</article-title><source>Nature</source><year>2006</year><volume>443</volume><fpage>355</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">16971952</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>J</given-names></name><name><surname>Guo</surname><given-names>P</given-names></name></person-group><article-title>Counting of six pRNAs of phi29 DNA-packaging motor with customized single-molecule dual-view system</article-title><source>EMBO J</source><year>2007</year><volume>26</volume><fpage>527</fpage><lpage>537</lpage><pub-id pub-id-type="pmcid">PMC1783441</pub-id><pub-id pub-id-type="pmid">17245435</pub-id><pub-id pub-id-type="doi">10.1038/sj.emboj.7601506</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abelson</surname><given-names>J</given-names></name><etal/></person-group><article-title>Conformational dynamics of single pre-mRNA molecules during in vitro splicing</article-title><source>Nat Struct Mol Biol</source><year>2010</year><volume>17</volume><fpage>504</fpage><lpage>512</lpage><pub-id pub-id-type="pmcid">PMC2881217</pub-id><pub-id pub-id-type="pmid">20305654</pub-id><pub-id pub-id-type="doi">10.1038/nsmb.1767</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>F</given-names></name><name><surname>Qin</surname><given-names>G</given-names></name><name><surname>Xia</surname><given-names>T</given-names></name><name><surname>Fang</surname><given-names>XH</given-names></name></person-group><article-title>Single-Molecule Imaging of Protein Interactions and Dynamics</article-title><source>Annu Rev Anal Chem</source><year>2020</year><volume>13</volume><fpage>337</fpage><lpage>361</lpage><pub-id pub-id-type="pmid">32228033</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>L</given-names></name><etal/></person-group><article-title>Stoichiometries of U2AF35, U2AF65 and U2 snRNP reveal new early spliceosome assembly pathways</article-title><source>Nucleic Acids Res</source><year>2017</year><volume>45</volume><fpage>2051</fpage><lpage>2067</lpage><pub-id pub-id-type="pmcid">PMC5389562</pub-id><pub-id pub-id-type="pmid">27683217</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkw860</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cherny</surname><given-names>D</given-names></name><etal/></person-group><article-title>Stoichiometry of a regulatory splicing complex revealed by single-molecule analyses</article-title><source>EMBO J</source><year>2010</year><volume>29</volume><fpage>2161</fpage><lpage>2172</lpage><pub-id pub-id-type="pmcid">PMC2905242</pub-id><pub-id pub-id-type="pmid">20502437</pub-id><pub-id pub-id-type="doi">10.1038/emboj.2010.103</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hodson</surname><given-names>MJ</given-names></name><name><surname>Hudson</surname><given-names>AJ</given-names></name><name><surname>Cherny</surname><given-names>D</given-names></name><name><surname>Eperon</surname><given-names>IC</given-names></name></person-group><article-title>The transition in spliceosome assembly from complex E to complex A purges surplus U1 snRNPs from alternative splice sites</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><fpage>6850</fpage><lpage>6862</lpage><pub-id pub-id-type="pmcid">PMC3413131</pub-id><pub-id pub-id-type="pmid">22505580</pub-id><pub-id pub-id-type="doi">10.1093/nar/gks322</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoskins</surname><given-names>AA</given-names></name><name><surname>Gelles</surname><given-names>J</given-names></name><name><surname>Moore</surname><given-names>MJ</given-names></name></person-group><article-title>New insights into the spliceosome by single molecule fluorescence microscopy</article-title><source>Curr Opin Chem Biol</source><year>2011</year><volume>15</volume><fpage>864</fpage><lpage>870</lpage><pub-id pub-id-type="pmcid">PMC3310177</pub-id><pub-id pub-id-type="pmid">22057211</pub-id><pub-id pub-id-type="doi">10.1016/j.cbpa.2011.10.010</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jobbins</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Exon-independent recruitment of SRSF1 is mediated by U1 snRNP stemloop 3</article-title><source>EMBOJ</source><year>2022</year><volume>41</volume><elocation-id>e107640</elocation-id><pub-id pub-id-type="pmcid">PMC8724738</pub-id><pub-id pub-id-type="pmid">34779515</pub-id><pub-id pub-id-type="doi">10.15252/embj.2021107640</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jobbins</surname><given-names>AM</given-names></name><etal/></person-group><article-title>The mechanisms of a mammalian splicing enhancer</article-title><source>Nucleic Acids Res</source><year>2018</year><volume>46</volume><fpage>2145</fpage><lpage>2158</lpage><pub-id pub-id-type="pmcid">PMC5861446</pub-id><pub-id pub-id-type="pmid">29394380</pub-id><pub-id pub-id-type="doi">10.1093/nar/gky056</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulbrich</surname><given-names>MH</given-names></name><name><surname>Isacoff</surname><given-names>EY</given-names></name></person-group><article-title>Subunit counting in membrane-bound proteins</article-title><source>Nat Methods</source><year>2007</year><volume>4</volume><fpage>319</fpage><lpage>321</lpage><pub-id pub-id-type="pmcid">PMC2744285</pub-id><pub-id pub-id-type="pmid">17369835</pub-id><pub-id pub-id-type="doi">10.1038/NMETH1024</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shcherbakova</surname><given-names>I</given-names></name><etal/></person-group><article-title>Alternative Spliceosome Assembly Pathways Revealed by Single-Molecule Fluorescence Microscopy</article-title><source>Cell Reports</source><year>2013</year><volume>5</volume><fpage>151</fpage><lpage>165</lpage><pub-id pub-id-type="pmcid">PMC3927372</pub-id><pub-id pub-id-type="pmid">24075986</pub-id><pub-id pub-id-type="doi">10.1016/j.celrep.2013.08.026</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herbert</surname><given-names>KM</given-names></name><etal/></person-group><article-title>A heterotrimer model of the complete Microprocessor complex revealed by single-molecule subunit counting</article-title><source>RNA</source><year>2016</year><volume>22</volume><fpage>175</fpage><lpage>183</lpage><pub-id pub-id-type="pmcid">PMC4712668</pub-id><pub-id pub-id-type="pmid">26683315</pub-id><pub-id pub-id-type="doi">10.1261/rna.054684.115</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>del Rio</surname><given-names>A</given-names></name><etal/></person-group><article-title>Stretching single talin rod molecules activates vinculin binding</article-title><source>Science</source><year>2009</year><volume>323</volume><fpage>638</fpage><lpage>641</lpage><pub-id pub-id-type="pmcid">PMC9339221</pub-id><pub-id pub-id-type="pmid">19179532</pub-id><pub-id pub-id-type="doi">10.1126/science.1162912</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Deffenbaugh</surname><given-names>NC</given-names></name><name><surname>Anderson</surname><given-names>CT</given-names></name><name><surname>Hancock</surname><given-names>WO</given-names></name></person-group><article-title>Molecular counting by photobleaching in protein complexes with many subunits: best practices and application to the cellulose synthesis complex</article-title><source>Mol Biol Cell</source><year>2014</year><volume>25</volume><fpage>3630</fpage><lpage>3642</lpage><pub-id pub-id-type="pmcid">PMC4230622</pub-id><pub-id pub-id-type="pmid">25232006</pub-id><pub-id pub-id-type="doi">10.1091/mbc.E14-06-1146</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shepherd</surname><given-names>JW</given-names></name><name><surname>Higgins</surname><given-names>EJ</given-names></name><name><surname>Wollman</surname><given-names>AJM</given-names></name><name><surname>Leake</surname><given-names>MC</given-names></name></person-group><article-title>PySTACHIO: Python Single-molecule TrAcking stoiCHiometry Intensity and simulation, a flexible, extensible, beginner-friendly and optimized program for analysis of single-molecule microscopy data</article-title><source>Comput Struct Biotechno IJ</source><year>2021</year><volume>19</volume><fpage>4049</fpage><lpage>4058</lpage><pub-id pub-id-type="pmcid">PMC8327484</pub-id><pub-id pub-id-type="pmid">34377369</pub-id><pub-id pub-id-type="doi">10.1016/j.csbj.2021.07.004</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsekouras</surname><given-names>K</given-names></name><name><surname>Custer</surname><given-names>TC</given-names></name><name><surname>Jashnsaz</surname><given-names>H</given-names></name><name><surname>Walter</surname><given-names>NG</given-names></name><name><surname>Presse</surname><given-names>S</given-names></name></person-group><article-title>A novel method to accurately locate and count large numbers of steps by photobleaching</article-title><source>Mol Biol Cell</source><year>2016</year><volume>27</volume><fpage>3601</fpage><lpage>3615</lpage><pub-id pub-id-type="pmcid">PMC5221592</pub-id><pub-id pub-id-type="pmid">27654946</pub-id><pub-id pub-id-type="doi">10.1091/mbc.E16-06-0404</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reyes-Lamothe</surname><given-names>R</given-names></name><name><surname>Sherratt</surname><given-names>DJ</given-names></name><name><surname>Leake</surname><given-names>MC</given-names></name></person-group><article-title>Stoichiometry and architecture of active DNA replication machinery in Escherichia coli</article-title><source>Science</source><year>2010</year><volume>328</volume><fpage>498</fpage><lpage>501</lpage><pub-id pub-id-type="pmcid">PMC2859602</pub-id><pub-id pub-id-type="pmid">20413500</pub-id><pub-id pub-id-type="doi">10.1126/science.1185757</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wakelin</surname><given-names>S</given-names></name><name><surname>Bagshaw</surname><given-names>CR</given-names></name></person-group><article-title>A prism combination for near isotropic fluorescence excitation by total internal reflection</article-title><source>J Microsc</source><year>2003</year><volume>209</volume><fpage>143</fpage><lpage>148</lpage><pub-id pub-id-type="pmid">12588531</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Messina</surname><given-names>TC</given-names></name><name><surname>Kim</surname><given-names>H</given-names></name><name><surname>Giurleo</surname><given-names>JT</given-names></name><name><surname>Talaga</surname><given-names>DS</given-names></name></person-group><article-title>Hidden Markov model analysis of multichromophore photobleaching</article-title><source>J Phys Chem B</source><year>2006</year><volume>110</volume><fpage>16366</fpage><lpage>16376</lpage><pub-id pub-id-type="pmcid">PMC1995553</pub-id><pub-id pub-id-type="pmid">16913765</pub-id><pub-id pub-id-type="doi">10.1021/jp063367k</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>H</given-names></name><name><surname>Aurousseau</surname><given-names>MR</given-names></name><name><surname>Bowie</surname><given-names>D</given-names></name><name><surname>Blunck</surname><given-names>R</given-names></name></person-group><article-title>Automating single subunit counting of membrane proteins in mammalian cells</article-title><source>J Biol Chem</source><year>2012</year><volume>287</volume><fpage>35912</fpage><lpage>35921</lpage><pub-id pub-id-type="pmcid">PMC3476259</pub-id><pub-id pub-id-type="pmid">22930752</pub-id><pub-id pub-id-type="doi">10.1074/jbc.M112.402057</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>DS</given-names></name><name><surname>Goldschen-Ohm</surname><given-names>MP</given-names></name><name><surname>Goldsmith</surname><given-names>RH</given-names></name><name><surname>Chanda</surname><given-names>B</given-names></name></person-group><article-title>Top-down machine learning approach for high-throughput single-molecule analysis</article-title><source>Elife</source><year>2020</year><volume>9</volume><pub-id pub-id-type="pmcid">PMC7205464</pub-id><pub-id pub-id-type="pmid">32267232</pub-id><pub-id pub-id-type="doi">10.7554/eLife.53357</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J</given-names></name><etal/></person-group><article-title>Automated Stoichiometry Analysis of Single-Molecule Fluorescence Imaging Traces via Deep Learning</article-title><source>J Am Chem Soc</source><year>2019</year><volume>141</volume><fpage>6976</fpage><lpage>6985</lpage><pub-id pub-id-type="pmid">30950273</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>L</given-names></name><name><surname>Zeiler</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Le Cun</surname><given-names>Y</given-names></name><name><surname>Fergus</surname><given-names>R</given-names></name></person-group><source>International conference on machine learning</source><publisher-name>PMLR</publisher-name><fpage>1058</fpage><lpage>1066</lpage></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>N</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name><name><surname>Krizhevsky</surname><given-names>A</given-names></name><name><surname>Sutskever</surname><given-names>I</given-names></name><name><surname>Salakhutdinov</surname><given-names>R</given-names></name></person-group><article-title>Dropout: A Simple Way to Prevent Neural Networks from Overfitting</article-title><source>J Mach Learn Res</source><year>2014</year><volume>15</volume><fpage>1929</fpage><lpage>1958</lpage></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mysková</surname><given-names>J</given-names></name><etal/></person-group><article-title>Directionality of light absorption and emission in representative fluorescent proteins</article-title><source>Proc Natl Acad Sci USA</source><year>2020</year><volume>117</volume><fpage>32395</fpage><lpage>32401</lpage><pub-id pub-id-type="pmcid">PMC7768707</pub-id><pub-id pub-id-type="pmid">33273123</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2017379117</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michalet</surname><given-names>X</given-names></name><name><surname>Pinaud</surname><given-names>F</given-names></name><name><surname>Weiss</surname><given-names>S</given-names></name></person-group><article-title>Single Quantum Dot Trajectory Analysis: Beyond the Single Diffusion Mode Model</article-title><source>Biophys J</source><year>2010</year><volume>98</volume><fpage>2O3a</fpage><lpage>2O4a</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2009.12.1086</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>G</given-names></name><etal/></person-group><article-title>Quantitative mass imaging of single biological macromolecules</article-title><source>Science</source><year>2018</year><volume>360</volume><fpage>423</fpage><lpage>427</lpage><pub-id pub-id-type="pmcid">PMC6103225</pub-id><pub-id pub-id-type="pmid">29700264</pub-id><pub-id pub-id-type="doi">10.1126/science.aar5839</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Gupta</surname><given-names>AK</given-names></name></person-group><article-title>Testing and locating variance changepoints with application to stock prices</article-title><source>J Am Stat Assoc</source><year>1997</year><volume>92</volume><fpage>739</fpage><lpage>747</lpage><pub-id pub-id-type="doi">10.2307/2965722</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marguet</surname><given-names>D</given-names></name><name><surname>Lenne</surname><given-names>PF</given-names></name><name><surname>Rigneault</surname><given-names>H</given-names></name><name><surname>He</surname><given-names>HT</given-names></name></person-group><article-title>Dynamics in the plasma membrane: how to combine fluidity and order</article-title><source>EMBO J</source><year>2006</year><volume>25</volume><fpage>3446</fpage><lpage>3457</lpage><pub-id pub-id-type="pmcid">PMC1538569</pub-id><pub-id pub-id-type="pmid">16900097</pub-id><pub-id pub-id-type="doi">10.1038/sj.emboj.7601204</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruthardt</surname><given-names>N</given-names></name><name><surname>Lamb</surname><given-names>DC</given-names></name><name><surname>Bräuchle</surname><given-names>C</given-names></name></person-group><article-title>Single-particle Tracking as a Quantitative Microscopy-based Approach to Unravel Cell Entry Mechanisms of Viruses and Pharmaceutical Nanoparticles</article-title><source>Molecular Therapy</source><year>2011</year><volume>19</volume><fpage>1199</fpage><lpage>1211</lpage><pub-id pub-id-type="pmcid">PMC3129551</pub-id><pub-id pub-id-type="pmid">21654634</pub-id><pub-id pub-id-type="doi">10.1038/mt.2011.102</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zalejski</surname><given-names>J</given-names></name><name><surname>Sun</surname><given-names>JC</given-names></name><name><surname>Sharma</surname><given-names>A</given-names></name></person-group><article-title>Unravelling the Mystery inside Cells by Using Single-Molecule Fluorescence Imaging</article-title><source>J Imaging</source><year>2023</year><volume>9</volume><pub-id pub-id-type="pmcid">PMC10532472</pub-id><pub-id pub-id-type="pmid">37754956</pub-id><pub-id pub-id-type="doi">10.3390/jimaging9090192</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>(A)</bold> Scheme showing data processing pipeline of the FluoroTensor package. Synthesized traces are used to train the CRNN model based on the properties of fluorophores in use. The full pipeline is then tested with synthesized single molecule movies. A projection of each channel is enhanced, fluorescent foci detected, colocalization between channels is mapped, and time intensity traces are calculated based on methods covered later in this section. Traces are then passed to the CRNN which predicts the number of photobleaching steps, and a moving average fitting tool takes this as an input and attempts to find the most likely time points where photobleaching occurs. The results are then compiled into an excel spreadsheet. <bold>(B)</bold> Table of layers in CRNN along with the shapes of their respective inputs, outputs, and number of trainable parameters. <bold>(C)</bold> Schematic diagram of the layers of CRNN.</p></caption><graphic xlink:href="EMS191500-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>(A)</bold> A composite image obtained by taking the mean of the first 20% of all frames in the mCherry Channel and combining it with the maximum projection of those same frames. <bold>(B)</bold> The composite image enhanced using a high pass filter and showing the spots that were detected. <bold>(C)</bold> The composite image enhanced using the method detailed in section 2.1 (<xref ref-type="fig" rid="F1">figure 1</xref>) and the spots detected. Note how spot 9 kept in the image enhanced by the high-pass filter is rejected here owing to the higher contrast of our enhancement resolving a second weaker spot overlapping it. <bold>(D)</bold> A zoom of the start of the trace of spot 10 proving that the spot detected was a real single mCherry molecule and was not an artefact of the enhancement. <bold>(E)</bold> A single frame from a movie of Cy5-labelled RNA molecules. <bold>(F)</bold> A single frame of mCherry-labelled U1A proteins from the same experiment as (E), note the much lower signal to noise ratio and thus the need for a powerful enhancement technique. Comparing (A) to (F) we can see that a single time bin (100ms) of Cy5 dyes has a much greater signal to noise ratio than a summed stack of 60 100ms time bins of mCherry fluorescent proteins. (Note that while (A) and (E) have different colour maps they are both still perceptually uniform.)</p></caption><graphic xlink:href="EMS191500-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p>A comparison of the FluoroTensor models with CLDNN and MLE for stochastic bleaching traces and traces with a minimum of 5 frames per plateau as described in Xu et al 2019 for CLDNN. Comparisons were made between prediction accuracy of each model for datasets with a range of signal to noise ratios (more detail in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 14</xref>).</p></caption><graphic xlink:href="EMS191500-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>(A)</bold> Three different binomial distributions. Consider the number of trials, N, as being the number of bound proteins in a complex and the probability of success, p, the ratio of exogenous FP tagged protein to endogenous untagged protein. The binomial distribution represents the distribution of photobleaching steps of fluorescent foci of complexes with these stoichiometries and labelling proportions. <bold>(B)</bold> Simulated data with these distributions was analysed automatically by FluoroTensor including locating the foci in the SM movies, calculating traces and using the neural network models to predict the number of photobleaching steps. <bold>(C)</bold> The same analysis on the same traces as (B) but using the CLDNN model to predict steps. <bold>(D)</bold> The distributions of steps found by a maximum likelihood estimator in our previous SM analysis software, Auswerter, developed in MATLAB (<xref ref-type="bibr" rid="R9">Jobbins et al., 2022</xref>).</p></caption><graphic xlink:href="EMS191500-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>The data analysis pipeline for single molecule tracking in FluoroTensor. First, images are enhanced via high-pass filtering. Then, the movie is normalized to the brightest pixel throughout to a range of 0-255. Molecules are detected frame by frame using the same algorithm as for colocalization analysis (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>). Spots are connected to their nearest neighbours in consecutive frames with constraints to ensure tracks are topologically linear as opposed to branching. MSDs are calculated track by track (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 22</xref>) and diffusion coefficients are generated and their distributions plotted and fitted with a Gaussian mixture model. Quality control is performed by rejecting tracks with high variance in the MSD fit which improves resolution of distributions of systems of diffusing molecules with multiple diffusion rates.</p></caption><graphic xlink:href="EMS191500-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p>A distribution of diffusion coefficients for a system with molecules diffusing at 4 distinct diffusivities. The standard deviation of the MSD plot gradients during fitting is expressed as a percentage of the diffusion coefficient of each track. The track is rejected from the distribution of diffusion coefficients if the percentage standard deviation is greater than the respective thresholds shown (200%, 20%, 5%, and 4% respectively. Setting the threshold lower rejects a greater number of tracks. Rejecting tracks with higher variance in the MSD fit deconvolves the distribution and allows for accurate fitting of the components via Gaussian mixture model. The ground truth diffusivities simulated were 0.010, 0.035, 0.070 and 0.120 μm<sup>2</sup> / s.</p></caption><graphic xlink:href="EMS191500-f006"/></fig></floats-group></article>