<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS193133</article-id><article-id pub-id-type="doi">10.1101/2023.12.26.572833</article-id><article-id pub-id-type="archive">PPR779091</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Optimal distance metrics for single-cell RNA-seq populations</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ji</surname><given-names>Yuge</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Green</surname><given-names>Tessa D.</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Peidli</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Bahrami</surname><given-names>Mojtaba</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Meiqi</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Zappia</surname><given-names>Luke</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Hrovatin</surname><given-names>Karin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Sander</surname><given-names>Chris</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Theis</surname><given-names>Fabian J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A5">5</xref></contrib><aff id="A1"><label>1</label>Institute of Computational Biology, Computational Health Center, Helmholtz Munich, Munich, Germany</aff><aff id="A2"><label>2</label>School of Life Sciences, Technical University of Munich, Weihenstephan, Germany</aff><aff id="A3"><label>3</label>Department of Systems Biology, Harvard Medical School, Boston, MA, USA</aff><aff id="A4"><label>4</label>Genome Biology Unit, European Molecular Biology Laboratory, Heidelberg, Germany</aff><aff id="A5"><label>5</label>Department of Mathematics, School of Computing, Information and Technology, Technical University of Munich, Munich, Germany</aff><aff id="A6"><label>6</label>Broad Institute, Cambridge, MA, USA</aff></contrib-group><pub-date pub-type="nihms-submitted"><day>31</day><month>12</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>27</day><month>12</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">In single-cell data workflows and modeling, distance metrics are commonly used in loss functions, model evaluation, and subpopulation analysis. However, these metrics behave differently depending on the source of variation, conditions and subpopulations in single-cell expression profiles due to data sparsity and high dimensionality. Thus, the metrics used for downstream tasks in this domain should be carefully selected. We establish a set of benchmarks with three evaluation measures, capturing desirable facets of absolute and relative distance behavior. Based on seven datasets using perturbation as ground truth, we evaluated 16 distance metrics applied to scRNA-seq data and demonstrated their application to three use cases. We find that linear metrics such as mean squared error (MSE) performed best across our three evaluation criteria. Therefore, we recommend the use of MSE for comparing single-cell RNA-seq populations and evaluating gene expression prediction models.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">In systems biology, profiling the transcriptomes of individual cells by single-cell RNA sequencing (scRNA-seq) has become a common tool for gaining insight into the function of complex biological systems. When analyzing or modeling scRNA-seq data, we rely on distance metrics to capture relevant differences in the data. For instance, we might use the t-statistic to identify differentially expressed genes and mean squared error in the reconstruction loss of a generative model. These distance metrics make assumptions about the data which may not always hold. If the assumptions of the metric do not match the specific data distribution, the resulting analysis or model is likely to suffer. Therefore, it is essential to pick a metric that is suitable for the data characteristics.</p><p id="P3">One application area is generative modeling of transcriptome data, where computational models are trained to reconstruct a cellular response on the transcriptome level. These models are usually evaluated based on how close their predicted gene expression profile is to an experimentally determined ground truth response. Ultimately, generative models are used to predict the changes of cells transcriptomes in response to time, a drug treatment or genetic alteration. There is currently no consensus in the literature on which distance metric to use for evaluating these models.</p><p id="P4">Many generative models<sup><xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref></sup>, as well as linear<sup><xref ref-type="bibr" rid="R4">4</xref></sup>, graph-based<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref></sup>, dynamic<sup><xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup> and optimal transport-based models<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup> output predicted expression data that aims to accurately reflect the state of cells after a specific intervention<sup><xref ref-type="bibr" rid="R11">11</xref></sup>. Different publications have used the coefficient of determination (R<sup>2</sup>)<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R12">12</xref></sup>, maximum mean discrepancy (MMD)<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, Spearman correlation<sup><xref ref-type="bibr" rid="R13">13</xref></sup>, Wasserstein<sup><xref ref-type="bibr" rid="R14">14</xref></sup> and mean absolute error (MAE)<sup><xref ref-type="bibr" rid="R15">15</xref></sup> for evaluation, each with its own set of assumptions and limitations. Despite the relevance of developing generative models, for example in reducing the search space of drug or genetic screens, there is a lack of comparative assessment of these distance metrics for scRNA-seq generative model evaluation. As such, a thorough investigation of distance metrics with a focus on biological interventions is timely for improving model development.</p><p id="P5">Here, we provide a reusable framework for evaluating distance metrics for single-cell gene expression data. To mimic how distance metrics would be used in model evaluation or dataset analysis, we quantify their sensitivity and robustness when identifying differences between populations (<xref ref-type="fig" rid="F1">Figure 1a,b</xref>). We also quantify each metric’s ability to capture variation that is expected based on prior knowledge (<xref ref-type="fig" rid="F1">Figure 1c</xref>). This work uses ground truths such as developmental time and small molecule perturbation, contrasting with previous work using cell type labels<sup><xref ref-type="bibr" rid="R49">49</xref></sup>. To ensure that our results are broadly applicable, we devise three evaluation metrics—control rank percentile (CRP), robustness, and biological reproducibility (BioRep)—and apply our analyses to 16 distances across seven scRNA-seq datasets (<xref ref-type="fig" rid="F1">Figure 1d</xref>). To assist users in deciding on a distance metric, we identify common trends in distance metric behavior, segregating the metrics into three categories based on their performance under various technical effects on scRNA-seq data. We show use cases in model training, model evaluation, and cell type analysis to demonstrate that the choice of distance metric matters for downstream tasks.</p></sec><sec id="S2" sec-type="methods"><title>Methods</title><sec id="S3"><title>Distances</title><p id="P6">We selected distance metrics based on common usage in genomics analysis and machine learning, including those used previously for model evaluation, as loss functions in model training, or for data analysis. We tested classically used distances (Euclidean, cosine distance, mean absolute error (MAE), mean squared error (MSE), linear maximum mean discrepancy (linear MMD)<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, Wasserstein<sup><xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref></sup>), in addition to some statistics commonly used in biological analysis (t-statistic, Pearson correlation, Spearman correlation, Kendall tau distance, coefficient of determination (R<sup>2</sup>), energy distance (E-distance)<sup><xref ref-type="bibr" rid="R19">19</xref></sup>), and previously unexplored ones (Kolmogorov-Smirnov test, symmetric Kullback-Leibler divergence, linear classification probability). After scaling of the metric, linear MMD, MSE, and Euclidean are mathematically identical, but we included all three implementations for completeness. Note that E-distance was computed directly on genes, which is different from prior use where it was computed on PCA embeddings.</p><p id="P7">Metrics that are not formally distances, such as Pearson correlation, were converted to return positive values (<xref ref-type="table" rid="T1">Table 1</xref>). Non-distributional distances were computed between the centroids of the two conditions, in accordance with conventional pipelines for single-cell omic data<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref></sup>. Defining equations can be found in the Supplementary Methods.</p></sec><sec id="S4"><title>Datasets</title><p id="P8">We used one simulated and six public scRNA-seq datasets for evaluation (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>).</p><p id="P9">Simulated data was generated using Splatter<sup><xref ref-type="bibr" rid="R22">22</xref></sup> (Supplementary Methods). The control condition was modeled as a heterogeneous population. 32 perturbed conditions were generated using all pairwise combinations of eight values representing different probabilities that a gene is differentially expressed (‘DEProb’) and four values representing varying magnitudes of corresponding differential expression (’FacLoc’).</p><p id="P10">Six public datasets were selected representing common multi-condition experimental setups (<xref ref-type="fig" rid="F2">Figure 2a</xref>), such as time-course<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R23">23</xref></sup>, CRISPR perturbation<sup><xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref></sup>, or small molecule treatment<sup><xref ref-type="bibr" rid="R26">26</xref>,<xref ref-type="bibr" rid="R27">27</xref></sup>. Five out of the six contain covariates were expected to correlate with effect strength per condition, such as increasing time, multiple dosages, or more than 1 guide RNA (gRNA). To ensure perturbation effect was not confounded with other biological factors such as cell type, each dataset was filtered to a single cell-type with the most cells across conditions. The exceptions were Sci-plex3, in which all three contained cell types were sufficiently abundant and therefore used separately, and Santinha et al. where all cell types were included. Datasets varied greatly in how strongly the labeled control condition and intervention transcriptomes differed (<xref ref-type="fig" rid="F2">Figure 2a</xref>). For instance, datasets from large-scale screens based on CRISPR or small molecules contained many conditions which likely did not cause a significant change from control.</p><p id="P11">All benchmarks were computed using unscaled, log-normalized counts, with conditions subsampled to the same number of cells and 2000 highly variable genes calculated jointly across all perturbation conditions, including control, using scanpy<sup><xref ref-type="bibr" rid="R28">28</xref></sup> with default parameters (Supplementary Methods). We also evaluated distances on raw count data using the same filtering and highly variable genes, but without log-normalization. Performance is reported only for log-normalized data, as performance on raw count data was comparable (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2d</xref>).</p></sec><sec id="S5"><title>Distance evaluation</title><p id="P12">We defined desirable properties of a good distance metric as follows. First, given prior knowledge, it should assign high distance values between cell populations with expected biological differences. Second, it should do so robustly, i.e. with minimal sensitivity to noise inherent to scRNA-seq. Thus, we reasoned that distances should perform well in differentiating untreated or baseline conditions (“control”) from conditions where an intervention has been applied (“perturbed”).</p><p id="P13">To this end, we defined an evaluation measure <bold>“control relative percentile” (CRP)</bold> (<xref ref-type="fig" rid="F1">Figure 1a</xref>). For each dataset, we randomly sampled five disjoint sets of cells of equal size (n=300) from the control population. We selected five sets to compute the variance for each distance while still retaining enough cells per sample. For each set of control cells, distances were computed to all other cell populations, including the perturbed populations and the other four control sets. <bold>The CRP is defined as the percentage of perturbed conditions with a larger distance to the reference control set than the control sets to each other, averaged across five control sets</bold>. For an ideal metric, this would equal one. We provide pseudocode for the CRP measure in the Supplementary Methods.</p><p id="P14">The primary assumption was that control cells should always be closer to each other than to perturbed cells unless the distance metric cannot distinguish between control and perturbed. It could also be true that the drug or CRISPR intervention had no effect. However, this would not lead to biases when comparing different metrics, as all distance calculations would suffer equally. A <italic>better</italic> distance metric would still have a smaller value, as fewer conditions would be close to control.</p><p id="P15">We defined <bold>robustness</bold> as the inverse of the variance of CRP, such that metrics with higher scores were more robust (<xref ref-type="fig" rid="F1">Figure 1b</xref>). We reasoned that it is desirable for a metric to be as insensitive as possible to variation within a population and return similar relative distances when comparing different views of identical populations. Thus, a better distance metric should have minimal differences in CRP across the five control conditions and a high robustness score.</p><p id="P16">We define <bold>biological reproducibility (BioRep)</bold> to examine whether metrics correlated with biologically meaningful continuous effect such as drug dosage, developmental time, or the number of gRNAs targeting different genes. This contrasts with CRP and robustness, which only measure the binary question of whether a distance finds that perturbations had an effect. For each dataset, we calculated the Spearman correlation between each metric’s value for each perturbed condition and the corresponding biological covariate (<xref ref-type="fig" rid="F1">Figure 1c</xref>). This test approximates how much a distance aligns with our expectation of effect sizes based on prior knowledge.</p><p id="P17">When comparing between metrics, values were rounded to three decimal places so that extremely similar performance would result in a tie. The final order of which metric performed best was decided by how many times a metric performed at or above average (<xref ref-type="fig" rid="F1">Figure 1d</xref>).</p></sec></sec><sec id="S6" sec-type="results"><title>Results</title><sec id="S7"><title>Our framework successfully characterizes similarities and differences between distance metrics</title><p id="P18">Most metrics performed reasonably well across all datasets. The average CRP, robustness, and BioRep across all metrics and all datasets was 0.62, 0.77, and 0.66 respectively. This indicates that on average metrics could robustly distinguish 62% of interventions from control, a reasonable number given that many interventions are not expected to have an effect in large screens. We can also see that metrics were positively correlated with effect sizes, indicating that they indeed captured meaningful biological variation. This supports that CRP, robustness, and BioRep are evaluation measures which are neither too simplifying nor too difficult to compute and comprehend, making them reasonable measures of distance metric performance.</p><p id="P19">In addition, all three evaluation measures showed variation across metrics, indicating that they are able to distinguish between the performances of individual metrics. Distance metrics generally performed consistently across datasets, supporting the robustness of this measure across different biological systems, batch effects, and control population definitions. The consistent behavior across datasets adds confidence that our recommendations will apply to other scRNA-seq datasets.</p><p id="P20">To summarize and simplify the comparison of distances, we grouped them by performance and behavior (<xref ref-type="table" rid="T1">Table 1</xref>, last column). We excluded classification class projection due to extremely subpar performance (<xref ref-type="fig" rid="F2">Figure 2b</xref>) and clustered the remaining 15 distances into three different categories—type I, II, and III—based on projection of performance into a PCA space (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2a</xref>). Type I distances were separated into type Ia and Ib due to slightly different behavior between the two groups; type Ib performed better on BioRep (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1c</xref>). All distances in type I behaved similarly with respect to observed metric biases (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2c</xref>).</p></sec><sec id="S8"><title>MSE and similar distance metrics best capture interventional effects in scRNA-seq data</title><p id="P21">One desirable metric characteristic is consistently strong performance across a variety of datasets. To make a general recommendation, we aggregated results across all three evaluation measures and datasets by averaging scaled evaluation scores (<xref ref-type="fig" rid="F2">Figure 2b</xref>). MSE and the mathematically identical linear MMD performed above the median of all metrics in all datasets. Euclidean distance and MAE performed comparably, which is expected given their mathematical similarity to MSE and linear MMD. E-distance significantly underperformed in BioRep in Schiebinger et al. but somewhat outperformed in four other datasets. Altogether, these distances performed extremely similarly, justifying their grouping in type I (<xref ref-type="table" rid="T1">Table 1</xref>). We emphasize that type I metrics are closely related, and we would consider their performance to be equivalent. The marginal differences seen may become important when comparing models (<xref ref-type="fig" rid="F3">Figure 3c</xref>) or cell populations with relatively small differences such as CRISPR perturbations.</p><p id="P22">The Type III distances (Wasserstein, symmetric KL divergence, Kendall tau distance, and Spearman correlation) performed worse than other metrics, particularly linear ones (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 1f</xref>). They scored an average of 0.31 and 0.51 for CRP and BioRep, respectively (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1a,c</xref>) and performed worse than other distances in all datasets except Schiebinger et al. and one cell line in Sci-plex3. We believe that this instance of good performance, specifically on BioRep, is due to the Schiebinger dataset being particularly well-suited for these metrics. We hypothesize that the specific time course in Schiebinger et al. produces a smooth shift in the parameters of the underlying distribution, but not in means (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1e</xref>).</p><p id="P23">The primary distinguishing feature of type III metrics is that they capture aspects of the distribution beyond the mean and standard deviation. We hypothesize that accounting for additional moments of the distributions is detrimental to picking up intervention-related biological signal. This can be observed in low robustness scores. For instance, by using ranks, noise-induced changes in lowly expressed genes have a disproportionate effect on Spearman correlation (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2b</xref>). Noise in many lowly expressed genes may mask the true biological effects in a smaller number of significant genes in type III distances. As such, we discourage the use of type III distance metrics for evaluating the closeness of predicted cell populations to real cell populations in most standard cases.</p><p id="P24">We also note that there are differences in the rankings when examining CRP and BioRep performance separately. Among all the distances we evaluated, linear classification probability achieved the highest CRP, as expected for a classifier specifically optimizing for this task (Supplementary Methods). Among the distances without training, Pearson correlation and cosine distance performed best for this measure, scoring an average of 0.81 and 0.80 for CRP, respectively (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1a</xref>). We can expect these to be similar as Pearson correlation and cosine distance are the same for zero-centered vectors<sup><xref ref-type="bibr" rid="R29">29</xref></sup>. With the exception of R<sup>2</sup>, type II distances outperformed type III distances in CRP, and vice versa for BioRep. We hypothesize that this is because vector distances better capture absolute change, but the effects in BioRep are more a function of changes in magnitude not fully captured by vector distances.</p><p id="P25">No single metric was the top performer in more than two datasets in the BioRep evaluation. BioRep scores sometimes also differed dramatically between distances of the same type for the same dataset (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1c</xref>). This finding suggests that the distribution of gene expression changes over the course of interventions can happen in multiple ways, and may be dependent on the covariate being examined (e.g. increasing dosage or increasing time). It may also depend on the biological setting: distances from three different types were the top scorers for BioRep in each of the Sci-plex3 cell lines (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1c</xref>). T-test metric performed best for MCF7, R<sup>2</sup> performed best for A549, and Wasserstein performed best for K562. Thus, variation in how distributions change after intervention is potentially not just relegated to dataset-specific effects. When using distance metrics with a continuous covariate as we do to calculate BioRep, it is worthwhile to consider using a combination of several distance metrics to capture different effects.</p></sec><sec id="S9"><title>Representative distance metrics for data investigation</title><p id="P26">We selected MSE as the representative distance for type I and cosine distance as the representative distance for type II. MSE and cosine distance have desirable qualities in that they are already commonly employed as a loss function in regression models, are computationally fast, and are readily available in several different packages across programming languages<sup><xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R32">32</xref></sup>. They are also simple to calculate manually and interpret. Users can use these representative distances on their own data to determine if there is a category of distances that is best suited to their biological question or dataset qualities. Users can also feel confident that the other distances in the category will behave similarly to the representative distance (<xref ref-type="fig" rid="F2">Figure 2b</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1a,b,c</xref>).</p><p id="P27">We do not identify a representative distance metric for type III distances because they displayed highly inconsistent BioRep scores across datasets (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1c</xref>), suggesting that they capture different qualities about what distributional shifts occur when going from control to perturbed. In the most common data analysis scenario, where dataset characteristics are not known a priori, we recommend starting with type I metrics in perturbation modeling and analysis.</p></sec><sec id="S10"><title>Use case 1: what a model learns changes depending on metric used</title><p id="P28">Since the absolute scores of the above evaluation measures were fairly similar across metrics (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1a,b,c</xref>), the question arises if changing the loss function of a model from one metric to another would make a substantive difference or improvement in what is being learned. To test this, we modified the loss of a generative probabilistic model, scVI<sup><xref ref-type="bibr" rid="R3">3</xref></sup>, and trained it on our CRISPRa dataset<sup><xref ref-type="bibr" rid="R24">24</xref></sup>, where no metric performed conclusively better in BioRep. We replaced the negative binomial loss, evaluated between the posterior distribution and real cells, with non-distributional MSE loss between predicted cells and real cells (Supplementary Methods). We trained with otherwise default parameters and plotted the learned latent representation of the dataset, as in a typical workflow with scVI and other generative models<sup><xref ref-type="bibr" rid="R20">20</xref></sup> (<xref ref-type="fig" rid="F3">Figure 3a,b</xref>). We compared this latent representation with one from a standard scVI model, using Local Inverse Simpson's Index (LISI)<sup><xref ref-type="bibr" rid="R33">33</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup> to identify CRISPRa treatments that clustered together (Supplementary Methods). Although we found that CRISPRa treatments overall clustered less in our MSE-scVI (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>), our model also identified a new cell cluster of cells with CRISPRa activation of TMSB4X (<xref ref-type="fig" rid="F3">Figure 3a</xref>).</p><p id="P29">To see if the models learned not only new but different relationships between CRISPRa conditions, we also examined the six CRISPRa treatments with low LISI scores in both models. We found that KLF1+SET was more similar to the remaining CRISPRa treatments containing SET in MSE-scVI than in standard scVI (<xref ref-type="fig" rid="F3">Figure 3b</xref>). <xref ref-type="fig" rid="F2">Figure 2b</xref> of Norman et al. supports this; there, KLF1+SET is clustered with other combinations including SET. Taken together, this indicates that changing the loss function of a model changes the latent space significantly, and different loss functions may provide perspective on different perturbations.</p></sec><sec id="S11"><title>Use case 2: model evaluation changes depending on metric used</title><p id="P30">Now that we have demonstrated that distance metrics differ in their ability to capture important variation in scRNA-seq data, we illustrate an example in which this difference affects which perturbation effect a model captures. We trained two versions of scGen<sup><xref ref-type="bibr" rid="R1">1</xref></sup> with different hyperparameters, which we call “scGen default” and “scGen shallow”, using the default or a lower number of neural network layers. We compared the scGen models against linear regression as a simple baseline (Supplementary Methods). We applied the models to PBMC data used in the scGEN tutorial<sup><xref ref-type="bibr" rid="R35">35</xref></sup> to predict gene expression profiles of CD4+ T cells after interferon stimulation, given other cell types pre- and post-stimulation, and evaluated on the top 50 differentially expressed genes(Supplementary Methods).</p><p id="P31">We observed that which model performed best depended on which distance metric is used to evaluate the three models (<xref ref-type="fig" rid="F3">Figure 3c</xref>). For example, R<sup>2</sup>, the metric used in the original scGen publication, reported that scGen with a shallow architecture vastly outperforms default scGen hyperparameters and also linear regression. However, evaluation with Pearson correlation provided exactly the opposite result. This makes it very difficult to decide which model better predicted gene expression during model development.</p><p id="P32">Based on its high CRP, robustness, and BioRep scores, we suggest using MSE and other type I distance metrics to evaluate gene expression predictions as a starting point to guide model development. In this case, MSE evaluation suggests that the shallow scGen model outperforms the default scGen and (marginally) the linear regression. We would also caution use of type III metrics in evaluating gene expression prediction, especially on high dimensional gene expression vectors. It is important to note that further downstream evaluation of a predictive model is still necessary to demonstrate a model’s goodness of fit. Nevertheless, we recommend that models which predict gene expression report MSE in their results.</p></sec><sec id="S12"><title>Use case 3: cell type response prioritization with distances</title><p id="P33">Another common task that relies on metrics is prioritization of cell types that respond most to perturbation. This task was formulated by Skinnider et al.<sup><xref ref-type="bibr" rid="R36">36</xref></sup> who also introduced the Augur model to solve this task. We used the accompanying dataset from that study for this analysis. To demonstrate the utility of distances in data analysis, we used MSE to estimate cell type response magnitude as a proxy for response prioritization (<xref ref-type="fig" rid="F3">Figure 3d</xref>) and compared the results to Augur. For a given dataset, Augur computes which cell type responds most to a given intervention and is methodologically similar to the classifier probability distance. Cell types that respond more are assigned a higher Augur score. We showed a positive correlation between Augur scores and MSE (<xref ref-type="fig" rid="F3">Figure 3e</xref>) when MSE was used to measure the magnitude of cell type response, simply by taking the distance between the two conditions per cell type. We also showed that differential cell type prioritization using MSE recapitulates the differentially responding microglia and oligodendrocyte cell types exactly as in the example with Augur in Squair et al.<sup><xref ref-type="bibr" rid="R37">37</xref></sup>(<xref ref-type="fig" rid="F3">Figure 3d</xref>). MSE provides a faster and more readily interpretable method of ranking cell types with comparable performance.</p></sec></sec><sec id="S13" sec-type="discussion"><title>Discussion</title><p id="P34">This work provides a quantitative comparison of distance metrics for single cell transcriptomics. Our observations and recommendations are broadly applicable whenever metric behavior is important, including for population comparison, functional analyses such as differential expression testing, and perturbation response prediction<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R36">36</xref></sup>. We find that conventional regression metrics such as MSE perform well on log-normalized scRNA-seq data, and, surprisingly, Spearman correlation does not, despite being a popular choice in the analysis of biological data<sup><xref ref-type="bibr" rid="R38">38</xref></sup>. The variety and number of datasets we tested allows us to summarize distance behavior into three types for end users. Finally, we show examples where the choice of distance metric can have a downstream impact. We conclude that MSE should be reported in model evaluation to ensure fair model comparability across studies and is a good starting point for investigating biological effect size and multi-condition analysis.</p><p id="P35">Despite consensus when it comes to fitting noise distributions, many non-NB and ZINB-parameterized scRNA-seq models, both those that predict gene expression and those that only model it, still perform well. General consensus suggests the Poisson, NB, and zero-inflated NB (ZINB) models as best capturing gene expression distributions<sup><xref ref-type="bibr" rid="R39">39</xref>–<xref ref-type="bibr" rid="R41">41</xref></sup>, with most scRNA simulators built on this insight<sup><xref ref-type="bibr" rid="R42">42</xref></sup>. While probabilistic models are popular<sup><xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R43">43</xref>–<xref ref-type="bibr" rid="R45">45</xref></sup>, optimal transport models are increasingly common<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R46">46</xref></sup>. Models such as scGen, which employs an MSE loss, perform competitively in batch correction and gene expression benchmarks<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup>. The breadth of models and parameterizations in current literature suggests that, at present, there is no clear best architecture for gene expression prediction. Going forward, careful and robust model evaluation is key to advancement in the field<sup><xref ref-type="bibr" rid="R47">47</xref></sup>. In this work, we have built a stepping stone by recommending benchmarking and model evaluation measures, with modular distance calculations built on programmatically accessible datasets. We aim to move towards more standardized evaluation, which will only become increasingly necessary as better models develop and improvements become more incremental.</p><p id="P36">Our framework differs from prior work by evaluating distances between known intervention labels instead of cell type or batch labels<sup><xref ref-type="bibr" rid="R48">48</xref>,<xref ref-type="bibr" rid="R49">49</xref></sup>. While cell types are a common source of biological variation, they are typically manually annotated in single-cell data<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R50">50</xref></sup>. This manual annotation relies on dataset preprocessing and clustering algorithms which involve distance calculations<sup><xref ref-type="bibr" rid="R20">20</xref></sup> and could bias results towards certain metrics. We initially chose intervention labels because it is commonly analyzed and a harder evaluation measure than cell type. The varying performance of distance metrics across datasets according to the BioRep metric (<xref ref-type="fig" rid="F2">Figure 2b</xref>) suggests that the choice of metric might change depending on the biological covariate (e.g. cell type, timepoint, perturbation). This likely explains why our recommendation contradicts Huizing et al.<sup><xref ref-type="bibr" rid="R49">49</xref></sup> recommendation of Wasserstein distance for batch and cell type distinguishability. Put another way, this challenges the assumption that all phenotype prediction can be assessed by the same measure, and by association, that all phenotypes can be modeled by the same distribution. This is supported by recent work demonstrating that the best parameters for negative binomial distributions are dataset-specific<sup><xref ref-type="bibr" rid="R48">48</xref></sup>, and that noise parameters change with time<sup><xref ref-type="bibr" rid="R51">51</xref></sup>.</p><p id="P37">While we aimed to provide a general distance metric recommendation, there are several limitations to our evaluation. There exist many other, less commonly used distances might have more optimal properties, including Mahalanobis distance, point cloud-based distances such as Chamfer and Hausdorff, and graph-based distances. Moreover, several metrics considered here benefit from being calculated in a different space than log-normalized data (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1d</xref>), and some distance measures are more commonly calculated on data that has been transformed into PCA space<sup><xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R33">33</xref></sup>. What effect additional processing<sup><xref ref-type="bibr" rid="R52">52</xref></sup> has on observed differences, including the effect of gene selection methods, is a subject for future work.</p><p id="P38">Additionally, the availability of interventional datasets posed some limitations. The populations we considered are relatively homogeneous, with the exception of Santinha et al. where both control and perturbed existed in differentiated cell types in sufficiently high numbers. Other performance behavior might be uncovered with the additional analyses of datasets containing heterogeneous tissue models and perturbation. In conclusion, we provide a general framework for assessing distance metrics in various datasets. Our reusable framework is publicly available at (<ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/perturbation-metrics">https://github.com/theislab/perturbation-metrics</ext-link>) and users can efficiently call distance metric implementations from the pertpy package (<ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/pertpy">https://github.com/theislab/pertpy</ext-link>) with an accompanying tutorial (<ext-link ext-link-type="uri" xlink:href="https://pertpy.readthedocs.io/en/latest/tutorials/notebooks/distances.html">https://pertpy.readthedocs.io/en/latest/tutorials/notebooks/distances.html</ext-link>). Any new metric can be easily assessed using this framework, facilitating the development of metrics for comparing transcriptomics distributions. Together with our metric recommendations, this framework adds clarity to robust analysis and model development for single-cell transcriptomics.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures and Methods</label><media xlink:href="EMS193133-supplement-Supplementary_Figures_and_Methods.pdf" mimetype="application" mime-subtype="pdf" id="d94aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S14"><title>Acknowledgements and Funding</title><p>We thank Niklas Schmacke, Linus Schumacher and Lukas Heumos for their valuable edits, comments, and recommendations on the manuscript. We thank Kemal Inecik for sharing his curation of Garcia 2022, and Lukas Heumos for helping integrate our software into the pertpy package. F.J.T. acknowledges support by the Helmholtz Association’s Initiative and Networking Fund through Helmholtz AI (ZT-I-PF-5-01) and by the European Union (ERC, DeepCell—101054957). L.Z. is funded by the Bavarian Ministry of Science and the Arts in the framework of the Bavarian Research Association ‘ForInter’ (Interaction of human brain cells). S.P. is supported by Open Targets (OTAR3083). C.S. acknowledges support by Wellcome-LEAP ΔTissue and the National Resource for Network Biology (NRNB) Research Resource (RR 031228-02). Views and opinions expressed are those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council. Neither the European Union nor the granting authority can be held responsible for them.</p></ack><sec id="S15" sec-type="data-availability"><title>Data and Code Availability</title><p id="P39">Distances were implemented in pertpy (<ext-link ext-link-type="uri" xlink:href="https://pertpy.readthedocs.io">https://pertpy.readthedocs.io</ext-link>). Reproducibility code and notebooks can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/theislab/perturbation-metrics">https://github.com/theislab/perturbation-metrics</ext-link>. All datasets used in this study are available from scPerturb<sup><xref ref-type="bibr" rid="R19">19</xref></sup>.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P40"><bold>Author contributions</bold></p><p id="P41">Project was conceptualized by Y.J., T.D.G., S.P. and K.H. Formal analysis and investigation by Y.J. and M.L. Validation and visualization was performed by Y.J. Data was curated by T.D.G. and S.P. Methodology was developed by Y.J., T.D.G., and S.P. Extensive software contributions to the framework and package were made by Y.J., M.B., S.P., L.Z., and T.D.G. Funding acquisition, resources, and supervision were provided by C.S. and F.T. The original draft of this manuscript was written by Y.J., T.D.G., and S.P. All authors contributed to revisions.</p></fn><fn id="FN2" fn-type="conflict"><p id="P42"><bold>Competing interests</bold></p><p id="P43">L.Z. has consulted for Lamin Labs GmbH. F.J.T. consults for Immunai Inc., Singularity Bio B.V., CytoReason Ltd, and Omniscope Ltd, and has ownership interest in Dermagnostix GmbH and Cellarity. C.S. is on the scientific advisory board of CytoReason Ltd.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>scGen predicts single-cell perturbation responses</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>715</fpage><lpage>721</lpage><pub-id pub-id-type="pmid">31363220</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyeau</surname><given-names>P</given-names></name><etal/></person-group><article-title>An empirical Bayes method for differential expression analysis of single cells with deep generative models</article-title><source>Proc Natl Acad Sci U S A</source><year>2023</year><volume>120</volume><comment>e2209124120</comment><pub-id pub-id-type="pmcid">PMC10214125</pub-id><pub-id pub-id-type="pmid">37192164</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2209124120</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Regier</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>MB</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="pmcid">PMC6289068</pub-id><pub-id pub-id-type="pmid">30504886</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L</given-names></name><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>Morgan</surname><given-names>MD</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title><source>Nat Biotechnol</source><year>2018</year><volume>36</volume><fpage>421</fpage><lpage>427</lpage><pub-id pub-id-type="pmcid">PMC6152897</pub-id><pub-id pub-id-type="pmid">29608177</pub-id><pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hie</surname><given-names>B</given-names></name><name><surname>Bryson</surname><given-names>B</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name></person-group><article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title><source>Nat Biotechnol</source><year>2019</year><volume>37</volume><fpage>685</fpage><lpage>691</lpage><pub-id pub-id-type="pmcid">PMC6551256</pub-id><pub-id pub-id-type="pmid">31061482</pub-id><pub-id pub-id-type="doi">10.1038/s41587-019-0113-3</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamimoto</surname><given-names>K</given-names></name><etal/></person-group><article-title>Dissecting cell identity via network inference and in silico gene perturbation</article-title><source>Nature</source><year>2023</year><volume>614</volume><fpage>742</fpage><lpage>751</lpage><pub-id pub-id-type="pmcid">PMC9946838</pub-id><pub-id pub-id-type="pmid">36755098</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-05688-9</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>B</given-names></name><etal/></person-group><article-title>CellBox: Interpretable Machine Learning for Perturbation Biology with Application to the Design of Cancer Combination Therapy</article-title><source>Cell Syst</source><year>2021</year><volume>12</volume><fpage>128</fpage><lpage>140</lpage><elocation-id>e4</elocation-id><pub-id pub-id-type="pmid">33373583</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aubin-Frankowski</surname><given-names>P-C</given-names></name><name><surname>Vert</surname><given-names>J-P</given-names></name></person-group><article-title>Gene regulation inference from single-cell RNA-seq data with linear differential equations and velocity inference</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>4774</fpage><lpage>4780</lpage><pub-id pub-id-type="pmid">33026066</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schiebinger</surname><given-names>G</given-names></name><etal/></person-group><article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title><source>Cell</source><year>2019</year><volume>176</volume><fpage>928</fpage><lpage>943</lpage><elocation-id>e22</elocation-id><pub-id pub-id-type="pmcid">PMC6615720</pub-id><pub-id pub-id-type="pmid">30849376</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.026</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunne</surname><given-names>C</given-names></name><etal/></person-group><article-title>Learning Single-Cell Perturbation Responses using Neural Optimal Transport</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021.12.15.472775</elocation-id><pub-id pub-id-type="pmcid">PMC10630137</pub-id><pub-id pub-id-type="pmid">37770709</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01969-x</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>Y</given-names></name><name><surname>Lotfollahi</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Machine learning for perturbational single-cell omics</article-title><source>Cell Systems</source><year>2021</year><volume>12</volume><fpage>522</fpage><lpage>537</lpage><pub-id pub-id-type="pmid">34139164</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lotfollahi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Predicting cellular responses to complex perturbations in high-throughput screens</article-title><source>Mol Syst Biol</source><year>2023</year><elocation-id>e11517</elocation-id><pub-id pub-id-type="pmcid">PMC10258562</pub-id><pub-id pub-id-type="pmid">37154091</pub-id><pub-id pub-id-type="doi">10.15252/msb.202211517</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunne</surname><given-names>C</given-names></name><etal/></person-group><article-title>Learning single-cell perturbation responses using neural optimal transport</article-title><source>Nat Methods</source><year>2023</year><pub-id pub-id-type="doi">10.1038/s41592-023-01969-x</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>KD</given-names></name><etal/></person-group><article-title>Multi-domain translation between single-cell imaging and sequencing data using autoencoders</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><elocation-id>31</elocation-id><pub-id pub-id-type="pmcid">PMC7782789</pub-id><pub-id pub-id-type="pmid">33397893</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-20249-2</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Hütter</surname><given-names>J-C</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><article-title>Large-scale Differentiable Causal Discovery of Factor Graphs</article-title><source>arXiv [statML]</source><year>2022</year></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gretton</surname><given-names>A</given-names></name><name><surname>Borgwardt</surname><given-names>KM</given-names></name><name><surname>Rasch</surname><given-names>M</given-names></name><name><surname>Schölkopf</surname><given-names>B</given-names></name><name><surname>Smola</surname><given-names>AJ</given-names></name></person-group><chapter-title>A kernel method for the two-sample-problem</chapter-title><source>Advances in Neural Information Processing Systems</source><publisher-name>The MIT Press</publisher-name><year>2007</year><volume>19</volume><fpage>513</fpage><lpage>520</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cuturi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Optimal Transport Tools (OTT): A JAX Toolbox for all things Wasserstein</article-title><source>arXiv [csLG]</source><year>2022</year></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Cuturi</surname><given-names>M</given-names></name></person-group><source>Sinkhorn Distances: Lightspeed Computation of Optimal Transport</source><comment><ext-link ext-link-type="uri" xlink:href="https://proceedings.neurips.cc/paper_files/paper/2013/file/af21d0c97db2e27e13572cbf59eb343d-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2013/file/af21d0c97db2e27e13572cbf59eb343d-Paper.pdf</ext-link></comment></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peidli</surname><given-names>S</given-names></name><etal/></person-group><article-title>scPerturb: Harmonized Single-Cell Perturbation Data</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2022.08.20.504663</elocation-id><pub-id pub-id-type="doi">10.1101/2022.08.20.504663</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumos</surname><given-names>L</given-names></name><etal/></person-group><article-title>Best practices for single-cell analysis across modalities</article-title><source>Nat Rev Genet</source><year>2023</year><volume>24</volume><fpage>550</fpage><lpage>572</lpage><pub-id pub-id-type="pmcid">PMC10066026</pub-id><pub-id pub-id-type="pmid">37002403</pub-id><pub-id pub-id-type="doi">10.1038/s41576-023-00586-w</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><etal/></person-group><article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title><source>Genome Biol</source><year>2019</year><volume>20</volume><elocation-id>241</elocation-id><pub-id pub-id-type="pmcid">PMC6859644</pub-id><pub-id pub-id-type="pmid">31739806</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1854-5</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><elocation-id>174</elocation-id><pub-id pub-id-type="pmcid">PMC5596896</pub-id><pub-id pub-id-type="pmid">28899397</pub-id><pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia-Alonso</surname><given-names>L</given-names></name><etal/></person-group><article-title>Single-cell roadmap of human gonadal development</article-title><source>Nature</source><year>2022</year><volume>607</volume><fpage>540</fpage><lpage>547</lpage><pub-id pub-id-type="pmcid">PMC9300467</pub-id><pub-id pub-id-type="pmid">35794482</pub-id><pub-id pub-id-type="doi">10.1038/s41586-022-04918-4</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norman</surname><given-names>TM</given-names></name><etal/></person-group><article-title>Exploring genetic interaction manifolds constructed from rich single-cell phenotypes</article-title><source>Science</source><year>2019</year><volume>365</volume><fpage>786</fpage><lpage>793</lpage><pub-id pub-id-type="pmcid">PMC6746554</pub-id><pub-id pub-id-type="pmid">31395745</pub-id><pub-id pub-id-type="doi">10.1126/science.aax4438</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Santinha</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Transcriptional linkage analysis with in vivo AAV-Perturb-seq</article-title><source>Nature</source><year>2023</year><volume>622</volume><fpage>367</fpage><lpage>375</lpage><pub-id pub-id-type="pmcid">PMC10567566</pub-id><pub-id pub-id-type="pmid">37730998</pub-id><pub-id pub-id-type="doi">10.1038/s41586-023-06570-y</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McFarland</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Multiplexed single-cell transcriptional response profiling to define cancer vulnerabilities and therapeutic mechanism of action</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>4296</elocation-id><pub-id pub-id-type="pmcid">PMC7453022</pub-id><pub-id pub-id-type="pmid">32855387</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-17440-w</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivatsan</surname><given-names>SR</given-names></name><etal/></person-group><article-title>Massively multiplex chemical transcriptomics at single-cell resolution</article-title><source>Science</source><year>2020</year><volume>367</volume><fpage>45</fpage><lpage>51</lpage><pub-id pub-id-type="pmcid">PMC7289078</pub-id><pub-id pub-id-type="pmid">31806696</pub-id><pub-id pub-id-type="doi">10.1126/science.aax6234</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><elocation-id>15</elocation-id><pub-id pub-id-type="pmcid">PMC5802054</pub-id><pub-id pub-id-type="pmid">29409532</pub-id><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodgers</surname><given-names>JL</given-names></name><name><surname>Nicewander</surname><given-names>WA</given-names></name></person-group><article-title>Thirteen Ways to Look at the Correlation Coefficient</article-title><source>Am Stat</source><year>1988</year><volume>42</volume><fpage>59</fpage><lpage>66</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><etal/></person-group><article-title>PyTorch: An Imperative Style, High-Performance Deep Learning Library</article-title><source>arXiv [csLG]</source><year>2019</year></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abadi</surname><given-names>M</given-names></name><etal/></person-group><article-title>TensorFlow: Large-Scale Machine Learning on Heterogeneous Distributed Systems</article-title><source>arXiv [csDC]</source><year>2016</year></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine Learning in Python</article-title><source>arXiv [csLG]</source><year>2012</year><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korsunsky</surname><given-names>I</given-names></name><etal/></person-group><article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title><source>Nat Methods</source><year>2019</year><volume>16</volume><fpage>1289</fpage><lpage>1296</lpage><pub-id pub-id-type="pmcid">PMC6884693</pub-id><pub-id pub-id-type="pmid">31740819</pub-id><pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luecken</surname><given-names>MD</given-names></name><etal/></person-group><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>41</fpage><lpage>50</lpage><pub-id pub-id-type="pmcid">PMC8748196</pub-id><pub-id pub-id-type="pmid">34949812</pub-id><pub-id pub-id-type="doi">10.1038/s41592-021-01336-8</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>HM</given-names></name><etal/></person-group><article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title><source>Nat Biotechnol</source><year>2018</year><volume>36</volume><fpage>89</fpage><lpage>94</lpage><pub-id pub-id-type="pmcid">PMC5784859</pub-id><pub-id pub-id-type="pmid">29227470</pub-id><pub-id pub-id-type="doi">10.1038/nbt.4042</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skinnider</surname><given-names>MA</given-names></name><etal/></person-group><article-title>Cell type prioritization in single-cell data</article-title><source>Nat Biotechnol</source><year>2020</year><pub-id pub-id-type="pmcid">PMC7610525</pub-id><pub-id pub-id-type="pmid">32690972</pub-id><pub-id pub-id-type="doi">10.1038/s41587-020-0605-1</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Squair</surname><given-names>JW</given-names></name><name><surname>Skinnider</surname><given-names>MA</given-names></name><name><surname>Gautier</surname><given-names>M</given-names></name><name><surname>Foster</surname><given-names>LJ</given-names></name><name><surname>Courtine</surname><given-names>G</given-names></name></person-group><article-title>Prioritization of cell types responsive to biological perturbations in single-cell data with Augur</article-title><source>Nat Protoc</source><year>2021</year><volume>16</volume><fpage>3836</fpage><lpage>3873</lpage><pub-id pub-id-type="pmid">34172974</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>JH</given-names></name></person-group><source>Handbook of Biological Statistics</source><edition>3rd ed</edition><publisher-loc>Baltimore, Maryland</publisher-loc><publisher-name>Sparky House Publishing</publisher-name><year>2014</year></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grün</surname><given-names>D</given-names></name><name><surname>Kester</surname><given-names>L</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Validation of noise models for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>637</fpage><lpage>640</lpage><pub-id pub-id-type="pmid">24747814</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Perraudeau</surname><given-names>F</given-names></name><name><surname>Gribkova</surname><given-names>S</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Vert</surname><given-names>J-P</given-names></name></person-group><article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><elocation-id>284</elocation-id><pub-id pub-id-type="pmcid">PMC5773593</pub-id><pub-id pub-id-type="pmid">29348443</pub-id><pub-id pub-id-type="doi">10.1038/s41467-017-02554-5</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title><source>Genome Biol</source><year>2019</year><volume>20</volume><elocation-id>296</elocation-id><pub-id pub-id-type="pmcid">PMC6927181</pub-id><pub-id pub-id-type="pmid">31870423</pub-id><pub-id pub-id-type="doi">10.1186/s13059-019-1874-1</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>JYH</given-names></name></person-group><article-title>A benchmark study of simulation methods for single-cell RNA sequencing data</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><elocation-id>6911</elocation-id><pub-id pub-id-type="pmcid">PMC8617278</pub-id><pub-id pub-id-type="pmid">34824223</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-27130-w</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gayoso</surname><given-names>A</given-names></name><etal/></person-group><article-title>A Python library for probabilistic analysis of single-cell omics data</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>163</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">35132262</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name><etal/></person-group><article-title>Probabilistic harmonization and annotation of single-cell transcriptomics data with deep generative models</article-title><source>Mol Syst Biol</source><year>2021</year><volume>17</volume><elocation-id>e9620</elocation-id><pub-id pub-id-type="pmcid">PMC7829634</pub-id><pub-id pub-id-type="pmid">33491336</pub-id><pub-id pub-id-type="doi">10.15252/msb.20209620</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinberger</surname><given-names>E</given-names></name><name><surname>Beebe-Wang</surname><given-names>N</given-names></name><name><surname>Lee</surname><given-names>S-I</given-names></name></person-group><article-title>Moment matching deep contrastive latent variable models</article-title><source>arXiv [csLG]</source><year>2022</year></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>D</given-names></name><etal/></person-group><article-title>Mapping cells through time and space with moscot</article-title><source>bioRxiv</source><year>2023</year><elocation-id>2023.05.11.540374</elocation-id><pub-id pub-id-type="doi">10.1101/2023.05.11.540374</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lähnemann</surname><given-names>D</given-names></name><etal/></person-group><article-title>Eleven grand challenges in single-cell data science</article-title><source>Genome Biol</source><year>2020</year><volume>21</volume><elocation-id>31</elocation-id><pub-id pub-id-type="pmcid">PMC7007675</pub-id><pub-id pub-id-type="pmid">32033589</pub-id><pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choudhary</surname><given-names>S</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Comparison and evaluation of statistical error models for scRNA-seq</article-title><source>Genome Biol</source><year>2022</year><volume>23</volume><elocation-id>27</elocation-id><pub-id pub-id-type="pmcid">PMC8764781</pub-id><pub-id pub-id-type="pmid">35042561</pub-id><pub-id pub-id-type="doi">10.1186/s13059-021-02584-9</pub-id></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huizing</surname><given-names>G-J</given-names></name><name><surname>Peyré</surname><given-names>G</given-names></name><name><surname>Cantini</surname><given-names>L</given-names></name></person-group><article-title>Optimal transport improves cell-cell similarity inference in single-cell omics data</article-title><source>Bioinformatics</source><year>2022</year><volume>38</volume><fpage>2169</fpage><lpage>2177</lpage><pub-id pub-id-type="pmcid">PMC9004651</pub-id><pub-id pub-id-type="pmid">35157031</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btac084</pub-id></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clarke</surname><given-names>ZA</given-names></name><etal/></person-group><article-title>Tutorial: guidelines for annotating single-cell transcriptomic maps using automated and manual methods</article-title><source>Nat Protoc</source><year>2021</year><volume>16</volume><fpage>2749</fpage><lpage>2764</lpage><pub-id pub-id-type="pmid">34031612</pub-id></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosales-Alvarez</surname><given-names>RE</given-names></name><etal/></person-group><article-title>VarID2 quantifies gene expression noise dynamics and unveils functional heterogeneity of ageing hematopoietic stem cells</article-title><source>Genome Biol</source><year>2023</year><volume>24</volume><elocation-id>148</elocation-id><pub-id pub-id-type="pmcid">PMC10290360</pub-id><pub-id pub-id-type="pmid">37353813</pub-id><pub-id pub-id-type="doi">10.1186/s13059-023-02974-1</pub-id></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlmann-Eltze</surname><given-names>C</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Comparison of transformations for single-cell RNA-seq data</article-title><source>Nat Methods</source><year>2023</year><volume>20</volume><fpage>665</fpage><lpage>672</lpage><pub-id pub-id-type="pmcid">PMC10172138</pub-id><pub-id pub-id-type="pmid">37037999</pub-id><pub-id pub-id-type="doi">10.1038/s41592-023-01814-1</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Evaluation measures used for cell population distance metrics evaluation.</title><p>(a) <italic>Control rank percentile (CRP)</italic> measures how close random samples of the control cells are to each other relative to how close they are to perturbed populations. Distances were measured between control pairs and control-perturbation pairs, ordered by magnitude, and then the relative rank of the control pairs was used to assess if the metric can distinguish between perturbed and control populations. (b) <italic>Robustness</italic> measures how similar control–perturbation distances are when calculated for different random samples of the control cells. (c) <italic>Biological reproducibility (BioRep)</italic> measures how well the measured distance metrics correspond to biological ground truth based on a biological covariate. (d) Recommendations were formulated from multiple types of experimental and simulated datasets. High-performing metrics have control populations that were close to each other and had a high correlation with known covariates.</p></caption><graphic xlink:href="EMS193133-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Description of intervention datasets and distance metric performance results.</title><p>(a) Categories used for evaluation. For each dataset the UMAP on the left is colored by the biological covariate used when calculating BioRep metric; the UMAP on the right highlights in blue the control population used when calculating CRP. The three labeled K562, MCF7, and A549 are different cell lines from a single experiment (Sci-plex3). (b) Overview of distance metric performance for each dataset and metric evaluation method, colored by rank across the evaluated metrics. The mean score for each metric is shown on the right, colored by the category each distance was assigned to (referred to as “type” below). Distances of the same type have similar absolute values. Type I distances performed better overall across tasks and datasets.</p></caption><graphic xlink:href="EMS193133-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Use cases of different distance metrics and computational runtime.</title><p>(a),(b) Latent representations of Norman et al. generated by two scVI-based models, colored by (a) two CRISPRa interventions which co-cluster separately from other cells in MSE-scVI but not in standard scVI and (b) six CRISPRa interventions which formed a separate cluster in the latent representations of both models. In (a), LISI score was averaged between the two interventions. In (b), the KLF1+SET CRISPRa intervention appears in a different location relative to other interventions depending on the model used. (c) Gene expression prediction performance of three different models resulted in a different winning model depending on the metric used. (d),(e) Distances quantified response relative response to perturbation across cell types. Prioritization via Augur and MSE are comparable despite dramatic differences in methodology and reduced computation time for MSE. (f) The computation time of two distances (Wasserstein and KS statistic) scaled poorly with an increasing number of conditions. Our recommended distance, MSE, increased in computational time with the number of conditions but remained fast overall.</p></caption><graphic xlink:href="EMS193133-f003"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><p>Summary of evaluated metrics. The four distance axioms referred to are I. Definiteness, II. Symmetry, III. Triangle inequality, and IV. Positivity. Representative distances for type I and type II are bolded. Conversion to distance ‘-’ when no conversion needed.</p></caption><table frame="box" rules="all"><thead><tr><th valign="bottom" align="left">Metric</th><th valign="bottom" align="left">Abbrev.</th><th valign="bottom" align="left">Conversion to distance</th><th valign="bottom" align="left">Assumptions</th><th valign="bottom" align="left">Differentiable</th><th valign="bottom" align="left">Axioms satisfied</th><th valign="bottom" align="left">Type</th></tr></thead><tbody><tr><td valign="bottom" align="left"><bold>Mean squared error</bold></td><td valign="bottom" align="left">MSE</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Gaussian</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ia</td></tr><tr><td valign="top" align="left">Maximum mean discrepancy</td><td valign="bottom" align="left">MMD</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Depends on kernel</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ia</td></tr><tr><td valign="bottom" align="left">Euclidean distance</td><td valign="bottom" align="left">Euclidean</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ia</td></tr><tr><td valign="bottom" align="left">Energy distance</td><td valign="bottom" align="left">E-distance</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Gaussian</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ia</td></tr><tr><td valign="bottom" align="left">Kolmogorov–Smirnov test</td><td valign="bottom" align="left">KS test</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">no</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ia</td></tr><tr><td valign="bottom" align="left">Mean absolute error</td><td valign="bottom" align="left">MAE</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Laplacian</td><td valign="bottom" align="left">yes<sup>*</sup></td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">Ib</td></tr><tr><td valign="bottom" align="left">Two-sided T-test statistic</td><td valign="bottom" align="left">T-test</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Gaussians with equal variance</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">violates III</td><td valign="bottom" align="left">Ib</td></tr><tr><td valign="bottom" align="left"><bold>Cosine distance</bold></td><td valign="bottom" align="left">cosine</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">II</td></tr><tr><td valign="bottom" align="left">Pearson correlation coefficient</td><td valign="bottom" align="left">Pearson</td><td valign="bottom" align="left">1 - r</td><td valign="bottom" align="left">Linearity, Gaussian</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">violates III</td><td valign="bottom" align="left">II</td></tr><tr><td valign="bottom" align="left">Coefficient of determination</td><td valign="bottom" align="left">R<sup>2</sup></td><td valign="bottom" align="left">1 - R<sup>2</sup></td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">violates II, III</td><td valign="bottom" align="left">II</td></tr><tr><td valign="bottom" align="left">Classifier control probability</td><td valign="bottom" align="left">classifier proba</td><td valign="bottom" align="left">1 - control probability</td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">no</td><td valign="bottom" align="left">violates II, III</td><td valign="bottom" align="left">II</td></tr><tr><td valign="bottom" align="left">Kendall tau distance</td><td valign="bottom" align="left">Kendall tau</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Ordinal variables</td><td valign="bottom" align="left">no</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">III</td></tr><tr><td valign="bottom" align="left">Spearman correlation coefficient</td><td valign="bottom" align="left">Spearman</td><td valign="bottom" align="left">1 - rho</td><td valign="bottom" align="left">Ordinal variables</td><td valign="bottom" align="left">no</td><td valign="bottom" align="left">violates III</td><td valign="bottom" align="left">III</td></tr><tr><td valign="bottom" align="left">Wasserstein distance</td><td valign="bottom" align="left">Wasserstein</td><td valign="bottom" align="left">-</td><td valign="bottom" align="left">Corresponding populations</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">violates I</td><td valign="bottom" align="left">III</td></tr><tr><td valign="bottom" align="left">Symmetric Kullback-Leibler divergence</td><td valign="bottom" align="left">symmetric KL</td><td valign="bottom" align="left">Gaussian for non-discrete formulation</td><td valign="bottom" align="left">X, Y occupy same distribution space, Gaussian</td><td valign="bottom" align="left">yes</td><td valign="bottom" align="left">violates III</td><td valign="bottom" align="left">III</td></tr><tr><td valign="bottom" align="left">Classifier class projection</td><td valign="bottom" align="left">classifier_cp</td><td valign="bottom" align="left">1 - control probability</td><td valign="bottom" align="left">None</td><td valign="bottom" align="left">no</td><td valign="bottom" align="left">violates II, III</td><td valign="bottom" align="left">-</td></tr></tbody></table></table-wrap></floats-group></article>