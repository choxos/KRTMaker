<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS146588</article-id><article-id pub-id-type="doi">10.1101/2020.11.09.375626</article-id><article-id pub-id-type="archive">PPR236757</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>DeepDrug: A general graph-based deep learning framework for drug-drug interactions and drug-target interactions prediction</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yin</surname><given-names>Qijin</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Cao</surname><given-names>Xusheng</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Fan</surname><given-names>Rui</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Qiao</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Jiang</surname><given-names>Rui</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Zeng</surname><given-names>Wanwen</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University, Beijing 100084, China</aff><aff id="A2"><label>2</label>College of Software, Nankai University, Tianjin, 300350, China</aff><aff id="A3"><label>3</label>Department of Statistics, Stanford University, Stanford, CA 94305, USA</aff><author-notes><corresp id="CR1">
<label>*</label>To whom correspondence may be addressed. <email>liuqiao@stanford.edu</email>; <email>ruijiang@tsinghua.edu.cn</email>; <email>wanwen@stanford.edu</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>01</day><month>07</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>04</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Computational approaches for accurate prediction of drug interactions, such as drug-drug interactions (DDIs) and drug-target interactions (DTIs), are highly demanded for biochemical researchers due to the efficiency and cost-effectiveness. Despite the fact that many methods have been proposed and developed to predict DDIs and DTIs respectively, their success is still limited due to a lack of systematic evaluation of the intrinsic properties embedded in the corresponding chemical structure. In this paper, we develop a deep learning framework, named DeepDrug, to overcome the above limitation by using residual graph convolutional networks (RGCNs) and convolutional networks (CNNs) to learn the comprehensive structural and sequential representations of drugs and proteins in order to boost the DDIs and DTIs prediction accuracy. We benchmark our methods in a series of systematic experiments, including binary-class DDIs, multi-class/multi-label DDIs, binary-class DTIs classification and DTIs regression tasks using several datasets. We then demonstrate that DeepDrug outperforms state-of-the-art methods in terms of both accuracy and robustness in predicting DDIs and DTIs with multiple experimental settings. Furthermore, we visualize the structural features learned by DeepDrug RGCN module, which displays compatible and accordant patterns in chemical properties and drug categories, providing additional evidence to support the strong predictive power of DeepDrug. Ultimately, we apply DeepDrug to perform drug repositioning on the whole DrugBank database to discover the potential drug candidates against SARS-CoV-2, where 3 out of 5 top-ranked drugs are reported to be repurposed to potentially treat COVID-19. To sum up, we believe that DeepDrug is an efficient tool in accurate prediction of DDIs and DTIs and provides a promising insight in understanding the underlying mechanism of these biochemical relations. The source code of the DeepDrug can be freely downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/wanwenzeng/deepdrug">https://github.com/wanwenzeng/deepdrug</ext-link>.</p></abstract><kwd-group><kwd>drug-drug interactions</kwd><kwd>drug-target interactions</kwd><kwd>deep learning</kwd><kwd>graph convolutional neural network</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The exploration for biomedical interactions between chemical compounds (drugs, molecules) and protein targets is of great significance for drug discovery<sup><xref ref-type="bibr" rid="R1">1</xref></sup>. It is believed that drugs interact with biological systems by binding to protein targets and affecting their downstream activity. Prediction of Drug-Target Interactions (DTIs) is thus important for identification of therapeutic targets or characteristics of drug targets. The abundant knowledge of DTIs also provides valuable insight towards understanding and uncovering higher-level information such as therapeutic mechanisms in drug repurposing<sup><xref ref-type="bibr" rid="R2">2</xref></sup>. For instance, Sildenafil was initially developed to treat pulmonary hypertension, but identification of its side effects allowed it to be repositioned for treating erectile dysfunction<sup><xref ref-type="bibr" rid="R3">3</xref></sup>. In addition, since most human diseases are complex biological processes that are resistant to the activity of a single drug<sup><xref ref-type="bibr" rid="R4">4</xref>, <xref ref-type="bibr" rid="R5">5</xref></sup>, polypharmacy has become a promising strategy among pharmacists. Prediction and validation of Drug-Drug Interactions (DDIs) can sometimes reveal potential synergies in drug combinations to improve the therapeutic efficacy of individual drugs<sup><xref ref-type="bibr" rid="R6">6</xref></sup>. More importantly, negative DDIs are major causes of adverse drug reactions (ADRs)<sup><xref ref-type="bibr" rid="R7">7</xref></sup>, especially among the elderly who are more likely to take multiple medications<sup><xref ref-type="bibr" rid="R8">8</xref></sup>. The severe ADRs from critical DDIs may lead to the withdrawal of drugs from market, such as withdrawal of mibefradil and cerivastatin from the US market<sup><xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref></sup>. Hence, accurate interactions prediction between drugs can not only ensure drug safety, but also can shed a light for drug repositioning or drug repurposing, which potentially can lower the overall drug development costs and enhance the drug development efficiency.</p><p id="P3">Over the past decade, the emergence of various biochemical databases, such as DrugBank<sup><xref ref-type="bibr" rid="R11">11</xref></sup>, TwoSides<sup><xref ref-type="bibr" rid="R12">12</xref></sup>, RCSB Protein Data Bank<sup><xref ref-type="bibr" rid="R13">13</xref></sup> and PubChem<sup><xref ref-type="bibr" rid="R14">14</xref></sup>, has provided a rich resource for studying DTIs and DDIs for health professionals. However, prediction of novel or unseen biochemical interactions still remains a challenging task. In vitro experimental techniques are reliable but expensive and time-consuming. In silico computational approaches have received far more attention due to their cost-effectiveness and increasing accuracy in various drug-related prediction tasks<sup><xref ref-type="bibr" rid="R15">15</xref>, <xref ref-type="bibr" rid="R16">16</xref>, <xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R18">18</xref></sup>. The state-of-the-art computational methods for interactions prediction rely on machine learning algorithms that incorporate large-scale biochemical data. Most of these efforts are based on the principle that similar drugs tend to share similar target proteins and vice versa<sup><xref ref-type="bibr" rid="R19">19</xref></sup>. Hence, the most popular frameworks formulate the prediction of DTIs and DDIs as classification tasks and use different forms of similarity functions as inputs<sup><xref ref-type="bibr" rid="R20">20</xref></sup>. Another common types of approach are to construct heterogeneous networks in the chemogenomics space to predict potential interactions using random walks<sup><xref ref-type="bibr" rid="R21">21</xref></sup>. The rise of machine learning methods, especially deep learning methods have promoted drug-related research tremendously in the last two decades, including the tasks for predicting DTIs and DDIs<sup><xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref></sup>. For example, DeepDDI<sup><xref ref-type="bibr" rid="R16">16</xref></sup> first generated a feature vector called structural similarity profile (SSP) for each drug, then calculated a combined SSPs of a pair of drugs by dimension reduction, i.e., PCA, from concatenation of two SSP of drugs. The combined SSPs were used for training DeepDDI model to perform DDI prediction. Similar to DeepDDI, NDD<sup><xref ref-type="bibr" rid="R15">15</xref></sup> first calculated high-level features of drug by multiple drug similarities based on drug substructure, target, side effect, pathway and etc. Then it used a multi-layer perceptron for the interaction prediction based on curated features. DeepPurpose<sup><xref ref-type="bibr" rid="R24">24</xref></sup> is a deep learning framework for DTI and DDI prediction tasks by integrating different types of neural network structure only using sequential inputs. DeepDTA<sup><xref ref-type="bibr" rid="R17">17</xref></sup> used two convolutional neural networks to learn from compound SMILES and protein sequences to predict interactions. GraphDTA<sup><xref ref-type="bibr" rid="R25">25</xref></sup> used graph neural networks and convolutional neural network to learn the high dimension features of drugs and targets separately and makes interaction prediction via fully connected layers.</p><p id="P4">In spite of these advances, there is still room for improvement in several aspects. First of all, the accurate prediction of unseen drug interactions depends heavily on the feature extraction technique or similarity kernel used. Since different forms of feature extraction or similarity kernel introduce varying amount of human-engineered bias, they often display different levels of predictive performance depending on the relevant settings and no single kernel outperforms others universally<sup><xref ref-type="bibr" rid="R26">26</xref></sup>. Similarity-based methods also have difficulty applied on large-scale datasets due to the significant computational complexity of measuring similarity matrices<sup><xref ref-type="bibr" rid="R27">27</xref></sup>. Network-based methods built upon topological properties of the multipartite graph suffer from the same problem depending on the complexity of the graph<sup><xref ref-type="bibr" rid="R28">28</xref></sup>. Deep learning based methods utilized either sequential or structural information, but none of them combined both information for specific drug/protein to comprehensively model the biological entities under the same framework.</p><p id="P5">In recent years, deep learning frameworks based on various of graph neural networks such as graph convolutional network (GCNs)<sup><xref ref-type="bibr" rid="R29">29</xref></sup>, graph attention networks (GATs)<sup><xref ref-type="bibr" rid="R30">30</xref></sup>, gated graph neural networks (GGNNs)<sup><xref ref-type="bibr" rid="R31">31</xref></sup> and residual graph convolutional network (RGCNs)<sup><xref ref-type="bibr" rid="R32">32</xref></sup> have demonstrated ground-breaking performance on social science, natural science, knowledge graphs and many other research areas<sup><xref ref-type="bibr" rid="R33">33</xref>, <xref ref-type="bibr" rid="R34">34</xref></sup>. In particular, GCNs have been applied to various biochemical problems such as molecular properties prediction<sup><xref ref-type="bibr" rid="R35">35</xref></sup>, molecular generation, protein function prediction<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. As pharmacological similarities are mainly originated and computed from not only sequential but also structural properties, graph representations of biochemical entities have shown capability of capturing the structural features of Euclidean ones without requiring feature engineering<sup><xref ref-type="bibr" rid="R37">37</xref>, <xref ref-type="bibr" rid="R38">38</xref></sup>.</p><p id="P6">Based on these observations, we propose DeepDrug, a graph-based deep learning framework, to learn drug interactions such as pairwise DDIs or DTIs. We formulate the DDIs and DTIs prediction problem as classification/regression tasks. A key insight of our framework is that biochemical interactions are primarily determined by both the sequence and structure of the participating entities. Therefore, the performance of the predictive model ultimately depends on the accurate characterization of the sequential and structural information. Since chemical structure of drugs can be naturally represented as graphs with nodes and edges denoting chemical atoms and bonds, respectively. Protein structures also have natural graph representations with nodes and edges representing amino acids and biochemical interactions, respectively. Thus it is intuitive to employ a graph-based architecture for DeepDrug. The proposed model mainly differs from previous methods in the following two aspects: 1) By taking advantage of the natural graph representation of drugs and proteins, DeepDrug takes not only traditional sequence representation but also graph representations as inputs to learn sequential and structural features for drugs and proteins under the same framework; 2) DeepDrug utilizes RGCN module to capture the intrinsic structural information among atoms of a compound and residues of a protein and CNN module to obtain genomics information in sequence. Comprehensive experiments on different benchmark datasets demonstrate that DeepDrug can successfully learn DDIs and DTIs by combining structural features from RGCN module and sequential features from CNN module in different tasks such as binary classification, multi-class/multi-label classification and regression. A series of systematic experiments show that DeepDrug outperforms other state-of-the-art models and demonstrates high robustness under different experimental settings. By visualization of structural features of drugs in our study, we also demonstrate the effectiveness of the RGCN module in learning structural information and drug functional information that have reasonable consistency.</p><p id="P7">In summary, the contributions of this paper are summarized as follows: <list list-type="simple" id="L1"><list-item><label>–</label><p id="P8">DeepDrug provides a unified framework based on RGCNs with edge features incorporation to extract structural information and CNNs to extract sequential information for both drugs and proteins for downstream DDIs and DTIs prediction. The novel design of DeepDrug architecture can capture comprehensive sequential and structural features.</p></list-item><list-item><label>–</label><p id="P9">DeepDrug achieves state-of-the-art performance in both DDIs and DTIs prediction tasks. Through comprehensive experiments, including binary-class classification of DDIs, multi-class/multi-label classification of DDIs, binary-class classification of DTIs and regression of DTIs in different ratios of positive and negative samples, the superior performance of DeepDrug highlights the strong and robust predictive power of DeepDrug architecture.</p></list-item><list-item><label>–</label><p id="P10">The interpretation of structural features learned from DeepDrug proves the key insight that biomedical structure may determine their function and drugs with similar structures tend to have similar targets.</p></list-item><list-item><label>–</label><p id="P11">The results of drug repositioning for SARS-CoV-2 suggest that DeepDrug can be a useful tool for effectively predicting DDIs and DTIs and greatly facilitate the drug discovery process.</p></list-item></list>
</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Overview of DeepDrug</title><p id="P12">We developed a deep learning framework, DeepDrug, to predict drug interactions (e.g., DDIs and DTIs) by combining sequence profile and structural profile (<xref ref-type="sec" rid="S10">Methods</xref>). For each input (drug or protein), we used sequence data as well as the partially available structure profile data as separate input branch to the DeepDrug model (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The input sequence was converted into a representation using one-hot encoding, and connected to several convolution layers. The partial structure profile was encoded as a graph, where we used DeepChem for converting drug SMILES strings into graph representations in the form of feature matrices (i.e. node feature matrices and edge feature matrices) and adjacency matrices and PAIRPred<sup><xref ref-type="bibr" rid="R39">39</xref></sup> for extracting the protein PDB data into similar graph representations. Then the graph representation was fed to several residual graph convolution layers. The hidden features extracted from the sequence branch and structural branch were subsequently merged by concatenation. Finally, we concatenated the hidden features for the pair of inputs together, and a fully connected layer with sigmoid/softmax/none activation functions were used to get different types of output. The detailed architecture of DeepDrug is provided in <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>.</p></sec><sec id="S4"><title>DeepDrug enables superior drug-drug interactions prediction</title><p id="P13">DDIs prediction falls into two categories: 1) binary classification where each DDI in the database was annotated as positive examples and negative examples were selected by random pairing. 2) multi-class/multi-label classification where the multi-label were obtained from annotations based on the different types of interactions (e.g., adverse effect) defined in DrugBank and Twosides. (<xref ref-type="sec" rid="S10">Methods</xref>). We first evaluated the performance of DeepDrug for DDIs prediction in a binary classification setting. We benchmarked DeepDrug against six baseline methods, including random forest classification (RF) and logistic regression (LR), DeepDDI<sup><xref ref-type="bibr" rid="R16">16</xref></sup>, DeepPurpose<sup><xref ref-type="bibr" rid="R24">24</xref></sup>, NDD<sup><xref ref-type="bibr" rid="R15">15</xref></sup> and AttentionDDI<sup><xref ref-type="bibr" rid="R40">40</xref></sup>. The baseline methods took either node feature matrix, edge feature matrix and adjacency matrix as inputs or SMILES string and similarities matrix as inputs (<xref ref-type="sec" rid="S10">Methods</xref>). Four different sets of data were used for evaluation, including DDInter, DrugBank, Twosides and NDD (<xref ref-type="sec" rid="S10">Methods</xref>). Our analysis showed that deep learning methods outperform similarity-based methods and traditional machine learning methods across different datasets by a large margin. Among the deep learning methods, DeepDrug consistently outperformed two other deep learning methods by achieving the highest F1 score of 0.916-0.955, highest auPRC score of 0.964-0.987 and highest auROC score of 0.971-0.988 in balanced datasets (<xref ref-type="fig" rid="F2">Fig. 2A,B</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). Comparing to the second best baseline method DeepPurpose, DeepDrug achieved averaged 2.1% higher F1 score,1.3% higher auPRC score and 1.1% higher auROC score in balanced data settings.</p><p id="P14">However, Due to the rarity of occurrence of DDIs<sup><xref ref-type="bibr" rid="R41">41</xref></sup>, the number of known DDIs among a typical drug database is usually very low. Hence, to be more realistic and practical, we also evaluated robustness of DeepDrug with imbalanced datasets by altering the ratio between positive samples and negative samples to 1:2, 1:4, 1:8 and 1:16 based on the number of drugs in different datasets. In our case, although the auPRC scores of all comparing methods dropped, DeepDrug still outperforms other comparison methods across all datasets with different positive-to-negative ratio by achieving the highest F1 and auPRC scores (<xref ref-type="fig" rid="F2">Fig. 2E-F</xref>). Specifically, DeepDrug is more robust and achieves a significantly higher performance than the second best comparison method DeepPurpose when the dataset is extremely unbalanced (<xref ref-type="fig" rid="F2">Fig. 2C-D</xref>). For example, The superiority demonstrated by DeepDrug over DeepPurpose in terms of F1 score increased from 1.7% to 9.6% when the positive-to-negative sample ratio changed from 1:1 to 1:16 for DDInter dataset. To sum up, the performance of DeepDrug in terms of F1 and auPRC scores over other prediction methods demonstrated the superior ability of DeepDrug in predicting DDIs, especially with unbalanced dataset.</p><p id="P15">To further showcase the predictive capability of our model, we compare DeepDrug with other methods in multi-class/multi-label classification tasks. We conducted the classification experiments using DrugBank and Twosidess databases based on the 86 and 1317 interaction types, respectively. All of the DDI methods were evaluated using standard metrics including macro F1 score and auPRC score. In multi-class classification, DeepDrug achieved the best performance by obtaining 4.3%-5.8% higher F1 score and 4.9%-6.7% higher auPRC than the best baseline method (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). The outperformance by DeepDrug indicated the advantage of using structural representation and sequential representation of drug in DDI predictions. The same trend was observed in multi-label classification results where the introduction of 1317 types of interactions in dataset lowers F1 scores of all methods, DeepDrug demonstrated much higher F1 as 0.292 and auPRC score as 0.265 than second best method DeepPurpose (F1 score 0.227 and auPRC score 0.191) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2A,B,C</xref>). DeepDrug was shown to be superior and robust in both binary and multi-class/multi-label classification of DDIs. Therefore, unlike DeepPurpose that only used the SMILES sequence information, DeepDrug exploited both structural information from a novel graph representation and sequence information from SMILES string, which is potentially capable of learning the underlying structural properties to gain better performance.</p></sec><sec id="S5"><title>DeepDrug accurately identifies drug-target interactions</title><p id="P16">Although proteins generally have more intricate structures than chemical drugs due to their three-dimensional arrangement of sequence residuals, they can still be effectively represented by 3D graphs. We first classified the DrugBank DTI dataset with binary labels and benchmarked DeepDrug against six baseline methods, including RF and LR, DeepPurpose, CPI<sup><xref ref-type="bibr" rid="R42">42</xref></sup>, MolTrans<sup><xref ref-type="bibr" rid="R43">43</xref></sup> and TransformerCPI<sup><xref ref-type="bibr" rid="R44">44</xref></sup> (<xref ref-type="sec" rid="S10">Methods</xref>). Similarly, the baseline methods took either node feature matrix, edge feature matrix and adjacency matrix or SMILES string as inputs (<xref ref-type="sec" rid="S10">Methods</xref>). Three benchmark datasets were introduced, including BindingDB, DAVIS and KIBA (<xref ref-type="sec" rid="S10">Methods</xref>). The benchmark experimental results also showed the same trend as DDIs tasks that deep learning methods dominated the DTIs prediction tasks. DeepDrug again obtained the best performance across all three deep learning methods by achieving an average auPRC of 0.811 in the above three datasets, compared to 0.788 of the second best baseline DeepPurpose (<xref ref-type="fig" rid="F3">Fig.3A-C</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>). Noticeably, DeepDrug and DeepPurpose were the only two deep learning methods that were applicable in the largest BindingDB dataset while the transformer-based method TransformerCPI failed due to the low computational efficiency. The superior performance of DeepDrug in DTIs prediction tasks indicated that the graph-based representation of drug can be regarded as a general framework for boosting preidcition performance in various drug-related tasks.</p><p id="P17">To further illustrate the predictive capability of our model, we compared DeepDrug four baseline methods, including GraphADT, DeepADT, DeepPurpose and RF, in DTIs regression settings. We conducted the regression experiments in the same three datasets (BindingDB, DAVIS and KIBA<sup><xref ref-type="bibr" rid="R45">45</xref></sup>) based on the Kd value (kinase dissociation constant). All of the comparing methods were evaluated using standard metrics including concordance score, Pearson r score and R<sup>2</sup> score. Again, DeepDrug achieved the best performance in terms of the three evaluation measurements compared to baseline methods (<xref ref-type="fig" rid="F3">Fig. 3D-F</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 4</xref>). Specifically, DeepDrug achieved the highest concordance score of 0.836 in BindingDB, which is 1.2% and 2.3% higher than DeepPurpose and a graph neural network based method GraphDTA, respectively. The superiority of DeepDrug was consistently observed in DAVIS and KIBA datasets. Different from GraphDTA that only updated node features in the graph convolutional layers, DeepDrug considered both node features and edge features and updated them iteratively, thus leading to a more comprehensive representation of a drug and resulting in an incremental predictive power in the DTIs tasks. The superiority of DeepDrug indicated the benefit of combining a comprehensive structural representation and sequence representation for both drugs and proteins in DTI prediction tasks.</p><p id="P18">To further explore the ability of DeepDrug in drug repositioning, we stringently separated the drugs and proteins into training and test sets, thus curating a blind test set where the drugs and proteins in test set have no overlap with training set. This task became much more challenging as both the drugs and proteins were unseen during the training process. DeepDrug demonstrated a concordance score of 0.677 and Pearson r of 0.468 in DAVIS dataset, which outperformed DeepPurpose (concordance score of 0.605, Pearson r of 0.392) by a noticeable margin (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 5</xref>). Therefore, by exploiting useful structural information from graph representation of drugs and proteins, DeepDrug was shown to be consistently superior over baseline methods in both classification and regression of DTIs. We then summarized that DeepDrug provided a powerful representation of both drugs and proteins by considering both the comprehensive structural information as well as the SMILES sequence information. The superior performance of DeepDrug across various settings in DDIs and DTIs prediction tasks implicated a strong generalization ability of DeepDrug in wide drug-related applications.</p></sec><sec id="S6"><title>Model ablation analysis</title><p id="P19">To further support the results shown in the above sections, we conducted model ablation analysis to measure the contribution of different modules used in DeepDrug architecture (<xref ref-type="sec" rid="S10">Methods</xref>). In particular, we analyzed the performance of DeepDrug with respect to the following model ablation setting: presence of RGCN module and presence of CNN module. We used the binary classification task of DDIs in multiple positive-to-negative sample ratios and DTIs regression for ablation studies. It was observed that using RGCN module alone lead to a decrease in performance with 0.5%~2.6% lower F1 score while using only CNN module resulted in a decline of 0.2%~1.6% in F1 score (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 6</xref>). Similar decrease trends were noticed in terms of R<sup>2</sup> and concordance score in DTI regression tasks. To summarize, RGCN module is the most important component of DeepDrug and RGCN module and CNN module are complementing each other to further improve the predictive performance, indicating the usefulness of our designed DeepDrug architecture.</p><p id="P20">We also analyzed the robustness of DeepDrug with respect to the following hyperparameter setting: choice of feature aggregation, number of hidden units in each GCN layer, the total number of GCN layers. The performance of DeepDrug was not sensitive to different feature aggregation operations, indicating the stability of different aggregation manners (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 7</xref>). As the number of hidden units increased significantly (e.g. 32 and higher) in RGCN layer, both evaluation metrics started to saturate. As the number of GCN layers increased, the model became insensitive to the number of RGCN and CNN layers as well (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 7</xref>). To sum up, DeepDrug was insensitive to most parameter choices, illustrating the robustness of the framework.</p></sec><sec id="S7"><title>DeepDrug embeddings reflect drug types and drug functions</title><p id="P21">We sought to demonstrate that DeepDrug effectively captured the variability of structural information in the embeddings learned from RGCN module. We first tested our method on DrugBank dataset with extra information such as drug types or drug functions. After training, the structural embeddings from DeepDrug were projected to a two-dimensional space with t-distributed stochastic neighbor embedding (tSNE) for visualization. We found that the DeepDrug embeddings exhibited clear patterns that corresponded to the underlying drug types and drug functions (<xref ref-type="fig" rid="F4">Fig. 4A</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3</xref>). We assumed that drugs that were closer in the embedding space (e.g, within the same cluster) implied the presence of certain form of higher similarity or closer relationship. To verify this, we then quantified the effectiveness of the embeddings by various evaluation settings and made direct comparisons to the state-of-the-art method DeepPurpose (<xref ref-type="sec" rid="S10">Methods</xref>). The quantitative results based on unsupervised evaluation suggested that the DeepDrug embeddings consistently outperformed DeepPurpose, with 6.91% higher averaged Drug Category Enrichment Score (DCES, <xref ref-type="sec" rid="S10">Methods</xref>) while the silhouette score is similar (<xref ref-type="fig" rid="F4">Fig. 4B</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 8</xref>). This is presumably because DeepDrug takes advantage of the extra structure information of proteins. Extensive evaluations under various folds showed that the DeepDrug embeddings consistently achieved the best performance (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). Furthermore, to evaluate the performance of Deepdrug applied to unseen drugs, we collected 4886 unseen drugs from DrugBank website (<xref ref-type="sec" rid="S10">Methods</xref>) and the DCES was 0.575 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 9</xref>), which was significantly better than the background distribution (DCES of null distribution = 0.10).</p><p id="P22">For further understanding, we isolated 12 drugs in the cluster 4 (enriched as opioids) and compared their chemical structures as well as their functionalities with other randomly sampled drugs in the dataset that were far away from the cluster. A subset of our sampled drugs are presented in <xref ref-type="fig" rid="F4">Fig. 4D</xref>. The striking observation was that drugs in the cluster shared very similar structural compositions. In terms of functionality, the cluster of drugs identified by DeepDrug embeddings were highly similar among themselves as well. Out of the 28 drugs in the cluster 4, all of them were meant for pain relief (<xref ref-type="fig" rid="F4">Fig. 4D</xref>). Taken together, these results demonstrated that the DeepDrug structural embeddings effectively captured the structural information which might determine the functionality of the input entities to reflect the underlying drug function. Such structural embedding capability is considered to be the main driving force to the superior performance of DeepDrug.</p></sec><sec id="S8"><title>DeepDrug provides therapeutic opportunities against SARS-CoV-2</title><p id="P23">To date, tens of millions of people have been infected with severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), causing the outbreak of the respiratory disease named the coronavirus disease 2019 (COVID-19). As a newly emerged member of the coronavirus family, SARS-CoV-2 is an enveloped positive-strand RNA virus, which has probably the largest genome (approximately 30 kb) among all RNA viruses. SARS-CoV-2 consists of 16 non-structural proteins (nsp1–nsp16 from ORF1a and ORF1ab), four structural proteins (spike, envelope, membrane and nucleocapsid) and nine putative accessory factors<sup><xref ref-type="bibr" rid="R46">46</xref></sup>. Nsp1–nsp16 forms the replicase-transcriptase complex. A primary RNA-dependent RNA polymerase Nsp12 is an essential protein that catalyzes the replication of RNA from an RNA template. The nucleocapsid (N) protein, which is mainly responsible for recognizing and wrapping viral RNA into helically symmetric structures, has been reported to boost the efficiency of transcription and replication of viral RNA, implying its vital and multifunctional roles in the life cycle of coronavirus<sup><xref ref-type="bibr" rid="R47">47</xref></sup>.</p><p id="P24">We next investigated whether DeepDrug was able to correctly identify the interactions of SARS-CoV-2 proteins. We constructed two drug-target positive datasets (i.e. one is expert-confirmed and one is literature-based) for SARS-CoV-2 from a recent study<sup><xref ref-type="bibr" rid="R46">46</xref></sup> (<xref ref-type="sec" rid="S10">Methods</xref>). In our benchmark BindingDB dataset, there were 68 SARS-CoV-2 interacting drugs and 124 proteins which were similar with these SARS-CoV-2 proteins. To obtain a stringent rule for constructing dataset, we removed those SARS-CoV-2 interacting drugs and analogous drugs from the training set that shared similar SMILE sequences (defined as drugs sequence similarities &gt; 60%, see <xref ref-type="sec" rid="S10">Methods</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig 4A-B</xref>), and removed proteins similar SARS-CoV-2 with protein sequence similarities &gt; 30%. After removing these records we re-trained the DeepDrug model and combined the SARS-CoV-2 interacting drugs with the remaining 64,980 drugs to construct an independent test set. The DeepDrug prediction scores for interacting pairs and non-interacting pairs were shown in <xref ref-type="fig" rid="F5">Fig 5A</xref>, we noticed that DeepDrug assigned higher prediction scores for those interacting pairs. The results showed that DeepDrug was able to distinguish expert-confirmed positive pairs from negative pairs in both of Mean and Maximum strategies (<italic>p</italic>-values equal to 5.06× 10<sup>-9</sup> and 8.06× 10<sup>-7</sup> respectively, one-side paired t-test). Results predicted on the similar templates for RCSB database, rather than the simulation structures, also show similar significant discrimination between expert-confirmed positive pairs and negative pairs (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 5</xref>). In addition, the results of DeepDrug training on the original BindingDB dataset also showed similar performance (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 6</xref>). Since the pairs from the negative dataset above were obtained from random pairing, there might exist potential effect drugs in the negative dataset. We observed that there were some outliers with very high affinity in the predictions of the negative pairs, which could be potential valid potential drugs. Among the top-ranked drug-protein pairs, 2 out of top-3 drugs, 5 out of top-20 drugs were already reported by literatures (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 10</xref>). For example, tiotropium may be effective for SARS-CoV-2 patients by reducing expressions of IL1B, IL6, IL8, RELA, NFKB1 and TNF, which is strongly activated by SARS-CoV-2 infection<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.Such results further demonstrated the strong predictive power of DeepDrug and DeepDrug may provide therapeutic opportunities against newly found proteins such as SARS-CoV-2.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P25">In this study, we proposed DeepDrug as a novel end-to-end deep learning framework for DDIs and DTIs predictions. DeepDrug takes both topological structure information and sequence information of either drug-drug pair or drug-protein pair as inputs and utilizes RGCNs and CNNs to learn the graph representation and high-level sequence embeddings, respectively. Multi-source features are fused together to complement each other in order to achieve a superior prediction level with high accuracy. In a series of systematic experiments, DeepDrug shows superior predictive performance in different datasets under various experimental settings of DDIs and DTIs tasks. DeepDrug mainly differs from previous methods in two aspects. First, unlike most previous methods that are designed only for a specifc task such as DDIs or DTIs prediction, DeepDrug adopts a more general graph-based architecture to facilitate the prediction in both DDIs and DTIs tasks. Second, previous methods typically only used the SMILES string or drug structural information as input, DeepDrug utilizes both topological information and sequence information as inputs to form a hybrid feature representation in order to boost the prediction performance. To the best of our knowledge, DeepDrug is the first work to apply both graph convolutions and sequence convolutions to molecular representation. In addition, we demonstrated that the combination of intrinsic graph-based representation and high-level sequence embeddings are appealing for a comprehensive assessment for predicting DDIs and DTIs. Our extensive experiments highlighted the predictive power of DeepDrug and its potential translational value in drug repositioning.</p><p id="P26">We provide two future directions for improving our DeepDrug model. First, the current interaction predictions (e.g., DTIs) do not consider the causal interaction where one drug is involved in a biological or biochemical process to directly or indirectly affect a protein. Identifying such direct interactions and indirect interactions could help us better understand the related biological or chemical pathways or mecthanisms. Second, a more in-depth systematic study of the embedded features learned by RGCN module or CNN module should be carefully compared. For example, we could use correlation studies to explore the relationships between two source of features, thus providing insights in comprehensive feature interpretation.</p><p id="P27">To sum up, we introduced DeepDrug which can be served as a framework for systematically exploring the DDIs and DTIs prediction tasks with a unified model architecture. With DeepDrug, researchers could perform drug repositioning with specific target proteins. Then, one can simultaneously learn the interaction mechanism and annotate the interaction potential for every possible drug. Using large-scale pubic data, one could train an accurate and interpretable model to predict the interactions associated with human diseases (e.g., SARS-CoV-2). We hope our approach could help unveil the drug interaction mechanism and facilitate the further biochemical research.</p></sec><sec id="S10" sec-type="methods | materials"><title>Method and material</title><sec id="S11"><title>Data preparation</title><p id="P28">We collected 5 DDI benchmark datasets for evaluation. DrugBank dataset consists of 1706 drugs with 191808 drug pairs among 86 types of drug interactions. TwoSides dataset consists of 645 drugs with 63473 drug pairs among 1317 kinds of side effects. Different from the exclusive interactions of Drugbank dataset, side effects in TwoSides dataset are not exclusive, indicating that side effect prediction is a multi-label classification task. Two datasets from NDD<sup><xref ref-type="bibr" rid="R15">15</xref></sup> are collected. The first one, termed NDD_DS1, is composed of 548 drugs with 300304 drug pairs, in which 97168 pairs are positive and the rest are negative. The second one, termed NDD_DS2, consists of 707 drugs with 499849 drug pairs, in which 34412 pairs are positive. DDInter<sup><xref ref-type="bibr" rid="R49">49</xref></sup> dataset consists of 1493 drugs with 117608 drug pairs.</p><p id="P29">To generate a series of binary datasets from DrugBank with different positive-to-negative ratio, we considered all the pairs in the DrugBank dataset as positive samples. As for negative samples, we randomly selected drug pairs in the dataset and eliminated drug pairs that overlapped with positive samples and duplicated drug pairs. In this way, we constructed a series of binary classification datasets with positive-to-negative ratio of 1:1, 1:2, 1:4, 1:8 and 1:16.</p><p id="P30">We collected 3 DTI benchmark datasets for evaluation, including DAVIS, KIBA and BindingDB<sup><xref ref-type="bibr" rid="R50">50</xref></sup> dataset. Specifically, DAVIS dataset consists of 68 drugs and 316 proteins, which constructs 21488 drug-protein pairs. KIBA dataset consists of 2111 drugs and 185 proteins, which constructs 390535 drug-protein pairs. As for BindingDB dataset, it consists of 417893 drugs and 2076 proteins, which constructs 751808 drug-protein pairs.</p></sec><sec id="S12"><title>Model architecture</title><p id="P31">DeepDrug was composed of RGCN modules, CNN modules, and a combined prediction module. The structural information and sequencing of each drug or protein were fed to a RGCN module and a CNN module for feature extraction, respectively. The CNN module consisted of three one-dimensional convolutional layers with 32,64 and 96 kernels respectively, followed by a one-dimensional adaptive max-pooling layer and a linear layer to extract the sequence embeddings. The kernel sizes of the convolutional layers were 4, 6 and 8 for drugs and 4,8 and 12 for proteins, respectively. Note that the adaptive max-pooling layer is aimed at reducing each kernel features across the sequence dimension by maximum function. The RGCN module was capable of learning both node embeddings and edge embeddings simultaneously by graph convolutions. Additionally, layer normalization techinique<sup><xref ref-type="bibr" rid="R51">51</xref></sup> was used in node embedding layers for stabilizing the training process. The GCN module converted original node features (93 and 80 features for drug and protein respectively) to the 128-dimension features and also converted the original edge features (11 features for drug and 2 features for protein) to 128-dimension features. Borrowed from the success of deep residual network<sup><xref ref-type="bibr" rid="R52">52</xref></sup>, we applied convolutional residual blocks in the GCN module, which contained 22 residual blocks for DDI and 6 residual blocks for DTI. Taking the <italic>l</italic>-th graph convolutional residual block for an example, the node feature <italic><bold>H</bold><sup>l</sup></italic> and edge feature <italic><bold>E</bold><sup>l</sup></italic> were passed through layer-normalization layers, ReLU nonlinear layers and a graph convolutional layer to obtain the processed the residual node feature <inline-formula><mml:math id="M1"><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover></mml:mrow><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> and edge feature <inline-formula><mml:math id="M2"><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math></inline-formula> which was further added to the original input a shortcut as the final output of the graph convolutional residual block, which could be represented as <inline-formula><mml:math id="M3"><mml:msup><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover></mml:mrow><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="M4"><mml:msup><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math></inline-formula> Similar to ProteinSolver graph neural network <sup><xref ref-type="bibr" rid="R53">53</xref></sup>, the graph convolutional layer firstly updated edge features, i.e. <inline-formula><mml:math id="M5"><mml:msubsup><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and then updated node features with updated edge features, i.e. <inline-formula><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula> The <italic>ρ<sup><bold>l</bold></sup></italic>, ∅<sup><bold><italic>l</italic></bold></sup> are node and edge updating functions by aggregating the message from both node and edge in the <italic>l</italic>-th graph convolutional residual block. In our work, <bold><italic>ρ</italic></bold> was a two-layer perceptron with 256 and 128 nodes respectively, by taking the concatenation of node features and the corresponding edge features as input. The node was updated by function <inline-formula><mml:math id="M7"><mml:msup><mml:mi>ϕ</mml:mi><mml:mi mathvariant="bold-italic">l</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></inline-formula> where <italic>W<sup>l</sup></italic> was learnable parameter and <italic>ζ<sup>l</sup></italic> was the message aggregation function. In our work, we chose SoftMax aggregation function <sup><xref ref-type="bibr" rid="R52">52</xref></sup>.</p><p id="P32">The two RGCN or CNN modules had shared weights during DDI tasks and are independent for DTI tasks. The features extracted by these modules are concatenated together and fed to the combined prediction module, which consisted of two linear layers and a final prediction layer. The two linear layers had 128 and 32 nodes respectively, and each was followed by a batch normalization layer, a dropout layer and a ReLU nonlinear layer. The final prediction layer was a linear layer with an activation function, which was dependent on the tasks. Specifically, the Sigmoid activation function were used for binary classification task and multi-label classification task. The Softmax activation function was selected for multi-class classification task and none of activation function was used for regression task.</p><p id="P33">We used Adam optimizer with initial settings of a learning rate of 0.01, and a weight decay of 10<sup>-4</sup>. The dropout ratio was set to 0.1. Noticeably, we reduced learning rate by half when the loss metric on the validation dataset has stopped improving. Besides, we used Ray-project<sup><xref ref-type="bibr" rid="R54">54</xref></sup> for hyper-parameters searching, including the number of the graph convolutional residual blocks, the size of channels in the graph convolutional layer (see details in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 11</xref>).</p></sec><sec id="S13"><title>Baseline methods</title><p id="P34">To evaluate the performance of DeepDrug, we benchmarked DeepDrug on multiple datasets with a 5-fold stratified cross-validation strategy for DDI tasks and DTI tasks. For classification task, we benchmarked DeepDrug with multiple baseline methods, including DeepPurpose, DeepDDI, NDD, AttentionDDI, logical regression (LR) and random forest (RF). We have modified DeepDDI slightly to make it suitable for binary classification. Note that NDD and AttentionDDI are based on multiple similarity matrices, which is not able to calculate on others dataset since the source code is not released, we have not trained and evaluated their performance on other datasets except NDD_S1 and NDD_S2. DeepPurpose is a deep learning framework for DTI and DDI prediction. We used default setting of DeepPurpose for benchmarking, i.e., “CNN” embedding for drugs and targets in DDI and DTI tasks. We have also modified DeepPurpose slightly to make it suitable for multi-class/multi-label classification tasks. For drug-target interaction task, we benchmarked DeepDrug with RF, LR, MolTrans, CPI, TransformerCPI and DeepPurpose. Note that we didn’t evaluate MolTrans, LR, TransformerCPI on BindingDB dataset due to time limitation (within 48 hours). For drug-target affinity regression tasks, we benchmarked DeepDrug with DeepDTA, GraphDTA and DeepPurpose.</p></sec><sec id="S14"><title>Model evaluation</title><p id="P35">F1-score, auROC (area under receiver operation curve) and auPRC (area under precision-recall curve) are used for measuring the performance in classification task. Due to the unbalance of the datasets, macro F1-score and auPRC are the more suitable metrics. For multi-label and multi-class classification, we regarded the problems as multiple binary classification tasks and calculated auROC and auPRC individually and then averaged them as the final auROC and auPRC score.</p><p id="P36">As for metrics of regression task, we used serval metrics to evaluate the performance of affinity prediction, including R<sup>2</sup>, Pearson correlation, and concordance index.</p></sec><sec id="S15"><title>Data preprocessing</title><p id="P37">We used DeepChem<sup><xref ref-type="bibr" rid="R55">55</xref></sup> for drug feature calculation. Each drug is constructed with 11-dimension edge features and 93-dimension node features from SMILE strings, of which 91 features were calculated using DeepChem and the remaining two are the in-degree and out-degree of each node. As for graph feature of proteins, we firstly collected the PDB files of all proteins on the RCSB database. For each protein, we selected the longest crystal structure, i.e., the longest chain in the pdb file, as the 3D structure of the protein. Each protein is constructed with 80-dimensional node features, including amino acid features, and 2-dimension edge features (the distance of amino acids, and the angle of amino acids). Among the node features, 78 of them are calculated by PAIRPred software and the remaining two are the in-degree and out-degree of amino acids. We removed proteins without no 3D structure was found and the corresponding DTI pairs for DTI datasets.</p><p id="P38">For the DAVIS and BindingDB datasets, the binding affinity is measured by K<sub>d</sub> value (kinase dissociation constant), of which the range is too large. K<sub>d</sub> is transformed to logspace, i.e., pK<sub>d</sub>, using the formula as follows<sup><xref ref-type="bibr" rid="R17">17</xref></sup>: <disp-formula id="FD1"><mml:math id="M8"><mml:mi>p</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msup><mml:mn>10</mml:mn><mml:mn>9</mml:mn></mml:msup></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p></sec><sec id="S16"><title>Drug embedding interpretation</title><sec id="S17"><title>Drug Embedding of DrugBank DDI dataset</title><p id="P39">We firstly evaluated the drug embeddings on the DrugBank DDI dataset. For each drug in the dataset, the 128-dimension latent feature from drug feature extraction module of pretrained DeepDrug model is extracted. And then t-SNE was performed on these features for dimension reduction and Leiden algorithm<sup><xref ref-type="bibr" rid="R56">56</xref></sup> is used for clustering.</p><p id="P40">The clustering results were analyzed by silhouette score and Drug Category Enrichment Score (DCES). The silhouette score is used for evaluating the clustering results. To calculate the Drug Category enrichment, 4149 drug categories were firstly collected from the DrugBank website. We noted that a drug may have multiple categories. In a certain cluster, we calculated the precision, recall and thus F1-score for each drug category. We then regarded the drug category with highest F1-score as the assigned category of this cluster. We defined the DCES as the average of the F1-scores of all clusters. The silhouette score and DCES can be used as a criterion to judge whether the drug embedding is good or not.</p></sec><sec id="S18"><title>Drug Embedding of unseen drugs from DrugBank website</title><p id="P41">We collected a total of 11,172 drugs from the DrugBank website and removed drugs without any drug category, which results in 6587 drugs in total and only 1701 drugs were used for pre-training DeepDrug. Similar to above, the 128-dimension features of these 6587 drugs are extracted and dimension reduction and Leiden clustering are performed.</p><p id="P42">To calculate whether the DCES for this dataset is significant or not, we shuffled the drug categories for 1000 times and then calculated the DCES for each time, as disrupting the drug categories results in disrupting the embeddings of the drugs. We found that the mean and the standard deviation of DCES is 0.096 (+/- 0.004). Thus, the DCES of DeepDrug model is significantly better than the background distribution.</p></sec></sec><sec id="S19"><title>SARS-CoV-2 applications</title><sec id="S20"><title>Dataset</title><p id="P43">We collected two drug-target datasets for SARS-CoV-2 from a recent paper<sup><xref ref-type="bibr" rid="R46">46</xref></sup>, which provide a literature-based and an expert-confirmed list of drugs and target proteins for SARS-CoV-2 with 42 and 34 pairs respectively. To construct the corresponding negative samples, we randomly paired the proteins of SARS-CoV-2 and 11164 drugs from the DrugBank website. Two approaches are used for the graph features construction of SARS-Cov-2 proteins. Firstly, the simulation structures of SARS-Cov-2 proteins are provided in SARS-CoV-2 3D database<sup><xref ref-type="bibr" rid="R57">57</xref></sup>. Secondly, for each protein in the SARS-CoV-2, the most similar templates in the RCSB database are used as the crystal structure of the protein, which are also provided in the SARS-CoV-2 3D database<sup><xref ref-type="bibr" rid="R57">57</xref></sup>.</p></sec><sec id="S21"><title>Drug similarity and protein similarity</title><p id="P44">To measure the similarity of two drugs, topological fingerprints of two drugs are calculated respectively by rdkit.Chem.Fingerprints.FingerprintMols.FingerprintMol function with default settings, then drug similarity is determined by rdkit.DataStructs.FingerprintSimilarity function. To measure the similarity of SARS-CoV-2 and proteins in BindingDB dataset, we first calculated the pairwise sequence similarity via EMBOSS Needle package with default setting. The drug similarity for each drug in BindingDB dataset is defined as the maximum topological similarity between this drug to each SARS-Cov-2 interacting drugs. Similar to definition of drug similarity, the protein similarity for each protein in BindingDB dataset is defined as the maximum sequence similarity between this protein to each protein in SARS-CoV-2. The drug similarity threshold is set to 0.6, which results in the removal of 64,980 drugs (15.6%). The protein similarity threshold is set to 0.3, resulting in the removal of 124 proteins (6.0%). To sum up, 128045 pairs (17.0%) are removed from BindingDB dataset to build a stringent training dataset for SARS-CoV-2 potential drug prediction.</p></sec><sec id="S22"><title>Affinity prediction</title><p id="P45">We used the DeepDrug DTI models pretrained on the BindingDB dataset to predict the binding affinity of the drug-target pairs constructed above. Five-fold cross-validation pretrained model are used to make binding affinity predictions and final prediction for each pair is obtained by taking the mean and maximum values of the predictions for these 5 models.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Data</label><media xlink:href="EMS146588-supplement-Supplementary_Data.pdf" mimetype="application" mime-subtype="pdf" id="d33aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S23"><title>Acknowledgements</title><p>We acknowledge the funding from National Key Research and Development Program of China (Nos. 2018YFC0910404 and 2020YFA0712402); National Natural Science Foundation of China (Nos. 61873141, 61721003, 62003178].</p></ack><sec sec-type="data-availability" id="S24"><title>Code availability</title><p id="P46">DeepDrug is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/wanwenzeng/deepdrug">https://github.com/wanwenzeng/deepdrug</ext-link>.</p></sec><fn-group><fn id="FN1" fn-type="conflict"><p id="P47"><bold>Competing interests</bold></p><p id="P48">The authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bleakley</surname><given-names>K</given-names></name><name><surname>Yamanishi</surname><given-names>Y</given-names></name></person-group><article-title>Supervised prediction of drug-target interactions using bipartite local models</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2397</fpage><lpage>2403</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zitnik</surname><given-names>M</given-names></name><name><surname>Nguyen</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Leskovec</surname><given-names>J</given-names></name><name><surname>Goldenberg</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>MM</given-names></name></person-group><article-title>Machine Learning for Integrating Data in Biology and Medicine: Principles, Practice, and Opportunities</article-title><source>Inf Fusion</source><year>2019</year><volume>50</volume><fpage>71</fpage><lpage>91</lpage></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boolell</surname><given-names>M</given-names></name><etal/></person-group><article-title>Sildenafil: an orally active type 5 cyclic GMP-specific phosphodiesterase inhibitor for the treatment of penile erectile dysfunction</article-title><source>Int J Impot Res</source><year>1996</year><volume>8</volume><fpage>47</fpage><lpage>52</lpage></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>J</given-names></name><etal/></person-group><article-title>Mechanisms of drug combinations: interaction and network perspectives</article-title><source>Nat Rev Drug Discov</source><year>2009</year><volume>8</volume><fpage>111</fpage><lpage>128</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>K</given-names></name><name><surname>Jeng</surname><given-names>EE</given-names></name><name><surname>Hess</surname><given-names>GT</given-names></name><name><surname>Morgens</surname><given-names>DW</given-names></name><name><surname>Li</surname><given-names>A</given-names></name><name><surname>Bassik</surname><given-names>MC</given-names></name></person-group><article-title>Synergistic drug combinations for cancer identified in a CRISPR screen for pairwise genetic interactions</article-title><source>Nat Biotechnol</source><year>2017</year><volume>35</volume><fpage>463</fpage><lpage>474</lpage></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Combining genomic and network characteristics for extended capability in predicting synergistic drugs for cancer</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><elocation-id>8481</elocation-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazarou</surname><given-names>J</given-names></name><name><surname>Pomeranz</surname><given-names>BH</given-names></name><name><surname>Corey</surname><given-names>PN</given-names></name></person-group><article-title>Incidence of adverse drug reactions in hospitalized patients: a meta-analysis of prospective studies</article-title><source>JAMA</source><year>1998</year><volume>279</volume><fpage>1200</fpage><lpage>1205</lpage></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>PF</given-names></name><name><surname>Barry</surname><given-names>PJ</given-names></name><name><surname>Ryan</surname><given-names>C</given-names></name><name><surname>Hartigan</surname><given-names>I</given-names></name><name><surname>O’Mahony</surname><given-names>D</given-names></name></person-group><article-title>Inappropriate prescribing in an acutely ill population of elderly patients as determined by Beers’ Criteria</article-title><source>Age Ageing</source><year>2008</year><volume>37</volume><fpage>96</fpage><lpage>101</lpage></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meinertz</surname><given-names>T</given-names></name></person-group><article-title>Mibefradil—a drug which may enhance the propensity for the development of abnormal QT prolongation</article-title><source>European heart journal supplements</source><year>2001</year><volume>3</volume><fpage>K89</fpage><lpage>K92</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staffa</surname><given-names>JA</given-names></name><name><surname>Chang</surname><given-names>J</given-names></name><name><surname>Green</surname><given-names>L</given-names></name></person-group><article-title>Cerivastatin and reports of fatal rhabdomyolysis</article-title><source>N Engl J Med</source><year>2002</year><volume>346</volume><fpage>539</fpage><lpage>540</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wishart</surname><given-names>DS</given-names></name><etal/></person-group><article-title>DrugBank: a comprehensive resource for in silico drug discovery and exploration</article-title><source>Nucleic Acids Res</source><year>2006</year><volume>34</volume><fpage>D668</fpage><lpage>672</lpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatonetti</surname><given-names>NP</given-names></name><name><surname>Ye</surname><given-names>PP</given-names></name><name><surname>Daneshjou</surname><given-names>R</given-names></name><name><surname>Altman</surname><given-names>RB</given-names></name></person-group><article-title>Data-driven prediction of drug effects and interactions</article-title><source>Sci Transl Med</source><year>2012</year><volume>4</volume><elocation-id>125ra131</elocation-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burley</surname><given-names>SK</given-names></name><etal/></person-group><article-title>RCSB Protein Data Bank: biological macromolecular structures enabling research and education in fundamental biology, biomedicine, biotechnology and energy</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>D464</fpage><lpage>D474</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><etal/></person-group><article-title>PubChem 2019 update: improved access to chemical data</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><fpage>D1102</fpage><lpage>D1109</lpage></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohani</surname><given-names>N</given-names></name><name><surname>Eslahchi</surname><given-names>C</given-names></name></person-group><article-title>Drug-Drug Interaction Predicting by Neural Network Using Integrated Similarity</article-title><source>Sci Rep</source><year>2019</year><volume>9</volume><elocation-id>13645</elocation-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>JY</given-names></name><name><surname>Kim</surname><given-names>HU</given-names></name><name><surname>Lee</surname><given-names>SY</given-names></name></person-group><article-title>Deep learning improves prediction of drug-drug and drug-food interactions</article-title><source>Proc Natl Acad Sci U S A</source><year>2018</year><volume>115</volume><fpage>E4304</fpage><lpage>E4311</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozturk</surname><given-names>H</given-names></name><name><surname>Ozgur</surname><given-names>A</given-names></name><name><surname>Ozkirimli</surname><given-names>E</given-names></name></person-group><article-title>DeepDTA: deep drug-target binding affinity prediction</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>i821</fpage><lpage>i829</lpage></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><name><surname>Jiang</surname><given-names>R</given-names></name><name><surname>Zhou</surname><given-names>M</given-names></name></person-group><article-title>DeepCDR: a hybrid graph convolutional network for predicting cancer drug response</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>i911</fpage><lpage>i918</lpage></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Kurgan</surname><given-names>L</given-names></name></person-group><article-title>Survey of Similarity-Based Prediction of Drug-Protein Interactions</article-title><source>Curr Med Chem</source><year>2020</year><volume>27</volume><fpage>5856</fpage><lpage>5886</lpage></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamanishi</surname><given-names>Y</given-names></name><name><surname>Araki</surname><given-names>M</given-names></name><name><surname>Gutteridge</surname><given-names>A</given-names></name><name><surname>Honda</surname><given-names>W</given-names></name><name><surname>Kanehisa</surname><given-names>M</given-names></name></person-group><article-title>Prediction of drug-target interaction networks from the integration of chemical and genomic spaces</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>i232</fpage><lpage>240</lpage></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zitnik</surname><given-names>M</given-names></name><name><surname>Agrawal</surname><given-names>M</given-names></name><name><surname>Leskovec</surname><given-names>J</given-names></name></person-group><article-title>Modeling polypharmacy side effects with graph convolutional networks</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>i457</fpage><lpage>i466</lpage></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Leng</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name></person-group><article-title>Deep learning for drug-drug interaction extraction from the literature: a review</article-title><source>Brief Bioinform</source><year>2020</year><volume>21</volume><fpage>1609</fpage><lpage>1627</lpage></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bagherian</surname><given-names>M</given-names></name><name><surname>Sabeti</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Sartor</surname><given-names>MA</given-names></name><name><surname>Nikolovska-Coleska</surname><given-names>Z</given-names></name><name><surname>Najarian</surname><given-names>K</given-names></name></person-group><article-title>Machine learning approaches and databases for prediction of drug-target interaction: a survey paper</article-title><source>Brief Bioinform</source><year>2021</year><volume>22</volume><fpage>247</fpage><lpage>269</lpage></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>K</given-names></name><name><surname>Fu</surname><given-names>T</given-names></name><name><surname>Glass</surname><given-names>LM</given-names></name><name><surname>Zitnik</surname><given-names>M</given-names></name><name><surname>Xiao</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><article-title>DeepPurpose: A Deep Learning Library for Drug-Target Interaction Prediction</article-title><source>Bioinformatics</source><year>2020</year></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>Le</surname><given-names>H</given-names></name><name><surname>Quinn</surname><given-names>TP</given-names></name><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>Le</surname><given-names>TD</given-names></name><name><surname>Venkatesh</surname><given-names>S</given-names></name></person-group><article-title>GraphDTA: Predicting drug–target binding affinity with graph neural networks</article-title><source>bioRxiv</source><year>2020</year><elocation-id>684662</elocation-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bajusz</surname><given-names>D</given-names></name><name><surname>Racz</surname><given-names>A</given-names></name><name><surname>Heberger</surname><given-names>K</given-names></name></person-group><article-title>Why is Tanimoto index an appropriate choice for fingerprint-based similarity calculations?</article-title><source>J Cheminform</source><year>2015</year><volume>7</volume><fpage>20</fpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mousavian</surname><given-names>Z</given-names></name><name><surname>Masoudi-Nejad</surname><given-names>A</given-names></name></person-group><article-title>Drug-target interaction prediction via chemogenomic space: learning-based methods</article-title><source>Expert Opin Drug Metab Toxicol</source><year>2014</year><volume>10</volume><fpage>1273</fpage><lpage>1287</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A network integration approach for drug-target interaction prediction and computational drug repositioning from heterogeneous information</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><fpage>573</fpage></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kipf</surname><given-names>TN</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><article-title>Semi-supervised classification with graph convolutional networks</article-title><source>arXiv preprint</source><year>2016</year><elocation-id>arxiv:160902907</elocation-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veličković</surname><given-names>P</given-names></name><name><surname>Cucurull</surname><given-names>G</given-names></name><name><surname>Casanova</surname><given-names>A</given-names></name><name><surname>Romero</surname><given-names>A</given-names></name><name><surname>Lio</surname><given-names>P</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name></person-group><article-title>Graph attention networks</article-title><source>arXiv preprint</source><year>2017</year><elocation-id>arxiv:171010903</elocation-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Tarlow</surname><given-names>D</given-names></name><name><surname>Brockschmidt</surname><given-names>M</given-names></name><name><surname>Zemel</surname><given-names>R</given-names></name></person-group><article-title>Gated graph sequence neural networks</article-title><source>arXiv preprint</source><year>2015</year><elocation-id>arxiv:151105493</elocation-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bresson</surname><given-names>X</given-names></name><name><surname>Laurent</surname><given-names>T</given-names></name></person-group><article-title>Residual gated graph convnets</article-title><source>arXiv preprint</source><year>2017</year><elocation-id>arxiv:171107553</elocation-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Huang</surname><given-names>M</given-names></name><name><surname>Jiang</surname><given-names>T</given-names></name></person-group><article-title>Reinforced molecular optimization with neighborhood-controlled grammars</article-title><source>Advances in Neural Information Processing Systems</source><year>2020</year><volume>33</volume><fpage>8366</fpage><lpage>8377</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>K</given-names></name><etal/></person-group><article-title>Graph Convolutional Networks for Multi-modality Medical Imaging: Methods, Architectures, and Clinical Applications</article-title><source>arXiv preprint</source><year>2022</year><elocation-id>arxiv:220208916</elocation-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duvenaud</surname><given-names>DK</given-names></name><etal/></person-group><article-title>Convolutional networks on graphs for learning molecular fingerprints</article-title><source>Advances in neural information processing systems</source><year>2015</year><volume>28</volume></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fout</surname><given-names>A</given-names></name><name><surname>Byrd</surname><given-names>J</given-names></name><name><surname>Shariat</surname><given-names>B</given-names></name><name><surname>Ben-Hur</surname><given-names>A</given-names></name></person-group><article-title>Protein interface prediction using graph convolutional networks</article-title><source>Advances in neural information processing systems</source><year>2017</year><volume>30</volume></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>Q</given-names></name><name><surname>Dueva</surname><given-names>E</given-names></name><name><surname>Cherkasov</surname><given-names>A</given-names></name><name><surname>Ester</surname><given-names>M</given-names></name></person-group><article-title>Padme: A deep learning-based framework for drug-target interaction prediction</article-title><source>arXiv preprint</source><year>2018</year><elocation-id>arxiv:180709741</elocation-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zamora-Resendiz</surname><given-names>R</given-names></name><name><surname>Crivelli</surname><given-names>S</given-names></name></person-group><article-title>Structural learning of proteins using graph convolutional neural networks</article-title><source>bioRxiv</source><year>2019</year><elocation-id>610444</elocation-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minhas</surname><given-names>F</given-names></name><name><surname>Geiss</surname><given-names>BJ</given-names></name><name><surname>Ben-Hur</surname><given-names>A</given-names></name></person-group><article-title>PAIRpred: partner-specific prediction of interacting residues from sequence and structure</article-title><source>Proteins</source><year>2014</year><volume>82</volume><fpage>1142</fpage><lpage>1155</lpage></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname><given-names>K</given-names></name><name><surname>Allam</surname><given-names>A</given-names></name><name><surname>Gonzalez</surname><given-names>NAP</given-names></name><name><surname>Krauthammer</surname><given-names>M</given-names></name></person-group><article-title>AttentionDDI: Siamese Attention-based Deep Learning method for drug-drug interaction predictions</article-title><year>2020</year></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bansal</surname><given-names>M</given-names></name><etal/></person-group><article-title>A community computational challenge to predict the activity of pairs of compounds</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>1213</fpage><lpage>1222</lpage></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsubaki</surname><given-names>M</given-names></name><name><surname>Tomii</surname><given-names>K</given-names></name><name><surname>Sese</surname><given-names>J</given-names></name></person-group><article-title>Compound-protein interaction prediction with end-to-end learning of neural networks for graphs and sequences</article-title><source>Bioinformatics</source><year>2019</year><volume>35</volume><fpage>309</fpage><lpage>318</lpage></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>K</given-names></name><name><surname>Xiao</surname><given-names>C</given-names></name><name><surname>Glass</surname><given-names>LM</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><article-title>MolTrans: Molecular Interaction Transformer for drug-target interaction prediction</article-title><source>Bioinformatics</source><year>2021</year><volume>37</volume><fpage>830</fpage><lpage>836</lpage></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>L</given-names></name><etal/></person-group><article-title>TransformerCPI: improving compound-protein interaction prediction by sequence-based deep learning with self-attention mechanism and label reversal experiments</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><fpage>4406</fpage><lpage>4414</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrero-Zazo</surname><given-names>M</given-names></name><name><surname>Segura-Bedmar</surname><given-names>I</given-names></name><name><surname>Martinez</surname><given-names>P</given-names></name><name><surname>Declerck</surname><given-names>T</given-names></name></person-group><article-title>The DDI corpus: an annotated corpus with pharmacological substances and drug-drug interactions</article-title><source>J Biomed Inform</source><year>2013</year><volume>46</volume><fpage>914</fpage><lpage>920</lpage></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordon</surname><given-names>DE</given-names></name><etal/></person-group><article-title>A SARS-CoV-2-Human Protein-Protein Interaction Map Reveals Drug Targets and Potential Drug-Repurposing</article-title><source>bioRxiv</source><year>2020</year></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Surjit</surname><given-names>M</given-names></name><name><surname>Lal</surname><given-names>SK</given-names></name></person-group><article-title>The SARS-CoV nucleocapsid protein: a protein with multifarious activities</article-title><source>Infect Genet Evol</source><year>2008</year><volume>8</volume><fpage>397</fpage><lpage>405</lpage></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>K</given-names></name><name><surname>Kim</surname><given-names>HH</given-names></name><name><surname>Choi</surname><given-names>Y</given-names></name></person-group><article-title>Tiotropium is predicted to be a promising drug for COVID-19 through transcriptome-based comprehensive molecular pathway analysis</article-title><source>Viruses</source><year>2020</year><volume>12</volume><fpage>776</fpage></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiong</surname><given-names>G</given-names></name><etal/></person-group><article-title>DDInter: an online drug-drug interaction database towards improving clinical decision-making and patient safety</article-title><source>Nucleic Acids Res</source><year>2021</year></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilson</surname><given-names>MK</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Baitaluk</surname><given-names>M</given-names></name><name><surname>Nicola</surname><given-names>G</given-names></name><name><surname>Hwang</surname><given-names>L</given-names></name><name><surname>Chong</surname><given-names>J</given-names></name></person-group><article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title><source>Nucleic acids research</source><year>2016</year><volume>44</volume><fpage>D1045</fpage><lpage>D1053</lpage></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ba</surname><given-names>JL</given-names></name><name><surname>Kiros</surname><given-names>JR</given-names></name><name><surname>Hinton</surname><given-names>GE</given-names></name></person-group><source>Layer Normalization</source><year>2016</year></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Xiong</surname><given-names>C</given-names></name><name><surname>Thabet</surname><given-names>A</given-names></name><name><surname>Ghanem</surname><given-names>B</given-names></name></person-group><article-title>DeeperGCN: All You Need to Train Deeper GCNs</article-title><year>2020</year></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strokach</surname><given-names>A</given-names></name><name><surname>Becerra</surname><given-names>D</given-names></name><name><surname>Corbi-Verge</surname><given-names>C</given-names></name><name><surname>Perez-Riba</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>PM</given-names></name></person-group><article-title>Fast and Flexible Protein Design Using Deep Graph Neural Networks</article-title><source>Cell Syst</source><year>2020</year><volume>11</volume><fpage>402</fpage><lpage>411</lpage><elocation-id>e404</elocation-id></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Moritz</surname><given-names>P</given-names></name><etal/></person-group><source>Ray: A distributed framework for emerging {AI} applications</source><conf-name>13th {USENIX} Symposium on Operating Systems Design and Implementation ({OSDI} 18))</conf-name><year>2018</year></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ramsundar</surname><given-names>B</given-names></name><name><surname>Eastman</surname><given-names>P</given-names></name><name><surname>Walters</surname><given-names>P</given-names></name><name><surname>Pande</surname><given-names>V</given-names></name></person-group><source>Deep learning for the life sciences: applying deep learning to genomics, microscopy, drug discovery, and more</source><publisher-name>O’Reilly Media, Inc</publisher-name><year>2019</year></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>Van Eck</surname><given-names>NJ</given-names></name></person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title><source>Scientific reports</source><year>2019</year><volume>9</volume><fpage>1</fpage><lpage>12</lpage></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alsulami</surname><given-names>AF</given-names></name><etal/></person-group><article-title>SARS-CoV-2 3D database: understanding the coronavirus proteome and evaluating possible drug targets</article-title><source>Briefings in Bioinformatics</source><year>2021</year><volume>22</volume><fpage>769</fpage><lpage>780</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Model diagram of DeepDrug.</title><p>DeepDrug is a general interaction prediction platform for DDIs and DTIs prediction. For each drug, the atom features and edge features are extracted from the SMILE sequence. For each protein in the DTI task, the node features and edge features are extracted from the corresponding pdb file (see <xref ref-type="sec" rid="S10">Methods</xref>). A graph neural network module and a convolutional neural network (CNN) module are used for extracting features for drug and protein separately in the DTI task. For the DDI task, the weights in deep graph neural network are shared for a pair of drugs. The features extracted are concatenated and finally fed to a prediction module for various tasks, including interaction classification, affinity regression and drug repositioning.</p></caption><graphic xlink:href="EMS146588-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>Benchmark results for DeepDrug on the binary DDI tasks.</title><p>DeepDrug are benchmarked with 6 baselines on the 11 datasets in terms of F1 (A) and auPRC (B). Note that the performance scores of NDD and AttentionDDI are from the original paper and “—” indicates not applicable. The performance of DeepDrug and the best baseline method, DeepPurpose, on the unbalanced dataset are shown in (C) and (D). The x axis indicates the odds of positive to negative sample and the y axis indicates the F1 (C) and auPRC (D). Compared with DeepPurpose, DeepDrug is better to overcome the impact of unbalanced dataset. (E) DeepDrug is compared with every baseline on every dataset in terms of F1 (E) and auPRC (F). The x axis and the y axis of each dot indicate the performance of a certain baseline (indicated by dot color) and DeepDrug on a certain dataset (indicated by the dot shape).</p></caption><graphic xlink:href="EMS146588-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>Benchmark results for DeepDrug on the DTIs and DTIs tasks.</title><p>DeepDrug is benchmarked with 6 baselines on three datasets in terms of F1 (A), auROC (B) and auPRC (C) in the DTI tasks. DeepDrug is benchmarked with 3 baselines on the three datasets in terms of concordance index (D), Pearson correlation (E) and R2 (F) in the DTIs tasks.</p></caption><graphic xlink:href="EMS146588-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>Drug embeddings for DeepDrug.</title><p>(A) The t-SNE visualization for drug embeddings on the DrugBank dataset. The drug embeddings are extracted from the graph neural network module of DeepDrug. Drug embedding are then reduced dimension by t-SNE and clustered by Louvain algorithm. The enrichment of clusters with drug category are shown in (B). “Score” indicates the silhouette score of each cluster and “F1” indicates the F1-score of the cluster with best matching drug category (see <xref ref-type="sec" rid="S10">Methods</xref>). Clusters are ordered by silhouette scores. The chemical structures of drugs in the cluster 4 are demonstrated in (C), indicating drug embeddings extracted by DeepDrug are topological informative. (D) Venn plot indicates the enriched drug categories of DeepDrug in each cross-validation fold are highly overlapped.</p></caption><graphic xlink:href="EMS146588-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Drug repositioning for SARS-CoV-2.</title><p>The performance of DeepDrug to discriminate the potential drug-SARS-CoV-2 pairs (positive dataset, i.e., “pos.expert” and “pos.literature”) and random pairs of the same drugs and SARS-CoV-2 proteins (negative dataset, i.e., “neg.drugbank”). “pos.expert” and “pos.literature” indicate two potential drug-SARS-CoV-2 pairs examined by expert checking and literature discovering individually, suggested in (Gordon, D.E., Nature 2020). The performance of DeepDrug in each cross-validation fold is shown. “Mean” indicates the final affinity scores is averaged from the 5-fold predicted affinity scores and “Maximum” indicates the final affinity scores is the maximum affinity score across all the folds. For SARS-CoV-2 proteins, simulated three-dimension structures are used.</p></caption><graphic xlink:href="EMS146588-f005"/></fig></floats-group></article>