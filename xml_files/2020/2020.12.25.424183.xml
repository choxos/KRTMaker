<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="preprint">
<?all-math-mml yes?>
<?use-mml?>
<?origin ukpmcpa?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
<journal-title-group>
<journal-title>bioRxiv : the preprint server for biology</journal-title>
</journal-title-group>
<issn pub-type="ppub"/>
</journal-meta>
<article-meta>
<article-id pub-id-type="manuscript">EMS141055</article-id>
<article-id pub-id-type="doi">10.1101/2020.12.25.424183</article-id>
<article-id pub-id-type="archive">PPR257903</article-id>
<article-version article-version-type="publisher-id">2</article-version>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Evaluating performance of existing computational models in predicting CD8+ T cell pathogenic epitopes and cancer neoantigens</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Buckley</surname>
<given-names>Paul R.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Lee</surname>
<given-names>Chloe H.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ma</surname>
<given-names>Ruichong</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Woodhouse</surname>
<given-names>Isaac</given-names>
</name>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Woo</surname>
<given-names>Jeongmin</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tsvetkov</surname>
<given-names>Vasily O</given-names>
</name>
<xref ref-type="aff" rid="A4">5</xref>
<xref ref-type="aff" rid="A5">6</xref>
<xref ref-type="aff" rid="A6">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Shcherbinin</surname>
<given-names>Dmitrii S</given-names>
</name>
<xref ref-type="aff" rid="A4">5</xref>
<xref ref-type="aff" rid="A5">6</xref>
<xref ref-type="aff" rid="A6">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Antanaviciute</surname>
<given-names>Agne</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Shughay</surname>
<given-names>Mikhail</given-names>
</name>
<xref ref-type="aff" rid="A4">5</xref>
<xref ref-type="aff" rid="A5">6</xref>
<xref ref-type="aff" rid="A6">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rei</surname>
<given-names>Margarida</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Simmons</surname>
<given-names>Alison</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Koohy</surname>
<given-names>Hashem</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="aff" rid="A7">8</xref>
<xref ref-type="corresp" rid="CR1">+</xref>
</contrib>
</contrib-group>
<aff id="A1">
<label>1</label>MRC Human Immunology Unit, Medical Research Council (MRC) Human Immunology Unit, MRC Weatherall Institute of Molecular Medicine (WIMM), John Radcliffe Hospital, University of Oxford, Oxford, UK, Oxford, UK</aff>
<aff id="A2">
<label>2</label>MRC WIMM Centre for Computational Biology, Medical Research Council (MRC) Weatherall Institute of Molecular Medicine, John Radcliffe Hospital, University of Oxford, Oxford, United Kingdom</aff>
<aff id="A3">
<label>3</label>Department of Neurosurgery, Oxford University Hospitals NHS Foundation Trust, John Radcliffe Hospital, University of Oxford, Oxford, UK, Oxford, UK</aff>
<aff id="A4">
<label>5</label>Center of Life Sciences, Skoltech, Moscow, 143026, Russia</aff>
<aff id="A5">
<label>6</label>Department of Genomics of Adaptive Immunity, Shemyakin-Ovchinnikov Institute of Bioorganic Chemistry, Moscow, 117997, Russia</aff>
<aff id="A6">
<label>7</label>Institute of Translational Medicine, Pirogov Russian National Research Medical University, Moscow, 117997, Russia</aff>
<aff id="A7">
<label>8</label>Alan Turning Fellow</aff>
<author-notes>
<corresp id="CR1">
<label>+</label>Correspondence: <email>hashem.koohy@rdm.ox.ac.uk</email>
</corresp>
</author-notes>
<pub-date pub-type="nihms-submitted">
<day>07</day>
<month>02</month>
<year>2022</year>
</pub-date>
<pub-date pub-type="preprint">
<day>18</day>
<month>01</month>
<year>2022</year>
</pub-date>
<permissions>
<ali:free_to_read/>
<license>
<ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
<license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p>
</license>
</permissions>
<abstract>
<p id="P1">T cell recognition of a cognate peptide-MHC complex (pMHC) presented on the surface of infected or malignant cells, is of utmost importance for mediating robust and long-term immune responses. Accurate predictions of cognate pMHC targets for T Cell Receptors (TCR) would greatly facilitate identification of vaccine targets for both pathogenic diseases as well as personalized cancer immunotherapies. Predicting immunogenic peptides therefore has been at the centre of intensive research for the past decades but has proven challenging. Although numerous models have been proposed, performance of these models has not been systematically evaluated and their success rate in predicting epitopes in the context of human pathology, has not been measured and compared. In this study, we evaluated the performance of several publicly available models, in identifying immunogenic CD8+ T cell targets in the context of pathogens and cancers. We found that for predicting immunogenic peptides from an emerging virus such as SARS-CoV-2, none of the models perform substantially better than random or offer considerable improvement beyond HLA ligand prediction. We also observed suboptimal performance for predicting cancer neoantigens. Through investigation of potential factors associated with ill performance of models, we highlight several data- and model-associated issues. In particular, we observed that cross-HLA variation in the distribution of immunogenic and non-immunogenic peptides in training data of the models seem to substantially confound the predictions. We additionally compared key parameters associated with immunogenicity between pathogenic peptides and cancer neoantigens and observed evidence for differences in the thresholds of binding affinity and stability, which suggested the need to modulate different features in identifying immunogenic pathogen vs. cancer peptides. Overall, we demonstrate that accurate and reliable prediction of immunogenic CD8+ T cell targets remains unsolved, thus we hope our work will guide users and model developers regarding potential pitfalls and unsettled questions in existing immunogenicity predictors.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="S1" sec-type="intro">
<title>Introduction</title>
<p id="P2">The importance of being able to accurately predict CD8+ T cell targets i.e., immunogenic peptides, has never been clearer than during the ongoing COVID-19 pandemic era. It is also central in devising personalised vaccines for various cancers.</p>
<p id="P3">An efficient antigen-specific CD8+ T cell response to exogenous pathogens or endogenous threats relies on tightly regulated processing and presentation of antigenic peptides by class I Major Histocompatibility Complexes (MHC) and subsequent recognition of the peptide-MHC (pMHC) complex by cognate CD8+ T cells <sup>
<xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref>
</sup>. Therefore, immunogenic peptides encompass attributes associated to two sets of features known as peptide-presentation and TCR recognition features <sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup>. Among these, features attributed to MHC presentation have been shown to be more prominent compared to those attributed to TCR recognition. Examples include heavily conserved anchor positions and enriched motifs associated with distinct HLA types<sup>
<xref ref-type="bibr" rid="R4">4</xref>,<xref ref-type="bibr" rid="R5">5</xref>
</sup>. Indeed, recent cutting-edge models in predicting MHC presentation have shown impressive performance, exemplified by the widely used netMHCpan<sup>
<xref ref-type="bibr" rid="R6">6</xref>
</sup> and other recently published models<sup>
<xref ref-type="bibr" rid="R7">7</xref>
</sup>.</p>
<p id="P4">The recognition features of peptides on the other hand are highly degenerate due to promiscuity of TCRs imposed by positive and negative selection to avoid immune blind spots<sup>
<xref ref-type="bibr" rid="R8">8</xref>
</sup>. In addition to peptides’ sequence-based recognition features, numerous other factors such as co-stimulation, proliferation and cytotoxicity underpin immunogenicity<sup>
<xref ref-type="bibr" rid="R1">1</xref>
</sup>. These factors collectively define the magnitude and shape of a T cell response and determine whether the response is elicited <sup>
<xref ref-type="bibr" rid="R9">9</xref>
</sup>. Furthermore, nuances in various experimental assays evaluating T cell responses can produce noisy data, while the lack of a ‘true negative’ pool of peptides augments this complexity. Indeed, a ‘negative’ T cell assay only means a peptide failed to elicit a T cell response in a given experiment, perhaps due to the absence of a cognate T cell. This does not necessarily mean that a peptide is objectively non-immunogenic. Taken together, the identification of ‘immunogenic’ peptides has proven to be more challenging than identification of peptides presented by MHC molecules. Further challenges - e.g., limited numbers of known TCR-pMHC pairs - in identifying T cell antigens have recently been reviewed by Joglekar et al <sup>
<xref ref-type="bibr" rid="R10">10</xref>
</sup>.</p>
<p id="P5">Click or tap here to enter text.Click or tap here to enter text.Despite these challenges, over the past decade several models have been presented to predict immunogenic peptides, leveraging different correlates of immunogenicity with varying levels of success. As we recently detailed<sup>
<xref ref-type="bibr" rid="R8">8</xref>
</sup>, a number of these studies have utilised sequence-based characteristics including amino acid features<sup>
<xref ref-type="bibr" rid="R13">13</xref>–<xref ref-type="bibr" rid="R17">17</xref>
</sup>, similarity to viral peptides<sup>
<xref ref-type="bibr" rid="R18">18</xref>
</sup>, sequence dissimilarity to self <sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R19">19</xref>
</sup>, association between peptide immunogenicity and their biophysical properties such as their structural and energy features<sup>
<xref ref-type="bibr" rid="R20">20</xref>
</sup>, as well as TCR recognition features<sup>
<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R21">21</xref>
</sup>. Recently, Wells et al.<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> comprehensively investigated a collection of parameters associated with neoantigen immunogenicity, grouped into 1) presentation features e.g., binding affinity and stability, hydrophobicity and tumor abundance and 2) recognition features e.g., agretopicity (the ratio of binding affinity between a mutated peptide and its wild-type counterpart), and foreignness (similarity of peptide of interest to previously characterised viral epitopes).</p>
<p id="P6">Despite the strong HLA-restriction of peptide recognition by conventional T cells, with most immunogenicity models, presentation features have not been deconvoluted from more subtle T cell recognition features in this manner, which - due to the prominence of MHC features in sequence data - may lead to models primarily predicting HLA ligands rather than immunogenic peptides. More recently though, studies such as those by Wells et al.<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> and Schmidt et al.<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup> have shed light on this issue by disentangling features associated with presentation vs. those associated with T cell recognition <sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R22">22</xref>
</sup>.</p>
<p id="P7">In addition to the emerging consensus that predicting peptide immunogenicity involves deconvoluting MHC presentation and T cell recognition features, evidence is suggesting that different features will be required to predict immunogenicity of pathogenic epitopes vs. neoantigens, given fundamental differences in the mechanisms underpinning the respective T cell responses. Compared with pathogenic peptides, which are substantially different from the human proteome, neoantigens often exhibit only a single point mutation from the corresponding wild-type self-peptide<sup>
<xref ref-type="bibr" rid="R11">11</xref>
</sup>. This high sequence similarity between cancer neoantigens and self-peptides is likely subject to immune tolerance, thus focus has been placed on identifying features which permit neoepitopes to escape, which may be less applicable for pathogenic epitopes<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup>.</p>
<p id="P8">Indeed, Richman et al. <sup>
<xref ref-type="bibr" rid="R23">23</xref>
</sup> and Devlin et al.<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup> have shown that dissimilarity to the self-proteome permits neoepitopes to escape from immune tolerance. However, we have recently shown that dissimilarity to self is limited in distinguishing immunogenic peptides from pathogens<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup>, which indicate differences in the features required to predict immunogenic peptides from pathogens vs. cancer. Complicating matters further, existing models are primarily trained on pathogenic epitopes, some of which are used then to predict immunogenic neoantigens. Indeed, these important differences between pathogenic peptides and cancer neoantigens and their recognition by T cells indicate that separate features and training datasets would be required to reliably predict immunogenicity in these distinct settings.</p>
<p id="P9">Given this tapestry of complexity, it is unclear to what extent existing immunogenicity models can discriminate immunogenic peptides in human disease; although in mice, there is evidence that HLA ligand prediction alone may suffice in identifying such peptides. A recent study by Croft et al<sup>
<xref ref-type="bibr" rid="R25">25</xref>
</sup> in vaccinia-virus infected C57BL/6 mice found that the majority (&gt; 80%) of presented peptides by H-2D<sup>b</sup> or H-2D<sup>k</sup> are immunogenic, implying that HLA ligand predictors could be accurately used to identify immunogenic vaccinia-virus epitopes. This was evaluated in a recent study by Paul et al<sup>
<xref ref-type="bibr" rid="R26">26</xref>
</sup>., who benchmarked 17 models that are used primarily to predict antigen presentation. They showed each of these models can be used to predict immunogenic vaccina-virus peptides in mice at a relatively high level of confidence, albeit with some variation. They observed that netMHCpan v4.0 was the best performing model. However, we have recently observed that the fraction of presented peptides in humans which are immunogenic may be more variable (2.4% to 69% across different studies) than observed by Croft et al. in mice <sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup>. It is unclear how much of this variation is a species-specific effect, or perhaps due to differences between experimental assays. Taken together, the extent to which immunogenicity models as well as antigen presentation features, can predict peptide immunogenicity in the context of different human disease settings, are open questions.</p>
<p id="P10">Numerous models over the past decade have been offered to predict peptide immunogenicity. These immunogenicity models have certainly contributed to our understanding of mechanisms underpinning T cell recognition in human disease, however, a systematic and unbiased evaluation of the performance of these models is not yet available and would provide a framework to guide identification of T cell targets in different immunological settings <sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R20">20</xref>
</sup>.</p>
<p id="P11">In this study, we evaluated and compared the performance of several publicly available models in predicting immunogenicity in human pathology settings. Given the crucial differences in- and features of- underlying mechanisms that invoke a T cell response, we illustrated the performance of these models in predicting immunogenic pathogenic epitopes and cancer neoantigens separately. In both settings, we found suboptimal model performance and considerable room for improvement. Furthermore, we explored several potential problems underpinning the suboptimal performance of some of these models and more generally the complexity of predicting peptide immunogenicity. We thus present a framework by which investigators can decide which immunogenicity classifier is more applicable to their data and research questions in the context of human disease.</p>
</sec>
<sec id="S2" sec-type="results">
<title>Results</title>
<sec id="S3">
<title>Evaluating model performance in predicting peptide immunogenicity</title>
<p id="P12">To perform an unbiased evaluation of existing models in predicting immunogenic peptides, we identified 7 publicly available models (see Methods for criteria details), each of which aim to predict whether an MHC-presented peptide may invoke a T cell response (i.e., whether a peptide is <italic>immunogenic</italic>). These models are named as the <italic>IEDB model</italic>
<sup>
<xref ref-type="bibr" rid="R16">16</xref>
</sup>, <italic>NetTepi</italic>
<sup>
<xref ref-type="bibr" rid="R15">15</xref>
</sup>, <italic>iPred</italic>
<sup>
<xref ref-type="bibr" rid="R14">14</xref>
</sup>, <italic>Repitope</italic>
<sup>
<xref ref-type="bibr" rid="R27">27</xref>
</sup>, <italic>PRIME</italic>
<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup>, <italic>DeepImmuno</italic>
<sup>
<xref ref-type="bibr" rid="R17">17</xref>
</sup> and <italic>Gao</italic>
<sup>
<xref ref-type="bibr" rid="R28">28</xref>
</sup> (<xref ref-type="table" rid="T1">Table 1</xref>). Additionally, given the observation by Paul et al.<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup> that netMHCpan 4.0 most accurately identified immunogenic vaccinia-virus T cell epitopes in mice, we included both eluted ligand (labelled <italic>netMHCpan_EL</italic>) and binding affinity (labelled <italic>netMHCpan_BA</italic>) outputs from netMHCpan 4.0 to assess their accuracy in a human setting. We therefore evaluated the performance of 9 models. We undertook the performance evaluation separately for pathogenic and cancer epitopes, due to inherent differences in these immunological settings.</p>
<sec id="S4">
<title>Evaluating model performance in predicting immunogenic pathogenic peptides</title>
<p id="P13">The ongoing efforts to understand T cell responses against SARS-CoV-2 have provided the community with an unprecedented number of functionally evaluated SARS-CoV-2 peptides. A unique and valuable characteristic of this data megapool is that – with the exception of several peptides from other coronaviruses (e.g., MERS, SARS-CoV) which share homology with SARS-CoV-2 <sup>
<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref>
</sup> – many of these peptides have not been used in the training data of the models under investigation (<xref ref-type="supplementary-material" rid="SD1">Fig S1A</xref>) due to their recent identification. These peptides are therefore an ideal ‘test’ dataset for evaluating the performance of models in predicting immunogenic peptides from an emerging pathogen, enabling a benchmark of model performance in a realistic setting. Thus, we leveraged these data to shed light on the extent these models can be used to accurately identify immunogenic peptides upon the emergence of a novel pathogen.</p>
<p id="P14">To achieve this, we gathered all MHC class I SARS-CoV-2 peptides from the IEDB<sup>
<xref ref-type="bibr" rid="R32">32</xref>
</sup> with T cell response information and supplemented the dataset with further peptides from VIPR<sup>
<xref ref-type="bibr" rid="R33">33</xref>
</sup>. Next, we applied two filters (see Methods for full details): <list list-type="roman-upper" id="L1">
<list-item>
<p id="P15">Length filter: We limited ourselves only on 9- and 10-mers because a) these lengths are the most common amongst CD8+ T cell targets and as a result the most prevalent lengths of class I peptides in our SARS-CoV-2 test data, b) these were the only lengths for which all 9 models are applicable.</p>
</list-item>
<list-item>
<p id="P16">HLA filter: We limited ourselves on the 13 HLA alleles for which all models were applicable (see Methods).</p>
</list-item>
</list>
</p>
<p id="P17">Identical homologs from e.g., MERS and SARS-CoV were retained (see <xref ref-type="supplementary-material" rid="SD1">Fig S1A</xref>), as upon the emergence of SARS-CoV-2, these conserved peptides may already have existed in model training data, therefore providing a more realistic testing scenario. Application of these filters left 878 SARS-CoV-2 peptides, of which ~64% were immunogenic and ~36% non-immunogenic. For added clarity, we assessed model performance using both receiver operating characteristic area-under-the-curve (ROC-AUC), which is commonly used in machine-learning contexts, and precision-recall area-under-the-curve (PR-AUC), which summarises model precision and recall and more accurately represents the balance of classes within the testing dataset.</p>
<p id="P18">The ROC-AUCs obtained from this task ranged from 0.504 for <italic>DeepImmuno</italic> to 0.574 for <italic>Repitope</italic> (<xref ref-type="fig" rid="F1">Fig 1A</xref>), suggesting suboptimal performance for all models in identifying immunogenic epitopes from an emerging virus (<xref ref-type="supplementary-material" rid="SD1">Fig S1B</xref>, Supplementary Table 1). PR-AUCs ranged from 0.633 for <italic>DeepImmuno</italic> to 0.702 for <italic>Repitope</italic> (<xref ref-type="fig" rid="F1">Fig 1B</xref>), which - given the proportion of immunogenic peptides in the dataset (~64%) - suggests that select models may perform marginally better than random. Indeed, a follow-up bootstrap analysis (see Methods) revealed that the majority of models did not perform substantially better than the baseline using these data; although, with varying levels of significance, <italic>Repitope</italic> (ROC-AUC z-score = 4, PR=AUC z-score = 3.885) and the <italic>IEDB model</italic> (ROC-AUC z-score = 2.5, PR-AUC z-score = 2.659) did perform better than random (<xref ref-type="supplementary-material" rid="SD1">Fig S1C-D</xref>, Supplementary Table 2-3).</p>
<p id="P19">Taken together, neither the assessed HLA ligand predictors nor models specifically designed to predict immunogenicity, could reliably identify immunogenic peptides from an emerging pathogen. Thus, these data indicate that HLA ligand prediction is not sufficient to predict immunogenic epitopes from an emerging pathogen, suggesting that while presentation may be necessary it is not sufficient for T cell immunogenicity. Additionally, this analysis illustrates that current models which have been designed to incorporate further features which describe T cell recognition of pMHCI complexes, do not appear to outperform peptide presentation predictions in this setting. These insights therefore reveal a gap for an immunogenicity predictor to help extract immunogenic peptides from the pool of presented pathogenic peptides.</p>
</sec>
<sec id="S5">
<title>Evaluating model performance in predicting immunogenic cancer neoantigens</title>
<p id="P20">One key application for immunogenicity classifiers is to identify immunogenic cancer neoantigens that can activate CD8+ T cells for potential use as vaccine targets for personalised cancer immunotherapies<sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R34">34</xref>
</sup>. Identifying immunogenic neoantigens is a ‘needle in a haystack’ problem, where one aims to find extremely small numbers of ‘positives’, from substantially imbalanced datasets. Indeed, multiple studies have observed that amongst predicted candidate cancer neoantigen datasets, validated <italic>immunogenic</italic> neoantigens comprise ~6% <sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R35">35</xref>
</sup>, suggesting high false positive rates amongst current identification pipelines. Nevertheless, in this scenario, the ability of models to accurately identify small numbers of positives is paramount.</p>
<p id="P21">For highly imbalanced classification, ROC-AUC can be misleading as this metric can underrepresent the minority class<sup>
<xref ref-type="bibr" rid="R36">36</xref>
</sup>. Thus, we diagnosed model performance in predicting immunogenic cancer neoantigens using PR-AUC <sup>
<xref ref-type="bibr" rid="R36">36</xref>
</sup>. We employed two independent cancer neoantigen datasets, both of which are intrinsically imbalanced: 1) our in-house glioblastoma (<italic>GBM) dataset</italic> and 2) a set of peptides gathered from the Tumor Neoantigen Selection Alliance (TESLA) consortium<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> (see Methods for details on both datasets). For this cancer neoantigen setting, we have additionally evaluated the model ‘<italic>DeepHLApan</italic>,<sup>
<xref ref-type="bibr" rid="R37">37</xref>
</sup>, which is an immunogenicity predictor designed to identify cancer neoantigens.</p>
<p id="P22">Our <italic>GBM</italic> dataset comprises peptides which bind HLA-A*02:01 from glioblastoma cancer patients. We excluded any peptides observed in any model’s training data. The resulting dataset comprised peptides of lengths 9 and 10 (n=123), containing 25 (20%) confirmed immunogenic neoantigens. After testing these models against the <italic>GBM</italic> dataset, we observed suboptimal PR-AUCs, ranging from 0.20 for <italic>DeepImmuno</italic> to 0.437 for <italic>iPred</italic> (<xref ref-type="fig" rid="F1">Fig 1C</xref>, Supplementary Table 4). With the exception of <italic>DeepHLApan</italic> which is hampered by false negatives, we observed a considerable number of false positives for each model (<xref ref-type="supplementary-material" rid="SD2">Fig S2A</xref>). Interestingly, <italic>netMHCpan_BA, netMHCpan_EL</italic> and <italic>PRIME</italic> identified the highest number (19, 18, 18 respectively) of the total 25 confirmed neoantigens (<xref ref-type="supplementary-material" rid="SD2">Fig S2A</xref>).</p>
<p id="P23">A bootstrap analysis revealed that despite suboptimal overall performance, the majority of models perform better than random (<xref ref-type="supplementary-material" rid="SD2">Fig S2B</xref>, Supplementary Table 5). For example, Z-scores evaluating deviation of the true PR-AUCs from a distribution of those achieved by random predictions demonstrate that <italic>netMHCpan_BA</italic> (z=5.2) possessed the most predictive power against this GBM dataset, followed by <italic>iPred</italic> (z=5.03) and <italic>NetTepi</italic> (z=4.38).</p>
<p id="P24">Next, we tested models against the publicly available ‘TESLA’ dataset. This dataset originally comprises cancer peptides amongst 13 class I alleles, of which we retained peptides experimentally tested against alleles for which all models are applicable, leaving peptides from 7 HLAs. Additionally, we excluded any peptides observed in any model’s training data. These filters resulted in 27 (~6.7%) immunogenic and 372 (~93%) non-immunogenic peptides of lengths 9 and 10.</p>
<p id="P25">We again observed suboptimal PR-AUC scores for each model, ranging from 0.051 for <italic>Repitope</italic> to 0.211 for <italic>Gao</italic> (<xref ref-type="fig" rid="F1">Fig 1D</xref>, <xref ref-type="supplementary-material" rid="SD3">Fig S3A</xref>, Supplementary Table 6). After assessing predictive power as described previously, we observed that <italic>Gao</italic> (z=6.65), <italic>netMHCpan_EL</italic> (z=6.2), <italic>NetTepi</italic> (z=4.88), <italic>PRIME</italic> (z=4.55) and <italic>netMHCpan_BA</italic> (z=4.53) each performed better than random (<xref ref-type="supplementary-material" rid="SD3">Fig S3B</xref>, Supplementary Table 7). <italic>Gao</italic> utilises dissimilarity to self and similarity to viral peptides to compute immunogenicity of a peptide, which are features identified by Wells et al. as important in discriminating immunogenic neoantigens in the context of the TESLA dataset, which may explain <italic>Gao’s</italic> higher performance here compared with the previous scenarios. <italic>PRIME</italic> identified the highest number of TESLA neoantigens (26/27) followed by <italic>netMHCpan_EL</italic> which identified (22/27). Here, we observed high numbers of false positives for all models, including <italic>DeepHLApan</italic> (<xref ref-type="supplementary-material" rid="SD3">Fig S3A</xref>).</p>
<p id="P26">Overall, these data highlight the complexity of predicting cancer neoantigens. Despite contribution of these models to fostering our understanding of T cell recognition of neoantigens, these analyses additionally illustrate there exists considerable room for improvement in accurately identifying immunogenic neoantigens. It is of note that for most models, their performance is hampered by a considerable false positive rate, that contributes to low precision. It is also important to note that although in some medical settings, high false positive and low false negative rate is preferred, the ultimate aim of an immunogenicity classifier model is to achieve an optimal performance by balancing between false positive and false negative rates. Otherwise, models such as netMHCpan capable of accurate prediction of peptide processing and presentation for CD8+ T cells, would be sufficient to identify a target pool for further functional validation, as each <italic>immunogenic</italic> class I peptide should be presented. In this regard, the only model that exhibits a notable overall performance improvement compared with <italic>netMHCpan</italic> is the <italic>Gao</italic> predictor, although this was only observed against the TESLA dataset. We also observed cross-data inconsistency in performance of these models in predicting cancer neoantigens. Taken together, these results suggest that an avenue for improving the performance of these models beyond what can be achieved by HLA ligand predictors, is through improving the precision of these models to consistently identify the proportion of HLA ligands capable of invoking a T cell response.</p>
<p id="P27">In summary, we have illustrated suboptimal performance of existing models in predicting targets for T cell responses for both emerging pathogens and cancers. In what follows we therefore explore a few potential features contributing to difficulties of predicting T cell target peptides.</p>
</sec>
</sec>
<sec id="S6">
<title>Exploring potential underlying issues with model performances</title>
<p id="P28">Here, we aim to shed light on issues and inconsistencies in model performances, which we hope can guide avenues of research for future immunogenicity predictors. First, given differences in model performances across the previously examined scenarios, we explore differences in underlying features associated with immunogenicity between pathogenic vs. cancer settings, as well as potential reasons for contrasting performances within cancer settings. Secondly, due to HLA imbalances in training datasets and the low precision of the models, combined with their limited capacity to extend the performance achieved by HLA ligand predictor <italic>netMHCpan</italic>, we explore the extent to which these models may primarily predict antigen presentation.</p>
<sec id="S7">
<title>Differences in discriminative features associated with immunogenicity for pathogenic vs. cancer peptides</title>
<p id="P29">Despite broad application of these models in predicting peptide targets for CD8+ T cell responses in both cancer and infection settings, there is no systematic comparative analysis of features associated to cancer vs. pathogenic peptide immunogenicity<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup>. As discussed above in identifying immunogenic peptides in these two settings, we noticed inconsistent performances between cancer vs. pathogenic scenarios as well as <italic>within</italic> cancer settings. For example, the <italic>Gao</italic> model was superior against one of two cancer datasets, but performed poorly against pathogenic epitopes. These inconsistencies suggest potential differences in parameters leading to pathogenic vs. cancer neoantigen immunogenicity, which may translate into differences in the features required to discriminate immunogenicity in these two settings. We reasoned that such differences may contribute to the observed inconsistencies in model performances.</p>
<p id="P30">As mentioned, Richman et al.<sup>
<xref ref-type="bibr" rid="R23">23</xref>
</sup> and Devlin et al.<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup> demonstrated that dissimilarity of a peptide to the self-proteome is associated with <italic>neoantigen</italic> immunogenicity. However, our recent work<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup> has demonstrated that dissimilarity to self is limited in discriminating immunogenic pathogenic peptides, suggesting that different features may be required to identify immunogenic peptides in pathogen vs cancer settings. Furthermore, given the wider availability of pathogenic compared with neoepitope datasets, immunogenicity predictors are often trained primarily on the former, which may further convolute predicting neoantigen immunogenicity.</p>
<p id="P31">For these reasons, we sought to investigate whether the observed variability in performances between pathogenic vs. cancer settings, may stem from differences in features attributed to immunogenicity. As discussed previously, Wells et al.<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> comprehensively interrogated features associated with neoantigen immunogenicity, defining those related to antigen-presentation, or those related to T cell recognition. We therefore compared the capacity of these features previously associated with neoantigen immunogenicity, to discriminate immunogenic and non-immunogenic pathogenic peptides.</p>
<p id="P32">We first gathered class I associated pathogenic peptides from the IEDB (‘pathogenic’ dataset, see Methods), as well as the neoepitopes from Wells et al.<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> (TESLA ‘cancer’ dataset). For this analysis we employed the entire TESLA dataset, comprising 608 peptides, of which ~6% were immunogenic and ~94% were non-immunogenic. The curated ‘pathogenic’ dataset consisted of 22,717 peptides in total, of which ~25% were immunogenic and ~75% were non-immunogenic. We then compared differences in the following presentation features: binding affinity and stability and the fraction of hydrophobic amino acids; the remaining features - agretopicity, foreignness and tumor abundance – are less applicable for pathogenic peptides.</p>
<p id="P33">We observed that cancer peptides may exhibit stronger MHC binding affinities than their pathogenic counterparts (<xref ref-type="fig" rid="F2">Fig 2A-i</xref>). Indeed, for both non-immunogenic and immunogenic groups, cancer peptides possessed significantly stronger binding affinities compared with pathogenic peptides (2A-ii). By comparing binding affinities between immunogenicity status, we observed that immunogenic pathogenic peptides had stronger binding affinities than non-immunogenic pathogen peptides, which was consistent with Wells’ observations for cancer peptides (2A-iii). Interestingly, the median binding affinity for <italic>non-immunogenic</italic> cancer peptides is similar to that of <italic>immunogenic</italic> pathogen peptides (2A-iii), in particular beyond ~100nM (2A-IV), suggesting that thresholds learnt from training data to discriminate immunogenicity may need to be tailored to pathogen or cancer settings. It is also important to note that, with the exception of HLA-C*07:02 (possibly due to limited numbers of peptides for this HLA), this trend was observed across a set of common HLAs (<xref ref-type="supplementary-material" rid="SD4">Fig S4A</xref>).</p>
<p id="P34">For MHC binding stability, the trends were consistent with those of binding affinity. First, cancer peptides exhibited greater stability compared to their pathogenic counterparts (<xref ref-type="fig" rid="F2">Fig 2Bi - 2Bii</xref>). Similar to previous observations with binding affinity, we observed that while predicted binding stability can discriminate immunogenic and non-immunogenic pathogen peptides, the distributions of <italic>non-immunogenic</italic> cancer peptide stabilities are more comparable to those of <italic>immunogenic</italic> pathogenic peptide binding stabilities (<xref ref-type="fig" rid="F2">Fig 2B-iii and Fig 2B-IV</xref>). These data provided further evidence that employment of the same thresholds or weights for MHC binding affinity or stability features, to discriminate immunogenic peptides in both pathogen and cancer settings, is likely to be ineffective. These observations of stronger binding affinities and more stable binding for cancer peptides may be due to facets of neoantigen identification pipelines, where one screens for high antigen presentation metrics to increase the likelihood of selecting better neoantigen candidates. This pre-selection for high presentation metrics may in turn contribute to skews in the datasets available for inference of MHC binding thresholds in discriminating immunogenic neoantigens.</p>
<p id="P35">As it comes to the ‘fraction of hydrophobicity’, we found it interesting that immunogenic pathogen peptides were more hydrophobic than their cancer counterparts (<xref ref-type="fig" rid="F2">Fig 2C-i</xref>). Furthermore, this feature can discriminate immunogenic and non-immunogenic peptides in both pathogenic and cancer settings (<xref ref-type="fig" rid="F2">Fig 2C-ii</xref>), although for pathogens there is a stronger trend, and in the reverse direction compared with cancer peptides. We additionally observed peaks around certain proportions for pathogenic peptides, and smoother distributions for their cancer counterparts (<xref ref-type="fig" rid="F2">Fig 2C-iii</xref>). This is perhaps due to differences in the distributions of lengths between settings, where e.g., 65% of peptides are 9mers compared with 50% in cancer.</p>
<p id="P36">Next, as certain HLAs possess preferences for hydrophobic residues, we explored the capacity of this feature to discriminate immunogenic pathogen peptides across a set of common HLAs. Here, we observed variability in discriminating immunogenic peptides, suggesting this feature may need to be considered in an HLA-specific manner (<xref ref-type="supplementary-material" rid="SD4">Fig S4C</xref>). While these data suggest there is perhaps more weight for this feature in identifying immunogenic pathogen peptides vs. cancer – albeit in the reverse direction – further work is required to determine whether this is a biological characteristic or a technical artefact.</p>
<p id="P37">Inconsistencies in performances were also observed after testing the models against two independent cancer datasets. We therefore sought to examine whether immunogenicity parameters are likely to be linked to these inconsistencies. Consistent with the results comparing pathogens vs. cancer, we observed that binding affinity (<xref ref-type="fig" rid="F2">Fig 2D-i, -ii, -iii</xref>), binding stability and fraction of hydrophobicity (<xref ref-type="supplementary-material" rid="SD4">Fig S4D</xref>) can discriminate immunogenicity with both cancer datasets (GBM and TESLA), while the thresholds required to discriminate immunogenicity are again likely to be different between the datasets. We were unable to explore the ‘recognition’ features associated with neoantigen immunogenicity as proposed by Wells, as our GBM dataset does not have tumor abundance information, which is a pre-requisite for the application of Wells’ recognition features. This task suggests that a fixed set of parameters may not be universal to all cancer datasets and that user input regarding the appropriate set of parameters, as well as interpretation of results, will be crucial in identifying immunogenic cancer neoantigens.</p>
<p id="P38">Overall, we have observed evidence for differences in the thresholds required for features to discriminate peptide immunogenicity in pathogens vs. cancer. Our observations indicate that a separate examination of presentation features and their weights in association with pathogen or cancer peptide immunogenicity is warranted. Furthermore, immunogenicity models are often trained primarily on pathogenic peptides. Therefore, as the distributions of binding affinities and/or stabilities for <italic>immunogenic</italic> pathogen peptides and <italic>non-immunogenic</italic> cancer peptides are comparable, this may in-part contribute to the substantial numbers of false positives generated by the models in identifying immunogenic cancer neoantigens, as well as inconsistencies in model performances between these immunological settings.</p>
</sec>
<sec id="S8">
<title>The effects of cross-HLA variation on predicting peptide immunogenicity</title>
<p id="P39">By exploring per HLA distributions of immunogenic and non-immunogenic peptides in the training data of these immunogenicity models, we observed substantial cross-HLA variation. Examples of these can be observed in <italic>Repitope</italic> (<xref ref-type="supplementary-material" rid="SD5">Fig S5A</xref>), the <italic>IEDB model</italic> (<xref ref-type="supplementary-material" rid="SD5">Fig S5B-C</xref>), and <italic>iPred</italic> (<xref ref-type="supplementary-material" rid="SD5">Fig S5D</xref>), where per HLA differences in numbers of positive (immunogenic) and negative (non-immunogenic) peptides are apparent. In fact, for <italic>iPred</italic> we observed that immunogenic peptides dominate the HLA-A supertype, whereas non-immunogenic peptides dominate HLA-B presented peptides in the training data (<xref ref-type="supplementary-material" rid="SD5">Fig S5D</xref>). As a result, HLA-A presenting peptides are more likely to receive a higher immunogenicity score from this model, regardless of their true immunogenicity status (<xref ref-type="supplementary-material" rid="SD5">Fig S5E</xref>).</p>
<p id="P40">We therefore sought to evaluate whether cross-HLA imbalances in immunogenic and non-immunogenic peptides may have contributed to suboptimal performances of some of the models. We hypothesised that without explicitly deconvoluting antigen-presentation features from TCR recognition propensity, training these models on HLA imbalanced datasets may lead to skewed predictions associated to HLA. This may in turn lead to predictions primarily of antigen presentation - due to more prominent MHC features <sup>
<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R7">7</xref>
</sup> - rather than reflecting both peptide presentation and subsequent TCR recognition. We therefore aimed to explore whether the immunogenicity models (i.e., excluding HLA ligand predictors) exhibit skewed prediction scores toward dominant HLAs, and whether models thus predict prominent HLA types.</p>
<p id="P41">We first examined the distributions of the 10 (for consistency among models) most dominant HLAs in each model’s training data. We observed large skews toward and amongst HLA-A*02:01 for all models (<xref ref-type="fig" rid="F3">Fig 3A</xref>). Indeed, by grouping peptides in each model’s training data by whether they bind HLA-A*02:01 (hereby A*02:01+) or not (A*02:01-), we observed considerable differences in the frequency of immunogenicity status per model training data (<xref ref-type="fig" rid="F3">Fig 3B</xref>). We observed that with the exception of <italic>IEDB</italic> and <italic>NetTepi,</italic> non-immunogenic peptides dominate the A*02:01- group, meaning that non-immunogenic peptides are primarily presented by HLAs other than HLA-A*02:01 in model training data. It is plausible that this skewed distribution of prominent HLA features associated to immunogenicity status may lead to predictions skewed by HLA type.</p>
<p id="P42">We therefore hypothesised that these models may recognise prominent sequence features amongst HLA-A*02:01-binding peptides in test datasets, leading to inappropriately skewed model predictions. Therefore, we gathered the immunogenicity prediction scores generated by each model after evaluating their performance against our SARS-CoV-2 9- and 10-mer peptide dataset and grouped scores by whether the peptide is immunogenic or not, and whether it binds HLA-A*02:01 or not. First, for many examined models, we did not observe significant differences in immunogenicity scores between immunogenic and non-immunogenic peptides which bind HLA-A*02:01 (<xref ref-type="fig" rid="F3">Fig 3C</xref>) (labelled A02:01+ Pve and A02:01+ Nve respectively). Furthermore, we found that <italic>Repitope</italic> (cohens-d=0.454), <italic>DeepImmuno</italic> (cohens-d=0.347), <italic>NetTepi</italic> (cohens-d=0.338), and to some extent <italic>iPred</italic> (cohens-d=0.206) predict <italic>non-immunogenic</italic> peptides that bind HLA-A*02:01 with higher scores than <italic>immunogenic</italic> peptides that bind remaining alleles; where on the contrary <italic>immunogenic</italic> peptides are expected to be predicted with higher immunogenicity scores. This analysis suggests that these models recognise dominant skewed HLA features associated with immunogenicity imbalances, which inappropriately skews model prediction scores, regardless of the true immunogenicity status of the peptide.</p>
<p id="P43">We next sought to analyse the extent to which these models detect peptide features associated with antigen presentation as opposed to T cell recognition. Here, we utilised prediction scores generated during the SARS-CoV-2 pathogenic epitopes analysis to instead predict whether a peptide engages HLA-A*02:01 or not (<xref ref-type="fig" rid="F3">Fig 3D</xref>). Remarkably, we observed higher performance here for all models, compared with when tasked with predicting SARS-CoV-2 peptide <italic>immunogenicity</italic> (<xref ref-type="fig" rid="F3">Fig 3D</xref> vs. <xref ref-type="fig" rid="F1">Fig 1A</xref>), implying that for peptides from an emerging virus, all assessed immunogenicity predictors more capably predict dominant HLA features than T cell immunogenicity.</p>
<p id="P44">Overall, our data suggests that cross-HLA variation in the distribution of positive and negative peptides in model training data is highly likely to affect the peptide immunogenicity prediction, in a sense that some of these models in their existing settings predict HLA type more accurately than peptide immunogenicity. This insight suggests that suboptimal performance of these models is partly due to data limitations. Furthermore, our data suggest that future training datasets composed of more balanced immunogenic and non-immunogenic peptides for various HLA (or at least the common class I HLAs) are required for more accurate immunogenicity predictions. However, our work indicates that in the absence of such comprehensive datasets, the modelling strategies should consider how information extracted from HLA imbalances in training data affect model predictions and that future immunogenicity models should carefully model HLA restriction of T cell recognition.</p>
</sec>
</sec>
</sec>
<sec id="S9" sec-type="discussion">
<title>Discussion</title>
<p id="P45">In this study, we have demonstrated that despite great efforts, there is room for improvement to achieve accurate and reliable predictions of CD8+ T cells targets for an emerging virus such as SARS-CoV-2, or for a tumor of interest for the purpose of developing personalized (or stratified) treatments. We have additionally highlighted several issues underpinning suboptimal performances of these models with the hope of a) making potential users aware of these issues and guiding them towards strategies for use of an appropriate model for their tasks, and b) pointing future model developers to standing issues for further advancements and improvements.</p>
<p id="P46">For predicting CD8+ T cell targets for an emerging virus, these models do not seem to offer much improvement beyond MHC binding or presentation scores generated by models which predict HLA binding status such as <italic>netMHCpan,</italic> i.e., they may not offer much help extracting peptides that will trigger T cell response from the pool of presented peptides. Accurate and reliable prediction of CD8+ T cell targets would assist with several burning challenges, e.g., inference of escape mutations and/or the effects of mutations in CD8+ T cells targets on their immunogenicity.</p>
<p id="P47">For predicting immunogenic cancer neoantigens, we again illustrated that the assessed models only marginally outperform <italic>netMHCpan</italic>. <italic>PRIME</italic> and <italic>NetTepi</italic> were able to identify a high proportion of immunogenic neoantigens (high Recall), albeit at the expense of many false positives (low precision). Indeed, in most cases in this setting, the models produced many false positives. As immunogenic class I peptides must be presented by MHC, HLA ligand prediction with 100% accuracy could theoretically include 100% of immunogenic peptides (high recall), albeit with a high proportion of false positives (low precision) from those presented peptides which are not immunogenic. This concept is consistent with most observed model performances, and perhaps may in-part explain low precision observed with these models, as multiple predictors incorporate -and barely extend performance of- antigen presentation predictions.</p>
<p id="P48">Consensus is indeed emerging that presentation of a mutated peptide is insufficient for neoantigen immunogenicity <sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R35">35</xref>
</sup>. Our findings are consistent with this concept and indicate that additional features are required to consistently discriminate HLA ligands which can or cannot invoke T cell responses. Recently, the work of Wells et al. has provided a paradigm for such an approach. Consistent with Wells et al., our work suggests that parameters associated with neoantigen immunogenicity may require calibration for individual use cases. Further factors, e.g., differences between cancers, technical variations between experiments, and inherent human variation, are likely to compound this complexity.</p>
<p id="P49">Several recent studies have investigated some additional parameters associated with peptide immunogenicity that were not covered in the models that we have evaluated<sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R11">11</xref>,<xref ref-type="bibr" rid="R20">20</xref>
</sup>. Riley et al.<sup>
<xref ref-type="bibr" rid="R20">20</xref>
</sup> presented a structure-based approach, reporting increased performance against other models including the <italic>IEDB model</italic> and <italic>NetTepi.</italic> Despite this success, the authors suggest improvements to their model are necessary before wide adoption of their methodology. To our knowledge, their predictor is not yet publicly available, thus we were not able to evaluate its performance in the present study. Capietto et al. <sup>
<xref ref-type="bibr" rid="R11">11</xref>
</sup> recently supplied a framework for how mutation position contributes to neoantigen immunogenicity and proposed that the suboptimal landscape of neoantigen prediction, stems from a limited number of available tools which capture a variety of features associated with neoantigen immunogenicity. Indeed, future work should seek to examine the full spectrum of available parameters associated with neoantigen immunogenicity.</p>
<p id="P50">By investigating several potential factors contributing to suboptimal performance of these models in identification of immunogenic viral or cancer peptides, our work pointed towards both data- and model-associated issues. Data-associated issues include, i) small sample numbers especially for uncommon HLAs, an issue which is compounded for neoantigens, ii) cross-HLA imbalances of positive and negative peptides and iii) lack of true non-immunogenic peptides available in training datasets. Furthermore, the immunogenicity of a peptide is determined using different functional T cell response assays, which adds further noise to the data. With regard to cross-HLA imbalances, our findings suggest that skews in the distributions of immunogenic and non-immunogenic peptides per HLA in model training data may introduce bias into predictions. This observation is supported by Bassani-Sternberg et al<sup>
<xref ref-type="bibr" rid="R7">7</xref>
</sup>, where they showed that sequence similarity (i.e., HLA-I binding motifs) could effectively cluster peptides by respective HLA allele binding.</p>
<p id="P51">Model-associated issues suggested by our work include the use of universal parameter values and features for the identification of both viral and cancer antigens, training models on pathogenic peptides which are then used for prediction of cancer neoantigens and vice versa and limited consideration of HLA-restriction criteria of T cell recognition. Indeed, deconvoluting information extracted from anchor positions vs. TCR contact position, as opposed to modelling only full-length peptides appears to be an attractive approach for incorporating HLA-restriction, such as with work by Wells<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup> and Schmidt<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup>. Furthermore, considering the lack of true negative training data, semi-supervised learning models e.g., generative variational autoencoder models seem appealing options.</p>
<p id="P52">Although in this study we sought to provide a general and an unbiased evaluation of the performances of existing immunogenicity models, there exist several limitations to our approach that are worth highlighting. First, we had to limit ourselves to specific HLAs and on peptide lengths (9 and 10) for which all models are applicable. More data from other HLAs and peptide lengths would be required for generalisation of our observations. Second, despite some potential benefits in re-training these models to further assess their reliability in different research settings, we chose to employ the models as trained by their authors. Key justifications for this are: a) the aim to provide a fair comparison across models, b) in most cases the end users would employ a model ‘as published’ and would not re-train them themselves. Additionally, retraining models may require recalibration of their parameters given new training datasets.</p>
<p id="P53">Third, for evaluating performance of models in identifying immunogenic peptides for emerging pathogens we performed this only - as a proof of concept - with a SARS-CoV-2 dataset that has not been used in training datasets of the models. Therefore, cross-pathogen variation in immunogenicity prediction is likely and highly important, but it is beyond the scope of this study. Finally, for our work regarding how HLA imbalances affect model predictions, we could only feasibly assess HLA-A*02:01 vs. remaining alleles, rather than HLA-A*02:01 vs. specific HLAs. More data from other HLAs will permit HLA-specific analyses.</p>
<p id="P54">The work of Croft et al.<sup>
<xref ref-type="bibr" rid="R25">25</xref>
</sup> indicated that vaccinia-virus peptides presented by mice MHC molecules are highly translated into T cell recognition and response. It is therefore not surprising to see that in mice HLA ligand predictors e.g., netMHCpan 4.0 may accurately identify immunogenic epitopes <sup>
<xref ref-type="bibr" rid="R26">26</xref>
</sup>. However, as we have observed in the present study and also previously reported<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup>, in humans HLA presentation does not seem to be sufficient for T cell recognition. Therefore, additional features of peptide immunogenicity are required to assist extracting T cell targets from the pool of presented peptides in humans.</p>
<p id="P55">We envision that the insights provided in this study can assist end-users to make evidencebased decisions for which model and parameters to use with their data and research questions. Our work suggests that presentation features binding affinity, peptide stability and fraction of hydrophobicity are all associated with peptide immunogenicity for both cancer neoantigens and as well as viral peptides albeit with different parameter thresholds. While recognition features foreignness and agretopicity are associated with neoantigen immunogenicity, they are likely to be less applicable to viral peptides. Our work additionally suggests that for both cancer and pathogenic CD8+ T cell target identification, the first reliable filter would be their presentation status which is predicted by tools such as netMHCpan. For pathogenic peptides, this could then be followed by additional filters e.g., <italic>Repitope</italic>. For cancer neoepitopes, <italic>PRIME</italic> – which incorporates presentation predictions – could be employed although users should expect high levels of false positives.</p>
<p id="P56">Our work highlights an urgent need to improve immunogenicity predictions for emerging pathogens, as well as to improve the precision of models in identifying immunogenic neoantigens. We envision that addressing these concerns would create vast potential for highly accurate immunogenicity predictors, which could augment the efficiency of medical research and managing pandemic disease. We believe that our work will provide a useful and informative resource in the community, to help future users choose the right model and parameters for their tasks and also to help manage their expectations. We hope this study will assist future model developers in addressing issues highlighted here and also to guide design of future experiments to provide the required data.</p>
</sec>
<sec id="S10" sec-type="methods">
<title>Methods</title>
<sec id="S11">
<title>Models selected for analysis</title>
<p id="P57">First, we gathered all publicly available models and excluded those which we were unable to perform comparative assessment. After exclusion (see Table S8), we were left with 7 models: the <italic>IEDB model, NetTepi iPred, Repitope, PRIME, DeepImmuno</italic> and <italic>Gao</italic>. netMHCpan 4.1 eluted ligand and binding affinity scores were additionally evaluated. The study reporting ‘PRIME’ focuses on predicting immunogenic neoantigens however the model is presented also as a predictor of pathogenic epitopes. All models with the exception of ‘<italic>DeepImmuno</italic>‘ were downloaded and ran locally. We were unable to run <italic>DeerpImmuno</italic> locally for unknown technical issues, therefore we instead used the webserver at <ext-link ext-link-type="uri" xlink:href="https://deepimmuno.research.cchmc.org/">https://deepimmuno.research.cchmc.org/</ext-link>
</p>
</sec>
<sec id="S12">
<title>Data Analysis</title>
<p id="P58">All analyses were performed in R 4.0.3. All visualisations (excluding ROC and PR curves) were produced using either the <italic>ggpubr</italic> or <italic>ggplot2</italic> packages. ROC curves were produced using the <italic>pROC</italic> package and PR curves were produced using the <italic>yardstick</italic> package. Confusion matrices and assessment metrics were computed using the <italic>caret</italic> package.</p>
</sec>
<sec id="S13">
<title>Definition of immunogenic peptides</title>
<p id="P59">In the current study, we refer to immunogenic peptides as those which possess a ‘positive’ label in data repositories such as the IEDB. This label refers to peptides where a T cell response has been observed by e.g., an IFNγ ELISpot assay, although other techniques are commonly used.</p>
</sec>
<sec id="S14">
<title>Model training data acquisition</title>
<p id="P60">We obtained the IEDB model training data from the supporting information of Calis et al 2013. This version of the data is prior to their redundancy filtering step and to our knowledge the final training data is not publicly available. The ‘Chowell’ dataset used to train iPred was obtained from the github repository hosting the classifier: <ext-link ext-link-type="uri" xlink:href="https://github.com/antigenomics/ipred/tree/master/classifier">https://github.com/antigenomics/ipred/tree/master/classifier</ext-link>
</p>
<p id="P61">The <italic>MHCI_Human</italic> training data for the human class I Repitope model was obtained from the R package, hosted at <ext-link ext-link-type="uri" xlink:href="https://github.com/masato-ogishi/Repitope">https://github.com/masato-ogishi/Repitope</ext-link>
</p>
<p id="P62">Training data for ‘PRIME’ was downloaded from the supplementary of the original publication<sup>
<xref ref-type="bibr" rid="R21">21</xref>
</sup>. Training data for ‘DeepImmuno’ was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno#deepimmuno-cnn">https://github.com/frankligy/DeepImmuno#deepimmuno-cnn</ext-link>
</p>
</sec>
<sec id="S15">
<title>Performance Evaluation</title>
<p id="P63">All models were executed with default settings. For models where HLA restriction is considered, the corresponding HLA was provided to the model for each peptide of interest. For <italic>NetTepi</italic>, the length of the peptide is also provided at the command line.</p>
<p id="P64">For each model ROC curves were built using the <italic>pROC</italic> package and PR curves built using <italic>yardstick</italic>. To compute confusion matrices, binary classifications must be generated. Thus, from ROC curves, optimal threshold values for binary classification (Positive or Negative) were generated using the youden index. The youden index uses ROC curves to compute a threshold value which maximises the equation (1-sensitivity+specificity). For each model, the individual computed threshold value was used to classify prediction scores into ‘Positive’ or ‘Negative’ sequences and compiled in an additional <italic>‘ImmunogenicityPrediction’</italic> column. For each model, confusion matrices were generated using the <italic>confusionMatrix</italic> function in the <italic>caret</italic> R package.</p>
<p id="P65">In each experiment – with the exception of SARS-CoV homologs in the SARS-CoV-2 experiment - peptides observed in model training data were excluded from performance evaluations. Model performance was evaluated through a combination of ROC-AUC, PR-AUC, precision and recall. Other metrics such as F1 score and Balanced Accuracy were also calculated. ROC-AUC curves show the performance of a model by perturbing thresholding and visualising the true positive rate (fraction of true positives / all true positives) against the false positive rate (fraction of false positives / all true negatives). Curve information is summarised using the area under the curve. Given a balanced dataset for binary classification (50% each classification), a random, unskilled model will have a ROC-AUC of 0.5, reflecting only the balance in the dataset. In contrast, a perfect model would have a ROC-AUC of 1.0. In a similar fashion, PR curves is a visualisation of model precision and recall (equations are described below) after perturbing thresholds. A perfect model would have a PR-AUC of 1.0, and a no skill classifier would reflect the balance in the data, i.e., using the above example, PR-AUC would be 0.5. <disp-formula id="FD1">
<mml:math id="M1">
<mml:mrow>
<mml:mtext>Precision</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mi>p</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>f</mml:mi>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</disp-formula> <disp-formula id="FD2">
<mml:math id="M2">
<mml:mrow>
<mml:mtext>Recall</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mi>p</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>f</mml:mi>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</disp-formula> where ‘tp’ stands for ‘true positives’ and fp stands for ‘false negatives’.</p>
</sec>
<sec id="S16">
<title>Evaluating model performance against SARS-CoV-2 peptides</title>
<p id="P66">The SARS-CoV-2 data were downloaded from the IEDB (accessed August 2021). Data were first filtered for class I binding peptides only (i.e., HLA allele information containing phrases <italic>HLA-A, HLA-B</italic>, or <italic>HLA-C</italic>). If contradicting pMHC observations (i.e., peptide <italic>A</italic>, HLA <italic>y</italic>, Immunogenicity both Positive and Negative in different experiments) were observed, the observation was assumed ‘positive’. NetTepi is only applicable for 13 HLA alleles (see below), therefore we only retained peptides assessed in the context of these alleles. We then filtered on 9 and 10mers, as <italic>DeepImmuno</italic> is only able to predict immunogenicity for these lengths. 49 SARS-CoV-2 peptides were observed in the collective model training data. After inspection, these peptides were from other coronaviruses. Given our aim to emulate a scenario with an emerging pathogen (where some peptides may have homology to other pathogens, but most are ‘unseen’), these were retained.</p>
<p id="P67">Each model was executed as published and prediction scores were generated for each peptide. ROC-AUC, PR-AUC, assessment metrics and confusion matrices were generated as described previously.</p>
<p id="P68">Alleles for which NetTepi is applicable: HLA-A*02:01, HLA-B*58:01, HLA-B*15:01, HLA-B*35:01, HLA-B*07:02, HLA-A*01:01, HLA-A*03:01, HLA-A*11:01, HLA-A*24:02, HLA-A*26:01, HLA-B*27:05, HLA-B*39:01, HLA-B*40:01.</p>
</sec>
<sec id="S17">
<title>Bootstrap analysis to assess model predictive power</title>
<p id="P69">To assess predictive capacity of models against a test dataset, we first gathered the prediction scores generated by each model against the test dataset. These scores were not altered however, we randomly shuffled the immunogenicity label for each peptide. After each shuffling, we calculated PR-AUCs between the original model prediction scores and the newly shuffled immunogenicity labels. This process was repeated 1000 times, resulting in a distribution of ‘shuffled PR-AUCs’, reflecting performance of a distribution of random, unskilled models. We then compared the true ‘benchmarked PR-AUCs’ against this distribution of ‘shuffled PR-AUCs’, to provide a representation of how superior the model performance observed during benchmarking was to a distribution of unskilled models. Z-scores were calculated by subtracting the mean of the ‘shuffled PR-AUCs’ from the benchmarked PR-AUCs, and then dividing by the standard deviation of the ‘shuffled PR-AUCs’.</p>
</sec>
<sec id="S18">
<title>Generating the ‘GBM’ dataset</title>
<p id="P70">These peptides were predicted using an in-house neoantigen identification pipeline and subsequently functionally validated. Prior to functional validation, these peptides were filtered to be of netMHCpan priority score &gt; 50. In-vitro priming of healthy donors peripheral blood mononuclear cells (PBMC) and peptide stimulation of patient’s autologous PBMC was performed to find peptide specific T cells. Positive peptides were those where peptide specific T cells were identified by pMHC(HLA-A02:01)-tetramer staining. A peptide titration curve was then performed. To minimise variation in the current study, we additionally filtered for lengths 9- and 10-mer.</p>
</sec>
<sec id="S19">
<title>Evaluating model performance against ‘GBM neoantigens’</title>
<p id="P71">Each model was executed as published and prediction scores were generated for each peptide in the ‘GBM’ dataset. ROC-AUC, PR-AUC, assessment metrics and confusion matrices were generated as described previously.</p>
</sec>
<sec id="S20">
<title>Evaluating model performance against ‘TESLA consortium neoantigens’</title>
<p id="P72">The ‘TESLA’ dataset was downloaded from Wells et al<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup>. In their study, 608 predicted neoantigens were derived from six patients. These predicted neoantigens were tested for immunogenicity, and 37 of them were found to be immunogenic. Here, test peptides were filtered for lengths (9 and 10) and HLA alleles (see above) for which all models are applicable</p>
</sec>
<sec id="S21">
<title>Exploring differences in features associated with immunogenicity between pathogen and cancer datasets</title>
<p id="P73">The ‘TESLA’ dataset was acquired as above. All 608 peptides of lengths 8-14 were employed in this analysis. To curate the ‘pathogenic’ peptide dataset, we downloaded MHC class I peptides from the IEDB (accessed September 2021). This dataset was then supplemented with further peptides from the <italic>Repitope</italic> package’s data repository. We retained only peptides of lengths 8-14 and excluded any peptides from ‘antigen organisms’ containing the phrases “homo sapien” or “cancer”. Only peptides predicted to bind their corresponding HLA allele were retained for analysis. For analysis, netMHCpan4.0 was used to predict binding affinities of peptides to corresponding HLAs. netMHCstabpan was used to predict binding stabilities. The ‘fraction of hydrophobicity’ was calculated as the fraction of a peptide’s residues that were hydrophobic. Hydrophobic residues were considered as “V”, “I”, “L”, “F”, “M”, “W” and “C” <sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup>.</p>
</sec>
<sec id="S22">
<title>HLA imbalance in model predictions for pathogenic epitopes: Exploratory Analysis</title>
<p id="P74">We gathered the prediction scores generated by testing models against the SARS-CoV-2 dataset after being tasked with predicting immunogenicity. If a peptide was observed to bind HLA-A02:01 in this data, it was labelled as ‘HLA-A02:01+, while the remaining peptides were labelled ‘HLA-A02:01-.</p>
</sec>
<sec id="S23">
<title>HLA imbalance in model predictions for pathogenic epitopes: Predicting HLA-A02:01+ peptides from SARS-CoV-2 peptide Immunogenicity Prediction Scores</title>
<p id="P75">Prediction scores generated by each model after the SARS-CoV-2 experiment to evaluate performance in predicting immunogenicity were gathered. Instead of producing ROC curves against the ‘Immunogenicity’ column however, ROC curves were produced against the binary classification of whether the peptide engages with HLA-A02:01 or not (i.e., HLA-A02:01+/-).</p>
</sec>
</sec>
<sec sec-type="supplementary-material" id="SM">
<title>Supplementary Material</title>
<supplementary-material content-type="local-data" id="SD1">
<label>Supplemental Figure 1</label>
<media xlink:href="EMS141055-supplement-Supplemental_Figure_1.pdf" mimetype="application" mime-subtype="pdf" id="N67201" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD2">
<label>Supplemental Figure 2</label>
<media xlink:href="EMS141055-supplement-Supplemental_Figure_2.pdf" mimetype="application" mime-subtype="pdf" id="N67210" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD3">
<label>Supplemental Figure 3</label>
<media xlink:href="EMS141055-supplement-Supplemental_Figure_3.pdf" mimetype="application" mime-subtype="pdf" id="N67219" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD4">
<label>Supplemental Figure 4</label>
<media xlink:href="EMS141055-supplement-Supplemental_Figure_4.pdf" mimetype="application" mime-subtype="pdf" id="N67228" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD5">
<label>Supplemental Figure 5</label>
<media xlink:href="EMS141055-supplement-Supplemental_Figure_5.pdf" mimetype="application" mime-subtype="pdf" id="N67237" position="anchor"/>
</supplementary-material>
</sec>
</body>
<back>
<ack id="S24">
<title>Acknowledgements</title>
<p>N/A</p>
</ack>
<sec id="S25" sec-type="data-availability">
<title>Availability of data and materials</title>
<p id="P76">Key datasets generated or analysed during this study are included in this published article [and its supplementary information files].</p>
</sec>
<fn-group>
<title>Declarations</title>
<fn id="FN1" fn-type="conflict">
<p id="P77">Competing Interests</p>
<p id="P78">No conflict of interest</p>
</fn>
<fn id="FN2">
<p id="P79">Ethics Statement</p>
<p id="P80">N/A</p>
</fn>
<fn id="FN3">
<p id="P81">Consent for publication</p>
<p id="P82">N/A</p>
</fn>
</fn-group>
<ref-list>
<ref id="R1">
<label>1</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhang</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Bevan</surname>
<given-names>MJ</given-names>
</name>
</person-group>
<article-title>CD8+ T Cells: Foot Soldiers of the Immune System</article-title>
<source>Immunity</source>
<year>2011</year>
<volume>35</volume>
<fpage>161</fpage>
<lpage>168</lpage>
</element-citation>
</ref>
<ref id="R2">
<label>2</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pennock</surname>
<given-names>ND</given-names>
</name>
<etal/>
</person-group>
<article-title>T cell responses: naive to memory and everything in between</article-title>
<source>AJP: Advances in Physiology Education</source>
<year>2013</year>
<volume>37</volume>
<fpage>273</fpage>
<lpage>283</lpage>
</element-citation>
</ref>
<ref id="R3">
<label>3</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wells</surname>
<given-names>DK</given-names>
</name>
<etal/>
</person-group>
<article-title>Key Parameters of Tumor Epitope Immunogenicity Revealed Through a Consortium Approach Improve Neoantigen Prediction</article-title>
<source>Cell</source>
<year>2020</year>
<volume>0</volume>
</element-citation>
</ref>
<ref id="R4">
<label>4</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Karnaukhov</surname>
<given-names>V</given-names>
</name>
<etal/>
</person-group>
<article-title>HLA binding of self-peptides is biased towards proteins with specific molecular functions</article-title>
<pub-id pub-id-type="doi">10.1101/2021.02.16.431395</pub-id>
</element-citation>
</ref>
<ref id="R5">
<label>5</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bassani-Sternberg</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Gfeller</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>Unsupervised HLA Peptidome Deconvolution Improves Ligand Prediction Accuracy and Predicts Cooperative Effects in Peptide–HLA Interactions</article-title>
<source>The Journal of Immunology</source>
<year>2016</year>
<volume>197</volume>
<fpage>2492</fpage>
<lpage>2499</lpage>
</element-citation>
</ref>
<ref id="R6">
<label>6</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Reynisson</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Alvarez</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Paul</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Peters</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Nielsen</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>
<source>Nucleic acids research</source>
<year>2020</year>
<volume>48</volume>
<fpage>W449</fpage>
<lpage>W454</lpage>
</element-citation>
</ref>
<ref id="R7">
<label>7</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bassani-Sternberg</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title>
<source>PLoS computational biology</source>
<year>2017</year>
<volume>13</volume>
<elocation-id>e1005725</elocation-id>
</element-citation>
</ref>
<ref id="R8">
<label>8</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lee</surname>
<given-names>CH</given-names>
</name>
<etal/>
</person-group>
<article-title>Predicting Cross-Reactivity and Antigen Specificity of T Cell Receptors</article-title>
<source>Frontiers in Immunology</source>
<year>2020</year>
<volume>11</volume>
<elocation-id>565096</elocation-id>
</element-citation>
</ref>
<ref id="R9">
<label>9</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Paludan</surname>
<given-names>SR</given-names>
</name>
<name>
<surname>Pradeu</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Masters</surname>
<given-names>SL</given-names>
</name>
<name>
<surname>Mogensen</surname>
<given-names>TH</given-names>
</name>
</person-group>
<article-title>Constitutive immune mechanisms: mediators of host defence and immune regulation</article-title>
<source>Nature Reviews Immunology</source>
<year>2020</year>
<fpage>1</fpage>
<lpage>14</lpage>
<pub-id pub-id-type="doi">10.1038/s41577-020-0391-5</pub-id>
</element-citation>
</ref>
<ref id="R10">
<label>10</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Joglekar</surname>
<given-names>AV</given-names>
</name>
<name>
<surname>Li</surname>
<given-names>G</given-names>
</name>
</person-group>
<article-title>T cell antigen discovery</article-title>
<source>Nature Methods</source>
<year>2020</year>
<fpage>1</fpage>
<lpage>8</lpage>
<pub-id pub-id-type="doi">10.1038/s41592-020-0867-z</pub-id>
</element-citation>
</ref>
<ref id="R11">
<label>11</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Capietto</surname>
<given-names>A-H</given-names>
</name>
<etal/>
</person-group>
<article-title>Mutation position is an important determinant for predicting cancer neoantigens</article-title>
<year>2020</year>
<pub-id pub-id-type="doi">10.1084/jem.20190179</pub-id>
</element-citation>
</ref>
<ref id="R12">
<label>12</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>H Lee</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Antanaviciute</surname>
<given-names>A</given-names>
</name>
<name>
<surname>R Buckley</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Simmons</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Koohy</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>To what extent does MHC binding translate to immunogenicity in humans?</article-title>
<source>ImmunoInformatics</source>
<year>2021</year>
<volume>3–4</volume>
<elocation-id>100006</elocation-id>
</element-citation>
</ref>
<ref id="R13">
<label>13</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ogishi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Yotsuyanagi</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space</article-title>
<source>Frontiers in Immunology</source>
<year>2019</year>
<volume>10</volume>
</element-citation>
</ref>
<ref id="R14">
<label>14</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pogorelyy</surname>
<given-names>Mv</given-names>
</name>
<etal/>
</person-group>
<article-title>Exploring the pre-immune landscape of antigen-specific T cells</article-title>
<source>Genome Medicine</source>
<year>2018</year>
<volume>10</volume>
<fpage>1</fpage>
<lpage>14</lpage>
</element-citation>
</ref>
<ref id="R15">
<label>15</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Trolle</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Nielsen</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>NetTepi: An integrated method for the prediction of T cell epitopes</article-title>
<source>Immunogenetics</source>
<year>2014</year>
<volume>66</volume>
<fpage>449</fpage>
<lpage>456</lpage>
</element-citation>
</ref>
<ref id="R16">
<label>16</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Calis</surname>
<given-names>JJA</given-names>
</name>
<etal/>
</person-group>
<article-title>Properties of MHC Class I Presented Peptides That Enhance Immunogenicity</article-title>
<source>PLoS Computational Biology</source>
<year>2013</year>
<volume>9</volume>
</element-citation>
</ref>
<ref id="R17">
<label>17</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Li</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Iyer</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Prasath</surname>
<given-names>VBS</given-names>
</name>
<name>
<surname>Ni</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Salomonis</surname>
<given-names>N</given-names>
</name>
</person-group>
<article-title>DeepImmuno: deep learning-empowered prediction and generation of immunogenic peptides for T-cell immunity</article-title>
<source>Briefings in Bioinformatics</source>
<year>2021</year>
<volume>00</volume>
<fpage>1</fpage>
<lpage>10</lpage>
</element-citation>
</ref>
<ref id="R18">
<label>18</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Luksza</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>A neoantigen fitness model predicts tumour response to checkpoint blockade immunotherapy</article-title>
<source>Nature</source>
<year>2017</year>
<volume>551</volume>
<fpage>517</fpage>
<lpage>520</lpage>
</element-citation>
</ref>
<ref id="R19">
<label>19</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bjerregaard</surname>
<given-names>AM</given-names>
</name>
<etal/>
</person-group>
<article-title>An analysis of natural T cell responses to predicted tumor neoepitopes</article-title>
<source>Frontiers in Immunology</source>
<year>2017</year>
<volume>8</volume>
<fpage>1566</fpage>
</element-citation>
</ref>
<ref id="R20">
<label>20</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Riley</surname>
<given-names>TP</given-names>
</name>
<etal/>
</person-group>
<article-title>Structure based prediction of neoantigen immunogenicity</article-title>
<source>Frontiers in Immunology</source>
<year>2019</year>
<volume>10</volume>
</element-citation>
</ref>
<ref id="R21">
<label>21</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schmidt</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>
<article-title>Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting</article-title>
<source>Cell Reports Medicine</source>
<year>2021</year>
<volume>2</volume>
<elocation-id>100194</elocation-id>
</element-citation>
</ref>
<ref id="R22">
<label>22</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schmidt</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>
<article-title>Prediction of neo-epitope immunogenicity reveals TCR recognition determinants and provides insight into immunoediting</article-title>
<source>Cell Reports Medicine</source>
<year>2021</year>
<volume>2</volume>
<elocation-id>100194</elocation-id>
</element-citation>
</ref>
<ref id="R23">
<label>23</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Richman</surname>
<given-names>LP</given-names>
</name>
<name>
<surname>Vonderheide</surname>
<given-names>RH</given-names>
</name>
<name>
<surname>Rech</surname>
<given-names>AJ</given-names>
</name>
</person-group>
<article-title>Neoantigen Dissimilarity to the Self-Proteome Predicts Immunogenicity and Response to Immune Checkpoint Blockade In Brief</article-title>
<source>Cell Systems</source>
<year>2019</year>
<volume>9</volume>
<fpage>375</fpage>
<lpage>382</lpage>
</element-citation>
</ref>
<ref id="R24">
<label>24</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Devlin</surname>
<given-names>JR</given-names>
</name>
<etal/>
</person-group>
<article-title>Structural dissimilarity from self drives neoepitope escape from immune tolerance</article-title>
<source>Nature Chemical Biology</source>
<year>2020</year>
<volume>16</volume>
<fpage>1269</fpage>
<lpage>1276</lpage>
</element-citation>
</ref>
<ref id="R25">
<label>25</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Croft</surname>
<given-names>NP</given-names>
</name>
<etal/>
</person-group>
<article-title>Most viral peptides displayed by class I MHC on infected cells are immunogenic</article-title>
<source>Proceedings of the National Academy of Sciences of the United States of America</source>
<year>2019</year>
<volume>116</volume>
<fpage>3112</fpage>
<lpage>3117</lpage>
</element-citation>
</ref>
<ref id="R26">
<label>26</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Paul</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>
<article-title>Benchmarking predictions of MHC class I restricted T cell epitopes in a comprehensively studied model system</article-title>
<source>PLoS Computational Biology</source>
<year>2020</year>
<volume>16</volume>
</element-citation>
</ref>
<ref id="R27">
<label>27</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ogishi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Yotsuyanagi</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space</article-title>
<source>Frontiers in Immunology</source>
<year>2019</year>
<volume>10</volume>
<fpage>827</fpage>
</element-citation>
</ref>
<ref id="R28">
<label>28</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gao</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<article-title>Predicting the Immunogenicity of T cell epitopes: From HIV to SARS-CoV-2</article-title>
<source>bioRxiv: the preprint server for biology</source>
<year>2020</year>
<pub-id pub-id-type="doi">10.1101/2020.05.14.095885</pub-id>
</element-citation>
</ref>
<ref id="R29">
<label>29</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Paul</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>
<article-title>Benchmarking predictions of MHC class I restricted T cell epitopes in a comprehensively studied model system</article-title>
<source>PLoS Computational Biology</source>
<year>2020</year>
<volume>16</volume>
<elocation-id>e1007757</elocation-id>
</element-citation>
</ref>
<ref id="R30">
<label>30</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Buckley</surname>
<given-names>P</given-names>
</name>
<etal/>
</person-group>
<article-title>HLA-dependent variation in SARS-CoV-2 CD8+ T cell crossreactivity with human coronaviruses</article-title>
<source>bioRxiv</source>
<year>2021</year>
<elocation-id>2021.07.17.452778</elocation-id>
</element-citation>
</ref>
<ref id="R31">
<label>31</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lee</surname>
<given-names>CH</given-names>
</name>
<etal/>
</person-group>
<article-title>Potential CD8+ T Cell Cross-Reactivity Against SARS-CoV-2 Conferred by Other Coronavirus Strains</article-title>
<source>Frontiers in Immunology</source>
<year>2020</year>
<volume>11</volume>
<elocation-id>2878</elocation-id>
</element-citation>
</ref>
<ref id="R32">
<label>32</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Dhanda</surname>
<given-names>SK</given-names>
</name>
<etal/>
</person-group>
<article-title>IEDB-AR: immune epitope database - analysis resource in 2019</article-title>
<source>Nucleic Acids Research</source>
<year>2019</year>
<volume>47</volume>
<fpage>W502</fpage>
<lpage>W506</lpage>
</element-citation>
</ref>
<ref id="R33">
<label>33</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pickett</surname>
<given-names>BE</given-names>
</name>
<etal/>
</person-group>
<article-title>ViPR: an open bioinformatics database and analysis resource for virology research</article-title>
<pub-id pub-id-type="doi">10.1093/nar/gkr859</pub-id>
</element-citation>
</ref>
<ref id="R34">
<label>34</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Roudko</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Greenbaum</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Bhardwaj</surname>
<given-names>N</given-names>
</name>
</person-group>
<article-title>Computational Prediction and Validation of Tumor-Associated Neoantigens</article-title>
<source>Frontiers in Immunology</source>
<year>2020</year>
<volume>11</volume>
<fpage>27</fpage>
</element-citation>
</ref>
<ref id="R35">
<label>35</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Yadav</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>Predicting immunogenic tumour mutations by combining mass spectrometry and exome sequencing</article-title>
<source>Nature</source>
<year>2014</year>
<volume>515</volume>
</element-citation>
</ref>
<ref id="R36">
<label>36</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Saito</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Rehmsmeier</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>The precision-recall plot is more informative than the ROC plot when evaluating binary classifiers on imbalanced datasets</article-title>
<source>PLoS ONE</source>
<year>2015</year>
<volume>10</volume>
</element-citation>
</ref>
<ref id="R37">
<label>37</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wu</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>
<article-title>DeepHLApan: A Deep Learning Approach for Neoantigen Prediction Considering Both HLA-Peptide Binding and Immunogenicity</article-title>
<source>Frontiers in Immunology</source>
<year>2019</year>
<volume>10</volume>
<elocation-id>2559</elocation-id>
</element-citation>
</ref>
</ref-list>
</back>
<floats-group>
<fig id="F1" position="float">
<label>Figure 1</label>
<caption>
<title>Models are not reliable in predicting epitopes for an emerging virus and exhibit room for improvement in predicting immunogenic cancer neoantigens.</title>
<p>A) ROC-curves of models tested ‘as published’ against 681 SARS-CoV-2 peptides of lengths 9 and 10 (45% immunogenic). B) PR-curves of models tested ‘as published’ against the SARS-CoV-2 peptides. C) PR-curves showing model performance against the GBM neoantigen dataset. D) PR-curves showing model performance against the TESLA neoantigen dataset.</p>
</caption>
<graphic xlink:href="EMS141055-f001"/>
</fig>
<fig id="F2" position="float">
<label>Figure 2</label>
<caption>
<p>Differences in magnitude of discriminative antigen-presentation features associated with immunogenicity for pathogenic vs. cancer peptides: Analysis was performed examining A) binding affinities, B) binding stabilities, C) fraction of the peptide which is hydrophobic (fraction hydrophobicity) between pathogenic and cancer peptides. i) Density plots showing the distributions of binding affinities (Ai), binding stabilities (Bi) or fraction hydrophobicity (Ciii) for immunogenic and non-immunogenic peptides within pathogenic vs cancer datasets. ii) Boxplots comparing binding affinities (Aii), binding stabilities (Bii) or fraction hydrophobicity (Ci) of pathogen vs cancer peptides for both non-immunogenic and immunogenic peptides. iii) Violin plots comparing the binding affinities (A-iii), binding stabilities (B-iii), fraction hydrophobicity (C-ii) of immunogenic and non-immunogenic peptides, for both cancer and pathogenic datasets. Green and red dashed lines show the median of the binding affinities for the immunogenic and non-immunogenic cancer peptides respectively. IV) Line plots showing the empirical cumulative distributions of binding affinities (A-IV) and binding stabilities (B-IV), grouped by immunogenic or non-immunogenic within cancer or pathogenic peptide datasets. D-i) Density plots showing the distributions of binding affinities for immunogenic and non-immunogenic peptides between two independent cancer peptide datasets (GBM and TESLA). D-ii) Boxplots comparing binding affinities of GBM vs TESLA peptides for both non-immunogenic and immunogenic peptides. D-iii) Violin plots comparing the binding affinities of immunogenic and non-immunogenic peptides for GBM and TESLA cancer peptide datasets.</p>
</caption>
<graphic xlink:href="EMS141055-f002"/>
</fig>
<fig id="F3" position="float">
<label>Figure 3</label>
<caption>
<title>Effects of cross-HLA variation on predicting peptide immunogenicity.</title>
<p>A) Barplots showing the distribution of immunogenic and non-immunogenic peptides for the top HLA alleles in each model’s training dataset. Gao’s training data is not included as the immunogenicity status are continuous. B) Barplots showing the distribution of immunogenic and non-immunogenic peptides for whether they bind HLA-A02:01 (labelled A*02:01+) or another allele (A*02:01-). C) Notched boxplots showing subtle differences between the immunogenicity scores created by each model, based on whether the peptide binds. HLA-A*02:01 (A02:01+) or another allele (A02:01-), and whether the peptide is immunogenic (Pve, labelled blue) or non-immunogenic (Nve, labelled red). D) ROC-AUCs of the models after taking scores produced to predict immunogenicity for SARS-CoV-2 peptides, but instead asked to predict HLA-A02:01 status.</p>
</caption>
<graphic xlink:href="EMS141055-f003"/>
</fig>
<table-wrap id="T1" position="float" orientation="portrait">
<label>Table 1</label>
<caption>
<title>An overview of Immunogenicity Predictors which are evaluated in this study.</title>
</caption>
<table frame="box" rules="all">
<thead>
<tr>
<th align="center" valign="top">Model</th>
<th align="center" valign="top">Features and Calculations</th>
<th align="center" valign="top">Training Data</th>
<th align="center" valign="top">Language</th>
<th align="center" valign="top">Input Data</th>
<th align="center" valign="top">HLA Restriction</th>
<th align="center" valign="top">Reported Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">IEDB Model Calis, J. J. A. <italic>et al.</italic>
<break/>Properties of MHC Class I Presented Peptides That Enhance Immunogenicity. <italic>PLoS Comput. Biol.</italic> <bold>9</bold>, (2013).</td>
<td align="left" valign="top">The IEDB model captures sequence-based frequencies of specific amino acids to describe those which are more prevalent in immunogenic peptides compared with non-immunogenic peptides. Thus, ‘enrichment scores’ are combined with weights on amino acid positional importance for immunogenicity. The user is provided with a score between -1 and 1, to indicate likelihood of immunogenicity.</td>
<td align="left" valign="top">Data were compiled from the IEDB and three murine studies.<break/>Strict data curation process excluded humans as a host for non-immunogenic peptides. Nine-mers were then selected and a redundancy filtering process was performed to avoid oversampling.<break/>Dataset after redundancy filtering is not publicly available.</td>
<td align="left" valign="top">Python</td>
<td align="left" valign="top">Peptide(s) and HLA Allele</td>
<td align="left" valign="top">Yes.</td>
<td align="left" valign="top">ROC-AUC after 3-fold cross-validation: 0.65</td>
</tr>
<tr>
<td align="left" valign="top">NetTepi<break/>Trolle, T. &amp; Nielsen, M. NetTepi: An integrated method for the prediction of T cell epitopes. <italic>Immunogenetics</italic> <bold>66</bold>, 449–456 (2014)</td>
<td align="left" valign="top">NetTepi was defined as the linear combination of binding affinity scores which were obtained by netMHCpan algorithm, binding stability scores which are obtained by netMHCstab (v1) and T cell propensity scores which are obtained similarly to the IEDB model: <italic>M</italic> - <italic>tTCellPropensity</italic> + <italic>sNetMHCstab</italic> + (1 – <italic>t</italic> – <italic>s</italic>)<italic>NetMHCcons</italic>
<break/>Developers optimized weights <italic>t</italic> and <italic>s</italic>, and defaults were given. <italic>netMHCstab</italic> and <italic>netMHCcons</italic> are called directly and canonically from NetTepi and individual scores from these algorithms are produced. These are integrated as above with the T cell propensity predictions. To our knowledge, the only difference between the T cell propensity component of NetTepi and the IEDB model, is that only default masking (for HLA-A0201) to encode for positional importance is employed by NetTepi, whereas for the IEDB model there are different settings based on chosen HLA.</td>
<td align="left" valign="top">T cell propensity component employed training data as above for the IEDB model.</td>
<td align="left" valign="top">Python</td>
<td align="left" valign="top">Peptides, HLA Allele, peptide length (8-14)</td>
<td align="left" valign="top">Yes, 13 HLA-A and HLA-B alleles</td>
<td align="left" valign="top">Average AUC0.1 values range between 0.9305 and 0.9652</td>
</tr>
<tr>
<td align="left" valign="top">iPred<break/>Pogorelyy, M. V. <italic>et al.</italic> Exploring the pre-immune landscape of antigen-specific T cells. <italic>Genome Med</italic>. <bold>10</bold>, 1–14 (2018</td>
<td align="left" valign="top">iPred is a Multinomial Gaussian Process classifier, utilising expectation-maximisation and as input <italic>iPred</italic> takes peptide sequence(s) and computes 10 Kidera Features <sup>
<xref ref-type="bibr" rid="R17">17</xref>
</sup> averaged over all residues. The output of the model is a probability score reflecting the likelihood of T cell immunogenicity.</td>
<td align="left" valign="top">Chowell dataset was used to compute kidera factor vector sums for model training.</td>
<td align="left" valign="top">R</td>
<td align="left" valign="top">Peptide sequence</td>
<td align="left" valign="top">No</td>
<td align="left" valign="top">ROC-AUC: ~0.80</td>
</tr>
<tr>
<td align="left" valign="top">Repitope<break/>Ogishi, M. … Yotsuyanagi, H. Quantitative prediction of the landscape of T cell epitope immunogenicity in sequence space. <italic>Front. Immunol.</italic> <bold>10</bold>, (2019)</td>
<td align="left" valign="top">Repitope is a framework which probes public TCRs to discriminate immunogenicity. Repitope computes physiochemical properties based on mimicking the thermodynamics between pMHC and public TCR interactions. This framework termed ‘TCR-peptide Contact Potential Profiling’ (CPP) focuses on the TCRβ CDR3 sequences, which are primarily involved in the interactions with peptides presented onto MHC. After a highly dimensional feature (~6000) computation occurs, feature selection can be performed and then a probabilistic estimate of immunogenicity is computed for each epitope. Models can be extrapolated to sequences for which it was not trained to make predictions.<break/>Repitope can compute probabilistic estimates of the immunogenicity for an original epitope and for all single amino acid variants, as well as the largest difference of immunogenicity between any variants to explore escape potential. Repitope also provides utility to predict CD4+ T cell immunogenicity for class II MHC.</td>
<td align="left" valign="top">Calis 2013 dataset, Chowell 2015 dataset, EPIMHC dataset, LANL HCV/HIV dataset, POPISK dataset, MHCBN dataset, TANTIGEN dataset. Please see following link for more details: <ext-link ext-link-type="uri" xlink:href="https://github.com/masato-ogishi/Repitope">https://github.com/masato-ogishi/Repitope</ext-link>
</td>
<td align="left" valign="top">R or Python.</td>
<td align="left" valign="top">Peptide sequences</td>
<td align="left" valign="top">No</td>
<td align="left" valign="top">ROC-AUC 0.76</td>
</tr>
<tr>
<td align="left" valign="top">PRIME</td>
<td align="left" valign="top">PRIME is a predictor of immunogenic epitopes. The model captures and deconvolutes molecular properties of antigen-presentation and TCR recognition propensity. The authors were able to achieve this deconvolution by a ‘careful annotation and analysis of epitope residues with minimal impact on binding to HLA-I molecules’. PRIME is efficient and runs faster than many HLA-I ligand predictors. For the HLA binding component of the prediction, PRIME uses mixMHCpred.</td>
<td align="left" valign="top">Compiled from multiple studies. See table S1: https://pubmed.ncbi.nl m.nih.gov/33665637/</td>
<td align="left" valign="top">Python</td>
<td align="left" valign="top">Peptide sequences and a corresponding HLA allele for each peptide.</td>
<td align="left" valign="top">Yes</td>
<td align="left" valign="top">ROC-AUC &gt;0.7, PR-AUC &gt;0.10 &lt; 0.16.</td>
</tr>
<tr>
<td align="left" valign="top">DeepImmuno</td>
<td align="left" valign="top">DeepImmuno-CNN is a convolution-neural network approach which predicts immunogenicity of pMHC complexes. A betabinomial probabilistic model is fit to the training dataset in order to generate an immunogenicity score. Their immunogenicity score weights each pMHC complex based on the strength of available experimental evidence in the training dataset. A principal component analysis of 566 amino acid physicochemical properties encodes each amino acid sequence.</td>
<td align="left" valign="top">Initial training and validation occurred using data from the IEDB. Please see: <ext-link ext-link-type="uri" xlink:href="https://github.com/frankligy/DeepImmuno">https://github.com/frankligy/DeepImmuno</ext-link>
</td>
<td align="left" valign="top">Web portal or Python</td>
<td align="left" valign="top">Peptide sequence and corresponding HLA. Lengths 9/10 only</td>
<td align="left" valign="top">Yes</td>
<td align="left" valign="top">ROC-AUC 0.85 from cross-validation.<break/>PR-AUC 0.81 from cross-validation.</td>
</tr>
<tr>
<td align="left" valign="top">Gao</td>
<td align="left" valign="top">A ‘physics-based’ learning model, aimed at predicting CTL epitopes. The model is trained and validated on peptides from HIV.</td>
<td align="left" valign="top">Peptide data from HIV patients.</td>
<td align="left" valign="top">R</td>
<td align="left" valign="top">Peptide and HLA allele.</td>
<td align="left" valign="top">Yes</td>
<td align="left" valign="top">ROC-AUC 0.66-0.71</td>
</tr>
</tbody>
</table>
</table-wrap>
<table-wrap id="T2" position="float" orientation="portrait">
<label>Table 2</label>
<caption>
<title>An overview of suggested applications for select immunogenicity predictors.</title>
</caption>
<table frame="box" rules="all">
<thead>
<tr>
<th align="left" valign="top">Immunogenicity Scenario</th>
<th align="left" valign="top">Recommended Model(s)</th>
<th align="left" valign="top">Notes/Justification</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">Predicting epitopes from an emerging pathogen or pathogenic epitopes in general</td>
<td align="left" valign="top">netMHCpan + Repitope</td>
<td align="left" valign="top">Each model performed poorly in this setting (Fig 1A), however Repitope exhibited the most predictive capacity. NetMHCpan should be used to first predict HLA binders, followed perhaps by Repitope to suggest immunogenic peptides.</td>
</tr>
<tr>
<td align="left" valign="top">Identifying immunogenic neoantigens</td>
<td align="left" valign="top">1) PRIME, NetTepi, netMHCpan, Gao.</td>
<td align="left" valign="top">While suboptimal performances were observed for each model, PRIME identified the highest number of immunogenic peptides albeit with limits in precision. NetTepi, netMHCpan and Gao also showed potential to identify immunogenic peptides. The desired precision vs. recall for a given research question should dictate which model is used.<break/>If all features are available, the TESLA algorithm has shown potential in other work.</td>
</tr>
</tbody>
</table>
</table-wrap>
</floats-group>
</article>
