<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS144663</article-id><article-id pub-id-type="doi">10.1101/2020.11.26.400218</article-id><article-id pub-id-type="archive">PPR245794</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Predicting the impact of sequence motifs on gene regulation using single-cell data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hepkema</surname><given-names>Jacob</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Lee</surname><given-names>Nicholas Keone</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Stewart</surname><given-names>Benjamin J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Ruangroengkulrith</surname><given-names>Siwat</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Charoensawan</surname><given-names>Varodom</given-names></name><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Clatworthy</surname><given-names>Menna R.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Hemberg</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A8">8</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, CB10 1SA, UK</aff><aff id="A2"><label>2</label>The Gurdon Institute, University of Cambridge, Tennis Court Road, Cambridge, CB2 1QN UK</aff><aff id="A3"><label>3</label>Molecular Immunity Unit, Department of Medicine, University of Cambridge, Cambridge CB2 0QQ, UK</aff><aff id="A4"><label>4</label>Cambridge University Hospitals NHS Foundation Trust and NIHR Cambridge Biomedical Research Centre, Cambridge CB2 0QQ, UK</aff><aff id="A5"><label>5</label>Department of Biochemistry, Faculty of Science, Mahidol University, Bangkok 10400, Thailand</aff><aff id="A6"><label>6</label>Integrative Computational BioScience (ICBS) Center, Mahidol University, Nakhon Pathom 7310, Thailand</aff><aff id="A7"><label>7</label>Systems Biology of Diseases Research Unit, Faculty of Science, Mahidol University, Bangkok 10400, Thailand</aff><aff id="A8"><label>8</label>Evergrande Center for Immunological Diseases, Harvard Medical School and Brigham and Women’s Hospital. Boston MA 02115, USA</aff><author-notes><corresp id="CR1">
<label>*</label>Corresponding author: <email>mhemberg@bwh.harvard.edu</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>02</day><month>05</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>30</day><month>04</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><sec id="S1"><title>Background</title><p id="P1">Binding of transcription factors (TFs) at proximal promoters and distal enhancers is central to gene regulation. Yet, identification of TF binding sites, also known as regulatory motifs, and quantification of their impact on gene expression remains challenging.</p></sec><sec id="S2"><title>Results</title><p id="P2">Here we infer putative regulatory motifs along with their cell type-specific importance using a convolutional neural network trained on single-cell data. Comparison of the importance score to expression levels across cells allows us to identify the TFs most likely to be binding at a given motif. Using multiple mouse tissues we obtain a model with cell type resolution which explains 29% of the variance in gene expression. Finally, by applying scover to distal enhancers identified using scATAC-seq from the mouse cerebral cortex we characterize changes in distal regulatory motifs during development.</p></sec><sec id="S3"><title>Conclusions</title><p id="P3">It is possible to identify regulatory motifs as well as their importance from single-cell data using a neural network model where all of the parameters and outputs are easily interpretable to the user.</p></sec></abstract></article-meta></front><body><sec id="S4" sec-type="intro"><title>Background</title><p id="P4">One of the central goals in genomics is to understand how different phenotypes are determined by the DNA sequence. In higher eukaryotes the vast majority of bases represent non-coding DNA and our ability to predict the function of these sequences is incomplete. An important role for non-coding DNA is to regulate the expression of protein coding genes, and a key mechanism is through binding of TFs to proximal promoters and distal enhancers. Although the underlying principles and mechanisms of TF binding have been studied extensively, determining which motifs are functional and quantifying their importance remains a major challenge (<xref ref-type="bibr" rid="R1">1</xref>–<xref ref-type="bibr" rid="R3">3</xref>).</p><p id="P5">Identifying regulatory motifs from sequence alone is hard because in higher eukaryotes most motifs are degenerate and the number of matches in the genome is typically much larger than the number of sites bound by a TF (<xref ref-type="bibr" rid="R4">4</xref>). Using epigenetic information, such as TF expression levels, TF binding, chromatin accessibility, and histone modifications, it is possible to obtain more accurate models of which motifs are relevant for expression (<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref>). Today, assays for quantifying the epigenome can be carried out for single cells (<xref ref-type="bibr" rid="R7">7</xref>–<xref ref-type="bibr" rid="R9">9</xref>), resulting in datasets with finer cellular resolution. However, there is a shortage of computational methods that can take full advantage of these data to infer regulatory motifs and their impact on molecular phenotypes, such as expression levels or open chromatin.</p><p id="P6">Although there are methods for inferring regulatory motifs from single-cell data, e.g. SCENIC (<xref ref-type="bibr" rid="R10">10</xref>), HOMER (<xref ref-type="bibr" rid="R11">11</xref>) and Basset (<xref ref-type="bibr" rid="R12">12</xref>), none of these methods is designed for both <italic>de novo</italic> motif identification and quantification of the contribution to gene expression levels with scRNAseq. A variety of machine learning approaches have been applied to bulk RNA-seq and ChIP-seq data to identify sequence and epigenetic features that determine gene expression (<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R13">13</xref>–<xref ref-type="bibr" rid="R16">16</xref>). In recent years, deep learning methods have become very popular (<xref ref-type="bibr" rid="R17">17</xref>,<xref ref-type="bibr" rid="R18">18</xref>) and they have been used for the task of predicting gene expression from sequence (<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R20">20</xref>).</p></sec><sec id="S5" sec-type="results"><title>Results</title><p id="P7">Here, we perform <italic>de novo</italic> discovery of regulatory motifs and their cell lineage specific impact on gene expression and chromatin accessibility from single cell data using scover, a convolutional neural network (<xref ref-type="fig" rid="F1">Fig 1a, b</xref>). Scover takes as input a set of sequences, e.g. promoters or distal enhancers, along with measurements of their activity, e.g. expression levels of the associated genes or accessibility levels of the enhancers. The output is a set of motifs associated with the convolutional filters along with a vector of influence scores for each motif in each output cell. Scover was implemented using the PyTorch framework (<xref ref-type="bibr" rid="R21">21</xref>) to be compatible with the scanpy workflow (<xref ref-type="bibr" rid="R22">22</xref>), and it is available under the MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/jacobhepkema/scover">https://github.com/jacobhepkema/scover</ext-link>.</p><p id="P8">Single-cell measurements from sequencing experiments typically have a large fraction of zeros. To overcome the accompanying challenges (<xref ref-type="bibr" rid="R23">23</xref>), scover reduces the sparsity by summing the values for <italic>k</italic>-nearest neighbors (default <italic>k</italic> = 100) of a set of seed cells to generate a 'pooled' dataset (<xref ref-type="fig" rid="F1">Fig 1a</xref>). This strategy does not rely on existing cell type annotation, and it also retains intra-cell type variability, as opposed to taking the average for existing cell annotations. The initial seed cells are selected by geometric sketching, which evenly samples cells across a representation of the dataset, preserving rare cell states (<xref ref-type="bibr" rid="R24">24</xref>). The use of the k-nearest neighbor graph ensures that most cells in a pool will come from the same cell type, however, many pools will be heterogeneous. The cell type annotation for a pool is determined by the most abundant cell type within the pool.</p><p id="P9">We use several metrics to evaluate the effect of different pool sizes (<xref ref-type="supplementary-material" rid="SD1">Fig S1</xref>). Reassuringly, we have found that results for the datasets considered in this manuscript are robust with respect to the pool size, and it is up to the user to strike the balance between model accuracy and cell type resolution. Sequences are fed into a single convolutional layer where <italic>d</italic> (default <italic>d</italic> = 600) filters representing regulatory motifs are combined before being fed to a neural network layer resulting in a predicted expression value. The shallow architecture requires fewer parameters which allows smaller input datasets to be used and it makes it more likely that a whole motif representation will be found (<xref ref-type="bibr" rid="R25">25</xref>).</p><p id="P10">Since the neural network is optimized using a stochastic approach, reproducibility can be achieved by running it <italic>r</italic> times (default <italic>r</italic> = 10) and excluding motifs that are found in fewer than 50% of models (<xref ref-type="bibr" rid="R26">26</xref>). To facilitate the overview of the found motifs, scover automatically compares the motifs to those annotated in CIS-BP (<xref ref-type="bibr" rid="R27">27</xref>) (if available). Randomly initialized convolutional filters may converge to recognise similar sequences that are enriched in the sequence input. To organize the <italic>rd</italic> motifs, they are assigned, based on their most significant motif alignment, to pre-specified motif clusters published elsewhere (<xref ref-type="bibr" rid="R28">28</xref>) (<xref ref-type="fig" rid="F1">Fig 1c</xref>).</p><p id="P11">Analysis of the convolutional filters and their associated weights can provide insights about the contribution of regulatory motifs to the observed measurements. To evaluate the importance of each motif, we employed a strategy inspired by Maslova et al (<xref ref-type="bibr" rid="R26">26</xref>) whereby an influence score <italic>n<sub>ip</sub></italic> is calculated for each motif <italic>i</italic> and pool <italic>p</italic> by excluding the motif from the analysis and comparing the prediction of the modified model to the original model (<xref ref-type="fig" rid="F1">Fig 1d</xref>). Influence scores in pools corresponding to the same cell type are averaged and influence scores for motifs belonging to the same motif cluster are summed. Since influence scores tend to be largely similar across cell types, we present the z-transformed values to highlight cell type specific patterns.</p><p id="P12">When multiple TFs recognize the motif of a motif cluster, additional information is required to identify the most likely protein. Although transcriptome data alone is insufficient, we can rank the candidates by calculating the Spearman correlation <italic>r<sub>ct</sub></italic> between the summed influence scores for motifs in motif cluster <italic>c</italic> and the expression levels of TF <italic>t</italic> across all pools. We assume that if |<italic>r<sub>ct</sub></italic>| is high, then the TF is more likely to bind to its cognate site.</p><sec id="S6"><title>Scover identifies regulatory motifs in human kidney</title><p id="P13">We applied scover to a scRNAseq dataset from human fetal and adult kidney containing a total of 67,471 cells (<xref ref-type="bibr" rid="R9">9</xref>). The 1kb input sequences were 500 nts upstream and downstream of the transcription start site (TSS) of each expressed gene. We used <italic>d =</italic> 600, and of the 6,000 convolutional filters, 8% could be grouped into 11 reproducible families corresponding to known motifs (<xref ref-type="fig" rid="F2">Fig. 2a,b</xref>, <xref ref-type="supplementary-material" rid="SD1">S2</xref>). Analysis of the top non-aligned motifs shows that many correspond to ETS motifs or GC-rich motifs, suggesting that they are likely biologically meaningful nonetheless (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>). Based on the validation set, the scover model explains 15% of the variance in gene expression, and the performance drops to 9% if non-matching motifs are excluded. To simplify the presentation of the results we grouped the 60 cell types into five categories: endothelial, immune, nephron epithelial, nephron progenitor and stromal (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>).</p><p id="P14">Dimensionality reduction using principal component analysis (PCA) reveals that the biggest difference in influence correlated with the E2F/2:E2F weights (<xref ref-type="fig" rid="F2">Fig. 2c</xref>, <xref ref-type="supplementary-material" rid="SD1">S4a,b</xref>; Spearman R = 0.87), suggesting that the first principal component might be related to the cell cycle (<xref ref-type="bibr" rid="R29">29</xref>). The second strongest trend separates two groups, the first consisting of nephron progenitors and immune cells, and the second consisting of nephron progenitors and stromal cells (<xref ref-type="fig" rid="F2">Fig 2c</xref>). The third principal component separates immune cells and epithelial cells from the rest (<xref ref-type="supplementary-material" rid="SD1">Fig S4c</xref>).</p><p id="P15">Since one of the largest differences in terms of influence scores is between nephron progenitors and nephron epithelium cells, we investigated the developmental trajectory by carrying out a pseudotime analysis. This revealed how the progenitors branch towards three distinct fates: podocytes, loop of Henle, and proximal tubules (<xref ref-type="fig" rid="F2">Fig 2d</xref>). Focusing on the latter, we calculated the correlation between the expression levels of six markers associated with tubule development and the influence scores to reveal strong associations for CREB/ATF and GC-tract. This suggests that we can relate influence scores not just to discrete categories but also to continuous processes.</p><p id="P16">Although promoters share some distinct sequence features, there is also a considerable diversity to allow for differential regulation. To visualize this diversity we applied UMAP dimensionality reduction to the matrix containing the inferred motif occurrences in each promoter, and then we assigned color to each dot based on its motif score (<xref ref-type="fig" rid="F3">Fig 3a</xref>, <xref ref-type="sec" rid="S11">Methods</xref>). Interestingly, promoters separated in terms of their motif contents; KLF/SP/2 motifs were abundant across almost all promoters, some promoters were enriched for ETS/1 motifs or YY1 motifs, and promoters with high scores for ZNF143 separated from the other promoters. Similarly, by calculating the correlation between motif family influence scores across pools, we observe that the motif families fall into two major groups with GC-rich KLF and E2F motifs in one cluster, further reinforcing the notion that there is a higher order organization of motifs (<xref ref-type="supplementary-material" rid="SD1">Fig S4d</xref>).</p><p id="P17">Since multiple TFs can compete to bind similar motifs (<xref ref-type="bibr" rid="R30">30</xref>), we set out a strategy to identify which TFs could putatively underlie the observed influence scores for each motif family. We do this by correlating motif family influence scores with the expression levels from TFs in those motif families, under the assumption that TF expression relates to its activity. Comparison of TF expression and influence scores reveals that 17 of the 80 TFs associated with the 11 motif families are strongly correlated with |r|&gt;0.5 and a significant p-value (<xref ref-type="fig" rid="F3">Fig 3b</xref>). These correlations can be used to pinpoint which putative TFs more likely correspond to the network predictions. For instance, while <italic>YY1</italic> and <italic>YY2</italic> have very similar motifs with an ATGG core (<xref ref-type="bibr" rid="R31">31</xref>), <italic>YY1</italic> has a higher correlation, suggesting that it is less likely that <italic>YY2</italic> corresponds to the network prediction (<xref ref-type="fig" rid="F3">Fig 3c</xref>). Similarly, while <italic>NRF1</italic> has a moderate correlation with influence scores, it more likely corresponds to the recently characterized TF BANP that recognizes a similar CGCG motif (<xref ref-type="bibr" rid="R32">32</xref>), as it has a higher correlation with influence scores. However, we cannot rule out that multiple TFs correspond to the same motif cluster. For instance, <italic>ELF1</italic> and <italic>FLI1</italic> both correlate moderately with ETS/1 cluster network influence scores, which supports the notion that ETS family TFs can bind similar sites and act in functionally redundant ways (<xref ref-type="bibr" rid="R33">33</xref>).</p></sec><sec id="S7"><title>Characterization of regulatory motifs in 18 mouse tissues</title><p id="P18">Next, we applied scover to 18 tissues from the Tabula Muris (<xref ref-type="bibr" rid="R8">8</xref>), containing a total of 67 cell types and 38,080 cells. Only 7.55% of the 6,000 convolutional filters matched 13 different motif families, 7 of which were the same as for the human kidney (<xref ref-type="fig" rid="F4">Fig 4a,b</xref>, <xref ref-type="supplementary-material" rid="SD1">S5</xref>). Again, we found that motifs that did not match any database motifs were very CpG-rich and often resembled known motifs such as ETS family motifs (<xref ref-type="supplementary-material" rid="SD1">Fig S6</xref>), and in their absence the fraction of variance explained is reduced from 29% to 18%.</p><p id="P19">We categorized cell types as adipose, connective, endocrine, endothelial, epithelial, exocrine, immune, macroglia, muscle, neuron and pericyte (<xref ref-type="supplementary-material" rid="SD1">Table S2</xref>). Dimensionality reduction of the influence score matrix reveals three distinct groups: immune cells, neurons, and the remaining cells (<xref ref-type="fig" rid="F4">Fig 4c</xref>), consistent with the expression analysis (<xref ref-type="bibr" rid="R34">34</xref>). The highest influence scores are found for ETS, followed by KLF and YY1 (<xref ref-type="supplementary-material" rid="SD1">Fig S5</xref>). We analyzed all promoters in the dataset for their motif composition (<xref ref-type="sec" rid="S11">Methods</xref>). E2F was the most abundant motif, whereas YY1, TBX/2, and ETS/1 were specifically found in subsets of promoters (<xref ref-type="fig" rid="F5">Fig 5a</xref>). Interestingly, there were subsets of promoters that were specifically enriched for IRF/1 and SPI only, respectively (<xref ref-type="supplementary-material" rid="SD1">Fig S7</xref>). GO-term analysis of these promoters showed an enrichment for immune-related GO terms (<xref ref-type="supplementary-material" rid="SD1">Fig S7</xref>), confirming the role of these motif families in immune cell function (<xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R36">36</xref>).</p><p id="P20">We hypothesized that in addition to having higher activity in specific cell types, the identified motifs would also be associated with distinct sets of cellular processes. We obtained 16,610 gene lists representing a diverse set of processes from the Gene Ontology (GO) database (<xref ref-type="bibr" rid="R37">37</xref>), and for each list we calculated the correlation between the average expression of the genes and influence scores across pools. We kept the terms with the top 1% of correlation scores, and we found that the motifs segregated into two main clusters, while the GO terms fall into three groups (<xref ref-type="fig" rid="F5">Fig 5b</xref>). Reassuringly, the influence scores for the motifs that are highest in immune cells were positively correlated with genes associated with immune related terms. The motifs in this group (ETS, SPI, YY1, IRF) have previously been reported to be important for immune cells (<xref ref-type="bibr" rid="R13">13</xref>,<xref ref-type="bibr" rid="R26">26</xref>,<xref ref-type="bibr" rid="R35">35</xref>,<xref ref-type="bibr" rid="R36">36</xref>,<xref ref-type="bibr" rid="R38">38</xref>–<xref ref-type="bibr" rid="R40">40</xref>). The second group corresponds to GO terms that are primarily related to differentiation and morphogenesis. This group is characterized by high activity of E2F and KLF. The third group is more difficult to characterize and we are unsure about the biological interpretation.</p><p id="P21">Comparison of TF expression levels and motif activity scores reveals several known regulatory principles (<xref ref-type="fig" rid="F5">Fig. 5c</xref>). For example, the TFs with highest correlation with ETS/1 influence scores are Elf1, Elf4 and Fli1. The high scores for ETS/1 in immune cells suggest that these TFs play a role in immune cell function. Indeed, Elf1 (<xref ref-type="bibr" rid="R41">41</xref>), Elf4 (<xref ref-type="bibr" rid="R42">42</xref>), and Fli1 (<xref ref-type="bibr" rid="R43">43</xref>) have all been described to play a role in regulating transcriptional programmes related to the immune system. TFs with high correlations with KLF/SP/2 influence scores include Sp1 and Sp3, which have previously been suggested to act cooperatively to regulate downstream targets (<xref ref-type="bibr" rid="R44">44</xref>). In other cases, expression level can distinguish between TF influences: both Yy1 and Yy2 are similarly correlated to YY1 family influence levels, and they bind similar motifs (<xref ref-type="bibr" rid="R45">45</xref>), but Yy1 has higher expression levels, making it more likely to be the TF with a higher influence on downstream expression.</p></sec><sec id="S8"><title>Identification of distal regulatory motifs in mouse cerebral cortex</title><p id="P22">To demonstrate the versatility of scover beyond analyzing promoters and scRNAseq data, we used it to infer regulatory motifs from open chromatin by analyzing data from mouse cerebral cortex collected by Chen et al using SNARE-seq (<xref ref-type="bibr" rid="R7">7</xref>). The cortex is organized in layers with distinct functions and we grouped cell types based on these categories. The dataset contains cells from both postnatal day 0 (P0) and adult, and we processed both time points after running the analyses separately. Since we were interested in distal enhancers, only 152,133 loci in P0 and 174,631 loci in adult that were outside the [-8 kb, 2kb] region relative to annotated TSSs were considered.</p><p id="P23">For P0 we found 19 motif clusters and for adult we found 16, with 10 found for both time points (<xref ref-type="fig" rid="F6">Fig 6a</xref>). For P0 11% and for adult 9.65% of convolutional filters matched a known motif (<xref ref-type="supplementary-material" rid="SD1">Fig S8</xref>), and we again found that many of the non-matching filters correspond to partial matches of known motifs (<xref ref-type="supplementary-material" rid="SD1">Fig S9</xref>). During development the mouse cerebral cortex undergoes changes in gene expression (<xref ref-type="bibr" rid="R46">46</xref>,<xref ref-type="bibr" rid="R47">47</xref>). We hypothesized that there would be concomitant changes in the landscape of distant regulatory elements. Analyzing open chromatin loci across the datasets, we found that the majority of P0 and adult open chromatin regions do not overlap (<xref ref-type="supplementary-material" rid="SD1">Fig S10</xref>).</p><p id="P24">The fraction of variance explained by the model is similar to the kidney scRNAseq data with 19% for P0 and 10% for adult. As expected, the motifs identified had lower CpG-content than the ones found at promoters (<xref ref-type="supplementary-material" rid="SD1">Fig S11</xref>). We found more motifs than for the two scRNAseq datasets, suggesting a greater diversity than for promoters although it is worth keeping in mind that there were almost an order of magnitude more distal regulatory elements here. Similar to the scRNAseq data, there is a range of almost two orders of magnitude in the influence scores of the different clusters, with Ebox, CTCF, and KLF near the high end, and ETS and E2F near the low end (<xref ref-type="supplementary-material" rid="SD1">Fig S12</xref>).</p><p id="P25">Comparing the P0 and adult datasets, we identified several differences in found motif families. For instance, CREB and EGR were among the identified motif families in adult, but not in P0 mice. TFs from these families have been implicated in neuronal plasticity (<xref ref-type="bibr" rid="R48">48</xref>–<xref ref-type="bibr" rid="R51">51</xref>), and Egr1 expression goes up drastically in neurons throughout cortical development (<xref ref-type="bibr" rid="R52">52</xref>). Similarly, CCAAT/CEBP motifs were found in the adult, and one of its associated TFs is Hlf which increases in expression during mouse development and is implicated in brain development (<xref ref-type="bibr" rid="R53">53</xref>). Taken together, the analysis reveals several differences in terms of distal regulatory motifs between P0 and adult mouse cerebral cortex, but more work and data is required to validate and interpret these differences.</p><p id="P26">To identify groups of enhancers with similar motif composition, we embedded the rectified motif scores for each region using UMAP (<xref ref-type="fig" rid="F6">Fig 6c, d</xref>). There were large differences in how widely a motif family was observed across peaks: MEF2 motifs were spread across a large number of loci in both P0 and adult mouse peaks, and EGR was widely observed in adult mouse peaks. Conversely, hox transcription factor motifs from HD/12 and HD/14 motif families had a more localized pattern, suggesting that they activate smaller subsets of loci with distinct regulatory motifs. Interestingly, one group of regions constitute a clear group of outliers in the UMAP for P0 mouse peaks and we find that they are characterized by high scores for the CTCF-motif (<xref ref-type="fig" rid="F6">Fig 6c</xref>). This result suggests that insulator regions differ in terms of their sequence composition compared to other distal open chromatin regions.</p></sec></sec><sec id="S9" sec-type="discussion"><title>Discussion</title><p id="P27">Here, we have presented a convolutional neural network model, and an exploration of inferred regulatory motifs and their activities across cell types using single cell data. Previous attempts to develop quantitative models of regulatory motifs have been restricted to tissue level or cell lines (<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R13">13</xref>), or to immune cells (<xref ref-type="bibr" rid="R26">26</xref>,<xref ref-type="bibr" rid="R38">38</xref>), and they frequently use histone marks rather than sequence to predict expression levels (<xref ref-type="bibr" rid="R54">54</xref>). Unlike existing motif analysis methods which mainly identify overrepresented motifs in sequences, scover also determines the relative impact of each motif on gene expression. By comparing to gene expression levels these scores can be used to pinpoint putative TFs that are related to the observed pattern.</p><p id="P28">Since we used a <italic>de novo</italic> strategy for finding motifs we expect that it will be especially helpful for researchers studying organisms where regulatory motifs are poorly annotated. For mouse and human non-matching motifs make a meaningful contribution, but from our results it is not yet clear what they represent. Some of them are likely good matches that have failed to converge, whereas others pick out CpG dinucleotides which are known to be associated with higher expression at promoters (<xref ref-type="bibr" rid="R6">6</xref>). Our results are also consistent with other studies that have categorized TFs as either preferentially binding promoters or enhancers (<xref ref-type="bibr" rid="R38">38</xref>). One such example is HNF4A, which is important in the kidney (<xref ref-type="bibr" rid="R55">55</xref>), but most likely due to its preference to distal enhancers it was not identified by our method (<xref ref-type="bibr" rid="R56">56</xref>).</p><p id="P29">Interestingly, there are several trends that are common to the kidney and the Tabula Muris datasets. Immune cells have regulatory profiles distinct from other cell types and they have the highest influence for ETS motifs, while KLF and ZFX have low impact (<xref ref-type="fig" rid="F2">Fig 2a</xref>, <xref ref-type="fig" rid="F4">4a</xref>). More generally, for the seven motif clusters (CREB/ATF/1, ETS 1 &amp; 2, KLF, E2F, YY1, ZFX) that are found in both datasets, the influence scores are in good agreement with the highest impact for the combined ETS families, followed by YY1 or KLF. A notable difference is that the quality of the fit provided by the Tabula Muris is substantially better. Since the two datasets have similar number of cells and similar sparsity after pooling, we conjecture that this is due to the greater diversity of cell types in the Tabula Muris and the use of different experimental platforms.</p><p id="P30">Although larger and more deeply sequenced datasets could allow for the discovery of additional motif clusters and better model fits, there are inherent limitations to the accuracy by which gene expression can be predicted from endogenous sequences. First, studies of gene expression noise have estimated that some of the variability is inevitable due to random fluctuations (<xref ref-type="bibr" rid="R57">57</xref>). Second, there are many other mechanisms of gene regulation that are not included in proximal sequence data, e.g. transcript sequence features that influence mRNA stability (<xref ref-type="bibr" rid="R58">58</xref>), TF concentrations, distal enhancers, histones, miRNAs, and RNA binding proteins. Third, we have only used one promoter for each gene, even though it is well known that many genes have alternative TSSs which could drastically impact regulation. Nevertheless, our results are consistent with a recent study of mouse hematopoietic cells which used epigenetic data to estimate that ~50% of the variance in expression can be explained by the endogenous promoter (<xref ref-type="bibr" rid="R54">54</xref>).</p></sec><sec id="S10" sec-type="conclusions"><title>Conclusions</title><p id="P31">We have demonstrated that a convolutional neural network can be used to simultaneously infer regulatory motif sequences and their relative importance from single-cell data. Using scRNAseq data, this allows us to find TF binding motifs at promoters along with their impact on gene expression levels. Application to data from human kidney and multiple mouse tissues revealed common regulatory patterns. Finally, we demonstrated that the framework can also be used for scATACseq data, and analyses of data from the mouse visual cortex allowed us to characterize motifs found at proximal and distal regulatory regions across development.</p></sec><sec id="S11" sec-type="methods"><title>Methods</title><sec id="S12"><title>Pooling</title><p id="P32">To reduce the sparsity, pools are created by grouping K-nearest neighbors of an initial selection of cells ('seed cells') calculated using a shared PCA embedding into <italic>p</italic> equally sized groups of <italic>q</italic> cells (<xref ref-type="fig" rid="F1">Fig 1a</xref>). The expression values are the log-transformed sum of the non-log-transformed expression values of the single cells in that pool. The 'seed cells' for the pooled dataset are selected using geometric sketching (<xref ref-type="bibr" rid="R24">24</xref>), which evenly samples cells from an embedding of the single cell dataset. The embedding selected for 'seed cell' sampling is slightly different for the RNA and ATAC datasets. As the RNA datasets consist of concatenated datasets of different batches, batch-balanced K-nearest neighbor algorithm BBKNN (<xref ref-type="bibr" rid="R59">59</xref>) was run with default parameters, which was used subsequently to calculate a batch-balanced UMAP dimensionality reduction. 1000 'seed cells' were sampled using geometric sketching for both the human kidney and Tabula Muris datasets across this batch-balanced UMAP. For both P0 and adult SNARE datasets, 100 'seed cells' were sampled for each dataset using a PCA embedding.</p></sec><sec id="S13"><title>One-hot encoding of nucleotide sequences</title><p id="P33">For the pooled transcriptomic datasets the sequences correspond to 500 bp upstream and 500 bp downstream of gene TSS (for a total size of 1000 bp per sequence). For the Tabula Muris and SNARE-seq datasets, sequences were isolated from the mm10 reference genome using the Ensembl v.79 annotations (<xref ref-type="bibr" rid="R60">60</xref>). For the human kidney dataset, sequences were isolated from the hg38 reference genome using the Ensembl v.86 annotations. For the pooled accessibility datasets, each sequence corresponded to 250 bp around the center of the peak region. Input nucleotide sequences are one-hot encoded into a 2D matrix such that the columns correspond to [A, C, G, T], respectively. For each position in the sequence, the corresponding row in the matrix will have a 1 in the column corresponding to the original nucleotide and a 0 otherwise (<xref ref-type="fig" rid="F1">Fig. 1a</xref>).</p></sec><sec id="S14"><title>Convolutional neural network architecture</title><p id="P34">Scover is a convolutional neural network composed of a convolutional layer, a rectified linear unit (ReLU) activation layer, a global maximum pooling layer, and a fully connected layer with bias and multiple output channels. The convolutional layer takes as input the one-hot encoded DNA sequences, and the fully connected layer outputs predictions across the pools. Sequentially, the neural network carries out the following operations: <list id="L1" list-type="order"><list-item><p id="P35">2D convolution without bias values with <italic>d</italic> convolutional filters of size (<italic>m</italic>, 4)</p></list-item><list-item><p id="P36">A ReLU activation layer that sets negative values to 0</p></list-item><list-item><p id="P37">A global maximum pooling layer that takes the maximum value for each of <italic>d</italic> rectified convolutional operations</p></list-item><list-item><p id="P38">A fully connected layer with bias values with <italic>d</italic> inputs and <italic>p</italic> outputs</p></list-item></list>
</p><p id="P39">The number of output pools <italic>p</italic> depends on the number of cells per pool <italic>q</italic>. The default values for running the model are <italic>d</italic> = 600, <italic>m</italic> = 12 and <italic>q</italic> = 100. However, it is recommended that the user explore different combinations.</p></sec><sec id="S15"><title>Training the neural network</title><p id="P40">The neural network is trained in two stages: Bayesian hyperparameter optimization, and a training stage using the best hyperparameters.</p><p id="P41">In the first stage, the hyperparameters are optimized through Bayesian hyperparameter optimization (<xref ref-type="bibr" rid="R61">61</xref>,<xref ref-type="bibr" rid="R62">62</xref>). The hyperparameter search is implemented using Ray Tune (<xref ref-type="bibr" rid="R63">63</xref>) and hyperopt (<xref ref-type="bibr" rid="R64">64</xref>) and runs distributed across available GPUs. For hyperparameter tuning, we use the ASHA algorithm, which applies aggressive early-stopping to trials that do not seem to produce good results (<xref ref-type="bibr" rid="R65">65</xref>), finding optimal hyperparameters faster than random search.</p><p id="P42">The division of the dataset into training, test, and validation sets was performed using cross-validation. The dataset was divided into <italic>K</italic> folds (default: 10) to create the 'outer test' set (10% of data each) and the 'inner' sets (10% of data each). Each 'inner' set was consequently split into a training and a validation set of 80% and 20% of the 'inner' set respectively. The 'inner' sets were used for the hyperparameter search for each outer fold.</p><p id="P43">The hyperparameter search was inspired by a previous neural network (<xref ref-type="bibr" rid="R62">62</xref>). The neural network parameters were initialized <italic>num_calibrations</italic> (default: 100) times for each fold with weights suggested by hyperopt based on previous runs for the fold. The prior for the learning rate is log uniformly distributed over the interval <italic>[epsilon_min, epsilon_max]</italic> (default: [5e-4, 5e-2]). The prior for the convolutional filter weights is normally distributed with mean 0 and standard deviation <italic>sigma_motifs<sup>2</sup>,</italic> where <italic>sigma_motifs</italic> is sampled from a log uniform distribution over the interval <italic>[sigma_motifs_min, sigma_motifs_max]</italic> (default: [1e-7, 1e-3]). Similarly, the prior for the fully connected layer weights is normally distributed with mean 0 and standard deviation <italic>sigma_net</italic><sup>2</sup>, where <italic>sigma_net</italic> is sampled from a log uniform distribution over the interval <italic>[sigma_net_min, sigma_net_max]</italic> (default: [1e-5, 1e-2]). The fully connected layer biases are initialized with the value 1e-5. The batch size was chosen by hyperopt from choices [64, 128, 256, 512]. Each network is trained for a number of epochs (default: 40). For each fold the lowest validation set errors are calculated. The optimal network initialization is chosen as the network initialization with the lowest mean error for the validation set.</p><p id="P44">During the training stage, the network is initialized using the optimal network initialization (the learning rate, batch size, <italic>sigma_motifs,</italic> and <italic>sigma_net)</italic> for each fold. For each fold, the network is trained for the same amount of epochs as before on the inner training set, and network parameters for each fold are saved at the time point of lowest validation set error. The network uses a mean squared error loss function, and the network parameters are optimized using the Adam optimizer (<xref ref-type="bibr" rid="R66">66</xref>). The network is trained with an early stopping strategy with patience 1. Prediction metrics are calculated for each fold separately using the prediction for the held-out 'outer' test set.</p><p id="P45">To ensure that the motifs identified by scover capture biologically meaningful signals, we carry out a control experiment where we train scover using a dataset where the nucleotide order of the input sequences is permuted. Small differences in correlation between the predicted and observed values for the real and permuted data is a strong indication that the identified motifs are spurious matches and that the model has failed to identify an informative model. For all of the datasets considered in this manuscript, the mean difference in the squared Pearson correlation using the real and permuted data was 0.098 for the kidney dataset, 0.21 for the Tabula Muris dataset, 0.120 for the p0 SNARE-seq dataset, and 0.063 for the adult SNARE-seq dataset. Of these, the smallest changes are for the SNARE-seq datasets, where the mean squared Pearson correlation went down by 63% for both datasets.</p></sec><sec id="S16"><title>Alignment of motifs</title><p id="P46">To extract position weight matrices corresponding to the convolutional filters, rectified activations are calculated for each model by convolving the convolutional filters across the training set sequences and passing the output through a ReLU layer. Consequently, for each sequence, the subsequence of length <italic>m</italic> that generates the highest positive activation is isolated for each convolutional filter. Sequences that do not generate a positive activation score for a given convolutional filter are not included. For each convolutional filter, the scores are converted to position frequency matrices (PFMs) of size 4 x <italic>m</italic> by summing the occurrences of each nucleotide at the corresponding sequence position. The PFMs are converted to position probability matrices (PPMs) by dividing each entry in the PFM by the sum of the nucleotide frequencies for the corresponding sequence position. The concatenated PPMs of the 10 models are then stored in a single MEME-formatted file. The motifs are aligned to MEME-formatted motif database files from CIS-BP (<xref ref-type="bibr" rid="R27">27</xref>) using the Tomtom tool from the MEME suite (<xref ref-type="bibr" rid="R67">67</xref>) using the argument -thresh 0.05. Sequence logos were visualized using R package <italic>ggseqlogo</italic> (<xref ref-type="bibr" rid="R68">68</xref>).</p></sec><sec id="S17"><title>Leave-one-out analysis and influence scores</title><p id="P47">After training <italic>r</italic> models, each model is reinitialized using the parameters from the optimal training point (the point at which the MSE on the validation set was the lowest). The prediction for motif <italic>i</italic> in pool <italic>j</italic> and sequence <italic>k</italic> is denoted <italic>b<sub>ijk</sub>.</italic> We then set all parameters related to motif <italic>i</italic> to zero and calculate the perturbed score <italic>c<sub>ijk</sub></italic> for each pool. The influence score for motif <italic>i</italic> in pool <italic>j</italic> is calculated as <inline-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mspace width="0.3em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> where <italic>N</italic> is the number of sequences in the validation set. The influence scores from <italic>d</italic> motifs from <italic>K</italic> models are concatenated to get a matrix with <italic>dK</italic> rows and <italic>p</italic> columns. For each motif, the mean influence per cell type is calculated as an average from the corresponding pools. For visualization purposes we also calculate a <bold>z</bold>-transformed version (based on cell types). Aligned motifs were assigned to a previously specified set of motif clusters (<xref ref-type="bibr" rid="R28">28</xref>). To ensure reproducibility, motif clusters are excluded if they contain motifs from less than half of the <italic>K</italic> models. Lastly, for most of the downstream analysis, motifs that did not align to known motifs are excluded. Influence scores for motifs that belong to the same motif family were summed to generate an 'aggregate motif family influence' matrix with <italic>num_motif_families</italic> rows and <italic>p</italic> columns. Similar to before, this matrix is then converted to include mean aggregate motif family influence scores across cell types or cell type categories, and for visualization purposes, these scores are z-transformed.</p></sec><sec id="S18"><title>Sequence ‘motif space’ analysis</title><p id="P48">For the kidney and tabula muris experiments, promoter analysis was carried out by iterating over all sequences using the 10 models: the calculated scores were the rectified max-pooled outputs of the convolutional layer for each model. The outputs were concatenated in the motif dimension to create an array of size (n_genes x 6000). "Motif space" UMAPs were calculated using this matrix using R package <italic>umap</italic> (<xref ref-type="bibr" rid="R69">69</xref>).</p></sec><sec id="S19"><title>Analysis of region overlap</title><p id="P49">The R packages ComplexHeatmap (<xref ref-type="bibr" rid="R70">70</xref>) and GenomicRegions (<xref ref-type="bibr" rid="R71">71</xref>) were used to calculate and plot the overlap in base pairs between the 250bp regions in the datasets used to train, validate, and test the models for SNARE P0 and adult.</p></sec><sec id="S20"><title>Proliferation and proximal tubule marker analysis</title><p id="P50">We used the following genes as markers of cell proliferation: MKI67, PLK1, E2F1, FOXM1, MCM2, MCM7, BUB1, CCNE1, CCND1, CCNB1, and TOP2A (<xref ref-type="bibr" rid="R72">72</xref>). The proliferation score of each pool was calculated as the average expression of this set of genes in that pool. Similarly, we used DLL1, ACAT1, PKD1, NOTCH2, AQP11 and HEYL for the proximal tubule signature genes.</p></sec><sec id="S21"><title>Gene Ontology analysis</title><p id="P51">The GO terms for mouse were downloaded from Ensembl Biomart. We used all categories with fewer than 50 genes for the analysis. For each GO term, the correlations between the expression of the GO term genes (across pools) and the aggregate motif influences of each motif family (across pools) were calculated. The top 500 GO terms in terms of their maximum correlation were hierarchically clustered based on euclidean distance, after which the tree was cut with <italic>k</italic> = 3 to form the clusters.</p></sec><sec id="S22"><title>Analysis of co-occurring motif families</title><p id="P52">To investigate co-occurring motif families in the Tabula Muris dataset, the max-pooled rectified outputs of the convolutional layers were first aggregated per motif family. Then, sets of genes with motif occurrence were selected for each motif family by filtering for genes with a score above half of the maximum gene score for that motif family. The upset plot was plotted using the R package UpsetR (<xref ref-type="bibr" rid="R73">73</xref>).</p></sec><sec id="S23"><title>Pseudotime analysis</title><p id="P53">The developing nephron compartment of the fetal kidney dataset was subset to cells with a developmental relationship to cap mesenchyme (excluding ureteric bud). A two dimensional UMAP embedding was calculated in scanpy (<xref ref-type="bibr" rid="R22">22</xref>), and was clustered using k-means clustering (k=10). Pseudotime trajectories were computed with Slingshot (<xref ref-type="bibr" rid="R74">74</xref>) using the cluster corresponding to cap mesenchyme as a starting cluster. Proximal tubule pseudotime values were generated for cells along a continuous trajectory path from cap mesenchyme to proximal tubule. The pseudotime values were averaged across the same cells that generated the pools in the combined human kidney dataset. In some cases, not all the cells in the pool had corresponding pseudotime values, as some cells fell outside of the k-means clusters along the principal curve corresponding to the proximal tubule pseudotime trajectory. The pseudotime values were only calculated for pools that had at least 100 cells (out of 120 cells per pool) with pseudotime values. The pooled (averaged) pseudotime values were subsequently normalized to range [0,1].</p></sec><sec id="S24"><title>Data processing</title><sec id="S25"><title>Human kidney dataset</title><p id="P54">The fetal and adult kidney datasets were concatenated in the cell dimension to create a matrix of 33,660 features by 67,465 cells. A PCA was run and the first PC was ignored for further analysis as this correlated heavily with the total amount of RNA counts in the cell. The pooling strategy is described above. After pooling the datasets with <italic>q</italic> = 120 cells per pool, the dataset was filtered by excluding genes that were expressed in &lt; 5% of pools. Another filter was applied: genes that were expressed in &lt; 16% of pools were only retained if the mean non-zero log-transformed expression was higher than log10(3). This resulted in a dataset of 18,150 genes by 1,000 pools. Running a full hyperparameter sweep with cross-validation using <italic>d</italic> = 600 and <italic>m</italic> = 12 took a few hours when run across 8 NVIDIA Tesla V100 GPUs.</p></sec><sec id="S26"><title>Tabula Muris dataset</title><p id="P55">20 Tabula Muris FACS-sorted Smart-Seq2 datasets were concatenated in the cell dimension. 297 erythrocytes were excluded from further analysis given their low counts, resulting in a matrix of 23,433 genes by 44,652 cells. The pooling strategy is described above. After pooling the dataset with <italic>q</italic> = 80 cells per pool, the data was filtered by removing genes that were expressed in &lt;3% of pools. Another filter was applied: genes that were expressed in &lt; 8% of pools were only retained if the mean non-zero log-transformed expression was higher than log10(4). The final pooled dataset had a size of 17,270 genes by 1,000 pools. When training the model we used <italic>d</italic> = 600 and <italic>m</italic> = 12.</p></sec><sec id="S27"><title>SNARE-seq dataset</title><p id="P56">The P0 and adult mouse datasets were both pooled with <italic>q</italic> = 100 cells per pool using the strategy described above. Both datasets were filtered by excluding peaks that were present in &lt; 6% of pools. To ensure that only distal peaks were included we removed any peak found in the [-8kb, 2kb] region relative to any TSS found in the Ensembl annotations for mm10 (v.96). Furthermore, we excluded all non-neuronal cell types from the analysis, but we included the inhibitory neurons when fitting the model even though only the excitatory neurons were used for the downstream analyses (<xref ref-type="supplementary-material" rid="SD1">Table S4</xref>). This resulted in a final pooled dataset size of 152,133 peaks by 100 pools for the P0 mouse dataset and 174,631 peaks by 100 pools for the adult mouse dataset. When training the model we used <italic>d</italic> = 600 and <italic>m</italic> = 12 for both P0 and adult mouse datasets.</p></sec></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary figures</label><media xlink:href="EMS144663-supplement-Supplementary_figures.pdf" mimetype="application" mime-subtype="pdf" id="d23aAdFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S28"><title>Acknowledgements</title><p>We would like to thank Song Chen and Yingxi Lin for helpful discussions about the SNARE-seq data and Irina Abnizova, Ilias Georgakopolous-Soares, Leopold Parts and Nikos Patikas for comments and suggestions on the manuscript and the package. We are also grateful to Simon Murray for testing the repository and to Jimmy Lee for sharing code.</p><sec id="S29"><title>Funding</title><p>JH was supported by a grant for "Search tools for scRNA-seq data" (2018-183503) from the Chan Zuckerberg Initiative. MH, JH and NKL were funded by a core grant from the Wellcome Trust, and JH received a PhD studentship from the Wellcome Trust. MH, NKL, SR and VC would like to acknowledge funding from a Newton Mobility Grant (NI160206) from the Royal Society and the Thai Office of the Higher Education Commission.</p></sec></ack><sec id="S30" sec-type="data-availability"><title>Availability of data and materials</title><sec id="S31" sec-type="data-availability"><title>Code availability</title><p id="P57">The neural network is implemented in pytorch, examples and code are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jacobhepkema/scover">https://github.com/jacobhepkema/scover</ext-link>. Code that was used to generate the figures is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jacobhepkema/scoverplots">https://github.com/jacobhepkema/scoverplots</ext-link>. Plots were generated using ggplot (<xref ref-type="bibr" rid="R75">75</xref>), pheatmap, gghalves, and other packages described above.</p></sec><sec id="S32" sec-type="data-availability"><title>Data availability</title><p id="P58">The human kidney datasets were downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.kidneycellatlas.org/">https://www.kidneycellatlas.org/</ext-link>. We downloaded 20 Tabula Muris FACS-sorted Smart-Seq2 datasets from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5829687.v8">https://doi.org/10.6084/m9.figshare.5829687.v8</ext-link>. We downloaded the SNARE-seq data from the Gene Expression Omnibus database under accession number GSE126074.</p></sec></sec><fn-group><title>Declarations</title><fn id="FN1"><p id="P59"><bold>Ethical approval and consent to participate</bold></p><p id="P60">Not applicable</p></fn><fn id="FN2" fn-type="conflict"><p id="P61"><bold>Competing interests</bold></p><p id="P62">The authors declare no competing interests.</p></fn><fn id="FN3" fn-type="con"><p id="P63"><bold>Author contributions</bold></p><p id="P64">The project was conceived by JH, NKL and MH. JH, NKL and SR wrote the code. JH and MH analyzed the data. BJS and MRC assisted with the analysis of the kidney data. VC, MRC and MH supervised the research. JH and MH wrote the manuscript with input from the other authors.</p></fn></fn-group><ref-list><title>Bibliography</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>SA</given-names></name><name><surname>Jolma</surname><given-names>A</given-names></name><name><surname>Campitelli</surname><given-names>LF</given-names></name><name><surname>Das</surname><given-names>PK</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name><name><surname>Albu</surname><given-names>M</given-names></name><etal/></person-group><article-title>The human transcription factors</article-title><source>Cell</source><year>2018</year><month>Feb</month><day>8</day><volume>172</volume><issue>4</issue><fpage>650</fpage><lpage>65</lpage></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slattery</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Dantas Machado</surname><given-names>AC</given-names></name><name><surname>Gordân</surname><given-names>R</given-names></name><name><surname>Rohs</surname><given-names>R</given-names></name></person-group><article-title>Absence of a simple code: how transcription factors read the genome</article-title><source>Trends Biochem Sci</source><year>2014</year><month>Sep</month><volume>39</volume><issue>9</issue><fpage>381</fpage><lpage>99</lpage></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jayaram</surname><given-names>N</given-names></name><name><surname>Usvyat</surname><given-names>D</given-names></name><name><surname>Martin</surname><given-names>ACR</given-names></name></person-group><article-title>Evaluating tools for transcription factor binding site prediction</article-title><source>BMC Bioinformatics</source><year>2016</year><month>Nov</month><day>2</day><volume>17</volume><issue>1</issue><fpage>547</fpage></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wunderlich</surname><given-names>Z</given-names></name><name><surname>Mirny</surname><given-names>LA</given-names></name></person-group><article-title>Different gene regulation strategies revealed by analysis of binding motifs</article-title><source>Trends Genet</source><year>2009</year><month>Oct</month><day>6</day><volume>25</volume><issue>10</issue><fpage>434</fpage><lpage>40</lpage></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beer</surname><given-names>MA</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name></person-group><article-title>Predicting gene expression from sequence</article-title><source>Cell</source><year>2004</year><month>Apr</month><day>16</day><volume>117</volume><issue>2</issue><fpage>185</fpage><lpage>98</lpage></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agarwal</surname><given-names>V</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><article-title>Predicting mRNA Abundance Directly from Genomic Sequence Using Deep Convolutional Neural Networks</article-title><source>Cell Rep</source><year>2020</year><month>May</month><day>19</day><volume>31</volume><issue>7</issue><elocation-id>107663</elocation-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Lake</surname><given-names>BB</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><article-title>High-throughput sequencing of the transcriptome and chromatin accessibility in the same cell</article-title><source>Nat Biotechnol</source><year>2019</year><month>Dec</month><volume>37</volume><issue>12</issue><fpage>1452</fpage><lpage>7</lpage></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium, Overall coordination, Logistical coordination, Organ collection and processing, Library preparation and sequencing, Computational data analysis</collab><etal/></person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title><source>Nature</source><year>2018</year><month>Oct</month><day>3</day><volume>562</volume><issue>7727</issue><fpage>367</fpage><lpage>72</lpage></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stewart</surname><given-names>BJ</given-names></name><name><surname>Ferdinand</surname><given-names>JR</given-names></name><name><surname>Young</surname><given-names>MD</given-names></name><name><surname>Mitchell</surname><given-names>TJ</given-names></name><name><surname>Loudon</surname><given-names>KW</given-names></name><name><surname>Riding</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Spatiotemporal immune zonation of the human kidney</article-title><source>Science</source><year>2019</year><month>Sep</month><day>27</day><volume>365</volume><issue>6460</issue><fpage>1461</fpage><lpage>6</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>González-Blas</surname><given-names>CB</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Imrichova</surname><given-names>H</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><etal/></person-group><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nat Methods</source><year>2017</year><month>Nov</month><volume>14</volume><issue>11</issue><fpage>1083</fpage><lpage>6</lpage></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinz</surname><given-names>S</given-names></name><name><surname>Benner</surname><given-names>C</given-names></name><name><surname>Spann</surname><given-names>N</given-names></name><name><surname>Bertolino</surname><given-names>E</given-names></name><name><surname>Lin</surname><given-names>YC</given-names></name><name><surname>Laslo</surname><given-names>P</given-names></name><etal/></person-group><article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title><source>Mol Cell</source><year>2010</year><month>May</month><day>28</day><volume>38</volume><issue>4</issue><fpage>576</fpage><lpage>89</lpage></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelley</surname><given-names>DR</given-names></name><name><surname>Snoek</surname><given-names>J</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name></person-group><article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title><source>Genome Res</source><year>2016</year><month>Jul</month><volume>26</volume><issue>7</issue><fpage>990</fpage><lpage>9</lpage></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>AD</given-names></name><name><surname>Sumazin</surname><given-names>P</given-names></name><name><surname>Xuan</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>MQ</given-names></name></person-group><article-title>DNA motifs in human and mouse proximal promoters predict tissue-specific expression</article-title><source>Proc Natl Acad Sci USA</source><year>2006</year><month>Apr</month><day>18</day><volume>103</volume><issue>16</issue><fpage>6275</fpage><lpage>80</lpage></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Natarajan</surname><given-names>A</given-names></name><name><surname>Yardimci</surname><given-names>GG</given-names></name><name><surname>Sheffield</surname><given-names>NC</given-names></name><name><surname>Crawford</surname><given-names>GE</given-names></name><name><surname>Ohler</surname><given-names>U</given-names></name></person-group><article-title>Predicting cell-type-specific gene expression from regions of open chromatin</article-title><source>Genome Res</source><year>2012</year><month>Sep</month><volume>22</volume><issue>9</issue><fpage>1711</fpage><lpage>22</lpage></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madsen</surname><given-names>JGS</given-names></name><name><surname>Rauch</surname><given-names>A</given-names></name><name><surname>Van Hauwaert</surname><given-names>EL</given-names></name><name><surname>Schmidt</surname><given-names>SF</given-names></name><name><surname>Winnefeld</surname><given-names>M</given-names></name><name><surname>Mandrup</surname><given-names>S</given-names></name></person-group><article-title>Integrated analysis of motif activity and gene expression changes of transcription factors</article-title><source>Genome Res</source><year>2018</year><month>Feb</month><volume>28</volume><issue>2</issue><fpage>243</fpage><lpage>55</lpage></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balwierz</surname><given-names>PJ</given-names></name><name><surname>Pachkov</surname><given-names>M</given-names></name><name><surname>Arnold</surname><given-names>P</given-names></name><name><surname>Gruber</surname><given-names>AJ</given-names></name><name><surname>Zavolan</surname><given-names>M</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group><article-title>ISMARA: automated modeling of genomic signals as a democracy of regulatory motifs</article-title><source>Genome Res</source><year>2014</year><month>May</month><volume>24</volume><issue>5</issue><fpage>869</fpage><lpage>84</lpage></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eraslan</surname><given-names>G</given-names></name><name><surname>Avsec</surname><given-names>Ž</given-names></name><name><surname>Gagneur</surname><given-names>J</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>Deep learning: new computational modelling techniques for genomics</article-title><source>Nat Rev Genet</source><year>2019</year><month>Jul</month><volume>20</volume><issue>7</issue><fpage>389</fpage><lpage>403</lpage></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marx</surname><given-names>V</given-names></name></person-group><article-title>Machine learning, practically speaking</article-title><source>Nat Methods</source><year>2019</year><month>Jun</month><volume>16</volume><issue>6</issue><fpage>463</fpage><lpage>7</lpage></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>KM</given-names></name><name><surname>Cofer</surname><given-names>EM</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Troyanskaya</surname><given-names>OG</given-names></name></person-group><article-title>Selene: a PyTorch-based deep learning library for sequence data</article-title><source>Nat Methods</source><year>2019</year><month>Apr</month><volume>16</volume><issue>4</issue><fpage>315</fpage><lpage>8</lpage></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelley</surname><given-names>DR</given-names></name><name><surname>Reshef</surname><given-names>YA</given-names></name><name><surname>Bileschi</surname><given-names>M</given-names></name><name><surname>Belanger</surname><given-names>D</given-names></name><name><surname>McLean</surname><given-names>CY</given-names></name><name><surname>Snoek</surname><given-names>J</given-names></name></person-group><article-title>Sequential regulatory activity prediction across chromosomes with convolutional neural networks</article-title><source>Genome Res</source><year>2018</year><month>May</month><volume>28</volume><issue>5</issue><fpage>739</fpage><lpage>50</lpage></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Paszke</surname><given-names>A</given-names></name><name><surname>Gross</surname><given-names>S</given-names></name><name><surname>Chintala</surname><given-names>S</given-names></name><name><surname>Chanan</surname><given-names>G</given-names></name><name><surname>Yang</surname><given-names>E</given-names></name><name><surname>DeVito</surname><given-names>Z</given-names></name><etal/></person-group><source>Automatic differentiation in PyTorch</source><conf-name>NIPS 2017</conf-name><year>2017</year></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biol</source><year>2018</year><month>Feb</month><day>6</day><volume>19</volume><issue>1</issue><fpage>15</fpage></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>M3Drop: dropout-based feature selection for scRNASeq</article-title><source>Bioinformatics</source><year>2019</year><month>Aug</month><day>15</day><volume>35</volume><issue>16</issue><fpage>2865</fpage><lpage>7</lpage></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hie</surname><given-names>B</given-names></name><name><surname>Cho</surname><given-names>H</given-names></name><name><surname>DeMeo</surname><given-names>B</given-names></name><name><surname>Bryson</surname><given-names>B</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name></person-group><article-title>Geometric Sketching Compactly Summarizes the Single-Cell Transcriptomic Landscape</article-title><source>Cell Syst</source><year>2019</year><month>Jun</month><day>26</day><volume>8</volume><issue>6</issue><fpage>483</fpage><lpage>493</lpage><elocation-id>e7</elocation-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koo</surname><given-names>PK</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Representation learning of genomic sequence motifs with convolutional neural networks</article-title><source>PLoS Comput Biol</source><year>2019</year><month>Dec</month><day>19</day><volume>15</volume><issue>12</issue><elocation-id>e1007560</elocation-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maslova</surname><given-names>A</given-names></name><name><surname>Ramirez</surname><given-names>RN</given-names></name><name><surname>Ma</surname><given-names>K</given-names></name><name><surname>Schmutz</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Fox</surname><given-names>C</given-names></name><etal/></person-group><article-title>Deep learning of immune cell differentiation</article-title><source>Proc Natl Acad Sci USA</source><year>2020</year><month>Oct</month><day>13</day><volume>117</volume><issue>41</issue><fpage>25655</fpage><lpage>66</lpage></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weirauch</surname><given-names>MT</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><name><surname>Albu</surname><given-names>M</given-names></name><name><surname>Cote</surname><given-names>AG</given-names></name><name><surname>Montenegro-Montero</surname><given-names>A</given-names></name><name><surname>Drewe</surname><given-names>P</given-names></name><etal/></person-group><article-title>Determination and inference of eukaryotic transcription factor sequence specificity</article-title><source>Cell</source><year>2014</year><month>Sep</month><day>11</day><volume>158</volume><issue>6</issue><fpage>1431</fpage><lpage>43</lpage></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vierstra</surname><given-names>J</given-names></name><name><surname>Lazar</surname><given-names>J</given-names></name><name><surname>Sandstrom</surname><given-names>R</given-names></name><name><surname>Halow</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>D</given-names></name><etal/></person-group><article-title>Global reference mapping of human transcription factor footprints</article-title><source>Nature</source><year>2020</year><month>Jul</month><day>29</day><volume>583</volume><issue>7818</issue><fpage>729</fpage><lpage>36</lpage></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Cam</surname><given-names>H</given-names></name><name><surname>Takahashi</surname><given-names>Y</given-names></name><name><surname>Volkert</surname><given-names>T</given-names></name><name><surname>Terragni</surname><given-names>J</given-names></name><name><surname>Young</surname><given-names>RA</given-names></name><etal/></person-group><article-title>E2F integrates cell cycle progression with DNA repair, replication, and G(2)/M checkpoints</article-title><source>Genes Dev</source><year>2002</year><month>Jan</month><day>15</day><volume>16</volume><issue>2</issue><fpage>245</fpage><lpage>56</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brewster</surname><given-names>RC</given-names></name><name><surname>Weinert</surname><given-names>FM</given-names></name><name><surname>Garcia</surname><given-names>HG</given-names></name><name><surname>Song</surname><given-names>D</given-names></name><name><surname>Rydenfelt</surname><given-names>M</given-names></name><name><surname>Phillips</surname><given-names>R</given-names></name></person-group><article-title>The transcription factor titration effect dictates level of gene expression</article-title><source>Cell</source><year>2014</year><month>Mar</month><day>13</day><volume>156</volume><issue>6</issue><fpage>1312</fpage><lpage>23</lpage></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><name><surname>Yan</surname><given-names>J</given-names></name><name><surname>Whitington</surname><given-names>T</given-names></name><name><surname>Toivonen</surname><given-names>J</given-names></name><name><surname>Nitta</surname><given-names>KR</given-names></name><name><surname>Rastas</surname><given-names>P</given-names></name><etal/></person-group><article-title>DNA-binding specificities of human transcription factors</article-title><source>Cell</source><year>2013</year><month>Jan</month><day>17</day><volume>152</volume><issue>1-2</issue><fpage>327</fpage><lpage>39</lpage></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grand</surname><given-names>RS</given-names></name><name><surname>Burger</surname><given-names>L</given-names></name><name><surname>Gräwe</surname><given-names>C</given-names></name><name><surname>Michael</surname><given-names>AK</given-names></name><name><surname>Isbel</surname><given-names>L</given-names></name><name><surname>Hess</surname><given-names>D</given-names></name><etal/></person-group><article-title>BANP opens chromatin and activates CpG-island-regulated genes</article-title><source>Nature</source><year>2021</year><month>Aug</month><volume>596</volume><issue>7870</issue><fpage>133</fpage><lpage>7</lpage></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boros</surname><given-names>J</given-names></name><name><surname>O'Donnell</surname><given-names>A</given-names></name><name><surname>Donaldson</surname><given-names>IJ</given-names></name><name><surname>Kasza</surname><given-names>A</given-names></name><name><surname>Zeef</surname><given-names>L</given-names></name><name><surname>Sharrocks</surname><given-names>AD</given-names></name></person-group><article-title>Overlapping promoter targeting by Elk-1 and other divergent ETS-domain transcription factor family members</article-title><source>Nucleic Acids Res</source><year>2009</year><month>Dec</month><volume>37</volume><issue>22</issue><fpage>7368</fpage><lpage>80</lpage></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>P</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Trout</surname><given-names>D</given-names></name><name><surname>Marinov</surname><given-names>GK</given-names></name><name><surname>Amrhein</surname><given-names>H</given-names></name><name><surname>Berghella</surname><given-names>L</given-names></name><etal/></person-group><article-title>The changing mouse embryo transcriptome at whole tissue and single-cell resolution</article-title><source>Nature</source><year>2020</year><month>Jul</month><day>29</day><volume>583</volume><issue>7818</issue><fpage>760</fpage><lpage>7</lpage></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamura</surname><given-names>T</given-names></name><name><surname>Yanai</surname><given-names>H</given-names></name><name><surname>Savitsky</surname><given-names>D</given-names></name><name><surname>Taniguchi</surname><given-names>T</given-names></name></person-group><article-title>The IRF family transcription factors in immunity and oncogenesis</article-title><source>Annu Rev Immunol</source><year>2008</year><volume>26</volume><fpage>535</fpage><lpage>84</lpage></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>EW</given-names></name><name><surname>Simon</surname><given-names>MC</given-names></name><name><surname>Anastasi</surname><given-names>J</given-names></name><name><surname>Singh</surname><given-names>H</given-names></name></person-group><article-title>Requirement of transcription factor PU.1 in the development of multiple hematopoietic lineages</article-title><source>Science</source><year>1994</year><month>Sep</month><day>9</day><volume>265</volume><issue>5178</issue><fpage>1573</fpage><lpage>7</lpage></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><collab>The Gene Ontology Consortium</collab><article-title>Expansion of the Gene Ontology knowledgebase and resources</article-title><source>Nucleic Acids Res</source><year>2017</year><month>Jan</month><day>4</day><volume>45</volume><issue>D1</issue><fpage>D331</fpage><lpage>8</lpage></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Lareau</surname><given-names>CA</given-names></name><name><surname>Ramirez</surname><given-names>RN</given-names></name><name><surname>Rose</surname><given-names>SA</given-names></name><name><surname>Maier</surname><given-names>B</given-names></name><name><surname>Wroblewska</surname><given-names>A</given-names></name><etal/></person-group><article-title>The cis-Regulatory Atlas of the Mouse Immune System</article-title><source>Cell</source><year>2019</year><month>Feb</month><day>7</day><volume>176</volume><issue>4</issue><fpage>897</fpage><lpage>912</lpage><elocation-id>e20</elocation-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleiman</surname><given-names>E</given-names></name><name><surname>Jia</surname><given-names>H</given-names></name><name><surname>Loguercio</surname><given-names>S</given-names></name><name><surname>Su</surname><given-names>AI</given-names></name><name><surname>Feeney</surname><given-names>AJ</given-names></name></person-group><article-title>YY1 plays an essential role at all stages of B-cell differentiation</article-title><source>Proc Natl Acad Sci USA</source><year>2016</year><month>Jul</month><day>5</day><volume>113</volume><issue>27</issue><fpage>E3911</fpage><lpage>20</lpage></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hwang</surname><given-names>SS</given-names></name><name><surname>Jang</surname><given-names>SW</given-names></name><name><surname>Kim</surname><given-names>MK</given-names></name><name><surname>Kim</surname><given-names>LK</given-names></name><name><surname>Kim</surname><given-names>B-S</given-names></name><name><surname>Kim</surname><given-names>HS</given-names></name><etal/></person-group><article-title>YY1 inhibits differentiation and function of regulatory T cells by blocking Foxp3 expression and activity</article-title><source>Nat Commun</source><year>2016</year><month>Feb</month><day>19</day><volume>7</volume><elocation-id>10789</elocation-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seifert</surname><given-names>LL</given-names></name><name><surname>Si</surname><given-names>C</given-names></name><name><surname>Saha</surname><given-names>D</given-names></name><name><surname>Sadic</surname><given-names>M</given-names></name><name><surname>de Vries</surname><given-names>M</given-names></name><name><surname>Ballentine</surname><given-names>S</given-names></name><etal/></person-group><article-title>The ETS transcription factor ELF1 regulates a broadly antiviral program distinct from the type I interferon response</article-title><source>PLoS Pathog</source><year>2019</year><month>Nov</month><day>4</day><volume>15</volume><issue>11</issue><elocation-id>e1007634</elocation-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyler</surname><given-names>PM</given-names></name><name><surname>Bucklin</surname><given-names>ML</given-names></name><name><surname>Zhao</surname><given-names>M</given-names></name><name><surname>Maher</surname><given-names>TJ</given-names></name><name><surname>Rice</surname><given-names>AJ</given-names></name><name><surname>Ji</surname><given-names>W</given-names></name><etal/></person-group><article-title>Human autoinflammatory disease reveals ELF4 as a transcriptional regulator of inflammation</article-title><source>Nat Immunol</source><year>2021</year><month>Sep</month><volume>22</volume><issue>9</issue><fpage>1118</fpage><lpage>26</lpage></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Luo</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Zacksenhaus</surname><given-names>E</given-names></name><name><surname>Ben-David</surname><given-names>Y</given-names></name></person-group><article-title>The ets transcription factor Fli-1 in development, cancer and disease</article-title><source>Oncogene</source><year>2015</year><month>Apr</month><day>16</day><volume>34</volume><issue>16</issue><fpage>2022</fpage><lpage>31</lpage></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krüger</surname><given-names>I</given-names></name><name><surname>Vollmer</surname><given-names>M</given-names></name><name><surname>Simmons</surname><given-names>DG</given-names></name><name><surname>Elsasser</surname><given-names>H-P</given-names></name><name><surname>Philipsen</surname><given-names>S</given-names></name><name><surname>Suske</surname><given-names>G</given-names></name></person-group><article-title>Sp1/Sp3 compound heterozygous mice are not viable: impaired erythropoiesis and severe placental defects</article-title><source>Dev Dyn</source><year>2007</year><month>Aug</month><volume>236</volume><issue>8</issue><fpage>2235</fpage><lpage>44</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Olashaw</surname><given-names>N</given-names></name><name><surname>Seto</surname><given-names>E</given-names></name></person-group><article-title>Molecular cloning and functional characterization of the transcription factor YY2</article-title><source>J Biol Chem</source><year>2004</year><month>Jun</month><day>11</day><volume>279</volume><issue>24</issue><fpage>25927</fpage><lpage>34</lpage></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardoso-Moreira</surname><given-names>M</given-names></name><name><surname>Halbert</surname><given-names>J</given-names></name><name><surname>Valloton</surname><given-names>D</given-names></name><name><surname>Velten</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Shao</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Gene expression across mammalian organ development</article-title><source>Nature</source><year>2019</year><month>Jul</month><volume>571</volume><issue>7766</issue><fpage>505</fpage><lpage>9</lpage></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tropea</surname><given-names>D</given-names></name><name><surname>Kreiman</surname><given-names>G</given-names></name><name><surname>Lyckman</surname><given-names>A</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Horng</surname><given-names>S</given-names></name><etal/></person-group><article-title>Gene expression changes and molecular pathways mediating activity-dependent plasticity in visual cortex</article-title><source>Nat Neurosci</source><year>2006</year><month>May</month><volume>9</volume><issue>5</issue><fpage>660</fpage><lpage>8</lpage></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veyrac</surname><given-names>A</given-names></name><name><surname>Gros</surname><given-names>A</given-names></name><name><surname>Bruel-Jungerman</surname><given-names>E</given-names></name><name><surname>Rochefort</surname><given-names>C</given-names></name><name><surname>Kleine Borgmann</surname><given-names>FB</given-names></name><name><surname>Jessberger</surname><given-names>S</given-names></name><etal/></person-group><article-title>Zif268/egr1 gene controls the selection, maturation and functional integration of adult hippocampal newborn neurons by learning</article-title><source>Proc Natl Acad Sci USA</source><year>2013</year><month>Apr</month><day>23</day><volume>110</volume><issue>17</issue><fpage>7062</fpage><lpage>7</lpage></element-citation></ref><ref id="R49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benito</surname><given-names>E</given-names></name><name><surname>Barco</surname><given-names>A</given-names></name></person-group><article-title>CREB's control of intrinsic and synaptic plasticity: implications for CREB-dependent memory models</article-title><source>Trends Neurosci</source><year>2010</year><month>May</month><volume>33</volume><issue>5</issue><fpage>230</fpage><lpage>40</lpage></element-citation></ref><ref id="R50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lonze</surname><given-names>BE</given-names></name><name><surname>Ginty</surname><given-names>DD</given-names></name></person-group><article-title>Function and regulation of CREB family transcription factors in the nervous system</article-title><source>Neuron</source><year>2002</year><month>Aug</month><day>15</day><volume>35</volume><issue>4</issue><fpage>605</fpage><lpage>23</lpage></element-citation></ref><ref id="R51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duclot</surname><given-names>F</given-names></name><name><surname>Kabbaj</surname><given-names>M</given-names></name></person-group><article-title>The role of early growth response 1 (EGR1) in brain plasticity and neuropsychiatric disorders</article-title><source>Front Behav Neurosci</source><year>2017</year><month>Mar</month><day>6</day><volume>11</volume><fpage>35</fpage></element-citation></ref><ref id="R52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herms</surname><given-names>J</given-names></name><name><surname>Zurmöhle</surname><given-names>U</given-names></name><name><surname>Schlingensiepen</surname><given-names>R</given-names></name><name><surname>Brysch</surname><given-names>W</given-names></name><name><surname>Schlingensiepen</surname><given-names>KH</given-names></name></person-group><article-title>Developmental expression of the transcription factor zif268 in rat brain</article-title><source>Neurosci Lett</source><year>1994</year><month>Jan</month><day>3</day><volume>165</volume><issue>1-2</issue><fpage>171</fpage><lpage>4</lpage></element-citation></ref><ref id="R53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hitzler</surname><given-names>JK</given-names></name><name><surname>Soares</surname><given-names>HD</given-names></name><name><surname>Drolet</surname><given-names>DW</given-names></name><name><surname>Inaba</surname><given-names>T</given-names></name><name><surname>O'Connel</surname><given-names>S</given-names></name><name><surname>Rosenfeld</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Expression patterns of the hepatic leukemia factor gene in the nervous system of developing and adult mice</article-title><source>Brain Res</source><year>1999</year><month>Feb</month><day>27</day><volume>820</volume><issue>1-2</issue><fpage>1</fpage><lpage>11</lpage></element-citation></ref><ref id="R54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiang</surname><given-names>G</given-names></name><name><surname>Keller</surname><given-names>CA</given-names></name><name><surname>Heuston</surname><given-names>E</given-names></name><name><surname>Giardine</surname><given-names>BM</given-names></name><name><surname>An</surname><given-names>L</given-names></name><name><surname>Wixom</surname><given-names>AQ</given-names></name><etal/></person-group><article-title>An integrative view of the regulatory and transcriptional landscapes in mouse hematopoiesis</article-title><source>Genome Res</source><year>2020</year><month>Mar</month><day>4</day><volume>30</volume><issue>3</issue><fpage>472</fpage><lpage>84</lpage></element-citation></ref><ref id="R55"><label>55</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martovetsky</surname><given-names>G</given-names></name><name><surname>Tee</surname><given-names>JB</given-names></name><name><surname>Nigam</surname><given-names>SK</given-names></name></person-group><article-title>Hepatocyte nuclear factors 4α and 1α regulate kidney developmental expression of drug-metabolizing enzymes and drug transporters</article-title><source>Mol Pharmacol</source><year>2013</year><month>Dec</month><volume>84</volume><issue>6</issue><fpage>808</fpage><lpage>23</lpage></element-citation></ref><ref id="R56"><label>56</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weltmeier</surname><given-names>F</given-names></name><name><surname>Borlak</surname><given-names>J</given-names></name></person-group><article-title>A high resolution genome-wide scan of HNF4α recognition sites infers a regulatory gene network in colon cancer</article-title><source>PLoS ONE</source><year>2011</year><month>Jul</month><day>28</day><volume>6</volume><issue>7</issue><elocation-id>e21667</elocation-id></element-citation></ref><ref id="R57"><label>57</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eling</surname><given-names>N</given-names></name><name><surname>Morgan</surname><given-names>MD</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Challenges in measuring and understanding biological noise</article-title><source>Nat Rev Genet</source><year>2019</year><month>Sep</month><volume>20</volume><issue>9</issue><fpage>536</fpage><lpage>48</lpage></element-citation></ref><ref id="R58"><label>58</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agarwal</surname><given-names>V</given-names></name><name><surname>Kelley</surname><given-names>DR</given-names></name></person-group><article-title>The genetic and biochemical determinants of mRNA degradation rates in mammals</article-title><source>BioRxiv</source><year>2022</year><month>Mar</month><day>19</day></element-citation></ref><ref id="R59"><label>59</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Polański</surname><given-names>K</given-names></name><name><surname>Young</surname><given-names>MD</given-names></name><name><surname>Miao</surname><given-names>Z</given-names></name><name><surname>Meyer</surname><given-names>KB</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Park</surname><given-names>J-E</given-names></name></person-group><article-title>BBKNN: fast batch alignment of single cell transcriptomes</article-title><source>Bioinformatics</source><year>2020</year><month>Feb</month><day>1</day><volume>36</volume><issue>3</issue><fpage>964</fpage><lpage>5</lpage></element-citation></ref><ref id="R60"><label>60</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname><given-names>AD</given-names></name><name><surname>Achuthan</surname><given-names>P</given-names></name><name><surname>Akanni</surname><given-names>W</given-names></name><name><surname>Allen</surname><given-names>J</given-names></name><name><surname>Allen</surname><given-names>J</given-names></name><name><surname>Alvarez-Jarreta</surname><given-names>J</given-names></name><etal/></person-group><article-title>Ensembl 2020</article-title><source>Nucleic Acids Res</source><year>2020</year><month>Jan</month><day>8</day><volume>48</volume><issue>D1</issue><fpage>D682</fpage><lpage>8</lpage></element-citation></ref><ref id="R61"><label>61</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergstra</surname><given-names>J</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name></person-group><article-title>Random Search for Hyper-Parameter Optimization</article-title><source>Journal of Machine Learning Research</source><year>2012</year></element-citation></ref><ref id="R62"><label>62</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alipanahi</surname><given-names>B</given-names></name><name><surname>Delong</surname><given-names>A</given-names></name><name><surname>Weirauch</surname><given-names>MT</given-names></name><name><surname>Frey</surname><given-names>BJ</given-names></name></person-group><article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title><source>Nat Biotechnol</source><year>2015</year><month>Aug</month><volume>33</volume><issue>8</issue><fpage>831</fpage><lpage>8</lpage></element-citation></ref><ref id="R63"><label>63</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liaw</surname><given-names>R</given-names></name><name><surname>Liang</surname><given-names>E</given-names></name><name><surname>Nishihara</surname><given-names>R</given-names></name><name><surname>Moritz</surname><given-names>P</given-names></name><name><surname>Gonzalez</surname><given-names>JE</given-names></name><name><surname>Stoica</surname><given-names>I</given-names></name></person-group><article-title>Tune: A Research Platform for Distributed Model Selection and Training</article-title><source>arXiv Preprint</source><year>2018</year><month>Jul</month><day>13</day><elocation-id>arXiv:1807.05118</elocation-id></element-citation></ref><ref id="R64"><label>64</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergstra</surname><given-names>J</given-names></name><name><surname>Yamins</surname><given-names>D</given-names></name><name><surname>Cox</surname><given-names>D</given-names></name></person-group><article-title>Making a Science of Model Search: Hyperparameter Optimization in Hundreds of Dimensions for Vision Architectures</article-title><year>2013</year><month>Feb</month><day>13</day></element-citation></ref><ref id="R65"><label>65</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Jamieson</surname><given-names>K</given-names></name><name><surname>Rostamizadeh</surname><given-names>A</given-names></name><name><surname>Gonina</surname><given-names>E</given-names></name><name><surname>Hardt</surname><given-names>M</given-names></name><name><surname>Recht</surname><given-names>B</given-names></name><etal/></person-group><article-title>A System for Massively Parallel Hyperparameter Tuning</article-title><source>arXiv</source><year>2018</year><month>Oct</month><day>13</day></element-citation></ref><ref id="R66"><label>66</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kingma</surname><given-names>DP</given-names></name><name><surname>Ba</surname><given-names>J</given-names></name></person-group><article-title>Adam: A Method for Stochastic Optimization</article-title><source>arXiv</source><year>2014</year><month>Dec</month><day>22</day></element-citation></ref><ref id="R67"><label>67</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>Quantifying similarity between motifs</article-title><source>Genome Biol</source><year>2007</year><volume>8</volume><issue>2</issue><fpage>R24</fpage></element-citation></ref><ref id="R68"><label>68</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagih</surname><given-names>O</given-names></name></person-group><article-title>ggseqlogo: a versatile R package for drawing sequence logos</article-title><source>Bioinformatics</source><year>2017</year><month>Nov</month><day>15</day><volume>33</volume><issue>22</issue><fpage>3645</fpage><lpage>7</lpage></element-citation></ref><ref id="R69"><label>69</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Melville</surname><given-names>J</given-names></name></person-group><article-title>UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction</article-title><source>arXiv</source><year>2018</year><month>Feb</month><day>9</day></element-citation></ref><ref id="R70"><label>70</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Eils</surname><given-names>R</given-names></name><name><surname>Schlesner</surname><given-names>M</given-names></name></person-group><article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title><source>Bioinformatics</source><year>2016</year><month>Sep</month><day>15</day><volume>32</volume><issue>18</issue><fpage>2847</fpage><lpage>9</lpage></element-citation></ref><ref id="R71"><label>71</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Pages</surname><given-names>H</given-names></name><name><surname>Aboyoun</surname><given-names>P</given-names></name><name><surname>Carlson</surname><given-names>M</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name><etal/></person-group><article-title>Software for computing and annotating genomic ranges</article-title><source>PLoS Comput Biol</source><year>2013</year><month>Aug</month><day>8</day><volume>9</volume><issue>8</issue><elocation-id>e1003118</elocation-id></element-citation></ref><ref id="R72"><label>72</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whitfield</surname><given-names>ML</given-names></name><name><surname>George</surname><given-names>LK</given-names></name><name><surname>Grant</surname><given-names>GD</given-names></name><name><surname>Perou</surname><given-names>CM</given-names></name></person-group><article-title>Common markers of proliferation</article-title><source>Nat Rev Cancer</source><year>2006</year><month>Feb</month><volume>6</volume><issue>2</issue><fpage>99</fpage><lpage>106</lpage></element-citation></ref><ref id="R73"><label>73</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conway</surname><given-names>JR</given-names></name><name><surname>Lex</surname><given-names>A</given-names></name><name><surname>Gehlenborg</surname><given-names>N</given-names></name></person-group><article-title>UpSetR: an R package for the visualization of intersecting sets and their properties</article-title><source>Bioinformatics</source><year>2017</year><month>Sep</month><day>15</day><volume>33</volume><issue>18</issue><fpage>2938</fpage><lpage>40</lpage></element-citation></ref><ref id="R74"><label>74</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Street</surname><given-names>K</given-names></name><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Fletcher</surname><given-names>RB</given-names></name><name><surname>Das</surname><given-names>D</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name><etal/></person-group><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title><source>BMC Genomics</source><year>2018</year><month>Jun</month><day>19</day><volume>19</volume><issue>1</issue><fpage>477</fpage></element-citation></ref><ref id="R75"><label>75</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group><source>ggplot2: Elegant Graphics for Data Analysis</source><edition>2nd, illustrated ed</edition><publisher-name>Springer</publisher-name><year>2016</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview of the scover workflow.</title><p>(<italic>a</italic>) Cell pooling strategy. A subset of cells is selected using geometric sketching. The k-nearest neighbors for cells in the subset are summed to produce a less sparse representation of the original dataset. (<italic>b</italic>) Scover infers regulatory motifs that are predictive of the signal associated with a set of sequences using a neural network consisting of a single convolutional layer, a rectified linear unit, global max pooling, and a linear layer with bias term. (<italic>c</italic>) The identified motifs are merged and compared to annotated motifs and assigned to pre-specified motif clusters based on their most significant alignment. (<italic>d</italic>) To evaluate the contribution of each motif an influence score is calculated using a leave-one-out strategy.</p></caption><graphic xlink:href="EMS144663-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Analysis of proximal promoters for the fetal and adult human kidney.</title><p>(<italic>a</italic>) Z-transformed influence scores for eleven motif clusters and five cell categories. (<italic>b</italic>) Example motif logos from the eleven motif clusters. (<italic>c</italic>) Projection of the pools onto the first two principal components of the influence score matrix reveals similar regulatory profiles. (<italic>d</italic>) Pseudotime trajectory for nephron progenitor development across single cells in fetal kidney represented as a UMAP plot. (<italic>e</italic>) Spearman correlations between motif influence scores and mean pseudotime values or expression of genes related to proliferation and proximal tubule development.</p></caption><graphic xlink:href="EMS144663-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Motif cluster impact for the human kidney dataset.</title><p>(<italic>a</italic>) UMAP plots of 18,150 promoters based on max-pooled rectified motif occurrences. Subplots show the summed max-pooled rectified motif scores for selected motif clusters in each promoter. (<italic>b</italic>) Spearman correlation between motif influence scores and expression levels of TFs binding to the motif in question. TFs with <italic>p</italic>-value&gt;=0.05 (after Benjamini-Hochberg correction) are in gray, the significant ones are colored by expression level, and selected top TFs for each cluster are named. (<italic>c</italic>) Correlation between motif influence and expression of selected TFs across pools. The Spearman correlation is reported at the top of each panel.</p></caption><graphic xlink:href="EMS144663-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Analysis of proximal promoters from the Tabula Muris.</title><p>(<italic>a</italic>) Z-transformed neural network influence for aggregated motif clusters. (<italic>b</italic>) Logos representing the thirteen motif clusters. (<italic>c</italic>) Pools are projected onto the space represented by the first two principal components of the motif influence matrix.</p></caption><graphic xlink:href="EMS144663-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Motif cluster impact for the Tabula Muris dataset.</title><p>(<italic>a</italic>) UMAP plots of 17,270 mouse promoters based on max-pooled rectified motif occurrences. Subplots show the summed max-pooled rectified motif scores for selected motif clusters in each promoter. (<italic>b</italic>) Spearman correlations between expression of GO terms and aggregate motif influences in pools. Randomly selected GO terms are shown for each cluster. (<italic>c</italic>) Spearman correlation between motif influence and expression levels of TFs binding to the motif in question. TFs with <italic>p</italic>-value&gt;=0.05 (after Benjamini-Hochberg correction) are in gray, the significant ones are colored by expression level, and selected top TFs for each cluster are named. (<italic>d</italic>) Correlations between aggregate motif family influence scores in pools and expression for selected TFs. The Spearman correlation is reported at the top of each panel.</p></caption><graphic xlink:href="EMS144663-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Analysis of distal open chromatin peaks from mouse cerebral cortex.</title><p>(<italic>a</italic>-<italic>b</italic>) Z-transformed average neural network influence score per motif cluster in (<italic>a</italic>) P0 and (<italic>b</italic>) adult. (<italic>c-d</italic>) UMAP embeddings of regulatory regions according to the motif hits for (<italic>c</italic>) P0 and (<italic>d</italic>) adult. Color shows selected summed motif family scores in each region, except for two scores: log1p(|dist|), which shows the log-transformation of 1 plus the absolute distance to the nearest TSS, and # accessible, which shows the number of pools where the open chromatin peak is observed.</p></caption><graphic xlink:href="EMS144663-f006"/></fig></floats-group></article>