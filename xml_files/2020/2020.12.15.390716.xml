<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS146587</article-id><article-id pub-id-type="doi">10.1101/2020.12.15.390716</article-id><article-id pub-id-type="archive">PPR253566</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Microbial Species Abundance Distributions Guide Human Population Size Estimation from Sewage Microbiomes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Lin</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Likai</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Yu</surname><given-names>Xiaoqian</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Duvallet</surname><given-names>Claire</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Isazadeh</surname><given-names>Siavash</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Dai</surname><given-names>Chengzhen</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Park</surname><given-names>Shinkyu</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Frois-Moniz</surname><given-names>Katya</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Duarte</surname><given-names>Fabio</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Ratti</surname><given-names>Carlo</given-names></name><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Alm</surname><given-names>Eric J.</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A7">7</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Ling</surname><given-names>Fangqiong</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A8">8</xref><xref ref-type="aff" rid="A9">9</xref><xref ref-type="aff" rid="A10">10</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Washington University in St. Louis, Department of Energy, Environmental and Chemical Engineering, St. Louis, MO, USA</aff><aff id="A2"><label>2</label>Washington University in St. Louis, Department of Mathematics, St. Louis, MO, USA</aff><aff id="A3"><label>3</label>Massachusetts Institute of Technology, Department of Biology, Boston, MA, USA</aff><aff id="A4"><label>4</label>Massachusetts Institute of Technology, Department of Biological Engineering, Boston, MA, USA</aff><aff id="A5"><label>5</label>Massachusetts Institute of Technology, Center for Microbiome Informatics and Therapeutics, Boston, MA, USA</aff><aff id="A6"><label>6</label>Massachusetts Institute of Technology, SENSEable City Lab, Boston, MA, USA</aff><aff id="A7"><label>7</label>Eli and Edythe L. Broad Institute of MIT and Harvard, Boston, MA, USA</aff><aff id="A8"><label>8</label>Washington University in St. Louis, Department of Computer Science and Engineering, St. Louis, MO, USA</aff><aff id="A9"><label>9</label>Washington University in St. Louis, Division of Biological and Biomedical Sciences, St. Louis, MO, USA</aff><aff id="A10"><label>10</label>Washington University in St. Louis, Division of Computational and Data Science, St. Louis, MO, USA</aff><author-notes><corresp id="CR1">
<label>*</label>Authors to whom correspondence should be addressed.</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>01</day><month>07</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>04</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">The metagenome embedded in urban sewage is an attractive new data source to understand urban ecology and assess human health status at scales beyond a single host. Analyzing the viral fraction of wastewater in the ongoing COVID-19 pandemic has shown the potential of wastewater as aggregated samples for early detection, prevalence monitoring, and variant identification of human diseases in large populations. However, using census-based population size instead of real-time population estimates can mislead the interpretation of data acquired from sewage, hindering assessment of representativeness, inference of prevalence, or comparisons of taxa across sites. Here, we show that taxon abundance and sub-species diversisty in gut-associated microbiomes are new feature space to utilize for human population estimation. Using a population-scale human gut microbiome sample of over 1,100 people, we found that taxon-abundance distributions of gut-associated multi-person microbiomes exhibited generalizable relationships with respect to human population size. Here and throughout this paper, the human population size is essentially the sample size from the wastewater sample. We present a new algorithm, MicrobiomeCensus, for estimating human population size from sewage samples. MicrobiomeCensus harnesses the inter-individual variability in human gut microbiomes and performs maximum likelihood estimation based on simultaneous deviation of multiple taxa’s relative abundances from their population means. MicrobiomeCensus outperformed generic algorithms in data-driven simulation benchmarks and detected population size differences in field data. New theorems are provided to justify our approach. This research provides a mathematical framework for inferring population sizes in real time from sewage samples, paving the way for more accurate ecological and public health studies utilizing the sewage metagenome.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The metagenome embedded in urban sewage is an attractive new data source to understand urban ecology and assess human health status at scales beyond a single host[<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R29">29</xref>]. Sewage microbiomes are found to share a variety of taxa with human gut microbiomes, where the baseline communities are characterized by a dominance of human-associated commensal organisms from the <italic>Bacteroidetes</italic> and <italic>Firmicutes</italic> phyla[<xref ref-type="bibr" rid="R29">29</xref>, <xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R24">24</xref>]. Human viruses like SARS-CoV-2 and polioviruses were detected in sewage samples during the pandemic and silent spreads, respectively, and found to correlate to reported cases, suggesting that sewage samples could be useful for understanding the dynamics in the human-associated symbionts at a population level[<xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R21">21</xref>]. Sewage has several advantages as samples of the population’s collective symbionts. For instance, sewage samples are naturally aggregated, wastewater infrastructures are highly accessible, and data on human symbionts can be collected without visits to clinics, thus utilizing sewage samples can reduce costs and avoid biases associated with stigma and accessibility[<xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R28">28</xref>]. Consequently, SARS-CoV-2 surveillance utilizing sewage samples are underway globally and incorporated into the U.S. Centers for Disease Control and Prevention surveillance framework[<xref ref-type="bibr" rid="R9">9</xref>].</p><p id="P3">A pressing challenge in utilizing sewage for ecological and public health studies is the lack of methods to directly estimate human population size from sewage. Specifically, virus monitoring at finer spatial granularity, e.g., single university dorms and nursing homes, are informative for guiding contact tracing and protecting populations at higher risk, but real-time population size estimations at such fine granularity are not yet available. For a given area, the census population (<italic>de jure</italic> population) can be larger than the number of people who contributed feces to sewage at a given time (<italic>de facto</italic> population)[<xref ref-type="bibr" rid="R11">11</xref>]. Conversely, the <italic>de jure</italic> population can also be smaller than the <italic>de facto</italic> population due to the presence of undocumented individuals[<xref ref-type="bibr" rid="R13">13</xref>]. Population proxies that are currently used for monitoring at wastewater-treatment plants, such as the loading of pepper mild mottle viruses, likely have high error at the neighborhood level because of their large variability in human fecal viromes (10<sup>6</sup>-10<sup>9</sup> virions per gram of dry weight fecal matter)[<xref ref-type="bibr" rid="R38">38</xref>]. Consequently, it is difficult to assess the representativeness of a sewage sample, infer the taxon abundance differences across time and space, or interpret errors. Lack of population size information could lead to false negatives in assessing virus eradication, because an absence of biomarkers might be caused by a sewage sample that under-represents the population size. Despite its importance, few studies have explicitly explored ways to estimate real-time human population size from sewage samples independent from census estimates[<xref ref-type="bibr" rid="R37">37</xref>].</p><p id="P4">Macroecological theories of biodiversity may offer clues to decipher and even enumerate the sources of a sewage microbiome. While we are only beginning to view sewage as samples of human symbionts beyond one person, generating multi-host microbiomes resembles a fundamental random additive process. Sizling et al. showed that lognormal SADs can be generated solely from summing the abundances from multiple non-overlapping sub-assemblages to form new assemblages[<xref ref-type="bibr" rid="R35">35</xref>]. Likewise, adding multiple sub-assemblages can also give rise to common Species-Area Relationships[<xref ref-type="bibr" rid="R35">35</xref>]. For microbial ecosystems, Shoemaker et al. examined the abilities of widely known and successful models of SADs in predicting microbial SADs and found that Poisson Lognormal distributions outperformed other distributions across environmental, engineered, and host-associated microbial communities, highlighting the underpinning role of lognormal processes in shaping microbial diversity[<xref ref-type="bibr" rid="R34">34</xref>].</p><p id="P5">In this study, we conceptualize a sewage microbiome as a multi-person microbiome, where the number of human contributors can vary. We hypothesize that the species abundance distribution in the multi-person microbiome will vary as a function of the human population size, which would arise from summing taxon abundances from multiple hosts analogous to the Central Limit Theorem. We use human gut microbiome data comprising over a thousand human subjects and machine learning algorithms to explore these relationships. Upon discovering a generalizable relationship, we develop MicrobiomeCensus, a nonparametric model that utilizes relative taxon abundances in the microbiome to predict the number of people contributing to a sewage sample. MicrobiomeCensus utilizes a multivariate <italic>T</italic> statistic to capture the simultaneous deviation of multiple taxa’s abundances from their means in a human population and performs maximum likelihood estimation. We provide proof on the validity of our approach. Next, we examine model performance through a simulation benchmark using human microbiome data. Last, we apply our model to data derived from real-world sewage. Our nonparametric method does not assume any underlying distributions of microbial abundances and can make inferences with just the computational power of a laptop computer.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Species abundance distributions of multi-person microbiomes vary by population size</title><p id="P6">We consider the fraction of microorganisms observed in sewage that are human-associated anaerobes as an “average gut microbiome” sampled from residents of a catchment area. Hence, our task becomes to find the underlying relationship between the number of contributors and the observed microbiome profiles in sewage samples. We define an “ideal sewage mixture” scenario to illustrate our case, where the sewage sample consists only of gut-associated microorganisms and is an even mix of n different individuals’ feces (<xref ref-type="fig" rid="F1">Figure 1</xref>). We denote the gut microbiome profile of an individual as <italic>X<sub>i</sub></italic> = (<italic>X</italic><sub><italic>i</italic>,1</sub> <italic>X</italic><sub><italic>i</italic>,2</sub>, …, <italic>X</italic><sub><italic>i</italic>,<italic>p</italic></sub>)<sup>⊤</sup>, where each <italic>X</italic><sub><italic>i</italic>,<italic>j</italic></sub> represents the relative abundance of operational taxonomic unit (OTU) <italic>j</italic> from individual <italic>i</italic>. Hence our ideal sewage mixture can be represented as <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mstyle></mml:math></disp-formula> where vectors <italic>X</italic><sub>1</sub>,<italic>X</italic><sub>2</sub>, …,<italic>X<sub>n</sub></italic> ∈ ℝ<sup><italic>p</italic></sup> are microbiome profiles from individuals 1, …, <italic>n</italic>. Under the ideal sewage mixture scenario, if we can quantitatively capture the departure of the sewage microbiome profile from the population mean of the human gut microbiomes of people constituting the catchment area, we will be able to estimate the population size.</p><p id="P7">Using a dataset comprised of 1,100 individuals’ gut microbiome taxonomic profiles[<xref ref-type="bibr" rid="R39">39</xref>], we created synthetic mixture samples of different numbers of contributors through bootstrapping (<xref ref-type="fig" rid="F1">Figure 1A</xref>). First, examined from an ecological perspective, the shape of the ranked abundance curves of the gut microbiomes differed when the means of multiple individuals were examined: when the number of contributors increased, a normal distribution appeared(<xref ref-type="fig" rid="F1">Figure 1B</xref>). For the single-person microbiomes, log-series and lognormal distributions explained 94% and 93% of the variations in the SADs, respectively, compared with 89% for Poisson lognormal, 87% for Zipf multinomial and 80% for the broken-stick model. Multi-person microbiomes were best predicted by log-series or lognormal models, but as the population increased to over a hundred, the multi-person SADs were best described by only lognormal SADs (Table S1).</p><p id="P8">We explored the distributions of the relative abundances of gut bacteria as a function of population size. As expected, the distribution of a taxon’s relative abundance changes with population size (<xref ref-type="fig" rid="F1">Figure 1C</xref>). For instance, for OTU-2397, a <italic>Bifidobacterium</italic> taxon, the relative abundance distribution was approximately log-normal when the relative abundance in single-host samples was considered, yet converged to a Normal distribution when mixtures of multiple hosts were considered. Although the means of the distributions of the same taxon under different population sizes were close, the variation in the data changed. A smaller variance was observed when the number of contributors increased (<xref ref-type="fig" rid="F1">Figure 1D</xref>). Notably, different taxa varied in the rates at which their variances decreased with population size (<xref ref-type="fig" rid="F1">Figure 1E</xref>), suggesting that a model that considers multiple features would be useful in predicting the number of contributors.</p></sec><sec id="S4"><title>Classifiers utilizing microbial taxon abundance features alone detects single-person and multi-person microbiomes</title><p id="P9">Inspired by the distinct shapes of SADs in multi-person gut-microbiomes from those of single-person microbiomes, we set up a classification task using the taxon relative abundances to separate synthetic communities constituting one, ten, and a hundred people. With algorithms of varying complexity, namely Logistic Regression (LR), Support Vector Machine (SVM), and Random Forest (RF) classifier, classification accuracies of 29.6%, 97.2%, and 100% were achieved (<xref ref-type="fig" rid="F2">Figure 2</xref>). Between RF and SVM, RF showed higher sensitivity and specificity in classifying all population groups (Table S2). This experiment suggests the usefulness of microbiome features in predicting human population counts from mixture samples.</p></sec><sec id="S5"><title>MicrobiomeCensus is a statistical model that estimates population size from microbial taxon abundances</title><p id="P10">While the classification tasks described above demonstrated the usefulness of taxa’s relative abundances in predicting the population size, a complex model like RF provided little explanatory power. We then ask, since the variance in the relative abundance of a given taxon decreases with population size, can we devise a statistic that captures the simultaneous deviation of several taxa’s abundances from their means, and estimate population size utilizing the statistic? Further, will this new method perform well despite inter-personal variation in gut microbiomes?</p><p id="P11">Our new method, MicrobiomeCensus, involves a statistic <italic>T<sub>n</sub></italic> to capture the simultaneous deviation of multiple taxa’s abundances from their means in relation to the variance of those taxa in the population (<xref ref-type="fig" rid="F3">Figure 3A</xref>). We denote Σ<sub>0</sub> = (<italic>σ<sub>ij</sub></italic>)<sub>1≤<italic>i</italic>,<italic>j</italic>≤<italic>p</italic></sub> as the covariance matrix for the individual microbiome profile and let Λ<sub>0</sub> be a diagonal matrix with <inline-formula><mml:math id="M2"><mml:msub><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>diag</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>22</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula> Then the statistic takes form <disp-formula id="FD2"><label>(2)</label><mml:math id="M3"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mtext>Λ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula><mml:math id="M4"><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:math></inline-formula> denotes the observed microbiome profile in ideal sewage, <italic>μ</italic> represents the population mean for the catchment area and <inline-formula><mml:math id="M5"><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is an estimator, <inline-formula><mml:math id="M6"><mml:msub><mml:mrow><mml:mover><mml:mtext>Λ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is an estimator of Λ<sub>0</sub> and <inline-formula><mml:math id="M7"><mml:mo>∥</mml:mo><mml:mi>v</mml:mi><mml:msub><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>:=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for any vector ℝ<sup><italic>p</italic></sup>. This statistic is enlightened by the classical Hotelling <italic>T</italic><sup>2</sup> statistic[<xref ref-type="bibr" rid="R16">16</xref>] <inline-formula><mml:math id="M8"><mml:msub><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mtext>Σ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></inline-formula> where <inline-formula><mml:math id="M9"><mml:msub><mml:mrow><mml:mover><mml:mtext>Σ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the sample covariance matrix, an estimator of ∑<sub>0</sub>. Actually if we assume the covariance matrix is diagonal (no correlations between different taxa), then they are essentially the same statistic in view of <inline-formula><mml:math id="M10"><mml:msub><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></inline-formula> The reason we replace covariance matrix ∑<sub>0</sub> by its diagonal Λ<sub>0</sub> is because for high dimensional situations, it would be very difficult to estimate the covariance matrix. In cases when <italic>p</italic> &gt; <italic>n</italic>, the sample covariance matrix is singular and thus <inline-formula><mml:math id="M11"><mml:msub><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is not even well defined. Studies accommodating the Hotelling <italic>T</italic><sup>2</sup> type statistic into the high-dimensional situation can be found, for example, in Bai and Saranadasa[<xref ref-type="bibr" rid="R1">1</xref>], Chen and Qi[<xref ref-type="bibr" rid="R10">10</xref>], Xu et al[<xref ref-type="bibr" rid="R36">36</xref>], etc. Our proposed statistic can handle the high dimensional cases as well, since the diagonal entities Λ<sub>0</sub> can be well estimated even when <italic>p</italic> is large. And we extend its application beyond the problem of the significance of the multivariate means.</p><p id="P12">In developing this new method, we utilize the variance change by population, but without any <italic>priori</italic> assumption about the gut bacterium species taxon abundance distributions and the covariance between species. Our analysis showed that the statistic <italic>T<sub>n</sub></italic> changed monotonically with increasing population size, indicating the promise of a population estimation model (<xref ref-type="fig" rid="F3">Figure 3B</xref>).</p><p id="P13">Leveraging our statistic <italic>T<sub>n</sub></italic>, we constructed an asymptotic maximum likelihood estimator to estimate size of the sample without the information of each individual, that is, we do not observe <italic>X</italic><sub>1</sub>, …, <italic>X<sub>n</sub></italic> but only their mixture <inline-formula><mml:math id="M12"><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:math></inline-formula> Here, the parameter of interest is the population size n, the test statistic is <italic>T<sub>n</sub></italic>, and a point estimate is made by maximizing the estimated likelihood of <italic>T<sub>n</sub></italic> with respect to n. We performed training and validation using 50% of the human microbiome data and held out the rest of the data for testing. Our model achieved a training error as low as 13% (mean absolute percentage error, MAPE) when up to 250 features are included. The model’s training performance increased when more features were included, yet the validation error did not profoundly change with an increasing number of features (<xref ref-type="fig" rid="F3">Figure 3C</xref>). Upon training and validation, we chose the top 120 OTUs and tested the performance of the tuned model on a test set held out during training/validation. The model’s MAPE was 21% (<xref ref-type="fig" rid="F3">Figure 3D and E</xref>, testing errors at each population size evaluated are provided in Table S3), indicating that our model generalized well across different hosts. We then used all data and tuned hyperparameter to acquire a final model. When applying the final model on the same testing data, our model achieved a testing error of 16.2% (<xref ref-type="fig" rid="F3">Figure 3D</xref>).</p><p id="P14">It is worth noting that in this algorithm, for each size <italic>n</italic>, we only need to estimate the sampling distribution of the statistic <italic>T<sub>n</sub></italic> once. Hence it is not time-consuming regardless of the true population size. We also note that an RF regression model could not be trained in a reasonable time on the same dataset, even with high-performance computing (<xref ref-type="sec" rid="S10">Methods</xref>). Our model performed remarkably better than a ten-fold cross-validated RF regression model utilizing a reduced dataset, which gave an MAPE of 32%, while the training time for our model was only a fraction of that of the RF regression model (Figure S1).</p></sec><sec id="S6"><title>MicrobiomeCensus detects human population size differences in sewage samples</title><p id="P15">With the newly developed population model, we set out to apply our model to sewage samples. Ideally, we would like to apply the model to samples generated from a fully controlled experiment with known human hosts contributing at a given time, yet such an experiment presents logistic challenges. Instead, we applied our model to sewage samples taken using one of two methods, either a snapshot (grab sample) sample taken from the sewage stream over 5 minutes, or an accumulative (composite sample) taken at a constant rate over 3 hours during morning peak human defecation[<xref ref-type="bibr" rid="R15">15</xref>] (Figure S2). We hypothesized that the composite samples would represent more people than snapshot samples. Taking grab samples, we sampled at 1-hr intervals at one manhole (n=25); using the accumulative method, we sampled at three campus buildings (classroom, dormitory, and family housing) multiple times over three months (n=76). To remove sequences possibly contributed by the water, we applied a taxonomic filter to retain families associated with the gut microbiome and normalized the species abundance by the retained sequencing reads (<xref ref-type="sec" rid="S10">Methods</xref>, Table S4). We applied our final model to the sewage data set. Our model estimated 1-9 people’s waste was captured by the snapshot samples (mean=3, s.d.=3), and 3-27 people were represented by the composite samples (mean=9, s.d.=7), where the composite samples represented significantly more people (<italic>p</italic> &lt; 0.0001) (<xref ref-type="fig" rid="F3">Figure 3F</xref>). The hypothesis that composite samples represent more people is well supported by our model results.</p></sec><sec id="S7"><title>Sub-species diversity in sewage samples reflects adding microbiomes from multiple people</title><p id="P16">Independent from our MicrobiomeCensus model, we found that certain human gut-associated species were frequently detected in sewage samples by using shotgun metagenomics, e.g., <italic>Bacteroides vulgatus</italic>, <italic>Provotella copri</italic>, and <italic>Eubacterium rectale</italic>. Further, their sub-species diversity, as indicated by nucleotide diversity and the number of polymorphic sites in housekeeping genes, was dramatically higher in sewage samples than in the gut microbiomes of individual human subjects (<xref ref-type="fig" rid="F4">Figure 4A-F</xref> and Supplementary Results).</p><p id="P17">To examine the effect of increasing population size on sub-species genetic variation in representative gut-associated microbial species, we simulated aggregate human gut samples using a sample without replacement procedure and computed the nucleotide diversity and numbers of polymorphic sites for the aggregate samples at different population sizes. This resulted in SNV profiles from 64 species. Our simulation showed increases in both nucleotide diversity and the number of polymorphic sites as more human gut samples were aggregated (<xref ref-type="fig" rid="F3">Figure 3 G and H</xref>). For instance, the nucleotide diversity and number of polymorphic sites in <italic>Eubacterium rectale</italic> increased from 0.029 (s.d. 0.026) to 0.149 (s.d. 0.002) and 64 (s.d. 54.33) to 1274 (s.d. 18.41), respectively, when the population size increased from 1 to 300. Further, the number of polymorphic sites strongly correlated with the population size (Pearson correlation coefficient &gt; 0.8) in 49 of the 64 species (Table S7), suggesting the potential that the SNV profiles of a wide range of gut species could be developed into feature space for population size estimation. Our simulation further shows that the number of polymorphic sites increased with population size more slowly than nucleotide diversity, indicating its potential to reflect more subtle changes in population size (<xref ref-type="fig" rid="F4">Figure 4G and H</xref>). Despite the need for further model developments, the analysis here shows the potential of the sub-species diversity of gut anaerobes as a feature space to be developed into a population size estimation model, independent from the taxon abundance-based model described here.</p></sec></sec><sec id="S8" sec-type="discussion"><title>Discussion</title><p id="P18">The MicrobiomeCensus method we present here can, in theory, estimate the population size contributing to a sewage sample from the taxon abundance of multiple human gut microbiome taxa, using our T statistic and associated maximum likelihood estimation and application procedures. While the model is trained to perform accurate population estimation on a neighborhood scale, we expect the population range it can estimate to expand with increasing training gut microbiome data availability. We propose the MicrobiomeCensus model as a tool to drive further developments in quantitative sewage-based epidemiology. We have provided mathematical proof of the validity of our approach.</p><p id="P19">MicrobiomeCensus showed excellent performance in our simulation benchmark. In particular, the study subjects that we utilized in the training and testing sets are random samples out of 1,100 men and women across a wide range of age without any stratification, hence the model’s testing performance indicates its generalizability. Our study is founded on the observations that healthy gut microbiomes are resilient, with inter-individual variability outweighing variability within individuals over time [<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R26">26</xref>]. There are caveats to our approach; potentially, diets and regional effects on human microbiome composition could introduce noises to the prediction [<xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R14">14</xref>]. In applications to sewage, future studies on water matrix effects should be performed to understand and further account for noises from the sewage collection network. It should be mentioned that while our model is trained on microbiome data, it is not limited to microbiome features because we did not impose any assumptions on the distribution of features. Other features, e.g., crAssphage titers, may also be incorporated once individual level data at a large population size become available to allow model validation.</p><p id="P20">Utilizing sewage to understand population-level dynamics of human symbionts presents a new scenario of sampling meta-communities. The gut microbiomes of humans can be viewed as local communities, and gut microbiomes of people living in a neighborhood could be viewed as a kind of regional meta-communities, because these communities are linked by dispersal that can take place among people connected by social networks and through a shared built environment. The meta-community framework is considered to provide useful new conceptual tools to understand the largely unexplained inter-personal variability in gut microbiomes, with expansions of the theory to consider biotic interactions suggested by Miller, Svanbäck, and Bohannan [<xref ref-type="bibr" rid="R27">27</xref>]. In considering a sample of meta-communities, Leibold and Chase asked provocatively “what is a community?” and observed that the definition of a community is usually “user-defined and could be context-dependent” –“one community ecologist might explore the patterns of coexistence and species interactions among species within a delimited area, the other might ask the same question but define a community that encompasses more area and thus types of species, as well as different degrees of movements and heterogeneity patterns” [<xref ref-type="bibr" rid="R19">19</xref>]. The ambiguity between samples of meta-communities and local communities is particularly challenging for samples of microbial communities, because dispersal boundaries are difficult to delineate. Despite the conceptual importance, empirical methods that explicitly test whether a microbiome sample is a sample of a meta-community or a local community have not been available. MicrobiomeCensus directly distinguishes samples of meta-communities and local communities by enumerating the number of hosts contributing to a microbiome. While MicrobiomeCensus is trained on gut microbiome data, the procedure may have wide applications in other microbial ecosystems.</p><p id="P21">In response to the COVID-19 pandemic now affecting the human population globally, sewage-based virus monitoring is underway[<xref ref-type="bibr" rid="R3">3</xref>]. Our analysis calls for attention to the denominator used in normalizing the biomarker measurements. While in practice, loading-based population proxies such as the copy numbers of pepper mild mottle viruses are used to normalize data generated from sewage, such proxies would likely have high error at the neighborhood level because of their variability in human fecal viromes (10<sup>6</sup>-10 virions per gram of dry weight in fecal matters)[<xref ref-type="bibr" rid="R38">38</xref>], while they likely have reasonable performance when the population size is sufficiently large and the means of biomarker loadings converge under the Central Limit Theorem. Thus, the relationships between sewage measurements and true viral prevalence in small populations are hard to establish despite the need for sentinel population studies. Our model has immediate application in detecting false negatives, because it alerts us to the possibility that an absence of biomarkers might be caused by a sewage sample that under-represents a population. With further developments incorporating local training data, the model can potentially generate a denominator that can help turn biomarker measurements into estimates of prevalence and enable the application of epidemiology models at finer spatio-temporal resolutions.</p></sec><sec id="S9" sec-type="methods"><title>Methods</title><sec id="S10"><title>Rationales</title><p id="P22">If the distribution of <italic>X<sub>i</sub></italic> is known, then the distribution <italic>T<sub>n</sub></italic> is known and one can easily use maximum likelihood estimator (MLE) to estimate the human population size. Here the human population size is essentially the sample size n from the wastewater sample. However for generality, we do not want to impose any specific distribution assumptions on taxon abundance distributions, thus, we need to rely on asymptotic results to estimate the distribution of our statistic. Unlike the univariate case where the asymptotic distribution of the statistic <italic>T<sub>n</sub></italic> can be simply derived by central limit theorem, we are dealing with a much more challenging situation due to high dimensionality.</p><p id="P23">In the following, we shall firstly introduce some notations and assumptions that will be needed for the theorems. Then, in Theorem 1, we derive the Gaussian approximation for the test statistic <italic>T<sub>n</sub></italic>, which implies that we can use simulated Gaussian vectors to approximate the distribution of our statistic. To apply this approximation, one needs to further estimate the covariance matrix which is highly non-trivial due to high dimensionality. To get around this difficulty, we further propose a sub-sampling approach. Theorem 2 provides the theoretical foundation for this sub-sampling scheme.</p></sec><sec id="S11"><title>Notation</title><p id="P24">Recall that vectors <italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, …, <italic>X<sub>n</sub></italic> are microbiome profiles from individuals 1, 2, …, <italic>n</italic>. Assume that they are independent and identically distributed (i.i.d) random vectors in ℝ<sup><italic>p</italic></sup> with mean <italic>μ</italic> ∈ ℝ<sup><italic>p</italic></sup> and variance Var(<italic>X<sub>i</sub></italic>) = Σ<sub>0</sub> ∈ ℝ<sup><italic>p</italic>×<italic>p</italic></sup>. Denote Σ<sub>0</sub> = (<italic>σ<sub>ij</sub></italic>)<sub>1≤<italic>i</italic>,<italic>j</italic>≤<italic>p</italic></sub> and <inline-formula><mml:math id="M13"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:math></inline-formula> Let the diagonal matrix Λ<sub>0</sub> = diag(<italic>σ<sub>i</sub></italic>, 1 ≤ <italic>i</italic> ≤ <italic>p</italic>).</p><p id="P25">To construct the Gaussian approximation, we shall firstly work with cases when both Λ<sub>0</sub> and <italic>μ</italic> are given, that is, consider the statistic <disp-formula id="FD3"><mml:math id="M14"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⋄</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></disp-formula></p><p id="P26">We will later extend all the results to cases when those parameters are unknown. For notation’s simplicity, consider the normalized version of <italic>X<sub>i</sub></italic>: <disp-formula id="FD4"><mml:math id="M15"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">).</mml:mo></mml:math></disp-formula></p><p id="P27">Then <inline-formula><mml:math id="M16"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⋄</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>Y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></inline-formula> where <inline-formula><mml:math id="M17"><mml:msub><mml:mrow><mml:mover><mml:mi>Y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> and the covariance matrix ∑<sub><italic>Y</italic></sub> of <italic>Y<sub>i</sub></italic> is the correlation matrix of <italic>X<sub>i</sub></italic>, with expression <inline-formula><mml:math id="M18"><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p><p id="P28">We need the following condition on <italic>Y<sub>i</sub></italic> for the main theorem.</p><p id="P29">A<sc>ssumption</sc> 1 <italic>Let s</italic> &gt; 2. <italic>Assume</italic> <disp-formula id="FD5"><label>(3)</label><mml:math id="M19"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mtext>∞</mml:mtext><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext> and </mml:mtext><mml:mspace width="1em"/><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>⊤</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mtext>Σ</mml:mtext><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mtext>∞</mml:mtext><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> <italic>where</italic> ∥⋅∥<sub><italic>F</italic></sub> <italic>is the matrix Frobenius norm</italic>.</p><p id="P30">R<sc>emark</sc> 1 <italic>Above conditions naturally hold if Y</italic><sub>1<italic>i</italic></sub>, 1 ≤ <italic>i</italic> ≤ <italic>p</italic>, <italic>are independent and</italic> max<sub>1≤<italic>i</italic>≤<italic>p</italic></sub>(𝔼∣<italic>Y</italic><sub>1<italic>i</italic></sub>∣<sup><italic>s</italic></sup>)<sup>1/<italic>s</italic></sup> &lt; ∞. <italic>Actually under this setting</italic>, ∑<sub><italic>Y</italic></sub> = <italic>I<sub>p</sub> and thus</italic> ∥∑<sub>Y</sub>∥<sub><italic>F</italic></sub> = <italic>p</italic><sup>1/2</sup>. <italic>By Berkholder[</italic><xref ref-type="bibr" rid="R6">6</xref><italic>]’s inequality</italic>, <disp-formula id="FD6"><mml:math id="M20"><mml:mstyle displaystyle="true"><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> <italic>where c</italic><sub>1</sub> &gt; 0 <italic>is independent of p</italic>. <italic>This justifies K<sub>s</sub> part in condition</italic> (<xref ref-type="disp-formula" rid="FD5">3</xref>). <italic>Again by Berkholder[</italic><xref ref-type="bibr" rid="R6">6</xref><italic>]’s inequality</italic>, <disp-formula id="FD7"><mml:math id="M21"><mml:mstyle displaystyle="true"><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>⊤</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>𝔼</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> <italic>where c</italic><sub>2</sub> &gt; 0 <italic>is independent of p</italic>. <italic>And thus D<sub>s</sub> part in condition</italic> (<xref ref-type="disp-formula" rid="FD5">3</xref>) <italic>holds</italic>.</p><p id="P31">Now we are ready to introduce the first asymptotic result. The following theorem essentially states that under certain regularity conditions, the distribution of our test statistic can be approximated by the distribution of some function of a Gaussian vector. T</p><p id="P32"><bold>Theorem 1 (Theorem 2.2 in Xu et al.</bold>[<xref ref-type="bibr" rid="R36">36</xref>]<bold>)</bold> <italic>Assume Assumption 1 holds with some s</italic> &gt; 2, <italic>also assume</italic> <disp-formula id="FD8"><label>(4)</label><mml:math id="M22"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:math></disp-formula></p><p id="P33"><italic>Then for Z</italic> ∼ <italic>N</italic> (0, ∑<italic><sub>Y</sub></italic>), <italic>we have</italic> <disp-formula id="FD9"><mml:math id="M23"><mml:mstyle displaystyle="true"><mml:munder><mml:mo movablelimits="true">sup</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⋄</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∥</mml:mo><mml:mi>Z</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:math></disp-formula></p><p id="P34">It is worth noticing that under settings in Remark 1, condition (<xref ref-type="disp-formula" rid="FD8">4</xref>) holds. Based on the above theorem, if we can estimate the covariance matrix ∑<sub><italic>Y</italic></sub>, then <inline-formula><mml:math id="M24"><mml:mo>∥</mml:mo><mml:mi>Z</mml:mi><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> can be generated and used for approximation of our statistic. However the estimation of ∑<sub><italic>Y</italic></sub> is difficult due to high dimensionality unless some additional conditions are imposed on the covariance matrix. To get around this difficulty, we shall consider a bootstrap approach. The main idea is that for each <italic>n</italic>, we randomly generate <italic>n</italic> samples from the reference data <italic>X<sub>i</sub></italic>, 1 ≤ <italic>i</italic> ≤ <italic>n</italic><sub>0</sub>, and construct some generated statistic. Using the empirical distribution of the generated statistic to approximate the distribution of our statistic. In the following, we shall provide the theoretical justification for this procedure.</p><p id="P35">For some integer <italic>J</italic> &gt; 0, let <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, …, <italic>A<sub>J</sub></italic> be i.i.d uniformly sampled from the class 𝓐<sub><italic>n</italic></sub> = {<italic>A</italic> : <italic>A</italic> ⊂ {1, 2, …,<italic>n</italic><sub>0</sub>}, ∣<italic>A</italic>∣ = <italic>n</italic>}. Assume the sampling process are independent from our data (<italic>X<sub>i</sub></italic>)<sub><italic>i</italic></sub>. Then for each 1 ≤ <italic>k</italic> ≤ <italic>J</italic>, the set {<italic>X<sub>i</sub>, i</italic> ∈ <italic>A<sub>k</sub></italic>} is of size <italic>n</italic> and can be used to construct one test statistic <inline-formula><mml:math id="M25"><mml:mi>n</mml:mi><mml:mo>∥</mml:mo><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></inline-formula> where <inline-formula><mml:math id="M26"><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula> After repeating this procedure <italic>J</italic> times, we would have <italic>J</italic> realizations of our test statistic which can be used to construct the empirical distribution <inline-formula><mml:math id="M27"><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo></mml:math></inline-formula> <disp-formula id="FD10"><mml:math id="M28"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>J</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>n</mml:mi><mml:mo>∥</mml:mo><mml:msubsup><mml:mtext>Λ</mml:mtext><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula></p><p id="P36">We shall later show that this empirical distribution can be adopted for approximating the distribution of the target statistic <inline-formula><mml:math id="M29"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⋄</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula> Following result can be derived based on Theorem 3.5 in Xu et al.[<xref ref-type="bibr" rid="R36">36</xref>] and Theorem 1.</p><p id="P37"><bold>Theorem 2</bold> <italic>Assume conditions in Theorem 1 hold</italic>, <italic>and moreover assume that n</italic> → ∞, <italic>n</italic> = <italic>o</italic>(<italic>n</italic><sub>0</sub>) <italic>and</italic> (<xref ref-type="disp-formula" rid="FD4">4</xref>) <italic>holds</italic>. <italic>Then for J</italic> → ∞, <italic>we have</italic> <disp-formula id="FD11"><label>(5)</label><mml:math id="M30"><mml:mstyle displaystyle="true"><mml:munder><mml:mo movablelimits="true">sup</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⋄</mml:mo></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula></p><p id="P38">Theorem 2 implies that we can use the empirical distribution generated from our sub-samples to estimate the distribution of our target. As mentioned previously, so far, we are assuming that we know the value of Λ<sub>0</sub> which is not realistic in applications. Therefore we need to further estimate Λ<sub>0</sub>, that is, we need to estimate the standard deviation for each coordinate. This can be easily accomplished by considering the estimator <disp-formula id="FD12"><mml:math id="M31"><mml:mstyle displaystyle="true"><mml:msubsup><mml:mrow><mml:mover><mml:mtext>Λ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula> where <italic>X</italic><sub><italic>i</italic>,<italic>j</italic></sub> represents the <italic>j</italic>th coordinate of <italic>X<sub>i</sub></italic>, and Λ<sub>0, <italic>j</italic></sub> is the jth diagonal entity of Λ<sub>0</sub> and <italic>n</italic><sub>0</sub> is the size of the reference data. Also one can use the average of the reference data to replace <italic>μ</italic>. If <italic>X</italic><sub><italic>i</italic>,<italic>j</italic></sub> has heavy tail, we can also consider a robust m-estimator for ∑<sub>0</sub> and <italic>μ</italic>, see for example, Catoni[<xref ref-type="bibr" rid="R8">8</xref>].</p></sec><sec id="S12"><title>Bootstrap procedure</title><p id="P39">Below we describe the bootstrap procedure we use to approximate the distribution of <italic>T<sub>n</sub></italic> for different census counts. Recall that <italic>X</italic><sub>1</sub>, …, <italic>X<sub>n</sub></italic> represent arrays of taxon relative abundances in the gut microbiome of human subject 1, …, <italic>n</italic>, and <italic>T<sub>n</sub></italic> is defined in (<xref ref-type="disp-formula" rid="FD3">Eq. 2</xref>).</p><list list-type="simple" id="L1"><list-item><p id="P40">Step 1. Estimate the population mean <inline-formula><mml:math id="M32"><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, and the diagonal matrix <inline-formula><mml:math id="M33"><mml:msub><mml:mrow><mml:mover><mml:mtext>Λ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></inline-formula> from a reference sample human gut microbiome data.</p></list-item><list-item><p id="P41">Step 2. For each census count <italic>n</italic>, generate <inline-formula><mml:math id="M34"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> from the reference data to compute <inline-formula><mml:math id="M35"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p></list-item><list-item><p id="P42">Step 3. Repeat Step 2 <italic>B</italic> times (herein 10,000 times) to get <inline-formula><mml:math id="M36"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></list-item><list-item><p id="P43">Step 4. Obtain the density function <inline-formula><mml:math id="M37"><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <italic>T<sub>n</sub></italic> based on <inline-formula><mml:math id="M38"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> using a Gaussian kernel.</p></list-item><list-item><p id="P44">Step 5. Repeat Steps 2-4 for all the census counts <italic>n</italic> =1, 2, …, <italic>N</italic> considered, herein <italic>N</italic> = 300. It should be noted that per Theorem 2 we require bootstrap sample size <italic>n</italic> much smaller than total reference sample size <italic>n</italic><sub>0</sub>, thus up to 300-person samples were simulated here because the gut microbiome reference dataset we utilized consisted of a total of 1,100 people. The range can be expanded if a larger dataset is available.</p></list-item></list></sec><sec id="S13"><title>Maximum Likelihood Estimation</title><p id="P45">We use a maximum likelihood estimation (MLE) procedure to achieve point estimates of the population size from a new mixture sample, <italic>W</italic>. The MLE procedure firstly computes <italic>T</italic><sub>0</sub> by replacing the sample average by <italic>W</italic>, that is <disp-formula id="FD13"><label>(6)</label><mml:math id="M39"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mtext>Λ</mml:mtext><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∥</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P46">And then computes the likelihoods that <italic>T</italic><sub>0</sub> was drawn from population sizes from 1 to <italic>N</italic>, respectively, using the estimated distributions generated from the bootstrap procedures described above. Next, the population size <inline-formula><mml:math id="M40"><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> that yields the highest likelihood is chosen.</p></sec><sec id="S14"><title>Confidence interval</title><p id="P47">Due to Theorem 1, the asymptotic distribution of <italic>nT<sub>n</sub></italic> is the same as <inline-formula><mml:math id="M41"><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> and is therefore independent of the parameter <italic>n</italic>. Hence for any confidence level 1 – <italic>α</italic>, we can firstly estimate the 1 – <italic>α</italic> quantile of <italic>nT<sub>n</sub></italic> based on the simulated data described above, denoted as <inline-formula><mml:math id="M42"><mml:msub><mml:mrow><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></inline-formula> Then for any new mixture <italic>W</italic> and the corresponding <italic>T</italic><sub>0</sub> as in (<xref ref-type="disp-formula" rid="FD13">6</xref>). We our 1 – <italic>α</italic> confidence interval is <inline-formula><mml:math id="M43"><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula></p></sec><sec id="S15"><title>Model training, validation, and testing</title><p id="P48">We synthesized a mixed data set from a gut microbiome dataset of 1,135 healthy human hosts from the Lifelines Deep study[<xref ref-type="bibr" rid="R39">39</xref>], which was the largest single-center study of population-level human microbiome variations from a single sequencing center at the time of this study. The data set consisted of 661 women and 474 men. We considered OTUs defined by 99% similarity of partial ribosomal RNA gene sequences (<xref ref-type="sec" rid="S10">Methods</xref> of OTU clustering are described in detail in Supplementary Methods). After quality filtering, we retained 1,100 samples that had more than 4,000 sequencing reads/sample. We split the entire dataset approximately in half, using 550 subjects to generate the training/validation set and the other 550 subjects to generate the test set. We then used the aforementioned ideal sewage mixture approach to generate synthetic populations of up to 300 individuals, which is the relevant range for population estimation in upstream sewage. The training error was computed using the entire training data set. Five repeated holdout validations using a 50-50 split in the training set were performed to tune the hyperparameter for feature selection. The training and cross-validation errors were evaluated at integers from 1 to 100, using the error definition: <disp-formula id="FD14"><label>(7)</label><mml:math id="M44"><mml:mstyle displaystyle="true"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>predicted </mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>actual </mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>actual </mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mtext>%</mml:mtext></mml:mstyle></mml:math></disp-formula> and the model’s performance across all the population sizes was characterized by the mean absolute percentage error (MAPE): <disp-formula id="FD15"><label>(8)</label><mml:math id="M45"><mml:mstyle displaystyle="true"><mml:mrow><mml:mtext>MAPE</mml:mtext></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>predicted </mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>actual </mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>actual </mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mtext>%</mml:mtext><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula></p><p id="P49">We chose to use MAPE because for a problem of population estimation, the the error relative to the true value is important to consider for performance evaluation. After training and validation, the hyperparameter (in this case, the top <italic>k</italic> abundant OTUs) that yielded the best performance in the validation step was used in the model. The tuned model was then tested on the test set. Our synthetic sewage microbiome approach captured the actual microbiome variation among individual hosts and demonstrated the model’s generalizability.</p></sec><sec id="S16"><title>Human gut microbiome 16S rRNA amplicon data source</title><p id="P50">The single-person and multi-person microbiome data were drawn from a gut microbiome dataset of 1,135 healthy human hosts from the Lifelines Deep study [<xref ref-type="bibr" rid="R39">39</xref>], which was the largest study of population-level human microbiome variations from a single sequencing center at the time of this study. The data set consisted of 661 women and 474 men. We considered operational taxonomic units defined by 99% similarity of partial ribosomal RNA gene sequences. After quality filtering, we retained 1,100 samples that had more than 4,000 sequencing reads/sample. The rarefaction depth was chosen to balance sample size and sequencing depth.</p></sec><sec id="S17"><title>16S rRNA gene amplicon sequencing data analysis</title><p id="P51">Operational taxonomic units defined at 99% sequencing similarity were generated from the combined dataset by first denoising the samples with DADA2[<xref ref-type="bibr" rid="R7">7</xref>], and then clustering the outputted exact sequence variants with the q2-vsearch plugin of QIIME2 [<xref ref-type="bibr" rid="R33">33</xref>]. Taxonomic assignments were performed using a multinomial naïve Bayes classifier against SILVA 132[<xref ref-type="bibr" rid="R32">32</xref>, <xref ref-type="bibr" rid="R4">4</xref>]. All 16S rRNA gene amplicon analyses were performed in the QIIME2 platform (QIIME 2019.10) [<xref ref-type="bibr" rid="R5">5</xref>].</p></sec><sec id="S18"><title>Species Abundance Distribution</title><p id="P52">We examined the relationships between the performances of several widely used SAD models and the number of contributors (population size) to a multi-person microbiome. Multi-person microbiomes were generated by sampling N individuals from the quality-filtered gut microbiome 16S rRNA dataset and summing the abundances of the same taxa. At each population size, 10,000 repeats were performed. The repeats were chosen according to the constraints of computational efficiency. The SADs evaluated included the Lognormal, Poisson Lognormal, Broken-stick, Log series and the Zipf model, which were shown to have varied successes in predicting microbial SADs [<xref ref-type="bibr" rid="R34">34</xref>]. We examined the fit using a rank-by-rank approach as previously described by Shoemaker et al. [<xref ref-type="bibr" rid="R34">34</xref>]. First, maximum-likelihood coefficients for each of the SADs described above were estimated using the R package sads[<xref ref-type="bibr" rid="R30">30</xref>]. Next, SADs were predicted using each model, and tabulated as RADs. Then, we used a least-squares regression to assess the relationship between the performance of the predicted SADs against the observations and recorded the coefficient of determination (R-squared). Last, R-squared values from model fits of each SAD model were summarized as the means, and the models that resulted in the highest R-squared values for each simulated community were recorded.</p></sec><sec id="S19"><title>Field data</title><p id="P53">We conducted a field sampling campaign, collecting sewage samples daily at manholes near three buildings (two dormitory buildings and one office building) on the campus of Massachusetts Institute of Technology. Seventy-six sewage samples were collected through a continuous peristaltic pump sampler operated at the morning peak (7-10 a.m. near the dormitory buildings and 8-11 a.m. near the office building) at 4 mL/min for 3 hours. Wastewater was filtered through sterile 0.22-μm mixed cellulose filters to collect microbial biomass. Environmental DNA was extracted with a Qiagen PowerSoil DNA extraction kit according to the manufacturer’s protocol. The DNA was amplified for the V4 region of the 16S rRNA gene and sequenced in a Miseq paired-end format at the MIT BioMicro Center, according to a previously published protocol[<xref ref-type="bibr" rid="R31">31</xref>]. Included as a comparison are a set of snapshot sewage samples taken using a peristaltic pump sampler at 100 mL/min for 5 minutes over a day (10 a.m. on Wednesday April 8, 2015, to 9 a.m. on Thursday April 9, 2015). The sampling methods for snapshot samples are described in detail by Matus et al.[<xref ref-type="bibr" rid="R24">24</xref>]</p></sec><sec id="S20"><title>Application to sewage data</title><p id="P54">1he 16S rRNA gene amplicon sequencing data from the field sewage samples were trimmed to the same region, 16S V4 (534-786) with the LifeLines Deep data using Cutadapt 1.12 [<xref ref-type="bibr" rid="R23">23</xref>]. Forward reads were trimmed to 175bps, and reverse reads were first trimmed to 175bps and then further trimmed to 155bps during quality screening. We created a taxonomic filter based on the composition of the gut microbiome data set, which consisted of the abundant family-level taxa that accounted for 99% of the sequencing reads in the human gut microbiome data set, and excluded those that might have an ecological niche in tap water (<italic>Enterobacteriaceae</italic> and <italic>Burkholderiaceae</italic>). This exclusion resulted in 25 bacterial families and one archaeal family in our taxonomic filter, including <italic>Lachnospiraceae</italic>, <italic>Ruminococcaceae</italic>, <italic>Bifidobacteriaceae, Erysipelotrichaceae, Bacteroidaceae</italic>, and others (Table S4). We applied our taxonomic filter to the sewage sequencing data, which retained 73.9% of the sequencing reads. This retention rate is consistent with our previous report of the human microbiome fraction in residential sewage samples[<xref ref-type="bibr" rid="R24">24</xref>]. We then normalized the relative abundance of taxa against the remaining sequencing reads in each sample. Welch’s two-sample t-tests were performed to retain the OTUs whose means did not differ significantly from the human microbiome data set (p &gt; 0.05).</p></sec><sec id="S21"><title>Deployment of generic machine learning models</title><p id="P55">Logistic regression, support vector machine, and random forest classifiers were employed to perform the classification task for population sizes of 1, 10, and 100. Model training, cross-validation, and testing were performed using the R Caret platform with the default setting[<xref ref-type="bibr" rid="R18">18</xref>]. For the support vector machine, the radial basis function kernel was employed. Ten-fold cross-validation and five repeats were performed for all the models considered. Model performance was evaluated using accuracy, sensitivity, and specificity. Based on the classifier performance, the RF regression model was used for comparison with our new model’s performance. Initially, we trained the model using the same training data set used in training our maximum likelihood model, however, the computation was infeasible, even with a 36-thread, 3TB-memory computing cluster. We then introduced gaps in the population size range, using populations from the vector (1, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 150, 180, 240, 300)<sup>⊤</sup> while maintaining the same sample size at each population size (10,000 samples). The training was performed in R Caret, using 10-fold cross-validation. Ten variables were randomly sampled as candidates at each split, mtry=10. The performance was evaluated using the same testing set that was used to evaluate the maximum likelihood model.</p></sec></sec></body><back><ack id="S22"><title>Acknowledgements</title><p>We thank Cho C. Yiu, David E Hingston, and Joseph S. Monteiro from the MIT Facilities department for assistance with sewage sampling. We thank Noriko Endo, Sean Gibbons, Tami Lieberman, Xiaofang Jiang and Shijie Zhao for valuable discussions. We thank Mariana Matus and Newsha Ghaeli for acquisition and access of 24-hr sewage time series data. The sampling and sequencing experiments were performed with funding from the Kuwait Foundation for Advancement of Sciences. Fangqiong Ling’s work at MIT was partially supported by an Alfred P. Sloan Foundation Microbiology of the Built Environment Postdoctoral Fellowship. The computational analyses were performed with resources provided by the WUSTL McKelvey School of Engineering. Lin Zhang was supported by National Science Foundation Grant 1322-58679 awarded to Fangqiong Ling.</p></ack><sec sec-type="data-availability" id="S23"><title>Code and data availability</title><p id="P56">Source code will be made avaiable through <ext-link ext-link-type="uri" xlink:href="https://github.com/linglab-washu/population-model">https://github.com/linglab-washu/population-model</ext-link> upon publication. Sewage metagenomic data will be made available at National Center for Biotechnology Information Short Read Archive at BioProject PRJNA683921 upon the time of publication.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P57"><bold>Author contributions statement</bold></p><p id="P58">F.L. and E.J.A. designed the study; F.L. performed simulation; L.C. performed mathematical proofs; F.L., X.Y. and L.Z. performed sequence analysis; F.L., S.I., C.Dai., and S.P. performed sewage experiments; C. Duvallet, K. F-M, F.D. C.R. and E.J.A. coordinated the acquisition of sequencing data; L.Z., L.C., E.J.A and F.L. wrote the manuscript.</p></fn><fn id="FN2" fn-type="conflict"><p id="P59"><bold>Competing interests</bold></p><p id="P60">E.J.A has an equity stake in Biobot Analytics. C. Duvallet is employed by Biobot Analytics.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>Zhidong</given-names></name><name><surname>Saranadasa</surname><given-names>Hewa</given-names></name></person-group><article-title>Effect of high dimension: by an example of a two sample problem</article-title><source>Statistica Sinica</source><year>1996</year><fpage>311</fpage><lpage>329</lpage></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berchenko</surname><given-names>Yakir</given-names></name><etal/></person-group><article-title>Estimation of polio infection prevalence from environmental surveillance data</article-title><source>Science Translational Medicine</source><year>2017</year><month>Mar</month><volume>9</volume><issue>383</issue><publisher-name>Publisher: American Association for the Advancement of Science Section: Reports</publisher-name><fpage>1946</fpage><lpage>6242</lpage><pub-id pub-id-type="doi">10.1126/scitranslmed.aaf6786</pub-id><comment>ISSN: 1946-6234, URL: <ext-link ext-link-type="uri" xlink:href="https://stm.sciencemag.org/content/9/383/eaaf6786">https://stm.sciencemag.org/content/9/383/eaaf6786</ext-link> (visited on 07/22/2020)</comment></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bivins</surname><given-names>Aaron</given-names></name><etal/></person-group><article-title>Wastewater-Based Epidemiology: Global Collaborative to Maximize Contributions in the Fight Against COVID-19</article-title><source>Environmental Science &amp; Technology</source><year>2020</year><volume>54</volume><issue>13</issue><fpage>7754</fpage><lpage>7757</lpage><pub-id pub-id-type="doi">10.1021/acs.est.0c02388</pub-id><comment>ISSN: 1520-5851</comment></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bokulich</surname><given-names>Nicholas A</given-names></name><etal/></person-group><article-title>Optimizing Taxonomic Classification of Marker-Gene Amplicon Sequences with QIIME 2’s Q2-Feature-Classifier Plugin</article-title><source>Microbiome</source><year>2018</year><month>May</month><volume>6</volume><issue>1</issue><fpage>90</fpage><pub-id pub-id-type="doi">10.1186/s40168-018-0470-z</pub-id><comment>ISSN: 2049-2618</comment></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolyen</surname><given-names>Evan</given-names></name><etal/></person-group><article-title>Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2</article-title><source>Nature biotechnology</source><year>2019</year><volume>37</volume><issue>8</issue><fpage>852</fpage><lpage>857</lpage></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burkholder</surname><given-names>Donald L</given-names></name></person-group><article-title>Sharp inequalities for martingales and stochastic integrals</article-title><source>Astérisque</source><year>1988</year><volume>157</volume><issue>158</issue><fpage>75</fpage><lpage>94</lpage></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callahan</surname><given-names>Benjamin J</given-names></name><etal/></person-group><article-title>DADA2: high-resolution sample inference from Illumina amplicon data</article-title><source>Nature methods</source><year>2016</year><volume>13</volume><issue>7</issue><fpage>581</fpage><lpage>583</lpage></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Catoni</surname><given-names>Olivier</given-names></name></person-group><article-title>Challenging the empirical mean and empirical variance: a deviation study</article-title><source>Annales de l’IHP Probabilités et statistiques</source><year>2012</year><volume>48</volume><issue>4</issue><fpage>1148</fpage><lpage>1185</lpage></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="web"><collab>CDC</collab><source>National Wastewater Surveillance System en-us</source><year>2020</year><month>Oct</month><comment>URL: <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/coronavirus/2019-ncov/cases-updates/wastewater-surveillance.html">https://www.cdc.gov/coronavirus/2019-ncov/cases-updates/wastewater-surveillance.html</ext-link> (visited on 11/29/2020)</comment></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Song X</given-names></name><name><surname>Qin</surname><given-names>Ying-Li</given-names></name><etal/></person-group><article-title>A two-sample test for high-dimensional data with applications to gene-set testing</article-title><source>The Annals of Statistics</source><year>2010</year><volume>38</volume><issue>2</issue><fpage>808</fpage><lpage>835</lpage></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daughton</surname><given-names>Christian G</given-names></name></person-group><article-title>Real-time estimation of small-area populations with human biomarkers in sewage eng</article-title><source>The Science of the Total Environment</source><year>2012</year><month>Jan</month><volume>414</volume><fpage>6</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/j.scitotenv.2011.11.015</pub-id><comment>ISSN: 1879-1026</comment></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>David</surname><given-names>Lawrence A</given-names></name><etal/></person-group><article-title>Host lifestyle affects human microbiota on daily timescales eng</article-title><source>Genome Biology</source><year>2014</year><volume>15</volume><issue>7</issue><fpage>R89</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-7-r89</pub-id><comment>ISSN: 1474-760X</comment></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fazel-Zarandi</surname><given-names>Mohammad M</given-names></name><name><surname>Feinstein</surname><given-names>Jonathan S</given-names></name><name><surname>Kaplan</surname><given-names>Edward H</given-names></name></person-group><article-title>The number of undocumented immigrants in the United States: Estimates based on demographic modeling with data from 1990 to 2016 eng</article-title><source>PloS One</source><year>2018</year><volume>13</volume><issue>9</issue><elocation-id>e0201193</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0201193</pub-id><comment>ISSN: 1932-6203</comment></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>Yan</given-names></name><etal/></person-group><article-title>Regional Variation Limits Applications of Healthy Gut Microbiome Reference Ranges and Disease Models en</article-title><source>Nature Medicine</source><year>2018</year><month>Oct</month><volume>24</volume><issue>10</issue><fpage>1532</fpage><lpage>1535</lpage><pub-id pub-id-type="doi">10.1038/s41591-018-0164-x</pub-id><comment>ISSN: 1546-170X</comment></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heaton</surname><given-names>KW</given-names></name><etal/></person-group><article-title>Defecation frequency and timing, and stool form in the general population: a prospective study eng</article-title><source>Gut</source><year>1992</year><month>June</month><volume>33</volume><issue>6</issue><fpage>818</fpage><lpage>824</lpage><pub-id pub-id-type="doi">10.1136/gut.33.6.818</pub-id><comment>ISSN: 0017-5749</comment></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hotelling</surname><given-names>Harold</given-names></name><name><surname>Frankel</surname><given-names>Lester R</given-names></name></person-group><article-title>The Transformation of Statistics to Simplify their Distribution</article-title><source>The Annals of Mathematical Statistics</source><year>1938</year><volume>9</volume><issue>2</issue><publisher-name>Publisher: Institute of Mathematical Statistics</publisher-name><fpage>87</fpage><lpage>96</lpage><comment>ISSN: 0003-4851. URL: <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2957606">http://www.jstor.org/stable/2957606</ext-link> (visited on 09/17/2020)</comment></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>Abigail J</given-names></name><etal/></person-group><article-title>Daily Sampling Reveals Personalized Diet-Microbiome Associations in Humans. en</article-title><source>Cell Host &amp; Microbe</source><year>2019</year><month>June</month><volume>25</volume><issue>6</issue><fpage>789</fpage><lpage>802</lpage><elocation-id>e5</elocation-id><pub-id pub-id-type="doi">10.1016/j.chom.2019.05.005</pub-id><comment>ISSN: 1931-3128</comment></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kuhn</surname><given-names>Max</given-names></name></person-group><article-title>Building Predictive Models in R Using the caret Package</article-title><source>Journal of Statistical Software</source><year>2008</year><month>Nov</month><volume>028</volume><issue>i05</issue><publisher-name>Publisher: Foundation for Open Access Statistics</publisher-name><comment>URL: <ext-link ext-link-type="uri" xlink:href="https://econpapers.repec.org/article/jssjstsof/v_3a028_3ai05.htm">https://econpapers.repec.org/article/jssjstsof/v_3a028_3ai05.htm</ext-link> (visited on 08/10/2020)</comment></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leibold</surname><given-names>Mathew A</given-names></name><name><surname>Chase</surname><given-names>Jonathan M</given-names></name></person-group><source>Metacommunity Ecology</source><year>2017</year><month>Dec</month><volume>59</volume><publisher-name>Princeton University Press</publisher-name><comment>en. Google-Books-ID: IEkqDwAAQBAJ. isbn: 978-1-4008-8906-8</comment></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozupone</surname><given-names>Catherine A</given-names></name><etal/></person-group><article-title>Diversity, stability and resilience of the human gut microbiota</article-title><source>Nature</source><year>2012</year><month>Sept</month><volume>489</volume><issue>7415</issue><fpage>220</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1038/nature11550</pub-id><pub-id pub-id-type="pmcid">PMC3577372</pub-id><comment>ISSN: 0028-0836. (visited on 09/12/2020)</comment></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manor</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Intensified environmental surveillance supporting the response to wild poliovirus type 1 silent circulation in Israel, 2013 eng</article-title><source>Euro Surveillance: Bulletin Europeen Sur Les Maladies Transmissibles = European Communicable Disease Bulletin</source><year>2014</year><month>Feb</month><volume>19</volume><issue>7</issue><elocation-id>20708</elocation-id><pub-id pub-id-type="doi">10.2807/1560-7917.es2014.19.7.20708</pub-id><comment>ISSN: 1560-7917</comment></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maritz</surname><given-names>Julia M</given-names></name><etal/></person-group><article-title>Patterns of protist diversity associated with raw sewage in New York City. en</article-title><source>The ISME Journal</source><year>2019</year><month>Nov</month><volume>13</volume><issue>11</issue><publisher-name>Publisher: Nature Publishing Group</publisher-name><fpage>2750</fpage><lpage>2763</lpage><pub-id pub-id-type="doi">10.1038/s41396-019-0467-z</pub-id><comment>Number: 11. ISSN: 1751-7370. URL: <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41396-019-0467-z">https://www.nature.com/articles/s41396-019-0467-z</ext-link> (visited on 11/29/2020)</comment></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>Marcel</given-names></name></person-group><article-title>Cutadapt Removes Adapter Sequences from High-Throughput Sequencing Reads en</article-title><source>EMBnet.journal</source><year>2011</year><month>May</month><volume>17</volume><issue>1</issue><fpage>10</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id><comment>ISSN: 2226-6089</comment></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Matus</surname><given-names>Mariana</given-names></name><etal/></person-group><article-title>24-hour multi-omics analysis of residential sewage reflects human activity and informs public health. en</article-title><source>bioRxiv</source><year>2019</year><month>Sept</month><publisher-name>Publisher: Cold Spring Harbor Laboratory Section: New Results</publisher-name><elocation-id>728022</elocation-id><pub-id pub-id-type="doi">10.1101/728022</pub-id><comment>URL: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/728022v2">https://www.biorxiv.org/content/10.1101/728022v2</ext-link> (visited on 06/21/2020)</comment></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Medema</surname><given-names>Gertjan</given-names></name><etal/></person-group><article-title>Presence of SARS-Coronavirus-2 RNA in Sewage and Correlation with Reported COVID-19 Prevalence in the Early Stage of the Epidemic in The Netherlands. en</article-title><source>Environmental Science &amp; Technology Letters</source><publisher-name>Publisher: American Chemical Society</publisher-name><pub-id pub-id-type="doi">10.1021/acs.estlett.0c00357</pub-id><pub-id pub-id-type="pmcid">PMC7254611</pub-id><comment>(visited on 09/16/2020)</comment></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname><given-names>Raaj S</given-names></name><etal/></person-group><article-title>Stability of the human faecal microbiome in a cohort of adult men eng</article-title><source>Nature Microbiology</source><year>2018</year><volume>3</volume><issue>3</issue><fpage>347</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1038/s41564-017-0096-0</pub-id><comment>ISSN: 2058-5276</comment></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>Elizabeth Theresa</given-names></name><name><surname>Svanbäck</surname><given-names>Richard</given-names></name><name><surname>Bohannan</surname><given-names>Brendan JM</given-names></name></person-group><article-title>Microbiomes as Metacommunities: Understanding Host-Associated Microbes through Metacommunity Ecology. en</article-title><source>Trends in Ecology &amp; Evolution</source><year>2018</year><month>Dec</month><volume>33</volume><issue>12</issue><fpage>926</fpage><lpage>935</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2018.09.002</pub-id><comment>ISSN: 0169-5347</comment></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murakami</surname><given-names>Michio</given-names></name><etal/></person-group><article-title>Letter to the Editor: Wastewater-Based Epidemiology Can Overcome Representativeness and Stigma Issues Related to COVID-19 eng</article-title><source>Environmental Science &amp; Technology</source><year>2020</year><volume>54</volume><issue>9</issue><elocation-id>5311</elocation-id><pub-id pub-id-type="doi">10.1021/acs.est.0c02172</pub-id><comment>ISSN: 1520-5851</comment></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>Ryan J</given-names></name><etal/></person-group><article-title>Sewage Reflects the Microbiomes of Human Populations</article-title><source>mBio</source><year>2015</year><month>Feb</month><volume>6</volume><issue>2</issue><pub-id pub-id-type="doi">10.1128/mBio.02574-14</pub-id><comment>ISSN: 2150-7511</comment></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prado</surname><given-names>Paulo I</given-names></name><name><surname>Miranda</surname><given-names>Murilo Dantas</given-names></name><name><surname>Chalom</surname><given-names>Andre</given-names></name></person-group><article-title>sads: Maximum Likelihood Models for Species Abundance Distributions</article-title><source>R package version 042</source><year>2018</year><comment>URL: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=sads">https://CRAN.R-project.org/package=sads</ext-link></comment></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preheim</surname><given-names>Sarah P</given-names></name><etal/></person-group><article-title>Computational methods for high-throughput comparative analyses of natural microbial communities eng</article-title><source>Methods in Enzymology</source><year>2013</year><volume>531</volume><fpage>353</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/B978-0-12-407863-5.00018-6</pub-id><comment>ISSN: 1557-7988</comment></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quast</surname><given-names>Christian</given-names></name><etal/></person-group><article-title>The SILVA Ribosomal RNA Gene Database Project: Improved Data Processing and Web-Based Tools eng</article-title><source>Nucleic Acids Research</source><year>2013</year><month>Jan</month><volume>41</volume><issue>Database issue</issue><elocation-id>D590–596</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id><comment>ISSN: 1362-4962</comment></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rognes</surname><given-names>Torbjørn</given-names></name><etal/></person-group><article-title>VSEARCH: A Versatile Open Source Tool for Metagenomics eng</article-title><source>PeerJ</source><year>2016</year><volume>4</volume><elocation-id>e2584</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.2584</pub-id><comment>ISSN: 2167-8359</comment></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Shoemaker</surname><given-names>William R</given-names></name><name><surname>Locey</surname><given-names>Kenneth J</given-names></name><name><surname>Lennon</surname><given-names>Jay T</given-names></name></person-group><article-title>A macroecological theory of microbial biodiversity. en</article-title><source>Nature Ecology &amp; Evolution</source><year>2017</year><month>Apr</month><volume>1</volume><issue>5</issue><publisher-name>Publisher: Nature Publishing Group</publisher-name><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1038/s41559-017-0107</pub-id><comment>Number: 5 ISSN: 2397-334X. URL: <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41559-017-0107">https://www.nature.com/articles/s41559-017-0107</ext-link> (visited on 12/01/2020)</comment></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Šizling</surname><given-names>Arnošt L</given-names></name><etal/></person-group><article-title>Species abundance distribution results from a spatial analogy of central limit theorem</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2009</year><month>Apr</month><volume>106</volume><issue>16</issue><fpage>6691</fpage><lpage>6695</lpage><pub-id pub-id-type="doi">10.1073/pnas.0810096106</pub-id><pub-id pub-id-type="pmcid">PMC2672478</pub-id><comment>ISSN: 0027-8424. (visited on 12/02/2020)</comment></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Mengyu</given-names></name><name><surname>Zhang</surname><given-names>Danna</given-names></name><name><surname>Wu</surname><given-names>Wei Biao</given-names></name></person-group><article-title>L2 Asymptotics for High-Dimensional Data</article-title><source>arXiv preprint arXiv</source><year>2014</year><elocation-id>1405.7244</elocation-id></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Zhugen</given-names></name><etal/></person-group><article-title>Monitoring Genetic Population Biomarkers for Wastewater-Based Epidemiology eng</article-title><source>Analytical Chemistry</source><year>2017</year><volume>89</volume><issue>18</issue><fpage>9941</fpage><lpage>9945</lpage><comment>ISSN: 1520-6882</comment><pub-id pub-id-type="doi">10.1021/acs.analchem.7b02257</pub-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Tao</given-names></name><etal/></person-group><article-title>RNA Viral Community in Human Feces: Prevalence of Plant Pathogenic Viruses. en</article-title><source>PLOS Biology</source><year>2005</year><month>Dec</month><volume>4</volume><issue>1</issue><publisher-name>Publisher: Public Library of Science</publisher-name><fpage>e3</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0040003</pub-id><comment>ISSN: 1545-7885. (visited on 11/30/2020)</comment></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhernakova</surname><given-names>Alexandra</given-names></name><etal/></person-group><article-title>Population-based metagenomics analysis reveals markers for gut microbiome composition and diversity. en</article-title><source>Science</source><year>2016</year><month>Apr</month><volume>352</volume><issue>6285</issue><publisher-name>Publisher: NIH Public Access</publisher-name><fpage>565</fpage><pub-id pub-id-type="doi">10.1126/science.aad3369</pub-id><pub-id pub-id-type="pmcid">PMC5240844</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" orientation="portrait" position="float"><caption><title>Author summary</title></caption><p>Wastewater-based epidemiology (WBE) is an emerging field that employs sewage as aggregated samples of human populations. This approach is particularly promising for tracking diseases that can spread asymptomatically in large populations, such as the COVID-19. As a new type of biological data, sewage has its own unique challenges to utilize. While wastewater samples are usually assumed to represent large populations, it is not guaranteed, because of stochasticity in toilet flushes; unlike epidemiological experiments collecting data from individuals, sample size, i.e., the human population size represented by a wastewater sample, is a fundamental yet difficult-to-characterize parameter for sewage samples. Researchers would need to aggregate data from large areas and week-long collection to stabilize data, during which, important spikes in small areas or short time scales may be lost. It also remains challenging to turn viral titers into case prevalences, evaluating representativeness, or comparing measurements across sites/studies.</p><p>This study provides a framework to estimate human population size from sewage utilizing human gut-associated microorganisms. Through analysis, we demonstrate that variance of taxon abundances and single-nucleotide polymorphism as two variables that change with population size. We provide a new tool MicrobiomeCensus that performs population size estimation from microbial taxon abundances. MicrobiomeCensus outperforms generic algorithms in terms of computational efficiency while at comparable or better accuracy. Using MicrobiomeCensus, we detected population size differences in sewage samples taken in Cambridge, MA, under two sampling approaches, i.e., ”grab” or ”composite” sampling. This study provides a framework to utilize individual-level microbiomes to learn from sewage, paving the way to prevalence estimation and improved spatio-temporal resolutions in WBE..</p></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><title>An ideal sewage mixture simulation shows the potential of microbiome taxon abundance profiles as population census information sources.</title><p>(A) We generated an “ideal sewage mixture” consisting of gut microbiomes from different numbers of people. (B) Ranked abundance curves for gut microbiomes of one person and mixtures of multiple people exhibit different levels of dominance and diversity. Blue lines show the rank abundance curves in stool samples (one person), red lines show 10-person mixtures, and saffron lines show 100-person mixtures. In each scenario, ten examples are shown. All samples were rarefied to the same sequencing depths (4,000 seqs/sample). (C) The probability density function of the relative abundance of one taxon for different population sizes. OTU-2379, a <italic>Bifidobacterium</italic> taxon, was used as an example. Maroon dashed lines indicate the sample means. (D) Multiple taxa’s abundance variances in one-person samples and 100-person samples. The dominant taxa are shown (top100) and are sorted by their ranks in variance. (E) The ratios of the variances of one-person samples and 100-person samples across dominant gut microbial taxa.</p></caption><graphic xlink:href="EMS146587-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Classifier performance of models utilizing gut microbiome taxon abundances.</title></caption><graphic xlink:href="EMS146587-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>MicrobiomeCensus statistic definition, model training, validation, and application.</title><p>(A) Example of computing the <italic>T</italic> statistic. (B) Simulation results for <italic>T</italic> with different population sizes. Grey points are simulation results. Red bars are means of 10,000 repeats performed for each population size. (C) Model training and tuning. We built the MicrobiomeCensus model using our <italic>T</italic> statistic and a maximum likelihood procedure. The training set consisted of 10,000 samples for population sizes ranging from 1-300, and 50% of the data were used to train and validate the model. Training and validation errors from different feature subsets are shown. Training errors are shown as red lines, and validation errors are shown as blue lines. (D) Model performance on simulation benchmark. After training and validation, the model utilized the top 120 abundance features. Model performance was tested on synthetic data generated from 550 different subjects not previously seen by the model. The training set consisted of 10,000 samples with population sizes from 1-300, and the testing set consisted of 10,000 repeats at the evaluated population sizes. The training error, testing error, and the error of the final model are shown. (E) Model performance evaluated using a testing set. Black solid dots indicate the means of the predicted values, and error bars indicate the standard deviations of the predicted values. (F) Application of the microbiome population model in sewage. Seventy-six composite samples (blue) were taken from three manholes on the MIT campus, and each sample was taken over 3 hours during the morning peak water usage hours. Twenty-five snapshot samples (grey) were taken using a peristaltic pump for 5 minutes at 1-hour intervals throughout a day.</p></caption><graphic xlink:href="EMS146587-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Sub-species diversity in gut-associated bacterial species as a potential marker for human population size.</title><p>(A-F) Comparison of sub-species diversity of gut-associated bacteria in human gut microbiome samples (LifelinesDeep) and MIT sewage samples. Nucleotide diversity and numbers of polymorphic sites were computed from ten phylogenetic marker genes. (G) and (H) Simulation results showing intra-species diversity in response to increasing population size, as represented by the number of polymorphic sites (G) and nucleotide diversity (H).</p></caption><graphic xlink:href="EMS146587-f004"/></fig></floats-group></article>