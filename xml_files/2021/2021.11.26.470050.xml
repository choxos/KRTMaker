<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS157438</article-id><article-id pub-id-type="doi">10.1101/2021.11.26.470050</article-id><article-id pub-id-type="archive">PPR425554</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">4</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Tracking bacteria at high density with FAST, the Feature-Assisted Segmenter/Tracker</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Meacock</surname><given-names>Oliver J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Durham</surname><given-names>William M.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR2">†</xref></contrib><aff id="A1"><label>1</label>Department of Zoology, University of Oxford, Oxford, United Kingdom</aff><aff id="A2"><label>2</label>Department of Physics and Astronomy, University of Sheffield, Sheffield, United Kingdom</aff><aff id="A3"><label>3</label>Department of Fundamental Microbiology, University of Lausanne, Lausanne, Switzerland</aff></contrib-group><author-notes><corresp id="CR1">
<label>*</label><email>oliver.meacock@unil.ch</email></corresp><corresp id="CR2">
<label>†</label><email>w.m.durham@sheffield.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>22</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>11</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Most bacteria live attached to surfaces in densely-packed communities<sup><xref ref-type="bibr" rid="R1">1</xref>,<xref ref-type="bibr" rid="R2">2</xref></sup>. While new experimental and imaging techniques are beginning to provide a window on the complex processes that play out in these communities, resolving the behaviour of individual cells through time and space remains a major challenge. Although a number of different software solutions have been developed to track microorganisms<sup><xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup>, these approaches typically rely on a large number of user-defined parameters that must be carefully tuned to effectively track cells. Testing a given parameter combination can take hours to days depending on the size of the dataset, making iterative optimisation impractical. To overcome these limitations, we have developed FAST, the Feature-Assisted Segmenter/Tracker, which uses unsupervised machine learning to optimise tracking while maintaining ease of use. Our approach, rooted in information theory, largely eliminates the need for users to iteratively adjust parameters manually and make qualitative assessments of the resulting cell trajectories. Instead, FAST measures multiple distinguishing “features” for each cell and then autonomously quantifies the amount of unique information each feature provides. We then use these measurements to determine how data from different features should be combined to minimize tracking errors. Comparing our algorithm with a naïve approach that uses cell position alone revealed that FAST produced 4 to 10 times fewer tracking errors. The modular design of FAST combines our novel tracking method with tools for segmentation, extensive data visualisation, lineage assignment, and manual track correction. It is also highly extensible, allowing users to extract custom information from images and seamlessly integrate it into downstream analyses. FAST therefore enables high-throughput, data-rich analyses with minimal user input. It has been released for use either in Matlab or as a compiled stand-alone application, and is available at <ext-link ext-link-type="uri" xlink:href="https://bit.ly/3vovDHn">https://bit.ly/3vovDHn</ext-link>, along with extensive tutorials and detailed documentation.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">Time-lapse microscopic imaging and automated cell tracking has led to many fundamental advances in our understanding of how microorganisms sense and respond to their environment. While many studies have focused on the movement of planktonic bacteria at relatively low densities, many behaviours – including collective movement<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R10">10</xref></sup>, combat<sup><xref ref-type="bibr" rid="R11">11</xref></sup>, sharing of public goods<sup><xref ref-type="bibr" rid="R12">12</xref></sup> and genetic exchange<sup><xref ref-type="bibr" rid="R13">13</xref></sup> – typically only occur in the closely-packed assemblages in which most microbes live. These dense communities are often studied in the laboratory using confluent monolayers of cells, which are much easier to image than three-dimensional aggregations. One method to generate such monolayers is to confine cells with a slab of agarose or polyacrylamide to form an interstitial colony<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref></sup>, while more advanced microfluidic techniques<sup><xref ref-type="bibr" rid="R17">17</xref></sup> can also be used to confine cells to a single plane while allowing for more precise control over their chemical environment (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). Monolayers can also form in thin films of fluid, including those arising naturally during bacterial swarming motility<sup><xref ref-type="bibr" rid="R10">10</xref></sup> and in assays used to study mixing induced by flagellar motility<sup><xref ref-type="bibr" rid="R18">18</xref></sup>. Regardless of the origin of the monolayer however, investigators face the same technical challenges when tracking densely packed cells using phase-contrast, brightfield and/or epi-fluorescence microscopy (<xref ref-type="fig" rid="F1">Fig. 1b</xref>).</p><p id="P3">Tracking solitary cells at low density is relatively straightforward, and basic tracking algorithms that use cell position alone often produce excellent results. However, tracking cells that are densely packed together is notoriously difficult because the spacing between neighbouring cells becomes similar to the distance cells move between frames. These problems are exacerbated by cell motility. While some species of bacteria are non-motile at high density and spread slowly only via cell division and the secretion of surfactants<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R17">17</xref></sup>, emergent patterns of collective motility driven by twitching<sup><xref ref-type="bibr" rid="R9">9</xref></sup>, swarming<sup><xref ref-type="bibr" rid="R10">10</xref></sup> and gliding<sup><xref ref-type="bibr" rid="R19">19</xref></sup> further complicate tracking by rapidly changing the positions of cells. Consequently, dense, motile communities must be imaged at high framerates for tracking to be feasible, such that a typical experiment requires a timeseries of hundreds or thousands of images. The large size of imaging datasets, combined with the large number of cells within each image, means that the computational time required for cell tracking is often one of the main bottlenecks in a researcher’s workflow. This can be compounded if tracking must be repeated multiple times to optimise tracking parameters.</p><p id="P4">A basic nearest-neighbour tracking algorithm compares the coordinates of cell centroids between subsequent frames and build trajectories by connecting those centroids that are closest together between subsequent time points. More advanced algorithms leverage additional cell characteristics or “features” to distinguish cells from one another, including metrics that measure cell shape, orientation, fluorescence levels and patterns of previous movement<sup><xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R20">20</xref>–<xref ref-type="bibr" rid="R22">22</xref></sup>. However, incorporating these additional feature measurements introduces a new problem, namely how to efficiently combine the information from different features to optimise tracking performance. In some software packages (e.g. MicrobeJ<sup><xref ref-type="bibr" rid="R3">3</xref></sup>), this requires the user to manually choose a large number of parameters and make qualitative judgements of the trajectories that result from each set of parameters. The combinatorial explosion in the number of possible parameters, the fact that a single parameter set can require many hours to test, and the lack of a rigorous way to compare the tracking results across different parameter sets, means that parameter optimisation in such a tracking algorithm is typically a highly iterative, time-consuming process.</p><p id="P5">A related problem is the fact that properties of bacteria within collectives are highly dynamic, changing at both the individual level and population level over time. For example, fluorophores can accumulate within cells or bleach, while cell movement can speed up or slow down due to the secretion of extracellular factors or changes in gene expression<sup><xref ref-type="bibr" rid="R23">23</xref>,<xref ref-type="bibr" rid="R24">24</xref></sup>. In addition, the overall density of cells often increases over time as a result of cell division. This variability means that an algorithm optimised to track cells at the beginning of an experiment might struggle at later timepoints. Furthermore, experimental issues - such as changes in illumination, focus, or shifts in the field of view caused by thermal drift - can cause an abrupt deterioration of tracking accuracy. Knowing when tracking accuracy has deteriorated to an unacceptable level often lacks a rigorous basis and requires the output of tracking software to be carefully validated by eye, typically infeasible for high-throughput datasets.</p><p id="P6">In this paper, we discuss a new approach that uses unsupervised machine learning to improve the fidelity of tracking. Our system automatically measures the statistical properties of each feature over time and then uses this data to dynamically change the relative weighting of each feature based on the information it can contribute to solving the tracking problem. It also provides users with a metric of the expected accuracy of the resulting cell trajectories, alerting them to sections of datasets that may need to be omitted from subsequent analyses. This tracking algorithm is combined with robust segmentation, feature extraction, lineage analysis and visualisation routines to make up FAST, the Feature-Assisted Segmenter/Tracker. FAST has been released as open-source software which can be run either directly within Matlab or as a stand-alone application, and has already been used in a number of publications to accurately analyse densely-packed bacterial monolayers<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>.</p><p id="P7">In the following sections, we discuss the design approach and general structure of FAST, and then illustrate the utility of our novel cell tracking approach using synthetic datasets. Next, we discuss three case studies that illustrate the versatility of FAST, including: 1) tracking of twitching <italic>P. aeruginosa</italic> cells in a 2D monolayer, 2) lineage analysis of an <italic>E. coli</italic> colony, and 3) automated analysis of the Type 6 Secretion System (T6SS) in a co-culture of <italic>P. aeruginosa</italic> and <italic>V. cholerae</italic>. While these case studies focus on densely packed bacteria, FAST can also be used to analyse other types of biological samples (<italic>e</italic>.<italic>g</italic>. <xref ref-type="supplementary-material" rid="SD1">Fig. S1g-i</xref>).</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>Software overview</title><p id="P8">Initially, we conducted a review of existing cell tracking software packages<sup><xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R8">8</xref></sup> to establish four key design objectives for our software: modularity, rapid user feedbacks, minimisation of user-defined parameters and extensibility (see <xref ref-type="supplementary-material" rid="SD1">section 2</xref> of the Supplementary Information for further details). We built the FAST pipeline following these design principles, resulting in a set of six modules that are used in sequence (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). First, the Segmentation module is used to identify the boundaries of individual cells, typically using brightfield or phase-contrast images. Next, the Feature Extraction module measures a range of different cell properties such as position, size and fluorescence intensity (potentially in multiple channels) using the previously extracted segmentation as a basis. The Tracking module employs our machine learning process to quantify the information associated with each feature and then calculates the relative weighting of each feature to maximise tracking fidelity. If required, a manual validation and correction sub-module also allows the user to correct any mistakes made by the tracking algorithm. The optional Division Detection module uses a closely related machine learning process to assign daughter cells to mother cells following cell division events. Two separate modules can finally be used to visualise the output of FAST: the Overlay module plots trajectories and/or the results of analyses over the top of the original images, while the Plotting module contains a range of different options to visualise extracted data.</p><p id="P9">The FAST GUI guides the user through the process of analysing a single dataset. However, many applications require a large number of imaging datasets to be analysed using consistent settings. To automate this, we have implemented a batch-processing tool called doubleFAST. Once a user has performed an analysis on a single dataset using the FAST GUI, doubleFAST can then read the settings used during this initial run and automatically apply them to any number of additional datasets. This allows data from multiple experiments to be processed with minimal amounts of additional user input and ensures each has been analysed using consistent settings.</p><p id="P10">Finally, we have implemented a post-processing toolbox, which contains scripts and functions to perform a number of different tasks on FAST’s output. These allow, among other things, conversion of track data to other file formats, automated detection of different genotypes, and the annotation of events such as reversals in movement direction. Users of FAST can suggest new additions to this toolbox so they can be used by the wider community.</p></sec><sec id="S4"><title>FAST’s tracking algorithm</title><p id="P11">One of FAST’s principal innovations is its new tracking algorithm, which automatically determines how to best combine data from a variety of different cell features to improve tracking fidelity. Although previous tracking software packages have had the option to incorporate cell characteristics other than position in their tracking routines<sup><xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R22">22</xref></sup>, FAST uses a conceptual framework based on information theory that optimises this process, increasing both the power and convenience of this approach. In this section we provide a high-level overview of our main innovations and how they impact the tracking process. For more detailed derivations and explanations, please refer to <xref ref-type="supplementary-material" rid="SD1">section 3.4</xref> of the Supplementary Information.</p><p id="P12">Our approach to the tracking problem is based on measurements of the amount of information that can be used to assign links between objects in subsequent frames, a measurement we call the “trackability”. This trackability score provides an integrated measure of how accurately we can follow objects from frame to frame, and due to its grounding in information theory has certain desirable properties such as the additivity of contributions from statistically independent features<sup><xref ref-type="bibr" rid="R27">27</xref>,<xref ref-type="bibr" rid="R28">28</xref></sup>. Measuring the trackability over time therefore provides users with a tool to predict when tracking will be stable and robust, as well as flagging portions of a dataset that might yield spurious trajectories. We define trackability in the following paragraphs and then illustrate how this metric is used in practice in our first case study.</p><p id="P13">We begin by assuming that <italic>N</italic> different features are measured for each object. An object’s features can be expressed as a vector <inline-formula><mml:math id="M1"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> with <italic>N</italic> elements, where the object index is denoted as <italic>I</italic> and time is denoted as <italic>t</italic>. Changes in an objects’ features over time – corresponding to, for example, translational movement or changes in fluorescence intensity – therefore generate a trajectory through the <italic>N-</italic>dimensional feature space. The goal of our tracking algorithm is to reconstruct each object’s trajectory from the cloud of individual data points resulting from the segmentation and measurement of objects in each image. As previously noted, individuals in high-density and high-motility systems can easily move further than the typical cell-cell separation between frames, making it difficult to reconstruct their trajectories from positional information alone. By including additional features in the tracking framework, we expand the feature space from these two spatial dimensions to <italic>N</italic> feature dimensions, creating new axes along which one can potentially discriminate neighbouring individuals from each other.</p><p id="P14">The trackability metric provides an estimate of how distinguishable trajectories are from each other in the feature space, and therefore how accurate tracking is likely to be. Unpredictable movement of objects tends to reduce trackability, while trackability increases if the features sample a wider range of values (<italic>i</italic>.<italic>e</italic>. if they have a larger dynamic range). To formalise this, we model an object’s instantaneous position in feature space as the random vector <bold><italic>X</italic></bold><sub><italic>t</italic></sub> and the change in this position between subsequent images as the random vector Δ<bold><italic>X</italic></bold><sub><italic>t</italic></sub>. The distribution <italic>f</italic>(<bold><italic>x</italic></bold>) is then the probability density function (PDF) representing the chance of finding a randomly selected object at a particular position <bold><italic>x</italic></bold> in the absence of additional information (specifically, the position of the object at prior timepoints), while the distribution <italic>f</italic>(Δ<bold><italic>x</italic>)</bold> represents the stochastic change in an object’s position in feature space between sequential timepoints. We estimate <italic>f</italic>(Δ<bold><italic>x</italic>)</bold> by assuming that the motion of an object through feature space can be modelled as a Gaussian random walk. Explicitly, we assume that the feature vector <inline-formula><mml:math id="M2"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> of an object at frame <italic>t</italic>+1 can be written in terms of its prior feature vector <inline-formula><mml:math id="M3"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> as: <disp-formula id="FD1"><label>(1)</label><mml:math id="M4"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mtext>,</mml:mtext></mml:math></disp-formula> where Δ<bold><italic>X</italic></bold><sub><italic>t</italic></sub> is modelled as a multivariate normal <inline-formula><mml:math id="M5"><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, and <italic>µ</italic><sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) and Σ<sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) are respectively the mean vector and covariance matrix of the set of frame-frame feature displacements {Δ<bold><italic>x</italic></bold><sub><italic>t</italic></sub>}. We can similarly characterise <italic>f</italic>(<bold><italic>x</italic></bold>) using the covariance matrix of the raw object locations, Σ<sub><italic>t</italic></sub>(<bold><italic>x</italic></bold>). While we can estimate Σ<sub><italic>t</italic></sub>(<bold><italic>x</italic></bold>) directly from static snapshots as the covariance of the set of feature vectors {<bold><italic>x</italic></bold><sub><italic>t</italic></sub>}, resolving {Δ<bold><italic>x</italic></bold><sub><italic>t</italic></sub>} and subsequently <italic>µ</italic><sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) and Σ<sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) requires a putative set of cell trajectories, which in our algorithm are obtained via a preliminary round of tracking that uses a simple nearest-neighbour approach. These statistics are robust to small numbers of tracking errors, allowing us to train our model using this relatively low-fidelity tracking approach.</p><p id="P15">From these measurements, we estimate the amount of information available for assigning objects between frames by calculating the difference between the entropies for the two distributions, H(<bold><italic>X</italic></bold>) and H(Δ<bold><italic>X</italic></bold>) <sup><xref ref-type="bibr" rid="R28">28</xref>,<xref ref-type="bibr" rid="R29">29</xref></sup>. The trackability <italic>r</italic><sub><italic>t</italic></sub> in bits object<sup>-1</sup> is then given as: <disp-formula id="FD2"><label>(2)</label><mml:math id="M6"><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>6</mml:mn><mml:mrow><mml:mi>π</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>n</italic><sub><italic>o,t</italic></sub> is the total number of objects present at time <italic>t</italic> and |·| denotes the determinant of the contents.</p><p id="P16">To illustrate the trackability metric, we consider the case of a single object with a single feature, for example its position in space along a single axis, <italic>x</italic> (<xref ref-type="fig" rid="F2">Fig. 2a-c</xref>). This simplifies <xref ref-type="disp-formula" rid="FD2">Eq. (2)</xref> to: <disp-formula id="FD3"><label>(3)</label><mml:math id="M7"><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>6</mml:mn><mml:mrow><mml:mi>π</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>σ</italic><sub><italic>t</italic></sub>(<italic>x</italic>) and <italic>σ</italic><sub><italic>t</italic></sub>(Δ<italic>x</italic>) denote the standard deviation of their respective distributions. As expected, one observes a larger trackability score when the distribution of feature displacements, <italic>f</italic>(Δ<italic>x</italic>), is more sharply peaked relative to the distribution of <italic>f</italic>(<italic>x</italic>) (<xref ref-type="fig" rid="F2">Fig. 2b,c</xref>). <italic>i</italic>.<italic>e</italic>. when the typical distance an object moves between frames is small compared to the range of values of <italic>x</italic>. If the trackability score is sufficiently large, the risk that two objects move close to one another and become difficult to distinguish is small. Intuitively, the precision of tracking will increase as (<italic>i</italic>) the size of the random fluctuations in feature space decreases, (<italic>ii</italic>) the number of objects within a frame decreases, and (<italic>iii</italic>) the total size of the feature space the objects occupy (<italic>i</italic>.<italic>e</italic>. their dynamic ranges) increases. By taking these multiple factors into account, <italic>r</italic><sub><italic>t</italic></sub> represents an integrated measurement of the risk that a given object will be incorrectly linked to a different object in a subsequent frame.</p><p id="P17">In addition to calculating the trackability, <bold><italic>µ</italic></bold><sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) and Σ<sub><italic>t</italic></sub>(Δ<bold><italic>x</italic></bold>) are also used to perform what we call “feature normalization<bold>”</bold>. This transformation converts the raw feature space <bold><italic>x</italic></bold> to a normalized feature space <inline-formula><mml:math id="M8"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> with a corresponding displacement distribution <inline-formula><mml:math id="M9"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> that is isotropic and zero-centred (<xref ref-type="fig" rid="F2">Fig. 2d</xref>), thus ensuring that the stochastic variation observed within each component of <inline-formula><mml:math id="M10"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is equal and that any predictable motion in the feature space (e.g. a gradual increase in cell length due to growth, or a reduction in fluorescent intensity due to photobleaching) is accounted for. The metric of this transformed space is the Mahalanobis distance, a dimensionless measure of how reliably we can predict where an object will appear in the feature space at the next time point under the assumptions of our statistical framework. By providing an equitable way to combine data from different features together, this metric allows us to more accurately distinguish correct from incorrect putative links. Large distances between sequential timepoints in this space indicate a discrepancy between the predicted and observed location of an object in the next frame, and so suggest that the input data must be erroneous - for example, because an object was mis-segmented a single frame. In contrast to previous approaches where feature weightings have to be selected or measured manually<sup><xref ref-type="bibr" rid="R20">20</xref></sup>, feature normalization allows one to automatically optimise the contribution of multiple features without any additional user input.</p><p id="P18">Finally, we use these statistical measurements to also calculate the adaptive tracking threshold, which automatically adjusts the stringency of the algorithm that links objects together based on how much information is available in each frame. While a larger fraction of putative links are accepted when information is relatively plentiful, only the highest certainty links are accepted when information is more limited. This dynamic adjustment of the link threshold thus allows FAST to maximise the number trajectories in less challenging tracking conditions (<italic>e</italic>.<italic>g</italic>. slow-moving cells at low density) while minimizing the number of spurious links in more challenging conditions (<italic>e</italic>.<italic>g</italic>. fast-moving cells at high density).</p></sec><sec id="S5"><title>Validating the methodology of FAST using ground-truthed datasets</title><p id="P19">To demonstrate the functionality of our tracking algorithm and to illustrate how using multiple features can enhance accuracy, we used a previously described self-propelled rod (SPR) model <sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup> to generate synthetic data sets that simulate bacteria collectively moving at high-density (<xref ref-type="fig" rid="F3">Fig. 3a</xref>). In these simulations, cells are modelled as stiff, mutually repulsive rods that are propelled by a constant force (Methods). This model has been shown to closely approximate bacterial collectives that propel themselves using either flagella or type IV pili, where steric interactions between neighbouring cells generate complex emergent collective behaviours<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. Importantly, this approach allows us to independently control each of the different properties of the system, allowing us to test FAST on a large number of qualitatively different datasets and to compare the results with a known ground truth.</p><p id="P20">We simulated a 2D monolayer of cells constitutively expressing a fluorescent protein by initialising populations of cells whose length and fluorescence intensity were drawn from distributions obtained from experimental data (<xref ref-type="fig" rid="F7">Extended Data Fig. 1</xref>). Following initialization, we simulated cell movement by numerically integrating the equations of motion for each rod. Once the system had reached steady-state, we extracted measurements of rod position, orientation, fluorescence and length at evenly spaced timepoints. To simulate noisy measurements, we added Gaussian noise to each of these features, with the noise magnitude based on that observed in real experimental data (<xref ref-type="fig" rid="F3">Fig. 3b</xref>, <xref ref-type="sec" rid="S11">Methods</xref>).</p><p id="P21">Rather than specialising on datasets with specific properties, FAST’s tracking algorithm is designed to be robust to a wide diversity of different conditions by automatically compensating via feature normalization. To test this capability, we varied the parameters of our simulation by adjusting the rod density, self-propulsion force and framerate, as well as the accuracy of feature measurement by adjusting the amount of noise in the measured cell position, length and fluorescence intensity. We tested five different values for each of these six parameters, yielding a total of 30 datasets in total.</p><p id="P22">The performance of the tracking algorithm was assessed by comparing its output to the ground truth (<xref ref-type="fig" rid="F3">Fig. 3c,d</xref>). Links that were present in the ground truth but missing in the reconstructions were scored as false negatives (FN), while those that were absent in the ground truth but present in the reconstructions were scored as false positives (FP). Links that were identical in both were scored as true positives (TP). We now integrated these measurements into a single metric that quantifies tracking performance, the <italic>F</italic><sub>1</sub>-score, defined as: <disp-formula id="FD4"><label>(4)</label><mml:math id="M11"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula> Users of FAST specify a tracking threshold that controls the stringency of the linking process. If this threshold is too stringent, too many correct links will rejected by the algorithm, while if the threshold is not stringent enough too many incorrect links will be accepted. In practice, users need the ability to choose the tracking threshold that best suits their needs - for example, users interested in detecting very rare events will have different requirements than those interested in measuring average cell behaviour. However, for the purpose of testing the benefits of our automated tracking algorithm, we removed the tracking threshold as a factor from our analyses by using the threshold that resulted in the largest the <italic>F</italic><sub>1</sub>-score for each dataset (<xref ref-type="fig" rid="F3">Fig. 3e</xref>). This greatest <italic>F</italic><sub>1</sub>-score is an objective measure of the performance of our tracking algorithm across datasets with different characteristics, and also allows us to robustly benchmark our tracking algorithm.</p><p id="P23">The simulated datasets were tracked using two different methods (<xref ref-type="fig" rid="F3">Fig. 3b</xref>). The first method only used the position of the rods – effectively a classical position-based tracking approach (‘Centroids’), while the second method used all four features – position, orientation, length and fluorescence intensity (‘All features’). We found that including all features led to a dramatic increase in tracking accuracy in all datasets, with a 4 to 10-fold reduction in the number of tracking errors (<xref ref-type="fig" rid="F8">Extended Data Fig. 2</xref>). Furthermore, our groundtruthed datasets allow us to directly relate a data set’s trackability to the accuracy of the resulting tracks, showing that it is an excellent predictor of the <italic>F</italic><sub>1</sub>-score regardless of the simulation parameters or level of noise in the dataset (<xref ref-type="fig" rid="F3">Fig. 3f</xref>).</p><p id="P24">Taken together, these analyses validate our methodology and illustrate how FAST copes with challenging data sets. First, they demonstrate that our method of integrating additional feature information during tracking is reliable and effective, allowing FAST to substantially reduce tracking errors compared to alternative approaches that use cell position alone. Second, these analyses demonstrate that our trackability score is able to integrate multiple aspects of the dataset into a single, robust heuristic of predicted tracking accuracy. Finally, we note the tracking algorithm used by FAST is fully automated and requires the user to choose only a single parameter (the tracking threshold) no matter the number of different features that are used in the tracking algorithm.</p></sec><sec id="S6"><title>Case studies</title></sec><sec id="S7"><title>Quantifying rapid bursts of cell movement in densely packed <italic>P. aeruginosa</italic> monolayers</title><p id="P25">Many different species of bacteria generate collective motility in densely-packed communities using either flagella, Type IV pili, or via gliding<sup><xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R19">19</xref>,<xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R31">31</xref></sup>. Motility allows populations to rapidly expand into new territory, giving them a competitive advantage over non-motile genotypes<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R32">32</xref></sup>. Here we demonstrate how FAST can be used to quantify the behaviour of <italic>P. aeruginosa</italic> cells in interstitial colonies that form between agar and glass<sup><xref ref-type="bibr" rid="R31">31</xref></sup>. We focus on cells within the monolayer that forms directly behind the colony’s leading edge, the dynamics of which play a crucial role in the competition between genotypes in both interstitial and more classical “surficial” colonies<sup><xref ref-type="bibr" rid="R9">9</xref></sup>.</p><p id="P26">Tracking cells undergoing collective movement requires a much larger acquisition frame rate compared to non-motile cells. While expensive timing boards can be used to “trigger” cameras with a high level of precision to keep the time between frames nearly constant, most high-end research microscopes lack this capability. Instead, “camera streaming” is more widely available, which directly streams the camera’s output to a computer which saves frames as fast as possible. This maximises the frame rate, but images acquired via camera streaming can have slight variations in the time that elapses between subsequent frames.</p><p id="P27">To illustrate how FAST can be used to handle a sequence of images collected via camera streaming, we collected a large dataset with 3,505 frames recorded at an average rate of 127 frames per second. The size is of this dataset is approximately 8 Gb and each frame contains approximately 1,700 tightly packed <italic>P. aeruginosa</italic> cells. Despite the large size of this dataset, processing with FAST could be completed on a standard laptop computer (<xref ref-type="sec" rid="S11">Methods</xref>), requiring only 200 mins to segment and 355 mins to extract the features of each of the ˜6 million individual objects.</p><p id="P28">Tracking consists of two separate stages: the model training stage, and the link assignment stage. After completion of the model training stage, FAST automatically generates and plots the trackability of the dataset at each timepoint (<xref ref-type="fig" rid="F4">Fig. 4a</xref>). For our dataset, this plot revealed that the trackability dropped precipitously at some timepoints. We hypothesised that these decreases resulted from a reduction in the imaging framerate. To test this, we plotted the trackability score against Δ<italic>t</italic>, the elapsed time between frames as calculated from timestamps (<xref ref-type="fig" rid="F4">Fig. 4a</xref>, inset). This revealed a strong negative correlation (Pearson’s correlation coefficient = -0.705), suggesting that the longer the time between frames, the lower the trackability and the less accurate the tracking results. To avoid these timepoints - and the spurious tracking results they might generate - we used the tracking module’s built-in time window selection tool to specify a subset of frames to track (<xref ref-type="fig" rid="F4">Fig. 4a</xref>, green region, 750 frames). Training the tracking model for this reduced dataset took 18 minutes, while tracking and track processing took an additional 88 minutes.</p><p id="P29">In this example, a relatively large timestep Δ<italic>t</italic> allows cells to move further between frames, which reduces predictability and therefore reduces the trackability score. More generally, however, the trackability depends on a combination of experimental and imaging conditions, providing a robust metric to interpret datasets. For example, the trackability score can be used to quickly identify a wide range of problems which might arise during an experiment, including fluctuations in focus, illumination intensity, or inadvertent movement of the sample. Once problematic timepoints have been identified, the user can decide either to avoid them by using a subset of the images (as in this example) or to reject the entire dataset.</p><p id="P30">Tracking the smaller subset of images that we specified resulted in over 1,600 separate trajectories, each at least 200 timepoints long. To visualise this large dataset, we used the Overlays module to colour individual cells in the phase-contrast image based on their instantaneous speed (<xref ref-type="fig" rid="F4">Fig. 4b</xref>). This revealed that while most cells move at relatively slow speeds, a small number of cells undergo rapid, sporadic bursts of movement approximately 25 times faster than the average. These rapid movements are also clearly visible in measurements of the speed of individual cells over time (<xref ref-type="fig" rid="F4">Fig. 4c</xref>). Our results are similar to the ‘slingshots’ previously observed in solitary <italic>P. aeruginosa</italic> cells moving at the glass/liquid interface, apparently driven by pilus detachment events<sup><xref ref-type="bibr" rid="R33">33</xref></sup>. However, the peak speeds that we record (up to 60 µm s<sup>-1</sup>) in collectives of <italic>P. aeruginosa</italic> are approximately 20 times larger than those previously observed. While we do not know the specific reason for this difference, interactions with neighbouring cells facilitated by the high cell density, the glass/agar interstitial colony environment and our higher framerate (˜13 times that of <sup><xref ref-type="bibr" rid="R33">33</xref></sup>) may each play a role.</p><p id="P31">To illustrate how this large tracking dataset can be mined to elucidate the statistics of rare events, we constructed the instantaneous marginal velocity distribution from our tracks (<italic>i</italic>.<italic>e</italic>. the x- and y-components of the instantaneous velocity vectors) (<xref ref-type="fig" rid="F4">Fig. 4d</xref>). While previous studies have found that sperm and swimming bacterial cells undergoing collective movement generate marginal velocity distributions that are approximately Gaussian<sup><xref ref-type="bibr" rid="R30">30</xref>,<xref ref-type="bibr" rid="R34">34</xref></sup>, we observed that bacteria collectively moving via pili-based motility exhibit much heavier tails corresponding to their occasional rapid motions. Despite the rarity of these events – less than 0.05% of our measurements had a magnitude larger than 20 µm s<sup>-1</sup> - the exceptional number of cell trajectories we obtained nevertheless allowed us to finely resolve their statistical distribution. These analyses demonstrate how FAST can be used to rapidly characterise the motility of a large number of cells in densely-packed conditions, with relatively little user input and computational effort.</p></sec><sec id="S8"><title>Lineage analysis of <italic>Escherichia coli</italic>
</title><p id="P32">A major aim of a number previous software packages has been to automatically reconstruct cell lineages<sup><xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R8">8</xref></sup>. However, identifying cell division events and the resulting daughter cells is a particularly difficult challenge. Near-perfect tracking of individuals is essential for accurate lineage tracking, as a single error can propagate through multiple division events, often contaminating the remainder of the dataset. We decided to test FAST’s lineage tracking capabilities using a time lapse movie of dividing <italic>E. coli</italic> cells<sup><xref ref-type="bibr" rid="R17">17</xref></sup> imaged using phase-contrast microscopy. Although the tracking algorithm performed well, several links were incorrectly assigned – this was particularly problematic at the beginning of the dataset, because the small number of cells provided insufficient data to adequately train the machine learning model. We therefore performed manual correction of the dataset using FAST’s built-in track validation and correction system, which required us to break 21 incorrect links and form 17 new links. These manual corrections constituted only 0.67% of the 5,698 links in the final dataset, with the remainder of links being correctly assigned automatically.</p><p id="P33">Following automated division detection, we visualised the lineage structure of the colony using the Overlays module (<xref ref-type="fig" rid="F5">Fig. 5a, b</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Video 1</xref>), allowing us to rapidly verify the accuracy of the lineage assignment. Visualisation of the population structure revealed that the descendants of each of the individual cells present at the beginning of the experiment formed highly elongated structures within the colony, similar to the patterns previously observed in experiments where colonies were initiated from multiple founder cells labelled with different fluorescent proteins<sup><xref ref-type="bibr" rid="R14">14</xref></sup>. We also used the feature extraction and plotting modules to reconstruct the length of individual cells and align them by the time that they last underwent division (<xref ref-type="fig" rid="F5">Fig. 5c</xref>). These analyses illustrate the power and accuracy of our tracking and lineage reconstruction approaches, and also showcase the ease with which FAST allows data-rich visualisations of the resulting datasets.</p></sec><sec id="S9"><title>Automated analysis of T6SS battles</title><p id="P34">To illustrate FAST’s capabilities beyond standard cell tracking, we analysed the activity of the Type 6 Secretion System (T6SS) using FAST. The T6SS is a highly dynamic organelle composed of a molecular ‘spear’ tipped with a toxin known as an effector<sup><xref ref-type="bibr" rid="R35">35</xref></sup>. Bacteria that possess the T6SS can inject this effector into neighbouring cells, which kills them<sup><xref ref-type="bibr" rid="R36">36</xref></sup>. Firing events can be monitored by visualising the localisation of the protein that forms the contractile sheath of the T6SS needle, TssB in <italic>P. aeruginosa</italic> and VipA in <italic>Vibrio cholerae</italic><sup><xref ref-type="bibr" rid="R37">37</xref>,<xref ref-type="bibr" rid="R38">38</xref></sup>. Here, we highlight how FAST can be used to quantify how the T6SS is regulated in co-cultures of <italic>V. cholerae</italic> and <italic>P. aeruginosa</italic>.</p><p id="P35">Because of its short range, the T6SS is effective only at high cell density, which historically has made it difficult to study using automated analyses. We used FAST to analyse imaging datasets that show two different bacterial species interacting with their respective T6SS when mixed together in a densely packed monolayer<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, specifically <italic>V. cholerae</italic> and <italic>P. aeruginosa</italic> cells expressing VipA-mCherry and TssB-mNeongreen, respectively (<xref ref-type="fig" rid="F6">Fig. 6a</xref>, left). We distinguished the two species from one another (<xref ref-type="fig" rid="F6">Fig. 6a</xref>, right) using FAST’s post-processing toolbox, which compares each cell’s intensity in the mCherry and mNeonGreen channels to automatically assign them to two distinct populations (<xref ref-type="fig" rid="F6">Fig. 6b</xref>). This utility allows one to rapidly compare the behaviour of different genotypes within the same sample.</p><p id="P36">The architecture of FAST allows users to easily define and quantify novel features that are not already included in FAST. To do this, users can write a short feature measurement script that can make use of the segmentation of each object in each frame, as well as the corresponding regions in each of the imaging channels - in this case, the mNeongreen, mCherry and phase-contrast signals. The Feature Extraction module then automatically stores these custom features in the same way as the built-in features, allowing them to be integrated into downstream analyses. To illustrate this capability, we extracted cell curvature as a custom feature to see if we could detect the differences in morphology of <italic>V. cholerae</italic> cells (which are generally comma-shaped) from that of <italic>P. aeruginosa</italic> (which are generally rod-shaped). Using a skeletonization-based approach, we extracted the morphological backbone of each cell from its segmentation and measured its curvature by finding the best-fit circle to this set of points. Consistent with expectations, our automated analysis found that the cells identified as <italic>V. cholerae</italic> were substantially more curved than those identified as <italic>P. aeruginosa</italic> (<xref ref-type="fig" rid="F6">Fig. 6c</xref>).</p><p id="P37">Our software is also capable of generating sophisticated visualisations and analyses of the behaviour of single cells. For example, FAST allows the dynamics of T6SS firing in individual cells to be easily visualised using the kymograph option of the Plotting module (<xref ref-type="fig" rid="F6">Fig. 6d</xref>), as well as the ‘cartouche’ option, which extracts and aligns cropped images of the specified cells (<xref ref-type="fig" rid="F6">Fig. 6f</xref>). We can also quantify the dynamics of the T6SS using the feature data associated with a given cell: the standard deviation of the mNeongreen channel substantially increases during firing (<xref ref-type="fig" rid="F6">Fig. 6e</xref>), as the TssB becomes non-uniformly distributed through the cell as it assembles into the sheath.</p><p id="P38">It is generally accepted that <italic>P. aeruginosa</italic> only fires its T6SS when triggered by the firing of the T6SS of a neighbouring cell<sup><xref ref-type="bibr" rid="R15">15</xref>,<xref ref-type="bibr" rid="R37">37</xref></sup>. Although qualitative evidence for this is strong, to our knowledge this effect has never been directly quantified, likely because of the difficulties involved with tracking densely packed cells and because the T6SS firing events are themselves relatively rare. We therefore decided to use FAST to simultaneously track a large number of densely packed cells and automatically detect when each fires its T6SS. We used our batch-processing tool – doubleFAST – to automate the analysis of multiple datasets from experiments in which WT <italic>P. aeruginosa</italic> cells were either cocultured with WT <italic>V. cholerae</italic> or cocultured with a mutant <italic>V. cholerae</italic> strain that is incapable of firing their T6SS (Δ<italic>hcp1</italic> Δ<italic>hcp2</italic>). Using the standard deviation of the mNeongreen channel to distinguish when <italic>P. aeruginosa</italic> is actively firing its T6SS, we calculated the proportion of time that <italic>P. aeruginosa</italic> cells spend firing their T6SS (<xref ref-type="fig" rid="F6">Fig. 6g</xref>). As expected, when co-cultured with the inactivated Δ<italic>hcp1</italic> Δ<italic>hcp2 V. cholerae</italic> strain, we measured that <italic>P. aeruginosa</italic> reduced the proportion of time it spent in the firing state approximately 30-fold compared to when co-cultured with WT <italic>V. cholerae</italic>. In total, these analyses were based on 1,246 tracks built from 139,849 individually segmented objects, illustrating how our automated processes can leverage quantities of data not amenable to manual approaches. In conclusion, this case study demonstrates how FAST can automatically distinguish different species, how users can specify novel features like cell curvature, and how complex bacterial behaviours can be quantified using feature data.</p></sec></sec><sec id="S10" sec-type="discussion"><title>Discussion</title><p id="P39">Advances in experimental techniques and automated microscopy have transformed live cell imaging from a technique that relies largely on qualitative observation into a highly quantitative discipline that leverages huge amounts of data. Integral to this renaissance are computational tools that can automatically parse and annotate the large imaging datasets resulting from these experiments. Many tools have been developed for this purpose<sup><xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R39">39</xref>–<xref ref-type="bibr" rid="R44">44</xref></sup>, each optimised for a specific research question. As we have emphasized throughout this manuscript, our own contribution is particularly well-suited for the analysis of experiments where cells are tightly packed together.</p><p id="P40">We designed FAST to allow users to rapidly obtain high-quality results by minimising both the number of user-defined tracking parameters and the computational time required to process an imaging dataset containing many cells. FAST automatically determines how to combine data from different cell features, which prevents users from having to iteratively improve tracking results by sequentially adjusting a large number of parameters – typically a very slow and laborious process. Our approach also provides the user with a single, easy to interpret metric that allows them to rapidly identify and avoid sections of the dataset that are predicted to yield low-fidelity trajectories. While the basic FAST package already outputs most of the cell features that are widely used by researchers, simple modifications to the system allow users to integrate new features into the existing analytical framework.</p><p id="P41">Tracking systems typically break down in one of two ways – either individual objects cannot be distinguished, or the tracking algorithm cannot accurately link individuals between frames. Machine learning is increasingly used to solve the first of these two challenges, and techniques that apply machine learning methods to segment microbes at high density are now widely available<sup><xref ref-type="bibr" rid="R41">41</xref>–<xref ref-type="bibr" rid="R43">43</xref>,<xref ref-type="bibr" rid="R45">45</xref></sup>. However, use of machine learning to perform tracking is comparatively rare. FAST fills this niche using a statistical framework that both substantially improves track quality and provides users with insight into possible problems with their data. Our software has already proven its ability to elucidate the rich and complex behaviours that individual bacteria exhibit in densely-packed conditions<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R16">16</xref>,<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R26">26</xref></sup>. Future work stemming from these combined experimental and analytical approaches could ultimately shed new light on how dense bacterial communities function and help us to develop novel strategies to manipulate them.</p></sec><sec id="S11" sec-type="materials | methods"><title>Materials and methods</title><sec id="S12"><title>Computational resources</title><p id="P42">All analyses presented in this manuscript were performed with a Microsoft Surface Book 2, with an 8-core Intel i7-8650U CPU and 8 Gb of RAM. FAST was run directly in Matlab, version 2018b.</p></sec><sec id="S13"><title>SPR model</title><p id="P43">The 2D SPR model used in this manuscript has been described in detail elsewhere<sup><xref ref-type="bibr" rid="R9">9</xref>,<xref ref-type="bibr" rid="R30">30</xref></sup>. In brief, we model cells as stiff rods composed of evenly-spaced Yukawa segments, mutually repulsive point potentials. We initialise the system by filling a square domain with <italic>N</italic><sub><italic>r</italic></sub> rods, evenly spaced on a lattice. Each rod <italic>i</italic> is associated with an aspect ratio <italic>a</italic><sup><italic>i</italic></sup> and a fluorescence intensity <italic>I</italic><sup><italic>i</italic></sup>, randomly drawn from distributions fitted to the <italic>P. aeruginosa</italic> data from the T6SS visualisation experiment<sup><xref ref-type="bibr" rid="R15">15</xref></sup> as shown in <xref ref-type="fig" rid="F7">Extended Data Fig. 1</xref>. The packing fraction of the system, <italic>ρ</italic>, is calculated as <disp-formula id="FD5"><mml:math id="M12"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>A</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:math></disp-formula> where <italic>A</italic> is the area of the simulated domain, which has doubly periodic boundary conditions.</p><p id="P44">Taking the instantaneous position of a rod <italic>i</italic> as <bold><italic>r</italic></bold><sup><italic>i</italic></sup>, its orientation as <italic>ϕ</italic><sup><italic>i</italic></sup>, the unit vector denoting this orientation as <inline-formula><mml:math id="M13"><mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msup></mml:math></inline-formula> and the sum of the potentials between <italic>i</italic> and all other rods as <italic>U</italic><sup><italic>i</italic></sup>, we define the equations of motion for each rod as: <disp-formula id="FD6"><label>(5a)</label><mml:math id="M14"><mml:msub><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="FD7"><label>(5b)</label><mml:math id="M15"><mml:msub><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula> where <bold><italic>f</italic></bold><sub><italic>T</italic></sub> is the translational friction tensor, <italic>f</italic><sub><italic>θ</italic></sub> is the rotational friction constant and <italic>F</italic> is the size of a self-propulsion force exerted by each rod along its axis. We use the formulation presented in<sup><xref ref-type="bibr" rid="R30">30</xref></sup> to calculate <bold><italic>f</italic></bold><sub><italic>T</italic></sub> and <italic>f</italic><sub><italic>ϕ</italic></sub>, which are in turn functions of the rod aspect ratio and the Stokesian friction coefficient, <italic>f</italic><sub><italic>0</italic></sub>. We simulate the dynamics of our system by numerically integrating <xref ref-type="disp-formula" rid="FD6">Eq. 5a</xref> and <xref ref-type="disp-formula" rid="FD7">5b</xref> using the midpoint method.</p><p id="P45">Following an initial transient, the system reaches a statistical steady-state. At this time, we begin to measure the positions, orientations, lengths and intensities of each rod at a sampling “framerate” Δ<italic>T</italic>. We add simulated measurement noise to each of these measurements, which is drawn from a Gaussian distribution with a mean of zero. The standard deviation of the measurement noise for each feature is controlled by the parameters <italic>σ</italic><sub><italic>r</italic></sub> (positional noise), <italic>σ</italic><sub><italic>ϕ</italic></sub> (orientational noise), <italic>σ</italic><sub><italic>a</italic></sub> (length noise) and <italic>σ</italic><sub><italic>I</italic></sub> (fluorescence noise). To constrain the baseline estimates of these noise parameters, we measured how each of the corresponding features fluctuated about the mean in <italic>P. aeruginosa</italic> cells in a dataset of T6SS firing<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. The cells in this dataset are non-motile and the framerate is high enough that growth is negligible, meaning any apparent changes in position, orientation, length or fluorescence are wholly attributable to measurement noise.</p><p id="P46">We varied the properties of our simulations by adjusting the values of the parameters <italic>N, F</italic>, Δ<italic>T, σ</italic><sub><italic>r</italic></sub>, <italic>σ</italic><sub><italic>a</italic></sub> and <italic>σ</italic><sub><italic>I</italic></sub> in different simulation runs. The values of these parameters, as well as the fixed system parameters, are provided in <xref rid="T1" ref-type="table">table 1</xref>.</p></sec><sec id="S14"><title>Sample preparation</title><p id="P47">The monolayer of <italic>P. aeruginosa</italic> presented in <xref ref-type="fig" rid="F4">Fig. 4</xref> was prepared using the wild-type PAO1 strain<sup><xref ref-type="bibr" rid="R46">46</xref></sup>. Cells were streaked out from freezer stocks onto LB agar plates (Lennox, 20 g/l, Fisher Scientific, solidified with 1.5% (w/v) agar, Difco brand, BD) and incubated overnight at 37°C. Single colonies were picked from the resulting plates and incubated overnight in liquid culture under continuous shaking, resulting in stationary phase cultures. These were then diluted 30-fold and returned to the shaking incubator for a further two hours, yielding cultures in exponential phase. The final culture used for inoculation was prepared by adjusting the optical density at 600 nm (OD<sub>600</sub>) of the exponential phase cultures to 0.05 using fresh LB, corresponding to an approximate concentration of 12,500 cells μl<sup>-1</sup></p><p id="P48">We prepared monolayers from these cultures using a similar protocol to that described in<sup><xref ref-type="bibr" rid="R31">31</xref></sup>. 1 μl of inoculation culture was spotted onto the centre of a small (2 cm x 2 cm) LB agar pad. To provide optimal conditions for observing twitching motility, the concentration of agar in these pads was 0.8%. This pad was then inverted and placed into the base of a coverslip-bottomed Petri dish (175 µm coverslip thickness, MatTek), which was then closed and incubated for 16 hr at room temperature. The ability to close the lid of the Petri dish allowed us to avoid desiccation of the sample during incubation. By the end of the incubation period, a large interstitial colony with a dense monolayer at its perimeter had formed<sup><xref ref-type="bibr" rid="R9">9</xref></sup>.</p></sec><sec id="S15"><title>Microscopy</title><p id="P49">The high framerate movie used for the analysis of rapid motion (<xref ref-type="fig" rid="F4">Fig. 4</xref>) was acquired using a Zeiss Axio Observer.Z1 microscope outfitted with an Axiocam 702 camera set to “camera streaming” mode and a Plan Apochromat 63x oil-immersion objective.</p></sec><sec id="S16"><title>Other datasets</title><p id="P50">The datasets showing dividing <italic>E. coli</italic> cells (<xref ref-type="fig" rid="F5">Fig. 5</xref>) and T6SS firing (<xref ref-type="fig" rid="F6">Fig. 6</xref>) were downloaded from the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref> sections of<sup><xref ref-type="bibr" rid="R17">17</xref></sup> and<sup><xref ref-type="bibr" rid="R37">37</xref></sup>, respectively, under a Creative Commons Attribution license. FIJI’s<sup><xref ref-type="bibr" rid="R47">47</xref></sup> built-in AVI reader was used to extract individual frames of both movies. The <italic>E. coli</italic> movie was then stabilised using a combination of manual stabilisation (for large shifts in the field of view between timepoints) and the TurboReg plugin<sup><xref ref-type="bibr" rid="R48">48</xref></sup>.</p></sec></sec><sec id="S17" sec-type="extended-data"><title>Extended Data</title><fig id="F7" position="anchor"><label>Extended Data Fig. 1</label><caption><title>Distributions used to specify initial conditions of the SPR model</title><p id="P51">The distributions of trajectory-averaged aspect ratios (a) and GFP intensities (b) of a dataset of non-motile P. aeruginosa cells<sup><xref ref-type="bibr" rid="R15">15</xref></sup>. A gamma distribution (shape parameter = 15.3, scale parameter = 0.248) and a normal distribution (mean = 63.1, standard deviation = 8.83), respectively, were fitted to these two datasets (black dotted lines). To initialise the SPR model, rod aspect ratio, a<sub>α</sub>, and simulated fluorescence intensity, I<sub>α</sub>, were randomly drawn from these two fitted distributions, allowing us to ensure that these two features were modelled realistically in our simulations.</p></caption><graphic xlink:href="EMS157438-f007"/></fig><fig id="F8" position="anchor"><label>Extended Data Fig. 2</label><caption><title>Including additional feature information improves trackability and increases tracking fidelity</title><p id="P52">We measured the trackability (a, b) and maximum F<sub>1</sub>-scores (c, d) of synthetic high-density motility data generated using a range of different parameter combinations. Both ‘simulation parameters’ (parameters that change the properties of the SPR model we used to generate the synthetic dataset, a, c) and ‘measurement parameters’ (parameters that change the amount of measurement noise for each of the different features, b, d) were varied. See <xref rid="T1" ref-type="table">Table 1</xref> for further details. Here we compare trackability and tracking fidelity when the tracking algorithm can only use positional information (‘Centroids’, brown) to when all feature information is available (‘All features’, purple). Arrows show the consistent increase in these two metrics when all features from the synthetic dataset are used, illustrating the robustness of our approach.</p></caption><graphic xlink:href="EMS157438-f008"/></fig></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary information</label><media xlink:href="EMS157438-supplement-Supplementary_information.pdf" mimetype="application" mime-subtype="pdf" id="d39aAdFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S18"><title>Acknowledgements</title><p>We would like to thank the numerous people who have tested and provided feedback on FAST during its development, including N.A. Costin, S.C. Booth, J.H. Wheeler, E.T. Granato, R.K. Kumar, W.P.J. Smith, C.J. Walther and H. Todorov. O.J.M. was supported by an EPSRC studentship through the Life Sciences Interface Centre for Doctoral Training (EP/F500394/1) and a long-term postdoctoral fellowship provided by the HFSP (LT0020/2022-L), while W.M.D was supported by a startup grant from the University of Sheffield’s Imagine: Imaging Life initiative, an EPSRC Pump Priming Award (EP/M027430/1), a BBSRC New Investigator Grant (BB/R018383/1), and the Human Frontier Science Program (RGY0080/2021).</p></ack><sec id="S20" sec-type="data-availability"><title>Data availability statement</title><p id="P53">Data for the case studies, including raw data files, track data and data processing settings and scripts, are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.21756212">https://doi.org/10.6084/m9.figshare.21756212</ext-link> (<xref ref-type="fig" rid="F4">Fig. 4</xref>), <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.21756269">https://doi.org/10.6084/m9.figshare.21756269</ext-link> (<xref ref-type="fig" rid="F5">Fig. 5</xref>) and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.21756329">https://doi.org/10.6084/m9.figshare.21756329</ext-link> (<xref ref-type="fig" rid="F6">Fig. 6</xref>)</p><sec id="S19" sec-type="data-availability"><title>Code availability statement</title><p id="P54">All source code, including both FAST and the SPR benchmarking system, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Pseudomoaner/FAST">https://github.com/Pseudomoaner/FAST</ext-link>.</p></sec></sec><fn-group><fn id="FN1" fn-type="conflict"><p id="P55">Conflict of interest</p><p id="P56">We report no conflicts of interest.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname><given-names>CD</given-names></name><name><surname>Xavier</surname><given-names>JB</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>The sociobiology of biofilms</article-title><source>FEMS Microbiol Rev</source><year>2009</year><volume>33</volume><fpage>206</fpage><lpage>24</lpage><pub-id pub-id-type="pmid">19067751</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname><given-names>CD</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>Spatial structure, cooperation and competition in biofilms</article-title><source>Nat Rev Microbiol</source><year>2016</year><volume>14</volume><fpage>589</fpage><lpage>600</lpage><pub-id pub-id-type="pmid">27452230</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ducret</surname><given-names>A</given-names></name><name><surname>Quardokus</surname><given-names>EM</given-names></name><name><surname>Brun</surname><given-names>Yv</given-names></name></person-group><article-title>MicrobeJ, a tool for high throughput bacterial cell detection and quantitative analysis</article-title><source>Nat Microbiol</source><year>2016</year><volume>1</volume><fpage>1</fpage><lpage>7</lpage><pub-id pub-id-type="pmcid">PMC5010025</pub-id><pub-id pub-id-type="pmid">27572972</pub-id><pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.77</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paintdakhi</surname><given-names>A</given-names></name><etal/></person-group><article-title>Oufti: an integrated software package for high-accuracy, high-throughput quantitative microscopy analysis</article-title><source>Mol Microbiol</source><year>2016</year><volume>99</volume><fpage>767</fpage><lpage>777</lpage><pub-id pub-id-type="pmcid">PMC4752901</pub-id><pub-id pub-id-type="pmid">26538279</pub-id><pub-id pub-id-type="doi">10.1111/mmi.13264</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stylianidou</surname><given-names>S</given-names></name><name><surname>Brennan</surname><given-names>C</given-names></name><name><surname>Nissen</surname><given-names>SB</given-names></name><name><surname>Kuwada</surname><given-names>NJ</given-names></name><name><surname>Wiggins</surname><given-names>PA</given-names></name></person-group><article-title>SuperSegger: robust image segmentation, analysis and lineage tracking of bacterial cells</article-title><source>Mol Microbiol</source><year>2016</year><volume>102</volume><fpage>690</fpage><lpage>700</lpage><pub-id pub-id-type="pmid">27569113</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinevez</surname><given-names>J-Y</given-names></name><etal/></person-group><article-title>TrackMate: An open and extensible platform for single-particle tracking</article-title><source>Methods</source><year>2017</year><volume>115</volume><fpage>80</fpage><lpage>90</lpage><pub-id pub-id-type="pmid">27713081</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Niemi</surname><given-names>J</given-names></name><name><surname>Tan</surname><given-names>C-M</given-names></name><name><surname>You</surname><given-names>L</given-names></name><name><surname>West</surname><given-names>M</given-names></name></person-group><article-title>Image segmentation and dynamic lineage analysis in single-cell fluorescence microscopy</article-title><source>Cytometry Part A</source><year>2009</year><volume>77A</volume><fpage>101</fpage><lpage>110</lpage><pub-id pub-id-type="pmcid">PMC2797831</pub-id><pub-id pub-id-type="pmid">19845017</pub-id><pub-id pub-id-type="doi">10.1002/cyto.a.20812</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>J</given-names></name><etal/></person-group><article-title>TLM-tracker: Software for cell segmentation, tracking and lineage analysis in time-lapse microscopy movies</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>2276</fpage><lpage>2277</lpage><pub-id pub-id-type="pmid">22772947</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meacock</surname><given-names>OJ</given-names></name><name><surname>Doostmohammadi</surname><given-names>A</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name><name><surname>Yeomans</surname><given-names>JM</given-names></name><name><surname>Durham</surname><given-names>WM</given-names></name></person-group><article-title>Bacteria solve the problem of crowding by moving slowly</article-title><source>Nat Phys</source><year>2021</year><volume>17</volume><fpage>205</fpage><lpage>210</lpage></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeckel</surname><given-names>H</given-names></name><etal/></person-group><article-title>Learning the space-time phase diagram of bacterial swarm expansion</article-title><source>Proc Natl Acad Sci U S A</source><year>2019</year><volume>116</volume><fpage>1489</fpage><lpage>1494</lpage><pub-id pub-id-type="pmcid">PMC6358709</pub-id><pub-id pub-id-type="pmid">30635422</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1811722116</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granato</surname><given-names>ET</given-names></name><name><surname>Meiller-Legrand</surname><given-names>TA</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>The Evolution and Ecology of Bacterial Warfare</article-title><source>Current Biology</source><year>2019</year><volume>29</volume><fpage>R521</fpage><lpage>R537</lpage><pub-id pub-id-type="pmid">31163166</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>P</given-names></name><name><surname>Schuster</surname><given-names>M</given-names></name></person-group><article-title>Public goods and cheating in microbes</article-title><source>Current Biology</source><year>2019</year><volume>29</volume><fpage>R442</fpage><lpage>R447</lpage><pub-id pub-id-type="pmid">31163154</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madsen</surname><given-names>JS</given-names></name><name><surname>Burmølle</surname><given-names>M</given-names></name><name><surname>Hansen</surname><given-names>LH</given-names></name><name><surname>Sørensen</surname><given-names>SJ</given-names></name></person-group><article-title>The interconnection between biofilm formation and horizontal gene transfer</article-title><source>FEMS Immunol Med Microbiol</source><year>2012</year><volume>65</volume><fpage>183</fpage><lpage>195</lpage><pub-id pub-id-type="pmid">22444301</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudge</surname><given-names>TJ</given-names></name><name><surname>Federici</surname><given-names>F</given-names></name><name><surname>Steiner</surname><given-names>PJ</given-names></name><name><surname>Kan</surname><given-names>A</given-names></name><name><surname>Haseloff</surname><given-names>J</given-names></name></person-group><article-title>Cell polarity-driven instability generates self-organized, fractal patterning of cell layers</article-title><source>ACS Synth Biol</source><year>2013</year><volume>2</volume><fpage>705</fpage><lpage>714</lpage><pub-id pub-id-type="pmid">23688051</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basler</surname><given-names>M</given-names></name><name><surname>Ho</surname><given-names>BT</given-names></name><name><surname>Mekalanos</surname><given-names>JJ</given-names></name></person-group><article-title>Tit-for-Tat: Type VI Secretion System Counterattack during Bacterial Cell-Cell Interactions</article-title><source>Cell</source><year>2013</year><volume>152</volume><fpage>884</fpage><lpage>894</lpage><pub-id pub-id-type="pmcid">PMC3616380</pub-id><pub-id pub-id-type="pmid">23415234</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2013.01.042</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Granato</surname><given-names>ET</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>The Evolution of Mass Cell Suicide in Bacterial Warfare</article-title><source>Current Biology</source><year>2020</year><volume>30</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC7372221</pub-id><pub-id pub-id-type="pmid">32502408</pub-id><pub-id pub-id-type="doi">10.1016/j.cub.2020.05.007</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nghe</surname><given-names>P</given-names></name><etal/></person-group><article-title>Microfabricated Polyacrylamide Devices for the Controlled Culture of Growing Cells and Developing Organisms</article-title><source>PLoS One</source><year>2013</year><volume>8</volume><elocation-id>e75537</elocation-id><pub-id pub-id-type="pmcid">PMC3782435</pub-id><pub-id pub-id-type="pmid">24086559</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0075537</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtuldu</surname><given-names>H</given-names></name><name><surname>Guasto</surname><given-names>JS</given-names></name><name><surname>Johnson</surname><given-names>KA</given-names></name><name><surname>Gollub</surname><given-names>JP</given-names></name></person-group><article-title>Enhancement of biomixing by swimming algal cells in two-dimensional films</article-title><source>Proc Natl Acad Sci U S A</source><year>2011</year><volume>108</volume><fpage>10391</fpage><lpage>5</lpage><pub-id pub-id-type="pmcid">PMC3127909</pub-id><pub-id pub-id-type="pmid">21659630</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1107046108</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jarrell</surname><given-names>KF</given-names></name><name><surname>McBride</surname><given-names>MJ</given-names></name></person-group><article-title>The surprisingly diverse ways that prokaryotes move</article-title><source>Nat Rev Microbiol</source><year>2008</year><volume>6</volume><fpage>466</fpage><lpage>476</lpage><pub-id pub-id-type="pmid">18461074</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Al-Kofahi</surname><given-names>O</given-names></name><etal/></person-group><article-title>Automated Cell Lineage Construction: A Rapid Method to Analyze Clonal Development Established with Murine Neural Progenitor Cells</article-title><source>Cell Cycle</source><year>2006</year><volume>5</volume><fpage>327</fpage><lpage>335</lpage><pub-id pub-id-type="pmid">16434878</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Veenman</surname><given-names>CJ</given-names></name><name><surname>Reinders</surname><given-names>MJT</given-names></name><name><surname>Backer</surname><given-names>E</given-names></name></person-group><article-title>Resolving motion correspondence for densely moving points</article-title><source>IEEE Trans Pattern Anal Mach Intell</source><year>2001</year><volume>23</volume><fpage>54</fpage><lpage>72</lpage></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meijeringa</surname><given-names>E</given-names></name><name><surname>Dzyubachyka</surname><given-names>O</given-names></name><name><surname>Smala</surname><given-names>I</given-names></name><name><surname>van Cappellen</surname><given-names>WA</given-names></name></person-group><article-title>Tracking in cell and developmental biology</article-title><source>Semin Cell Dev Biol</source><year>2009</year><volume>20</volume><fpage>894</fpage><lpage>902</lpage><pub-id pub-id-type="pmid">19660567</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>K</given-names></name><etal/></person-group><article-title>Psl trails guide exploration and microcolony formation in Pseudomonas aeruginosa biofilms</article-title><source>Nature</source><year>2013</year><volume>497</volume><fpage>388</fpage><lpage>91</lpage><pub-id pub-id-type="pmcid">PMC4109411</pub-id><pub-id pub-id-type="pmid">23657259</pub-id><pub-id pub-id-type="doi">10.1038/nature12155</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A hierarchical cascade of second messengers regulates Pseudomonas aeruginosa surface behaviors</article-title><source>mBio</source><year>2015</year><volume>6</volume><elocation-id>e02456-14</elocation-id><pub-id pub-id-type="pmcid">PMC4324313</pub-id><pub-id pub-id-type="pmid">25626906</pub-id><pub-id pub-id-type="doi">10.1128/mBio.02456-14</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishna Kumar</surname><given-names>R</given-names></name><etal/></person-group><article-title>Droplet printing reveals the importance of micron-scale structure for bacterial ecology</article-title><source>Nat Commun</source><year>2021</year><volume>12</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmcid">PMC7870943</pub-id><pub-id pub-id-type="pmid">33558498</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-20996-w</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>D</given-names></name><name><surname>Cheng</surname><given-names>X</given-names></name></person-group><article-title>To cross or not to cross: Collective swimming of Escherichia coli under two-dimensional confinement</article-title><source>Phys Rev Res</source><year>2022</year><volume>4</volume><elocation-id>023105</elocation-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubuis</surname><given-names>JO</given-names></name><name><surname>Tkacik</surname><given-names>G</given-names></name><name><surname>Wieschaus</surname><given-names>EF</given-names></name><name><surname>Gregor</surname><given-names>T</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><article-title>Positional information, in bits</article-title><source>Proc Natl Acad Sci U S A</source><year>2013</year><volume>110</volume><fpage>16301</fpage><lpage>16308</lpage><pub-id pub-id-type="pmcid">PMC3799327</pub-id><pub-id pub-id-type="pmid">24089448</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1315642110</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cover</surname><given-names>TM</given-names></name><name><surname>Thomas</surname><given-names>JA</given-names></name></person-group><source>Elements of Information Theory Elements of Information Theory</source><publisher-name>John Wiley &amp; Sons, Inc</publisher-name><year>1991</year><pub-id pub-id-type="doi">10.1002/0471200611</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmed</surname><given-names>NA</given-names></name><name><surname>Gokhale</surname><given-names>Dv</given-names></name></person-group><article-title>Entropy Expressions and Their Estimators for Multivariate Distributions</article-title><source>IEEE Trans Inf Theory</source><year>1989</year><volume>35</volume><fpage>688</fpage><lpage>692</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wensink</surname><given-names>HH</given-names></name><etal/></person-group><article-title>Meso-scale turbulence in living fluids</article-title><source>Proc Natl Acad Sci U S A</source><year>2012</year><volume>109</volume><fpage>14308</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC3437854</pub-id><pub-id pub-id-type="pmid">22908244</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1202032109</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Semmler</surname><given-names>AB</given-names></name><name><surname>Whitchurch</surname><given-names>CB</given-names></name><name><surname>Mattick</surname><given-names>JS</given-names></name></person-group><article-title>A re-examination of twitching motility in Pseudomonas aeruginosa</article-title><source>Microbiology (N Y)</source><year>1999</year><volume>145</volume><fpage>2863</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">10537208</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>Y</given-names></name><etal/></person-group><article-title>The population dynamics of bacteria in physically structured habitats and the adaptive virtue of random motility</article-title><source>Proc Natl Acad Sci U S A</source><year>2011</year><volume>108</volume><fpage>4047</fpage><lpage>52</lpage><pub-id pub-id-type="pmcid">PMC3053974</pub-id><pub-id pub-id-type="pmid">21325053</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1013499108</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>F</given-names></name><name><surname>Conrad</surname><given-names>JC</given-names></name><name><surname>Gibiansky</surname><given-names>ML</given-names></name><name><surname>Wong</surname><given-names>GCL</given-names></name></person-group><article-title>Bacteria use type-IV pili to slingshot on surfaces</article-title><source>Proc Natl Acad Sci U S A</source><year>2011</year><volume>108</volume><fpage>12617</fpage><lpage>22</lpage><pub-id pub-id-type="pmcid">PMC3150923</pub-id><pub-id pub-id-type="pmid">21768344</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1105073108</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Creppy</surname><given-names>A</given-names></name><name><surname>Praud</surname><given-names>O</given-names></name><name><surname>Druart</surname><given-names>X</given-names></name><name><surname>Kohnke</surname><given-names>PL</given-names></name><name><surname>Plouraboué</surname><given-names>F</given-names></name></person-group><article-title>Turbulence of swarming sperm</article-title><source>Phys Rev E</source><year>2015</year><volume>92</volume><elocation-id>032722</elocation-id><pub-id pub-id-type="pmid">26465513</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hood</surname><given-names>RD</given-names></name><etal/></person-group><article-title>A Type VI Secretion System of Pseudomonas aeruginosa Targets a Toxin to Bacteria</article-title><source>Cell Host Microbe</source><year>2010</year><volume>7</volume><fpage>25</fpage><lpage>37</lpage><pub-id pub-id-type="pmcid">PMC2831478</pub-id><pub-id pub-id-type="pmid">20114026</pub-id><pub-id pub-id-type="doi">10.1016/j.chom.2009.12.007</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Russell</surname><given-names>AB</given-names></name><name><surname>Peterson</surname><given-names>SB</given-names></name><name><surname>Mougous</surname><given-names>JD</given-names></name></person-group><article-title>Type VI secretion system effectors: Poisons with a purpose</article-title><source>Nature Reviews Microbiology</source><year>2014</year><volume>12</volume><fpage>137</fpage><lpage>148</lpage><pub-id pub-id-type="pmcid">PMC4256078</pub-id><pub-id pub-id-type="pmid">24384601</pub-id><pub-id pub-id-type="doi">10.1038/nrmicro3185</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>WPJ</given-names></name><etal/></person-group><article-title>The evolution of tit-for-tat in bacteria via the type VI secretion system</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC7589516</pub-id><pub-id pub-id-type="pmid">33106492</pub-id><pub-id pub-id-type="doi">10.1038/s41467-020-19017-z</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kudryashev</surname><given-names>M</given-names></name><etal/></person-group><article-title>Structure of the Type VI Secretion System Contractile Sheath Article Structure of the Type VI Secretion System Contractile Sheath</article-title><source>Cell</source><year>2015</year><volume>160</volume><fpage>952</fpage><lpage>962</lpage><pub-id pub-id-type="pmcid">PMC4359589</pub-id><pub-id pub-id-type="pmid">25723169</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2015.01.037</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>R</given-names></name><etal/></person-group><article-title>Quantitative image analysis of microbial communities with BiofilmQ</article-title><source>Nat Microbiol</source><year>2021</year><volume>6</volume><fpage>151</fpage><lpage>156</lpage><pub-id pub-id-type="pmcid">PMC7840502</pub-id><pub-id pub-id-type="pmid">33398098</pub-id><pub-id pub-id-type="doi">10.1038/s41564-020-00817-4</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>R</given-names></name><name><surname>van Teeseling</surname><given-names>MCF</given-names></name><name><surname>Thanbichler</surname><given-names>M</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name></person-group><article-title>BacStalk: A comprehensive and interactive image analysis software tool for bacterial cell biology</article-title><source>Mol Microbiol</source><year>2020</year><volume>114</volume><fpage>140</fpage><lpage>150</lpage><pub-id pub-id-type="pmid">32190923</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeckel</surname><given-names>H</given-names></name><name><surname>Drescher</surname><given-names>K</given-names></name></person-group><article-title>Advances and opportunities in image analysis of bacterial cells and communities</article-title><source>FEMS Microbiol Rev</source><year>2021</year><volume>45</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC8371272</pub-id><pub-id pub-id-type="pmid">33242074</pub-id><pub-id pub-id-type="doi">10.1093/femsre/fuaa062</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Valen</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Deep Learning Automates the Quantitative Analysis of Individual Cells in Live-Cell Imaging Experiments</article-title><source>PLoS Comput Biol</source><year>2016</year><volume>12</volume><elocation-id>e1005177</elocation-id><pub-id pub-id-type="pmcid">PMC5096676</pub-id><pub-id pub-id-type="pmid">27814364</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005177</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Connor</surname><given-names>OM</given-names></name><name><surname>Alnahhas</surname><given-names>RN</given-names></name><name><surname>Lugagne</surname><given-names>JB</given-names></name><name><surname>Dunlop</surname><given-names>MJ</given-names></name></person-group><article-title>DeLTA 2.0: A deep learning pipeline for quantifying single-cell spatial and temporal dynamics</article-title><source>PLoS Comput Biol</source><year>2022</year><volume>18</volume><elocation-id>e1009797</elocation-id><pub-id pub-id-type="pmcid">PMC8797229</pub-id><pub-id pub-id-type="pmid">35041653</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009797</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cuny</surname><given-names>AP</given-names></name><name><surname>Ponti</surname><given-names>A</given-names></name><name><surname>Kündig</surname><given-names>T</given-names></name><name><surname>Rudolf</surname><given-names>F</given-names></name><name><surname>Stelling</surname><given-names>J</given-names></name></person-group><article-title>Cell region fingerprints enable highly precise single-cell tracking and lineage reconstruction</article-title><source>Nat Methods</source><year>2022</year><volume>19</volume><fpage>1276</fpage><lpage>1285</lpage><pub-id pub-id-type="pmid">36138173</pub-id></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panigrahi</surname><given-names>S</given-names></name><etal/></person-group><article-title>Misic, a general deep learning-based method for the high-throughput cell segmentation of complex bacterial communities</article-title><source>Elife</source><year>2021</year><volume>10</volume><elocation-id>e65151</elocation-id><pub-id pub-id-type="pmcid">PMC8478410</pub-id><pub-id pub-id-type="pmid">34498586</pub-id><pub-id pub-id-type="doi">10.7554/eLife.65151</pub-id></element-citation></ref><ref id="R46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertrand</surname><given-names>JJ</given-names></name><name><surname>West</surname><given-names>JT</given-names></name><name><surname>Engel</surname><given-names>JN</given-names></name></person-group><article-title>Genetic Analysis of the Regulation of Type IV Pilus Function by the Chp Chemosensory System of Pseudomonas aeruginosa</article-title><source>J Bacteriol</source><year>2009</year><volume>192</volume><fpage>994</fpage><lpage>1010</lpage><pub-id pub-id-type="pmcid">PMC2812951</pub-id><pub-id pub-id-type="pmid">20008072</pub-id><pub-id pub-id-type="doi">10.1128/JB.01390-09</pub-id></element-citation></ref><ref id="R47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J</given-names></name><etal/></person-group><article-title>Fiji: an open-source platform for biological-image analysis</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><fpage>676</fpage><lpage>682</lpage><pub-id pub-id-type="pmcid">PMC3855844</pub-id><pub-id pub-id-type="pmid">22743772</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id></element-citation></ref><ref id="R48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thévenaz</surname><given-names>P</given-names></name><name><surname>Ruttimann</surname><given-names>UE</given-names></name><name><surname>Unser</surname><given-names>M</given-names></name></person-group><article-title>A pyramid approach to subpixel registration based on intensity</article-title><source>IEEE Transactions on Image Processing</source><year>1998</year><volume>7</volume><fpage>27</fpage><lpage>41</lpage><pub-id pub-id-type="pmid">18267377</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Fig. 1</label><caption><title>Analysis of high-density datasets using FAST’s modular framework.</title><p>(a) While bacteria naturally form monolayers in some environments, a number of different assays are used to physically confine cells to a plane in laboratory experiments. Among these are interstitial colonies, microfluidic devices that trap cells between two solid boundaries, and experimental assays that confine cells to a thin film of liquid. (b) These experiments are typically imaged using automated microscopy systems capable of collecting images in both transmitted light and fluorescent channels at specified time points. (c) FAST analyses these imaging datasets in six separate modules, each of which is used in sequence (see text). A complete specification of each module is provided in the <xref ref-type="supplementary-material" rid="SD1">Supplementary Information</xref>.</p></caption><graphic xlink:href="EMS157438-f001"/></fig><fig id="F2" position="float"><label>Fig. 2</label><caption><title>An information-theoretic framework for automated object tracking.</title><p>(a) For illustrative purposes, we consider here a theoretical dataset in which an object is characterised using a single feature, its position along the x-axis. The object’s position at three successive timepoints is denoted x<sub>1</sub>,x<sub>2</sub>,x<sub>3</sub> (red circles), while the displacements are denoted Δx<sub>1</sub>,Δx<sub>2</sub> (blue arrows). We assume that feature displacements are drawn from a Normal distribution f(Δx), while the instantaneous object position (independent of knowledge of other timepoints) is drawn from a separate Uniform distribution f(x) (b). The information content I of the feature is then calculated as the difference in the entropies of the two distributions, H(X) and H(ΔX), and represents our increase in certainty about the position of the object at time t+1given knowledge about its position at time t. The trackability quantifies the total amount of information measured for each object, which increases when f(Δx) exhibits less variability relative to f(x). (c) Trackability decreases when the distribution of f(Δx) is broader (i.e. the feature becomes more “noisy”). Here the different colours correspond to the different distributions of f(Δx) shown in panel b. d,e) Illustration of the feature normalization process for two features. In both d and e, the central plot indicates the joint distribution of a pair of feature displacements, while the left and bottom plots indicate the corresponding marginal distributions. In (d), the random variables representing the unnormalized frame-frame displacements of the two features - ΔX and ΔY - are correlated and displaced from the origin. Using the joint distribution’s covariance matrix Σ(Δ<bold>x</bold>) and mean vector µ(Δ<bold>x</bold>), the feature space is transformed such that the resulting joint distribution of feature displacements <inline-formula><mml:math id="M16"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is zero-centred and isotropic (e), ensuring that each feature exhibits an equivalent amount of stochastic variation between frames.</p></caption><graphic xlink:href="EMS157438-f002"/></fig><fig id="F3" position="float"><label>Fig. 3</label><caption><title>Validating FAST using synthetic data from a simulation of collective bacterial motility.</title><p>(a) We used a self-propelled rod (SPR) model to generate noisy datasets with a verified ground truth. We then performed cell tracking with FAST using either only a single feature (the rod’s centroid at sequential timepoints; brown) or using a suite of different features (rod centroid, length, orientation and simulated fluorescence intensity; purple). Comparison of the reconstructed trajectories from FAST (b) with the ground truth data (c) allowed us to identify the errors made by the tracking algorithm (d). Errors were split into two categories: links made between objects that were incorrect (‘false positives’, solid magenta lines), and links between objects that were missed (‘false negatives’, dashed magenta lines). We also calculated the number of correct links made in each case (‘true positives’, solid orange lines). From these counts, we evaluated the performance of the tracking algorithm by calculating the F<sub>1</sub>-score (main text). (e) The value of this F<sub>1</sub>-score depends on a user-defined parameter, the tracking threshold. To objectively compare the results from the tracking algorithm when run on datasets with different properties, we calculated the tracking threshold that generated the largest F<sub>1</sub>-score for a given dataset and used this score in subsequent analyses. (f) Including all feature information substantially and consistently improved tracking performance compared to when only object positions were used (see also <xref ref-type="fig" rid="F8">Extended Data Fig. 2</xref>). Furthermore, we found that our trackability metric was an excellent predictor of tracking accuracy for a given set of features, suggesting that it can be used to estimate the accuracy of the algorithm even when a ground truth is not available. In the different simulations we varied rod density, propulsive force, and framerate, as well the amount of noise in the measurement of position, length and fluorescence (Extended Data Fig. 3). The black circles in (f) correspond to the dataset presented in (e).</p></caption><graphic xlink:href="EMS157438-f003"/></fig><fig id="F4" position="float"><label>Fig. 4</label><caption><title>Tracking single cells in an interstitial P. aeruginosa colony spreading via pili-based motility.</title><p>(a) We used FAST to track cells within a monolayer of P. aeruginosa undergoing collective motility using position, length and width as features. Images were collected using high speed “camera streaming” with a mean frame rate of 127 fps, but variations in the elapsed time between subsequent frames, Δt, resulted in transient reductions in trackability. (a, inset) Analysis of the timestamps associated with each frame revealed that the trackability score was negatively correlated with Δt (R indicates Pearson’s correlation coefficient; the warmer colours denote a higher density of data points). We therefore restricted our subsequent analyses to a subset of the data in which the trackability score was relatively constant (green region) using FAST’s built-in tools. (b) We used the Overlays module to colour code cells based on their instantaneous speed. Although cells typically moved relatively slowly, very occasionally cells were observed to undergo a very rapid burst of movement (see cream coloured cell). (c) These rapid jumps can also be observed in traces of the speed of individual cells. Here we plot the instantaneous speed of three different cells over time, each in a different colour. The montages above illustrate three of these transient events, using the same colour coding shown in b. (d) To investigate these movements at the population level, we calculated instantaneous cell velocities in both the x and y direction for all cells and plotted their combined distribution. In other active systems, this distribution is approximately Gaussian. However, in our system the highly transient bursts of velocity results in heavy tails, causing them deviate from a Gaussian distribution with the same variance (dashed black line).</p></caption><graphic xlink:href="EMS157438-f004"/></fig><fig id="F5" position="float"><label>Fig. 5</label><caption><title>Tracking and lineage analysis of E. coli cells in a growing colony.</title><p>(a) Lineage tree showing the colony at the final point of the timeseries. Here thicker lines show the location of division events and thinner lines show the movement of cells between divisions. The trajectory colour indicates how many generations have elapsed in each lineage from the initial timepoint. (b) The colony at three different timepoints. Cells that share the same mother in generation 1 (‘Gen 1’) are shown in the same colour at each timepoint, illustrating how the spatial distribution of different lineages develops over time. (c) Growth curves of each cell, aligned by generation number. Tracks are shaded according to the age of the corresponding cell, from birth (dark blue) to division (light blue). The data visualisations of both panels a and b were produced using FAST’s Overlays module, while panel c was prepared with the Plotting module.</p></caption><graphic xlink:href="EMS157438-f005"/></fig><fig id="F6" position="float"><label>Fig. 6</label><caption><title>Identifying different bacterial species, quantifying cell morphologies, and investigating T6SS dynamics in a densely packed collective.</title><p>(a) A monolayer composed of a mixture of P. aeruginosa cells expressing TssB-mNeongreen and V. cholerae cells expressing VipA-mCherry (left). Measurements of the average intensity of each cell in the two different fluorescence channels allowed us to automatically distinguish the two species (b), an approach known as image cytometry. By colour coding each cell (P. aeruginosa, cyan, V. cholerae, red), we were able to visually confirm the accuracy of the assignment process (a, right). (c) We then quantified a novel feature, cell curvature, using FAST’s custom feature extraction framework to calculate the curvature of the segmentation backbones (inset). Splitting these measurements into the two previously assigned populations showed the comma shaped V. cholerae cells were substantially more curved than the rod-shaped P. aeruginosa cells. (d-f) We then used FAST’s plotting options to illustrate the dynamics of the T6SS. A P. aeruginosa cell fires its T6SS machinery (observed as the bright puncta of TssB), which can be visualised using the kymograph (d) and ‘cartouche’ (f) plotting options, as well as an increase in the standard deviation of the mNeongreen channel (e). (g) We used this latter measurement to detect when the T6SS was active in a cell, allowing us to measure the proportion of time that each cell in the population spends in the firing state. Our analyses confirmed that when co-cultured with a strain of V. cholerae with an inactive T6SS (Δhcp1 Δhcp2), the T6SS activity of WT P. aeruginosa cells is dramatically reduced compared to when they are co-cultured with WT V. cholerae. Here the circles show results from individual experimental timeseries and horizontal lines show the overall mean proportion.</p></caption><graphic xlink:href="EMS157438-f006"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Parameters of the SPR model used to generate synthetic datasets.</title><p>Here we show both range of values we tested and baseline value that was used when we varied another parameter. Note that our simulations are non-dimensionalised, using the width of a single rod as the characteristic lengthscale and the time taken for an isolated rod with F = 1 to move a single rod width as the characteristic timescale.</p></caption><table frame="box" rules="rows"><thead><tr style="background-color:#4472C4"><th valign="top" align="left"><styled-content style="color:#FFFFFF">Parameter symbol</styled-content></th><th valign="top" align="left"><styled-content style="color:#FFFFFF">Parameter name</styled-content></th><th valign="top" align="left"><styled-content style="color:#FFFFFF">Value(s)</styled-content></th></tr></thead><tbody><tr><td valign="middle" align="center"><bold><italic>A</italic></bold></td><td valign="middle" align="left">Area of simulation domain</td><td valign="middle" align="left">10,000</td></tr><tr><td valign="bottom" align="center"><bold><italic>f</italic><sub>0</sub></bold></td><td valign="bottom" align="left">Stokesian friction coefficient</td><td valign="bottom" align="left">1</td></tr><tr><td valign="top" align="center"><bold><italic>N</italic></bold></td><td valign="top" align="left">Number of rods</td><td valign="bottom" align="left">700 (baseline)<break/>[300, 500, 700, 900, 1100] (variable)</td></tr><tr><td valign="top" align="center"><bold><italic>F</italic></bold></td><td valign="top" align="left">Self-propulsion force</td><td valign="bottom" align="left">1 (baseline)<break/>[0.7, 0.85, 1, 1.15, 1.3] (variable)</td></tr><tr><td valign="top" align="center"><bold><italic>ΔT</italic></bold></td><td valign="bottom" align="left">Time between sampled timepoints</td><td valign="bottom" align="left">10 (baseline)<break/>[5, 7.5, 10, 12.5, 15] (variable)</td></tr><tr><td valign="top" align="center"><bold><italic>σ<sub>r</sub></italic></bold></td><td valign="bottom" align="left">Standard deviation of positional measurement noise</td><td valign="bottom" align="left">0.02 (baseline)<break/>[0.02, 0.1, 0.2, 0.4, 0.6] (variable)</td></tr><tr><td valign="top" align="center"><bold><italic>σ<sub>ϕ</sub></italic></bold></td><td valign="middle" align="left">Standard deviation of orientational measurement noise</td><td valign="top" align="left">0.02 radians</td></tr><tr><td valign="top" align="center"><bold><italic>σ<sub>a</sub></italic></bold></td><td valign="bottom" align="left">Standard deviation of length measurement noise</td><td valign="bottom" align="left">0.1 (baseline)<break/>[0.05, 0.1, 0.2, 0.4, 0.6] (variable)</td></tr><tr><td valign="top" align="center"><bold><italic>σ<sub>I</sub></italic></bold></td><td valign="middle" align="left">Standard deviation of fluorescence measurement noise</td><td valign="top" align="left">1 A.U. (baseline)<break/>[0.5, 1, 2, 4, 6] A.U. (variable)</td></tr></tbody></table></table-wrap></floats-group></article>