<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS141072</article-id><article-id pub-id-type="doi">10.1101/2021.12.02.471004</article-id><article-id pub-id-type="archive">PPR428528</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Online Phylogenetics using Parsimony Produces Slightly Better Trees and is Dramatically More Efficient for Large SARS-CoV-2 Phylogenies than <italic>de novo</italic> and Maximum-Likelihood Approaches</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Thornlow</surname><given-names>Bryan</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Kramer</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ye</surname><given-names>Cheng</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Maio</surname><given-names>Nicola De</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>McBroome</surname><given-names>Jakob</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Hinrichs</surname><given-names>Angie S.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Lanfear</surname><given-names>Robert</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Turakhia</surname><given-names>Yatish</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Corbett-Detig</surname><given-names>Russell</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biomolecular Engineering, University of California, Santa Cruz; Santa Cruz, CA 95064, USA</aff><aff id="A2"><label>2</label>Genomics Institute, University of California, Santa Cruz; Santa Cruz, CA 95064, USA</aff><aff id="A3"><label>3</label>Department of Electrical and Computer Engineering, University of California, San Diego; San Diego, CA 92093, USA</aff><aff id="A4"><label>4</label>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus; Cambridge CB10 1SD, UK</aff><aff id="A5"><label>5</label>Department of Ecology and Evolution, Research School of Biology, Australian National University; Canberra, ACT 2601, Australia</aff><author-notes><corresp id="CR1">
<label>*</label>Correspondence to <email>bthornlo@ucsc.edu</email> and <email>rucorbet@ucsc.edu</email>
</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>07</day><month>02</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>03</day><month>12</month><year>2021</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Phylogenetics has been foundational to SARS-CoV-2 research and public health policy, assisting in genomic surveillance, contact tracing, and assessing emergence and spread of new variants. However, phylogenetic analyses of SARS-CoV-2 have often relied on tools designed for <italic>de novo</italic> phylogenetic inference, in which all data are collected before any analysis is performed and the phylogeny is inferred once from scratch. SARS-CoV-2 datasets do not fit this mould. There are currently over 10 million sequenced SARS-CoV-2 genomes in online databases, with tens of thousands of new genomes added every day. Continuous data collection, combined with the public health relevance of SARS-CoV-2, invites an “online” approach to phylogenetics, in which new samples are added to existing phylogenetic trees every day. The extremely dense sampling of SARS-CoV-2 genomes also invites a comparison between likelihood and parsimony approaches to phylogenetic inference. Maximum likelihood (ML) methods are more accurate when there are multiple changes at a single site on a single branch, but this accuracy comes at a large computational cost, and the dense sampling of SARS-CoV-2 genomes means that these instances will be extremely rare because each internal branch is expected to be extremely short. Therefore, it may be that approaches based on maximum parsimony (MP) are sufficiently accurate for reconstructing phylogenies of SARS-CoV-2, and their simplicity means that they can be applied to much larger datasets. Here, we evaluate the performance of <italic>de novo</italic> and online phylogenetic approaches, and ML and MP frameworks, for inferring large and dense SARS-CoV-2 phylogenies. Overall, we find that online phylogenetics produces similar phylogenetic trees to <italic>de novo</italic> analyses for SARS-CoV-2, and that MP optimizations produce more accurate SARS-CoV-2 phylogenies than do ML optimizations. Since MP is thousands of times faster than presently available implementations of ML and online phylogenetics is faster than <italic>de novo,</italic> we therefore propose that, in the context of comprehensive genomic epidemiology of SARS-CoV-2, MP online phylogenetics approaches should be favored.</p></abstract><kwd-group><kwd>SARS-CoV-2</kwd><kwd>phylogenetics</kwd><kwd>parsimony</kwd><kwd>maximum likelihood</kwd><kwd>optimization</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The widespread availability and extreme abundance of pathogen genome sequencing has made phylogenetics central to combatting the pandemic. Communities worldwide have begun implementing genomic surveillance by systematically sequencing the genomes of a percentage of local cases (<xref ref-type="bibr" rid="R10">Deng et al. 2020</xref>; <xref ref-type="bibr" rid="R28">Lu et al. 2020a</xref>; <xref ref-type="bibr" rid="R32">Meredith et al. 2020</xref>; <xref ref-type="bibr" rid="R36">Park et al. 2021</xref>). This has been invaluable in tracing local transmission chains (<xref ref-type="bibr" rid="R4">Bluhm et al. 2020</xref>; <xref ref-type="bibr" rid="R25">Lam 2020</xref>), understanding the genetic makeup of viral populations within local communities (<xref ref-type="bibr" rid="R15">Gonzalez-Reiche et al. 2020</xref>; <xref ref-type="bibr" rid="R13">Franceschi et al. 2021</xref>; <xref ref-type="bibr" rid="R53">Thornlow et al. 2021a</xref>), uncovering the means by which viral lineages have been introduced to new areas (<xref ref-type="bibr" rid="R5">Castillo et al. 2020</xref>), and measuring the relative spread of specific variants (<xref ref-type="bibr" rid="R47">Skidmore et al. 2021</xref>; <xref ref-type="bibr" rid="R58">Umair et al. 2021</xref>). Phylogenetic approaches for better understanding the proximate evolutionary origins of the virus (<xref ref-type="bibr" rid="R27">Li et al. 2020</xref>), as well as to identify recombination events (<xref ref-type="bibr" rid="R20">Jackson et al. 2021</xref>; <xref ref-type="bibr" rid="R57">Turakhia et al. 2021b</xref>) and instances of convergent evolution (<xref ref-type="bibr" rid="R21">Kalantar et al. 2020</xref>; <xref ref-type="bibr" rid="R38">Peng et al. 2021</xref>) have greatly informed our understanding of the virus. Phylogenetic visualization software including Auspice (<xref ref-type="bibr" rid="R16">Hadfield et al. 2018</xref>) and Taxonium (<xref ref-type="bibr" rid="R43">Sanderson 2021a</xref>) have also become widely used for public health purposes.</p><p id="P3">A comprehensive, up-to-date phylogenetic tree of SARS-CoV-2 is important for public health officials and researchers. A tree containing all available sequences can sometimes facilitate identification of epidemiological links between samples that might otherwise be obscured in subsampled phylogenies. Conversely, these approaches can often rule out otherwise plausible transmission histories. Such information can also help to identify the likely sources of new viral strains in a given area (<xref ref-type="bibr" rid="R34">Moreno et al. 2020</xref>; <xref ref-type="bibr" rid="R51">Tang et al. 2021</xref>). Additionally, using up-to-date information enables us to find and track quickly growing clades and novel variants of concern (<xref ref-type="bibr" rid="R1">Annavajhala et al. 2021</xref>; <xref ref-type="bibr" rid="R52">Tegally et al. 2021</xref>), as well as to measure the spread of known variants at both global and community scales. Furthermore, comprehensive phylogenies can facilitate identification of recombinant viral genomes (<xref ref-type="bibr" rid="R57">Turakhia et al. 2021b</xref>), natural selection at homoplasious positions (van Dorp et al. 2020), variation in mutation rates (<xref ref-type="bibr" rid="R8">De Maio et al. 2021a</xref>), and systematic recurrent errors (Turakhia et al. 2020). This also facilitates naming lineages of interest, which has been especially important in tracking variants of concern during the pandemic (<italic>e.g.</italic> B.1.1.7 or “Alpha” and B.1.617.2 or “Delta”) (<xref ref-type="bibr" rid="R41">Rambaut et al. 2020</xref>).</p><p id="P4">SARS-CoV-2 presents a unique set of phylogenetic challenges. First, the unprecedented pace and scale of whole-genome sequence data has forced the phylogenetics community to place runtime and scalability at the center of every inference strategy. More than 10 million SARS-CoV-2 genome sequences are currently available, with tens of thousands being added each day. Prior to the pandemic, <italic>de novo</italic> phylogenetics, or approaches that infer phylogenies from scratch, have been the standard, as there has rarely been a need to re-infer or improve pre-existing phylogenies on a daily basis. Re-inferring a tree of more than 10 million samples daily, however, is extremely costly, and has brought a renewed focus on methods for adding new samples to existing phylogenetic trees (<xref ref-type="bibr" rid="R30">Matsen et al. 2010</xref>; <xref ref-type="bibr" rid="R3">Berger et al. 2011</xref>; <xref ref-type="bibr" rid="R19">Izquierdo-Carrasco et al. 2014</xref>; <xref ref-type="bibr" rid="R12">Fourment et al. 2018</xref>; <xref ref-type="bibr" rid="R2">Barbera et al. 2019</xref>). This approach has been called “online phylogenetics” (<xref ref-type="bibr" rid="R14">Gill et al. 2020</xref>), and has important advantages in the context of the pandemic and beyond. Online phylogenetics is appealing for the genomic surveillance of any pathogen, because iterative optimization should decrease computational expense, allowing good estimates of phylogenies to be made readily available.</p><p id="P5">Second, SARS-CoV-2 genomes are much more closely related than sequences in most other phylogenetic analyses. Because the advantages of maximum likelihood methods decrease for closely related samples and long branches are relatively rare in the densely sampled SARS-CoV-2 phylogeny (<xref ref-type="bibr" rid="R11">Felsenstein 1978</xref>; <xref ref-type="bibr" rid="R17">Hendy and Penny 1989</xref>; <xref ref-type="bibr" rid="R39">Philippe et al. 2005</xref>), this suggests that phylogenetic inferences based on maximum parsimony, a much faster and simpler phylogenetic inference method, could be better suited for online phylogenetic analyses of SARS-CoV-2 genomes (<xref ref-type="bibr" rid="R60">Wertheim et al. 2021</xref>). The principle of maximum parsimony is that the tree with the fewest mutations should be favored, and it is sometimes described as a non-parametric phylogenetic inference method (<xref ref-type="bibr" rid="R50">Sullivan and Swofford 2001</xref>; <xref ref-type="bibr" rid="R23">Kolaczkowski and Thornton 2004</xref>). Additionally, because parsimony-based tree optimization does not require estimation of ancestral character state uncertainty at all positions in the phylogeny like ML optimization does, parsimony uses much less memory.</p><p id="P6">Here, we evaluate approaches that would enable one to maintain a fully up-to-date and comprehensive global phylogeny of SARS-CoV-2 genome sequences (<xref ref-type="bibr" rid="R31">McBroome et al. 2021</xref>). Specifically, we investigate tradeoffs between online and <italic>de novo</italic> phylogenetics and between maximum parsimony and maximum likelihood approaches when the aim is for an analysis to scale to millions of sequences, with tens of thousands of new sequences being added daily. We chose to compare maximum parsimony and maximum likelihood (and omit other approaches like neighbor-joining) because they were the most effective methods at inferring large SARS-CoV-2 phylogenies based on previous analyses (<xref ref-type="bibr" rid="R26">Lanfear and Mansfield 2020</xref>), and because the most efficient distance-based methods are quadratic in memory usage so cannot scale to estimating trees from datasets of more than a few hundred thousand sequences (<xref ref-type="bibr" rid="R59">Wang et al. 2022</xref>). We mimic the time-course of the pandemic by introducing increasingly large numbers of SARS-CoV-2 genome sequences proportionately to their reported sampling dates.</p><p id="P7">We evaluate potential online phylogenetics approaches by iteratively adding samples to existing trees and optimizing the augmented phylogeny with different tools that have been proposed for this purpose during the pandemic. In particular, we evaluate matOptimize, IQ-TREE 2, and FastTree 2. Between each optimization step, we use UShER (<xref ref-type="bibr" rid="R56">Turakhia et al. 2021a</xref>) to add samples to trees by maximum parsimony. matOptimize is a parsimony optimization approach that uses subtree pruning and regrafting (SPR) moves to minimize the total mutations in the final tree topology (<xref ref-type="bibr" rid="R61">Ye et al. 2022</xref>). IQ-TREE 2 uses nearest neighbor interchange (NNI) to find the tree with the highest likelihood given an input multiple sequence alignment (<xref ref-type="bibr" rid="R33">Minh et al. 2020</xref>). FastTree 2 uses a pseudo-likelihood approach that employs minimum-evolution SPR and/or NNI moves and maximum-likelihood NNI moves while using several heuristics to reduce the search space (<xref ref-type="bibr" rid="R40">Price et al. 2010</xref>). The likelihood-based approaches evaluated here report branch lengths in substitutions per site. Parsimony-based matOptimize reports branch lengths in total substitutions, which can be converted to the latter by dividing by the genome length. These branch lengths may be interpreted as is or used as an initial estimate for other distance measures, for example in the construction of time trees (<xref ref-type="bibr" rid="R44">Sanderson 2021b</xref>).</p><p id="P8">Results from our comparisons demonstrate that for the purposes of SARS-CoV-2 phylogenetics, in which samples are numerous and closely related and inference speed is of high significance, parsimony-based online phylogenetics applications are clearly most favorable and are also the only immediately available methods capable of producing daily phylogenetic estimates of all available SARS-CoV-2 genomes (<xref ref-type="bibr" rid="R56">Turakhia et al. 2021a</xref>). We note that matOptimize is used to maintain such a phylogeny comprising over 9 million genomes as of April 2022 (<xref ref-type="bibr" rid="R31">McBroome et al. 2021</xref>). As similarly vast datasets will soon be available for many species and pathogens, we expect that online approaches using parsimony or pseudo-likelihood optimization will become increasingly central to phylogenetic inference.</p></sec><sec id="S2" sec-type="results | discussion"><title>Results and Discussion</title><sec id="S3"><title>Online phylogenetics is an alternative to de novo phylogenetics for ongoing studies</title><p id="P9">The vast majority of phylogenetics during the pandemic has consisted of <italic>de novo</italic> phylogenetics approaches (<xref ref-type="bibr" rid="R16">Hadfield et al. 2018</xref>; <xref ref-type="bibr" rid="R27">Li et al. 2020</xref>; <xref ref-type="bibr" rid="R28">Lu et al. 2020a</xref>, <xref ref-type="bibr" rid="R29">2020b</xref>; <xref ref-type="bibr" rid="R32">Meredith et al. 2020</xref>), in which each phylogeny is inferred using only genetic variation data, and without a guide tree (<xref ref-type="fig" rid="F1">Fig. 1</xref>). This strategy for phylogenetic inference has long been the default, as in most instances in the past, data are collected just once for a project, and more relevant data are rarely going to be made available in the near future. This process is well characterized and has been foundational for many phylogenetics studies (<xref ref-type="bibr" rid="R18">Hug et al. 2016</xref>; <xref ref-type="bibr" rid="R37">Parks et al. 2018</xref>; <xref ref-type="bibr" rid="R29">Lu et al. 2020b</xref>), and most phylogenetics software is developed with <italic>de novo</italic> phylogenetics as the primary intended usage.</p><p id="P10">A challenging aspect of pandemic phylogenetics is the need to keep up with the pace of data generation as genome sequences continuously become available. To evaluate phylogenetics applications in the pandemic (<xref ref-type="fig" rid="F1">Fig. 1</xref>), we split 233,326 samples dated from December 23, 2019 through January 11, 2021 into 50 batches according to their date of collection. Each batch contains roughly 5,000 samples. Samples in each batch were collected within a few days of each other, except in the first months of the pandemic when sample collection was more sparse. We also constructed a dataset of otherwise similar data simulated from a known phylogeny (see <xref ref-type="sec" rid="S10">Methods</xref>). The intent of this scheme is to roughly approximate the data generation and deposition that occurred during the pandemic. All datasets are available from the repository associated with this project (<xref ref-type="bibr" rid="R54">Thornlow et al. 2021b</xref>), for reproducibility and so that future methods developers can directly compare their outputs to our results. We performed online and <italic>de novo</italic> phylogenetics using a range of inference and optimization approaches. Since thousands of new sequences are added to public sequence repositories each day, we terminated any phylogenetic inference approaches that took more than 24 hours, because such phylogenies would be obsolete for some public health applications by the time they were inferred.</p></sec><sec id="S4"><title>Analyses using simulated data suggest that online phylogenetics is more accurate for SARS-CoV-2</title><p id="P11">We first compared matOptimize (commit 66ca5ff, conda version 0.4.8) (<xref ref-type="bibr" rid="R61">Ye et al. 2022</xref>), IQ-TREE 2 (<xref ref-type="bibr" rid="R33">Minh et al. 2020</xref>), and FastTree 2 (<xref ref-type="bibr" rid="R40">Price et al. 2010</xref>) using both online and <italic>de novo</italic> phylogenetics strategies using simulated data that we designed to closely mimic real SARS-CoV-2 datasets. All online phylogenomics workflows used UShER (<xref ref-type="bibr" rid="R56">Turakhia et al. 2021a</xref>) to add new sequences to the previous tree (see <xref ref-type="sec" rid="S10">Methods</xref>) as to our knowledge it is the only software package that is fast enough to perform under real time constraints. We chose these three tools based on their widespread usage among SARS-CoV-2 phylogenetics applications (<italic>e.g.</italic> matOptimize is part of the UShER suite (<xref ref-type="bibr" rid="R56">Turakhia et al. 2021a</xref>), IQ-TREE 2 is used by (<xref ref-type="bibr" rid="R6">COVID-19 Genomics UK (COG-UK) Consortium 2020</xref>; <xref ref-type="bibr" rid="R26">Lanfear and Mansfield 2020</xref>) and FastTree 2 is used by (<xref ref-type="bibr" rid="R16">Hadfield et al. 2018</xref>)) as well as to cover several different methodologies.</p><p id="P12">Simulating an alignment based on a known tree ensures that there is a ground truth for comparison to definitively assess each optimization method. We used an inferred global phylogeny as a template to simulate a complete multiple sequence alignment using phastSim (<xref ref-type="bibr" rid="R9">De Maio et al. 2021b</xref>). We subsampled this simulated alignment into 50 progressively larger sets of samples, ranging in number of samples from 4,676 to 233,326 (see <xref ref-type="sec" rid="S10">Methods</xref>), to examine each of the three optimization methods in both online and <italic>de novo</italic> phylogenetics. We then computed the Robinson-Foulds distance for unrooted trees of each iteration, after condensing identical samples and collapsing very short branches, to the global mutation-annotated tree on which the simulation was based, pruned to contain only the relevant samples, and normalized by the maximum possible Robinson-Foulds distance between the trees (<xref ref-type="fig" rid="F2">Fig. 2</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>) (<xref ref-type="bibr" rid="R49">Steel and Penny 1993</xref>).</p><p id="P13">All online phylogenetics methods noticeably outperformed their <italic>de novo</italic> counterparts. Overall, online matOptimize produced phylogenies with the lowest Robinson-Foulds distance to the ground truth for the majority of iterations (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Online IQ-TREE 2 performed similarly, but was able to complete only 25 of the 50 iterations due to its extreme computational resource requirements. For example, for the 14th phylogeny of 60,571 sequences, which was the last phylogeny produced using under 200 GB of RAM in under 24 hours by all six methods, we found Robinson-Foulds distances of 1696, 2590, and 2130 for <italic>de novo UShER+</italic> matOptimize, FastTree 2, and IQ-TREE 2 respectively, and distances of 1557, 2111, and 1618 for online matOptimize, FastTree 2, and IQ-TREE 2, respectively.</p><p id="P14">There are several possible explanations for the improved performance of online phylogenetics relative to <italic>de novo</italic> approaches. First, the radius for SPR moves when optimizing a large tree is insufficiently large to find improvements that are more readily applied when the tree contains fewer samples as in early rounds of online phylogenetics. In online phylogenetics, these improvements carry over to subsequent trees, while in <italic>de novo,</italic> they do not. The radius is defined as the phylogenetic distance of the search space when moving a node to a more optimal position. As the phylogeny increases in size, the distance from a node to its optimal position is likely to also increase, necessitating a larger SPR move radius to make equivalent improvements in larger trees. Second, large clades consisting primarily of samples with branch length zero might further reduce the ability of optimization methods to find improvements by indirectly limiting search space due to the increased number of edges when represented internally as a bifurcating tree. It may sometimes be possible to explore moves across such tree regions during online phylogenetics in early iterations when the polytomy is relatively small. Third, online phylogenetics facilitates tree optimization by providing an exceptionally good initial tree that has already been heavily optimized in previous iterations. We expect that this approach will typically outperform parsimony and neighbor-joining initial trees that are used in most <italic>de novo</italic> phylogenetic inference approaches. Finally, because each online experiment began with a small tree inferred <italic>de novo</italic> by stepwise sample addition with UShER, it is possible that these initial trees are more optimal than initial trees produced during <italic>de novo</italic> inference by the other software we evaluated, perhaps because UShER prefers the reference nucleotide in cases of ambiguous internal character states.</p></sec><sec id="S5"><title>Analyses using real data suggest that online phylogenetics is more efficient than <italic>de novo</italic> and produces similarly optimal phylogenies</title><p id="P15">While analyses using simulated data offer the ability to compare to a known ground truth, assessing the performance of each method on real SARS-CoV-2 data may more accurately reflect practical use of each method. Therefore, we also tested each optimization strategy on 50 progressively larger sets of real SARS-CoV-2 samples and calculated the parsimony score and likelihood of each optimized tree, as well as the run-time and peak RAM usage of each software package used (<xref ref-type="fig" rid="F3">Fig. 3</xref>). To accomplish this, we subsampled our global phylogeny, which was produced using stringent quality control steps (see <xref ref-type="sec" rid="S10">Methods</xref>), as before, to mimic the continuous accumulation of samples over the course of the pandemic.</p><p id="P16">Online optimizations are generally much faster than <italic>de novo</italic> phylogenetic inference. For example, IQ-TREE 2 achieves a roughly four-fold faster run-time for online optimizations compared to inferring the tree <italic>de novo</italic> (<xref ref-type="fig" rid="F3">Fig. 3c</xref>). The 11th iteration, which has 47,819 sequences and was the last to be completed by both online and <italic>de novo</italic> IQ-TREE 2, took 22 hours 50 minutes for <italic>de novo</italic> IQ-TREE 2 but only 5 hours 26 minutes for online IQ-TREE 2. <italic>De novo</italic> UShER+matOptimize was the only <italic>de novo</italic> method to finish all trees in fewer than 24 hours, but its speed for each daily update pales in comparison to online matOptimize. Online matOptimize is several orders of magnitude faster than its <italic>de novo</italic> counterpart, and its optimizations for the largest phylogenies take roughly 30 seconds, while <italic>de novo</italic> tree inference with UShER can take several hours for trees consisting of more than 100,000 samples (<xref ref-type="fig" rid="F3">Fig. 3c</xref>). However, whether a software package is used for online or <italic>de novo</italic> phylogenetics does not strongly affect its peak memory usage.</p><p id="P17">We also found that online phylogenetics strategies produce trees very similar in both parsimony score and likelihood to their <italic>de novo</italic> counterparts, with differences of less than 1% in all cases (<xref ref-type="fig" rid="F3">Fig. 3a-b</xref>). For example, in the 11th iteration containing 47,819 sequences, online IQ-TREE 2 produces a tree with a parsimony score of 32,005, whereas <italic>de novo</italic> IQ-TREE 2 produces a tree with parsimony score 32,149. Our results suggest that in addition to the computational savings that allow online phylogenetics approaches to continuously stay up-to-date, online phylogenetics approaches also produce trees with similar parsimony scores and likelihoods to their <italic>de novo</italic> counterparts.</p></sec><sec id="S6"><title>Under pandemic time constraints, parsimony-based optimization methods have favorable metrics compared to ML methods for SARS-CoV-2 phylogenies</title><p id="P18">In the case of both <italic>de novo</italic> and online phylogenetics, the parsimony-based matOptimize outperforms both FastTree 2 and IQ-TREE 2 in runtime and peak memory usage. For the sixth iteration (26,486 samples), which was the largest phylogeny inferred by all online methods in under 24 hours and using under 200 GB of RAM, online FastTree 2 required nearly 24 hours and 30.3 GB of RAM, and online IQ-TREE 2 required 1 hour 45 minutes and 72 GB of RAM. By contrast, matOptimize used only 6 seconds and 0.15 GB of RAM. This iteration contained roughly 10% as many samples as the 50th and final iteration (233,326 total samples), which online matOptimize completed in 32 seconds using 1.41 GB of RAM at peak usage. Even this largest tree represents only a very small fraction of the more than 10 million currently available SARS-CoV-2 genomes, indicating that, among the approaches we evaluated, matOptimize is the only viable option for maintaining a comprehensive SARS-CoV-2 phylogeny via online phylogenetics.</p><p id="P19">In addition to its scalability, matOptimize outperforms ML optimization methods under 24-hour time constraints in both the parsimony and likelihood scores of the trees that it infers. For the sixth iteration (26,486 samples), we found parsimony scores of 16,130, 16,179, and 16,290 for online matOptimize, IQ-TREE 2, and FastTree 2 respectively. While all methods produce phylogenies with parsimony scores within 1% of each other, matOptimize is consistently the lowest. However, matOptimize was developed to optimize by parsimony, while the other methods were developed for ML optimizations. Unexpectedly, we found log-likelihood scores of -233,414.277, -233,945.528, and -235,177.396 for matOptimize, IQ-TREE 2, and FastTree 2 respectively, indicating that matOptimize produces preferable phylogenies based on likelihood as well. We used a Jukes-Cantor (JC) model to calculate likelihoods due to time constraints in calculation for more complex substitution models, but a Generalised Time Reversible (GTR) model with specified rate parameters produced strongly correlated likelihoods (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). Specifically, we fit a generalized linear model using a Gamma family (inverse link function) to predict the likelihood of the tree under the JC model using the iteration of tree construction and the GTR likelihood as predictors. We examined the six trees from the first and second iteration (12 in total). We found that the GTR likelihood was significantly correlated with the JC likelihood (p &lt; 2.27 × 10<sup>-5</sup>).</p></sec><sec id="S7"><title>Parsimony optimization produces comparable or more favorable SARS-CoV-2 trees than the most thorough maximum likelihood methods</title><p id="P20">We also compared the performance of <italic>de novo</italic> inference with UShER+matOptimize to state-of-the-art methods without a 24-hour limit on runtime. In three iterations of increasing size (~4.5k, ~8.9k, and ~13.2k samples), we inferred trees from real and simulated data using UShER+matOptimize, IQ-TREE 2 with stochastic search enabled, and RAxML-NG. With the parameters used here, IQ-TREE 2 performs stochastic NNI moves in addition to hill-climbing NNI. RAxML-NG is a maximum likelihood approach that uses SPR moves to search tree-space for higher likelihood phylogenies (<xref ref-type="bibr" rid="R24">Kozlov et al. 2019</xref>). We allowed each experiment to run for up to two weeks. All programs completed successfully on the first iteration. RAxML-NG did not terminate within two weeks for the second and third iterations. On real data, we found that UShER+matOptimize produced trees with higher log-likelihoods than IQ-TREE 2 and RAxML-NG across all three iterations (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). Under the substitution model parameters estimated by IQ-TREE 2, the log-likelihoods for the first iteration were -73780.756, -73828.271, and -73782.289 for UShER+matOptimize, IQ-TREE 2, and RAxML-NG respectively. Under the parameters estimated by RAxML-NG, the log-likelihoods for the first iteration were -73754.894, -73801.935, and -73756.246 for UShER+matOptimize, IQ-TREE 2, and RAxML-NG respectively. On simulated data, UShER+matOptimize produced trees closer to the ground truth than the other methods when measured by quartet distance across all three iterations (<xref ref-type="fig" rid="F4">Fig. 4B</xref>). By RF distance, the UShER+matOptimize trees were closest to the ground truth for the second and third iterations, but the RAxML-NG tree was closest to ground truth in the first iteration (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). We therefore conclude that parsimony-based tree inference can perform equivalently or better than state of the art maximum likelihood approaches but do this in a tiny fraction of the time, making it by far the most suitable approach for pandemic-scale phylogenetics of SARS-CoV-2.</p></sec><sec id="S8"><title>Parsimony and likelihood are strongly correlated when optimizing large SARS-CoV-2 phylogenies</title><p id="P21">While our comparisons of online and <italic>de novo</italic> as well as parsimony-based and ML optimizations of cumulative pandemic-style data demonstrated practical performance, the largest trees completed by all methods in these experiments represent only a small fraction of available SARS-CoV-2 data. It is also crucial that we identify the optimal ways to produce a large phylogeny from already aggregated data. We therefore evaluated phylogenetic inference methods for optimizing a tree of 364,427 SARS-CoV-2 genome sequences, without constraining methods according to time or memory requirements. We optimized this global phylogeny using matOptimize (<xref ref-type="bibr" rid="R61">Ye et al. 2022</xref>), IQ-TREE 2 (<xref ref-type="bibr" rid="R33">Minh et al. 2020</xref>), and FastTree 2 (<xref ref-type="bibr" rid="R40">Price et al. 2010</xref>). Overall, we found that matOptimize produced the tree with the lowest parsimony score across all methods in roughly one hour (<xref ref-type="table" rid="T1">Table 1</xref>).</p><p id="P22">We found that after each of the six iterations of FastTree 2 optimization, the likelihood and parsimony improvements are strongly linearly correlated (<xref ref-type="fig" rid="F5">Fig. 5</xref>). This suggests that changes achieved by maximizing parsimony will also optimize likelihood for SARS-CoV-2 data. That is, for extremely densely sampled phylogenies wherein long branches are especially rare, parsimony and likelihood of phylogenies, and tree moves to optimize either are highly correlated. However, despite the strength of this correlation, we find an extreme disparity in practical usage when optimizing by either metric. Parsimony-based methods are far more time- and data-efficient, and presently available ML approaches quickly become prohibitively expensive. For example, while the 6 iterations of FastTree did result in large improvements in both likelihood and parsimony score, the resulting tree would be out of date long before the 10.5-day optimization had completed. Moreover, we applied matOptimize to the tree output by the sixth iteration of FastTree, achieving a parsimony score of 293,866 (improvement of 288) in just 16 minutes, indicating that even after 10.5 days, additional optimization was still possible. This suggests that, for the purposes of optimizing even moderately large SARS-CoV-2 trees, parsimony-based methods should be heavily favored due to their increased efficiency.</p></sec></sec><sec id="S9" sec-type="conclusions"><title>Conclusions</title><p id="P23">The SARS-CoV-2 pandemic has made phylogenetics central to efforts to combat the spread of the virus, but has posed challenges for many commonly used phylogenetics frameworks. A major component of this effort relies on a comprehensive, up-to-date, global phylogeny of SARS-CoV-2 genomes. However, the scale and continuous growth of the data have caused difficulties for standard <italic>de novo</italic> phylogenetic methods. Here, we find that online phylogenetics methods are practical, pragmatic, and accurate for inferring daily phylogenetic trees from a large and densely-sample virus outbreak.</p><p id="P24">One counterintuitive result is that parsimony-based optimizations outperform sufficiently efficient ML approaches regardless of whether phylogenies are evaluated using parsimony or likelihood. This might be a consequence of the fact that parsimony scores and likelihoods are strongly correlated across phylogenies inferred via a range of phylogenetic approaches. The extremely short branches (<xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>) on SARS-CoV-2 phylogenies mean that the probability of multiple mutations occurring at the same site on a single branch is negligible. Stated another way, SARS-CoV-2 is approaching a “limit” where parsimony and likelihood are nearly equivalent. In turn, because of their relative efficiency, parsimony-based methods are able to search more of the possible tree space in the same amount of time, thereby resulting in trees with better likelihoods and lower parsimony scores than trees optimized using currently-available ML software packages. We emphasize that this does not bear on the relative merits of the underlying principles of ML and MP, but instead reflects the utility of methods that have been applied during the pandemic. Nevertheless, this observation does suggest that in some cases, MP optimization may provide a fast and accurate starting point for ML optimization methods. Indeed, many popular phylogenetics software, such as RAxML (<xref ref-type="bibr" rid="R48">Stamatakis 2014</xref>) and IQ-TREE (<xref ref-type="bibr" rid="R33">Minh et al. 2020</xref>) already use stepwise-addition parsimony trees as initial trees for their optimization. Our results suggest that further optimization of these initial trees using MP may provide benefits in speed <italic>and</italic> accuracy for some datasets, even when the target is an estimate of the ML tree.</p><p id="P25">As sequencing technologies progress and become more readily available, sample sizes for phylogenetic analyses of major pathogens and highly-studied organisms will necessarily continue to increase. Today, SARS-CoV-2 represents an extreme with respect to the total number of samples relative to the very short branch lengths on the phylogeny. However, the global sequencing effort during the pandemic suggests that the public health sphere has a strong interest in the increased application of whole-genome sequencing to study the genomic contents, evolution, and transmission history of major and emerging human pathogens. We expect that million-sample datasets will become commonplace in the near future. Parsimony-based methods like matOptimize show promise for huge datasets with short branch lengths. Similarly, recently developed parsimony-based likelihood approximations may ultimately be similarly scalable and accurate (<xref ref-type="bibr" rid="R7">De Maio et al. 2022</xref>). Online phylogenetics using both of these methods will be a fruitful avenue for future development and application to accommodate these datasets.</p></sec><sec id="S10" sec-type="methods"><title>Methods</title><p id="P26">We first developed a “global phylogeny", from which all analyses in this study were performed. We began by downloading VCF and FASTA files corresponding to March 18, 2021 from our own daily-updated database (<xref ref-type="bibr" rid="R31">McBroome et al. 2021</xref>). The VCF file contains pairwise alignments of each of the 434,063 samples to the SARS-CoV-2 reference genome. We then implemented filters, retaining only sequences containing at least 28,000 non-N nucleotides, and fewer than two non-[ACGTN-] characters. We used UShER to create a phylogeny from scratch using only the remaining 366,492 samples. To remove potentially erroneous sequences, we iteratively pruned this tree of highly divergent internal branches with branch parsimony scores greater than 30, then terminal branches with branch parsimony scores greater than 6, until convergence, resulting in a final global phylogeny containing 364,427 samples. The branch parsimony score indicates the total number of substitutions along a branch. Similar filters based on sequence divergence are used by existing SARS-CoV-2 phylogenetic inference methods. For full reproducibility, files used for creating the global phylogeny can be found in subrepository 1 on the project GitHub page (<xref ref-type="bibr" rid="R54">Thornlow et al. 2021b</xref>).</p><p id="P27">Following this, we tested several optimization strategies on this global phylogeny, hereafter the “starting tree". We used matOptimize, FastTree 2, and maximum parsimony (MP) IQ-TREE 2. MP IQ-TREE 2 uses parsimony as the optimality criterion in contrast to the maximum likelihood mode used in all other experiments, which was infeasible on a dataset of this size. In these optimization experiments, we used experimental versions of MP IQ-TREE 2 that allow finer control of parsimony parameters (specific versions are listed in the supplemental Github repository). In one experiment, we used the starting tree and its corresponding alignment and ran five iterations of MP IQ-TREE 2, varying the SPR radius from 20 to 100 in increments of 20. Experiments on a small dataset indicated that there is little or no improvement in parsimony score beyond a radius of 100. Separately, we tested another strategy that applied two iterations of MP IQ-TREE 2 to the starting tree, the first iteration using an SPR radius of 20 and the second using a radius of 100. Finally, we tested a strategy of six iterations of pseudo-likelihood optimization with FastTree 2 followed by two iterations of parsimony optimization with matOptimize. The tree produced by this strategy, hereafter the “ground truth” tree, had the highest likelihood of all the strategies we tested. This tree (after_usher_optimized_fasttree_iter6.tree) and files for these optimization experiments can be found in subrepository 2.</p><p id="P28">In the multifurcating ground truth tree of 364,427 samples, there are 265,289 unique (in FASTA sequence) samples. There are 447,643 nodes in the tree. For reference, a full binary tree with the same number of leaves has 728,853 nodes. 23,437 of the 29,903 sites in the alignment are polymorphic (they display at least two non-ambiguous nucleotides). Homoplasies are common in these data. In the starting tree, 19,090 sites display a mutation occurring on at least two different branches, and 4,976 sites display a mutation occurring more than ten times in the tree.</p><p id="P29">To mimic pandemic-style phylogenetics, we separated a total of 233,326 samples from the starting tree of 364,427 samples into 50 batches of ~5,000 by sorting according to the date of sample collection. We then set up two frameworks for each of the three software packages (matOptimize (commit 66ca5ff, conda version 0.4.8), maximum-likelihood IQ-TREE 2 (multicore version 2.1.3 COVID-edition), and FastTree 2 (Double Precision version 2.1.10)). The online phylogenetics frameworks began by using UShER to infer a small tree <italic>de novo</italic> from the first batch of samples, followed by alternating steps of optimization using one of the three evaluated methods and placement of additional samples with UShER. In <italic>de novo</italic> phylogenetics, we supplied each software package with an alignment corresponding to all samples in that batch and its predecessors (or VCF for matOptimize) without a guide tree. For both cases, each tree is larger than its predecessor by ~5,000 samples, and each tree necessarily contains all samples in the immediately preceding tree. For FastTree 2, we used 2 rounds of subtree-prune-regraft (SPR) moves (-spr 2), maximum SPR length of 1000 (-sprlength 1000), zero rounds of minimum evolution nearest neighbor interchanges (-nni 0), and the Generalised Time Reversible + Gamma (GTR+G) substitution model (-gtr -gamma). For IQ-TREE 2, we used a branch length minimum of 0.000000001 (-blmin 1e-9), zero rounds of stochastic tree search (-n 0), and the GTR+G substitution model (-m GTR+G). With these parameters, IQ-TREE 2 constructs a starting parsimony tree and then performs hill-climbing NNI steps to optimize likelihood, avoiding the significant time overhead of stochastic search. We ran all matOptimize analyses using an instance with 15 CPUs and 117.2 GB of RAM, and we ran all IQ-TREE 2 and FastTree 2 analyses on an instance with 31 CPUs and 244.1 GB of RAM, but we limited each command to 15 threads for equivalence with matOptimize. Files for all simulated data experiments can be found in subrepository 3.</p><p id="P30">To generate our simulated data, we used the SARS-CoV-2 reference genome (GISAID ID: EPI_ISL_402125; GenBank ID: MN908947.3) (<xref ref-type="bibr" rid="R46">Shu and McCauley 2017</xref>; <xref ref-type="bibr" rid="R45">Sayers et al. 2021</xref>) as the root sequence and used phastSim (<xref ref-type="bibr" rid="R9">De Maio et al. 2021b</xref>) to simulate according to the ground truth phylogeny described above. Intergenic regions were evolved using phastSim using the default neutral mutation rates estimated in ref. (<xref ref-type="bibr" rid="R8">De Maio et al. 2021a</xref>), with position-specific mean mutation rates sampled from a gamma distribution with alpha=beta=4, and with 1% of the genome having a 10-fold increase mutation rate for one specific mutation type (SARS-CoV-2 hypermutability model described in ref. (<xref ref-type="bibr" rid="R9">De Maio et al. 2021b</xref>)). Evolution of coding regions was simulated with the same neutral mutational distribution, with a mean nonsynonymous/synonymous rate ratio of omega=0.48 as estimated in (<xref ref-type="bibr" rid="R56">Turakhia et al. 2021a</xref>),with codon-specific omega values sampled from a gamma distribution with alpha=0.96 and beta=2. Rates for each intergenic and coding region were not normalized in order to have the same baseline neutral mutation rate distribution across the genome.</p><p id="P31">We repeated our iterative experiments using <italic>de novo</italic> and online matOptimize, IQ-TREE 2 and FastTree 2 on this simulated alignment, using the same strategies as before. However, instead of computing parsimony and likelihood scores, we computed the Robinson-Foulds (RF) distance (<xref ref-type="bibr" rid="R42">Robinson and Foulds 1981</xref>) of each optimization to the ground truth tree, pruned to contain only the samples belonging to that batch. To calculate each RF distance, we used the -O (collapse tree) argument in matUtils extract (<xref ref-type="bibr" rid="R31">McBroome et al. 2021</xref>) and then used the dist.topo command in the <italic>ape</italic> package in R (<xref ref-type="bibr" rid="R35">Paradis and Schliep 2019</xref>), comparing the collapsed optimized tree and the pruned, collapsed ground truth tree at each iteration. We computed normalized RF distances as a proportion of the total possible RF distance, which is equivalent to two times the number of samples in the trees minus six (<xref ref-type="bibr" rid="R49">Steel and Penny 1993</xref>).</p><p id="P32">Eliminating the 24-hour runtime restriction, we also repeated the first three <italic>de novo</italic> iterative experiments on both real and simulated data to compare UShER+matOptimize, IQ-TREE 2 with stochastic search, and RAxML-NG. These iterations of ~4.5k, ~8.9k, and ~13.2k samples were allowed to run for up to 14 days. For runs that did not terminate within this time (the second and third iterations of RAxML-NG), we used the best tree inferred during the run for comparisons. We ran IQ-TREE 2 and RAxML-NG under the GTR+G model with the smallest minimum branch length parameter that did not cause numerical errors. To compare the trees inferred from real data, we computed log-likelihoods under the GTR+G model for all trees, fixing the model parameters to those estimated by IQ-TREE 2 during tree inference. We also compared the log-likelihoods of the trees under the parameters estimated by RAxML-NG for the first iteration, but could not do so for the second and third iterations which did not terminate in under two weeks. We allowed optimization of branch lengths during likelihood calculation. For the UShER+matOptimize trees, before computing likelihoods, we converted the branch lengths into units of substitutions per site by dividing each branch length by the alignment length (29,903). To compare the trees inferred from simulated data, we computed the RF and quartet distances of each tree to the corresponding ground truth tree described above.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="EMS141072-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S11"><title>Acknowledgements</title><p>We gratefully acknowledge the authors from the originating laboratories responsible for obtaining each sample, as well as the submitting laboratories where the genome data were generated and shared, on which this research is based.</p><sec id="S12"><title>Funding</title><p>This work was supported by National Institutes of Health (R35GM128932 to R.C.D., T32HG008345 (B.T. and J.M.), F31HG010584 to B.T.), Alfred P. Sloan Foundation fellowship, University of California Office of the President Emergency COVID-19 Research Seed Funding (R00RG2456 to R.C.-D.), European Molecular Biology Laboratory (to N.D.M.), Australian Research Council (DP200103151 to R.L.), Chan-Zuckerberg Initiative grant (to R.L.), and by Eric and Wendy Schmidt by recommendation of the Schmidt Futures program.</p></sec></ack><fn-group><fn id="FN1" fn-type="conflict"><p id="P33"><bold>Competing interests</bold></p><p id="P34">R.L. worked as an advisor to GISAID from mid 2020 to late 2021. The remaining authors declare no competing interests.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annavajhala</surname><given-names>MK</given-names></name><name><surname>Mohri</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Nair</surname><given-names>M</given-names></name><name><surname>Zucker</surname><given-names>JE</given-names></name><name><surname>Sheng</surname><given-names>Z</given-names></name><name><surname>Gomez-Simmonds</surname><given-names>A</given-names></name><name><surname>Kelley</surname><given-names>AL</given-names></name><name><surname>Tagliavia</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><etal/></person-group><article-title>A Novel and Expanding SARS-CoV-2 Variant, B.1.526, Identified in New York</article-title><source>medRxiv</source><year>2021</year></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barbera</surname><given-names>P</given-names></name><name><surname>Kozlov</surname><given-names>AM</given-names></name><name><surname>Czech</surname><given-names>L</given-names></name><name><surname>Morel</surname><given-names>B</given-names></name><name><surname>Darriba</surname><given-names>D</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>EPA-ng: Massively Parallel Evolutionary Placement of Genetic Sequences</article-title><source>Syst Biol</source><year>2019</year><volume>68</volume><fpage>365</fpage><lpage>369</lpage></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>SA</given-names></name><name><surname>Krompass</surname><given-names>D</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>Performance, accuracy, and Web server for evolutionary placement of short sequence reads under maximum likelihood</article-title><source>Syst Biol</source><year>2011</year><volume>60</volume><fpage>291</fpage><lpage>302</lpage></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bluhm</surname><given-names>A</given-names></name><name><surname>Christandl</surname><given-names>M</given-names></name><name><surname>Gesmundo</surname><given-names>F</given-names></name><name><surname>Klausen</surname><given-names>FR</given-names></name><name><surname>Mančinska</surname><given-names>L</given-names></name><name><surname>Steffan</surname><given-names>V</given-names></name><name><surname>França</surname><given-names>DS</given-names></name><name><surname>Werner</surname><given-names>AH</given-names></name></person-group><article-title>SARS-CoV-2 transmission routes from genetic data: A Danish case study</article-title><source>PLOS ONE</source><year>2020</year><volume>15</volume><elocation-id>e0241405</elocation-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castillo</surname><given-names>AE</given-names></name><name><surname>Parra</surname><given-names>B</given-names></name><name><surname>Tapia</surname><given-names>P</given-names></name><name><surname>Acevedo</surname><given-names>A</given-names></name><name><surname>Lagos</surname><given-names>J</given-names></name><name><surname>Andrade</surname><given-names>W</given-names></name><name><surname>Arata</surname><given-names>L</given-names></name><name><surname>Leal</surname><given-names>G</given-names></name><name><surname>Barra</surname><given-names>G</given-names></name><name><surname>Tambley</surname><given-names>C</given-names></name><name><surname>Tognarelli</surname><given-names>J</given-names></name><etal/></person-group><article-title>Phylogenetic analysis of the first four SARS-CoV-2 cases in Chile</article-title><source>J Med Virol</source><year>2020</year><volume>92</volume><fpage>1562</fpage><lpage>1566</lpage></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><collab>COVID-19 Genomics UK (COG-UK) Consortium</collab><article-title>An integrated national scale SARS-CoV-2 genomic surveillance network</article-title><source>Lancet Microbe</source><year>2020</year><volume>1</volume><fpage>e99</fpage><lpage>e100</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Kalaghatgi</surname><given-names>P</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Maximum likelihood pandemic-scale phylogenetics</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.03.22.485312</elocation-id></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Walker</surname><given-names>CR</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Mutation Rates and Selection on Synonymous Mutations in SARS-CoV-2</article-title><source>Genome Biol Evol</source><year>2021a</year><volume>13</volume></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Weilguny</surname><given-names>L</given-names></name><name><surname>Walker</surname><given-names>CR</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>phastSim: efficient simulation of sequence evolution for pandemic-scale datasets</article-title><source>bioRxiv</source><year>2021b</year></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>X</given-names></name><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>Federman</surname><given-names>S</given-names></name><name><surname>du Plessis</surname><given-names>L</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Faria</surname><given-names>NR</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Bushnell</surname><given-names>B</given-names></name><name><surname>Pan</surname><given-names>C-Y</given-names></name><name><surname>Guevara</surname><given-names>H</given-names></name><etal/></person-group><article-title>Genomic surveillance reveals multiple introductions of SARS-CoV-2 into Northern California</article-title><source>Science</source><year>2020</year><volume>369</volume><fpage>582</fpage><lpage>587</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Cases in which Parsimony or Compatibility Methods will be Positively Misleading</article-title><source>Syst Biol</source><year>1978</year><volume>27</volume><fpage>401</fpage><lpage>410</lpage></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fourment</surname><given-names>M</given-names></name><name><surname>Claywell</surname><given-names>BC</given-names></name><name><surname>Dinh</surname><given-names>V</given-names></name><name><surname>McCoy</surname><given-names>C</given-names></name><name><surname>Matsen</surname><given-names>FA</given-names><suffix>Iv</suffix></name><name><surname>Darling</surname><given-names>AE</given-names></name></person-group><article-title>Effective Online Bayesian Phylogenetics via Sequential Monte Carlo with Guided Proposals</article-title><source>Syst Biol</source><year>2018</year><volume>67</volume><fpage>490</fpage><lpage>502</lpage></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franceschi</surname><given-names>VB</given-names></name><name><surname>Caldana</surname><given-names>GD</given-names></name><name><surname>de Menezes Mayer</surname><given-names>A</given-names></name><name><surname>Cybis</surname><given-names>GB</given-names></name><name><surname>Neves</surname><given-names>CAM</given-names></name><name><surname>Ferrareze</surname><given-names>PAG</given-names></name><name><surname>Demoliner</surname><given-names>M</given-names></name><name><surname>de Almeida</surname><given-names>PR</given-names></name><name><surname>Gularte</surname><given-names>JS</given-names></name><name><surname>Hansen</surname><given-names>AW</given-names></name><name><surname>Weber</surname><given-names>MN</given-names></name><etal/></person-group><article-title>Genomic epidemiology of SARS-CoV-2 in Esteio, Rio Grande do Sul, Brazil</article-title><source>BMC Genomics</source><year>2021</year><volume>22</volume><fpage>371</fpage></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gill</surname><given-names>MS</given-names></name><name><surname>Lemey</surname><given-names>P</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Baele</surname><given-names>G</given-names></name></person-group><article-title>Online Bayesian Phylodynamic Inference in BEAST with Application to Epidemic Reconstruction</article-title><source>Mol Biol Evol</source><year>2020</year><volume>37</volume><fpage>1832</fpage><lpage>1842</lpage></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzalez-Reiche</surname><given-names>AS</given-names></name><name><surname>Hernandez</surname><given-names>MM</given-names></name><name><surname>Sullivan</surname><given-names>MJ</given-names></name><name><surname>Ciferri</surname><given-names>B</given-names></name><name><surname>Alshammary</surname><given-names>H</given-names></name><name><surname>Obla</surname><given-names>A</given-names></name><name><surname>Fabre</surname><given-names>S</given-names></name><name><surname>Kleiner</surname><given-names>G</given-names></name><name><surname>Polanco</surname><given-names>J</given-names></name><name><surname>Khan</surname><given-names>Z</given-names></name><name><surname>Alburquerque</surname><given-names>B</given-names></name><etal/></person-group><article-title>Introductions and early spread of SARS-CoV-2 in the New York City area</article-title><source>Science</source><year>2020</year><volume>369</volume><fpage>297</fpage><lpage>301</lpage></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadfield</surname><given-names>J</given-names></name><name><surname>Megill</surname><given-names>C</given-names></name><name><surname>Bell</surname><given-names>SM</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Potter</surname><given-names>B</given-names></name><name><surname>Callender</surname><given-names>C</given-names></name><name><surname>Sagulenko</surname><given-names>P</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><article-title>Nextstrain: real-time tracking of pathogen evolution</article-title><source>Bioinformatics</source><year>2018</year><volume>34</volume><fpage>4121</fpage><lpage>4123</lpage></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hendy</surname><given-names>MD</given-names></name><name><surname>Penny</surname><given-names>D</given-names></name></person-group><article-title>A Framework for the Quantitative Study of Evolutionary Trees</article-title><source>Syst Biol</source><year>1989</year><volume>38</volume><fpage>297</fpage><lpage>309</lpage></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hug</surname><given-names>LA</given-names></name><name><surname>Baker</surname><given-names>BJ</given-names></name><name><surname>Anantharaman</surname><given-names>K</given-names></name><name><surname>Brown</surname><given-names>CT</given-names></name><name><surname>Probst</surname><given-names>AJ</given-names></name><name><surname>Castelle</surname><given-names>CJ</given-names></name><name><surname>Butterfield</surname><given-names>CN</given-names></name><name><surname>Hernsdorf</surname><given-names>AW</given-names></name><name><surname>Amano</surname><given-names>Y</given-names></name><name><surname>Ise</surname><given-names>K</given-names></name><name><surname>Suzuki</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A new view of the tree of life</article-title><source>Nat Microbiol</source><year>2016</year><volume>1</volume><fpage>16048</fpage></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izquierdo-Carrasco</surname><given-names>F</given-names></name><name><surname>Cazes</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>SA</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>PUmPER: phylogenies updated perpetually</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>1476</fpage><lpage>1477</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>B</given-names></name><name><surname>Boni</surname><given-names>MF</given-names></name><name><surname>Bull</surname><given-names>MJ</given-names></name><name><surname>Colleran</surname><given-names>A</given-names></name><name><surname>Colquhoun</surname><given-names>RM</given-names></name><name><surname>Darby</surname><given-names>AC</given-names></name><name><surname>Haldenby</surname><given-names>S</given-names></name><name><surname>Hill</surname><given-names>V</given-names></name><name><surname>Lucaci</surname><given-names>A</given-names></name><name><surname>McCrone</surname><given-names>JT</given-names></name><name><surname>Nicholls</surname><given-names>SM</given-names></name><etal/></person-group><article-title>Generation and transmission of interlineage recombinants in the SARS-CoV-2 pandemic</article-title><source>Cell</source><year>2021</year><volume>184</volume><fpage>5179</fpage><lpage>5188</lpage><elocation-id>e8</elocation-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalantar</surname><given-names>KL</given-names></name><name><surname>Carvalho</surname><given-names>T</given-names></name><name><surname>de Bourcy</surname><given-names>CFA</given-names></name><name><surname>Dimitrov</surname><given-names>B</given-names></name><name><surname>Dingle</surname><given-names>G</given-names></name><name><surname>Egger</surname><given-names>R</given-names></name><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Holmes</surname><given-names>OB</given-names></name><name><surname>Juan</surname><given-names>Y-F</given-names></name><name><surname>King</surname><given-names>R</given-names></name><name><surname>Kislyuk</surname><given-names>A</given-names></name><etal/></person-group><article-title>IDseq—An open source cloud-based pipeline and analysis service for metagenomic pathogen detection and monitoring</article-title><source>Gigascience</source><year>2020</year><volume>9</volume></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>A</given-names></name><name><surname>Zia</surname><given-names>T</given-names></name><name><surname>Suleman</surname><given-names>M</given-names></name><name><surname>Khan</surname><given-names>T</given-names></name><name><surname>Ali</surname><given-names>SS</given-names></name><name><surname>Abbasi</surname><given-names>AA</given-names></name><name><surname>Mohammad</surname><given-names>A</given-names></name><name><surname>Wei</surname><given-names>D-Q</given-names></name></person-group><article-title>Higher infectivity of the SARS-CoV-2 new variants is associated with K417N/T, E484K, and N501Y mutants: An insight from structural data</article-title><source>J Cell Physiol</source><year>2021</year><volume>236</volume><fpage>7045</fpage><lpage>7057</lpage></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolaczkowski</surname><given-names>B</given-names></name><name><surname>Thornton</surname><given-names>JW</given-names></name></person-group><article-title>Performance of maximum parsimony and likelihood phylogenetics when evolution is heterogeneous</article-title><source>Nature</source><year>2004</year><volume>431</volume><fpage>980</fpage><lpage>984</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozlov</surname><given-names>AM</given-names></name><name><surname>Darriba</surname><given-names>D</given-names></name><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Morel</surname><given-names>B</given-names></name><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>RAxML-NG: a fast, scalable and user-friendly tool for maximum likelihood phylogenetic inference</article-title><source>Bioinformatics</source><year>2019</year><volume>35</volume><fpage>4453</fpage><lpage>4455</lpage></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lam</surname><given-names>TT-Y</given-names></name></person-group><article-title>Tracking the Genomic Footprints of SARS-CoV-2 Transmission</article-title><source>Trends Genet</source><year>2020</year><volume>36</volume><fpage>544</fpage><lpage>546</lpage></element-citation></ref><ref id="R26"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Mansfield</surname><given-names>R</given-names></name></person-group><article-title>roblanf/sarscov2phylo: 13-11-20</article-title><year>2020</year></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Giorgi</surname><given-names>EE</given-names></name><name><surname>Marichannegowda</surname><given-names>MH</given-names></name><name><surname>Foley</surname><given-names>B</given-names></name><name><surname>Xiao</surname><given-names>C</given-names></name><name><surname>Kong</surname><given-names>X-P</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Gnanakaran</surname><given-names>S</given-names></name><name><surname>Korber</surname><given-names>B</given-names></name><name><surname>Gao</surname><given-names>F</given-names></name></person-group><article-title>Emergence of SARS-CoV-2 through recombination and strong purifying selection</article-title><source>Sci Adv</source><year>2020</year><volume>6</volume></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>du Plessis</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Hill</surname><given-names>V</given-names></name><name><surname>Kang</surname><given-names>M</given-names></name><name><surname>Lin</surname><given-names>H</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name><name><surname>François</surname><given-names>S</given-names></name><name><surname>Kraemer</surname><given-names>MUG</given-names></name><name><surname>Faria</surname><given-names>NR</given-names></name><name><surname>McCrone</surname><given-names>JT</given-names></name><etal/></person-group><article-title>Genomic Epidemiology of SARS-CoV-2 in Guangdong Province, China</article-title><source>Cell</source><year>2020a</year><volume>181</volume><fpage>997</fpage><lpage>1003</lpage><elocation-id>e9</elocation-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>R</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Niu</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Song</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>N</given-names></name><name><surname>Bi</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Genomic characterisation and epidemiology of 2019 novel coronavirus: implications for virus origins and receptor binding</article-title><source>Lancet</source><year>2020b</year><volume>395</volume><fpage>565</fpage><lpage>574</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsen</surname><given-names>FA</given-names></name><name><surname>Kodner</surname><given-names>RB</given-names></name><name><surname>Armbrust</surname><given-names>EV</given-names></name></person-group><article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title><source>BMC Bioinformatics</source><year>2010</year><volume>11</volume><fpage>538</fpage></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Kramer</surname><given-names>A</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name></person-group><article-title>A Daily-Updated Database and Tools for Comprehensive SARS-CoV-2 Mutation-Annotated Trees</article-title><source>Mol Biol Evol</source><year>2021</year><volume>38</volume><fpage>5819</fpage><lpage>5824</lpage></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meredith</surname><given-names>LW</given-names></name><name><surname>Hamilton</surname><given-names>WL</given-names></name><name><surname>Warne</surname><given-names>B</given-names></name><name><surname>Houldcroft</surname><given-names>CJ</given-names></name><name><surname>Hosmillo</surname><given-names>M</given-names></name><name><surname>Jahun</surname><given-names>AS</given-names></name><name><surname>Curran</surname><given-names>MD</given-names></name><name><surname>Parmar</surname><given-names>S</given-names></name><name><surname>Caller</surname><given-names>LG</given-names></name><name><surname>Caddy</surname><given-names>SL</given-names></name><name><surname>Khokhar</surname><given-names>FA</given-names></name><etal/></person-group><article-title>Rapid implementation of SARS-CoV-2 sequencing to investigate cases of health-care associated COVID-19: a prospective genomic surveillance study</article-title><source>Lancet Infect Dis</source><year>2020</year><volume>20</volume><fpage>1263</fpage><lpage>1271</lpage></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>Schmidt</surname><given-names>HA</given-names></name><name><surname>Chernomor</surname><given-names>O</given-names></name><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Woodhams</surname><given-names>MD</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name></person-group><article-title>IQ-TREE 2: New Models and Efficient Methods for Phylogenetic Inference in the Genomic Era</article-title><source>Mol Biol Evol</source><year>2020</year><volume>37</volume><fpage>1530</fpage><lpage>1534</lpage></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreno</surname><given-names>GK</given-names></name><name><surname>Braun</surname><given-names>KM</given-names></name><name><surname>Riemersma</surname><given-names>KK</given-names></name><name><surname>Martin</surname><given-names>MA</given-names></name><name><surname>Halfmann</surname><given-names>PJ</given-names></name><name><surname>Crooks</surname><given-names>CM</given-names></name><name><surname>Prall</surname><given-names>T</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name><name><surname>Baczenas</surname><given-names>JJ</given-names></name><name><surname>Heffron</surname><given-names>AS</given-names></name><name><surname>Ramuta</surname><given-names>M</given-names></name><etal/></person-group><article-title>Revealing fine-scale spatiotemporal differences in SARS-CoV-2 introduction and spread</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>5558</elocation-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paradis</surname><given-names>E</given-names></name><name><surname>Schliep</surname><given-names>K</given-names></name></person-group><article-title>ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title><source>Bioinformatics</source><year>2019</year></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>AK</given-names></name><name><surname>Kim</surname><given-names>I-H</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>J-M</given-names></name><name><surname>Kim</surname><given-names>HM</given-names></name><name><surname>Lee</surname><given-names>CY</given-names></name><name><surname>Han</surname><given-names>M-G</given-names></name><name><surname>Rhie</surname><given-names>G-E</given-names></name><name><surname>Kwon</surname><given-names>D</given-names></name><name><surname>Nam</surname><given-names>J-G</given-names></name><name><surname>Park</surname><given-names>Y-J</given-names></name><etal/></person-group><article-title>Genomic Surveillance of SARS-CoV-2: Distribution of Clades in the Republic of Korea in 2020</article-title><source>Osong Public Health Res Perspect</source><year>2021</year><volume>12</volume><fpage>37</fpage><lpage>43</lpage></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Chuvochina</surname><given-names>M</given-names></name><name><surname>Waite</surname><given-names>DW</given-names></name><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Skarshewski</surname><given-names>A</given-names></name><name><surname>Chaumeil</surname><given-names>P-A</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name></person-group><article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title><source>Nat Biotechnol</source><year>2018</year><volume>36</volume><fpage>996</fpage><lpage>1004</lpage></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>IDseq Team</collab><name><surname>Peng</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Mann</surname><given-names>SA</given-names></name><name><surname>Mitchell</surname><given-names>AM</given-names></name><name><surname>Laurie</surname><given-names>MT</given-names></name><name><surname>Sunshine</surname><given-names>S</given-names></name><name><surname>Pilarowski</surname><given-names>G</given-names></name><name><surname>Ayscue</surname><given-names>P</given-names></name><name><surname>Kistler</surname><given-names>A</given-names></name><name><surname>Vanaerschot</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>LM</given-names></name><etal/></person-group><article-title>Estimation of secondary household attack rates for emergent spike L452R SARS-CoV-2 variants detected by genomic surveillance at a community-based testing site in San Francisco</article-title><source>Clin Infect Dis</source><year>2021</year></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Philippe</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Brinkmann</surname><given-names>H</given-names></name><name><surname>Rodrigue</surname><given-names>N</given-names></name><name><surname>Delsuc</surname><given-names>F</given-names></name></person-group><article-title>Heterotachy and long-branch attraction in phylogenetics</article-title><source>BMC Evol Biol</source><year>2005</year><volume>5</volume><fpage>50</fpage></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Dehal</surname><given-names>PS</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name></person-group><article-title>FastTree 2--approximately maximum-likelihood trees for large alignments</article-title><source>PLoS One</source><year>2010</year><volume>5</volume><elocation-id>e9490</elocation-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Holmes</surname><given-names>EC</given-names></name><name><surname>O’Toole</surname><given-names>Á</given-names></name><name><surname>Hill</surname><given-names>V</given-names></name><name><surname>McCrone</surname><given-names>JT</given-names></name><name><surname>Ruis</surname><given-names>C</given-names></name><name><surname>du Plessis</surname><given-names>L</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title><source>Nature Microbiology</source><year>2020</year><volume>5</volume><fpage>1403</fpage><lpage>1407</lpage></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>DF</given-names></name><name><surname>Foulds</surname><given-names>LR</given-names></name></person-group><article-title>Comparison of phylogenetic trees</article-title><source>Math Biosci</source><year>1981</year><volume>53</volume><fpage>131</fpage><lpage>147</lpage></element-citation></ref><ref id="R43"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name></person-group><source>taxonium: Explore very large trees in the browser</source><year>2021a</year><comment>Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/theosanderson/taxonium">https://github.com/theosanderson/taxonium</ext-link></comment></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanderson</surname><given-names>T</given-names></name></person-group><article-title>Chronumental: time tree estimation from very large phylogenies</article-title><source>bioRxiv</source><year>2021b</year><elocation-id>2021.10.27.465994</elocation-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sayers</surname><given-names>EW</given-names></name><name><surname>Cavanaugh</surname><given-names>M</given-names></name><name><surname>Clark</surname><given-names>K</given-names></name><name><surname>Pruitt</surname><given-names>KD</given-names></name><name><surname>Schoch</surname><given-names>CL</given-names></name><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Karsch-Mizrachi</surname><given-names>I</given-names></name></person-group><article-title>GenBank</article-title><source>Nucleic Acids Res</source><year>2021</year><volume>49</volume><fpage>D92</fpage><lpage>D96</lpage></element-citation></ref><ref id="R46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>Y</given-names></name><name><surname>McCauley</surname><given-names>J</given-names></name></person-group><article-title>GISAID: Global initiative on sharing all influenza data – from vision to reality</article-title><source>Eurosurveillance</source><year>2017</year><volume>22</volume></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skidmore</surname><given-names>PT</given-names></name><name><surname>Kaelin</surname><given-names>EA</given-names></name><name><surname>Holland</surname><given-names>LRA</given-names></name><name><surname>Maqsood</surname><given-names>R</given-names></name></person-group><article-title>Emergence of a SARS-CoV-2 E484K variant of interest in Arizona</article-title><source>medRxiv</source><year>2021</year></element-citation></ref><ref id="R48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><fpage>1312</fpage><lpage>1313</lpage></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steel</surname><given-names>MA</given-names></name><name><surname>Penny</surname><given-names>D</given-names></name></person-group><article-title>Distributions of tree comparison metrics—some new results</article-title><source>Syst Biol</source><year>1993</year></element-citation></ref><ref id="R50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sullivan</surname><given-names>J</given-names></name><name><surname>Swofford</surname><given-names>DL</given-names></name></person-group><article-title>Should We Use Model-Based Methods for Phylogenetic Inference When We Know That Assumptions About Among-Site Rate Variation and Nucleotide Substitution Pattern Are Violated?</article-title><source>Systematic Biology</source><year>2001</year><volume>50</volume><fpage>723</fpage><lpage>729</lpage></element-citation></ref><ref id="R51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>JW</given-names></name><name><surname>Toovey</surname><given-names>OTR</given-names></name><name><surname>Harvey</surname><given-names>KN</given-names></name><name><surname>Hui</surname><given-names>DDS</given-names></name></person-group><article-title>Introduction of the South African SARS-CoV-2 variant 501Y.V2 into the UK</article-title><source>J Infect</source><year>2021</year><volume>82</volume><fpage>e8</fpage><lpage>e10</lpage></element-citation></ref><ref id="R52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tegally</surname><given-names>H</given-names></name><name><surname>Wilkinson</surname><given-names>E</given-names></name><name><surname>Giovanetti</surname><given-names>M</given-names></name><name><surname>Iranzadeh</surname><given-names>A</given-names></name><name><surname>Fonseca</surname><given-names>V</given-names></name><name><surname>Giandhari</surname><given-names>J</given-names></name><name><surname>Doolabh</surname><given-names>D</given-names></name><name><surname>Pillay</surname><given-names>S</given-names></name><name><surname>San</surname><given-names>EJ</given-names></name><name><surname>Msomi</surname><given-names>N</given-names></name><name><surname>Mlisana</surname><given-names>K</given-names></name><etal/></person-group><article-title>Detection of a SARS-CoV-2 variant of concern in South Africa</article-title><source>Nature</source><year>2021</year><volume>592</volume><fpage>438</fpage><lpage>443</lpage></element-citation></ref><ref id="R53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Jain</surname><given-names>M</given-names></name><name><surname>Dhillon</surname><given-names>N</given-names></name><name><surname>La</surname><given-names>S</given-names></name><name><surname>Kapp</surname><given-names>JD</given-names></name><name><surname>Anigbogu</surname><given-names>I</given-names></name><name><surname>Cassatt-Johnstone</surname><given-names>M</given-names></name><name><surname>McBroome</surname><given-names>J</given-names></name><name><surname>Haeussler</surname><given-names>M</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><etal/></person-group><article-title>A new SARS-CoV-2 lineage that shares mutations with known Variants of Concern is rejected by automated sequence repository quality control</article-title><source>bioRxiv</source><year>2021a</year></element-citation></ref><ref id="R54"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>roblanf</surname></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Cheng</surname><given-names>Y</given-names></name></person-group><article-title>bpt26/parsimony</article-title><year>2021b</year></element-citation></ref><ref id="R55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>F</given-names></name><name><surname>Tong</surname><given-names>B</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Shi</surname><given-names>S</given-names></name><name><surname>Zheng</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Dong</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>P</given-names></name></person-group><article-title>Mutation N501Y in RBD of Spike Protein Strengthens the Interaction between COVID-19 and its Receptor ACE2</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021.02.14.431117</elocation-id></element-citation></ref><ref id="R56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Gozashti</surname><given-names>L</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name></person-group><article-title>Ultrafast Sample placement on Existing tRees (UShER) enables real-time phylogenetics for the SARS-CoV-2 pandemic</article-title><source>Nat Genet</source><year>2021a</year><volume>53</volume><fpage>809</fpage><lpage>816</lpage></element-citation></ref><ref id="R57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Mcbroome</surname><given-names>J</given-names></name></person-group><article-title>Pandemic-Scale phylogenomics reveals elevated recombination rates in the SARS-CoV-2 spike region</article-title><source>bioRxiv</source><year>2021b</year></element-citation></ref><ref id="R58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Umair</surname><given-names>M</given-names></name><name><surname>Ikram</surname><given-names>A</given-names></name><name><surname>Salman</surname><given-names>M</given-names></name><name><surname>Khurshid</surname><given-names>A</given-names></name><name><surname>Alam</surname><given-names>M</given-names></name><name><surname>Badar</surname><given-names>N</given-names></name><name><surname>Suleman</surname><given-names>R</given-names></name><name><surname>Tahir</surname><given-names>F</given-names></name><name><surname>Sharif</surname><given-names>S</given-names></name><name><surname>Montgomery</surname><given-names>J</given-names></name><name><surname>Whitmer</surname><given-names>S</given-names></name><etal/></person-group><article-title>Whole-genome sequencing of SARS-CoV-2 reveals the detection of G614 variant in Pakistan</article-title><source>PLoS One</source><year>2021</year><volume>16</volume><elocation-id>e0248371</elocation-id></element-citation></ref><ref id="R59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Barbetti</surname><given-names>J</given-names></name><name><surname>Wong</surname><given-names>T</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name></person-group><article-title>DecentTree: Scalable Neighbour-Joining for the Genomic Era</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.04.10.487712</elocation-id></element-citation></ref><ref id="R60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wertheim</surname><given-names>JO</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name><name><surname>Sanderson</surname><given-names>MJ</given-names></name></person-group><article-title>Accuracy in near-perfect virus phylogenies</article-title><source>Syst Biol</source><year>2021</year></element-citation></ref><ref id="R61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname><given-names>C</given-names></name><name><surname>Thornlow</surname><given-names>B</given-names></name><name><surname>Hinrichs</surname><given-names>A</given-names></name><name><surname>Torvi</surname><given-names>D</given-names></name><name><surname>Lanfear</surname><given-names>R</given-names></name><name><surname>Corbett-Detig</surname><given-names>R</given-names></name><name><surname>Turakhia</surname><given-names>Y</given-names></name></person-group><article-title>matOptimize: A parallel tree optimization method enables online phylogenetics for SARS-CoV-2</article-title><source>bioRxiv</source><year>2022</year><elocation-id>2022.01.12.475688</elocation-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Phylogenies may be optimized from scratch using de novo phylogenetics or iteratively using online phylogenetics.</title><p>In de novo phylogenetics (top), trees are repeatedly re-inferred from scratch. Conversely, online phylogenetics (bottom) involves placement of new samples as they are collected. Intermittent optimization steps (not depicted) after new samples are placed can help overcome errors from previous iterations. Online phylogenetics is expected to be much faster and require less memory than de novo phylogenetics.</p></caption><graphic xlink:href="EMS141072-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Online matOptimize produces phylogenies most similar to ground truth on simulated data.</title><p>For each batch of samples, we calculated the Robinson-Foulds distance between the tree produced by a given optimization software and the ground truth tree pruned to contain only the relevant samples. We then normalized these values by the maximum possible Robinson-Foulds distance between the two trees (see <xref ref-type="supplementary-material" rid="SD1">Figure S3</xref>), which is equal to 2n-6 where n equals the number of samples in each tree (Steel and Penny 1993). We terminated FastTree and IQ-TREE after the first phylogeny that took more than 24 hours to optimize.</p></caption><graphic xlink:href="EMS141072-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>In practice, optimization by parsimony is more effective for SARS-CoV-2 data than optimization by ML.</title><p>We calculated (A) the parsimony score for each tree using matUtils, (B) the log-likelihood of each tree using IQ-TREE 2, (C) runtime and (D) peak memory usage of each optimization. (A) and (B) are normalized by the value obtained for the matOptimize online approach such that all other methods are expressed as a ratio. Strategies that surpassed 24 hours (C) or the allowable RAM usage (D) were terminated prior. In most cases, with the notable exception of FastTree 2, online phylogenetics (solid lines) perform better than de novo phylogenetics (dashed lines). We ran all matOptimize analyses using an instance with 15 CPUs and 117.2 GB of RAM, and we ran all IQ-TREE 2 and FastTree 2 analyses on an instance with 31 CPUs and 244.1 GB of RAM, but limited each command to 15 threads for equivalence with matOptimize.</p></caption><graphic xlink:href="EMS141072-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>de novo matOptimize produces similar or more favorable trees compared to the most thorough maximum-likelihood inference programs.</title><p>We ran these methods for up to two weeks each to infer trees de novo from the three smallest iterations of real and simulated data. For real data <bold>(A)</bold>, log-likelihoods were computed under the model parameters estimated by IQ-TREE 2 at each iteration. Values are normalized by the value of the matOptimize approach such that all other methods are expressed as a ratio. For simulated data <bold>(B, C)</bold>, the reported quartet distances <bold>(B)</bold> are similarly normalized by the value of the matOptimize approach such that other methods are expressed as a ratio. RF distances <bold>(C)</bold> are normalized by the maximum possible RF distance of 2n-6, where n is the number of leaves in each tree. For all panels, the second and third iterations of RAxML-NG (which did not terminate within two weeks) are omitted.</p></caption><graphic xlink:href="EMS141072-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Improvement in likelihood and parsimony have a linear relationship for our optimized global tree.</title><p>We optimized our initial global tree using 6 iterations of FastTree and measured the total parsimony and the likelihood after each, finding a linear relationship (Pearson correlation, rho = -1.0, p &lt; 2.9×10<sup>-7</sup>).</p></caption><graphic xlink:href="EMS141072-f005"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><p>We applied each of the three optimization methods to a starting tree of 364,427 SARS-CoV-2 samples, which had an initial parsimony score of 296,247. We first ran 2 iterations of IQ-TREE 2 optimization, using an SPR radius of 20 on the first and 100 on the second. We also used an SPR radius of 10 on one iteration of matOptimize, and six iterations of pseudo-likelihood optimization using FastTree 2, which we terminated after roughly 10.5 days.</p></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="middle">Method</th><th align="left" valign="middle">Iterations</th><th align="left" valign="middle">Runtime (H:M:S)</th><th align="left" valign="middle">Final Parsimony Score (Percent Change from Starting Tree)</th></tr></thead><tbody><tr><td align="left" valign="middle">IQ-TREE 2</td><td align="left" valign="middle">2</td><td align="left" valign="middle">24:30:52</td><td align="left" valign="middle">294,258 (0.67)</td></tr><tr><td align="left" valign="middle">FastTree 2</td><td align="left" valign="middle">6</td><td align="left" valign="middle">252:02:49</td><td align="left" valign="middle">294,154 (0.71)</td></tr><tr><td align="left" valign="middle">matOptimize</td><td align="left" valign="middle">1</td><td align="left" valign="middle">1:12:03</td><td align="left" valign="middle">294,022 (0.75)</td></tr></tbody></table></table-wrap></floats-group></article>