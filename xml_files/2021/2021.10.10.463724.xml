<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS136542</article-id><article-id pub-id-type="doi">10.1101/2021.10.10.463724</article-id><article-id pub-id-type="archive">PPR405885</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>Recoverability of Ancestral Recombination Graph Topologies</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hayman</surname><given-names>Elizabeth</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Ignatieva</surname><given-names>Anastasia</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Hein</surname><given-names>Jotun</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Mathematics, University of Oxford, Andrew Wiles Building, Oxford OX2 6GG, UK</aff><aff id="A2"><label>2</label>Department of Statistics, University of Warwick, Coventry CV4 7AL, UK</aff><aff id="A3"><label>3</label>Department of Statistics, University of Oxford, 24-29 St Giles’, Oxford OX1 3LB, UK</aff><aff id="A4"><label>4</label>The Alan Turing Institute, British Library, London NW1 2DB, UK</aff><author-notes><corresp id="CR1"><label>*</label><email>elizabeth.hayman@keble.ox.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>13</day><month>10</month><year>2021</year></pub-date><pub-date pub-type="preprint"><day>10</day><month>10</month><year>2021</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Recombination is a powerful evolutionary process that shapes the genetic diversity observed in the populations of many species. Reconstructing genealogies in the presence of recombination from sequencing data is a very challenging problem, as this relies on mutations having occurred on the correct lineages in order to detect the recombination and resolve the ordering of coalescence events in the local trees. We investigate the probability of reconstructing the true topology of ancestral recombination graphs (ARGs) under the coalescent with recombination and gene conversion. We explore how sample size and mutation rate affect the inherent uncertainty in reconstructed ARGs, which sheds light on the theoretical limitations of ARG reconstruction methods. We illustrate our results using estimates of evolutionary rates for several organisms; in particular, we find that for parameter values that are realistic for SARS-CoV-2, the probability of reconstructing genealogies that are close to the truth is low.</p></abstract><kwd-group><kwd>Recombination detection</kwd><kwd>ancestral recombination graph</kwd><kwd>coalescent</kwd><kwd>gene conversion</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P2">The reconstruction of genealogies from sequencing data in the presence of recombination has remained an important but challenging problem. Several tools have been developed for recovering the topology of genealogies, with some recent methods capable of tackling very large datasets using heuristic and approximate approaches (e.g. <xref ref-type="bibr" rid="R18">Kelleher et al., 2019</xref>; <xref ref-type="bibr" rid="R31">Speidel et al., 2019</xref>). However, all methods that use sequencing data rely on mutations in the genealogical history in order to detect recombination and determine the ordering of coalescence events. Particularly when mutation rates are low, there may thus be significant uncertainty in the shape of the reconstructed local trees. Some tools (such as ARGweaver, <xref ref-type="bibr" rid="R25">Rasmussen et al., 2014</xref>) instead infer a distribution over genealogies, allowing inference methods to integrate over this uncertainty, although these are generally limited by computational power and can handle only moderate sample sizes.</p><p id="P3">In this article, we calculate the probability that the true topology of the genealogy (disregarding branch lengths) can be recovered from the data, either in full or up to a specified number of ambiguous internal edges, under some simplifying assumptions. This sheds light both on the performance of heuristic reconstruction methods (by quantifying how close to the true history they might get in the best case scenario) and methods exploring the posterior distribution over compatible genealogies (by giving a sense of the size of the search space).</p><p id="P4">The coalescent with recombination is a widely used model for genealogies that extends coalescent trees to ancestral recombination graphs (ARGs) (<xref ref-type="bibr" rid="R6">Griffiths and Marjoram, 1997</xref>). Under the commonly used <italic>infinite sites</italic> assumption, which we implement, each mutation occurs at a new position of the genome. Recombination can then be detected using the <italic>four gamete</italic> test (<xref ref-type="bibr" rid="R13">Hudson and Kaplan, 1985</xref>): denoting the ancestral allele by 0 and the derived allele by 1, if all four configurations 00, 01, 10 and 11 are observed at any two sites of a sample, then the sample could not have been generated by mutation alone and at least one recombination must have occurred. For a recombination to generate such incompatible sites, the ARG topology must include a particular configuration of coalescence events preceding a recombination, and mutations must fall on the correct edges of the recombination cycle.</p><p id="P5">Under the coalescent with recombination, <xref ref-type="bibr" rid="R22">Myers (2003)</xref> derived the probability that, conditional on a single recombination having occurred in the history of a sample, its effect is detectable from the sequencing data. This was achieved by constructing recursion equations for the probability of interest, starting at the present time and considering each subsequent event backwards in time. We utilise similar ideas to consider the detectability of multiple recombination events, under the simplifying assumption of a two-locus model (where two non-recombining segments are separated by a single recombination break-point). We also make the assumption that the ARG topology is constrained to be a <italic>galled tree</italic>, i.e. an ARG where the recombination cycles do not interact with each other. This allows us to calculate the probability that, conditioning on <italic>R</italic> recombination events having occurred in the sample’s history, they are all detectable, and the topology of each local tree can be reconstructed unambiguously (or up to a fixed number of ambiguous internal edges). We also calculate the probability that an ARG generated under the coalescent with recombination is a galled tree, and find that this is a reasonable assumption if the recombination rate is relatively low. We also consider gene conversion—where a section of genetic material is taken from one parent genome, and the endpoints from another parent genome—and derive the probability that given one gene conversion event has occurred in the history of the sample, this is detectable from the sequencing data.</p><p id="P6">The idea of constructing recursion equations to calculate quantities of interest for the coalescent with recombination goes back several decades: <xref ref-type="bibr" rid="R4">Ethier and Griffiths (1990)</xref>, and later <xref ref-type="bibr" rid="R15">Jenkins and Song (2009</xref>, <xref ref-type="bibr" rid="R16">2010</xref>), used recursion equations to obtain (asymptotic) closed-form expressions for the two-locus sampling distribution under different mutation models. Our work also links with previous explorations of the properties of coalescent genealogies <italic>without</italic> recombination. In this setting, <xref ref-type="bibr" rid="R33">Wiuf and Donnelly (1999)</xref> considered the age of a single mutation conditioned on its prevalence among sampled sequences; <xref ref-type="bibr" rid="R26">Sargsyan (2006)</xref>, <xref ref-type="bibr" rid="R12">Hobolth and Wiuf (2009)</xref>, <xref ref-type="bibr" rid="R17">Jenkins and Song (2011)</xref> and <xref ref-type="bibr" rid="R14">Jenkins et al. (2014)</xref> extended this to incorporate recurrent mutations under various conditions on the placement of mutations on the genealogy and on the demographic model. Our work explores a new direction in that we do not focus on sampling distributions or the properties of mutations such as the frequency spectrum directly; we instead use recursion equations to calculate the probability of mutations falling on the genealogy in a way that makes the ordering of coalescence events and presence of recombination events deducible from the data.</p><p id="P7">There is also a large body of literature concerned with assessing the effect of sample size and sequence length on the accuracy of phylogenetic inference, incorporating both simulation studies and theoretical investigations for a multitude of settings and mutation models (e.g. <xref ref-type="bibr" rid="R11">Hillis et al., 1994</xref>; <xref ref-type="bibr" rid="R10">Hillis, 1998</xref>; <xref ref-type="bibr" rid="R19">Kim, 1998</xref>; <xref ref-type="bibr" rid="R23">Pollock et al., 2002</xref>; <xref ref-type="bibr" rid="R9">Heath et al., 2008</xref>). Our investigation of the accuracy of reconstructed tree topologies for data generated under the coalescent (without recombination) supports the broad consensus that accuracy improves with increasing the number of sampled taxa (when fixing the number of leaves for which the phylogeny is required) and sequence length. We derive analytic expressions for the probabilities of interest under the coalescent, which are new to the best of our knowledge; we also explicitly consider the presence of recombination, which has not been the focus of these prior studies.</p><p id="P8">Where possible, we illustrate our findings using mutation and recombination rate parameters that are reasonable for biological organisms. Using published estimates of evolutionary rates for SARS-CoV-2, we take the population scaled mutation and recombination rates to be approximately <italic>θ</italic> = 100 and <italic>ρ</italic> = 0.1 per genome, respectively (assuming a generation time of 7.5 days (<xref ref-type="bibr" rid="R20">Li et al., 2020</xref>), <italic>N<sub>e</sub></italic> = 50, mutation rate of 1 · 10<sup>–3</sup> per site per year (<xref ref-type="bibr" rid="R3">Duchene et al., 2020</xref>), recombination rate of 2 ·10<sup>–6</sup> per site per year (<xref ref-type="bibr" rid="R21">Müller et al., 2021</xref>)). We also consider <italic>Drosophila melanogaster</italic>, with <italic>θ</italic> = 8 and <italic>ρ</italic> = 21 per kb, using estimates of <xref ref-type="bibr" rid="R2">Chan et al. (2012)</xref>. For human populations, typical rates are <italic>θ</italic> = <italic>ρ</italic> = 0.1 per kb, as used in previous analyses (<xref ref-type="bibr" rid="R18">Kelleher et al., 2019</xref>).</p><p id="P9">In <xref ref-type="sec" rid="S2">Section 2</xref>, we first demonstrate our ideas in the simpler case where recombination is disallowed, i.e. when the genealogy is constrained to be a binary tree generated under the coalescent model. In <xref ref-type="sec" rid="S8">Section 3</xref>, we calculate the probability that an ARG generated under the coalescent with recombination is a galled tree. Then, in <xref ref-type="sec" rid="S12">Section 4</xref>, we consider the probability of reconstructing the ARG topology unambiguously when it is a galled tree. Further, in <xref ref-type="sec" rid="S20">Section 5</xref>, we derive the probability that a gene conversion event is detectable from sequencing data. A discussion of these results is presented in <xref ref-type="sec" rid="S23">Section 6</xref>.</p><p id="P10">MATLAB code used for the numerical calculations can be found on GitHub at github. com/Elizabeth-Hayman/Recoverability_of_ARG_topologies.</p></sec><sec id="S2"><label>2</label><title>Topology of a Tree</title><p id="P11">We first assume the absence of recombination, so the genealogy can be represented by a rooted binary tree, and consider the probability that the true tree topology can be reconstructed unambiguously from a sample of sequencing data generated under the coalescent model.</p><p id="P12">Consider a rooted binary tree topology (disregarding branch lengths) as a directed acyclic graph (DAG), with a root node of in-degree 0 and out-degree 2, tree nodes with in-degree 1 and out-degree 2, and leaves with in-degree 1 and out-degree 0. The edges of this tree can then be classed as internal (connecting the root or a tree node with a tree node) and external (connecting the root or a tree node with a leaf). Each edge in the tree corresponds to a bipartition of the leaves, into those that are and those that are not descendants of the edge. A mutation on an edge manifests as a segregating site in the sequencing data, splitting the sampled sequences into those that do and those that do not carry the mutation, therefore allowing for the presence of the edge in the genealogy to be deduced. In fact, as a consequence of the splits-equivalence theorem (<xref ref-type="bibr" rid="R1">Buneman, 1971</xref>; <xref ref-type="bibr" rid="R27">Semple and Steel, 2003</xref>), if each internal edge undergoes at least one mutation, the tree topology can be uniquely determined from the sample. Note that mutations on the external edges are not helpful for resolving the ordering of coalescence events in the tree topology. This leads to the following definition:</p><sec id="S3"><title>Definition 1.</title><p id="P13"><italic>A tree is</italic> recoverable <italic>if at least one mutation is present on each of the internal edges, and hence the ordering of coalescence events can be uniquely determined from the sequencing data.</italic></p><p id="P14">In <xref ref-type="fig" rid="F1">Figure 1</xref>, the first two trees are not recoverable, and they are both consistent with the same sequencing sample. The rightmost tree is recoverable, as the topology is uniquely associated with the sample (even though fewer mutations occur overall).</p><p id="P15">Note that although we disregard recombination for now, some algorithms detect recombination by identifying changes to the local trees on either side of a recombination breakpoint (<xref ref-type="bibr" rid="R30">Song and Hein, 2005</xref>), so the detectability of recombination depends on how accurately the tree topologies at each locus can be reconstructed.</p></sec><sec id="S4"><label>2.1</label><title>Probability that the tree is recoverable</title><p id="P16">In order to derive the probability that the tree is recoverable, we proceed by considering the genealogy backwards in time, and tracking whether at least one mutation has occurred on each internal branch before it undergoes a coalescence event. At any point in time, each lineage can thus be in one of two states: if the lineage has not mutated since the last coalescence event, we assign it to being in <italic>State 1</italic>, and otherwise in <italic>State 2</italic>. Note that the terminal branches are taken to be in State 2 (mutations on the terminal branches are not required in order for the tree to be recoverable, as they provide no information on the ordering of coalescence events).</p><p id="P17">At some point <italic>t</italic> backwards in time, let <italic>n<sub>l</sub></italic> be the total number of lineages currently remaining, and <italic>n<sub>f</sub></italic> the number of lineages currently in State 2. Define <italic>P</italic><sub>1</sub>(<italic>n<sub>l</sub>, n<sub>f</sub></italic>) as the probability that the tree before (above) time <italic>t</italic> is recoverable, given that <italic>n<sub>f</sub></italic> out of <italic>n<sub>l</sub></italic> lineages are in State 2 at <italic>t</italic>. Assigning all lineages to be in State 2 at the present time <italic>t</italic> = 0, <italic>P</italic><sub>1</sub>(<italic>n</italic>, <italic>n</italic>) then gives the probability that the whole tree is recoverable.</p><p id="P18">We then construct recursion equations by conditioning on the current state pair (<italic>n<sub>f</sub></italic>, <italic>n<sub>l</sub></italic>) and considering the possible next event backwards in time. Letting <inline-formula><mml:math id="M1"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mi>θ</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>, <list list-type="bullet" id="L1"><list-item><p id="P19">with probability <inline-formula><mml:math id="M2"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:math></inline-formula> the event is a coalescence of two lineages in State 2 (then the number of lineages decreases by one, and the number of lineages in State 2 decreases by two);</p></list-item><list-item><p id="P20">with probability (<italic>n<sub>l</sub></italic> — <italic>n<sub>f</sub></italic>)<italic>θ</italic>/2<italic>λ</italic> the event is a mutation of a lineage in State 1 (then the number of lineages in State 2 increases by one, and consequently the number of lineages in State 1 drops by one);</p></list-item><list-item><p id="P21">with probability <italic>n<sub>f</sub>θ</italic>/2<italic>λ</italic>, the event is a mutation of a lineage in State 2 (then there is no change of state).</p></list-item></list></p><p id="P22">The recursion thus takes the form <disp-formula id="FD1"><label>(1)</label><mml:math id="M3"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> with the initial condition <italic>P</italic><sub>1</sub>(1, 0) = 1. This is the simplest case of recursions we present, which can be solved numerically with a runtime of order roughly <italic>n</italic><sup>2</sup>. Further on in the text, recursions become more complex, but can be solved efficiently via dynamic programming and should not require any matrix inversion. We use MATLAB to solve the recursions.</p><p id="P23"><xref ref-type="fig" rid="F2">Figure 2</xref> (blue dots and lines) illustrates the probability of the tree being recoverable for various values of <italic>n</italic> and <italic>θ</italic>. Panels (a)-(c) demonstrate that this probability is monotonically decreasing in <italic>n</italic> for fixed <italic>θ</italic>; for larger values of <italic>n</italic>, the time periods between coalescence events are shorter near the present time, so it is less likely that mutations will occur on all of the internal edges. Panel (d) shows that the probability that the tree is recoverable for a sample of fixed size (<italic>n</italic> = 20) increases as <italic>θ</italic> grows, with a limit of 1 as <italic>θ</italic> → ∞, as expected. However, the probability that the tree is recoverable does not reach near 1 until <italic>θ</italic> ≈ 10<sup>5</sup>, which appears infeasibly large for biological samples (typically <italic>θ</italic> ≤ 100). For <italic>θ</italic> = 100, which is typical for SARS-CoV-2 genomes for instance, the probability of the tree being recoverable becomes very small for sample sizes over 25. For <italic>Drosophila melanogaster</italic>, with <italic>θ</italic> ≈ 10, this probability is minuscule for <italic>n</italic> &gt; 10.</p><p id="P24"><xref ref-type="bibr" rid="R5">Fu and Li (1993)</xref> derive the expected total length of internal branches to be <disp-formula id="FD2"><mml:math id="M4"><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> for large <italic>n</italic>, using our time scaling. Given that mutations occur as a Poisson process with rate <italic>θ</italic>/2, the expected total number of mutations on interior branches is therefore ≈ <italic>θ</italic> log(<italic>n</italic>). This gives some intuitive understanding of the results above: for a sample of size <italic>n</italic>, there are <italic>n</italic> – 1 coalescent events, and thus a minimum of <italic>n</italic> – 2 mutations are required to have one on each interior branch. Therefore, even before the precise placement of individual mutations is considered, the total number of mutations needed for the tree to be recoverable grows like <italic>n</italic>, while the number of mutations expected to occur on the interior branches grows like log(<italic>n</italic>). Hence, the probability of the tree being recoverable drops to 0 quickly.</p></sec><sec id="S5"><label>2.2</label><title>Probability that tree is partially recoverable</title><p id="P25">The probability of the tree being recoverable decreases rapidly as <italic>n</italic> increases, so we next consider the probability of the tree being <italic>partially</italic> recoverable:</p><sec id="S6"><title>Definition 2</title><p id="P26"><italic>A tree is</italic> partially recoverable <italic>if all except up to</italic> <italic>n</italic><sub>0</sub> <italic>internal edges carry at least one mutation.</italic></p><p id="P27"><xref ref-type="fig" rid="F1">Figure 1</xref> (left and centre panels) demonstrates two possible trees for <italic>n</italic> = 4 and <italic>n</italic><sub>0</sub> = 1: the trees are consistent with the same sample, and have the same topology apart from the internal edge joining the second sequence to the rest of the tree. A mutation at one of the starred positions would fix the reconstructed genealogy to one of these two possibilities.</p><p id="P28">We extend the results of the previous section by including <italic>n</italic><sub>0</sub> as a recursive index to track the number of internal edges that have not yet undergone at least one mutation. By again considering the next event backwards in time when there are <italic>n<sub>l</sub></italic> lineages of which <italic>n<sub>f</sub></italic> are in State 2, the equivalent recursion to <xref ref-type="disp-formula" rid="FD1">(1)</xref> is <disp-formula id="FD3"><mml:math id="M5"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P29">The initial conditions are <italic>P</italic><sub>1<italic>a</italic></sub>(<italic>n</italic><sub>0</sub>,1,1) = 1 =<italic>P</italic><sub>1<italic>a</italic></sub>(<italic>n</italic><sub>0</sub>, 1, 0). Note that we are considering the probability of having <italic>up to</italic> <italic>n</italic><sub>0</sub> unresolved internal edges: the probability of missing <italic>precisely n</italic><sub>0</sub> edges can be calculated as <italic>P</italic><sub>1<italic>a</italic></sub>(<italic>n</italic><sub>0</sub>, 1,1) – <italic>P</italic><sub>1<italic>a</italic></sub>(<italic>n</italic><sub>0</sub>–a 1,1,1).</p><p id="P30"><xref ref-type="fig" rid="F2">Figure 2 (a)-(c)</xref> shows how the probability of the tree being partially recoverable varies with <italic>θ</italic> and <italic>n</italic><sub>0</sub>, where <italic>n</italic><sub>0</sub> is taken to be a fixed percentage of the total number of internal edges in the tree (rounded down to the nearest integer, which makes the plots look jagged). Note that increasing <italic>n</italic><sub>0</sub> in panels (a)-(c) shifts the probability curve to the right, for each value of <italic>θ</italic>, and that the magnitude of the shift increases with <italic>θ</italic>. Panel (d) highlights that allowing even a small number of unresolved edges results in a large increase in the probability of correctly reconstructing the rest of the tree.</p></sec></sec><sec id="S7"><label>2.3</label><title>History of a specific lineage</title><p id="P31">The probability of the tree being even partially recoverable decreases rapidly with increasing sample size. We next focus on the probability of unambiguously determining the history of a specific lineage. This is useful if there is particular interest in the history of a specific sequence: for instance, in the context of viral genealogies, our results quantify the probability that a particular viral strain can be accurately placed in the overall genealogy. <xref ref-type="fig" rid="F3">Figure 3</xref> shows an example of a tree topology where the history of the lineage highlighted in red can be reconstructed unambiguously, while allowing for uncertainty in the rest of the tree topology. This requires that mutations occur on all of the internal edges highlighted in red.</p><p id="P32">This simplifies the model considered in <xref ref-type="sec" rid="S3">Section 2.1</xref>, as the dependence on <italic>n<sub>f</sub></italic> can be dropped, with the recursions only focussing on the state of the one lineage. Here, <italic>n</italic><sub>0</sub> counts only those unresolved internal edges that are ancestral to the single lineage of interest. The equivalent to <xref ref-type="disp-formula" rid="FD1">(1)</xref> in this setting with <italic>P</italic><sub>2</sub>(<italic>n</italic><sub>0</sub>, <italic>n</italic><sub>l</sub>, lineage state) as the probability of interest is <disp-formula id="FD4"><label>(2)</label><mml:math id="M6"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P33">The initial conditions are <italic>P</italic><sub>2</sub>(<italic>n</italic><sub>0</sub>, 1, 1) = 1 = <italic>P</italic><sub>2</sub>(<italic>n</italic><sub>0</sub>, 1, 2).</p><p id="P34"><xref ref-type="fig" rid="F4">Figure 4</xref> shows plots of the resulting probabilities. The probabilities are consistently higher compared to those of the whole tree being recoverable, and are non-negligible even for reasonably large sample sizes. Taking the SARS-CoV-2 value of <italic>θ</italic> ≈ 100, panel (a) shows that the genealogical history of a particular lineage from a sample size of 20 has probability of 0.75 of being reconstructed unambiguously. Panel (b) shows the probability of reconstructing the history of a single lineage up to <italic>n<sub>0</sub></italic> unresolved internal edges. As before, even a small degree of flexibility (up to three undetermined interior edges out of a sample of hundreds) leads to a significant improvement in recoverability.</p></sec></sec><sec id="S8"><label>3</label><title>Probability that an ARG is a Galled Tree</title><p id="P35">Define an ARG as a rooted binary DAG, containing a root node of in-degree 0 and out-degree 2, sample nodes with in-degree 1 and out-degree 0, recombination nodes with in-degree 2 and out-degree 1, and tree nodes with in-degree 1 and out-degree 2. Recombination nodes are labelled with a recombination breakpoint <italic>z</italic> (which, assuming a two-locus model, is fixed), with the leftmost parent node inheriting the genetic material at coordinates [0, <italic>z</italic>) and the rightmost parent inheriting the genetic material at [<italic>z</italic>, 1]. Suppose that two directed paths out of a node <italic>x</italic> in the ARG meet at a recombination node <italic>y</italic>; a recombination <italic>loop</italic> is the subgraph of the ARG containing <italic>x,y</italic> and the two paths connecting them. If a recombination loop shares no node with any other recombination loop, it is termed <italic>galled</italic> (<xref ref-type="bibr" rid="R7">Gusfield, 2014</xref>, p. 237). A <italic>galled tree</italic> is an ARG where all recombination loops are galled. An example of an ARG that is (resp. is not) a galled tree is given in the left (resp. right) panel of <xref ref-type="fig" rid="F5">Figure 5</xref>.</p><p id="P36">Galled trees are a particularly tractable class of ARGs, for which many properties are significantly more straightforward to derive analytically, and reconstruction algorithms are attractively efficient. For instance, there exists a polynomial time algorithm for reconstructing a parsimonious galled tree from sequencing data, if this is possible (<xref ref-type="bibr" rid="R32">Wang et al., 2001</xref>; <xref ref-type="bibr" rid="R8">Gusfield et al., 2004</xref>); there is a concise necessary and sufficient condition for the sample to be consistent with a galled tree (<xref ref-type="bibr" rid="R28">Song, 2006</xref>); if a genealogy is in the shape of a galled tree, the sample can also be derived on a true tree (with no recombination) if at most one recurrent mutation per site is allowed (<xref ref-type="bibr" rid="R7">Gusfield, 2014</xref>, Theorem 8.12.1).</p><p id="P37"><xref ref-type="bibr" rid="R7">Gusfield (2014)</xref> notes that ARGs are likely to be galled trees if the recombination rate is low, or if there is reason to believe that recombination has only occurred relatively close to the present. However, the probability that an ARG generated under the coalescent with recombination is a galled tree has not been previously derived analytically. We obtain an explicit expression for the probability that an ARG with <italic>n</italic> leaves and known recombination rate <italic>ρ</italic> contains only galled recombination cycles. Note that the results we derive hold for the <italic>big</italic> ARG (i.e. including recombination events in non-ancestral material); this simplifies the expressions, and we expect the results to be very close to those for the <italic>small</italic> ARG (ignoring recombination events in non-ancestral material) when <italic>ρ</italic> is small and <italic>n</italic> reasonably large.</p><p id="P38">Define an <italic>open</italic> recombination loop as one where (looking backwards in time) the two recombinant lineages have not yet coalesced back with each other. An ARG may fail to be a galled tree if a lineage of an open recombination loop undergoes another recombination, or coalesces with a lineage from a different open recombination loop.</p><sec id="S9"><label>3.1</label><title>Probability that an ARG has exactly <italic>R</italic> recombination nodes</title><p id="P39">First, we obtain an expression that an ARG has precisely <italic>R</italic> recombination events for a sample of size <italic>n</italic>. Consider the ARG some time <italic>t</italic> before the present. Define <inline-formula><mml:math id="M7"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> as the probability that an ARG has at most <italic>R</italic> recombinations (in total), given that there are <italic>n<sub>l</sub></italic> lineages remaining at <italic>t</italic>, with <italic>r</italic> ≤ <italic>R</italic> possible recombination events having occurred before (below) time <italic>t</italic>. By considering the genealogy backwards in time and conditioning on the next possible event, we construct the following recursion for <inline-formula><mml:math id="M8"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:math></inline-formula>
<disp-formula id="FD5"><label>(3)</label><mml:math id="M9"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD6"><label>(4)</label><mml:math id="M10"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>for</mml:mtext><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P40">The condition <italic>n<sub>l</sub></italic> ≤ <italic>n</italic> + <italic>R</italic> arises as at most <italic>n</italic> + <italic>R</italic> lineages can be present in the ARG at any time (through the sample undergoing <italic>R</italic> recombination before any coalescences). The initial condition is <inline-formula><mml:math id="M11"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, as the process must terminate with precisely <italic>R</italic> recombinations having occurred. Then <inline-formula><mml:math id="M12"><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> gives the probability that the ARG has exactly <italic>R</italic> recombination nodes, for a sample of size <italic>n</italic>.</p></sec><sec id="S10"><label>3.2</label><title>Probability that an ARG with <italic>R</italic> recombination nodes is a galled tree</title><p id="P41">We next derive the probability that an ARG with exactly <italic>R</italic> recombination nodes is a galled tree. Again considering the ARG at some point <italic>t</italic> backwards in time, let <inline-formula><mml:math id="M13"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> be the probability that the ARG has precisely <italic>R</italic> recombination loops in total, all of which are galled, conditional on there being <italic>n<sub>l</sub></italic> lineages at time <italic>t</italic>, with <italic>r</italic> out of <italic>R</italic> recombinations having occurred before <italic>t</italic>, and <italic>r</italic><sub>0</sub> ≤ <italic>r</italic> recombination loops currently open. As illustrated in <xref ref-type="fig" rid="F5">Figure 5</xref>, an ARG may fail to be a galled tree if (1) a lineage that is part of an open recombination loop undergoes a further recombination, or if (2) two lineages that are part of different open recombination loops coalesce. Considering each possible next event that does not lead to the ARG failing to be a galled tree, the following recursions on <inline-formula><mml:math id="M14"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> can therefore be constructed: <disp-formula id="FD7"><label>(5)</label><mml:math id="M15"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P42">The condition 2<italic>r</italic><sub>0</sub> ≤ <italic>n<sub>l</sub></italic> arises as there must be at least 2<italic>r</italic><sub>0</sub> lineages in the ARG when <italic>r</italic><sub>0</sub> galled recombination loops are open; the condition <italic>n<sub>l</sub></italic> ≤ <italic>n</italic> + <italic>r</italic><sub>0</sub> arises as there can be at most <italic>n</italic> + <italic>r</italic><sub>0</sub> lineages in the ARG at any time (through the sample undergoing <italic>r</italic><sub>0</sub> recombinations before any coalescences). The initial condition is <inline-formula><mml:math id="M16"><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Then <inline-formula><mml:math id="M17"><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability that the ARG has exactly <italic>R</italic> recombination loops, all of which are galled.</p></sec><sec id="S11"><label>3.3</label><title>Probability that an ARG is a galled tree</title><p id="P43">Combining the results above, <inline-formula><mml:math id="M18"><mml:msup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> gives the probability that an ARG with exactly <italic>R</italic> recombination nodes and <italic>n</italic> leaves is a galled tree. Then <disp-formula id="FD8"><mml:math id="M19"><mml:msup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="script">Q</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></disp-formula> gives the probability that an ARG is a galled tree, conditional on <italic>up to R</italic> recombinations having occurred. Taking the limit <inline-formula><mml:math id="M20"><mml:msup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>lim</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> removes the conditioning on <italic>R</italic> (as a finite number of recombinations occurs in any history with probability one), thus giving an unconditional probability that an ARG with <italic>n</italic> leaves is a galled tree.</p><p id="P44">The left panel of <xref ref-type="fig" rid="F6">Figure 6</xref> illustrates the probability <italic>𝒮<sup><italic>n,ρ</italic></sup></italic> that an ARG is a galled tree for a range of sample sizes <italic>n</italic> and recombination rates <italic>ρ</italic>. When the recombination rate is low, ARGs are galled trees with high probability; this is both due to the ARGs being likely to contain at most one recombination node (and hence being trivially galled), or the recombinations being ‘far apart’ in the ARG so that the recombination loops are not likely to interact.</p><p id="P45">The right panel of <xref ref-type="fig" rid="F6">Figure 6</xref> shows the probability <inline-formula><mml:math id="M21"><mml:msup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:msup><mml:mstyle displaystyle="false"><mml:mo>∫</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi mathvariant="script">S</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>ρ</mml:mi></mml:math></inline-formula>, integrating over a uniform prior distribution <italic>q</italic> on the recombination rate <italic>ρ</italic> ∈ (0,1), to illustrate the probability that the ARG is a galled tree conditioning on <italic>R</italic> recombinations and assuming a low recombination rate. For <italic>R</italic> = 2 recombinations, the ARG is a galled tree with reasonably high probability, of around 0.4 when the sample size is moderate. This suggests that restricting our consideration to ARGs in the form of galled trees might be reasonable when analysing whole-genome SARS-CoV-2 data, for instance, and human or drosophila samples of relatively short genomic regions.</p></sec></sec><sec id="S12"><label>4</label><title>Topology of an Arg</title><p id="P46">We now extend our results in <xref ref-type="sec" rid="S2">Section 2</xref> to include crossover recombination, through analysing the probability of reconstructing the ARG topology in the form of a galled tree unambigiously (or up to a specified number of ambiguous internal edges), under a two-locus model.</p><sec id="S13"><label>4.1</label><title>Detectability of one recombination</title><p id="P47">Conditioning on exactly one recombination having occurred in the history of a sample with a breakpoint z ∈ [0,1], <xref ref-type="bibr" rid="R22">Myers (2003)</xref> considers the probability of this recombination being <italic>detectable</italic>:</p><sec id="S14"><title>Definition 3</title><p id="P48"><italic>A recombination is</italic> detectable <italic>if it changes the ARG topology (i.e. the topology of at least one local tree), and mutations fall on the correct edges of the recombination loop to create incompatibilities in the data, which can then be detected by the four gamete test</italic>.</p><p id="P49">The necessary conditions on the ARG topology and positions of mutations are illustrated in <xref ref-type="fig" rid="F7">Figure 7</xref>. One of the shows configurations must be a subgraph of the ARG for the recombination to be detectable from the data. Labelling the locus to the left (resp. right) of the breakpoint as <italic>A</italic> (resp. <italic>B</italic>), denote <italic>A</italic>-type mutations as those occurring in locus <italic>A,</italic>and <italic>B</italic>-type those in locus <italic>B</italic>. Assuming that the ancestral type is known to be 00, all of the configurations shown in the Figure generate incompatible sites at <italic>A</italic> and <italic>B</italic>.</p><p id="P50"><xref ref-type="bibr" rid="R22">Myers (2003</xref>, <xref ref-type="sec" rid="S17">Section 4.3</xref>) calculates the probability of the recombination being detectable through constructing recursion equations, beginning at the recombination event and tracking the state of each recombinant lineage backwards in time (dissallowing any further recombintions). The possible states for the recombinant lineage emerging from the left-hand side of the recombination node (denoted <italic>ɛ</italic>) are given in <xref ref-type="table" rid="T1">Table 1</xref>. The states for the right-hand lineage (denoted <italic>ℱ</italic>) are equivalent, but with <italic>A</italic> and <italic>B</italic> reversed. Myers notes that for one recombination to be detectable, it is sufficient to have either lineage reach State 4, or for both lineages to simultaneously be in state ≥ 2.</p><p id="P51">Our work extends these results by considering more than one (galled) recombination, and calculating the probability that each recombination is detectable, and also that each local tree is (partially) recoverable. Note that when conditioning on <italic>R</italic> recombination events, we again consider the <italic>big</italic> ARG, and condition on <italic>R</italic> recombination events in the entire history of the sample (including those that might occur in non-ancestral material). This substantially simplifies calculations, and we expect the difference with conditioning on <italic>R</italic> recombination events in ancestral material to be negligible for small <italic>ρ</italic> and reasonably large <italic>n</italic>.</p></sec></sec><sec id="S15"><label>4.2</label><title>Probability that ARG is recoverable</title><p id="P52">We arrive at the following definition:</p><sec id="S16"><title>Definition 4</title><p id="P53"><italic>The ARG is</italic> recoverable <italic>if all recombinations are detectable and each local tree is recoverable (i.e. each edge of the ARG which is internal in at least one local tree has at least one mutation)</italic>.</p><p id="P54">We now calculate the probability that the ARG is a galled tree and recoverable, conditioning on <italic>R</italic> recombinations having occurred. This requires at least one mutation on each edge which is internal to at least one local tree, and the correct sequence of coalescent and mutation events within each recombination loop (to ensure the presence of incompatible sites in the data). This necessitates incorporating more states into the recursions of <xref ref-type="sec" rid="S2">Section 2</xref> to track each of the recombinant lineages. Note that the restriction to galled trees means that for each recombination to the detectable, the detection conditions stated above must hold (independently) for each recombination loop.</p><p id="P55">A fixed number of recombinations <italic>R</italic> are allowed to occur in the history of a sample of size <italic>n</italic>. Suppose that at some point in time, the total number of remaining lineages is <italic>n<sub>l</sub></italic>, and the number of non-recombinant lineages which have undergone at least one mutation since the last coalescence event is <italic>n<sub>f</sub></italic>. The other indices are given in the third column of <xref ref-type="table" rid="T2">Table 2</xref>, tracking the number of left recombinant lineages in various states (with equivalent states for the right recombinant lineages). The indices <italic>a</italic>, <italic>b</italic>, <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, <italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>, <italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub> (resp. <italic>i</italic>,<italic>j</italic>,<italic>k</italic><sub>1</sub>,<italic>k</italic><sub>2</sub>,<italic>l</italic><sub>1</sub>,<italic>l</italic><sub>2</sub>,<italic>m</italic><sub>1</sub>,<italic>m</italic><sub>2</sub>) count the number of left (resp. right) lineages in states 0, 1,..., 7. The index <italic>r</italic> tracks the number of recombination events which have occurred, with <italic>r</italic><sub>0</sub> recombination loops currently remaining open. Note that we must have <disp-formula id="FD9"><mml:math id="M22"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P56">Let <disp-formula id="FD10"><mml:math id="M23"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> be the probability that the ARG is recoverable, given that <italic>r</italic> recombinations have occurred in the history, <italic>r</italic><sub>0</sub> of which are currently open, and <italic>n<sub>l</sub></italic> lineages remain, there are <italic>a</italic> recombination loops with left lineage in State 1, <italic>b</italic> in State 2, and so on, and there are no unresolved edges (denoted by the first index being 0). For the ARG to be recoverable, in each recombination loop we require that at least one of the recombinant lineages is in state 6 or 7, or both lineages in a state greater than 3, before the two recombinant lineages can coalesce (and close the recombination loop). These conditions, for each recombination loop, are necessary and sufficient: any internal branch without at least one mutation would lead to non-recoverability, as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>. Similarly, any recombination loop that closes before the recombinant lineages have reached suitable states will not generate incompatible sites, and hence the recombination will not be detectable. The recursions for this system are described in full in the <xref ref-type="supplementary-material" rid="SD1">Appendix, Section A.1</xref>, and the recursion solved in MATLAB to find <inline-formula><mml:math id="M24"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>(0, <italic>n</italic>, <italic>n</italic>, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0).</p></sec></sec><sec id="S17"><label>4.3</label><title>Probability that ARG topology is partially recoverable</title><p id="P57">We also consider the probability that the ARG is <italic>partially recoverable,</italic> with mutations present on all except (up to) <italic>n</italic><sub>0</sub> internal edges. This is done similarly to the case for binary trees described in <xref ref-type="sec" rid="S2">Section 2</xref>, and simply requires more bookkeeping; the full system of resulting equations is presented in the <xref ref-type="supplementary-material" rid="SD1">Appendix, Section A.1</xref>.</p></sec><sec id="S18"><label>4.4</label><title>One recombination</title><p id="P58">We first consider the results when conditioning on one recombination, setting <italic>R</italic> = 1; this is a realistic scenario when analysing sequencing data from species with a low recombination rate. We fix <italic>ρ</italic> = 0.1, being suitably small so that the assumption of a single recombination is reasonable, noting that this is the estimated value of the recombination rate for SARS-CoV-2 genomes, and human samples of length 1kb.</p><p id="P59"><xref ref-type="fig" rid="F9">Figure 9 (a)</xref> shows solutions of the recursive system for various values of the parameters. Note that these curves are not monotonic in n: there must be a sufficient number of coalescences above the recombination to create incompatible sites in the sample, but increasing the number of lineages makes it unlikely that a mutation occurs between each coalescence (required to make the ARG recoverable). The results demonstrate that the probability of the ARG being recoverable is very low for even moderate values of <italic>θ</italic>, increasing very slowly as <italic>θ</italic> → ∞.</p><p id="P60"><xref ref-type="fig" rid="F9">Figure 9 (b)</xref> demonstrates that allowing just a small number of ‘missed’ internal edges substantially improves the probability of recovering the rest of the ARG topology correctly. For instance, with <italic>n</italic> = 15, the probability of recovering the ARG topology increases from around 0.1 to 0.4 if up to three unresolved internal edges are allowed.</p><p id="P61">Solutions to the recursive system while varying the breakpoint across the genome, <italic>z</italic>, show that taking a breakpoint close to the centre of the genome gives slightly higher probabilities of detecting the full topology (see <xref ref-type="supplementary-material" rid="SD1">Figure 14</xref> in the Appendix).</p></sec><sec id="S19"><label>4.5</label><title>Two recombinations</title><p id="P62">While ARGs containing only one recombination are trivially galled, <xref ref-type="fig" rid="F6">Figure 6</xref> shows that around 40% of ARGs with two recombination nodes will be galled for <italic>ρ</italic> = 0.1. The probability of an ARG being a galled tree falls substantially when conditioning on more than two recombinations, so we do not analyse this case in further detail.</p><p id="P63"><xref ref-type="fig" rid="F10">Figure 10</xref> illustrates solutions of the recursion equations when conditioning on two recombinations and the ARG being a galled tree. The probabilities of the ARG being recoverable are significantly smaller, with fewer than a quarter of ARGs being recoverable even with an infinite mutation rate, for <italic>n</italic> = 60. In comparison, this probability is closer to 0.7 when conditioning on only one recombination. <xref ref-type="fig" rid="F10">Figure 10 (b)</xref> demonstrates again that the probability of the ARG being <italic>partially</italic> recoverable, allowing even a small number of unresolved edges, is comparatively higher, but still very low.</p><p id="P64">These results imply that even if an ARG reconstruction algorithm utilises all of the available information on shared mutations contained within the sequencing data, there is still likely to be significant uncertainty in resolving the location of internal edges. This probability only decreases with increasing recombination rate, and improves very slowly with increasing mutation rate. This makes it very unlikely that reconstruction programs will successfully capture the full complexity of the ARG.</p><p id="P65">The parameter values <italic>θ</italic> ≈ 100 and <italic>ρ</italic> ≈ 0.1, reasonable for SARS-CoV-2, might appear to be optimal for creating genealogies that are fully recoverable from the data: low recombination rates increase the probability of seeing a small number of galled cycles, and high mutation rates make it more likely that mutations will fall on all of the necessary edges. However, our results show that at most 25% of one-recombination, and 2.5% of two-recombination ARGS are recoverable.</p></sec></sec><sec id="S20"><label>5</label><title>Probability that Gene Conversion is Detectable</title><p id="P66">We have so far focussed on crossover recombination events, with one fixed breakpoint: gene conversion is another important type of recombination, which is thought to commonly occur in biological settings, but which has not received as much consideration from a theoretical perspective (<xref ref-type="bibr" rid="R29">Song et al., 2008</xref>). <xref ref-type="fig" rid="F11">Figure 11</xref> illustrates the key difference between crossover recombination (left panel) and gene conversion events (right panel). Genetic material ancestral to the orange section is taken from the right parent and material ancestral to the purple section from the left. In biological samples, the conversion tract (orange) is typically small compared to the total length of the genome.</p><p id="P67">In this section, conditioning on precisely one gene conversion event in the history of the sample (again in the <italic>big</italic> ARG sense), we calculate the probability that this event is detectable, and is distinguishable from one crossover recombination event (<italic>without</italic> the requirement that the ARG is recoverable). As we thus consider a simpler case, we can begin constructing the recursion equations immediately after (above) the gene conversion event, conditioning on precisely one such event in the genealogy.</p><p id="P68">Let <italic>ρ</italic> now be the population scaled rate of gene conversion. Similarly to the case of crossover recombination, a gene conversion is detectable if two pairs of sites spanning the two breakpoints are incompatible (in the sense of the four gamete test). Label the sections of the genome undergoing the gene conversion [0, <italic>z</italic><sub>1</sub>), (<italic>z</italic><sub>1</sub>,<italic>z</italic><sub>2</sub>), (<italic>z</italic><sub>2</sub>,1] as <italic>A,B,C</italic>, respectively. <xref ref-type="fig" rid="F12">Figure 12</xref> demonstrates the possible configurations of events inside the gene conversion loop that lead to detectability. Following similar arguments to those of <xref ref-type="bibr" rid="R22">Myers (2003)</xref> for the case of a single recombination, if one of the three possibilities illustrated in <xref ref-type="fig" rid="F13">Figure 13</xref> appears as a subgraph of the ARG, the gene conversion is guaranteed to be detectable. Note that there is some flexibility in the arrangement of events, as the positions of <italic>A</italic> and <italic>C</italic> can be interchanged, and additional coalescence events can be added to the recombination loop. Note also that the sub-graphs corresponding to sections [0, <italic>z<sub>2</sub></italic>) and (<italic>z</italic><sub>1</sub>,1] of the genome each must have one of the configurations given in <xref ref-type="fig" rid="F7">Figure 7</xref>.</p><sec id="S21"><label>5.1</label><title>Probability gene conversion is detectable if it occurs when there are <italic>k</italic> – 1 lineages in the ARG</title><p id="P69">The recursion relations for this scenario take a similar form to those described in <xref ref-type="sec" rid="S13">Section 4.1</xref>, conditioning on a single gene conversion in the genealogy, occurring at time <italic>t</italic> and resulting in a transition from <italic>k</italic> – 1 ≤ <italic>n</italic> to <italic>k</italic> lineages in the ARG. Let <italic>i</italic> (resp. <italic>j</italic>) denote the state of the left (resp. right) recombinant lineage, as detailed in full in the <xref ref-type="supplementary-material" rid="SD1">Appendix, Tables 3</xref> and <xref ref-type="supplementary-material" rid="SD1">4</xref>. At time <italic>t′</italic> ≥ <italic>t</italic>, let <inline-formula><mml:math id="M25"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> denote the probability that the gene conversion will be detectable, given there are currently <italic>n<sub>l</sub></italic> lineages in the ARG (including the two recombinant lineages), with the left recombinant lineage <italic>ɛ</italic> being in state <italic>i</italic> and the right lineage <italic>ℱ</italic> in state <italic>j</italic>. Note that unlike the case of crossover recombination, there is now a broken symmetry as two mutations on the flanking parts of the genome (purple segments in <xref ref-type="fig" rid="F11">Figure 11</xref>) are needed, and only one on the conversion tract (orange segment), so the set of possible states differs for <italic>ɛ</italic> and <italic>ℱ</italic>.</p><p id="P70">The full system of recursions is included in the <xref ref-type="supplementary-material" rid="SD1">Appendix, Section A.5</xref>. These equations are formed by considering the next state that could be reached in the ARG, and applying the law of total probability. As some events will not change the state of the ARG, the recursive equations can be expressed as <disp-formula id="FD11"><mml:math id="M26"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>total</mml:mtext><mml:mtext>rate</mml:mtext><mml:mtext>of</mml:mtext><mml:mtext>events</mml:mtext><mml:mtext>that</mml:mtext><mml:mtext>change</mml:mtext><mml:mtext>the</mml:mtext><mml:mtext>ARG</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mtext>rate</mml:mtext><mml:mtext>of</mml:mtext><mml:mtext>event</mml:mtext><mml:mtext>that</mml:mtext><mml:mtext>results</mml:mtext><mml:mtext>in</mml:mtext><mml:mtext>transition</mml:mtext><mml:mtext>between</mml:mtext><mml:mtext>states</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P71">Events which change the state of the ARG include coalescences and mutations (as the position of the gene conversion event is separately conditioned upon). Each equation takes the general form <disp-formula id="FD12"><mml:math id="M27"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mi>∑</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>g<sub>i,j</sub></italic>(<italic>θ</italic>) are linear functions of <italic>θ</italic> which are different for each pair of states (<italic>i,j</italic>), and <inline-formula><mml:math id="M28"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The recursive system is solved to find <inline-formula><mml:math id="M29"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></sec><sec id="S22"><label>5.2</label><title>Probability gene conversion is detectable</title><p id="P72">Summing over <italic>k</italic> removes the conditioning on when the gene conversion event occurs, to give the desired probability <italic><bold>𝒫</bold><sup>n,ρ</sup></italic>, that a detectable gene conversion events occurs, conditional on precisely one such event in the history. We have <disp-formula id="FD13"><label>(6)</label><mml:math id="M30"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mo>𝒫</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P73">This is constructed as follows. Note that <inline-formula><mml:math id="M31"><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> describes the state of an ARG directly after the gene conversion (looking backwards in time), which took the number of lineages from <italic>k</italic> – 1 to k. Therefore, starting with a sample of size <italic>n</italic>, there must have been <italic>n</italic> – <italic>k</italic> coalescence events, followed by the gene conversion, followed by the a sequence of state changes that allow the gene conversion to be detectable. These events, respectively, have probabilities <disp-formula id="FD14"><mml:math id="M32"><mml:munderover><mml:mrow><mml:msup><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>P</mml:mi><mml:mn>4</mml:mn><mml:mi>ρ</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P74">Putting these together gives the numerator of <xref ref-type="disp-formula" rid="FD13">(6)</xref>. The denominator is constructed in a similar way, requiring <italic>n</italic> – <italic>k</italic> coalescent events followed by the gene conversion. After the gene conversion event, only a further <italic>k</italic> – 1 coalescences are required, with probability <disp-formula id="FD15"><mml:math id="M33"><mml:munderover><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mspace width="0.2em"/></mml:msup></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P75"><xref ref-type="fig" rid="F13">Figure 13 (a)</xref> shows that detection probabilities for gene conversion events behave very similarly to those for detecting a single recombination (<xref ref-type="bibr" rid="R22">Myers, 2003</xref>), though are consistently slightly lower, as the gene conversion requires more mutation events to be detectable. Note that the asymptotic probability as <italic>θ</italic> → ∞ tends to the probability that a single recombination changes the ARG topology. In <xref ref-type="fig" rid="F13">Figure 13 (b)</xref>, the length of the conversion tract is varied; for scenarios where either the conversion tract, or its complement, is particularly short, the probability of detection decreases, as there is a lower probability of a mutation falling on the shorter section. As the mutation rate is assumed to be uniform across the genome, a conversion length of 1/3 gives the highest probabilities of detection.</p></sec></sec><sec id="S23" sec-type="discussion"><label>6</label><title>Discussion</title><p id="P76">In this article, we have calculated the probability of recovering the tree or ARG topology under the coalescent with recombination, when the ARG topology is constrained to be in the shape of a galled tree. Galled trees have several attractive combinatorial and algorithmic properties that do not hold for general ARGs. We have explicitly calculated the probability of an ARG being a galled tree, shedding light on how applicable these results might be in the analysis of real data. Our results indicate that genealogies in the form of galled trees are reasonably likely to be seen for <italic>ρ</italic> &lt; 1 with moderate sample size.</p><p id="P77">Our results can also shed light on some theoretical properties of genealogical reconstruction algorithms. While some recently developed methods can handle impressive quantities of sequencing data, they are based on heuristic methods, making it difficult to obtain theoretical insights into their performance. In particular, while tsinfer (<xref ref-type="bibr" rid="R18">Kelleher et al., 2019</xref>) retains polytomies (i.e. nodes with more than two child lineages) where the order of co-alescence events cannot be resolved unambiguously, many other algorithms resolve the order of events randomly. Our results give a sense of how many such polytomies might be present in the history of a dataset, and how likely recombination events are to be detectable for a given value of evolutionary parameters. This provides an upper bound on how well genealogies can be reconstructed, even if the algorithm utilises all of the available sequencing data to the fullest extent.</p><p id="P78">In the absence of recombination, our results demonstrate that allowing a small number of unresolved internal edges can greatly improve the probability of reconstructing the rest of the tree correctly. This suggests that, for certain values of the parameters, there are likely to be a relatively small number of edges in the genealogy which are not supported by mutations and could be placed at many plausible positions.</p><p id="P79">For large sample sizes, the probability of recovering the tree or ARG topology with a high level of certainty is minuscule, for reasonable values of the mutation rate (such as those estimated for SARS-CoV-2). This strengthens the case for using Bayesian methods to integrate over the uncertainty of branch placements, or utilising additional data to resolve ambiguous event ordering. For instance, <xref ref-type="bibr" rid="R24">Ramazzotti et al. (2021)</xref> analysed variant frequencies using SARS-CoV-2 intra-host sequencing data, in order to resolve the ordering of transmission events in genealogies built using consensus sequences (i.e. at the level of one sequence per infected host).</p><p id="P80">For tractability, our analysis has focused on the particular case where the ARG topology is that of a galled tree, under the coalescent with recombination. A natural extension of this work would be to consider general ARGs and other models, with more complex scenarios that might include multiple loci or non-constant population size.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Materials</label><media xlink:href="EMS136542-supplement-Supplementary_Materials.pdf" mimetype="application" mime-subtype="pdf" id="d27aAdGbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S24"><title>Acknowledgements</title><p>We thank Paul Jenkins for useful comments, and two anonymous reviewers for valuable suggestions. This work was supported by the EPSRC and MRC OxWaSP Centre for Doctoral Training (EPSRC grant EP/L016710/1), and by the Alan Turing Institute (EPSRC grant EP/N510129/1).</p></ack><ref-list><ref id="R1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Buneman</surname><given-names>P</given-names></name></person-group><chapter-title>The recovery of trees from measures of dissimilarity</chapter-title><person-group person-group-type="editor"><name><surname>Hodson</surname><given-names>FR</given-names></name><name><surname>Kendall</surname><given-names>DG</given-names></name><name><surname>Tautu</surname><given-names>P</given-names></name></person-group><source>Mathematics in the Archeological and Historical Sciences</source><publisher-name>Edinburgh University Press</publisher-name><publisher-loc>Edinburgh</publisher-loc><year>1971</year><fpage>387</fpage><lpage>395</lpage></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>AH</given-names></name><name><surname>Jenkins</surname><given-names>PA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>Genome-wide fine-scale recombination rate variation in Drosophila melanogaster</article-title><source>PLoS Genetics</source><year>2012</year><volume>8</volume><issue>12</issue><elocation-id>e1003090</elocation-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duchene</surname><given-names>S</given-names></name><name><surname>Featherstone</surname><given-names>L</given-names></name><name><surname>Haritopoulou-Sinanidou</surname><given-names>M</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Lemey</surname><given-names>P</given-names></name><name><surname>Baele</surname><given-names>G</given-names></name></person-group><article-title>Temporal signal and the phylodynamic threshold of SARS-CoV-2</article-title><source>Virus Evolution</source><year>2020</year><volume>6</volume><issue>2</issue></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ethier</surname><given-names>S</given-names></name><name><surname>Griffiths</surname><given-names>R</given-names></name></person-group><article-title>On the two-locus sampling distribution</article-title><source>Journal of Mathematical Biology</source><year>1990</year><volume>29</volume><issue>2</issue><fpage>131</fpage><lpage>159</lpage></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Y-X</given-names></name><name><surname>Li</surname><given-names>W-H</given-names></name></person-group><article-title>Statistical tests of neutrality of mutations</article-title><source>Genetics</source><year>1993</year><volume>133</volume><issue>3</issue><fpage>693</fpage><lpage>709</lpage></element-citation></ref><ref id="R6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Griffiths</surname><given-names>RC</given-names></name><name><surname>Marjoram</surname><given-names>P</given-names></name></person-group><chapter-title>An ancestral recombination graph</chapter-title><person-group person-group-type="editor"><name><surname>Donnelly</surname><given-names>P</given-names></name><name><surname>Tavare</surname><given-names>S</given-names></name></person-group><source>Progress in population genetics and human evolution</source><publisher-name>Springer</publisher-name><publisher-loc>New York</publisher-loc><year>1997</year><fpage>257</fpage><lpage>270</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gusfield</surname><given-names>D</given-names></name></person-group><source>ReCombinatorics: The algorithmics of ancestral recombination graphs and explicit phylogenetic networks</source><publisher-name>MIT press</publisher-name><publisher-loc>Cambridge, Massachusetts</publisher-loc><year>2014</year></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gusfield</surname><given-names>D</given-names></name><name><surname>Eddhu</surname><given-names>S</given-names></name><name><surname>Langley</surname><given-names>C</given-names></name></person-group><article-title>Optimal, efficient reconstruction of phylogenetic networks with constrained recombination</article-title><source>Journal of Bioinformatics and Computational Biology</source><year>2004</year><volume>2</volume><issue>01</issue><fpage>173</fpage><lpage>213</lpage></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heath</surname><given-names>TA</given-names></name><name><surname>Hedtke</surname><given-names>SM</given-names></name><name><surname>Hillis</surname><given-names>DM</given-names></name></person-group><article-title>Taxon sampling and the accuracy of phylogenetic analyses</article-title><source>Journal of Systematics and Evolution</source><year>2008</year><volume>46</volume><issue>3</issue><fpage>239</fpage></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hillis</surname><given-names>DM</given-names></name></person-group><article-title>Taxonomic sampling, phylogenetic accuracy, and investigator bias</article-title><source>Systematic Biology</source><year>1998</year><volume>47</volume><issue>1</issue><fpage>3</fpage><lpage>8</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hillis</surname><given-names>DM</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Swofford</surname><given-names>DL</given-names></name></person-group><article-title>Hobgoblin of phylogenetics?</article-title><source>Nature</source><year>1994</year><volume>369</volume><issue>6479</issue><fpage>363</fpage><lpage>364</lpage></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hobolth</surname><given-names>A</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name></person-group><article-title>The genealogy, site frequency spectrum and ages of two nested mutant alleles</article-title><source>Theoretical Population Biology</source><year>2009</year><volume>75</volume><issue>4</issue><fpage>260</fpage><lpage>5</lpage></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Kaplan</surname><given-names>NL</given-names></name></person-group><article-title>Statistical properties of the number of recombination events in the history of a sample of DNA sequences</article-title><source>Genetics</source><year>1985</year><volume>111</volume><issue>1</issue><fpage>147</fpage><lpage>164</lpage></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>PA</given-names></name><name><surname>Mueller</surname><given-names>JW</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>General triallelic frequency spectrum under demographic models with variable population size</article-title><source>Genetics</source><year>2014</year><volume>196</volume><fpage>295</fpage><lpage>311</lpage></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>PA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>Closed-form two-locus sampling distributions: accuracy and universality</article-title><source>Genetics</source><year>2009</year><volume>183</volume><issue>3</issue><fpage>1087</fpage><lpage>1103</lpage></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>PA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>An asymptotic sampling formula for the coalescent with recombination</article-title><source>The Annals of Applied Probability</source><year>2010</year><volume>20</volume><issue>3</issue><fpage>1005</fpage></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>PA</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>The effect of recurrent mutation on the frequency spectrum of a segregating site and the age of an allele</article-title><source>Theoretical Population Biology</source><year>2011</year><volume>80</volume><issue>2</issue><fpage>158</fpage><lpage>173</lpage></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelleher</surname><given-names>J</given-names></name><name><surname>Wong</surname><given-names>Y</given-names></name><name><surname>Wohns</surname><given-names>AW</given-names></name><name><surname>Fadil</surname><given-names>C</given-names></name><name><surname>Albers</surname><given-names>PK</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name></person-group><article-title>Inferring whole-genome histories in large population datasets</article-title><source>Nature Genetics</source><year>2019</year><volume>51</volume><issue>9</issue><fpage>1330</fpage><lpage>1338</lpage></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name></person-group><article-title>Large-scale phylogenies and measuring the performance of phylogenetic estimators</article-title><source>Systematic Biology</source><year>1998</year><volume>47</volume><issue>1</issue><fpage>43</fpage><lpage>60</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Guan</surname><given-names>X</given-names></name><name><surname>Wu</surname><given-names>P</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Tong</surname><given-names>Y</given-names></name><name><surname>Ren</surname><given-names>R</given-names></name><name><surname>Leung</surname><given-names>KS</given-names></name><name><surname>Lau</surname><given-names>EH</given-names></name><name><surname>Wong</surname><given-names>JY</given-names></name><etal/></person-group><article-title>Early transmission dynamics in Wuhan, China, of novel coronavirus-infected pneumonia</article-title><source>New England Journal of Medicine</source><year>2020</year><volume>382</volume><fpage>1199</fpage><lpage>1207</lpage></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname><given-names>NF</given-names></name><name><surname>Kistler</surname><given-names>KE</given-names></name><name><surname>Bedford</surname><given-names>T</given-names></name></person-group><article-title>Recombination patterns in coronaviruses</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type="doi">10.1101/2021.04.28.441806</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>S</given-names></name></person-group><source>The detection of recombination events using DNA sequence data</source><publisher-name>Ph.D. thesis, University of Oxford, Department of Statistics</publisher-name><year>2003</year></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollock</surname><given-names>DD</given-names></name><name><surname>Zwickl</surname><given-names>DJ</given-names></name><name><surname>McGuire</surname><given-names>JA</given-names></name><name><surname>Hillis</surname><given-names>DM</given-names></name></person-group><article-title>Increased taxon sampling is advantageous for phylogenetic inference</article-title><source>Systematic biology</source><year>2002</year><volume>51</volume><issue>4</issue><fpage>664</fpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramazzotti</surname><given-names>D</given-names></name><name><surname>Angaroni</surname><given-names>F</given-names></name><name><surname>Maspero</surname><given-names>D</given-names></name><name><surname>Gambacorti-Passerini</surname><given-names>C</given-names></name><name><surname>Antoniotti</surname><given-names>M</given-names></name><name><surname>Graudenzi</surname><given-names>A</given-names></name><name><surname>Piazza</surname><given-names>R</given-names></name></person-group><article-title>Verso: a comprehensive framework for the inference of robust phylogenies and the quantification of intra-host genomic diversity of viral samples</article-title><source>Patterns</source><year>2021</year><volume>2</volume><issue>3</issue><elocation-id>100212</elocation-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rasmussen</surname><given-names>MD</given-names></name><name><surname>Hubisz</surname><given-names>MJ</given-names></name><name><surname>Gronau</surname><given-names>I</given-names></name><name><surname>Siepel</surname><given-names>A</given-names></name></person-group><article-title>Genome-wide inference of ancestral recombination graphs</article-title><source>PLoS Genetics</source><year>2014</year><volume>10</volume><issue>5</issue><elocation-id>e1004342</elocation-id></element-citation></ref><ref id="R26"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sargsyan</surname><given-names>O</given-names></name></person-group><source>Analytical and simulation results for the general coalescent</source><publisher-name>Ph.D. thesis, University of Southern California</publisher-name><year>2006</year></element-citation></ref><ref id="R27"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Semple</surname><given-names>C</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><source>Phylogenetics</source><publisher-name>Oxford University Press</publisher-name><publisher-loc>Oxford</publisher-loc><year>2003</year></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>A concise necessary and sufficient condition for the existence of a galled-tree</article-title><source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source><year>2006</year><volume>3</volume><issue>2</issue><fpage>186</fpage><lpage>191</lpage></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>YS</given-names></name><name><surname>Ding</surname><given-names>Z</given-names></name><name><surname>Gusfield</surname><given-names>D</given-names></name><name><surname>Langley</surname><given-names>CH</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name></person-group><article-title>Algorithms to distinguish the role of gene-conversion from single-crossover recombination in the derivation of SNP sequences in populations</article-title><source>Journal of Computational Biology</source><year>2008</year><volume>14</volume><issue>10</issue><fpage>1273</fpage><lpage>86</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>YS</given-names></name><name><surname>Hein</surname><given-names>J</given-names></name></person-group><article-title>Constructing minimal ancestral recombination graphs</article-title><source>Journal of Computational Molecular Cell Biology</source><year>2005</year><volume>12</volume><issue>2</issue><fpage>147</fpage><lpage>169</lpage></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speidel</surname><given-names>L</given-names></name><name><surname>Forest</surname><given-names>M</given-names></name><name><surname>Shi</surname><given-names>S</given-names></name><name><surname>Myers</surname><given-names>S</given-names></name></person-group><article-title>A method for genome-wide genealogy estimation for thousands of samples</article-title><source>Nature Genetics</source><year>2019</year><volume>51</volume><issue>9</issue><fpage>1321</fpage><lpage>1329</lpage></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>Perfect phylogenetic networks with recombination</article-title><source>Journal of Computational Biology</source><year>2001</year><volume>8</volume><issue>1</issue><fpage>69</fpage><lpage>78</lpage></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiuf</surname><given-names>C</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>Conditional genealogies and the age of a neutral mutant</article-title><source>Theoretical Population Biology</source><year>1999</year><volume>56</volume><issue>2</issue><fpage>183</fpage><lpage>201</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Examples of tree topologies that are and are not recoverable.</title><p>Mutations are shown as dots, labelled by the site they affect; internal edges that do not carry a mutation are marked with red stars.</p></caption><graphic xlink:href="EMS136542-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Probability of tree being (partially) recoverable.</title><p>Panels (a)-(c) show the probabilities for different values of the mutation rate against sample size, for a range of <italic>n</italic><sub>0</sub> (colours) taken to be a given percentage of the total number of internal edges in the tree (rounded down to the nearest integer). Panel (d) shows the probabilities for a fixed sample size <italic>n</italic> = 20 against <italic>θ</italic>, for a range of <italic>n</italic><sub>0</sub> (colours).</p></caption><graphic xlink:href="EMS136542-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Example of a tree with a single lineage of interest (highlighted in red).</title></caption><graphic xlink:href="EMS136542-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p>Probability of unambiguously reconstructing the history of a single lineage (left panel: unambiguously, right panel: with up to <italic>n</italic><sub>0</sub> unresolved internal branches). Note the longer scale on the <italic>x</italic>-axis in panel (b).</p></caption><graphic xlink:href="EMS136542-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><p>Left panel: ARG with two recombinations which is a galled tree (the recombination loops do not interact). Right panel: ARG that is not a galled tree, as the two recombinations loops are intertwined.</p></caption><graphic xlink:href="EMS136542-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Probability that an ARG is a galled tree for varying parameter values and sample size.</title></caption><graphic xlink:href="EMS136542-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><p>Positioning of mutations on the ARG with a single recombination that are required for the recombination to be detectable. Ancestral type is assumed to be 00.</p></caption><graphic xlink:href="EMS136542-f007"/></fig><fig id="F8" position="float"><label>Figure 8</label><caption><p>Progression of the recombinant lineage <italic>ɛ</italic> through the states described in table 2. Note the mutations coloured green, which create incompatible sites in the data. Entries ‘D’ in the table (right panel) shows the combination of left and right lineage states that lead to the ARG being recoverable (if the loop closes when the two lineages are in the corresponding states). Entry ‘S’ indicates the start position of the two lineages directly after the recombination event.</p></caption><graphic xlink:href="EMS136542-f008"/></fig><fig id="F9" position="float"><label>Figure 9</label><caption><title>Probabilities of the ARG being (partially) recoverable conditional on one recombination.</title></caption><graphic xlink:href="EMS136542-f009"/></fig><fig id="F10" position="float"><label>Figure 10</label><caption><title>Probabilities of the ARG being (partially) recoverable, conditioning on two galled recombinations.</title></caption><graphic xlink:href="EMS136542-f010"/></fig><fig id="F11" position="float"><label>Figure 11</label><caption><title>Crossover recombination with breakpoint at position <italic>z</italic><sub>1</sub>(left panel), and gene conversion with conversion tract between positions <italic>z</italic><sub>1</sub> and <italic>z<sub>2</sub></italic> (right panel).</title></caption><graphic xlink:href="EMS136542-f011"/></fig><fig id="F12" position="float"><label>Figure 12</label><caption><p>Conditions for a gene conversion to be detectable. Gene conversion nodes are labelled with the breakpoint positions. Each mutation is labelled by the section of the genome on which it must occur.</p></caption><graphic xlink:href="EMS136542-f012"/></fig><fig id="F13" position="float"><label>Figure 13</label><caption><title>Probability of gene conversion being detectable.</title></caption><graphic xlink:href="EMS136542-f013"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>States described for the left recombinant edge denoted <italic>ɛ</italic></title></caption><table frame="void" rules="all"><tbody><tr><td align="left" valign="top">State 0</td><td align="left" valign="top">No coalescence has occurred on edge <italic>ɛ</italic> since the recombination.</td></tr><tr><td align="left" valign="top">State 1</td><td align="left" valign="top">There has been at least one coalescence on edge <italic>ɛ</italic> since the recombination. No mutations have occurred on edge <italic>ɛ</italic> since the last coalescence.</td></tr><tr><td align="left" valign="top">State 2</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 1 and a type <italic>A</italic> mutation has occurred since the last coalescence.</td></tr><tr><td align="left" valign="top">State 3</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 2 and undergone one further coalescence.</td></tr><tr><td align="left" valign="top">State 4</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 3 and a type <italic>B</italic> mutation has occurred since the last coalescence.</td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><title>States are described for the left recombinant edge denoted <italic>ɛ</italic> (third column gives the index that counts the number of lineages in each state).</title></caption><table frame="void" rules="all"><tbody><tr><td align="left" valign="top">State 0</td><td align="left" valign="top">No coalescence has occurred on edge <italic>ɛ</italic> since the recombination.</td><td align="left" valign="top"><italic>a</italic></td></tr><tr><td align="left" valign="top">State 1</td><td align="left" valign="top">There has been at least one coalescence since the recombination. No mutations have occurred since the last coalescence.</td><td align="left" valign="top"><italic>b</italic></td></tr><tr><td align="left" valign="top">State 2</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 1 and mutations <italic>not</italic> including a type A mutation have occurred since the last coalescence.</td><td align="left" valign="top"><italic>c</italic><sub>2</sub></td></tr><tr><td align="left" valign="top">State 3</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 1 and mutations including a type A mutation have occurred since the last coalescence.</td><td align="left" valign="top"><italic>c</italic><sub>1</sub></td></tr><tr><td align="left" valign="top">State 4</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 3 and undergone one further coalescence.</td><td align="left" valign="top"><italic>d</italic><sub>1</sub></td></tr><tr><td align="left" valign="top">State 5</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 4 and mutations <italic>not</italic> including a type B mutation have occurred since the last coalescence.</td><td align="left" valign="top"><italic>e</italic><sub>2</sub></td></tr><tr><td align="left" valign="top">State 6</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 4 and mutations including a type B mutation have occurred since the last coalescence.</td><td align="left" valign="top"><italic>e</italic><sub>1</sub></td></tr><tr><td align="left" valign="top">State 7</td><td align="left" valign="top"><italic>ɛ</italic> has reached state 6 and undergone one further coalescence.</td><td align="left" valign="top"><italic>d</italic><sub>2</sub></td></tr></tbody></table></table-wrap></floats-group></article>