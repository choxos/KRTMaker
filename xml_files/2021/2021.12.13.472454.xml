<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="preprint">
<?all-math-mml yes?>
<?use-mml?>
<?origin ukpmcpa?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
<journal-title-group>
<journal-title>bioRxiv : the preprint server for biology</journal-title>
</journal-title-group>
<issn pub-type="ppub"/>
</journal-meta>
<article-meta>
<article-id pub-id-type="manuscript">EMS141132</article-id>
<article-id pub-id-type="doi">10.1101/2021.12.13.472454</article-id>
<article-id pub-id-type="archive">PPR431725</article-id>
<article-version article-version-type="publisher-id">1</article-version>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>TopHap: Rapid inference of key phylogenetic structures from common haplotypes in large genome collections with limited diversity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Caraballo-Ortiz</surname>
<given-names>Marcos A.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="fn" rid="FN1">x</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Miura</surname>
<given-names>Sayaka</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="fn" rid="FN1">x</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sanderford</surname>
<given-names>Maxwell</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dolker</surname>
<given-names>Tenzin</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tao</surname>
<given-names>Qiqing</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Weaver</surname>
<given-names>Steven</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pond</surname>
<given-names>Sergei L. K.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kumar</surname>
<given-names>Sudhir</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="aff" rid="A3">3</xref>
<xref ref-type="corresp" rid="CR1">*</xref>
</contrib>
</contrib-group>
<aff id="A1">
<label>1</label>Institute for Genomics and Evolutionary Medicine</aff>
<aff id="A2">
<label>2</label>Department of Biology, Temple University, Philadelphia, PA 19122, USA</aff>
<aff id="A3">
<label>3</label>Center of Excellence in Genome Medicine Research, King Abdulaziz University, Saudi Arabia</aff>
<author-notes>
<corresp id="CR1">
<label>*</label>To whom correspondence should be addressed. Contact <email>s.kumar@temple.edu</email>
</corresp>
<fn id="FN1">
<label>x</label>
<p id="P1">Joint first authors.</p>
</fn>
</author-notes>
<pub-date pub-type="nihms-submitted">
<day>07</day>
<month>02</month>
<year>2022</year>
</pub-date>
<pub-date pub-type="preprint">
<day>14</day>
<month>12</month>
<year>2021</year>
</pub-date>
<permissions>
<ali:free_to_read/>
<license>
<ali:license_ref>https://creativecommons.org/licenses/by-nd/4.0/</ali:license_ref>
<license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nd/4.0/">CC BY-ND 4.0 International license</ext-link>.</license-p>
</license>
</permissions>
<abstract>
<sec id="S1">
<title>Motivation</title>
<p id="P2">Building reliable phylogenies from very large collections of sequences with a limited number of phylogenetically informative sites is challenging because sequencing errors and recurrent/backward mutations interfere with the phylogenetic signal, confounding true evolutionary relationships. Massive global efforts of sequencing genomes and reconstructing the phylogeny of SARS-CoV-2 strains exemplify these difficulties since there are only hundreds of phylogenetically informative sites and millions of genomes. For such datasets, we set out to develop a method for building the phylogenetic tree of genomic haplotypes consisting of positions harboring common variants to improve the signal-to-noise ratio for more accurate phylogenetic inference of resolvable phylogenetic features.</p>
</sec>
<sec id="S2">
<title>Results</title>
<p id="P3">We present the <italic>TopHap</italic> approach that determines spatiotemporally common haplotypes of common variants and builds their phylogeny at a fraction of the computational time of traditional methods. To assess topological robustness, we develop a bootstrap resampling strategy that resamples genomes spatiotemporally. The application of <italic>TopHap</italic> to build a phylogeny of 68,057 genomes (68KG) produced an evolutionary tree of major SARS-CoV-2 haplotypes. This phylogeny is concordant with the mutation tree inferred using the co-occurrence pattern of mutations and recovers key phylogenetic relationships from more traditional analyses. We also evaluated alternative roots of the SARS-CoV-2 phylogeny and found that the earliest sampled genomes in 2019 likely evolved by four mutations of the most recent common ancestor of all SARS-CoV-2 genomes. An application of <italic>TopHap</italic> to more than 1 million genomes reconstructed the most comprehensive evolutionary relationships of major variants, which confirmed the 68KG phylogeny and provided evolutionary origins of major variants of concern.</p>
</sec>
<sec id="S3">
<title>Availability</title>
<p id="P4">
<italic>TopHap</italic> is available on the web at <ext-link ext-link-type="uri" xlink:href="https://github.com/SayakaMiura/TopHap">https://github.com/SayakaMiura/TopHap</ext-link>.</p>
</sec>
</abstract>
</article-meta>
</front>
<body>
<sec id="S4" sec-type="intro">
<label>1</label>
<title>Introduction</title>
<p id="P5">The global health emergency caused by the SARS-CoV-2 coronavirus has catalyzed an unprecedented effort to sequence millions of genomes from all around the world and their analysis to reveal its origins and evolution (<xref ref-type="bibr" rid="R1">Andersen et al., 2020</xref>; <xref ref-type="bibr" rid="R6">Kumar et al., 2021</xref>; <xref ref-type="bibr" rid="R15">Rambaut et al., 2020</xref>). However, applying classical phylogenetic methods to infer the global SARS-CoV-2 phylogeny has been challenging (<xref ref-type="bibr" rid="R6">Kumar et al., 2021</xref>; <xref ref-type="bibr" rid="R10">Morel et al., 2020</xref>). This is partly because phylogenetically informative sites are relatively rare due to a low mutation rate and a short evolutionary period of the outbreak. Genome sequences contain random and systematic sequencing errors, which compete with informative phylogenetic variation and mislead phylogenetic inference (<xref ref-type="bibr" rid="R6">Kumar et al., 2021</xref>; <xref ref-type="bibr" rid="R10">Morel et al., 2020</xref>; <xref ref-type="bibr" rid="R14">Pipes et al., 2020</xref>). Consequently, the application of standard phylogenetic methods to the multiple sequencing alignment (MSA) of SARS-CoV-2 genomes has produced many equally plausible phylogenies, particularly when reconstructing early mutational history and the root of the SARS-CoV-2 phylogeny (<xref ref-type="bibr" rid="R12">Nie et al., 2020</xref>; <xref ref-type="bibr" rid="R14">Pipes et al., 2020</xref>; <xref ref-type="bibr" rid="R20">van Dorp et al., 2020</xref>).</p>
<p id="P6">
<xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> reconstructed a mutation tree using shared cooccurrence patterns of mutations occurring in &gt;1% of isolates. They applied and advanced a maximum likelihood method (SCITE, <xref ref-type="bibr" rid="R5">Jahn et al., 2016</xref>) that models false-positive and false-negative variant detections while assuming that recombination is absent (<xref ref-type="bibr" rid="R5">Jahn et al., 2016</xref>; <xref ref-type="bibr" rid="R6">Kumar et al., 2021</xref>). They reported success deciphering the earliest phases of SARS-CoV-2 evolution, including the most recent common ancestor (MRCA) genome, using common variants observed in the early stages of SARS-CoV-2 evolution. Based on the success in building the mutation tree using common variants, we hypothesized that it should be possible to build a reliable molecular phylogeny of major SARS-CoV-2 haplotypes by filtering out all genomic positions at which no minor allele rose to a frequency greater than 1%. Such filtering should effectively reduce the effect of the noise in making molecular phylogenetic inferences using standard approaches (e.g., the maximum likelihood [ML] method). If successful, one would prefer a traditional phylogenetic approach because it can better handle multiple substitutions at the same site (homoplasy) and use outgroup sequences more effectively than the mutation tree approaches.</p>
<p id="P7">However, excluding alignment sites with only low-frequency variants followed by applying a standard phylogenetic approach on remaining sites was unsuccessful. An example illustrates the problem in <xref ref-type="fig" rid="F1">figure 1</xref>. The ancestral genome contains only three polymorphic positions where derived alleles occur at high frequencies (#1, #2, and #3; <xref ref-type="fig" rid="F1">Fig. 1a</xref>). In this case, we expect to see at most four correct haplotypes in the absence of noise: three mutant strains (H1, H2, and H3) and one ancestral haplotype. The addition of a small number of sequencing errors and homoplasy generate additional haplotypes (e.g., H4, H5, and H6) that occur with very low frequency but still mislead an ML analysis (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). ML phylogenies place two spurious haplotypes (H5 and H6) near the root of the tree (<xref ref-type="fig" rid="F1">Fig. 1c</xref>), albeit without significant statistical support.</p>
<p id="P8">However, this behavior is rectified when one removes rare haplotypes (<xref ref-type="fig" rid="F1">Fig. 1d</xref>). This observation prompted us to develop a simple filtering procedure to identify <italic>common (top) haplotypes</italic> of <italic>common variants</italic> for molecular phylogenetic analysis. We first present this filtering process (the <italic>TopHap</italic> approach) and then apply it to infer the early evolutionary history of SARS-CoV-2 by using 68,057 genomes previously analyzed by <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> for a direct comparison of the <italic>TopHap</italic> phylogeny with the mutation tree generated by using patterns of co-occurrence of variants.</p>
</sec>
<sec id="S5" sec-type="methods">
<label>2</label>
<title>Methods</title>
<sec id="S6">
<label>2.1</label>
<title>The <italic>TopHap</italic> approach</title>
<p id="P9">As input, <italic>TopHap</italic> uses an MSA of genomes (<italic>n</italic> genomes and <italic>m</italic> base positions; <xref ref-type="fig" rid="F2">Fig. 2a</xref>). The first step is the selection of common variants by specifying a desired minor allele frequency threshold (e.g., <italic>maf</italic> &gt; 1%) without using any reference genomes. All alignment sites containing at least one allele with a frequency greater than <italic>maf</italic> and another allele with a frequency less than 1-<italic>maf</italic> are marked for inclusion (<italic>k</italic> variant positions). Every genome is then reduced to a haplotype on <italic>k</italic> retained sites. Next, unique haplotype sequences are identified, and their frequencies tallied.</p>
<p id="P10">
<italic>TopHap</italic> selects the top <italic>h</italic> haplotypes given a desired <italic>hf</italic> frequency cutoff. Now, the MSA contains <italic>h</italic> haplotypes, each <italic>k</italic> base positions long and tagged with its frequency. Outgroup genomes are added into the MSA by converting them into haplotypes containing only <italic>k</italic> selected positions. This reduced MSA is subjected to the phylogenetic analysis using standard methods, e.g., Maximum Parsimony (MP) or ML methods with models for analyzing datasets containing only polymorphic positions (<xref ref-type="bibr" rid="R7">Lewis, 2001</xref>; <xref ref-type="bibr" rid="R16">Schrempf et al., 2016</xref>; <xref ref-type="bibr" rid="R18">Stamatakis, 2014</xref>). This will produce the <italic>TopHap</italic> phylogeny of common haplotypes on common variants.</p>
<p id="P11">When information on sampling location and time of haplotypes is available, <italic>TopHap</italic> selects variants and haplotypes for each spatiotemporal slice of the dataset that is regionally (e.g., continent, country, or city) and/or temporally (e.g., monthly) partitioned (<xref ref-type="fig" rid="F2">Fig. 2b</xref>). Then, all the variants and haplotypes selected in spatiotemporal slices are pooled together. In this case, the same <italic>maf</italic> and <italic>hf</italic> thresholds are applied to each spatiotemporal slice.</p>
<sec id="S7">
<title>Calculation of bootstrap support</title>
<p id="P12">In the <italic>TopHap</italic> approach, bootstrap branch support for the inferred phylogeny of common haplotypes is calculated by resampling genomes to build bootstrap replicate datasets. This procedure assesses the robustness of the inferred phylogeny to the inclusion/exclusion of haplotypes likely created by sequencing errors and convergent changes that are expected to have relatively low frequencies spatiotemporally because the bootstrap resampling procedure is applied separately to each spatiotemporal slice and the final set of variants and haplotypes are pooled together. This genome resampling approach is different from Felsenstein’s bootstrap approach of resampling sites to build bootstrap replicate datasets, which is not useful for phylogenies in which many branches are expected to have fewer than three mutations. At least three mutations per branch are required to achieve a 95% confidence level even without any homoplasy in the standard bootstrap approach (<xref ref-type="bibr" rid="R4">Felsenstein, 1985</xref>; <xref ref-type="bibr" rid="R17">Soltis and Soltis, 2003</xref>).</p>
<p id="P13">Every bootstrap replicate dataset is subjected to phylogeny reconstruction to generate bootstrap replicate phylogenies. Haplotypes that do not appear in all the bootstrap replicates are then pruned from all the phylogenies. (Of course, one may choose to retain all haplotypes that occur in most of the bootstrap replicates.) Then a bootstrap consensus tree is generated. This consensus tree contains bootstrap support values on the inferred phylogeny.</p>
</sec>
<sec id="S8">
<title>Placement of additional haplotypes into the phylogeny</title>
<p id="P14">To place a new genome into the <italic>TopHap</italic> phylogeny, the first step is to transform it into a haplotype of <italic>k</italic> positions used to build the <italic>TopHap</italic> phylogeny. One may use an MP (e.g., UShER (<xref ref-type="bibr" rid="R19">Turakhia et al., 2021</xref>) and pplacer (<xref ref-type="bibr" rid="R9">Matsen et al., 2010</xref>)) or ML approach (RAxML-EPA (<xref ref-type="bibr" rid="R2">Berger et al., 2011</xref>)). When the intent is to place a genome with variant(s) in the genomic position that was not used to build the <italic>TopHap</italic> phylogeny, we rebuild the phylogeny by requiring that the position(s) of interest be always included during the <italic>TopHap</italic> analysis. This process takes only a few additional minutes and produces a phylogeny with haplotypes that contain the variant(s) of interest.</p>
</sec>
<sec id="S9">
<title>Annotations using Nextstrain and PANGO classifications</title>
<p id="P15">To compare <italic>TopHap</italic> phylogeny with the Nextstrain classification, we annotated all the <italic>TopHap</italic> haplotypes using the presence and absence of diagnostic Nextstrain mutations (<ext-link ext-link-type="uri" xlink:href="https://Nextstrain.org/ncov">https://Nextstrain.org/ncov</ext-link>). We also assigned a PANGO lineage to each genome in the data using the Phylogenetic Assignment of Named Global Outbreak Lineages (PANGOLIN) software (<xref ref-type="bibr" rid="R15">Rambaut et al., 2020</xref>). <italic>TopHap</italic> haplotype ID was also assigned for each genome when an observed haplotype was perfectly identical to a <italic>TopHap</italic> haplotype. Here, the same <italic>TopHap</italic> haplotypes may belong to more than one different PANGO lineage. In this case, we paired a <italic>TopHap</italic> haplotype with the major PANGO lineage.</p>
</sec>
</sec>
<sec id="S10">
<label>2.2</label>
<title>Genome Data Acquisition and Assembly</title>
<p id="P16">We obtained an MSA containing 68,057 genomes (hereafter, 68KG) of the SARS-CoV-2 coronavirus from human hosts analyzed in <xref ref-type="bibr" rid="R6">Kumar et al., (2021)</xref>. These genomes were obtained from the GISAID database (<ext-link ext-link-type="uri" xlink:href="https://www.gisaid.org">https://www.gisaid.org</ext-link>) and covered the period from December 24, 2019, until October 12, 2020. The 68KG alignment was generated after filtering 133,741 SARS-CoV-2 genomes, such that genomes shorter than 28,000 bases and those with many ambiguous bases were removed. Three outgroup coronavirus genomes were added to the alignment: <italic>Rhinolophus affinis</italic> (RaTG13) and <italic>R. malayanus</italic> (RmYN02) bats, and the <italic>Manis javanica</italic> pangolin (MT040335) (<xref ref-type="bibr" rid="R8">Liu et al., 2020</xref>; <xref ref-type="bibr" rid="R22">Zhou et al., 2020</xref>). Following the above procedure, we also assembled a dataset containing 1,106,862 genomes (hereafter 1MG) from the GISAID database covering the period from December 24, 2019, to September 11, 2021.</p>
</sec>
</sec>
<sec id="S11" sec-type="results">
<label>3</label>
<title>Results</title>
<p id="P17">We stratified sequence isolates by (month of sampling, country) attributes to select variants and haplotypes in the <italic>TopHap</italic> analysis of the 68KG dataset. We used spatial and regional <italic>maf</italic> and <italic>hf</italic> cut-offs of 5% to avoid including problematic variants and haplotypes created by recurrent/backward mutations and sequencing error, particularly because of the small number of genomes available for some spatiotemporal slices. We retained a data stratum that contained at least 500 genomes. When the number of genomes sampled from a country was less than 500, we manually pooled them with adjacent countries with sparse sampling, i.e., all genomes from these countries were pooled when they were located in the same continent. Also, the numbers of genomes in December 2019 and October 2020 were &lt;500, so we pooled them with January 2020 and September 2020 time slices, respectively.</p>
<p id="P18">We used the Maximum Parsimony approach to infer <italic>TopHap</italic> phylogeny because the dataset contained only variable sites. One hundred bootstrap replicate analyses were carried out following the procedure outlined in the <xref ref-type="sec" rid="S2">methods</xref> section. The whole <italic>TopHap</italic> analysis was completed in less than an hour, providing the spatiotemporal slices of 68K haplotypes composed of positions with <italic>maf</italic> &gt; 5%. The final tree consisted of 83 variable sites and 39 unique haplotypes (<xref ref-type="fig" rid="F3">Fig. 3</xref>). All but three groupings in this tree were highly supported (bootstrap confidence levels &gt; 95%), i.e., many inferences were robust to genome sampling (100 replicates). The other three groupings received &gt;80% bootstrap support. In the <italic>TopHap</italic> phylogeny, many branches were longer than one mutation, and many zerolength branches created multifurcations.</p>
<sec id="S12">
<title>Temporal trends in variant frequencies</title>
<p id="P19">The <italic>TopHap</italic> approach in the MP analysis of selected haplotypes does not use the temporal information of genomes (isolation day) nor observed variant frequency. Therefore, a <italic>TopHap</italic> phylogeny allows us to test the concordance between mutation occurrence time and variant frequency and those expected from the phylogeny. We first mapped mutations to every branch in the SARS-CoV-2 phylogeny by reconstructing the most parsimonious ancestral states and minimum evolution. All mutations were mapped unambiguously (<xref ref-type="fig" rid="F3">Fig. 3</xref>). In the <italic>TopHap</italic> phylogeny of haplotypes from the early pandemic (up to October 2020), the frequencies of variants mapped onto branches generally decreased from the root to tip on evolutionary lineages (e.g., <xref ref-type="fig" rid="F4">Fig 4a</xref>). For example, the mutant bases mapping to the earliest diverging branches in the <italic>TopHap</italic> phylogeny occurred with the highest frequency in the 68KG dataset. Also, the timing of the first sampling date of variants increased on lineages from root to tip (<xref ref-type="fig" rid="F4">Fig 4b</xref>). This good concordance with those expected from the inferred <italic>TopHap</italic> phylogeny indicates that the observed patterns are consistent with the clonal evolution of SARS-CoV-2 during the early stage of the pandemic.</p>
</sec>
<sec id="S13">
<title>Comparing the TopHap phylogeny with the mutation tree</title>
<p id="P20">We compared the order of mutations in the <italic>TopHap</italic> phylogeny with the mutation tree inferred using the co-occurring mutations pattern by <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>. This is different from the MP analysis of <italic>TopHap</italic> haplotypes as it treated every variant position independently. For notational consistency, we used Greek symbols for variants when they were the same as those analyzed in <xref ref-type="bibr" rid="R6">Kumar et al. (2021</xref>, Supplementary Table 2). In total, 49 mutations were shared between 68K <italic>TopHap</italic> phylogeny (83 mutations) and the mutation tree in <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> (84 mutations). Thirty-four variants were unique to the <italic>TopHap</italic> phylogeny because those variants and corresponding haplotypes rose to high enough frequency (5% frequency) in at least one spatiotemporal slice (locale or month), but their global frequency was less than the 1% required by <xref ref-type="bibr" rid="R6">Kumar et al., (2021)</xref> in building the mutation tree. Thirty-five mutations analyzed in <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> were missing from the <italic>TopHap</italic> analysis because they never rose to 5% frequency in any time slice. So, we based our comparison of <italic>TopHap</italic> and mutation tree on 49 variants found in both analyses.</p>
<p id="P21">The inferred mutation order from the <italic>TopHap</italic> phylogeny is consistent with the mutation tree, except that some mutations on branches with multiple mutations were not resolved. For example, the mutation tree suggested that α<sub>2</sub> mutation preceded α<sub>3</sub>, but <italic>TopHap</italic> phylogeny does not resolve this transition because the corresponding intermediate haplotype did not occur with more than 5% frequency in any spatiotemporal slice. This <italic>TopHap</italic> result is reasonable because sequencing error may have created spurious transitional haplotypes (<xref ref-type="bibr" rid="R13">Pekar et al., 2021</xref>). At the same time, some multi-mutation branches in the <italic>TopHap</italic> phylogeny also correspond well with the unresolved branching order of mutations in <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>, which was suggested to be due to evolutionary bursts (e.g., three β mutations and three ε mutations).</p>
<p id="P22">The high concordance of <italic>TopHap</italic> phylogeny inferred, without making any assumptions about the lack of recombination, with the mutation tree inferred using variant co-occurrence patterns suggests that the early phases of SARS-CoV-2 evolution did not involve significant numbers of recombination and co-infections (see also <xref ref-type="bibr" rid="R21">Varabyou et al., 2021</xref>), which could have, otherwise, resulted in differences between the <italic>TopHap</italic> phylogeny and the mutation tree.</p>
</sec>
<sec id="S14">
<title>TopHap analysis with &gt;1 million SARS-CoV-2 genomes</title>
<p id="P23">Next, we analyzed a recent snapshot of SARS-CoV-2 genome collection acquired one year after the 68KG data set. After filtering incomplete genome sequences, we obtained an alignment of 1,106,862 genomes to build the 1MG dataset that was 16 times bigger than the 68KG dataset. Nevertheless, the <italic>TopHap</italic> analysis, including 100 bootstrap replicates, was completed in less than 3 hours. Using TopHap with <italic>hf</italic> &gt; 5% and <italic>maf</italic> &gt; 5%, we obtained a reduced MSA of 150 haplotypes with 675 variable sites. Therefore, the number of haplotypes increased only four-fold, and the number of variable sites increased by eight times. The inferred phylogeny from the 1MG data set (<xref ref-type="fig" rid="F6">Figure 6a</xref>) was supported with relatively high bootstrap values (&gt;80%) and concordant with the 68KG <italic>TopHap</italic> phylogeny. The order of early mutations (α<sub>1</sub>-α<sub>3</sub>, β<sub>1</sub>-β<sub>3</sub>, ε<sub>1</sub>-ε<sub>3</sub>, γ<sub>1</sub>, δ<sub>1</sub> and ν<sub>1</sub>-ν<sub>2</sub>) was the same for 1MG and 68KG <italic>TopHap</italic> phylogenies. Therefore, inferences about the early history reported for the 68KG data set were robust to the expanded sampling of genomes.</p>
<p id="P24">The 1MG <italic>TopHap</italic> phylogeny contains several branches with many mutations, which often lead to haplotypes that have been designated variants of concern (VOC) by WHO. This includes WHO-ALPHA, WHO-BETA, WHO-DELTA, WHO-ETA, WHO-GAMMA, and WHO-LAMBDA variants. We used the WHO-prefix to avoid conflicting between Kumar et al. notations for mutations and the WHO’s notation for multi-mutation strains. Notably, Kumar et al. mutation identifiers were proposed earlier, so we have retained them. The placement of these VOCs in <italic>TopHap</italic> is like that in the Nextstrain (<xref ref-type="fig" rid="F6">Fig. 6b and 6c</xref>). For example, both Nextstrain and <italic>TopHap</italic> reconstruct WHO-ALPHA, WHO-GAMMA, and WHO-LAMBDA to be sister lineages. Also, the N501Y Spike recurrent mutation (A23063T) occurred independently in WHO-ALPHA, WHO-GAMMA, and WHO-BETA lineages, inferred correctly by <italic>TopHap</italic> (<xref ref-type="fig" rid="F6">Fig. 6a</xref>).</p>
</sec>
<sec id="S15">
<title>Rooting the tree of SARS-CoV-2 genomes</title>
<p id="P25">We find that Nextstrain and PANGO phylogeny broadly agree with 68KG and 1MG <italic>TopHap</italic> phylogenies, except for the root position (<xref ref-type="fig" rid="F3">Fig. 3</xref>, <xref ref-type="fig" rid="F5">5</xref>, and <xref ref-type="fig" rid="F6">6</xref>). For example, clade 19A is at the root of the Nextstrain phylogeny, but <italic>TopHap</italic> phylogenies using the bat/pangolin outgroups suggest that Clade 19A is a derived clade. Based on 100 genome resamples, the bootstrap support was modest (&gt;66%) for the root of the <italic>TopHap</italic> phylogeny. But, no bootstrap replicates supported the Nextstrain rooting, and &lt;34% supported the PANGO rooting.</p>
<p id="P26">The <italic>TopHap</italic> rooting is the same as that implied by the mutation tree reported in <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>. <italic>TopHap</italic> root is also consistent with one of the two preferred roots in <xref ref-type="bibr" rid="R3">Bloom (2021)</xref>, who analyzed 13 additional partial genomes from only China until the end of January 2020. Key early mutations analyzed in <xref ref-type="bibr" rid="R3">Bloom (2021)</xref> contained an additional variable site (genomic position 29095), where the minor base occurred with a too low frequency to be included in the TopHap analysis (0.4% in the 68KG). So, we refer to it as mutation <italic>x</italic> (= 29095, U is minor, and C is major) and include it in the 68KG MSA. We also searched for other rare haplotypes to see if any other cluster at or near the root position in the 68KG <italic>TopHap</italic> phylogeny.</p>
<p id="P27">We found 936 additional unique haplotypes that occurred in the 68KG dataset more than once. We tested their placement one by one in the <italic>TopHap</italic> phylogeny by using RAxML-EPA (<xref ref-type="bibr" rid="R2">Berger et al., 2011</xref>). Only two were attached at or near the root. One of them had the same haplotype sequence as that of MRCA and was present in 17 isolates. This haplotype is the proCoV2 sequence reported by <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>, circulating in early 2020. The other haplotype differed from the proCoV2 sequence in two genomic positions (29095 [location of <italic>x</italic> variant] and 18060 [location of α<sub>1</sub> variant]). This haplotype is the same as what <xref ref-type="bibr" rid="R3">Bloom (2021)</xref> suggested to be important in rooting the SARS-CoV-2 phylogeny, which led us to consider five alternative scenarios based on <italic>TopHap</italic>, <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>, <xref ref-type="bibr" rid="R3">Bloom (2021)</xref>, Nextstrain, and PANGO (<xref ref-type="fig" rid="F7">Fig. 7</xref>) involving eight positions that experienced mutations (α<sub>1</sub>-α<sub>3</sub>, β<sub>1</sub>-β<sub>3</sub>, ν<sub>1</sub>-ν<sub>2</sub>, and <italic>x</italic>) and gave rise to seven major early haplotypes. Our evaluation of these five scenarios is the most detailed comparison to date because of the size of the dataset analyzed and the variants included. For example, V1 and V2 variants were absent in the analysis by <xref ref-type="bibr" rid="R3">Bloom (2021)</xref>, because genomes only sampled until the end of January 2020 were included, and variant <italic>x</italic> was missing from <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> analysis because its global frequency was less than 1% in the 68KG dataset.</p>
<p id="P28">We evaluated these five scenarios (topologies) using MP and ML optimally criteria (<xref ref-type="fig" rid="F7">Fig. 7</xref>). We used the key seven haplotypes with the eight positions (α<sub>1</sub>-α<sub>3</sub>, β<sub>1</sub>-β<sub>3</sub>, ν<sub>1</sub>-ν<sub>2</sub>, and <italic>x</italic>). MP suggests scenarios A, B, and C to be equally parsimonious, and D and E (PANGO and Nextstrain, respectively) to be less parsimonious by 1 and 3 mutations. Scenario D and E were also less likely than A, B, and C, where we estimated the loglikelihood (<italic>lnL</italic>) of all five scenarios (topologies) using a GTR model of nucleotide substitutions in MEGA for the haplotypes shown in <xref ref-type="fig" rid="F7">Fig. 7</xref>. While the log-likelihood of scenario A was the highest, it was only slightly higher than that for B and C that were equally likely. Among scenarios A, B, and C, <italic>x</italic> variant was lost in B, while the α<sub>1</sub> variant was acquired twice in A and lost in C.</p>
<p id="P29">In all the three equally most parsimonious scenarios (A, B, and C), the addition of mutation <italic>x</italic> pushes back the MRCA of SARS-CoV-2 by one mutation compared to the proCoV2 sequence of <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>. In these cases, the number of differences between Wuhan-1 and the MRCA is four (<xref ref-type="fig" rid="F7">Fig. 7</xref>). With a mutation rate range of 6.64 × 10<sup>−4</sup>−9.27 × 10<sup>−4</sup> substitutions per site per year (<xref ref-type="bibr" rid="R13">Pekar et al., 2021</xref>), we can estimate that proCoV2 existed 7.7–10.8 weeks before the December 24, 2019 sampling date of Wuhan-1. This places the progenitor of SARS-CoV-2 to have evolved in mid-September to Early-October 2019, which is earlier than the mid-November 2019 date favored by <xref ref-type="bibr" rid="R13">Pekar et al. (2021)</xref>. Pekar et al. used rooting in scenario D in which the lineage containing (α<sub>2</sub>-α<sub>3</sub> and β<sub>1</sub>-β<sub>3</sub>; PONGO B) is a sister group of the lineage containing α<sub>1</sub>and v<sub>1</sub>-v<sub>2</sub> (PONGO A). As noted above, this scenario receives lower bootstrap support than the alternative in which PONGO B arose from the ancestor containing α<sub>1</sub>. In this sense, <xref ref-type="bibr" rid="R13">Pekar et al. (2021)</xref> may have dated a later event in the SARS-CoV-2 phylogeny.</p>
</sec>
</sec>
<sec id="S16" sec-type="conclusions">
<label>4</label>
<title>Conclusions</title>
<p id="P30">The ongoing global efforts to monitor the evolution of the SARS-CoV-2 coronavirus have motivated hundreds of laboratories worldwide to generate genome sequences continuously. The number of genomes has grown quickly, becoming orders of magnitude greater than the genome size. Rapid growth, low sequence variability, and the presence of sequencing error have made the direct use of phylogenetic methods on genome alignments challenging for such data (e.g., <xref ref-type="bibr" rid="R10">Morel et al., 2020</xref>).</p>
<p id="P31">We have shown that the <italic>TopHap</italic> phylogeny for common variants and haplotypes in the 68KG SARS-CoV-2 dataset works well and agrees with the mutation tree produced using a mutation order approach (MOA) (<xref ref-type="bibr" rid="R6">Kumar et al., 2021</xref>). But, the <italic>TopHap</italic> approach offers some advantages over MOA. Firstly, MOA assumes the sequencing error rate to be constant throughout the outbreak, which is unlikely to hold for pathogenomic datasets acquired in different laboratories at different times. Secondly, MOA analysis needs to have mutant bases indicated at the outset, a limitation addressed by <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref>, but at a large computational expense. In contrast, <italic>TopHap</italic> analyses directly use outgroup in standard phylogenetic analysis. <italic>TopHap</italic> analysis is certainly more computationally efficient as the analysis of the 68KG dataset took only a few hours. In contrast, MOA took more than a week to compute.</p>
<p id="P32">Thirdly, <italic>TopHap</italic> analysis can use well-established methods to infer phylogeny and ancestral sequences to identify recurrent and backward mutations. In contrast, MOA assumes an infinite site model and, thus, is not suitable for detecting recurrent and backward mutations. Lastly, rarer haplotypes can also be attached to a backbone of a <italic>TopHap</italic> phylogeny by simply adding the genomic position of interest in constructing the MSA of haplotypes, as demonstrated above.</p>
<p id="P33">In conclusion, <italic>TopHap</italic> is a simple and effective method to build haplotype phylogenies and assess their statistical robustness. <italic>TopHap</italic> can be applied in any data containing a large number of sequences with a handful of variants, including other pathogens and tumor single-cell sequencing data that is now producing a large number of somatic cell sequences (<xref ref-type="bibr" rid="R11">Navin, 2015</xref>).</p>
</sec>
</body>
<back>
<ack id="S17">
<title>Acknowledgments</title>
<p>We thank Sudip Sharma for comments and everyone depositing genome data on GISAID (list at <ext-link ext-link-type="uri" xlink:href="http://igem.temple.edu/COVID-19">http://igem.temple.edu/COVID-19</ext-link>).</p>
<sec id="S18">
<title>Funding</title>
<p>This work has been supported by the U.S. National Science Foundation to S.K./S.M. (DEB-2034228) and S.P. (DBI-2027196) and U.S. National Institutes of Health to S.K. (GM 139504-01) and S.P. (AI-134384).</p>
</sec>
</ack>
<fn-group>
<fn id="FN2" fn-type="con">
<p id="P34">
<bold>Author contributions</bold>
</p>
<p id="P35">S.K. and S.M developed the original method, designed research; and implemented the technique; M.A.C.O., S.M., T.D., and Q.T. performed analyses; S.P. and S.W. assembled sequence alignments; and S.K., S.M., M.A.C.O., Q.T., and S.P. wrote the paper.</p>
</fn>
</fn-group>
<ref-list>
<ref id="R1">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Andersen</surname>
<given-names>KG</given-names>
</name>
<etal/>
</person-group>
<article-title>The proximal origin of sars-cov-2</article-title>
<source>Nat Med</source>
<year>2020</year>
<volume>26</volume>
<fpage>450</fpage>
<lpage>452</lpage>
</element-citation>
</ref>
<ref id="R2">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Berger</surname>
<given-names>SA</given-names>
</name>
<etal/>
</person-group>
<article-title>Performance, accuracy, and web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>
<source>Syst Biol</source>
<year>2011</year>
<volume>60</volume>
<fpage>291</fpage>
<lpage>302</lpage>
</element-citation>
</ref>
<ref id="R3">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bloom</surname>
<given-names>JD</given-names>
</name>
</person-group>
<article-title>Recovery of deleted deep sequencing data sheds more light on the early wuhan sars-cov-2 epidemic</article-title>
<source>Mol Biol Evol</source>
<year>2021</year>
<elocation-id>10.1093/molbev/msab246</elocation-id>
</element-citation>
</ref>
<ref id="R4">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Felsenstein</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Confidence limits on phylogenies: An approach using the bootstrap</article-title>
<source>Evolution</source>
<year>1985</year>
<volume>39</volume>
<fpage>783</fpage>
<lpage>791</lpage>
</element-citation>
</ref>
<ref id="R5">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Jahn</surname>
<given-names>K</given-names>
</name>
<etal/>
</person-group>
<year>2016</year>
<article-title>Tree inference for single-cell data</article-title>
<source>Genome Biology</source>
<volume>17</volume>
<fpage>86</fpage>
</element-citation>
</ref>
<ref id="R6">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kumar</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>
<article-title>An evolutionary portrait of the progenitor sars-cov-2 and itsdominant offshoots in covid-19 pandemic</article-title>
<source>Mol Biol Evol</source>
<year>2021</year>
<volume>38</volume>
<fpage>3046</fpage>
<lpage>3059</lpage>
</element-citation>
</ref>
<ref id="R7">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lewis</surname>
<given-names>PO</given-names>
</name>
</person-group>
<article-title>A likelihood approach to estimating phylogeny from discrete morphological character data</article-title>
<source>Syst Biol</source>
<year>2001</year>
<volume>50</volume>
<fpage>913</fpage>
<lpage>925</lpage>
</element-citation>
</ref>
<ref id="R8">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Liu</surname>
<given-names>P</given-names>
</name>
<etal/>
</person-group>
<article-title>Are pangolins the intermediate host of the 2019 novel coronavirus (sars-cov-2)?</article-title>
<source>PLoS Path</source>
<year>2020</year>
<volume>16</volume>
<elocation-id>e1008421</elocation-id>
</element-citation>
</ref>
<ref id="R9">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Matsen</surname>
<given-names>FA</given-names>
</name>
<etal/>
</person-group>
<article-title>Pplacer: Linear time maximum-likelihood and bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
<source>BMC Bioinformatics</source>
<year>2010</year>
<volume>11</volume>
<fpage>538</fpage>
</element-citation>
</ref>
<ref id="R10">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Morel</surname>
<given-names>B</given-names>
</name>
<etal/>
</person-group>
<article-title>Phylogenetic analysis of sars-cov-2 data is difficult</article-title>
<source>Mol Biol Evol</source>
<year>2020</year>
<volume>38</volume>
<fpage>1777</fpage>
<lpage>1791</lpage>
</element-citation>
</ref>
<ref id="R11">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Navin</surname>
<given-names>NE</given-names>
</name>
</person-group>
<article-title>The first five years of single-cell cancer genomics and beyond</article-title>
<source>Genome Res</source>
<year>2015</year>
<volume>25</volume>
<fpage>1499</fpage>
<lpage>1507</lpage>
</element-citation>
</ref>
<ref id="R12">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nie</surname>
<given-names>Q</given-names>
</name>
<etal/>
</person-group>
<article-title>Phylogenetic and phylodynamic analyses of sars-cov-2</article-title>
<source>Virus Res</source>
<year>2020</year>
<volume>287</volume>
<elocation-id>198098</elocation-id>
</element-citation>
</ref>
<ref id="R13">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pekar</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>
<article-title>Evidence against the veracity of sars-cov-2 genomes intermediate between lineages a and b</article-title>
<source>In Virologicalorg</source>
<year>2021</year>
</element-citation>
</ref>
<ref id="R14">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pipes</surname>
<given-names>L</given-names>
</name>
<etal/>
</person-group>
<article-title>Assessing uncertainty in the rooting of the sars-cov-2 phylogeny</article-title>
<source>Mol Biol Evol</source>
<year>2020</year>
<volume>38</volume>
<fpage>1537</fpage>
<lpage>1543</lpage>
</element-citation>
</ref>
<ref id="R15">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Rambaut</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<article-title>A dynamic nomenclature proposal for sars-cov-2 lineages to assist genomic epidemiology</article-title>
<source>Nat Microbiol</source>
<year>2020</year>
<volume>5</volume>
<fpage>1403</fpage>
<lpage>1407</lpage>
</element-citation>
</ref>
<ref id="R16">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schrempf</surname>
<given-names>D</given-names>
</name>
<etal/>
</person-group>
<article-title>Reversible polymorphism-aware phylogenetic models and their application to tree inference</article-title>
<source>J Theor Biol</source>
<year>2016</year>
<volume>407</volume>
<fpage>362</fpage>
<lpage>370</lpage>
</element-citation>
</ref>
<ref id="R17">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Soltis</surname>
<given-names>PS</given-names>
</name>
<name>
<surname>Soltis</surname>
<given-names>DE</given-names>
</name>
</person-group>
<article-title>Applying the bootstrap in phylogeny reconstruction</article-title>
<source>Stat Sci</source>
<year>2003</year>
<volume>18</volume>
<fpage>256</fpage>
<lpage>267</lpage>
</element-citation>
</ref>
<ref id="R18">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Stamatakis</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Raxml version 8: A tool for phylogenetic analysis and postanalysis of large phylogenies</article-title>
<source>Bioinformatics</source>
<year>2014</year>
<volume>30</volume>
<fpage>1312</fpage>
<lpage>1313</lpage>
</element-citation>
</ref>
<ref id="R19">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Turakhia</surname>
<given-names>Y</given-names>
</name>
<etal/>
</person-group>
<article-title>Ultrafast sample placement on existing trees (usher) enables real-time phylogenetics for the sars-cov-2 pandemic</article-title>
<source>Nat Genet</source>
<year>2021</year>
<volume>53</volume>
<fpage>809</fpage>
<lpage>816</lpage>
</element-citation>
</ref>
<ref id="R20">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>van Dorp</surname>
<given-names>L</given-names>
</name>
<etal/>
</person-group>
<article-title>Emergence of genomic diversity and recurrent mutations in sars-cov-2</article-title>
<source>Infect Genet Evol</source>
<year>2020</year>
<volume>83</volume>
<elocation-id>104351</elocation-id>
</element-citation>
</ref>
<ref id="R21">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Varabyou</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<article-title>Rapid detection of inter-clade recombination in sars-cov-2 with bolotie</article-title>
<source>Genetics</source>
<year>2021</year>
<volume>218</volume>
<elocation-id>iyab074</elocation-id>
</element-citation>
</ref>
<ref id="R22">
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhou</surname>
<given-names>P</given-names>
</name>
<etal/>
</person-group>
<article-title>A pneumonia outbreak associated with a new coronavirus of probable bat origin</article-title>
<source>Nature</source>
<year>2020</year>
<volume>579</volume>
<fpage>270</fpage>
<lpage>273</lpage>
</element-citation>
</ref>
</ref-list>
</back>
<floats-group>
<fig id="F1" position="float">
<label>Figure 1</label>
<caption>
<title>Traditional phylogenetic approach versus the new <italic>TopHap</italic> approach to manage a dataset that contains many sequences with few variants.</title>
<p>(<bold>a</bold>) The true tree showing three simulated haplotypes. In this example, three mutations (α, β, and γ) occurred sequentially and gave rise to haplotypes, H1, H2, and H3. The size of triangles at each tip is proportional to the number of genomes containing these haplotypes. (<bold>b</bold>) Phylogenetic approaches use a multiple sequence alignment, simplified here with only three informative variants. Due to sequencing errors, a few spurious haplotypes would be observed (red letters, i.e., H4–H6) in low haplotype frequencies (0.3%–1%). Inclusion of these spurious haplotypes misguides the maximum likelihood (ML) and other methods and distorts the evolutionary inference. (<bold>c</bold>) Results based on a typical ML approach would suggest that the spurious haplotypes H6 and H5, were the first to arise. The bootstrap support for all the branching patterns is low (21%–47%) because each branch is only one mutation long, a situation where the bootstrap method is known to be powerless (see text). (<bold>d</bold>) The <italic>TopHap</italic> approach was able to infer the correct tree because it uses high-frequency haplotypes to infer a phylogeny; the haplotypes with low frequencies – which are likely spurious due to sequencing errors – are removed.</p>
</caption>
<graphic xlink:href="EMS141132-f001"/>
</fig>
<fig id="F2" position="float">
<label>Figure 2</label>
<caption>
<title>Overview of the <italic>TopHap</italic> approach.</title>
<p>Input to <italic>TopHap</italic> is an alignment of genome sequences (<italic>n</italic> sequences, <italic>m</italic> bases each). <italic>TopHap</italic> flowchart (<bold>a</bold>) without any spatiotemporal sampling information and (<bold>b</bold>) with consideration of spatiotemporal information are shown. In the <italic>TopHap</italic> algorithm, we first identify high-frequency variants (&gt;<italic>maf</italic>) and produce a restricted alignment with <italic>n</italic> sequences and <italic>k</italic> bases. Next, we identify high-frequency haplotypes (&gt;<italic>hf</italic>) and produce a new alignment of <italic>h</italic> haplotypes, each with <italic>k</italic> bases. These haplotypes are subjected to phylogenetic inference. To compute bootstrap confidence limits, we resample <italic>n</italic> haplotypes with replacement to form a replicate <italic>n</italic>×<italic>k</italic> dataset, identify high-frequency haplotypes (&gt;<italic>hf</italic> and then infer a phylogeny. This process is repeated 100 times and a bootstrap consensus phylogeny is inferred. When the analyses are conducted with the consideration of spatiotemporal (or other type) annotation to construct subsets (<bold>panel b</bold>), variants and haplotypes are identified for each slice separately and then they are merged prior to phylogenetic analysis. For the SARS-CoV-2 68KG dataset, we classified sequences based on their sampling months and sampling countries.</p>
</caption>
<graphic xlink:href="EMS141132-f002"/>
</fig>
<fig id="F3" position="float">
<label>Figure 3</label>
<caption>
<title>The <italic>TopHap</italic> Phylogeny of 68KG SARS-CoV-2 major haplotypes.</title>
<p>(<bold>a</bold>) Numbers near nodes are bootstrap confidence limits derived from bootstrap resampling of genomes. Mutations mapped are shown on branches. When the same mutations were included in <xref ref-type="bibr" rid="R6">Kumar et al., (2021)</xref>, their mutation IDs (Greek symbols) were shown. Their mutations and genomic positions are given in the right side. The Nextstrain clade ID was annotated based on their diagnostic mutations and is provided at the far right. PANGO lineage was annotated for each genome using PANGOLIN software (<xref ref-type="bibr" rid="R15">Rambaut et al., 2020</xref>). We also annotated <italic>TopHap</italic> haplotype for each genome by comparing its haplotype with <italic>TopHap</italic> haplotypes. When an observed haplotype did not perfectly match any of the <italic>TopHap</italic> haplotypes, we did not assign any for the genome. Using these genome annotations, we paired each <italic>TopHap</italic> haplotype with the major PANGO lineage, and the percentage of genomes containing it is presented in the parenthesis.</p>
</caption>
<graphic xlink:href="EMS141132-f003"/>
</fig>
<fig id="F4" position="float">
<label>Figure 4</label>
<caption>
<p>Number of branches from the root to a tip and global mutant nucleotide frequency (<bold>b</bold>) and the first time the mutation was observed (<bold>c</bold>). Selected tip IDs are found in <xref ref-type="fig" rid="F3">Figure 3</xref>. The day was counted from the first sample date (Dec 24, 2019).</p>
</caption>
<graphic xlink:href="EMS141132-f004"/>
</fig>
<fig id="F5" position="float">
<label>Figure 5</label>
<caption>
<title>Comparison of <italic>TopHap</italic> phylogeny with the Nextstrain (a) and PANGO (b) phylogenies.</title>
<p>
<bold>(a)</bold> Only clades included in the 68KG data are shown. <bold>(b)</bold> Only PANGO lineages that were included in the <italic>TopHap</italic> phylogeny were used. Corresponding PANGO IDs are found in <xref ref-type="fig" rid="F3">Figure 3</xref>.</p>
</caption>
<graphic xlink:href="EMS141132-f005"/>
</fig>
<fig id="F6" position="float">
<label>Figure 6</label>
<caption>
<title>The 1MG <italic>TopHap</italic> Phylogeny.</title>
<p>(<bold>a</bold>) Red numbers near nodes are bootstrap confidence limits derived from bootstrap resampling of genomes. Early mutations that were predicted in <xref ref-type="bibr" rid="R6">Kumar et al. (2021)</xref> are mapped are shown on branches using their mutation IDs (Greek symbols). Their mutations and genomic positions are given in <xref ref-type="fig" rid="F3">Figure 3</xref>. The haplotypes with concerning mutations are indicated by using WHO IDs, and 20A EU2 and 20E (EU1) are Nextstrain clade IDs. These haplotypes were identified by annotating PANGO and Nextstrain lineage for each genome. We also annotated <italic>TopHap</italic> haplotype for each genome by comparing its haplotype with <italic>TopHap</italic> haplotypes. When an observed haplotype did not perfectly match any of the <italic>TopHap</italic> haplotypes, we did not assign any for the genome. Using these genome annotations, we paired each <italic>TopHap</italic> haplotype with the major PANGO and Nextstrain lineage, which contained the WHO annotation. We assigned WHO ID when at least one of the annotations indicated it. Evolutionary relationship of lineages with concerning mutations by (<bold>b</bold>) Nextstrain and (<bold>c</bold>) <italic>TopHap</italic>.</p>
</caption>
<graphic xlink:href="EMS141132-f006"/>
</fig>
<fig id="F7" position="float">
<label>Figure 7</label>
<caption>
<title>The early history of SARS-CoV-2 variants.</title>
<p>Five root positions are explored in which the haplotype with mutation <italic>x</italic> has been added to the <italic>TopHap</italic> phylogeny in <xref ref-type="fig" rid="F3">figure 3</xref> (A and B), <xref ref-type="bibr" rid="R6">Kumar et al., (2021)</xref> mutational history (B), <xref ref-type="bibr" rid="R3">Bloom, (2021)</xref> phylogeny (B and C), PANGO classification (D), and the Nextstrain classification (E). Haplotypes have eight positions that contain variants α<sub>1</sub>-α<sub>3</sub>, β<sub>2</sub>-β<sub>3</sub>, ν<sub>1</sub>-ν<sub>2</sub>, and <italic>x</italic>. Genomic positions are shown whenever a mutation occurs: green box for forward and red for backward mutations). ML log likelihoods (<italic>lnL</italic>) and number of MP substitutions are shown. WH-1 is the haplotype corresponding to the Wuhan-1 genome. The gray triangle represents all the other SARS-CoV-2 haplotypes of the ongoing infections in the world.</p>
</caption>
<graphic xlink:href="EMS141132-f007"/>
</fig>
</floats-group>
</article>
