<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS144670</article-id><article-id pub-id-type="doi">10.1101/2021.12.21.473142</article-id><article-id pub-id-type="archive">PPR435335</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Control-based continuation: a new approach to prototype synthetic gene networks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>de Cesare</surname><given-names>Irene</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Salzano</surname><given-names>Davide</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>di Bernardo</surname><given-names>Mario</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN1">†</xref></contrib><contrib contrib-type="author"><name><surname>Renson</surname><given-names>Ludovic</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="fn" rid="FN1">†</xref><xref ref-type="corresp" rid="CR1">#</xref></contrib><contrib contrib-type="author"><name><surname>Marucci</surname><given-names>Lucia</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="fn" rid="FN1">†</xref><xref ref-type="corresp" rid="CR1">#</xref></contrib></contrib-group><aff id="A1"><label>1</label>Engineering Mathematics Department, University of Bristol, Bristol BS8 1TW, UK</aff><aff id="A2"><label>2</label>Department of Electrical Engineering and Information Technologies, University of Naples Federico II, 80125 Naples, Italy</aff><aff id="A3"><label>3</label>Department of Mechanical Engineering, Imperial College London, UK</aff><aff id="A4"><label>4</label>BrisSynBio, University of Bristol, Bristol BS8 1TQ, UK</aff><aff id="A5"><label>5</label>School of Cellular and Molecular Medicine, University of Bristol, Bristol BS8 1UB, UK</aff><author-notes><corresp id="CR1"><label>#</label> Co-corresponding authors; <email>l.renson@imperial.ac.uk</email>; <email>lucia.marucci@bristol.ac.uk</email></corresp><fn id="FN1"><label>†</label><p id="P1">Co-senior authors.</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>02</day><month>05</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>28</day><month>04</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Control-Based Continuation (CBC) is a general and systematic method to carry out the bifurcation analysis of physical experiments. CBC does not rely on a mathematical model and thus overcomes the uncertainty introduced when identifying bifurcation curves indirectly through modelling and parameter estimation. We demonstrate, <italic>in silico</italic>, CBC applicability to biochemical processes by tracking the equilibrium curve of a toggle switch which includes additive process noise and exhibits bistability. We compare results obtained when CBC uses a model-free and model-based control strategy and show that both can track stable and unstable solutions, revealing bistability. We then demonstrate CBC in conditions more representative of a real experiment using an agent-based simulator describing cells growth and division, cell-to-cell variability, spatial distribution, and diffusion of chemicals. We further show how the identified curves can be used for parameter estimation and discuss how CBC can significantly accelerate the prototyping of synthetic gene regulatory networks.</p></abstract><kwd-group><kwd>Control-Based Continuation</kwd><kwd>Synthetic Biology</kwd><kwd>Bifurcations</kwd><kwd>Toggle Switch</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P3">The complexity of biological systems is widely acknowledged. In native organisms, multi-scale intracellular interactions often result in complex nonlinear dynamics. Consider, for example, switches and oscillations in gene expression, which are used by cells to process external inputs and program specific cell outputs. Synthetic biology aims at engineering biological computation by recreating such dynamics using circuits embedded into living cells [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R3">3</xref>, <xref ref-type="bibr" rid="R4">4</xref>, <xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R9">9</xref>, <xref ref-type="bibr" rid="R10">10</xref>].</p><p id="P4">Mathematical modelling is widely used within synthetic biology design-build-test-learn cycles. In the context of engineered gene regulatory networks, models can both support the design phase (indicating the parameter space which allows the emergence of the desired dynamics, such as oscillations), and the testing upon experimental implementation. Moreover, modelling is currently the only way in synthetic biology to study the relationship between physical parameters variations and bifurcations; the latter represent stability boundaries where qualitative and quantitative changes to the system’s dynamics occur. For instance, saddle-node and Hopf bifurcations (responsible for hysteresis and oscillatory behaviours, respectively) that are commonly observed in native biological systems [<xref ref-type="bibr" rid="R11">11</xref>] can only be studied by nonlinear model analysis. This means that, firstly, a mathematical model needs to be derived and fitted to often <italic>ad hoc</italic> generated experimental data. Then, nonlinear model analysis can be performed to identify the bifurcation behaviour being observed.</p><p id="P5">The derivation of biochemical models can however be challenging, both in terms of model structure (which depends on underlying hypothesis on the system), and parameter identification and validation (which can be troublesome in the case of incomplete/noisy experimental datasets). Model uncertainties will inevitably result in misleading conclusions [<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R13">13</xref>]. As a consequence, the design and testing of engineering synthetic biochemical circuits that perform as intended is extremely difficult, unless various design, build, test and learn iterations are performed [<xref ref-type="bibr" rid="R14">14</xref>].</p><p id="P6">Control-based continuation (CBC), originally proposed by Sieber and Krauskopf [<xref ref-type="bibr" rid="R15">15</xref>], is a general, systematic and model-free testing method that applies the principles of numerical continuation (a computational method for bifurcation analysis) to physical experiments. The fundamental principles of CBC are well established and the method has been applied to a wide range of mechanical systems. For instance, Barton et al. [<xref ref-type="bibr" rid="R16">16</xref>] studied the periodic responses of a bistable energy harvester. A similar system was studied by Renson et al. [<xref ref-type="bibr" rid="R17">17</xref>]. The continuation method was also demonstrated on a multi-degree-of-freedom structure exhibiting isolated curves of periodic responses and quasi-periodic oscillations [<xref ref-type="bibr" rid="R18">18</xref>]. CBC exploits feedback control to explore the nonlinear dynamics of a system, detect bifurcations, and eventually trace their evolution with respect to adjustable parameters directly during experimental tests.</p><p id="P7">Recently, external feedback controllers have been exploited for controlling gene expression in living cells by means of microfluidics/microscopy or optogenetics platforms [<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R21">21</xref>, <xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>, <xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R26">26</xref>, <xref ref-type="bibr" rid="R27">27</xref>]. From a control theory standpoint, genetic networks are the processes to be controlled, while the controller is implemented on a computer. Biosensors are used to measure the state of the process, usually by means of fluorescent reporter proteins. The fluorescence evaluation can be done either at single-cell or at cell population level, and is fed to a control algorithm that evaluates the appropriate control input aiming to steer the process to a selected reference signal. Inputs are then actuated on the process via light or chemical compounds [<xref ref-type="bibr" rid="R28">28</xref>].</p><p id="P8">By employing external feedback controllers to steer gene expression it should be possible to apply CBC to track nonlinear dynamics in biochemical systems, overcoming the need for a model identification step and defining a shorter way for bifurcation tracking which includes the isolation of unstable equilibria (see in <xref ref-type="fig" rid="F1">Fig. 1A</xref> path 1 compared to path 2).</p><p id="P9">Here, we demonstrate, for the first time, the applicability of CBC to prototype the dynamics of a synthetic gene regulatory network and to estimate the parameters of a fixed model structure, if available, using data collected after the CBC routine. We use as a test bed the toggle switch, a bistable biological circuit, firstly embedded in <italic>Escherichia coli</italic> cells by Gardner et al. [<xref ref-type="bibr" rid="R10">10</xref>], which is often used to benchmark new control strategies and is considered a fundamental tool for cell computation [<xref ref-type="bibr" rid="R11">11</xref>, <xref ref-type="bibr" rid="R29">29</xref>]. Specifically, we run <italic>in silico</italic> experiments on a recent version of the toggle switch, for which external feedback control was shown to be successful [<xref ref-type="bibr" rid="R6">6</xref>]. Moreover, we leveraged an agent-based simulator called BSim [<xref ref-type="bibr" rid="R30">30</xref>] to test the performance of the designed algorithms in conditions more representative of a real experiment. Our <italic>in silico</italic> demonstration of CBC gives us the confidence that the method should be exploitable <italic>in vivo</italic> to fully explore the parameter space which allows the emergence of the desired dynamics (in our example, hysteresis), leading to rapid and model-free characterization, and also parameter estimation, of engineered synthetic modules.</p></sec><sec id="S2" sec-type="results | discussion"><title>Results and Discussion</title><p id="P10">CBC retrieves stable and unstable invariant solutions of a dynamical system through the application of an external control action. In order to acquire the bifurcation diagram, the controller must not modify the position in the parameter space of the uncontrolled system’s invariant solutions. For example, the equilibria of a controlled system are in general different from the one of the uncontrolled system and, to recover the response of the underlying uncontrolled system of interest, CBC seeks a control signal that decays asymptotically to zero, i.e., <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:munder><mml:mrow><mml:mi>lim</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula> where <italic>x</italic> ∈ ℝ is the system’s state, <italic>x<sub>ref</sub></italic> ∈ ℝ is the control reference signal and <italic>t</italic> is time. Although the control signal is asymptotically converging to zero, it is synthetized in order to stabilise local dynamics of the system such that unstable equilibria become stable and hence detectable forward in time. A control strategy that satisfies (1) is called noninvasive and does not modify the system’s equilibrium positions in the parameter space. Finding a noninvasive control signal usually requires finding the “right” reference input (<italic>x<sub>ref</sub></italic>) for the controller such that (1) is satisfied, while the solution of interest is stabilised.</p><p id="P11">When the control input can be chosen as the bifurcation parameter of interest, the methodology can be significantly simplified as the control signal is only required to settle to a constant value. Indeed, when this condition is achieved, the non-zero constant control signal can be viewed as a mere shift in the bifurcation parameter value. This simplified method is used in this paper, and more details about its implementation can be found in the <xref ref-type="sec" rid="S9">Methods</xref> section. Furthermore, CBC can also be extended to characterise systems exhibiting oscillations and other bifurcations as described in [<xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R18">18</xref>, <xref ref-type="bibr" rid="R31">31</xref>, <xref ref-type="bibr" rid="R32">32</xref>].</p><p id="P12">The applicability of CBC is demonstrated here in <italic>silico</italic> on a synthetic gene network, the toggle switch (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The mathematical model developed by Lugagne et al. [<xref ref-type="bibr" rid="R6">6</xref>] is used. From a control system standpoint, it can be seen as a 2-input (<italic>aTc</italic> and <italic>IPTG</italic>) 2-output (<italic>LacI</italic> and <italic>TetR</italic>) nonlinear dynamical system. The inputs correspond to drugs that can be added to the cells environment, while the outputs are proteins synthesized by cells and detected by tagging them with fluorescent reporters. Here the control signal (specifically <italic>IPTG</italic>) plays a dual role: not only it pushes the system into a new state, but it keeps the system stable allowing it to explore the nearby unstable dynamics which would not be collected otherwise (see the red branch of the bifurcation diagram in <xref ref-type="fig" rid="F1">Fig. 1 A</xref>). The model derivation and further information about the network can be found in the <xref ref-type="sec" rid="S9">Methods</xref> section.</p><p id="P13"><xref ref-type="fig" rid="F1">Fig. 1 B</xref> illustrates an experiment conducted with CBC; data points collected with CBC (blue point) are compared to the actual bifurcation curve obtained using standard model-based numerical continuation algorithms (gray dashed line). First, a particular control reference value (<italic>x<sub>ref</sub></italic> = <italic>TetR*</italic>) is selected (dashed-blue line). The reference signal is compared to the actual expression of the gene of interest to compute a control error. This is fed to the controller, which evaluates a controlling signal (<italic>IPTG</italic> concentration), translated into an input to the toggle switch that will therefore change its state (the red line in <xref ref-type="fig" rid="F1">Fig. 1 B</xref> shows the system transient dynamic). At every sampling time a new measure is acquired and the entire process is repeated until a steady state value is reached. The steady state value of the state variables, together with the associated control signal, are then saved to define a point <inline-formula><mml:math id="M2"><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mo> </mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> in the bifurcation diagram. Subsequently, a new reference value is picked (see <xref ref-type="sec" rid="S9">Methods</xref>) and the entire process is repeated. To trace out the entire equilibrium curve, the continuation algorithm requires a set of control reference values, broadly covering the range of gene expression of interest (in our case the <italic>TetR</italic> fluorescence expression).</p><p id="P14">CBC is a model-free method because it does not require the knowledge of a mathematical model of the system to be applied to, and the results’ accuracy does not depend on the structure and parameter values of a model. Furthermore, the controller within CBC is only required to be stabilizing and noninvasive. As such, CBC is not tied to a specific type of feedback controller and control laws that do not require a mathematical model of the system can be used. However, the design, parameter tuning and overall performance of the controller can be improved if some knowledge (like a model) of the system dynamics is available. Here, the use of a model-free proportional (P) controller and a model-predictive controller (MPC) is compared. The former controller was chosen as it is widely used in CBC applications, while the latter is commonly exploited in synthetic biology [<xref ref-type="bibr" rid="R20">20</xref>]. When using Model Predictive control strategies, simple linear models work well, showing that detailed mathematical representations are not needed for CBC to be work. A sampling time of 5 minutes is considered in this work; this is a realistic time interval that we previously used to image and externally control bacterial cells [<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R25">25</xref>]. Note that, with the simplified CBC approach, the controller is not required to take the control error to zero but only to stabilise the system to the nearest equilibrium point. This does not affect the accuracy of results, as further explained in <xref ref-type="sec" rid="S9">Methods</xref>.</p><sec id="S3"><title>CBC can reconstruct the toggle switch bifurcation diagram under deterministic simulation settings</title><p id="P15">We first applied CBC on the deterministic model of the toggle switch. During the in <italic>silico</italic> experiment, 30 steady state points <inline-formula><mml:math id="M3"><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mo> </mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo> </mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> were acquired by varying the reference input to the control strategy between <italic>TetR*</italic> = 1800[<italic>a.u</italic>.] (or 1200[<italic>a.u</italic>.]) and <italic>TetR*</italic> = 0[<italic>a.u</italic>]. The maximum duration of a single equilibrium acquisition was constrained to 9 hours and 55 minutes, after which the control reference was modified. The steady states values were computed by taking the average of the samples recorded in the last 60 minutes (12 samples) of the simulation carried out for each value of the reference input. Averaging is not essential in a deterministic scenario, but becomes fundamental in a noisy environment as a way to filter out some noise. Points collected with the CBC perfectly overlap with the numerical continuation diagram (<xref ref-type="fig" rid="F2">Fig. 2 A</xref> and <xref ref-type="fig" rid="F3">3 A</xref>). Both control strategies have comparable tracking performances and proved able to stabilise the unstable branch of equilibria delimited by the Saddle-Node bifurcations, capturing the whole bifurcation curve.</p><p id="P16">The proportional control signal is linearly dependent on the error signal. Every time the reference is modified (<xref ref-type="fig" rid="F2">Fig. 2 B</xref>), the error changes and consequently the control signal as well changes (<xref ref-type="fig" rid="F2">Fig. 2 C</xref>). As the controller does not include an integral action, the error never nullifies, but it becomes constant once the system reaches the equilibrium. When this happens, the control signal and bifurcation parameter <italic>IPTG</italic> becomes constant as well (because the proportional contribution is constant), and the steady state can be collected.</p><p id="P17">With MPC, the control action is computed as the optimal signal that minimizes the error, and therefore its contribution pushes the system’s trajectories towards the reference signal, generating some early oscillations (<xref ref-type="fig" rid="F3">Fig. 3 B, C</xref>). As the bifurcation parameter is not directly proportional to the control error, the latter does not have to be different from zero. The steady state error introduced by the MPC algorithm is much lower than the proportional one (see <xref ref-type="fig" rid="F2">Fig. 2 B</xref> and <xref ref-type="fig" rid="F3">Fig. 3 B</xref>); thus, it is easier to define the range of reference values for the MPC as it corresponds to the effective dynamical range explored by the continuation algorithm. Instead, when using a proportional controller, the range of the control reference may need to be varied significantly (as in <xref ref-type="fig" rid="F2">Fig. 2 B</xref>, where the maximum reference was set to <italic>TetR* =</italic> 1800[<italic>a.u</italic>.] in order for the algorithm to get a full coverage of the bifurcation diagram). This should not be considered as a fault of the proportional algorithm but only as a difference between the two control strategies. Results in <xref ref-type="fig" rid="F2">Fig. 2</xref> and <xref ref-type="fig" rid="F3">Fig. 3</xref> are also represented in <xref ref-type="supplementary-material" rid="SD1">Supplementary Movies S1</xref> and <xref ref-type="supplementary-material" rid="SD2">S2</xref>.</p><p id="P18">To decrease the total time of each simulation we also implemented a steady state detection routine that changes the reference each time the system reaches steady state (<xref ref-type="sec" rid="S9">Methods</xref>). This, together with a smaller number of collected points, allowed to decrease the experimental time to approximately 55 hours for both the controllers, see <xref ref-type="supplementary-material" rid="SD5">Fig. S1</xref> and <xref ref-type="supplementary-material" rid="SD5">S2</xref>.</p></sec><sec id="S4"><title>CBC can reconstruct the toggle switch bifurcation diagram under a stochastic simulation setting</title><p id="P19">CBC is now demonstrated on a stochastic toggle switch model to reproduce conditions more similar to a real experiment. As noise can strongly modify results of a single continuation experiment, we consider 10 repetitions of the same experiment. In each we collect 30 points, with the steady states values computed as described for the ODE case.</p><p id="P20">The resulting plot is a density map made of all the collected steady states <inline-formula><mml:math id="M4"><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mo> </mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo> </mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> over the 10 simulations, that we can compare with the numerically computed bifurcation diagram (<xref ref-type="fig" rid="F4">Fig. 4 A</xref> and <xref ref-type="fig" rid="F5">5 A</xref>). The results show dense clouds of points falling in the area where the branch of equilibria is, confirming the ability of the strategy to work also in a stochastic setting: both controllers were able to track the unstable branch of equilibria, preventing the system from jumping between the two stable steady states. For simplicity, we only show one out of 10 computed trajectories of <italic>TetR</italic> and <italic>IPTG</italic> in <xref ref-type="fig" rid="F4">Fig. 4 B, C</xref> and <xref ref-type="fig" rid="F5">5 B, C</xref>.</p><p id="P21">For both the proportional controller and MPC, the output signal shows oscillations due to noise, that also affect the control signal <italic>u</italic>. However, these oscillations do not seem to strongly alter the average values we take as steady state points. Similar observations to the deterministic case can be made. For the proportional controller, the error does not nullify and the reference signal is chosen in a wider range of values than for the MPC in order to uncover the full bifurcation curve (<xref ref-type="fig" rid="F4">Fig. 4 B</xref>).</p><p id="P22">As in the deterministic scenario, the simulation time can be drastically decreased considering a variable step time associated to the computation of the steady states and a reduced amount of collected points. The resulting bifurcation curves can be seen in <xref ref-type="supplementary-material" rid="SD5">Fig. S3 A</xref> and <xref ref-type="supplementary-material" rid="SD5">S4 A</xref>, while panels B and C show just one representative trajectory of <italic>TetR</italic> and <italic>IPTG</italic>, respectively. Furthermore, for the stochastic scenario, we also considered the case of steady state check with full amount of points (30). We found that the reference shift guided by steady state detection could only reduce the total time to 228 hours for a proportional controller and 233 hours in case of MPC algorithm (see <xref ref-type="supplementary-material" rid="SD5">Figure S5</xref> and <xref ref-type="supplementary-material" rid="SD5">S6</xref>), i.e. a 23.4% and a 21.8% reduction, respectively. Reducing the total testing time requires to decrease the number of points collected, which can be achieved without losing accuracy in the diagram retrieved as shown in <xref ref-type="supplementary-material" rid="SD5">Figs. S3</xref> and <xref ref-type="supplementary-material" rid="SD5">S4</xref>. Nonetheless, the present method could be improved by developing a algorithm for automatic reference stepping with variable numbers of point collected.</p></sec><sec id="S5"><title>Single-cell CBC using agent-based simulations</title><p id="P23">To further prove the applicability of CBC to synthetic biology, we validated the method in BSim, a Java-based bacteria simulator [<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R33">33</xref>], where it is possible to consider a scenario more representative of a real experiment, including spatial distribution, movement, growth and division of cells as well as spatial distribution and diffusion of chemicals. We implemented single cell control considering the same model used for the stochastic scenario (<xref ref-type="disp-formula" rid="FD4">Equation (4)</xref>). Simulation settings (i.e. sampling time, number of collected points, gains, etc.) where kept the same as above, with minor differences due to changes in the programming language.</p><p id="P24">In <xref ref-type="fig" rid="F6">figures 6 B</xref>, <xref ref-type="fig" rid="F7">7 B</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Movies S3</xref> and <xref ref-type="supplementary-material" rid="SD4">S4</xref> representative examples of <italic>TetR</italic> and <italic>IPTG</italic> trajectories are shown. The bifurcation curves that are obtained, shown in <xref ref-type="fig" rid="F6">Fig. 6 A</xref> and <xref ref-type="fig" rid="F7">7 A</xref>, are comparable with previous results obtained on the stochastic model. However, we observed worse control performances for the proportional controller in BSim. This is mainly due to additional factors introduced in simulations. Specifically, the cells biomechanics and their flush out from the microfluidic chamber are simulated, as well as the chemicals’ spatial distribution and diffusion that introduce additional delay in the control input delivery. Additionally, in BSim we explicitly simulated an actuation delay due to the time the media takes to be delivered to the cells within the microfluidic device. All these factors might contribute to the performances exhibited by the proportional controller. A similar result when using more realistic simulation environments was also found in [<xref ref-type="bibr" rid="R34">34</xref>], where the authors showed that the performance of a PI controller considerably deteriorated when the algorithm was tested on an agent based model, while an MPC algorithm was able to maintain similar performance. Further information about BSim can be found in the <xref ref-type="sec" rid="S9">Methods section</xref>.</p><p id="P25">Results with reduced points and steady state detection obtained in BSim (<xref ref-type="supplementary-material" rid="SD5">Fig. S7</xref> and <xref ref-type="supplementary-material" rid="SD5">Fig. S8</xref>) were similar to short stochastic simulations in Matlab. Here, the increased complexity of simulations takes into account many sources of noise (such as spatial diffusion of chemicals); for this reason,results are more scattered around the numerically computed bifurcation diagram (see <xref ref-type="supplementary-material" rid="SD5">Fig. S7 A</xref> and <xref ref-type="supplementary-material" rid="SD5">Fig. S8 A</xref>). Nonetheless, implemented controllers manage to stabilise trajectories along the unstable branch of equilibria.</p><p id="P26">Considering the stochasticity of the experiments, there might be variability in the amount of time needed to uncover the bifurcation curve but, in general, it can be reduced up to less than a third of the original simulations.</p></sec><sec id="S6"><title>Model calibration via data collected using CBC in a noisy scenario</title><p id="P27">Methods for parameters identification in nonlinear systems often rely on optimization routines: given a model, parameters identification allows to calibrate its output in order to match experimental data (refer to [<xref ref-type="bibr" rid="R35">35</xref>, <xref ref-type="bibr" rid="R36">36</xref>] for further information).</p><p id="P28">Using the approach by Beregi et al. [<xref ref-type="bibr" rid="R32">32</xref>], we show how the equilibria measured using CBC can be exploited to estimate the toggle switch model parameters, and how data corresponding to unstable equilibria helps retrieving a model that captures the bistable behaviour of the system. Further information about the identification process can be found in Methods.</p><p id="P29">The equilibrium curves obtained from parameters identified using CBC data are shown in Fig. S9 D for the deterministic scenario and in <xref ref-type="supplementary-material" rid="SD5">Fig. S9 E, F</xref> for the stochastic scenario (in green and red data associated to the proportional controller and to the MPC, respectively). For the sake of comparison, model parameters were also estimated from points collected using a traditional, open-loop parameter sweep where different levels of input parameter (IPTG) were tested for both noise-free and noisy scenarios (<xref ref-type="supplementary-material" rid="SD5">Fig. S9 A</xref> and <xref ref-type="supplementary-material" rid="SD5">B, C</xref>, respectively). The equilibrium curve obtained in this way generally does not reproduce the bistable behaviour of the system, except slightly in the ideal case of the deterministic simulations (<xref ref-type="supplementary-material" rid="SD5">Fig. S9 A</xref>). On the other hand, data collected with CBC still capture bistability even in stochastic simulations (<xref ref-type="supplementary-material" rid="SD5">Fig. S9 E, F</xref>), although without being able to reproduce the original numerical bifurcation curve.</p><p id="P30">Parameter estimation results show that the use of data including unstable equilibria helps estimating parameters that reproduce bistability. As such, it is thought that the MPC control approach is preferable compared to the proportional control as it offers greater control over the distribution of data points along the equilibrium curve. Estimated parameters are shown in <xref ref-type="supplementary-material" rid="SD5">Table S1</xref> for all different collected data. Interestingly, the variation of some parameters does not significantly affect the resulting fitted curve. Take, for example, the red line in S9 D, which is in excellent agreement with the reference equilibrium curve but was calculated with some identified parameters values being up to 41% different from their nominal value, hinting to non-identifiability of some parameters. We confirmed this by performing a structural identifiability analysis on the system, using the STRIKE-GOLDD toolbox [<xref ref-type="bibr" rid="R37">37</xref>], which showed unidentifiability of 9 parameters out of 14 when we considered two measurable outputs (<italic>LacI</italic> and <italic>TetR</italic>), one known control input (IPTG) and one other input as a fixed constant (<italic>aTc</italic>). For further reference, structural unidentifiability of the 2 ODEs toggle switch system for fixed inputs was also highlighted by Villaverde et al. [<xref ref-type="bibr" rid="R38">38</xref>].</p><p id="P31">We note that bifurcation curves estimated from sweeps can be improved to reproduce bistability if additional knowledge about the presence of horizontal asymptotes for the stable branches is introduced in the cost function used for parameter estimation (<xref ref-type="supplementary-material" rid="SD5">Fig. S10 A-C</xref>). However, obtaining qualitatively different results for similar estimation approaches would typically lead to poor confidence in the results. This modified approach is also not systematic as the true behaviour of the system is assumed to be known. Using this new approach with CBC data further improves the agreement between the reference and identified models (<xref ref-type="supplementary-material" rid="SD5">Fig. S10 D-F</xref>).</p></sec><sec id="S7" sec-type="conclusions"><title>Concluding Remarks</title><p id="P32">This paper presents the first application, <italic>in silico</italic>, of CBC to biochemical systems. In particular, CBC can track the stable and unstable equilibria of a synthetic gene network behaving as a toggle switch. In the absence of noise, a perfect agreement between equilibrium curves measured using CBC and standard numerical continuation methods is found. A notable challenge in biological applications, as compared to the mechanical systems studied so far with CBC, is the significant presence of (process) noise. Our results on the stochastic models (Matlab and Bsim) clearly show that CBC is still able to uncover the bistable nature of the system, as recorded data points qualitatively follow the equilibrium curve of the underlying deterministic model.</p><p id="P33">Besides exploring the nonlinear dynamics of the physical system directly in the experiment, CBC provides informative data for parameter estimation. Our results show that the measured data, especially those falling in the unstable region, was critical for the identification of model parameters that can reproduce bistability.</p><p id="P34">CBC appears therefore as a valuable tool for uncovering the dynamics of potentially more complex synthetic gene networks even in the presence of significant levels of noise. CBC can also be used to characterise oscillations [<xref ref-type="bibr" rid="R39">39</xref>] and other bifurcations [<xref ref-type="bibr" rid="R17">17</xref>, <xref ref-type="bibr" rid="R40">40</xref>]. The information gathered with CBC has the potential to enable a more accurate understanding of biochemical interactions and thus a more precise prototyping of those behaviours into novel synthetic gene circuits.</p><p id="P35">An important feature of CBC is that it is a model-free method since it does not require a model of the system to work, and the accuracy of the results is independent from any modelling assumption. CBC also does not rely on a particular control strategy, provided the controller can be made noninvasive and is able to stabilise unstable responses. In this regard, the use of a mathematical model (even approximate) can improve the control performance. For instance, the initial estimate of a proportional controller gain can be obtained based on a model and then further refined by trial and error during experiments. We also showed that a model-predictive controller, based on a simple linear model, can provide a smaller steady-state control error, resulting in better discretisation of the equilibrium curve and beneficial for parameter estimation. MPC is a controller broadly used in biology [<xref ref-type="bibr" rid="R20">20</xref>] which generally performs best for fast varying references [<xref ref-type="bibr" rid="R41">41</xref>]. We hope that the use of MPC in the present paper paves the way for a wide range of applications of CBC in systems and synthetic biology.</p></sec><sec id="S8"><title>Future developments</title><p id="P36">In future studies we aim to apply the strategy <italic>in-vivo</italic>, using the microfluidic experimental set-up already described in [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R24">24</xref>], which proved to be successful for control experiments involving both mammalian and bacterial cells.</p><p id="P37">Several challenges will have to be addressed to enable a wider uptake of CBC: <list list-type="order" id="L1"><list-item><p id="P38"><italic>Noise</italic>. The presence of noise can make stabilization more difficult, as observed here and also highlighted by Lugagne et al. [<xref ref-type="bibr" rid="R6">6</xref>]. Moreover, the presence of noise affects the noninvasiveness associated to the control input. Indeed, noise introduces variations in the control signal which cannot be suppressed completely. While this appears to have a mild effect on the system considered here, this is arguably not the case in general. As of now, some noise-related effects can be compensated by considering signal processing techniques, but more rigorous methods are required.</p></list-item><list-item><p id="P39"><italic>Control</italic>. As of now, there are no general and systematic methods to design the controller used in CBC. Currently, control parameters are found by trials and errors. While this works for simple systems, this approach does not scale to more complex systems where more sophisticated control strategies including, for instance, multiple inputs and outputs, will be needed. A step in that direction has recently been made by Li and Dankowicz [<xref ref-type="bibr" rid="R42">42</xref>] who proposed adaptive control design strategies for CBC.</p></list-item><list-item><p id="P40"><italic>Experimental time</italic>. Our initial simulations were particularly long (298 hours in <xref ref-type="fig" rid="F4">Fig. 4</xref>–<xref ref-type="fig" rid="F7">7</xref>). While such experiments can be achieved with some experimental set-ups – Balagaddé et al. [<xref ref-type="bibr" rid="R43">43</xref>] performed experiments on an <italic>Escherichia coli</italic> prey-predator system that lasted between 200 and 500 hours using a microchemostat platform – this is currently not possible using microscopy/microfluidic platform [<xref ref-type="bibr" rid="R6">6</xref>, <xref ref-type="bibr" rid="R22">22</xref>]. It is in principle possible to significantly reduce testing time by improving the performance of the controller to reduce the transient. However, this can prove difficult due to the significant presence of noise in biochemical systems. Nonetheless, we showed that, for the presented gene network, it is possible to adjust the number of recorded points and CBC parameters to significantly reduce experimental time (2-3 days in the deterministic case, and 3-4 days in the stochastic case) while preserving a fine discretisation of the equilibrium curve.</p></list-item></list></p></sec></sec><sec id="S9" sec-type="methods"><title>Methods</title><sec id="S10"><title>Model of the toggle switch</title><p id="P41">The genetic toggle switch is a well-characterized bistable biological circuit, first embedded in <italic>Escherichia coli</italic> by Gardner et al. [<xref ref-type="bibr" rid="R10">10</xref>]. The system consists of two repressors (<italic>LacI</italic> and <italic>TetR</italic>), which mutually repress each other, and two inducers (Atc and <italic>IPTG</italic>), which can externally tune the genes’ production (<xref ref-type="fig" rid="F1">Fig. 1 A</xref>). In the absence of inducers, the circuit exhibits two stable equilibria. Levels of <italic>LacI</italic> and <italic>TetR</italic> can be measured via fluorescent reporters: for example, mKate2(RFP) and mEGFP(GFP) can be used to monitor <italic>LacI</italic> and <italic>TetR</italic>, respectively [<xref ref-type="bibr" rid="R6">6</xref>].</p><p id="P42">Here, we will refer to the Hill-type model developed by Lugagne et al. [<xref ref-type="bibr" rid="R6">6</xref>], representing mRNA transcription, translation and degradation/dilution due to growth. Mathematically, the system is described by a set of four ordinary differential equations: <disp-formula id="FD2"><label>(2)</label><mml:math id="M5"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mspace width="0.2em"/><mml:mi>θ</mml:mi></mml:msup><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where the system states are given by the genes production <italic>LacI</italic> and <italic>TetR</italic> and the associated <italic>mRNAs</italic> (<italic>mRNA<sub>LacI</sub></italic>, <italic>mRNA<sub>TetR</sub></italic>), <inline-formula><mml:math id="M6"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the leakage transcription rate, <inline-formula><mml:math id="M7"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> is the transcription rate, <inline-formula><mml:math id="M8"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula> the translation rate, <inline-formula><mml:math id="M9"><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> the mRNA degradation rate and <inline-formula><mml:math id="M10"><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula> is the protein degradation rate. Parameters are listed in <xref ref-type="table" rid="T1">table 1</xref>.</p><p id="P43">The authors assumed that the repressors could be modelled with Hill function (<italic>h(x, <bold>θ</bold>, η</italic>) = 1/(1 + <italic>x/<bold>θ</bold></italic>)<sup>η</sup>), where <bold><italic>θ</italic></bold> represents a threshold parameter for the Hill function and η is the Hill coefficient. Two more equations were added to take into account inducers diffusion through the cell membrane. Formally: <disp-formula id="FD3"><label>(3)</label><mml:math id="M11"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P44">The deterministic version of the model does not capture the intrinsic stochasticity of biochemical processes. A more accurate description is provided by the stochastic modelling procedure, based on the pseudo-reactions listed in <xref ref-type="table" rid="T2">table 2</xref>.</p><p id="P45">Specifically, we employed a SDE based model for the description of biochemical systems [<xref ref-type="bibr" rid="R44">44</xref>]: <disp-formula id="FD4"><label>(4)</label><mml:math id="M12"><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:munder accentunder="true"><mml:munder accentunder="true"><mml:mi>S</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mrow><mml:munder accentunder="true"><mml:mi>f</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:munder accentunder="true"><mml:mi>W</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:math></disp-formula></p><p id="P46">Here: <list list-type="bullet" id="L2"><list-item><p id="P47"><inline-formula><mml:math id="M13"><mml:munder accentunder="true"><mml:munder accentunder="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></inline-formula> is the stoichiometry matrix where each row is associated to a state variable and each column <italic>i</italic> includes stoichiometry coefficients associated to the reaction <italic>i</italic>.</p></list-item><list-item><p id="P48"><underline><italic>f</italic></underline> is a vector where each element <italic>i</italic> corresponds to a propensity function. The latter is a function describing the probability of a certain reaction given the concentration of the chemical species (<xref ref-type="bibr" rid="R45">45</xref>).</p></list-item><list-item><p id="P49"><italic>d<underline>W</underline></italic> is a vector containing the Wiener Process increments.</p></list-item></list>
</p><p id="P50">Pseudo-reactions and propensity functions were all given in [<xref ref-type="bibr" rid="R6">6</xref>], and here reported in <xref ref-type="table" rid="T2">Table 2</xref>. All simulations were performed using Matlab R2019b. To solve the system (2) we used the function ode<xref ref-type="bibr" rid="R45">45</xref>, while for the stochastic model in <xref ref-type="disp-formula" rid="FD4">eq. (4)</xref> we implemented the Euler-Maruyama method [<xref ref-type="bibr" rid="R44">44</xref>], that is known to be slightly less accurate than the Stochastic Simulation Algorithm [<xref ref-type="bibr" rid="R45">45</xref>], but more computationally efficient.</p><p id="P51">Throughout the paper we have assumed <italic>aTc</italic> to be fixed to <italic>25ngmL<sup>–</sup></italic>1 for all simulations.</p></sec><sec id="S11"><title>Control-based continuation theory: using control to track equilibria of the underlying uncontrolled system</title><p id="P52">CBC seeks to define a bifurcation diagram by the application of a noninvasive control action, that does not modify the underlying uncontrolled system’s equilibria position in parameter space. To do so, the original method looks for a control action whose contribution vanishes asymptotically (<xref ref-type="disp-formula" rid="FD1">eq. (1)</xref>). However, the same noninvasiveness can be achieved with a slightly simplified method, provided that the control action enters the system as bifurcation parameter [<xref ref-type="bibr" rid="R31">31</xref>]. The fundamental principles of the simplified CBC method used in this paper can be explained using the scalar differential equation: <disp-formula id="FD5"><label>(5)</label><mml:math id="M14"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">μ</mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></disp-formula> where <bold><italic>μ</italic></bold> ∈ ℝ is the bifurcation parameter. <xref ref-type="disp-formula" rid="FD5">Eq. (5)</xref> corresponds to the normal form of a fold (or saddle-node) bifurcation. The equilibria of the above system are given by the formula: <disp-formula id="FD6"><label>(6)</label><mml:math id="M15"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:mo>−</mml:mo><mml:mtext mathvariant="bold">μ</mml:mtext></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P53">To trace out the equilibrium curve of (5), including both stable and unstable equilibria, CBC relies on the presence of a stabilising feedback controller. The equation of motion of the system including feedback control is given by: <disp-formula id="FD7"><label>(7)</label><mml:math id="M16"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">μ</mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>u</mml:mi></mml:math></disp-formula> where <italic>u</italic> is the control signal given by a suitable, i.e. stabilizing, control law. When the control signal and bifurcation parameter affect the system in the same way (as in <xref ref-type="disp-formula" rid="FD7">Eq. (7)</xref>), the static component of the control signal can be interpreted as a shift of the bifurcation parameter <bold><italic>μ</italic></bold>. In this paper, a simple linear proportional (P) law will be considered such that <italic>u</italic> is given by <disp-formula id="FD8"><label>(8)</label><mml:math id="M17"><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula> where <italic>x<sub>ref</sub></italic>(<italic>t</italic>) is the control reference (or target) and <italic>K<sub>p</sub></italic> is the proportional gain. Using (<xref ref-type="disp-formula" rid="FD8">8</xref>) as control input, (<xref ref-type="disp-formula" rid="FD7">7</xref>) becomes: <disp-formula id="FD9"><label>(9)</label><mml:math id="M18"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">μ</mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> that can be reordered as: <disp-formula id="FD10"><label>(10)</label><mml:math id="M19"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext mathvariant="bold">μ</mml:mtext><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P54">Thus, we can write the equilibria of (<xref ref-type="disp-formula" rid="FD10">10</xref>) and the control signal at steady state as: <disp-formula id="FD11"><label>(11)</label><mml:math id="M20"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math></disp-formula> <disp-formula id="FD12"><label>(12)</label><mml:math id="M21"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P55">Writing <italic>x</italic><sub>ref</sub> as function of the steady state control action <italic>u</italic>, we can substitute <xref ref-type="disp-formula" rid="FD12">Eq. (12)</xref> in <xref ref-type="disp-formula" rid="FD11">Eq. (11)</xref> to obtain: <disp-formula id="FD13"><label>(13)</label><mml:math id="M22"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math></disp-formula> <disp-formula id="FD14"><label>(14)</label><mml:math id="M23"><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:math></disp-formula> <disp-formula id="FD15"><label>(15)</label><mml:math id="M24"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>p</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="P56">Solving the squared term and simplifying the equation we can thus obtain: <disp-formula id="FD16"><label>(16)</label><mml:math id="M25"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:msqrt></mml:math></disp-formula></p><p id="P57"><xref ref-type="disp-formula" rid="FD16">Eq. (16)</xref> defines the same equilibrium curve as <xref ref-type="disp-formula" rid="FD6">Eq. (6)</xref> for a parameter <bold><italic>μ* = μ + ū</italic></bold>. Therefore, the steady state contribution of the control signal does not have to be removed and it can simply be considered as a shift in parameter space. The control strategy so defined is noninvasive (it does not modify the position of system’s equilibria in parameter space) and the requirement of <xref ref-type="disp-formula" rid="FD1">eq. (1)</xref> can be translated into: <disp-formula id="FD17"><label>(17)</label><mml:math id="M26"><mml:munder><mml:mrow><mml:mi>lim</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mn>0.</mml:mn></mml:math></disp-formula> which is equivalent to converging to a steady state value.</p><p id="P58">Here we demonstrated how CBC can be applied to track equilibria of a system by the application of a stabilizing proportional controller. However, the same results could be achieved with other control strategies as long as the controller stabilises the system’s unstable equilibria. In fact, CBC is not restricted to a particular form of control and thus the control law can in principle take a general form: <disp-formula id="FD18"><label>(18)</label><mml:math id="M27"><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="S12"><title>Main steps of the control-based continuation algorithm</title><p id="P59">The algorithm applied for control-based continuation can be briefly summarized in the following steps: <list list-type="order" id="L3"><list-item><p id="P60">Set a new control reference. A reference value <italic>x<sub>ref</sub> = TetR*</italic> is used to evaluate the error (the difference between the measured <italic>TetR</italic> and the reference target), and it is given to the controller. The range where the reference is picked normally covers the minimum and maximum expression of the protein of interest, but it can be modified according to the need (<xref ref-type="fig" rid="F2">Fig. 2 B</xref> shows a maximum reference value of <italic>TetR*</italic> = 1800[<italic>a.u</italic>], although the maximum expression of <italic>TetR</italic> is 1200[<italic>a.u</italic>]).</p></list-item><list-item><p id="P61">Compute the control action. Depending on the control strategy, either the MPC performs optimization and defines the optimal control input or the proportional controller evaluates the control action depending on the error value.</p></list-item><list-item><p id="P62">Feed the control action to the system. The computed control action <italic>u</italic> is fed to the system for 5 minutes continuously, as it is considered to be the minimum sampling time for measurements and actuation in an hypothetical microfluidics/microscopy experimental set-up. After 5 minutes, the system output is measured and a new error is computed. Steps 2 and 3 are repeated until the process is considered at steady state.</p></list-item><list-item><p id="P63">Check for steady state. The initial implementation of the algorithm considers the system at steady state after a fixed amount of time (9<italic>h</italic> and 55<italic>min</italic> for experiments shown in the Results section). The algorithm allows a variable time for steady state computation. In this case, to compute the steady state of <italic>TetR</italic> and <italic>IPTG</italic>, the slope of the linear curve fitting the last 12 samples after 3 hours of simulation is calculated for both the error and the control signals (where the slope corresponds to the angle the curve makes with respect to the <italic>x</italic> – <italic>axis</italic>). If the computed value is below a user-defined tolerance, the system is assumed at steady state. Otherwise, the simulation continues and the steady state is checked every new sample, until the slope is sufficiently small. A threshold is set on both the error and the control slopes, which may vary between a deterministic and a stochastic simulation.</p></list-item><list-item><p id="P64">Acquire the steady state. The steady state values of <italic>TetR</italic> and <italic>IPTG</italic> (<inline-formula><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mtext> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M29"><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula>) are saved as the average value computed over the last 12 samples of each signal, and the algorithm goes back to step 1.</p></list-item></list>
</p><p id="P65">All steps are repeated until enough steady states are collected, or until the range of output and parameter values has been covered. An initial guess is given as initial state for the algorithm to start with. A schematic of few steps can be seen in <xref ref-type="fig" rid="F1">Fig. 1 B</xref>.</p><p id="P66">Results of the variable stepping reference algorithm can be seen in <xref ref-type="supplementary-material" rid="SD5">Fig. S1-S8</xref> for both the deterministic and the stochastic scenarios.</p></sec><sec id="S13"><title>Proportional Controller</title><p id="P67">The simplest controller that can satisfy CBC requirements is a proportional controller, formally described by the control law of <xref ref-type="disp-formula" rid="FD8">Equation (8)</xref>. The error signal is computed by subtracting the measured output to the control reference (<italic>TetR*</italic> – <italic>TetR</italic>). The error is then fed to the controller to evaluate the control input <italic>IPTG</italic> given to the toggle switch system. A schematic of the control loop can be seen in <xref ref-type="supplementary-material" rid="SD5">Fig. S11 A</xref>.</p><p id="P68">Despite its simplicity, the proportional controller has proved to be a solid choice for CBC. As long as the controller can stabilise the system, the control action is noninvasive and thus the points collected through the CBC routine correspond to the equilibria of the underlying uncontrolled system.</p><p id="P69">To tune the proportional gain <italic>K<sub>p</sub></italic> we linearized the system around an unstable equilibria and then we used the root locus to find the minimum gain able to stabilise the linearized system. Depending on the type of simulation, deterministic or stochastic, the <italic>K<sub>p</sub></italic> gain is then adjusted by trial and error.</p></sec><sec id="S14"><title>Model Predictive Controller</title><p id="P70">Model predictive control is a control scheme based on two main features: prediction and optimization. At each step, a model reproducing the process behaviour is used to predict the process outputs to given input signals. The input minimizing a cost function is computed using an optimization algorithm and fed to the controlled process. We chose a linear model to reproduce behaviours we expect from the real process. A further requirement for the prediction procedure is the process current state which, if not fully measurable, can be estimated using a Kalman filter. A schematic of the control loop can be seen in <xref ref-type="supplementary-material" rid="SD5">Fig. S9 B</xref>.</p></sec><sec id="S15"><title>System identification to reproduce the process experimental behaviour through a simplified model</title><p id="P71">The MPC strategy requires a model to predict the process trajectories and carry out the optimization routine. We artificially reproduced the experimental behaviours using stochastic numerical simulations. Specifically, we measured the response of the system’s outputs (<italic>LacI</italic> and <italic>TetR</italic>) to different randomly generated pulses of <italic>aTc</italic> and <italic>IPTG</italic>, both with fixed and variable amplitude. This data-set was used to identify a LTI system via noniterative subspace estimation algorithm, using the Matlab System Identification toolbox. The result was a continuous-time identified state space model of the following form: <disp-formula id="FD19"><label>(19)</label><mml:math id="M30"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>x</italic>(<italic>t</italic>) is the state, <italic>u</italic>(<italic>t</italic>) is the input to the system, <italic>y</italic>(<italic>t</italic>) is the system output, <italic>d</italic>(<italic>t</italic>) is the state disturbance and <italic>K</italic> is its associated matrix [<xref ref-type="bibr" rid="R46">46</xref>].</p><p id="P72">Here, <italic>A,B,C</italic> and <italic>K</italic> are free parameters to estimate, while <italic>D</italic> was set to 0. <xref ref-type="disp-formula" rid="FD19">Equation (19)</xref> is called innovation form of the state-space model and the matrix <italic>K</italic> corresponds to the Kalman gain matrix associated to the identified system.</p></sec><sec id="S16"><title>Definition of the Kalman predictor to reconstruct unmeasurable states</title><p id="P73">Considering the Toggle Switch system (2), we measure only <italic>LacI</italic> and <italic>TetR</italic> concentrations.</p><p id="P74">To estimate the remaining states we opted for a Kalman filter, defined as: <disp-formula id="FD20"><label>(20)</label><mml:math id="M31"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <inline-formula><mml:math id="M32"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the state estimate, <inline-formula><mml:math id="M33"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the output estimate and all the matrices <italic>A, B, C, D, K</italic> correspond to those obtained through the identification process.</p><p id="P75"><xref ref-type="disp-formula" rid="FD20">Eq. (20)</xref> can be rewritten as follows: <disp-formula id="FD21"><label>(21)</label><mml:math id="M34"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>K</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p id="P76">The addition of a correction based on the measured outputs <italic>LacI</italic> and <italic>TetR</italic> (<italic>U<sub>k</sub></italic> = [<italic>u</italic>(<italic>t</italic>); [<italic>LacI</italic>, <italic>TetR</italic>]]) enables a better fit of the original process outputs [<xref ref-type="bibr" rid="R47">47</xref>].</p><p id="P77">The ability to predict the data recorded is evaluated using the percentage of the output variation that is reproduced by the model. This is defined as: <disp-formula id="FD22"><label>(22)</label><mml:math id="M35"><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:math></disp-formula> where <italic>y</italic> is the measured output, <inline-formula><mml:math id="M36"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the simulated predicted model output and ȳ is the mean value of y. Fit percentages of <italic>LacI</italic> and <italic>TetR</italic> outputs for the system in <xref ref-type="disp-formula" rid="FD21">eq. (21)</xref> are 96.4 and 92.2 respectively.</p></sec><sec id="S17"><title>Definition of a cost function to compute an optimal control action</title><p id="P78">To compute the optimal control action we employed a genetic algorithm [<xref ref-type="bibr" rid="R48">48</xref>]. Commonly, MPC algorithms use quadratic cost functions weighting both the state of the system and the control action. Considering a scalar example, a quadratic cost function could be defined as: <disp-formula id="FD23"><label>(23)</label><mml:math id="M37"><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mtext mathvariant="bold-italic">α</mml:mtext><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mtext mathvariant="bold-italic">β</mml:mtext><mml:mi>u</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p id="P79">Here, <bold>α</bold> and <italic><bold>β</bold></italic> correspond to weighting coefficients reflecting the relative importance of the error <italic>e</italic> and the control input u; <italic>N</italic> represents the prediction horizon, and <italic>i</italic> the current time. To adapt the cost function to CBC and guarantee noninvasiveness of the control input we initially replaced the control input <italic>u</italic> by its variation Δu as follows: <disp-formula id="FD24"><label>(24)</label><mml:math id="M38"><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mtext mathvariant="bold-italic">α</mml:mtext><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mi>∑</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mtext mathvariant="bold-italic">β</mml:mtext><mml:mo>Δ</mml:mo><mml:mi>u</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p id="P80">In this way, the optimization finds the best trade off between regulation accuracy and control variation. Although <xref ref-type="disp-formula" rid="FD24">eq. (24)</xref> granted us good results in most of the simulations, the tuning of both <italic><bold>α</bold></italic> and <italic><bold>β</bold></italic> was difficult, as small changes into the CBC algorithm variables (such as the number of points collected during a single simulation) affected the quality of the results and demanded for retuning of the cost function parameters.</p><p id="P81">To simplify the cost function, we set <italic><bold>β</bold></italic> = 0 and <italic><bold>α</bold></italic> = <italic>N – k</italic> + 1 and forced the optimizer to limit both the control input amplitude and variation at each iteration point. Formally we defined the following constraints: <disp-formula id="FD25"><label>(25)</label><mml:math id="M39"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">init </mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mtext mathvariant="italic">prev </mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mtext mathvariant="italic">prev </mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">curr </mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mtext mathvariant="italic">prev </mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mtext mathvariant="italic">prev </mml:mtext></mml:mrow></mml:msub><mml:mspace width="0.4em"/><mml:mo>∀</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">curr </mml:mtext></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext mathvariant="italic">init </mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>u<sub>init</sub> (t</italic>) is the control input during the first step of the algorithm; <italic>u<sub>curr</sub>(t</italic>) is the control input for all other steps except for the first one and <italic>u<sub>prev</sub></italic> is the control input steady state value, saved before stepping the reference in the algorithm.</p><p id="P82">The presence of external constraints on the control action allows to have a noninvasive contribution without the need for the βΔ<italic>u</italic>(<italic>i</italic> + k)<sup>2</sup> term in the cost function. The parameter <italic><bold>γ</bold></italic> defines a percentage bandwidth that we consider acceptable for the control action to vary between. In other words, at each iteration of the CBC algorithm -by which we mean every time we change the reference signal-the control action cannot vary more than <italic><bold>γ</bold></italic> with respect to the previous registered steady state input. In our simulations <italic><bold>γ</bold></italic> was set to 0.3 for 30 points (<xref ref-type="fig" rid="F3">Fig. 3</xref>, <xref ref-type="fig" rid="F5">5</xref>) and to 0.5 for 11 and 12 points (<xref ref-type="supplementary-material" rid="SD5">Fig. S2</xref>, <xref ref-type="supplementary-material" rid="SD4">S4</xref>). Other settings for <italic><bold>γ</bold></italic> might be found in Figures captions. Fewer points result in larger control reference steps, which can be associated with bigger steps in the control input, and for this reason <italic><bold>γ</bold></italic> can be more easily calibrated just by considering the amount of points to be collected in a simulation.</p></sec><sec id="S18"><title>Parameters estimation process</title><p id="P83">For the estimation process, we calculated the analytical solutions of our toggle switch model (2) that will be used to build the cost function for parameter estimation. In particular, we want to define the function: <disp-formula id="FD26"><label>(26)</label><mml:math id="M40"><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="bold">Θ</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula> that has a unique real solution for each admissible value of <italic>TetR</italic> and for a chosen set of parameters <bold>Θ</bold> = (<italic>klm<sub>0</sub>, klm, <bold>θ</bold><sub>aTc</sub>, <bold>η</bold><sub>aTc</sub>, <bold>θ</bold><sub>TetR</sub>, <bold>η</bold><sub>TetR</sub>, ktm<sub>0</sub>, ktm, <bold>Θ</bold><sub>IPTG</sub>, <bold>θ</bold><sub>IPTG</sub>, <bold>θ</bold><sub>LacI</sub>, <bold>η</bold><sub>LacI</sub>, klp, ktp</italic>), which is the subject of the estimation process. The full <xref ref-type="disp-formula" rid="FD26">Equation (26)</xref> is presented in the Supplementary (S1). Here we considered the parameters (<italic>gtm, glm, glp, gtp</italic>) to be fixed to the values computed in [<xref ref-type="bibr" rid="R6">6</xref>] and therefore we did not estimate them.</p><p id="P84">Once we computed the analytical definition of <italic>g(TetR</italic>, <bold>Θ</bold>), we built the following cost function: <disp-formula id="FD27"><label>(27)</label><mml:math id="M41"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mi>∑</mml:mi></mml:mstyle></mml:mrow><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mo>||</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mtext>Θ</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>||</mml:mo><mml:msub><mml:mspace width="0.2em"/><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M42"><mml:mo stretchy="false">[</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, are the measured steady state values of control input and control output out of the CBC routine for the <italic>i</italic> point of the bifurcation curve. The <italic>k</italic> index looks for the estimated point <inline-formula><mml:math id="M43"><mml:mo stretchy="false">[</mml:mo><mml:mtext>g</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mtext>Θ</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula> with minimum distance (L<sup>2</sup> norm) from the measured steady state considered by the index <italic>i</italic>. <inline-formula><mml:math id="M44"><mml:mover accent="true"><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula> is normalized between 0 and 1 to be comparable with <inline-formula><mml:math id="M45"><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula>.</p><p id="P85">Minimizing the cost function <xref ref-type="disp-formula" rid="FD27">(27)</xref> for all points collected during an experiment, it is possible to estimate the best set of parameters <bold>Θ</bold> that allows to characterize a model of the toggle switch reproducing the bistability behaviour seen via experiments. Once a set of parameters is found (using a genetic algorithm), it is possible to build the bifurcation curve by solving <xref ref-type="disp-formula" rid="FD26">Equation (26)</xref> for fixed values of <italic>TetR</italic>. Sets <bold>Θ</bold> that gave complex values of <italic>IPTG</italic> were directly discarded. Estimates of parameters for different experimental settings and percentage variation with respect to nominal values can be seen in <xref ref-type="supplementary-material" rid="SD5">Table S1</xref>.</p><p id="P86">In order to validate the results of the estimation using data collected with the CBC algorithm, a comparison with the parameter sweeps method was made. Parameter sweeps is a simple experimental design to collect data at different values of a parameter of interest and is commonly used for parameter estimation. Considering the example of the toggle switch, parameter sweeps is implemented registering the steady state signal <inline-formula><mml:math id="M46"><mml:mover accent="true"><mml:mrow><mml:mtext mathvariant="italic"> TetR </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula> for fixed values of the input <inline-formula><mml:math id="M47"><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math></inline-formula>. Collected points <inline-formula><mml:math id="M48"><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> fall on the stable branches of our bifurcation curve, as shown in <xref ref-type="supplementary-material" rid="SD5">Fig. S11 A, B, C</xref>. This method does not allow to collect unstable steady states as there is no control over the system.</p><p id="P87">We showed that CBC grants a more robust estimation by collecting data in the unstable branch, which is not possible through simple parameter sweeps, and allows to retrieve the bistability of the system (see <xref ref-type="supplementary-material" rid="SD5">Fig. S9 D, E, F</xref>).</p><p id="P88">As highlighted in the main text, assuming an <italic>a priori</italic> knowledge of the system’s bistability, we could improve the performances of our calibration by releasing the constraint on sets <bold>Θ</bold> that generate complex values of <italic>IPTG</italic>. Furthermore, more complex cost function could be considered (for example, the minimum distance of measured point from the calibrated bifurcation curve). <xref ref-type="supplementary-material" rid="SD5">Fig. S10</xref> shows this latter improved case, with very good fitting performances compared to the initial estimation. Although the noticeable improvement, the modified cost function requires a much longer computational time and knowledge of the system of interest’s dynamics, which is often not the case when CBC is applied experimentally.</p></sec><sec id="S19"><title>Agent-based simulations</title><p id="P89">All agent based simulations were performed using BSim, an agent-based environment designed to simulate bacterial populations [<xref ref-type="bibr" rid="R30">30</xref>, <xref ref-type="bibr" rid="R33">33</xref>]. Here, cell bio-mechanics are explicitly modelled, together with cell growth and division. The spatial configuration and dynamics of the chemical inducers added in the culture environment are also simulated, introducing an extra time delay in the delivery of the inducer molecules to the cells. In addition, it is possible to mimic microfluidic-based experimental platforms, including related physical and technological constraints (e.g. dimensions and shape of microfluidic chambers, flush out of cells). Specifically, we can define the geometry and dimension of the microfluidic chamber, and the physical interactions of the cells with the device. We can account for cells movement and collision inside the growth chamber and simulate the flushing out of the cells from the chamber with their consequent removal from the set of analysable cells. The CBC algorithm was implemented by adding to the simulation environment both the proportional and the MPC controllers.</p><p id="P90">As previously done in Shannon et al. [<xref ref-type="bibr" rid="R22">22</xref>] and Salzano et al. [<xref ref-type="bibr" rid="R49">49</xref>], the simulation environment has been complemented with the SDE solver based on the Euler-Maruyama method (4).</p><p id="P91">BSim simulates experiments via a microfluidic-based system composed by a microfluidic device, a microscopy, a computer and an actuation system. Dimensions of the growth chamber were initially taken from Lugagne et al. [<xref ref-type="bibr" rid="R6">6</xref>] but then set to 16<italic>μM ×</italic> 1.5<italic>μM</italic> × 1<italic>μM</italic> to reduce the simulation time. The proportional controller was implemented directly in Bsim, while the MPC was implemented in Matlab and externally called by the agent-based simulator. All bio-mechanical parameters of the cells were set to the same values used by Matyjaszkiewicz et al. [<xref ref-type="bibr" rid="R30">30</xref>]. Moreover, realistic constraints on the sampling and actuation time were considered, similarly to what already done for Matlab CBC simulations. More precisely, we enforced the state of the cells to be measured every 5min and we assumed the input provided to be changed at most every 5min. Finally, we assumed a 40s delay on the actuation of the control inputs, accounting for the time the inducers would take to reach the microfluidics cell culture chambers in a physical experiment.</p><p id="P92">All the factors taken into account in BSim added additional sources of variability to the simulations, sometimes affecting the performance of the control algorithms, as discussed in the Results and Discussion sections.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Movie S1 supplementary info</label><media xlink:href="EMS144670-supplement-Movie_S1_supplementary_info.mp4" mimetype="video" mime-subtype="mp4" id="d34aAdDbB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Movie S2 supplementary info</label><media xlink:href="EMS144670-supplement-Movie_S2_supplementary_info.mp4" mimetype="video" mime-subtype="mp4" id="d34aAdDcB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Movie S3 supplementary info</label><media xlink:href="EMS144670-supplement-Movie_S3_supplementary_info.mp4" mimetype="video" mime-subtype="mp4" id="d34aAdDdB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Movie S4 supplementary info</label><media xlink:href="EMS144670-supplement-Movie_S4_supplementary_info.mp4" mimetype="video" mime-subtype="mp4" id="d34aAdDeB" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary Information</label><media xlink:href="EMS144670-supplement-Supplementary_Information.pdf" mimetype="application" mime-subtype="pdf" id="d34aAdDfB" position="anchor"/></supplementary-material></sec></body><back><ack id="S20"><title>Acknowledgments</title><p>I.d.C. is supported by an EPSRC DTP Scholarship. L.M. is supported by the Medical Research Council grant MR/N021444/1, by the Engineering and Physical Sciences Research Council grants EP/R041695/1 and EP/S01876X/1, and by the European Union’s Horizon 2020 under Grant Agreement No. 766840. L.R. is funded by a Research Fellowship from the Royal Academy of Engineering (RF1516/15/11).</p></ack><sec id="S21" sec-type="data-availability"><title>Data availability</title><p id="P93">The code used in this publication is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/lrenson/cbc-synbio-paper">https://github.com/lrenson/cbc-synbio-paper</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/diBernardoGroup/Control-Based-Continuation-of-a-genetic-Toggle-Switch">https://github.com/diBernardoGroup/Control-Based-Continuation-of-a-genetic-Toggle-Switch</ext-link>. Movies S1, S2, S3 and S4 are provided as supplementary files.</p></sec><glossary><title>Abbreviations</title><def-list><def-item><term>CBC</term><def><p>control-based continuation</p></def></def-item><def-item><term>MPC</term><def><p>model predctive control</p></def></def-item><def-item><term>P</term><def><p>proportional control.</p></def></def-item></def-list></glossary><fn-group><fn id="FN2" fn-type="con"><p id="P94"><bold>Author Contributions</bold></p><p id="P95">I.d.C. designed and carried out the simulations in Matlab2019b and wrote the manuscript with inputs from all the authors. D.S. developed the BSim code and wrote the agent-based simulations section. M.d.B supervised the initial development of CBC and the agent-based implementation. L.R. provided the initial framework for the CBC code. L.R. and L.M. conceived the project and supervised the entire work.</p></fn><fn id="FN3" fn-type="conflict"><p id="P96"><bold>Declaration of Interests</bold></p><p id="P97">Nothing to declare.</p></fn></fn-group><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Din</surname><given-names>M Omar</given-names></name><name><surname>Danino</surname><given-names>Tal</given-names></name><name><surname>Prindle</surname><given-names>Arthur</given-names></name><name><surname>Skalak</surname><given-names>Matt</given-names></name><name><surname>Selimkhanov</surname><given-names>Jangir</given-names></name><name><surname>Allen</surname><given-names>Kaitlin</given-names></name><name><surname>Julio</surname><given-names>Ellixis</given-names></name><name><surname>Atolia</surname><given-names>Eta</given-names></name><name><surname>Tsimring</surname><given-names>Lev S</given-names></name><name><surname>Bhatia</surname><given-names>Sangeeta N</given-names></name><etal/></person-group><article-title>Synchronized cycles of bacterial lysis for in vivo delivery</article-title><source>Nature</source><year>2016</year><volume>536</volume><issue>7614</issue><fpage>81</fpage><lpage>85</lpage></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elowitz</surname><given-names>Michael B</given-names></name><name><surname>Leibler</surname><given-names>Stanislas</given-names></name></person-group><article-title>A synthetic oscillatory network of transcriptional regulators</article-title><source>Nature</source><year>2000</year><volume>403</volume><issue>6767</issue><fpage>335</fpage><lpage>338</lpage></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marucci</surname><given-names>Lucia</given-names></name><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Cantone</surname><given-names>Irene</given-names></name><name><surname>Ricci</surname><given-names>Maria Aurelia</given-names></name><name><surname>Cosma</surname><given-names>Maria Pia</given-names></name><name><surname>Santini</surname><given-names>Stefania</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name></person-group><article-title>How to turn a genetic circuit into a synthetic tunable oscillator, or a bistable switch</article-title><source>PloS one</source><year>2009</year><volume>4</volume><issue>12</issue><elocation-id>e8083</elocation-id></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stricker</surname><given-names>Jesse</given-names></name><name><surname>Cookson</surname><given-names>Scott</given-names></name><name><surname>Bennett</surname><given-names>Matthew R</given-names></name><name><surname>Mather</surname><given-names>William H</given-names></name><name><surname>Tsimring</surname><given-names>Lev S</given-names></name><name><surname>Hasty</surname><given-names>Jeff</given-names></name></person-group><article-title>A fast, robust and tunable synthetic gene oscillator</article-title><source>Nature</source><year>2008</year><volume>456</volume><issue>7221</issue><fpage>516</fpage><lpage>519</lpage></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tigges</surname><given-names>Marcel</given-names></name><name><surname>Dénervaud</surname><given-names>Nicolas</given-names></name><name><surname>Greber</surname><given-names>David</given-names></name><name><surname>Stelling</surname><given-names>Joerg</given-names></name><name><surname>Fussenegger</surname><given-names>Martin</given-names></name></person-group><article-title>A synthetic low-frequency mammalian oscillator</article-title><source>Nucleic acids research</source><year>2010</year><volume>38</volume><issue>8</issue><fpage>2702</fpage><lpage>2711</lpage></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lugagne</surname><given-names>Jean-Baptiste</given-names></name><name><surname>Carrillo</surname><given-names>Sebastián Sosa</given-names></name><name><surname>Kirch</surname><given-names>Melanie</given-names></name><name><surname>Köhler</surname><given-names>Agnes</given-names></name><name><surname>Batt</surname><given-names>Gregory</given-names></name><name><surname>Hersen</surname><given-names>Pascal</given-names></name></person-group><article-title>Balancing a genetic toggle switch by real-time feedback control and periodic forcing</article-title><source>Nature communications</source><year>2017</year><volume>8</volume><issue>1</issue><fpage>1</fpage><lpage>8</lpage></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kramer</surname><given-names>Beat P</given-names></name><name><surname>Viretta</surname><given-names>Alessandro Usseglio</given-names></name><name><surname>Daoud-El Baba</surname><given-names>Marie</given-names></name><name><surname>Aubel</surname><given-names>Dominique</given-names></name><name><surname>Weber</surname><given-names>Wilfried</given-names></name><name><surname>Fussenegger</surname><given-names>Martin</given-names></name></person-group><article-title>An engineered epigenetic transgene switch in mammalian cells</article-title><source>Nature biotechnology</source><year>2004</year><volume>22</volume><issue>7</issue><fpage>867</fpage><lpage>870</lpage></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perez-Carrasco</surname><given-names>Ruben</given-names></name><name><surname>Barnes</surname><given-names>Chris P</given-names></name><name><surname>Schaerli</surname><given-names>Yolanda</given-names></name><name><surname>Isalan</surname><given-names>Mark</given-names></name><name><surname>Briscoe</surname><given-names>James</given-names></name><name><surname>Page</surname><given-names>Karen M</given-names></name></person-group><article-title>Combining a toggle switch and a repressilator within the ac-dc circuit generates distinct dynamical behaviors</article-title><source>Cell systems</source><year>2018</year><volume>6</volume><issue>4</issue><fpage>521</fpage><lpage>530</lpage></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siciliano</surname><given-names>Velia</given-names></name><name><surname>Menolascina</surname><given-names>Filippo</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name><name><surname>Fracassi</surname><given-names>Chiara</given-names></name><name><surname>Garzilli</surname><given-names>Immacolata</given-names></name><name><surname>Moretti</surname><given-names>Maria Nicoletta</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name></person-group><article-title>Construction and modelling of an inducible positive feedback loop stably integrated in a mammalian cell-line</article-title><source>PLoS Comput Biol</source><year>2011</year><volume>7</volume><issue>6</issue><elocation-id>e1002074</elocation-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>Timothy S</given-names></name><name><surname>Cantor</surname><given-names>Charles R</given-names></name><name><surname>Collins</surname><given-names>James J</given-names></name></person-group><article-title>Construction of a genetic toggle switch in escherichia coli</article-title><source>Nature</source><year>2000</year><volume>403</volume><issue>6767</issue><fpage>339</fpage><lpage>342</lpage></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balázsi</surname><given-names>Gábor</given-names></name><name><surname>van Oudenaarden</surname><given-names>Alexander</given-names></name><name><surname>Collins</surname><given-names>James J</given-names></name></person-group><article-title>Cellular decision making and biological noise: from microbes to mammals</article-title><source>Cell</source><year>2011</year><volume>144</volume><issue>6</issue><fpage>910</fpage><lpage>925</lpage></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marucci</surname><given-names>Lucia</given-names></name></person-group><article-title>Nanog dynamics in mouse embryonic stem cells: results from systems biology approaches</article-title><source>Stem cells international</source><year>2017</year><volume>2017</volume></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Babtie</surname><given-names>Ann C</given-names></name><name><surname>Kirk</surname><given-names>Paul</given-names></name><name><surname>Stumpf</surname><given-names>Michael PH</given-names></name></person-group><article-title>Topological sensitivity analysis for systems biology</article-title><source>Proceedings of the National Academy of Sciences</source><year>2014</year><volume>111</volume><issue>52</issue><fpage>18507</fpage><lpage>18512</lpage></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsiao</surname><given-names>Victoria</given-names></name><name><surname>Swaminathan</surname><given-names>Anandh</given-names></name><name><surname>Murray</surname><given-names>Richard M</given-names></name></person-group><article-title>Control theory for synthetic biology: recent advances in system characterization, control design, and controller implementation for synthetic biology</article-title><source>IEEE Control Systems Magazine</source><year>2018</year><volume>38</volume><issue>3</issue><fpage>32</fpage><lpage>62</lpage></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sieber</surname><given-names>Jan</given-names></name><name><surname>Krauskopf</surname><given-names>Bernd</given-names></name></person-group><article-title>Control based bifurcation analysis for experiments</article-title><source>Nonlinear Dynamics</source><year>2008</year><volume>51</volume><issue>3</issue><fpage>365</fpage><lpage>377</lpage></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Mann</surname><given-names>Brian P</given-names></name><name><surname>Burrow</surname><given-names>Stephen G</given-names></name></person-group><article-title>Control-based continuation for investigating nonlinear experiments</article-title><source>Journal of Vibration and Control</source><year>2012</year><volume>18</volume><issue>4</issue><fpage>509</fpage><lpage>520</lpage></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renson</surname><given-names>Ludovic</given-names></name><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Neild</surname><given-names>Simon A</given-names></name></person-group><article-title>Experimental tracking of limit-point bifurcations and backbone curves using control-based continuation</article-title><source>International Journal of Bifurcation and Chaos</source><year>2017</year><volume>27</volume><issue>01</issue><elocation-id>1730002</elocation-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renson</surname><given-names>Ludovic</given-names></name><name><surname>Shaw</surname><given-names>AD</given-names></name><name><surname>Barton</surname><given-names>DAW</given-names></name><name><surname>Neild</surname><given-names>SA</given-names></name></person-group><article-title>Application of control-based con-tinuation to a nonlinear structure with harmonically coupled modes</article-title><source>Mechanical Systems and Signal Processing</source><year>2019</year><volume>120</volume><fpage>449</fpage><lpage>464</lpage></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menolascina</surname><given-names>Filippo</given-names></name><name><surname>Fiore</surname><given-names>Gianfranco</given-names></name><name><surname>Orabona</surname><given-names>Emanuele</given-names></name><name><surname>De Stefano</surname><given-names>Luca</given-names></name><name><surname>Ferry</surname><given-names>Mike</given-names></name><name><surname>Hasty</surname><given-names>Jeff</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name></person-group><article-title>In-vivo real-time control of protein expression from endogenous and synthetic gene networks</article-title><source>PLoS Comput Biol</source><year>2014</year><volume>10</volume><issue>5</issue><elocation-id>e1003625</elocation-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Napolitano</surname><given-names>Sara</given-names></name><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>Rocca</surname><given-names>Daniel L</given-names></name><name><surname>Aulicino</surname><given-names>Francesco</given-names></name><name><surname>Santorelli</surname><given-names>Marco</given-names></name><name><surname>Tumaini</surname><given-names>Barbara</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name></person-group><article-title>Regulation of gene expression and signaling pathway activity in mammalian cells by automated microfluidics feedback control</article-title><source>ACS synthetic biology</source><year>2018</year><volume>7</volume><issue>11</issue><fpage>2558</fpage><lpage>2565</lpage></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Aulicino</surname><given-names>Francesco</given-names></name><name><surname>Rocca</surname><given-names>Dan L</given-names></name><name><surname>Montes-Olivas</surname><given-names>Sandra</given-names></name><name><surname>Khazim</surname><given-names>Mahmoud</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name><name><surname>Cosma</surname><given-names>Maria Pia</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name></person-group><article-title>A tunable dual-input system for on-demand dynamic gene expression regulation</article-title><source>Nature communications</source><year>2019</year><volume>10</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname><given-names>Barbara</given-names></name><name><surname>Zamora-Chimal</surname><given-names>Criseida G</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Salzano</surname><given-names>Davide</given-names></name><name><surname>Grierson</surname><given-names>Claire S</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name><name><surname>Savery</surname><given-names>Nigel J</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name></person-group><article-title>In vivo feedback control of an antithetic molecular-titration motif in escherichia coli using microfluidics</article-title><source>ACS Synthetic Biology</source><year>2020</year><volume>9</volume><issue>10</issue><fpage>2617</fpage><lpage>2624</lpage></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uhlendorf</surname><given-names>Jannis</given-names></name><name><surname>Miermont</surname><given-names>Agnès</given-names></name><name><surname>Delaveau</surname><given-names>Thierry</given-names></name><name><surname>Charvin</surname><given-names>Gilles</given-names></name><name><surname>Fages</surname><given-names>François</given-names></name><name><surname>Bottani</surname><given-names>Samuel</given-names></name><name><surname>Batt</surname><given-names>Gregory</given-names></name><name><surname>Hersen</surname><given-names>Pascal</given-names></name></person-group><article-title>Long-term model predictive control of gene expression at the population and single-cell levels</article-title><source>Proceedings of the National Academy of Sciences</source><year>2012</year><volume>109</volume><issue>35</issue><fpage>14271</fpage><lpage>14276</lpage></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>De Cesare</surname><given-names>Irene</given-names></name><name><surname>Zamora-Chimal</surname><given-names>Criseida G</given-names></name><name><surname>Haener</surname><given-names>David</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Regina</surname><given-names>Antonella La</given-names></name><name><surname>Shannon</surname><given-names>Barbara</given-names></name><name><surname>Savery</surname><given-names>Nigel J</given-names></name><name><surname>Grierson</surname><given-names>Claire S</given-names></name><name><surname>Di Bernardo</surname><given-names>Mario</given-names></name><etal/></person-group><article-title>Cheetah: a computational toolkit for cybergenetic control</article-title><source>ACS Synthetic Biology</source><year>2021</year><volume>10</volume><issue>5</issue><fpage>979</fpage><lpage>989</lpage></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Cesare</surname><given-names>Irene</given-names></name><name><surname>Zamora-Chimal</surname><given-names>Criseida G</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Khazim</surname><given-names>Mahmoud</given-names></name><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>Shannon</surname><given-names>Barbara</given-names></name><name><surname>Fiore</surname><given-names>Gianfranco</given-names></name><name><surname>Perrino</surname><given-names>Giansimone</given-names></name><name><surname>Napolitano</surname><given-names>Sara</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name><etal/></person-group><article-title>Chipseg: An automatic tool to segment bacterial and mammalian cells cultured in microfluidic devices</article-title><source>ACS omega</source><year>2021</year><volume>6</volume><issue>4</issue><fpage>2473</fpage><lpage>2476</lpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Khazim</surname><given-names>Mahmoud</given-names></name><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>di Bernardo</surname><given-names>Diego</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name></person-group><chapter-title>A microfluidic/microscopy-based platform for on-chip controlled gene expression in mammalian cells</chapter-title><source>Synthetic Gene Circuits</source><publisher-name>Springer</publisher-name><year>2021</year><fpage>205</fpage><lpage>219</lpage></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khazim</surname><given-names>Mahmoud</given-names></name><name><surname>Postiglione</surname><given-names>Lorena</given-names></name><name><surname>Pedone</surname><given-names>Elisa</given-names></name><name><surname>Rocca</surname><given-names>Dan L</given-names></name><name><surname>Zahra</surname><given-names>Carine</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name></person-group><article-title>Towards automated control of embryonic stem cell pluripotency</article-title><source>IFAC-PapersOnLine</source><year>2019</year><volume>52</volume><issue>26</issue><fpage>82</fpage><lpage>87</lpage></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Del Vecchio</surname><given-names>Domitilla</given-names></name><name><surname>Dy</surname><given-names>Aaron J</given-names></name><name><surname>Qian</surname><given-names>Yili</given-names></name></person-group><article-title>Control theory meets synthetic biology</article-title><source>Journal of The Royal Society Interface</source><year>2016</year><volume>13</volume><issue>120</issue><elocation-id>20160380</elocation-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Min</given-names></name><name><surname>Su</surname><given-names>Ri-Qi</given-names></name><name><surname>Li</surname><given-names>Xiaohui</given-names></name><name><surname>Ellis</surname><given-names>Tom</given-names></name><name><surname>Lai</surname><given-names>Ying-Cheng</given-names></name><name><surname>Wang</surname><given-names>Xiao</given-names></name></person-group><article-title>Engineering of regulated stochastic cell fate determination</article-title><source>Proceedings of the National Academy of Sciences</source><year>2013</year><volume>110</volume><issue>26</issue><fpage>10610</fpage><lpage>10615</lpage></element-citation></ref><ref id="R30"><label>[30]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matyjaszkiewicz</surname><given-names>Antoni</given-names></name><name><surname>Fiore</surname><given-names>Gianfranco</given-names></name><name><surname>Annunziata</surname><given-names>Fabio</given-names></name><name><surname>Grierson</surname><given-names>Claire S</given-names></name><name><surname>Savery</surname><given-names>Nigel J</given-names></name><name><surname>Marucci</surname><given-names>Lucia</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name></person-group><article-title>Bsim 2.0: an advanced agent-based cell simulator</article-title><source>ACS synthetic biology</source><year>2017</year><volume>6</volume><issue>10</issue><fpage>1969</fpage><lpage>1972</lpage></element-citation></ref><ref id="R31"><label>[31]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Sieber</surname><given-names>Jan</given-names></name></person-group><article-title>Systematic experimental exploration of bifurcations with noninvasive control</article-title><source>Physical Review E</source><year>2013</year><volume>87</volume><issue>5</issue><elocation-id>052916</elocation-id></element-citation></ref><ref id="R32"><label>[32]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beregi</surname><given-names>Sandor</given-names></name><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Rezgui</surname><given-names>Djamel</given-names></name><name><surname>Neild</surname><given-names>Simon A</given-names></name></person-group><article-title>Robustness of nonlinear parameter identification in the presence of process noise using control-based continuation</article-title><source>Nonlinear Dynamics</source><year>2021</year><volume>104</volume><issue>2</issue><fpage>885</fpage><lpage>900</lpage></element-citation></ref><ref id="R33"><label>[33]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorochowski</surname><given-names>Thomas E</given-names></name><name><surname>Matyjaszkiewicz</surname><given-names>Antoni</given-names></name><name><surname>Todd</surname><given-names>Thomas</given-names></name><name><surname>Oak</surname><given-names>Neeraj</given-names></name><name><surname>Kowalska</surname><given-names>Kira</given-names></name><name><surname>Reid</surname><given-names>Stephen</given-names></name><name><surname>Tsaneva-Atanasova</surname><given-names>Krasimira T</given-names></name><name><surname>Savery</surname><given-names>Nigel J</given-names></name><name><surname>Grierson</surname><given-names>Claire S</given-names></name><name><surname>Di Bernardo</surname><given-names>Mario</given-names></name></person-group><source>Bsim: an agent-based tool for modeling bacterial populations in systems and synthetic biology</source><year>2012</year></element-citation></ref><ref id="R34"><label>[34]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guarino</surname><given-names>Agostino</given-names></name><name><surname>Fiore</surname><given-names>Davide</given-names></name><name><surname>Salzano</surname><given-names>Davide</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name></person-group><article-title>Balancing cell populations endowed with a synthetic toggle switch via adaptive pulsatile feedback control</article-title><source>ACS synthetic biology</source><year>2020</year><volume>9</volume><issue>4</issue><fpage>793</fpage><lpage>803</lpage></element-citation></ref><ref id="R35"><label>[35]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Walter</surname><given-names>Eric</given-names></name><name><surname>Pronzato</surname><given-names>Luc</given-names></name></person-group><source>Identification of parametric models: from experimental data</source><publisher-name>Springer Verlag</publisher-name><year>1997</year></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ljung</surname><given-names>Lennart</given-names></name></person-group><article-title>Perspectives on system identification</article-title><source>Annual Reviews in Control</source><year>2010</year><volume>34</volume><issue>1</issue><fpage>1</fpage><lpage>12</lpage></element-citation></ref><ref id="R37"><label>[37]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villaverde</surname><given-names>Alejandro F</given-names></name><name><surname>Barreiro</surname><given-names>Antonio</given-names></name><name><surname>Papachristodoulou</surname><given-names>Antonis</given-names></name></person-group><article-title>Structural identi-fiability of dynamic systems biology models</article-title><source>PLoS computational biology</source><year>2016</year><volume>12</volume><issue>10</issue><elocation-id>e1005153</elocation-id></element-citation></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villaverde</surname><given-names>Alejandro F</given-names></name><name><surname>Tsiantis</surname><given-names>Nikolaos</given-names></name><name><surname>Banga</surname><given-names>Julio R</given-names></name></person-group><article-title>Full observability and estimation of unknown inputs, states and parameters of nonlinear biological models</article-title><source>Journal of the Royal Society Interface</source><year>2019</year><volume>16</volume><issue>156</issue><elocation-id>20190043</elocation-id></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sieber</surname><given-names>Jan</given-names></name><name><surname>Krauskopf</surname><given-names>Bernd</given-names></name><name><surname>Wagg</surname><given-names>David</given-names></name><name><surname>Neild</surname><given-names>Simon</given-names></name><name><surname>Gonzalez-Buelga</surname><given-names>Alicia</given-names></name></person-group><article-title>Control-based continuation of unstable periodic orbits</article-title><source>Journal of Computational and Nonlinear Dynamics</source><year>2011</year><volume>6</volume><issue>1</issue></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renson</surname><given-names>Ludovic</given-names></name><name><surname>Sieber</surname><given-names>Jan</given-names></name><name><surname>Barton</surname><given-names>David AW</given-names></name><name><surname>Shaw</surname><given-names>AD</given-names></name><name><surname>Neild</surname><given-names>SA</given-names></name></person-group><article-title>Numerical continuation in nonlinear experiments using local gaussian process regression</article-title><source>Nonlinear Dynamics</source><year>2019</year><volume>98</volume><issue>4</issue><fpage>2811</fpage><lpage>2826</lpage></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fiore</surname><given-names>Gianfranco</given-names></name><name><surname>Perrino</surname><given-names>Giansimone</given-names></name><name><surname>Di Bernardo</surname><given-names>Mario</given-names></name><name><surname>Di Bernardo</surname><given-names>Diego</given-names></name></person-group><article-title>In vivo real-time control of gene expression: a comparative analysis of feedback control strategies in yeast</article-title><source>ACS synthetic biology</source><year>2016</year><volume>5</volume><issue>2</issue><fpage>154</fpage><lpage>162</lpage></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Yang</given-names></name><name><surname>Dankowicz</surname><given-names>Harry</given-names></name></person-group><article-title>Adaptive control designs for control-based continuation in a class of uncertain discrete-time dynamical systems</article-title><source>Journal of Vibration and Control</source><year>2020</year><elocation-id>1077546320913377</elocation-id></element-citation></ref><ref id="R43"><label>[43]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balagaddé</surname><given-names>FrederickK</given-names></name><name><surname>Song</surname><given-names>Hao</given-names></name><name><surname>Ozaki</surname><given-names>Jun</given-names></name><name><surname>Collins</surname><given-names>Cynthia H</given-names></name><name><surname>Barnet</surname><given-names>Matthew</given-names></name><name><surname>Arnold</surname><given-names>Frances H</given-names></name><name><surname>Quake</surname><given-names>Stephen R</given-names></name><name><surname>You</surname><given-names>Lingchong</given-names></name></person-group><article-title>A synthetic escherichia coli predator-prey ecosystem</article-title><source>Molecular systems biology</source><year>2008</year><volume>4</volume><issue>1</issue><fpage>187</fpage></element-citation></ref><ref id="R44"><label>[44]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lakatos</surname><given-names>Eszter</given-names></name></person-group><article-title>Stochastic analysis and control methods for molecular cell biology</article-title><year>2017</year></element-citation></ref><ref id="R45"><label>[45]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>Daniel T</given-names></name></person-group><article-title>Exact stochastic simulation of coupled chemical reactions</article-title><source>The journal of physical chemistry</source><year>1977</year><volume>81</volume><issue>25</issue><fpage>2340</fpage><lpage>2361</lpage></element-citation></ref><ref id="R46"><label>[46]</label><element-citation publication-type="web"><collab>MATHWORKS Repository</collab><comment><ext-link ext-link-type="uri" xlink:href="https://it.mathworks.com/help/ident/ug/identifying-state-space-models-with-independent-process-and-measurement-noise.html">https://it.mathworks.com/help/ident/ug/identifying-state-space-models-with-independent-process-and-measurement-noise.html</ext-link></comment></element-citation></ref><ref id="R47"><label>[47]</label><element-citation publication-type="web"><collab>MATHWORKS Repository</collab><comment><ext-link ext-link-type="uri" xlink:href="https://it.mathworks.com/help/ident/ug/definition-simulation-and-prediction.html">https://it.mathworks.com/help/ident/ug/definition-simulation-and-prediction.html</ext-link></comment></element-citation></ref><ref id="R48"><label>[48]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>Lawrence</given-names></name></person-group><source>Handbook of genetic algorithms</source><year>1991</year></element-citation></ref><ref id="R49"><label>[49]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salzano</surname><given-names>Davide</given-names></name><name><surname>Fiore</surname><given-names>Davide</given-names></name><name><surname>di Bernardo</surname><given-names>Mario</given-names></name></person-group><article-title>Controlling reversible cell differentiation for labor division in microbial consortia</article-title><source>bioRxiv</source><year>2021</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>A) A schematic Toggle Switch from Lugagne et al. [<xref ref-type="bibr" rid="R6">6</xref>]; two different paths to the bifurcation diagram (<bold>- -</bold>): numerical continuation (path 1), and control-based continuation (path 2). Unstable branch of the bifurcation curve (<styled-content style="color:#FF0000">-</styled-content>) and bifurcation points (<bold>*</bold>) are highlighted. B) Steps of the CBC algorithm: at time <italic>t</italic> = 124<italic>h</italic> the control pushes the system’s trajectory <italic>TetR</italic>(<italic>IPTG</italic>) (–) towards the new reference <italic>TetR*</italic> (<styled-content style="color:#0000FF">- -</styled-content>). At time <italic>t</italic> = 144<italic>h</italic> transient dynamics are extinguished and a point <inline-formula><mml:math id="M49"><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mtext> </mml:mtext><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is saved (.). Then, the reference signal is increased and the process is repeated.</p></caption><graphic xlink:href="EMS144670-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>CBC with P controller applied to the deterministic toggle switch model (2).</title><p>A) Equilibrium curve measured using CBC (·). <italic>TetR</italic>(<italic>IPTG</italic>) transient trajectories (<styled-content style="color:#FF0000">.</styled-content>). Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <italic>k<sub>p</sub> =</italic> 0.0016 and <italic>aTc = 25ngmL<sup>–</sup>1</italic>.</p></caption><graphic xlink:href="EMS144670-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>CBC with MPC applied to the deterministic toggle switch model (2).</title><p>A) Equilibrium curve measured using CBC (·). <italic>TetR</italic>(<italic>IPTG</italic>) transient trajectories (<styled-content style="color:#FF0000">..</styled-content>). Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <bold>Y</bold> = 0.3 (<xref ref-type="disp-formula" rid="FD25">Eq. (25)</xref>) and <italic>aTc = 25ngmL<sup>–</sup>1</italic>.</p></caption><graphic xlink:href="EMS144670-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>CBC with P controller applied to the stochastic toggle switch model (4).</title><p>A) Density plot of equilibrium curve measured using CBC. Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of one simulation of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <italic>k<sub>p</sub> =</italic> 0.0016 and <italic>aTc = 25ngmL<sup>–</sup></italic>1.</p></caption><graphic xlink:href="EMS144670-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>CBC with MPC applied to the stochastic toggle switch model (4).</title><p>A) Density plot of equilibrium curve measured using CBC. Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of one simulation of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <italic>γ</italic> = 0.3 (<xref ref-type="disp-formula" rid="FD25">Eq. (25)</xref>) and <italic>aTc = 25ngmL<sup>–</sup>1</italic>.</p></caption><graphic xlink:href="EMS144670-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>CBC with P controller applied to the stochastic toggle switch model (4) in BSim.</title><p>A) Density plot of equilibrium curve measured using CBC. Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of one simulation of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <italic>k<sub>p</sub></italic> = 0.0016 and <italic>aTc</italic> = <italic>25ngmL<sup>–</sup></italic>1.</p></caption><graphic xlink:href="EMS144670-f006"/></fig><fig id="F7" position="float"><label>Figure 7</label><caption><title>CBC with MPC applied to the stochastic toggle switch model (4) in BSim.</title><p>A) Density plot of equilibrium curve measured using CBC. Reference equilibrium curve obtained using numerical continuation (- -). B) Time evolution of one simulation of <italic>TetR</italic> and the control reference signal <italic>TetR*</italic> (–). C) Time evolution of <italic>IPTG</italic> (i.e. control signal). Parameter values: <italic>γ</italic> = 0.3 (<xref ref-type="disp-formula" rid="FD25">Eq. (25)</xref>) and <italic>aTc</italic> = <italic>25ngmL</italic><sup>–</sup> 1.</p></caption><graphic xlink:href="EMS144670-f007"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Parameters for the toggle switch model</title></caption><table frame="box" rules="all"><thead><tr style="border-top: double"><th align="center" valign="middle">Parameters</th><th align="center" valign="middle">Description</th><th align="center" valign="middle">Value</th></tr></thead><tbody><tr style="border-top: double"><td align="center" valign="middle"><inline-formula><mml:math id="M50"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">Transcription rates (mRNA <italic>min</italic><sup>–1</sup>)</td><td align="center" valign="middle">3.20<italic>e</italic> − 2</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M51"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.19<italic>e</italic> − 1</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M52"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">8.30</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M53"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.06</td></tr><tr style="border-top: double"><td align="center" valign="middle"><inline-formula><mml:math id="M54"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">Translation rates (a.u. <italic>mRNA</italic><sup>–1</sup> <italic>min</italic><sup>–1</sup>)</td><td align="center" valign="middle">9.726<italic>e</italic> − 1</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M55"><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.170</td></tr><tr style="border-top: double"><td align="center" valign="middle"><inline-formula><mml:math id="M56"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">Degradation rates (<italic>min</italic><sup>–1</sup>)</td><td align="center" valign="middle">1.386<italic>e</italic> − 1</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M57"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.386<italic>e</italic> − 1</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M58"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.65<italic>e</italic> − 2</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M59"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.65<italic>e</italic> − 2</td></tr><tr style="border-top: double"><td align="center" valign="middle">θ<italic><sub>LacI</sub></italic></td><td align="center" valign="middle"><italic>plac</italic> regulation by TetR (-)</td><td align="center" valign="middle">31.94</td></tr><tr><td align="center" valign="middle">η<italic><sub>LacI</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.00</td></tr><tr><td align="center" valign="middle">θ<italic><sub>IPTG</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">9.06e − 2</td></tr><tr><td align="center" valign="middle">η<italic><sub>IPTG</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.00</td></tr><tr style="border-top: double"><td align="center" valign="middle">θ<italic><sub>TetR</sub></italic></td><td align="center" valign="middle"><italic>ptet</italic> regulation by LacI (-)</td><td align="center" valign="middle">30.00</td></tr><tr><td align="center" valign="middle">η<italic><sub>TetR</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.00</td></tr><tr><td align="center" valign="middle">θ<italic><sub>aTc</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">11.65</td></tr><tr><td align="center" valign="middle">η<italic><sub>aTc</sub></italic></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.00</td></tr><tr style="border-top: double"><td align="center" valign="middle"><inline-formula><mml:math id="M60"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">IPTG exchange rate (<italic>min</italic><sup>–1</sup>)</td><td align="center" valign="middle">2.75<italic>e</italic> − 2</td></tr><tr><td align="center" valign="middle"><inline-formula><mml:math id="M61"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>out </mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">1.11<italic>e</italic> − 1</td></tr><tr style="border-top: double"><td align="center" valign="middle"><inline-formula><mml:math id="M62"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">aTc exchange rate (<italic>min</italic><sup>–1</sup>)</td><td align="center" valign="middle">1.62<italic>e</italic> − 1</td></tr><tr style="border-bottom: double"><td align="center" valign="middle"><inline-formula><mml:math id="M63"><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td><td align="center" valign="middle">-</td><td align="center" valign="middle">2.00<italic>e</italic> − 2</td></tr></tbody></table></table-wrap><table-wrap id="T2" position="float" orientation="portrait"><label>Table 2</label><caption><p>Table of pseudo-reactions: here <inline-formula><mml:math id="M64"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext> TetR </mml:mtext><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">θ</mml:mtext><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">η</mml:mtext><mml:mrow><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">θ</mml:mtext><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">η</mml:mtext><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M65"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext> LacI </mml:mtext><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">θ</mml:mtext><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">η</mml:mtext><mml:mrow><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">θ</mml:mtext><mml:mrow><mml:mtext>LacI </mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">η</mml:mtext><mml:mrow><mml:mtext>LacI </mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are gene regulation function, and <italic>h(x, θ, η) =</italic> 1/(1 + x/θ)<sup>η</sup> is the decreasing Hill function. The others arrows superscripts are parameters that can be found in <xref ref-type="table" rid="T1">Table 1</xref>.</p></caption><table frame="box" rules="all"><thead><tr style="border-top: double; border-bottom: hidden"><th align="center" valign="middle">Description</th><th align="center" valign="middle">Pseudo-reaction</th></tr></thead><tbody><tr style="border-bottom: double"><td align="center" valign="middle">transcription</td><td align="center" valign="middle"><inline-formula><mml:math id="M66"><mml:mtable><mml:mtr><mml:mtd><mml:mo>∅</mml:mo><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>T</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mrow><mml:mo>∅</mml:mo><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>P</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mspace width="0.2em"/></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula></td></tr><tr style="border-bottom: double"><td align="center" valign="middle">translation</td><td align="center" valign="middle"><inline-formula><mml:math id="M67"><mml:mtable><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mi>T</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula></td></tr><tr style="border-bottom: double"><td align="center" valign="middle">degradation/dilution</td><td align="center" valign="middle"><inline-formula><mml:math id="M68"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mo>∅</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>m</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mo>∅</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>L</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mo>∅</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>T</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>T</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mover><mml:mo>∅</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></inline-formula></td></tr></tbody></table></table-wrap></floats-group></article>