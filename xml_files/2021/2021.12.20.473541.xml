<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS145670</article-id><article-id pub-id-type="doi">10.1101/2021.12.20.473541</article-id><article-id pub-id-type="archive">PPR435158</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>BISoN: A Bayesian Framework for Inference of Social Networks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hart</surname><given-names>Jordan D. A.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Weiss</surname><given-names>Michael N.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Franks</surname><given-names>Daniel W.</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author"><name><surname>Brent</surname><given-names>Lauren J. N.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Centre for Research in Animal Behaviour, University of Exeter, UK</aff><aff id="A2"><label>2</label>Center for Whale Research, Friday Harbour, WA, USA</aff><aff id="A3"><label>3</label>Departments of Biology and Computer Science, University of York, UK</aff><author-notes><fn id="FN1"><label>*</label><p id="P1">Joint senior authors</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>08</day><month>06</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>01</day><month>06</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">1. Social networks are often constructed from point estimates of edge weights. In many contexts, edge weights are inferred from observational data, and the uncertainty around estimates can be affected by various factors. Though this has been acknowledged in previous work, methods that explicitly quantify uncertainty in edge weights have not yet been widely adopted, and remain undeveloped for many common types of data. Furthermore, existing methods are unable to cope with some of the complexities often found in observational data, and do not propagate uncertainty in edge weights to subsequent statistical analyses.</p><p id="P3">2. We introduce a unified Bayesian framework for modelling social networks based on observational data. This framework, which we call <italic>BISoN</italic>, can accommodate many common types of observational social data, can capture confounds and model effects at the level of observations, and is fully compatible with popular methods used in social network analysis.</p><p id="P4">3. We show how the framework can be applied to common types of data and how various types of downstream statistical analyses can be performed, including non-random association tests and regressions on network properties.</p><p id="P5">4. Our framework opens up the opportunity to test new types of hypotheses, make full use of observational datasets, and increase the reliability of scientific inferences. We have made example R scripts available to enable adoption of the framework.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P6">Social network analysis is arguably one of the most popular frameworks in the study of sociality (<xref ref-type="bibr" rid="R6">Croft et al., 2016</xref>). In many scientific contexts, network connections (edges) are inferred from observational data, from human observers recording social interactions between monkeys, to biologgers capturing proximity events between people. The type of data used to infer networks and the manner in which the data are collected affects both the interpretation of social network analyses and their accuracy (<xref ref-type="bibr" rid="R33">Whitehead, 2008</xref>).</p><p id="P7">Networks are usually constructed by taking a normalised measure of sociality, such as the proportion of sampling periods each pair spends engaged in a social behaviour (e.g. the Simple Ratio Index; SRI). These normalised measures ensure that pairs that are observed for longer are not erroneously determined to be more social (<xref ref-type="bibr" rid="R33">Whitehead, 2008</xref>). This is important because observing social events can be challenging and uniform sampling over all pairs is not always possible (<xref ref-type="bibr" rid="R5">Croft et al., 2010</xref>). Though normalised measures of sociality will not be biased by sampling time, they will be accompanied by varying levels of certainty. For example, edge weights will be treated as a certain 0.5 for both a case where individuals have been seen together once and apart once, and equally where individuals have been together 100 times and apart 100 times. Despite there being considerably more certainty around the values of the latter example than the former, methods to estimate and propagate uncertainty through social network analyses remain largely underdeveloped.</p><p id="P8">In this paper we introduce BISoN: a general unified Bayesian framework for modelling social network data. BISoN captures uncertainty in edge weights, making full use of available data; propagates uncertainty through downstream analyses; and can control for social and non-social effects at any level (individual, dyad, group, observation, etc). Any type of social network analysis can be conducted within our framework, including dyadic and nodal regressions, non-random edge weight tests, and estimation of structural network properties. The BISoN framework comprises a) an <italic>edge weight model</italic>, dependent on data type, that builds edge weights and networks with uncertainty from empirical data, and b) downstream analyses that use estimated edge weights to take into account uncertainty in the network. We will focus on how our framework can be applied to animal systems, but the underlying principle can be applied to any type of network analysis where network edges are inferred. The BISoN framework presents an opportunity to generate reliable, flexible, and rich scientific inference in the study of social systems.</p><sec id="S2"><title>BISoN - Bayesian Inference of Social Networks</title><p id="P9">In the following section we outline the three edge weight models we have developed for binary, count, and duration data (see <xref ref-type="table" rid="T1">Table 1</xref> for definitions of these types of data). For brevity the models are presented without detailing any specific priors, but when fitting these models, priors should always be specified, and the choice of prior should depend on the context and the question in hand (<xref ref-type="bibr" rid="R30">van de Schoot et al., 2021</xref>). These edge weight models can be used to generate estimates for network edge weights <italic>ω<sub>ij</sub></italic>. We describe how to obtain edge weight estimates for binary, count and duration data below. Once estimates for edge weights <italic>ω<sub>ij</sub></italic> are obtained, they can be used in downstream analyses. We will briefly outline three types of analyses that propagate uncertainty through the analysis. These analyses are: 1) testing for non-random edge weights, 2) dyadic regression, and 3) nodal regression. When presenting the downstream analyses, for brevity we will refer to them in the context of the count data model, but these downstream analyses are freely applicable to all types of data. The models we present here are simple examples that can be extended and refined in many ways. The Bayesian nature of this framework means that these methods will be useful and reliable, providing they are used appropriately in the context of the data, the scientific question, and with appropriate diagnostic tools (<xref ref-type="bibr" rid="R18">Kruschke, 2015</xref>; <xref ref-type="bibr" rid="R20">McElreath, 2020</xref>). We have provided example code at: <ext-link ext-link-type="uri" xlink:href="https://github.com/JHart96/BISON_examples">www.github.com/JHart96/BISON_examples</ext-link>.</p></sec><sec id="S3"><title>Quantifying uncertainty in edge weights</title><sec id="S4"><title>Edge weight model: Binary data</title><p id="P10">To demonstrate the notion behind BISoN, we will first describe the edge weight model for the case of binary data, where presence or absence of a social event per fixed sampling period is recorded. First, note that for binary data, edge weights are commonly defined as: <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula> where <italic>X<sub>ij</sub></italic> is the number of social events that occurred between <italic>i</italic> and <italic>j</italic>, and <italic>D<sub>ij</sub></italic> is the number of sampling periods where it is considered possible for a social event to have been observed between <italic>i</italic> and <italic>j</italic>. The exact definition will depend on context, but this may often be the number of periods in which at least one of the individuals of the dyad was seen.</p><p id="P11">The edge weight is therefore equivalent to the probability of <italic>i</italic> and <italic>j</italic> engaging in a social event in any given sampling period. This can also be interpreted as an estimate of the proportion of time <italic>i</italic> and <italic>j</italic> spend engaging in a social event. Let us refer to this probability (or proportion) as <italic>p<sub>ij</sub></italic>. Without making any additional assumptions beyond that of the standard SRI calculation, an equivalent formulation is: <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P12">Note that the maximum likelihood estimate for <italic>p<sub>ij</sub></italic> in this process is <italic>X<sub>ij</sub></italic>/<italic>D<sub>ij</sub></italic> = <italic>W<sub>ij</sub></italic>. The binomial process is the natural process for multiple Bernoulli trials, which makes this formulation a natural extension of point estimates for edge weights. In a Bayesian context, the parameter <italic>p<sub>i j</sub></italic> is treated as a random variable, and inherently captures any uncertainty around its value. A similar formulation was used by <xref ref-type="bibr" rid="R9">Farine and Strandburg-Peshkin (2015)</xref> to estimate uncertainty over edge weights using a beta conjugate prior over the <italic>p<sub>ij</sub></italic> parameters (as detailed in <xref ref-type="bibr" rid="R11">Fink(1997)</xref>).</p><p id="P13">Social data can sometimes be influenced by non-social effects at the observation level, for example varying levels of habitat visibility depending on location, variance in observer reliability, or time of day can all affect the recorded observations of social events. These effects cannot be modelled by aggregating social events <italic>X<sub>ij</sub></italic> at the dyad level. To solve this, we propose to model these effects by decomposing the binomial process over the aggregated observations to distinct Bernoulli processes over unaggregated observations, as follows: <disp-formula id="FD3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the probability of a social event occurring between <italic>i</italic> and <italic>j</italic> in the <italic>n</italic>-th observation of <italic>i</italic> and <italic>j</italic>, and <italic>ω<sub>i j</sub></italic> is the edge weight between <italic>i</italic> and <italic>j</italic>. The ellipsis represents additional terms that can be included (if desired) to model various effects. The term <inline-formula><mml:math id="M5"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be seen as analogous to the predictor terms in regression models. In the location-dependent visibility example, including an observation-level location effect will account for this visibility effect. When additional effects are included, the edge weight will become an estimate of relative sociality in the presence of non-social effects. We use a linear combination of effects in these examples for simplicity, but the effects could equally be modelled as non-linear functions if deemed necessary in context. Alternatively dyad- or individual-level effects can also be included to separate out different types of social effect.</p><p id="P14">The binary data model can also be used for group-based (gambit) data (<xref ref-type="bibr" rid="R12">Franks et al., 2010</xref>). If being used for group data, an additional term in the model can be used to account for nonindependence within group observations. See the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> for further discussions on these points.</p></sec><sec id="S5"><title>Edge weight model: Count data</title><p id="P15">The same concept as above can also be applied to the case of count data, where counts of social events between individuals per sampling period is recorded. First, note that for count data, point estimates of edge weights are often defined in the same way as Equation 1, but where <italic>X<sub>ij</sub></italic> is the total number of social events that occurred between <italic>i</italic> and <italic>j</italic>, and <italic>D<sub>i j</sub></italic> is the total amount of time a social event could have been observed between <italic>i</italic> and <italic>j</italic>.</p><p id="P16">The edge weight is therefore equivalent to the rate at which <italic>i</italic> and <italic>j</italic> engaged in a social event per unit time. Let us refer to this rate as <italic>λ<sub>ij</sub></italic>. When events occur with a fixed rate, the number of events expected per unit time is described by the Poisson process (<xref ref-type="bibr" rid="R31">Wasserman, 2004</xref>). Since we assume that the rate of events characterises edge weights well, then without making any additional assumptions, we can model social events as: <disp-formula id="FD4"><label>(4)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>λ<sub>i j</sub></italic> is the underlying rate parameter. When modelled in a Bayesian framework, this provides a natural way to model the uncertainty around edge weights because the maximum likelihood estimate for <italic>λ<sub>ij</sub></italic> is <italic>X<sub>ij</sub></italic>/<italic>D<sub>ij</sub></italic> = <italic>W<sub>ij</sub></italic> (<xref ref-type="bibr" rid="R16">Held and Sabanés Bové, 2014</xref>).</p><p id="P17">Again, this model doesn’t allow observation-level effects to be modelled, so we must decompose the aggregated data into the original sampling periods. Fortunately, the sum of Poisson-distributed random variables is also described by a Poisson distribution. This means that the full model can take a similar form to the previous model: <disp-formula id="FD5"><label>(5)</label><mml:math id="M7"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M8"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the rate at which social events occur between <italic>i</italic> and <italic>j</italic> in the <italic>n</italic>-th observation of <italic>i</italic> and <italic>j</italic>, <inline-formula><mml:math id="M9"><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the length of time of the <italic>n</italic>-th sampling period for the dyad, and <italic>ω<sub>ij</sub></italic> is again the edge weight between <italic>i</italic> and <italic>j</italic>. As above, the ellipsis represents potential additional effects that could be included in the model if necessary. This is discussed in a later section and in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p></sec><sec id="S6"><title>Edge weight model: Duration data</title><p id="P18">The edge weight model for duration data is slightly more complex than those of the binary and count data models, because it models two different types of data simultaneously: the duration of social events, and the frequency with which they occur. With duration data, the edge weight is again calculated using <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>, but where <italic>X<sub>i j</sub></italic> is the amount of time <italic>i</italic> and <italic>j</italic> were seen engaged in a social event, and <italic>D<sub>ij</sub></italic> is the maximum amount of time <italic>i</italic> and <italic>j</italic> could have been seen engaged in a social event. The total amount of time <italic>X<sub>ij</sub></italic> is the sum of times from <italic>K<sub>i j</sub></italic> social events. The edge weight is then modelled as the proportion of time <italic>t<sub>ij</sub></italic> each dyad could engage in a social event that is actually spent engaging in the social event: <disp-formula id="FD6"><label>(6)</label><mml:math id="M10"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula> where <italic>μ<sub>i j</sub></italic> is the mean event duration for the dyad and <italic>λ<sub>i j</sub></italic> is the mean rate of events per unit time for the dyad. Inter-arrival times in a Poisson process are distributed according to the exponential distribution, so we use this to model the duration of social events once they have started. The count of events can again be considered to be a Poisson process. Bringing these two assumptions together gives the following model (see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> for the full derivation): <disp-formula id="FD7"><label>(7)</label><mml:math id="M11"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P19">The mean event time <italic>μ<sub>ij</sub></italic> is modelled inherently in <inline-formula><mml:math id="M12"><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and can be recovered from the fitted model afterwards using <italic>μ<sub>ij</sub></italic> = <italic>ω<sub>ij</sub>/λ<sub>ij</sub></italic>.</p></sec><sec id="S7"><title>Accounting for social and non-social effects</title><p id="P20">By modelling social events at the observation-level rather than the dyad-level, it is possible to account for observation-level effects that may influence the estimated edge weights. An example of this is where the study population might move through various locations with different visibilities, leading to location-dependent missed social events. Assuming that variation in sociality between location isn’t of direct interest to the researcher, we can include a location effect in the model. An example of how this can be achieved in the count model is: <disp-formula id="FD8"><label>(8)</label><mml:math id="M13"><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <inline-formula><mml:math id="M14"><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is a location effect corresponding to the location of the social events observed for the dyad <italic>ij</italic> in the <italic>n</italic>-th observation period. The location effect has an adaptive normal prior centered at zero (often known as a random effect). The location effect is designed to capture the differences in visibility at different locations. In theory, the effect of visibility on edge weights will always be negative, but we choose to model it withouts bounds. This is because the true visibilities in different locations are unknown, so the edge weights cannot be estimated exactly, only proportionally. It is therefore unnecessary to place an upper bound on the visibility effect, making the model easier to fit.</p><p id="P21">Depending on the assumed causal process that generates observations, it won’t always be possible to control for non-social effects in this way, as the social effect of interest may partially be borne out through apparent non-social effects, such as space use. For example indviduals may genuinely be more social in some locations than others, and controlling for location would remove the social effect of interest. A discussion on the the considerations around modelling non-social effects is included in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref>.</p></sec><sec id="S8"><title>Downstream analysis with uncertainty</title><p id="P22">The previous section has shown how uncertainty can be estimated over edge weights. Once these estimates have been obtained, it is then possible to conduct various types of statistical analysis on the network while propagating uncertainty through the entire analysis. In this section we will discuss how several common types of social network analysis can be applied to social networks constructed with BISoN edge weight models. In particular we outline how three specific types of network analysis can be conducted: 1) testing for non-random edge weights, 2) dyadic regression, and 3) nodal regression.</p></sec><sec id="S9"><title>Testing for non-random edge weights</title><p id="P23">BISoN enables a Bayesian test analogous to the classic non-random association test developed by <xref ref-type="bibr" rid="R2">Bejder et al. (1998)</xref>, and originally proposed as the ‘chance sociogram’ by <xref ref-type="bibr" rid="R21">Moreno and Jennings (1938)</xref>. At its core, this test asks whether the structure of an observed network is an artefact of sampling or if there is genuine variation in edge weights between individuals. If the structure of an observed network is simply due to sampling, then there is no variation in edge weight, and each dyad is equally likely to engage in social events as all other dyads. In BISoN, this is equivalent to <disp-formula id="FD9"><label>(9)</label><mml:math id="M15"><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>ω</italic> is now a single edge weight parameter shared between all dyads, indicating no variation in underlying edge weights between dyads. This model constitutes the null hypothesis <italic>H</italic><sub>0</sub> of random edge weights. This can be compared to the alternative hypothesis <italic>H</italic><sub>1</sub> of non-random edge weights, where the <italic>ω</italic> parameter is replaced with a dyad-level parameter <italic>ω<sub>i j</sub></italic>, allowing each dyad to exhibit a different edge weights. In a Bayesian context, these two models (<italic>H</italic><sub>0</sub> : <italic>ω<sub>ij</sub></italic> = <italic>ω</italic> vs <italic>H</italic><sub>1</sub> : <italic>ω<sub>ij</sub></italic> ≠ <italic>ω</italic>) can be compared using the <italic>Bayes factor</italic>. Instead of attempting to reject the null model, as in null hypothesis significance testing, the Bayes factor quantifies the support for or against the hypotheses. The Bayes factor in favour of <italic>H</italic><sub>1</sub> over <italic>H</italic><sub>0</sub> is defined as: <disp-formula id="FD10"><label>(10)</label><mml:math id="M16"><mml:msub><mml:mtext>BF</mml:mtext><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∣</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∣</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula> where <italic>P</italic>(<italic>H</italic><sub>1</sub>|<italic>X</italic>) and <italic>P</italic>(<italic>H</italic><sub>0</sub>|<italic>X</italic>) denote the probability of the alternative hypothesis and the null hypothesis given the data <italic>X</italic> respectively. <italic>P</italic>(<italic>X</italic> |<italic>H</italic><sub>1</sub>) and <italic>P</italic>(<italic>X</italic> |<italic>H</italic><sub>0</sub>) are known as the marginal likelihoods, and can be estimated numerically from a fitted model (<xref ref-type="bibr" rid="R15">Gronau et al., 2017</xref>). The Bayes factor can be directly interpreted as the relative likelihood of the competing hypotheses. For example, a Bayes factor of 5 in favour of <italic>H</italic><sub>1</sub> over <italic>H</italic><sub>0</sub> would indicate that <italic>H</italic><sub>1</sub> is 5 times more likely than <italic>H</italic><sub>0</sub> given the data and model. A useful property of Bayes factors is that they can quantify support for or against hypotheses, and can even be used to compare multiple hypotheses.</p><p id="P24">The original test from <xref ref-type="bibr" rid="R2">Bejder et al. (1998)</xref> is extendable to test for non-random associations within categories (such as sex combination or age difference). However, it requires continuous variables such as age difference to be discretised into categories. Discretising variables is generally not ideal, and removes information, weakens statistical power, and can lose useful insights (<xref ref-type="bibr" rid="R1">Altman and Royston, 2006</xref>). Our proposed test can account for variables such as age without discretisation. This can be achieved by adding variables to the predictor in the following way: <disp-formula id="FD11"><label>(11)</label><mml:math id="M17"><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>ω</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mtext>Age</mml:mtext></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></disp-formula> where <italic>β</italic><sub>Age</sub> is a parameter describing the effects of age on the log rate of social events, and <italic>A<sub>ij</sub></italic> is the age difference for the dyad <italic>i j</italic>. In addition to modelling continuous variables, this approach to the non-random edge weight testing also makes it possible to compare multiple competing hypotheses of edge structure, model the effects of different dyad-level covariates, and compare hypotheses relating to global network metrics such as network density or clustering coefficients.</p></sec><sec id="S10"><title>Dyadic regression</title><p id="P25">A common type of analysis in studies of social networks is to consider factors that affect edge weights. This type of analysis is often called dyadic regression, where explanatory factors such as sex or age difference are regressed against edge weight. The edge weights in dyadic regression are non-independent, as variables such as age difference or sex difference are inherently linked to individual-level attributes. This means that effects due to age or sex in individual <italic>i</italic> affect all dyads that connect <italic>i</italic>. This non-independence can be controlled for by including node-level effects in the regression (<xref ref-type="bibr" rid="R29">Tranmer et al., 2014</xref>).</p><p id="P26">Using the count data example discussed earlier, we propose to conduct dyadic regression using a standard regression model of the form: <disp-formula id="FD12"><label>(12)</label><mml:math id="M18"><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>u</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <italic>β</italic><sub>0</sub> is the intercept parameter, <italic>β</italic><sub>1</sub> is the slope parameter, <italic>u<sub>i</sub></italic> are parameters accounting for the effect of node membership on edge weight, <italic>σ</italic> is the standard deviation of the residuals, and <italic>σ<sub>u</sub></italic> is a hyperprior for the standard deviation of the node membership effect (undefined here to avoid suggesting a default prior). The <italic>u</italic> parameters are used to capture non-independence of dyads, and are sometimes known as multi-membership effects (<xref ref-type="bibr" rid="R29">Tranmer et al., 2014</xref>). The dashed line indicates that the model can be fit in two separate parts: the first part being the edge weight model, and the second part being the dyadic regression model. It is not strictly necessary to separate out the model like this, but doing so makes it possible to fit the edge weight model once and conduct multiple types of analysis on it afterwards without fitting the entire model again. The <italic>β</italic><sub>0</sub> and <italic>β</italic><sub>1</sub> parameters can be interpreted in the same way as usual regression coefficients, and will be accompanied with posterior distributions describing plausible values of the coefficients.</p><p id="P27">The model shown here is intended as a minimal example of a simple linear regression with node-level effects to account for the non-independence of edges. The regression can be extended to support different family distributions, hierarchical effects, non-linearities, and more. We have included examples of diagnostics and some extensions in the example code.</p></sec><sec id="S11"><title>Nodal regression</title><p id="P28">The final common type of network analysis we will cover here is nodal regression, where a regression is performed to analyse the relationship between a nodal network metric (such as centrality) and nodal traits (such as age and sex). These analyses are usually used to assess how network position depends on various biological factors, but can also be used where network position is a predictor. Since node metrics are derivative measures of the network, uncertainty in edge weights should ideally propagate through to node metrics, and on to coefficients in regression analyses, giving an accurate estimate of the total uncertainty in inferred parameters. The core of the nodal regression is similar to dyadic regression, taking the form: <disp-formula id="FD13"><label>(13)</label><mml:math id="M19"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <italic>β</italic><sub>0</sub> is the intercept parameter, <italic>β</italic><sub>1</sub> is the slope parameter, and <italic>σ</italic> is the standard deviation of the residuals. <italic>M<sub>i</sub></italic>(<italic>ω</italic>) denotes the node metric estimates when applied to the edge weights estimated in the top part of the model.</p><p id="P29">Calculating node metrics within the model may present a practical challenge when using standard model fitting software, as many node metrics can not be described purely in terms of closed-form equations (<xref ref-type="bibr" rid="R13">Freeman, 1978</xref>). In this case, splitting up the model along the dashed line becomes an important step, as it allows the edge weights to be estimated using a standard piece of software, and leaves the regression part of the model to be fit using a sampler that supports numeric estimates of network centralities. As part of the code we have made available, we have written a custom Metropolis-Hastings sampler that maintains the joint distribution of edge weights, rather than sampling edge weights independently. This ensures that the effect of any structure in the observation data (such as location effects) is maintained and propagated through to the node metric estimates, and subsequently to regression coefficient estimates.</p></sec><sec id="S12"><title>Example: Synthetic dataset</title><p id="P30">To demonstrate our framework, we present an example based on a synthetic dataset of social events simulating count data. The synthetic dataset was generated by assigning underlying undirected edge weights to 28 dyads corresponding to all possible pairs of 8 individuals living in a closed social group. Individuals 1 - 4 were assigned to a treatment condition and individuals 4 - 8 were assigned to a control. Dyads between two individuals within the treatment condition were assigned a higher edge weight than other dyads, to induce an effect of treatment condition on centrality. Social events were simulated from a Poisson point process based on both the underlying edge weight and an observation-level, non-social effect of location. There were 6 possible locations for observations of social events that were used to simulate the effect of varying visibilities in different locations. Between 10 and 50 observation periods of fixed length (arbitrary time units) were simulated for each dyad. Full details of the simulation can be found in the example code.</p><p id="P31">The synthetic dataset describes the count of events for each observation period, therefore the appropriate model for this data is the count model. The full model was defined as: <disp-formula id="FD14"><label>(14)</label><mml:math id="M20"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Poisson</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Half-normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M21"><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the count of social events between <italic>i</italic> and <italic>j</italic> in their <italic>n</italic>-th observation period, <inline-formula><mml:math id="M22"><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the social event rate from the corresponding period, <inline-formula><mml:math id="M23"><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is the length of the corresponding sampling period (fixed to 1 here for simplicity), <italic>ω<sub>ij</sub></italic> is the dyad-level edge weight, and <inline-formula><mml:math id="M24"><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> is an observation-level effect corresponding to one of the 6 locations. The prior distributions were chosen using a prior predictive check to ensure the parameters only take on biologically plausible values. The model was implemented in Stan, and fitted in R, using the package <italic>Rstan</italic> (<xref ref-type="bibr" rid="R24">R Core Team, 2020;</xref><xref ref-type="bibr" rid="R28">Stan Development Team, 2020</xref>).</p><p id="P32">The model fit was checked visually by examining the chains and computing the Gelman Rubin <inline-formula><mml:math id="M25"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> convergence statistic (<xref ref-type="bibr" rid="R14">Gelman and Rubin, 1992</xref>). Once the model fit was verified, the parameter estimates of edge weights <italic>ω<sub>ij</sub></italic> between dyads were extracted. <xref ref-type="fig" rid="F2">Figure 2A</xref> shows a visualisation of the network based on edge weight estimates <italic>ω<sub>i j</sub></italic>, where the bands around edges are proportional to the widths of the 95% credible intervals. At this point the estimated network can be treated much the same as a standard network of point estimates, as long as care is taken to preserve uncertainty through subsequent analyses. To demonstrate the power of BISoN for conducting downstream analyses, we conducted a regression analysis where the response was eigenvector centrality and the predictor was a categorical variable with two categories, representing the treatment condition. To improve model fit, the response was standardised by subtracting the mean and dividing by the standard deviation. The model specification for the regression analysis was: <disp-formula id="FD15"><label>(15)</label><mml:math id="M26"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mtext>EV</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mtext>Treat</mml:mtext><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mtext>Treat</mml:mtext><mml:mspace width="0.2em"/><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Half-normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> where EV<sub><italic>i</italic></sub> denotes the standardised eigenvector centrality for the <italic>i</italic>-th node, <italic>β</italic><sub>Treat[<italic>i</italic>]</sub>is the effect parameter corresponding to the treatment condition (control or treatment) for the <italic>i</italic>-th sample, and <italic>σ</italic> is the standard deviation of the residuals. The regression model was fit using our custom Metropolis-Hastings sampler and chain convergence was checked visually and with the <inline-formula><mml:math id="M27"><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> statistic. Posterior predictive checks were used to ensure the model fitted the data well.</p><p id="P33">The posterior distributions of unstandardised eigenvector centralities for the 8 nodes are shown in <xref ref-type="fig" rid="F2">Figure 2B</xref>. The treatment condition parameters are interpretable as the mean standardised eigenvector centrality of nodes for each of the two conditions. The 95% credible interval for the control parameter <italic>β</italic><sub>Control</sub> was [–1.27, –0.36], with a median of –0.83 and for the treatment parameter <italic>β</italic><sub>Treatment</sub> was [0.35, 1.29], with a median of 0.85. One of the many benefits of Bayesian inference is that posterior distributions of different parameters can themselves be used gain statistical insights. In this case, the question of real interest is the difference between the two treatment conditions: <italic>β</italic><sub>Treatment</sub>– <italic>β</italic><sub>Control</sub>. This quantity can simply be calculated by subtracting the posteriors corresponding to the treatment parameter from those corresponding to the control parameter. We found that the difference in standardised centrality between treatment conditions, <italic>β</italic><sub>Treatment</sub>– <italic>β</italic><sub>Control</sub>, had a 95% credible interval of [0.99, 2.33] and a median of 1.69. The posterior distribution of the difference is also shown in <xref ref-type="fig" rid="F2">Figure 2B</xref>. This indicates that the treatment condition appears to correlate strongly with a higher centrality.</p><p id="P34">This brief example outlines just some of the types of analysis that can be carried out in our framework. We have included several additional examples in the code included with this paper.</p></sec></sec></sec><sec id="S13" sec-type="discussion"><title>Discussion</title><p id="P35">In this paper we presented BISoN, a general, highly flexible framework for modelling and analysing social networks. BISoN uses models of data collection processes to quantify uncertainty in edge weights. These models are versatile, and can be extended to capture additional social and non-social effects. We demonstrated how uncertainty in the network can then be propagated through to subsequent analyses, such as regressions involving network centrality. We have provided example code for how to implement the BISoN framework in R with Stan at: <ext-link ext-link-type="uri" xlink:href="https://github.com/JHart96/BISON_examples">www.github.com/JHart96/BISON_examples</ext-link>.</p><p id="P36">BISoN acknowledges the inherent uncertainty in inferred edge weights, and by propagating this through downstream analyses can offer nuanced, balanced, and powerful statistical analyses, focused on quantifying biological effects and the uncertainty around them. As well as propagating uncertainty into downstream analyses, the edge weight model itself can also be adapted to ask questions about individual variation in gregariousness, reciprocation of directed behaviours, and underlying differentiation of edge weights, among many others (see the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> for further information).</p><p id="P37">One of the main benefits of our framework is its inherent flexibility, but this also introduces a number of considerations when using it. Setting priors is an important part of Bayesian modelling, and it is important that they reflect realistic prior expectations of parameter values (<xref ref-type="bibr" rid="R30">van de Schoot et al., 2021</xref>). The priors included in the example code are not intended as good defaults, and instead the priors should be determined by careful consideration of the meaning of the parameter, prior expectations of likely values for the parameter, and using prior predictive checks (<xref ref-type="bibr" rid="R3">Conn et al., 2018</xref>). It is also important to note that using additional terms and altering the predictor part of the model can change the interpretation of model parameters, which may require the priors to be altered as well.</p><p id="P38">Another consideration is that network centrality measures based on binarised edges, such as degree and transitivity, have a slightly different interpretation in this framework. This is because, even though a particular dyad may never have been seen interacting in, say 100 samples, it is still possible that they would interact in the the 101st sample. The edge weight models BISoN uses naturally acknowledge this, so there is uncertainty around all edge weights. If binarised centralities are needed, there are two possible ways to use them in BISoN: 1) the edge weights can be thresholded, to generate a binary distribution on 0 and 1 for each edge; or 2) the edge weights can be assigned to categories, and membership of a specific category (e.g. weak or strong) becomes the new binary measure, again maintaining uncertainty over the membership. Option 1 can simply be applied to the sampling posterior by choosing a biologically relevant cut-off point and applying the threshold. In some cases this approach may prove challenging because it requires mapping domain knowledge and the question, in context, to a single threshold point for the analysis. Option 2 requires partial pooling over edge weights, assuming that they are drawn from a mixture of distributions, and assigns each edge weight to each type of connection with a certain probability. This approach is conceptually similar to the social bond categorisation method introduced by <xref ref-type="bibr" rid="R8">Ellis et al. (2021)</xref>. If it is biologically sensible to believe there are different categories of connections in a system, this can provide a natural and principled way to compute binary network measures (see <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> for an example of how to do this).</p><p id="P39">A final consideration of our modelling framework is that, though non-social effects can be modelled in the predictor, this alone cannot remove some non-social effects, and could instead absorb the social effect of interest, depending on the underlying causal system. We recommend that these effects be treated with caution, and used only with explicit assumptions about the underlying causal system. These considerations are also discussed in further depth in the <xref ref-type="supplementary-material" rid="SD1">supplementary material</xref> using causal models.</p><p id="P40">The versatility of our proposed framework makes the approach powerful, but comes with a number of limitations. Though highly flexible, one important constraint on BISoN is that knowledge of sampling effort will be required to properly model the processes that generate observations. On a practical level, BISoN models will usually need to be fit using an MCMC sampler. MCMC can be slow and computationally expensive, especially with large datasets. If additional effects are not included, this issue can be partially overcome by aggregating data at the dyad-level and fitting collapsed versions of the models (see <xref ref-type="supplementary-material" rid="SD1">supplementary materials</xref>). Furthermore, MCMC methods do not guarantee convergence, so additional checks will be required to make sure the sampler has performed correctly (<xref ref-type="bibr" rid="R4">Cowles and Carlin, 1996;</xref>
<xref ref-type="bibr" rid="R7">Draper, 2008</xref>). Together these limitations make the process of model building, fitting, and checking a more complex undertaking than simply building networks from point estimates. However, in return for these investments, researchers will have access to a powerful suite of tools that can make maximum use of hard-won data.</p><p id="P41">The BISoN framework is open-ended and can be extended in many ways. One particularly useful aspect of the Bayesian approach is the ability to treat data with uncertainty. This allows missing data to be modelled within the statistical model without the need for repeated model fitting routines. Furthermore, missing data can be estimated from other variables, which could be especially useful in populations where traits such as age are often estimated or unknown (<xref ref-type="bibr" rid="R19">Little and Rubin, 2002</xref>). Another potential direction for the framework is to move beyond static sociality measures and instead explicitly model the dynamics of edge weights, as discussed by <xref ref-type="bibr" rid="R23">Pinter-Wollman et al. (2014)</xref>. Dynamic edge weights could be modelled by incorporating autoregressive time series models into the framework (Wei, 2013). This would make it possible to model the general trends in edge weights, how changes in edge weights propagate through the network, and even model flow processes such as disease or information transmission.</p></sec><sec id="S14" sec-type="conclusions"><title>Conclusion</title><p id="P42">Uncertainty affects all social network analyses, yet until now has been difficult to quantify. The BISoN framework we have introduced is designed to help quantify uncertainty and ensure it is preserved through subsequent analyses to give robust and reliable statistical inference. Our framework is general and widely applicable to almost any type of social relational data.</p><p id="P43">Estimated edge weights from our models can be used with many different types of downstream analysis while propagating uncertainty. We believe the ideas presented in this paper are only the first step in developing powerful, flexible, and robust statistical models for social networks. BISoN has the potential to enable us to ask a wide range of nuanced questions, and obtain a deeper insight into the nature of sociality.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS145670-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d9aAeDbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Acknowledgements</title><p>The authors would like to thank Rebecca Padget, Josefine Bohr Brask, Delphine De Moor, Samuel Ellis, Kenneth Keuk, Mario Angst, and members of the CRAB social network club for useful discussions on early versions of the manuscript. JDAH acknowledges funding from the Engineering and Physical Sciences Research Council [grant number EP/R513210/1]. LJNB acknowledges funding from a European Research Council Consolidator Grant (FriendOrigins - 864461) and from the National Institute of Health (R01AG060931, R01MH118203). DWF and MNW acknowledge funding from the Natural Environment Research Council [grant numberNE/S010327/1]. DWF also acknowledges funding from the Natural Environment Research Council [grant number NE/S009914/1]. The authors declare no conflict of interest.</p></ack><fn-group><fn id="FN2" fn-type="con"><p id="P44"><bold>Author contributions</bold></p><p id="P45">JDAH conceived of the initial idea behind BISoN, which was further developed with input from MNW, DWF, and LJNB. The example code was written by JDAH. The manuscript was written by JDAH with input from MNW, DWF, and LJNB.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altman</surname><given-names>Douglas G</given-names></name><name><surname>Royston</surname><given-names>Patrick</given-names></name></person-group><article-title>The cost of dichotomising continuous variables</article-title><source>BMJ : British Medical Journal</source><year>2006</year><month>May</month><volume>332</volume><issue>7549</issue><fpage>1080</fpage><comment>ISSN 0959-8138</comment></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bejder</surname><given-names>Lars</given-names></name><name><surname>Fletcher</surname><given-names>David</given-names></name><name><surname>Bräger</surname><given-names>Stefan</given-names></name></person-group><article-title>A method for testing association patterns of social animals</article-title><source>Animal Behaviour</source><year>1998</year><month>September</month><volume>56</volume><issue>3</issue><fpage>719</fpage><lpage>725</lpage><pub-id pub-id-type="doi">10.1006/anbe.1998.0802</pub-id><comment>ISSN 0003-3472</comment></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conn</surname><given-names>Paul B</given-names></name><name><surname>Johnson</surname><given-names>Devin S</given-names></name><name><surname>Williams</surname><given-names>Perry J</given-names></name><name><surname>RMelin</surname><given-names>Sharon</given-names></name><name><surname>Hooten</surname><given-names>Mevin B</given-names></name></person-group><article-title>A guide to bayesian model checking for ecologists</article-title><source>Ecological Monographs</source><year>2018</year><volume>88</volume><issue>4</issue><fpage>526</fpage><lpage>542</lpage></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowles</surname><given-names>Mary Kathryn</given-names></name><name><surname>Carlin</surname><given-names>Bradley P</given-names></name></person-group><article-title>Markov chain monte carlo convergence diagnostics: a comparative review</article-title><source>Journal of the American Statistical Association</source><year>1996</year><volume>91</volume><issue>434</issue><fpage>883</fpage><lpage>904</lpage></element-citation></ref><ref id="R5"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Croft</surname><given-names>Darren P</given-names></name><name><surname>James</surname><given-names>Richard</given-names></name><name><surname>Krause</surname><given-names>Jens</given-names></name></person-group><source>Exploring animal social networks</source><publisher-name>Princeton University Press</publisher-name><publisher-loc>Princeton, N.J</publisher-loc><year>2010</year><comment>ISBN 978-1-4008-3776-2. OCLC: 939935939</comment></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croft</surname><given-names>Darren P</given-names></name><name><surname>Safi</surname><given-names>K</given-names></name></person-group><article-title>Darden, and Tina W Wey. Current directions in animal social networks</article-title><source>Current Opinion in Behavioral Sciences</source><year>2016</year><month>December</month><volume>12</volume><fpage>52</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2016.09.001</pub-id><comment>ISSN 2352-1546</comment></element-citation></ref><ref id="R7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Draper</surname><given-names>David</given-names></name></person-group><source>Bayesian Multilevel Analysis and MCMC</source><publisher-name>Springer</publisher-name><publisher-loc>NewYork New York NY</publisher-loc><year>2008</year><fpage>77</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1007/978-0-387-73186-52</pub-id><comment>ISBN 978-0-387-73186-5</comment></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellis</surname><given-names>Samuel</given-names></name><name><surname>Franks</surname><given-names>Daniel W</given-names></name><name><surname>Weiss</surname><given-names>Michael N</given-names></name><name><surname>Cant</surname><given-names>Michael A</given-names></name><name><surname>Domenici</surname><given-names>Paolo</given-names></name><name><surname>Balcomb</surname><given-names>Kenneth C</given-names></name><name><surname>Ellifrit</surname><given-names>David K</given-names></name><name><surname>Croft</surname><given-names>Darren P</given-names></name></person-group><article-title>Mixture models as a method for comparative sociality: social networks and demographic change in resident killer whales</article-title><source>Behavioral Ecology and Sociobiology</source><year>2021</year><volume>75</volume><issue>4</issue><fpage>1</fpage><lpage>15</lpage></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farine</surname><given-names>Damien R</given-names></name><name><surname>Carter</surname><given-names>Gerald G</given-names></name></person-group><article-title>Permutation tests for hypothesis testing with animal social network data: Problems and potential solutions</article-title><source>Methods in Ecology and Evolution</source><year>2021</year></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Damien</surname><given-names>R</given-names></name></person-group><article-title>Farine and Ariana Strandburg-Peshkin. Estimating uncertainty and reliability of so- cialnetworkdatausingBayesianinference</article-title><source>Royal Society Open Science</source><year>2015</year><month>September</month><volume>2</volume><issue>9</issue><elocation-id>150367</elocation-id><pub-id pub-id-type="doi">10.1098/rsos.150367</pub-id><comment>ISSN 2054-5703</comment></element-citation></ref><ref id="R11"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Fink</surname><given-names>Daniel</given-names></name></person-group><source>A compendium of conjugate priors</source><year>1997</year><volume>46</volume><comment>See <ext-link ext-link-type="uri" xlink:href="http://www.people.cornell.edu/-pages/df36/CONJINTRnew%20TEX.pdf">http://www.people.cornell.edu/-pages/df36/CONJINTRnew%20TEX.pdf</ext-link></comment></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franks</surname><given-names>Daniel W</given-names></name><name><surname>Ruxton</surname><given-names>Graeme D</given-names></name><name><surname>James</surname><given-names>Richard</given-names></name></person-group><article-title>Sampling animal association networks with the gambit of the group</article-title><source>Behavioral Ecology and Sociobiology</source><year>2020</year><month>January</month><volume>64</volume><issue>3</issue><fpage>493</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1007/s00265-009-0865-8</pub-id><comment>ISSN 0340-5443,1432-0762</comment></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>Linton C</given-names></name></person-group><article-title>Centrality in social networks conceptual clarification</article-title><source>Social networks</source><year>1978</year><volume>1</volume><issue>3</issue><fpage>215</fpage><lpage>239</lpage></element-citation></ref><ref id="R14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>Andrew</given-names></name><name><surname>Rubin</surname><given-names>Donald B</given-names></name></person-group><chapter-title>Inference from Iterative Simulation Using Multiple Sequences</chapter-title><source>Statistical Science</source><publisher-name>Institute of Mathematical Statistics</publisher-name><year>1992</year><month>November</month><volume>7</volume><issue>4</issue><fpage>457</fpage><lpage>472</lpage><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id><comment>Publisher ISSN 0883-4237,2168-8745</comment></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gronau</surname><given-names>Quentin F</given-names></name><name><surname>Sarafoglou</surname><given-names>Alexandra</given-names></name><name><surname>Matzke</surname><given-names>Dora</given-names></name><name><surname>Ly</surname><given-names>Alexander</given-names></name><name><surname>Boehm</surname><given-names>Udo</given-names></name><name><surname>Marsman</surname><given-names>Maarten</given-names></name><name><surname>Leslie</surname><given-names>David S</given-names></name><name><surname>Forster</surname><given-names>Jonathan J</given-names></name><name><surname>Wagenmakers</surname><given-names>Eric-Jan</given-names></name><name><surname>Steingroever</surname><given-names>Helen</given-names></name></person-group><article-title>A tutorial on bridge sampling</article-title><source>Journal of mathematical psychology</source><year>2017</year><volume>81</volume><fpage>80</fpage><lpage>97</lpage></element-citation></ref><ref id="R16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Held</surname><given-names>Leonhard</given-names></name><name><surname>Bové</surname><given-names>Daniel Sabanés</given-names></name></person-group><source>Applied Statistical Inference</source><publisher-name>Springer Berlin Heidelberg</publisher-name><publisher-loc>Berlin Heidelberg</publisher-loc><year>2014</year><pub-id pub-id-type="doi">10.1007/978-3-642-37887-4</pub-id><comment>ISBN 978-3-642-37886-7 978-3-642-37887-4</comment></element-citation></ref><ref id="R17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kenny</surname><given-names>David A</given-names></name><name><surname>La Voie</surname><given-names>Lawrence</given-names></name></person-group><chapter-title>The social relations model</chapter-title><source>Advances in experimental social psychology</source><publisher-name>Elsevier</publisher-name><year>1984</year><volume>18</volume><fpage>141</fpage><lpage>182</lpage></element-citation></ref><ref id="R18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kruschke</surname><given-names>John K</given-names></name></person-group><source>Doing Bayesian data analysis: a tutorial with R, JAGS, and Stan</source><edition>edition 2</edition><publisher-name>Academic Press</publisher-name><publisher-loc>Boston</publisher-loc><year>2015</year><comment>edition ISBN 978-0-12-405888-0</comment></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Little</surname><given-names>Roderick JA</given-names></name><name><surname>Rubin</surname><given-names>Donald B</given-names></name></person-group><article-title>Bayes and multiple imputation</article-title><source>Statistical analysis with missing data</source><year>2002</year><fpage>200</fpage><lpage>220</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McElreath</surname><given-names>Richard</given-names></name></person-group><source>Statistical rethinking: a Bayesian course with examples in R and Stan CRC texts in statistical science</source><edition>2 edition</edition><publisher-loc>Taylor and Francis</publisher-loc><publisher-name>CRC Press</publisher-name><year>2020</year><comment>ISBN 978-0-367-13991-9</comment></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreno</surname><given-names>Jacob L</given-names></name><name><surname>Jennings</surname><given-names>Helen H</given-names></name></person-group><article-title>Statistics of social configurations</article-title><source>Sociometry</source><year>1938</year><fpage>342</fpage><lpage>374</lpage></element-citation></ref><ref id="R22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pearl</surname><given-names>Judea</given-names></name><name><surname>Glymour</surname><given-names>Madelyn</given-names></name><name><surname>Jewell</surname><given-names>Nicholas P</given-names></name></person-group><source>Causal inference in statistics: A primer</source><publisher-name>John Wiley &amp; Sons</publisher-name><year>2016</year></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinter-Wollman</surname><given-names>Noa</given-names></name><name><surname>Hobson</surname><given-names>Elizabeth A</given-names></name><name><surname>Smith</surname><given-names>Jennifer E</given-names></name><name><surname>Edelman</surname><given-names>Andrew J</given-names></name><name><surname>Shizuka</surname><given-names>Daizaburo</given-names></name><name><surname>De Silva</surname><given-names>Shermin</given-names></name><name><surname>Waters</surname><given-names>James S</given-names></name><name><surname>Prager</surname><given-names>Steven D</given-names></name><name><surname>Sasaki</surname><given-names>Takao</given-names></name><name><surname>Witte-myer</surname><given-names>George</given-names></name><etal/></person-group><article-title>The dynamics of animal social networks: analytical, conceptual, and theoretical advances</article-title><source>Behavioral Ecology</source><year>2004</year><volume>25</volume><issue>2</issue><fpage>242</fpage><lpage>255</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="other"><collab>R Core Team</collab><source>R: A language and environment for statistical computing</source><year>2020</year></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross</surname><given-names>Cody T</given-names></name><name><surname>McElreath</surname><given-names>Richard</given-names></name><name><surname>Redhead</surname><given-names>Daniel</given-names></name></person-group><article-title>Modelling human and non-human animal network data in r using strand</article-title><source>bioRxiv</source><year>2022</year></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rue</surname><given-names>Håvard</given-names></name><name><surname>Martino</surname><given-names>Sara</given-names></name><name><surname>Chopin</surname><given-names>Nicolas</given-names></name></person-group><article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title><source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source><year>2009</year><volume>71</volume><issue>2</issue><fpage>319</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1111/j.1467-9868.2008.00700.x</pub-id><comment>eprint: ISSN 1467-9868</comment></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rue</surname><given-names>Håvard</given-names></name><name><surname>Riebler</surname><given-names>Andrea</given-names></name><name><surname>Sørbye</surname><given-names>Sigrunn H</given-names></name><name><surname>Illian</surname><given-names>Janine B</given-names></name><name><surname>Simpson</surname><given-names>Daniel P</given-names></name><name><surname>Lindgren</surname><given-names>Finn K</given-names></name></person-group><article-title>Bayesian Computing with INLA: A Review</article-title><source>Annual Review of Statistics and Its Application</source><year>2017</year><month>March</month><volume>4</volume><issue>1</issue><fpage>395</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1146/annurev-statistics-060116-054045</pub-id><comment>ISSN 2326-8298, 2326-831X</comment></element-citation></ref><ref id="R28"><element-citation publication-type="other"><collab>Stan Development Team</collab><article-title>RStan: the R interface to Stan</article-title><source>R package version 2.21.2</source><year>2020</year></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tranmer</surname><given-names>Mark</given-names></name><name><surname>Steel</surname><given-names>David</given-names></name><name><surname>Browne</surname><given-names>William J</given-names></name></person-group><article-title>Multiple-membership multipleclassification models for social network and group dependences</article-title><source>Journal of the Royal Statistical Society: Series A (Statistics in Society)</source><year>2014</year><volume>177</volume><issue>2</issue><fpage>439</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1111/rssa.12021</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van de Schoot</surname><given-names>Rens</given-names></name><name><surname>Depaoli</surname><given-names>Sarah</given-names></name><name><surname>King</surname><given-names>Ruth</given-names></name><name><surname>Kramer</surname><given-names>Bianca</given-names></name><name><surname>Märtens</surname><given-names>Kaspar</given-names></name><name><surname>Tadesse</surname><given-names>Mahlet G</given-names></name><name><surname>Vannucci</surname><given-names>Marina</given-names></name><name><surname>Gelman</surname><given-names>Andrew</given-names></name><name><surname>Veen</surname><given-names>Duco</given-names></name><name><surname>Willemsen</surname><given-names>Joukje</given-names></name><etal/></person-group><article-title>Bayesian statistics and modelling</article-title><source>Nature Reviews Methods Primers</source><year>2021</year><volume>1</volume><issue>1</issue><fpage>1</fpage><lpage>26</lpage></element-citation></ref><ref id="R31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>Larry</given-names></name></person-group><source>All of Statistics: A Concise Course in Statistical Inference Springer Texts in Statistics</source><publisher-name>Springer New York</publisher-name><publisher-loc>New York NY</publisher-loc><year>2004</year><pub-id pub-id-type="doi">10.1007/978-0-387-21736-9</pub-id><comment>ISBN 978-1-4419-2322-6 978-0-387-21736-9</comment></element-citation></ref><ref id="R32"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>William WS</given-names></name></person-group><source>Time Series Analysis</source><year>2013</year><month>March</month><comment>ISBN: 9780199934898.</comment></element-citation></ref><ref id="R33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Whitehead</surname><given-names>Hal</given-names></name></person-group><source>Analyzing animal societies</source><publisher-name>University of Chicago Press</publisher-name><year>2008</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p>Schematic overview of the BISoN framework. Different types of observation data in various levels of aggregation are fed into the appropriate edge weight model for the type of data. The edge weight model generates posterior distributions over edge weights, quantifying uncertainty over them. Posterior edge weights can be visualised in a sociogram with uncertainty, or exported as an edge list with credible intervals. Posterior edge weights can also be exported for downstream analyses such as regression analyses, non-random edge weight tests, and more.</p></caption><graphic xlink:href="EMS145670-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p>A) Visualisation of a network generated from uncertain edge weights. The width of edges denotes their weights, and the bands around the edges are proportional to the width of their 95% credible intervals. Low edge weights are arbitrarily removed from this plot (though not the analysis) for visualisation purposes. B) Posterior distributions of node-level eigenvector centralities for each node in the network. Nodes 1 - 4 are those assigned to the treatment, and nodes 5 - 8 to the control.</p></caption><graphic xlink:href="EMS145670-f002"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><p>Definitions of the three types of social observational data we have developed models for. Examples of standard edge weight interpretations are included in the third column.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Data type</th><th align="left" valign="top">Description</th><th align="left" valign="top">Edge interpretation</th></tr></thead><tbody><tr><td align="left" valign="top">Binary</td><td align="left" valign="top">The presence or absence of a social event for each dyad is recorded in each sampling period.</td><td align="left" valign="top">Probability of (or proportion of time) engaging in a social event in a fixed period of time.</td></tr><tr><td align="left" valign="top">Count</td><td align="left" valign="top">The number of social events for each dyad is recorded in each sampling period.</td><td align="left" valign="top">Rate of occurrence of social events per unit time.</td></tr><tr><td align="left" valign="top">Duration</td><td align="left" valign="top">The amount of time each dyad spends engaged in a social event is recorded in each sampling period.</td><td align="left" valign="top">Proportion of time spent engaging in a social event.</td></tr></tbody></table></table-wrap></floats-group></article>