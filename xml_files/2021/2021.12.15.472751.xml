<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS145515</article-id><article-id pub-id-type="doi">10.1101/2021.12.15.472751</article-id><article-id pub-id-type="archive">PPR433041</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Polymorphism-aware estimation of species trees and evolutionary forces from genomic sequences with RevBayes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Borges</surname><given-names>Rui</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Boussau</surname><given-names>Bastien</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Höhna</surname><given-names>Sebastian</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Pereira</surname><given-names>Ricardo J.</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Kosiol</surname><given-names>Carolin</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib></contrib-group><aff id="A1"><label>1</label>Institut für Populationsgenetik, Vetmeduni Vienna, Veterinärplatz 1, 1210 Wien, Austria</aff><aff id="A2"><label>2</label>Université de Lyon, Université Claude Bernard Lyon 1, CNRS UMR 5558, LBBE, F-69100, Villeurbanne, France</aff><aff id="A3"><label>3</label>GeoBio-Center, Ludwig-Maximilians-Universität München, Richard-Wagner Straße 10, 80333 Munich, Germany</aff><aff id="A4"><label>4</label>Department of Earth and Environmental Sciences, Paleontology &amp; Geobiology, Ludwig-Maximilians-Universität München, Richard-Wagner Straße 10, 80333 Munich, Germany</aff><aff id="A5"><label>5</label>Division of Evolutionary Biology, Department of Biology II, Ludwig-Maximilians-Universität Muänchen, Grosshaderner Straße 2, 82152 Planegg-Martinsried, Germany</aff><aff id="A6"><label>6</label>Centre for Biological Diversity, University of St Andrews, St Andrews, Fife KY16 9TH, UK</aff><author-notes><corresp id="CR1"><label>*</label> corresponding author: <email>ck202@st-andrews.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>31</day><month>05</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>30</day><month>05</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1"><list id="L1" list-type="order"><list-item><p id="P2">The availability of population genomic data through new sequencing technologies gives unprecedented opportunities for estimating important evolutionary forces such as genetic drift, selection, and mutation biases across organisms. Yet, analytical methods that can handle polymorphisms jointly with sequence divergence across species are rare and not easily accessible to empiricists.</p></list-item><list-item><p id="P3">We implemented polymorphism-aware phylogenetic models (PoMos), an alternative approach for species tree estimation, in the Bayesian phylogenetic software RevBayes. PoMos naturally account for incomplete lineage sorting, which is known to cause difficulties for phylogenetic inference in species radiations, and scale well with genome-wide data. Simultaneously, PoMos can estimate mutation and selection biases.</p></list-item><list-item><p id="P4">We have applied our methods to resolve the complex phylogenetic relationships of a young radiation of <italic>Chorthippus</italic> grasshoppers, based on coding sequences. In addition to establishing a well-supported species tree, we found a mutation bias favoring AT alleles and selection bias promoting the fixation of GC alleles, the latter consistent with GC-biased gene conversion. The selection bias is two orders of magnitude lower than genetic drift, validating the critical role of nearly neutral evolutionary processes in species radiation.</p></list-item><list-item><p id="P5">PoMos offer a wide range of models to reconstruct phylogenies and can be easily combined with existing models in RevBayes — e.g., relaxed clock and divergence time estimation — offering new insights into the evolutionary processes underlying molecular evolution and, ultimately, species diversification.</p></list-item></list>
</p></abstract><kwd-group><kwd>species tree</kwd><kwd>Bayesian inference</kwd><kwd>RevBayes</kwd><kwd>polymorphism-aware phylogenetic models</kwd><kwd>mutation bias</kwd><kwd>selection</kwd><kwd>grasshoppers</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P6">The recent development of sequencing technologies has made it possible to obtain large amounts of genomic data at a low cost, across model and non-model organisms. We now have an unprecedented opportunity to study macroevolutionary and microevolutionary processes at temporal scales where the distinction between species and population is challenging to establish (<xref ref-type="bibr" rid="R22">Leaché and Oaks, 2017</xref>). To resolve the intricate phylogenetic relationships between closely related taxa, we need models of species divergence that are able to assess the significance of different evolutionary forces in shaping species’ diversity patterns. The polymorphism-aware phylogenetic models (PoMos) are examples of such models (<xref ref-type="bibr" rid="R6">De Maio et al., 2013</xref>, <xref ref-type="bibr" rid="R7">2015</xref>). PoMos describe the evolutionary relationship between taxa (i.e., populations or species), in which the frequency of alleles change over time, conditioned on evolutionary forces such as mutational bias, genetic drift, and selection (<xref ref-type="bibr" rid="R3">Borges et al., 2019</xref>). Thus, PoMos have the ability to leverage population genomic data to estimate parameters of molecular evolution and jointly provide more accurate estimates of the species tree.</p><p id="P7">PoMos can be seen as an extension of the traditional phylogenetic substitution models (e.g., JC, HKY, and GTR) (<xref ref-type="bibr" rid="R19">Jukes and Cantor, 1969</xref>; <xref ref-type="bibr" rid="R12">Hasegawa et al., 1985</xref>; <xref ref-type="bibr" rid="R34">Tavaré, 1986</xref>), in the sense that PoMos additionally consider the existence of polymorphisms. Traditional phylogenetic substitution models assume that a species can be represented using a single genotype and that all differences occur only between (but not within) species. By describing allele changes over time, PoMos operate in a state-space that includes both fixed and polymorphic states. The possibility to model the existence of ancestral polymorphisms is of particular importance as PoMos naturally accounts for incomplete lineage sorting — i.e., the persistence of ancestral polymorphisms during speciation —, which is known to be a prime cause of phylogenomic conflict in species tree inference (<xref ref-type="bibr" rid="R24">Maddison and Knowles, 2006</xref>; <xref ref-type="bibr" rid="R32">Szöllősi et al., 2015</xref>).</p><p id="P8">PoMos are similar to the multispecies coalescent approach because both allow estimating the species tree. However, PoMos describe allele trajectories instead of genealogies, therefore integrating over all possible genealogical histories to directly estimate the species tree (similar to SNAPP, <xref ref-type="bibr" rid="R5">Bryant et al., 2012</xref>) and bypassing the computational burden of estimating genealogies. This burden continues to be a major constraint for the coalescent-based species tree methods, as the space of unknown genealogies is large and difficult to explore (<xref ref-type="bibr" rid="R27">Ogilvie et al., 2016</xref>; <xref ref-type="bibr" rid="R35">Yang and Rannala, 2017</xref>; <xref ref-type="bibr" rid="R9">Flouri et al., 2020</xref>). The integration over genealogies in PoMos allows them to scale well with genomic data sampled from many populations and individuals (<xref ref-type="bibr" rid="R29">Schrempf et al., 2016</xref>). The neutral PoMos were previously integrated into the maximum likelihood framework in IQ-Tree, primarily for species tree inference (<xref ref-type="bibr" rid="R30">Schrempf et al., 2019</xref>). PoMos were previously integrated into the maximum likelihood and Bayesian framework respectively in IQ-Tree (<xref ref-type="bibr" rid="R30">Schrempf et al., 2019</xref>) and BEAST 2 <xref ref-type="bibr" rid="R4">Bouckaert et al. (2019</xref>), primarily for species tree inference. However, an implementation including new PoMo models, like the recently proposed virtual PoMos and models with selection and different mutation schemes is still missing <xref ref-type="bibr" rid="R3">Borges et al. (2019</xref>, <xref ref-type="bibr" rid="R1">2022</xref>). More importantly, an easy-to-expand and well-documented implementation of PoMos is needed. The implentation of PoMos in RevBayes opens possibilities of combining PoMos with other sophisticated phylogenetic models including molecular dating, phylogeography, trait evolution, and branch-heterogeneous processes, and will permit tackling evolutionary questions that are previously intractable.</p><p id="P9">Furthermore, PoMos permit disentangling the contribution of the various evolutionary forces to the species divergence process that are often confounded in existing methods. For example, selection favoring the fixation of specific alleles can be particularly difficult to model under the coalescent approaches but it is quite straightforward to do under PoMos (<xref ref-type="bibr" rid="R3">Borges et al., 2019</xref>). PoMos are also able to estimate possible mutation bias (<xref ref-type="bibr" rid="R1">Borges et al., 2022</xref>), which condition the genetic variability upon which selection can act. As such, PoMos can be helpful in testing the significance of biologically relevant processes responsible for molecular evolution, even in the absence of well-annotated reference genomes, as demonstrated by our application example on grasshopper species. Lastly, PoMos have been shown to be statistically sound; the maximum a posteriori tree is a consistent estimator of the species tree (<xref ref-type="bibr" rid="R2">Borges and Kosiol, 2020</xref>).</p><p id="P10">For all these reasons, PoMos constitute an attractive framework for estimating the species trees and testing the role of the different evolutionary forces responsible for molecular evolution across the genome. Here, we implement these models within the widely-used Bayesian programming tool RevBayes (<xref ref-type="bibr" rid="R16">Höhna et al., 2016</xref>) and demonstrate their application with population genomic data from a recent species radiation (<xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>).</p><sec id="S2"><title>The model</title><p id="P11">PoMos model the evolution of a population of <italic>N</italic> haploid individuals and <italic>K</italic> alleles through time, in which changes in the allele content and frequency are both possible. These changes are mediated by evolutionary forces, such as genetic drift, mutation, and selection. The PoMo state-space includes fixed (or boundary) states {<italic>Na</italic><sub><italic>i</italic></sub>}, in which all <italic>N</italic> haploid individuals have the same allele <italic>a</italic><sub><italic>i</italic></sub> ∈ {1,…, <italic>K</italic>}, and polymorphic states {<italic>na<sub>i</sub></italic>, (<italic>N</italic> — <italic>n</italic>)<italic>a<sub>j</sub></italic>}, in which two alleles <italic>a<sub>i</sub></italic> and <italic>a<sub>j</sub></italic> are present in the population with absolute frequencies <italic>n</italic> and <italic>N</italic> — <italic>n</italic>, respectively.</p><p id="P12">Mutations occur with rate <italic>μ<sub>a<sub>i</sub>a<sub>j</sub></sub></italic> and govern the allele content, only arising in the fixed states: <disp-formula id="FD1"><label>(1)</label><mml:math id="M1"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mo>}</mml:mo><mml:mo>→</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P13">The assumption that mutations can only arise in the fixed states, corresponds to assuming that mutation rates are comparably low, and by the time of a new mutation a fixation of the previous mutation at the same site has already taken place. Low mutations rates are indeed verified for the majority of multicellular eukaryotes (<xref ref-type="bibr" rid="R23">Lynch et al., 2016</xref>). Additionally, a reversible mutation model is usually considered. In this case, we break the mutations into a base composition π and exchangeability parameter <italic>ρ</italic> (i.e., <italic>μ<sub>a<sub>i</sub>a<sub>j</sub></sub></italic> = <italic>ρ<sub>a<sub>i</sub>a<sub>j</sub>,</sub>π<sub>a<sub>j</sub></sub></italic>), similar to the definition of substitution rates in the general time-reversible model by <xref ref-type="bibr" rid="R34">Tavaré (1986</xref>). Assuming reversible mutations has no biological basis; however, this assumption simplifies obtaining formal quantities such as the stationary distribution while still allowing the modeling of mutation biases.</p><p id="P14">Genetic drift is modeled according to the Moran model, in which one individual is chosen to die, and one individual is chosen to reproduce at each time step. Selection acts to favor or disfavor alleles by differentiated fitness: <italic>ϕ<sub>a<sub>i</sub></sub></italic> = 1 + <italic>σ<sub>a<sub>i</sub></sub></italic>, where <italic>σ<sub>a<sub>i</sub></sub></italic> is the selection coefficient of the a<sub><italic>i</italic></sub> allele. Together, genetic drift and selection govern the allele frequency changes: <disp-formula id="FD2"><label>(2)</label><mml:math id="M2"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></disp-formula></p><p id="P15">As standard substitution models, PoMos are continuous-time Markov models and are fully characterized by their rate matrices. PoMos express time in Moran generations, and the rates in equations (<xref ref-type="disp-formula" rid="FD1">1</xref>) and (<xref ref-type="disp-formula" rid="FD2">2</xref>) together define the PoMos rate matrices (<xref ref-type="bibr" rid="R1">Borges et al., 2022</xref>)</p></sec><sec id="S3"><title>PoMos implemented in RevBayes</title><p id="P16">Previously, PoMos were implemented in a Maximum Likelihood framework in HyPhy (<xref ref-type="bibr" rid="R6">De Maio et al., 2013</xref>) and IQ-Tree (<xref ref-type="bibr" rid="R30">Schrempf et al., 2019</xref>). Here, we implemented PoMos in a Bayesian framework in the phylogenetic software package RevBayes (<xref ref-type="bibr" rid="R16">Höhna et al., 2016</xref>) (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The main advantage of our new implementation are extensions of PoMos (described below) and the existing model toolbox of RevBayes, resulting in models whose parameters cannot be estimated in the Maximum Likelihood framework. RevBayes includes several maintained and extensively used routines for phylogeny estimation and hypothesis testing (<xref ref-type="bibr" rid="R15">Höhna et al., 2014</xref>, <xref ref-type="bibr" rid="R16">2016</xref>, <xref ref-type="bibr" rid="R14">2018</xref>, <xref ref-type="bibr" rid="R17">2021</xref>). In addition, RevBayes can perform a range of inferences — e.g., phylogeny reconstruction, inference of selection, molecular dating, character evolution, ancestral state reconstruction — that can be easily married with PoMos, allowing the development of newly devised models for varied evolutionary applications.</p><p id="P17">PoMo rate matrices include selection by modeling allelic fitness (argument <monospace>phi</monospace>). Selection can also be helpful to model nucleotide usage biases that are not caused by selection but behave like it (<xref ref-type="bibr" rid="R25">Nagylaki, 1983</xref>). This is the case of GC-biased gene conversion, a mutational bias present in many living organisms (<xref ref-type="bibr" rid="R11">Galtier et al., 2009</xref>), that prefers GC alleles over AT during recombination. Neutral dynamics can simply be defined by assigning the fitness coefficients vector to <xref ref-type="disp-formula" rid="FD1">1</xref>.</p><p id="P18">PoMo functions in RevBayes permit modeling mutational biases. Mutations can be assumed non-reversible (via the argument mu) or reversible (functions including the prefix <monospace>Reversible</monospace>). Reversible mutations assume that the mutation rate between any two alleles is the product of an exchangeability and a base composition term (arguments <monospace>rho</monospace> and <monospace>pi</monospace>). Another advantage of having PoMos in a Bayesian framework is that empirically measured mutation rates, population sizes, or nucleotide usage biases can be accounted for during inference via informative priors. Additionally, we implemented virtual PoMos, which were recently introduced (<xref ref-type="bibr" rid="R1">Borges et al., 2022</xref>): <monospace>fnReversiblePoMoTwo4N</monospace> and <monospace>fnReversiblePoMoThree4N</monospace>. Virtual PoMos mimic a population dynamic that unfolds in the effective population by using a much smaller virtual population size, making it computationally more efficient. While inferences are performed in the virtual population, the mutation rates and selection coefficients are rescaled to real dynamic using theoretically obtained scaling laws (<xref ref-type="bibr" rid="R1">Borges et al., 2022</xref>).</p><p id="P19">Apart from the standard PoMos, which usually operate with the four nucleotide bases, we have also added PoMo rate matrices to be used in genetic systems that might have any number of variants (i.e., <monospace>fnPoMoKN</monospace>). In addition, we included specific models for the biallelic case, as this is typically used in population genetic applications (e.g., <monospace>fnReversiblePoMo2N</monospace>).</p><p id="P20">Furthermore, we have included functions to read allele frequency data and correct for sampling biases. Genetic diversity is usually undersampled because sampled fixed sites might not necessarily be fixed in the original population. To account for this missing data, we implemented two corrections: the weighted and the sampled binomial corrections (described in <xref ref-type="bibr" rid="R29">Schrempf et al. (2016</xref>)). While the former directly uses the binomial weights to initialize the likelihoods of every PoMo state at the tree tips, the latter samples PoMo states from them. These methods are integrated into the functions that read allele frequency data, either from count files or FASTA alignments (i.e., <monospace>convertCountFileToNaturalNumbers</monospace> or <monospace>readPoMoCountFile</monospace>, and <monospace>convertFastaFileToNaturalNumbers</monospace> respectively).</p></sec><sec id="S4"><title>Implementation, availability and validation</title><p id="P21">The RevBayes source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/revbayes/revbayes">https://github.com/revbayes/revbayes</ext-link>. A detailed tutorial about Bayesian phylogenetic inference with PoMos is available at <ext-link ext-link-type="uri" xlink:href="https://revbayes.github.io/tutorials/pomos/">https://revbayes.github.io/tutorials/pomos/</ext-link>.</p><p id="P22">As a critical part of a robust Bayesian workflow, we validated our implementations of PoMos in RevBayes using a simulation-based calibration approach (<xref ref-type="bibr" rid="R33">Talts et al., 2018</xref>). This method assesses the soundness of a posterior sampler by testing the expectation that if data is generated according to a model, then the Bayesian posterior inferences with respect to that same model are calibrated by construction. In practical terms, if one draws <italic>S</italic> parameter values from their prior distributions and subsequently simulates <italic>S</italic> data sets using these parameter values, the inferred <italic>α</italic>% credible intervals will contain the true parameter value in <italic>Sα</italic> of times. This simulation-based calibration approach is quite stringent because the correct coverage of credible intervals is only achieved if the likelihood function, the MCMC sampler, and the simulation function are implemented correctly.</p><p id="P23">We simulated 1000 alignments of four species and 1000 sites, considering a population dynamic including three virtual individuals, four alleles (<italic>A</italic>, <italic>C</italic>, <italic>G</italic> and <italic>T</italic>) and general mutation (nine free parameters in total: three base composition parameters π and six exchangeabilities ρ) and selection (three fitness coefficients; <italic>ϕ<sub>A</sub></italic> was set to 1) schemes. We calculated the coverage probabilities for each parameter and compared them with the credibility interval size. Our analyses show a 1:1 correlation (i.e., identity line) between the coverage and credible interval size, indicating that our implementations are statistically and computationally sound (<xref ref-type="fig" rid="F2">Fig. 2</xref>). The simulated data sets and the RevBayes scripts and output files used in simulation-based calibration analyses are all provided as additional material (see Data availability statement for further details).</p></sec><sec id="S5"><title>Application to grasshoppers transcriptome data</title><p id="P24">We studied the recent radiation of five grasshopper species using transcriptome data (<xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>) and PoMos in RevBayes. This data set includes nine grasshopper populations with five to 15 sampled individuals per population (<xref ref-type="fig" rid="F3">Fig. 3</xref>). FASTA alignments from 1 895 protein-coding genes were generated by calling the most common base at each position so that each individual grasshopper is represented by one allele. As in the original study, the data used in the phylogenetic analyses included only ORFs from orthologous gene. Paralogous genes potentially involved in duplications were excluded from these analyses, as well as UTRs that can potentially be involved in miss-assemblies. Note that PoMos describe the evolution of haploid populations, so, as is usual in many population genetic models, the total number of individuals are the total of individual chromosomes (i.e., a population of <italic>N</italic> diploid individuals is seen as a population of 2<italic>N</italic> haploid individuals). Consequently, one should avoid making inferences with genomic units that are known to have a different number of individuals (e.g., heterosomes and sex chromosomes, or gene families with multiple paralogs, unless PoMos are properly combined with models of chromosome or gene family evolution).</p><p id="P25">The final alignment included only the third codon position and those sites for which at least four individuals were observed per population. A total of 2 744 646 sites were obtained, but for computational reasons, only a sample of 1 million randomly selected sites was used for the phylogenetic inferences. This represents a manageable number of sites that are usually easily reached in standard empirical studies. We have repeated the phylogenetic analyses with two additional data sets of 1 million sites and obtained similar results that fully support the conclusions drawn here about the grasshoppers’ evolutionary history and pressures acting on their coding regions.</p><p id="P26">Phylogenetic inferences were carried out with the virtual PoMoThree model, which assumes a reversible mutation scheme. As we aimed to test the dynamic where AT alleles (or weak alleles, W) are preferred by mutational bias, and GC alleles (or strong alleles, S) are favored by GC-biased gene conversion, we defined the allele composition, exchangeabilities, and fitness coefficients in the following manner. The allele composition is generally defined as π = [π<sub>A</sub>, π<sub>C</sub>, π<sub>G</sub>, π<sub>T</sub>], which in terms of strong and weak alleles becomes π = [π<sub>W</sub>, π<sub>S</sub>, π<sub>S</sub>, π<sub>W</sub>]. The allele exchangeabilities are generally defined as <italic>ρ</italic> = [<italic>ρ<sub>AC</sub>, ρ<sub>AG</sub>, ρ<sub>AT</sub>, ρ<sub>CG</sub>, ρ<sub>CT</sub>, ρ<sub>GT</sub></italic>], but we have only considered two exchangeability classes, one between weak and strong alleles, and another one between alleles of the same type: i.e., <italic>ρ</italic> = [<italic>ρ<sub>WS</sub>, ρ<sub>WS</sub>, ρ<sub>WW</sub>, ρ<sub>SS</sub>, ρ<sub>WS</sub>, ρ<sub>WS</sub></italic>], where <italic>ρ<sub>WW</sub></italic> = <italic>ρ<sub>SS</sub></italic>. The fitness coefficients are generally defined as <italic>ϕ</italic> = [<italic>ϕ<sub>A</sub></italic>, <italic>ϕ<sub>D</sub></italic>, <italic>ϕ<sub>G</sub></italic>, <italic>ϕ<sub>T</sub></italic>], but because we are only interested in modelling GC-bias, we simplified it to ϕ = [1.0, <italic>ϕ<sub>S</sub>,ϕ<sub>S</sub></italic>, 1.0], where <italic>σ<sub>S</sub></italic> = <italic>ϕ<sub>S</sub></italic> — 1 is the selection coefficient favouring the strong alleles.</p><p id="P27">In total, four parameters were estimated: <italic>π<sub>W</sub></italic>, <italic>ρ<sub>WS</sub></italic>, <italic>ρ<sub>SS</sub></italic> = <italic>ρ<sub>WW</sub></italic> and <italic>ϕ<sub>S</sub></italic>. We set a Beta prior on <italic>π<sub>W</sub></italic> and an exponential prior on the exchangeabilities <italic>ρ<sub>WS</sub></italic> and <italic>ρ<sub>SS</sub></italic>. A reversible jump mixture was set on <italic>ϕ<sub>S</sub></italic>, including a point mass at 1.0 and a gamma prior for all the positive values, both with probability 0.5. This means that the GC-bias rate can take on the constant value 0.0 (suggesting neutrality) or be drawn from the base distribution gamma (indicating selection). A special reversible-jump MCMC algorithm (for details see <xref ref-type="bibr" rid="R10">Freyman and Höhna, 2018</xref>) is then used to infer whether GC-bias was active or not. We assumed a strict molecular clock rate drawn from an exponential prior with an arbitrary root age that we fixed to 1.0. A uniform time tree prior was set for the phylogeny. We ran the MCMC with four chains for 300 000 generations. The Bayesian inferences in RevBayes with the grasshopper’s sequence alignment (one million sites and nine populations) took approximately 29 hours in an iMac desktop with a 3.7 GHz Intel Core i5 processor and 32GB memory using four parallel processes. Convergence was assessed via the effective sample size parameter, which was higher than 400 for the continuous parameters and tree splits (<xref ref-type="bibr" rid="R8">Fabreti and Höhna, 2021</xref>). The multiple sequence alignments, the RevBayes scripts and output files used in the grasshopper’s phylogenetic analyses are provided as additional material (see Data availability statement for further details).</p><p id="P28">The posterior distributions of the mutation rate parameters and selection coefficient, despite all showing clear peaks (<xref ref-type="fig" rid="F4">Fig. 4</xref>), cannot be directly interpreted as they are relative to a virtual population size of three individuals. To obtain sensible estimates of these evolutionary forces, we need to scale them according to the grasshoppers’ effective population size. While empirical estimates of the genetic diversity (Watterson’s <italic>θ</italic> = 0.012, according to <xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>) are available for these species, we lack direct measurements of the mutation rate that would allow us to estimate their effective population size via <italic>θ</italic> = 4<italic>Nμ</italic>. We have instead used the fruit fly mutation rate (3.5×10<sup>−9</sup>, according to <xref ref-type="bibr" rid="R20">Keightley et al., 2014</xref>) and obtained an effective population size of approximately 850 000 individuals. We note that this estimate must be considered with care, as mutation rates vary greatly across phylogenetic scales.</p><p id="P29">Using the estimated population size and the scaling laws in <xref ref-type="bibr" rid="R1">Borges et al. (2022)</xref>, we calculated the relative mutation rates and GC-bias for the grasshoppers’ transcriptomic data (<xref ref-type="table" rid="T1">Table 1</xref>). Despite the four mutation types being around the same order of magnitude, we found evidence for mutational bias, with mutations from strong to weak alleles being more frequent than mutations from weak to strong alleles: <italic>μ<sub>SW</sub></italic> = 5.67 × 10<sup>−10</sup> and <italic>μ<sub>WS</sub></italic> = 3.76 × 10<sup>−10</sup>. Mutations between alleles of the same type are the least frequent: <italic>μ<sub>WW</sub></italic> = 2.64 × 10<sup>−10</sup> and <italic>μ<sub>SS</sub></italic> = 1.75 × 10<sup>−10</sup>. The GC-bias rate is two orders of magnitude higher than the mutation rates but two orders of magnitude lower than the reciprocal of the population size: σ<sub>S</sub> = 6.89 × 10<sup>−8</sup> and <italic>Nσ<sub>S</sub></italic> = 0.059. This indicates that GC-selection (or possibly GC-biased gene conversion) operates in a nearly neutral range. Nonetheless, the posterior of <italic>ϕ<sub>S</sub></italic> never included the point mass 1.0 (log Bayes Factor = 3.68), indicating that selection in favor of GC alleles at the third codon position is very significant despite acting in the nearly neutral range.</p><p id="P30">Overall, these results suggest that a dynamic including mutational bias favoring AT alleles and selection bias promoting the fixation of GC alleles influences the codon usage patterns of the <italic>Chorthippus</italic> grasshoppers protein-coding sequences. Despite being reported here for the first time for the case of grasshoppers, these patterns have been observed in other taxa (e.g., <xref ref-type="bibr" rid="R31">Sueoka and Kawanishi, 2000</xref>), suggesting that gene GC-biased gene conversion is a general molecular process throughout the tree of life (<xref ref-type="bibr" rid="R28">Pessia et al., 2012</xref>; <xref ref-type="bibr" rid="R21">Lassalle et al., 2015</xref>).</p><p id="P31">Regarding the topology, our phylogenetic inferences show very well-supported branches [posterior probabilities (PP) all equal to 1.00 <xref ref-type="fig" rid="F3">Fig. 3</xref>]. In agreement with <xref ref-type="bibr" rid="R26">Nolen et al. (2020</xref>), the populations of each species form very well supported clades. However, the relationships between <italic>C</italic>. <italic>rubratibialis</italic>, <italic>C</italic>. <italic>brunneus</italic> and <italic>C</italic>. <italic>biguttulus</italic> were unclear (PP = 0.67) in <xref ref-type="bibr" rid="R26">Nolen et al. (2020</xref>), whereas in our analyses the <italic>C</italic>. <italic>rubratibialis</italic> emerges as a sister species of <italic>C</italic>. <italic>brunneus</italic> (PP=1.0). Notably, the relative divergence among taxa is significantly larger than in <xref ref-type="bibr" rid="R26">Nolen et al. (2020</xref>). This result is expected in light of the mutation and selection bias we found acting on the grasshoppers’ coding sequences. We have recently shown that nucleotide usage bias leads phylogenetic methods to underestimate branch lengths (<xref ref-type="bibr" rid="R1">Borges et al., 2022</xref>). These biases are greater for more closely related populations as observed with these grasshopper populations. Indeed, <italic>Pseudochorthippus</italic> subspecies and <italic>Chorthippus</italic> species are estimated to have diversified recently, between 476 to 506 ka respectively (<xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>).</p><p id="P32">In this application, we show how PoMos can effectively help to characterize both the history and molecular evolution dynamic of non-model organisms with transcriptome data, which despite having well-known limitations compared to genomic data in the presence of well-annotated reference genomes, will continue to be used to understand the evolution of clades with large variation of genome size and structure (e.g. <xref ref-type="bibr" rid="R18">Irisarri et al. (2017</xref>); <xref ref-type="bibr" rid="R13">Hawlitschek et al. (2022</xref>)). However, PoMos have also been used with model organisms, such as the well annotated genomes of fruit flies (see <xref ref-type="bibr" rid="R1">Borges et al. (2022)</xref>). PoMos helped establishing possible routes of colonization of the African continent. By employing a phylogenetic molecular clock model, we dated the main episodes of fruit flies’ history such as their out of Africa migration. The advantage of having PoMos within RevBayes is that several means to solve the same problem exist. For example, one could have also dated the fruit flies phylogeny via informative priors on the mutation rates.</p><p id="P33">As it becomes easier and easier to sequence genomes and transcriptomes, we will soon have the resolution to solve long-standing questions in evolutionary biology that require leveraging intra-, interspecific, as well as phenotypic and ecological aspects of the evolutionary process. The combination of PoMos with phylogenetic models of molecular dating, species delimitation, phylogeography, and character evolution facilitate addressing this questions by scientist from broad backgrounds, in a user-friendly interface.</p></sec></sec><sec id="S6" sec-type="conclusions"><title>Conclusion</title><p id="P34">We implemented PoMos into the widely-used phylogenetic Bayesian software RevBayes. Our implementation allows researchers to use the latest species tree inference models and combine state-of-the-art methods in phylogenetics to build robust inferences or for testing hypotheses. PoMos are able to perform accurate species tree inference while jointly estimating parameters of the molecular evolutionary dynamic. Together, PoMos offer more species tree inference methods that can be useful to characterize the evolution of both species and molecular sequences. We anticipate that our methods will be particularly interesting to researchers studying genomic data sets, including multiple species, populations, and individuals, which are increasingly being produced but still lack appropriate analytical methods. Furthermore, RevBayes is open-source and multiplatform; thus, it can easily be used on a variety of systems and settings for both academic research and teaching.</p></sec></body><back><ack id="S7"><title>Acknowledgements</title><p>This work was funded by the Vienna Science and Technology Fund (WWTF) [MA16-061] and partially supported by the Austrian Science Fund (FWF) [P34524-B] and Biotechnology and Biological Sciences Research Council (BBSRC) [BB/W000768/1]. This work was supported by the Deutsche Forschungsgemeinschaft (DFG) Emmy Noether-Program (Award HO 6201/1-1 to S.H.)</p></ack><sec id="S8" sec-type="data-availability"><title>Data availability statement</title><p id="P35">The data used and produced by the the simulation-based calibration analyses of PoMos in RevBayes and the phylogenetic analyses conducted on the <italic>Chorthippus sp</italic>. grasshoppers (<xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>) are available at Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6592395">https://doi.org/10.5281/zenodo.6592395</ext-link>, last accessed May 30, 2022).</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P36"><bold>Authors’ contributions</bold></p><p id="P37">R.B. and C.K. conceived the project; R.B., B.B. and S.H. implemented the models in RevBayes; R.B. and R.P. performed the application example; R.B. and C.K. led the writing of the manuscript. All authors contributed critically to the drafts and gave final approval for publication.</p></fn><fn id="FN2" fn-type="conflict"><p id="P38"><bold>Conflict of Interest statement</bold></p><p id="P39">The authors declare no conflicts of interest.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borges</surname><given-names>R</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Nucleotide Usage Biases Distort Inferences of the Species Tree</article-title><source>Genome Biology and Evolution</source><year>2022</year><volume>14</volume><issue>1</issue><elocation-id>evab290</elocation-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borges</surname><given-names>R</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Consistency and identifiability of the polymorphism-aware phylogenetic models</article-title><source>Journal of Theoretical Biology</source><year>2020</year><volume>486</volume><elocation-id>110074</elocation-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borges</surname><given-names>R</given-names></name><name><surname>Szoöllősi</surname><given-names>GJ</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Quantifying GC-Biased Gene Conversion in Great Ape Genomes Using Polymorphism-Aware Models</article-title><source>Genetics</source><year>2019</year><volume>212</volume><issue>4</issue><fpage>1321</fpage><lpage>1336</lpage></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouckaert</surname><given-names>R</given-names></name><name><surname>Vaughan</surname><given-names>TG</given-names></name><name><surname>Barido-Sottani</surname><given-names>J</given-names></name><name><surname>Duchêne</surname><given-names>S</given-names></name><name><surname>Fourment</surname><given-names>M</given-names></name><name><surname>Gavryushkina</surname><given-names>A</given-names></name><name><surname>Heled</surname><given-names>J</given-names></name><name><surname>Jones</surname><given-names>G</given-names></name><name><surname>Kühnert</surname><given-names>D</given-names></name><name><surname>Maio</surname><given-names>ND</given-names></name><name><surname>Matschiner</surname><given-names>M</given-names></name><etal/></person-group><article-title>Beast 2.5: An advanced software platform for bayesian evolutionary analysis</article-title><source>PLOS Computational Biology</source><year>2019</year><volume>15</volume><elocation-id>e1006650</elocation-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryant</surname><given-names>D</given-names></name><name><surname>Bouckaert</surname><given-names>R</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name><name><surname>Rosenberg</surname><given-names>NA</given-names></name><name><surname>RoyChoudhury</surname><given-names>A</given-names></name></person-group><article-title>Inferring species trees directly from biallelic genetic markers: bypassing gene trees in a full coalescent analysis</article-title><source>Molecular biology and evolution</source><year>2012</year><volume>29</volume><issue>8</issue><fpage>1917</fpage><lpage>1932</lpage></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Schlötterer</surname><given-names>C</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Linking great apes genome evolution across time scales using polymorphism-aware phylogenetic models</article-title><source>Molecular Biology and Evolution</source><year>2013</year><volume>30</volume><issue>10</issue><fpage>2249</fpage><lpage>2262</lpage></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>PoMo: An allele frequency-based approach for species tree estimation</article-title><source>Systematic Biology</source><year>2015</year><volume>64</volume><issue>6</issue><fpage>1018</fpage><lpage>1031</lpage></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabreti</surname><given-names>LG</given-names></name><name><surname>Höhna</surname><given-names>S</given-names></name></person-group><article-title>Convergence assessment for bayesian phylogenetic analysis using mcmc simulation</article-title><source>Methods in Ecology and Evolution</source><year>2021</year></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flouri</surname><given-names>T</given-names></name><name><surname>Jiao</surname><given-names>X</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>A Bayesian Implementation of the Multispecies Coalescent Model with Introgression for Phylogenomic Analysis</article-title><source>Molecular Biology and Evolution</source><year>2020</year><volume>37</volume><issue>4</issue><fpage>1211</fpage><lpage>1223</lpage></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freyman</surname><given-names>WA</given-names></name><name><surname>Hoöhna</surname><given-names>S</given-names></name></person-group><article-title>Cladogenetic and anagenetic models of chromosome number evolution: a Bayesian model averaging approach</article-title><source>Systematic Biology</source><year>2018</year><volume>67</volume><issue>2</issue><fpage>1995</fpage><lpage>215</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galtier</surname><given-names>N</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name><name><surname>Glémin</surname><given-names>S</given-names></name><name><surname>Ranwez</surname><given-names>V</given-names></name></person-group><article-title>GC-biased gene conversion promotes the fixation of deleterious amino acid changes in primates</article-title><year>2009</year></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Kishino</surname><given-names>H</given-names></name><name><surname>Yano</surname><given-names>T</given-names></name></person-group><article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial {DNA}</article-title><source>Journal of Molecular Evolution</source><year>1985</year><volume>22</volume><fpage>160</fpage><lpage>174</lpage></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawlitschek</surname><given-names>O</given-names></name><name><surname>Ortiz</surname><given-names>EM</given-names></name><name><surname>Noori</surname><given-names>S</given-names></name><name><surname>Webster</surname><given-names>KC</given-names></name><name><surname>Husemann</surname><given-names>M</given-names></name><name><surname>Pereira</surname><given-names>RJ</given-names></name></person-group><article-title>Transcriptomic data reveals nuclear-mitochondrial discordance in gomphocerinae grasshoppers (in-secta: Orthoptera: Acrididae)</article-title><source>Molecular Phylogenetics and Evolution</source><year>2022</year><volume>170</volume><elocation-id>107439</elocation-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Coghill</surname><given-names>LM</given-names></name><name><surname>Mount</surname><given-names>GG</given-names></name><name><surname>Thomson</surname><given-names>RC</given-names></name><name><surname>Brown</surname><given-names>JM</given-names></name></person-group><article-title>P<sup>3</sup> Phylogenetic Posterior Prediction in RevBayes</article-title><source>Molecular biology and evolution</source><year>2018</year><volume>35</volume><issue>4</issue><fpage>1028</fpage><lpage>1034</lpage></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Heath</surname><given-names>TA</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Landis</surname><given-names>MJ</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group><article-title>Probabilistic Graphical Model Representation in Phylogenetics</article-title><source>Systematic Biology</source><year>2014</year><volume>63</volume><issue>5</issue><fpage>753</fpage><lpage>771</lpage></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Landis</surname><given-names>MJ</given-names></name><name><surname>Heath</surname><given-names>TA</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Moore</surname><given-names>BR</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name></person-group><article-title>RevBayes: Bayesian Phylogenetic Inference Using Graphical Models and an Interactive Model-Specification Language</article-title><source>Systematic Biology</source><year>2016</year><volume>65</volume><issue>4</issue><fpage>726</fpage><lpage>736</lpage></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Höhna</surname><given-names>S</given-names></name><name><surname>Landis</surname><given-names>MJ</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group><article-title>Parallel power posterior analyses for fast computation of marginal likelihoods in phylogenetics</article-title><source>PeerJ</source><year>2021</year><volume>9</volume><elocation-id>e12438</elocation-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irisarri</surname><given-names>I</given-names></name><name><surname>Baurain</surname><given-names>D</given-names></name><name><surname>Brinkmann</surname><given-names>H</given-names></name><name><surname>Delsuc</surname><given-names>F</given-names></name><name><surname>Sire</surname><given-names>J-Y</given-names></name><name><surname>Kupfer</surname><given-names>A</given-names></name><name><surname>Petersen</surname><given-names>J</given-names></name><name><surname>Jarek</surname><given-names>M</given-names></name><name><surname>Meyer</surname><given-names>A</given-names></name><name><surname>Vences</surname><given-names>M</given-names></name><name><surname>Philippe</surname><given-names>H</given-names></name></person-group><article-title>Phylotranscriptomic consolidation of the jawed vertebrate timetree</article-title><source>Nature Ecology &amp; Evolution</source><year>2017</year><volume>1</volume><fpage>1370</fpage><lpage>1378</lpage></element-citation></ref><ref id="R19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Jukes</surname><given-names>TH</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name></person-group><chapter-title>Evolution of protein molecules</chapter-title><person-group person-group-type="editor"><name><surname>Munro</surname><given-names>H</given-names></name></person-group><source>Mammalian Protein Metabolism</source><publisher-name>Elsevier</publisher-name><publisher-loc>New York</publisher-loc><year>1969</year><fpage>21</fpage><lpage>132</lpage></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keightley</surname><given-names>PD</given-names></name><name><surname>Ness</surname><given-names>RW</given-names></name><name><surname>Halligan</surname><given-names>DL</given-names></name><name><surname>Haddrill</surname><given-names>PR</given-names></name></person-group><article-title>Estimation of the Spontaneous Mutation Rate per Nucleotide Site in a Drosophila melanogaster Full-Sib Family</article-title><source>Genetics</source><year>2014</year><volume>196</volume><issue>1</issue><fpage>313</fpage><lpage>320</lpage></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lassalle</surname><given-names>F</given-names></name><name><surname>Périan</surname><given-names>S</given-names></name><name><surname>Bataillon</surname><given-names>T</given-names></name><name><surname>Nesme</surname><given-names>X</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name></person-group><article-title>GC-Content Evolution in Bacterial Genomes: The Biased Gene Conversion Hypothesis Expands</article-title><source>PLOS Genetics</source><year>2015</year><volume>11</volume><issue>2</issue><elocation-id>e1004941</elocation-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leaché</surname><given-names>AD</given-names></name><name><surname>Oaks</surname><given-names>JR</given-names></name></person-group><article-title>The Utility of Single Nucleotide Polymorphism (SNP) Data in Phylogenetics</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><year>2017</year><volume>48</volume><issue>1</issue><fpage>69</fpage><lpage>84</lpage></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lynch</surname><given-names>M</given-names></name><name><surname>Ackerman</surname><given-names>MS</given-names></name><name><surname>Gout</surname><given-names>J-F</given-names></name><name><surname>Long</surname><given-names>H</given-names></name><name><surname>Sung</surname><given-names>W</given-names></name><name><surname>Thomas</surname><given-names>WK</given-names></name><name><surname>Foster</surname><given-names>PL</given-names></name></person-group><article-title>Genetic drift, selection and the evolution of the mutation rate</article-title><source>Nature Reviews Genetics</source><year>2016</year><volume>17</volume><issue>11</issue><fpage>704</fpage><lpage>714</lpage></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>WP</given-names></name><name><surname>Knowles</surname><given-names>LL</given-names></name></person-group><article-title>Inferring phylogeny despite incomplete lineage sorting</article-title><source>Systematic Biology</source><year>2006</year><volume>55</volume><issue>1</issue><fpage>21</fpage><lpage>30</lpage></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagylaki</surname><given-names>T</given-names></name></person-group><article-title>Evolution of a Finite Population under Gene Conversion</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>1983</year><volume>80</volume><issue>20</issue><fpage>6278</fpage><lpage>6281</lpage></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nolen</surname><given-names>ZJ</given-names></name><name><surname>Yildirim</surname><given-names>B</given-names></name><name><surname>Irisarri</surname><given-names>I</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Groot Crego</surname><given-names>C</given-names></name><name><surname>Amby</surname><given-names>DB</given-names></name><name><surname>Mayer</surname><given-names>F</given-names></name><name><surname>Gilbert</surname><given-names>MTP</given-names></name><name><surname>Pereira</surname><given-names>RJ</given-names></name></person-group><article-title>Historical isolation facilitates species radiation by sexual selection: Insights from Chorthippus grasshoppers</article-title><source>Molecular Ecology</source><year>2020</year><volume>29</volume><issue>24</issue><fpage>4985</fpage><lpage>5002</lpage></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogilvie</surname><given-names>HA</given-names></name><name><surname>Heled</surname><given-names>J</given-names></name><name><surname>Xie</surname><given-names>D</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name></person-group><article-title>Computational performance and statistical accuracy of* BEAST and comparisons with other methods</article-title><source>Systematic Biology</source><year>2016</year><volume>65</volume><issue>3</issue><fpage>381</fpage><lpage>396</lpage></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pessia</surname><given-names>E</given-names></name><name><surname>Popa</surname><given-names>A</given-names></name><name><surname>Mousset</surname><given-names>S</given-names></name><name><surname>Rezvoy</surname><given-names>C</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name><name><surname>Marais</surname><given-names>GAB</given-names></name></person-group><article-title>Evidence for widespread gc-biased gene conversion in eukaryotes</article-title><source>Genome Biology and Evolution</source><year>2012</year><volume>4</volume><fpage>675</fpage><lpage>682</lpage></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>De Maio</surname><given-names>N</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Reversible polymorphism-aware phylogenetic models and their application to tree inference</article-title><source>Journal of Theoretical Biology</source><year>2016</year><volume>407</volume><fpage>362</fpage><lpage>370</lpage></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrempf</surname><given-names>D</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name></person-group><article-title>Polymorphism-Aware Species Trees with Advanced Mutation Models, Bootstrap, and Rate Heterogeneity</article-title><source>Molecular Biology and Evolution</source><year>2019</year><volume>36</volume><issue>6</issue><fpage>1294</fpage><lpage>1301</lpage></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sueoka</surname><given-names>N</given-names></name><name><surname>Kawanishi</surname><given-names>Y</given-names></name></person-group><article-title>DNA G+C content of the third codon position and codon usage biases of human genes</article-title><source>Gene</source><year>2000</year><volume>261</volume><issue>1</issue><fpage>53</fpage><lpage>62</lpage></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szöllősi</surname><given-names>GJ</given-names></name><name><surname>Tannier</surname><given-names>E</given-names></name><name><surname>Daubin</surname><given-names>V</given-names></name><name><surname>Boussau</surname><given-names>B</given-names></name></person-group><article-title>The Inference of Gene Trees with Species Trees</article-title><source>Systematic Biology</source><year>2015</year><volume>64</volume><issue>1</issue><fpage>e42</fpage><lpage>e62</lpage></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Talts</surname><given-names>S</given-names></name><name><surname>Betancourt</surname><given-names>M</given-names></name><name><surname>Simpson</surname><given-names>D</given-names></name><name><surname>Vehtari</surname><given-names>A</given-names></name><name><surname>Gelman</surname><given-names>A</given-names></name></person-group><article-title>Validating bayesian inference algorithms with simulation-based calibration</article-title><source>arXiv preprint</source><year>2018</year><elocation-id>arXiv:180406788</elocation-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tavaré</surname><given-names>S</given-names></name></person-group><article-title>Some Probabilistic and Statistical Problems in the Analysis of DNA Sequences</article-title><source>Lectures on Mathematics in the Life Sciences</source><year>1986</year><volume>17</volume><fpage>57</fpage><lpage>86</lpage></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name></person-group><article-title>Efficient Bayesian species tree inference under the multispecies coalescent</article-title><source>Systematic Biology</source><year>2017</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>An overview of the PoMos functions implemented in RevBayes (<xref ref-type="bibr" rid="R16">Höhna et al., 2016</xref>).</title></caption><graphic xlink:href="EMS145515-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Simulation-based calibration of PoMos in RevBayes (<xref ref-type="bibr" rid="R16">Höhna et al., 2016</xref>)</title><p>The plots were obtained using 1000 simulated data sets of multiple sequence alignments of 4 species and 1000 sites. We simulated a population dynamic including three virtual individuals, four alleles (A, <italic>C, G</italic> and <italic>T</italic>) and general mutation (nine free parameters in total: three πs and six <italic>ρ</italic>s) and selection (three fitness coefficients; <italic>ϕ<sub>A</sub></italic> was set to 1) schemes. The coverage probability corresponds to the proportion of credible intervals that includes the true parameter value. The expectation from mathematical theory is that coverage and credible interval size show a 1:1 correlation.</p></caption><graphic xlink:href="EMS145515-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Grasshopper evolutionary history.</title><p>Application example of the Bayesian PoMos in RevBayes to transcriptome data from nine grasshopper populations of the genus <italic>Chorthippus sp</italic>. (<xref ref-type="bibr" rid="R26">Nolen et al., 2020</xref>). Phylogenetic inferences were conducted using one million randomly sampled sites from the third codon position of 1 895 protein-coding genes together with the virtual PoMoThree model. The maximum a posteriori tree is depicted; all the branches had a posterior clade probability of 1.00 (not shown). The number of sampled individuals per population is indicated inside parenthesis. Photos of <italic>Chorthippus brunneus</italic> (credits to Jörg Hempel) and <italic>Chorthippus mollis</italic> (credits to G.-U. Tolkiehn) grasshoppers taken from Wikipedia under the Creative Commons Attribution-Share Alike 3.0 licence.</p></caption><graphic xlink:href="EMS145515-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Posterior and prior distributions of the mutation biases and selection parameters at the grasshoppers’ third codon position.</title><p>Delta indicates the mass point distribution. The prior densities are rescaled only to facilitate comparisons between the prior and posterior distributions and should not be read on the y-axis.</p></caption><graphic xlink:href="EMS145515-f004"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Posterior mean estimates and 95% credible intervals of the molecular dynamic parameters between weak (AT) and strong (GC) alleles at the grasshoppers’ third codon position.</title><p>Note that 2π<sub>s</sub> + 2π<sub>w</sub> = 1, <italic>pss</italic> = <italic>pww</italic> and <italic>p<sub>SW</sub></italic> = <italic>pws</italic>. The estimates of the mutations rates and selection coefficients were rescaled for a population of 850 000 individuals based on the theoretical results of <xref ref-type="bibr" rid="R1">Borges et al. (2022)</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle">Evolutionary force</th><th align="center" valign="middle">Parameter</th><th align="center" valign="middle">Posterior mean</th><th align="center" valign="middle">95% credible interval</th></tr></thead><tbody><tr><td align="center" valign="middle">Mutation bias towards strong alleles</td><td align="center" valign="middle"><italic>μ<sub>WS</sub></italic> = ρ<sub>WS</sub> π<italic><sub>S</sub></italic></td><td align="center" valign="middle">2.63×10<sup>−10</sup></td><td align="center" valign="middle">[2.60,2.67] ×10<sup>−10</sup></td></tr><tr><td align="center" valign="middle">Mutation bias towards weak alleles</td><td align="center" valign="middle"><italic>μ<sub>SW</sub></italic> = ρ<sub>WS</sub> π<sub><italic>W</italic></sub></td><td align="center" valign="middle">5.67×10<sup>−10</sup></td><td align="center" valign="middle">[5.62, 5.71]×10<sup>−10</sup></td></tr><tr><td align="center" valign="middle">Mutation bias between strong alleles</td><td align="center" valign="middle"><italic>μ<sub>SS</sub></italic> = ρ<sub>SS</sub> π<sub><italic>s</italic></sub></td><td align="center" valign="middle">3.76×10<sup>−10</sup></td><td align="center" valign="middle">[3.73, 3.79] ×10<sup>−10</sup></td></tr><tr><td align="center" valign="middle">Mutation bias between weak alleles</td><td align="center" valign="middle">μ<sub><italic>WW</italic></sub> = ρ<sub>SS</sub> π<sub><italic>W</italic></sub></td><td align="center" valign="middle">1.75×10<sup>−10</sup></td><td align="center" valign="middle">[1.72, 1.77]×10<sup>−10</sup></td></tr><tr><td align="center" valign="middle">Selection favouring GC alleles</td><td align="center" valign="middle"><italic>σ<sub>S</sub></italic> = <italic>ϕ<sub>S</sub> -</italic> 1</td><td align="center" valign="middle">6.89×10<sup>−8</sup></td><td align="center" valign="middle">[5.71, 8.19] ×10<sup>−8</sup></td></tr></tbody></table></table-wrap></floats-group></article>