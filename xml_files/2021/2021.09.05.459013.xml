<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front>
      <journal-meta>
         <journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
         <journal-title-group>
            <journal-title>bioRxiv : the preprint server for biology</journal-title>
         </journal-title-group>
         <issn pub-type="ppub"/>
      </journal-meta>
      <article-meta>
         <article-id pub-id-type="manuscript">EMS134319</article-id>
         <article-id pub-id-type="doi">10.1101/2021.09.05.459013</article-id>
         <article-id pub-id-type="archive">PPR391234</article-id>
         <article-version article-version-type="publisher-id">2</article-version>
         <article-categories>
            <subj-group subj-group-type="heading">
               <subject>Article</subject>
            </subj-group>
         </article-categories>
         <title-group>
            <article-title>ScanNet: An interpretable geometric deep learning model for structure-based protein binding site prediction</article-title>
         </title-group>
         <contrib-group>
            <contrib contrib-type="author">
               <name>
                  <surname>Tubiana</surname>
                  <given-names>Jérôme</given-names>
               </name>
               <xref ref-type="corresp" rid="CR1">*</xref>
               <aff id="A1">Blavatnik School of Computer Science, Tel Aviv University, Israel</aff>
            </contrib>
            <contrib contrib-type="author">
               <name>
                  <surname>Schneidman-Duhovny</surname>
                  <given-names>Dina</given-names>
               </name>
               <xref ref-type="corresp" rid="CR2">†</xref>
               <aff id="A2">School of Computer Science and Engineering, The Hebrew University of Jerusalem, Israel</aff>
            </contrib>
            <contrib contrib-type="author">
               <name>
                  <surname>Wolfson</surname>
                  <given-names>Haim J.</given-names>
               </name>
               <xref ref-type="corresp" rid="CR3">‡</xref>
               <aff id="A3">Blavatnik School of Computer Science, Tel Aviv University, Israel</aff>
            </contrib>
         </contrib-group>
         <author-notes>
            <corresp id="CR1">
               <label>*</label>
               <email>jertubiana@gmail.com</email>
            </corresp>
            <corresp id="CR2">
               <label>†</label>
               <email>dina.schneidman@mail.huji.ac.il</email>
            </corresp>
            <corresp id="CR3">
               <label>‡</label>
               <email>wolfson@tau.ac.il</email>
            </corresp>
         </author-notes>
         <pub-date pub-type="nihms-submitted">
            <day>08</day>
            <month>09</month>
            <year>2021</year>
         </pub-date>
         <pub-date pub-type="preprint">
            <day>06</day>
            <month>09</month>
            <year>2021</year>
         </pub-date>
         <permissions>
            <ali:free_to_read/>
            <license>
               <ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
               <license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p>
            </license>
         </permissions>
         <abstract>
            <p id="P1">Predicting the functional sites of a protein from its structure, such as the binding sites of small molecules, other proteins or antibodies sheds light on its function <italic>in vivo</italic>. Currently, two classes of methods prevail: Machine Learning (ML) models built on top of handcrafted features and comparative modeling. They are respectively limited by the expressivity of the handcrafted features and the availability of similar proteins. Here, we introduce ScanNet, an end-to-end, interpretable geometric deep learning model that learns features directly from 3D structures. ScanNet builds representations of atoms and amino acids based on the spatio-chemical arrangement of their neighbors. We train ScanNet for detecting protein-protein and protein-antibody binding sites, demonstrate its accuracy - including for unseen protein folds - and interpret the filters learned. Finally, we predict epitopes of the SARS-CoV-2 spike protein, validating known antigenic regions and predicting previously uncharacterized ones. Overall, ScanNet is a versatile, powerful, and interpretable model suitable for functional site prediction tasks. A webserver for ScanNet is available from <ext-link ext-link-type="uri" xlink:href="http://bioinfo3d.cs.tau.ac.il/ScanNet/">http://bioinfo3d.cs.tau.ac.il/ScanNet/</ext-link>
            </p>
         </abstract>
      </article-meta>
   </front>
   <body>
      <sec id="S1" sec-type="intro">
         <title>Introduction</title>
         <p id="P2">Despite recent progresses in experimental [<xref ref-type="bibr" rid="R1">1</xref>] and AI-based [<xref ref-type="bibr" rid="R2">2</xref>, <xref ref-type="bibr" rid="R3">3</xref>] protein structure determination, there remains a gap between structure and function [<xref ref-type="bibr" rid="R4">4</xref>]. The most accurate functional site prediction method is comparative modelling [<xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R13">13</xref>]: given a query protein, similar proteins with known functional sites are searched for and their sites are mapped onto the query structure. Comparative modelling has several shortcomings. First and foremost, its coverage is limited, as the pool of experimentally characterized protein folds or structural motifs is small. Second, functional sites are variably preserved throughout evolution. On the one hand, the B-cell epitopes of viral proteins frequently undergo antigenic drift, <italic>i.e</italic>. the abolition of recognition by antibodies after only one or few mutations. On the other hand, some protein-protein interactions are mainly driven by few “hotspot” residues; mutations and/or conformational changes of the other interface residues preserve the interaction. Put differently, the <italic>invariances</italic> in both sequence and conformation spaces of such function-determining structural motifs are in general motif-dependent and therefore unknown. This hampers our ability to both define and recognize such motifs using conventional comparative approaches.</p>
         <p id="P3">An alternative to comparative modelling is feature-based Machine Learning (ML) [<xref ref-type="bibr" rid="R12">12</xref>–<xref ref-type="bibr" rid="R18">18</xref>]. For each amino acid of a query protein, various features of geometrical (e.g. secondary structure, solvent accessibility, molecular surface curvature), physico-chemical (e.g. hydrophobicity, polarity, electrostatic potential) and evolutionary (e.g. conservation, position- weight matrices, coevolution) nature are calculated. Then, the target property is predicted using a ML model for tabular data such as Random Forest or Gradient Boosting. Reasoning on mathematically defined features offers three advantages: i) ability to generalize to proteins with no similarity to any of the train set proteins, ii) high sequence sensitivity, <italic>i.e</italic>. ability to output distinct predictions for highly similar protein sequences and iii) fast inference speed. ML models are however limited by the expressiveness of the features employed, as these cannot capture the spatio-chemical arrangements of atoms or amino acids characterizing function-bearing motifs. Examples of such function-bearing motifs include Zinc fingers that are signature of DNA/RNA binding sites [<xref ref-type="bibr" rid="R19">19</xref>], or protein-protein interaction hotspots ”O-rings” [<xref ref-type="bibr" rid="R20">20</xref>], namely exposed hydrophobic/aromatic amino acids surrounded by polar/charged ones. Despite over 50 years of experimental structural determination, novel function-determining motifs are still being discovered [<xref ref-type="bibr" rid="R21">21</xref>].</p>
         <p id="P4">End-to-end differentiable models, <italic>i.e</italic>. Deep Learning (DL) can potentially overcome the limitations of both approaches. Indeed, DL models can learn the data features and their invariances directly by backpropagation, and generalize well despite large number of parameters. Adapting the DL approach to protein structures requires defining an appropriate representation for proteins. Proteins can indeed be represented in multiple, complementary ways, e.g. as sequences [<xref ref-type="bibr" rid="R22">22</xref>, <xref ref-type="bibr" rid="R23">23</xref>], residue graphs [<xref ref-type="bibr" rid="R24">24</xref>–<xref ref-type="bibr" rid="R27">27</xref>], atomic density maps [<xref ref-type="bibr" rid="R28">28</xref>–<xref ref-type="bibr" rid="R34">34</xref>], atomic point clouds [<xref ref-type="bibr" rid="R35">35</xref>] or molecular surfaces [<xref ref-type="bibr" rid="R36">36</xref>, <xref ref-type="bibr" rid="R37">37</xref>], each capturing different functionally relevant features. Voxelated atomic density maps can be readily processed using classical 3D Convolutional Neural Networks, but the approach is computationally intensive and the predictions are not invariant upon rotation of the input structure. Point clouds, graphs and surfaces can be analyzed via Geometric Deep Learning [<xref ref-type="bibr" rid="R38">38</xref>, <xref ref-type="bibr" rid="R39">39</xref>], i.e. end-to-end differentiable models tailored for data with no natural grid-like topology or shared global coordinate system. Graphs can be derived from 3D structures by taking residues as nodes and the distances and angles between them as edges and processed using Graph Neural Networks (GNN) such as Message Passing Neural Networks [<xref ref-type="bibr" rid="R40">40</xref>] or Graph Attention Networks [<xref ref-type="bibr" rid="R41">41</xref>]. By design, GNNs are invariant upon euclidean transformation and expressive, but can be challenging to regularize and interpret. In particular, it is unclear whether - and if yes, which - structural motifs are captured by GNNs.</p>
         <p id="P5">Here, we introduce ScanNet (Spatio-Chemical Arrangement of Neighbors Neural Network), a novel geometric deep learning architecture tailored for protein structures. ScanNet builds representations of atoms and amino acids based on the spatio-chemical arrangement of their neighbors and exploits them to predict labels for each amino acid. By construction, ScanNet is end-to-end differentiable with minimal structure preprocessing, yielding fast training and inference. ScanNet predictions are local, invariant upon euclidean transformations and integrate information from multiple scales (atom, amino acid) and modalities (structure, MSA) in a synergistic fashion. Its corresponding parametric function is expressive, meaning that it can efficiently approximate known handcrafted features. Crucially, through appropriate parameterization and regularization, the filters learnt by ScanNet can be readily visualized and interpreted. We showcase the capabilities of ScanNet on two related tasks: prediction of protein-protein binding sites and B-cell epitopes (<italic>i.e</italic>. antibody binding sites). ScanNet outperforms baseline methods based on ML, structural homology and surface-based geometric deep learning. We further visualize and interpret the representations learnt by the network. We find that they encompass known handcrafted features, and find filters detecting simple, generic structural motifs such as hydrogen bonds as well as filters recognizing complex, task-specific motifs such as O-rings and transmembrane helical domains. Applied to the SARS-CoV-2 spike protein, ScanNet predictions validate known antigenic regions and predict a previously uncharacterized one.</p>
      </sec>
      <sec id="S2" sec-type="results">
         <title>Results</title>
         <sec id="S3">
            <label>A</label>
            <title>Spatio-chemical Arrangement of Neighbors Network (ScanNet)</title>
            <p id="P6">ScanNet takes as input a protein structure file, and optionally, a position-weight matrix derived from a multiple sequence alignment and outputs a residue-wise label probability. Its four main stages, shown in <xref ref-type="fig" rid="F1">Fig. 1</xref> and detailed in Materials and Methods, are: atomic neighborhood embedding, atom to amino acid pooling, amino acid neighborhood embedding and neighborhood attention.</p>
            <p id="P7">ScanNet first builds, for each heavy atom, a local coordinate frame centered on its position and oriented according to its covalent bonds. Next, it identifies its closest neighboring atoms. The resulting neighborhood, formally a point cloud with coordinates and attributes (atom group type) is passed through a set of spatio-chemical linear filters to yield an atom-wise representation. Each filter outputs a matching score between its (trainable) spatio-chemical pattern and the neighborhood. The patterns, which are parameterized using Gaussian kernels and sparse bilinear products, are localized in both physical and attribute space. Localization facilitates interpretation and is biologically motivated since motif functionality is often born by a few key atomic groups / amino acids in a specific arrangement, whereas other neighbors are irrelevant and interchangeable. Trainable, localized spatio-chemical patterns generalize to proteins the well-known concept of pharmacophores for small molecules.</p>
            <p id="P8">Towards calculation of amino acid-wise output, the atom-wise representation is pooled at the amino acid scale and concatenated with embedded amino acid-level information (either amino acid type or position-weight matrix). Importantly, the constituting atoms of an amino acid have various types and may play different functional roles. In particular, some handcrafted features such as accessible surface area average information over all the atoms, whereas others, such as secondary structure consider only subsets (the backbone atoms). Therefore, a trainable, multi-headed attention pooling operation capable of learning which atoms are relevant for each feature is employed rather than a conventional symmetric pooling operation like average or maximum.</p>
            <p id="P9">The neighborhood embedding procedure is then repeated at the amino acid scale: a local coordinate frame is constructed for each amino acid from its <italic>C</italic>
               <sub>
                  <italic>α</italic>
               </sub> atom, side-chain orientation and local backbone orientation and its nearest neighbors are identified. The resulting neighborhood with <italic>learnt</italic> attributes is passed through a set of trainable filters to yield an amino-acid wise representation.</p>
            <p id="P10">Finally, spatially-consistent output probabilities are obtained by projecting the amino-acid representations to scalar values, smoothing them across a local neighborhood and converting to probabilities with a logistic function. The smoothing scheme integrates two specifics of protein binding sites. First, protein-protein interactions are frequently driven by key ”hotspot” residues that contribute most of the binding energy, whereas other ”passenger” nearby residues have a small contribution to the binding energy [<xref ref-type="bibr" rid="R20">20</xref>, <xref ref-type="bibr" rid="R42">42</xref>]. Such passenger residues are harder to detect directly as they do not necessarily have the salient features of protein-protein binding sites [<xref ref-type="bibr" rid="R43">43</xref>]. Second, some amino acid pairs consistently have <italic>opposite</italic> binding site labels - in particular, consecutive amino acids along the sequence because their side chains typically point in opposite directions. Altogether, this motivates the introduction of trainable, attention-based weighted averages, with <italic>algebraic</italic> weights.</p>
         </sec>
         <sec id="S4">
            <label>B</label>
            <title>ScanNet for prediction of protein-protein binding sites</title>
            <p id="P11">The protein-protein Binding Sites (PPBS) of a protein are defined as the residues directly involved in one or more native, high affinity protein-protein interaction (PPI). Not every surface residue is a PPBS, as (i) binding propensity competes with structural stability and (ii) PPI are highly partner and conformation-specific. Knowledge of the PPBS of a protein provides insight about its <italic>in-vivo</italic> behavior, particularly when its partners are unknown and can guide docking algorithms. Prediction of PPBS with conventional approaches is challenging as PPBS structural motifs are more diverse, less conserved and more extended than small molecule binding sites. Additionally, only incomplete and noisy labels can be derived from structural data, as (i) most PPIs of a given protein are not structurally characterized, and (ii) a substantial fraction (∼ 15% [<xref ref-type="bibr" rid="R44">44</xref>]) of the structurally characterized protein-protein interfaces are not physiological but crystal-induced.</p>
            <p id="P12">We constructed a non-redundant data set of 20K representative protein chains with annotated binding sites derived from the Dockground database of protein complexes [<xref ref-type="bibr" rid="R45">45</xref>]. The PPBS data set covers a wide range of complex sizes, types, organism taxonomies, protein lengths (<xref ref-type="supplementary-material" rid="SD4">Fig.S4 (a)-(d)</xref>) and contains around 5M amino acids, of which 22.7% are PPBS. To address the uneven sampling of the protein space, we introduced sample weights for each chain that are inversely proportional to the number of similar chains found in the data set (Materials and Methods and <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S4(h</xref>)). To investigate the relationship between homology and generalization error, we divided the validation/test sets into four splits based on the degree of homology with respect to their closest train set example (see <xref ref-type="fig" rid="F2">Fig. 2</xref> and <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S4(g)</xref>).</p>
            <p id="P13">We evaluated three models on the PPBS data set: (i) ScanNet, (ii) a ML pipeline based on handcrafted features and (iii) a structural homology pipeline (see Materials and Methods for technical details). For the handcrafted features baseline, we computed for each amino acid various geometric, chemical and evolutionary features, and used xgboost, a state-of-the-art tree-based classification algorithm [<xref ref-type="bibr" rid="R46">46</xref>]. For the structural homology pipeline, pairwise local structural alignments between the train set chains and the query chain were first constructed using MultiProt [<xref ref-type="bibr" rid="R47">47</xref>]. Then, alignments were weighted and aggregated to produce binding site probabilities for each amino acid. For all three models, the validation set was used for hyperparameters selection and early stopping, and performance is reported on the test set. Training and evaluation of a single model took one to two hours for ScanNet (excluding preprocessing time, ∼10<italic>ms</italic> per step using a single Nvidia V100 GPU), few minutes for the ML baseline (excluding feature calculation time, using Intel Xeon Phi processor with 28 cores) and one month for the structural homology baseline (Intel Xeon Phi processor with 28 cores). We also evaluated Masif-site [<xref ref-type="bibr" rid="R36">36</xref>], a surface-based geometric deep learning model. Since Masif-site was not trained on the same data set, we only report its global test set performance.</p>
            <p id="P14">We found that for the full test set, ScanNet achieved an AUCPR of 0.694 (<xref ref-type="table" rid="T1">Table I</xref>), accuracy of 87.7% (<xref ref-type="supplementary-material" rid="SD4">Sup. Table S3</xref>) and 73.5% precision at 50% recall (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S17</xref>), the best performance by a substantial margin. The next best model was the structural homology baseline, whereas Masif-site and the handcrafted features model performed similarly. The model ranks differed when considering only subsets (<xref ref-type="fig" rid="F2">Fig. 2 (a)-(d)</xref>). Unsurprinsingly, the structural homology baseline performed best in the high homology setting, but its performance degraded rapidly with the degree of relatedness; when the test protein had no similar fold in the train set, it was the worst algorithm. Conversely, the performance of the handcrafted features baseline increased slowly with the degree of homology, meaning that it could not faithfully recognize previously seen folds. In contrast, ScanNet could both recognize previously seen folds and generalize to unseen ones.</p>
            <p id="P15">Visualizations of ScanNet predictions for representative examples (<xref ref-type="fig" rid="F2">Fig. 2 (e),(f)</xref> and <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S9,S10,S11,S12</xref>) illustrate that predictions are spatially coherent and that in most cases, the binding sites are correctly identified. Overall, the network performed uniformly well across complex types and sizes, protein lengths and organisms (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S8</xref> ). PPBS identification was slightly harder when no or few homologs were found in the MSA (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S8 b</xref>) and slightly easier for enzymes (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S8 d</xref>). We next identified and visualized train and test examples on which ScanNet performed poorly (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S13</xref>). We found <italic>bona fide</italic> false negative (undetected interacting patches) and false positives (predicted interacting patches), although for the later we could not rule out involvement in another PPI for which no structural data was available. Another source of mistake was confusion between types of binding sites: we found at least one instance where the incorrectly predicted PPBS were actually RNA binding sites. However, only a minority of RNA binding domain were confused as protein binding (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S15</xref>) Finally, confusion between crystal and native interfaces was a substantial source of apparent mistakes. We found several train set examples in which the network ”refused” to learn the train label and instead predicted another binding interface with high confidence (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S14</xref>). The predicted binding sites matched well the interface found in another biological assembly file. We found a posteriori that the biological assembly files used in the train set were annotated as probably incorrect by QSbio [<xref ref-type="bibr" rid="R44">44</xref>]. Overall, this demonstrated the robustness of predictions with respect to noise in training labels.</p>
            <p id="P16">We next performed ablation experiments to investigate the importance of the network components (<xref ref-type="table" rid="T1">Table I</xref>, <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S16, Sup. Fig. S17</xref>). ScanNet performance decreased but remained above the other methods when discarding the evolutionary information (by replacing the position-weight matrix by the one-hot encoded sequence) or all the atomicscale information (by removing the first two modules). Removing the sparse regularization on the spatio-chemical patterns and the early stopping yielded an homology-like performance profile, with better performance in the high homology setting but poorer otherwise. Lastly, training the model on all chains without redundancy reduction nor using sample weights yielded worse performance, highlighting the importance of sample weights.</p>
            <p id="P17">Finally, we investigated the impact of conformational changes upon binding (<italic>i.e</italic>. induced fit) on ScanNet predictions using the Dockground unbound X-ray and simulated data sets [<xref ref-type="bibr" rid="R45">45</xref>]. Overall, predictions based on bound and unbound structures were highly consistent, and accuracy decreased only mildly from bound to unbound (Materials and Methods Sec. D, <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S5, Sup. Table S1</xref>).</p>
         </sec>
         <sec id="S5">
            <label>C</label>
            <title>Visualization and interpretation of the learnt representations</title>
            <p id="P18">What did ScanNet learn? Does the network reason solely by comparison with training instances or does it learn the underlying chemical principles of binding? How will it behave in out-of-sample settings such as disordered regions? To better understand the learnt representations, we visualized the spatio-chemical patterns and low-dimensional projections of the representations at the atomic (<xref ref-type="fig" rid="F3">Fig. 3</xref>) and amino acid (<xref ref-type="fig" rid="F4">Fig. 4</xref>) levels.</p>
            <p id="P19">Recall that each pattern is composed by a set of gaussian kernels characterized by their location in the local coordinate system and specificity in attribute space. At the atomic scale, the origin corresponds to the central atom and the <sc>z</sc>-axis and <sc>xz</sc>-plane are oriented according to its covalent bonds. Panels (a)-(f) of <xref ref-type="fig" rid="F3">Fig. 3</xref>,<xref ref-type="fig" rid="F4">4</xref> each show one pattern (left), together with a maximally activating neighborhood (right) taken from the validation set and the remaining patterns are provided as Supplementary Data. The atomic pattern shown in <xref ref-type="fig" rid="F3">Fig. 3 (a)</xref> has two main components: a <italic>NH</italic> group located at the center and an oxygen located few Å away, in the (<italic>x</italic> &lt; 0, <italic>y</italic> &lt; 0, <italic>z</italic> &lt; 0) quadrant, i.e. opposite from the two covalent bonds. It is the well known signature of a <italic>N</italic> – <italic>H</italic> – <italic>O</italic> hydrogen bond, ubiquitous in protein backbones. The corresponding maximally activating atom is indeed a backbone nitrogen within a beta sheet. Patterns may have more than two components, and several possible groups per location. The atomic pattern shown in panel (b) features two oxygen atoms and three <italic>NH</italic> groups in a specific arrangement; the corresponding maximally activating neighborhoods are backbone nitrogens located at contact zones between two helical fragments (right of panel (b) and <xref ref-type="supplementary-material" rid="SD4">Sup Fig.S18</xref>). Patterns shown in panels (c),(d) focus on side chains. Pattern (c) is defined as a carbon in the vicinity of a methyl group and an aromatic ring. Pattern (d) consists of <italic>SH</italic> or <italic>NH</italic>
               <sub>2</sub> groups - two side chains-located hydrogen donors - surrounded by oxygen atoms. Lastly, patterns may include prescribed absence of atoms in specific regions. Pattern (e) is defined by a backbone carbon or oxygen without any <italic>NH</italic> groups in its vicinity, meaning that it identifies backbones available for hydrogen bonding. Pattern (f) identifies a methionine side chain with one solvent-exposed side, and is associated with high PPBS probability. Together, the filters collectively define a rich representation capturing various properties of a neighborhood, as seen from the 2D T-SNE projections colored by properties (<xref ref-type="fig" rid="F3">Fig. 3 (g),(h)</xref> ). In the space of filter activities, atoms cluster by coordination number (number of other atoms in range of Van Der Waals interaction) and electrostatic potential (calculated with the Adaptive Poisson-Boltzmann Solver [<xref ref-type="bibr" rid="R49">49</xref>]).</p>
            <p id="P20">The amino acid scale patterns can be similarly analyzed: the origin, <italic>z</italic> axis and <italic>xz</italic> plane are respectively defined by the <italic>C</italic>
               <sub>
                  <italic>α</italic>
               </sub>, side-chain and backbone orientation of the central amino acid. Neighborhoods are shown as backbone segments, with position weight matrices as attributes; the learnt attributes pooled from the atomic scale are not shown. Each gaussian component of a pattern is characterized by a complex specificity in attribute space. We represent it by the distributions of amino acid types and accessible surface areas of its top 1% maximally activating residues. Patterns (a) and (b) focus only on the central amino acid, i.e. they recombine and propagate features from the previous layers. Pattern a) consists of solvent exposed residues of type frequently encountered in protein-protein interfaces such as Leucine or Arginine. It is positively correlated with the output probability (<italic>r</italic> = 0.31). Conversely, pattern (b), which consists of buried hydrophobic amino acids, is activated by residues within the protein cores and is negatively correlated with the output (<italic>r</italic> = –0.32).</p>
            <p id="P21">Multi-component patterns are also found: pattern (c) consists of an exposed glycine together with and exposed aromatic or leucine amino acid and is correlated with binding (<italic>r</italic> = 0.18). Pattern (d) is constituted by an exposed hydrophobic amino acid surrounded by exposed, charged amino acids and is strongly correlated with binding (<italic>r</italic> = 0.29). It is remarkably similar to the hotspot O-ring architecture previously described by Bogan and Thorn [<xref ref-type="bibr" rid="R20">20</xref>]. Conversely, pattern (e), which consists of a central cysteine (possibly involved in a disulfide bond) surrounded by exposed lysines is negatively correlated with binding (<italic>r</italic> = –0.13).</p>
            <p id="P22">Distributed patterns such as pattern (f) are found and hypothetically contribute to prediction by identifying domain-level context. Pattern (f), which consists of multiple aromatic and hydrophobic components, is strongly activated by transmembrane helical domains. Identification of transmembrane domain is indeed required for accurate prediction as the hydrophobic core / hydrophilic rim rule is reversed within membranes. Inversely, we expect that for disordered regions, only the filters with patterns focusing on a single amino acid such as (a) and (b) or a linear stretch such as (c) will contribute to the prediction, whereas the others will be silent. ScanNet will thus effectively behave as a convolutional sequence model with a short kernel width.</p>
            <p id="P23">Finally, the two dimensional T-SNE projections of the representation (<xref ref-type="fig" rid="F4">Fig. 4 (f), (g)</xref> and <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S19</xref>) show that the filter activities encompass various amino-acid level handcrafted features, including amino acid type, secondary structure, accessible surface area, surface convexity and evolutionary conservation.</p>
            <p id="P24">Overall, these findings support the hypothesis that ScanNet learns some of the underlying physico-chemical principles of protein-protein interactions. To consolidate these findings, we compared ScanNet predictions to experimental alanine scans and residue contributions to the binding energy using Rosetta (Materials and Methods, <xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S7</xref>). We found that among the binding residues, the ones with higher binding probability and larger attention coefficients tend to contribute more to the binding free energy. Additionally, the amino acid filter activities reflected the type of interaction (van der Waals, electrostatic,etc.) involved in binding.</p>
         </sec>
         <sec id="S6">
            <label>D</label>
            <title>ScanNet for prediction of B-cell Epitopes</title>
            <p id="P25">B-cell epitopes (BCE) are defined as residues directly involved in a antibody-antigen complex. Although <italic>a priori</italic> every surface residue is potentially immunogenic, some are preferred in the sense that it is easier to mature antibodies targeting them with high affinity and specificity. Exhaustive, high-throughput experimental determination of BCEs is challenging, because they can span across multiple non-contiguous protein fragments. Prediction is challenging owing to their instability throughout evolution, and the lack of exhaustive epitope mappings for a given antigen. <italic>In-silico</italic> prediction of BCE can be leveraged for constructing epitope-based vaccines and for designing non-immunogenic therapeutic proteins.</p>
            <p id="P26">We derived from the SabDab database [<xref ref-type="bibr" rid="R50">50</xref>] a data set of 3756 protein chains (796 95% sequence identity clusters) with annotated BCE. 8.9% of the residues were labeled as BCE, likely an underestimation of the true fraction. The data set was split into five subsets for cross-validation training, with no more than 70% sequence identity between pairs of sequences from different subsets. We evaluated ScanNet in three settings: trained from scratch, trained for PPBS prediction without finetuning, and trained via transfer learning using the PPBS network as starting point. We compared it with the handcrafted features baseline, structural homology baseline and Discotope, a popular tool based on geometric features and propensity scores [<xref ref-type="bibr" rid="R51">51</xref>]. We also report the performance of ScanNet without evolutionary data, of the null predictor and of a predictor based on solvent accessibility only. ScanNet trained via transfer learning outperformed the other models, with an AUCPR of 0.178 and a Positive Predicted Value at L/10 of 27.5% (<xref ref-type="fig" rid="F5">Fig. 5 (a)</xref>, <xref ref-type="supplementary-material" rid="SD4">Sup. Table S4</xref>). This represents an enrichment of respectively 143%, 153% and 309% over Discotope, solvent accessibility-based and null prediction. ScanNet perfomed equally well with or without evolutionary information unlike for PPBS. Visualization of representative spatio-chemical patterns associated with high BCE probability sheds light on the similarities and differences between PPBS and BCE (<xref ref-type="fig" rid="F5">Fig. 5 (b)-(e)</xref>, the remaining filters are provided as Supplementary Data). We find Asparagine and Arginine-containing patterns (b,c) as well as linear epitopes ((c), shared with PPBS). Pattern (d) consists of exposed residues with alternate charges, and putatively indicates availability for salt-bridge formation (d). Finally, pattern (e) is constituted by an exposed, charged amino acid in the vicinity of two cysteines forming a disulfide bond. A possible explanation is that disulfide bond-rich regions are more structurally stable, hence easier to recognize with high affinity and specificity.</p>
            <p id="P27">We next predicted and visualized BCE of the SARS-CoV-2 spike protein. Predictions are shown with representative antibodies superimposed for the trimer with one open Receptor Binding Domain (RBD) (<xref ref-type="fig" rid="F5">Fig. 5 (e)</xref>) and for the isolated RBD and N-terminal domain (NTD) (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S20</xref>). For the spike protein, the RBD was correctly identified as a major antigenic site. The six main epitopes previously described [<xref ref-type="bibr" rid="R52">52</xref>] all had high probabilities, including the cryptic epitope CR3022 (exposed in the open conformation). The tip of the N-terminal Domain (NTD) was also correctly identified as a highly antigenic site. Two linear epitopes located in the S2 fusion machinery are also predicted around Glu 1150 and Arg 1185 respectively. Previously, Shrock et al. [<xref ref-type="bibr" rid="R53">53</xref>] reported that both regions were targeted by antibodies from recovered Covid-19 patients. For the first one, a broadly neutralizing mAB targeting this epitope was recently isolated [<xref ref-type="bibr" rid="R54">54</xref>] and shown to neutralize several beta-coronaviruses but not SARS-CoV-2. Finally, the network predicted with high confidence one previously unreported conformational epitope constituted by three fragments in the vicinity of the glycosylated [<xref ref-type="bibr" rid="R55">55</xref>] Asn 657. Provided that the network is correct, and since the presence of the glycosyl group is unknown at run-time but can be imputed by ScanNet from the Asn-X-Ser/Thr linear motif, two interpretations are possible: either the glycosyl group shields an otherwise highly immunogenic region from antibodies or it directly induces immune response via glycosyl-binding antibodies. We similarly found two additional cryptic epitopes of the NTD which are centered on glycosylated asparagine when performing prediction on the NTD domain alone (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S20 (b)</xref> ).</p>
            <p id="P28">Overall, ScanNet predictions are in excellent agreement with the known antigenic profile of the spike protein and predict a novel epitope that could not be detected via high-throughput linear epitope scanning. We additionally predicted BCE for three other viral protein: HIV envelope protein, influenza HA-1 and influenza HA-3 Hemagglutinin (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S21</xref>). We notably found that the Hemagglutinin epitope predictions differed between the HA-1 and HA-3 strand despite the similar fold, suggesting that ScanNet could be suitable for studying antigenic drift.</p>
         </sec>
      </sec>
      <sec id="S7" sec-type="discussion">
         <title>Discussion</title>
         <p id="P29">Protein function is born by a diverse set of structural motifs. These motifs, characterized by their complex spatio-chemical arrangements of atoms and amino acids, cannot be fully encompassed by handcrafted features. Conversely, detection via comparative modeling is challenging because their invariants, i.e. the set of function-preserving sequence/conformational perturbations are unknown. ScanNet is an end-to-end geometric deep learning model capable of learning such motifs together with their invariants directly from raw structural data by backpropagation. We demonstrated, through a detailed comparison on newly compiled datasets of annotated protein-protein binding sites and B-cell epitopes that it efficiently leverages these motifs to outperform feature-based methods, comparative modeling, and surface-based geometric deep learning. ScanNet reaches an accuracy of 87.7% for PPBS prediction and a positive prediction value at L/10 of 27.5 % for BCE prediction. Through appropriate parameterization and regularization, the spatio-chemical patterns learned by the model can be explicitly visualized and interpreted as previously known motifs and as novel ones. A breakthrough was recently achieved in protein structure prediction using DL [<xref ref-type="bibr" rid="R2">2</xref>], leading to the release of a vast set of accurate protein structure models [<xref ref-type="bibr" rid="R3">3</xref>]. We anticipate that ScanNet will prove insightful for analyzing these proteins, of which little is known regarding their function. A webserver is made available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo3d.cs.tau.ac.il/ScanNet/">http://bioinfo3d.cs.tau.ac.il/ScanNet/</ext-link> and linked to both the PDB and AlphaFoldDB for ease of use. Very recently, Evans et al. [<xref ref-type="bibr" rid="R56">56</xref>] introduced AlphaFold-multimer, a novel approach for prediction of protein complexes from paired multiple sequence alignments and demonstrated impressive performance. We further compared ScanNet to AlphaFold-mutimer for prediction of partner-specific protein-protein binding sites, partner-agnostic protein-protein binding sites, and B-cell epitopes (Materials and Methods). We found that AlphaFold outperformed ScanNet for partner-specific PPBS, whereas both performed comparably for partner-agnostic PPBS. For B-cell epitopes, ScanNet could identify all the main epitopes of the Receptor Binding Domain of the SARS-CoV-2 spike protein, whereas AlphaFold-multimer could only identify one. This showcases the complementarity between MSA-based, partner-specific and structure-based, partner-agnostic approaches . Owing to its generality, it is straightforward to extend ScanNet to other classes of binding sites provided that sufficient training data is available. Extension to partner-specific binding prediction for prediction of interactions and guiding molecular docking is a promising future direction , as the amino acid filter activities are correlated between interacting binding sites (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S22</xref> ). Meanwhile, the learnt atom-wise and amino acid-wise representations can be readily used as drop-in replacement for handcrafted features in any structure-based machine learning pipeline. A second class of applications is protein design: ScanNet, which is differentiable with respect to its inputs and does not require evolutionary information, could be used in conjunction with structure prediction tools to guide design of proteins with prescribed binding or non-binding properties (e.g. non-immunogenic therapeutic proteins).</p>
         <p id="P30">Finally, interpretable, end-to-end learning, combined with self-supervised learning techniques could pave the way towards a complete dictionary of function-bearing structural motifs found in nature, deepening our understanding of the core principles underlying protein function.</p>
      </sec>
      <sec id="S8" sec-type="materials | methods">
         <title>Materials and Methods</title>
         <p id="P31">The Materials and Methods is organized as follows. Section A provides all mathematical and implementation details for ScanNet. Section B is dedicated to the baselines methods. Section C covers data set construction, partition and sample weights. In Section D, we evaluate the impact of induced fit on changes on ScanNet predictions. We compare ScanNet to AlphaFold-multimer in section E. Section F covers the link between ScanNet prediction and binding site predictions. Section G contains additional results for the Protein-protein binding site and B-cell epitope prediction tasks.</p>
         <sec id="S9">
            <label>A</label>
            <title>ScanNet network</title>
            <sec id="S10">
               <label>1</label>
               <title>Preprocessing</title>
               <p id="P32">
                  <bold>PDB parsing</bold> PDB files are parsed using Biopython [<xref ref-type="bibr" rid="R63">63</xref>]. We gather, for each chain, the amino acid sequence and the point cloud of heavy atoms, formally a list of triplets {(coordinates<sub>
                     <italic>l</italic>
                  </sub>, residue id<sub>
                     <italic>l</italic>
                  </sub>, atom id<sub>
                     <italic>l</italic>
                  </sub>) <italic>l</italic> ∈ [[1, <italic>N</italic>
                  <sub>atoms</sub>]]}, e.g. ([10.1,101.3,-12.6], 97, CA). Only atoms belonging to classical residues are considered; exotic residues, additional molecules bound to the chain (e.g. heme, ATP, glycosyl groups, ions...) are excluded.</p>
               <p id="P33">Towards definition of a local reference frame for each atom, we reconstruct the molecular graph (i.e. atom as nodes and covalent bonds as edges) using the residue and atom ids. Each heavy atom has one, two or three neighbors on the molecular graph; if it has only one (e.g. for methyl group <italic>CH</italic>
                  <sub>3</sub>), a virtual hydrogen atom is appended to the graph. Two neighbors are selected to define a triplet of points (<italic>l</italic>, <italic>i</italic>
                  <sub>𝒩<sub>l</sub>
                  </sub>
                  <sub>(<italic>l</italic>)</sub>, <italic>i</italic>
                  <sub>𝒩<sub>2</sub>
                  </sub>
                  <sub>(<italic>l</italic>)</sub> from which a frame can be derived. The coordinates of atoms <italic>l</italic>, <italic>i</italic>
                  <sub>𝒩<sub>l</sub>
                  </sub>
                  <sub>(<italic>l</italic>)</sub> and <italic>i</italic>
                  <sub>
                     <italic>𝒩</italic>
                     <sub>2</sub>
                  </sub>(<italic>l</italic>) respectively define the center, <italic>xz</italic> plane and <italic>z</italic> direction, see paragraph on Frame Computation Module and Equation 3. The first (“previous”) neighbor is chosen as the closest from the N-terminal nitrogen. For the second (“next”) neighbor, if the atom has three neighbors, the furthest from the C-terminal carbon among the remaining two is used [<xref ref-type="bibr" rid="R64">64</xref>]. For instance, the two neighbors of the <italic>C</italic> atom of residue <italic>l</italic> are the <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> of the residue <italic>l</italic> and the <italic>N</italic> of the residue <italic>l</italic> + 1 . The two neighbors of the <italic>C</italic>
                  <sub>
                     <italic>β</italic>
                  </sub> atom are the <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> atom and the <italic>C</italic>
                  <sub>
                     <italic>γ</italic>
                  </sub> atom of the side chain.</p>
               <p id="P34">Also based on the molecular graph, an attribute is assigned to each heavy atom based on its type and the number of bound hydrogens. Twelve categories are defined: <italic>C</italic>,<italic>CH</italic>,<italic>CH</italic>
                  <sub>2</sub>,<italic>CH</italic>
                  <sub>3</sub>,<italic>C</italic>
                  <sub>
                     <italic>π</italic>
                  </sub> (aromatic carbon), <italic>O</italic>,<italic>OH</italic>,<italic>N</italic>,<italic>NH</italic>,<italic>NH</italic>
                  <sub>2</sub>,<italic>S</italic>,<italic>SH</italic>. Overall, four atomic arrays are constructed:</p>
               <list list-type="simple" id="L1">
                  <list-item>
                     <p id="P35">The point cloud of atoms and virtual atoms (float, size [<italic>N</italic>
                        <sub>atoms</sub> + <italic>N</italic>
                        <sub>virtualatoms</sub>, 3]).</p>
                  </list-item>
                  <list-item>
                     <p id="P36">The triplets of indices for constructing atomic local frames (integer, size [<italic>N</italic>
                        <sub>atoms</sub>, 3]).</p>
                  </list-item>
                  <list-item>
                     <p id="P37">The atom groups (integer, size [<italic>N</italic>
                        <sub>atoms</sub>,]).</p>
                  </list-item>
                  <list-item>
                     <p id="P38">The residue index of each atom (integer, size [<italic>N</italic>
                        <sub>atoms</sub>,]).</p>
                  </list-item>
               </list>
               <p id="P39">For the amino acid level, four similar arrays are constructed. The point cloud consists of the <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> and the side chain centers of mass (SCoM) of each amino acid. For Glycines - which do not have a sidechain - a virtual SCoM is defined as x<sub>scoM</sub> = 3x<sub>
                     <italic>C</italic>
                     <sub>
                        <italic>α</italic>
                     </sub>
                  </sub> – x<sub>
                     <italic>C</italic>
                  </sub> – x<sub>
                     <italic>N</italic>
                  </sub>, where x<sub>
                     <italic>C</italic>
                     <sub>
                        <italic>α</italic>
                     </sub>
                  </sub>, x<sub>
                     <italic>C</italic>
                  </sub>, x<sub>
                     <italic>N</italic>
                  </sub> denote the coordinate of respectively the <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub>,<italic>N</italic> and <italic>C</italic> atom of the residue . The reference frame of each amino acid is defined by the <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> (center), previous <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> along the backbone (xz-plane) and SCoM (z-axis). Previous works [<xref ref-type="bibr" rid="R24">24</xref>, <xref ref-type="bibr" rid="R30">30</xref>] considered other amino acid frames constructed from the backbone atoms only. Here, our rationale was that neighboring amino acids located in the opposite direction from the side chain (i.e. the interior of the protein) should not matter for functionality. It also facilitates filter interpretation, as for exposed residues the side-chain points towards the exterior of the protein. We also experimented with frames constructed from consecutive <italic>C</italic>
                  <sub>
                     <italic>α</italic>
                  </sub> and found no difference performance-wise, but have not visualized the corresponding filters.</p>
               <p id="P40">The per-residue attribute is given by the position-weight matrix (21-dimensional probability distribution, see below) or the one-hot-encoded sequence for the models without evolutionary information.</p>
               <p id="P41">
                  <bold>Derivation of the Position Weight Matrix</bold> Given the sequence, we first construct a Multiple Sequence Alignment (MSA) by homology search using HHblits 2 (4 iterations, default values of other parameters) [<xref ref-type="bibr" rid="R65">65</xref>] on the Uni-Clust30_2018_06 database [<xref ref-type="bibr" rid="R66">66</xref>] (except for the SARS-Cov-2 Spike Protein for which we used the UniRef30_2020_06). Next, a sequence dependent weight <italic>w</italic>(<italic>S</italic>) was computed so as to i) address sampling redundancy [<xref ref-type="bibr" rid="R67">67</xref>] and ii) focus the alignment around the wild type [<xref ref-type="bibr" rid="R68">68</xref>]:
<disp-formula id="FD1">
                     <label>(1)</label>
                     <mml:math id="M1">
                        <mml:mrow>
                           <mml:mi>w</mml:mi>
                           <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>S</mml:mi>
                              <mml:mo>)</mml:mo>
                           </mml:mrow>
                           <mml:mo>=</mml:mo>
                           <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mrow>
                                 <mml:mtext> Number of </mml:mtext>
                                 <mml:mn>90</mml:mn>
                                 <mml:mtext>% sequence identity homologs </mml:mtext>
                              </mml:mrow>
                           </mml:mfrac>
                           <mml:mo>×</mml:mo>
                           <mml:mi>exp</mml:mi>
                           <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                 <mml:mo>−</mml:mo>
                                 <mml:mfrac>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>D</mml:mi>
                                          <mml:mrow>
                                             <mml:mtext>Hamming </mml:mtext>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:mi>S</mml:mi>
                                             <mml:mo>,</mml:mo>
                                             <mml:mi>W</mml:mi>
                                             <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>d</mml:mi>
                                          <mml:mn>0</mml:mn>
                                       </mml:msub>
                                    </mml:mrow>
                                 </mml:mfrac>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                              <mml:mo>,</mml:mo>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P42">where <italic>d</italic>
                  <sub>0</sub> is adjusted such that the effective number of samples is <italic>B</italic>
                  <sub>eff</sub> ≡ ∑<sub>
                     <italic>s</italic>
                  </sub>
                  <italic>w</italic>(<italic>S</italic>) = 500. If the alignment is initially too small, <italic>d</italic>
                  <sub>
                     <italic>0</italic>
                  </sub> = ∞ is used. Focusing the alignments allows to detect local evolutionary conservation patterns as opposed to family-level conservation patterns; this is relevant as protein-protein interfaces are not always conserved at the superfamily level.</p>
            </sec>
            <sec id="S11">
               <label>2</label>
               <title>ScanNet modules</title>
               <p id="P43">
                  <bold>Notations</bold> The following notations are used throughout presentation of the modules; <italic>x</italic>: Global coordinates; <italic>f</italic>: Frames; <italic>x</italic>
                  <sup>
                     <italic>ℓ</italic>
                  </sup>: Local coordinates; <italic>a</italic>: Attributes; <italic>a</italic>
                  <sup>
                     <italic>ℓ</italic>
                  </sup>: Local attributes; <italic>L</italic>: Size of point set; <italic>K</italic>: Number of points in a neighborhood; <italic>D</italic>: Dimension of coordinates; <italic>N</italic>/<italic>M</italic>: Dimension of attributes. <italic>G</italic>: Number of Gaussian kernels. All upper case letters are integer dimension numbers. The corresponding lower case letter denote running indices e.g. <italic>a</italic>
                  <sub>
                     <italic>ln</italic>
                  </sub> denotes the <italic>n</italic>’th (<italic>n</italic> ∈ [[1, <italic>N</italic>]]) attribute of the <italic>l</italic>’th (<italic>l</italic> ∈ [[1, <italic>L</italic>]]) point of the point cloud and <inline-formula>
                     <mml:math id="M2">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                 <mml:mi>l</mml:mi>
                                 <mml:mi>k</mml:mi>
                                 <mml:mi>d</mml:mi>
                              </mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> is the <italic>d</italic>’th local coordinate of the <italic>k</italic>’th neigbhor of point <italic>i</italic>. Bold letters denote vectors or matrices.</p>
               <p id="P44">
                  <bold>Attribute Embedding Module (AEM)</bold> applies an element-wise non-linear transformation to the attributes <italic>a</italic>
                  <sub>
                     <italic>ln</italic>
                  </sub> of each point. Here, we used a element-wise dense layer, <italic>i.e</italic>. a matrix product followed by ReLU non-linearity for all AEM except for the initial atomic attribute embedding module - for which the input is a categorical variable and a one-hot encoding layer is applied. The equation for the AEM writes:
<disp-formula id="FD2">
                     <label>(2)</label>
                     <mml:math id="M3">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>a</mml:mi>
                              <mml:mrow>
                                 <mml:mi>l</mml:mi>
                                 <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                           </mml:msubsup>
                           <mml:mo>=</mml:mo>
                           <mml:mtext>ReLU</mml:mtext>
                           <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                 <mml:munder>
                                    <mml:mstyle mathsize="140%" displaystyle="true">
                                       <mml:mo>∑</mml:mo>
                                    </mml:mstyle>
                                    <mml:mi>n</mml:mi>
                                 </mml:munder>
                                 <mml:msub>
                                    <mml:mi>a</mml:mi>
                                    <mml:mrow>
                                       <mml:mi>l</mml:mi>
                                       <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:msub>
                                    <mml:mi>w</mml:mi>
                                    <mml:mrow>
                                       <mml:mi>n</mml:mi>
                                       <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo>+</mml:mo>
                                 <mml:msub>
                                    <mml:mi>θ</mml:mi>
                                    <mml:mi>m</mml:mi>
                                 </mml:msub>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P45">
                  <bold>Frame Computation Module</bold> (FCM) takes as input a point cloud <italic>x</italic>
                  <sub>
                     <italic>ld</italic>
                  </sub> and a set of triplets of indices (<italic>i</italic>
                  <sub>
                     <italic>l</italic>1</sub>,<italic>i</italic>
                  <sub>
                     <italic>l</italic>2</sub>,<italic>i</italic>
                  <sub>
                     <italic>l</italic>3</sub>) and calculates, for every triplet, a frame <italic>f</italic>
                  <sub>
                     <italic>ldd</italic>′</sub>, of size [<italic>L</italic>,4, 3]), constituted by the center and the three unit vectors. The equation writes:
<disp-formula id="FD3">
                     <label>(3)</label>
                     <mml:math id="M4">
                        <mml:mtable columnalign="left">
                           <mml:mtr>
                              <mml:mtd>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:mtext>center </mml:mtext>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mspace width="0.2em"/>
                                 <mml:mo>=</mml:mo>
                                 <mml:msub>
                                    <mml:mtext>x</mml:mtext>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>i</mml:mi>
                                          </mml:mstyle>
                                          <mml:mrow>
                                             <mml:mtext>l</mml:mtext>
                                             <mml:mn>1</mml:mn>
                                          </mml:mrow>
                                       </mml:msub>
                                    </mml:mrow>
                                 </mml:msub>
                              </mml:mtd>
                           </mml:mtr>
                           <mml:mtr>
                              <mml:mtd>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>4</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo stretchy="false">(</mml:mo>
                                 <mml:mtext>z</mml:mtext>
                                 <mml:mo>−</mml:mo>
                                 <mml:mtext> axis </mml:mtext>
                                 <mml:mo stretchy="false">)</mml:mo>
                                 <mml:mo>=</mml:mo>
                                 <mml:mfrac>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mtext>x</mml:mtext>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>i</mml:mtext>
                                                <mml:mrow>
                                                   <mml:mtext>l</mml:mtext>
                                                   <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                             </mml:msub>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:mo>−</mml:mo>
                                       <mml:msub>
                                          <mml:mtext>x</mml:mtext>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>i</mml:mtext>
                                                <mml:mrow>
                                                   <mml:mtext>l</mml:mtext>
                                                   <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                             </mml:msub>
                                          </mml:mrow>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>x</mml:mtext>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mtext>i</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:mtext>l</mml:mtext>
                                                         <mml:mn>3</mml:mn>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>−</mml:mo>
                                             <mml:msub>
                                                <mml:mtext>x</mml:mtext>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mtext>i</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:mtext>l</mml:mtext>
                                                         <mml:mn>1</mml:mn>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                </mml:mrow>
                                             </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                 </mml:mfrac>
                              </mml:mtd>
                           </mml:mtr>
                           <mml:mtr>
                              <mml:mtd>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>3</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo stretchy="false">(</mml:mo>
                                 <mml:mtext>y</mml:mtext>
                                 <mml:mo>−</mml:mo>
                                 <mml:mtext> axis </mml:mtext>
                                 <mml:mo stretchy="false">)</mml:mo>
                                 <mml:mo>=</mml:mo>
                                 <mml:mfrac>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mtext>f</mml:mtext>
                                          <mml:mrow>
                                             <mml:mtext>l</mml:mtext>
                                             <mml:mn>4</mml:mn>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:mo>×</mml:mo>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>x</mml:mtext>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mtext>i</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:mtext>l</mml:mtext>
                                                         <mml:mn>2</mml:mn>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>−</mml:mo>
                                             <mml:msub>
                                                <mml:mtext>x</mml:mtext>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mtext>i</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:mtext>l</mml:mtext>
                                                         <mml:mn>1</mml:mn>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                </mml:mrow>
                                             </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>f</mml:mtext>
                                                <mml:mrow>
                                                   <mml:mtext>l</mml:mtext>
                                                   <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>×</mml:mo>
                                             <mml:mrow>
                                                <mml:mo>(</mml:mo>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mtext>x</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:msub>
                                                            <mml:mtext>i</mml:mtext>
                                                            <mml:mrow>
                                                               <mml:mtext>l</mml:mtext>
                                                               <mml:mn>2</mml:mn>
                                                            </mml:mrow>
                                                         </mml:msub>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                   <mml:mo>−</mml:mo>
                                                   <mml:msub>
                                                      <mml:mtext>x</mml:mtext>
                                                      <mml:mrow>
                                                         <mml:msub>
                                                            <mml:mtext>i</mml:mtext>
                                                            <mml:mrow>
                                                               <mml:mtext>l</mml:mtext>
                                                               <mml:mn>1</mml:mn>
                                                            </mml:mrow>
                                                         </mml:msub>
                                                      </mml:mrow>
                                                   </mml:msub>
                                                </mml:mrow>
                                                <mml:mo>)</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                 </mml:mfrac>
                              </mml:mtd>
                           </mml:mtr>
                           <mml:mtr>
                              <mml:mtd>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo stretchy="false">(</mml:mo>
                                 <mml:mtext>x</mml:mtext>
                                 <mml:mo>−</mml:mo>
                                 <mml:mtext> axis </mml:mtext>
                                 <mml:mo stretchy="false">)</mml:mo>
                                 <mml:mo>=</mml:mo>
                                 <mml:mfrac>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mtext>f</mml:mtext>
                                          <mml:mrow>
                                             <mml:mtext>l</mml:mtext>
                                             <mml:mn>3</mml:mn>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:mo>×</mml:mo>
                                       <mml:msub>
                                          <mml:mtext>f</mml:mtext>
                                          <mml:mrow>
                                             <mml:mtext>l</mml:mtext>
                                             <mml:mn>4</mml:mn>
                                          </mml:mrow>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mtext>f</mml:mtext>
                                                <mml:mrow>
                                                   <mml:mtext>l</mml:mtext>
                                                   <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>×</mml:mo>
                                             <mml:msub>
                                                <mml:mtext>f</mml:mtext>
                                                <mml:mrow>
                                                   <mml:mtext>l</mml:mtext>
                                                   <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                             </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>‖</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                 </mml:mfrac>
                              </mml:mtd>
                           </mml:mtr>
                        </mml:mtable>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P46">Where × denotes the cross-product. Examples of frames overlaid on a protein structure are shown in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S1 (a,b)</xref>. The FCM has no trainable parameters.</p>
               <p id="P47">
                  <bold>Neighborhood Computation Module</bold> (NCM) determines, for each point, its <italic>K</italic> closest neighbors in space (including itself), computes their local coordinates and duplicates their attributes. Its inputs are a set of frames <italic>f</italic>
                  <sub>
                     <italic>lid</italic>
                  </sub> and attributes <italic>a</italic>
                  <sub>
                     <italic>ln</italic>
                  </sub>, and outputs are the neighborhoods <inline-formula>
                     <mml:math id="M5">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                 <mml:mi>l</mml:mi>
                                 <mml:mi>k</mml:mi>
                                 <mml:mi>d</mml:mi>
                              </mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, <inline-formula>
                     <mml:math id="M6">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                 <mml:mi>l</mml:mi>
                                 <mml:mi>k</mml:mi>
                                 <mml:mi>d</mml:mi>
                              </mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>. The nearest neighbor search is implemented naively by computing distances between all pairs of frame centers. For the atomic and amino acid neighborhoods, we use as local coordinates the three euclidean coordinates of the second frame center in the first frame and take <italic>K</italic> = 16. For the neighborhood attention module, we take <italic>K</italic> = 32 and use five coordinates: the distance between both frames centers <inline-formula>
                     <mml:math id="M7">
                        <mml:mrow>
                           <mml:mo>‖</mml:mo>
                           <mml:msub>
                              <mml:mtext>f</mml:mtext>
                              <mml:mrow>
                                 <mml:mtext>l</mml:mtext>
                                 <mml:mn>1</mml:mn>
                              </mml:mrow>
                           </mml:msub>
                           <mml:mo>−</mml:mo>
                           <mml:msubsup>
                              <mml:mtext>f</mml:mtext>
                              <mml:mrow>
                                 <mml:mtext>l</mml:mtext>
                                 <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                           </mml:msubsup>
                           <mml:mo>‖</mml:mo>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, the dot product between the side-chain directions <inline-formula>
                     <mml:math id="M8">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mtext>f</mml:mtext>
                              <mml:mrow>
                                 <mml:mtext>l</mml:mtext>
                                 <mml:mn>4</mml:mn>
                              </mml:mrow>
                           </mml:msub>
                           <mml:mo>⋅</mml:mo>
                           <mml:msubsup>
                              <mml:mtext>f</mml:mtext>
                              <mml:mrow>
                                 <mml:mtext>l</mml:mtext>
                                 <mml:mn>4</mml:mn>
                              </mml:mrow>
                              <mml:mo>′</mml:mo>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, the dot product between the side-chain directions and the center to center vectors <inline-formula>
                     <mml:math id="M9">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mtext>f</mml:mtext>
                              <mml:mrow>
                                 <mml:mtext>l</mml:mtext>
                                 <mml:mn>4</mml:mn>
                              </mml:mrow>
                           </mml:msub>
                           <mml:mo>⋅</mml:mo>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:msubsup>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mo>′</mml:mo>
                                 </mml:msubsup>
                                 <mml:mo>−</mml:mo>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mo>‖</mml:mo>
                                 <mml:msubsup>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mo>′</mml:mo>
                                 </mml:msubsup>
                                 <mml:mo>−</mml:mo>
                                 <mml:msub>
                                    <mml:mtext>f</mml:mtext>
                                    <mml:mrow>
                                       <mml:mtext>l</mml:mtext>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo>‖</mml:mo>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> (and symmetric) and the distance between amino acids along the sequence (clipped at <italic>d</italic>
                  <sub>max</sub> = 8). They are shown respectively as <italic>d</italic>,<italic>w</italic>,<italic>θ</italic>,<italic>θ′</italic>,<italic>d</italic>
                  <sub>sequence</sub> in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S1 (c)</xref>; The NCM has no trainable parameters.</p>
               <p id="P48">
                  <bold>Neighborhood Embedding Module</bold> (NEM) is the core module of ScanNet. NEM convolves each neighborhood with a set of trainable spatio-chemical filters, akin to convolutional filters in image CNNs (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Its inputs are a set of <italic>K</italic> points with local coordinates <inline-formula>
                     <mml:math id="M10">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>x</mml:mi>
                              <mml:mrow>
                                 <mml:mi>k</mml:mi>
                                 <mml:mi>d</mml:mi>
                              </mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> and attributes <inline-formula>
                     <mml:math id="M11">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>a</mml:mi>
                              <mml:mrow>
                                 <mml:mi>k</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, where <italic>k</italic> ∈ [1, <italic>K</italic>], <italic>d</italic> ∈ [1,<italic>D</italic>], <italic>n</italic> ∈ [1, <italic>N</italic>] respectively denote neighbor, coordinate and attribute indices. NEM outputs a set of <italic>M</italic> filter activities <italic>y</italic>
                  <sub>
                     <italic>m</italic>
                  </sub>. It is parameterized using <italic>G</italic> = 32 gaussian kernels (as in [<xref ref-type="bibr" rid="R69">69</xref>]) and a bilinear product as follows:
<disp-formula id="FD4">
                     <label>(4)</label>
                     <mml:math id="M12">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>m</mml:mi>
                           </mml:msub>
                           <mml:mo>=</mml:mo>
                           <mml:mtext>ReLU</mml:mtext>
                           <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                 <mml:munder>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathsize="140%" displaystyle="true">
                                                   <mml:mo>∑</mml:mo>
                                                </mml:mstyle>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mtext>​</mml:mtext>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mi>k</mml:mi>
                                       <mml:mo>,</mml:mo>
                                       <mml:mi>g</mml:mi>
                                       <mml:mo>,</mml:mo>
                                       <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                 </mml:munder>
                                 <mml:msubsup>
                                    <mml:mi>W</mml:mi>
                                    <mml:mrow>
                                       <mml:mi>m</mml:mi>
                                       <mml:mi>g</mml:mi>
                                       <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mi>s</mml:mi>
                                       <mml:mi>c</mml:mi>
                                    </mml:mrow>
                                 </mml:msubsup>
                                 <mml:mi mathvariant="script">G</mml:mi>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>μ</mml:mi>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>g</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                       <mml:mo>,</mml:mo>
                                       <mml:msub>
                                          <mml:mtext>Σ</mml:mtext>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>g</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                       <mml:mo>,</mml:mo>
                                       <mml:msub>
                                          <mml:mi>x</mml:mi>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>k</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                                 <mml:msub>
                                    <mml:mi>a</mml:mi>
                                    <mml:mrow>
                                       <mml:mi>k</mml:mi>
                                       <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                 </mml:msub>
                                 <mml:mo>+</mml:mo>
                                 <mml:munder>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathsize="140%" displaystyle="true">
                                                   <mml:mo>∑</mml:mo>
                                                </mml:mstyle>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mtext>​</mml:mtext>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mi>k</mml:mi>
                                       <mml:mo>,</mml:mo>
                                       <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                 </mml:munder>
                                 <mml:msubsup>
                                    <mml:mi>W</mml:mi>
                                    <mml:mrow>
                                       <mml:mi>m</mml:mi>
                                       <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                 </mml:msubsup>
                                 <mml:mi mathvariant="script">G</mml:mi>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>μ</mml:mi>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>g</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                       <mml:mo>,</mml:mo>
                                       <mml:msub>
                                          <mml:mtext>Σ</mml:mtext>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>g</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                       <mml:mo>,</mml:mo>
                                       <mml:msub>
                                          <mml:mtext>x</mml:mtext>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>k</mml:mi>
                                          </mml:mstyle>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                                 <mml:mo>+</mml:mo>
                                 <mml:msubsup>
                                    <mml:mi>W</mml:mi>
                                    <mml:mi>m</mml:mi>
                                    <mml:mi>b</mml:mi>
                                 </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P49">Where <inline-formula>
                     <mml:math id="M13">
                        <mml:mrow>
                           <mml:mi mathvariant="script">G</mml:mi>
                           <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                 <mml:mi>μ</mml:mi>
                                 <mml:mo>,</mml:mo>
                                 <mml:mstyle mathvariant="bold" mathsize="normal">
                                    <mml:mi>Σ</mml:mi>
                                 </mml:mstyle>
                                 <mml:mo>,</mml:mo>
                                 <mml:mtext>x</mml:mtext>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                           </mml:mrow>
                           <mml:mo>=</mml:mo>
                           <mml:mi>exp</mml:mi>
                           <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                 <mml:mo>−</mml:mo>
                                 <mml:mfrac>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                 </mml:mfrac>
                                 <mml:msup>
                                    <mml:mrow>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:mtext>x</mml:mtext>
                                             <mml:mo>−</mml:mo>
                                             <mml:mi>μ</mml:mi>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                    <mml:mi>T</mml:mi>
                                 </mml:msup>
                                 <mml:msup>
                                    <mml:mstyle mathvariant="bold" mathsize="normal">
                                       <mml:mi>Σ</mml:mi>
                                    </mml:mstyle>
                                    <mml:mrow>
                                       <mml:mo>−</mml:mo>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                 </mml:msup>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:mtext>x</mml:mtext>
                                       <mml:mo>−</mml:mo>
                                       <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> is a Gaussian kernel of center <italic>μ</italic> and (full) covariance matrix Σ, and <bold>W</bold>
                  <sup>
                     <bold>sc</bold>
                  </sup>, <bold>W</bold>
                  <sup>
                     <bold>s</bold>
                  </sup>, <bold>W</bold>
                  <sup>
                     <bold>b</bold>
                  </sup> are trainable tensors of sizes [<italic>M</italic>, <italic>G</italic>, <italic>N</italic>], [<italic>M</italic>, <italic>G</italic>], [<italic>M</italic>,]. See a graphical sketch in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S1 (d)</xref>. The gaussian kernels are trainable and shared between all filters of a given layer, see implementation in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S1 (e)</xref>.</p>
               <p id="P50">The above parameterization offers several advantages over other choices such as Multilayer perceptrons [<xref ref-type="bibr" rid="R25">25</xref>, <xref ref-type="bibr" rid="R70">70</xref>, <xref ref-type="bibr" rid="R71">71</xref>] or spherical harmonics [<xref ref-type="bibr" rid="R35">35</xref>, <xref ref-type="bibr" rid="R72">72</xref>]. First, it is straightforward to interpret: a filter <italic>m</italic> with large entries of the tensor <bold>W</bold>
                  <sup>
                     <bold>sc</bold>
                  </sup> for some <italic>g</italic>,<italic>n</italic> is positively activated by points having attribute <italic>n</italic> and located near the center of the Gaussian <italic>g</italic>. Similarly, the matrix <italic>W</italic>
                  <sup>
                     <italic>s</italic>
                  </sup> encodes attribute-independent spatial sensitivity and <italic>W</italic>
                  <sup>
                     <italic>b</italic>
                  </sup> is a bias vector. Second, localized filters, <italic>i.e</italic>. filters detecting only one or few combinations of point/attributes can be obtained by simply enforcing sparsity of the weights <italic>W</italic>
                  <sup>
                     <italic>sc</italic>
                  </sup> and <italic>W</italic>
                  <sup>
                     <italic>s</italic>
                  </sup> via a regularization penalty. Third, the filters are guaranteed to have an almost compact support, as the gaussian functions decay rapidly as ∥<italic>x</italic>∥ → ∞). This ensures that the diameter of the neighborhood is effectively capped irrespective of the local point density - in particular for unpacked or disordered regions. Last but not least, the gaussian kernels can be initialized using unsupervised learning, thereby improving performance and limiting run-to-run performance variance (initialization protocol detailed below).</p>
               <p id="P51">For the sparsity regularization, we use the following combination of cost function and norm constraint:
<disp-formula id="FD5">
                     <label>(5)</label>
                     <mml:math id="M14">
                        <mml:mrow>
                           <mml:mtable columnalign="left">
                              <mml:mtr columnalign="left">
                                 <mml:mtd columnalign="left">
                                    <mml:mrow>
                                       <mml:msubsup>
                                          <mml:mi>ℛ</mml:mi>
                                          <mml:mn>1</mml:mn>
                                          <mml:mn>2</mml:mn>
                                       </mml:msubsup>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathvariant="bold" mathsize="normal">
                                                   <mml:mi>W</mml:mi>
                                                </mml:mstyle>
                                                <mml:mrow>
                                                   <mml:mtext>sc</mml:mtext>
                                                </mml:mrow>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                       <mml:mo>=</mml:mo>
                                       <mml:mfrac>
                                          <mml:mrow>
                                             <mml:msubsup>
                                                <mml:mtext>λ</mml:mtext>
                                                <mml:mn>1</mml:mn>
                                                <mml:mn>2</mml:mn>
                                             </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mrow>
                                             <mml:mn>2</mml:mn>
                                             <mml:mi>G</mml:mi>
                                             <mml:mi>N</mml:mi>
                                          </mml:mrow>
                                       </mml:mfrac>
                                       <mml:munder>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mstyle mathsize="140%" displaystyle="true">
                                                         <mml:mo>∑</mml:mo>
                                                      </mml:mstyle>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mi>m</mml:mi>
                                       </mml:munder>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:mrow>
                                                <mml:mo>(</mml:mo>
                                                <mml:mrow>
                                                   <mml:munder>
                                                      <mml:mrow>
                                                         <mml:msup>
                                                            <mml:mrow>
                                                               <mml:msup>
                                                                  <mml:mstyle mathsize="140%" displaystyle="true">
                                                                     <mml:mo>∑</mml:mo>
                                                                  </mml:mstyle>
                                                                  <mml:mtext>​</mml:mtext>
                                                               </mml:msup>
                                                            </mml:mrow>
                                                            <mml:mtext>​</mml:mtext>
                                                         </mml:msup>
                                                      </mml:mrow>
                                                      <mml:mrow>
                                                         <mml:mi>g</mml:mi>
                                                         <mml:mi>n</mml:mi>
                                                      </mml:mrow>
                                                   </mml:munder>
                                                   <mml:mrow>
                                                      <mml:mo>|</mml:mo>
                                                      <mml:mrow>
                                                         <mml:msubsup>
                                                            <mml:mi>W</mml:mi>
                                                            <mml:mrow>
                                                               <mml:mi>m</mml:mi>
                                                               <mml:mi>g</mml:mi>
                                                               <mml:mi>n</mml:mi>
                                                            </mml:mrow>
                                                            <mml:mrow>
                                                               <mml:mi>s</mml:mi>
                                                               <mml:mi>c</mml:mi>
                                                            </mml:mrow>
                                                         </mml:msubsup>
                                                      </mml:mrow>
                                                      <mml:mo>|</mml:mo>
                                                   </mml:mrow>
                                                </mml:mrow>
                                                <mml:mo>)</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                       </mml:msup>
                                    </mml:mrow>
                                 </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                 <mml:mtd columnalign="left">
                                    <mml:mrow>
                                       <mml:msubsup>
                                          <mml:mi>ℛ</mml:mi>
                                          <mml:mn>1</mml:mn>
                                          <mml:mn>2</mml:mn>
                                       </mml:msubsup>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathvariant="bold" mathsize="normal">
                                                   <mml:mi>W</mml:mi>
                                                </mml:mstyle>
                                                <mml:mstyle mathvariant="bold" mathsize="normal">
                                                   <mml:mi>s</mml:mi>
                                                </mml:mstyle>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                       <mml:mo>=</mml:mo>
                                       <mml:mfrac>
                                          <mml:mrow>
                                             <mml:msubsup>
                                                <mml:mtext>λ</mml:mtext>
                                                <mml:mn>1</mml:mn>
                                                <mml:mn>2</mml:mn>
                                             </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mrow>
                                             <mml:mn>2</mml:mn>
                                             <mml:mi>G</mml:mi>
                                          </mml:mrow>
                                       </mml:mfrac>
                                       <mml:munder>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mstyle mathsize="140%" displaystyle="true">
                                                         <mml:mo>∑</mml:mo>
                                                      </mml:mstyle>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mi>m</mml:mi>
                                       </mml:munder>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:mrow>
                                                <mml:mo>(</mml:mo>
                                                <mml:mrow>
                                                   <mml:munder>
                                                      <mml:mrow>
                                                         <mml:msup>
                                                            <mml:mrow>
                                                               <mml:msup>
                                                                  <mml:mstyle mathsize="140%" displaystyle="true">
                                                                     <mml:mo>∑</mml:mo>
                                                                  </mml:mstyle>
                                                                  <mml:mtext>​</mml:mtext>
                                                               </mml:msup>
                                                            </mml:mrow>
                                                            <mml:mtext>​</mml:mtext>
                                                         </mml:msup>
                                                      </mml:mrow>
                                                      <mml:mi>g</mml:mi>
                                                   </mml:munder>
                                                   <mml:mrow>
                                                      <mml:mo>|</mml:mo>
                                                      <mml:mrow>
                                                         <mml:msubsup>
                                                            <mml:mi>W</mml:mi>
                                                            <mml:mrow>
                                                               <mml:mi>m</mml:mi>
                                                               <mml:mi>g</mml:mi>
                                                            </mml:mrow>
                                                            <mml:mi>s</mml:mi>
                                                         </mml:msubsup>
                                                      </mml:mrow>
                                                      <mml:mo>|</mml:mo>
                                                   </mml:mrow>
                                                </mml:mrow>
                                                <mml:mo>)</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                       </mml:msup>
                                    </mml:mrow>
                                 </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                 <mml:mtd columnalign="left">
                                    <mml:mrow>
                                       <mml:msqrt>
                                          <mml:mrow>
                                             <mml:munder>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mrow>
                                                         <mml:msup>
                                                            <mml:mstyle mathsize="140%" displaystyle="true">
                                                               <mml:mo>∑</mml:mo>
                                                            </mml:mstyle>
                                                            <mml:mtext>​</mml:mtext>
                                                         </mml:msup>
                                                      </mml:mrow>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                             </mml:munder>
                                             <mml:msup>
                                                <mml:mrow>
                                                   <mml:mrow>
                                                      <mml:mo>(</mml:mo>
                                                      <mml:mrow>
                                                         <mml:msubsup>
                                                            <mml:mi>W</mml:mi>
                                                            <mml:mrow>
                                                               <mml:mi>m</mml:mi>
                                                               <mml:mi>g</mml:mi>
                                                               <mml:mi>n</mml:mi>
                                                            </mml:mrow>
                                                            <mml:mrow>
                                                               <mml:mi>s</mml:mi>
                                                               <mml:mi>c</mml:mi>
                                                            </mml:mrow>
                                                         </mml:msubsup>
                                                      </mml:mrow>
                                                      <mml:mo>)</mml:mo>
                                                   </mml:mrow>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                             </mml:msup>
                                          </mml:mrow>
                                       </mml:msqrt>
                                       <mml:mo>=</mml:mo>
                                       <mml:msqrt>
                                          <mml:mrow>
                                             <mml:mfrac>
                                                <mml:mi>G</mml:mi>
                                                <mml:mi>K</mml:mi>
                                             </mml:mfrac>
                                          </mml:mrow>
                                       </mml:msqrt>
                                       <mml:mo>,</mml:mo>
                                       <mml:mo>∀</mml:mo>
                                       <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                 </mml:mtd>
                              </mml:mtr>
                           </mml:mtable>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P52">The so-called <inline-formula>
                     <mml:math id="M15">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>L</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> regularization (as previously described in [<xref ref-type="bibr" rid="R73">73</xref>]) is a variant of the <italic>L</italic>
                  <sub>1</sub> regularization <inline-formula>
                     <mml:math id="M16">
                        <mml:mrow>
                           <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                 <mml:msub>
                                    <mml:mi>ℛ</mml:mi>
                                    <mml:mn>1</mml:mn>
                                 </mml:msub>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mi>W</mml:mi>
                                          </mml:mstyle>
                                          <mml:mstyle mathvariant="bold" mathsize="normal">
                                             <mml:mn>1</mml:mn>
                                          </mml:mstyle>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                                 <mml:mo>=</mml:mo>
                                 <mml:munder>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathsize="140%" displaystyle="true">
                                                   <mml:mo>∑</mml:mo>
                                                </mml:mstyle>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mtext>​</mml:mtext>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mi>m</mml:mi>
                                       <mml:mi>g</mml:mi>
                                       <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                 </mml:munder>
                                 <mml:mrow>
                                    <mml:mo>|</mml:mo>
                                    <mml:mrow>
                                       <mml:msubsup>
                                          <mml:mi>W</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>m</mml:mi>
                                             <mml:mi>g</mml:mi>
                                             <mml:mi>n</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>1</mml:mn>
                                       </mml:msubsup>
                                    </mml:mrow>
                                    <mml:mo>|</mml:mo>
                                 </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> that promotes homogeneity of the filter sparsity values. This can be seen from the expression of the gradients, which write:
<disp-formula id="FD6">
                     <label>(6)</label>
                     <mml:math id="M17">
                        <mml:mrow>
                           <mml:mtable columnalign="left">
                              <mml:mtr columnalign="left">
                                 <mml:mtd columnalign="left">
                                    <mml:mrow>
                                       <mml:mfrac>
                                          <mml:mrow>
                                             <mml:mo>∂</mml:mo>
                                             <mml:msubsup>
                                                <mml:mi>ℛ</mml:mi>
                                                <mml:mn>1</mml:mn>
                                                <mml:mn>2</mml:mn>
                                             </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>∂</mml:mo>
                                             <mml:msubsup>
                                                <mml:mi>W</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>m</mml:mi>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>s</mml:mi>
                                                   <mml:mi>c</mml:mi>
                                                </mml:mrow>
                                             </mml:msubsup>
                                          </mml:mrow>
                                       </mml:mfrac>
                                       <mml:mo>=</mml:mo>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:mfrac>
                                                <mml:mrow>
                                                   <mml:msubsup>
                                                      <mml:mi>λ</mml:mi>
                                                      <mml:mn>1</mml:mn>
                                                      <mml:mn>2</mml:mn>
                                                   </mml:msubsup>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>G</mml:mi>
                                                   <mml:mi>N</mml:mi>
                                                </mml:mrow>
                                             </mml:mfrac>
                                             <mml:munder>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mrow>
                                                         <mml:msup>
                                                            <mml:mstyle mathsize="140%" displaystyle="true">
                                                               <mml:mo>∑</mml:mo>
                                                            </mml:mstyle>
                                                            <mml:mtext>​</mml:mtext>
                                                         </mml:msup>
                                                      </mml:mrow>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                   <mml:msup>
                                                      <mml:mrow/>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                             </mml:munder>
                                             <mml:mrow>
                                                <mml:mo>|</mml:mo>
                                                <mml:mrow>
                                                   <mml:msubsup>
                                                      <mml:mi>W</mml:mi>
                                                      <mml:mrow>
                                                         <mml:mi>m</mml:mi>
                                                         <mml:mi>g</mml:mi>
                                                         <mml:mi>n</mml:mi>
                                                      </mml:mrow>
                                                      <mml:mrow>
                                                         <mml:mi>s</mml:mi>
                                                         <mml:mi>c</mml:mi>
                                                      </mml:mrow>
                                                   </mml:msubsup>
                                                </mml:mrow>
                                                <mml:mo>|</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                       <mml:mi>s</mml:mi>
                                       <mml:mi>i</mml:mi>
                                       <mml:mi>g</mml:mi>
                                       <mml:mi>n</mml:mi>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:msubsup>
                                                <mml:mi>W</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>m</mml:mi>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>s</mml:mi>
                                                   <mml:mi>c</mml:mi>
                                                </mml:mrow>
                                             </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                 </mml:mtd>
                              </mml:mtr>
                              <mml:mtr columnalign="left">
                                 <mml:mtd columnalign="left">
                                    <mml:mrow>
                                       <mml:mfrac>
                                          <mml:mrow>
                                             <mml:mo>∂</mml:mo>
                                             <mml:msub>
                                                <mml:mi>ℛ</mml:mi>
                                                <mml:mn>1</mml:mn>
                                             </mml:msub>
                                          </mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>∂</mml:mo>
                                             <mml:msubsup>
                                                <mml:mi>W</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>m</mml:mi>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>s</mml:mi>
                                                   <mml:mi>c</mml:mi>
                                                </mml:mrow>
                                             </mml:msubsup>
                                          </mml:mrow>
                                       </mml:mfrac>
                                       <mml:mo>=</mml:mo>
                                       <mml:mtext> </mml:mtext>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:msub>
                                          <mml:mi>λ</mml:mi>
                                          <mml:mn>1</mml:mn>
                                       </mml:msub>
                                       <mml:mtext> </mml:mtext>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mspace width="0.2em"/>
                                       <mml:mi>s</mml:mi>
                                       <mml:mi>i</mml:mi>
                                       <mml:mi>g</mml:mi>
                                       <mml:mi>n</mml:mi>
                                       <mml:mrow>
                                          <mml:mo>(</mml:mo>
                                          <mml:mrow>
                                             <mml:msubsup>
                                                <mml:mi>W</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>m</mml:mi>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mi>n</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mi>s</mml:mi>
                                                   <mml:mi>c</mml:mi>
                                                </mml:mrow>
                                             </mml:msubsup>
                                          </mml:mrow>
                                          <mml:mo>)</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                 </mml:mtd>
                              </mml:mtr>
                           </mml:mtable>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P53">The <inline-formula>
                     <mml:math id="M18">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>L</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> regularization is effectively a <italic>L</italic>
                  <sub>1</sub> regularization with a filter-dependent regularization strength: filters that are sparse (resp. not sparse) have a small (resp. large) <italic>L</italic>
                  <sub>1</sub> norm, hence a small (resp. large) effective <italic>L</italic>
                  <sub>1</sub> regularization strength; which in turn further relaxes or tightens the sparsity constraint. The <italic>L</italic>
                  <sub>2</sub> filter norm constraint is necessary to ensure a well-defined optimization problem because of the downstream batch norm layers. Indeed, the operation <inline-formula>
                     <mml:math id="M19">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>g</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                           </mml:msubsup>
                           <mml:mo>→</mml:mo>
                           <mml:msub>
                              <mml:mi>ρ</mml:mi>
                              <mml:mi>m</mml:mi>
                           </mml:msub>
                           <mml:msubsup>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>g</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> leaves the final output invariant, as it is exactly compensated by the covariation of the slope od the subsequent batch normlayer through <inline-formula>
                     <mml:math id="M20">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mi>α</mml:mi>
                              <mml:mi>m</mml:mi>
                           </mml:msub>
                           <mml:mo>→</mml:mo>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:msub>
                                    <mml:mi>α</mml:mi>
                                    <mml:mi>m</mml:mi>
                                 </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:msub>
                                    <mml:mi>ρ</mml:mi>
                                    <mml:mi>m</mml:mi>
                                 </mml:msub>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> (using notations from [<xref ref-type="bibr" rid="R47">74</xref>]). Therefore, without constraion the optimum would be the asymptote <inline-formula>
                     <mml:math id="M21">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>g</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                           </mml:msubsup>
                           <mml:mo>→</mml:mo>
                           <mml:mn>0</mml:mn>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>,<inline-formula>
                     <mml:math id="M22">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mi>α</mml:mi>
                              <mml:mi>m</mml:mi>
                           </mml:msub>
                           <mml:mo>→</mml:mo>
                           <mml:mi>∞</mml:mi>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> with <inline-formula>
                     <mml:math id="M23">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>g</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                           </mml:msubsup>
                           <mml:mo>×</mml:mo>
                           <mml:msub>
                              <mml:mi>α</mml:mi>
                              <mml:mi>m</mml:mi>
                           </mml:msub>
                           <mml:mo>=</mml:mo>
                           <mml:msubsup>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>g</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mn>1</mml:mn>
                                 <mml:mo>⋆</mml:mo>
                              </mml:mrow>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, the optimum weight value without any regularization. The norm value is chosen such that the filter output <italic>y</italic>
                  <sub>
                     <italic>m</italic>
                  </sub> (Eqn. 4) has roughly variance 1 when the attributes have variance 1.</p>
               <p id="P54">To determine the value of the regularization penalty <inline-formula>
                     <mml:math id="M24">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>λ</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, we searched for a satisfying compromise between interpretability (localized filters) and classification performance. We first determined the order of magnitude of <inline-formula>
                     <mml:math id="M25">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>λ</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> as follows: assuming filters weights <italic>W</italic>
                  <sup>1</sup> with sparse entries (a fraction <italic>p</italic> of non-zero weight, with typical weight value <italic>W</italic>), the <italic>L</italic>
                  <sub>2</sub> norm writes <inline-formula>
                     <mml:math id="M26">
                        <mml:mrow>
                           <mml:mo>∥</mml:mo>
                           <mml:mi>W</mml:mi>
                           <mml:msub>
                              <mml:mo>∥</mml:mo>
                              <mml:mn>2</mml:mn>
                           </mml:msub>
                           <mml:mo>=</mml:mo>
                           <mml:msqrt>
                              <mml:mrow>
                                 <mml:mi>p</mml:mi>
                                 <mml:mi>G</mml:mi>
                                 <mml:mi>N</mml:mi>
                              </mml:mrow>
                           </mml:msqrt>
                           <mml:mi>W</mml:mi>
                           <mml:mo>≡</mml:mo>
                           <mml:msqrt>
                              <mml:mrow>
                                 <mml:mi>G</mml:mi>
                                 <mml:mo>/</mml:mo>
                                 <mml:mi>K</mml:mi>
                              </mml:mrow>
                           </mml:msqrt>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>, <italic>i</italic>.<italic>e</italic>. <inline-formula>
                     <mml:math id="M27">
                        <mml:mrow>
                           <mml:mi>W</mml:mi>
                           <mml:mo>∼</mml:mo>
                           <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mrow>
                                 <mml:msqrt>
                                    <mml:mrow>
                                       <mml:mi>K</mml:mi>
                                       <mml:mi>N</mml:mi>
                                       <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                 </mml:msqrt>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> and <inline-formula>
                     <mml:math id="M28">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>ℛ</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                           <mml:mo>∼</mml:mo>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:mi>λ</mml:mi>
                                 <mml:mi>p</mml:mi>
                                 <mml:mi>G</mml:mi>
                                 <mml:mi>M</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mn>2</mml:mn>
                                 <mml:mi>K</mml:mi>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>. Further assuming that the regularization penalties and cross-entropy variations (about 10<sup>–2</sup> per site in our experiments) should approximately balance each other, and with <italic>G</italic>/<italic>K</italic> = 2, <italic>M</italic> = 128 for both atomic and amino acid filters, we find that λ ⁓ 10<sup>–2</sup>/<italic>pM</italic>. With a target <italic>p</italic> ⁓ 10<sup>–2</sup>, we conclude that <inline-formula>
                     <mml:math id="M29">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>λ</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                           <mml:mo>∼</mml:mo>
                           <mml:msup>
                              <mml:mrow>
                                 <mml:mn>10</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mo>−</mml:mo>
                                 <mml:mn>2</mml:mn>
                              </mml:mrow>
                           </mml:msup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula>. After experimentation, we chose <inline-formula>
                     <mml:math id="M30">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>λ</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                           </mml:msubsup>
                           <mml:mo>=</mml:mo>
                           <mml:msup>
                              <mml:mrow>
                                 <mml:mn>2.10</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mo>−</mml:mo>
                                 <mml:mn>3</mml:mn>
                              </mml:mrow>
                           </mml:msup>
                        </mml:mrow>
                     </mml:math>
                  </inline-formula> for both atomic and amino acid filters, as this value yielded the most satisfactory filter visualizations and prediction performances.</p>
               <p id="P55">
                  <bold>Atomic to Amino Acid Pooling</bold> Towards calculation of residue-wise outputs, the learnt atomic scale representation must be aggregated at the amino acid scale. We recall that the constituting atoms of an amino acid may play different functional roles, hence symmetric pooling operations may not be sufficiently expressive. ScanNet instead employs a trainable multi-headed attention pooling. It writes:
<disp-formula id="FD7">
                     <label>(7)</label>
                     <mml:math id="M31">
                        <mml:mrow>
                           <mml:msubsup>
                              <mml:mi>y</mml:mi>
                              <mml:mi>m</mml:mi>
                              <mml:mrow>
                                 <mml:mtext>amino acid </mml:mtext>
                              </mml:mrow>
                           </mml:msubsup>
                           <mml:mo>=</mml:mo>
                           <mml:munder>
                              <mml:mrow>
                                 <mml:msup>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mstyle mathsize="140%" displaystyle="true">
                                             <mml:mo>∑</mml:mo>
                                          </mml:mstyle>
                                          <mml:mtext>​</mml:mtext>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mtext>​</mml:mtext>
                                 </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mtext>atom </mml:mtext>
                                 <mml:mo>,</mml:mo>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                           </mml:munder>
                           <mml:msub>
                              <mml:mi>P</mml:mi>
                              <mml:mrow>
                                 <mml:mi>m</mml:mi>
                                 <mml:mi>n</mml:mi>
                              </mml:mrow>
                           </mml:msub>
                           <mml:msubsup>
                              <mml:mi>y</mml:mi>
                              <mml:mi>n</mml:mi>
                              <mml:mrow>
                                 <mml:mtext>atom </mml:mtext>
                              </mml:mrow>
                           </mml:msubsup>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:mi>exp</mml:mi>
                                 <mml:mrow>
                                    <mml:mo>[</mml:mo>
                                    <mml:mrow>
                                       <mml:munder>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mstyle mathsize="140%" displaystyle="true">
                                                         <mml:mo>∑</mml:mo>
                                                      </mml:mstyle>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mi>n</mml:mi>
                                       </mml:munder>
                                       <mml:msub>
                                          <mml:mi>A</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>m</mml:mi>
                                             <mml:mi>n</mml:mi>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:msubsup>
                                          <mml:mi>y</mml:mi>
                                          <mml:mi>n</mml:mi>
                                          <mml:mrow>
                                             <mml:mtext>atom </mml:mtext>
                                          </mml:mrow>
                                       </mml:msubsup>
                                    </mml:mrow>
                                    <mml:mo>]</mml:mo>
                                 </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:munder>
                                    <mml:mrow>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mstyle mathsize="140%" displaystyle="true">
                                                   <mml:mo>∑</mml:mo>
                                                </mml:mstyle>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mtext>​</mml:mtext>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mtext>atom </mml:mtext>
                                    </mml:mrow>
                                 </mml:munder>
                                 <mml:mi>exp</mml:mi>
                                 <mml:mrow>
                                    <mml:mo>[</mml:mo>
                                    <mml:mrow>
                                       <mml:munder>
                                          <mml:mrow>
                                             <mml:msup>
                                                <mml:mrow>
                                                   <mml:msup>
                                                      <mml:mstyle mathsize="140%" displaystyle="true">
                                                         <mml:mo>∑</mml:mo>
                                                      </mml:mstyle>
                                                      <mml:mtext>​</mml:mtext>
                                                   </mml:msup>
                                                </mml:mrow>
                                                <mml:mtext>​</mml:mtext>
                                             </mml:msup>
                                          </mml:mrow>
                                          <mml:mi>n</mml:mi>
                                       </mml:munder>
                                       <mml:msub>
                                          <mml:mi>A</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>m</mml:mi>
                                             <mml:mi>n</mml:mi>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:msubsup>
                                          <mml:mi>y</mml:mi>
                                          <mml:mi>n</mml:mi>
                                          <mml:mrow>
                                             <mml:mtext>atom </mml:mtext>
                                          </mml:mrow>
                                       </mml:msubsup>
                                    </mml:mrow>
                                    <mml:mo>]</mml:mo>
                                 </mml:mrow>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P56">Where <bold>P</bold>, <bold>A</bold> are trainable projection and attention weighting) matrices. Eqn. <xref ref-type="disp-formula" rid="FD7">7</xref> generalizes the average pooling (<italic>A</italic>
                  <sub>
                     <italic>m</italic>,.</sub> = 0) and maximum pooling (<italic>A</italic>
                  <sub>
                     <italic>m</italic>,.</sub> = <italic>αP</italic>
                  <sub>
                     <italic>m</italic>
                  </sub>. with large <italic>α</italic>) operations. A sparsity regularization is also employed for both <bold>P</bold>, <bold>A</bold> to simplify correspondence between atomic and amino acid filters.</p>
               <p id="P57">
                  <bold>Neighborhood Attention Module</bold> (NAM) computes spatially coherent, residue-wise output probabilities from amino acid frames and spatio-chemical filter activities. The computation is done in four stages, see <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S2</xref>. First, local amino acid scale neighborhoods of size <italic>K</italic> = 32 are constructed, with graph-type local coordinates: distances, angles and sequence distances (see <xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S1(c)</xref> ). Second, the five-dimensional edges are projected element-wise into a single algebraic value using trainable Gaussian kernels followed by a dense layer with linear activation function. No bias is used for the dense layer, such that the edge value decays to zero as the distance increases. Third, the filter activities are projected to scalar values and locally averaged using attention-based weights. Our expression of the weighting coefficients slightly differs from the graph attention network formulation of [<xref ref-type="bibr" rid="R41">41</xref>] as follows: each node is characterized by a trainable output feature (unnormalized binding site probability), self-attention (”passenger” residues should have weak self-attention), cross-attention (hotspots should have strong cross-attention) and contrast coefficients (residues can follow either the majority or the hotspot residue). The weights may also take negative values depending on the edge values. Finally, a logistic function is applied to obtain normalized probabilities. Intuitively, the purpose of the NAM is to smooth out the probabilities such that if a residue has high binding propensity, its solvent-exposed neighbors should too. To this end, the NAM learns i) a diffusion kernel on the residue-residue graph (the algebraic edges) and ii) importance coefficients for each node.</p>
            </sec>
            <sec id="S12">
               <label>3</label>
               <title>Full architecture</title>
               <p id="P58">A diagram showing the architecture of the network is drawn in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S3</xref>, and a table listing each module with its input(s) and output(s) sizes and comments is provided as Supplementary Data. In total, the network contains 475K parameters, of which about 200K are non-zero.</p>
            </sec>
            <sec id="S13">
               <label>4</label>
               <title>Training</title>
               <p id="P59">
                  <bold>Initialization</bold> For the neighborhood embedding modules, the gaussian kernels were initialized by unsupervised learning; using a subset of the training set, we computed atomic and amino acid neighborhoods, and fitted the spatial point density using a Gaussian Mixture Model (as implemented in Scikit-learn [<xref ref-type="bibr" rid="R75">75</xref>], best of 10 runs with Kmeans++ initialization, full covariance matrix and 10<sup>–1</sup> covariance matrix regularization). For the trainable graph edges of the Neighborhood Attention module computed from distances and angles, we initialized them as a least square parametric fit of the label autocorrelation function (normalized):
<disp-formula id="FD8">
                     <label>(8)</label>
                     <mml:math id="M32">
                        <mml:mrow>
                           <mml:mi>A</mml:mi>
                           <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                 <mml:mtext>distance </mml:mtext>
                                 <mml:mo>,</mml:mo>
                                 <mml:mtext> angles </mml:mtext>
                                 <mml:mo>,</mml:mo>
                                 <mml:mo>…</mml:mo>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                           </mml:mrow>
                           <mml:mo>=</mml:mo>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                       <mml:mi mathvariant="double-struck">E</mml:mi>
                                       <mml:mrow>
                                          <mml:mo>[</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mi>Y</mml:mi>
                                                <mml:mi>i</mml:mi>
                                             </mml:msub>
                                             <mml:msub>
                                                <mml:mi>Y</mml:mi>
                                                <mml:mi>j</mml:mi>
                                             </mml:msub>
                                             <mml:mo>∣</mml:mo>
                                             <mml:msub>
                                                <mml:mi>d</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>i</mml:mi>
                                                   <mml:mi>j</mml:mi>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>=</mml:mo>
                                             <mml:mtext> </mml:mtext>
                                             <mml:mi>d</mml:mi>
                                             <mml:mi>i</mml:mi>
                                             <mml:mi>s</mml:mi>
                                             <mml:mi>t</mml:mi>
                                             <mml:mi>a</mml:mi>
                                             <mml:mi>n</mml:mi>
                                             <mml:mi>c</mml:mi>
                                             <mml:mi>e</mml:mi>
                                             <mml:mo> </mml:mo>
                                             <mml:mo>,</mml:mo>
                                             <mml:mo>…</mml:mo>
                                          </mml:mrow>
                                          <mml:mo>]</mml:mo>
                                       </mml:mrow>
                                       <mml:mo>−</mml:mo>
                                       <mml:mi mathvariant="double-struck">E</mml:mi>
                                       <mml:msup>
                                          <mml:mrow>
                                             <mml:mrow>
                                                <mml:mo>[</mml:mo>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mi>Y</mml:mi>
                                                      <mml:mi>i</mml:mi>
                                                   </mml:msub>
                                                </mml:mrow>
                                                <mml:mo>]</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                       </mml:msup>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                 </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mi mathvariant="double-struck">E</mml:mi>
                                 <mml:mrow>
                                    <mml:mo>[</mml:mo>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>Y</mml:mi>
                                          <mml:mi>i</mml:mi>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>]</mml:mo>
                                 </mml:mrow>
                                 <mml:mo>−</mml:mo>
                                 <mml:mi mathvariant="double-struck">E</mml:mi>
                                 <mml:msup>
                                    <mml:mrow>
                                       <mml:mrow>
                                          <mml:mo>[</mml:mo>
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mi>Y</mml:mi>
                                                <mml:mi>i</mml:mi>
                                             </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>]</mml:mo>
                                       </mml:mrow>
                                    </mml:mrow>
                                    <mml:mn>2</mml:mn>
                                 </mml:msup>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P60">Intuitively, this initialization choice corresponds to a diffusion kernel over the residue-residue graph. All remaining weights are initialized using symmetric random distributions, see details in supporting table.</p>
               <p id="P61">
                  <bold>Padding and protein serialization trick</bold> In our implementation, ScanNet takes as input an entire protein and computes neighborhoods on-the-fly, akin to a fully convolutional segmentation network [<xref ref-type="bibr" rid="R76">76</xref>]. Training on GPUs requires fixed size inputs but the lengths of proteins varied by almost two orders of magnitude in our dataset (see <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S4 (e)</xref> ). To avoid truncating large proteins or wasting most of the computational power, we used the following protein serialization trick. We choose a relatively large maximal protein length (<italic>L</italic>
                  <sub>max</sub> = 1024, 2120 for the PPBS and BCE datasets), concatenate several proteins into a single example and translate each protein far away from the others, such that no two proteins overlap in space. Since ScanNet exploits only local neighborhoods, the predictions for each protein are fully independent from one another. Before training or prediction, we group proteins in a greedy fashion that minimizes the unused placeholders. Proteins are first sorted by length and the largest ones are first picked; then, we pick among the remaining proteins the largest that fits into the placeholder (if any), concatenate it, and continue until the placeholder is full. For the PPBS dataset, we found that about 96% of the amino acids placeholders were used, as opposed to less than 25% with naive padding. This results in a speed-up of about 4-fold. Finally, we used masking layers across the network to prevent backpropagating errors for the remaining placeholders that do not contain any residue.</p>
               <p id="P62">
                  <bold>Optimization</bold> The network is trained by minimizing the binary cross-entropy loss function by backpropagation using the ADAM optimizer [<xref ref-type="bibr" rid="R77">77</xref>]. We set the maximum number of epochs to 100, the batch size to 1, the learning rate to 10<sup>–3</sup> (10<sup>–4</sup> for the transfer learning) and perform learning rate annealing and early stopping based on the validation cross-entropy; the optimal model was usually reached before 10 epochs. We used batch normalization layers before each ReLU non-linearity throughout the network to avoid vanishing gradients. Finally, regarding sample weighting, a complication of the protein serialization trick is that residues of a single example may have different sample weight as they come from different proteins. To account for this, we formally replaced the binary cross-entropy loss function and logistic non-linearity with a categorical cross-entropy and softmax function with two output classes; training labels are multiplied by their weight so as to replicate the weighted loss function.</p>
               <p id="P63">
                  <bold>Software and runtime</bold> The network was implemented using Tensorflow v1.14.0 [<xref ref-type="bibr" rid="R78">78</xref>] and Keras v2.2.5 [<xref ref-type="bibr" rid="R79">79</xref>]. Training was completed in about one to two hours using a single Nvidia V100 GPU. The inference time is dominated by the construction of the MSA and the calculation of the Position Weight Matrix - it is of the order of one to few minutes depending on sequence length and MSA depth.</p>
            </sec>
         </sec>
         <sec id="S14">
            <label>B</label>
            <title>Baseline Methods</title>
            <sec id="S15">
               <label>1</label>
               <title>Handcrafted features baseline</title>
               <p id="P64">For the handcrafted features baseline, we computed for each amino acid geometric, chemical and evolutionary features as described in recent works on prediction of protein-protein / protein-antibody binding sites [<xref ref-type="bibr" rid="R12">12</xref>–<xref ref-type="bibr" rid="R18">18</xref>]. The following features were computed:</p>
               <list list-type="bullet" id="L2">
                  <list-item>
                     <p id="P65">Amino acid type (one-hot encoded, 20 dim.).</p>
                  </list-item>
                  <list-item>
                     <p id="P66">Secondary structure type (one-hot encoded, 8 dim.); computed with DSSP [<xref ref-type="bibr" rid="R61">61</xref>].</p>
                  </list-item>
                  <list-item>
                     <p id="P67">Relative Accessible Surface Area (1 dim.); computed with DSSP [<xref ref-type="bibr" rid="R61">61</xref>].</p>
                  </list-item>
                  <list-item>
                     <p id="P68">Coordination Number (1 dim.), defined as the number of <italic>C</italic>
                        <sub>
                           <italic>α</italic>
                        </sub> atoms in a ball of radius 13 center around the <italic>C</italic>
                        <sub>
                           <italic>α</italic>
                        </sub> atom of the amino acid.</p>
                  </list-item>
                  <list-item>
                     <p id="P69">Half Sphere Exposure Index [<xref ref-type="bibr" rid="R80">80</xref>] (1 dim.), defined as follows: let <italic>N</italic>
                        <sub>1</sub> be the coordination number, and <italic>N</italic>
                        <sub>2</sub> the number of <italic>C</italic>
                        <sub>
                           <italic>α</italic>
                        </sub> atoms in the intersection of a ball of radius 13 center and above the plane defined by the <italic>C</italic>
                        <sub>
                           <italic>α</italic>
                        </sub> – <italic>C</italic>
                        <sub>
                           <italic>β</italic>
                        </sub> vector. The half sphere exposure index is <inline-formula>
                           <mml:math id="M33">
                              <mml:mrow>
                                 <mml:mfrac>
                                    <mml:mrow>
                                       <mml:mn>2</mml:mn>
                                       <mml:msub>
                                          <mml:mi>N</mml:mi>
                                          <mml:mn>2</mml:mn>
                                       </mml:msub>
                                       <mml:mo>−</mml:mo>
                                       <mml:msub>
                                          <mml:mi>N</mml:mi>
                                          <mml:mn>1</mml:mn>
                                       </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                       <mml:mi>N</mml:mi>
                                       <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                 </mml:mfrac>
                                 <mml:mo>∈</mml:mo>
                                 <mml:mo stretchy="false">[</mml:mo>
                                 <mml:mo>−</mml:mo>
                                 <mml:mn>1</mml:mn>
                                 <mml:mo>,</mml:mo>
                                 <mml:mn>1</mml:mn>
                                 <mml:mo stretchy="false">]</mml:mo>
                              </mml:mrow>
                           </mml:math>
                        </inline-formula>.</p>
                  </list-item>
                  <list-item>
                     <p id="P70">Backbone and Sidechain Depth [<xref ref-type="bibr" rid="R81">81</xref>] (2 dim.). The molecular surface was computed using MSMS (probe radius 1.5Å) [<xref ref-type="bibr" rid="R82">82</xref>], and the distance to the surface was computed and averaged for all backbone (resp. sidechain) atoms.</p>
                  </list-item>
                  <list-item>
                     <p id="P71">Surface convexity index (3 dim.) [<xref ref-type="bibr" rid="R83">83</xref>]. For each atom, we construct a ball of radius 5/8/11 Åcentered on it, and compute the <italic>f</italic> fraction of its volume located on the inside of molecular surface; the index is given by 2<italic>f</italic> – 1 ∈ [–1, –1]. The surface convexity index is averaged at amino acid level.</p>
                  </list-item>
                  <list-item>
                     <p id="P72">Position Weight Matrix (PWM, 21 dim.)</p>
                  </list-item>
                  <list-item>
                     <p id="P73">Conservation score <italic>C</italic> = log 21 + Σ<sub>
                           <italic>a</italic>
                        </sub> log <italic>PWM</italic>(<italic>a</italic>) (1 dim.).</p>
                  </list-item>
               </list>
               <p id="P74">In total, 58 features are used. For classification, we used the xgboost algorithm (boosted trees) [<xref ref-type="bibr" rid="R46">46</xref>]. The classifier was trained by cross-entropy minimization, using the same training and validation sets. We used 100 boosting rounds (with early stopping on validation loss), and the following four parameters were determined by grid search: tree depth (5,10,20), minimum child weight (5,10,50,100), <italic>γ</italic> (0.01,0.1,1.0,5.), <italic>η</italic> (0.5, 1.0).</p>
            </sec>
            <sec id="S16">
               <label>2</label>
               <title>Structural homology baseline</title>
               <p id="P75">Several approaches leveraging sequence and structure homology were previously developed [<xref ref-type="bibr" rid="R5">5</xref>–<xref ref-type="bibr" rid="R11">11</xref>], but were not readily available for large scale benchmarking, which prompted us to develop an in-house structural homology baseline method. It features three key components:</p>
               <list list-type="order" id="L3">
                  <list-item>
                     <p id="P76">A non-redundant database of template protein chains with known binding sites. We used here as template the training set of ScanNet for a fair comparison. The template database was further clustered at the 90% (resp. 95%) sequence identity for the PPBS and BCE datasets, for speed gain purposes and to simplify alignment weighting, see below.</p>
                  </list-item>
                  <list-item>
                     <p id="P77">A local pairwise structure comparison engine. Compared to sequence homology or global structural homology, local structural homology were shown to outperform other methods in terms of coverage [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R10">10</xref>]. Here, we used MultiProt [<xref ref-type="bibr" rid="R47">47</xref>], an algorithm we previously developed which, given two proteins, outputs a set of local structural alignments.</p>
                  </list-item>
                  <list-item>
                     <p id="P78">An alignment weighting scheme. Typically, MultiProt always finds at least few local alignments even when there is no homology between a query and a template protein, albeit with low coverage and low sequence identity. The alignments hence must be weighted so as to give higher importance to the most significant alignments [<xref ref-type="bibr" rid="R11">11</xref>]. Formally, for a given query protein with length <italic>L</italic>, MultiProt produces a set of <italic>R</italic> local alignments <italic>𝓐</italic>
                        <sub>
                           <italic>r</italic>
                        </sub>, <italic>r</italic> ∈ [1, <italic>R</italic>]. Each alignment is characterized by:
<list list-type="simple" id="L4">
                           <list-item>
                              <label>•</label>
                              <p id="P79">The list of query residues included in the alignment, encoded as a binary vector:
<disp-formula id="FD9">
                                    <label>(9)</label>
                                    <mml:math id="M34">
                                       <mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>{</mml:mo>
                                             <mml:mrow>
                                                <mml:mtable columnalign="left">
                                                   <mml:mtr columnalign="left">
                                                      <mml:mtd columnalign="left">
                                                         <mml:mrow>
                                                            <mml:msub>
                                                               <mml:mi>a</mml:mi>
                                                               <mml:mrow>
                                                                  <mml:mi>r</mml:mi>
                                                                  <mml:mo>,</mml:mo>
                                                                  <mml:mi>l</mml:mi>
                                                               </mml:mrow>
                                                            </mml:msub>
                                                            <mml:mo>=</mml:mo>
                                                            <mml:mn>1</mml:mn>
                                                            <mml:mtext> if residue </mml:mtext>
                                                            <mml:mi>l</mml:mi>
                                                            <mml:mo>∈</mml:mo>
                                                            <mml:mo stretchy="false">[</mml:mo>
                                                            <mml:mn>1</mml:mn>
                                                            <mml:mo>,</mml:mo>
                                                            <mml:mi>L</mml:mi>
                                                            <mml:mo stretchy="false">]</mml:mo>
                                                            <mml:mtext> in local alignment </mml:mtext>
                                                            <mml:msub>
                                                               <mml:mi mathvariant="script">A</mml:mi>
                                                               <mml:mi>r</mml:mi>
                                                            </mml:msub>
                                                         </mml:mrow>
                                                      </mml:mtd>
                                                   </mml:mtr>
                                                   <mml:mtr columnalign="left">
                                                      <mml:mtd columnalign="left">
                                                         <mml:mrow>
                                                            <mml:msub>
                                                               <mml:mi>a</mml:mi>
                                                               <mml:mrow>
                                                                  <mml:mi>r</mml:mi>
                                                                  <mml:mo>,</mml:mo>
                                                                  <mml:mi>l</mml:mi>
                                                               </mml:mrow>
                                                            </mml:msub>
                                                            <mml:mo>=</mml:mo>
                                                            <mml:mspace width="0.2em"/>
                                                            <mml:mn>0</mml:mn>
                                                            <mml:mspace width="0.2em"/>
                                                            <mml:mspace width="0.2em"/>
                                                            <mml:mtext>otherwise</mml:mtext>
                                                         </mml:mrow>
                                                      </mml:mtd>
                                                   </mml:mtr>
                                                </mml:mtable>
                                             </mml:mrow>
                                          </mml:mrow>
                                       </mml:mrow>
                                    </mml:math>
                                 </disp-formula>
                              </p>
                           </list-item>
                           <list-item>
                              <label>•</label>
                              <p id="P80">The coverage of the local alignment: Coverage<sub>
                                    <italic>r</italic>
                                 </sub> = <inline-formula>
                                    <mml:math id="M35">
                                       <mml:mrow>
                                          <mml:mfrac>
                                             <mml:mn>1</mml:mn>
                                             <mml:mi>L</mml:mi>
                                          </mml:mfrac>
                                          <mml:munder>
                                             <mml:mstyle mathsize="140%" displaystyle="true">
                                                <mml:mo>∑</mml:mo>
                                             </mml:mstyle>
                                             <mml:mi>l</mml:mi>
                                          </mml:munder>
                                          <mml:msub>
                                             <mml:mi>a</mml:mi>
                                             <mml:mrow>
                                                <mml:mi>r</mml:mi>
                                                <mml:mo>,</mml:mo>
                                                <mml:mi>l</mml:mi>
                                             </mml:mrow>
                                          </mml:msub>
                                       </mml:mrow>
                                    </mml:math>
                                 </inline-formula>
                              </p>
                           </list-item>
                           <list-item>
                              <label>•</label>
                              <p id="P81">The average root mean square deviation between matching pairs of <italic>C</italic>
                                 <sub>
                                    <italic>α</italic>
                                 </sub> atoms RMSD<sub>
                                    <italic>r</italic>
                                 </sub>
                              </p>
                           </list-item>
                           <list-item>
                              <label>•</label>
                              <p id="P82">The average sequence identity between query and template residues of the local alignment SeqID<sub>r</sub>
                              </p>
                           </list-item>
                        </list>
                     </p>
                  </list-item>
               </list>
               <p id="P83">Combining the alignment and the corresponding binding site labels of the templates, we define the following label alignment matrix:
<disp-formula id="FD10">
                     <label>(10)</label>
                     <mml:math id="M36">
                        <mml:mrow>
                           <mml:mrow>
                              <mml:mo>{</mml:mo>
                              <mml:mrow>
                                 <mml:mtable columnalign="left">
                                    <mml:mtr columnalign="left">
                                       <mml:mtd columnalign="left">
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mi>y</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>r</mml:mi>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:mi>l</mml:mi>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>=</mml:mo>
                                             <mml:mn>1</mml:mn>
                                             <mml:mtext> </mml:mtext>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mtext>if </mml:mtext>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:msub>
                                                <mml:mi>a</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>r</mml:mi>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:mi>l</mml:mi>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>=</mml:mo>
                                             <mml:mn>1</mml:mn>
                                             <mml:mtext> and label of aligned template residue </mml:mtext>
                                             <mml:mo>=</mml:mo>
                                             <mml:mn>1</mml:mn>
                                          </mml:mrow>
                                       </mml:mtd>
                                    </mml:mtr>
                                    <mml:mtr columnalign="left">
                                       <mml:mtd columnalign="left">
                                          <mml:mrow>
                                             <mml:msub>
                                                <mml:mi>y</mml:mi>
                                                <mml:mrow>
                                                   <mml:mi>r</mml:mi>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:mi>l</mml:mi>
                                                </mml:mrow>
                                             </mml:msub>
                                             <mml:mo>=</mml:mo>
                                             <mml:mn>0</mml:mn>
                                             <mml:mtext> </mml:mtext>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mspace width="0.2em"/>
                                             <mml:mtext>otherwise </mml:mtext>
                                          </mml:mrow>
                                       </mml:mtd>
                                    </mml:mtr>
                                 </mml:mtable>
                              </mml:mrow>
                           </mml:mrow>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P84">and write predicted binding site probability as:
<disp-formula id="FD11">
                     <label>(11)</label>
                     <mml:math id="M37">
                        <mml:mrow>
                           <mml:msub>
                              <mml:mi>P</mml:mi>
                              <mml:mi>l</mml:mi>
                           </mml:msub>
                           <mml:mo>=</mml:mo>
                           <mml:mfrac>
                              <mml:mrow>
                                 <mml:msub>
                                    <mml:mi>P</mml:mi>
                                    <mml:mn>0</mml:mn>
                                 </mml:msub>
                                 <mml:mo>+</mml:mo>
                                 <mml:mstyle displaystyle="true">
                                    <mml:msubsup>
                                       <mml:mo>∑</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                          <mml:mo>=</mml:mo>
                                          <mml:mn>1</mml:mn>
                                       </mml:mrow>
                                       <mml:mi>R</mml:mi>
                                    </mml:msubsup>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>a</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>r</mml:mi>
                                             <mml:mo>,</mml:mo>
                                             <mml:mi>l</mml:mi>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:msub>
                                          <mml:mi>y</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>r</mml:mi>
                                             <mml:mo>,</mml:mo>
                                             <mml:mi>l</mml:mi>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:msup>
                                          <mml:mi>e</mml:mi>
                                          <mml:mrow>
                                             <mml:mi mathvariant="script">W</mml:mi>
                                             <mml:mrow>
                                                <mml:mo>(</mml:mo>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext> Coverage </mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext> SeqID </mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext> RMSD </mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                </mml:mrow>
                                                <mml:mo>)</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                       </mml:msup>
                                    </mml:mrow>
                                 </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                 <mml:mn>1</mml:mn>
                                 <mml:mo>+</mml:mo>
                                 <mml:mstyle displaystyle="true">
                                    <mml:msubsup>
                                       <mml:mo>∑</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                          <mml:mo>=</mml:mo>
                                          <mml:mn>1</mml:mn>
                                       </mml:mrow>
                                       <mml:mi>R</mml:mi>
                                    </mml:msubsup>
                                    <mml:mrow>
                                       <mml:msub>
                                          <mml:mi>a</mml:mi>
                                          <mml:mrow>
                                             <mml:mi>r</mml:mi>
                                             <mml:mo>,</mml:mo>
                                             <mml:mi>l</mml:mi>
                                          </mml:mrow>
                                       </mml:msub>
                                       <mml:msup>
                                          <mml:mi>e</mml:mi>
                                          <mml:mrow>
                                             <mml:mi mathvariant="script">W</mml:mi>
                                             <mml:mrow>
                                                <mml:mo>(</mml:mo>
                                                <mml:mrow>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext> Coverage </mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext> SeqID </mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                   <mml:mo>,</mml:mo>
                                                   <mml:msub>
                                                      <mml:mrow>
                                                         <mml:mtext>RMSD</mml:mtext>
                                                      </mml:mrow>
                                                      <mml:mi>r</mml:mi>
                                                   </mml:msub>
                                                </mml:mrow>
                                                <mml:mo>)</mml:mo>
                                             </mml:mrow>
                                          </mml:mrow>
                                       </mml:msup>
                                    </mml:mrow>
                                 </mml:mstyle>
                              </mml:mrow>
                           </mml:mfrac>
                        </mml:mrow>
                     </mml:math>
                  </disp-formula>
               </p>
               <p id="P85">Where <italic>𝓦</italic>(Coverage, SeqID,RMSD) is a trainable log-weight function and <italic>P</italic>
                  <sub>0</sub> is a pseudo-count regularization term, such that <italic>P</italic>
                  <sub>
                     <italic>l</italic>
                  </sub> = <italic>P</italic>
                  <sub>0</sub> if no alignment is found for a given residue. The log-weight function <italic>𝓦</italic> is parameterized by a two-layer perceptron with 20 hidden nodes and hyperbolic tangent activation function and was trained by cross-entropy minimization on a subset of the validation set; after training, we found that <italic>𝓦</italic> is a increasing function of both alignment coverage and sequence identity, in agreement with our intuition that high coverage/sequence identity alignments should be favored. For <italic>P</italic>
                  <sub>0</sub>, we use the fraction of interface residues in the train set (resp. 0.22 and 0.09 for the PPBS and BCE train sets). Note that since the labels are already defined using multiple pdb files and redundancy reduction on templates was employed, there is no need to further reweight alignments by ligand diversity as described in [<xref ref-type="bibr" rid="R11">11</xref>].</p>
               <p id="P86">As expected, the baseline performed very well when high quality homologs were available, and underperformed otherwise.</p>
            </sec>
            <sec id="S17">
               <label>3</label>
               <title>Masif-site</title>
               <p id="P87">We used the Docker image of Masif-site as made available at <ext-link ext-link-type="uri" xlink:href="https://github.com/LPDI-EPFL/masif">https://github.com/LPDI-EPFL/masif</ext-link>. Masif-site predicts binding site propensity at the surface vertex level. To aggregate at the amino acid level, we followed the aggregation scheme provided for the Masif vs Sppider comparison (<ext-link ext-link-type="uri" xlink:href="https://github.com/LPDI-EPFL/masif/blob/master/comparison/masif_site/masif_vs_sppider/masif_sppider_Intpred_comp.ipynb">https://github.com/LPDI-EPFL/masif/blob/master/comparison/masif_site/masif_vs_sppider/masif_sppider_Intpred_comp.ipynb</ext-link>): each surface vertex is first assigned to its closest atom and corresponding amino acid and the binding site probability of an amino acid is taken as the maximum binding site probability over all its corresponding vertices. We stress that the comparison with Masif-site should be interpreted with caution, as:(i) Masif-site predicts at surface vertex level rather than amino acid level. Its residue-wise probabilities are therefore not calibrated, resulting in bad likelihood scores (see <xref ref-type="supplementary-material" rid="SD4">Sup. Table S2</xref>). (ii) We did not retrain Masif-site owing to limited computational resources and ts training set used was smaller than ours (iii) Our test set overlaps with Masif-site training set, hence Masif-site should overperform on a fraction of our test set.</p>
            </sec>
            <sec id="S18">
               <label>4</label>
               <title>Discotope</title>
               <p id="P88">We used the Discotope version 1.1 as made available at <ext-link ext-link-type="uri" xlink:href="https://services.healthtech.dtu.dk/software.php">https://services.healthtech.dtu.dk/software.php</ext-link>. To emulate the behavior of Discotope version 2.0, which processes entire protein assemblies rather than individual protein chains [<xref ref-type="bibr" rid="R51">51</xref>], we fused each multi-chain antigens into a single chain, and verified on a few examples that the outputs were consistent with the ones from the Discotope 2.0 webserver.</p>
            </sec>
         </sec>
         <sec id="S19">
            <label>C</label>
            <title>Data preparation</title>
            <p id="P89">
               <bold>Initial database and filtering</bold> We use the Dockground database of protein-protein interfaces [<xref ref-type="bibr" rid="R45">45</xref>] (Jan. 2020 full redundant version) as a starting point for our Protein-Protein Binding Sites (PPBS) database. Each unique PDB chain involved in one interface or more was considered as a single example; we excluded chains with sequence length less than 10, chains involved in a protein-antibody complex (as classified in the SabDab database [<xref ref-type="bibr" rid="R50">50</xref>]), or designed proteins (identified as having two or more of the following red flags: no Uniprot ID, no known CATH class, no sequence homologs found, and engineered/synthetic/designed/de novo appearing in chain name). We obtained 70583 unique chains (grouped in 20025 clusters at 95% sequence identity) from 41466 distinct PDB files, involved in 240506 PPIs.</p>
            <p id="P90">The dataset covers a wide range of complex sizes, types, organism taxonomies, protein lengths (<xref ref-type="supplementary-material" rid="SD4">Fig.S4 (a)-(d)</xref>). For the B-cell epitopes database, we used the SabDab database (timestamp: 04/19/2021 [<xref ref-type="bibr" rid="R50">50</xref>]) and included all antigens with length 10 or more forming an interface with an antibody with both heavy and light chain appearing in the PDB files. We obtained 3756 chains (grouped in 796 clusters at 95% sequence identity).</p>
            <p id="P91">
               <bold>Data partition</bold> For the PPBS database, we investigated the impact of homology between train and test set examples on generalization of ScanNet and our baseline models. We enforced a maximum sequence identity (90%) between a val/test example and any train set example and grouped validation and test examples into four subgroups based on their degrees of homology, see <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S4(g)</xref>:</p>
            <list list-type="order" id="L5">
               <list-item>
                  <p id="P92">
                     <italic>Val</italic>/<italic>Test 70%</italic>: At least 70% sequence identity with at least one train set example.</p>
               </list-item>
               <list-item>
                  <p id="P93">
                     <italic>Val</italic>/<italic>Test Homology</italic>: At most 70% sequence identity with any train set example, at least one train set example belonging to same protein superfamily (H level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]).</p>
               </list-item>
               <list-item>
                  <p id="P94">
                     <italic>Val</italic>/<italic>Test Topology</italic>: At least one train set example with similar protein topology (T level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]), none with similar protein superfamily.</p>
               </list-item>
               <list-item>
                  <p id="P95">
                     <italic>Val</italic>/<italic>Test None</italic>: None of the above.</p>
               </list-item>
            </list>
            <p id="P96">Subgroups are ordered by decreasing degree of homology; generalization is expected to be increasingly difficult. To ensure that the four subsets have approximately equal sizes, the following partitioning algorithm was employed. The chains are first iteratively clustered by sequence identity at several levels (100%, 95%, 90% seqID, 70% seqID) using CD-HIT [<xref ref-type="bibr" rid="R84">84</xref>] followed by clustering at homology and topology identifiers. If a 70% (resp. homology) cluster contains several distinct homology (resp. topology) categories, these categories are merged into a single one. Next, we constructed the <italic>Val/Test None</italic> by randomly drawing topology clusters and assigning all its members to either validation and test; this is repeated until <italic>Val/Test None</italic> are full. The <italic>Val/Test topology</italic> sets were constructed by randomly drawing from the remaining topology clusters with more than one homology cluster, and assigning half of the homology clusters to train and half to val/test. Similarly, the <italic>Val/Test homology</italic> and <italic>Val/Test</italic> 70 are constructed similarly by drawing homology (resp. 70%) clusters with more than one 70% (resp. 90%) sequence identity cluster, and allocating each 70% (resp. 90%) cluster to either train or val/test. Finally, the remaining 90% clusters are randomly allocated to fill the training, validation and test sets (64% - 16% - 20% split).</p>
            <p id="P97">For the BCE, the dataset was subdivided into 5 folds for cross-validation. Antigens were clustered at 70% sequence identity, and each cluster was assigned to one fold at random (except for SARS-CoV-2 antigens, which were all assigned to fold 1).</p>
            <p id="P98">
               <bold>Label computation</bold> An amino acid of a protein chain is labeled as a binding site if at least one of its heavy atoms is within 4Å of another heavy atom from another chain within the biological assembly [<xref ref-type="bibr" rid="R12">12</xref>]. Next, since the same protein may appear in multiple assemblies, we take the union of all its binding sites found across pdb files. This is done by clustering sequences at 95% sequence identity using CD-HIT [<xref ref-type="bibr" rid="R84">84</xref>, <xref ref-type="bibr" rid="R85">85</xref>], aligning the sequences and labels of each cluster using MAFFT [<xref ref-type="bibr" rid="R86">86</xref>] and propagating the labels along each column. We found that for the PPBS dataset, 91.2% of the binding sites were identified from the original pdb complex file and 8.8% were propagated from other pdb files.</p>
            <p id="P99">For SabDab, we found that several epitopes appeared as accessible in one conformation of the protein and buried in another conformation; labels were propagated from one structure to another only if the residues had similar relative accessible surface area and coordination number (number of amino acids within 13Å). The propagation criterion writes:
<disp-formula id="FD12">
                  <label>(12)</label>
                  <mml:math id="M38">
                     <mml:mrow>
                        <mml:mrow>
                           <mml:mo>|</mml:mo>
                           <mml:mrow>
                              <mml:msub>
                                 <mml:mrow>
                                    <mml:mtext>ASA</mml:mtext>
                                 </mml:mrow>
                                 <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                 <mml:mrow>
                                    <mml:mtext>ASA</mml:mtext>
                                 </mml:mrow>
                                 <mml:mn>2</mml:mn>
                              </mml:msub>
                           </mml:mrow>
                           <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>/</mml:mo>
                        <mml:mi>σ</mml:mi>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:mtext>ASA</mml:mtext>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                           <mml:mo>|</mml:mo>
                           <mml:mrow>
                              <mml:msub>
                                 <mml:mrow>
                                    <mml:mtext>Coord</mml:mtext>
                                 </mml:mrow>
                                 <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                 <mml:mrow>
                                    <mml:mtext>Coord</mml:mtext>
                                 </mml:mrow>
                                 <mml:mn>2</mml:mn>
                              </mml:msub>
                           </mml:mrow>
                           <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>/</mml:mo>
                        <mml:mi>σ</mml:mi>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:mtext>Coord</mml:mtext>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mn>0.5</mml:mn>
                     </mml:mrow>
                  </mml:math>
               </disp-formula>
            </p>
            <p id="P100">For the PPBS, we obtained 22.7% positive labels - 30% when only considering the surface residues, with relative accessible surface ≥ 25% ( distributions shown in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig.S4 (e,f)</xref> ). For the BCE, we found 8.9% positive labels.</p>
            <p id="P101">
               <bold>Sample weighting and subsampling</bold> PDB covers unevenly the protein sequence space: many protein families do not have any representative structure, whereas others such as immunoglobulins have tens of thousands. The sampling is also biased within one family, as some genes and/or organisms are more frequently studied than others. To correct for the biases occurring at multiple scales, we apply the following hierarchical reweighting scheme:
<disp-formula id="FD13">
                  <label>(13)</label>
                  <mml:math id="M39">
                     <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                           <mml:mn>1</mml:mn>
                           <mml:mrow>
                              <mml:mtext>#</mml:mtext>
                              <mml:msub>
                                 <mml:mi mathvariant="script">C</mml:mi>
                                 <mml:mrow>
                                    <mml:mn>100</mml:mn>
                                 </mml:mrow>
                              </mml:msub>
                           </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>×</mml:mo>
                        <mml:mfrac>
                           <mml:mn>1</mml:mn>
                           <mml:mrow>
                              <mml:mtext>#</mml:mtext>
                              <mml:mrow>
                                 <mml:mo>{</mml:mo>
                                 <mml:mrow>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>100</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>∈</mml:mo>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>95</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                 </mml:mrow>
                                 <mml:mo>}</mml:mo>
                              </mml:mrow>
                           </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>×</mml:mo>
                        <mml:mfrac>
                           <mml:mn>1</mml:mn>
                           <mml:mrow>
                              <mml:mtext>#</mml:mtext>
                              <mml:mrow>
                                 <mml:mo>{</mml:mo>
                                 <mml:mrow>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>95</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>∈</mml:mo>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>90</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                 </mml:mrow>
                                 <mml:mo>}</mml:mo>
                              </mml:mrow>
                           </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>×</mml:mo>
                        <mml:mfrac>
                           <mml:mn>1</mml:mn>
                           <mml:mrow>
                              <mml:mtext>#</mml:mtext>
                              <mml:mrow>
                                 <mml:mo>{</mml:mo>
                                 <mml:mrow>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>90</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>∈</mml:mo>
                                    <mml:msub>
                                       <mml:mi mathvariant="script">C</mml:mi>
                                       <mml:mrow>
                                          <mml:mn>70</mml:mn>
                                       </mml:mrow>
                                    </mml:msub>
                                 </mml:mrow>
                                 <mml:mo>}</mml:mo>
                              </mml:mrow>
                           </mml:mrow>
                        </mml:mfrac>
                     </mml:mrow>
                  </mml:math>
               </disp-formula>
            </p>
            <p id="P102">Where <italic>C</italic>
               <sub>
                  <italic>T</italic>
               </sub> denotes the clusters at sequence identity cut-off <italic>T</italic>. This choice is such that each cluster at 70% sequence identity contributes a total weight 1; within each 70% cluster, each of the <italic>K</italic> 90% clusters contributes a total weight 1/<italic>K</italic>, and so on. An example of set of weights is illustrated in <xref ref-type="supplementary-material" rid="SD4">Fig. S4 (h)</xref>.</p>
            <p id="P103">In addition, this hierarchical choice ensures that the total weight of a cluster is invariant upon subsampling at some higher cluster identity level (e.g. the total weight of a 90% sequence identity cluster is invariant upon subsampling at 100%, 95% or 90% sequence identity). For the PPBS dataset, when hierarchical reweighting was used, we found no significant change of performance when training on the full set of chains or on 95% sequence identity representatives and therefore used the 95% sequence identity subset for speed gain purposes. When no reweighting or subsampling was used, performance significantly degraded, see <xref ref-type="table" rid="T1">Table I</xref> and <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S16</xref>. For the BCE database, the same approach was followed, without any subsampling - in order to include as many conformations as possible - and using a 90% sequence identity cut-off for the reweighting scheme, as similar proteins may have different epitopes.</p>
         </sec>
         <sec id="S20">
            <label>D</label>
            <title>Impact of induced fit on ScanNet predictions</title>
            <p id="P104">Protein structures undergo induced fit (i.e. conformational changes) upon binding. The magnitude of conformational changes varies, ranging from minimal rearrangement of side chain rotamers to extensive allosteric motion. ScanNet is mostly [<xref ref-type="bibr" rid="R87">87</xref>] trained on bound chains but applied to unbound ones. Owing to its high expressivity, it is a priori capable of picking up signature of bound conformations such as over-stretched side chains or unpacked helixes (see e.g. 4wwx:B of <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S14</xref>).</p>
            <p id="P105">We evaluated the predictive performance of ScanNet on unbound chains for two datasets: the Dockground simulated and Dockground X-Ray [<xref ref-type="bibr" rid="R45">45</xref>]. The Dockground simulated data set consists of chains extracted from complex pdb files and relaxed using Langevin Dynamics simulations [<xref ref-type="bibr" rid="R88">88</xref>]. Simulating separately the bound protein structures, without the interacting partner for a short time period (1 ns) relaxes the side-chain conformations of the interface residues and reliably approximates the unbound form of the protein if conformational changes are small (&lt; 2 ÅRMSD). We considered only the proteins that appeared in our data set and excluded four tetramers, obtaining 6012 chains. We used as ground truth the binding site labels of the PPBS data set (18.5% positive labels).</p>
            <p id="P106">The Dockground X-Ray consists of chains that are both crystallized alone and in complex with their partner. It features chains undergoing larger conformational changes than the simulated data set one. We selected <italic>N</italic> = 709 (bound, unbound) pairs with at least 95% sequence identity between chains. As some complex component were multi-chains, there was no direct correspondence with our data set labels (which included inter-domain, intra-protein binding sites); instead, we used as ground truth labels the interface residues of the complex (6.6% positive labels). The reduction in the fraction of positive labels also stems from the longer length of proteins on average (respectively 331 and 221 for X-ray and simulated).</p>
            <p id="P107">For both data set, we computed ScanNet predictions separately for the bound and unbound structures, excluded residues that did not match between the bound and unbound structure and compared both predictions residue-wise. Results are reported in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table S1 and Supplementary Fig. S5</xref>. We find a good agreement between bound and unbound predictions (Pearson correlations of <italic>r</italic> = 0.86, <italic>r</italic> = 0.78 for simulated and X-ray data sets respectively). A slight drop in accuracy between bound and unbound structures is found: from 88.3% to 86.6% for the simulated set and from 91.9% to 91.3% for the X-ray set.</p>
            <p id="P108">To further quantify the impact of global and local conformational changes on prediction, we calculated for each chain the root mean square deviation (RMSD) between the bound and unbound atomic coordinates and the RMSD between the bound and unbound solvent accessible surface area. <xref ref-type="supplementary-material" rid="SD4">Supplementary Fig. S5 (e),(f)</xref> show the per-chain Pearson correlation between bound and unbound predictions against the coordinate (resp. solvent accessibility) RMSD. As expected, structures with larger global/local conformational changes tend to exhibit significant changes in binding site predictions. Overall, we conclude that ScanNet predictions are overall robust to conformational changes, although improvements could be obtained by training on unbound structures.</p>
         </sec>
         <sec id="S21">
            <label>E</label>
            <title>Comparison between ScanNet and AlphaFold2 binding site predictions</title>
            <p id="P109">AlphaFold-multimer (AF2) is a recently released model for predicting the structure of protein complexes from paired multiple sequence alignments [<xref ref-type="bibr" rid="R56">56</xref>]. It is difficult to compare fairly AF2 and ScanNet, as the first one assumes knowledge of the partner and predicts partner-specific binding sites, whereas the second one does not assume knowledge of the partner and predicts partner-agnostic binding sites. We nonetheless benchmarked both approaches as follows. We considered Benchmark2, a set of 17 recently released dimers that do not appear in the training sets of AF2 and ScanNet [<xref ref-type="bibr" rid="R89">89</xref>]. For each of the 34 chains, we determined the ground truth partner-specific binding sites (i.e. involved in the complex) and partner-agnostic binding site (i.e. the union of all binding sites involved in any complex found among PDB structures with 95% or more sequence identity to the chain). Next, we ran AF2 (ColabFold version, no relaxation [<xref ref-type="bibr" rid="R90">90</xref>]) to predict the structure of the complex given the pair of sequences, obtaining five models. For each residue, the binding site probability was defined as the fraction of models in which it belongs to the interface (taking fractional values ∈ {0,0.2,0.4,0.6,0.8,1.0}; we also tested continuous values using the predicted alignment error at contacts, but found no improvement). We also experimented defining continuous binding site probability by using the predicted alignment error at contacts, but found no improvement. ScanNet was run on each chain to produce binding site probabilities (averaging of 11 models). The Area under the precision recall curve (AUCPR) was computed for each chain separately, and for both the partner-specific and partner-agnostic binding sites. Results are reported in <xref ref-type="supplementary-material" rid="SD4">Supplementary Fig.S6 (a),(b),(c)</xref>. We found that for partner-specific binding site, AF2 outperformed ScanNet in 27/34 chains (<xref ref-type="supplementary-material" rid="SD4">Supplementary Fig.S6 (a)</xref>) whereas for partner-agnostic binding, the performances were comparable (19/34 better for AF2 and 15/34 better for ScanNet, <xref ref-type="supplementary-material" rid="SD4">Supplementary Fig.S6 (b)</xref>). Generically, ScanNet outperformed AF2 when a protein had multiple binding sites, whereas AF2 outperformed ScanNet when only a single binding site was known. Other examples where ScanNet outperformed AF2 were a mammal cell surface protein (6pnq, <xref ref-type="supplementary-material" rid="SD4">Supplementary Fig.S6 (c)</xref> ), and a rice host-pathogen interaction (5zng) - for which no paired MSA can be constructed.</p>
            <p id="P110">For B-cell epitope prediction, we tested AF2 on the Receptor Binding Domain (RBD) of the SARS-CoV-2 spike protein as follows. We first selected six representative antibody-antigen complexes spanning all the known epitopes of the RBD, following [<xref ref-type="bibr" rid="R52">52</xref>] (<xref ref-type="supplementary-material" rid="SD4">Sup. Table S6</xref>). We then predicted their structure with AF2, obtaining 6 × 5 = 30 models. The B-cell epitope propensity was defined residue-wise as the fraction of all models in which the residue is bound by antibodies. We found that AF2 systematically predicted a single binding mode roughly corresponding to the RBD-C epitope (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S6 (d),(e)</xref> ) , whereas ScanNet correctly predicted multiple epitopes. We compared AF2 and ScanNet epitope propensity predictions with the empirical antibody hit rate calculated from 290 experimental structures of antibody-spike protein found in the PDB (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S6 (d)</xref> ), and found that the ScanNet profile better correlated (Spearman coefficient of respectively 0.74 and 0.6). Allegedly, AF2 failure stems from i) unavailability of a paired MSA ii) low sensitivity with respect to the antibody sequence and iii) unimodal rather than multimodal prediction.</p>
         </sec>
         <sec id="S22">
            <label>F</label>
            <title>Link between ScanNet predictions and residue contribution to binding energy</title>
            <p id="P111">Presumably residues with high binding probability correspond to hotspots residues, i.e. residues with high contribution to the binding free energy of the complexes [<xref ref-type="bibr" rid="R43">43</xref>]. To test this hypothesis, we first compared ScanNet predictions to changes in binding affinity ∆∆<italic>G</italic> measured after mutation of binding residues to alanine. Positive ∆∆<italic>G</italic> indicate important residues, and hotspots are typically defined as ∆∆<italic>G</italic> &gt; 2<italic>kcal</italic>.<italic>mor</italic>
               <sup>–1</sup>. We found in the SKEMPI v2.0 database [<xref ref-type="bibr" rid="R91">91</xref>] 2122 mutations of binding residues to alanine, spread across 130 complexes. We calculated for each residue its binding site probability <italic>p</italic> and aggregated attention coefficient <italic>a</italic> (defined as Σ<sub>
                  <italic>i</italic>
               </sub>
               <italic>a</italic>
               <sub>
                  <italic>ij</italic>
               </sub> where <italic>a</italic> is computed as in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S2</xref>). The later score quantifies the importance of the residue within the neighborhood; residues with high aggregated attention drive prediction of their neighborhood. Next, we estimated the conditional average 𝔼[∆∆<italic>G</italic>|<italic>p</italic>, <italic>a</italic>] using a one-layer perceptron with 20 hidden units, hyperbolic tangent activation and non-negative kernel weights to enforce monotonicity (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S7 (a),(b)</xref>). We indeed find that residues with high binding probability and large attention coefficient tend to be more important for binding.</p>
            <p id="P112">We next performed a similar analysis using the Benchmark 5.5 dataset [<xref ref-type="bibr" rid="R92">92</xref>] (271 dimers, 10444 binding sites) and the Rosetta REF15 all-atom energy function [<xref ref-type="bibr" rid="R93">93</xref>]. For each dimer, the binding energy was estimated as the difference between the energy of the complex and the sum of the energies of the unbound structures. The FastRelax protocol of PyRosetta [<xref ref-type="bibr" rid="R94">94</xref>] was used to remove steric clashes prior to computation of the energies. We similarly find that residues with high binding probability and large attention coefficient tend to contribute a lower energy (<xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S7 (c),(d)</xref>).</p>
            <p id="P113">In addition, Rosetta allows to calculate the contribution of individual energy terms to the residue-wise binding energy. This raises the question of whether the types of interaction involved in binding can be predicted from the intermediate layer activities of ScanNet. We grouped the 19 energy terms into eight groups: Solvation (fa_sol+lk_ball_wtd+fa_intrasolxover4), van der Waals (fa_atr+fa_rep), Coulomb (fa_elec), Backbone-side chain hydrogen bonds (hbondbb sc), Side chain - side chain hydrogen bonds (hbondjsc), Side chain internal energy (fa_intra_rep+fa_dun+yhh_planarity), Backbone internal energy (omega+paa_pp+rama_prepro+hbond_sr_bb+hbond_lr_bb) and Others (pro_close+dslf_fa13+ref).</p>
            <p id="P114">Next, we computed for each binding residue the vector of activities of the amino-acid spatio-chemical filters. We then performed a LASSO regression to predict residue-wise the value of each energy term from the filter activities (optimal regularization determined by cross-validation with scikit-learn [<xref ref-type="bibr" rid="R75">75</xref>]). The regression and correlation coefficients are shown in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S7 (e)</xref>. We find several “hotspot” filters associated with negative binding energies, such as filters 81, 17, 57, 41, 2 and 22 (the O-ring filter represented in the main text). As expected, they are also strongly correlated with binding (<italic>r</italic> =0.47,0.19, 0.12, 0.31, 0.09,0.29 see filter depiction in Supplementary Data).</p>
            <p id="P115">Interestingly, each filter displays a distinct energetic profile. For instance, filter 81 is associated with strong van der Waals binding without any cost in solvation energy; consistently, it is activated by hydrophobic residues already fully exposed in the unbound state (see filter depiction in Supplementary Data). The O-ring filter 22 is associated with both strong van der Waals and electrostatic energy, but at the expense of a higher solvation cost. Backbone-mediated interactions are also captured; for instance, filter 54, which corresponds to an exposed glycine/lysine tandem, is associated with strong backbone - sidechain hydrogen bonding.</p>
            <p id="P116">Altogether, the comparative analysis with mutagenesis assays and Rosetta energy supports the claim that ScanNet learns some of the underlying physical principles of binding.</p>
         </sec>
         <sec id="S23">
            <label>G</label>
            <title>Protein-protein binding site and B-cell epitope prediction: additional material</title>
         </sec>
      </sec>
      <sec sec-type="supplementary-material" id="SM">
         <title>Supplementary Material</title>
         <supplementary-material content-type="local-data" id="SD1">
            <label>3D visualisation and activation statistics of all the amino acid filters of the B-cell epitope</label>
            <media xlink:href="EMS134319-supplement-3D_visualisation_and_activation_statistics_of_all_the_amino_acid_filters_of_the_B_cell_epitope.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdEbB" position="anchor"/>
         </supplementary-material>
         <supplementary-material content-type="local-data" id="SD2">
            <label>3D visualisation and activation statistics of all the amino acid filters of the protein-protein</label>
            <media xlink:href="EMS134319-supplement-3D_visualisation_and_activation_statistics_of_all_the_amino_acid_filters_of_the_protein_protein.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdEcB" position="anchor"/>
         </supplementary-material>
         <supplementary-material content-type="local-data" id="SD3">
            <label>3D visualisation and activation statistics of all the atomic filters of the protein-protein binding</label>
            <media xlink:href="EMS134319-supplement-3D_visualisation_and_activation_statistics_of_all_the_atomic_filters_of_the_protein_protein_binding.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdEdB" position="anchor"/>
         </supplementary-material>
         <supplementary-material content-type="local-data" id="SD4">
            <label>Supplementary Tables Figures</label>
            <media xlink:href="EMS134319-supplement-Supplementary_Tables_Figures.pdf" mimetype="application" mime-subtype="pdf" id="d24aAdEeB" position="anchor"/>
         </supplementary-material>
      </sec>
   </body>
   <back>
      <ack id="S24">
         <title>Acknowledgements</title>
         <p id="P117">J.T. acknowledges financial support from the Edmond J. Safra Center for Bioinformatics at Tel Aviv University and from the Human Frontier Science Program (cross-disciplinary postdoctoral fellowship LT001058/2019-C). D.S. was supported by ISF 1466/18, Israel ministry of Science and Technology and HUJI-CIDR. This work was supported by Len Blavatnik and the Blavatnik Family Foundation. We are grateful to Sonia Lichtenzveig Sela and the CS system team for their technical support. We thank Raphaël Groscot for his help on pythreejs visualizations. We thank Léa Naccache, Michael Nissan, Yoav Lotem, Mark Rozanov, Lirane Bitton, Matan Halfon and Shon Cohen for helpful discussions.</p>
      </ack>
      <sec id="S25" sec-type="data-availability">
         <title>Availability</title>
         <p id="P118">Data sets and source codes for training and evaluating ScanNet will be released upon publication.</p>
      </sec>
      <ref-list>
         <ref id="R1">
            <label>[1]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kühlbrandt</surname>
                     <given-names>W</given-names>
                  </name>
               </person-group>
               <article-title>The resolution revolution</article-title>
               <source>Science</source>
               <year>2014</year>
               <volume>343</volume>
               <fpage>1443</fpage>
            </element-citation>
         </ref>
         <ref id="R2">
            <label>[2]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Jumper</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Evans</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Pritzel</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Green</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Figurnov</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Ronneberger</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Tunyasuvunakool</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Bates</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Žídek</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Potapenko</surname>
                     <given-names>A</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Highly accurate protein structure prediction with alphafold</article-title>
               <source>Nature</source>
               <year>2021</year>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R3">
            <label>[3]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Tunyasuvunakool</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Adler</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>Z</given-names>
                  </name>
                  <name>
                     <surname>Green</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Zielinski</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Žídek</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Bridgland</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Cowie</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Meyer</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Laydon</surname>
                     <given-names>A</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Highly accurate protein structure prediction for the human proteome</article-title>
               <source>Nature</source>
               <year>2021</year>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R4">
            <label>[4]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chruszcz</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Domagalski</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Osinski</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Wlodawer</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Minor</surname>
                     <given-names>W</given-names>
                  </name>
               </person-group>
               <article-title>Unmet challenges of structural genomics</article-title>
               <source>Current opinion in structural biology</source>
               <year>2010</year>
               <volume>20</volume>
               <fpage>587</fpage>
            </element-citation>
         </ref>
         <ref id="R5">
            <label>[5]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Shulman-Peleg</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Nussinov</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Wolfson</surname>
                     <given-names>HJ</given-names>
                  </name>
               </person-group>
               <article-title>Siteengines: recognition and comparison of binding sites and protein–protein interfaces</article-title>
               <source>Nucleic acids research</source>
               <year>2005</year>
               <volume>33</volume>
               <elocation-id>W337</elocation-id>
            </element-citation>
         </ref>
         <ref id="R6">
            <label>[6]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Carl</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Konc</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Vehar</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Janezic</surname>
                     <given-names>D</given-names>
                  </name>
               </person-group>
               <article-title>Protein-protein binding site prediction by local structural alignment</article-title>
               <source>Journal of chemical information and modeling</source>
               <year>2010</year>
               <volume>50</volume>
               <elocation-id>1906</elocation-id>
            </element-citation>
         </ref>
         <ref id="R7">
            <label>[7]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Zhang</surname>
                     <given-names>QC</given-names>
                  </name>
                  <name>
                     <surname>Petrey</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Norel</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Honig</surname>
                     <given-names>BH</given-names>
                  </name>
               </person-group>
               <article-title>Protein interface conservation across structure space</article-title>
               <source>Proceedings of the National Academy of Sciences</source>
               <year>2010</year>
               <volume>107</volume>
               <elocation-id>10896</elocation-id>
            </element-citation>
         </ref>
         <ref id="R8">
            <label>[8]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Xue</surname>
                     <given-names>LC</given-names>
                  </name>
                  <name>
                     <surname>Dobbs</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Honavar</surname>
                     <given-names>V</given-names>
                  </name>
               </person-group>
               <article-title>Homppi: a class of sequence homology based protein-protein interface prediction methods</article-title>
               <source>BMC bioinformatics</source>
               <year>2011</year>
               <volume>12</volume>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R9">
            <label>[9]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Shoemaker</surname>
                     <given-names>BA</given-names>
                  </name>
                  <name>
                     <surname>Zhang</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Tyagi</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Thangudu</surname>
                     <given-names>RR</given-names>
                  </name>
                  <name>
                     <surname>Fong</surname>
                     <given-names>JH</given-names>
                  </name>
                  <name>
                     <surname>Marchler-Bauer</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Bryant</surname>
                     <given-names>SH</given-names>
                  </name>
                  <name>
                     <surname>Madej</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Panchenko</surname>
                     <given-names>AR</given-names>
                  </name>
               </person-group>
               <article-title>Ibis (inferred biomolecular interaction server) reports, predicts and integrates multiple types of conserved interactions for proteins</article-title>
               <source>Nucleic acids research</source>
               <year>2012</year>
               <volume>40</volume>
               <elocation-id>D834</elocation-id>
            </element-citation>
         </ref>
         <ref id="R10">
            <label>[10]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Jordan</surname>
                     <given-names>RA</given-names>
                  </name>
                  <name>
                     <surname>Yasser</surname>
                     <given-names>E-M</given-names>
                  </name>
                  <name>
                     <surname>Dobbs</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Honavar</surname>
                     <given-names>V</given-names>
                  </name>
               </person-group>
               <article-title>Predicting protein-protein interface residues using local surface structural similarity</article-title>
               <source>BMC bioinformatics</source>
               <year>2012</year>
               <volume>13</volume>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R11">
            <label>[11]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Esmaielbeiki</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Nebel</surname>
                     <given-names>J-C</given-names>
                  </name>
               </person-group>
               <source>Unbiased protein interface prediction based on ligand diversity quantification</source>
               <year>2012</year>
            </element-citation>
         </ref>
         <ref id="R12">
            <label>[12]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Xue</surname>
                     <given-names>LC</given-names>
                  </name>
                  <name>
                     <surname>Dobbs</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Bonvin</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Honavar</surname>
                     <given-names>V</given-names>
                  </name>
               </person-group>
               <article-title>Computational prediction of protein interfaces: A review of data driven methods</article-title>
               <source>FEBS letters</source>
               <year>2015</year>
               <volume>589</volume>
               <elocation-id>3516</elocation-id>
            </element-citation>
         </ref>
         <ref id="R13">
            <label>[13]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Esmaielbeiki</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Krawczyk</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Knapp</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Nebel</surname>
                     <given-names>J-C</given-names>
                  </name>
                  <name>
                     <surname>Deane</surname>
                     <given-names>CM</given-names>
                  </name>
               </person-group>
               <article-title>Progress and challenges in predicting protein interfaces</article-title>
               <source>Briefings in bioinformatics</source>
               <year>2016</year>
               <volume>17</volume>
               <fpage>117</fpage>
            </element-citation>
         </ref>
         <ref id="R14">
            <label>[14]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Neuvirth</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Raz</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Schreiber</surname>
                     <given-names>G</given-names>
                  </name>
               </person-group>
               <article-title>Promate: a structure based prediction program to identify the location of protein–protein binding sites</article-title>
               <source>Journal of molecular biology</source>
               <year>2004</year>
               <volume>338</volume>
               <fpage>181</fpage>
            </element-citation>
         </ref>
         <ref id="R15">
            <label>[15]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chung</surname>
                     <given-names>J-L</given-names>
                  </name>
                  <name>
                     <surname>Wang</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Bourne</surname>
                     <given-names>PE</given-names>
                  </name>
               </person-group>
               <article-title>Exploiting sequence and structure homologs to identify protein–protein binding sites</article-title>
               <source>Proteins: Structure, Function, and Bioinformatics</source>
               <year>2006</year>
               <volume>62</volume>
               <fpage>630</fpage>
            </element-citation>
         </ref>
         <ref id="R16">
            <label>[16]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Porollo</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Meller</surname>
                     <given-names>J</given-names>
                  </name>
               </person-group>
               <article-title>Prediction-based fingerprints of protein–protein interactions</article-title>
               <source>Proteins: Structure, Function, and Bioinformatics</source>
               <year>2007</year>
               <volume>66</volume>
               <fpage>630</fpage>
            </element-citation>
         </ref>
         <ref id="R17">
            <label>[17]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Sweredoski</surname>
                     <given-names>MJ</given-names>
                  </name>
                  <name>
                     <surname>Baldi</surname>
                     <given-names>P</given-names>
                  </name>
               </person-group>
               <article-title>Pepito: improved discontinuous b-cell epitope prediction using multiple distance thresholds and half sphere exposure</article-title>
               <source>Bioinformatics</source>
               <year>2008</year>
               <volume>24</volume>
               <elocation-id>1459</elocation-id>
            </element-citation>
         </ref>
         <ref id="R18">
            <label>[18]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Mishra</surname>
                     <given-names>SK</given-names>
                  </name>
                  <name>
                     <surname>Kandoi</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Jernigan</surname>
                     <given-names>RL</given-names>
                  </name>
               </person-group>
               <article-title>Coupling dynamics and evolutionary information with structure to identify protein regulatory and functional binding sites</article-title>
               <source>Proteins: Structure, Function, and Bioinformatics</source>
               <year>2019</year>
               <volume>87</volume>
               <fpage>850</fpage>
            </element-citation>
         </ref>
         <ref id="R19">
            <label>[19]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Klug</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Rhodes</surname>
                     <given-names>D</given-names>
                  </name>
               </person-group>
               <article-title>‘zinc fingers’: a novel protein motif for nucleic acid recognition</article-title>
               <source>Trends in Biochemical Sciences</source>
               <year>1987</year>
               <volume>12</volume>
               <fpage>464</fpage>
            </element-citation>
         </ref>
         <ref id="R20">
            <label>[20]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Bogan</surname>
                     <given-names>AA</given-names>
                  </name>
                  <name>
                     <surname>Thorn</surname>
                     <given-names>KS</given-names>
                  </name>
               </person-group>
               <article-title>Anatomy of hot spots in protein interfaces</article-title>
               <source>Journal of molecular biology</source>
               <year>1998</year>
               <volume>280</volume>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R21">
            <label>[21]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Wensien</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>von Pappenheim</surname>
                     <given-names>FR</given-names>
                  </name>
                  <name>
                     <surname>Funk</surname>
                     <given-names>L-M</given-names>
                  </name>
                  <name>
                     <surname>Kloskowski</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Curth</surname>
                     <given-names>U</given-names>
                  </name>
                  <name>
                     <surname>Diederichsen</surname>
                     <given-names>U</given-names>
                  </name>
                  <name>
                     <surname>Uranga</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Ye</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Fang</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Pan</surname>
                     <given-names>K-T</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>A lysine–cysteine redox switch with an nos bridge regulates enzyme function</article-title>
               <source>Nature</source>
               <year>2021</year>
               <volume>593</volume>
               <fpage>460</fpage>
            </element-citation>
         </ref>
         <ref id="R22">
            <label>[22]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Elnaggar</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Heinzinger</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Dallago</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Rihawi</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Wang</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Jones</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Gibbs</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Feher</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Angerer</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Steinegger</surname>
                     <given-names>M</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Prottrans: towards cracking the language of life’s code through self-supervised deep learning and high performance computing</article-title>
               <source>arXiv preprint</source>
               <year>2020</year>
               <elocation-id>arXiv:2007.06225</elocation-id>
            </element-citation>
         </ref>
         <ref id="R23">
            <label>[23]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Rives</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Meier</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Sercu</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Goyal</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Lin</surname>
                     <given-names>Z</given-names>
                  </name>
                  <name>
                     <surname>Liu</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Guo</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Ott</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Zitnick</surname>
                     <given-names>CL</given-names>
                  </name>
                  <name>
                     <surname>Ma</surname>
                     <given-names>J</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>
               <source>Proceedings of the National Academy of Sciences</source>
               <year>2021</year>
               <volume>118</volume>
            </element-citation>
         </ref>
         <ref id="R24">
            <label>[24]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ingraham</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Riesselman</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Sander</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Marks</surname>
                     <given-names>D</given-names>
                  </name>
               </person-group>
               <source>Learning protein structure with a differentiable simulator</source>
               <conf-name>International Conference on Learning Representations</conf-name>
               <year>2018</year>
            </element-citation>
         </ref>
         <ref id="R25">
            <label>[25]</label>
            <element-citation publication-type="other">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ingraham</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Garg</surname>
                     <given-names>VK</given-names>
                  </name>
                  <name>
                     <surname>Barzilay</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Jaakkola</surname>
                     <given-names>T</given-names>
                  </name>
               </person-group>
               <source>Generative models for graph-based protein design</source>
               <year>2019</year>
            </element-citation>
         </ref>
         <ref id="R26">
            <label>[26]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Jing</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Xu</surname>
                     <given-names>J</given-names>
                  </name>
               </person-group>
               <article-title>Fast and effective protein model refinement by deep graph neural networks</article-title>
               <source>bioRxiv</source>
               <year>2020</year>
            </element-citation>
         </ref>
         <ref id="R27">
            <label>[27]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Baldassarre</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Menéndez Hurtado</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Elofsson</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Azizpour</surname>
                     <given-names>H</given-names>
                  </name>
               </person-group>
               <article-title>Graphqa: protein model quality assessment using graph convolutional networks</article-title>
               <source>Bioinformatics</source>
               <year>2021</year>
               <volume>37</volume>
               <fpage>360</fpage>
            </element-citation>
         </ref>
         <ref id="R28">
            <label>[28]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Wallach</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Dzamba</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Heifets</surname>
                     <given-names>A</given-names>
                  </name>
               </person-group>
               <article-title>Atomnet: a deep convolutional neural network for bioactivity prediction in structure-based drug discovery</article-title>
               <source>arXiv preprint</source>
               <year>2015</year>
               <elocation-id>arXiv:1510.02855</elocation-id>
            </element-citation>
         </ref>
         <ref id="R29">
            <label>[29]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ragoza</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Hochuli</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Idrobo</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Sunseri</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Koes</surname>
                     <given-names>DR</given-names>
                  </name>
               </person-group>
               <article-title>Protein–ligand scoring with convolutional neural networks</article-title>
               <source>Journal of chemical information and modeling</source>
               <year>2017</year>
               <volume>57</volume>
               <fpage>942</fpage>
            </element-citation>
         </ref>
         <ref id="R30">
            <label>[30]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Pagès</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Charmettant</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Grudinin</surname>
                     <given-names>S</given-names>
                  </name>
               </person-group>
               <article-title>Protein model quality assessment using 3d oriented convolutional neural networks</article-title>
               <source>Bioinformatics</source>
               <year>2019</year>
               <volume>35</volume>
               <elocation-id>3313</elocation-id>
            </element-citation>
         </ref>
         <ref id="R31">
            <label>[31]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Townshend</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Bedi</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Suriana</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Dror</surname>
                     <given-names>R</given-names>
                  </name>
               </person-group>
               <article-title>End-to-end learning on 3d protein structure for interface prediction</article-title>
               <source>Advances in Neural Information Processing Systems</source>
               <year>2019</year>
               <volume>32</volume>
               <elocation-id>15642</elocation-id>
            </element-citation>
         </ref>
         <ref id="R32">
            <label>[32]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Wang</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Terashi</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Christoffer</surname>
                     <given-names>CW</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Kihara</surname>
                     <given-names>D</given-names>
                  </name>
               </person-group>
               <article-title>Protein docking model evaluation by 3d deep convolutional neural networks</article-title>
               <source>Bioinformatics</source>
               <year>2020</year>
               <volume>36</volume>
               <elocation-id>2113</elocation-id>
            </element-citation>
         </ref>
         <ref id="R33">
            <label>[33]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Igashov</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Olechnovic</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Kadukova</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Venclovas</surname>
                     <given-names>Č</given-names>
                  </name>
                  <name>
                     <surname>Grudinin</surname>
                     <given-names>S</given-names>
                  </name>
               </person-group>
               <article-title>Vorocnn: Deep convolutional neural network built on 3d voronoi tessellation of protein structures</article-title>
               <source>bioRxiv</source>
               <year>2020</year>
            </element-citation>
         </ref>
         <ref id="R34">
            <label>[34]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Renaud</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Geng</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Georgievska</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Ambrosetti</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Ridder</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Marzella</surname>
                     <given-names>DF</given-names>
                  </name>
                  <name>
                     <surname>Bonvin</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Xue</surname>
                     <given-names>LC</given-names>
                  </name>
               </person-group>
               <article-title>Deeprank: A deep learning framework for data mining 3d protein-protein interfaces</article-title>
               <source>Biorxiv</source>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R35">
            <label>[35]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Eismann</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Suriana</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Jing</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Townshend</surname>
                     <given-names>RJ</given-names>
                  </name>
                  <name>
                     <surname>Dror</surname>
                     <given-names>RO</given-names>
                  </name>
               </person-group>
               <article-title>Protein model quality assessment using rotation-equivariant, hierarchical neural networks</article-title>
               <source>arXiv preprint</source>
               <year>2020</year>
               <elocation-id>arXiv:2011.13557</elocation-id>
            </element-citation>
         </ref>
         <ref id="R36">
            <label>[36]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Gainza</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Sverrisson</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Monti</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Rodola</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Boscaini</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Bronstein</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Correia</surname>
                     <given-names>B</given-names>
                  </name>
               </person-group>
               <article-title>Deciphering interaction fingerprints from protein molecular surfaces using geometric deep learning</article-title>
               <source>Nature Methods</source>
               <year>2020</year>
               <volume>17</volume>
               <fpage>184</fpage>
            </element-citation>
         </ref>
         <ref id="R37">
            <label>[37]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Sverrisson</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Feydy</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Correia</surname>
                     <given-names>BE</given-names>
                  </name>
                  <name>
                     <surname>Bronstein</surname>
                     <given-names>MM</given-names>
                  </name>
               </person-group>
               <source>Fast end-to-end learning on protein surfaces</source>
               <conf-name>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</conf-name>
               <year>2021</year>
               <fpage>15272</fpage>
               <lpage>15281</lpage>
            </element-citation>
         </ref>
         <ref id="R38">
            <label>[38]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Bronstein</surname>
                     <given-names>MM</given-names>
                  </name>
                  <name>
                     <surname>Bruna</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>LeCun</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Szlam</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Vandergheynst</surname>
                     <given-names>P</given-names>
                  </name>
               </person-group>
               <article-title>Geometric deep learning: going beyond euclidean data</article-title>
               <source>IEEE Signal Processing Magazine</source>
               <year>2017</year>
               <volume>34</volume>
               <fpage>18</fpage>
            </element-citation>
         </ref>
         <ref id="R39">
            <label>[39]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Bronstein</surname>
                     <given-names>MM</given-names>
                  </name>
                  <name>
                     <surname>Bruna</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Cohen</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Veličković</surname>
                     <given-names>P</given-names>
                  </name>
               </person-group>
               <article-title>Geometric deep learning: Grids, groups, graphs, geodesics, and gauges</article-title>
               <source>arXiv preprint</source>
               <year>2021</year>
               <elocation-id>arXiv:2104.13478</elocation-id>
            </element-citation>
         </ref>
         <ref id="R40">
            <label>[40]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Gilmer</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Schoenholz</surname>
                     <given-names>SS</given-names>
                  </name>
                  <name>
                     <surname>Riley</surname>
                     <given-names>PF</given-names>
                  </name>
                  <name>
                     <surname>Vinyals</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Dahl</surname>
                     <given-names>GE</given-names>
                  </name>
               </person-group>
               <source>Neural message passing for quantum chemistry</source>
               <conf-name>International conference on machine learning</conf-name>
               <conf-sponsor>PMLR</conf-sponsor>
               <year>2017</year>
               <fpage>1263</fpage>
               <lpage>1272</lpage>
            </element-citation>
         </ref>
         <ref id="R41">
            <label>[41]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Veličković</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Cucurull</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Casanova</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Romero</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Lio</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Bengio</surname>
                     <given-names>Y</given-names>
                  </name>
               </person-group>
               <article-title>Graph attention networks</article-title>
               <source>arXiv preprint</source>
               <year>2017</year>
               <elocation-id>arXiv:1710.10903</elocation-id>
            </element-citation>
         </ref>
         <ref id="R42">
            <label>[42]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Keskin</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Ma</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Nussinov</surname>
                     <given-names>R</given-names>
                  </name>
               </person-group>
               <article-title>Hot regions in protein–protein interactions: the organization and contribution of structurally conserved hot spot residues</article-title>
               <source>Journal of molecular biology</source>
               <year>2005</year>
               <volume>345</volume>
               <elocation-id>1281</elocation-id>
            </element-citation>
         </ref>
         <ref id="R43">
            <label>[43]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ofran</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Rost</surname>
                     <given-names>B</given-names>
                  </name>
               </person-group>
               <article-title>Protein–protein interaction hotspots carved into sequences</article-title>
               <source>PLoS computational biology</source>
               <year>2007</year>
               <volume>3</volume>
               <fpage>e119</fpage>
            </element-citation>
         </ref>
         <ref id="R44">
            <label>[44]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Dey</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Ritchie</surname>
                     <given-names>DW</given-names>
                  </name>
                  <name>
                     <surname>Levy</surname>
                     <given-names>ED</given-names>
                  </name>
               </person-group>
               <article-title>Pdb-wide identification of biological assemblies from conserved quaternary structure geometry</article-title>
               <source>Nature methods</source>
               <year>2018</year>
               <volume>15</volume>
               <fpage>67</fpage>
            </element-citation>
         </ref>
         <ref id="R45">
            <label>[45]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kundrotas</surname>
                     <given-names>PJ</given-names>
                  </name>
                  <name>
                     <surname>Anishchenko</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Dauzhenka</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Kotthoff</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Mnevets</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Copeland</surname>
                     <given-names>MM</given-names>
                  </name>
                  <name>
                     <surname>Vakser</surname>
                     <given-names>IA</given-names>
                  </name>
               </person-group>
               <article-title>Dockground: a comprehensive data resource for modeling of protein complexes</article-title>
               <source>Protein Science</source>
               <year>2018</year>
               <volume>27</volume>
               <fpage>172</fpage>
            </element-citation>
         </ref>
         <ref id="R46">
            <label>[46]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chen</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Guestrin</surname>
                     <given-names>C</given-names>
                  </name>
               </person-group>
               <source>Xgboost: A scalable tree boosting system</source>
               <conf-name>Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining</conf-name>
               <year>2016</year>
               <fpage>785</fpage>
               <lpage>794</lpage>
            </element-citation>
         </ref>
         <ref id="R47">
            <label>[47]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Shatsky</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Nussinov</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Wolfson</surname>
                     <given-names>HJ</given-names>
                  </name>
               </person-group>
               <source>Multiprot—a multiple protein structural alignment algorithm</source>
               <conf-name>International Workshop on Algorithms in Bioinformatics</conf-name>
               <publisher-name>Springer</publisher-name>
               <year>2002</year>
               <fpage>235</fpage>
               <lpage>250</lpage>
            </element-citation>
         </ref>
         <ref id="R48">
            <label>[48]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Sillitoe</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Bordin</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Dawson</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Waman</surname>
                     <given-names>VP</given-names>
                  </name>
                  <name>
                     <surname>Ashford</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Scholes</surname>
                     <given-names>HM</given-names>
                  </name>
                  <name>
                     <surname>Pang</surname>
                     <given-names>CS</given-names>
                  </name>
                  <name>
                     <surname>Woodridge</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Rauer</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Sen</surname>
                     <given-names>N</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Cath: increased structural coverage of functional space</article-title>
               <source>Nucleic acids research</source>
               <year>2021</year>
               <volume>49</volume>
               <elocation-id>D266</elocation-id>
            </element-citation>
         </ref>
         <ref id="R49">
            <label>[49]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Jurrus</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Engel</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Star</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Monson</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Brandi</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Felberg</surname>
                     <given-names>LE</given-names>
                  </name>
                  <name>
                     <surname>Brookes</surname>
                     <given-names>DH</given-names>
                  </name>
                  <name>
                     <surname>Wilson</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Chen</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Liles</surname>
                     <given-names>K</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Improvements to the apbs biomolecular solvation software suite</article-title>
               <source>Protein Science</source>
               <year>2018</year>
               <volume>27</volume>
               <fpage>112</fpage>
            </element-citation>
         </ref>
         <ref id="R50">
            <label>[50]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Dunbar</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Krawczyk</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Leem</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Baker</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Fuchs</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Georges</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Shi</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Deane</surname>
                     <given-names>CM</given-names>
                  </name>
               </person-group>
               <article-title>Sabdab: the structural antibody database</article-title>
               <source>Nucleic acids research</source>
               <year>2014</year>
               <volume>42</volume>
               <elocation-id>D1140</elocation-id>
            </element-citation>
         </ref>
         <ref id="R51">
            <label>[51]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kringelum</surname>
                     <given-names>JV</given-names>
                  </name>
                  <name>
                     <surname>Lundegaard</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Lund</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Nielsen</surname>
                     <given-names>M</given-names>
                  </name>
               </person-group>
               <article-title>Reliable b cell epitope predictions: impacts of method development and improved benchmarking</article-title>
               <source>PLoS Comput Biol</source>
               <year>2012</year>
               <volume>8</volume>
               <elocation-id>e1002829</elocation-id>
            </element-citation>
         </ref>
         <ref id="R52">
            <label>[52]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Huang</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>NC</given-names>
                  </name>
                  <name>
                     <surname>Jackson</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Peng</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>van Gils</surname>
                     <given-names>MJ</given-names>
                  </name>
                  <name>
                     <surname>Sanders</surname>
                     <given-names>RW</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Structural and functional ramifications of antigenic drift in recent sars-cov-2 variants</article-title>
               <source>Science</source>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R53">
            <label>[53]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Shrock</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Fujimura</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Kula</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Timms</surname>
                     <given-names>RT</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>I-H</given-names>
                  </name>
                  <name>
                     <surname>Leng</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Robinson</surname>
                     <given-names>ML</given-names>
                  </name>
                  <name>
                     <surname>Sie</surname>
                     <given-names>BM</given-names>
                  </name>
                  <name>
                     <surname>Li</surname>
                     <given-names>MZ</given-names>
                  </name>
                  <name>
                     <surname>Chen</surname>
                     <given-names>Y</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Viral epitope profiling of covid-19 patients reveals cross-reactivity and correlates of severity</article-title>
               <source>Science</source>
               <year>2020</year>
               <volume>370</volume>
            </element-citation>
         </ref>
         <ref id="R54">
            <label>[54]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Sauer</surname>
                     <given-names>MM</given-names>
                  </name>
                  <name>
                     <surname>Tortorici</surname>
                     <given-names>MA</given-names>
                  </name>
                  <name>
                     <surname>Park</surname>
                     <given-names>Y-J</given-names>
                  </name>
                  <name>
                     <surname>Walls</surname>
                     <given-names>AC</given-names>
                  </name>
                  <name>
                     <surname>Homad</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Acton</surname>
                     <given-names>OJ</given-names>
                  </name>
                  <name>
                     <surname>Bowen</surname>
                     <given-names>JE</given-names>
                  </name>
                  <name>
                     <surname>Wang</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Xiong</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>de van der Schueren</surname>
                     <given-names>W</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Structural basis for broad coronavirus neutralization</article-title>
               <source>Nature Structural &amp; Molecular Biology</source>
               <year>2021</year>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R55">
            <label>[55]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Watanabe</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Allen</surname>
                     <given-names>JD</given-names>
                  </name>
                  <name>
                     <surname>Wrapp</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>McLellan</surname>
                     <given-names>JS</given-names>
                  </name>
                  <name>
                     <surname>Crispin</surname>
                     <given-names>M</given-names>
                  </name>
               </person-group>
               <article-title>Site-specific glycan analysis of the sars-cov-2 spike</article-title>
               <source>Science</source>
               <year>2020</year>
               <volume>369</volume>
               <fpage>330</fpage>
            </element-citation>
         </ref>
         <ref id="R56">
            <label>[56]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Evans</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>O’Neill</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Pritzel</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Antropova</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Senior</surname>
                     <given-names>AW</given-names>
                  </name>
                  <name>
                     <surname>Green</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Žídek</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Bates</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Blackwell</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Yim</surname>
                     <given-names>J</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Protein complex prediction with alphafold-multimer</article-title>
               <source>Biorxiv</source>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R57">
            <label>[57]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Buckle</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Schreiber</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Fersht</surname>
                     <given-names>AR</given-names>
                  </name>
               </person-group>
               <article-title>Protein-protein recognition: Crystal structural analysis of a barnase-barstar complex at 2.0-. ang. resolution</article-title>
               <source>Biochemistry</source>
               <year>1994</year>
               <volume>33</volume>
               <elocation-id>8878</elocation-id>
            </element-citation>
         </ref>
         <ref id="R58">
            <label>[58]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Fenalti</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Law</surname>
                     <given-names>RH</given-names>
                  </name>
                  <name>
                     <surname>Buckle</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Langendorf</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Tuck</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Rosado</surname>
                     <given-names>CJ</given-names>
                  </name>
                  <name>
                     <surname>Faux</surname>
                     <given-names>NG</given-names>
                  </name>
                  <name>
                     <surname>Mahmood</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Hampe</surname>
                     <given-names>CS</given-names>
                  </name>
                  <name>
                     <surname>Banga</surname>
                     <given-names>JP</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Gaba production by glutamic acid decarboxylase is regulated by a dynamic catalytic loop</article-title>
               <source>Nature structural &amp; molecular biology</source>
               <year>2007</year>
               <volume>14</volume>
               <fpage>280</fpage>
            </element-citation>
         </ref>
         <ref id="R59">
            <label>[59]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Goddard</surname>
                     <given-names>TD</given-names>
                  </name>
                  <name>
                     <surname>Huang</surname>
                     <given-names>CC</given-names>
                  </name>
                  <name>
                     <surname>Meng</surname>
                     <given-names>EC</given-names>
                  </name>
                  <name>
                     <surname>Pettersen</surname>
                     <given-names>EF</given-names>
                  </name>
                  <name>
                     <surname>Couch</surname>
                     <given-names>GS</given-names>
                  </name>
                  <name>
                     <surname>Morris</surname>
                     <given-names>JH</given-names>
                  </name>
                  <name>
                     <surname>Ferrin</surname>
                     <given-names>TE</given-names>
                  </name>
               </person-group>
               <article-title>Ucsf chimerax: Meeting modern challenges in visualization and analysis</article-title>
               <source>Protein Science</source>
               <year>2018</year>
               <volume>27</volume>
               <fpage>14</fpage>
            </element-citation>
         </ref>
         <ref id="R60">
            <label>[60]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Van der Maaten</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Hinton</surname>
                     <given-names>G</given-names>
                  </name>
               </person-group>
               <article-title>Visualizing data using t-sne</article-title>
               <source>Journal of machine learning research</source>
               <year>2008</year>
               <volume>9</volume>
            </element-citation>
         </ref>
         <ref id="R61">
            <label>[61]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kabsch</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Sander</surname>
                     <given-names>C</given-names>
                  </name>
               </person-group>
               <article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>
               <source>Biopolymers: Original Research on Biomolecules</source>
               <year>1983</year>
               <volume>22</volume>
               <elocation-id>2577</elocation-id>
            </element-citation>
         </ref>
         <ref id="R62">
            <label>[62]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Amaro</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Mulholland</surname>
                     <given-names>A</given-names>
                  </name>
               </person-group>
               <article-title>Biomolecular simulations in the time of covid19, and after</article-title>
               <source>Computing in Science &amp; Engineering</source>
               <year>2020</year>
            </element-citation>
         </ref>
         <ref id="R63">
            <label>[63]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Cock</surname>
                     <given-names>PJ</given-names>
                  </name>
                  <name>
                     <surname>Antao</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Chang</surname>
                     <given-names>JT</given-names>
                  </name>
                  <name>
                     <surname>Chapman</surname>
                     <given-names>BA</given-names>
                  </name>
                  <name>
                     <surname>Cox</surname>
                     <given-names>CJ</given-names>
                  </name>
                  <name>
                     <surname>Dalke</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Friedberg</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Hamelryck</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Kauff</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Wilczynski</surname>
                     <given-names>B</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>
               <source>Bioinformatics</source>
               <year>2009</year>
               <volume>25</volume>
               <fpage>1422</fpage>
            </element-citation>
         </ref>
         <ref id="R64">
            <label>[64]</label>
            <note>
               <p>If both are equally far away e.g. for isoleucine, we choose the first one according to the residue id</p>
            </note>
         </ref>
         <ref id="R65">
            <label>[65]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Remmert</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Biegert</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Hauser</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Söding</surname>
                     <given-names>J</given-names>
                  </name>
               </person-group>
               <article-title>Hhblits: lightning-fast iterative protein sequence searching by hmm-hmm alignment</article-title>
               <source>Nature methods</source>
               <year>2012</year>
               <volume>9</volume>
               <fpage>173</fpage>
            </element-citation>
         </ref>
         <ref id="R66">
            <label>[66]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Mirdita</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>von den Driesch</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Galiez</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Martin</surname>
                     <given-names>MJ</given-names>
                  </name>
                  <name>
                     <surname>Söding</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Steinegger</surname>
                     <given-names>M</given-names>
                  </name>
               </person-group>
               <article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>
               <source>Nucleic acids research</source>
               <year>2017</year>
               <volume>45</volume>
               <fpage>D170</fpage>
            </element-citation>
         </ref>
         <ref id="R67">
            <label>[67]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Cocco</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Feinauer</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Figliuzzi</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Monasson</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Weigt</surname>
                     <given-names>M</given-names>
                  </name>
               </person-group>
               <article-title>Inverse statistical physics of protein sequences: a key issues review</article-title>
               <source>Reports on Progress in Physics</source>
               <year>2018</year>
               <volume>81</volume>
               <elocation-id>032601</elocation-id>
            </element-citation>
         </ref>
         <ref id="R68">
            <label>[68]</label>
            <element-citation publication-type="book">
               <person-group person-group-type="author">
                  <name>
                     <surname>Posani</surname>
                     <given-names>L</given-names>
                  </name>
               </person-group>
               <source>Inference and modeling of biological networks: a statistical-physics approach to neural attractors and protein fitness landscapes</source>
               <publisher-name>Ph.D. thesis, Université Paris sciences et lettres</publisher-name>
               <year>2018</year>
            </element-citation>
         </ref>
         <ref id="R69">
            <label>[69]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chen</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Han</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Li</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Chen</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Xing</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Zhao</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Li</surname>
                     <given-names>H</given-names>
                  </name>
               </person-group>
               <article-title>Deep rbfnet: Point cloud feature learning using radial basis functions</article-title>
               <source>arXiv preprint</source>
               <year>2018</year>
               <elocation-id>arXiv:1812.04302</elocation-id>
            </element-citation>
         </ref>
         <ref id="R70">
            <label>[70]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Qi</surname>
                     <given-names>CR</given-names>
                  </name>
                  <name>
                     <surname>Su</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Mo</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Guibas</surname>
                     <given-names>LJ</given-names>
                  </name>
               </person-group>
               <source>Pointnet: Deep learning on point sets for 3d classification and segmentation</source>
               <conf-name>Proceedings of the IEEE conference on computer vision and pattern recognition</conf-name>
               <year>2017</year>
               <fpage>652</fpage>
               <lpage>660</lpage>
            </element-citation>
         </ref>
         <ref id="R71">
            <label>[71]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Qi</surname>
                     <given-names>CR</given-names>
                  </name>
                  <name>
                     <surname>Yi</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Su</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Guibas</surname>
                     <given-names>LJ</given-names>
                  </name>
               </person-group>
               <article-title>Pointnet++: Deep hierarchical feature learning on point sets in a metric space</article-title>
               <source>arXiv preprint</source>
               <year>2017</year>
               <elocation-id>arXiv:1706.02413</elocation-id>
            </element-citation>
         </ref>
         <ref id="R72">
            <label>[72]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Igashov</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Pavlichenko</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Grudinin</surname>
                     <given-names>S</given-names>
                  </name>
               </person-group>
               <article-title>Spherical convolutions on molecular graphs for protein model quality assessment</article-title>
               <source>Machine Learning: Science and Technology</source>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R73">
            <label>[73]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Tubiana</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Cocco</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Monasson</surname>
                     <given-names>R</given-names>
                  </name>
               </person-group>
               <article-title>Learning protein constitutive motifs from sequence data</article-title>
               <source>Elife</source>
               <year>2019</year>
               <volume>8</volume>
               <elocation-id>e39397</elocation-id>
            </element-citation>
         </ref>
         <ref id="R74">
            <label>[74]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ioffe</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Szegedy</surname>
                     <given-names>C</given-names>
                  </name>
               </person-group>
               <source>Batch normalization: Accelerating deep network training by reducing internal covariate shift</source>
               <conf-name>International conference on machine learning</conf-name>
               <conf-sponsor>PMLR</conf-sponsor>
               <year>2015</year>
               <fpage>448</fpage>
               <lpage>456</lpage>
            </element-citation>
         </ref>
         <ref id="R75">
            <label>[75]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Pedregosa</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Varoquaux</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Gramfort</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Michel</surname>
                     <given-names>V</given-names>
                  </name>
                  <name>
                     <surname>Thirion</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Grisel</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Blondel</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Prettenhofer</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Weiss</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Dubourg</surname>
                     <given-names>V</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Scikit-learn: Machine learning in python</article-title>
               <source>the Journal of machine Learning research</source>
               <year>2011</year>
               <volume>12</volume>
               <elocation-id>2825</elocation-id>
            </element-citation>
         </ref>
         <ref id="R76">
            <label>[76]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Long</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Shelhamer</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Darrell</surname>
                     <given-names>T</given-names>
                  </name>
               </person-group>
               <source>Fully convolutional networks for semantic segmentation</source>
               <conf-name>Proceedings of the IEEE conference on computer vision and pattern recognition</conf-name>
               <year>2015</year>
               <fpage>3431</fpage>
               <lpage>3440</lpage>
            </element-citation>
         </ref>
         <ref id="R77">
            <label>[77]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kingma</surname>
                     <given-names>DP</given-names>
                  </name>
                  <name>
                     <surname>Ba</surname>
                     <given-names>J</given-names>
                  </name>
               </person-group>
               <article-title>Adam: A method for stochastic optimization</article-title>
               <source>arXiv preprint</source>
               <year>2014</year>
               <elocation-id>arXiv:1412.6980</elocation-id>
            </element-citation>
         </ref>
         <ref id="R78">
            <label>[78]</label>
            <element-citation publication-type="confproc">
               <person-group person-group-type="author">
                  <name>
                     <surname>Abadi</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Barham</surname>
                     <given-names>P</given-names>
                  </name>
                  <name>
                     <surname>Chen</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Chen</surname>
                     <given-names>Z</given-names>
                  </name>
                  <name>
                     <surname>Davis</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Dean</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Devin</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Ghemawat</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Irving</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Isard</surname>
                     <given-names>M</given-names>
                  </name>
                  <etal/>
               </person-group>
               <source>Tensorflow: A system for large-scale machine learning</source>
               <conf-name>12th {USENIX} symposium on operating systems design and implementation ({OSDI} 16)</conf-name>
               <year>2016</year>
               <fpage>265</fpage>
               <lpage>283</lpage>
            </element-citation>
         </ref>
         <ref id="R79">
            <label>[79]</label>
            <element-citation publication-type="book">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chollet</surname>
                     <given-names>F</given-names>
                  </name>
               </person-group>
               <source>Deep learning with Python</source>
               <publisher-name>Simon and Schuster</publisher-name>
               <year>2017</year>
            </element-citation>
         </ref>
         <ref id="R80">
            <label>[80]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Song</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Tan</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Takemoto</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Akutsu</surname>
                     <given-names>T</given-names>
                  </name>
               </person-group>
               <article-title>Hsepred: predict half-sphere exposure from protein sequences</article-title>
               <source>Bioinformatics</source>
               <year>2008</year>
               <volume>24</volume>
               <fpage>1489</fpage>
            </element-citation>
         </ref>
         <ref id="R81">
            <label>[81]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chakravarty</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Varadarajan</surname>
                     <given-names>R</given-names>
                  </name>
               </person-group>
               <article-title>Residue depth: a novel parameter for the analysis of protein structure and stability</article-title>
               <source>Structure</source>
               <year>1999</year>
               <volume>7</volume>
               <fpage>723</fpage>
            </element-citation>
         </ref>
         <ref id="R82">
            <label>[82]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Sanner</surname>
                     <given-names>MF</given-names>
                  </name>
                  <name>
                     <surname>Olson</surname>
                     <given-names>AJ</given-names>
                  </name>
                  <name>
                     <surname>Spehner</surname>
                     <given-names>J-C</given-names>
                  </name>
               </person-group>
               <article-title>Reduced surface: an efficient way to compute molecular surfaces</article-title>
               <source>Biopolymers</source>
               <year>1996</year>
               <volume>38</volume>
               <fpage>305</fpage>
            </element-citation>
         </ref>
         <ref id="R83">
            <label>[83]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Connolly</surname>
                     <given-names>ML</given-names>
                  </name>
               </person-group>
               <article-title>Shape complementarity at the hemoglobin <italic>α</italic>1<italic>β</italic>1 subunit interface</article-title>
               <source>Biopolymers</source>
               <year>1986</year>
               <volume>25</volume>
               <fpage>1229</fpage>
            </element-citation>
         </ref>
         <ref id="R84">
            <label>[84]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Fu</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Niu</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>Z</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Li</surname>
                     <given-names>W</given-names>
                  </name>
               </person-group>
               <article-title>Cd-hit: accelerated for clustering the next-generation sequencing data</article-title>
               <source>Bioinformatics</source>
               <year>2012</year>
               <volume>28</volume>
               <elocation-id>3150</elocation-id>
            </element-citation>
         </ref>
         <ref id="R85">
            <label>[85]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Li</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Godzik</surname>
                     <given-names>A</given-names>
                  </name>
               </person-group>
               <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
               <source>Bioinformatics</source>
               <year>2006</year>
               <volume>22</volume>
               <fpage>1658</fpage>
            </element-citation>
         </ref>
         <ref id="R86">
            <label>[86]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Nakamura</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Yamada</surname>
                     <given-names>KD</given-names>
                  </name>
                  <name>
                     <surname>Tomii</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Katoh</surname>
                     <given-names>K</given-names>
                  </name>
               </person-group>
               <article-title>Parallelization of mafft for large-scale multiple sequence alignments</article-title>
               <source>Bioinformatics</source>
               <year>2018</year>
               <volume>34</volume>
               <fpage>2490</fpage>
            </element-citation>
         </ref>
         <ref id="R87">
            <label>[87]</label>
            <note>
               <p>For the PPBS data set, 8.9% of the binding site residues are actually in unbound conformation, as their label was inferred from another pdb file, see data preparation</p>
            </note>
         </ref>
         <ref id="R88">
            <label>[88]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kirys</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Ruvinsky</surname>
                     <given-names>AM</given-names>
                  </name>
                  <name>
                     <surname>Singla</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Tuzikov</surname>
                     <given-names>AV</given-names>
                  </name>
                  <name>
                     <surname>Kundrotas</surname>
                     <given-names>PJ</given-names>
                  </name>
                  <name>
                     <surname>Vakser</surname>
                     <given-names>IA</given-names>
                  </name>
               </person-group>
               <article-title>Simulated unbound structures for benchmarking of protein docking in the dockground resource</article-title>
               <source>BMC bioinformatics</source>
               <year>2015</year>
               <volume>16</volume>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R89">
            <label>[89]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Ghani</surname>
                     <given-names>U</given-names>
                  </name>
                  <name>
                     <surname>Desta</surname>
                     <given-names>I</given-names>
                  </name>
                  <name>
                     <surname>Jindal</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Khan</surname>
                     <given-names>O</given-names>
                  </name>
                  <name>
                     <surname>Jones</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Kotelnikov</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Padhorny</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Vajda</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Kozakov</surname>
                     <given-names>D</given-names>
                  </name>
               </person-group>
               <article-title>Improved docking of protein models by a combination of alphafold2 and cluspro</article-title>
               <source>BioRxiv</source>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R90">
            <label>[90]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Mirdita</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Schütze</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Moriwaki</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Heo</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Ovchinnikov</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Steinegger</surname>
                     <given-names>M</given-names>
                  </name>
               </person-group>
               <article-title>Colabfold-making protein folding accessible to all</article-title>
               <year>2021</year>
            </element-citation>
         </ref>
         <ref id="R91">
            <label>[91]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Jankauskaitė</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Jiménez-García</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Dapkūnas</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Fernández-Recio</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Moal</surname>
                     <given-names>IH</given-names>
                  </name>
               </person-group>
               <article-title>Skempi 2.0: an updated benchmark of changes in protein–protein binding energy, kinetics and thermodynamics upon mutation</article-title>
               <source>Bioinformatics</source>
               <year>2019</year>
               <volume>35</volume>
               <fpage>462</fpage>
            </element-citation>
         </ref>
         <ref id="R92">
            <label>[92]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Vreven</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Moal</surname>
                     <given-names>IH</given-names>
                  </name>
                  <name>
                     <surname>Vangone</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Pierce</surname>
                     <given-names>BG</given-names>
                  </name>
                  <name>
                     <surname>Kastritis</surname>
                     <given-names>PL</given-names>
                  </name>
                  <name>
                     <surname>Torchala</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Chaleil</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Jiménez-García</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Bates</surname>
                     <given-names>PA</given-names>
                  </name>
                  <name>
                     <surname>Fernandez-Recio</surname>
                     <given-names>J</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Updates to the integrated protein–protein interaction benchmarks: docking benchmark version 5 and affinity benchmark version 2</article-title>
               <source>Journal of molecular biology</source>
               <year>2015</year>
               <volume>427</volume>
               <elocation-id>3031</elocation-id>
            </element-citation>
         </ref>
         <ref id="R93">
            <label>[93]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Alford</surname>
                     <given-names>RF</given-names>
                  </name>
                  <name>
                     <surname>Leaver-Fay</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Jeliazkov</surname>
                     <given-names>JR</given-names>
                  </name>
                  <name>
                     <surname>O’Meara</surname>
                     <given-names>MJ</given-names>
                  </name>
                  <name>
                     <surname>DiMaio</surname>
                     <given-names>FP</given-names>
                  </name>
                  <name>
                     <surname>Park</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Shapovalov</surname>
                     <given-names>MV</given-names>
                  </name>
                  <name>
                     <surname>Renfrew</surname>
                     <given-names>PD</given-names>
                  </name>
                  <name>
                     <surname>Mulligan</surname>
                     <given-names>VK</given-names>
                  </name>
                  <name>
                     <surname>Kappel</surname>
                     <given-names>K</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>The rosetta all-atom energy function for macromolecular modeling and design</article-title>
               <source>Journal of chemical theory and computation</source>
               <year>2017</year>
               <volume>13</volume>
               <elocation-id>3031</elocation-id>
            </element-citation>
         </ref>
         <ref id="R94">
            <label>[94]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Chaudhury</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Lyskov</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Gray</surname>
                     <given-names>JJ</given-names>
                  </name>
               </person-group>
               <article-title>Pyrosetta: a script-based interface for implementing molecular modeling algorithms using rosetta</article-title>
               <source>Bioinformatics</source>
               <year>2010</year>
               <volume>26</volume>
               <fpage>689</fpage>
            </element-citation>
         </ref>
         <ref id="R95">
            <label>[95]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>NC</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Zhao</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Huang</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Yu</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Hua</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Tien</surname>
                     <given-names>H</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Structural basis of a public antibody response to sars-cov-2</article-title>
               <source>BioRxiv</source>
               <year>2020</year>
            </element-citation>
         </ref>
         <ref id="R96">
            <label>[96]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Wu</surname>
                     <given-names>NC</given-names>
                  </name>
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Bangaru</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Torres</surname>
                     <given-names>JL</given-names>
                  </name>
                  <name>
                     <surname>Caniels</surname>
                     <given-names>TG</given-names>
                  </name>
                  <name>
                     <surname>Brouwer</surname>
                     <given-names>PJ</given-names>
                  </name>
                  <name>
                     <surname>Van Gils</surname>
                     <given-names>MJ</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>An alternative binding mode of ighv3-53 antibodies to the sars-cov-2 receptor binding domain</article-title>
               <source>Cell reports</source>
               <year>2020</year>
               <volume>33</volume>
               <elocation-id>108274</elocation-id>
            </element-citation>
         </ref>
         <ref id="R97">
            <label>[97]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Kreye</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Reincke</surname>
                     <given-names>SM</given-names>
                  </name>
                  <name>
                     <surname>Kornau</surname>
                     <given-names>H-C</given-names>
                  </name>
                  <name>
                     <surname>Sánchez-Sendin</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Corman</surname>
                     <given-names>VM</given-names>
                  </name>
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>NC</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>A therapeutic non-self-reactive sars-cov-2 antibody protects from lung pathology in a covid-19 hamster model</article-title>
               <source>Cell</source>
               <year>2020</year>
               <volume>183</volume>
               <fpage>1058</fpage>
            </element-citation>
         </ref>
         <ref id="R98">
            <label>[98]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Hansen</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Baum</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Pascal</surname>
                     <given-names>KE</given-names>
                  </name>
                  <name>
                     <surname>Russo</surname>
                     <given-names>V</given-names>
                  </name>
                  <name>
                     <surname>Giordano</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Wloga</surname>
                     <given-names>E</given-names>
                  </name>
                  <name>
                     <surname>Fulton</surname>
                     <given-names>BO</given-names>
                  </name>
                  <name>
                     <surname>Yan</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Koon</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Patel</surname>
                     <given-names>K</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Studies in humanized mice and convalescent humans yield a sars-cov-2 antibody cocktail</article-title>
               <source>Science</source>
               <year>2020</year>
               <volume>369</volume>
               <fpage>1010</fpage>
            </element-citation>
         </ref>
         <ref id="R99">
            <label>[99]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Huang</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Bangaru</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Zhao</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <name>
                     <surname>Peng</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Barman</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Nemazee</surname>
                     <given-names>D</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>A combination of cross-neutralizing antibodies synergizes to prevent sars-cov-2 and sars-cov pseudovirus infection</article-title>
               <source>Cell host &amp; microbe</source>
               <year>2021</year>
               <volume>29</volume>
               <fpage>806</fpage>
            </element-citation>
         </ref>
         <ref id="R100">
            <label>[100]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Liu</surname>
                     <given-names>H</given-names>
                  </name>
                  <name>
                     <surname>Wu</surname>
                     <given-names>NC</given-names>
                  </name>
                  <name>
                     <surname>Yuan</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Bangaru</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Torres</surname>
                     <given-names>JL</given-names>
                  </name>
                  <name>
                     <surname>Caniels</surname>
                     <given-names>TG</given-names>
                  </name>
                  <name>
                     <surname>Van Schooten</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Zhu</surname>
                     <given-names>X</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>C-CD</given-names>
                  </name>
                  <name>
                     <surname>Brouwer</surname>
                     <given-names>PJ</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Cross-neutralization of a sars-cov-2 antibody to a functionally conserved site is mediated by avidity</article-title>
               <source>Immunity</source>
               <year>2020</year>
               <volume>53</volume>
               <fpage>1272</fpage>
            </element-citation>
         </ref>
         <ref id="R101">
            <label>[101]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Cerutti</surname>
                     <given-names>G</given-names>
                  </name>
                  <name>
                     <surname>Guo</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Zhou</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Gorman</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Lee</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Rapp</surname>
                     <given-names>M</given-names>
                  </name>
                  <name>
                     <surname>Reddem</surname>
                     <given-names>ER</given-names>
                  </name>
                  <name>
                     <surname>Yu</surname>
                     <given-names>J</given-names>
                  </name>
                  <name>
                     <surname>Bahna</surname>
                     <given-names>F</given-names>
                  </name>
                  <name>
                     <surname>Bimela</surname>
                     <given-names>J</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Potent sars-cov-2 neutralizing antibodies directed against spike n-terminal domain target a single supersite</article-title>
               <source>Cell Host &amp; Microbe</source>
               <year>2021</year>
               <volume>29</volume>
               <fpage>819</fpage>
            </element-citation>
         </ref>
         <ref id="R102">
            <label>[102]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Lee</surname>
                     <given-names>PS</given-names>
                  </name>
                  <name>
                     <surname>Ohshima</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Stanfield</surname>
                     <given-names>RL</given-names>
                  </name>
                  <name>
                     <surname>Yu</surname>
                     <given-names>W</given-names>
                  </name>
                  <name>
                     <surname>Iba</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Okuno</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Kurosawa</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Wilson</surname>
                     <given-names>IA</given-names>
                  </name>
               </person-group>
               <article-title>Receptor mimicry by antibody f045–092 facilitates universal binding to the h3 subtype of influenza virus</article-title>
               <source>Nature communications</source>
               <year>2014</year>
               <volume>5</volume>
               <fpage>1</fpage>
            </element-citation>
         </ref>
         <ref id="R103">
            <label>[103]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Gamblin</surname>
                     <given-names>S</given-names>
                  </name>
                  <name>
                     <surname>Haire</surname>
                     <given-names>L</given-names>
                  </name>
                  <name>
                     <surname>Russell</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Stevens</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Xiao</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Ha</surname>
                     <given-names>Y</given-names>
                  </name>
                  <name>
                     <surname>Vasisht</surname>
                     <given-names>N</given-names>
                  </name>
                  <name>
                     <surname>Steinhauer</surname>
                     <given-names>D</given-names>
                  </name>
                  <name>
                     <surname>Daniels</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Elliot</surname>
                     <given-names>A</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>The structure and receptor binding properties of the 1918 influenza hemagglutinin</article-title>
               <source>Science</source>
               <year>2004</year>
               <volume>303</volume>
               <fpage>1838</fpage>
            </element-citation>
         </ref>
         <ref id="R104">
            <label>[104]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Stewart-Jones</surname>
                     <given-names>GB</given-names>
                  </name>
                  <name>
                     <surname>Soto</surname>
                     <given-names>C</given-names>
                  </name>
                  <name>
                     <surname>Lemmin</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Chuang</surname>
                     <given-names>G-Y</given-names>
                  </name>
                  <name>
                     <surname>Druz</surname>
                     <given-names>A</given-names>
                  </name>
                  <name>
                     <surname>Kong</surname>
                     <given-names>R</given-names>
                  </name>
                  <name>
                     <surname>Thomas</surname>
                     <given-names>PV</given-names>
                  </name>
                  <name>
                     <surname>Wagh</surname>
                     <given-names>K</given-names>
                  </name>
                  <name>
                     <surname>Zhou</surname>
                     <given-names>T</given-names>
                  </name>
                  <name>
                     <surname>Behrens</surname>
                     <given-names>A-J</given-names>
                  </name>
                  <etal/>
               </person-group>
               <article-title>Trimeric hiv-1-env structures define glycan shields from clades a, b, and g</article-title>
               <source>Cell</source>
               <year>2016</year>
               <volume>165</volume>
               <fpage>813</fpage>
            </element-citation>
         </ref>
         <ref id="R105">
            <label>[105]</label>
            <element-citation publication-type="journal">
               <person-group person-group-type="author">
                  <name>
                     <surname>Hie</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Zhong</surname>
                     <given-names>ED</given-names>
                  </name>
                  <name>
                     <surname>Berger</surname>
                     <given-names>B</given-names>
                  </name>
                  <name>
                     <surname>Bryson</surname>
                     <given-names>B</given-names>
                  </name>
               </person-group>
               <article-title>Learning the language of viral evolution and escape</article-title>
               <source>Science</source>
               <year>2021</year>
               <volume>371</volume>
               <fpage>284</fpage>
            </element-citation>
         </ref>
      </ref-list>
   </back>
   <floats-group>
      <fig id="F1" position="float">
         <label>Fig. 1</label>
         <caption>
            <title>Overview of the ScanNet architecture</title>
            <p>ScanNet inputs are the primary sequence, tertiary structure, and, optionally, position-weight matrix (PWM) computed from a multiple sequence alignment (MSA) of evolutionary-related proteins. Firstly, for each atom, neighboring atoms are extracted from the structure and positioned in a local coordinate frame (top left). The resulting point cloud is passed through a set of trainable, linear filters detecting specific spatio-chemical arrangements (top middle), yielding an atomic scale representation (top right). After aggregation of the atomic representation at amino acid (AA) level and concatenation with AA attributes, the process is reiterated with AA to obtain a representation of AA (bottom). The later is projected and locally averaged for residue-wise classification.</p>
         </caption>
         <graphic xlink:href="EMS134319-f001"/>
      </fig>
      <fig id="F2" position="float">
         <label>Fig. 2</label>
         <caption>
            <title>Prediction of Protein-Protein Binding Sites (PPBS) with ScanNet</title>
            <p>(a)-(d) Precision-Recall curves of PPBS prediction for ScanNet, Structural homology, and Handcrafted features baseline methods (see main text). Train and test sets constructed from the redundant Dockground template database [<xref ref-type="bibr" rid="R45">45</xref>]. Proteins of the test set are subdivided into four non-overlapping groups (a) <italic>Test 70%</italic>: At least 70% sequence identity with at least one train set example. (b) <italic>Test Homology</italic>: At most 70% sequence identity with any train set example, at least one train set example belonging to same protein superfamily (H level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]). (c) <italic>Test Topology</italic>: At least one train set example with similar protein topology (T level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]), none with similar protein superfamily. (d) <italic>Test None</italic>: None of the above. (e),(f) Illustration of predicted PPBS for (e) an enzyme (barnase, PDB ID: 1brs:A [<xref ref-type="bibr" rid="R57">57</xref>], Val. Homology dataset) with its inhibitor overlaid and (f) an homodimer (glutamic acid decarboxylase GAD67, PDB ID: 2okj:A [<xref ref-type="bibr" rid="R58">58</xref>], Test Topology dataset). The molecular surface of the query protein is shown with coloring based on predicted probability, ranging from low (white) to high (dark blue). The partner protein is shown in cartoon representation (gray transparent). Visualization software: ChimeraX [<xref ref-type="bibr" rid="R59">59</xref>]</p>
         </caption>
         <graphic xlink:href="EMS134319-f002"/>
      </fig>
      <fig id="F3" position="float">
         <label>Fig. 3</label>
         <caption>
            <title>Visualisation of the learnt atomic representation</title>
            <p>The panels (a)-(f) show each one spatio-chemical pattern on the left and one corresponding top-activating neighborhood on the right. Each pattern is depicted as follows: only the gaussian kernels relevant to the pattern are shown; they are represented by their unit ellipsoid. The corresponding location-wise attribute specificity is depicted as a weight logo inside the ellipsoid, similar to a position weight matrix: attributes with <italic>non-zero</italic> weights are stacked on top of one another with letter height proportional to their <italic>algebraic</italic> weight value, sorted from strongest positive (top) to strongest negative (bottom, reversed letters). The unit ellipsoid is colored based on the maximally activating attribute type if it is positive, or gray otherwise. Color code: carbon (beige), oxygen (red), nitrogen (blue), sulfur (yellow). The frame is overlaid in gray, with axes extending over 3.75 Å. Each filter/neighborhood pair is oriented independently for clarity. Visualizations created with pythreejs. (g), (h) Two-dimensional projection of the learnt atomic scale representation using T-SNE [<xref ref-type="bibr" rid="R60">60</xref>]. Each point corresponds to one atom of a representative set of proteins. Coloring based on atom coordination index (g) or electrostatic potential at the atom location, computed using APBS [<xref ref-type="bibr" rid="R49">49</xref>] (h).</p>
         </caption>
         <graphic xlink:href="EMS134319-f003"/>
      </fig>
      <fig id="F4" position="float">
         <label>Fig. 4</label>
         <caption>
            <title>Visualisation of the learnt amino acid representation</title>
            <p>The panels (a)-(f) show each one spatio-chemical pattern on the left and one corresponding top-activating neighborhood on the right. Gaussian kernels are depicted similarly as in <xref ref-type="fig" rid="F3">Fig. 3</xref>. Since the input attributes are learnt, each component of a pattern is characterized by a complex specificity in attribute space. We represent it by the distributions of amino acid types and accessible surface areas of its top 1% maximally activating residues. The distributions are shown as a logo (each letter or symbol is proportional to the probability), with a total height proportional to the mean activation of the set. Accessible surface area values are discretized into four quartiles and represented as pie charts (from full gray = buried to full blue = accessible). Amino acids are colored by chemical properties: negatively charged (red), positively charged (blue), polar (purple), hydrophobic (black), sulfur-containing (green), aromatic (gold), tiny/proline (gray). The frame is overlaid in gray, with axes extending over 9 Å. Each filter/neighborhood pair is oriented independently for clarity. Visualizations created with pythreejs. (g), (h) Two-dimensional projection of the learnt amino acid scale representation using T-SNE [<xref ref-type="bibr" rid="R60">60</xref>]. Each point corresponds to one amino acid of a representative set of proteins. Coloring based on secondary structure (g) or accessible surface area (h) calculated with DSSP [<xref ref-type="bibr" rid="R61">61</xref>]. Additional T-SNE plots available in <xref ref-type="supplementary-material" rid="SD4">Sup. Fig. S19</xref>.</p>
         </caption>
         <graphic xlink:href="EMS134319-f004"/>
      </fig>
      <fig id="F5" position="float">
         <label>Fig. 5</label>
         <caption>
            <title>Prediction of B-cell Epitopes with ScanNet</title>
            <p>(a) Precision-Recall curve of B-cell epitope prediction for baseline methods, Discotope [<xref ref-type="bibr" rid="R51">51</xref>] and ScanNet. Epitope database constructed from SabDab (timestamp: 04/19/2021) [<xref ref-type="bibr" rid="R50">50</xref>]; 5-fold cross-validation performance is shown. (b)-(e) Selected learnt amino acid neighborhood filters whose activity is positively correlated with epitope probability. Same visualization as <xref ref-type="fig" rid="F4">Fig. 4</xref>. (f) Application to Spike protein of SARS-CoV-2. Predictions performed on a MD snapshot of the spike trimer with one RBD open [<xref ref-type="bibr" rid="R62">62</xref>]. The monomer with open conformation is represented as molecular surface with color corresponding to BCE probability, from white (low) to dark blue (high). Representative antibodies binding the main epitopes are superimposed in color, cartoon representation, see full list in <xref ref-type="supplementary-material" rid="SD4">Sup. Table S6</xref>.</p>
         </caption>
         <graphic xlink:href="EMS134319-f005"/>
      </fig>
      <table-wrap id="T1" position="float" orientation="portrait">
         <label>Table I</label>
         <caption>
            <title>Performance evaluation for prediction of Protein-protein binding sites.</title>
            <p>Area under Precision Recall Curve (AUCPR) is shown. Proteins of the test set are subdivided into four non-overlapping groups. <italic>Test 70%</italic>: At least 70% sequence identity with at least one train set example. <italic>Test Homology</italic>: At most 70% sequence identity with any train set example, at least one train set example belonging to same protein superfamily (H level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]). <italic>Test Topology</italic>: At least one train set example with similar protein topology (T level of CATH classification [<xref ref-type="bibr" rid="R48">48</xref>]), none with similar protein superfamily. <italic>Test None</italic>: None of the above. For Masif-site, only the aggregated performance is shown since its training set differs from ours. See <xref ref-type="supplementary-material" rid="SD4">Sup. Tables S2,S3</xref> for additional evaluation metrics</p>
         </caption>
         <table frame="box" rules="cols">
            <thead>
               <tr>
                  <th align="center" valign="top">Algorithm</th>
                  <th align="center" valign="top">Test (70%)</th>
                  <th align="center" valign="top">Test (Homology)</th>
                  <th align="center" valign="top">Test (Topology)</th>
                  <th align="center" valign="top">Test (None)</th>
                  <th align="center" valign="top">Test (All)</th>
               </tr>
            </thead>
            <tbody>
               <tr style="border-top: solid thin">
                  <td align="center" valign="top">Structural homology baseline</td>
                  <td align="center" valign="top">
                     <bold>0.828</bold>
                  </td>
                  <td align="center" valign="top">0.696</td>
                  <td align="center" valign="top">0.535</td>
                  <td align="center" valign="top">0.387</td>
                  <td align="center" valign="top">0.613</td>
               </tr>
               <tr>
                  <td align="center" valign="top">Handcrafted features baseline</td>
                  <td align="center" valign="top">0.596</td>
                  <td align="center" valign="top">0.567</td>
                  <td align="center" valign="top">0.568</td>
                  <td align="center" valign="top">0.432</td>
                  <td align="center" valign="top">0.537</td>
               </tr>
               <tr>
                  <td align="center" valign="top">Masif-site [<xref ref-type="bibr" rid="R36">36</xref>]</td>
                  <td align="center" valign="top">NA</td>
                  <td align="center" valign="top">NA</td>
                  <td align="center" valign="top">NA</td>
                  <td align="center" valign="top">NA</td>
                  <td align="center" valign="top">0.533</td>
               </tr>
               <tr style="border-bottom: solid thin">
                  <td align="center" valign="top">ScanNet</td>
                  <td align="center" valign="top">0.732</td>
                  <td align="center" valign="top">
                     <bold>0.712</bold>
                  </td>
                  <td align="center" valign="top">
                     <bold>0.735</bold>
                  </td>
                  <td align="center" valign="top">
                     <bold>0.605</bold>
                  </td>
                  <td align="center" valign="top">
                     <bold>0.694</bold>
                  </td>
               </tr>
               <tr>
                  <td align="center" valign="top">ScanNet (no evolutionary information)</td>
                  <td align="center" valign="top">0.672</td>
                  <td align="center" valign="top">0.648</td>
                  <td align="center" valign="top">0.685</td>
                  <td align="center" valign="top">0.565</td>
                  <td align="center" valign="top">0.639</td>
               </tr>
               <tr>
                  <td align="center" valign="top">ScanNet (no atomic information)</td>
                  <td align="center" valign="top">0.697</td>
                  <td align="center" valign="top">0.672</td>
                  <td align="center" valign="top">0.689</td>
                  <td align="center" valign="top">0.547</td>
                  <td align="center" valign="top">0.648</td>
               </tr>
               <tr>
                  <td align="center" valign="top">ScanNet (no regularization)</td>
                  <td align="center" valign="top">0.756</td>
                  <td align="center" valign="top">0.702</td>
                  <td align="center" valign="top">0.701</td>
                  <td align="center" valign="top">0.572</td>
                  <td align="center" valign="top">0.678</td>
               </tr>
               <tr>
                  <td align="center" valign="top">ScanNet (no reweighting)</td>
                  <td align="center" valign="top">0.702</td>
                  <td align="center" valign="top">0.668</td>
                  <td align="center" valign="top">0.683</td>
                  <td align="center" valign="top">0.553</td>
                  <td align="center" valign="top">0.648</td>
               </tr>
            </tbody>
         </table>
      </table-wrap>
   </floats-group>
</article>