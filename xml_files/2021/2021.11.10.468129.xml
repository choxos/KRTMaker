<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS162957</article-id><article-id pub-id-type="doi">10.1101/2021.11.10.468129</article-id><article-id pub-id-type="archive">PPR419388</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group><subj-group subj-group-type="europepmc-category"><subject>Covid-19</subject></subj-group></article-categories><title-group><article-title>CORSID enables <italic>de novo</italic> identification of transcription regulatory sequences and genes in coronaviruses</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Chuanyi</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author"><name><surname>Sashittal</surname><given-names>Palash</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author"><name><surname>El-Kebir</surname><given-names>Mohammed</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="CR1">†</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Electrical &amp; Computer Engineering, University of Illinois at Urbana-Champaign, IL 61801</aff><aff id="A2"><label>2</label>Department of Computer Science, University of Illinois at Urbana-Champaign, IL 61801</aff><author-notes><corresp id="CR1"><label>†</label>Correspondence: <email>melkebir@illinois.edu</email></corresp><fn id="FN1"><label>*</label><p id="P1">Joint first authorship</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>20</day><month>01</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>12</day><month>11</month><year>2021</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Genes in coronaviruses are preceded by transcription regulatory sequences (TRSs), which play a critical role in gene expression mediated by the viral RNA-dependent RNA-polymerase via the process of discontinuous transcription. In addition to being crucial for our understanding of the regulation and expression of coronavirus genes, we demonstrate for the first time how TRSs can be leveraged to identify gene locations in the coronavirus genome. To that end, we formulate the TRS AND GENE IDENTIFICATION (TRS-GENE-ID) problem of simultaneously identifying TRS sites and gene locations in unannotated coronavirus genomes. We introduce CORSID (CORe Sequence IDentifier), a computational tool to solve this problem. We also present CORSID-A, which solves a constrained version of the TRS-GENE-ID problem, the TRS IDENTIFICATION (TRS-ID) problem, identifying TRS sites in a coronavirus genome with specified gene annotations. We show that CORSID-A outperforms existing motif-based methods in identifying TRS sites in coronaviruses and that CORSID outperforms state-of-the-art gene finding methods in finding genes in coronavirus genomes. We demonstrate that CORSID enables <italic>de novo</italic> identification of TRS sites and genes in previously unannotated coronaviruses. CORSID is the first method to perform accurate and simultaneous identification of TRS sites and genes in coronavirus genomes without the use of any prior information.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>1</label><title>Introduction</title><p id="P3">Coronaviruses are comprised of a single-stranded RNA genome that is ready to be translated by the host ribosome (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). While the majority of messenger RNA (mRNA) in eukaryotes is <italic>monocistronic</italic>, <italic>i.e.</italic> each mRNA is translated into a single gene product, the coronavirus RNA genome is comprised of many genes, which are expressed and translated using two distinct mechanisms [<xref ref-type="bibr" rid="R15">15</xref>]. First, upon entry, the viral genome is translated to produce polypeptides corresponding to one or two overlapping open reading frames (ORFs). Second, the resulting polypeptides undergo auto-cleavage, producing many non-structural proteins, including RNA-dependent-RNA-polymerase (RdRP), which mediates the expression of the remaining viral genes via <italic>discontinuous transcription</italic> [<xref ref-type="bibr" rid="R22">22</xref>]. That is, RdRP is prone to perform template switching upon encountering <italic>transcription regulatory sequences</italic> (TRSs) located in the 5’ untranslated region (UTR) of the genome — called TRS-L where L stands for leader — and upstream of each viral gene — called TRS-B where B stands for body (<xref ref-type="fig" rid="F1">Fig. 1b</xref>). This mechanism yields multiple subgenomic mRNAs that are translated into the structural and accessory viral proteins, necessary for the viral life cycle. Not only is the identification and characterization of TRS sites crucial to understanding the regulation and expression of the viral proteins, but here we hypothesize that the existence of these regulatory sequences can be leveraged to simultaneously identify TRS sites and associated viral genes in unannotated coronavirus genomes with high accuracy.</p><p id="P4">While there exist methods for identifying either TRS sites or viral genes, no method exists that does so simultaneously (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>). More specifically, since TRSs contain 6 – 7 nt long conserved sequences, called <italic>core sequences</italic> [<xref ref-type="bibr" rid="R8">8</xref>,<xref ref-type="bibr" rid="R25">25</xref>], general-purpose motif finding methods [<xref ref-type="bibr" rid="R2">2</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R29">29</xref>] can be employed to identify TRS-L and TRS-Bs in coronaviruses. For instance, MEME [<xref ref-type="bibr" rid="R2">2</xref>] is a widely used method that employs expectation maximization to identify multiple appearances of multiple motifs simultaneously. The only method that is specifically developed for identifying TRS sites in coronaviruses is SuPER [<xref ref-type="bibr" rid="R28">28</xref>], which takes as input a coronavirus genome sequence with specified gene locations as well as additional taxonomic and secondary structure information. Importantly, SuPER as well as other general-purpose motif finding algorithms are unable to identify viral genes in unannotated coronavirus genome sequences. On the other hand, gene prediction is a well-studied problem with many methods including Glimmer3 [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R21">21</xref>] and Prodigal [<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R13">13</xref>]. Glimmer3 uses a Markov model to assign scores to ORFs, and then processes overlapping genes to generate the final list of predicted genes. By contrast, Prodigal employs a more heuristic approach with fine-tuned parameters that are optimized to identify genes in prokaryotes. However, these general-purpose gene finding tools are not designed to leverage the genomic structure of coronaviruses, specifically the TRS sites located upstream of the genes in the genome, nor are they able to directly identify these regulatory sequences.</p><p id="P5">In this study, we introduce the TRS IDENTIFICATION (TRS-ID) and the TRS AND GENE IDENTIFICATION (TRS-GENE-ID) problems, to identify TRS sites in a coronavirus genome with specified gene annotations, and to simultaneously identifying TRS sites and genes in an unannotated coronavirus genome, respectively (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). Underpinning our approach is the concept of a <italic>TRS alignment</italic>, which is a multiple sequence alignment of TRS sites with additional constraints that result from template switching by RdRP. We introduce CORSID-A, a dynamic programming (DP) algorithm to solve the TRS-ID problem, adapting the recurrence that underlies the Smith-Waterman algorithm [<xref ref-type="bibr" rid="R24">24</xref>] for local sequence alignment. Additionally, we introduce CORSID to solve the TRS-GENE-ID problem via a maximum-weight independent set problem [<xref ref-type="bibr" rid="R11">11</xref>] on an interval graph defined by the candidate ORFs in the genome with weights obtained from the previous DP. We evaluate the performance of our methods on 468 coronavirus genomes downloaded from GenBank, demonstrating that CORSID-A outperforms MEME and SuPER in identifying TRS sites and, unlike these methods, possesses the ability to identify recombination events. Moreover, we find that CORSID vastly outperforms state-of-the-art gene finding methods. Finally, we illustrate how CORSID enables <italic>de novo</italic> identification of TRS sites and genes in previously unannotated coronaviruses. In summary, CORSID is the first method to perform accurate and simultaneous identification of TRS sites and genes in coronavirus genomes without the use of prior taxonomic or secondary structure information.</p></sec><sec id="S2"><label>2</label><title>Problem Statement</title><p id="P6">We begin by introducing notation and key definitions (<xref ref-type="sec" rid="S3">Section 2.1</xref>), followed by stating the TRS IDENTIFI-CATION problem (<xref ref-type="sec" rid="S8">Section 2.2</xref>) and then the TRS AND GENE IDENTIFICATION problem (<xref ref-type="sec" rid="S10">Section 2.3</xref>).</p><sec id="S3"><label>2.1</label><title>Preliminaries</title><p id="P7">A <italic>genome</italic> <bold>v</bold> = <italic>v</italic><sub>1</sub> … <italic>v</italic>|<bold>v</bold>| is a sequence from the alphabet Σ = A, T, C, G . The first position of the genome is known as the <italic>5’ end</italic> whereas the last position of the genome is known as the <italic>3’ end</italic>. We denote the contiguous subsequence <italic>v<sub>p</sub> … v<sub>q</sub></italic> of <bold>v</bold> by <bold>v</bold>[<italic>p, q</italic>]. We call a contiguous subsequence <bold>x</bold> of <bold>v</bold> also a <italic>region</italic>, denoted as <bold>x</bold> = [<italic>x</italic><sup>−</sup><italic>, x</italic><sup>+</sup>] such that <bold>x</bold> = <bold>v</bold>[<italic>x</italic><sup>−</sup><italic>, x</italic><sup>+</sup>]. Thus, coordinates <italic>x</italic><sup>−</sup> and <italic>x</italic><sup>+</sup> of a subsequence <bold>x</bold> are in terms of the reference genome <bold>v</bold>, <italic>i.e.</italic> <bold>x</bold> = <italic>vx− … vx</italic>+ . Alternatively, we may refer to individual characters in a subsequence <bold>x</bold> using relative indices, <italic>i.e.</italic> <bold>x</bold> = <italic>x</italic><sub>1</sub> … <italic>x</italic><sub>|<bold>x</bold>|</sub>. Our goals are twofold: given a coronavirus genome <bold>v</bold>, we aim to identify (i) TRS-L and TRS-Bs, and optionally, (ii) the associated genes (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). To begin, recall the following definition of an alignment.</p><sec id="S4"><title>Definition 1</title><p id="P8">Matrix <italic>A</italic> = [<italic>a<sub>ij</sub></italic>] with <italic>n</italic> + 1 rows is an <italic>alignment</italic> of sequences <bold>w</bold><sub>0</sub><italic>, … ,</italic> <bold>w</bold><sub><italic>n</italic></sub> ∈ Σ* provided (i) entries <italic>a<sub>ij</sub></italic> either correspond to a letter in the alphabet Σ or a gap denoted by ‘–‘ such that (ii) no column of <italic>A</italic> is composed of only gaps, and (iii) the removal of gaps of row <italic>i</italic> of <italic>A</italic> yields sequence <bold>w</bold><sub><italic>i</italic></sub>.</p><p id="P9">Here, we seek an alignment with two additional constraints, called a TRS alignment defined as follows.</p></sec><sec id="S5"><title>Definition 2</title><p id="P10">An alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> is a <italic>TRS alignment</italic> provided (i) <bold>a</bold><sub>0</sub> does not contain any gaps, and (ii) <bold>a</bold><sub>1</sub><italic>, … ,</italic> <bold>a</bold><sub><italic>n</italic></sub> do not contain any internal gaps.</p><p id="P11">Intuitively, the first sequence <bold>a</bold><sub>0</sub> in the alignment <italic>A</italic> represents TRS-L, whereas <bold>a</bold><sub>1</sub><italic>, … ,</italic> <bold>a</bold><sub><italic>n</italic></sub> represent TRS-Bs, each upstream of an accessory or structural gene. We do not allow gaps in the TRS-L sequence <bold>a</bold><sub>0</sub> as template switching by RdRP occurs due to complementary base pairing between TRS-L and the nascent strand of TRS-B [<xref ref-type="bibr" rid="R26">26</xref>]. For the same reason, we do not allow internal gaps in TRS-Bs <bold>a</bold><sub><italic>i</italic></sub>. However, as each TRS-B may match a different region of the TRS-L, we do allow flanking gaps in these sequences (<xref ref-type="fig" rid="F1">Fig. 1c</xref>). We score a TRS alignment <italic>A</italic> using a scoring function <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>:</mml:mo><mml:mi>Σ</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Σ</mml:mi><mml:mo>∪</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula> in the following way.</p></sec><sec id="S6"><title>Definition 3</title><p id="P12">The <italic>score s</italic>(<italic>A</italic>) of a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> is given by <inline-formula><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>a</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>a</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>a</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, whereas the <italic>minimum score s</italic><sub>min</sub>(<italic>A</italic>) is defined as <inline-formula><mml:math id="M3"><mml:mrow><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>a</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>a</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p id="P13">In other words, we score each TRS-B <bold>a</bold><sub><italic>i</italic></sub> (where <italic>i</italic> ≥ 1) by comparing it to the TRS-L sequence <bold>a</bold><sub>0</sub> in a way that is consistent with the mechanism of template switching during discontinuous transcription. As such, our scoring function differs from the traditional sum-of-pairs scoring function [<xref ref-type="bibr" rid="R3">3</xref>] where every unordered pair (<bold>a</bold><sub><italic>i</italic></sub>,<bold>a</bold><sub><italic>j</italic></sub>) of sequences contributes to the score of the alignment. Furthermore, each TRS alignment uniquely determines the core sequence as follows.</p></sec><sec id="S7"><title>Definition 4</title><p id="P14">Sequence <bold>c</bold>(<italic>A</italic>) is the <italic>core sequence</italic> of a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> provided <bold>c</bold>(<italic>A</italic>) is the largest contiguous subsequence of <bold>a</bold><sub>0</sub> such that no character of <bold>c</bold> is aligned to a gap in any of <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>.</p><p id="P15">Note that the core sequence is a subsequence of the TRS sequences. As such, the TRS alignment can include nucleotides immediately flanking the core sequence, which have been shown to play an important role in discontinuous transcription in previous experiments [<xref ref-type="bibr" rid="R26">26</xref>].</p></sec></sec><sec id="S8"><label>2.2</label><title>The TRS IDENTIFICATION problem</title><p id="P16">The first problem we consider is that of identifying TRS sites given a viral genome with known genes <bold>x</bold><sub>0</sub>, …, <bold>x</bold><sub><italic>n</italic></sub>. Specifically, we are given a candidate region <bold>w</bold><sub>0</sub> that contains the unknown TRS-L <bold>a</bold><sub>0</sub> upstream of gene <bold>x</bold><sub>0</sub> as well as candidate regions <bold>w</bold><sub>1</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> that contain the unknown TRS-Bs <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub> of genes <bold>x</bold><sub>1</sub>, …, <bold>x</bold><sub><italic>n</italic></sub>. <xref ref-type="sec" rid="S17">Section 3.1</xref> details how to obtain these candidate regions when only given the gene locations. To further guide the optimization problem, we impose an additional constraint on the sought TRS alignment <italic>A</italic> in the form of a minimum length <italic>ω</italic> on the core sequence <bold>c</bold>(<italic>A</italic>) as well as a threshold <italic>τ</italic> on the minimum score <italic>s</italic><sub>min</sub>(<italic>A</italic>) of the TRS alignment. We formalize this problem as follows.</p><sec id="S9"><title>Problem 1 (TRS IDENTIFICATION (TRS-ID))</title><p id="P17">Given non-overlapping sequences <bold>w</bold><sub>0</sub>, …, <bold>w</bold><sub><italic>n</italic></sub>, coresequence length <italic>ω</italic> &gt; 0 and score threshold <italic>τ</italic> &gt; 0, find a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> such that (i) <bold>a</bold><sub><italic>i</italic></sub> corresponds to a subsequence in <bold>w</bold><sub><italic>i</italic></sub> for all <italic>i</italic> ∈ {0<italic>, …, n</italic>}, (ii) the core sequence <bold>c</bold>(<italic>A</italic>) has length at least <italic>ω</italic>, (iii) the minimum score <italic>s</italic><sub>min</sub>(<italic>A</italic>) is at least <italic>τ</italic> , and (iv) the alignment has maximum score <italic>s</italic>(<italic>A</italic>).</p></sec></sec><sec id="S10"><label>2.3</label><title>The TRS AND GENE IDENTIFICATION problem</title><p id="P18">In the second problem, we are no longer given an annotated genome with gene locations. Rather, we seek to simultaneously identify genes and TRS sites given a viral genome sequence <bold>v</bold> split into a leader region <bold>v</bold><sub>leader</sub> and body region <bold>v</bold><sub>body</sub>. <xref ref-type="sec" rid="S18">Section 3.2</xref> describes a heuristic for identifying these two regions when only given <bold>v</bold>. The key idea here is that each TRS alignment will uniquely determine a set of genes it encodes. To make this relationship clear, we begin by defining an open reading frame as follows.</p><sec id="S11"><title>Definition 5</title><p id="P19">A contiguous subsequence <bold>x</bold> = [<italic>x</italic><sup>−</sup><italic>, x</italic><sup>+</sup>] of <bold>v</bold> is an <italic>open reading frame</italic> provided <bold>x</bold> (i) has a length |<bold>x</bold>| that is a multiple of 3, (ii) starts with a start codon, <italic>i.e. x</italic><sub>1</sub> <italic>… x</italic><sub>3</sub> = ATG, and (iii) ends at a stop codon, <italic>i.e. x</italic><sub>|<bold>x</bold>|−2</sub> … <italic>x</italic><sub>|<bold>x</bold>|</sub> ∈ {ATG, TAG, TGA}.</p><p id="P20">Each TRS-B <bold>a</bold><sub><italic>i</italic></sub> is associated with at most one ORF that occurs immediately downstream of <bold>a</bold><sub><italic>i</italic></sub>. Naively, to identify the ORF associated with <bold>a</bold><sub><italic>i</italic></sub>, one could simply scan downstream of the TRS-B for the first occurrence of a start codon and continue scanning to identify the corresponding in-frame stop codon. However, this would not take ribosomal leaky scanning into account, where the ribosome does not initiate translation at the first encountered ‘ATG’. <xref ref-type="sec" rid="S18">Section 3.2</xref> provides a more robust definition of a downstream ORF that takes ribosomal leaky scanning into account. To summarize, we have that a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> uniquely determines a set Γ(<italic>A</italic>) of candidate genes.</p></sec><sec id="S12"><title>Definition 6</title><p id="P21">A set Γ(<italic>A</italic>) of ORFs are <italic>induced genes</italic> of a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> provided Γ(<italic>A</italic>) is composed of the ORFs that occur downstream of each TRS-B <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub> in <bold>v</bold><sub>body</sub>.</p><p id="P22">Note that multiple TRS-Bs of a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> can induce the same gene in <bold>v</bold><sub>body</sub>. Moreover, there may <italic>not</italic> be an ORF downstream of a TRS-B <bold>a</bold><sub><italic>i</italic></sub>. As such, we have that |Γ (<italic>A</italic>)| ≤ <italic>n</italic>. By contrast, in coronaviruses, each viral gene typically has a unique TRS-B. Moreover, these viral genes are typically non-overlapping in the genome. Finally, coronavirus genomes tend to be compact with most positions coding for genes. To capture these biological constraints, we introduce the following definitions.</p></sec><sec id="S13"><title>Definition 7</title><p id="P23">A TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> is <italic>concordant</italic> provided (i) each TRS-B <bold>a</bold><sub><italic>i</italic></sub> corresponds to exactly one gene in Γ(<italic>A</italic>), and (ii) there are no two ORFs in Γ(<italic>A</italic>) whose positions in <bold>v</bold><sub>body</sub> overlap.</p></sec><sec id="S14"><title>Definition 8</title><p id="P24">The <italic>genome coverage g</italic>(<italic>A</italic>) of a TRS alignment <italic>A</italic> is the number of positions in <bold>v</bold><sub>body</sub> that are covered by the set Γ(<italic>A</italic>) of induced genes.</p><p id="P25">This leads to the following problem.</p></sec><sec id="S15"><title>Problem 2 (TRS AND GENE IDENTIFICATION (TRS-GENE-ID))</title><p id="P26">Given leader region <bold>v</bold><sub>leader</sub>, body region <bold>v</bold><sub>body</sub>, core-sequence length <italic>ω</italic> &gt; 0 and score threshold <italic>τ</italic> &gt; 0, find a TRS alignment <italic>A</italic> = [<bold>a</bold><sub><italic>i</italic></sub>] such that (i) <bold>a</bold><sub>0</sub> corresponds to a subsequence in <bold>v</bold><sub>leader</sub>, (ii) <bold>a</bold><sub><italic>i</italic></sub> corresponds to a subsequence in <bold>v</bold><sub>body</sub> for all <italic>i</italic> ≥ 1, (iii) the core sequence <bold>c</bold>(<italic>A</italic>) has length at least <italic>ω</italic>, (iv) the minimum score <italic>s</italic><sub>min</sub>(<italic>A</italic>) is at least <italic>τ</italic>, (v) <italic>A</italic> is concordant, and (vi) <italic>A</italic> induces a set Γ(<italic>A</italic>) of genes with maximum genome coverage <italic>g</italic>(<italic>A</italic>) and <italic>A</italic> subsequently has maximum score <italic>s</italic>(<italic>A</italic>).</p></sec></sec></sec><sec id="S16" sec-type="methods"><label>3</label><title>Methods</title><p id="P27"><xref ref-type="sec" rid="S17">Section 3.1</xref> introduces CORSID-A, which solves the TRS-ID problem. <xref ref-type="sec" rid="S18">Section 3.2</xref> introduces CORSID, solving the TRS-GENE-ID problem. Both sections discuss practical considerations as well as several heuristics for obtaining the required input to each problem. We implemented both methods in Python. The source code is available at <monospace><ext-link ext-link-type="uri" xlink:href="https://github.com/elkebir-group/CORSID">https://github.com/elkebir-group/CORSID</ext-link></monospace>.</p><sec id="S17"><label>3.1</label><title>Solving the TRS IDENTIFICATION problem</title><p id="P28">Recall that in the TRS-ID problem we seek a TRS alignment <italic>A</italic> given input candidate regions sequences <bold>w</bold><sub>0</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> that each occur upstream of genes <bold>x</bold><sub>0</sub>, …, <bold>x</bold><sub><italic>n</italic></sub>. Intuitively, we define the candidate region for a gene <bold>x</bold><sub><italic>i</italic></sub> as the region <inline-formula><mml:math id="M4"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>w</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> composed of positions <italic>w</italic><sup>−</sup> ≤ <italic>p</italic> ≤ <italic>w</italic><sup>+</sup> such that any sgmRNA starting at <italic>p</italic> will lead to the translation of ORF <bold>x</bold><sub><italic>i</italic></sub> by the ribosome. SuPER [<xref ref-type="bibr" rid="R28">28</xref>], the only other method for identifying TRSs in annotated coronavirus genomes, employs a heuristic by defining the candidate region <bold>w</bold><sub><italic>i</italic></sub> of a gene <bold>x</bold><sub><italic>i</italic></sub> as <italic>v</italic><sub><italic>x</italic><sup>−</sup>−170</sub> … <italic>v</italic><sub>x<sup>−</sup>−1</sub>, <italic>i.e.</italic> the candidate region <bold>w</bold><sub><italic>i</italic></sub> is a subsequence of 170 nt immediately upstream of gene <bold>x</bold><sub><italic>i</italic></sub> for 1 ≤ <italic>i</italic> ≤ <italic>n</italic>. Here, we take a more rigorous and flexible approach that takes ribosomal leaky scanning into account by skipping over previous ORFs with length smaller than 100 nt (details in Appendix A.1).</p><p id="P29">Recall that in a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> only the TRS-Bs <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub> are allowed to have gaps (restricted to the flanks), and that the TRS-L <bold>a</bold><sub>0</sub> is gapless. To score a TRS alignment, we use a simple scoring function <inline-formula><mml:math id="M5"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>:</mml:mo><mml:mi>Σ</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Σ</mml:mi><mml:mo>∪</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula> such that <italic>s</italic>(<italic>x, y</italic>) equals +1 for matches (<italic>i.e. x</italic> = <italic>y</italic>), 2 for mismatches (<italic>i.e. x</italic> ≠ <italic>y</italic> and <italic>y</italic> ≠ −), and 0 for gaps (<italic>i.e. y</italic> = −). In other words, while we reward matches and penalize mismatches, we do not penalize flanking gaps.</p><p id="P30">Recall that the sought TRS alignment <italic>A</italic> must induce a core sequence <bold>c</bold>(<italic>A</italic>) of length at least <italic>ω</italic>. Due to this constraint, the input sequences <bold>w</bold><sub>0</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> depend on one another and cannot be considered in isolation. We break this dependency by considering a subsequence <bold>u</bold> within <bold>w</bold><sub>0</sub> of length <italic>ω</italic>, restricting the induced core sequence <bold>c</bold>(<italic>A</italic>) of output TRS alignments <italic>A</italic> to contain <bold>u</bold>. We solve this constrained version of the TRS-ID problem using dynamic programming in time <italic>O</italic>(|<bold>w</bold><sub>0</sub>| <italic>L</italic>) where <italic>L</italic> is the total length of candidate regions <bold>w</bold><sub>1</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> (details are in Appendix A.2 and <xref ref-type="fig" rid="F2">Fig. 2a</xref>). We obtain the solution to the original TRS-ID problem by identifying the window <bold>u</bold> that induces a TRS alignment <italic>A</italic> with maximum score. As there are <italic>O</italic>(|<bold>w</bold><sub>0</sub>|) windows in <bold>w</bold><sub>0</sub> of fixed length <italic>ω</italic>, this procedure takes <italic>O</italic>(|<bold>w</bold><sub>0</sub>|2<italic>L</italic>) time.</p></sec><sec id="S18"><label>3.2</label><title>Solving the TRS AND GENE IDENTIFICATION problem</title><p id="P31">In the TRS-GENE-ID problem, we require two sequences: <bold>v</bold><sub>leader</sub> which contains TRS-L <bold>a</bold><sub>0</sub> and <bold>v</bold><sub>body</sub> which contains each TRS-B <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>. We describe a heuristic to partition a genome <bold>v</bold> into <bold>v</bold><sub>leader</sub> and <bold>v</bold><sub>body</sub> in Appendix A.3. This heuristic is performed in <italic>O</italic>(<italic>m</italic><sup>2</sup>) time where <italic>m</italic> is the number of ORFs in <bold>v</bold>.</p><p id="P32">We will now define the relationship between a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> and the set Γ(<italic>A</italic>) of induced genes. Upon removing (flanking) gaps, each aligned sequence <bold>a</bold><sub><italic>i</italic></sub> corresponds to a contiguous subsequence <bold>v</bold><sub><italic>i</italic></sub> of the viral genome <bold>v</bold>. Specifically, <bold>v</bold><sub>0</sub> occurs in <bold>v</bold><sub>leader</sub> and <bold>v</bold><sub><italic>i</italic></sub> occurs in <bold>v</bold><sub>body</sub> (where <italic>i</italic> ≥ 1). By Definition 4, each subsequence <bold>v</bold><sub><italic>i</italic></sub> has positions that are aligned with the core sequence <bold>c</bold>(<italic>A</italic>). These aligned positions induce the subsequence <inline-formula><mml:math id="M6"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>c</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of length equal to |<bold>c</bold>(<italic>A</italic>)|. Note that while <bold>c</bold><sub>0</sub> = <bold>c</bold>(<italic>A</italic>), it may be that <bold>c</bold><sub><italic>i</italic></sub> ≠ <bold>c</bold>(<italic>A</italic>) where <italic>i</italic> ≥ 1 due to mismatches. Importantly, there are coronaviruses where the last three nucleotides of the core sequence within a TRS-B coincide with the start codon of the associated gene (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). As such, we have the following definition.</p><sec id="S19"><title>Definition 9</title><p id="P33">Let <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> be a TRS alignment and let <inline-formula><mml:math id="M7"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>c</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the subsequence of <bold>a</bold><sub><italic>i</italic></sub> that is aligned to the core sequence <bold>c</bold>(<italic>A</italic>). The ORF <italic>associated</italic> with TRS-B <bold>a</bold><sub><italic>i</italic></sub> is the unique ORF <bold>x</bold> where position <italic>c<sub>i</sub></italic><sup>+</sup> − 2 occurs within the candidate region of <bold>x</bold>.</p><p id="P34">As discussed, there may not exist an ORF associated with a TRS-B <bold>a</bold><sub><italic>i</italic></sub>, which may happen when the TRS-B is located near the 3’ end of the genome. Given a TRS alignment <italic>A</italic> = [<bold>a</bold><sub>0</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>]<sup><italic>T</italic></sup> , the set Γ(<italic>A</italic>) of induced genes equals the set of ORFs that are associated with <bold>a</bold><sub>1</sub>, …, <bold>a</bold><sub><italic>n</italic></sub>.</p><p id="P35">To solve the TRS-GENE-ID problem, we take a similar sliding window approach that we used to solve the TRS-ID problem. That is, we consider all subsequences <bold>u</bold> within <bold>v</bold><sub>leader</sub> of length <italic>ω</italic> and solve a constrained version of the TRS-GENE-ID problem, additionally requiring that the sought TRS alignment <italic>A</italic> has a core sequence <bold>c</bold>(<italic>A</italic>) that fully contains <bold>u</bold>, using the following two steps. First, we construct a DP table similar to the previous table used in TRS-ID problem in <italic>O</italic>(|<bold>v</bold><sub>leader</sub>||<bold>v</bold><sub>body</sub>|) time, and for each ORF, we select the alignment with the highest score in the corresponding candidate region. Second, given these ORFs and corresponding alignments, we build a vertex-weighted interval graph combining ORF lengths and alignment scores as weights. To identify the optimal TRS alignment <italic>A</italic> and associated genes Γ(<italic>A</italic>), we solve a maximum-weight independent set (MWIS) on this graph in <italic>O</italic>(<italic>m</italic>) time, where <italic>m</italic> is the number of candidate ORFs in <bold>v</bold><sub>body</sub> (Appendix A.4 and <xref ref-type="fig" rid="F2">Fig. 2b</xref>). Each instance of the constrained TRS-GENE-ID problem takes <italic>O</italic>(|<bold>v</bold><sub>leader</sub>||<bold>v</bold><sub>body</sub>| + <italic>m</italic>) time. Since the number of windows of length <italic>ω</italic> in <bold>v</bold><sub>leader</sub> is <italic>O</italic>(|<bold>v</bold><sub>leader</sub>|), the total running time of CORSID to solve the TRS-GENE-ID problem is <italic>O</italic>(|<bold>v</bold><sub>leader</sub>|<sup>2</sup> |<bold>v</bold><sub>body</sub>| + |<bold>v</bold><sub>leader</sub>|<italic>m</italic>). In practice, the number <italic>m</italic> of candidate ORFs in <bold>v</bold><sub>body</sub> ranges from 21 – 92, the length |<bold>v</bold><sub>leader</sub>| of leader region ranges from 171 − 716 and the length |<bold>v</bold><sub>body</sub>| of the body region ranges from 6280 – 11462 across all the coronaviruses studied in this paper. Finally, to obtain biologically meaningful solutions, we employ a progressive approach and consider overlapping genes (see Appendix A.5 for details).</p></sec></sec></sec><sec id="S20" sec-type="results"><label>4</label><title>Results</title><p id="P36">To evaluate the performance of CORSID-A and CORSID, we downloaded the same set of 505 assembled coronavirus genomes previously analyzed by SuPER [<xref ref-type="bibr" rid="R28">28</xref>] from GenBank along with their annotation GFF files, indicating gene locations. To benchmark methods for the TRS-ID problem, we assessed each method’s ability to correctly identify TRS-L as well as identify a TRS-B upstream of each gene. For the TRS-GENE-ID problem, we additionally assessed each method’s ability to identify ground-truth genes. Appendix B.1 describes how we established the set of genes and locations of TRS sites in the coronavirus genomes. We excluded 35 genomes due to incomplete leader sequences, thus lacking TRS-L. We excluded two more genomes due to empty GFF files, thus lacking gene annotations. The remaining 468 genomes comprised all four genera of the <italic>Coronaviridae</italic> family and spanned a total of 22 subgenera (<xref ref-type="supplementary-material" rid="SD1">Table S2</xref>).</p><sec id="S21"><label>4.1</label><title>CORSID-A finds TRS-L and TRS-Bs with higher accuracy than existing methods</title><p id="P37">We begin by comparing the performance of CORSID-A with MEME and SuPER for the TRS IDENTIFI-CATION problem. Recall that MEME is a general-purpose motif detection algorithm [<xref ref-type="bibr" rid="R2">2</xref>], whereas SuPER is specifically designed for identifying core sequences within coronavirus genomes annotated with genes [<xref ref-type="bibr" rid="R28">28</xref>]. To run CORSID-A, we extracted candidate regions <bold>w</bold><sub>1</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> upstream of annotated genes <bold>x</bold><sub>0</sub>, …, <bold>x</bold><sub><italic>n</italic></sub> as described in Definition 11. The minimum length <italic>ω</italic> of core sequence is set to 7 following existing literature [<xref ref-type="bibr" rid="R8">8</xref>], and we use a minimum alignment score of <italic>τ</italic> = 2. We provided MEME with the same candidate regions <bold>w</bold><sub>0</sub>, …, <bold>w</bold><sub><italic>n</italic></sub>, and ran it in “zero or one occurrence per sequence” mode. As for SuPER, we analyzed the previously reported results on the same 468 sequences considered here. Detailed commands and parameters can be found in Appendix B.2.</p><p id="P38">As shown in <xref ref-type="fig" rid="F3">Fig. 3b</xref>, CORSID-A correctly identified TRS-Ls in 466 out of 468 genomes, reaching a higher accuracy (99.6%) than MEME (442 genomes, 94.4%), but was outperformed by SuPER, which was correct in 467 genomes (99.8%). The two genomes where our method failed are outliers in their respective subgenera, indicative of possible sequencing errors (Appendix B.4). <xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref> discusses the one genome where SuPER failed to identify TRS-L correctly, showing that the TRS-L sequence identified by our method is supported by both secondary structure information as well as a split read in a corresponding RNA sequencing sample. <italic>Split reads</italic> map to non-contiguous regions of the viral genome and provide direct evidence of template switching at TRS sites.</p><p id="P39">Of note, SuPER uses additional information to identify TRS-L and TRS-B sites compared to MEME and CORSID-A. That is, SuPER requires the user to specify the genus of origin for each input sequence, which is used to obtain a genus-specific motif of the core sequence from a look-up table. This motif is used to identify matches along the genome. In addition, SuPER takes as input the 5’ UTR secondary structure, restricting the region in which the TRS-L occurs until the fourth stem loop (SL4). Importantly, while CORSID-A does not rely on any prespecified motif, taxonomic or secondary structure information, our method identified more TRS-Bs than either SuPER or MEME (<xref ref-type="fig" rid="F3">Fig. 3c</xref>). Specifically, we define the <italic>TRS-B recall</italic> as the fraction of genes for which TRS-Bs were identified. While the median TRS-B recall of all three methods is 1, CORSID-A found putative TRS-Bs of all genes in 387 genomes (82.7%), while SuPER and MEME did so in only 290 (62.0%) and 315 (67.3%) genomes, respectively.</p><p id="P40">To validate the identified TRS sites, we examined split reads in publicly available RNA-sequencing data of cells infected by coronaviruses. Here we considered two samples, SRR1942956 and SRR1942957, of SARS-CoV-1-infected cells (NC 004718) with a median depth of 2940× and 2765×, respectively. The TRS-B region predicted by CORSID-A is supported by 246 reads in sample SRR1942956 and 233 reads in sample SRR1942957, whereas the TRS-B region predicted by SuPER is supported by only 1 read in each sample (<xref ref-type="supplementary-material" rid="SD1">Fig. S3a</xref>). Our method was able to identify these positions due to use of flanking positions rather than focusing on identifying a short 6 – 7 nt motif as done by SuPER.</p><p id="P41">Recombination plays a crucial role in the evolution of RNA viruses, and results from homologous or non-homologous template switching. In particular for coronaviruses, template switching occurs at TRS sites during discontinuous transcription [<xref ref-type="bibr" rid="R9">9</xref>], making these sites prone to recombination events. CORSID-A uses local alignment to identify TRSs, and unlike SuPER, is not restricted to identifying regulatory sequences of a fixed length. Therefore, as a by-product, our method will be able to find evidence for homologous recombination at these sites. Specifically, even though the length of the core sequence is fixed at 7, the length of the TRS-Ls identified by our method ranges from 9 to 45 (median: 22). This corroborates previous findings showing that recombination hotspots in coronaviruses are colocated with TRS sites [<xref ref-type="bibr" rid="R28">28</xref>]. In particular, the longest TRS-B with a length of 45 nucleotides occurs upstream of gene <italic>ns12.9</italic> of NC 006213 with only 6 mismatches showing strong evidence of recombination (<xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref>). In contrast, the core sequence identified by SuPER and MEME (<xref ref-type="fig" rid="F3">Fig. 3d</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S5</xref>) are at most 10 nt long. Furthermore, we note there is experimental evidence that not only the core sequence but also flanking nucleotides play an important role in discontinuous transcription [<xref ref-type="bibr" rid="R26">26</xref>]. This demonstrates the importance of identifying larger regulatory sequences, as done by our method, rather than identifying shorter recurring motifs as done by SuPER and MEME. In summary, CORSID-A outperforms existing methods, such as SuPER and MEME, in identifying TRS sites in coronavirus genomes with given gene locations.</p></sec><sec id="S22"><label>4.2</label><title>CORSID identifies genes with higher accuracy than existing methods</title><p id="P42">We now focus on the TRS-GENE-ID problem, where we compared CORSID to two general-purpose gene finding methods: Glimmer3 [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R21">21</xref>] and Prodigal [<xref ref-type="bibr" rid="R12">12</xref>, <xref ref-type="bibr" rid="R13">13</xref>]. Each method was given as input the complete, unannotated genome sequence of each of the 468 coronaviruses. Following recommended instructions, we ran Glimmer3 by first building the required interpolated context model (ICM) on each genome sequence separately. We ran Prodigal in meta-genomics mode. For CORSID, we used window length <italic>ω</italic> = 7 and progressively reduced the score threshold <italic>τ</italic> from 7 to 2. We refer the reader to Appendix B.2 for the precise commands used to run previous tools, and to Appendix B.3 for details on how the predicted set of genes are compared to the ground truth.</p><p id="P43"><xref ref-type="fig" rid="F4">Fig. 4a</xref> shows that CORSID outperformed Glimmer3 and Prodigal in terms of both precision and recall. The median precision and recall of CORSID is 0.818 and 1.00, respectively, whereas the median precision and recall is 0.556 and 0.556, respectively, for Glimmer3, and 0.636 and 0.667, respectively, for Prodigal. Additionally, the first quartile of both precision and recall for CORSID is greater than the third quartile of these metrics for either Glimmer3 and Prodigal, showing a significant performance advantage for CORSID. While Prodigal and Glimmer3 do not have the capability to identify TRS sites, CORSID identifies these regulatory sites in addition to the genes. Specifically, compared to CORSID-A, which identified TRS-L correctly for 466 (99.6%) genomes, CORSID does so for 443 (94.7%) genomes (<xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>). This is a modest reduction in performance, especially when taking into account that CORSID, unlike CORSID-A, is not given any additional information apart from the complete, unannotated genome sequence. Analyzing the previously discussed SARS-CoV-1 genome (NC 004718), we found that CORSID identified the same 10 genes as CORSID-A, while Prodigal missed four genes and Glimmer3 missed two genes (<xref ref-type="supplementary-material" rid="SD1">Fig. S3b</xref>).</p><p id="P44">Given the large discrepancy between precision and recall for CORSID, we investigated whether genomes were poorly annotated, leading to incorrect false positives. To that end, we used BLASTx [<xref ref-type="bibr" rid="R1">1</xref>] to transfer gene annotation from well-annotated genomes to poorly-annotated genomes. To reduce computation time, we only assessed false positive (FP) genes occurring in <bold>v</bold><sub>body</sub>. We reclassified a FP gene as a true positive (TP) if the alignment reported by BLASTx spans at least 95% of both the query sequence (the FP gene) and the hit sequence in the database (detailed in Appendix B.2). The resulting confusion matrices of the predicted and the ground-truth genes are shown in <xref ref-type="fig" rid="F4">Fig. 4b</xref>. Although BLASTx found 629 and 459 matches in the database for FPs of Glimmer3 and Prodigal, respectively, which is more than 387 for CORSID, CORSID maintains its lead in absolute numbers for TP and FP. As such, CORSID achieved the highest pooled precision and recall both before and after the BLASTx verification. In summary, CORSID accurately identifies TRSs and genes given just the unannotated genome, outperforming existing gene finding methods.</p></sec><sec id="S23"><label>4.3</label><title>CORSID enables <italic>de novo</italic> identification of TRS sites and genes</title><p id="P45">To demonstrate how users can use CORSID to annotate genes and identify TRS-L and TRS-Bs given a newly assembled genome, we analyzed a previously-excluded genome that lacks gene annotation (genome DQ288927). This genome is 27534 nt long, which we provided as input to CORSID, Glimmer3 and Prodigal. CORSID identified nine genes spanning 91.66% of the genome, all of which match annotated genes in other <italic>Igacoviruses</italic> sequences in the BLASTx database (<xref ref-type="fig" rid="F5">Fig. 5</xref>). By contrast, Glimmer3 identified a total of six genes spanning 80.52% of the genome, five of which match genes in the BLASTx database. On the other hand, Prodigal found six genes, all of which were present in the database, spanning 84.22% of the genome. In summary, CORSID identified more genes than existing methods, all of which occurred in homologous previously-annotated genomes in the BLASTx database, demonstrating that CORSID can be used to accurately annotate coronavirus genomes.</p></sec></sec><sec id="S24" sec-type="discussion"><label>5</label><title>Discussion</title><p id="P46">In this paper, we investigated the hypothesis that the presence of transcription regulatory sequences in coronavirus genomes can be leveraged to simultaneously infer these regulatory sequences and their associated genes in a synergistic manner. To that end, we formulated the TRS IDENTIFICATION (TRS-ID) problem of identifying TRS sites in a coronavirus genome with given gene locations, and the general problem, the TRS AND GENE IDENTIFICATION (TRS-GENE-ID) problem of simultaneous identification of genes and TRS sites given only the coronavirus genome. Underpinning both problems is the notion of a TRS alignment, which extends the previous concept of core sequences to include flanking nucleotides that provide additional signal. Our proposed method for the first problem, CORSID-A, is based upon a dynamic programming formulation which extends the classical Smith-Waterman recurrence [<xref ref-type="bibr" rid="R24">24</xref>]. CORSID, which solves the general problem, additionally incorporates a maximum-weight independent set formulation on an interval graph to identify TRS sites and genes.</p><p id="P47">Using extensive experiments on 468 coronavirus genomes, we showed that CORSID-A outperformed two motif-based approaches, MEME [<xref ref-type="bibr" rid="R2">2</xref>] and SuPER [<xref ref-type="bibr" rid="R28">28</xref>]. Additionally, we showed that CORSID outperformed two general-purpose gene finding algorithms, Glimmer3 [<xref ref-type="bibr" rid="R5">5</xref>, <xref ref-type="bibr" rid="R21">21</xref>] and Prodigal [<xref ref-type="bibr" rid="R12">12</xref>]. We performed direct validation of TRS sites predicted for the SARS-CoV-1 genome (NC 004718), showing that the TRS sites identified by our method are more strongly supported by split reads in RNA-seq samples than the TRS sites identified by SuPER. Lastly, we demonstrated that CORSID enables <italic>de novo</italic> identification of TRSs and genes in newly assembled coronavirus genomes by applying it on a previously unannotated coronavirus (DQ288927) belonging to the <italic>Igacovirus</italic> subgenus.</p><p id="P48">There are several avenues for future research. First, CORSID currently requires the complete genome as input to identify the TRS sites and the genes. We plan to extend our method to allow gene identification in the several coronaviruses available in GenBank with only partial reference genomes by leveraging knowledge from other coronaviruses with complete genomes with similar TRS sites. Second, while in this study we only focused on coronaviruses, discontinuous transcription occurs in all viruses in the taxonomic order of <italic>Nidovirales</italic>. However, CORSID, which assumes a single TRS-L region in the genome, cannot be directly applied to other families of viruses within <italic>Nidovirales</italic> such as the family <italic>Mesoniviridae</italic> that contain multiple TRS-L regions in the genome. Incorporating such features and extending CORSID to all <italic>Nidovirales</italic> viruses is a useful direction of future work. Finally, currently CORSID requires the reference genome of the virus as input. In the future, we plan to extend this method to simultaneously discover the reference genome and the core-sequences of the virus using <italic>de novo</italic> assembly. We envision that this will enable simultaneous genome assembly and gene annotation of coronaviruses.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Methods</label><media xlink:href="EMS162957-supplement-Supplementary_Methods.pdf" mimetype="application" mime-subtype="pdf" id="d265aAdFbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S25"><title>Acknowledgements</title><p>This material is based upon work supported by the National Science Foundation under award numbers CCF-1850502, CCF-2027669 and CCF-2046488. We thank Ayesha Kazi, Michael Xiang, and Yichi Zhang for developing the web-based visualization tool of CORSID solutions.</p></ack><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>Stephen F</given-names></name><name><surname>Gish</surname><given-names>Warren</given-names></name><name><surname>Miller</surname><given-names>Webb</given-names></name><name><surname>Myers</surname><given-names>Eugene W</given-names></name><name><surname>Lipman</surname><given-names>David J</given-names></name></person-group><article-title>Basic local alignment search tool</article-title><source>Journal of Molecular Biology</source><year>1990</year><volume>215</volume><issue>3</issue><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>Timothy L</given-names></name><name><surname>Boden</surname><given-names>Mikael</given-names></name><name><surname>Buske</surname><given-names>Fabian A</given-names></name><name><surname>Frith</surname><given-names>Martin</given-names></name><name><surname>Grant</surname><given-names>Charles E</given-names></name><name><surname>Clementi</surname><given-names>Luca</given-names></name><name><surname>Ren</surname><given-names>Jingyuan</given-names></name><name><surname>Li</surname><given-names>Wilfred W</given-names></name><name><surname>Noble</surname><given-names>William S</given-names></name></person-group><article-title>MEME SUITE: tools for motif discovery and searching</article-title><source>Nucleic Acids Research</source><year>2009</year><volume>37</volume><issue>suppl 2</issue><fpage>W202</fpage><lpage>W208</lpage><pub-id pub-id-type="pmcid">PMC2703892</pub-id><pub-id pub-id-type="pmid">19458158</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkp335</pub-id></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carrillo</surname><given-names>Humberto</given-names></name><name><surname>Lipman</surname><given-names>David</given-names></name></person-group><article-title>The multiple sequence alignment problem in biology</article-title><source>SIAM Journal on Applied Mathematics</source><year>1988</year><volume>48</volume><issue>5</issue><fpage>1073</fpage><lpage>1082</lpage></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Shih-Cheng</given-names></name><name><surname>Olsthoorn</surname><given-names>René CL</given-names></name></person-group><article-title>Group-specific structural features of the 5’-proximal sequences of coronavirus genomic RNAs</article-title><source>Virology</source><year>2010</year><volume>401</volume><issue>1</issue><fpage>29</fpage><lpage>41</lpage><pub-id pub-id-type="pmcid">PMC7111916</pub-id><pub-id pub-id-type="pmid">20202661</pub-id><pub-id pub-id-type="doi">10.1016/j.virol.2010.02.007</pub-id></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delcher</surname><given-names>Arthur L</given-names></name><name><surname>Bratke</surname><given-names>Kirsten A</given-names></name><name><surname>Powers</surname><given-names>Edwin C</given-names></name><name><surname>Salzberg</surname><given-names>Steven L</given-names></name></person-group><article-title>Identifying bacterial genes and endosymbiont DNA with Glimmer</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>6</issue><fpage>673</fpage><lpage>679</lpage><pub-id pub-id-type="pmcid">PMC2387122</pub-id><pub-id pub-id-type="pmid">17237039</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btm009</pub-id></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobin</surname><given-names>Alexander</given-names></name><name><surname>Davis</surname><given-names>Carrie A</given-names></name><name><surname>Schlesinger</surname><given-names>Felix</given-names></name><name><surname>Drenkow</surname><given-names>Jorg</given-names></name><name><surname>Zaleski</surname><given-names>Chris</given-names></name><name><surname>Jha</surname><given-names>Sonali</given-names></name><name><surname>Batut</surname><given-names>Philippe</given-names></name><name><surname>Chaisson</surname><given-names>Mark</given-names></name><name><surname>Gingeras</surname><given-names>Thomas R</given-names></name></person-group><article-title>STAR: ultrafast universal RNA-seq aligner</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>1</issue><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="pmcid">PMC3530905</pub-id><pub-id pub-id-type="pmid">23104886</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Down</surname><given-names>Thomas A</given-names></name><name><surname>Hubbard</surname><given-names>Tim JP</given-names></name></person-group><article-title>NestedMICA: sensitive inference of over-represented motifs in nucleic acid sequence</article-title><source>Nucleic Acids Research</source><year>2005</year><volume>33</volume><issue>5</issue><fpage>1445</fpage><lpage>1453</lpage><pub-id pub-id-type="pmcid">PMC1064142</pub-id><pub-id pub-id-type="pmid">15760844</pub-id><pub-id pub-id-type="doi">10.1093/nar/gki282</pub-id></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finkel</surname><given-names>Yaara</given-names></name><name><surname>Mizrahi</surname><given-names>Orel</given-names></name><name><surname>Nachshon</surname><given-names>Aharon</given-names></name><name><surname>Weingarten-Gabbay</surname><given-names>Shira</given-names></name><name><surname>Morgenstern</surname><given-names>David</given-names></name><name><surname>Yahalom-Ronen</surname><given-names>Yfat</given-names></name><name><surname>Tamir</surname><given-names>Hadas</given-names></name><name><surname>Achdout</surname><given-names>Hagit</given-names></name><name><surname>Stein</surname><given-names>Dana</given-names></name><name><surname>Israeli</surname><given-names>Ofir</given-names></name><etal/></person-group><article-title>The coding capacity of SARS-CoV-2</article-title><source>Nature</source><year>2021</year><volume>589</volume><issue>7840</issue><fpage>125</fpage><lpage>130</lpage><pub-id pub-id-type="pmid">32906143</pub-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname><given-names>Rachel L</given-names></name><name><surname>Deming</surname><given-names>Damon J</given-names></name><name><surname>Deming</surname><given-names>Meagan E</given-names></name><name><surname>Yount</surname><given-names>Boyd L</given-names></name><name><surname>Baric</surname><given-names>Ralph S</given-names></name></person-group><article-title>Evaluation of a recombination-resistant coronavirus as a broadly applicable, rapidly implementable vaccine platform</article-title><source>Communications Biology</source><year>2018</year><volume>1</volume><issue>1</issue><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmcid">PMC6206136</pub-id><pub-id pub-id-type="pmid">30393776</pub-id><pub-id pub-id-type="doi">10.1038/s42003-018-0175-7</pub-id></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffiths-Jones</surname><given-names>S</given-names></name></person-group><article-title>Rfam: an RNA family database</article-title><source>Nucleic Acids Research</source><year>2003</year><month>January</month><volume>31</volume><issue>1</issue><fpage>439</fpage><lpage>441</lpage><pub-id pub-id-type="pmcid">PMC165453</pub-id><pub-id pub-id-type="pmid">12520045</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg006</pub-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsiao</surname><given-names>Ju Yuan</given-names></name><name><surname>Tang</surname><given-names>Chuan Yi</given-names></name><name><surname>Chang</surname><given-names>Ruay Shiung</given-names></name></person-group><article-title>An efficient algorithm for finding a maximum weight 2-independent set on interval graphs</article-title><source>Information Processing Letters</source><year>1992</year><volume>43</volume><issue>5</issue><fpage>229</fpage><lpage>235</lpage></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname><given-names>Doug</given-names></name><name><surname>Chen</surname><given-names>Gwo-Liang</given-names></name><name><surname>LoCascio</surname><given-names>Philip F</given-names></name><name><surname>Land</surname><given-names>Miriam L</given-names></name><name><surname>Larimer</surname><given-names>Frank W</given-names></name><name><surname>Hauser</surname><given-names>Loren J</given-names></name></person-group><article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title><source>BMC Bioinformatics</source><year>2010</year><volume>11</volume><issue>1</issue><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmcid">PMC2848648</pub-id><pub-id pub-id-type="pmid">20211023</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname><given-names>Doug</given-names></name><name><surname>LoCascio</surname><given-names>Philip F</given-names></name><name><surname>Hauser</surname><given-names>Loren J</given-names></name><name><surname>Uberbacher</surname><given-names>Edward C</given-names></name></person-group><article-title>Gene and translation initiation site prediction in metagenomic sequences</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>17</issue><fpage>2223</fpage><lpage>2230</lpage><pub-id pub-id-type="pmid">22796954</pub-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>Marilyn</given-names></name></person-group><article-title>Initiation of translation in prokaryotes and eukaryotes</article-title><source>Gene</source><year>1999</year><volume>234</volume><issue>2</issue><fpage>187</fpage><lpage>208</lpage><pub-id pub-id-type="pmid">10395892</pub-id></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname><given-names>Michael MC</given-names></name><name><surname>Stohlman</surname><given-names>Stephen A</given-names></name></person-group><article-title>Comparative analysis of RNA genomes of mouse hepatitis viruses</article-title><source>Journal of Virology</source><year>1981</year><volume>38</volume><issue>2</issue><fpage>661</fpage><lpage>670</lpage><pub-id pub-id-type="pmcid">PMC171196</pub-id><pub-id pub-id-type="pmid">6165837</pub-id><pub-id pub-id-type="doi">10.1128/jvi.38.2.661-670.1981</pub-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larkin</surname><given-names>Mark A</given-names></name><name><surname>Blackshields</surname><given-names>Gordon</given-names></name><name><surname>Brown</surname><given-names>Nigel P</given-names></name><name><surname>Chenna</surname><given-names>R</given-names></name><name><surname>McGettigan</surname><given-names>Paul A</given-names></name><name><surname>McWilliam</surname><given-names>Hamish</given-names></name><name><surname>Valentin</surname><given-names>Franck</given-names></name><name><surname>Wallace</surname><given-names>Iain M</given-names></name><name><surname>Wilm</surname><given-names>Andreas</given-names></name><name><surname>Lopez</surname><given-names>Rodrigo</given-names></name><etal/></person-group><article-title>Clustal W and Clustal X version 2.0</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>21</issue><fpage>2947</fpage><lpage>2948</lpage><pub-id pub-id-type="pmid">17846036</pub-id></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madhugiri</surname><given-names>Ramakanth</given-names></name><name><surname>Fricke</surname><given-names>Markus</given-names></name><name><surname>Marz</surname><given-names>Manja</given-names></name><name><surname>Ziebuhr</surname><given-names>John</given-names></name></person-group><article-title>RNA structure analysis of alphacoronavirus terminal genome regions</article-title><source>Virus Research</source><year>2014</year><volume>194</volume><fpage>76</fpage><lpage>89</lpage><pub-id pub-id-type="pmcid">PMC7114417</pub-id><pub-id pub-id-type="pmid">25307890</pub-id><pub-id pub-id-type="doi">10.1016/j.virusres.2014.10.001</pub-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maier</surname><given-names>Helena Jane</given-names></name><name><surname>Bickerton</surname><given-names>Erica</given-names></name><name><surname>Britton</surname><given-names>Paul</given-names></name></person-group><article-title>Coronaviruses</article-title><source>Methods and Protocols</source><year>2015</year></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michel</surname><given-names>Christian Jean</given-names></name><name><surname>Mayer</surname><given-names>Claudine</given-names></name><name><surname>Poch</surname><given-names>Olivier</given-names></name><name><surname>Thompson</surname><given-names>Julie Dawn</given-names></name></person-group><article-title>Characterization of accessory genes in coronavirus genomes</article-title><source>Virology Journal</source><year>2020</year><volume>17</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmcid">PMC7450977</pub-id><pub-id pub-id-type="pmid">32854725</pub-id><pub-id pub-id-type="doi">10.1186/s12985-020-01402-1</pub-id></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavesi</surname><given-names>Giulio</given-names></name><name><surname>Mereghetti</surname><given-names>Paolo</given-names></name><name><surname>Mauri</surname><given-names>Giancarlo</given-names></name><name><surname>Pesole</surname><given-names>Graziano</given-names></name></person-group><article-title>Weeder Web: discovery of transcription factor binding sites in a set of sequences from co-regulated genes</article-title><source>Nucleic Acids Research</source><year>2004</year><volume>32</volume><issue>suppl 2</issue><fpage>W199</fpage><lpage>W203</lpage><pub-id pub-id-type="pmcid">PMC441603</pub-id><pub-id pub-id-type="pmid">15215380</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh465</pub-id></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salzberg</surname><given-names>Steven L</given-names></name><name><surname>Delcher</surname><given-names>Arthur L</given-names></name><name><surname>Kasif</surname><given-names>Simon</given-names></name><name><surname>White</surname><given-names>Owen</given-names></name></person-group><article-title>Microbial gene identification using interpolated Markov models</article-title><source>Nucleic Acids Research</source><year>1998</year><volume>26</volume><issue>2</issue><fpage>544</fpage><lpage>548</lpage><pub-id pub-id-type="pmcid">PMC147303</pub-id><pub-id pub-id-type="pmid">9421513</pub-id><pub-id pub-id-type="doi">10.1093/nar/26.2.544</pub-id></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sashittal</surname><given-names>Palash</given-names></name><name><surname>Zhang</surname><given-names>Chuanyi</given-names></name><name><surname>Peng</surname><given-names>Jian</given-names></name><name><surname>El-Kebir</surname><given-names>Mohammed</given-names></name></person-group><article-title>Jumper enables discontinuous transcript assembly in coronaviruses</article-title><source>bioRxiv</source><year>2021</year><pub-id pub-id-type="pmcid">PMC8602663</pub-id><pub-id pub-id-type="pmid">34795232</pub-id><pub-id pub-id-type="doi">10.1038/s41467-021-26944-y</pub-id></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shukla</surname><given-names>Aditi</given-names></name><name><surname>Hilgenfeld</surname><given-names>Rolf</given-names></name></person-group><article-title>Acquisition of new protein domains by coronaviruses: analysis of overlapping genes coding for proteins N and 9b in SARS coronavirus</article-title><source>Virus Genes</source><year>2015</year><volume>50</volume><issue>1</issue><fpage>29</fpage><lpage>38</lpage><pub-id pub-id-type="pmcid">PMC7089080</pub-id><pub-id pub-id-type="pmid">25410051</pub-id><pub-id pub-id-type="doi">10.1007/s11262-014-1139-8</pub-id></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>Temple F</given-names></name><name><surname>Waterman</surname><given-names>Michael S</given-names></name><etal/></person-group><article-title>Identification of common molecular subsequences</article-title><source>Journal of Molecular Biology</source><year>1981</year><volume>147</volume><issue>1</issue><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sola</surname><given-names>Isabel</given-names></name><name><surname>Almazan</surname><given-names>Fernando</given-names></name><name><surname>Zúñiga</surname><given-names>Sonia</given-names></name><name><surname>Enjuanes</surname><given-names>Luis</given-names></name></person-group><article-title>Continuous and discontinuous RNA synthesis in coronaviruses</article-title><source>Annual review of virology</source><year>2015</year><volume>2</volume><fpage>265</fpage><lpage>288</lpage><pub-id pub-id-type="pmcid">PMC6025776</pub-id><pub-id pub-id-type="pmid">26958916</pub-id><pub-id pub-id-type="doi">10.1146/annurev-virology-100114-055218</pub-id></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sola</surname><given-names>Isabel</given-names></name><name><surname>Moreno</surname><given-names>José L</given-names></name><name><surname>Zúñiga</surname><given-names>Sonia</given-names></name><name><surname>Alonso</surname><given-names>Sara</given-names></name><name><surname>Luis</surname><given-names>Enjuanes</given-names></name></person-group><article-title>Role of Nucleotides Immediately Flanking the Transcription-Regulating Sequence Core in Coronavirus Subgenomic mRNA Synthesis</article-title><source>Journal of Virology</source><year>2005</year><month>February</month><volume>79</volume><issue>4</issue><fpage>2506</fpage><lpage>2516</lpage><pub-id pub-id-type="pmcid">PMC546574</pub-id><pub-id pub-id-type="pmid">15681451</pub-id><pub-id pub-id-type="doi">10.1128/JVI.79.4.2506-2516.2005</pub-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Ke</given-names></name><name><surname>Zheng</surname><given-names>Bo-Jian</given-names></name><name><surname>Zeng</surname><given-names>Rong</given-names></name><name><surname>Lu</surname><given-names>Wei</given-names></name><name><surname>Lin</surname><given-names>Yong-Ping</given-names></name><name><surname>Xue</surname><given-names>Liang</given-names></name><name><surname>Li</surname><given-names>Li</given-names></name><name><surname>Yang</surname><given-names>Lei-Lei</given-names></name><name><surname>Xu</surname><given-names>Chen</given-names></name><name><surname>Dai</surname><given-names>Jie</given-names></name><etal/></person-group><article-title>Severe acute respiratory syndrome coronavirus accessory protein 9b is a virion-associated protein</article-title><source>Virology</source><year>2009</year><volume>388</volume><issue>2</issue><fpage>279</fpage><lpage>285</lpage><pub-id pub-id-type="pmcid">PMC7103405</pub-id><pub-id pub-id-type="pmid">19394665</pub-id><pub-id pub-id-type="doi">10.1016/j.virol.2009.03.032</pub-id></element-citation></ref><ref id="R28"><label>[28]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Yiyan</given-names></name><name><surname>Yan</surname><given-names>Wei</given-names></name><name><surname>Hall</surname><given-names>A Brantley</given-names></name><name><surname>Xiaofang</surname><given-names>Jiang</given-names></name></person-group><article-title>Characterizing transcriptional regulatory sequences in coronaviruses and their role in recombination</article-title><source>Molecular Biology and Evolution</source><year>2021</year><volume>38</volume><issue>4</issue><fpage>1241</fpage><lpage>1248</lpage><pub-id pub-id-type="pmcid">PMC7665640</pub-id><pub-id pub-id-type="pmid">33146390</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msaa281</pub-id></element-citation></ref><ref id="R29"><label>[29]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Zizhen</given-names></name><name><surname>Weinberg</surname><given-names>Zasha</given-names></name><name><surname>Walter</surname><given-names>L Ruzzo</given-names></name></person-group><article-title>CMfinder—a covariance model based RNA motif finding algorithm</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><issue>4</issue><fpage>445</fpage><lpage>452</lpage><pub-id pub-id-type="pmid">16357030</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><title>Overview</title><p>(a) A coronavirus genome <bold>v</bold> consists of a leader region <bold>v</bold><sub>leader</sub> and a body region <bold>v</bold><sub>body</sub>. (b) Structural and accessory genes are expressed via discontinuous transcription with template switching occurring at transcription regulatory sequences (TRS, indicated in red), resulting in subgenomic messenger RNAs (sgmRNAs) for each gene. (c) In the TRS IDENTIFICATION (TRS-ID) problem, we wish to identify TRSs given a genome <bold>v</bold> with genes <bold>x</bold><sub>0</sub>, …, <bold>x</bold><sub><italic>n</italic></sub>. The TRS AND GENE IDENTIFICATION (TRS-GENE-ID) asks to simultaneously identify genes and their associated TRSs given genome <bold>v</bold>. Throughout this manuscript we use ‘T’ (thymine) rather than ‘U’ (uracil).</p></caption><graphic xlink:href="EMS162957-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Algorithm details</title><p>(a) Given genes <bold>x</bold><sub>0</sub>, …, <bold>x</bold><sub><italic>n</italic></sub>, we obtain candidate regions <bold>w</bold><sub>0</sub>, …, <bold>w</bold><sub><italic>n</italic></sub> by identifying upstream ORFs, skipping over ORFs if they are of length less than 100 nt (indicated by ‘*’). CORSID-A solves the TRS-ID problem by sliding a window <bold>u</bold> through <bold>w</bold><sub>0</sub>, solving <italic>n</italic> independent pair-wise dynamic programming problems, which together yield the optimal TRS alignment <italic>A</italic> for window <bold>u</bold>. (b) To solve the TRS-GENE-ID problem, CORSID additionally solves a maximum-weight independent set problem [<xref ref-type="bibr" rid="R11">11</xref>] on an interval graph defined by the candidate ORFs to simultaneously identify an optimal pair (<italic>A,</italic> Γ(<italic>A</italic>)) for window <bold>u</bold>.</p></caption><graphic xlink:href="EMS162957-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>CORSID-A accurately identifies TRS-Ls and TRS-Bs</title><p>(a) We used SuPER [<xref ref-type="bibr" rid="R28">28</xref>], MEME [<xref ref-type="bibr" rid="R2">2</xref>] and CORSID-A to identify TRS sites in 468 coronavirus genome with known gene locations. (b) The fraction of genomes for which the three methods identified the TRS-L correctly. (c) The fraction of genes of the genomes for which the three methods identified the corresponding TRS-B site correctly. (d) Number of coronavirus genomes of the four genera of the <italic>Coronaviridae</italic> family with different lengths of the TRS-L identified by the three methods. <xref ref-type="supplementary-material" rid="SD1">Fig. S4</xref> provides the TRS alignment identified by CORSID-A for the genome indicated by ‘*’.</p></caption><graphic xlink:href="EMS162957-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>CORSID accurately identifies TRS-Ls, TRS-Bs, and genes</title><p>(a) Precision and recall of Glimmer3 [<xref ref-type="bibr" rid="R5">5</xref>], Prodigal [<xref ref-type="bibr" rid="R12">12</xref>], and CORSID for gene prediction in 468 genomes. For clarity, we added a small jitter (drawn from <italic>N</italic> (0, 2.5 × 10<sup>−5</sup>)) to the 2D distribution plot. (b) Confusion matrices of the ground truth genes and the predicted genes by the three methods. In order to account for poorly annotated genomes, we used BLASTx [<xref ref-type="bibr" rid="R1">1</xref>] to verify the false positive genes predicted by the three methods. The adjusted confusion matrices are shown in the row below.</p></caption><graphic xlink:href="EMS162957-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>CORSID accurately finds genes in an unannotated <italic>Igacovirus</italic> genome (DQ288927)</title><p>(a) The position of the genes identified by CORSID. The Venn diagram shows the genes found by CORSID, Glimmer3 and Prodigal. “*” indicates ≥ 95% query/hit coverage, and “**” indicates a hit coverage of 93.5% and a query coverage of 98.3%. (b) TRS alignment for genes identified by CORSID. (c) The fraction of positions in <bold>v</bold><sub>body</sub> covered by genes identified by the three methods.</p></caption><graphic xlink:href="EMS162957-f005"/></fig></floats-group></article>