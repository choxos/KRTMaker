<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="preprint">
<?all-math-mml yes?>
<?use-mml?>
<?origin ukpmcpa?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
<journal-title-group>
<journal-title>bioRxiv : the preprint server for biology</journal-title>
</journal-title-group>
<issn pub-type="ppub"/>
</journal-meta>
<article-meta>
<article-id pub-id-type="manuscript">EMS137109</article-id>
<article-id pub-id-type="doi">10.1101/2021.10.16.464647</article-id>
<article-id pub-id-type="archive">PPR408445</article-id>
<article-version article-version-type="publisher-id">1</article-version>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>BugSplit: highly accurate taxonomic binning of metagenomic assemblies enables genome-resolved metagenomics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Chandrakumar</surname>
<given-names>Induja</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gauthier</surname>
<given-names>Nick P.G.</given-names>
</name>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Nelson</surname>
<given-names>Cassidy</given-names>
</name>
<xref ref-type="aff" rid="A3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bonsall</surname>
<given-names>Michael B.</given-names>
</name>
<xref ref-type="aff" rid="A3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Locher</surname>
<given-names>Kerstin</given-names>
</name>
<xref ref-type="aff" rid="A4">4</xref>
<xref ref-type="aff" rid="A5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Charles</surname>
<given-names>Marthe</given-names>
</name>
<xref ref-type="aff" rid="A4">4</xref>
<xref ref-type="aff" rid="A5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>MacDonald</surname>
<given-names>Clayton</given-names>
</name>
<xref ref-type="aff" rid="A4">4</xref>
<xref ref-type="aff" rid="A5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Krajden</surname>
<given-names>Mel</given-names>
</name>
<xref ref-type="aff" rid="A5">5</xref>
<xref ref-type="aff" rid="A6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Manges</surname>
<given-names>Amee R.</given-names>
</name>
<xref ref-type="aff" rid="A6">6</xref>
<xref ref-type="aff" rid="A7">7</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Chorlton</surname>
<given-names>Samuel D.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A5">5</xref>
</contrib>
</contrib-group>
<aff id="A1">
<label>1</label>BugSeq Bioinformatics Inc, Vancouver, British Columbia, Canada</aff>
<aff id="A2">
<label>2</label>Department of Microbiology and Immunology, University of British Columbia, Vancouver, British Columbia, Canada</aff>
<aff id="A3">
<label>3</label>Mathematical Ecology Research Group, Department of Zoology, University of Oxford, Oxford, United Kingdom</aff>
<aff id="A4">
<label>4</label>Division of Medical Microbiology, Vancouver General Hospital, Vancouver, British Columbia, Canada</aff>
<aff id="A5">
<label>5</label>Department of Pathology and Laboratory Medicine, University of British Columbia, Vancouver, British Columbia, Canada</aff>
<aff id="A6">
<label>6</label>British Columbia Centre for Disease Control, Vancouver, British Columbia, Canada</aff>
<aff id="A7">
<label>7</label>School of Population and Public Health, University of British Columbia, Vancouver, British Columbia, Canada</aff>
<author-notes>
<corresp id="CR1">
<bold>Corresponding author:</bold> Samuel D Chorlton, MD; <email>sam@bugseq.com</email>
</corresp>
</author-notes>
<pub-date pub-type="nihms-submitted">
<day>20</day>
<month>10</month>
<year>2021</year>
</pub-date>
<pub-date pub-type="preprint">
<day>19</day>
<month>10</month>
<year>2021</year>
</pub-date>
<permissions>
<ali:free_to_read/>
<license>
<ali:license_ref>https://creativecommons.org/licenses/by-nd/4.0/</ali:license_ref>
<license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nd/4.0/">CC BY-ND 4.0 International license</ext-link>.</license-p>
</license>
</permissions>
<abstract>
<p id="P1">A large gap remains between sequencing a microbial community and characterizing all of the organisms inside of it. Here we develop a novel method to taxonomically bin metagenomic assemblies through alignment of contigs against a reference database. We show that this workflow, BugSplit, bins metagenome-assembled contigs to species with a 33% absolute improvement in F1-score when compared to alternative tools. We perform nanopore mNGS on patients with COVID-19, and using a reference database predating COVID-19, demonstrate that BugSplit's taxonomic binning enables sensitive and specific detection of a novel coronavirus not possible with other approaches. When applied to nanopore mNGS data from cases of <italic>Klebsiella pneumoniae</italic> and <italic>Neisseria gonorrhoeae</italic> infection, BugSplit's taxonomic binning accurately separates pathogen sequences from those of the host and microbiota, and unlocks the possibility of sequence typing, <italic>in silico</italic> serotyping, and antimicrobial resistance prediction of each organism within a sample. BugSplit is available at <ext-link ext-link-type="uri" xlink:href="https://bugseq.com/academic">https://bugseq.com/academic</ext-link>.</p>
</abstract>
<kwd-group>
<kwd>Metagenomic</kwd>
<kwd>Binning</kwd>
<kwd>Profiling</kwd>
<kwd>Assembly</kwd>
<kwd>NGS</kwd>
<kwd>Long-read</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="S1" sec-type="intro">
<title>Introduction</title>
<p id="P2">Automated genome-resolved metagenomics, including the identification and characterization of members of a microbial community, has remained challenging despite improvements in sequencing technology and bioinformatic analysis<sup>
<xref ref-type="bibr" rid="R1">1</xref>
</sup>. A community-initiative for the Critical Assessment of Metagenomics Interpretation (CAMI) has tracked the progress of this goal over time and posited two main challenges for metagenomic next-generation sequencing (mNGS): profiling and binning<sup>
<xref ref-type="bibr" rid="R2">2</xref>
</sup>. Metagenomic profiling aims to quantify the presence/absence and abundance of organisms in a microbial community, and has seen a marked improvement in the number and performance of tools from the first to the second CAMI challenge<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup>.</p>
<p id="P3">Metagenomic binning aims to place sequences (usually assembled contigs) from the same organism in a unique bin, enabling the study of each organism within complex microbial communities. Metagenomic binning can further be divided into supervised and unsupervised approaches, where unsupervised approaches use sequence information such as tetranucleotide repeat counts and sequencing depth to bin sequences, while supervised approaches use reference sequence databases and previously generated information to bin sequences<sup>
<xref ref-type="bibr" rid="R4">4</xref>
</sup>. While unsupervised binners have improved over recent years, their lack of ability to assign taxonomic labels to bins precludes downstream analyses such as profiling the presence/absence of specific organisms, performing organism-specific analyses, or identifying sequences of concern (eg. novel pathogens with sequence homology to known pathogens)<sup>
<xref ref-type="bibr" rid="R3">3</xref>
</sup>. The COVID-19 pandemic has highlighted the need for such improvements, with the aim of ensuring early availability of pathogen-agnostic diagnostics when outbreaks of novel strains emerge<sup>
<xref ref-type="bibr" rid="R5">5</xref>
</sup>.</p>
<p id="P4">Earlier work on taxonomic binning has relied on amino acid alignments of assembled contigs to a universal protein database<sup>
<xref ref-type="bibr" rid="R6">6</xref>–<xref ref-type="bibr" rid="R9">9</xref>
</sup>. These workflows allow for identification of divergent sequences, but do not leverage the non-coding and synonymous variation within contigs, nor the positional relationship of classifier features (eg. co-localization of proteins) into taxonomic classification. An alternative approach relies on a search for taxa-specific conserved features; however, this approach is limited by recall, where contigs missing the conserved marker cannot be classified, and to date, no approaches encompass conserved markers spanning archaea, bacterial, viruses and eukaryotes<sup>
<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>
</sup>. Finally, k-mer and minimizer based approaches suffer from lack of positional relationship between k-mers, and lack of ability to resolve uncertainty when using a single k-mer or even base to break lowest common ancestor ties, as demonstrated in previous evaluations<sup>
<xref ref-type="bibr" rid="R9">9</xref>
</sup>.</p>
<p id="P5">In addition to software improvements, advancements in sequencing technology have enabled the production of higher quality metagenomic assemblies through long-read approaches, which have been posited to enable genome-resolved metagenomics<sup>
<xref ref-type="bibr" rid="R12">12</xref>,<xref ref-type="bibr" rid="R13">13</xref>
</sup>. Third-generation sequencers, such as those by Oxford Nanopore Technologies (ONT) and Pacific Biosciences (PacBio), can generate reads up to megabases in length and contigs spanning full microbial genomes<sup>
<xref ref-type="bibr" rid="R14">14</xref>
</sup>. Traditionally, there has been a tradeoff between read length and sequencing quality; however with the advent of high fidelity (HiFi) PacBio sequencing and improvements in ONT sequencing kits and basecallers, that gap is quickly disappearing<sup>
<xref ref-type="bibr" rid="R15">15</xref>–<xref ref-type="bibr" rid="R17">17</xref>
</sup>. Additionally, the small size and cost-effectiveness of third-generation sequencers is poised to enable broad-scale adoption of this technology for mNGS, which has already been used across clinical, food, defense and environmental applications<sup>
<xref ref-type="bibr" rid="R18">18</xref>–<xref ref-type="bibr" rid="R20">20</xref>
</sup>.</p>
<p id="P6">Here we describe BugSplit, an automated, supervised method to bin contigs by taxonomic identity. The main difference between our workflow, BugSplit, and others is that it utilizes local nucleotide alignments of contigs against a universal reference database, such as the NCBI nucleotide (nt) database or Refseq, for taxonomic binning of assemblies. Using full alignments captures the synonymous and non-coding variation, as well as the positional relationship of features, without needing to annotate protein coding regions or translate sequences. Several authors have posited that nucleotide alignment lacks sensitivity to classify divergent taxa<sup>
<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref>
</sup>; however, we show this assumption to be false when classifying contigs. Second, our approach leverages the absolute nucleotide identity (ANI) of alignments to collapse taxonomic assignments to higher ranks based on accepted ANI thresholds for defining taxa. Third, we incorporate uncertainty between alignments using a voting algorithm to collapse assignments up the taxonomic tree, and fourth, we adjust for known inaccuracies in reference databases by detecting and correcting misannotated contigs. We show that these advancements, especially when paired with long-read sequencing, enable the automated identification and characterization of microbes in complex microbial communities.</p>
</sec>
<sec id="S2" sec-type="results">
<title>Results</title>
<sec id="S3">
<title>Evaluation of taxonomic binning accuracy with mock microbial communities and known organisms</title>
<p id="P7">We first evaluate BugSplit using three commonly used benchmarking datasets generated with third-generation sequencers: the ZymoBIOMICS Even and Log datasets are mock microbial communities of eight bacteria and two yeasts, with varying abundance, sequenced on an ONT GridION<sup>
<xref ref-type="bibr" rid="R21">21</xref>
</sup>, and the ZymoBIOMICS Gut Microbiome Standard containing 19 bacteria (five of which are strains of the same species) and two yeasts sequenced on a PacBio Sequel II. We compare BugSplit with DIAMOND+MEGAN-LR and MMseqs2, two popular tools for taxonomic binning of contigs, and use the official CAMI AMBER tool to assess taxonomic binning performance<sup>
<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R22">22</xref>
</sup>. AMBER's calculation of performance metrics has been previously reported and is summarized in the methods, along with methods for assembly and polishing of each metagenomic community.</p>
<p id="P8">On average, BugSplit binned contigs to species bins with an absolute F1-score 33.0% better than DIAMOND+MEGAN-LR and 54.9% better than MMseqs2. These advantages are maintained across all taxonomic ranks, but decrease in magnitude at higher ranks where the performance of DIAMOND+MEGAN-LR and MMseqs2 improves (<xref ref-type="fig" rid="F1">Figure 1</xref>). BugSplit largely demonstrates superior accuracy by improving classification completeness while maintaining or surpassing the classification purity of alternative tools. At the species level, average classification purity was within 6% of DIAMOND+MEGAN-LR and MMseqs2, while average completeness exceeded DIAMOND+MEGAN-LR by 42.3% and MMseqs2 by 58.4%. Similarly, BugSplit was able to classify, to a species level, 36.6% more contigs than DIAMOND+MEGAN-LR and 50.6% more than MMseqs2, while misclassifying 0.5% fewer contigs than DIAMOND+MEGAN-LR and 3.3% more than MMseqs2. Finally, BugSplit achieves these improvements in accuracy without sacrificing execution time: BugSplit executed these processes faster than DIAMOND+MEGAN-LR and MMseqs2 on all three datasets by 100 minutes or more (<xref ref-type="supplementary-material" rid="SD3">Supplementary Table 2</xref>).</p>
<p id="P9">To highlight the classification performance of BugSplit on a species with close sequence homology yet very different implications for public safety, we apply BugSplit to a case of human anthrax (<italic>Bacillus anthracis</italic> strain Ba0914), sequenced on a MinION at the Centers for Disease Control and Prevention<sup>
<xref ref-type="bibr" rid="R23">23</xref>
</sup>. Our taxonomic binning pipeline classified the complete assembled genome in 1 hour and 20 minutes as <italic>Bacillus anthracis</italic>. MMseqs2 took 3 hours and 48 minutes to identify the bacterial genome as belonging to the family <italic>Bacillaceae</italic>, and DIAMOND+MEGAN-LR took 6 hours 38 minutes to identify the genome as <italic>Bacillus</italic> (most specific taxonomic classification presented for all classifiers).</p>
</sec>
<sec id="S4">
<title>Evaluation of taxonomic binning accuracy with novel organisms</title>
<p id="P10">To demonstrate that nucleotide alignment retains and even improves on the ability to bin divergent sequences from those in public databases, we apply BugSplit and the other taxonomic binners to two datasets simulating novel organisms. We first analyse the CAMI High-Complexity dataset, a well characterized microbial community comprising 2.80 Gb of contigs from 596 novel organisms generated from a simulated Illumina HiSeq sequencing run, which has been used in other benchmarking studies<sup>
<xref ref-type="bibr" rid="R2">2</xref>
</sup>. We use the CAMI version of Refseq from 2015, predating the publication of organisms in this dataset. BugSplit binned contigs with a genus-level absolute F1-score 16.0% and 15.2% better than DIAMOND+MEGAN-LR and MMseqs2, respectively, which was driven by both superior completeness and purity of bins (7-17.5% better purity, 13.5-14.3% better completeness) (<xref ref-type="fig" rid="F1">Figure 1</xref>). These advantages are maintained at the family rank, where BugSplit exhibited superior purity and completeness by 1 to 3%, respectively.</p>
<p id="P11">To demonstrate the impact of BugSplit's performance on detecting a novel pathogen, we performed nanopore mNGS using sequence-independent single primer amplification of two nasopharyngeal swabs from patients with COVID-19 and from one viral culture of SARS-CoV-2. We generated approximately 5000 to 24,000 reads per sample meeting stringent quality control settings, and assembled 6, 2 and 1 contigs spanning 2,000 to 14,000 base pairs from each sample. We analysed these contigs with BugSplit, DIAMOND+MEGAN-LR and MMseqs2, replacing their databases with an archive of the NCBI nucleotide database from 2019, predating the emergence of SARS-CoV-2.</p>
<p id="P12">BugSplit successfully classified all contigs to the genus Betacoronavirus, and correctly classified none of them to the species level. DIAMOND+MEGAN-LR overclassified two contigs, classifying them as Bat SARS-like coronavirus (parent species: Severe acute respiratory syndrome-related coronavirus), and failed to classify the other seven contigs. MMseqs2 classified eight of nine contigs as the less specific Coronaviridae family.</p>
</sec>
<sec id="S5">
<title>Improved taxonomic binning enables highly-accurate taxonomic profiling of third-generation metagenomic data</title>
<p id="P13">We hypothesized that accurate taxonomic assignment of contigs would improve compositional estimates derived from metagenome sequencing datasets. We have previously shown that alternative long-read taxonomic profilers vastly overestimate the number of species in a sample when applied to mNGS data: in our previous benchmarking study, BugSeq version 1, which was the top performing tool, estimated five times more species than the number of species truly present in a simple mock community (52 vs 10 true species present)<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup>. This result was two orders of magnitude better than Centrifuge (&gt;5000 species detected), the tool that currently drives ONT's official platform EPI2ME<sup>
<xref ref-type="bibr" rid="R24">24</xref>,<xref ref-type="bibr" rid="R25">25</xref>
</sup>. As metaFlye<sup>
<xref ref-type="bibr" rid="R26">26</xref>
</sup> produces length and coverage output of each contig in a metagenomic assembly, we can combine this information with BugSplit taxonomic bin labels to compute the relative abundance of each taxon in a sample in less than five minutes for all third-generation datasets. We additionally include two read-level taxonomic profilers in our comparison: Centrifuge (given its popularity for third-generation metagenomic analysis) and BugSeq version 1 (which has previously been shown to outperform other classifiers including MetaMaps<sup>
<xref ref-type="bibr" rid="R27">27</xref>
</sup> and CDKAM<sup>
<xref ref-type="bibr" rid="R28">28</xref>
</sup> on ONT data). Comparison of tools was performed with standardized metrics calculated with OPAL<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup>.</p>
<p id="P14">Indeed, we find that BugSplit was the top OPAL-ranked among all of the metagenomic profilers assessed, and exhibited the top F1-score (0.81 vs. 0.63 for second-place MMseqs2) when calling species as present or absent across the three benchmark communities (<xref ref-type="fig" rid="F2">Figure 2</xref>). Completeness was also highest after read-based profilers Centrifuge and BugSeq 1; however, Centrifuge called greater than 900 species as present across all datasets (true value: 10-21) and therefore had purity approaching 0, while BugSeq 1 had purity approaching 10%. In comparison, the purity of BugSplit was 89.4%. BugSplit assigned less than 0.02% of bases in each assembly to <italic>Saccharomyces pastorianus</italic>, a hybrid organism of <italic>Saccharomyces cerevisiae</italic> (truly present in each dataset) and <italic>Saccharomyces eubayanus</italic>; filtering these contigs out results in 100% purity for BugSplit across all three long-read datasets. We also find that BugSplit was most accurate identifying the abundance of each species in two of three datasets, and was second to BugSeq 1 for the third dataset, the Zymo Log community (L1 norm error: 0.109 versus 0.073). Organisms that BugSplit failed to detect had the lowest abundance in each dataset, with the exception of <italic>Faecalibacterium prausnitzii</italic>, <italic>Veillonella rogosae</italic> and <italic>Prevotella corporis</italic> from the Zymo Gut dataset, which had their assembled contigs assigned to the genus level. Difficulty in detecting the lowest abundance contigs reflects difficulty in assembling them rather than classifying their contigs; in the Zymo Log dataset, multiple organisms have sequencing coverage below 0.005X and therefore contribute no assembled contigs.</p>
</sec>
<sec id="S6">
<title>Binning by taxonomic identity enables targeted downstream analysis using tools designed for single-organism whole genome sequencing data</title>
<p id="P15">We demonstrate the importance of BugSplit's species-level taxonomic binning by applying it to a previously reported case of hypervirulent <italic>Klebsiella pneumoniae</italic> liver abscess and its detection using mock blood cultures<sup>
<xref ref-type="bibr" rid="R30">30</xref>
</sup>. Hypervirulence typing of <italic>K. pneumoniae</italic> is important for clinical care, as hypervirulent strains are more likely to cause life-threatening infections and are increasingly resistant to antimicrobials<sup>
<xref ref-type="bibr" rid="R31">31</xref>
</sup>. Two mock blood culture samples from this patient were created by spiking the isolate into blood at 30 CFU/mL, incubating it in an automated blood culture system and sequencing positive blood culture bottles using a nanopore sequencer as previously described<sup>
<xref ref-type="bibr" rid="R30">30</xref>
</sup>. BugSplit successfully detected the only microorganism as <italic>K. pneumoniae</italic> in both samples, and binned sequences belonging to <italic>K. pneumoniae</italic> together, producing bins 97.3% and 94.6% complete with less than 1% contamination using CheckM<sup>
<xref ref-type="bibr" rid="R32">32</xref>
</sup>. In contrast, MMseqs2 produced bins 94.3% and 44.8% complete, and DIAMOND+MEGAN-LR produced bins 29.3 and 25.7% complete. To demonstrate the impact of binning completeness, we implement automatic bioinformatic analyses developed for <italic>K. pneumoniae</italic> whole genome sequencing data (Kleborate<sup>
<xref ref-type="bibr" rid="R33">33</xref>
</sup>) on each bin labelled as <italic>K. pneumoniae</italic>. Kleborate has recently been reported to accurately predict sequence type, serotype and other features of <italic>K. pneumoniae</italic> isolates from WGS data. Kleborate correctly called each BugSplit <italic>K. pneumoniae</italic> bin from both blood culture bottles as sequence type 11 and serotype K47, concordant with bacterial culture and traditional serotyping results. In contrast, Kleborate was unable to determine sequence type for both DIAMOND+MEGAN-LR bins and one of two MMseqs2 bins, and was additionally unable to determine serotype for one of two DIAMOND+MEGAN-LR bins.</p>
<p id="P16">By binning at the species level, we can also attribute antimicrobial resistance genes and mutations to specific organisms in a sample. We incorporate ResFinder<sup>
<xref ref-type="bibr" rid="R34">34</xref>
</sup> into BugSplit and execute it automatically on all taxonomic bins, looking for variants that cause AMR specifically in the taxon assigned to each bin. We additionally implement a modification to ResFinder that automatically adjusts for the higher error rate of nanopore metagenomic assemblies, and corrects indels and erroneous stop codons in resistance conferring loci (see Methods, and publicly available in ResFinder version 4.2). We apply BugSplit and our modified ResFinder tool to a recent dataset of 10 urine samples from patients infected with <italic>Neisseria gonorrhoeae</italic>. Urine underwent mNGS using an ONT GridION, and cultured isolates from the same samples underwent Illumina sequencing for comparison, as previously reported<sup>
<xref ref-type="bibr" rid="R35">35</xref>
</sup>.</p>
<p id="P17">BugSplit successfully identified <italic>N. gonorrhoeae</italic> in all 10 samples, ranging from 1.1% to 58.1% of sequenced bases (2.0% to 72.8% of microbial sequenced bases). In contrast to the original Centrifuge-based analysis of this data, and in accordance with the authors’ conclusions that reads classified as <italic>Neisseria lactamica</italic> likely reflect taxonomic misclassification of <italic>N. gonorrhoeae</italic> reads, we find no <italic>N. lactamica</italic> in any of the samples.<sup>
<xref ref-type="bibr" rid="R35">35</xref>
</sup> Interestingly, we find one sample (original identifier: 301_UB_U) with co-infection with <italic>Ureaplasma urealyticum</italic>, another potential cause of urethritis. The original metagenomic analysis of this data does not discuss this finding, and this sequence was not found in any other samples.</p>
<p id="P18">BugSplit successfully assembled and binned together a median of 97.1% (range: 67.0-98.3%) of the <italic>N. gonorrhoeae</italic> genome, as determined by CheckM on the <italic>N. gonorrhoeae</italic> bins, with a maximum of 0.9% contamination. DIAMOND+MEGAN-LR and MMseqs2 binned a median of 11.4% (range: 0% to 26.7%) and 22.4% (range: 0% to 65.5%) of the <italic>N. gonorrhoeae</italic> genome, respectively, with a maximum of 0.2% contamination. When our modified ResFinder is run on the <italic>N. gonorrhoeae</italic> bins created with BugSplit, we identify variants conferring AMR to cephalosporins, quinolones, penicillins, macrolides and tetracyclines with 96.6% sensitivity (28/29 variants detected) and 100% specificity as compared with Illumina sequencing of cultured isolates from the same patients, and the authors’ original pathogen-specific analysis<sup>
<xref ref-type="bibr" rid="R36">36</xref>
</sup>. In comparison, DIAMOND+MEGAN-LR detected 13.8% of variants (4/29) and MMseqs2 detected 24.1% (7/29) variants conferring AMR.</p>
</sec>
</sec>
<sec id="S7" sec-type="discussion">
<title>Discussion</title>
<p id="P19">As mNGS becomes more ubiquitous and is applied to clinical, environmental, biodefense and other samples encompassing incredible microbial diversity, methods to characterize the genome and functional capacity of each organism in a sample become increasingly important. Here, we demonstrate that nucleotide alignment of contigs against a reference database enables significantly improved taxonomic binning of metagenomic assemblies when compared to tools that rely on protein alignments. To evaluate the performance of this approach, we performed taxonomic binning of simulated and real sequencing data from three sequencing technologies and microbial communities containing one to over 500 organisms. BugSplit can classify organisms with available reference genomes to the species level with significantly greater completeness than alternative approaches while preserving bin purity. Our results on simulated novel organisms demonstrate that nucleotide alignment retains sensitivity to classify divergent organisms, with precision to place them on the taxonomic tree at the appropriate rank.</p>
<p id="P20">We demonstrate through several use cases how these improvements in taxonomic binning unlock downstream analyses not feasible with current taxonomic binners. Our application of mNGS and BugSplit to the detection of SARS-CoV-2 before any reference sequences were available highlights the power of broadly deploying mNGS with optimal taxonomic binning for pathogen surveillance and pandemic prevention by detecting pathogens earlier. The robust binning provided by BugSplit also allows for automated analysis of taxonomic bins using tools designed for single organism whole genome sequencing data. We demonstrate that it is possible to accurately predict the sequence type, serotype and antimicrobial resistance of organisms directly from clinical samples such as blood cultures and urine. We additionally demonstrate how taxonomic binning may be used to identify unknown organisms of bioterrorism potential, such as <italic>Bacillus anthracis</italic>. As diagnostic microbiology laboratories adopt NGS for bacterial isolate and metagenomic sequencing, automated tools to detect pathogens and leverage the existing body of pathogen-specific bioinformatic analyses will enable a faster, easier transition to NGS. We anticipate that this technology will be broadly useful for the detection and characterization of organisms from diverse samples, and can be greatly expanded upon to support analyses that are application and domain specific.</p>
<p id="P21">We anticipate several improvements that will further refine taxonomic bins produced by BugSplit. The most substantial impact is likely to be the inclusion of assembly graph topology into the binning algorithm to improve strain-level resolution. Currently, metagenomic assemblers only output a single contig for conserved regions between different strains of a single species; using BugSplit, these contigs are assigned to the common species and placed in a species-level bin. By incorporating graph topology and linkage of contigs, we will be able to mitigate this limitation and place the contig in multiple strain-level taxonomic bins. Further exploration of the parameter space of BugSplit may also result in improved binning. For example, minimap2 could be tuned for greater alignment recall while preserving precision than its default “map-ont” setting, and voting coverage thresholds may be able to be tuned for improved classification of contigs across the taxonomic hierarchy. Ultimately, we expect to adopt a strategy that will allow optimal values for key parameters to be determined by the taxonomic lineage of alignments.</p>
<p id="P22">BugSplit is a highly accurate tool for taxonomic binning and profiling of third-generation metagenomic data with computing speeds faster than comparable workflows. We show that using BugSplit to bin metagenomic assemblies has several substantial downstream effects, including enabling highly similar species discrimination and identification, novel species identification and universal, pathogen-agnostic taxonomic profiling. When combined with automated assembly, polishing and post-processing of bins, we demonstrate that detecting pathogens, strain-typing them and accurately predicting their antimicrobial resistance directly from complex samples with mNGS becomes feasible.</p>
</sec>
<sec id="S8" sec-type="methods">
<title>Methods</title>
<sec id="S9">
<title>BugSplit Preprocessing</title>
<p id="P23">BugSplit uses Nextflow running on AWS Batch to orchestrate processing of sequencing data in the cloud. In brief, nanopore reads undergo demultiplexing and adapter trimming with qcat<sup>
<xref ref-type="bibr" rid="R37">37</xref>
</sup>.</p>
<p id="P24">Nanopore and PacBio (now added into the pipeline) next undergo quality control with prinseqlite<sup>
<xref ref-type="bibr" rid="R38">38</xref>
</sup>, filtering reads with a mean Phred score less than 7, a DUST complexity score less than 7 or a read length less than 100 base pairs. Finally, reads are aligned with minimap2<sup>
<xref ref-type="bibr" rid="R39">39</xref>
</sup> using default parameters against a database containing common non-microbial host genomes, including human, mouse, rat, pig, cow and chicken, to focus assembly on microorganisms. Reads unaligned to host genomes are retained and progress to assembly.</p>
<p id="P25">After preprocessing, reads are assembled with metaFlye<sup>
<xref ref-type="bibr" rid="R26">26</xref>
</sup>, preserving strain heterogeneity. Assemblies built from ONT R9.4.1 or R10.3 reads undergo four rounds of Racon<sup>
<xref ref-type="bibr" rid="R40">40</xref>
</sup> polishing, one round of Medaka<sup>
<xref ref-type="bibr" rid="R41">41</xref>
</sup> and one round of Homopolish<sup>
<xref ref-type="bibr" rid="R42">42</xref>
</sup>, in accordance with recent assembly benchmarking<sup>
<xref ref-type="bibr" rid="R43">43</xref>
</sup>. A mash database<sup>
<xref ref-type="bibr" rid="R44">44</xref>
</sup>, published by the mash authors and comprising all genomes and plasmid sequences in Refseq (<ext-link ext-link-type="uri" xlink:href="https://gembox.cbcb.umd.edu/mash/refseq.genomes%2Bplasmid.k21s1000.msh">https://gembox.cbcb.umd.edu/mash/refseq.genomes%2Bplasmid.k21s1000.msh</ext-link>) is used for homology search with Homopolish. Racon and Medaka are executed on g4dn-class instances via AWS Batch. PacBio HiFi and ONT Q20+ assemblies do not undergo polishing beyond that included in metaFlye. An entire GridION flowcell using R9.4.1 pores can be assembled and polished to Q40 in less than 6.5 hours, approximately 5 hours faster than using CPUs alone (<xref ref-type="supplementary-material" rid="SD3">Supplementary Material</xref>).</p>
</sec>
<sec id="S10">
<title>Taxonomic Binning of Contigs</title>
<p id="P26">Contigs are first aligned to a reference database such as RefSeq or NCBI nucleotide database (nt) with minimap2. We use the default `map-ont` preset of minimap2, as it provides the greatest sensitivity for nucleotide alignment out of all minimap2 presets and performs comparably to nucleotide BLAST<sup>
<xref ref-type="bibr" rid="R45">45</xref>
</sup>. We evaluated replacing minimap2 with an alternative local nucleotide aligner, discontiguous nucleotide megaBLASTN<sup>
<xref ref-type="bibr" rid="R46">46</xref>
</sup>, however this approach was too slow for practical purposes (<xref ref-type="supplementary-material" rid="SD3">Supplementary Material</xref>). As alignments are made to individual genomes representing a single strain of an organism, the taxonomic identification of each retained alignment is reassigned to internal nodes on the taxonomic tree based on absolute nucleotide identity. Based on the previous identification of ANI thresholds to define a species and genus, as well as the current error rates for metagenomic assembly and the lack of strain representation in public reference databases, we reassign any alignment to the reference database with 95-99% ANI to the species level, with 62-94.9% ANI to the genus level, and with less than 62% ANI to the superkingdom (highest rank before root) level<sup>
<xref ref-type="bibr" rid="R47">47</xref>–<xref ref-type="bibr" rid="R51">51</xref>
</sup>. Alignments with greater than 99% ANI are retained at the strain level.</p>
<p id="P27">As minimap2 randomly picks a primary alignment if there are multiple alignments with equal top score, we collapse equally good top hits to their lowest common ancestor. Alignments to collapse are identified as secondary alignments with equal dynamic programming score of the max scoring segment in the alignment (“ms” minimap2 SAM tag) to a non-secondary alignment, covering the exact same region of a query contig as the non-secondary alignment.</p>
<p id="P28">Next, we implement a voting algorithm to assign contigs to the taxonomic node encompassing a certain percentage of all bases in the contig, aggregating the alignments from above. We again parameterize this vote using accepted definitions of species and previous studies utilizing ANI, requiring 95% and 70% of bases in a contig to map to a strain or species for the contig to be assigned to that strain or species<sup>
<xref ref-type="bibr" rid="R52">52</xref>–<xref ref-type="bibr" rid="R54">54</xref>
</sup>, respectively. For ranks above species (eg. genus), we use a majority vote, assigning the contig to the deepest taxon encompassing at least 50% of all bases in a contig, as this approach has previously been reported to perform well<sup>
<xref ref-type="bibr" rid="R55">55</xref>
</sup>. In summary, for a contig to be assigned to a species, it must have at least 70% of its bases with 95% or more ANI mapped to a reference sequence.</p>
<p id="P29">NCBI assigns plasmids to the taxonomy identity of their host bacteria in which they were first sequenced<sup>
<xref ref-type="bibr" rid="R56">56</xref>,<xref ref-type="bibr" rid="R57">57</xref>
</sup>. This can be misleading due to plasmid conjugation and the ability of plasmids to replicate in organisms across phylogenetic subgroups. We implement a mechanism to recover and correct taxon labels of plasmid sequences. In brief, plasmid sequences are identified with PlasmidFinder<sup>
<xref ref-type="bibr" rid="R58">58</xref>
</sup>, and their taxonomic identities are overridden to that of “plasmid sequences” (NCBI taxon 36549). Full commands and versions for each program are available in the <xref ref-type="supplementary-material" rid="SD3">supplementary material</xref>.</p>
</sec>
<sec id="S11">
<title>Abundance Calculation</title>
<p id="P30">The relative abundance of a taxon <italic>t</italic>, in terms of percent of total nucleic acid in a sample, can be approximated using the sequencing depth and length of all contigs <italic>c</italic> assigned to <italic>t</italic>(<italic>c<sub>t</sub>
</italic>), divided by the total size of sequencing data: <disp-formula id="FD1">
<mml:math id="M1">
<mml:mrow>
<mml:mtext>Relative</mml:mtext>
<mml:mspace width="0.2em"/>
<mml:mtext>abundance</mml:mtext>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mstyle displaystyle="true">
<mml:mi>∑</mml:mi>
</mml:mstyle>
<mml:mtext>​</mml:mtext>
</mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>p</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>h</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>c</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>×</mml:mo>
<mml:mi>l</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>g</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>h</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>c</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mstyle mathsize="140%" displaystyle="true">
<mml:mi>∑</mml:mi>
</mml:mstyle>
<mml:mtext>​</mml:mtext>
</mml:msup>
<mml:mtext>read</mml:mtext>
<mml:mspace width="0.2em"/>
<mml:mtext>lengths</mml:mtext>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p id="P31">Abundance in bases can be summed up the taxonomic tree to calculate cumulative bases assigned to each taxon, yielding relative abundance at all ranks, in an approach similar to Sczyrba et al<sup>
<xref ref-type="bibr" rid="R2">2</xref>
</sup>.</p>
</sec>
<sec id="S12">
<title>Accuracy Assessment and Comparison to Alternative Tools</title>
<p id="P32">We use AMBER<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup> version 2.0.2 to assess the performance of each tool binning contigs to taxa. Bin completeness was calculated as the average fraction of true positive base pairs in each predicted bin from the true bin size. Bin purity was calculated as the average fraction of true positive base pairs in each predicted bin. We use OPAL<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup> version 1.0.10 to assess the taxonomic profiling performance of each tool. The default OPAL ranking scheme was used to identify the top taxonomic profiler. OPAL's purity is calculated as the number of taxa correctly predicted as present in a sample divided by all predicted taxa at that rank. OPAL's completeness is calculated as the number of taxa correctly predicted as present in a sample divided by all taxa present at that rank. Completeness and purity for both AMBER<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup> and OPAL<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup> range from 0 (worst) to 1 (best). Further calculation details are available in their respective original publications.</p>
<p id="P33">MMseqs2 and DIAMOND were run with the NCBI non-redundant amino acid database as suggested by their authors. All databases were downloaded on May 15, 2021, and all tools were run with 96 threads and 768Gb of RAM available to them. The CAMI comparison used the 2015 Refseq database and NCBI taxonomy as provided by the CAMI authors.<sup>
<xref ref-type="bibr" rid="R2">2</xref>
</sup> The built-in taxonomy of MEGAN-LR was replaced by placing ncbi.tre and ncbi.map, a Newick formatted NCBI taxonomy, in the working directory. These files were generated by converting the NCBI taxonomy files (names.dmp and nodes.dmp) provided with the CAMI datasets into Newick format with the Python taxonomy package<sup>
<xref ref-type="bibr" rid="R59">59</xref>
</sup>.</p>
<p id="P34">Ground truth classifications were generated for all datasets except for CAMI, which used the gold standard contig classifications provided by CAMI. Ground truths were generated by comparing each contig in our metagenomic assembly to the reference genome of each organism contained within the mock microbial community using MegaBLASTN. The taxonomic identification of the top BLAST hit for each contig was determined to be its gold standard assignment.</p>
</sec>
<sec id="S13">
<title>Application to detection of an emerging coronavirus, hypervirulent <italic>Klebsiella pneumoniae</italic> and <italic>Neisseria gonorrhoeae</italic> infections</title>
<p id="P35">For the detection of an emerging coronavirus, nasopharyngeal swabs (n = 2) were collected as part of routine testing at Vancouver General Hospital during Fall 2020 (<italic>ORF1ab</italic> C<sub>t</sub> values = 14.7, 20.6) and cultured SARS-CoV-2 viral particles (<italic>RdRp</italic> C<sub>t</sub> value = 18.3) were obtained from the BC Centre for Disease Control Public Health Laboratory. Both clinical samples and cultured virions were extracted and randomly amplified through sequence-independent single-primer amplification as previously described<sup>
<xref ref-type="bibr" rid="R60">60</xref>
</sup>. Samples were sequenced on Oxford Nanopore MinION devices and basecalling was performed with Guppy (Oxford Nanopore Technologies). Ethics approval for collection of nasopharyngeal swabs was obtained from the University of British Columbia (H20-02152).</p>
<p id="P36">For the application to human anthrax, hypervirulent <italic>K. pneumoniae</italic>, and <italic>N. gonorrhoeae</italic> infections, raw data was downloaded from the NCBI accessions listed below in Data Availability and submitted to BugSplit. In brief, reads were preprocessed, assembled and polished as detailed above in BugSplit preprocessing. Binning completion and contamination were assessed with CheckM using the default CheckM database. The NCBI nucleotide database from 2019 was downloaded from the second CAMI challenge (<ext-link ext-link-type="uri" xlink:href="https://openstack.cebitec.unibielefeld.de:8080/swift/v1/CAMI_2_DATABASES/ncbi_blast/nt.gz">https://openstack.cebitec.unibielefeld.de:8080/swift/v1/CAMI_2_DATABASES/ncbi_blast/nt.gz</ext-link>) and used in place of BugSplit's default database for the emerging coronavirus application.</p>
</sec>
<sec id="S14">
<title>Modifications to ResFinder to accommodate for insertions, deletions and stop codons in assemblies with high error rates</title>
<p id="P37">By default, ResFinder<sup>
<xref ref-type="bibr" rid="R34">34</xref>
</sup> (which includes the PointFinder<sup>
<xref ref-type="bibr" rid="R61">61</xref>
</sup> module) performs a BLASTN<sup>
<xref ref-type="bibr" rid="R46">46</xref>
</sup> alignment of the query assembly against a database of resistance loci. PointFinder scans each alignment and identifies all differences, including insertions and deletions (indels), between the query assembly and reference locus for further annotation. In the event of a stop codon (nucleotides TAG, TAA or TGA) within a locus, PointFinder terminates its search for variants in the region upstream to the stop codon. Full details are available in the original PointFinder<sup>
<xref ref-type="bibr" rid="R61">61</xref>
</sup> methods. We base our modifications to PointFinder on the previously demonstrated observation that frameshifts and stop codons in third-generation assemblies are more likely to reflect sequencing and assembly errors than true sequence variation<sup>
<xref ref-type="bibr" rid="R62">62</xref>,<xref ref-type="bibr" rid="R63">63</xref>
</sup>. We modify PointFinder to not halt its search for variants along a resistance loci if it encounters a stop codon. We additionally modify PointFinder to shift alignments around indels, maintaining the reading frame, in an approach similar to more general frameshift correction tools<sup>
<xref ref-type="bibr" rid="R62">62</xref>,<xref ref-type="bibr" rid="R63">63</xref>
</sup>. Our modified PointFinder has been incorporated into ResFinder version 4.2 and can be activated with the `-ii` (Ignore Indels) and `-ic` (Ignore stop <underline>C</underline>odons) flags.</p>
</sec>
</sec>
<sec sec-type="supplementary-material" id="SM">
<title>Supplementary Material</title>
<supplementary-material content-type="local-data" id="SD1">
<label>AMBER Output File</label>
<media xlink:href="EMS137109-supplement-AMBER_Output_File.zip" mimetype="application" mime-subtype="zip" id="N66715" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD2">
<label>OPAL Output File</label>
<media xlink:href="EMS137109-supplement-OPAL_Output_File.zip" mimetype="application" mime-subtype="zip" id="N66724" position="anchor"/>
</supplementary-material>
<supplementary-material content-type="local-data" id="SD3">
<label>Supplementary Material</label>
<media xlink:href="EMS137109-supplement-Supplementary_Material.doc" mimetype="application" mime-subtype="msword" id="N66733" position="anchor"/>
</supplementary-material>
</sec>
</body>
<back>
<sec id="S15" sec-type="data-availability">
<title>Data Availability</title>
<p id="P38">A public instance of BugSplit is freely available for academic use at <ext-link ext-link-type="uri" xlink:href="https://bugseq.com/academic">https://bugseq.com/academic</ext-link>. Acceptable inputs include FASTQ files from one or more samples sequenced on an Illumina, PacBio or ONT sequencer. Paired Illumina FASTQ files are also accepted. Outputs comprise taxonomic profiling in visual (HTML) and Kraken-report format, taxonomic bins in FASTA format, and additional bin-specific analyses as detailed above in textual and visual formats.</p>
</sec>
<fn-group>
<fn id="FN1">
<p id="P39">Benchmarking data was downloaded from:</p>
<p id="P40">
<italic>Bacillus anthracis</italic> whole genome nanopore sequencing: SRA accession SRR10088696</p>
<p id="P41">ZymoBIOMICS Even nanopore mNGS: SRA accession ERR3152364</p>
<p id="P42">ZymoBIOMICS Log nanopore mNGS: SRA accession ERR3152366</p>
<p id="P43">ZymoBIOMICS Gut PacBio HiFi mNGS: SRA accession SRR13128014</p>
<p id="P44">CAMI High Complexity gold standard assembly and ground truth labels: <ext-link ext-link-type="uri" xlink:href="https://openstack.cebitec.uni-bielefeld.de:8080/swift/v1/CAMI_I_HIGH">https://openstack.cebitec.uni-bielefeld.de:8080/swift/v1/CAMI_I_HIGH</ext-link> using the CAMI downloader.</p>
<p id="P45">COVID-19 nanopore mNGS data: Bioproject Accession Number PRJNA766077</p>
<p id="P46">Hypervirulent <italic>Klebsiella pneumoniae</italic> nanopore mNGS data: NCBI BioProject PRJNA663005</p>
<p id="P47">
<italic>Neisseria gonorrhoeae</italic> nanopore mNGS data: NCBI BioProject PRJEB35173</p>
<p id="P48">NCBI nt database from 2019: <ext-link ext-link-type="uri" xlink:href="https://openstack.cebitec.unibielefeld.de:8080/swift/v1/CAMI_2_DATABASES/ncbi_blast/nt.gz">https://openstack.cebitec.unibielefeld.de:8080/swift/v1/CAMI_2_DATABASES/ncbi_blast/nt.gz</ext-link>
</p>
<p id="P49">Our error-tolerant mode has been integrated into ResFinder/PointFinder and is freely available at: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/resfinder/src/master/">https://bitbucket.org/genomicepidemiology/resfinder/src/master/</ext-link>. Error-tolerant mode can be activated with the `-ii` and `-ic` command line flags.</p>
</fn>
</fn-group>
<ref-list>
<ref id="R1">
<label>1</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kayani</surname>
<given-names>MUR</given-names>
</name>
<name>
<surname>Huang</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Feng</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Chen</surname>
<given-names>L</given-names>
</name>
</person-group>
<article-title>Genome-resolved metagenomics using environmental and clinical samples</article-title>
<source>Brief Bioinform</source>
<year>2021</year>
<volume>22</volume>
</element-citation>
</ref>
<ref id="R2">
<label>2</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sczyrba</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<article-title>Critical Assessment of Metagenome Interpretation—a benchmark of metagenomics software</article-title>
<source>Nat Methods</source>
<year>2017</year>
<volume>14</volume>
<fpage>1063</fpage>
<lpage>1071</lpage>
</element-citation>
</ref>
<ref id="R3">
<label>3</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Meyer</surname>
<given-names>F</given-names>
</name>
<etal/>
</person-group>
<source>Critical Assessment of Metagenome Interpretation - the second round of challenges</source>
<year>2021</year>
<pub-id pub-id-type="doi">10.1101/2021.07.12.451567</pub-id>
<elocation-id>2021.07.12.451567</elocation-id>
</element-citation>
</ref>
<ref id="R4">
<label>4</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Breitwieser</surname>
<given-names>FP</given-names>
</name>
<name>
<surname>Lu</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Salzberg</surname>
<given-names>SL</given-names>
</name>
</person-group>
<article-title>A review of methods and databases for metagenomic classification and assembly</article-title>
<source>Brief Bioinform</source>
<year>2019</year>
<volume>20</volume>
<fpage>1125</fpage>
<lpage>1136</lpage>
</element-citation>
</ref>
<ref id="R5">
<label>5</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Vandenberg</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Martiny</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Rochas</surname>
<given-names>O</given-names>
</name>
<name>
<surname>van Belkum</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Kozlakidis</surname>
<given-names>Z</given-names>
</name>
</person-group>
<article-title>Considerations for diagnostic COVID-19 tests</article-title>
<source>Nat Rev Microbiol</source>
<year>2021</year>
<volume>19</volume>
<fpage>171</fpage>
<lpage>183</lpage>
</element-citation>
</ref>
<ref id="R6">
<label>6</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mirdita</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Steinegger</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Breitwieser</surname>
<given-names>F</given-names>
</name>
<name>
<surname>Söding</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Levy Karin</surname>
<given-names>E</given-names>
</name>
</person-group>
<article-title>Fast and sensitive taxonomic assignment to metagenomic contigs</article-title>
<source>Bioinformatics</source>
<year>2021</year>
<volume>37</volume>
<fpage>3029</fpage>
<lpage>3031</lpage>
</element-citation>
</ref>
<ref id="R7">
<label>7</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Huson</surname>
<given-names>DH</given-names>
</name>
<etal/>
</person-group>
<article-title>MEGAN-LR: new algorithms allow accurate binning and easy interactive exploration of metagenomic long reads and contigs</article-title>
<source>Biol Direct</source>
<year>2018</year>
<volume>13</volume>
<issue>6</issue>
</element-citation>
</ref>
<ref id="R8">
<label>8</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bağcı</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Patz</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Huson</surname>
<given-names>DH</given-names>
</name>
</person-group>
<article-title>DIAMOND+MEGAN: Fast and Easy Taxonomic and Functional Analysis of Short and Long Microbiome Sequences</article-title>
<source>Curr Protoc</source>
<year>2021</year>
<volume>1</volume>
<fpage>e59</fpage>
</element-citation>
</ref>
<ref id="R9">
<label>9</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>von Meijenfeldt</surname>
<given-names>FAB</given-names>
</name>
<name>
<surname>Arkhipova</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Cambuy</surname>
<given-names>DD</given-names>
</name>
<name>
<surname>Coutinho</surname>
<given-names>FH</given-names>
</name>
<name>
<surname>Dutilh</surname>
<given-names>BE</given-names>
</name>
</person-group>
<article-title>Robust taxonomic classification of uncharted microbial sequences and bins with CAT and BAT</article-title>
<source>Genome Biol</source>
<year>2019</year>
<volume>20</volume>
<fpage>217</fpage>
</element-citation>
</ref>
<ref id="R10">
<label>10</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gregor</surname>
<given-names>I</given-names>
</name>
<name>
<surname>Dröge</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Schirmer</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Quince</surname>
<given-names>C</given-names>
</name>
<name>
<surname>McHardy</surname>
<given-names>AC</given-names>
</name>
</person-group>
<article-title>PhyloPythiaS+: a self-training method for the rapid reconstruction of low-ranking taxonomic bins from metagenomes</article-title>
<source>PeerJ</source>
<year>2016</year>
<volume>4</volume>
<elocation-id>e1603</elocation-id>
</element-citation>
</ref>
<ref id="R11">
<label>11</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chaumeil</surname>
<given-names>PA</given-names>
</name>
<name>
<surname>Mussig</surname>
<given-names>AJ</given-names>
</name>
<name>
<surname>Hugenholtz</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Parks</surname>
<given-names>DH</given-names>
</name>
</person-group>
<article-title>GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database</article-title>
<source>Bioinformatics</source>
<year>2020</year>
<volume>36</volume>
<fpage>1925</fpage>
<lpage>1927</lpage>
</element-citation>
</ref>
<ref id="R12">
<label>12</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gehrig</surname>
<given-names>JL</given-names>
</name>
<etal/>
</person-group>
<source>Finding the right fit: A comprehensive evaluation of short-read and long-read sequencing approaches to maximize the utility of clinical microbiome data</source>
<year>2021</year>
<pub-id pub-id-type="doi">10.1101/2021.08.31.458285</pub-id>
<elocation-id>2021.08.31.458285</elocation-id>
</element-citation>
</ref>
<ref id="R13">
<label>13</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Malmstrom</surname>
<given-names>RR</given-names>
</name>
<name>
<surname>Eloe-Fadrosh</surname>
<given-names>EA</given-names>
</name>
</person-group>
<article-title>Advancing Genome-Resolved Metagenomics beyond the Shotgun</article-title>
<source>mSystems</source>
<volume>4</volume>
<fpage>e00118</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R14">
<label>14</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Payne</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Holmes</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Rakyan</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Loose</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>BulkVis: a graphical viewer for Oxford nanopore bulk FAST5 files</article-title>
<source>Bioinformatics</source>
<year>2019</year>
<volume>35</volume>
<fpage>2193</fpage>
<lpage>2198</lpage>
</element-citation>
</ref>
<ref id="R15">
<label>15</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lang</surname>
<given-names>D</given-names>
</name>
<etal/>
</person-group>
<article-title>Comparison of the two up-to-date sequencing technologies for genome assembly: HiFi reads of Pacific Biosciences Sequel II system and ultralong reads of Oxford Nanopore</article-title>
<source>GigaScience</source>
<year>2020</year>
<volume>9</volume>
</element-citation>
</ref>
<ref id="R16">
<label>16</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lal</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<source>Improving long-read consensus sequencing accuracy with deep learning</source>
<year>2021</year>
<pub-id pub-id-type="doi">10.1101/2021.06.28.450238</pub-id>
<elocation-id>2021.06.28.450238</elocation-id>
</element-citation>
</ref>
<ref id="R17">
<label>17</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wick</surname>
<given-names>RR</given-names>
</name>
<name>
<surname>Judd</surname>
<given-names>LM</given-names>
</name>
<name>
<surname>Holt</surname>
<given-names>KE</given-names>
</name>
</person-group>
<article-title>Performance of neural network basecalling tools for Oxford Nanopore sequencing</article-title>
<source>Genome Biol</source>
<year>2019</year>
<volume>20</volume>
<fpage>129</fpage>
</element-citation>
</ref>
<ref id="R18">
<label>18</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Petersen</surname>
<given-names>LM</given-names>
</name>
<name>
<surname>Martin</surname>
<given-names>IW</given-names>
</name>
<name>
<surname>Moschetti</surname>
<given-names>WE</given-names>
</name>
<name>
<surname>Kershaw</surname>
<given-names>CM</given-names>
</name>
<name>
<surname>Tsongalis</surname>
<given-names>GJ</given-names>
</name>
</person-group>
<article-title>Third-Generation Sequencing in the Clinical Laboratory: Exploring the Advantages and Challenges of Nanopore Sequencing</article-title>
<source>J Clin Microbiol</source>
<volume>58</volume>
<fpage>e01315</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R19">
<label>19</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Maguire</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>Precision long-read metagenomics sequencing for food safety by detection and assembly of Shiga toxin-producing Escherichia coli in irrigation water</article-title>
<source>PLOS ONE</source>
<year>2021</year>
<volume>16</volume>
<elocation-id>e0245172</elocation-id>
</element-citation>
</ref>
<ref id="R20">
<label>20</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Urban</surname>
<given-names>L</given-names>
</name>
<etal/>
</person-group>
<article-title>Freshwater monitoring by nanopore sequencing</article-title>
<source>eLife</source>
<year>2021</year>
<volume>10</volume>
<elocation-id>e61504</elocation-id>
</element-citation>
</ref>
<ref id="R21">
<label>21</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nicholls</surname>
<given-names>SM</given-names>
</name>
<name>
<surname>Quick</surname>
<given-names>JC</given-names>
</name>
<name>
<surname>Tang</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Loman</surname>
<given-names>NJ</given-names>
</name>
</person-group>
<article-title>Ultra-deep, long-read nanopore sequencing of mock microbial community standards</article-title>
<source>GigaScience</source>
<year>2019</year>
<volume>8</volume>
</element-citation>
</ref>
<ref id="R22">
<label>22</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Meyer</surname>
<given-names>F</given-names>
</name>
<etal/>
</person-group>
<article-title>AMBER: Assessment of Metagenome BinnERs</article-title>
<source>GigaScience</source>
<year>2018</year>
<volume>7</volume>
</element-citation>
</ref>
<ref id="R23">
<label>23</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>McLaughlin</surname>
<given-names>HP</given-names>
</name>
<etal/>
</person-group>
<article-title>Rapid Nanopore Whole-Genome Sequencing for Anthrax Emergency Preparedness</article-title>
<source>Emerg Infect Dis</source>
<year>2020</year>
<volume>26</volume>
<fpage>358</fpage>
<lpage>361</lpage>
</element-citation>
</ref>
<ref id="R24">
<label>24</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Fan</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Huang</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Chorlton</surname>
<given-names>SD</given-names>
</name>
</person-group>
<article-title>BugSeq: a highly accurate cloud platform for long-read metagenomic analyses</article-title>
<source>BMC Bioinformatics</source>
<year>2021</year>
<volume>22</volume>
<fpage>160</fpage>
</element-citation>
</ref>
<ref id="R25">
<label>25</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kim</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Song</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Breitwieser</surname>
<given-names>FP</given-names>
</name>
<name>
<surname>Salzberg</surname>
<given-names>SL</given-names>
</name>
</person-group>
<article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
<source>Genome Res</source>
<year>2016</year>
<volume>26</volume>
<fpage>1721</fpage>
<lpage>1729</lpage>
</element-citation>
</ref>
<ref id="R26">
<label>26</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kolmogorov</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>metaFlye: scalable long-read metagenome assembly using repeat graphs</article-title>
<source>Nat Methods</source>
<year>2020</year>
<volume>17</volume>
<fpage>1103</fpage>
<lpage>1110</lpage>
</element-citation>
</ref>
<ref id="R27">
<label>27</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Dilthey</surname>
<given-names>AT</given-names>
</name>
<name>
<surname>Jain</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Koren</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Phillippy</surname>
<given-names>AM</given-names>
</name>
</person-group>
<article-title>Strain-level metagenomic assignment and compositional estimation for long reads with MetaMaps</article-title>
<source>Nat Commun</source>
<year>2019</year>
<volume>10</volume>
<elocation-id>3066</elocation-id>
</element-citation>
</ref>
<ref id="R28">
<label>28</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bui</surname>
<given-names>VK</given-names>
</name>
<name>
<surname>Wei</surname>
<given-names>C</given-names>
</name>
</person-group>
<article-title>CDKAM: a taxonomic classification tool using discriminative k-mers and approximate matching strategies</article-title>
<source>BMC Bioinformatics</source>
<year>2020</year>
<volume>21</volume>
<fpage>468</fpage>
</element-citation>
</ref>
<ref id="R29">
<label>29</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Meyer</surname>
<given-names>F</given-names>
</name>
<etal/>
</person-group>
<article-title>Assessing taxonomic metagenome profilers with OPAL</article-title>
<source>Genome Biol</source>
<year>2019</year>
<volume>20</volume>
<fpage>51</fpage>
</element-citation>
</ref>
<ref id="R30">
<label>30</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhou</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>
<article-title>Comprehensive Pathogen Identification, Antibiotic Resistance, and Virulence Genes Prediction Directly From Simulated Blood Samples and Positive Blood Cultures by Nanopore Metagenomic Sequencing</article-title>
<source>Front Genet</source>
<year>2021</year>
<volume>12</volume>
<fpage>244</fpage>
</element-citation>
</ref>
<ref id="R31">
<label>31</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Russo</surname>
<given-names>TA</given-names>
</name>
<name>
<surname>Marr</surname>
<given-names>CM</given-names>
</name>
</person-group>
<article-title>Hypervirulent Klebsiella pneumoniae</article-title>
<source>Clin Microbiol Rev</source>
<volume>32</volume>
<fpage>e00001</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R32">
<label>32</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Parks</surname>
<given-names>DH</given-names>
</name>
<name>
<surname>Imelfort</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Skennerton</surname>
<given-names>CT</given-names>
</name>
<name>
<surname>Hugenholtz</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Tyson</surname>
<given-names>GW</given-names>
</name>
</person-group>
<article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>
<source>Genome Res</source>
<year>2015</year>
<volume>25</volume>
<fpage>1043</fpage>
<lpage>1055</lpage>
</element-citation>
</ref>
<ref id="R33">
<label>33</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lam</surname>
<given-names>MMC</given-names>
</name>
<etal/>
</person-group>
<article-title>A genomic surveillance framework and genotyping tool for Klebsiella pneumoniae and its related species complex</article-title>
<source>Nat Commun</source>
<year>2021</year>
<volume>12</volume>
<elocation-id>4188</elocation-id>
</element-citation>
</ref>
<ref id="R34">
<label>34</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bortolaia</surname>
<given-names>V</given-names>
</name>
<etal/>
</person-group>
<article-title>ResFinder 4.0 for predictions of phenotypes from genotypes</article-title>
<source>J Antimicrob Chemother</source>
<year>2020</year>
<volume>75</volume>
<fpage>3491</fpage>
<lpage>3500</lpage>
</element-citation>
</ref>
<ref id="R35">
<label>35</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Street</surname>
<given-names>TL</given-names>
</name>
<etal/>
</person-group>
<article-title>Optimizing DNA Extraction Methods for Nanopore Sequencing of Neisseria gonorrhoeae Directly from Urine Samples</article-title>
<source>J Clin Microbiol</source>
<volume>58</volume>
<fpage>e01822</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R36">
<label>36</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sanderson</surname>
<given-names>ND</given-names>
</name>
<etal/>
</person-group>
<article-title>High precision Neisseria gonorrhoeae variant and antimicrobial resistance calling from metagenomic Nanopore sequencing</article-title>
<source>Genome Res</source>
<year>2020</year>
<volume>30</volume>
<fpage>1354</fpage>
<lpage>1363</lpage>
</element-citation>
</ref>
<ref id="R37">
<label>37</label>
<element-citation publication-type="book">
<source>qcat</source>
<year>2021</year>
<publisher-name>Oxford Nanopore Technologies</publisher-name>
</element-citation>
</ref>
<ref id="R38">
<label>38</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schmieder</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Edwards</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Quality control and preprocessing of metagenomic datasets</article-title>
<source>Bioinformatics</source>
<year>2011</year>
<volume>27</volume>
<fpage>863</fpage>
<lpage>864</lpage>
</element-citation>
</ref>
<ref id="R39">
<label>39</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Li</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
<source>Bioinformatics</source>
<year>2018</year>
<volume>34</volume>
<fpage>3094</fpage>
<lpage>3100</lpage>
</element-citation>
</ref>
<ref id="R40">
<label>40</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Vaser</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Sović</surname>
<given-names>I</given-names>
</name>
<name>
<surname>Nagarajan</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Ŝikić</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
<source>Genome Res</source>
<year>2017</year>
<volume>27</volume>
<fpage>737</fpage>
<lpage>746</lpage>
</element-citation>
</ref>
<ref id="R41">
<label>41</label>
<element-citation publication-type="book">
<source>Medaka</source>
<year>2021</year>
<publisher-name>Oxford Nanopore Technologies</publisher-name>
</element-citation>
</ref>
<ref id="R42">
<label>42</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Huang</surname>
<given-names>YT</given-names>
</name>
<name>
<surname>Liu</surname>
<given-names>PY</given-names>
</name>
<name>
<surname>Shih</surname>
<given-names>PW</given-names>
</name>
</person-group>
<article-title>Homopolish: a method for the removal of systematic errors in nanopore sequencing by homologous polishing</article-title>
<source>Genome Biol</source>
<year>2021</year>
<volume>22</volume>
<fpage>95</fpage>
</element-citation>
</ref>
<ref id="R43">
<label>43</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Latorre-Pérez</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Villalba-Bermell</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Pascual</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Vilanova</surname>
<given-names>C</given-names>
</name>
</person-group>
<article-title>Assembly methods for nanopore-based metagenomic sequencing: a comparative study</article-title>
<source>Sci Rep</source>
<year>2020</year>
<volume>10</volume>
<elocation-id>13588</elocation-id>
</element-citation>
</ref>
<ref id="R44">
<label>44</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ondov</surname>
<given-names>BD</given-names>
</name>
<etal/>
</person-group>
<article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
<source>Genome Biol</source>
<year>2016</year>
<volume>17</volume>
<fpage>132</fpage>
</element-citation>
</ref>
<ref id="R45">
<label>45</label>
<element-citation publication-type="web">
<collab>What parameters best resmble blastn</collab>
<source>minimap2 GitHub</source>
<year>2017</year>
<comment>
<ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/minimap2/issues/54">https://github.com/lh3/minimap2/issues/54</ext-link>
</comment>
</element-citation>
</ref>
<ref id="R46">
<label>46</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Morgulis</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group>
<article-title>Database indexing for production MegaBLAST searches</article-title>
<source>Bioinformatics</source>
<year>2008</year>
<volume>24</volume>
<fpage>1757</fpage>
<lpage>1764</lpage>
</element-citation>
</ref>
<ref id="R47">
<label>47</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ciufo</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>
<article-title>Using average nucleotide identity to improve taxonomic assignments in prokaryotic genomes at the NCBI</article-title>
<source>Int J Syst Evol Microbiol</source>
<year>2018</year>
<volume>68</volume>
<fpage>2386</fpage>
<lpage>2392</lpage>
</element-citation>
</ref>
<ref id="R48">
<label>48</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kim</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Oh</surname>
<given-names>HS</given-names>
</name>
<name>
<surname>Park</surname>
<given-names>SC</given-names>
</name>
<name>
<surname>Chun</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Towards a taxonomic coherence between average nucleotide identity and 16S rRNA gene sequence similarity for species demarcation of prokaryotes</article-title>
<source>Int J Syst Evol Microbiol</source>
<volume>64</volume>
<fpage>346</fpage>
<lpage>351</lpage>
</element-citation>
</ref>
<ref id="R49">
<label>49</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Richter</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Rosselló-Móra</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Shifting the genomic gold standard for the prokaryotic species definition</article-title>
<source>Proc Natl Acad Sci</source>
<year>2009</year>
<volume>106</volume>
<fpage>19126</fpage>
<lpage>19131</lpage>
</element-citation>
</ref>
<ref id="R50">
<label>50</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Barco</surname>
<given-names>RA</given-names>
</name>
<etal/>
</person-group>
<article-title>A Genus Definition for Bacteria and Archaea Based on a Standard Genome Relatedness Index</article-title>
<source>mBio</source>
<volume>11</volume>
<fpage>e02475</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R51">
<label>51</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Federhen</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>
<article-title>Toward richer metadata for microbial sequences: replacing strain-level NCBI taxonomy taxids with BioProject, BioSample and Assembly records</article-title>
<source>Stand Genomic Sci</source>
<year>2014</year>
<volume>9</volume>
<fpage>1275</fpage>
</element-citation>
</ref>
<ref id="R52">
<label>52</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Goris</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>
<article-title>DNA–DNA hybridization values and their relationship to whole-genome sequence similarities</article-title>
<source>Int J Syst Evol Microbiol</source>
<volume>57</volume>
<fpage>81</fpage>
<lpage>91</lpage>
</element-citation>
</ref>
<ref id="R53">
<label>53</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Konstantinidis</surname>
<given-names>KT</given-names>
</name>
<name>
<surname>Tiedje</surname>
<given-names>JM</given-names>
</name>
</person-group>
<article-title>Genomic insights that advance the species definition for prokaryotes</article-title>
<source>Proc Natl Acad Sci</source>
<year>2005</year>
<volume>102</volume>
<fpage>2567</fpage>
<lpage>2572</lpage>
</element-citation>
</ref>
<ref id="R54">
<label>54</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Konstantinidis</surname>
<given-names>KT</given-names>
</name>
<name>
<surname>Ramette</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Tiedje</surname>
<given-names>JM</given-names>
</name>
</person-group>
<article-title>Toward a More Robust Assessment of Intraspecies Diversity, Using Fewer Genetic Markers</article-title>
<source>Appl Environ Microbiol</source>
<year>2006</year>
<volume>72</volume>
<fpage>7286</fpage>
<lpage>7293</lpage>
</element-citation>
</ref>
<ref id="R55">
<label>55</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Hanson</surname>
<given-names>NW</given-names>
</name>
<name>
<surname>Konwar</surname>
<given-names>KM</given-names>
</name>
<name>
<surname>Hallam</surname>
<given-names>SJ</given-names>
</name>
</person-group>
<article-title>LCA*: an entropy-based measure for taxonomic assignment within assembled metagenomes</article-title>
<source>Bioinformatics</source>
<year>2016</year>
<volume>32</volume>
<fpage>3535</fpage>
<lpage>3542</lpage>
</element-citation>
</ref>
<ref id="R56">
<label>56</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Robertson</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Bessonov</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Schonfeld</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Nash</surname>
<given-names>JHEY</given-names>
</name>
</person-group>
<article-title>Universal whole-sequence-based plasmid typing and its utility to prediction of host range and epidemiological surveillance</article-title>
<source>Microb Genomics</source>
<year>2020</year>
<volume>6</volume>
<elocation-id>e000435</elocation-id>
</element-citation>
</ref>
<ref id="R57">
<label>57</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schoch</surname>
<given-names>CL</given-names>
</name>
<etal/>
</person-group>
<article-title>NCBI Taxonomy: a comprehensive update on curation, resources and tools</article-title>
<source>Database</source>
<year>2020</year>
<volume>2020</volume>
</element-citation>
</ref>
<ref id="R58">
<label>58</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Carattoli</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Hasman</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>PlasmidFinder and In Silico pMLST: Identification and Typing of Plasmid Replicons in Whole-Genome Sequencing (WGS)</article-title>
<source>Methods Mol Biol Clifton NJ</source>
<year>2020</year>
<volume>2075</volume>
<fpage>285</fpage>
<lpage>294</lpage>
</element-citation>
</ref>
<ref id="R59">
<label>59</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bovee</surname>
<given-names>R</given-names>
</name>
</person-group>
<source>Taxonomy</source>
<comment>(One Codex)</comment>
</element-citation>
</ref>
<ref id="R60">
<label>60</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gauthier</surname>
<given-names>NPG</given-names>
</name>
<etal/>
</person-group>
<source>Nanopore Metagenomic Sequencing for Detection and Characterization of SARS-CoV-2 in Clinical Samples</source>
<year>2021</year>
<pub-id pub-id-type="doi">10.1101/2021.08.13.21261922</pub-id>
<elocation-id>2021.08.13.21261922</elocation-id>
</element-citation>
</ref>
<ref id="R61">
<label>61</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zankari</surname>
<given-names>E</given-names>
</name>
<etal/>
</person-group>
<article-title>PointFinder: a novel web tool for WGS-based detection of antimicrobial resistance associated with chromosomal point mutations in bacterial pathogens</article-title>
<source>J Antimicrob Chemother</source>
<year>2017</year>
<volume>72</volume>
<fpage>2764</fpage>
<lpage>2768</lpage>
</element-citation>
</ref>
<ref id="R62">
<label>62</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Arumugam</surname>
<given-names>K</given-names>
</name>
<etal/>
</person-group>
<article-title>Annotated bacterial chromosomes from frame-shift-corrected long-read metagenomic data</article-title>
<source>Microbiome</source>
<year>2019</year>
<volume>7</volume>
<fpage>61</fpage>
</element-citation>
</ref>
<ref id="R63">
<label>63</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Hackl</surname>
<given-names>T</given-names>
</name>
<etal/>
</person-group>
<source>proovframe: frameshift-correction for long-read (meta)genomics</source>
<year>2021</year>
<pub-id pub-id-type="doi">10.1101/2021.08.23.457338</pub-id>
<elocation-id>2021.08.23.457338</elocation-id>
</element-citation>
</ref>
</ref-list>
</back>
<floats-group>
<fig id="F1" position="float">
<label>Figure 1</label>
<caption>
<p>Performance of contig taxonomic classifiers across four datasets: Zymo Even, Zymo Log, Zymo Gut and CAMI High Complexity. Panels A-C: Average bin purity and recall across taxonomic ranks. Shaded bands show the standard error of the metrics. Panel D: BugSplit produces more complete bins with less contamination compared with alternative taxonomic binners.</p>
</caption>
<graphic xlink:href="EMS137109-f001"/>
</fig>
<fig id="F2" position="float">
<label>Figure 2</label>
<caption>
<p>Taxonomic profiling accuracy of five tools across three mock microbial communities sequenced with a long-read sequencer. Greater completeness and purity, and lower Bray-Curtis distance reflect better taxonomic profiling.</p>
</caption>
<graphic xlink:href="EMS137109-f002"/>
</fig>
<fig id="F3" position="float">
<label>Figure 3</label>
<caption>
<p>Overview of full BugSplit workflow (top), and example of contig classification algorithm (bottom). Alignments against the reference database are first collapsed up the taxonomic tree based on absolute nucleotide identity. A base-level vote is then performed across all bases of a contig, determining the final taxonomic assignment of the contig based on rank-specific majority thresholds.</p>
</caption>
<graphic xlink:href="EMS137109-f003"/>
</fig>
<table-wrap id="T1" orientation="portrait" position="float">
<label>Table 1</label>
<caption>
<p>Antimicrobial resistance prediction of BugSplit, applied to nanopore mNGS of urine, compared with Illumina sequencing, of <italic>Neisseria gonorrhoeae</italic> infections.</p>
</caption>
<table frame="box" rules="all">
<thead>
<tr>
<th valign="top" align="left"/>
<th valign="top" align="left" colspan="2" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">23S (Macrolides)</styled-content>
</th>
<th valign="top" align="left" colspan="2" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">gyrA (Quinolones)</styled-content>
</th>
<th valign="top" align="left" colspan="3" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">mtrR (Penicillins, Tetracyclines, Cephalosporins, Macrolides)</styled-content>
</th>
<th valign="top" align="left" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">pilQ (Macr olides)</styled-content>
</th>
<th valign="top" align="left" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">ponA (Penici llins)</styled-content>
</th>
<th valign="top" align="left" style="background-color: #0070C0">
<styled-content style="color:#FFFFFF">rpsJ (Tetra cyclines)</styled-content>
</th>
</tr>
<tr style="background-color: #8FAADB">
<th valign="top" align="left">
<styled-content style="color:#FFFFFF">Sample / Resistance Variant</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">c.2045 A&gt;G</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">c.2597 C&gt;T</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.S91F</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.D95 N/G</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.A39 T</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.G45 D</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">Deletio n</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.E666 K</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.L421 P</styled-content>
</th>
<th valign="top" align="center">
<styled-content style="color:#FFFFFF">p.V57 M/L/Q</styled-content>
</th>
</tr>
</thead>
<tbody>
<tr style="background-color: #E7E6E6">
<td valign="top" align="center">202</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">S</td>
<td valign="top" align="center">D</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">
<bold>deletion</bold>
</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">
<bold>P</bold>
</td>
<td valign="top" align="center">V</td>
</tr>
<tr>
<td valign="top" align="center">206</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">T</td>
<td valign="top" align="center">N/A</td>
<td valign="top" align="center">N/A</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">L</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr style="background-color: #E7E6E6">
<td valign="top" align="center">250</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">S</td>
<td valign="top" align="center">D</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">
<bold>deletion</bold>
</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">
<bold>P</bold>
</td>
<td valign="top" align="center">V</td>
</tr>
<tr>
<td valign="top" align="center">271</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">
<bold>T</bold>
</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">WT</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">L</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr style="background-color: #E7E6E6">
<td valign="top" align="center">294</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">
<bold>T</bold>
</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">WT</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">L</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr>
<td valign="top" align="center">301</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">
<bold>G</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">
<bold>deletion</bold>
</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">
<bold>P</bold>
</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr style="background-color: #E7E6E6">
<td valign="top" align="center">303</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">
<bold>T</bold>
</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">WT</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">L</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr>
<td valign="top" align="center">304</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">S</td>
<td valign="top" align="center">D</td>
<td valign="top" align="center">
<bold>T</bold>
</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">WT</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">L</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
<tr style="background-color: #E7E6E6">
<td valign="top" align="center">314</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">S</td>
<td valign="top" align="center">D</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">
<bold>deletion</bold>
</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">
<bold>P</bold>
</td>
<td valign="top" align="center">V</td>
</tr>
<tr>
<td valign="top" align="center">315</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">C</td>
<td valign="top" align="center">
<bold>F</bold>
</td>
<td valign="top" align="center">A</td>
<td valign="top" align="center">
<bold>T</bold>
</td>
<td valign="top" align="center">G</td>
<td valign="top" align="center">WT</td>
<td valign="top" align="center">E</td>
<td valign="top" align="center">
<bold>P</bold>
</td>
<td valign="top" align="center">
<bold>M</bold>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="TFN1">
<p id="P50">
<bold>Bold</bold> = variant detected by BugSplit, concordant with Illumina sequencing of <italic>N. gonorrhoeae</italic> isolates</p>
<p id="P51">
<styled-content style="color:#FF0000">Red</styled-content> = variant missed by BugSplit, compared with Illumina sequencing of <italic>N. gonorrhoeae</italic> isolates. The mtR gene was not assembled for the single missing variant within this region. N/A = variant position not recovered by BugSplit; no variant present</p>
</fn>
</table-wrap-foot>
</table-wrap>
</floats-group>
</article>
