<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS173644</article-id><article-id pub-id-type="doi">10.1101/2021.11.15.468285</article-id><article-id pub-id-type="archive">PPR422725</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">3</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title><monospace>insideOutside</monospace>: an accessible algorithm for classifying interior and exterior points, with applications in embryology</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Strawbridge</surname><given-names>Stanley E.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Kurowski</surname><given-names>Agata</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Corujo-Simon</surname><given-names>Elena</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Fletcher</surname><given-names>Alastair N.</given-names></name><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Nichols</surname><given-names>Jennifer</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Fletcher</surname><given-names>Alexander G.</given-names></name><xref ref-type="aff" rid="A7">7</xref><xref ref-type="aff" rid="A8">8</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><aff id="A1"><label>1</label>Wellcome-MRC Cambridge Stem Cell Institute, University of Cambridge, Cambridge, UK</aff><aff id="A2"><label>2</label>Department of Physiology, Neuroscience and Development, University of Cambridge, Cambridge, UK</aff><aff id="A3"><label>3</label>Department of Pharmacological Sciences, Icahn School of Medicine at Mount Sinai, New York, NY, USA</aff><aff id="A4"><label>4</label>MRC Human Genetics Unit, University of Edinburgh, Edinburgh, UK</aff><aff id="A5"><label>5</label>Department of Mathematical Sciences, Northern Illinois University, DeKalb, IL, USA</aff><aff id="A6"><label>6</label>Centre for Trophoblast Research, University of Cambridge, Cambridge, UK</aff><aff id="A7"><label>7</label>School of Mathematics and Statistics, University of Sheffield, Sheffield, UK</aff><aff id="A8"><label>8</label>The Bateson Centre, University of Sheffield, Sheffield, UK</aff></contrib-group><author-notes><corresp id="CR1"><label>*</label><email>ss2199@cam.ac.uk</email>, <email>jenny.nichols@ed.ac.uk</email>, <email>a.g.fletcher@sheffield.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>06</day><month>04</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>05</day><month>04</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">A crucial aspect of embryology is relating the position of individual cells to the broader geometry of the embryo. A classic example of this is the first cell-fate decision of the mouse embryo, where interior cells become inner cell mass and exterior cells become trophectoderm. Fluorescent labelling, imaging, and quantification of tissue-specific proteins have advanced our understanding of this dynamic process. However instances arise where these markers are either not available, or not reliable, and we are left only with the cells’ spatial locations. Therefore, a simple, robust method for classifying interior and exterior cells of an embryo using spatial information is required. Here, we describe a simple mathematical framework and an unsupervised machine learning approach, termed <monospace>insideOutside</monospace>, for classifying interior and exterior points of a three-dimensional point-cloud, a common output from imaged cells within the early mouse embryo. We benchmark our method against other published methods to demonstrate that it yields greater accuracy in classification of nuclei from the pre-implantation mouse embryos and greater accuracy when challenged with local surface concavities. We have made MATLAB and Python implementations of the method freely available. This method should prove useful for embryology, with broader applications to similar data arising in the life sciences.</p></abstract><kwd-group><kwd>Machine Learning</kwd><kwd>Quantitative Biology</kwd><kwd>Pre-implantation</kwd><kwd>Embryo</kwd><kwd>Inner Cell Mass</kwd><kwd>Trophectoderm</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><title>Introduction</title><p id="P2">The mouse embryo undergoes three major morphogenetic events between fertilization and implantation: compaction, cavitation, and hatching (<xref ref-type="fig" rid="F1">Fig. 1A,B</xref>) (<xref ref-type="bibr" rid="R45">Tarkowski and Wróblewska, 1967</xref>; <xref ref-type="bibr" rid="R41">Smith and McLaren, 1977</xref>; <xref ref-type="bibr" rid="R48">Yoshinaga et al., 1976</xref>). Compaction coincides with the first binary cell-fate decision, which is ultimately driven by cellular position within the embryo (<xref ref-type="fig" rid="F1">Fig. 1C</xref>) (<xref ref-type="bibr" rid="R45">Tarkowski and Wróblewska, 1967</xref>). Exterior cells polarize to become the extraembryonic trophectoderm (TE), precursors of the placenta (<xref ref-type="bibr" rid="R22">Lawson et al., 1999</xref>), while interior cells become the inner cell mass (ICM) (<xref ref-type="bibr" rid="R49">Ziomek and Johnson, 1980</xref>; <xref ref-type="bibr" rid="R20">Johnson and Ziomek, 1981</xref>). ICM cells then undergo a second binary cell-fate decision to become either the embryonic epiblast, source of the foetus (<xref ref-type="bibr" rid="R14">Gardner and Rossant, 1979</xref>) and embryonic stem cells (<xref ref-type="bibr" rid="R9">Evans and Kaufman, 1981</xref>; <xref ref-type="bibr" rid="R28">Martin, 1981</xref>), or the primitive endoderm (PrE), founder of the yolk sac (<xref ref-type="bibr" rid="R13">Gardner and Johnson, 1972</xref>). This second cell-fate decision coincides with cavitation, where a fluid-filled cavity, called the blastocoel, forms between the TE and one side of the ICM (<xref ref-type="bibr" rid="R41">Smith and McLaren, 1977</xref>). Finally, prior to implantation, the embryo must hatch from the zona pellucida (<xref ref-type="bibr" rid="R27">Malter and Cohen, 1989</xref>).</p><p id="P3">Molecular profiling of these tissues through RNA sequencing (<xref ref-type="bibr" rid="R17">Guo et al., 2010</xref>, <xref ref-type="bibr" rid="R16">2017</xref>) and immunohistochemistry (<xref ref-type="bibr" rid="R6">Chazaud et al., 2006</xref>; <xref ref-type="bibr" rid="R33">Niwa et al., 2005</xref>; <xref ref-type="bibr" rid="R35">Palmieri et al., 1994</xref>) has revealed key lineage markers such as NANOG and GATA6. These lineage markers have been used to study the dynamic emergence and plasticity of distinct cell identities during pre-implantation development by employing fluorescent reporter knock-ins (<xref ref-type="bibr" rid="R1">Arnold et al., 2011</xref>; <xref ref-type="bibr" rid="R15">Grabarek et al., 2012</xref>; <xref ref-type="bibr" rid="R19">Hamilton et al., 2003</xref>; <xref ref-type="bibr" rid="R21">Kalkan et al., 2017</xref>; <xref ref-type="bibr" rid="R30">McDole and Zheng, 2012</xref>). However, in the mouse there remain instances where reliable lineage markers do not exist (<xref ref-type="bibr" rid="R36">Plusa et al., 2008</xref>) or cease to faithfully mark their lineage (<xref ref-type="bibr" rid="R23">Le Bin et al., 2014</xref>; <xref ref-type="bibr" rid="R40">Schrode et al., 2014</xref>; <xref ref-type="bibr" rid="R3">Bessonnard et al., 2014</xref>), while in other mammals such as humans and non-human primates, such lineage markers are not yet established (<xref ref-type="bibr" rid="R5">Boroviak et al., 2018</xref>; <xref ref-type="bibr" rid="R18">Guo et al., 2021</xref>; <xref ref-type="bibr" rid="R44">Stirparo et al., 2018</xref>). In such cases, we must find alternative methods to classify the tissues under investigation.</p><p id="P4">For decades, spatial information has been used to help classify cell populations in the pre-implantation mouse embryo (<xref ref-type="bibr" rid="R11">Fleming, 1987</xref>; <xref ref-type="bibr" rid="R32">Nichols and Gardner, 1984</xref>). Recent advances in image acquisition and processing technologies have improved the accuracy of this spatial information. A common analysis method is quantitative immunofluorescence (qIF) of cell nuclei, whereby three-dimensional (3D) confocal fluorescence microscopy images of nuclei are segmented and quantified using software such as Fiji (<xref ref-type="bibr" rid="R39">Schindelin et al., 2012</xref>), MINS (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), or Nessys (<xref ref-type="bibr" rid="R4">Blin et al., 2019</xref>). Output parameters from qIF include total nuclear fluorescence, nuclear volume, and the geometric centre (centroid) of the nucleus. The centroid point-cloud can then be used to classify individual nuclei by their relative positions. Classification of interior and exterior nuclei is of particular interest when investigating the relationship between the cells of the ICM (interior) and the TE (exterior).</p><p id="P5">To date, three methods have been used to classify interior and exterior nuclei of the mouse embryo from qIF. We refer to these as the random sample consensus (RANSAC) Ellipsoidal, Convex Hull, and <monospace>insideOutside</monospace> methods. The RANSAC Ellipsoidal method, employed by MINS (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), robustly fits an ellipsoid to the point-cloud generated by segmented nuclear centroids through the RANSAC iterative method (<xref ref-type="bibr" rid="R10">Fischler and Bolles, 1981</xref>). Each nucleus is then classified as exterior if the distance from the ellipsoid’s centre to the nuclear centroid exceeds 0.95 times the distance from the ellipsoid’s centre to the point on the ellipsoid that is closest to the nucleus’s centroid; otherwise, the cell is classified as interior. MINS has been widely used for qIF and has been cited in nearly 100 manuscripts. The Convex Hull method, employed by the spatial analysis software IVEN (<xref ref-type="bibr" rid="R12">Forsyth et al., 2021</xref>), constructs a convex hull, the smallest convex set that contains all centroids, from all nuclear centroids of the embryo and then classifies a nucleus as exterior if it belongs to the boundary of the convex hull. IVEN allows for manual correction of the classification, but this requires user input which may introduce bias. The <monospace>insideOutside</monospace> method, a preliminary version of which was employed by <xref ref-type="bibr" rid="R43">Stirparo et al. (2021)</xref>, is an accessible position-based approach to the classification of interior and exterior nuclei.</p><p id="P6">A fourth method, which we refer to as the Naïve Ellipsoidal method, was introduced by <xref ref-type="bibr" rid="R12">Forsyth et al. (2021)</xref> for their benchmarking. This approach accepts the first fit of an ellipsoid to the point-cloud, as opposed to generating a consensus ellipsoid through iterative random sampling, as in the RANSAC approach. The same distance rule as the RANSAC Ellipsoidal method is then applied to classify cell positions.</p><p id="P7">These four methods share the common assumption that the embryo is convex. A shape is said to be convex if the line segment between any pair of points within the shape is entirely contained within the shape (<xref ref-type="fig" rid="F1">Fig. 1D</xref>); otherwise the shape is said to be concave (<xref ref-type="fig" rid="F1">Fig. 1E</xref>). The RANSAC Ellipsoidal method models the embryo as an ellipsoid, which is a convex shape. Similarly, the Convex Hull method explicitly defines the exterior points as being a member of a convex shape. Therefore, these methods underperform if the surface of the embryo exhibits small local concavities or if the embryo incurs indentations through fixation and mounting. The <monospace>insideOutside</monospace> method softens the assumption of convexity by classifying points using a two-dimensional parameter space instead of requiring strict membership of a convex shape.</p><p id="P8">It has become increasingly important for developmental biologists to perform rigorous quantification of their data. Thus it is necessary to develop easy-to-deploy software that does not require high levels of programming expertise. Furthermore, benchmarking of the three mentioned classification methods has yet to be performed. Therefore, here we present the accessible <monospace>insideOutside</monospace> algorithm for the classification of interior and exterior points of embryo-like shapes. We detail the mathematics underpinning the two-dimensional parameter space used for unsupervised classification, along with accuracy testing. We then benchmark current classification methods using simulated and empirical data from pre-implantation mouse blastocysts, showing that the Convex Hull and <monospace>insideOutside</monospace> methods outperform the Ellipsoidal methods. We conclude by demonstrating that the <monospace>insideOutside</monospace> method outperforms the Convex Hull method when challenged with local surface concavities, as can be found in empirical data sets.</p></sec><sec id="S2" sec-type="results"><title>Results</title><sec id="S3"><title>The minimum distance and variance in distances from a point to the surface of a convex shape are inversely related</title><p id="P9">Here we will establish the minimum distance, and variance in distances, to the surface of a convex shape as parameters underlying the <monospace>insideOutside</monospace> algorithm. An intuitive understanding for this choice of parameters follows by considering their relationship for points at the centre, and on the surface, of a sphere.</p><p id="P10">We first consider these parameters for a point at the centre of a sphere (<xref ref-type="fig" rid="F2">Fig. 2A</xref>). The minimum distance to the sphere is exactly the radius of the sphere. In fact, the distance from the centre to all other points of the sphere is identically the radius, meaning that the variance in distance to the surface of the sphere is exactly zero. Thus, minimum distance to the surface is maximized and the variance in distances is minimized for the point at the centre of a sphere.</p><p id="P11">On the other hand, consider an arbitrary point on the surface of that same sphere (<xref ref-type="fig" rid="F2">Fig. 2B</xref>). For that surface point, the minimum distance to the surface of the sphere is exactly zero. If we then draw line segments from that point to all other points on the surface of the sphere, we see that we are drawing line segments of every length between zero and the diameter of the sphere, meaning that the original point on the surface of the sphere achieves the most diversity of line segment lengths possible for the sphere. In other words, as we will see below, a point on the surface of the sphere has the maximum variance in distances to the surface. Thus, minimum distance to the surface is minimized and the variance in distances to the surface has been maximized for any point on the surface of a sphere. We therefore arrive at an inverse relationship between the minimum distance and the variance in distances to the surface of a sphere as we move from the centre of the sphere to the surface of the sphere.</p><p id="P12">We now formalize this relationship. First, we derive the expression for the minimum distance from any point on/inside the sphere of radius <italic>r</italic>, centred at the origin, to the sphere. Intuitively, a point <italic>P</italic> on/inside the sphere, its closest point on the sphere, and the origin all lie on a straight line (<xref ref-type="fig" rid="F2">Fig. 2C</xref>, top). Hence, if <italic>P</italic> is located a distance <italic>x</italic> ∈ [0, <italic>r</italic>] from the origin, then since the distance from any point on the sphere to the origin is <italic>r</italic>, the minimum distance from <italic>P</italic> to the sphere is given by <italic>m</italic> = <italic>r</italic> – <italic>x</italic>.</p><p id="P13">Next, we derive the expression for the variance in distances from a given point on/inside the sphere to the sphere. Let <italic>P</italic> be located at distance <italic>x</italic> ∈ [0, <italic>r</italic>] from the origin, and without loss of generality let <italic>P</italic> lie on the <italic>z</italic>-axis. Consider a point <italic>Q</italic> on the sphere, whose angle to the <italic>z</italic>-axis is given by <italic>ϕ</italic> (<xref ref-type="fig" rid="F2">Fig. 2C</xref>, bottom). Since the distance from <italic>Q</italic> to the origin is <italic>r</italic>, by the law of cosines the distance from <italic>P</italic> to <italic>Q</italic> is given by <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mn>)</mml:mn><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>x</mml:mi><mml:mspace width="0.2em"/><mml:mtext>cos</mml:mtext><mml:mspace width="0.2em"/><mml:mi>ϕ</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. Computing surface integrals, the variance in distances from <italic>P</italic> to the sphere is thus given by <disp-formula id="FD1"><label>(1)</label><mml:math id="M2"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>𝔼</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>]</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mi>𝔼</mml:mi><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mn>]</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P14">Substituting <italic>x</italic> = <italic>r</italic> – <italic>m</italic> into <xref ref-type="disp-formula" rid="FD1">equation (1)</xref>, and differentiating with respect to <italic>m</italic>, we obtain <disp-formula id="FD2"><label>(2)</label><mml:math id="M3"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mn>9</mml:mn><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mn>)</mml:mn><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>)</mml:mn><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P15">Since <italic>m</italic> – <italic>r</italic> ≤ 0 and 2<italic>m</italic><sup>2</sup> – 4<italic>mr</italic> – <italic>r</italic><sup>2</sup> &lt; 0 for <italic>m</italic> ∈ [0, <italic>r</italic>], we have <italic>dv/dm</italic> ≤ 0 for <italic>m</italic> ∈ [0, <italic>r</italic>], hence <italic>v</italic> is a decreasing function of <italic>m</italic> for <italic>m</italic> ∈ [0, <italic>r</italic>]. Thus, for points on/inside the sphere, the variance in distances is inversely related to the minimum distance to the sphere. This relationship is plotted in <xref ref-type="fig" rid="F2">Fig. 2E</xref>.</p><p id="P16">The above calculations prove that the minimum distance and variance in distances to the surface are inversely related for a sphere. As an aside, we note that this relationship does not hold absolutely for arbitrary compact, convex three-dimensional shapes. Indeed, it is possible to construct examples where the centre of mass does not maximize the minimum distance to the surface, and it is this feature that hinders the inverse relationship between the minimum distance and variance in distances to the surface. Nevertheless, given a compact, convex surface which satisfies a mild roundness condition, there is a compact subset of its interior for which that the minimum distance to the boundary and the variance are inversely related. This means that the desired property holds once we are close enough to the surface, and the closer the surface resembles a sphere, the stronger the inverse relationship between the minimum distance and variance in distances to it. While a more detailed mathematical study lies outside the scope of the present study, we note that this relationship does not hold absolutely for arbitrary compact, convex three-dimensional shapes.</p><p id="P17">We conclude this section by providing numerical simulations indicating that this property remains true for piecewise linear approximations of the sphere. For this we simulate 100 points on the surface of a sphere that are spaced either equidistant (<xref ref-type="fig" rid="F2">Fig. 2D</xref>) or uniformly at random (1000 realizations) (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>) (<xref ref-type="bibr" rid="R8">Deserno, 2004</xref>). For each discrete surface, the minimum distance and variance in distances to the surface points are calculated for 50 test points equally spaced between the centre of the sphere and a surface point. Both sets of simulations closely match the analytical solution (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). While this has been demonstrated for the case of the sphere and discretized derivatives of the sphere, it provides a theoretical foundation for the use of <italic>m</italic> and <italic>v</italic> in the classification of convex point-clouds. Importantly, the demonstration using discretized surfaces indicates that this relation is directly applicable to empirical data which consist of discrete points, e.g. the centroids of nuclei within an embryo.</p></sec><sec id="S4"><title><monospace>insideOutside</monospace>: a two-dimensional decision space for classifying interior and exterior positions</title><p id="P18">Motivated by the theoretical result of the previous section, we proceed to describe an algorithm for the classification of interior and exterior points of a 3D point-cloud. The <monospace>insideOutside</monospace> algorithm (<xref ref-type="boxed-text" rid="BX1">Algorithm 1</xref>) takes in a set of 3D Cartesian coordinates, <italic>S</italic> ∈ ℝ<sup><italic>n</italic>×3</sup> (<xref ref-type="fig" rid="F3">Fig. 3Ai</xref>), and returns indexing vector <italic>I</italic> ∈ 𝔹<sup><italic>n</italic></sup> with 0 indexing the inside points and 1 indexing the outside points. For pre-implantation embryos, the input data can be generated through manual nuclear segmentation in Fiji (<xref ref-type="bibr" rid="R39">Schindelin et al., 2012</xref>) or MATLAB’s <monospace>volumeSegmenter</monospace> App (Copyright 2020 The MathWorks, Inc) or through automated 3D nuclear segmentation pipelines like MINS (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), Nessys (<xref ref-type="bibr" rid="R4">Blin et al., 2019</xref>), or StarDist (<xref ref-type="bibr" rid="R46">Weigert et al., 2020</xref>). The algorithm begins by computing the Delaunay triangulation, 𝒟, over <italic>S</italic> (<xref ref-type="fig" rid="F3">Fig. 3Aii</xref>). From 𝒟, we generate a convex hull ℋ (<xref ref-type="bibr" rid="R2">Barber et al., 1996</xref>) (<xref ref-type="fig" rid="F3">Fig. 3Aiii</xref>). Now, using ℋ we can calculate the distance function, <italic>d</italic>(<italic>P</italic>, ℋ), ∀<italic>P</italic> ∈ <italic>S</italic> (<xref ref-type="fig" rid="F3">Fig. 3Aiv</xref>). We calculate the minimum and variance in <italic>d</italic>(<italic>P</italic>, ℋ), ∀<italic>P</italic> ∈ <italic>S</italic>, and then scale each parameter such that the maximum is 1 and the minimum is 0 (<xref ref-type="fig" rid="F3">Fig. 3Av</xref>). Note that we choose to calculate distances to all surfaces of the convex hull, not just all points generating it, to maximise accuracy and robustness of our method. Finally, hierarchical clustering by ward linkage is performed on the parameters to classify the points into two groups (<xref ref-type="fig" rid="F3">Fig. 3Avi,vii</xref>).</p><p id="P19">The accuracy of the <monospace><monospace>insideOutside</monospace></monospace> method classification was performed on test shapes designed to resemble the late mouse blastocyst, whose cell number ranges between 100-150 (<xref ref-type="bibr" rid="R36">Plusa et al., 2008</xref>), where approximately 60-70% of the cells belong to the TE (outside cells) (<xref ref-type="bibr" rid="R11">Fleming, 1987</xref>; <xref ref-type="bibr" rid="R38">Saiz et al., 2016</xref>, <xref ref-type="bibr" rid="R37">2020</xref>; <xref ref-type="bibr" rid="R31">Morgani et al., 2018</xref>). Therefore we constructed shapes with 100 uniform random points on the unit sphere (outside) and 50 uniform random points within balls of radii between 0.01 and 1 (inside), both centred at the origin (<xref ref-type="fig" rid="F3">Fig. 3B</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>). 1000 embryos were simulated and classified for each of 100 inner ball radii.</p><boxed-text id="BX1" position="anchor" content-type="below"><caption><title>Algorithm 1: <monospace>insideOutside</monospace> takes in an <italic>n</italic> × 3 matrix of Cartesian points and returns a bit vector that classifies each point as either inside, 0, or outside, 1</title></caption><p id="P20">  <bold>Data:</bold> Set of points <italic>S</italic> ∈ ℝ<sup><italic>n</italic>×3</sup></p><p id="P21">  <bold>Result:</bold> Classification vector <italic>I</italic> ∈ 𝔹<sup><italic>n</italic></sup></p><p id="P22">  Delaunay triangulation 𝒟 over <italic>S</italic></p><p id="P23">  Generate convex hull ℋ from 𝒟</p><p id="P24">  <bold>for</bold> <italic>each point P</italic> ∈ <italic>S</italic> <bold>do</bold></p><p id="P25">         <bold>for</bold> <italic>each face f</italic> ∈ ℋ <bold>do</bold></p><p id="P26">                  Calculate min <italic>d</italic>(<italic>P, f</italic> )</p><p id="P27">         <bold>end</bold></p><p id="P28">         Calculate <italic>m</italic> = min <italic>d</italic>(<italic>P, ℋ</italic>)</p><p id="P29">         Calculate <italic>v</italic> = Var(<italic>d</italic>(<italic>P, ℋ</italic>))</p><p id="P30">  <bold>end</bold></p><p id="P31">  Perform unsupervised classification for two groups</p></boxed-text><p id="P32">Initial tests revealed near-perfect classification rates for True Outside points at all inner ball radii (<xref ref-type="supplementary-material" rid="SD1">Fig. S2E</xref>). There was, however, a significant drop in the True Inside classification rate at an inner ball radius of 0.82 where the True Inside classification rate dropped below 0.99 with minimum rate of 0.48 ± 0.17 (mean ± standard deviation) at an inner ball radius of 1. To improve the True Inside classification rate, we modified the parameter space by taking the log of <italic>m</italic>, which results in a greater separation of inside and outside points along the minimum distance axis (<xref ref-type="supplementary-material" rid="SD1">Fig. S2F</xref>). Simulations bear out marked improvements in True Inside classification rates with no detriment to True Outside classification rates. The resulting True Inside classification rates do not drop below 0.99 until an inner ball radius of 0.94 and achieve a minimum of only 0.82 ±0.09 at an inner ball radius of 1.</p><p id="P33">We extended this analysis to explore the effects on True Inside classification rate by adding different values of a small parameter, <italic>ε</italic>, to the minimum distance to the surface (<xref ref-type="fig" rid="F3">Fig. 3C</xref>). We observe very high True Inside classification rates (&gt;0.95) for the vast majority of inner ball radii. For all values of <italic>ε</italic> assessed, a decrease in True Inside classification rate is only observed for inner ball radii near one. Indeed, we see that the worst case True Inside classification rates for each <italic>ε</italic> are obtained for inner ball radii at, or very near, one (<xref ref-type="fig" rid="F3">Fig. 3D</xref>). While these worst case True Inside classification rates range between 0.67 and 0.87, each <italic>ε</italic> outperforms the raw minimum distance of 0.48. We therefore conclude that so long as <italic>ε </italic> is sufficiently small, the exact value has little impact on the classification rates. Thus we have established our algorithm using the parameters of [log<sub>10</sub>(<italic>m</italic> + <italic>ε</italic>), <italic>v</italic>], for <italic>ε</italic> = 0.01, and we now proceed to challenge this method with empirical data.</p></sec><sec id="S5"><title><monospace><monospace>insideOutside</monospace></monospace> and Convex Hull methods outperform the Ellipsoidal methods when classifying cells of the mouse blastocyst</title><p id="P34">In this section we set out to show that the <monospace>insideOutside</monospace> method can successfully classify the nuclei of real-world samples by using previously quantified mid-blastocysts mouse embryos (<xref ref-type="bibr" rid="R43">Stirparo et al., 2021</xref>) (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). We initially assess different unsupervised clustering mehtods which can be used in <monospace>insideOutside</monospace> and how well the minimum distance and variance of distances to the surface relationship is able to classify empirical data. Next we assess how well the individual parameters, minimum distance and the variance of distances to the surface, are able to classify these data. We finally benchmark our method against the three other methods (Naïve Ellipsoidal, RANSAC Ellipsoidal (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), and Convex Hull (<xref ref-type="bibr" rid="R12">Forsyth et al., 2021</xref>)) with these same embryos. SOX2 staining, which can be used to mark all nuclei of the early ICM (<xref ref-type="bibr" rid="R47">Wicklow et al., 2014</xref>), was used as the ground truth, where SOX2 positive nuclei indicate inside nuclei and SOX2 negative nuclei indicate outside nuclei. SOX2 positive/negative status was determined through statistical inference (Gaussian mixture modelling) with 758 cells from 14 embryos (<xref ref-type="fig" rid="F4">Fig. 4B,C</xref>). We then used the SOX2 ground truth (<xref ref-type="fig" rid="F4">Fig. 4D</xref>) to calculate the True Inside and True Outside rates for the four classification methods(<xref ref-type="fig" rid="F4">Fig. 4E</xref>).</p><p id="P35">First, we assessed different unsupervised clustering methods on classification rates (<xref ref-type="supplementary-material" rid="SD1">Fig. S3A</xref>). The methods we assessed were K-means clustering, hierarchical clustering, spectral clustering, and DBSCAN. No difference was observed in either the True Inside classification rate (means ranging between 0.91 and 0.93, p-values &gt; 0.05, Kruskal-Wallis) or the True Outside classification rate (p-values &gt; 0.05, Kruskal-Wallis). However, the spectral clustering method exhibited a larger variance than the other three methods and a lower mean rate of 0.79, while the mean rates for the other three methods ranged between 0.89 and 0.90. We therefore propose that any of K-means clustering, hierarchical clustering, or dbscan are sufficient for unsupervised clustering. However, because DBSCAN requires additional user defined parameters, we would only suggest K-means clustering or hierarchical clustering. Finally, we select hierarchical clustering for <monospace>insideOutside</monospace> as the preferred method as it tends to better classify highly eccentric distributions, such as the ones generated from these data (<xref ref-type="supplementary-material" rid="SD1">Fig. S2C</xref>).</p><p id="P36">Next, we see from simulations that there is a roughly linear relationship between the minimum distance to the surface, <italic>m</italic>, and variance of distances to the surface, <italic>v</italic>, for points away from the surface and centre of a sphere (<xref ref-type="fig" rid="F2">Fig. 2E</xref>). Therefore, we wanted to determine if one of the parameters was sufficient for classification of empirical data, or if it is the case that both parameters are needed to improve classification in the nonlinear regions that are towards the surface and centre of embryos. To that end, we examined the ability to classify nuclei using only a univariate parameter space of either log<sub>10</sub>(<italic>m</italic> + 0.01) or <italic>v</italic> against the bivariate parameter space of [log<sub>10</sub>(<italic>m</italic> + 0.01), <italic>v</italic>] (<xref ref-type="supplementary-material" rid="SD1">Fig. S3B</xref>). We see that <italic>v</italic> alone is a relatively poor classifier for both inside nuclei (rate = 0.69 ± 0.21, mean ± standard deviation; N = 14 embryos) and outside nuclei (rate = 0.65 ± 0.15). Whereas log10(<italic>m</italic> + 0.01) and [log10(<italic>m</italic> + 0.01), <italic>v</italic>] correctly classified nuclei with identical rates (rate = 0.91 ± 0.06) above that of <italic>v</italic> alone (p-value of 0.0027, Kruskal-Wallis). Again log<sub>10</sub>(<italic>m</italic> + 0.01) (rate = 0.895 ± 0.092; p-value of 0.004) and [log<sub>10</sub>(<italic>m</italic>+0.01), <italic>v</italic>] (rate = 0.904 ± 0.086; p-value of 0.002) yielded better rates for outside nuclei classification rates compared with <italic>v</italic>. Although, outside classification rates for log<sub>10</sub>(<italic>m</italic> + 0.01) and [log<sub>10</sub>(<italic>m</italic> + 0.01), <italic>v</italic>] were not significantly difference (p-value of 0.98), [log<sub>10</sub>(<italic>m</italic> + 0.01), <italic>v</italic>] outperformed log<sub>10</sub>(<italic>m</italic> + 0.01) for 3 out of 14 embryos. This leads us to conclude that the bivariate parameter space does indeed provide an advantage in classifying outside nuclei in some instances.</p><p id="P37">With <monospace>insideOutside</monospace> in hand, we now benchmark our method against the three other methods. For inside nuclei classification (<xref ref-type="fig" rid="F4">Fig. 4F</xref>,left), we find that both the Convex Hull (rate = 0.92 ± 0.06, mean ± standard deviation; N = 14 embryos) and <monospace>insideOutside</monospace> (rate = 0.91 ± 0.06) methods outperform the Naïve Ellipsoidal method (rate = 0.59 ± 0.29; p-values of 6.8 × 10<sup>–4</sup> and 1.0 × 10<sup>–3</sup>, respectively, Kruskal-Wallis) and RANSAC Ellipsoidal method (rate = 0.62 ± 0.12; p-values of 8.1 × 10<sup>–5</sup> and 1.3 × 10<sup>–4</sup>, respectively). The Naïve and RANSAC Ellipsoidal methods show no difference in ability to classify inside nuclei (p-value = 0.96). Similarly, the Convex Hull and <monospace>insideOutside</monospace> methods show no difference in ability to classify inside nuclei (p-value = 0.99, Kruskal-Wallis). These rates are summarized in the table in <xref ref-type="supplementary-material" rid="SD1">Fig. S3C</xref>.</p><p id="P38">For outside nuclei classification (<xref ref-type="fig" rid="F4">Fig. 4F</xref>,right), we see that the Naïve Ellipsoidal method (rate = 0.73 ± 0.13) underperforms compared to the RANSAC Ellipsoidal method (rate = 0.95 ± 0.06, p-value = 4.9 × 10 <sup>–4</sup>), Convex Hull method (rate = 0.89 ± 0.09, p-value = 0.031), and <monospace>insideOutside</monospace> method (rate = 0.90 ± 0.08, p-value = 0.019). However, no difference is seen between the RANSAC Ellipsoidal, Convex Hull, and <monospace>insideOutside</monospace> methods (all pair-wise p-values ≥ 0.63). Thus, the Naïve Ellipsoidal method shows the lowest rates of classification for the both inside and outside points. While the RANSAC Ellipsoidal method only under-performs in classifying interior points. These data together show that ellipsoid fitting has the least satisfactory classification accuracy.</p></sec><sec id="S6"><title><monospace><monospace>insideOutside</monospace></monospace> outperforms the Convex Hull method in classification of outside points</title><p id="P39">While both the <monospace>insideOutside</monospace> and Convex Hull methods perform comparably on the empirical blastocysts, the Convex Hull method holds a systematic error of misclassifying outside points as inside points when there are minor concavities at the surface. We highlight this feature in two head-to-head comparisons of the <monospace>insideOutside</monospace> and Convex Hull methods. First we simulate segmentation/imaging errors by leave-K-out sub-sampling of the empirical embryos. Then we conclude with the introduction of small local surface concavities to simulated test shapes.</p><p id="P40">We begin by simulating segmentation/imaging errors by k-fold cross validation sub-sampling of the empirical embryos for k values between 1 and 15. This reveals that the Convex Hull method outperforms <monospace>insideOutside</monospace> in classifying inside points in 16.44% of of sub-sampled embryos (<xref ref-type="supplementary-material" rid="SD1">Fig. S3D</xref>). When considering outside classification, <monospace>insideOutside</monospace> performs better in 12.98% of sub-sampled embryos while the Convex Hull method performs better in 0.06% of sub-sampled embryos (<xref ref-type="supplementary-material" rid="SD1">Fig. S3E</xref>). We then asked how sensitive these methods are to perturbations relative to the non-subsampled embryos. We found a decrease in inside classification rates relative to the non-subsampled classfication for both Convex Hull method (39.86% of samples) and <monospace>insideOutside</monospace> (40.71% of samples) (<xref ref-type="supplementary-material" rid="SD1">Fig. S3F</xref>). Conversely, the an increase in outside classification rates relative to the non-subsampled embryos was exhibited for both Convex Hull method (31.37% of samples) and <monospace>insideOutside</monospace> (27.70% of samples) (<xref ref-type="supplementary-material" rid="SD1">Fig. S3G</xref>).</p><p id="P41">We now show the systematic nature of this misclassification by emulating increasing levels of local surface concavities via the introduction of increasing levels of normally distributed random noise to the surface points of the test shapes (<xref ref-type="fig" rid="F4">Fig. 4G</xref>). We then compute the classification rates over the parameter space of inner ball radius (100 radii between 0.01 and 1) and noise factor (100 levels between 0 and 0.25) for 100 shapes (<xref ref-type="fig" rid="F4">Fig. 4H</xref> and <xref ref-type="supplementary-material" rid="SD1">Fig. S4A</xref>). The Convex Hull method shows a uniform decrease of True Outside classification rates across all inner ball radii for increasing levels of noise, eventually dropping below a rate of 0.4 around a noise factor greater than 0.2. The <monospace>insideOutside</monospace> method does not display this uniform decrease of True Outside classification rates, instead maintaining a rate of greater than 0.9 for the majority of the parameter sets tested. The <monospace>insideOutside</monospace> method only begins to lose accuracy when both the inner ball radius and noise factor become large. Surface concavities have negligible effects on the classification rates of inside points for both methods (<xref ref-type="supplementary-material" rid="SD1">Fig. S4B,C</xref>).</p></sec></sec><sec id="S7" sec-type="discussion"><title>Discussion</title><p id="P42">Motivated by the need to accurately classify cells of mouse embryos based on their spatial position alone, we present <monospace>insideOutside</monospace>, an accessible algorithm for the classification of interior and exterior points of a three-dimensional point-cloud. We established an inverse relationship between the minimum distance and variance in distances from a point to a ‘typical’ convex shape’s surface. We then harnessed this inverse relationship to build an algorithm which allows for faithful classification of interior and exterior points by hierarchical clustering. We then proceeded to benchmark our method against three other methods, Naïve Ellipsoidal, RANSAC Ellipsoidal (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>) and Convex Hull (<xref ref-type="bibr" rid="R12">Forsyth et al., 2021</xref>), finding that the <monospace>insideOutside</monospace> method was as reliable, or better, at classifying nuclei of the pre-implantation mouse embryo. We demonstrated that the <monospace>insideOutside</monospace> method has greater accuracy than the Convex Hull method in classifying exterior points when challenged with both segmentation/imaging errors and local surface concavities. Finally, we have packaged the algorithm as freely available stand-alone MATLAB and Python implementations.</p><p id="P43">We have shown that the Convex Hull and <monospace>insideOutside</monospace> methods both outperform the Naïve and RANSAC Ellipsoidal methods in the classification of interior nuclei of pre-implantation mouse embryos, while the Naïve Ellipsoidal method underperforms the other three methods when classifying exterior nuclei. In all four methods we find that instances of misclassification are highest where the ICM is in contact with the TE (<xref ref-type="fig" rid="F4">Fig. 4E</xref>). This shows that ellipsoid fitting methods (Naïve and RANSAC) are not as suitable in classifying interior and exterior points as convex hull based methods (Convex Hull and <monospace>insideOutside</monospace>).</p><p id="P44">Moreover, we have shown through simulation that the <monospace>insideOutside</monospace> method is more accurate than the other methods when challenged with surface concavities. This is particularly important for classifying model systems whose exterior points exhibit high levels of noise. Such noise can be biological in nature, e.g. due to variability in nuclear height along the apicobasal axis of columnar epithelia; or technical, e.g. due to segmentation errors.</p><p id="P45">These findings speak to the appropriateness of each method. There may be instances when the user has a large number of points in a low noise situation where exterior points should be strictly classified as belonging to the surface. In such cases the Convex Hull method is most appropriate. Alternatively, the user may want to soften this condition in the case of a small number of points in a high noise situation, e.g. the pre-implantation mouse embryo. Here, the <monospace>insideOutside</monospace> method would be most useful, as it performs the best in such high noise situations. While the Ellipsoidal method has proved useful in identifying unique embryos from images with many embryos (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), we would not recommend the Ellipsoidal method for classifying the nuclei of those embryos. Finally, we note that all of the classification methods considered in the present study take on the order of 10<sup>–4</sup> to 10<sup>–3</sup> s to implement for a typical mouse embryo. As such, relative computational cost is unlikely to be a factor unless analysing unrealistically large numbers of embryos.</p><p id="P46">There is scope for further refinement of the <monospace>insideOutside</monospace> algorithm. This could come by way of incorporating more information about the segmented nuclei, e.g. making use of nuclear aspect ratio and not just nuclear centroid. Additional parameters could also be introduced to the parameter decision space. IVEN has made use of number-of-neighbours, calculated from the Delaunay triangulation, in downstream spatial analysis. The addition of number-of-neighbours to the classification space may aid in better discrimination of interior and exterior points, especially in the problem case where the ICM meets the TE. More generally, extensions to our algorithm could leverage alternative approaches to improve robustness of classification, such as those based on deep learning (<xref ref-type="bibr" rid="R34">Ounkomol et al., 2018</xref>; <xref ref-type="bibr" rid="R7">Christiansen et al., 2018</xref>).</p><p id="P47">We have sought to make this method, and future methods, easy-to-deploy for biological and life scientists, as there is increasing need for them to perform rigorous quantification of their data. Development of the <monospace>insideOutside</monospace> method in <xref ref-type="bibr" rid="R43">Stirparo et al. (2021)</xref> was born of a need to refine the original MINS classification method and was driven by collaboration between experimentalists and theoreticians. While there is no expectation for experimentalists to do methods development, there is expectation that they should be able to use these methods, thus empowering future work. Both MINS and IVEN share this ethos of empowering experimentalists in the journey of data analysis. However, the <monospace>insideOutside</monospace> method is provided as a stand-alone script, whereas the classification methods in MINS and IVEN are members of a larger software package. This means that the <monospace>insideOutside</monospace> method has greater flexibility in use and migration to other programming languages. Critically, the stand-alone nature of the <monospace>insideOutside</monospace> method lends itself to incorporation into other software pipelines. For example, the <monospace>insideOutside</monospace> method could be incorporated as an additional classification method into either MINS or IVEN, as both packages have MATLAB implementations.</p><p id="P48">Finally, other use cases for the <monospace>insideOutside</monospace> method include other mammalian organisms that undergo the process of blastocyst formation (humans, non-human primates, other rodents, ungulates, etc.). It also has use for certain organoid systems, such as quantifying the level of cell sorting in ICM organoids (<xref ref-type="bibr" rid="R29">Mathew et al., 2019</xref>). And while the <monospace>insideOutside</monospace> method was motivated by the need to discriminate between the ICM and the TE in the pre-implantation blastocyst, it remains a general method for classifying the interior and exterior points of a point-cloud. This means it has extensibility to any data of this description. This includes the organization of transcription factor clusters from single-molecule localization microscopy (<xref ref-type="bibr" rid="R24">Liu et al., 2014</xref>), the pattern of RNA transcripts acquired through seq-FISH (<xref ref-type="bibr" rid="R25">Lohoff et al., 2022</xref>), and the relationship of genomic loci within the nucleus as determined by single-cell Hi-C structures (<xref ref-type="bibr" rid="R42">Stevens et al., 2017</xref>).</p></sec><sec id="S8" sec-type="materials | methods"><title>Materials and Methods</title><sec id="S9"><title>Embryo collection and bright-field imaging</title><p id="P49">Embryos were obtained from natural mating, detection of a copulation plug in the morning was used as confirmation of successful mating and indicated embryonic day (E) 0.5. 8-cell and compacted morula embryos were flushed from the oviduct at E2.5 and E3.0, respectively, and mid and late blastocysts were flushed from the uterine horns at E3.5 and E4.5, respectively, using M2 medium (Sigma-Aldrich, M7167). This research has been regulated under the Animals (Scientific Procedures) Act 1986 Amendment Regulations 2012 following ethical review by the University of Cambridge Animal Welfare and Ethical Review Body. Use of animals in this project was approved by the ethical review committee for the University of Cambridge, and relevant Home Office licences (Project licence No. 80/2597 and No. P76777883) are in place. Bright-field images were taken on a Leica DMI4000B microscope.</p></sec><sec id="S10"><title>Quantitative immunofluorescence of embryos</title><p id="P50">Quantitative immunofluorescence data was originally published in <xref ref-type="bibr" rid="R43">Stirparo et al. (2021)</xref>. In brief, embryos were fixed in paraformaldehyde, stained for DNA and SOX2, and imaged using confocal microscopy. Embryo nuclei were segmented and each nucleus’s total fluorescence (sum of pixel values), volume, and centroid were quantified using MINS (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>).</p></sec><sec id="S11"><title>Accuracy testing designations and rates</title><p id="P51">For accuracy testing, each point was assigned one of four designations: true inside, misclassified inside, true outside, or misclassified outside. A designation of “true inside" means the ground truth of the point and the classification of the point were both “inside". A designation of “misclassified inside" means the ground truth of the point was “inside" and the classification of the point was “outside". The same logic applies to the “outside" designations.</p><p id="P52">Two rates were calculated in the accuracy testing: true inside rate and true outside rate. The “true inside rate" was calculated as the number “true inside" points divided by the number of “total inside" points determined by the ground truth, <disp-formula id="FD3"><label>(3)</label><mml:math id="M4"><mml:mtext>True</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>Inside</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>Rate</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>=</mml:mtext><mml:mspace width="0.2em"/><mml:mfrac><mml:mrow><mml:mtext>True</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>Inside</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>Inside</mml:mtext></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p id="P53">The same logic applies to the “true outside rate". Note that our terminology is based on biological intuition and represents a departure from standard machine learning nomenclature: “true inside rate" corresponds to the sensitivity of the inside classification, and similarly for “true outside rate".</p></sec><sec id="S12"><title>Simulating segmentation error</title><p id="P54">Segmentation error was simulated by <italic>k</italic>-fold cross validation sub-sampling, <italic>k</italic> ∈ [1, 15], of the 14 different embryos. For one-fold cross validation sub-sampling, each nucleus was left out once to build the sample (E.g. For an embryo with 35 nuclei, there would be 35 samples drawn). For <italic>k</italic>-fold cross validation sub-sampling with <italic>k</italic> &gt; 1, we randomly chose 100 samples with replacement from each of the 14 embryos, for a total of 1400 sub-sampled embryos for each value of <italic>k</italic>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS173644-supplement-Supplementary_Material.pdf" mimetype="application" mime-subtype="pdf" id="d25aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgements</title><p>The authors thank the members of the Fletcher and Nichols groups for their helpful feedback in the preparation of the manuscript, especially Ian Groves and Lawrence Bates. Collaboration between the Fletcher and Nichols groups was made possible through a Company of Biologists Travelling Fellowship awarded to SES (DEVTF-180513). SES also acknowledges a Sir Henry Wellcome Postdoctoral Fellowship (224070/Z/21/Z). AGF acknowledges support from the Biotechnology and Biological Sciences Research Council (BB/V018647/1 and BB/R016925/1).</p></ack><sec id="S14" sec-type="data-availability"><title>Code availability</title><p id="P55">The <monospace><monospace>insideOutside</monospace></monospace> algorithm and all code used in this manuscript to perform simulations, analysis, and benchmarking are written in MATLAB (2021a) and are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/stanleystrawbridge/insideOutside">https://github.com/stanleystrawbridge/insideOutside</ext-link> under the GNU General Public License v3.0. A Python implementation of the <monospace>insideOutside</monospace> algorithm is provided in the same repository.</p></sec><fn-group><fn id="FN1" fn-type="con"><p id="P56"><bold>Author contributions</bold></p><p id="P57">SES conceived and developed the <monospace>insideOutside</monospace> algorithm. ECS collected bright field images of pre-implantation mouse embryos. SES, ANF and AGF performed mathematical analyses. AK performed embryo immunostainings and segmentation used for methods benchmarking. SES and AGF performed simulations and computational analyses. SES, AGF, and JN wrote the manuscript.</p></fn></fn-group><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnold</surname><given-names>K</given-names></name><name><surname>Sarkar</surname><given-names>A</given-names></name><name><surname>Yram</surname><given-names>MA</given-names></name><name><surname>Polo</surname><given-names>JM</given-names></name><name><surname>Bronson</surname><given-names>R</given-names></name><name><surname>Sengupta</surname><given-names>S</given-names></name><name><surname>Seandel</surname><given-names>M</given-names></name><name><surname>Geijsen</surname><given-names>N</given-names></name><name><surname>Hochedlinger</surname><given-names>K</given-names></name></person-group><article-title>Sox2+ adult stem and progenitor cells are important for tissue regeneration and survival of mice</article-title><source>Cell Stem Cell</source><year>2011</year><volume>9</volume><issue>4</issue><fpage>317</fpage><lpage>329</lpage><pub-id pub-id-type="pmcid">PMC3538360</pub-id><pub-id pub-id-type="pmid">21982232</pub-id><pub-id pub-id-type="doi">10.1016/j.stem.2011.09.001</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barber</surname><given-names>CB</given-names></name><name><surname>Dobkin</surname><given-names>DP</given-names></name><name><surname>Huhdanpaa</surname><given-names>H</given-names></name></person-group><article-title>The quickhull algorithm for convex hulls</article-title><source>ACM Trans Math Softw</source><year>1996</year><volume>22</volume><issue>4</issue><fpage>469</fpage><lpage>483</lpage></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bessonnard</surname><given-names>S</given-names></name><name><surname>De Mot</surname><given-names>L</given-names></name><name><surname>Gonze</surname><given-names>D</given-names></name><name><surname>Barriol</surname><given-names>M</given-names></name><name><surname>Dennis</surname><given-names>C</given-names></name><name><surname>Goldbeter</surname><given-names>A</given-names></name><name><surname>Dupont</surname><given-names>G</given-names></name><name><surname>Chazaud</surname><given-names>C</given-names></name></person-group><article-title>Gata6, Nanog and Erk signaling control cell fate in the inner cell mass through a tristable regulatory network</article-title><source>Development</source><year>2014</year><volume>141</volume><issue>19</issue><fpage>3637</fpage><lpage>3648</lpage><pub-id pub-id-type="pmid">25209243</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blin</surname><given-names>G</given-names></name><name><surname>Sadurska</surname><given-names>D</given-names></name><name><surname>Portero Migueles</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>N</given-names></name><name><surname>Watson</surname><given-names>J</given-names></name><name><surname>Lowell</surname><given-names>S</given-names></name></person-group><article-title>Nessys: a new set of tools for the automated detection of nuclei within intact tissues and dense 3D cultures</article-title><source>PLoS Biol</source><year>2019</year><volume>17</volume><issue>8</issue><elocation-id>e3000388</elocation-id><pub-id pub-id-type="pmcid">PMC6703695</pub-id><pub-id pub-id-type="pmid">31398189</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000388</pub-id></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boroviak</surname><given-names>T</given-names></name><name><surname>Stirparo</surname><given-names>GG</given-names></name><name><surname>Dietmann</surname><given-names>S</given-names></name><name><surname>Hernando-Herraez</surname><given-names>I</given-names></name><name><surname>Mohammed</surname><given-names>H</given-names></name><name><surname>Reik</surname><given-names>W</given-names></name><name><surname>Smith</surname><given-names>A</given-names></name><name><surname>Sasaki</surname><given-names>E</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Bertone</surname><given-names>P</given-names></name></person-group><article-title>Single cell transcriptome analysis of human, marmoset and mouse embryos reveals common and divergent features of preimplantation development</article-title><source>Development</source><year>2018</year><volume>145</volume><issue>21</issue><elocation-id>dev167833</elocation-id><pub-id pub-id-type="pmcid">PMC6240320</pub-id><pub-id pub-id-type="pmid">30413530</pub-id><pub-id pub-id-type="doi">10.1242/dev.167833</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chazaud</surname><given-names>C</given-names></name><name><surname>Yamanaka</surname><given-names>Y</given-names></name><name><surname>Pawson</surname><given-names>T</given-names></name><name><surname>Rossant</surname><given-names>J</given-names></name></person-group><article-title>Early lineage segregation between epiblast and primitive endoderm in mouse blastocysts through the Grb2-MAPK pathway</article-title><source>Dev Cell</source><year>2006</year><volume>10</volume><issue>5</issue><fpage>615</fpage><lpage>624</lpage><pub-id pub-id-type="pmid">16678776</pub-id></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christiansen</surname><given-names>EM</given-names></name><name><surname>Yang</surname><given-names>SJ</given-names></name><name><surname>Ando</surname><given-names>DM</given-names></name><name><surname>Javaherian</surname><given-names>A</given-names></name><name><surname>Skibinski</surname><given-names>G</given-names></name><name><surname>Lipnick</surname><given-names>S</given-names></name><name><surname>Mount</surname><given-names>E</given-names></name><name><surname>O’neil</surname><given-names>A</given-names></name><name><surname>Shah</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>AK</given-names></name><etal/></person-group><article-title>In silico labeling: predicting fluorescent labels in unlabeled images</article-title><source>Cell</source><year>2018</year><volume>173</volume><issue>3</issue><fpage>792</fpage><lpage>803</lpage><pub-id pub-id-type="pmcid">PMC6309178</pub-id><pub-id pub-id-type="pmid">29656897</pub-id><pub-id pub-id-type="doi">10.1016/j.cell.2018.03.040</pub-id></element-citation></ref><ref id="R8"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Deserno</surname><given-names>M</given-names></name></person-group><source>How to generate equidistributed points on the surface of a sphere</source><year>2004</year><date-in-citation>accessed: 10.02.2021</date-in-citation><comment>Online <ext-link ext-link-type="uri" xlink:href="https://www.cmu.edu/biolphys/deserno/pdf/sphere_equi.pdf">https://www.cmu.edu/biolphys/deserno/pdf/sphere_equi.pdf</ext-link></comment></element-citation></ref><ref id="R9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>MJ</given-names></name><name><surname>Kaufman</surname><given-names>MH</given-names></name></person-group><article-title>Establishment in culture of pluripotential cells from mouse embryos</article-title><source>Nature</source><year>1981</year><volume>292</volume><issue>5819</issue><fpage>154</fpage><lpage>156</lpage><pub-id pub-id-type="pmid">7242681</pub-id></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischler</surname><given-names>MA</given-names></name><name><surname>Bolles</surname><given-names>RC</given-names></name></person-group><article-title>Random sample consensus: a paradigm for model fitting with applications to image analysis and automated cartography</article-title><source>Commun A C M</source><year>1981</year><volume>24</volume><issue>6</issue><fpage>381</fpage><lpage>395</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fleming</surname><given-names>TP</given-names></name></person-group><article-title>A quantitative analysis of cell allocation to trophectoderm and inner cell mass in the mouse blastocyst</article-title><source>Dev Biol</source><year>1987</year><volume>119</volume><issue>2</issue><fpage>520</fpage><lpage>531</lpage><pub-id pub-id-type="pmid">3803716</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forsyth</surname><given-names>J</given-names></name><name><surname>Al-Anbaki</surname><given-names>A</given-names></name><name><surname>de la Fuente</surname><given-names>R</given-names></name><name><surname>Modare</surname><given-names>N</given-names></name><name><surname>Perez-Cortes</surname><given-names>D</given-names></name><name><surname>Rivera</surname><given-names>I</given-names></name><name><surname>Kelly</surname><given-names>R</given-names></name><name><surname>Cotter</surname><given-names>S</given-names></name><name><surname>Plusa</surname><given-names>B</given-names></name></person-group><article-title>IVEN: A quantitative tool to describe 3D cell position and neighbourhood reveals architectural changes in FGF4-treated preimplantation embryos</article-title><source>PLoS Biol</source><year>2021</year><volume>19</volume><issue>7</issue><elocation-id>e3001345</elocation-id><pub-id pub-id-type="pmcid">PMC8341705</pub-id><pub-id pub-id-type="pmid">34310594</pub-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3001345</pub-id></element-citation></ref><ref id="R13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>R</given-names></name><name><surname>Johnson</surname><given-names>M</given-names></name></person-group><article-title>An investigation of inner cell mass and trophoblast tissues following their isolation from the mouse blastocyst</article-title><source>J Embryol Exp Morph</source><year>1972</year><volume>28</volume><issue>2</issue><fpage>279</fpage><lpage>312</lpage><pub-id pub-id-type="pmid">4672104</pub-id></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname><given-names>R</given-names></name><name><surname>Rossant</surname><given-names>J</given-names></name></person-group><article-title>Investigation of the fate of 4-5 day post-coitum mouse inner cell mass cells by blastocyst injection</article-title><source>J Embryol Exp Morph</source><year>1979</year><volume>52</volume><fpage>141</fpage><lpage>152</lpage><pub-id pub-id-type="pmid">521746</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grabarek</surname><given-names>JB</given-names></name><name><surname>Żyżyńska</surname><given-names>K</given-names></name><name><surname>Saiz</surname><given-names>N</given-names></name><name><surname>Piliszek</surname><given-names>A</given-names></name><name><surname>Frankenberg</surname><given-names>S</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name><name><surname>Plusa</surname><given-names>B</given-names></name></person-group><article-title>Differential plasticity of epiblast and primitive endoderm precursors within the ICM of the early mouse embryo</article-title><source>Development</source><year>2012</year><volume>139</volume><issue>1</issue><fpage>129</fpage><lpage>139</lpage><pub-id pub-id-type="pmcid">PMC3231774</pub-id><pub-id pub-id-type="pmid">22096072</pub-id><pub-id pub-id-type="doi">10.1242/dev.067702</pub-id></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>F</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Hu</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>P</given-names></name><name><surname>Wen</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>F</given-names></name></person-group><article-title>Single-cell multi-omics sequencing of mouse early embryos and embryonic stem cells</article-title><source>Cell Res</source><year>2017</year><volume>27</volume><issue>8</issue><fpage>967</fpage><lpage>988</lpage><pub-id pub-id-type="pmcid">PMC5539349</pub-id><pub-id pub-id-type="pmid">28621329</pub-id><pub-id pub-id-type="doi">10.1038/cr.2017.82</pub-id></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>G</given-names></name><name><surname>Huss</surname><given-names>M</given-names></name><name><surname>Tong</surname><given-names>GQ</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>LL</given-names></name><name><surname>Clarke</surname><given-names>ND</given-names></name><name><surname>Robson</surname><given-names>P</given-names></name></person-group><article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title><source>Dev Cell</source><year>2010</year><volume>18</volume><issue>4</issue><fpage>675</fpage><lpage>685</lpage><pub-id pub-id-type="pmid">20412781</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>G</given-names></name><name><surname>Stirparo</surname><given-names>GG</given-names></name><name><surname>Strawbridge</surname><given-names>SE</given-names></name><name><surname>Spindlow</surname><given-names>D</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Clarke</surname><given-names>J</given-names></name><name><surname>Dattani</surname><given-names>A</given-names></name><name><surname>Yanagida</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>MA</given-names></name><name><surname>Myers</surname><given-names>S</given-names></name><etal/></person-group><article-title>Human naive epiblast cells possess unrestricted lineage potential</article-title><source>Cell Stem Cell</source><year>2021</year><volume>28</volume><issue>6</issue><fpage>1040</fpage><lpage>1056</lpage><pub-id pub-id-type="pmcid">PMC8189439</pub-id><pub-id pub-id-type="pmid">33831366</pub-id><pub-id pub-id-type="doi">10.1016/j.stem.2021.02.025</pub-id></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname><given-names>TG</given-names></name><name><surname>Klinghoffer</surname><given-names>RA</given-names></name><name><surname>Corrin</surname><given-names>PD</given-names></name><name><surname>Soriano</surname><given-names>P</given-names></name></person-group><article-title>Evolutionary divergence of platelet-derived growth factor alpha receptor signaling mechanisms</article-title><source>Mol Cell Biol</source><year>2003</year><volume>23</volume><issue>11</issue><fpage>4013</fpage><lpage>4025</lpage><pub-id pub-id-type="pmcid">PMC155222</pub-id><pub-id pub-id-type="pmid">12748302</pub-id><pub-id pub-id-type="doi">10.1128/MCB.23.11.4013-4025.2003</pub-id></element-citation></ref><ref id="R20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>MH</given-names></name><name><surname>Ziomek</surname><given-names>CA</given-names></name></person-group><article-title>The foundation of two distinct cell lineages within the mouse morula</article-title><source>Cell</source><year>1981</year><volume>24</volume><issue>1</issue><fpage>71</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">7237545</pub-id></element-citation></ref><ref id="R21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalkan</surname><given-names>T</given-names></name><name><surname>Olova</surname><given-names>N</given-names></name><name><surname>Roode</surname><given-names>M</given-names></name><name><surname>Mulas</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>HJ</given-names></name><name><surname>Nett</surname><given-names>I</given-names></name><name><surname>Marks</surname><given-names>H</given-names></name><name><surname>Walker</surname><given-names>R</given-names></name><name><surname>Stunnenberg</surname><given-names>HG</given-names></name><name><surname>Lilley</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Tracking the embryonic stem cell transition from ground state pluripotency</article-title><source>Development</source><year>2017</year><volume>144</volume><issue>7</issue><fpage>1221</fpage><lpage>1234</lpage><pub-id pub-id-type="pmcid">PMC5399622</pub-id><pub-id pub-id-type="pmid">28174249</pub-id><pub-id pub-id-type="doi">10.1242/dev.142711</pub-id></element-citation></ref><ref id="R22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>KA</given-names></name><name><surname>Dunn</surname><given-names>NR</given-names></name><name><surname>Roelen</surname><given-names>BA</given-names></name><name><surname>Zeinstra</surname><given-names>LM</given-names></name><name><surname>Davis</surname><given-names>AM</given-names></name><name><surname>Wright</surname><given-names>CV</given-names></name><name><surname>Korving</surname><given-names>JP</given-names></name><name><surname>Hogan</surname><given-names>BL</given-names></name></person-group><article-title>Bmp4 is required for the generation of primordial germ cells in the mouse embryo</article-title><source>Genes Dev</source><year>1999</year><volume>13</volume><issue>4</issue><fpage>424</fpage><lpage>436</lpage><pub-id pub-id-type="pmcid">PMC316469</pub-id><pub-id pub-id-type="pmid">10049358</pub-id><pub-id pub-id-type="doi">10.1101/gad.13.4.424</pub-id></element-citation></ref><ref id="R23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Bin</surname><given-names>GC</given-names></name><name><surname>Muñoz-Descalzo</surname><given-names>S</given-names></name><name><surname>Kurowski</surname><given-names>A</given-names></name><name><surname>Leitch</surname><given-names>H</given-names></name><name><surname>Lou</surname><given-names>X</given-names></name><name><surname>Mansfield</surname><given-names>W</given-names></name><name><surname>Etienne-Dumeau</surname><given-names>C</given-names></name><name><surname>Grabole</surname><given-names>N</given-names></name><name><surname>Mulas</surname><given-names>C</given-names></name><name><surname>Niwa</surname><given-names>H</given-names></name><etal/></person-group><article-title>Oct4 is required for lineage priming in the developing inner cell mass of the mouse blastocyst</article-title><source>Development</source><year>2014</year><volume>141</volume><issue>5</issue><fpage>1001</fpage><lpage>1010</lpage><pub-id pub-id-type="pmcid">PMC3929414</pub-id><pub-id pub-id-type="pmid">24504341</pub-id><pub-id pub-id-type="doi">10.1242/dev.096875</pub-id></element-citation></ref><ref id="R24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Legant</surname><given-names>WR</given-names></name><name><surname>Chen</surname><given-names>BC</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Grimm</surname><given-names>JB</given-names></name><name><surname>Lavis</surname><given-names>LD</given-names></name><name><surname>Betzig</surname><given-names>E</given-names></name><name><surname>Tjian</surname><given-names>R</given-names></name></person-group><article-title>3D imaging of Sox2 enhancer clusters in embryonic stem cells</article-title><source>eLife</source><year>2014</year><volume>3</volume><elocation-id>e04236</elocation-id><pub-id pub-id-type="pmcid">PMC4381973</pub-id><pub-id pub-id-type="pmid">25537195</pub-id><pub-id pub-id-type="doi">10.7554/eLife.04236</pub-id></element-citation></ref><ref id="R25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lohoff</surname><given-names>T</given-names></name><name><surname>Ghazanfar</surname><given-names>S</given-names></name><name><surname>Missarova</surname><given-names>A</given-names></name><name><surname>Koulena</surname><given-names>N</given-names></name><name><surname>Pierson</surname><given-names>N</given-names></name><name><surname>Griffiths</surname><given-names>J</given-names></name><name><surname>Bardot</surname><given-names>E</given-names></name><name><surname>Eng</surname><given-names>CH</given-names></name><name><surname>Tyser</surname><given-names>R</given-names></name><name><surname>Argelaguet</surname><given-names>R</given-names></name><etal/></person-group><article-title>Integration of spatial and single-cell transcriptomic data elucidates mouse organogenesis</article-title><source>Nat Biotechnol</source><year>2022</year><volume>40</volume><fpage>74</fpage><lpage>85</lpage><pub-id pub-id-type="pmcid">PMC8763645</pub-id><pub-id pub-id-type="pmid">34489600</pub-id><pub-id pub-id-type="doi">10.1038/s41587-021-01006-2</pub-id></element-citation></ref><ref id="R26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lou</surname><given-names>X</given-names></name><name><surname>Kang</surname><given-names>M</given-names></name><name><surname>Xenopoulos</surname><given-names>P</given-names></name><name><surname>Munoz-Descalzo</surname><given-names>S</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>A rapid and efficient 2D/3D nuclear segmentation method for analysis of early mouse embryo and stem cell image data</article-title><source>Stem Cell Rep</source><year>2014</year><volume>2</volume><issue>3</issue><fpage>382</fpage><lpage>397</lpage><pub-id pub-id-type="pmcid">PMC3964288</pub-id><pub-id pub-id-type="pmid">24672759</pub-id><pub-id pub-id-type="doi">10.1016/j.stemcr.2014.01.010</pub-id></element-citation></ref><ref id="R27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malter</surname><given-names>HE</given-names></name><name><surname>Cohen</surname><given-names>J</given-names></name></person-group><article-title>Blastocyst formation and hatching in vitro following zona drilling of mouse and human embryos</article-title><source>Gamete Res</source><year>1989</year><volume>24</volume><issue>1</issue><fpage>67</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">2591852</pub-id></element-citation></ref><ref id="R28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>GR</given-names></name></person-group><article-title>Isolation of a pluripotent cell line from early mouse embryos cultured in medium conditioned by teratocarcinoma stem cells</article-title><source>Proc Natl Acad Sci USA</source><year>1981</year><volume>78</volume><issue>12</issue><fpage>7634</fpage><lpage>7638</lpage><pub-id pub-id-type="pmcid">PMC349323</pub-id><pub-id pub-id-type="pmid">6950406</pub-id><pub-id pub-id-type="doi">10.1073/pnas.78.12.7634</pub-id></element-citation></ref><ref id="R29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathew</surname><given-names>B</given-names></name><name><surname>Muñoz-Descalzo</surname><given-names>S</given-names></name><name><surname>Corujo-Simon</surname><given-names>E</given-names></name><name><surname>Schröter</surname><given-names>C</given-names></name><name><surname>Stelzer</surname><given-names>EH</given-names></name><name><surname>Fischer</surname><given-names>SC</given-names></name></person-group><article-title>Mouse ICM organoids reveal three-dimensional cell fate clustering</article-title><source>Biophys J</source><year>2019</year><volume>116</volume><issue>1</issue><fpage>127</fpage><lpage>141</lpage><pub-id pub-id-type="pmcid">PMC6341222</pub-id><pub-id pub-id-type="pmid">30514631</pub-id><pub-id pub-id-type="doi">10.1016/j.bpj.2018.11.011</pub-id></element-citation></ref><ref id="R30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDole</surname><given-names>K</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name></person-group><article-title>Generation and live imaging of an endogenous Cdx2 reporter mouse line</article-title><source>Genesis</source><year>2012</year><volume>50</volume><issue>10</issue><fpage>775</fpage><lpage>782</lpage><pub-id pub-id-type="pmcid">PMC3477249</pub-id><pub-id pub-id-type="pmid">22814996</pub-id><pub-id pub-id-type="doi">10.1002/dvg.22049</pub-id></element-citation></ref><ref id="R31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgani</surname><given-names>SM</given-names></name><name><surname>Saiz</surname><given-names>N</given-names></name><name><surname>Garg</surname><given-names>V</given-names></name><name><surname>Raina</surname><given-names>D</given-names></name><name><surname>Simon</surname><given-names>CS</given-names></name><name><surname>Kang</surname><given-names>M</given-names></name><name><surname>Arias</surname><given-names>AM</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Schröter</surname><given-names>C</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>A Sprouty4 reporter to monitor FGF/ERK signaling activity in ESCs and mice</article-title><source>Dev Biol</source><year>2018</year><volume>441</volume><issue>1</issue><fpage>104</fpage><lpage>126</lpage><pub-id pub-id-type="pmcid">PMC6455974</pub-id><pub-id pub-id-type="pmid">29964027</pub-id><pub-id pub-id-type="doi">10.1016/j.ydbio.2018.06.017</pub-id></element-citation></ref><ref id="R32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Gardner</surname><given-names>R</given-names></name></person-group><article-title>Heterogeneous differentiation of external cells in individual isolated early mouse inner cell masses in culture</article-title><source>J Embryol Exp Morph</source><year>1984</year><volume>80</volume><fpage>225</fpage><lpage>240</lpage><pub-id pub-id-type="pmid">6747527</pub-id></element-citation></ref><ref id="R33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niwa</surname><given-names>H</given-names></name><name><surname>Toyooka</surname><given-names>Y</given-names></name><name><surname>Shimosato</surname><given-names>D</given-names></name><name><surname>Strumpf</surname><given-names>D</given-names></name><name><surname>Takahashi</surname><given-names>K</given-names></name><name><surname>Yagi</surname><given-names>R</given-names></name><name><surname>Rossant</surname><given-names>J</given-names></name></person-group><article-title>Interaction between Oct3/4 and Cdx2 determines trophectoderm differentiation</article-title><source>Cell</source><year>2005</year><volume>123</volume><issue>5</issue><fpage>917</fpage><lpage>929</lpage><pub-id pub-id-type="pmid">16325584</pub-id></element-citation></ref><ref id="R34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ounkomol</surname><given-names>C</given-names></name><name><surname>Seshamani</surname><given-names>S</given-names></name><name><surname>Maleckar</surname><given-names>MM</given-names></name><name><surname>Collman</surname><given-names>F</given-names></name><name><surname>Johnson</surname><given-names>GR</given-names></name></person-group><article-title>Label-free prediction of three-dimensional fluorescence images from transmitted-light microscopy</article-title><source>Nat Meth</source><year>2018</year><volume>15</volume><issue>11</issue><fpage>917</fpage><lpage>920</lpage><pub-id pub-id-type="pmcid">PMC6212323</pub-id><pub-id pub-id-type="pmid">30224672</pub-id><pub-id pub-id-type="doi">10.1038/s41592-018-0111-2</pub-id></element-citation></ref><ref id="R35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmieri</surname><given-names>SL</given-names></name><name><surname>Peter</surname><given-names>W</given-names></name><name><surname>Hess</surname><given-names>H</given-names></name><name><surname>SCHöLER</surname><given-names>HR</given-names></name></person-group><article-title>Oct-4 transcription factor is differentially expressed in the mouse embryo during establishment of the first two extraembryonic cell lineages involved in implantation</article-title><source>Dev Biol</source><year>1994</year><volume>166</volume><issue>1</issue><fpage>259</fpage><lpage>267</lpage><pub-id pub-id-type="pmid">7958450</pub-id></element-citation></ref><ref id="R36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plusa</surname><given-names>B</given-names></name><name><surname>Piliszek</surname><given-names>AE</given-names></name><name><surname>Frankenberg</surname><given-names>S</given-names></name><name><surname>Artus</surname><given-names>J</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>Distinct sequential cell behaviours direct primitive endoderm formation in the mouse blastocyst</article-title><source>Dev Biol</source><year>2008</year><volume>2</volume><issue>319</issue><fpage>537</fpage><lpage>538</lpage><pub-id pub-id-type="pmcid">PMC2768606</pub-id><pub-id pub-id-type="pmid">18725515</pub-id><pub-id pub-id-type="doi">10.1242/dev.021519</pub-id></element-citation></ref><ref id="R37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saiz</surname><given-names>N</given-names></name><name><surname>Mora-Bitria</surname><given-names>L</given-names></name><name><surname>Rahman</surname><given-names>S</given-names></name><name><surname>George</surname><given-names>H</given-names></name><name><surname>Herder</surname><given-names>JP</given-names></name><name><surname>García-Ojalvo</surname><given-names>J</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>Growth-factor-mediated coupling between lineage size and cell fate choice underlies robustness of mammalian development</article-title><source>eLife</source><year>2020</year><volume>9</volume><elocation-id>e56079</elocation-id><pub-id pub-id-type="pmcid">PMC7513828</pub-id><pub-id pub-id-type="pmid">32720894</pub-id><pub-id pub-id-type="doi">10.7554/eLife.56079</pub-id></element-citation></ref><ref id="R38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saiz</surname><given-names>N</given-names></name><name><surname>Williams</surname><given-names>KM</given-names></name><name><surname>Seshan</surname><given-names>VE</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>Asynchronous fate decisions by single cells collectively ensure consistent lineage composition in the mouse blastocyst</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><issue>1</issue><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmcid">PMC5120222</pub-id><pub-id pub-id-type="pmid">27857135</pub-id><pub-id pub-id-type="doi">10.1038/ncomms13463</pub-id></element-citation></ref><ref id="R39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schindelin</surname><given-names>J</given-names></name><name><surname>Arganda-Carreras</surname><given-names>I</given-names></name><name><surname>Frise</surname><given-names>E</given-names></name><name><surname>Kaynig</surname><given-names>V</given-names></name><name><surname>Longair</surname><given-names>M</given-names></name><name><surname>Pietzsch</surname><given-names>T</given-names></name><name><surname>Preibisch</surname><given-names>S</given-names></name><name><surname>Rueden</surname><given-names>C</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>Schmid</surname><given-names>B</given-names></name><etal/></person-group><article-title>Fiji: an open-source platform for biological-image analysis</article-title><source>Nat Meth</source><year>2012</year><volume>9</volume><issue>7</issue><fpage>676</fpage><lpage>682</lpage><pub-id pub-id-type="pmcid">PMC3855844</pub-id><pub-id pub-id-type="pmid">22743772</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id></element-citation></ref><ref id="R40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schrode</surname><given-names>N</given-names></name><name><surname>Saiz</surname><given-names>N</given-names></name><name><surname>Di Talia</surname><given-names>S</given-names></name><name><surname>Hadjantonakis</surname><given-names>AK</given-names></name></person-group><article-title>GATA6 levels modulate primitive endoderm cell fate choice and timing in the mouse blastocyst</article-title><source>Dev Cell</source><year>2014</year><volume>29</volume><issue>4</issue><fpage>454</fpage><lpage>467</lpage><pub-id pub-id-type="pmcid">PMC4103658</pub-id><pub-id pub-id-type="pmid">24835466</pub-id><pub-id pub-id-type="doi">10.1016/j.devcel.2014.04.011</pub-id></element-citation></ref><ref id="R41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>R</given-names></name><name><surname>McLaren</surname><given-names>A</given-names></name></person-group><article-title>Factors affecting the time of formation of the mouse blastocoele</article-title><source>J Embryol Exp Morph</source><year>1977</year><volume>41</volume><fpage>79</fpage><lpage>92</lpage><pub-id pub-id-type="pmid">591880</pub-id></element-citation></ref><ref id="R42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevens</surname><given-names>TJ</given-names></name><name><surname>Lando</surname><given-names>D</given-names></name><name><surname>Basu</surname><given-names>S</given-names></name><name><surname>Atkinson</surname><given-names>LP</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Lee</surname><given-names>SF</given-names></name><name><surname>Leeb</surname><given-names>M</given-names></name><name><surname>Wohlfahrt</surname><given-names>KJ</given-names></name><name><surname>Boucher</surname><given-names>W</given-names></name><name><surname>O’Shaughnessy-Kirwan</surname><given-names>A</given-names></name><etal/></person-group><article-title>3D structures of individual mammalian genomes studied by single-cell Hi-C</article-title><source>Nature</source><year>2017</year><volume>544</volume><issue>7648</issue><fpage>59</fpage><lpage>64</lpage><pub-id pub-id-type="pmcid">PMC5385134</pub-id><pub-id pub-id-type="pmid">28289288</pub-id><pub-id pub-id-type="doi">10.1038/nature21429</pub-id></element-citation></ref><ref id="R43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stirparo</surname><given-names>G</given-names></name><name><surname>Kurowski</surname><given-names>A</given-names></name><name><surname>Yanagida</surname><given-names>A</given-names></name><name><surname>Bates</surname><given-names>L</given-names></name><name><surname>Strawbridge</surname><given-names>S</given-names></name><name><surname>Hladkou</surname><given-names>S</given-names></name><name><surname>Stuart</surname><given-names>H</given-names></name><name><surname>Boroviak</surname><given-names>T</given-names></name><name><surname>Silva</surname><given-names>J</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name></person-group><article-title>OCT4 induces embryonic pluripotency via STAT3 signaling and metabolic mechanisms</article-title><source>Proc Natl Acad Sci USA</source><year>2021</year><volume>118</volume><issue>3</issue><elocation-id>e2008890118</elocation-id><pub-id pub-id-type="pmcid">PMC7826362</pub-id><pub-id pub-id-type="pmid">33452132</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2008890118</pub-id></element-citation></ref><ref id="R44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stirparo</surname><given-names>GG</given-names></name><name><surname>Boroviak</surname><given-names>T</given-names></name><name><surname>Guo</surname><given-names>G</given-names></name><name><surname>Nichols</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>A</given-names></name><name><surname>Bertone</surname><given-names>P</given-names></name></person-group><article-title>Integrated analysis of single-cell embryo data yields a unified transcriptome signature for the human pre-implantation epiblast</article-title><source>Development</source><year>2018</year><volume>145</volume><issue>3</issue><elocation-id>dev158501</elocation-id><pub-id pub-id-type="pmcid">PMC5818005</pub-id><pub-id pub-id-type="pmid">29361568</pub-id><pub-id pub-id-type="doi">10.1242/dev.158501</pub-id></element-citation></ref><ref id="R45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarkowski</surname><given-names>AK</given-names></name><name><surname>Wróblewska</surname><given-names>J</given-names></name></person-group><article-title>Development of blastomeres of mouse eggs isolated at the 4-and 8-cell stage</article-title><source>J Embryol Exp Morph</source><year>1967</year><volume>18</volume><fpage>155</fpage><lpage>180</lpage><pub-id pub-id-type="pmid">6048976</pub-id></element-citation></ref><ref id="R46"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Weigert</surname><given-names>M</given-names></name><name><surname>Schmidt</surname><given-names>U</given-names></name><name><surname>Haase</surname><given-names>R</given-names></name><name><surname>Sugawara</surname><given-names>K</given-names></name><name><surname>Myers</surname><given-names>G</given-names></name></person-group><source>Star-convex polyhedra for 3d object detection and segmentation in microscopy</source><conf-name>2020 IEEE Winter Conference on Applications of Computer Vision (WACV)</conf-name><year>2020</year><fpage>3655</fpage><lpage>3662</lpage></element-citation></ref><ref id="R47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wicklow</surname><given-names>E</given-names></name><name><surname>Blij</surname><given-names>S</given-names></name><name><surname>Frum</surname><given-names>T</given-names></name><name><surname>Hirate</surname><given-names>Y</given-names></name><name><surname>Lang</surname><given-names>R</given-names></name><name><surname>Sasaki</surname><given-names>H</given-names></name><name><surname>Ralston</surname><given-names>A</given-names></name></person-group><article-title>HIPPO pathway members restrict SOX2 to the inner cell mass where it promotes ICM fates in the mouse blastocyst</article-title><source>PLoS Genet</source><year>2014</year><volume>10</volume><issue>10</issue><elocation-id>e1004618</elocation-id><pub-id pub-id-type="pmcid">PMC4207610</pub-id><pub-id pub-id-type="pmid">25340657</pub-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004618</pub-id></element-citation></ref><ref id="R48"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yoshinaga</surname><given-names>K</given-names></name><name><surname>Meyer</surname><given-names>RK</given-names></name><name><surname>Greep</surname><given-names>RO</given-names></name></person-group><source>Implantation of the Ovum</source><publisher-name>Harvard University Press</publisher-name><year>1976</year></element-citation></ref><ref id="R49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziomek</surname><given-names>C</given-names></name><name><surname>Johnson</surname><given-names>M</given-names></name></person-group><article-title>Cell surface interaction induces polarization of mouse 8-cell blastomeres at compaction</article-title><source>Cell</source><year>1980</year><volume>21</volume><issue>3</issue><fpage>935</fpage><lpage>942</lpage><pub-id pub-id-type="pmid">7438209</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>A.</bold> Bright-field images from pre-implantation mouse development, from morula to late blastocyst. <bold>B.</bold> Three major morphogenetic events occur during pre-implantation mouse development: compaction, cavitation, and hatching. <bold>C.</bold> Cells in the pre-implantation embryo make two sets of binary cell-fate decisions: first, blastomeres become inner cell mass (ICM) (interior) or trophectoderm (exterior); second, ICM become epiblast or primitive endoderm. These decisions coincide with compaction and cavitation, respectively, and are completed by hatching. <bold>D.</bold> A shape is convex if for any pair of points, <italic>P</italic><sub>0</sub> and <italic>P</italic><sub>1</sub>, the resulting line segment is entirely contained within the shape; biological examples of convex shapes include the compacted morula and blastocyst. <bold>E.</bold> A shape is concave if there exists at least one pair of points whose resulting line segment passes to the exterior of the shape; biological examples of concave shapes include trophectoderm cells and the blastocoel cavity.</p></caption><graphic xlink:href="EMS173644-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>A.</bold> For a point <italic>P</italic> (orange dot) at the centre of a sphere (𝒪, black dot) of radius <italic>r</italic>, the minimum distance from <italic>P</italic> to the sphere is <italic>r</italic> and the variance in distances is zero. <bold>B.</bold> For a point <italic>P</italic> on the surface of the sphere, the minimum distance is zero, and the variance in distances is greatest. <bold>C.</bold> Analytic expressions for the minimum distance, <italic>m</italic>, and variance in distances, <italic>v</italic>, from a point <italic>P</italic> located on/inside a sphere of radius <italic>r</italic> centred at the origin to the sphere. <bold>D.</bold> This relationship is tested for spheres that are discretized using equidistant points. 100 equidistant points (blue dots) are plotted on the unit sphere (rainbow surface). <italic>m</italic> and <italic>v</italic> are calculated for 50 test points (red dots) along the vector from the origin (black dot) to the surface point <italic>P</italic> = (0, 0, 1). Shown are the three-quarters view (left) and the three orthogonal views (right). <bold>E.</bold> The inverse relationship between <italic>m</italic> and <italic>v</italic> are shown for the continuous case of the unit sphere (see <xref ref-type="disp-formula" rid="FD2">(2)</xref>) (red line) and discrete cases of 100 equidistant points on the unit sphere (<xref ref-type="fig" rid="F2">Fig. 2D</xref>, black dotted line) and 100 uniform random points on the unit sphere (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>, translucent black lines, 1000 realizations).</p></caption><graphic xlink:href="EMS173644-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>A.</bold> Outline of the <monospace>insideOutside</monospace> algorithm. <bold>B.</bold> Accuracy testing was performed on a shape constructed of 100 outside points, uniform random points on the unit sphere, and 50 inside points, uniform random points in a ball centred at 𝒪 of radii ranging from 0.01 to 1 (see <xref ref-type="supplementary-material" rid="SD1">Fig. S2</xref>). <bold>Bi-iv.</bold> The steps of the algorithm performed on an example shape with inner ball radius of 1. <bold>Bi.</bold> Ground truth of inside points, blue dots enclosed by blue surface, and outside points, orange points on orange surface. <bold>Bii.</bold> The triangulated hull generated from making a convex hull over the Delaunay triangulation. <bold>Biii.</bold> The classification of points using hierarchical clustering over the calculated parameter space. Shown are True Inside points (blue), True Outside points (orange), and Misclassified Outside points (green). <bold>Biv.</bold> The classification mapped onto the original shape. <bold>C-D.</bold> Accuracy testing was performed by classifying the points (50 inside, 100 outside) of 500 shapes for each of 100 different inner ball radii for values of <italic>ε</italic> ∈ [0.001, 0.1]. <bold>C.</bold> Mean True Inside rate of 500 realizations for each pair of inner ball radius and <italic>ε</italic>. <bold>D.</bold> The minimum achieved True Inside rate for each value of <italic>ε</italic> from the parameter sweep in <bold>C</bold>. The red dashed line shows the True Inside rate using the raw minimum distance and black dotted line shows the selected value of <italic>ε</italic>.</p></caption><graphic xlink:href="EMS173644-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>A.</bold> Confocal images of a mid-blastocyst stained for DNA and early ICM marker SOX2. A single slice is shown for transmitted light and maximum intensity projections are shown for fluorescence images. <bold>B.</bold> Gaussian mixture modelling (GMM) was performed on the SOX2 nuclear signal of 758 cells from 14 embryos to classify SOX2 positive (blue) and negative (orange) nuclei. Nuclear signal was normalized by nuclear volume, log<sub>10</sub> transformation, and re-scaling to the interval [0,1]. <bold>C.</bold> GMM classification of cells applied to the embryo from <bold>A</bold>. <bold>D.</bold> SOX2 GMM classification of embryo from <bold>A</bold> shown in three-quarters view. SOX2 GMM classification was used as the ground truth for methods benchmarking. Shown are True Inside (blue) and True Outside (orange) cell classification. <bold>E.</bold> Classification of embryo from <bold>A</bold> by the Naïve Ellipsoidal, RANSAC Ellipsoidal (<xref ref-type="bibr" rid="R26">Lou et al., 2014</xref>), Convex Hull (<xref ref-type="bibr" rid="R12">Forsyth et al., 2021</xref>), and <monospace>insideOutside</monospace> (<xref ref-type="bibr" rid="R43">Stirparo et al., 2021</xref>) methods shown in three-quarter view. Shown are True Inside (blue), True Outside (orange), Misclassified Outside (green; inside classified as outside), and Misclassified Inside (gray; outside classified as inside) nuclei. <bold>F.</bold> Classification rates for True Inside (left, blue) and True Outside (right, orange). Kruskal-Wallis Test, p-values: *, 0.05 ≥ p &gt; 0.01; **, 0.01 ≥ p &gt; 0.001; ***, 0.001 ≥ p &gt; 0.0001; ****, 0.0001 ≥ p. All other pairwise relationships were not significant with p-values ≥ 0.63. <bold>G.</bold> Increasing levels of noise were added to the surface points of the test shape to simulate increasing local surface concavities. <bold>H.</bold> The mean True Outside rate (orange scale) is shown over the parameter space of inner ball radius (100 radii between 0.01 and 1) versus noise factor (100 levels between 0 and 0.25) for the Convex Hull (left) and <monospace>insideOutside</monospace> (right) methods. 100 test shapes were classified for each parameter pair. Additional contour lines are shown to delineate drops in classification rate.</p></caption><graphic xlink:href="EMS173644-f004"/></fig></floats-group></article>