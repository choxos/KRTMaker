<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS146032</article-id><article-id pub-id-type="doi">10.1101/2021.12.12.472272</article-id><article-id pub-id-type="archive">PPR431258</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Stabilization of Microbial Communities by Responsive Phenotypic Switching</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Haas</surname><given-names>Pierre A.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Gutierrez</surname><given-names>Maria A.</given-names></name><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Oliveira</surname><given-names>Nuno M.</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref><xref ref-type="corresp" rid="CR2">†</xref></contrib><contrib contrib-type="author"><name><surname>Goldstein</surname><given-names>Raymond E.</given-names></name><xref ref-type="aff" rid="A4">4</xref><xref ref-type="corresp" rid="CR3">‡</xref></contrib></contrib-group><aff id="A1"><label>1</label>Max Planck Institute for the Physics of Complex Systems, Nöthnitzer Straße 38, 01187 Dresden, Germany</aff><aff id="A2"><label>2</label>Max Planck Institute of Molecular Cell Biology and Genetics, Pfotenhauerstraße 108, 01307 Dresden, Germany</aff><aff id="A3"><label>3</label>Center for Systems Biology Dresden, Pfotenhauerstraße 108, 01307 Dresden, Germany</aff><aff id="A4"><label>4</label>Department of Applied Mathematics and Theoretical Physics, Centre for Mathematical Sciences, University of Cambridge, Wilberforce Road, Cambridge CB3 0WA, United Kingdom</aff><aff id="A5"><label>5</label>Department of Veterinary Medicine, University of Cambridge, Madingley Road, Cambridge CB3 0ES, United Kingdom</aff><author-notes><corresp id="CR1"><label>*</label><email>haas@pks.mpg.de</email></corresp><corresp id="CR2"><label>†</label><email>n.m.oliveira@damtp.cam.ac.uk</email></corresp><corresp id="CR3"><label>‡</label><email>r.e.goldstein@damtp.cam.ac.uk</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>16</day><month>06</month><year>2022</year></pub-date><pub-date pub-type="preprint"><day>14</day><month>06</month><year>2022</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P1">Clonal microbes can switch between different phenotypes and recent theoretical work has shown that stochastic switching between these subpopulations can stabilize microbial communities. This phenotypic switching need not be stochastic, however, but could also be in response to environmental factors, both biotic and abiotic. Here, motivated by the bacterial persistence phenotype, we explore the ecological effects of such responsive switching by analyzing phenotypic switching in response to competing species. We show that the stability of microbial communities with responsive switching differs generically from that of communities with stochastic switching only. To understand the mechanisms by which responsive switching stabilizes coexistence, we go on to analyze simple two-species models. Combining exact results and numerical simulations, we extend the classical stability results for the competition of two species without phenotypic variation to the case in which one species switches, stochastically and responsively, between two phenotypes. In particular, we show that responsive switching can stabilize coexistence even when stochastic switching on its own does not affect the stability of the community.</p></abstract></article-meta></front><body><sec id="S1" sec-type="intro"><label>I</label><title>Introduction</title><p id="P2">One of the classical results of theoretical ecology is that large random ecological communities are very likely to be unstable [<xref ref-type="bibr" rid="R1">1</xref>]. This is a statistical result, based on the analysis of random matrices representing the Jacobians of otherwise unspecified population dynamics [<xref ref-type="bibr" rid="R1">1</xref>]. It may appear to contradict Nature’s large biodiversity, but actual biological interactions are not random: Rather, they are the product of a long history of evolution, during which population dynamics pruned a possibly much larger set of species [<xref ref-type="bibr" rid="R2">2</xref>]. Nevertheless, the mathematical constraints from random matrix theory that restrict the evolution of this biodiversity can be revealed by this statistical take on population stability, because it enables some analysis of generic large ecological communities and their huge parameter space, and therefore complements the exact results for small systems that are not available for these larger systems. The power of this statistical approach has been demonstrated in a large body of work which, for example, analyzed the effect of the interaction type and structure on the stability of the community [<xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R6">6</xref>], revealed the stabilizing effect of higher-order interactions and explicit resource dynamics [<xref ref-type="bibr" rid="R7">7</xref>, <xref ref-type="bibr" rid="R8">8</xref>], or explored yet other related problems [<xref ref-type="bibr" rid="R9">9</xref>–<xref ref-type="bibr" rid="R13">13</xref>].</p><p id="P3">In this context, recent theoretical work has revealed that subpopulation structure such as phenotypic variation can stabilize microbial communities [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R15">15</xref>]. In particular, we have argued that abundant phenotypic variation is generically destabilizing [<xref ref-type="bibr" rid="R15">15</xref>], essentially because introducing phenotypic variation increases the effective number of species in the system, which is known to be destabilizing [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R3">3</xref>]. More subtly however, stochastic switching to a rare phenotype such as the bacterial persister phenotype [<xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref>] can stabilize communities [<xref ref-type="bibr" rid="R15">15</xref>].</p><p id="P4">Although such stochastic phenotypic switching is optimal in infrequently changing environments [<xref ref-type="bibr" rid="R19">19</xref>], frequent environmental cues, be they biotic or abiotic, favor responsive phenotypic switching associated to some kind of sensing mechanism [<xref ref-type="bibr" rid="R19">19</xref>]. Indeed, recent experimental evidence suggests that such sensing is implicated in the bacterial stress response and, in particular, in switching to stress-resilient phenotypes akin to bacterial persisters [<xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref>]. For example, formation of persisters under stress has recently been associated with production of the “alarmone” ppGpp, suggesting a stress-dependent persistence response [<xref ref-type="bibr" rid="R16">16</xref>, <xref ref-type="bibr" rid="R18">18</xref>]. Data showing that sublethal antibiotic concentrations increase persister concentration [<xref ref-type="bibr" rid="R20">20</xref>] are also consistent with responsive contributions to the persistence switching rates. (While early experiments exposing <italic>Escherichia coli</italic> to antibiotics had suggested that direct sensing is absent from the persistence response [<xref ref-type="bibr" rid="R21">21</xref>], these could not, as already noted in Ref. [<xref ref-type="bibr" rid="R19">19</xref>], exclude effects such as a dependence of switching rates on antibiotic concentration.) The cues for this responsive switching may be toxins produced by other bacterial species, such as the colicinogens produced by certain strains of <italic>E. coli</italic> that have garnered attention in the context of bacterial “rock–paper–scissors” games [<xref ref-type="bibr" rid="R22">22</xref>–<xref ref-type="bibr" rid="R25">25</xref>]. Indeed, very recent work [<xref ref-type="bibr" rid="R26">26</xref>] provides experimental evidence linking such toxins to a stress response: a “suicidal” subpopulation of <italic>Pseudomonas aeruginosa</italic> actively migrates up antibiotic gradients while upregulating the release of its own bacteriocins, suggesting an attack response against toxin-producing competitors [<xref ref-type="bibr" rid="R26">26</xref>]. Responsive mechanisms are thus starting to be appreciated as a feature of microbial populations, but their ecological role in microbial communities remains unclear.</p><p id="P5">Here, we address these ecological implications of responsive switching theoretically by analyzing its effects on the stability of competitive microbial communities with a rare, slowly growing and weakly competing, persister-like phenotype. In the first part of this paper, we extend the two-phenotype model of Ref. [<xref ref-type="bibr" rid="R15">15</xref>] to include responsive phenotypic switching, and show how the statistical stability properties of this model differ from those of a model with stochastic switching only, even if the second phenotype is rare. These statistical results emphasize the importance of the type of phenotypic switching for stability, but leave unanswered the question: Under which conditions does phenotypic switching, be it stochastic or responsive, stabilize or destabilize this community? We address this question in the second part of this paper: We extend the classical results for the stability of Lotka–Volterra systems [<xref ref-type="bibr" rid="R27">27</xref>] by analyzing a minimal model of two competing species in which one species switches, both stochastically and in response to the other species, between two phenotypes. Using numerical simulations and by deriving exact results for still simpler models, we show in particular that responsive switching can promote coexistence even in cases in which stochastic switching on its own does not affect the stability of the community.</p></sec><sec id="S2"><label>II</label><title>Statistical Stability of Responsive Phenotypic Switching</title><p id="P6">In this Section, we introduce a model for the competition of <italic>N</italic> species that switch, both responsively and stochastically, between two phenotypes. This model extends that of Ref. [<xref ref-type="bibr" rid="R15">15</xref>]. We show that its statistical stability properties are generically different from those of the corresponding model with stochastic switching only.</p><sec id="S3"><label>A</label><title>Model</title><p id="P7">We consider the competition of <italic>N</italic> ⩾ 2 well-mixed species that have two phenotypes, B and P, each, between which they switch stochastically. In addition, the B phenotypes of each species respond to the other species by switching to the corresponding P phenotype [Fig. <xref ref-type="fig" rid="F1">1(a)</xref>]. We denote by <italic>B<sub>n</sub></italic> and <italic>P<sub>n</sub></italic> the respective abundances of the B and P phenotypes of species <italic>n,</italic> for 1 ⩽ <italic>n</italic> ⩽ <italic>N</italic>. With Lotka–Volterra competition terms [<xref ref-type="bibr" rid="R27">27</xref>], the dynamics of the vectors <bold><italic>B</italic></bold> = (<italic>B</italic><sub>1</sub>, <italic>B</italic><sub>2</sub>, . . . , <italic>B<sub>N</sub></italic>) and <bold><italic>P</italic></bold> = (<italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub>, . . . , <italic>P<sub>N</sub></italic>) are thus [<xref ref-type="bibr" rid="R28">28</xref>] <disp-formula id="FD1"><label>(1a)</label><mml:math id="M1"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mtext>C</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mtext>D</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>+</mml:mo><mml:mtext>R</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>+</mml:mo><mml:mtext>S</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ℓ</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD2"><label>(1b)</label><mml:math id="M2"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>ε</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mtext>E</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>−</mml:mo><mml:mtext>F</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>+</mml:mo><mml:mtext>R</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>+</mml:mo><mml:mtext>S</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ℓ</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <bold><italic>b, p</italic></bold> are growth rates, the nonnegative entries of the matrices <monospace>C</monospace>, <monospace>D</monospace>, <monospace>E</monospace>, <monospace>F</monospace> are competition strengths, <bold><italic>k, ℓ</italic></bold> are nonnegative rates of stochastic switching, and <monospace>R</monospace>, <monospace>S</monospace> are nonnegative rates of responsive switching. The diagonal entries of <monospace>R</monospace>, <monospace>S</monospace> vanish, so that microbes do not switch phenotype in response to the presence of other microbes of their own species. We stress that Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) are deterministic, as are all subsequent models in this paper: in particular, they do not resolve the individual, stochastic switching events, but only their mean behavior expressed by the deterministic rates of stochastic switching.</p><p id="P8">The functional form of the responsive switching rates in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>), with a direct dependence on the competitor abundances, implies a neglect of the dynamics of the chemical cues of the responsive switching. This is justified since our model aims to elucidate the effect of this responsive switching on stability, rather than the effect of these chemical dynamics that was analyzed, e.g., in Ref. [<xref ref-type="bibr" rid="R29">29</xref>]. The same argument justifies, for instance, neglecting resource dynamics in spite of their known effect on stability [<xref ref-type="bibr" rid="R8">8</xref>]. The linear dependence of responsive switching on the abundances of other species is, however, a simplifying assumption, just as the logistic Lotka–Volterra interaction terms [<xref ref-type="bibr" rid="R27">27</xref>] in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) are the simplest choice of interaction terms. While the full dynamics of the system (and in particular, the existence of non-steady-state attractors like limit cycles) are expected to depend on the details of the functional forms of the interaction terms and switching rates, any such functional forms linearize to the logistic interaction terms and linear switching rates in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) close to an equilibrium. These details do not therefore affect the stability properties of equilibria. Moreover, as shown in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>, the logistic nonlinearities in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) are sufficient for their dynamics to be bounded. For these reasons, we believe these simplifying assumptions to be appropriate for the qualitative analysis of phenotypic dynamics and in particular of the stability of the equilibria of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) in this paper.</p><p id="P9">The parameter <italic>ε</italic> in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) scales the growth and competition of the P phenotypes, and the stochastic and responsive switching rates into the P phenotypes. In the limit <italic>ε</italic> ≪ 1, the P phenotype is therefore a slowly growing and weakly competing phenotype such as bacterial persisters [<xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref>].</p></sec><sec id="S4"><label>B</label><title>Reduced and Averaged Models</title><p id="P10">How does the stability of a microbial community with responsive phenotypic switching differ from that of a community with stochastic switching only? To answer this biological question and thus understand the ecological effects of the type of phenotypic switching, it is tempting to compare the mathematical stability of equilibria of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) to that of equilibria of a corresponding <italic>reduced model</italic> with stochastic switching only, in which <monospace>R</monospace> = <monospace>S</monospace> = <monospace>O</monospace>. Such a comparison does not however answer our biological question, because the populations at equilibrium of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and this reduced model are in general different. This direct comparison cannot therefore decide whether stability differences result from this difference of populations or from the differences in phenotypic switching.</p><p id="P11">To understand the two types of phenotypic switching, we do not therefore compare Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) to this reduced model, but instead to an <italic>averaged model</italic> that has the same population at equilibrium as Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>). While the reduced model takes values of interaction parameters or switching rates from Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>), the averaged model replaces these values with effective values that are determined by the condition of equality of populations at equilibrium. We introduced such averaging of models in Ref. [<xref ref-type="bibr" rid="R15">15</xref>]. There, we pointed out that equality of populations at equilibrium does not lead to simple relations between the eigenvalues of the corresponding Jacobians, so there is no reason to expect their stability properties to be the same. The present discussion develops these ideas.</p><p id="P12">While stability differences between Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and the corresponding averaged model thus reveal the ecological roles of responsive and stochastic phenotypic switching, stability differences between the reduced and averaged models stem from the differences of the reduced and the averaged, effective model parameters. In an actual biological community, these parameters can evolve independently from the evolution of a phenotypic substructure, and so stability differences need not result from this phenotypic substructure. This raises interesting questions akin to those asked in Ref. [<xref ref-type="bibr" rid="R19">19</xref>]: For example, does evolving a more complex phenotypic substructure require more evolutionary adaptations than evolving the effective parameters directly? Answering such questions requires, however, coupling Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) to an evolutionary model. This is beyond the scope of this paper, in which we will therefore focus on the stability differences between Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and the corresponding averaged model, which can be imputed directly to responsive phenotypic switching.</p><p id="P13">After this rather abstract discussion of reduced and averaged models, we now write down the averaged model with stochastic switching only: <disp-formula id="FD3"><label>(2a)</label><mml:math id="M3"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mtext>C</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mtext>D</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ℓ</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD4"><label>(2b)</label><mml:math id="M4"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>ε</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mtext>E</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>−</mml:mo><mml:mtext>F</mml:mtext><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ℓ</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P14">This is the model that we have analyzed in Ref. [<xref ref-type="bibr" rid="R15">15</xref>]. To establish the correspondence between Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>), we notice that an equilibrium <inline-formula><mml:math id="M5"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="script">E</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mo>*</mml:mo></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mo>*</mml:mo></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) is also an equilibrium of Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>) if <bold><italic>k′</italic></bold> = <bold><italic>k</italic></bold> + <monospace>R</monospace> · <bold><italic>B</italic><sub>*</sub></bold> + <monospace>S</monospace> · <bold><italic>P</italic><sub>*</sub></bold> and all other growth rates, competition strengths, and switching rates are unchanged. At equilibrium, responsive switching thus modifies only the effective rate of stochastic switching. It is not therefore possible to distinguish, at equilibrium, between purely stochastic switching and a dependence of switching rates on the presence of other species. This aspect, we have noted in the Introduction, has previously been discussed from an experimental point of view in the context of <italic>E. coli</italic> persistence [<xref ref-type="bibr" rid="R19">19</xref>, <xref ref-type="bibr" rid="R21">21</xref>]. Somewhat conversely, in a reduced model, the rate <bold><italic>k</italic></bold> of stochastic switching would remain unchanged from Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>); stability differences between Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>) and this reduced model could therefore also result, independently from responsive switching, from evolution of the rates of stochastic switching.</p><p id="P15">Despite the correspondence at <inline-formula><mml:math id="M6"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="script">E</mml:mi></mml:mstyle></mml:math></inline-formula> of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>), it is clear that their dynamics away from <inline-formula><mml:math id="M7"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="script">E</mml:mi></mml:mstyle></mml:math></inline-formula> are in general different. It is for this reason that correspondence at equilibrium does not, as we have already noted above, translate to corresponding stability properties. In what follows, we therefore analyze these stability properties to understand the ecological effect of responsive switching.</p></sec><sec id="S5" sec-type="results"><label>C</label><title>Results</title><p id="P16">In the spirit of the random matrix approach to ecological stability, we compare the stability of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>) by sampling their parameters randomly and computing stability statistics. Since the coexistence equilibria of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>) cannot be found in closed form, we cannot sample the model parameters directly; rather, as discussed in more detail in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>, we sample the coexistence state itself and some model parameters directly, leaving linear equations to be solved for the remaining parameters to ensure that the chosen coexistence state is steady [<xref ref-type="bibr" rid="R15">15</xref>].</p><p id="P17">For these random systems, we find that, as the number <italic>N</italic> of species increases, stable coexistence states of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) are increasingly unlikely to be stable with the dynamics of Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>), and vice versa: Stable coexistence with responsive switching is increasingly unlikely to be stable with stochastic switching only, and vice versa [Fig. <xref ref-type="fig" rid="F2">2(a)</xref>]. This trend persists for <italic>ε</italic> ≪ 1, although the probabilities are reduced in magnitude [Fig. <xref ref-type="fig" rid="F2">2(b)</xref>]. Responsive switching can thus stabilize and destabilize equilibria of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>). However, coexistence is less likely to be stable with responsive switching than with stochastic switching only [Fig. <xref ref-type="fig" rid="F2">2(c)</xref>], although the probabilities are nearly equal for small <italic>ε</italic> [Fig. <xref ref-type="fig" rid="F2">2(c)</xref>, inset].</p><p id="P18">In the limit <italic>ε</italic> ≪ 1, coexistence states can be determined in closed form by asymptotic expansion in the small parameter <italic>ε</italic>. Writing <bold><italic>B</italic><sub>*</sub></bold> = <bold><italic>B</italic><sub>0</sub></bold> + <italic>ε</italic><bold><italic>B</italic><sub>1</sub></bold> + <italic>O</italic> (ε<sup>2</sup>), <bold><italic>P</italic><sub>*</sub></bold> = <bold><italic>P</italic><sub>0</sub></bold> + <italic>ε</italic><bold><italic>P</italic><sub>1</sub></bold> + <italic>O</italic> (ε<sup>2</sup>), we find <bold><italic>B</italic><sub>0</sub></bold> = <monospace>C</monospace><sup>−1</sup> · <bold><italic>b</italic></bold>, <bold><italic>P</italic><sub>1</sub></bold> = (<bold><italic>k</italic> +</bold> <monospace>R</monospace> · <bold><italic>B</italic><sub>0</sub></bold>)<bold><italic>B</italic><sub>0</sub></bold>/<bold><italic>ℓ</italic></bold>, but <bold><italic>B</italic><sub>1</sub></bold> = <bold><italic>P</italic><sub>0</sub></bold> = <bold>0</bold>, as derived in more detail in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>. We thence obtain asymptotic expressions for the Jacobians (<xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>), similarly to calculations in Ref. [<xref ref-type="bibr" rid="R15">15</xref>]. Sampling asymptotic coexistence equilibria using this solution, we confirm our findings above, although results differ at a quantitative level because of the different sampling methods [Fig. <xref ref-type="fig" rid="F2">2(b)</xref>].</p><p id="P19">The models with and without responsive switching thus generically lead to different stability results. The Jacobians at <inline-formula><mml:math id="M8"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="script">E</mml:mi></mml:mstyle></mml:math></inline-formula> <monospace>J</monospace><sub>*</sub>, with responsive switching and K<sub>*</sub> with stochastic switching only, are related by <disp-formula id="FD5"><label>(3)</label><graphic xlink:href="EMS146032-f009.jpg"/></disp-formula> which follows from the calculations in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>. We stress that this is an exact result and not an asymptotic approximation. Even in view of this linear relation, the fact that the two models give different stability results is not fundamentally surprising [<xref ref-type="bibr" rid="R15">15</xref>]: this simply reflects the fact that linear relations between matrices do not imply linear relations between their determinants. What is perhaps more unexpected is that, although <monospace>J</monospace><sub>*</sub> = <monospace>K</monospace><sub>*</sub> + <italic>O</italic>(<italic>ε</italic>), the stability results differ even in the limit <italic>ε</italic> ≪ 1. We have previously related behavior of this ilk to the possibility of eigenvalues with small real parts being stabilized or destabilized by higher-order terms in the expansion [<xref ref-type="bibr" rid="R15">15</xref>].</p><p id="P20">We had to restrict to small values of <italic>N</italic> when computing the numerical results in Fig. <xref ref-type="fig" rid="F2">2</xref>, because it becomes increasingly difficult to sample increasingly rare [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R3">3</xref>] stable systems as <italic>N</italic> increases. The strength of the classical random matrix approach [<xref ref-type="bibr" rid="R1">1</xref>, <xref ref-type="bibr" rid="R3">3</xref>] to stability is that it can often circumvent this difficulty by analyzing random Jacobians without further specification of the underlying population dynamics and hence of their equilibria. This simplification is not however available for the questions addressed here, because we need to relate “full” and averaged models (in this case, with and without responsive switching). Nonetheless, the trends in Fig. <xref ref-type="fig" rid="F2">2</xref> suggest that the stability differences found numerically there are amplified for larger values of <italic>N</italic>.</p><p id="P21">There is, however, a more important limitation of this stability analysis: one may argue that instability of an equilibrium is not biologically or ecologically significant, because it does not imply extinction of a species, since the dynamics, perturbed away from the unstable equilibrium, may converge to a different equilibrium, a limit cycle, or a more complex attractor, and so the species may still coexist. A more relevant question is therefore: does stability of one model (with responsive switching or with stochastic switching only) not only fail to predict stability, but also fail to predict coexistence in the other model? Unlike predicting stability, predicting coexistence requires the full dynamics of the system and its non-steady-state attractors, and so the predictions depend, as noted above, on the details of the interactions and switching rates. Analyzing the effect of these details on coexistence is beyond the scope of this paper. Here, we restrict to the logistic interactions and linear switching rates in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>), evolve unstable equilibria numerically and, as described in <xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>, determine whether the species coexist permanently [<xref ref-type="bibr" rid="R32">32</xref>].</p><p id="P22"><xref ref-type="fig" rid="F3">Figure 3</xref> shows the distributions of the long-time dynamics of equilibria that are unstable with responsive switching or with stochastic switching only, respectively, but are stable in the other model. The possible long-time dynamics are permanent coexistence or extinction of some species; in both cases, we distinguish between convergence of the remaining species to an equilibrium or to a limit cycle. The small proportion of systems for which the numerical solution does not converge (Fig. <xref ref-type="fig" rid="F3">3</xref>) may include systems in which more complex attractors arise. We note in particular that extinction of some species is not a rare outcome (Fig. <xref ref-type="fig" rid="F3">3</xref>): it is actually the most likely outcome if both phenotypes have similar abundances [<italic>ε</italic> = 1, Fig. <xref ref-type="fig" rid="F3">3(a)</xref>], while convergence to a limit cycle of all species is more likely if one phenotype is rare [<italic>ε</italic> ≪ 1, Fig. <xref ref-type="fig" rid="F3">3(b)</xref>].</p><p id="P23">From these distributions, we estimate, for both models, the probabilities of extinction of some species for systems perturbed away from an equilibrium that is stable in the other model (Fig. <xref ref-type="fig" rid="F4">4</xref>). The increase of these probabilities with the number of species <italic>N</italic> qualitatively matches the increase of the probabilities of an equilibrium that is stable in one model being unstable in the other model (Fig. <xref ref-type="fig" rid="F2">2</xref>). We can therefore extend our previous conclusion: stability of an equilibrium in one model does not even in general imply permanent coexistence in the other model.</p><p id="P24">Finally, we could similarly compare the stability of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) to that of an averaged model without phenotypic switching (<xref ref-type="supplementary-material" rid="SD1">Appendix A</xref>). However, in view of the correspondence of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>), the qualitative conclusions of such a comparison must parallel those of comparing models with stochastic switching only and averaged models without phenotypic variation. These two models we compared in Ref. [<xref ref-type="bibr" rid="R15">15</xref>], where we concluded that stochastic switching to an abundant phenotype is destabilizing, but stochastic switching to a rare phenotype, corresponding to <italic>ε</italic> ≪ 1, is stabilizing. Here, we can therefore conclude similarly that responsive switching to an abundant phenotype generically destabilizes the community (compared to the case in which there is no phenotypic variation), but that responsive switching to a rare phenotype has a stabilizing effect.</p><p id="P25">However, all of these results are fundamentally statistical in nature. While they show how responsive phenotypic switching affects stability on average, they do not yield any insight into the conditions under which phenotypic switching stabilizes or destabilizes the community. To understand the mechanisms underlying these stability differences, we therefore complement this statistical analysis with an analysis of reduced two-species models in the next Section.</p></sec></sec><sec id="S6"><label>III</label><title>Stabilization of Two-Species Coexistence by Responsive Switching</title><p id="P26">In this Section, we reduce the <italic>N</italic>-species model (<xref ref-type="disp-formula" rid="FD1">1</xref>) to a minimal two-species model of responsive phenotypic switching. In the context of this model, we analyze the mechanisms by which stochastic and responsive switching affect stability numerically. We confirm some of these numerical results by deriving exact results for simplified models in <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref>. These exact results extend the classical results [<xref ref-type="bibr" rid="R27">27</xref>], which we rederive in <xref ref-type="supplementary-material" rid="SD1">Appendix C</xref>, for the stability of the two-species Lotka–Volterra competition model.</p><sec id="S7"><label>A</label><title>Minimal two-species model</title><p id="P27">The simplest setting for responsive phenotypic switching is the competition of two well-mixed species [Fig. <xref ref-type="fig" rid="F1">1(b)</xref>]. The first species has a single phenotype, A, while the second one has two phenotypes, B and P, between which it switches stochastically. Moreover, phenotype B responds to the competitor phenotype A by switching to P [Fig. <xref ref-type="fig" rid="F1">1(b)</xref>]. To interpret this model in terms of actual biological systems, it is useful to think of P as a phenotype resilient to stress conditions, akin to the bacterial persister phenotype [<xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref>], and to which the common, “normal” phenotype B switches in response to toxins produced by A. With this interpretation and for simplicity, we shall sometimes refer to B, P, A and their respective abundances <italic>B</italic>, <italic>P</italic>, <italic>A</italic> as bacteria, persisters, and competitors [<xref ref-type="bibr" rid="R33">33</xref>], and we shall sometimes assume the model parameters to scale accordingly.</p><p id="P28">Thus, again using Lotka–Volterra competition terms [<xref ref-type="bibr" rid="R27">27</xref>], the nondimensionalized dynamics of the system are <disp-formula id="FD6"><label>(4a)</label><mml:math id="M9"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>κ</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD7"><label>(4b)</label><mml:math id="M10"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:mi>ξ</mml:mi><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>ϖ</mml:mi><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>ζ</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> <disp-formula id="FD8"><label>(4c)</label><mml:math id="M11"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>−</mml:mo><mml:mi>η</mml:mi><mml:mi>A</mml:mi><mml:mo>−</mml:mo><mml:mi>ϑ</mml:mi><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mi>ι</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> wherein <italic>α</italic>, <italic>β</italic>, <italic>γ</italic>, <italic>δ</italic>, <italic>ς</italic>, <italic>η</italic>, <italic>ϑ</italic>, <italic>ι</italic>, <italic>κ</italic>, <italic>μ</italic>, <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ζ</italic> ⩾ 0 are dimensionless nonnegative parameters. To obtain this form of the equations, we have scaled time and the population sizes so as to remove the parameters that would otherwise appear in the logistic growth term <italic>B</italic> (1 – <italic>B</italic>) of the bacteria in the absence of persisters and competitors [<xref ref-type="bibr" rid="R34">34</xref>]. The interpretation of the model parameters in Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) is given in <xref ref-type="table" rid="T1">Table I</xref>.</p><p id="P29">We have not explicitly introduced a positive parameter <italic>ε</italic> ≲ 1 scaling the competition dynamics of and switching rates to persisters, but we expect <disp-formula id="FD9"><label>(5)</label><mml:math id="M12"><mml:mrow><mml:mtable equalrows="true" equalcolumns="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>ι</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϖ</mml:mi><mml:mo>,</mml:mo><mml:mi>ς</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> from the interpretation of the model in terms of bacteria, per-sisters, and competitors and by comparison of Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and (<xref ref-type="disp-formula" rid="FD6">4</xref>). We will not assume <italic>ε</italic> ≪ 1, but we will sometimes invoke <italic>ε</italic> ≲ 1 below and in the calculations in <xref ref-type="supplementary-material" rid="SD1">Appendices B</xref>, <xref ref-type="supplementary-material" rid="SD1">C</xref>, <xref ref-type="supplementary-material" rid="SD1">D</xref> to restrict parameter ranges or impose inequalities between parameters.</p></sec><sec id="S8" sec-type="results"><label>B</label><title>Results</title><p id="P30">In this subsection, we analyze model (<xref ref-type="disp-formula" rid="FD6">4</xref>) numerically and ask: under which conditions and to what extent does responsive switching stabilize or destabilize coexistence?</p><sec id="S9"><label>1</label><title>Numerical setup</title><p id="P31">Although the full model (<xref ref-type="disp-formula" rid="FD6">4</xref>) is too complicated for meaningful analytical progress to be made, its equilibria can be found numerically and efficiently by precomputing, using M<sc>ATHE</sc>-<sc>matica</sc>, the exact polynomial equations satisfied by the equilibria from Gröbner bases [<xref ref-type="bibr" rid="R35">35</xref>]. For each computed equilibrium, we check its accuracy using the values of the right-hand sides of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) evaluated there, and verify that all solutions have been found using a test based on Sturm’s theorem [<xref ref-type="bibr" rid="R36">36</xref>]. Finally, we determine the stability of the computed equilibria using the Routh–Hurwitz conditions [<xref ref-type="bibr" rid="R27">27</xref>]. Similarly, we determine the stability of equilibria of the averaged models (with stochastic switching only and without phenotypic variation) corresponding to Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>). Unstable equilibria are integrated numerically, similarly to the calculations in <xref ref-type="sec" rid="S2">Sec. II</xref>, to determine whether the species coexist permanently notwithstanding a particular coexistence equilibrium being unstable. We reduce the number of systems that need to be integrated in this way by showing, in <xref ref-type="supplementary-material" rid="SD1">Appendix D</xref>, that coexistence is permanent if all trivial steady states are unstable provided that the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>) are satisfied.</p><p id="P32">The setup for our numerical calculations is as follows: we fix a population of bacteria and competitors by fixing the competition parameters <italic>α, η, ϑ</italic>, and compute stability diagrams in the (<italic>ζ, β</italic>) plane for random choices of the remaining model parameters <italic>γ</italic>, <italic>δ</italic>, <italic>ι</italic>, <italic>κ</italic>, <italic>μ</italic>, <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ς</italic>, which we constrain to satisfy the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>). We report these numerical results by plotting, for each point in the (<italic>ζ</italic>, <italic>β</italic>) diagram, stability statistics (such as the proportion of random systems in which coexistence is stable or permanent at this point), but it is important to note that these statistics, while providing a convenient way of visualizing the generic properties of the stability diagrams, have no real biological meaning because the averaged models vary between these random instantiations of the full model, since the bacteria-persister competition parameters are held fixed while the switching parameters and the remaining competition parameters are varied.</p></sec><sec id="S10" sec-type="discussion"><label>2</label><title>Discussion</title><p id="P33"><xref ref-type="fig" rid="F5">Figure 5</xref> shows numerical stability diagrams of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>). The classical results for two-species Lotka–Volterra model (<xref ref-type="supplementary-material" rid="SD1">Appendix C</xref>) suggest distinguishing the cases <italic>η</italic>/<italic>α</italic> &gt; <italic>ϑ</italic> and <italic>η</italic>/<italic>α</italic> &lt; <italic>ϑ</italic> which indeed give rise to qualitatively different stability diagrams (Fig. <xref ref-type="fig" rid="F5">5</xref>).</p><p id="P34">In both cases however, sufficient levels of responsive switching destabilize coexistence compared to the averaged model with stochastic switching only. This effect is less pronounced for <italic>ϑ</italic> &lt; <italic>η</italic>/<italic>α</italic> [Fig. <xref ref-type="fig" rid="F5">5(a)</xref>] than for <italic>ϑ</italic> &gt; <italic>η</italic>/<italic>α</italic> [Fig. <xref ref-type="fig" rid="F5">5(b)</xref>]. This destabilization is that which we already noted when discussing the statistical stability of responsive switching in the previous section: <xref ref-type="fig" rid="F2">Figure 2(c)</xref> has already shown that coexistence is more likely to be stable in models with stochastic switching only than in those with responsive switching.</p><p id="P35">In the context of the minimal two-species model (<xref ref-type="disp-formula" rid="FD6">4</xref>), we can however address the mechanisms underlying this average destabilization, and hence even identify the conditions under which responsive switching can be stabilizing. To this end, we analyze the effect of the P phenotype, i.e. the effect of the parameters <italic>ι</italic>, <italic>κ</italic>, <italic>μ</italic>, <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ς</italic> that describe its interactions with the A and B phenotypes (<xref ref-type="table" rid="T1">Table I</xref>), on the stability and permanence of coexistence: We plot, in Figs. <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>, stability diagrams of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) for the cases in which one and only one among <italic>ι</italic>, <italic>κ</italic>, <italic>μ</italic>, <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ς</italic> is nonzero. We emphasize that the these parameters are of the same order, as expressed by the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>), so neglecting the effect represented by one (say, persister growth) compared to another (say, persister-competitor interactions) is not in general ecologically consistent. For this reason, these “one-parameter” models are not “more minimal” than Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>), but the “one-parameter” diagrams in Figs. <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref> can reveal the individual mathematical effects of these parameters, and our results will show how they can help unravel mechanisms of (de)stabilization.</p><p id="P36">The full stability diagram of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) is not of course a trivial superposition of the stability diagrams in Figs. <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>. Nonetheless, we recognize features of these diagrams in the stability diagrams of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) plotted in Fig. <xref ref-type="fig" rid="F5">5</xref>. It is therefore all the more striking that, for the same parameter values for which Fig. <xref ref-type="fig" rid="F5">5</xref> shows destabilization of coexistence due to responsive switching, the “one-parameter” diagrams show the possibility of stabilization of coexistence: Persister-competitor interactions [<italic>ι</italic> &gt; 0, Figs. <xref ref-type="fig" rid="F6">6(a),(b)</xref>] and persister growth [<italic>μ</italic> &gt; 0, Figs. <xref ref-type="fig" rid="F6">6(c),(d)</xref>] are stabilizing. Moreover, Figs. <xref ref-type="fig" rid="F7">7(a),(b)</xref> show a very slight destabilizing effect of competitor-persister interactions (<italic>ξ</italic> &gt; 0). Finally, the different types of competition between bacteria and persisters (<xref ref-type="table" rid="T1">Table I</xref>) correspond to the cases <italic>κ</italic> &gt; 0 [Figs. <xref ref-type="fig" rid="F6">6(e),(f)</xref>], <italic>ϖ</italic> &gt; 0 [Figs. <xref ref-type="fig" rid="F7">7(c),(d)</xref>], and <italic>ς</italic> &gt; 0 [Figs. <xref ref-type="fig" rid="F7">7(e),(f)</xref>]. They yield very similar stability diagrams and are neither stabilizing nor destabilizing for the generic parameter values used in Figs. <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>. Of the six persister parameters <italic>ι</italic>, <italic>μ</italic>, <italic>κ</italic>, <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ς</italic>, only the first two have thus, on their own, a strong effect on stability or permanence of coexistence when coupled to responsive switching.</p><p id="P37">This suggests that coexistence can be stabilized by tuning the persister parameters so that the stabilizing parameters <italic>ι</italic>, <italic>μ</italic> exceed the others, while still remaining “small”, as required by the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>). This is confirmed by the numerical results in Fig. <xref ref-type="fig" rid="F8">8</xref>. The stabilizing effect of “elevating” <italic>ι</italic>, <italic>μ</italic> is less pronounced for <italic>ϑ</italic> &lt; <italic>η</italic>/<italic>α</italic> [Fig. <xref ref-type="fig" rid="F8">8(a)</xref>] than for <italic>ϑ</italic> &gt; <italic>η</italic>/<italic>α</italic> [Fig. <xref ref-type="fig" rid="F8">8(b)</xref>], mirroring the weaker destabilizing effect of “unelevated” <italic>ι</italic>, <italic>μ</italic> in the former case.</p><p id="P38">How do we interpret this stabilization by elevated <italic>ι</italic>, <italic>μ</italic> in the context of our analysis based on a weakly-competing, persister-like phenotype P [Fig. <xref ref-type="fig" rid="F1">1(b)</xref>]? The “elevated” growth rate <italic>μ</italic> that stabilizes coexistence with responsive switching might correspond to a phenotype that relies on a different food source (and therefore competes weakly with both the normal phenotype B and the competitors A); the growth rate <italic>μ</italic> may still be small because the alternative food source may be scarce, or more difficult to metabolize. Similarly, an elevated, but small persister-competitor interaction rate <italic>ι</italic> may result from toxins produced by the persisters and acting specifically on the competitors. That the ecological fitness of the phenotypes we have just described should be linked to responsive switching in particular is not surprising.</p><p id="P39">The elevated growth and and interaction with competitors of this phenotype are consistent with a persister phenotype, because the corresponding parameters remain “small” in the sense of the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>). While the bacterial persister phenotype [<xref ref-type="bibr" rid="R16">16</xref>–<xref ref-type="bibr" rid="R18">18</xref>] is sometimes considered to be a dormant phenotype [<xref ref-type="bibr" rid="R37">37</xref>], small levels of growth or interaction with competitors are mathematically different from absence thereof. Our theoretical results stress this point by suggesting that even such phenotypes can contribute crucially to stability and permanence of coexistence in a microbial community.</p></sec><sec id="S11"><label>3</label><title>Analytical results</title><p id="P40">The full model (<xref ref-type="disp-formula" rid="FD6">4</xref>) does not allow meaningful analytical progress to be made. However, some of the effects of the parameters <italic>ι, μ, κ</italic> and hence some of the features in their stability diagrams (Fig. <xref ref-type="fig" rid="F6">6</xref>) and in the full stability diagram of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) in Fig. <xref ref-type="fig" rid="F5">5</xref> can be understood analytically. (We are not aware of similar analytical results for the other persister parameters <italic>ξ, ϖ, ς</italic>.) In <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref>, we derive and discuss these analytical results, which extend the classical results for the two-species Lotka–Volterra model [<xref ref-type="bibr" rid="R27">27</xref>] to the simplest mathematical models of responsive switching. Again, these “one-parameter” mathematical models are not “more minimal” ecological models than Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>), but they are sufficiently simple to allow analytical understanding of the numerical results that have led us to identifying the stabilizing phenotype discussed above. We shall postpone the detailed discussion of these analytical results to <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref>, but emphasize three of their features here.</p><p id="P41">First, the exact calculations show that there are regions of parameter space in which all steady states of the “one-parameter” models involving <italic>ι, μ, κ</italic> are unstable, but in which coexistence is still permanent. This emphasizes the importance of non-steady-state attractors for permanence of coexistence and stabilization of coexistence by responsive switching for these models and stresses how phenotypic switching increases the complexity of the dynamics: no limit cycles (and no more complex attractors) arise in classical two-species Lotka–Volterra competition model [<xref ref-type="bibr" rid="R27">27</xref>]. Thus analysis of the linear stability of the steady states (Ref. [<xref ref-type="bibr" rid="R27">27</xref>] and <xref ref-type="supplementary-material" rid="SD1">Appendix C</xref>) provides a complete biological picture of the community for the average model, but does not yield a similarly complete picture of a two-species community with phenotypic variation.</p><p id="P42">Second, these results and further calculations in <xref ref-type="supplementary-material" rid="SD1">Appendix C</xref> show that stochastic switching on its own does not affect the stability of coexistence in these models. Responsive switching can thus be stabilizing even when stochastic switching has no effect on stability. This statement can be extended numerically to the other “one-parameter” models and permanence of coexistence. Indeed, the “one-parameter” (de)stabilization diagrams comparing the stability or permanence of coexistence in the full model (<xref ref-type="disp-formula" rid="FD6">4</xref>) and in its average without phenotypic variation (not shown) are identical to those comparing Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) and its average with stochastic switching only (Figs. <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>, insets), so stochastic switching on its own does not even affect the permanence of coexistence in these “one-parameter” models. However, these results do not carry over to the full model (<xref ref-type="disp-formula" rid="FD6">4</xref>): the (de)stabilization diagrams for the comparison of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) and its average without phenotypic variation (not shown) are different from those in Figs. <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F8">8</xref>. From these numerical results, we can in fact conclude that elevated <italic>ι, μ</italic> as in Fig. <xref ref-type="fig" rid="F8">8</xref> also stabilize the averaged model with stochastic switching only compared to that without phenotypic variation.</p><p id="P43">Finally, the analytical results stress that even small rates of stochastic switching, <italic>β</italic> = <italic>O</italic> (<italic>ε</italic>), affect stability, but only if the B and A phenotypes are similar enough, as expressed by the scaling requirement <italic>η</italic> – <italic>αϑ</italic> ≲ <italic>O</italic> (<italic>ε</italic><sup>2</sup>). Our choice of allowing, in our numerical calculations, “large” values <italic>β</italic> = <italic>O</italic>(1), which are not consistent with the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>), is therefore one of numerical convenience that does not affect the biological validity of our analysis. The existence of such a requirement is not unexpected: an asymptotically rare phenotype P should not change the stability of communities in which one of the A and B phenotypes strongly dominates the other, i.e. <italic>η</italic> – <italic>αϑ</italic> = <italic>O</italic>(1). This case of strong dominance is perhaps less relevant to our analysis, because one expects such strong dominance to lead to one species simply outcompeting the other. By contrast, weak dominance of one species may build up the evolutionary pressure that could lead to the emergence of stabilizing features such as the responsive switching analyzed here. In this context, our earlier results in <xref ref-type="sec" rid="S2">Sec. II</xref> and in Ref. [<xref ref-type="bibr" rid="R15">15</xref>], showing that the effect of a rare phenotype is amplified as the number of species increases, might be relatable to a combinatorial and statistical increase of species interactions lacking such strong dominance.</p></sec></sec></sec><sec id="S12" sec-type="conclusions"><label>IV</label><title>Conclusion</title><p id="P44">In this paper, we have analyzed the ecological implications of phenotypic variation and, in particular, responsive phenotypic switching in the context of microbial communities in which the species have a rare, slowly growing and weakly competing, persister-like phenotype. We have shown that the statistical properties of stability and permanence of coexistence are different in models with responsive phenotypic switching and in corresponding averaged models with stochastic phenotypic switching only, and we have emphasized the need to define these averaged models carefully. Although this statistical analysis showed that coexistence is less likely to be stable on average with responsive switching than with stochastic switching only, numerical results for a minimal two-species model revealed those parameters (and hence the ecological conditions) in combination with which responsive switching can stabilize two-species communities. Exact results for simplified mathematical models showed further that responsive switching can stabilize coexistence even when stochastic switching on its own does not affect the stability of the community. Additionally, our numerical results emphasized the importance of non-steady-state attractors for coexistence of all species, even for the simplified two-species models, but analytical understanding of these attractors is still lacking.</p><p id="P45">All of our results thus hint at a complex relationship between ecological stability and phenotypic variation, of which this and previous studies [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R15">15</xref>] have only scratched the surface. Focusing, as we did in this paper, on a minimal twophenotype structure with the asymptotic separation afforded by a rare, persister-like phenotype has enabled more detailed and mechanistic understanding. However, extending these results to many-species systems and more general phenotypic structures remains an important challenge for future work. Reference [<xref ref-type="bibr" rid="R14">14</xref>] has already begun to address these questions in the context of stochastic phenotypic switching, but to understand which phenotypic interactions stabilize or destabilize manyspecies systems, further analytical progress, for simple models of communities of more than two species, will be crucial to guide statistical exploration of many-species systems due to the quadratic increases of the number of interaction parameters with the number of species. Such analytical progress may benefit from the information-theoretic approaches used in evolutionary population dynamics [<xref ref-type="bibr" rid="R38">38</xref>, <xref ref-type="bibr" rid="R39">39</xref>]. Moreover, now that a range of stability-affecting structures of microbial communities, from phenotypic variation (this work and Refs. [<xref ref-type="bibr" rid="R14">14</xref>, <xref ref-type="bibr" rid="R15">15</xref>]) and species modularity [<xref ref-type="bibr" rid="R6">6</xref>] to higher-order interactions [<xref ref-type="bibr" rid="R7">7</xref>] or resource and signaling dynamics [<xref ref-type="bibr" rid="R8">8</xref>, <xref ref-type="bibr" rid="R29">29</xref>], has been identified, further theoretical work will need to analyze the interplay of such effects and ask: Which of these effects (if any) dominates the overturning of May’s stability paradigm [<xref ref-type="bibr" rid="R1">1</xref>] in actual ecological communities?</p><p id="P46">The deterministic equations in this paper describe well-mixed populations, with the deterministic parameter that we call the stochastic switching rate representing a mean over individual, stochastic events of phenotypic switching. For a rare phenotype such as the persister phenotype, this approximation may break down because persister abundances may be small not only in relative terms [<xref ref-type="bibr" rid="R30">30</xref>], but also in absolute terms [<xref ref-type="bibr" rid="R40">40</xref>]. Future work will need to address more generally such stochastic effects in simulations resolving individual rare stochastic events to disentangle their contributions to the stability of ecological communities and the contributions of their mean deterministic behavior, as studied in this paper.</p><p id="P47">Meanwhile, our work has predicted that the combination of responsive switching to a rare persister-like phenotype and its slow growth and weak interaction with competitors can favor coexistence in microbial communities. This ecological prediction remains to be tested experimentally and the weak growth, interaction with competitors, and responsive switching rates of persisters remain to be quantified in microbial communities. Some experimentally support for the importance of this parameter combination might already be given by the recent work [<xref ref-type="bibr" rid="R26">26</xref>] showing that a non-reproducing subpopulation of <italic>P. aeruginosa</italic> releases bacteriocins while migrating up antibiotic gradients. More importantly, these experiments emphasize the role of spatial dynamics in the response to antibiotic stress. Future theoretical work will therefore also need to add such spatial dynamics into the models that we have analyzed here.</p><p id="P48">More generally, identifying experimental systems in which the role of responsive phenotypic switching can be addressed experimentally is another key challenge for future work. In particular, experimental systems for these questions must allow disentangling the effect of responsive phenotypic switching, say, and the effect of the change of the equilibrium population that results from “turning off” responsive switching. This is precisely the problem that we highlighted when discussing reduced models and solved, theoretically, by defining averaged models for stability comparison. By introducing these averaged models, we have been able to make complex, albeit mathematical ecological perturbations. It is this ability that explains the power of theoretical approaches for guiding experimental exploration of problems in ecology. For this reason, the importance of these theoretical approaches mirrors the outstanding importance of microbial communities [<xref ref-type="bibr" rid="R41">41</xref>]—and hence that of understanding the biological and mathematical effects that stabilize or destabilize them—for the world that surrounds us.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Appendix</label><media xlink:href="EMS146032-supplement-Supplementary_Appendix.pdf" mimetype="application" mime-subtype="pdf" id="d19aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S13"><title>Acknowledgments</title><p>We thank B. G. Stokell for a conversation on confidence intervals. This work was supported in part by the Schlumberger Chair Fund. R.E.G. was supported by Established Career Fellowship No. EP/M017982/1 from the Engineering and Physical Sciences Research Council and Grant No. 7523 from the Marine Microbiology Initiative of the Gordon and Betty Moore Foundation. N.M.O. was supported by Discovery Fellowship No. BB/T009098/1 from the Biotechnology and Biological Sciences Research Council, a Wellcome Trust Interdisciplinary Fellowship, and, at earlier stages of this work, a Herchel Smith Postdoctoral Research Fellowship. P.A.H. was supported by the Max Planck Society, and, at earlier stages of this work, by a Nevile Research Fellowship from Magdalene College, Cambridge and a Hooke Research Fellowship at the Mathematical Institute, University of Oxford.</p></ack><ref-list><ref id="R1"><label>[1]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>May</surname><given-names>RM</given-names></name></person-group><article-title>Will a large complex system be stable?</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>1972</year><volume>238</volume><fpage>413</fpage></element-citation></ref><ref id="R2"><label>[2]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Servan</surname><given-names>CA</given-names></name><name><surname>Capitan</surname><given-names>JA</given-names></name><name><surname>Grilli</surname><given-names>J</given-names></name><name><surname>Morrison</surname><given-names>KE</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><article-title>Coexistence of many species in random ecosystems</article-title><source>Nat Ecol Evol</source><year>2018</year><volume>2</volume><fpage>1237</fpage></element-citation></ref><ref id="R3"><label>[3]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Allesina</surname><given-names>S</given-names></name><name><surname>Tang</surname><given-names>S</given-names></name></person-group><article-title>Stability criteria for complex ecosystems</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2012</year><volume>483</volume><fpage>205</fpage></element-citation></ref><ref id="R4"><label>[4]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mougi</surname><given-names>A</given-names></name><name><surname>Kondoh</surname><given-names>M</given-names></name></person-group><article-title>Diversity of interaction types and ecological community stability</article-title><source>Science</source><year>2012</year><volume>337</volume><fpage>349</fpage></element-citation></ref><ref id="R5"><label>[5]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coyte</surname><given-names>KZ</given-names></name><name><surname>Schluter</surname><given-names>J</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>The ecology of the microbiome: Networks, competition, and stability</article-title><source>Science</source><year>2015</year><volume>350</volume><fpage>663</fpage></element-citation></ref><ref id="R6"><label>[6]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grilli</surname><given-names>J</given-names></name><name><surname>Rogers</surname><given-names>T</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><article-title>Modularity and stability in ecological communities</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><elocation-id>12031</elocation-id></element-citation></ref><ref id="R7"><label>[7]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Grilli</surname><given-names>J</given-names></name><name><surname>Barabas</surname><given-names>G</given-names></name><name><surname>Michalska-Smith</surname><given-names>MJ</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><article-title>Higher-order competitive interactions stabilize dynamics in competitive network models</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2017</year><volume>548</volume><fpage>210</fpage></element-citation></ref><ref id="R8"><label>[8]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>S</given-names></name><name><surname>O’Dwyer</surname><given-names>JP</given-names></name></person-group><article-title>Stability criteria for complex microbial communities</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><elocation-id>2970</elocation-id></element-citation></ref><ref id="R9"><label>[9]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>A</given-names></name></person-group><article-title>The stability of a feasible random ecosystem</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>1974</year><volume>251</volume><fpage>607</fpage></element-citation></ref><ref id="R10"><label>[10]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grilli</surname><given-names>J</given-names></name><name><surname>Adorisio</surname><given-names>M</given-names></name><name><surname>Suweis</surname><given-names>S</given-names></name><name><surname>Barabas</surname><given-names>G</given-names></name><name><surname>Banavar</surname><given-names>JR</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name><name><surname>Maritan</surname><given-names>A</given-names></name></person-group><article-title>Feasibility and coexistence of large ecological communities</article-title><source>Nat Commun</source><year>2017</year><volume>8</volume><elocation-id>14389</elocation-id></element-citation></ref><ref id="R11"><label>[11]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibbs</surname><given-names>T</given-names></name><name><surname>Grilli</surname><given-names>J</given-names></name><name><surname>Rogers</surname><given-names>T</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><article-title>Effect of population abundances on the stability of large random ecosystems</article-title><source>Phys Rev E</source><year>2018</year><volume>98</volume><elocation-id>022410</elocation-id></element-citation></ref><ref id="R12"><label>[12]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>L</given-names></name></person-group><article-title>The feasibility and stability of large complex biological networks: a random matrix approach</article-title><source>Sci Rep</source><year>2018</year><volume>8</volume><elocation-id>8246</elocation-id></element-citation></ref><ref id="R13"><label>[13]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barron</surname><given-names>JW</given-names></name><name><surname>Galla</surname><given-names>T</given-names></name></person-group><article-title>Dispersal-induced instability in complex ecosystems</article-title><source>Nat Commun</source><year>2020</year><volume>11</volume><elocation-id>6032</elocation-id></element-citation></ref><ref id="R14"><label>[14]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maynard</surname><given-names>DS</given-names></name><name><surname>Serván</surname><given-names>CA</given-names></name><name><surname>Capitán</surname><given-names>JA</given-names></name><name><surname>Allesina</surname><given-names>S</given-names></name></person-group><article-title>Phenotypic variability promotes diversity and stability in competitive communities</article-title><source>Ecol Lett</source><year>2019</year><volume>22</volume><fpage>1776</fpage></element-citation></ref><ref id="R15"><label>[15]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>PA</given-names></name><name><surname>Oliveira</surname><given-names>NM</given-names></name><name><surname>Goldstein</surname><given-names>RE</given-names></name></person-group><article-title>Subpopulations and stability in microbial communities</article-title><source>Phys Rev Research</source><year>2020</year><volume>2</volume><elocation-id>022036(R)</elocation-id></element-citation></ref><ref id="R16"><label>[16]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maisonneuve</surname><given-names>E</given-names></name><name><surname>Gerdes</surname><given-names>K</given-names></name></person-group><article-title>Molecular mechanisms underlying bacterial persisters</article-title><source>Cell</source><year>2014</year><volume>157</volume><fpage>539</fpage></element-citation></ref><ref id="R17"><label>[17]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harms</surname><given-names>A</given-names></name><name><surname>Maisonneuve</surname><given-names>E</given-names></name><name><surname>Gerdes</surname><given-names>K</given-names></name></person-group><article-title>Mechanisms of bacterial persistence during stress and antibiotic exposure</article-title><source>Science</source><year>2016</year><volume>354</volume><elocation-id>aaf4268</elocation-id></element-citation></ref><ref id="R18"><label>[18]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radzikowski</surname><given-names>JL</given-names></name><name><surname>Schramke</surname><given-names>H</given-names></name><name><surname>Heinemann</surname><given-names>M</given-names></name></person-group><article-title>Bacterial persistence from a system-level perspective</article-title><source>Curr Opin Biotechnol</source><year>2017</year><volume>46</volume><fpage>98</fpage></element-citation></ref><ref id="R19"><label>[19]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kussell</surname><given-names>E</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name></person-group><article-title>Phenotypic diversity, population growth, and information in fluctuating environments</article-title><source>Science</source><year>2005</year><volume>309</volume><fpage>2075</fpage></element-citation></ref><ref id="R20"><label>[20]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>DI</given-names></name><name><surname>Hughes</surname><given-names>D</given-names></name></person-group><article-title>Microbiological effects of sublethal levels of antibiotics</article-title><source>Nat Rev Microbiol</source><year>2014</year><volume>12</volume><fpage>465</fpage></element-citation></ref><ref id="R21"><label>[21]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balaban</surname><given-names>NQ</given-names></name><name><surname>Merrin</surname><given-names>J</given-names></name><name><surname>Chait</surname><given-names>R</given-names></name><name><surname>Kowalik</surname><given-names>L</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name></person-group><article-title>Bacterial persistence as a phenotypic switch</article-title><source>Science</source><year>2004</year><volume>305</volume><fpage>1622</fpage></element-citation></ref><ref id="R22"><label>[22]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kerr</surname><given-names>B</given-names></name><name><surname>Riley</surname><given-names>MA</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Bohannan</surname><given-names>BJM</given-names></name></person-group><article-title>Local dispersal promotes biodiversity in a real-life game of rock-paper-scissors</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2002</year><volume>418</volume><fpage>171</fpage></element-citation></ref><ref id="R23"><label>[23]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Czaran</surname><given-names>TL</given-names></name><name><surname>Hoekstra</surname><given-names>RF</given-names></name><name><surname>Pagie</surname><given-names>L</given-names></name></person-group><article-title>Chemical warfare between microbes promotes biodiversity</article-title><source>Proc Natl Acad Sci USA</source><year>2002</year><volume>99</volume><fpage>786</fpage></element-citation></ref><ref id="R24"><label>[24]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kirkup</surname><given-names>BC</given-names></name><name><surname>Riley</surname><given-names>MA</given-names></name></person-group><article-title>Antibiotic-mediated antagonism leads to a bacterial game of rock–paper–scissors <italic>in vivo</italic></article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2004</year><volume>428</volume><fpage>412</fpage></element-citation></ref><ref id="R25"><label>[25]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Reichenbach</surname><given-names>T</given-names></name><name><surname>Mobilia</surname><given-names>M</given-names></name><name><surname>Frey</surname><given-names>E</given-names></name></person-group><article-title>Mobility promotes and jeopardizes biodiversity in rock-paper-scissor games</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2007</year><volume>448</volume><fpage>1046</fpage></element-citation></ref><ref id="R26"><label>[26]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira</surname><given-names>NM</given-names></name><name><surname>Wheeler</surname><given-names>JHR</given-names></name><name><surname>Deroy</surname><given-names>C</given-names></name><name><surname>Booth</surname><given-names>SC</given-names></name><name><surname>Walsh</surname><given-names>EJ</given-names></name><name><surname>Durham</surname><given-names>WM</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><article-title>Suicidal chemotaxis in bacteria</article-title><source>bioRxiv</source><year>2021</year><elocation-id>2021.12.21.473623v3</elocation-id></element-citation></ref><ref id="R27"><label>[27]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Murray</surname><given-names>JD</given-names></name></person-group><source>Mathematical Biology</source><edition>3rd ed</edition><publisher-name>Springer</publisher-name><publisher-loc>Berlin Germany</publisher-loc><year>2002</year><volume>I</volume><fpage>79</fpage><lpage>118</lpage><comment>Chap. 3, Appendices 501-511</comment></element-citation></ref><ref id="R28"><label>[28]</label><note><p>We imply, in Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>) and throughout Sec. <xref ref-type="sec" rid="S2">II</xref> and Appendix <xref ref-type="supplementary-material" rid="SD1">A</xref>, elementwise multiplication of vectors and rows or columns of matrices by writing the corresponding symbols next to each other and reserve dots to denote matrix multiplication</p></note></ref><ref id="R29"><label>[29]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kelsic</surname><given-names>ED</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Vetsigian</surname><given-names>K</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><article-title>Counteraction of antibiotic production and degradation stabilizes microbial communities</article-title><source>Nature</source><publisher-loc>London</publisher-loc><year>2015</year><volume>521</volume><fpage>516</fpage></element-citation></ref><ref id="R30"><label>[30]</label><note>
<p>Relative persister abundances are typically very small, say ε = 10<sup>–5</sup> for <italic>E. coli</italic> [<xref ref-type="bibr" rid="R21">21</xref>], but can vary widely, as reported by <element-citation publication-type="journal" id="d19aAeBadBbH"><person-group person-group-type="author"><name><surname>Hofsteenge</surname><given-names>N</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name><name><surname>Silander</surname><given-names>OK</given-names></name></person-group><article-title>Quantitative analysis of persister fractions suggests different mechanisms of formation among environmental isolates of <italic>E. coli</italic></article-title><source>BMC Microbiol</source><year>2013</year><volume>13</volume><fpage>25</fpage></element-citation>
</p>
</note><note><p>The value ε -0.01 used in Figs. <xref ref-type="fig" rid="F2">2</xref>–<xref ref-type="fig" rid="F4">4</xref> is towards the upper end of the experimental range for <italic>E. coli</italic> in culture (<italic>vide ibid</italic>.), but typical for P. aeruginosa biofilms <element-citation publication-type="book" id="d19aAeBadCaJ"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>K</given-names></name></person-group><chapter-title>Multidrug tolerance of biofilms and persister cells</chapter-title><person-group person-group-type="editor"><name><surname>Romeo</surname><given-names>T</given-names></name></person-group><source>Bacterial Biofilms, Current Topics in Microbiology and Immunology</source><publisher-loc>Berlin, German</publisher-loc><publisher-name>Springer</publisher-name><year>2008</year><fpage>107</fpage><lpage>131</lpage></element-citation>
</p>
</note><note><p>Anyway, the mechanism underlying the differences between ε = 0 and ε ≪ 1 thar we have identified in Ref. [<xref ref-type="bibr" rid="R15">15</xref>] is generic, which justifies choosing ε = 0.01 for numerical convenience.</p></note></ref><ref id="R31"><label>[15]</label><note><p>The confidence intervals computed for Figs. <xref ref-type="fig" rid="F2">2(a),(b)</xref>, <xref ref-type="fig" rid="F3">3</xref>, <xref ref-type="fig" rid="F4">4</xref> are Wilson intervals [see, e.g., <element-citation publication-type="journal" id="d19aAeBaeBaH"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>LD</given-names></name><name><surname>Cai</surname><given-names>TT</given-names></name><name><surname>Das-Gupta</surname><given-names>A</given-names></name></person-group><article-title>Interval estimation for a binomial proportion</article-title><source>Stat Sci</source><year>2001</year><volume>16</volume><fpage>101</fpage></element-citation>
</p>
</note><note>
<p>those computed for Fig. <xref ref-type="fig" rid="F2">2(c)</xref> are derived from the Fieller-type statistic introduced by <element-citation publication-type="journal" id="d19aAeBaeCbD"><person-group person-group-type="author"><name><surname>Nam</surname><given-names>J-m</given-names></name><name><surname>Blackwelder</surname><given-names>WC</given-names></name></person-group><article-title>Analysis of the ratio of marginal probabilities in a matched-pair setting</article-title><source>Stat Med</source><year>2002</year><volume>21</volume><fpage>689</fpage></element-citation>
</p>
</note></ref><ref id="R32"><label>[32]</label><note><p>We will use “permanent coexistence” rather loosely to mean the alternative to extinction of one or more species, but note that different mathematical definitions, some of which go (rather unhelpfully in the biological context of this paper) by the name of “persistence” rather than “permanence”, are associated with this concept in the dynamical systems literature: See, e.g., the definitions in Sec. 3 of <element-citation publication-type="journal" id="d19aAeBafBaB"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>G</given-names></name><name><surname>Waltman</surname><given-names>P</given-names></name></person-group><article-title>Persistence in dynamical systems</article-title><source>J Differ Equations</source><year>1986</year><volume>63</volume><fpage>255</fpage></element-citation>
</p>
</note><note><p>and the related discussion in Sec. 2 of<element-citation publication-type="journal" id="d19aAeBafCaB"><person-group person-group-type="author"><name><surname>Hutson</surname><given-names>V</given-names></name><name><surname>Vickers</surname><given-names>G</given-names></name></person-group><article-title>A criterion for permanent coexistence of species, with an application to a two-prey one-predator system</article-title><source>Math Biosci</source><year>1983</year><volume>63</volume><fpage>253</fpage></element-citation>
</p>
</note></ref><ref id="R33"><label>[33]</label><note><p>The name “bacteria” which we use to have a simple way of referring to phenotype B is of course not strictly biologically accurate because the persisters (phenotype P) and competitors (phenotype A) are biologically bacteria too.</p></note></ref><ref id="R34"><label>[34]</label><note><p>The variables <bold><italic>B</italic></bold>and <bold><italic>P</italic></bold>in Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) must be nondimensionalized using the same dimensional scalings lest the switching terms in Eqs. (4a) and (4b) become unbalanced. We could have chosen a different scaling for <bold><italic>A</italic></bold>in Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) from that of <bold><italic>B</italic></bold>and <bold><italic>P</italic></bold>to set e.g. α = 1, but equal scalings make comparing competition strengths easier. In the same spirit, we have reused the dimensional scalings from Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) to nondimensionalize <bold><italic>B</italic></bold>’, <bold><italic>A</italic></bold>’ in the averaged model described by Eqs. (C1) to avoid having to unravel different dimensional scalings when writing down the consistency conditions expressed by Eqs. (C6).</p></note></ref><ref id="R35"><label>[35]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>DA</given-names></name><name><surname>Little</surname><given-names>J</given-names></name><name><surname>O’Shea</surname><given-names>D</given-names></name></person-group><source>Using Algebraic Geometry try, Graduate Texts in Mathematics</source><edition>2nd ed</edition><publisher-name>Springer</publisher-name><publisher-loc>Berlin, Germany</publisher-loc><comment>Chap. 2</comment><year>2005</year><volume>185</volume><fpage>26</fpage><lpage>76</lpage></element-citation></ref><ref id="R36"><label>[36]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yap</surname><given-names>C-K</given-names></name></person-group><source>Fundamental Problems in Algorithmic Algebra</source><publisher-name>Oxford University Press</publisher-name><publisher-loc>Oxford, England</publisher-loc><year>2000</year><fpage>141</fpage><lpage>218</lpage><comment>Chap. 6, Chap. 7</comment></element-citation></ref><ref id="R37"><label>[37]</label><note><p>Whether persisters are dormant is still a subject of debate in the microbiological literature: See, e.g., <element-citation publication-type="journal" id="d19aAeBakBaB"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>TK</given-names></name><name><surname>Knabel</surname><given-names>SJ</given-names></name><name><surname>Kwan</surname><given-names>BW</given-names></name></person-group><article-title>Bacterial persister cell formation and dormancy</article-title><source>Appl Environ Microbiol</source><year>2013</year><volume>79</volume><fpage>7116</fpage></element-citation>
<element-citation publication-type="journal" id="d19aAeBakBaD"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>J</given-names></name><name><surname>Peng</surname><given-names>B</given-names></name><name><surname>Qu</surname><given-names>J</given-names></name><name><surname>Zheng</surname><given-names>J</given-names></name></person-group><article-title>Are bacterial persisters dormant cells only?</article-title><source>Front Microbiol</source><year>2022</year><volume>12</volume><elocation-id>708580</elocation-id></element-citation>
</p>
</note></ref><ref id="R38"><label>[38]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivoire</surname><given-names>O</given-names></name></person-group><article-title>Informations in models of evolutionary dynamics</article-title><source>J Stat Phys</source><year>2016</year><volume>162</volume><fpage>1324</fpage></element-citation></ref><ref id="R39"><label>[39]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Guan</surname><given-names>S</given-names></name><name><surname>Shi</surname><given-names>H</given-names></name></person-group><article-title>Information geometry in the population dynamics of bacteria</article-title><source>J Stat Mech Theory Exp</source><volume>2020</volume><issue>7</issue><elocation-id>073501</elocation-id></element-citation></ref><ref id="R40"><label>[40]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raynaud</surname><given-names>X</given-names></name><name><surname>Nunan</surname><given-names>N</given-names></name></person-group><article-title>Spatial ecology ofbacteria at the microscale in soil</article-title><source>PLoS ONE</source><year>2014</year><volume>9</volume><elocation-id>e87217</elocation-id><comment>estimate that bacteria in soil communities interact with at most <bold><italic>O</italic></bold>(10<sup>3</sup>) neighbors, so the low relative persister abundances [30] mean that, even if the community counts many fewer than the <bold><italic>O</italic></bold>(10<sup>4</sup>) species typical for soil communities (<italic>vide ibid</italic>.), interactions with persisters are rare stochastic events in such communities</comment></element-citation></ref><ref id="R41"><label>[41]</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stubbendieck</surname><given-names>RM</given-names></name><name><surname>Vargas-Bautista</surname><given-names>C</given-names></name><name><surname>Straight</surname><given-names>PD</given-names></name></person-group><article-title>Bacterial communities: Interactions to scale</article-title><source>Front Microbiol</source><year>2016</year><volume>7</volume><elocation-id>1234</elocation-id></element-citation></ref><ref id="R42"><label>[42]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Parker</surname><given-names>TS</given-names></name><name><surname>Chua</surname><given-names>LO</given-names></name></person-group><source>Practical Numerical Algorithms for Chaotic Systems</source><publisher-name>Springer</publisher-name><publisher-loc>New York, NY</publisher-loc><year>1989</year><comment>Chap. 3.2, Chap. 5.5, and App. B, pp. 61–66, 118–131, and 305–306</comment></element-citation></ref><ref id="R43"><label>[43]</label><note><p>The approach of proving permanence by “chasing” possible limit sets in this way has also been used for general three-species Lotka–Volterra systems without phenotypic variation: See, e.g., <element-citation publication-type="journal" id="d19aAeBaqBaB"><person-group person-group-type="author"><name><surname>Freedman</surname><given-names>HI</given-names></name><name><surname>Waltman</surname><given-names>P</given-names></name></person-group><article-title>Persistence in a model of three competitive populations</article-title><source>Math Biosci</source><year>1958</year><volume>73</volume><fpage>89</fpage></element-citation>
<element-citation publication-type="journal" id="d19aAeBaqBaD"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>GJ</given-names></name><name><surname>Waltman</surname><given-names>P</given-names></name></person-group><article-title>Persistence in three-dimensional Lotka–Volterra systems</article-title><source>Math Comput Model</source><year>1988</year><volume>10</volume><fpage>13</fpage></element-citation>
</p>
</note><note><p>A more general approach for establishing permanence involves identifying an appropriate “averaged Lyapunov function” [see, e.g., <element-citation publication-type="book" id="d19aAeBaqCaB"><person-group person-group-type="author"><name><surname>Hofbauer</surname><given-names>J</given-names></name><name><surname>Sigmund</surname><given-names>K</given-names></name></person-group><chapter-title>Permanence for replicator equations</chapter-title><person-group person-group-type="editor"><name><surname>Kurzhanski</surname><given-names>AB</given-names></name><name><surname>Sigmund</surname><given-names>K</given-names></name></person-group><source>Dynamical Systems, Lecture Notes in Economics and Mathematical Systems</source><year>1987</year><volume>287</volume><fpage>70</fpage><lpage>92</lpage></element-citation></p>
</note><note><p>but the corresponding general results (vide ibid.) cannot directly be applied to the systems with phenotypic switching considered here, because, for the two-species model (<xref ref-type="disp-formula" rid="FD1">4</xref>) and its simplified versions (B1), (B2), (B3), <italic>B˙/B</italic> and <italic>P˙/P</italic> diverge at <italic>B</italic> = 0 and <italic>P</italic> = 0, respectively.</p>
</note></ref><ref id="R44"><label>[44]</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Glendinning</surname><given-names>P</given-names></name></person-group><source>Stability Instability and Chaos: An Introduction to the Theory of Nonlinear Differential Equations</source><publisher-name>Cambridge University Press</publisher-name><publisher-loc>Cambridge, UK</publisher-loc><year>1994</year><fpage>102</fpage><lpage>144</lpage><comment>Chap. 5</comment></element-citation></ref></ref-list></back><floats-group><fig id="F1" position="float"><label>FIG. 1</label><caption><title>Models of stochastic and responsive phenotypic switching.</title><p>(a) In the model of <xref ref-type="sec" rid="S2">Sec. II</xref>, each species has two phenotypes, B and P, and switches stochastically between them. Moreover, the B phenotype of each species responds to other species by switching to the P phenotype. (b) In the minimal two-species model of <xref ref-type="sec" rid="S6">Sec. III</xref>, the second species has a single competitor phenotype A, which causes B to switch to P. Dashed lines: stochastic switching. Solid lines: responsive switching.</p></caption><graphic xlink:href="EMS146032-f001"/></fig><fig id="F2" position="float"><label>FIG. 2</label><caption><title>Stability of random microbial communities with responsive phenotypic switching.</title><p>(a) Probability of a random equilibrium that is stable in the model with responsive switching <inline-formula><mml:math id="M13"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>)] or in the model with stochastic switching only <inline-formula><mml:math id="M14"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>)] being unstable in the other model, as a function of the number <bold><italic>N</italic></bold> of species in the system. (b) Same plot, but focused on low probabilities. (c) Ratio of the probabilities of random equilibria of <inline-formula><mml:math id="M15"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M16"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> being stable. Inset: same plot, focused on small probability differences. Probabilities were estimated from up to 5 · 10<sup>8</sup> random systems each. Parameter values: <italic>ε</italic> = 1 and <italic>ε</italic> = 0.01 [<xref ref-type="bibr" rid="R30">30</xref>]; for the latter value, both exact and asymptotic equilibria were computed. Error bars are 95% confidence intervals [<xref ref-type="bibr" rid="R31">31</xref>] larger than the plot markers.</p></caption><graphic xlink:href="EMS146032-f002"/></fig><fig id="F3" position="float"><label>FIG. 3</label><caption><p>Distributions, in the models with responsive switching <inline-formula><mml:math id="M17"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>)] or with stochastic switching only <inline-formula><mml:math id="M18"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>)], of the long-time dynamics of unstable equilibria that are stable in the other model. Distributions are shown for exact equilibria with (a) <italic>ε</italic> = 1, (b) <italic>ε</italic> = 0.01 [<xref ref-type="bibr" rid="R30">30</xref>], and different numbers of species <italic>N</italic>. Each distribution was estimated by numerical integration of up to 5 · 10<sup>3</sup> unstable systems. For a small proportion of the systems (#), the numerical solution did not converge. Vertical bars represent 95% confidence intervals [<xref ref-type="bibr" rid="R31">31</xref>].</p></caption><graphic xlink:href="EMS146032-f003"/></fig><fig id="F4" position="float"><label>FIG. 4</label><caption><title>Permanent coexistence in random microbial communities with responsive phenotypic switching.</title><p>(a) Probability, in the models with responsive switching <inline-formula><mml:math id="M19"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD1">1</xref>)] and with stochastic switching only <inline-formula><mml:math id="M20"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> [Eqs. (<xref ref-type="disp-formula" rid="FD3">2</xref>)], of extinction of some species of a random system perturbed away from an equilibrium that is stable in the other model, as a function of the number of species in the system, <italic>N</italic>. (b) Same plot, but focused on low probabilities. Exact equilibria were obtained for <italic>ε</italic> = 1 and <italic>ε</italic> = 0.01 [<xref ref-type="bibr" rid="R30">30</xref>]. Each probability was computed from up to 5 · 10<sup>8</sup> random systems and up to 5 · 10<sup>3</sup> random systems having an equilibrium with different stability in models <inline-formula><mml:math id="M21"><mml:mi mathvariant="script">R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M22"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula>. Thick error bars correct the estimated probabilities for the systems in which the numerical solution of the long-time behavior did not converge (Fig. <xref ref-type="fig" rid="F3">3</xref>); thin error bars add 95% confidence intervals [<xref ref-type="bibr" rid="R31">31</xref>]. Only those error bars larger than the plot markers are shown.</p></caption><graphic xlink:href="EMS146032-f004"/></fig><fig id="F5" position="float"><label>FIG. 5</label><caption><p>Numerical stability diagrams of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) in the (<italic>ζ</italic>, <italic>β</italic>) diagramin the cases (a) <italic>η</italic>/<italic>α</italic> &gt; <italic>ϑ</italic> and (b) <italic>η</italic>/<italic>α</italic> &lt; <italic>ϑ</italic>. The color of each point in the stability diagrams represents the proportion of <italic>N</italic> = 1000 random systems for which coexistence is stable or permanent at that point. The insets plot the proportion of systems for which coexistence is destabilized, ⊖, compared to the averaged model with stochastic switching only. The symbol ⊕ in parentheses [panel (b), inset] indicates that a nonzero proportion of systems (too small to be visualizable by the color scheme) is stabilized (or becomes permanent) compared to the averaged model. Parameter values: <italic>α</italic> = 0.8, <italic>η</italic> = 1.2, <italic>ϑ</italic> = 1.1 [panel (a)] or <italic>ϑ</italic> = 1.9 [panel (b)], <inline-formula><mml:math id="M23"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>ι</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϖ</mml:mi><mml:mo>,</mml:mo><mml:mi>ς</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>ε</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> with <italic>ε</italic> = 0.1, and <inline-formula><mml:math id="M24"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>1.6</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="EMS146032-f005"/></fig><fig id="F6" position="float"><label>FIG. 6</label><caption><title>Effect of the parameters <italic>ι, μ, δ,</italic> on the stability and permanence of coexistence.</title><p>Numerical stability and permanence results for Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) if only one of the persister parameters <italic>ι, κ, μ, ξ, ϖ, ς</italic> is nonzero: <italic>ι</italic> &gt; 0 [panels (a), (b)], <italic>μ</italic> &gt; 0 [panels (c), (d)], <italic>κ</italic> &gt; 0 [panels (e), (f)]. The analytical results in <xref ref-type="supplementary-material" rid="SD1">Appendix B</xref> confirm some of these results. The cases <italic>η</italic>/<italic>α</italic> &gt; <italic>ϑ</italic> [panels (a), (c), (e)] and <italic>η</italic>/<italic>α</italic> &gt; <italic>ϑ</italic> [panels (b), (d), (f)] lead to qualitatively different diagrams. The color of each point in the stability diagrams represents the proportion of <italic>N</italic> = 1000 random systems for which coexistence is stable or permanent at that point. The insets similarly plot the proportion of systems for which coexistence is stabilized (or becomes permanent), ⊕, or destabilized, ⊖, compared to the averaged model with stochastic switching only; there is no (de)stabilization where there is no inset. Parameter values: <italic>α</italic> = 0.8, <italic>η</italic> = 1.2, and <italic>ϑ</italic> = 1.1 [panels (a), (c), (e)] or <italic>ϑ</italic> = 1.9 [panels (b), (d), (f)]. The remaining parameters (if not set to zero) were sampled uniformly and independently, constrained by the persister scalings (<xref ref-type="disp-formula" rid="FD9">5</xref>): <inline-formula><mml:math id="M25"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>ι</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϖ</mml:mi><mml:mo>,</mml:mo><mml:mi>ς</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>ε</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> with <italic>ε</italic> = 0.1, and <inline-formula><mml:math id="M26"><mml:mi>δ</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>1.6</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula></p></caption><graphic xlink:href="EMS146032-f006"/></fig><fig id="F7" position="float"><label>FIG. 7</label><caption><title>Effect of the parameters <italic>ξ</italic>, <italic>ϖ</italic>, <italic>ς</italic> on the stability and permanence of coexistence.</title><p>Numerical stability and permanence results for Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) if only one of the persister parameters <italic>ι, κ, μ, ξ, ϖ, ς</italic> is nonzero: <italic>ξ</italic> &gt; 0 [panels (a), (b)], <italic>ϖ</italic> &gt; 0 [panels (c), (d)], <italic>ς</italic> &gt; 0 [panels (e), (f)]. Panels (a), (c), (e) have <italic>η</italic>/<italic>α</italic> &gt; <italic>ϑ</italic> while panels (b), (d), (f) have <italic>η</italic>/<italic>α</italic> &lt; <italic>ϑ</italic> Plots are analogous to and parameter values are equal to those in Fig. <xref ref-type="fig" rid="F6">6</xref>.</p></caption><graphic xlink:href="EMS146032-f007"/></fig><fig id="F8" position="float"><label>FIG. 8</label><caption><p>Stabilization of coexistence by “elevated” persister growth <italic>μ</italic> or persister-competitor interaction <italic>ι</italic>. Plots, in (<italic>ζ, β</italic>) space and for (a) <italic>η</italic>/<italic>α</italic> &gt; <italic>ϖ</italic> and (b) <italic>η</italic>/<italic>α</italic> &lt; <italic>ϖ</italic>, of the proportion of <italic>N</italic> = 1000 random instantiations of Eqs. (<xref ref-type="disp-formula" rid="FD6">4</xref>) for which coexistence is stabilized (or becomes permanent), ⊕, or destabilized, ⊖, compared to the averaged model with stochastic switching only. Proportions are represented by the colors of the points in the diagrams, with symbols in parentheses indicating that the stability or permanence of a proportion of systems too small to be visualizable by the color scheme changes compared to the averaged model. The “elevation” of <italic>ι</italic>, <italic>μ</italic> increases from top to bottom. Parameter values: <italic>α</italic> = 0.8, <italic>η</italic> = 1.2, (a) <italic>ϑ</italic> = 1.1 or (b) <italic>ϑ</italic> = 1.9, and <inline-formula><mml:math id="M27"><mml:mi>δ</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>1.6</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:math></inline-formula> as in Figs. <xref ref-type="fig" rid="F5">5</xref>–<xref ref-type="fig" rid="F7">7</xref>; also, <inline-formula><mml:math id="M28"><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϖ</mml:mi><mml:mo>,</mml:mo><mml:mi>ς</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>ε</mml:mi><mml:mtext>/</mml:mtext><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>ε</mml:mi><mml:mtext>/</mml:mtext><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ι</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>ε</mml:mi><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>ε</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:math></inline-formula> with <italic>ε</italic> = 0.1 and where <italic>ƒ</italic> ∈ “1 (top), 1.5, 2, 2.5 (bottom)” “elevates” the values of <italic>ι</italic>, <italic>μ</italic>.</p></caption><graphic xlink:href="EMS146032-f008"/></fig><table-wrap id="T1" orientation="portrait" position="float"><label>Table 1</label><caption><p>Parameters of the two-species model (<xref ref-type="disp-formula" rid="FD6">4</xref>), representing the interactions in Fig. <xref ref-type="fig" rid="F1">1(b)</xref>, and their interpretations. The parameters have been divided into three groups. Only one of the persister logistic parameters appears in each of the simplified models (<xref ref-type="supplementary-material" rid="SD1">B1</xref>), (<xref ref-type="supplementary-material" rid="SD1">B2</xref>), (<xref ref-type="supplementary-material" rid="SD1">B3</xref>).</p></caption><table frame="hsides" rules="groups"><thead><tr style="border-top: double"><th align="left" valign="top">group</th><th align="left" valign="top">parameter<sup><xref ref-type="table-fn" rid="TFN1">a</xref></sup></th><th align="left" valign="top">interpretation<sup><xref ref-type="table-fn" rid="TFN2">b</xref></sup></th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="4" style="writing-mode:tb-rl;writing-mode:vertical-rl;">competitor logistic parameters</td><td align="left" valign="top" style="border-top: solid thin">α</td><td align="left" valign="top" style="border-top: solid thin">magnitude of effect of B–A interaction on B</td></tr><tr><td align="left" valign="top">ζ</td><td align="left" valign="top">growth rate of A</td></tr><tr><td align="left" valign="top">η</td><td align="left" valign="top">strength of within-species competition of A</td></tr><tr><td align="left" valign="top">ϑ</td><td align="left" valign="top">magnitude of effect of B–A interaction on A</td></tr><tr><td align="center" valign="middle" rowspan="3" style="writing-mode:tb-rl;writing-mode:vertical-rl; border-top: solid thin">phenotypic switching rates</td><td align="left" valign="top" style="border-top: solid thin">β</td><td align="left" valign="top" style="border-top: solid thin">rate of responsive switching from B to P</td></tr><tr><td align="left" valign="top">γ</td><td align="left" valign="top">rate of stochastic switching from B to P</td></tr><tr><td align="left" valign="top">δ</td><td align="left" valign="top">rate of stochastic switching from P to B</td></tr><tr><td align="center" valign="middle" rowspan="6" style="writing-mode:tb-rl;writing-mode:vertical-rl; border-top: solid thin">persister logistic parameters</td><td align="left" valign="top" style="border-top: solid thin">ι</td><td align="left" valign="top" style="border-top: solid thin">magnitude of effect of P–A interaction on A</td></tr><tr><td align="left" valign="top">κ</td><td align="left" valign="top">magnitude of effect of B–P interaction on B</td></tr><tr><td align="left" valign="top">μ</td><td align="left" valign="top">growth rate of P</td></tr><tr><td align="left" valign="top">ξ</td><td align="left" valign="top">magnitude of effect of P–A interaction on P</td></tr><tr><td align="left" valign="top">ϖ</td><td align="left" valign="top">magnitude of effect of P–B interaction on P</td></tr><tr style="border-bottom: double"><td align="left" valign="top">ς</td><td align="left" valign="top">strength of within-species competition of P</td></tr></tbody></table><table-wrap-foot><fn id="TFN1"><label>a</label><p id="P49">The equations have been nondimensionalized by rescaling time and population abundances to remove two (dimensional) parameters, viz. the growth rate and the strength of the within-species competition of B.</p></fn><fn id="TFN2"><label>b</label><p id="P50">Phenotype abbreviations (B: bacteria; P: persisters; A: competitors) used in this column are as in Fig. <xref ref-type="fig" rid="F1">1 (b)</xref>.</p></fn></table-wrap-foot></table-wrap></floats-group></article>