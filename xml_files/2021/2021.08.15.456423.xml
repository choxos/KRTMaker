<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="preprint">
<?all-math-mml yes?>
<?use-mml?>
<?origin ukpmcpa?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">bioRxiv</journal-id>
<journal-title-group>
<journal-title>bioRxiv : the preprint server for biology</journal-title>
</journal-title-group>
<issn pub-type="ppub"/>
</journal-meta>
<article-meta>
<article-id pub-id-type="manuscript">EMS140772</article-id>
<article-id pub-id-type="doi">10.1101/2021.08.15.456423</article-id>
<article-id pub-id-type="archive">PPR383483</article-id>
<article-version article-version-type="publisher-id">1</article-version>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>SMOG 2 and OpenSMOG: Extending the limits of structure-based models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>de Oliveira</surname>
<given-names>Antonio B.</given-names>
<suffix>Jr</suffix>
</name>
<xref ref-type="aff" rid="A1">†</xref>
<xref ref-type="fn" rid="FN2">††</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Contessoto</surname>
<given-names>Vinícius G.</given-names>
</name>
<xref ref-type="aff" rid="A1">†</xref>
<xref ref-type="fn" rid="FN2">††</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hassan</surname>
<given-names>Asem</given-names>
</name>
<xref ref-type="aff" rid="A2">‡</xref>
<xref ref-type="aff" rid="A3">¶</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Byju</surname>
<given-names>Sandra</given-names>
</name>
<xref ref-type="aff" rid="A2">‡</xref>
<xref ref-type="aff" rid="A3">¶</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Ailun</given-names>
</name>
<xref ref-type="aff" rid="A3">¶</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Yang</given-names>
</name>
<xref ref-type="aff" rid="A7">§</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dodero-Rojas</surname>
<given-names>Esteban</given-names>
</name>
<xref ref-type="aff" rid="A5">‖</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mohanty</surname>
<given-names>Udayan</given-names>
</name>
<xref ref-type="aff" rid="A4">§</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Noel</surname>
<given-names>Jeffrey K.</given-names>
</name>
<xref ref-type="corresp" rid="CR1">*</xref>
<xref ref-type="aff" rid="A6">⊥</xref>
<xref ref-type="fn" rid="FN1">#</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Onuchic</surname>
<given-names>Jose N.</given-names>
</name>
<xref ref-type="corresp" rid="CR1">*</xref>
<xref ref-type="aff" rid="A1">†</xref>
<xref ref-type="aff" rid="A7">@</xref>
<xref ref-type="aff" rid="A8">Δ</xref>
<xref ref-type="aff" rid="A9">∇</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Whitford</surname>
<given-names>Paul C.</given-names>
</name>
<xref ref-type="corresp" rid="CR1">*</xref>
<xref ref-type="aff" rid="A1">‡</xref>
<xref ref-type="aff" rid="A3">¶</xref>
</contrib>
</contrib-group>
<aff id="A1">
<label>†</label>Center for Theoretical Biological Physics, Rice University, BioScience Research Collaborative, 6566 Main St, Houston, TX 77030</aff>
<aff id="A2">
<label>†</label>Department of Physics, Northeastern University, Dana Research Center 111, 360 Huntington Ave, Boston, MA 02115</aff>
<aff id="A3">
<label>¶</label>Center for Theoretical Biological Physics, Northeastern University, 360 Huntington Ave, Boston, MA 02115</aff>
<aff id="A4">
<label>§</label>Department of Chemistry, Boston College, Chestnut Hill, MA 02467</aff>
<aff id="A5">
<label>‖</label>Center for Theoretical Biological Physics, Rice University, Houston, TX 77005</aff>
<aff id="A6">
<label>⊥</label>Crystallography, Max Delbruck Center for Molecular Medicine, Berlin, Germany</aff>
<aff id="A7">
<label>@</label>Department of Physics &amp; Astronomy, Rice University, Houston, TX, USA</aff>
<aff id="A8">
<label>Δ</label>Department of Chemistry, Rice University, Houston, TX, USA</aff>
<aff id="A9">
<label>∇</label>Department of Biosciences, Rice University, Houston, TX, USA</aff>
<author-notes>
<corresp id="CR1">
<email>jnoel@mdc-berlin.de</email>; <email>jonuchic@rice.edu</email>; <email>p.whitford@northeastern.edu</email>
</corresp>
<fn id="FN1" fn-type="present-address">
<label>#</label>
<p id="P1">Current address: Electric Ant Lab, Science Park 106, 1098 XG, Amsterdam, The Netherlands</p>
</fn>
<fn id="FN2" fn-type="equal">
<label>††</label>
<p id="P2">These authors contributed equally to this work</p>
</fn>
</author-notes>
<pub-date pub-type="nihms-submitted">
<day>11</day>
<month>01</month>
<year>2022</year>
</pub-date>
<pub-date pub-type="preprint">
<day>16</day>
<month>08</month>
<year>2021</year>
</pub-date>
<permissions>
<ali:free_to_read/>
<license>
<ali:license_ref>https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
<license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0 International license</ext-link>.</license-p>
</license>
</permissions>
<abstract>
<p id="P3">Applying simulations with structure-based (Gō-like) models has proven to be an effective strategy for investigating the factors that control biomolecular dynamics. The common element of these models is that some (or all) of the intra/inter-molecular interactions are explicitly defined to stabilize an experimentally-determined structure. To facilitate the development and application of this broad class of models, we previously released the SMOG 2 software package. This suite allows one to easily customize and distribute structure-based (i.e. SMOG) models for any type of polymer-ligand system. Since its original release, user feedback has driven the implementation of numerous enhancements. Here, we describe recent extensions to the software and demonstrate the capabilities of the most recent version, SMOG v2.4. Changes include new tools that aid user-defined customization of force fields, as well as an interface with the OpenMM simulation libraries (OpenSMOG v1.0). To illustrate the utility of these advances, we present several applications of SMOG2 and OpenSMOG, which include systems with millions of atoms, long polymers and explicit ions. We also highlight how one can incorporate non-structure-based (e.g. AMBER-based) energetics to define a hybrid class of models. The representative applications include large-scale rearrangements of the SARS-CoV-2 Spike protein, the HIV-1 capsid in the presence of explicit ions, and crystallographic lattices of ribosomes and proteins. In summary, SMOG 2 and OpenSMOG provide robust support for researchers who seek to apply structure-based models to large and/or intricate biomolecular systems.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="S1" sec-type="intro">
<title>Introduction</title>
<p id="P4">Over the last several decades, structure-based models have been used to study a broad range of phenomena, spanning from protein folding<sup>
<xref ref-type="bibr" rid="R1">1</xref>
</sup> and binding,<sup>
<xref ref-type="bibr" rid="R2">2</xref>
</sup> to the dynamics of large-scale ribonucleoprotein assemblies.<sup>
<xref ref-type="bibr" rid="R3">3</xref>,<xref ref-type="bibr" rid="R4">4</xref>
</sup> The common feature of every structure-based model is that some (or all) of the energetic interactions explicitly stabilize specific pre-defined structures. That is, rather than assigning energetic parameters solely on the basis of chemical composition (as done in semi-empirical models), potential energy minima are defined to stabilize a known (typically experimentally-obtained) native conformation.<sup>
<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref>
</sup> In the context of protein folding, this type of energetic representation is supported by the principle of minimal frustration,<sup>
<xref ref-type="bibr" rid="R7">7</xref>,<xref ref-type="bibr" rid="R8">8</xref>
</sup> which states that the interactions formed in the native conformation will dominate the folding landscape. When applying these models to assemblies, such as the ribosome<sup>
<xref ref-type="bibr" rid="R9">9</xref>
</sup> or protein filaments,<sup>
<xref ref-type="bibr" rid="R10">10</xref>,<xref ref-type="bibr" rid="R11">11</xref>
</sup> assigning particular configurations to be potential energy minima can also be warranted, since structural techniques can only resolve low free-energy states. However, since structure-based models implicitly encode these free-energy minima, it is appropriate to consider the modeled interactions as representing the effective energetics of a system. With the simplicity and (generally) low computational requirements of these effective potentials, they provide a viable approach for investigating how molecular systems respond to perturbations (e.g. change in temperature, pH, binding, etc). In terms of strategies for deploying structure-based models, one will typically begin with a common-variety structure-based model,<sup>
<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R6">6</xref>
</sup> then systematically introduce additional energetic terms and characterize their influence on a large-scale dynamical process.</p>
<p id="P5">Structure-based, or Gō-like, models have a long history in the study of protein dynamics. In the earliest implementations, these models included coarse-grained (one bead per residue) descriptions of proteins,<sup>
<xref ref-type="bibr" rid="R12">12</xref>
</sup> where each residue was restricted to a 2D or 3D lattice. Subsequent models extended these coarse-grained representations to allow for off-lattice dynamics to be simulated,<sup>
<xref ref-type="bibr" rid="R5">5</xref>,<xref ref-type="bibr" rid="R13">13</xref>
</sup> which opened avenues for direct comparison of theoretical predictions and experimental measures. The C<sub>
<italic>α</italic>
</sub> model by Clementi et al.<sup>
<xref ref-type="bibr" rid="R5">5</xref>
</sup> is probably the most widely-known and used structure-based model, where countless variants have appeared in the literature over the years. In addition to the so-called single-basin models that have been popular in the study of folding, multi-basin variants<sup>
<xref ref-type="bibr" rid="R14">14</xref>–<xref ref-type="bibr" rid="R16">16</xref>
</sup> have also been used to study conformational rearrangements. In terms of spatial resolution, all-atom<sup>
<xref ref-type="bibr" rid="R6">6</xref>,<xref ref-type="bibr" rid="R17">17</xref>
</sup> and C<sub>
<italic>α</italic>
</sub>–C<sub>
<italic>β</italic>
</sub>
<sup>
<xref ref-type="bibr" rid="R18">18</xref>
</sup> variants have been proposed to characterize side chain packing during folding, or detailed steric effects during conformational transitions. Even though all of these force fields can be categorized as being part of the same class of models, extensions and modifications have resulted in many structure-based model variants, where each has been tailored to address specific questions.</p>
<p id="P6">With the growing popularity of structure-based models in the 2000s, it became increasingly difficult to quantitatively compare insights provided by different model variants. Differences were typically found in the functional form and energetic weights of dihedral energies, contact maps and excluded volume terms, and different simulation protocols were often applied. A factor that drove this diversity of techniques was, at that time, there was not a generally-available tool/framework available for the application and development of new structure-based models. Rather, research groups would often design their own custom software, where idiosyncrasies would manifest in the form of seemingly-arbitrary variations that had unclear effects on the predicted dynamics.</p>
<p id="P7">To provide the field with a common platform for applying structure-based models, we released the SMOG server webtool (smog-server.org, or SMOG 1<sup>
<xref ref-type="bibr" rid="R19">19</xref>
</sup>) in 2008. SMOG 1 provided a web-based interface for generating structure-based models that could be simulated with Gromacs,<sup>
<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref>
</sup> a high-performance molecular dynamics package. With the broad support available for Gromacs-formatted force field files, some of the models generated by SMOG 1 could also be simulated in NAMD,<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup> LAMMPS<sup>
<xref ref-type="bibr" rid="R23">23</xref>
</sup> and OpenMM.<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup> While the SMOG 1 interface has had considerable popularity (over 27,000 force fields generated, to date), only a few parameters could be adjusted by the user. To extend the versatility of structure-based model design, in 2015 we released SMOG 2.<sup>
<xref ref-type="bibr" rid="R25">25</xref>
</sup> SMOG 2 is distributed as a downloadable open-source software package, and it allows users to define new types of SMOG models through use of XML-based “template” files. With its lightweight and portable characteristics, users can easily disseminate SMOG-model variants without maintaining a complete software stack. Primarily driven by user feedback, the SMOG 2 package has continued to be extended and refined, and there is now a range of new options and tools for the study of arbitrarily complex biomolecular systems.</p>
<p id="P8">Here, we describe the most recent developments of the SMOG 2 software package, which are available in SMOG v2.4. These enhancements improve the user experience, provide new capabilities and allow for streamlined deployment of SMOG models in OpenMM (via the newly-released OpenSMOG library). To highlight the flexibility of the code, we describe example applications that test the capabilities of SMOG (v2.4) and OpenSMOG (v1.0). These examples include large systems (more than 10 million atoms, or thousands of polymer chains), very long polymers (150 kilobase strand of DNA), systems with electrostatics and explicit ions, as well as models that employ complicated functional forms that can be simulated in OpenMM. With these developments, the SMOG2/OpenSMOG tools establish a comprehensive computational infrastructure that supports the development and application of novel SMOG models using state-of-the-art hardware.</p>
</sec>
<sec id="S2">
<title>Software Overview</title>
<p id="P9">The current manuscript describes two interrelated software components: SMOG (v2.4) and OpenSMOG (v1.0). SMOG 2 is a standalone software package that reads PDB-formatted structural information and produces force field files that define a structure-based model for the given biomolecular system. SMOG 2 is written in Perl, and users may install the code manually, configure the required libraries via conda, or download a fully-configured SMOG 2 container. OpenSMOG is a Python library that allows highly-customizable SMOG models to be simulated in OpenMM. While these software elements may be used independently, they have been designed to directly interface in order to expand the possible applications of SMOG models (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Below, we provide an overview of the support provided and usage considerations of the SMOG2/OpenSMOG framework.</p>
</sec>
<sec id="S3">
<title>SMOG v2.4</title>
<sec id="S4">
<title>Approach</title>
<p id="P10">In addition to providing support for default C<sub>
<italic>α</italic>
</sub>
<sup>
<xref ref-type="bibr" rid="R5">5</xref>
</sup>and all-atom<sup>
<xref ref-type="bibr" rid="R6">6</xref>
</sup> models, SMOG 2 allows users to define general rules for constructing new classes of structure-based models, without requiring programming or scripting. Each type of SMOG model is defined by a set of XML files, which are collectively referred to as the model “template”. These define the covalent geometry and resolution of each supported residue, the functional form of every interaction and assignment of energetics in a given SMOG model variant. There are four core files that constitute a template: the settings file (.sif), bonded information file (.bif), bond energetics file (.b) and non-bonded energetics file (.nb). SMOG 2 reads the templates, and then applies the template-defined rules to construct force fields for individual molecular systems (provided in PDB format). As output, SMOG 2 generates force field and coordinate files that can be used to perform simulations with Gromacs<sup>
<xref ref-type="bibr" rid="R20">20</xref>,<xref ref-type="bibr" rid="R21">21</xref>
</sup> (version 3 and later) or OpenMM<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup> (via the OpenSMOG module). In addition, Gromacs-formatted files may also be used (with limited support) by NAMD,<sup>
<xref ref-type="bibr" rid="R22">22</xref>
</sup> or they may be converted (through the SMOG-converter program<sup>
<xref ref-type="bibr" rid="R26">26</xref>
</sup>) for use with LAMMPS.<sup>
<xref ref-type="bibr" rid="R23">23</xref>
</sup> Since there are already detailed technical descriptions available on template organization and SMOG 2 output files,<sup>
<xref ref-type="bibr" rid="R25">25</xref>,<xref ref-type="bibr" rid="R27">27</xref>
</sup> we will focus the current discussion of the template-based approach to recent extensions that allow for more versatile definitions of structure-based models to be applied.</p>
</sec>
<sec id="S5">
<title>Code accessibility</title>
<p id="P11">SMOG 2 and OpenSMOG are open source and freely available for anonymous download. SMOG 2 is available at <ext-link ext-link-type="uri" xlink:href="https://smog-server.org/smog2">https://smog-server.org/smog2</ext-link>. The software may be downloaded in the form of a container, a stable release bundle, or through a git repository. Installation instructions are provided in the user manual. The OpenSMOG library can be installed via conda or pip, or it can be compiled from source (<ext-link ext-link-type="uri" xlink:href="https://github.com/smog-server/OpenSMOG">https://github.com/smog-server/OpenSMOG</ext-link>). Detailed installation instructions and usage tutorials can be found in the associated documentation (<ext-link ext-link-type="uri" xlink:href="https://opensmog.readthedocs.io">https://opensmog.readthedocs.io</ext-link>).</p>
</sec>
<sec id="S6">
<title>Recent improvements</title>
<sec id="S7">
<title>Performance for large systems</title>
<p id="P12">For the current version (2.4), we made a concerted effort to improve the versatility and performance of SMOG 2 when applied to large and complex assemblies. For reference, with a typical desktop, a SMOG model can usually be generated for small molecular systems (~10,000 atoms) in less than a minute. While the performance of SMOG 2 for small systems is sufficient for routine daily usage, stress testing the code with large molecular systems revealed a number of algorithmic limitations in earlier versions. By addressing these deficiencies, we have significantly reduced the computational requirements for large systems (millions of atoms), both in terms of memory and CPU usage. For reference, as described in subsequent sections, it was not tractable to generate SMOG models for some large-scale systems (i.e. long double-stranded DNA) with SMOG v2.3. To quantify these performance gains, we compared the time required for SMOG v2.0 and v2.4 to generate an all-atom SMOG model for a reasonably large molecular system: the ribosome (~150,000 atoms). When using a 2.7GHz Intel Core i7 chip, SMOG v2.0 requires more than 8 minutes to generate force field files with the default all-atom model. Using SMOG v2.4, this same system requires just over 2 minutes. Further, as described later, the time required by SMOG 2 scales linear with the number of atoms, such that million-atom systems only require approximately 10 minutes to complete. This means it is now practical to routinely prepare structure-based model variants for larger assemblies (10<sup>5</sup> – 10<sup>6</sup> atoms).</p>
</sec>
<sec id="S8">
<title>Modeling tools</title>
<p id="P13">Since the release of SMOG v2.0, numerous tools (called smog-tools) have been introduced to perform common system-specific modifications to SMOG models. These modules streamline the model development stage for each user, which reduces the likelihood of introducing modeling errors and improves the reproducibility of each study. As examples, one may quickly and directly add ions to a system with the <monospace>smog_ions</monospace> tool, or rescale/remove subsets of contacts/dihedrals between specific groups of atoms (e.g. interface interactions) with <monospace>smog_scale-energies</monospace>. The <monospace>smog_extract</monospace> tool allows one to remove any subset of atoms, along with their energetic terms. This can be useful if one seeks to obtain additional sampling for a subset of atoms within a larger system. A more laborious approach to accomplish this would be to regenerate the force field files, from scratch, for a smaller system. Instead, <monospace>smog_extract</monospace> allows the user to create a force field for the subsystem that has identical energetic parameters as the complete system, including any user-introduced modifications.</p>
</sec>
<sec id="S9">
<title>Support for large molecules</title>
<p id="P14">In addition to having a range of algorithmic improvements, SMOG v2.4 can also utilize files that are provided in an extended PDB-like format. Specifically, base-62 numbering (0-9,A-Z,a-z) may be used for atom/residue indices, and free-format coordinates are allowed. With these minor changes, SMOG models can be generated for systems that have dimensions that exceed the 1-μm limit imposed by the fixed format of PDB files. With base-62 numbering, one can uniquely index and reference up to nearly one billion atoms (62<sup>5</sup>) or 15 million residues (62<sup>4</sup>) in a single chain.</p>
</sec>
<sec id="S10">
<title>Interface with OpenMM</title>
<p id="P15">While the above tools were introduced in SMOG versions 2.1 to 2.3, version 2.4 introduces the -OpenSMOG option, which allows for broad support of SMOG models in OpenMM. As depicted in <xref ref-type="fig" rid="F1">Fig. 1</xref>, SMOG v2.4 can generate input files that are written specifically for use with the OpenSMOG module of OpenMM. In addition to enhancing support for GPU computing, the SMOG2/OpenSMOG framework also enables a more versatile approach for defining SMOG models. In SMOG 2.4, we have extended the template format, in order to exploit the Custom Force strategy implemented in OpenMM. From a user standpoint, a novel potential energy function can be added by simply introducing minor modifications to the XML-formatted SMOG2 template files. In OpenSMOG (v1.0), this framework allows for a broad range of pair-wise potentials to be deployed. Support for multi-body interactions, as well as custom nonbonded terms, dihedrals, bonds and bond angles are scheduled for future versions of SMOG2/OpenSMOG.</p>
<p id="P16">Here, we will show how to introduce an arbitrary contact potential in SMOG2/OpenSMOG. In the example below, we employ a custom contact potential of the form: <disp-formula id="FD1">
<label>(1)</label>
<mml:math id="M1">
<mml:mrow>
<mml:mi>U</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>A</mml:mi>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>σ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mi>r</mml:mi>
</mml:mfrac>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>16</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>0.5</mml:mn>
<mml:mo>∗</mml:mo>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>tanh</mml:mi>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>B</mml:mi>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>σ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula> where <italic>A, B, σ</italic>
<sub>1</sub> and <italic>σ</italic>
<sub>2</sub> are parameter that define each contact interaction. While we are unaware of this specific potential being deployed previously, one could envision using this type of function to approximate a square-well interaction (<xref ref-type="fig" rid="F2">Fig. 2</xref>). To define this function for use in the SMOG model, one would simply add the following element to the .sif template file: <boxed-text id="BX1" position="anchor" content-type="below">
<label>Listing 1</label>
<caption>
<title>Defining a new contact potential in SMOG 2. By, adding this function element to the .sif file, one can introduce a user-defined potential in OpenSMOG/OpenMM.</title>
</caption>
<p id="P17">&lt;function name="r16_tanh"</p>
<p id="P18">   directive="OpenSMOG"</p>
<p id="P19">   OpenSMOGtype="contact"</p>
<p id="P20">   OpenSMOGpotential="weight*((sigma1/r)^16+0.5*(tanh(B*(r-sigma2))-1))"</p>
<p id="P21">   OpenSMOGparameters="weight,B,sigma1,sigma2"</p>
<p id="P22">   exclusions="1"</p>
<p id="P23">/&gt;</p>
</boxed-text>
</p>
<p id="P24">This general functional form could then be applied to any contact group, in this case the global (default) group.</p>
<boxed-text id="BX2" position="anchor" content-type="below">
<label>Listing 2</label>
<caption>
<title>After a contact potential is defined (Listing 1), it may be used to define the interactions between specific types of atoms in the .nb template file.</title>
</caption>
<p id="P25">&lt;contact func="r16_tanh(energynorm,10,?*0.9,?*1.1)" contactGroup=“c”&gt;</p>
<p id="P26">   &lt;pairType&gt;*&lt;/pairType&gt;</p>
<p id="P27">   &lt;pairType&gt;*&lt;/pairType&gt;</p>
<p id="P28">&lt;/contact&gt;</p>
</boxed-text>
<p id="P29">In this example, the parameter <monospace>weight</monospace> is assigned based on the default energy normalization scheme (static weights are also supported), the parameter <monospace>B</monospace> is 10 nm<sup>–1</sup>, <monospace>sigma1</monospace> is 0.9 times the native distance (calculated based on the input PDB structure) and <monospace>sigma2</monospace> is 1.1 times the native distance. After preparing the template files, the user simply needs to issue the -<monospace>OpenSMOG</monospace> flag when calling SMOG 2. This will ensure that all OpenSMOG-specific formatting changes are included in the produced files, so that they will be ready for use with OpenSMOG/OpenMM.</p>
</sec>
</sec>
</sec>
<sec id="S11">
<title>OpenSMOG</title>
<p id="P30">OpenSMOG is a Python library for performing molecular dynamics (MD) simulations with structure-based models generated by SMOG (v2.4 and later. <xref ref-type="fig" rid="F1">Fig. 1</xref>). OpenSMOG uses the OpenMM Python API<sup>
<xref ref-type="bibr" rid="R24">24</xref>
</sup>, which supports a wide variety of potential energy functions, including those used in all-atom and coarse-grained variants of SMOG models. The OpenSMOG library is a set of wrappers for core OpenMM libraries, which ensures that simulations with OpenSMOG can utilize the full range of OpenMM-supported hardware. In terms of GPU support, one may use OpenCL or HIP libraries for AMD GPUs, or CUDA libraries with NVIDIA GPUs.</p>
<p id="P31">Rather than developing a completely new interface for applying structure-based models, OpenSMOG builds upon existing support in OpenMM for Gromacs-formatted force field (.top) and coordinate (.gro) files. However, the utility of OpenSMOG arises from the introduction of an additional XML-formatted file with which to pass customized potential terms from SMOG 2 to OpenMM. For ease of discussion, we will refer to this file as <monospace>opensmog.xml</monospace>. This file replaces the use of the “pairs” directive in the .top file, since the pairs directive supports a limited set of pair-wise potentials. Instead, <monospace>opensmog.xml</monospace> can define pair-wise potentials that have an arbitrary number of parameters, and parameters can be set using a combination of expressions and rules, as described in detail in the SMOG 2 manual. Further, OpenSMOG passes information from <monospace>opensmog.xml</monospace> to the CustomBondForce class provided by OpenMM, which allows for use of an arbitrary number of contact potentials in a single simulation. This represents the most significant improvement over current SMOG-model support provided by other MD packages.</p>
<p id="P32">Once the force field has been generated by SMOG 2, a short Python script is sufficient to perform a simulation with OpenSMOG. For example, to launch a simulation for the system “CI2” using HIP acceleration (for AMD GPUs), one could use the following script: <boxed-text id="BX3" position="anchor" content-type="below">
<label>Listing 3</label>
<caption>
<title>Usage example of the OpenSMOG library</title>
</caption>
<p id="P33">#OpenSMOG example</p>
<p id="P34">from OpenSMOG import SBM</p>
<p id="P35">sbm_CI2 = SBM(name=’CI2’, time_step=0.002, r_cutoff=1.5, collision_rate=1.0, temperature=0.5)</p>
<p id="P36">sbm_CI2.setup_openmm(platform=’HIP’)</p>
<p id="P37">sbm_CI2.saveFolder(’output’)</p>
<p id="P38">sbm_CI2.loadSystem(Grofile=’CI2.gro’, Topfile=’CI2.top’, Xmlfile=’CI2.xml’)</p>
<p id="P39">sbm_CI2.createSimulation()</p>
<p id="P40">sbm_CI2.createReporters(trajectory=True, energies=True, energy_components=False, interval=1000)</p>
<p id="P41">sbm_CI2.run(100000, report=True, interval=1000)</p>
</boxed-text>
</p>
<p id="P42">In this example, the temperature is set to 0.5 (reduced units), the simulation will be performed for 100,000 timesteps of size 0.002, where the non-bonded cutoff is 1.5 nm. There are a few important technical notes that are worth mentioning. First, a timestep of 0.002 is recommended<sup>
<xref ref-type="bibr" rid="R25">25</xref>
</sup> for the default all-atom SMOG model, but a step of 0.0005 is typically appropriate for <italic>C<sub>α</sub>
</italic> models. For customized models, different values may be more suitable. Next, HIP libraries are used in the above example, though OpenMM allows for OpenCL and CUDA support, and the user should determine which is most suitable for the available hardware. Finally, in the above example we set <monospace>energy_components=False</monospace>, which turns off the writing of individual energetic components (e.g. dihedrals, contacts, etc). When turned on, we have found that writing the full set of energies every 1000 steps can incur a roughly 10% performance loss. Accordingly, it is important that the user determines an appropriate frequency for writing the energies by component.</p>
<p id="P43">With the script given in Listing 3, OpenSMOG would generate three output files:</p>
</sec>
<sec id="S12">
<title>Applications of SMOG 2 and OpenSMOG</title>
<p id="P44">To illustrate the capabilities of SMOG v2.4 and OpenSMOG v1.0, we provide some representative examples that highlight key aspects of this computational infrastructure. First, we describe simulations of the SARS-CoV-2 spike protein, for which post-translational modifications and non-standard energetic terms are introduced and applied in OpenMM. Simulations of the HIV-1 capsid are then presented, which illustrate how one may incorporate electrostatics and explicit ions into a structure-based model. This is followed by examples of extremely large molecular systems that are supported by SMOG v2.4. These include cases that span large length scales (~5 microns), include many atoms (&gt; 10<sup>7</sup>), have long chains (10<sup>5</sup> residues) and systems composed of many chains (&gt; 10<sup>4</sup>). These large systems were used as benchmarks for identifying performance and memory limitations in earlier versions of SMOG 2. We close with an example for how SMOG 2 may be used to easily generate a force field for subsystems of larger assemblies.</p>
<sec id="S13">
<title>Simulating global rearrangements with SMOG2 and OpenSMOG</title>
<p id="P45">SMOG2 and OpenSMOG provide a versatile framework for defining structure-based models of arbitrarily complex molecular systems. The flexibility of this approach is highlighted by recent simulations of the SARS-CoV-2 spike protein (<xref ref-type="fig" rid="F3">Fig. 3</xref>). For this system, there is much interest in understanding the influence that glycans may have on the functional dynamics. For our purposes, we will consider the influence that glycan excluded volume interactions can have on the global rearrangements of this protein. That is, rather than considering the full range of energetic factors that may be present, these initial simulations aim to directly assess the steric contribution. For this type of question, one would need to define the glycans to have no preferred configuration (except those imposed by stereochemistry) and no stabilizing contacts. Further, one must be able to describe simple (N- and O- ligated) and complex (branched) glycans. In addition to these considerations, one may also wish to encode the bonded terms based on Amber<sup>
<xref ref-type="bibr" rid="R28">28</xref>
</sup> parameters, rather than those found in the structural model, as described recently for simulations of a viral capsid.<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup> In terms of the user interface, all force field parameters are defined in the templates, while the glycan bonds are given through a PDB-file extension. Using the exact same files as input for SMOG 2, one can then generate the force field files for Gromacs (default behavior), or OpenMM (by issuing the -<monospace>OpenSMOG</monospace> flag).</p>
<p id="P46">To demonstrate the utility of this complex definition of a structure-based model, we applied it to simulate a global conformational rearrangement of the fully glycosylated S2 subunit of SARS-CoV-2 Spike protein. During the membrane fusion process, the S2 subunit of the Spike protein undergoes a major conformational change, where individual atoms are displaced by 200-300Å. This transition is of obvious immediate interest, since it is responsible for virus-host membrane fusion, a necessary step during infection<sup>
<xref ref-type="bibr" rid="R30">30</xref>–<xref ref-type="bibr" rid="R34">34</xref>
</sup>. However, simulating this conformational change also illustrates how complex and large-scale molecular motions may be studied using all-atom structure-based models. Following the approach described in Ref.<sup>
<xref ref-type="bibr" rid="R35">35</xref>
</sup>, we used this extended all-atom (15207 atoms) structure-based model to simulate the transition between the prefusion and postfusion conformations of the glycosylated S2 subunit. Here, the postfusion structure contacts are energetically stabilizing. Through use of the OpenSMOG option of SMOG 2, this complex system can be simulated using OpenMM (<xref ref-type="fig" rid="F3">Fig. 3C</xref>). Alternately, one may omit this flag and perform simulations in other MD packages, such as Gromacs. In terms of computational performance, we obtained 1.73 × 10<sup>8</sup> time steps per day with OpenSMOG when using a single AMD MI50 GPU.</p>
</sec>
<sec id="S14">
<title>Studying ion dynamics in large assemblies</title>
<p id="P47">A goal of the SMOG class of structure-based models is to allow for the systematic analysis of factors that influence biomolecular dynamics. By starting with highly-simplified variants of structure-based models,<sup>
<xref ref-type="bibr" rid="R6">6</xref>
</sup> and then continually increasing the energetic complexity, we envision that a nearly continuous spectrum of models may be constructed that span all the way to completely non-specific (e.g. AMBER, CHARMM) potentials. To this end, we continue to expand the support of SMOG 2 for more energetically detailed models. A major step in this direction is enabling one to integrate electrostatic interactions with implicit or explicit ions into the existing SMOG-model framework.</p>
<p id="P48">Recently, we have extended SMOG 2 to allow for effective ionic potentials to be deployed. Specifically, one may apply pairwise non-bonded interactions that include up to five Gaussian functions, as described by Savelyev and Papoian.<sup>
<xref ref-type="bibr" rid="R37">37</xref>
</sup> Following their iterative refinement protocol, we established ion-protein parameters that reproduce the ionic distributions obtained with the Amber99SB-ildn<sup>
<xref ref-type="bibr" rid="R38">38</xref>
</sup> force field. By developing models that have explicit diffuse ions and electrostatics, along with implicit representations of solvent, this strategy can allow for long timescale simulations of large-scale biomolecular assemblies. Since the details of this particular parameterization are described elsewhere,<sup>
<xref ref-type="bibr" rid="R39">39</xref>
</sup> we will only note the enabling technical features that are available in SMOG v2.4. First, we extended SMOG 2 in order to accommodate general non-bonded definitions. Next, we introduced the <monospace>smog_ions</monospace> tool, which allows the user to quickly assign ion positions and parameters to any existing SMOG force field. As expected, these tasks require minimal computational overhead, where assigning a million ions can be completed in a few minutes on most personal computers.</p>
<p id="P49">To demonstrate the potential for SMOG 2 to be used to investigate electrostatics and ionic effects in large-scale assemblies, we simulated the HIV-1 capsid with an all-atom model in the presence of 10 mM MgCl<sub>2</sub> and 100 mM KCl. The HIV-1 capsid consists of 1356 p24 proteins,<sup>
<xref ref-type="bibr" rid="R36">36</xref>
</sup> which together contain 2.4 million non-hydrogen atoms (<xref ref-type="fig" rid="F4">Fig. 4A</xref>). Due to the dimensions of the box (cube of linear dimension 200 nm), is was necessary to introduce 1.1 million diffuse ions (Mg<sup>2+</sup>, K<sup>+</sup> and Cl<sup>−</sup>, <xref ref-type="fig" rid="F4">Fig. 4B</xref>) in order to represent physiological concentrations. The simulations can be performed with a modified version of the Gromacs (v5.1.4) software package, which is available for download at smog-server.org. We then calculated the number of diffuse ions that were within 1 nm of the HIV-1 capsid, as a function of time (<xref ref-type="fig" rid="F4">Fig. 4C</xref>). This demonstrative calculation shows that both monovalent and divalent ions can equilibrate around the HIV-1 capsid within a few million timesteps. This example makes it clear that it is now tractable to design new electrostatic/ion representations and investigate how these factors can influence dynamics in very large systems. While these simulations may be performed on commonly-available commodity clusters, an explicit-solvent simulation of these dimensions would contain more than 2 billion atoms, which would require specialized access and software in order to utilize world-leading computing resources<sup>
<xref ref-type="bibr" rid="R40">40</xref>
</sup>. In summary, these recently-introduced features of SMOG2 enable new modeling strategies to be applied in the study of ionic effects in biomolecular assemblies.</p>
</sec>
<sec id="S15">
<title>Simulating multi-million atom systems</title>
<p id="P50">Since the original release of SMOG 2,<sup>
<xref ref-type="bibr" rid="R25">25</xref>
</sup> a range of changes have been introduced to enhance the user experience and improve performance when working with larger molecular systems. While performing a simulation will remain the most computationally-demanding step of any study, the improved performance of SMOG 2 allows users to quickly iterate through variations of a given model, as well as troubleshoot potential issues associated with each structure and/or custom force field. To illustrate the capabilities of SMOG 2, we provide example applications to large molecular systems: crystallographic lattices of many (&gt; 150) complete ribosomes, a lattice formed by tens of thousands of proteins and a hypothetical 1000-nucleosome system. Below we describe these benchmark systems. For the lattice of ribosomes, we also describe some basic analysis that is accessible when using SMOG models to simulate such a system.</p>
</sec>
<sec id="S16">
<title>Crystallographic lattice of ribosomes</title>
<p id="P51">In order to test the support of SMOG 2 for large and heterogeneous systems, we used SMOG 2 to generate a structure-based model of a crystallographic lattice of ribosomes. In this test system, we used a crystallographic model of the T. thermophilus ribosome (PDB ID:4XEJ<sup>
<xref ref-type="bibr" rid="R41">41</xref>
</sup>) to first generate a complete unit cell, which is composed of eight ribosomes, for a total of 1.14 million atoms and 424 chains. Unit cell generation was performed using the Unit Cell tool in Chimera.<sup>
<xref ref-type="bibr" rid="R42">42</xref>
</sup> We then generated systems with 1 unit cell (8 ribosomes) to 19 unit cells (152 ribosomes) tiled along the x direction. SMOG v2.4 could successfully generate an all-atom structure-based model (with AMBER-based bonded geometry<sup>
<xref ref-type="bibr" rid="R29">29</xref>
</sup>) for each of the systems using a single core of a 2.2GHz Intel Xeon Platinum 8276 CPU. The time for SMOG 2 to complete scaled linearly with the number of unit cells (~ 11.5 minutes per million atoms).</p>
<p id="P52">Since SMOG 2 enables one to generate all-atom structure-based models for large system, one can begin to probe how crystallographic contacts impact the apparent molecular flexibility of this large assembly. Here, we performed molecular dynamics simulation of a 15-ribosome system, which is composed of a central ribosome along with its 14 adjacent crystallographic replicas (795 chains, 2144639 atoms). After generating an all-atom structure-based model with SMOG 2, we performed constant temperature simulations (0.5 reduced units, or 60 Gromacs units) using Gromacs.<sup>
<xref ref-type="fn" rid="FN5">i</xref>
</sup>
</p>
<p id="P53">Comparing the dynamics of a ribosome in isolation with the dynamics found in the lattice reveals the significant impact crystallographic contacts can have on flexibility. For this comparison, we considered the spatial root mean squared fluctuations (RMSF) of the ribosome in each system (central lattice ribosome, or isolated ribosome; <xref ref-type="fig" rid="F5">Fig. 5</xref>). While many regions exhibit nearly identical RMSF values, there are distinct differences in some peripheral structural elements. In particular, there is a marked decrease in RMSF values for the small subunit beak (h35) and spur (h6), as well as the large subunit L1 stalk and protein L9. Due to the presence of crystallographic contacts, the L1 stalk, beak and spur exhibit fluctuations that are roughly linearly correlated between the lattice-bound and isolated system. This is consistent with each element moving approximately as a rigid body about a pivot-like region. That is, the mobility of each atom is roughly proportional to its distance from the pivot region. As a result, the slope of the line formed is equal to the ratio of root-mean-square-solid-angle (RMSSA) subtended by the scale of the fluctuations in the lattice/cluster and the free single ribosome. Protein L9 exhibits a different trend. That is, all atoms in L9 have roughly the same RMSF values in the lattice, consistent with strong confinement of the extended domain. In the isolated ribosome, all restraints on L9 are absent, and there is a wide range of large RMSF values. While the current simulations provide proof-of-principle that crystallographic effects may be quantitatively assessed in the SMOG 2 framework, additional calculations will be required to fully delineate their precise influence. In terms of our understanding of biomolecular dynamics, these types of comparisons provide new avenues for establishing insights into the relationship between crystallographic B-factors and dynamics of biomolecules in solution.</p>
</sec>
<sec id="S17">
<title>Systems with many molecules</title>
<p id="P54">We next tested the ability of SMOG 2 to generate force fields for systems with large numbers of chains. For this test case, we generated a crystallographic lattice of a small, 64-residue protein. In the same manner as for the ribosome lattices described above, we generated crystallographic lattices of the protein CI2 (PDB ID: 2CI2<sup>
<xref ref-type="bibr" rid="R43">43</xref>
</sup>) that range from 1000 to 3000 unit cells. In the largest system, there were 36,000 proteins. All-atom SMOG models were successfully generated for all systems, again requiring approximately 11.2 minutes per million atoms (36k chains, 3.5 hours). To ensure the generated files were usable, each system was subsequently energy minimized and simulated at constant temperature using Gromacs. <sup>
<xref ref-type="fn" rid="FN6">ii</xref>
</sup>
</p>
</sec>
<sec id="S18">
<title>Multi-million-atom chains</title>
<p id="P55">As a final stress test of the SMOG 2 software, we considered systems with extremely long chains. Here, we generated an artificial model of a nucleosome system. For this molecular model, we began with a single nucleosome structure (PDB ID 1P3I).<sup>
<xref ref-type="bibr" rid="R44">44</xref>
</sup> We then extended the DNA strand using a model of an ideal linear B-form 40bp DNA that was generated with the W3DNA server.<sup>
<xref ref-type="bibr" rid="R45">45</xref>
</sup> Using the Tk interface of VMD,<sup>
<xref ref-type="bibr" rid="R46">46</xref>
</sup> systems were generated with multiples of 100 nucleosome-linker segments. The largest system considered contained 1000 nucleosomes, with the dsDNA containing ≈ 184K basepairs and more than 3 million atoms per chain. This system also contained 8000 histone proteins, for a system total of 13,534,000 atoms that spans 4.5 μm. Using a single compute core, SMOG v2.4 was able to generate an all-atom structure-based model for a chain of 1000 nucleosomes in ≈ 3.5 hours. For comparison, code limitations precluded the possibility of SMOG v2.3 to generate a force field for this system. As with the other cases, this system was energy minimized and simulated using Gromacs.<sup>
<xref ref-type="fn" rid="FN7">iii</xref>
</sup>
</p>
<p id="P56">While this artificial system was used to demonstrate computational capabilities, it represents a notable milestone. That is, in modern models of chromatin,<sup>
<xref ref-type="bibr" rid="R47">47</xref>
</sup> the system is coarse grained at a resolution of 50000 base pairs per pseudoparticle. This extremely-coarse representation is suitable, since it corresponds to the resolution afforded by state-of-the art Hi-C measurements. With the presented advances in SMOG 2, the field may now consider a wide range of all-atom and coarse-grained (e.g. 1-3 beads per residue) models for systems that reach the scale of these experimentally-derived coarse-grained models of chromatin. This provides exciting opportunities, where SMOG models may be used to study the dynamics at “small” scales (i.e. 100,000 base pairs) and Hi-C-inspired models may be used to extend to the scale of full chromosomes. Together, this overlap of spatial scales can allow the field to establish a comprehensive understanding of chromatin dynamics that spans from atomic-level to chromosome-scale dynamics.</p>
</sec>
<sec id="S19">
<title>Probing dynamics in subsystems</title>
<p id="P57">For biomolecular systems in which the dynamical phenomenon of interest involves a small sub-region of a larger assembly, it may be helpful to simulate only the dynamics of the sub-region, while approximating the dynamics at the boundary. With the SMOG 2 package, this can be achieved by extracting any subset of atoms from a larger system using the <monospace>smog_extract</monospace> tool. This tool also allows for position restraints to be imposed on boundary atoms (i.e. those that had interactions removed). It is possible to use isotropic<sup>
<xref ref-type="bibr" rid="R48">48</xref>
</sup> or anisotropic<sup>
<xref ref-type="bibr" rid="R49">49</xref>
</sup> restraints at the boundaries, such that the mobility of boundary atoms is consistent with the fluctuations observed in the full assembly. Below, we provide an example for how to use SMOG 2 to prepare a system and refine the boundary restraints.</p>
<p id="P58">To study a subsystem, we will use the <monospace>smog_extract</monospace> tool to construct a truncated ribosome system. In this example, an all-atom SMOG model was first generated for the full ribosome (<xref ref-type="fig" rid="F7">Fig. 7A</xref>, PDB 6QNR<sup>
<xref ref-type="bibr" rid="R50">50</xref>
</sup>). Next, we extracted all atoms and interactions that are in the vicinity of the peptidyl transferase center (PTC) (<xref ref-type="fig" rid="F7">Fig. 7B</xref>). Boundary atoms were automatically identified and assigned a default weight to each position restraint. Then, following the methods of Noel et al.,<sup>
<xref ref-type="bibr" rid="R48">48</xref>
</sup> the RMSF values of all boundary atoms were calculated and compared to the values found in the full ribosome. Based on this, the weight of each restraint was iteratively updated until the fluctuations of the boundary atoms were consistent with the full ribosome system (<xref ref-type="fig" rid="F7">Fig. 7C</xref>). This yields a model for the subsystem in which artificial boundary effects are minimized. The utility of this strategy is that one may reduce the computational demand without unintentionally perturbing the dynamics due to the introduction of boundary restraints. In this specific system, one could then consider studying the interplay between ribosome flexibility near the PTC and the dynamics of the tRNA molecule.</p>
</sec>
</sec>
<sec id="S20" sec-type="conclusions">
<title>Conclusions</title>
<p id="P59">SMOG 2 and OpenSMOG increase the accessibility of structure-based (SMOG) model development, application and dissemination. With the flexible construction of SMOG models that is afforded by SMOG2/OpenSMOG, these tools alleviate common technical challenges associated with force field development, while providing strategies that are tailored for the construction of structure-based models. By removing technical obstacles, SMOG2/OpenSMOG allows researchers to focus on posing deeper physical questions, which may be more easily answered through the systematic construction of SMOG model variants. In the current report, we highlight recent advances that include improved support for large molecular systems, as well as support for more elaborate SMOG model definitions. These representative applications illustrate only a few ways in which this platform can allow researchers to address broad biophysical challenges. In contrast to early structure-based models, these tools allow for the application of these models to systems/processes that span diverse length scales, ranging from the folding of small proteins to the dynamics of large-scale biomolecular assemblies.</p>
</sec>
</body>
<back>
<ack id="S21">
<title>Acknowledgement</title>
<p>PCW was supported by NSF grant MCB-1915843. This research was supported by the Center for Theoretical Biological Physics sponsored by the NSF (Grant PHY-2019745). JNO was also supported by the National Science Foundation (NSF) grants CHE-1614101 and PHY-1522550 and by the Welch Foundation (Grant C-1792). JNO is a Cancer Prevention and Research Institute of Texas (CPRIT) Scholar in Cancer Research. ABOJ acknowledges the Robert A. Welch Postdoctoral Fellow program. We would also like to acknowledge generous support from the Northeastern University Discovery cluster and Northeastern University Research Computing staff. We are also grateful for generous computational resources and support provided by the AMD COVID-19 HPC Fund program.</p>
</ack>
<fn-group>
<fn id="FN3" fn-type="con">
<p id="P60">
<bold>Author contributions</bold>
</p>
<p id="P61">ABO, VGC, JKN and PCW wrote the software. All authors contributed to the design of the software. ABO, VGC, AH, SB, AW, YW, ED, JKN and PCW tested the software and performed simulations. All authors contributed to manuscript preparation.</p>
</fn>
<fn id="FN4" fn-type="conflict">
<p id="P62">
<bold>Notes</bold>
</p>
<p id="P63">The authors declare no competing financial interest.</p>
</fn>
<fn id="FN5">
<label>i</label>
<p id="P64">versions 5.1.4 and 2021.2 were both tested</p>
</fn>
<fn id="FN6">
<label>ii</label>
<p id="P65">versions 5.1.4 and 2021.2</p>
</fn>
<fn id="FN7">
<label>iii</label>
<p id="P66">versions 5.1.4 and 2021.2</p>
</fn>
</fn-group>
<ref-list>
<ref id="R1">
<label>(1)</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
</person-group>
<source>Computational Modeling of Biological Systems</source>
<person-group person-group-type="editor">
<name>
<surname>Dokholyan</surname>
<given-names>NV</given-names>
</name>
</person-group>
<publisher-name>Springer</publisher-name>
<publisher-loc>US</publisher-loc>
<year>2012</year>
<fpage>31</fpage>
<lpage>54</lpage>
</element-citation>
</ref>
<ref id="R2">
<label>(2)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Levy</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Cho</surname>
<given-names>SS</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
<name>
<surname>Wolynes</surname>
<given-names>PG</given-names>
</name>
</person-group>
<article-title>A survey of flexible protein binding mechanisms and their transition states using native topology based energy landscapes</article-title>
<source>J Mol Biol</source>
<year>2005</year>
<volume>346</volume>
<fpage>1121</fpage>
<lpage>45</lpage>
</element-citation>
</ref>
<ref id="R3">
<label>(3)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Levi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Studying ribosome dynamics with simplified models</article-title>
<source>Methods</source>
<year>2019</year>
<volume>162-163</volume>
<fpage>128</fpage>
<lpage>140</lpage>
</element-citation>
</ref>
<ref id="R4">
<label>(4)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kim</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Abeysirigunawarden</surname>
<given-names>SC</given-names>
</name>
<name>
<surname>Chen</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Mayerle</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Ragunathan</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Luthey-Schulten</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Ha</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Woodson</surname>
<given-names>SA</given-names>
</name>
</person-group>
<article-title>Protein-guided RNA dynamics during early ribosome assembly</article-title>
<source>Nature</source>
<year>2014</year>
<volume>506</volume>
<fpage>334</fpage>
<lpage>338</lpage>
</element-citation>
</ref>
<ref id="R5">
<label>(5)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Clementi</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Nymeyer</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Topological and energetic factors: What determines the structural details of the transition state ensemble and “en-route” intermediates for protein folding? An investigation for small globular proteins</article-title>
<source>J Mol Biol</source>
<year>2000</year>
<volume>298</volume>
<fpage>937</fpage>
<lpage>953</lpage>
</element-citation>
</ref>
<ref id="R6">
<label>(6)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Gosavi</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Schug</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Sanbonmatsu</surname>
<given-names>KY</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
</person-group>
<article-title>An all-atom structure-based potential for proteins: Bridging minimal models with all-atom empirical forcefields</article-title>
<source>Prot Struct Func Bioinfo</source>
<year>2009</year>
<volume>75</volume>
<fpage>430</fpage>
<lpage>441</lpage>
</element-citation>
</ref>
<ref id="R7">
<label>(7)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bryngelson</surname>
<given-names>JD</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
<name>
<surname>Socci</surname>
<given-names>ND</given-names>
</name>
<name>
<surname>Wolynes</surname>
<given-names>PG</given-names>
</name>
</person-group>
<article-title>Funnels, Pathways, And The Energy Landscape Of Protein-Folding - A Synthesis</article-title>
<source>Proteins</source>
<year>1995</year>
<volume>21</volume>
<fpage>167</fpage>
<lpage>195</lpage>
</element-citation>
</ref>
<ref id="R8">
<label>(8)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bryngelson</surname>
<given-names>JD</given-names>
</name>
<name>
<surname>Wolynes</surname>
<given-names>PG</given-names>
</name>
</person-group>
<article-title>Intermediates And Barrier Crossing In A Random Energy-Model (With Applications To Protein Folding)</article-title>
<source>J Phys Chem-Us</source>
<year>1989</year>
<volume>93</volume>
<fpage>6902</fpage>
<lpage>6915</lpage>
</element-citation>
</ref>
<ref id="R9">
<label>(9)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nguyen</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Steric interactions lead to collective tilting motion in the ribosome during mRNA-tRNA translocation</article-title>
<source>Nat Commun</source>
<year>2016</year>
<volume>7</volume>
<elocation-id>10586</elocation-id>
</element-citation>
</ref>
<ref id="R10">
<label>(10)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Noé</surname>
<given-names>F</given-names>
</name>
<name>
<surname>Daumke</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Mikhailov</surname>
<given-names>AS</given-names>
</name>
</person-group>
<article-title>Polymer-like Model to Study the Dynamics of Dynamin Filaments on Deformable Membrane Tubes</article-title>
<source>Biophys J</source>
<year>2019</year>
<volume>117</volume>
<fpage>1870</fpage>
<lpage>1891</lpage>
</element-citation>
</ref>
<ref id="R11">
<label>(11)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Faelber</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Dietrich</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Wollweber</surname>
<given-names>F</given-names>
</name>
<name>
<surname>Pfitzner</surname>
<given-names>A-K</given-names>
</name>
<name>
<surname>Mühleip</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Sanchez</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Kudryashev</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Chiaruttini</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Lilie</surname>
<given-names>H</given-names>
</name>
<etal/>
</person-group>
<article-title>Structure and assembly of the mitochondrial membrane remodelling GTPase Mgm1</article-title>
<source>Nature</source>
<year>2019</year>
<volume>571</volume>
<fpage>429</fpage>
<lpage>433</lpage>
</element-citation>
</ref>
<ref id="R12">
<label>(12)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>N</surname>
<given-names>G</given-names>
</name>
<name>
<surname>H</surname>
<given-names>T</given-names>
</name>
</person-group>
<article-title>Respective roles of short- and long-range interactions in protein folding</article-title>
<source>Proceedings of the National Academy of Science</source>
<year>1978</year>
<fpage>1</fpage>
<lpage>5</lpage>
</element-citation>
</ref>
<ref id="R13">
<label>(13)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Karanicolas</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Brooks</surname>
<given-names>CL</given-names>
</name>
</person-group>
<article-title>The importance of explicit chain representation in protein folding models: an examination of Ising-like models</article-title>
<source>Proteins</source>
<year>2003</year>
<volume>53</volume>
<fpage>740</fpage>
<lpage>7</lpage>
</element-citation>
</ref>
<ref id="R14">
<label>(14)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Best</surname>
<given-names>RB</given-names>
</name>
<name>
<surname>Chen</surname>
<given-names>Y-G</given-names>
</name>
<name>
<surname>Hummer</surname>
<given-names>G</given-names>
</name>
</person-group>
<article-title>Slow protein conformational dynamics from multiple experimental structures: the helix/sheet transition of arc repressor</article-title>
<source>Structure (London, England : 1993)</source>
<year>2005</year>
<volume>13</volume>
<fpage>1755</fpage>
<lpage>63</lpage>
</element-citation>
</ref>
<ref id="R15">
<label>(15)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Okazaki</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Koga</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Takada</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
<name>
<surname>Wolynes</surname>
<given-names>PG</given-names>
</name>
</person-group>
<article-title>Multiple-basin energy landscapes for large-amplitude conformational motions of proteins: Structure-based molecular dynamics simulations</article-title>
<source>Proc Nat Acad Sci USA</source>
<year>2006</year>
<volume>103</volume>
<fpage>11844</fpage>
<lpage>11849</lpage>
</element-citation>
</ref>
<ref id="R16">
<label>(16)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Whitford</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Miyashita</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Levy</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Conformational transitions of adenylate kinase: Switching by cracking</article-title>
<source>J Mol Biol</source>
<year>2007</year>
<volume>366</volume>
<fpage>1661</fpage>
<lpage>1671</lpage>
</element-citation>
</ref>
<ref id="R17">
<label>(17)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Clementi</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Garcia</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Interplay among tertiary contacts, secondary structure formation and side-chain packing in the protein folding mechanism: All-atom representation study of protein L</article-title>
<source>J Mol Biol</source>
<year>2003</year>
<volume>326</volume>
<fpage>933</fpage>
<lpage>954</lpage>
</element-citation>
</ref>
<ref id="R18">
<label>(18)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Cheung</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Finke</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Callahan</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Exploring the interplay between topology and secondary structural formation in the protein folding problem</article-title>
<source>J Phys Chem B</source>
<year>2003</year>
<volume>107</volume>
<fpage>11193</fpage>
<lpage>11200</lpage>
</element-citation>
</ref>
<ref id="R19">
<label>(19)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
<name>
<surname>Sanbonmatsu</surname>
<given-names>KY</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
</person-group>
<article-title>SMOG@ctbp: simplified deployment of structure-based models in GROMACS</article-title>
<source>Nucleic Acid Res</source>
<year>2010</year>
</element-citation>
</ref>
<ref id="R20">
<label>(20)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lindahl</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Hess</surname>
<given-names>B</given-names>
</name>
<name>
<surname>van der Spoel</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>GROMACS 3.0: A package for molecular simulation and trajectory analysis</article-title>
<source>J Mol Mod</source>
<year>2001</year>
<volume>7</volume>
<fpage>306</fpage>
<lpage>317</lpage>
</element-citation>
</ref>
<ref id="R21">
<label>(21)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Hess</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Kutzner</surname>
<given-names>C</given-names>
</name>
<name>
<surname>van der Spoel</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Lindahl</surname>
<given-names>E</given-names>
</name>
</person-group>
<article-title>GROMACS 4: Algorithms for highly efficient, load-balanced, and scalable molecular simulation</article-title>
<source>J Chem Theory Comput</source>
<year>2008</year>
<volume>4</volume>
<fpage>435</fpage>
<lpage>447</lpage>
</element-citation>
</ref>
<ref id="R22">
<label>(22)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Phillips</surname>
<given-names>JC</given-names>
</name>
<name>
<surname>Hardy</surname>
<given-names>DJ</given-names>
</name>
<name>
<surname>Maia</surname>
<given-names>JDC</given-names>
</name>
<name>
<surname>Stone</surname>
<given-names>JE</given-names>
</name>
<name>
<surname>Ribeiro</surname>
<given-names>JV</given-names>
</name>
<name>
<surname>Bernardi</surname>
<given-names>RC</given-names>
</name>
<name>
<surname>Buch</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Fiorin</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Hénin</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Jiang</surname>
<given-names>W</given-names>
</name>
<etal/>
</person-group>
<article-title>Scalable molecular dynamics on CPU and GPU architectures with NAMD</article-title>
<source>The Journal of Chemical Physics</source>
<year>2020</year>
<volume>153</volume>
<elocation-id>044130</elocation-id>
</element-citation>
</ref>
<ref id="R23">
<label>(23)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Plimpton</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Fast Parallel Algorithms for Short-Range Molecular Dynamics</article-title>
<source>Journal of Computational Physics</source>
<year>1995</year>
<volume>117</volume>
<fpage>1</fpage>
<lpage>19</lpage>
</element-citation>
</ref>
<ref id="R24">
<label>(24)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Eastman</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Swails</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Chodera</surname>
<given-names>JD</given-names>
</name>
<name>
<surname>McGibbon</surname>
<given-names>RT</given-names>
</name>
<name>
<surname>Zhao</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Beauchamp</surname>
<given-names>KA</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>L-P</given-names>
</name>
<name>
<surname>Simmonett</surname>
<given-names>AC</given-names>
</name>
<name>
<surname>Harrigan</surname>
<given-names>MP</given-names>
</name>
<name>
<surname>Stern</surname>
<given-names>CD</given-names>
</name>
<etal/>
</person-group>
<article-title>OpenMM 7: Rapid development of high performance algorithms for molecular dynamics</article-title>
<source>PLoS Comput Biol</source>
<year>2017</year>
<volume>13</volume>
<elocation-id>e1005659</elocation-id>
</element-citation>
</ref>
<ref id="R25">
<label>(25)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Levi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Raghunathan</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Lammert</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Hayes</surname>
<given-names>RL</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>SMOG 2: A Versatile Software Package for Generating Structure-Based Models</article-title>
<source>PLoS Comput Biol</source>
<year>2016</year>
<volume>12</volume>
<elocation-id>e1004794</elocation-id>
</element-citation>
</ref>
<ref id="R26">
<label>(26)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Suma</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Coronel</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Bussi</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Micheletti</surname>
<given-names>C</given-names>
</name>
</person-group>
<article-title>Directional translocation resistance of Zika xrRNA</article-title>
<source>Nature Communications</source>
<year>2020</year>
<volume>11</volume>
<elocation-id>3749</elocation-id>
</element-citation>
</ref>
<ref id="R27">
<label>(27)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Levi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Bandarkar</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Yang</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Mohanty</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Using SMOG 2 to simulate complex biomolecular assemblies</article-title>
<source>bioRxiv</source>
<year>2018</year>
</element-citation>
</ref>
<ref id="R28">
<label>(28)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Duan</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Wu</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Chowdhury</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Lee</surname>
<given-names>MC</given-names>
</name>
<name>
<surname>Xiong</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Yang</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Cieplak</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Luo</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Lee</surname>
<given-names>T</given-names>
</name>
<etal/>
</person-group>
<article-title>A point-charge force field for molecular mechanics simulations of proteins based on condensed-phase quantum mechanical calculations</article-title>
<source>J Comp Chem</source>
<year>2003</year>
<volume>24</volume>
<fpage>1999</fpage>
<lpage>2012</lpage>
</element-citation>
</ref>
<ref id="R29">
<label>(29)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
<name>
<surname>Jiang</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Serwer</surname>
<given-names>P</given-names>
</name>
</person-group>
<article-title>Simulations of Phage T7 Capsid Expansion Reveal the Role of Molecular Sterics on Dynamics</article-title>
<source>Viruses</source>
<year>2020</year>
<volume>12</volume>
</element-citation>
</ref>
<ref id="R30">
<label>(30)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Walls</surname>
<given-names>AC</given-names>
</name>
<name>
<surname>Park</surname>
<given-names>YJ</given-names>
</name>
<name>
<surname>Tortorici</surname>
<given-names>MA</given-names>
</name>
<name>
<surname>Wall</surname>
<given-names>A</given-names>
</name>
<name>
<surname>McGuire</surname>
<given-names>AT</given-names>
</name>
<name>
<surname>Veesler</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>Structure, Function, and Antigenicity of the SARS-CoV-2 Spike Glycoprotein</article-title>
<source>Cell</source>
<year>2020</year>
<volume>181</volume>
<fpage>281</fpage>
<lpage>292</lpage>
<elocation-id>e6</elocation-id>
</element-citation>
</ref>
<ref id="R31">
<label>(31)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wang</surname>
<given-names>Q</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Wu</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Niu</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Song</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Lu</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Qiao</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Hu</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Yuen</surname>
<given-names>KY</given-names>
</name>
<etal/>
</person-group>
<article-title>Structural and Functional Basis of SARS-CoV-2 Entry by Using Human ACE2</article-title>
<source>Cell</source>
<year>2020</year>
<volume>181</volume>
<fpage>894</fpage>
<lpage>904</lpage>
<elocation-id>e9</elocation-id>
</element-citation>
</ref>
<ref id="R32">
<label>(32)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wrapp</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Corbett</surname>
<given-names>KS</given-names>
</name>
<name>
<surname>Goldsmith</surname>
<given-names>JA</given-names>
</name>
<name>
<surname>Hsieh</surname>
<given-names>CL</given-names>
</name>
<name>
<surname>Abiona</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Graham</surname>
<given-names>BS</given-names>
</name>
<name>
<surname>McLellan</surname>
<given-names>JS</given-names>
</name>
</person-group>
<article-title>Cryo-EM structure of the 2019-nCoV spike in the prefusion conformation</article-title>
<source>Science</source>
<year>2020</year>
<volume>367</volume>
<fpage>1260</fpage>
<lpage>1263</lpage>
</element-citation>
</ref>
<ref id="R33">
<label>(33)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lan</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Ge</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Yu</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Shan</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Zhou</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Fan</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>Q</given-names>
</name>
<name>
<surname>Shi</surname>
<given-names>X</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>Q</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>L</given-names>
</name>
<etal/>
</person-group>
<article-title>Structure of the SARS-CoV-2 spike receptor-binding domain bound to the ACE2 receptor</article-title>
<source>Nature</source>
<year>2020</year>
<volume>581</volume>
<fpage>215</fpage>
<lpage>220</lpage>
</element-citation>
</ref>
<ref id="R34">
<label>(34)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Watanabe</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Allen</surname>
<given-names>JD</given-names>
</name>
<name>
<surname>Wrapp</surname>
<given-names>D</given-names>
</name>
<name>
<surname>McLellan</surname>
<given-names>JS</given-names>
</name>
<name>
<surname>Crispin</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>Site-specific glycan analysis of the SARS-CoV-2 spike</article-title>
<source>Science</source>
<year>2020</year>
<volume>2</volume>
<fpage>330</fpage>
<lpage>333</lpage>
</element-citation>
</ref>
<ref id="R35">
<label>(35)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Dodero-Rojas</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>P</given-names>
</name>
</person-group>
<article-title>Sterically-Confined Rearrangements of SARS-CoV-2 Spike Protein Control Cell Invasion</article-title>
<source>bioRxiv</source>
<year>2021</year>
</element-citation>
</ref>
<ref id="R36">
<label>(36)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhao</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Perilla</surname>
<given-names>JR</given-names>
</name>
<name>
<surname>Yufenyuy</surname>
<given-names>EL</given-names>
</name>
<name>
<surname>Meng</surname>
<given-names>X</given-names>
</name>
<name>
<surname>Chen</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Ning</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Ahn</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Gronenborn</surname>
<given-names>AM</given-names>
</name>
<name>
<surname>Schulten</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Aiken</surname>
<given-names>C</given-names>
</name>
<etal/>
</person-group>
<article-title>Mature HIV-1 capsid structure by cryo-electron microscopy and all-atom molecular dynamics</article-title>
<source>Nature</source>
<year>2013</year>
<volume>497</volume>
<fpage>643</fpage>
<lpage>646</lpage>
</element-citation>
</ref>
<ref id="R37">
<label>(37)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Savelyev</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Papoian</surname>
<given-names>GA</given-names>
</name>
</person-group>
<article-title>Molecular renormalization group coarse-graining of electrolyte solutions: Application to aqueous NaCl and KCl</article-title>
<source>J Phys Chem B</source>
<year>2009</year>
<volume>113</volume>
<fpage>7785</fpage>
<lpage>7793</lpage>
</element-citation>
</ref>
<ref id="R38">
<label>(38)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lindorff-Larsen</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Piana</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Palmo</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Maragakis</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Klepeis</surname>
<given-names>JL</given-names>
</name>
<name>
<surname>Dror</surname>
<given-names>RO</given-names>
</name>
<name>
<surname>Shaw</surname>
<given-names>DE</given-names>
</name>
</person-group>
<article-title>Improved side-chain torsion potentials for the Amber ff99SB protein force field</article-title>
<source>Prot Struct Func Bioinfo</source>
<year>2010</year>
<volume>78</volume>
<fpage>1950</fpage>
<lpage>1958</lpage>
</element-citation>
</ref>
<ref id="R39">
<label>(39)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wang</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Levi</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Mohanty</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Diffuse ions coordinate dynamics in a ribonucleoprotein assembly</article-title>
<source>bioRxiv</source>
<year>2021</year>
</element-citation>
</ref>
<ref id="R40">
<label>(40)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Perilla</surname>
<given-names>JR</given-names>
</name>
<name>
<surname>Schulten</surname>
<given-names>K</given-names>
</name>
</person-group>
<article-title>Physical properties of the HIV-1 capsid from all-atom molecular dynamics simulations</article-title>
<source>Nature Communications</source>
<year>2017</year>
<volume>8</volume>
<fpage>1</fpage>
<lpage>10</lpage>
</element-citation>
</ref>
<ref id="R41">
<label>(41)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Colussi</surname>
<given-names>TM</given-names>
</name>
<name>
<surname>Costantino</surname>
<given-names>DA</given-names>
</name>
<name>
<surname>Zhu</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Donohue</surname>
<given-names>JP</given-names>
</name>
<name>
<surname>Korostelev</surname>
<given-names>AA</given-names>
</name>
<name>
<surname>Jaa-far</surname>
<given-names>ZA</given-names>
</name>
<name>
<surname>Plank</surname>
<given-names>TDM</given-names>
</name>
<name>
<surname>Noller</surname>
<given-names>HF</given-names>
</name>
<name>
<surname>Kieft</surname>
<given-names>JS</given-names>
</name>
</person-group>
<article-title>Initiation of translation in bacteria by a structured eukaryotic IRES RNA</article-title>
<source>Nature</source>
<year>2015</year>
<volume>519</volume>
<fpage>110</fpage>
<lpage>113</lpage>
</element-citation>
</ref>
<ref id="R42">
<label>(42)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pettersen</surname>
<given-names>EF</given-names>
</name>
<name>
<surname>Goddard</surname>
<given-names>TD</given-names>
</name>
<name>
<surname>Huang</surname>
<given-names>CC</given-names>
</name>
<name>
<surname>Couch</surname>
<given-names>GS</given-names>
</name>
<name>
<surname>Greenblatt</surname>
<given-names>DM</given-names>
</name>
<name>
<surname>Meng</surname>
<given-names>EC</given-names>
</name>
<name>
<surname>Ferrin</surname>
<given-names>TE</given-names>
</name>
</person-group>
<article-title>UCSF Chimera-a visualization system for exploratory research and analysis</article-title>
<source>Journal of Computational Chemistry</source>
<year>2004</year>
<volume>25</volume>
<fpage>1605</fpage>
<lpage>1612</lpage>
</element-citation>
</ref>
<ref id="R43">
<label>(43)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>McPhalen</surname>
<given-names>CA</given-names>
</name>
<name>
<surname>James</surname>
<given-names>MNG</given-names>
</name>
</person-group>
<article-title>Crystal and molecular structure of the serine proteinase inhibitor CI-2 from barley seeds</article-title>
<source>Biochem</source>
<year>1987</year>
<volume>26</volume>
<fpage>261</fpage>
<lpage>269</lpage>
</element-citation>
</ref>
<ref id="R44">
<label>(44)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Muthurajan</surname>
<given-names>UM</given-names>
</name>
<name>
<surname>Bao</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Forsberg</surname>
<given-names>LJ</given-names>
</name>
<name>
<surname>Edayathumangalam</surname>
<given-names>RS</given-names>
</name>
<name>
<surname>Dyer</surname>
<given-names>PN</given-names>
</name>
<name>
<surname>White</surname>
<given-names>CL</given-names>
</name>
<name>
<surname>Luger</surname>
<given-names>K</given-names>
</name>
</person-group>
<article-title>Crystal structures of histone Sin mutant nucleosomes reveal altered protein-DNA interactions</article-title>
<source>EMBO J</source>
<year>2004</year>
<volume>23</volume>
<fpage>260</fpage>
<lpage>271</lpage>
</element-citation>
</ref>
<ref id="R45">
<label>(45)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Li</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Olson</surname>
<given-names>WK</given-names>
</name>
<name>
<surname>Lu</surname>
<given-names>X-J</given-names>
</name>
</person-group>
<article-title>Web 3DNA 2.0 for the analysis, visualization, and modeling of 3D nucleic acid structures</article-title>
<source>Nucleic Acid Res</source>
<year>2019</year>
<volume>47</volume>
<fpage>W26</fpage>
<lpage>W34</lpage>
</element-citation>
</ref>
<ref id="R46">
<label>(46)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Humphrey</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Dalke</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Schulten</surname>
<given-names>K</given-names>
</name>
</person-group>
<article-title>VMD: Visual molecular dynamics</article-title>
<source>J Mol Graph</source>
<year>1996</year>
<volume>14</volume>
<fpage>33</fpage>
<lpage>38</lpage>
</element-citation>
</ref>
<ref id="R47">
<label>(47)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Oliveira Junior</surname>
<given-names>AB</given-names>
</name>
<name>
<surname>Contessoto</surname>
<given-names>VG</given-names>
</name>
<name>
<surname>Mello</surname>
<given-names>MF</given-names>
</name>
<name>
<surname>Onuchic</surname>
<given-names>JN</given-names>
</name>
</person-group>
<article-title>A Scalable Computational Approach for Simulating Complexes of Multiple Chromosomes</article-title>
<source>J Mol Biol</source>
<year>2021</year>
<volume>433</volume>
<elocation-id>166700</elocation-id>
<comment>Diving into Chromatin across Space and Time</comment>
</element-citation>
</ref>
<ref id="R48">
<label>(48)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Chahine</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Leite</surname>
<given-names>VB</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Capturing transition paths and transition states for conformational rearrangements in the ribosome</article-title>
<source>Biophys J</source>
<year>2014</year>
<volume>107</volume>
<fpage>2881</fpage>
<lpage>2890</lpage>
</element-citation>
</ref>
<ref id="R49">
<label>(49)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Yang</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Noel</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Whitford</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Anisotropic fluctuations in the ribosome determine tRNA kinetics</article-title>
<source>J Phys Chem B</source>
<year>2017</year>
<volume>121</volume>
<fpage>10593</fpage>
<lpage>10601</lpage>
</element-citation>
</ref>
<ref id="R50">
<label>(50)</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Rozov</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Khusainov</surname>
<given-names>I</given-names>
</name>
<name>
<surname>El Omari</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Duman</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Mykhaylyk</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Yusupov</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Westhof</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Wagner</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Yusupova</surname>
<given-names>G</given-names>
</name>
</person-group>
<article-title>Importance of potassium ions for ribosome structure and function revealed by long-wavelength X-ray diffraction</article-title>
<source>Nature Communications</source>
<year>2019</year>
<volume>10</volume>
<fpage>2519</fpage>
<lpage>12</lpage>
</element-citation>
</ref>
</ref-list>
</back>
<floats-group>
<fig id="F1" position="float">
<label>Figure 1</label>
<caption>
<title>The SMOG2/OpenSMOG pipeline</title>
<p>SMOG v2.4 introduces support for the OpenSMOG libraries, which allow a wide range of SMOG model variants to be applied in OpenMM. While SMOG 2 and OpenSMOG are two distinct software elements, they have been co-designed to interface and provide integrated support for SMOG models. There is support for preprocessing of PDB structures, force field generation, as well as execution of GPU-accelerated simulations in OpenMM. While previous SMOG models have had general support by Gromacs, and partial support from NAMD, LAMMPS and openMM, the OpenSMOG framework extends support by enabling increased levels of model customization. In terms of work flow, SMOG 2 reads a PDB file and generates all files required to perform an MD simulation using the OpenSMOG module in OpenMM.</p>
</caption>
<graphic xlink:href="EMS140772-f001"/>
</fig>
<fig id="F2" position="float">
<label>Figure 2</label>
<caption>
<title>Versatile support for contact potentials in OpenSMOG</title>
<p>The SMOG2/OpenSMOG framework allows for a wide range of contact potentials to be employed. This figure depicts the energy function given by <xref ref-type="disp-formula" rid="FD1">equation 1</xref>.</p>
</caption>
<graphic xlink:href="EMS140772-f002"/>
</fig>
<fig id="F3" position="float">
<label>Figure 3</label>
<caption>
<title>Global rearrangements of the SARS-CoV-2 Spike Glycoprotein</title>
<p>A) Structural model of the prefusion conformation of the S2 subunit of Spike protein. Glycans are shown in yellow. Blue circles indicate the positions of monosaccharide-monosaccharide bonds and red circles show monosaccharide-Asn bonds. B) Postfusion conformation of the S2 subunit of the Spike Protein. C) RMSD from the postfusion structure for a representative simulation with a SMOG model of the prefusion-to-postfusion rearrangement.</p>
</caption>
<graphic xlink:href="EMS140772-f003"/>
</fig>
<fig id="F4" position="float">
<label>Figure 4</label>
<caption>
<title>Simulations of the HIV-1 capsid with diffuse ions</title>
<p>A) Cryo-EM structure of the HIV-1 capsid (cyan; PDB 3J3Q<sup>
<xref ref-type="bibr" rid="R36">36</xref>
</sup>). B) System simulated with a SMOG model, where the HIV-1 capsid is in the presence of 10 mM MgCl<sub>2</sub> and 100 mM KCl (cubic box of linear dimensions 200 nm). Diffuse ions appear as small dots. C) From a simulation with a SMOG model variant that includes electrostatics, we calculated the number of Mg<sup>2+</sup> (blue), K<sup>+</sup> (orange) and Cl<sup>−</sup> (green) ions that are within 1 nm of the capsid. After a few million time steps, the system visibly begins to equilibrate, where the average number of each type of ion approaches an asymptotic value.</p>
</caption>
<graphic xlink:href="EMS140772-f004"/>
</fig>
<fig id="F5" position="float">
<label>Figure 5</label>
<caption>
<title>Probing the influence of crystallographic contacts on dynamics</title>
<p>A) Crystallographic structure of a bacterial ribosome (PDB ID:4XEJ<sup>
<xref ref-type="bibr" rid="R41">41</xref>
</sup>), with rRNA shown in white and proteins shown in blue. B) 15-ribosome cluster, where the arrangement corresponds to the experimental crystallographic lattice positions. The central ribosome (white) closely contacts 14 neighboring ribosomes (non-white). C) Spatial RMSF values, by residue, calculated from simulations of an isolated ribosome (panel A) and the central ribosome of the crystallographic cluster (panel B). Dashed line shows a slope of 1 (i.e. identical fluctuations in both systems). While the RMSF values of many residues are minimally impacted (light brown), there are multiple extended regions (protein L9, L1 stalk, 30S beak and spur) that are significantly more mobile in the isolated ribosome. D) Structure of the ribosome, colored by regions designated in panel C.</p>
</caption>
<graphic xlink:href="EMS140772-f005"/>
</fig>
<fig id="F6" position="float">
<label>Figure 6</label>
<caption>
<title>Simulating nucleosomes</title>
<p>top) Artificial 300-nucleosome system, where each DNA strand (blue) has 1131600 atoms. There are also 2400 histone proteins (pink), for a total of 4060200 atoms. bottom) Zoomed-in view of a 10 nucleosome segment that is associated with a single dsDNA helix. Recent improvements in SMOG 2 allow for the rapid generation of all-atom structure-based models for systems of this size. Systems that have up to 1000 nucleosomes were successfully tested.</p>
</caption>
<graphic xlink:href="EMS140772-f006"/>
</fig>
<fig id="F7" position="float">
<label>Figure 7</label>
<caption>
<title>Simulating subsystems with SMOG</title>
<p>A) Structure of a complete bacterial ribosome (PDB 6QNR<sup>
<xref ref-type="bibr" rid="R50">50</xref>
</sup>), with the rRNA (white), proteins (blue) and tRNA (yellow and red) shown. B) After generating a structure-based model with SMOG 2, the <monospace>smog_extract</monospace> tool allows one to reduce the system size while preserving interactions present in the full assembly. Spheres indicate which atoms at the boundaries have interactions removed during truncation. Position restraints can be automatically applied to boundary atoms, to ensure the system maintains its overall structure. C) Position restraints may be refined,<sup>
<xref ref-type="bibr" rid="R48">48</xref>
</sup> such that the dynamics of the subsystem boundary is consistent with the dynamics of the full assembly (labeled reference).</p>
</caption>
<graphic xlink:href="EMS140772-f007"/>
</fig>
<table-wrap id="T1" orientation="portrait" position="float">
<label>Table 1</label>
<caption>
<title>Files generated by SMOG 2 that are input for OpenSMOG</title>
</caption>
<table frame="box" rules="all">
<thead>
<tr>
<th align="left" valign="top">suffix</th>
<th align="left" valign="top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">.gro</td>
<td align="left" valign="top">Gromacs-formatted coordinate file</td>
</tr>
<tr>
<td align="left" valign="middle">.top</td>
<td align="left" valign="top">Gromacs-formatted force field file. Contains all bonded information (bonds, angles, torsion, improper) and non-specific vdW parameters</td>
</tr>
<tr>
<td align="left" valign="top">.xml</td>
<td align="left" valign="top">Contains all contact interactions for the system</td>
</tr>
</tbody>
</table>
</table-wrap>
<table-wrap id="T2" orientation="portrait" position="float">
<label>Table 2</label>
<caption>
<p>Default output files when using OpenSMOG. Default file name is given by the variable “name” in Listing 3, with a suffix defined below.</p>
</caption>
<table frame="box" rules="all">
<thead>
<tr>
<th align="left" valign="top">suffix</th>
<th align="left" valign="top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">_trajectory.dcd</td>
<td align="left" valign="top">contains atomic positions for each frame</td>
</tr>
<tr>
<td align="left" valign="middle">_energy.csv</td>
<td align="left" valign="top">contains the potential energy, kinetic energy, total energy and temperature</td>
</tr>
<tr>
<td align="left" valign="middle">_energy_components.csv</td>
<td align="left" valign="top">contains the potential energy associated with each force group in the system</td>
</tr>
</tbody>
</table>
</table-wrap>
</floats-group>
</article>
