<!DOCTYPE article
 PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="preprint"><?all-math-mml yes?><?use-mml?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-title-group><journal-title>bioRxiv : the preprint server for biology</journal-title></journal-title-group><issn pub-type="ppub"/></journal-meta><article-meta><article-id pub-id-type="manuscript">EMS177474</article-id><article-id pub-id-type="doi">10.1101/2021.11.03.467004</article-id><article-id pub-id-type="archive">PPR415607</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">2</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Discordance between different bioinformatic methods for identifying resistance genes from short-read genomic data, with a focus on <italic>Escherichia coli</italic></article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Davies</surname><given-names>Timothy J</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Swan</surname><given-names>Jeremy</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Sheppard</surname><given-names>Anna E</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Pickford</surname><given-names>Hayleah</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Lipworth</surname><given-names>Samuel</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>AbuOun</surname><given-names>Manal</given-names></name><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Ellington</surname><given-names>Matthew</given-names></name><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A5">e</xref></contrib><contrib contrib-type="author"><name><surname>Fowler</surname><given-names>Philip W</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib><contrib contrib-type="author"><name><surname>Hopkins</surname><given-names>Susan</given-names></name><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A5">e</xref></contrib><contrib contrib-type="author"><name><surname>Hopkins</surname><given-names>Katie L</given-names></name><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A6">f</xref></contrib><contrib contrib-type="author"><name><surname>Crook</surname><given-names>Derrick W</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A4">d</xref></contrib><contrib contrib-type="author"><name><surname>Peto</surname><given-names>Tim EA</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A4">d</xref></contrib><contrib contrib-type="author"><name><surname>Anjum</surname><given-names>Muna F</given-names></name><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Walker</surname><given-names>A Sarah</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref><xref ref-type="fn" rid="FN1">*</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Stoesser</surname><given-names>Nicole</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="aff" rid="A2">b</xref><xref ref-type="aff" rid="A4">d</xref><xref ref-type="fn" rid="FN1">*</xref></contrib></contrib-group><aff id="A1"><label>a</label>Nuffield Department of Medicine, Oxford University, Oxford, United Kingdom</aff><aff id="A2"><label>b</label>National Institute for Health Research (NIHR) Health Protection Research Unit on Healthcare Associated Infections and Antimicrobial Resistance at University of Oxford, UK</aff><aff id="A3"><label>c</label>Bacteriology, Animal and Plant Health Agency, Surrey UK</aff><aff id="A4"><label>d</label>Oxford University Hospitals NHS Foundation Trust, Oxford, UK</aff><aff id="A5"><label>e</label>Antimicrobial Resistance and Healthcare Associated Infections (AMRHAI) Division, UK Health Security Agency, London, UK</aff><aff id="A6"><label>f</label>HCAI, Fungal, AMR, AMU and Sepsis Division, UK Health Security Agency, London, UK</aff><author-notes><corresp id="CR1"><bold>1.3 Corresponding author</bold> <italic>Dr Timothy Davies, <email>timothy.davies@ndm.ox.ac.uk</email>; Alternate corresponding author: Dr Nicole Stoesser, <email>nicole.stoesser@ndm.ox.ac.uk</email></italic></corresp><fn id="FN1" fn-type="equal"><label>*</label><p id="P1">contribution considered equal</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>06</day><month>07</month><year>2023</year></pub-date><pub-date pub-type="preprint"><day>21</day><month>06</month><year>2023</year></pub-date><permissions><ali:free_to_read/><license><ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International license</ext-link>.</license-p></license></permissions><abstract><p id="P2">Several bioinformatics genotyping algorithms are now commonly used to characterise antimicrobial resistance (AMR) gene profiles in whole genome sequencing (WGS) data, with a view to understanding AMR epidemiology and developing resistance prediction workflows using WGS in clinical settings. Accurately evaluating AMR in Enterobacterales, particularly <italic>Escherichia coli</italic>, is of major importance, because this is a common pathogen. However, robust comparisons of different genotyping approaches on relevant simulated and large real-life WGS datasets are lacking. Here, we used both simulated datasets and a large set of real <italic>E. coli</italic> WGS data (n=1818 isolates) to systematically investigate genotyping methods in greater detail.</p><p id="P3">Simulated constructs and real sequences were processed using four different bioinformatic programs (ABRicate, ARIBA, KmerResistance, and SRST2, run with the ResFinder database) and their outputs compared. For simulations tests where 3,079 AMR gene variants were inserted into random sequence constructs, KmerResistance was correct for 3,076 (99.9%) simulations, ABRicate for 3,054 (99.2%), ARIBA for 2,783 (90.4%) and SRST2 for 2,108 (68.5%). For simulations tests where two closely related gene variants were inserted into random sequence constructs, KmerResistance the correct alleles in 35,338/46,318 (76.3%) ABRicate identified in 11,842/46,318 (25.6%) of simulations, ARIBA in 1679/46,318 (3.6%), and SRST2 in 2000/46,318 (4.3%). In real data, across all methods, 1392/1818 (76%) isolates had discrepant allele calls for at least one gene.</p><p id="P4">Our evaluations revealed poor performance in scenarios that would be expected to be challenging (e.g. identification of AMR genes at &lt;10x coverage, discriminating between closely related AMR gene sequences), but also identified systematic sequence classification (i.e. naming) errors even in straightforward circumstances, which contributed to 1081/3092 (35%) errors in our most simple simulations and at least 2530/4321 (59%) discrepancies in real data. Further, many of the remaining discrepancies were likely “artefactual” with reporting cut-off differences accounting for at least 1430/4321 (33%) discrepants. Comparing outputs generated by running multiple algorithms on the same dataset can help identify and resolve these artefacts, but ideally new and more robust genotyping algorithms are needed.</p></abstract><kwd-group><kwd>Antimicrobial resistance genotyping</kwd><kwd>genomics</kwd><kwd>Escherichia coli</kwd><kwd>resistance prediction</kwd></kwd-group></article-meta></front><body><sec id="S1" sec-type="intro"><label>4</label><title>Introduction</title><p id="P5">Whole genome sequencing (WGS) has become a major tool for characterising the epidemiology of bacterial antimicrobial resistance (AMR) genes, representing a potentially highly discriminatory, non-targeted approach with significant advantages over other more targeted molecular techniques(<xref ref-type="bibr" rid="R1">1</xref>). In addition, WGS-based antibiotic susceptibility prediction has been successfully implemented as part of diagnostic and treatment workflows for <italic>Mycobacterium tuberculosis</italic>(<xref ref-type="bibr" rid="R2">2</xref>). Accurate WGS-based profiling of complete AMR gene content and prediction of susceptibility phenotypes would represent an attractive option for other commonly encountered clinical bacterial pathogens, such as Enterobacterales, including <italic>Escherichia coli</italic>.</p><p id="P6">Several key components are required for WGS-based AMR genotyping and predictions of susceptibility phenotype, including a robust AMR gene reference catalogue linking each genetic mechanism/sequence with a given phenotype, and accurate AMR gene identification and classification algorithms. Several catalogues and bioinformatics algorithms are now available(<xref ref-type="bibr" rid="R3">3</xref>–<xref ref-type="bibr" rid="R9">9</xref>), but only limited comparative evaluation of their outputs has been undertaken. The genetic mechanisms underpinning AMR in Enterobacterales and some other bacteria (e.g. <italic>Pseudomonas aeruginosa</italic>) are much more complex than those in <italic>M. tuberculosis</italic>, and whilst some studies suggest that WGS-based genotyping holds promise for AMR gene characterisation and the prediction of antimicrobial susceptibility for several different Enterobacterales species(<xref ref-type="bibr" rid="R10">10</xref>–<xref ref-type="bibr" rid="R12">12</xref>), the limited reproducibility and reliability of such methods in a blinded, head-to-head analysis across nine bioinformatics teams has been recently highlighted(<xref ref-type="bibr" rid="R13">13</xref>). However, this study was small (n=10 sequencing datasets, n=7 isolates), encountered a limited set of typing discrepancies, and used highly selected samples, meaning the impact of these issues on larger, real-world datasets remains unclear.</p><p id="P7">We therefore used simulations and three large, independent and diverse <italic>E. coli</italic> sequencing datasets to investigate the robustness and reproducibility of four widely-used WGS-based AMR genotyping methods (ABRicate, ARIBA, KmerResistance, and SRST2) at scale, investigating any encountered discrepancies.</p></sec><sec id="S2" sec-type="methods"><label>5</label><title>Methods</title><sec id="S3"><title>AMR gene identification methods</title><p id="P8">We evaluated the impact of different bioinformatics tools using the same AMR gene catalogue, namely the ResFinder database (v.29/10/2019). At the time the study was designed (March 2018), to be included bioinformatics tools had to: (i) have publicly available code, (ii) run on local computing architecture without major modification, (iii) accept different AMR gene databases to ensure broad and long-term typing usability, and (iv) have a command line interface that could enable batch processing of large numbers of samples (<xref ref-type="supplementary-material" rid="SD1">Table S1</xref>).</p><p id="P9">We identified four publicly available bioinformatic tools that met these criteria and used distinct AMR gene identification approaches: ABRicate(<xref ref-type="bibr" rid="R14">14</xref>) (which searches for AMR genes in assemblies using <italic>BLA</italic>STn), SRST2(<xref ref-type="bibr" rid="R7">7</xref>) (which maps reads directly onto the formatted AMR gene database using Bowtie 2), ARIBA(<xref ref-type="bibr" rid="R6">6</xref>) (which combines these two approaches, first mapping reads to the AMR gene database using minimap, and then creating local assemblies of the mapped reads using Fermi-lite) and KmerResistance(<xref ref-type="bibr" rid="R8">8</xref>) (which analyses shared k-mers between the query sequences and reference sequences in the AMR gene database) (<xref ref-type="supplementary-material" rid="SD1">Fig. S1</xref>). To mimic broad usability, each program was run using default parameters. For ABRicate, assemblies were first produced using SPAdes(<xref ref-type="bibr" rid="R15">15</xref>) run with default parameters.</p></sec><sec id="S4"><title>Simulated data:single and multiple allele identification, and low coverage scenarios</title><p id="P10">Prior to evaluating real data, we considered the accuracy of each method in identifying known AMR gene alleles “inserted” into simulated flanking sequence constructs. For this, each AMR gene variant in the ResFinder database (n=3,079) was flanked by 1kb of random sequence (using Numpy v1.16.4(<xref ref-type="bibr" rid="R16">16</xref>) and combined using BioPython(<xref ref-type="bibr" rid="R17">17</xref>) v1.74) and reads simulated at 40x coverage using ART (details and rationale in <xref ref-type="supplementary-material" rid="SD1">Supplementary Methods</xref>, <xref ref-type="fig" rid="F1">Fig. 1</xref>, <xref ref-type="supplementary-material" rid="SD1">S2</xref>). Other ART parameters were: error profile=“HISEQ2500”, mean DNA fragment length (standard deviation)=480bp (150bp), and read length=151bp. Each bioinformatic method was then tested to see if it could correctly identify the AMR gene variant, using default parameters. We repeated this 10 times to assess variability across repeats.</p><p id="P11">We also considered two <italic>a priori</italic> scenarios that are thought to affect AMR genotyping(<xref ref-type="bibr" rid="R18">18</xref>), namely a <italic>multiple allele scenario</italic> in which multiple closely genetically related alleles (see below) of a given AMR gene were present, and a <italic>low quality</italic> scenario reflected by low sequencing coverage. For the <italic>multiple allele</italic> scenario we excluded target AMR gene variants that were incorrectly identified individually by any method (see Results), and then calculated pairwise nucleotide similarity between all remaining AMR gene variants. To do this, each remaining AMR gene variant was split into 31-mers, which were then compared with 31-mer sets from every other non-excluded AMR gene variant using pairwise Jaccard’s similarity indices. AMR gene variant pairs were defined as similar if they shared any 31-mer, resulting in a total of 46,318 possible similar AMR gene variant pairs (<xref ref-type="supplementary-material" rid="SD1">Fig. S3</xref>-<xref ref-type="supplementary-material" rid="SD1">S5</xref>).</p><p id="P12">For the <italic>low coverage scenario</italic>, reads were simulated from 176 <italic>bla</italic><sub>TEM</sub> gene-containing constructs at coverage depths ranging from 1x to 50x using ART (n=176*50=8,800 simulations), reflecting total <italic>bla</italic><sub>TEM</sub> diversity present in the ResFinder database at the time of simulation. Each construct contained a random perfect reference <italic>bla</italic><sub>TEM</sub> variant flanked by 1kb of random sequence on each side produced using Numpy/BioPython as above. Simulated reads were then processed by each genotyping method using default settings and the identified variants were compared with the known <italic>bla</italic><sub>TEM</sub> variants present in each construct. The measure of performance for this scenario was the proportion of <italic>bla</italic><sub>TEM</sub> variants correctly identified by each method at each coverage level.</p></sec><sec id="S5"><title>Real data:Isolate selection</title><p id="P13">To evaluate performance on real data, we then studied a total of 1,818 <italic>E. coli</italic> isolates comprising three different WGS datasets in order to reflect different strain-level and AMR gene diversity: (i) 984 sequentially collected bloodstream infection isolates at Oxford University Hospitals (OUH) NHS Foundation Trust(<xref ref-type="bibr" rid="R19">19</xref>) (“Oxford dataset”); (ii) 497 animal commensal <italic>E. coli</italic> isolates donated by the UK Animal and Plant Health Agency (APHA)(<xref ref-type="bibr" rid="R20">20</xref>) (“APHA dataset”), and (iii) 337 <italic>E. coli</italic> isolates collected by UK Health Security Agency’s (UKHSA) Antimicrobial Resistance and Healthcare Associated Infections (AMRHAI) Reference Unit, which investigates isolates enriched for rare or important resistance genotypes encountered in the UK (sequenced for this study, “UKHSA dataset”).</p><p id="P14">Isolates were re-cultured from frozen stocks stored in nutrient broth plus 10% glycerol at -80°C. DNA was extracted using the QuickGene DNA Tissue Kit S (Kurabo Industries, Japan) as per manufacturer’s instructions, with an additional mechanical lysis step (FastPrep, MP Biomedicals, USA) immediately following chemical lysis. A combination of standard Illumina and in-house protocols were used to produce multiplexed paired-end libraries, which were sequenced on an Illumina HiSeq 2500, generating 151bp paired-end reads. High quality sequences were de-novo assembled using Velvet(<xref ref-type="bibr" rid="R21">21</xref>) as previously described(<xref ref-type="bibr" rid="R22">22</xref>). <italic>In silico</italic> Achtman(<xref ref-type="bibr" rid="R23">23</xref>) multi-locus sequence types (MLST) types were defined using ARIBA(<xref ref-type="bibr" rid="R6">6</xref>).</p><p id="P15">While this work does not attempt to predict resistance from WGS data, each isolate had linked AST (summarized in <xref ref-type="supplementary-material" rid="SD1">Table S2</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S6</xref>), which we have included as the complexity of resistance genotype identification is associated with the phenotype. Isolates had complete AST data available for: ampicillin, ceftazidime and one other 3rd generation cephalosporin (cefotaxime for the animal commensal isolates, ceftriaxone for all others), gentamicin, ciprofloxacin, and co-trimoxazole.</p><p id="P16">We compared AMR genotypes reported for each isolate by each method (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Reported alleles were grouped into gene families using 17-mers .Discrepancies were classified according to which of the four bioinformatics methods agreed. The cause of discrepancy was investigated for all patterns occurring in at least 10 isolates. To investigate less common errors we assessed all discrepancies which affected <italic>bla</italic><sub>TEM</sub> alleles.</p></sec></sec><sec id="S6" sec-type="results"><label>6</label><title>Results</title><sec id="S7"><title>Simulated scenarios</title><sec id="S8"><title>Accurate identification of single AMR gene variants in simulated sequence constructs</title><p id="P17">For the 3,079 AMR gene variants in the ResFinder database, all four genotyping methods correctly identified those inserted into random sequence contexts for all repeats in 1999 (64.9%) cases. ARIBA was the only tool to intermittently correctly identify alleles across repeats (N=42/3079 (1.3%) alleles), being always correct for 2,783/3,079 (90.4%) alleles. All other tools were consistent across repeats, with KmerResistance being correct for 3,076 (99.9%) simulations, ABRicate for 3,054 (99.2%), and SRST2 for 2,108 (68.5%) (<xref ref-type="fig" rid="F2">Fig. 2</xref>). For SRST2, most errors were due to its approach of pre-clustering reference sequences into sub-families by sequence identity prior to genotyping, thereby essentially excluding <italic>a priori</italic> the possibility of identifying alleles that were not selected as the representative for these sub-family clusters. This error is explained in more detail below as it also affected genotyping in real isolate sequences.</p></sec><sec id="S9"><title>Impact of the presence of multiple closely related alleles on genotyping calls</title><p id="P18">The multiple allele simulation caused problems for all algorithms. Overall, KmerResistance was the most successful, identifying both correct genes in 35338/46318 (76%) of scenarios (<xref ref-type="table" rid="T1">Table 1</xref>). By contrast the next most successful was ABRicate, achieving this in 11842/46318 (26%) with the remaining tools, ARIBA and SRST2 only achieving this in 1679 (4%) and 2000 (4%) scenarios respectively. In addition, assembly-based algorithms frequently failed to completely assemble genes, with ABRicate and ARIBA reporting fragmented/incomplete alleles for 26848/58499 (46%) and 2483/18830 (13%) of the correct alleles they identified respectively. SRST2, as expected, found only a single allele in most (33319/46,318 (72%)) cases, as dictated by its clustering parameters. Unsurprisingly all four programs were most likely to make erroneous genotyping calls as the simulated pairs of alleles became more closely related (<xref ref-type="supplementary-material" rid="SD1">Fig. S7a</xref>, <xref ref-type="supplementary-material" rid="SD1">Fig. S7b</xref>).</p></sec><sec id="S10"><title>Impact of sequencing depth on genotyping calls</title><p id="P19">KmerResistance was able to identify <italic>bla</italic><sub>TEM</sub> alleles at lower coverage than any of the other methods (<xref ref-type="fig" rid="F3">Fig. 3</xref>). Above 15x depth of coverage for the gene, all methods correctly identified <italic>bla</italic><sub>TEM</sub> alleles in simulated constructs in &gt; 95% of cases (<xref ref-type="fig" rid="F3">Fig. 3</xref>). All methods were able to identify all of the <italic>bla</italic><sub>TEM</sub> alleles correctly at least once, but examples existed for all methods where the allele was correctly identified at low coverage, but then mis-classified at higher coverage. In general, ABRicate and SRST2, while requiring greater sequencing depth to correctly identify <italic>bla</italic><sub>TEM</sub> alleles initially were more accurate at higher coverage depths, making erroneous calls for only 1/176 (0.6%) and 0/176 (0%) of <italic>bla</italic><sub>TEM</sub> alleles at depths &gt;20x. In contrast, for &gt;20x coverage ARIBA and KmerResistance made erroneous allele calls for 23/176 (13%) and 6/176 (3%) <italic>bla</italic><sub>TEM</sub> variants respectively. Above 40x coverage ABRicate was incorrect for one (0.6%), ARIBA for four (2%), KmerResistance for one (0.6%), and SRST2 for zero (0%) simulated <italic>bla</italic><sub>TEM</sub> alleles.</p></sec></sec><sec id="S11"><title>Real data</title><sec id="S12"><title>E. coli isolate diversity, antimicrobial susceptibility phenotypes and antimicrobial resistance genotypes</title><p id="P20">The 1,818 isolates were diverse, representing &gt;260 multi-locus sequence types (STs), which were differentially distributed among the datasets. For example, although ST131 was the most common (207/1818 (11%) isolates), this was largely due to the fact it was by far the most common in the UKHSA dataset (74/337 (22%) isolates). In the Oxford dataset, it was only the second most common ST (123/984 (13%) isolates) after ST73 (161/984 (16%)) isolates) and it was rare in the APHA isolates (10/497 isolates (2%)).</p><p id="P21">Correspondingly, the set also contained a broad range of resistance genes, but the exact number was dependant on the method of search. For legibility, we have included results as reported by ABRicate as this is the most conceptually simple and interrogatable approach.. The commonest AMR-associated sequence identified was <italic>mdfA</italic>. This is known to be universal in <italic>E. coli</italic>, and correspondingly was identified in all 1,818 isolates in the dataset. There were no other ubiquitous AMR genes; however, several were common across datasets, with <italic>bla</italic><sub>TEM</sub>, <italic>aad</italic>A, <italic>sul, tet</italic>, and <italic>dfr</italic> genes occurring in &gt;40% of the isolates. As expected, more UKHSA isolates contained extended-spectrum beta-lactamase (54/337 vs 94/1481) and carbapenemase (18/337 vs 1/1481) genes (p=&lt;0.001). Aside from <italic>bla</italic><sub>TEM</sub>, other beta-lactamases were rare among the APHA dataset. Outside of beta-lactam-associated AMR genes, the Oxford dataset had the lowest proportion of other AMR genes for all the different gene families encountered in this study.</p></sec><sec id="S13"><title>Genotyping discrepancies</title><p id="P22">10487 different genes (N=15588 different alleles) were identified in the 1818 isolates by the four methods. 1392/1818 (76%) isolates had discrepancies across the four bioinformatics methods for at least one gene. At the gene-level, aside from for <italic>tet, aadA</italic> and <italic>cat</italic> genes, the performance of the bioinformatic tools was similar (<xref ref-type="fig" rid="F4">Fig. 4</xref>, <bold>panel a</bold>), with tools reporting each gene in the approximately same proportion of isolates (within +/-2%). With regards to the three outliers, ABRicate reported <italic>tet</italic> and <italic>aadA</italic> genes in 19% and 10% more isolates respectively than the other three tools, and ABRicate and KmerResistance reported <italic>cat</italic> genes in 5% more isolates than ARIBA and SRST2. By contrast, the alleles reported by each tool were often discrepant, with alleles of some genes <italic>(</italic>e.g. <italic>blaSHV, blaCMY)</italic> consistently being differentially reported (<xref ref-type="fig" rid="F4">Fig. 4</xref>, <bold>panel b</bold>). Consequently, pairwise agreement between any two different tools was less than 59% (N=1065 isolates, <xref ref-type="fig" rid="F4">Fig. 4</xref>, <bold>panel c</bold>). While unsupported genotype reports (i.e. where the output of one tool was not supported by any other) were common for all tools (<xref ref-type="fig" rid="F5">Fig. 5</xref>), KmerResistance reported fewer unsupported genotypes than the other three tools (p&lt;0.001).</p></sec><sec id="S14"><title>Causes of genotyping discrepancy</title><p id="P23">At least 2530/4321 (59%) of allele-level discrepancies were due to programs naming the same underlying sequence differently (annotation differences). We identified three different causes of differences through investigation of discrepantly reported genes: differences due to difficulty distinguishing between optimal matches among alleles with nested sequences (N=1737 genes), spurious identification of additional alleles due to reads being multiply mapped to distant variants of the same allelic family (N=547 genes), and finally tools choosing different optimal matches based on optimal DNA sequence alignment when the database only contains one sequence per protein (N=197) (<xref ref-type="fig" rid="F6">Fig. 6</xref>). These issues occurred alone in 1944/2530 (77%) discrepantly reported genes, and correspondingly 586/2530 (23%) had multiple issues occurring in combination. In isolation these errors typically caused only a single method to be discordant, but when combined resulted in more complex patterns of discrepancy and could make all four methods disagree with one another. In addition to annotation, ABRicate’s lesser requirement for complete gene coverage (which aims to mitigate assembly errors) caused at least 1430/4321 (33%) allele-level discrepancies. Discrepancies less easily classified as (but still possibly related to) annotation/cut-offs did occur, but thankfully only affected 381/10487 (4%) of reported genotypes.</p></sec><sec id="S15"><title>Annotation related discrepancies</title><p id="P24">The most common type of annotation error (N=1737 genes) was the result of tools struggling to choose optimal matches when the database contains nested sequences. One such example of this seen in our data caused by the sequences for two different <italic>dfrA7</italic> alleles in the October 2019 Resfinder database, dfrA7_1_AB161450 and dfrA7_5_AJ419170. The shorter of the two (dfrA7_1_AB161450, 474 base pairs long) aligns almost perfectly (percentage identity = 99%, 1 single nucleotide gap) with the first 473 bases of dfrA7_5_AJ419170. ARIBA, KmerResistance and SRST2, which look for the best identity sequence matches, all report the sample contains a perfect match for dfrA7_1_AB161450. By contrast ABRicate, which uses <italic>BLA</italic>ST to identify optimal sequences, reports the sample contains a near perfect match to dfrA7_5_AJ419170, as with this being a longer match it is more statistically significant. This then occurs each time <italic>a dfrA7</italic> allele is encountered, occurring 24 times in our dataset. Similar errors occur for several other genes, including <italic>sul, tet, aph(<xref ref-type="bibr" rid="R6">6</xref>)</italic>, and <italic>aac(<xref ref-type="bibr" rid="R3">3</xref>)</italic>.</p><p id="P25">The second most common annotation discrepancy (N=547 genes) was tools reporting multiple alleles due to reads mapping to two or more distant variants of the same allelic family. An example seen in our data is both ARIBA and SRST2 reporting multiple <italic>bla</italic><sub>SHV</sub> alleles. In this instance, ARIBA and SRST2 identify a primary perfect allele and a second allele with a lower quality match. These multiple matches however were likely spurious, with &lt;10 reads mapping individually to each allele, no clear heterozygosity observed in read pileups, and no fragmentation in assembly graphs. This is the result of a biproduct of how mapping methods identify optimal matches. Both ARIBA and SRST2 map reads to each sequence in the database, and then compare “closely related” sequences to decide which mapping is optimal. Defining “closely related” however is not straightforward (<xref ref-type="supplementary-material" rid="SD1">Fig. S8</xref>). Reads mapping to more than one set of “closely related” sequences can result in tools finding multiple gene variants when the isolate only had one gene original</p><p id="P26">The final common annotation discrepancy (N=197 genes) was because many tools select the allele to report on the basis of which sequence in the database had the optimal DNA alignment with the target resistance gene. Resistance gene nomenclature is generally based on proteins however, and consequently resistance databases often only catalogue one sequence per resistance protein. Variant alleles with synonymous mutations fail to perfectly match any element, and may have an alternate optimal DNA match. We saw this in our data with 9 occasions where ABRicate, KmerResistance and SRST2 identified imperfect matches to aph(3”)-Ib_2_AF024602 and ARIBA identified an imperfect match to aph(3”)-Ib_4_AF313472. However, the sequence they were matching to in the SPAdes and ARIBA assembly was a 100% identity and coverage protein match to aph(3”)-Ib_5_AF321551.</p></sec><sec id="S16"><title>Non-annotation related discrepancies</title><p id="P27">In addition to annotation discrepancies that were caused by bioinformatics algorithms, genotyping calls were also affected by partial/low coverage of AMR gene targets and assembly fragmentation, consistent with the results from simulations. While for some of these, such as the 1430 discrepancies more definitively described cut-off related discrepancies occurring <italic>in tet, mfs, aadA</italic>, and <italic>cat</italic> genes, each program identified the same section of sequence, making it clear that the different programs had different thresholds for reporting, other situations were less clear. To investigate this in detail, we examined beta-lactamase matches which were either partial/low coverage or occurred across fragmented assemblies.</p><p id="P28">Partial/low coverage beta-lactamase genes were discrepantly found in 39 isolates (<xref ref-type="supplementary-material" rid="SD1">Fig. S9</xref>), particularly affecting <italic>bla</italic><sub>TEM</sub>-like gene calls (29/39 cases). KmerResistance reported the presence of a beta-lactamase gene in all 39 of these discrepant cases, with calls supported to a varying degree by the other algorithms. However, in all but four cases, KmerResistance reported that the depth of the gene was less than 5x. For the four cases where the gene was present at greater than 5x depth as called by KmerResistance, three (present at depth &gt;100x) were omitted from ARIBA reports as ARIBA assemblies contained mis-sense mutations and the final one (present at depth 17x) failed to assemble for ABRicate.</p><p id="P29">Assembly fragmentation affected ABRicate and ARIBA beta-lactam resistance gene calls in 24 cases, with 16 of these likely to be due to the presence of multiple closely related beta-lactamase alleles thereby affecting assembly integrity. The possibility of heterozygous alleles was indicated by the ARIBA flag “variants_suggest_collapsed_repeat”, and the SRST2 “minor allele frequency value” was high (&gt;20%). KmerResistance reported two related alleles in 12/16 cases, one with high depth, percentage identity and coverage, and one much less accurately. This likely reflects KmerResistance’s winner-takes-all strategy, where matching unique k-mers to reference alleles are counted, and the reference allele with the most matches is then also assigned all reads with non-unique kmer-matches. This then leaves only reads with unique k-mers matching any closely related secondary allele, resulting in poor depth and coverage metrics.</p></sec></sec></sec><sec id="S17" sec-type="discussion"><label>7</label><title>Discussion</title><p id="P30">We evaluated the impact of bioinformatics approaches to AMR genotyping in <italic>E. coli</italic> for four commonly used methods and a widely used AMR gene database (ResFinder). Using &gt;50,000 simulations and comparing &gt;1,800 sequences sampled across human and animal reservoirs, thereby capturing common and rare AMR genotypes, we highlight that whilst currently available widely used genotyping methods are useful, their outputs should be carefully considered in light of our findings. Commonly postulated causes of discrepancy, such as low quality sequencing data, appeared to play little role. Instead, discrepancies were primarily artefactual, occurring because of different approaches in representing the complexity of the reference AMR gene database. Inconsistent labelling of gene variants will also affect the reliability of any catalogue-based methods for phenotypic prediction from WGS-based AMR genotypes. Specifically, predicting phenotype based on the presence of specific allelic variants will be clearly problematic without a reliable method of identification.</p><p id="P31">Our work agrees with previous findings by <italic>Doyle et al</italic>. on a small and selected dataset(<xref ref-type="bibr" rid="R13">13</xref>); however, we utilised large simulated and real-life datasets to identify these significant genotyping discrepancies between methods, and also characterized the underlying reasons for these discrepancies. We found most discrepancies were largely due to notation differences, i.e. each method identified the same consensus sequence but then named them differently. Further, many of these discrepancies are caused by implicit and frequently incorrect assumptions about database structure and AMR gene diversity, including that AMR genes can be classified in well-defined families using genetic identity, that different approaches to deciding best-matching alleles are equivalent, and that isolates will usually not harbor highly genetically related variants of the same AMR gene. However, nomenclature and family structure amongst AMR genes relevant to Enterobacterales is complicated, with highly diverse genotypes (and sometimes phenotypes) being assigned similar family names (e.g. <italic>bla</italic><sub>CTX-M</sub>, <italic>bla</italic><sub>OXA</sub>) and single SNPs in some cases leading to different resistance phenotypes (e.g. <italic>bla</italic><sub>TEM-1</sub> (Genbank: <bold>AY458016.1</bold>) - beta-lactamase inhibitor susceptible i.e. susceptible to amoxicllin-clavulanate, <italic>bla</italic><sub>TEM-30</sub> (Genbank: <bold>AJ437107.1</bold>) - beta-lactamase inhibitor resistant i.e.g resistant to amoxicillin-clavulanate). Given this, it is not surprising that we found methods that make fewer assumptions (e.g. KmerResistance) to be more robust. Based on our findings high accuracy resistance genotyping may require the use of multiple different methods to cross-check results, and/or a clear understanding of the specific assumptions underlying the methods used, before conclusions about allele presence are drawn.</p><p id="P32">One of the key strengths of this analysis was its combined use of both simulations and real world data. By using simulations, we were able to benchmark methods against a known truth, which is impossible to do with real-world data. Previous studies using only real-world data have attempted to overcome the absence of complete knowledge of the underlying genotype by using phenotypic data as a reference standard; however genotype-phenotype correlations remain poorly defined(<xref ref-type="bibr" rid="R10">10</xref>, <xref ref-type="bibr" rid="R19">19</xref>). By subsequently using a large sequencing dataset of isolates obtained across niches, we were then able to assess the extent of discrepancies in real-life, replicating the problems observed in simulated data.</p><p id="P33">A limitation of this work is that we chose not to evaluate the impact of database choice, and this will represent future work. Currently, as has been highlighted previously(<xref ref-type="bibr" rid="R24">24</xref>), there are discrepancies between the AMR databases in common use, with each having a slightly different scope and in some cases differential names for different AMR gene variants (e.g.<italic>str</italic>A vs <italic>aph</italic>(<italic>6)-Ia or aphD</italic>, and <italic>str</italic>B versus <italic>aph(<xref ref-type="bibr" rid="R6">6</xref>)-Id</italic>). Comparing databases would have therefore added significant further complexity whilst limiting the generalisability of findings. A further limitation stemming from our fixed choice of database is that we have not analysed any methods where the bioinformatic method and database are intertwined (e.g. ResFinder/PointFinder or RGI). As the interaction between tool and database was the cause of many issues, it is possible that methods that are database-specific will perform better. However, the drawbacks of these combined resources are their inflexibility, again limiting generalisability. A further limitation was that these genotyping algorithms were compared using an older version of the ResFinder database – the most up to date when this work was originally planned. Since this time, 70 sequences have been added, 2 sequences modified and 2 sequences deleted (See <xref ref-type="supplementary-material" rid="SD1">supplementary data</xref>). We opted not to re-perform the analysis due to its manual nature and that as most of the discrepancies relate to underlying principles behind the algorithms rather than the specific implementation. Finally, we have focused our evaluation on <italic>E. coli</italic>, but it is likely that these issues will also more widely affect AMR genotyping, particularly of similar species with complex genotypes.</p><p id="P34">While WGS-based approaches are attractive for both characterizing AMR gene epidemiology and representing a subsequent tool for resistance prediction, this work highlights the need for caution when interpreting resistance genotypes reported by even widely used bioinformatics methods. Before WGS-based approaches can be considered reliable for use in <italic>E. coli</italic> (and likely other Enterobacterales), particularly for clinical decision making or replacing phenotypic data to determine epidemiological trends, database standardisation, the development of novel genotyping approaches, and improved validation and evaluation will be required.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Material</label><media xlink:href="EMS177474-supplement-Supplementary_Material.docx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.wordprocessingml.document" id="d30aAdEbB" position="anchor"/></supplementary-material></sec></body><back><ack id="S18"><label>8.5</label><title>Acknowledgements</title><p>We are grateful to the microbiology laboratory teams at the John Radcliffe Hospital, Oxford, the Animal and Plant Health Agency, and UK Health Security Agency.</p><sec id="S19"><label>8.3</label><title>Funding information</title><p>The study was funded by the National Institute for Health Research Health Protection Research Unit (NIHR HPRU) in Healthcare Associated Infections and Antimicrobial Resistance at Oxford University in partnership with Public Health England (PHE) [NIHR200915]. DWC, TEAP, PWF and ASW are supported by the NIHR Oxford Biomedical Research Centre. The report presents independent research funded by the National Institute for Health Research. The views expressed in this publication are those of the authors and not necessarily those of the NHS, the National Institute for Health Research, the Department of Health or Public Health England. NS is an Oxford Martin Fellow and an NIHR Oxford BRC Senior Fellow. ASW is an NIHR Senior Investigator.</p></sec></ack><fn-group><label>8</label><title>Author statements</title><fn id="FN2" fn-type="con"><p id="P35"><bold>8.1 Authors and contributors</bold></p><p id="P36">TJD, NS, AES, ASW, DWC and TEAP conceptualised the study. TD, NS, ASW, AES and MFA decided the methodology. NS, ASW, MFA, AES, DWC and TEAP supervised the project. NS, MA, MFA, MJE, KH and SH acquired and curated the data used in this study. TJD and JSW constructed software pipelines to analyse sequencing data using each of the bioinformatic tools. TJD and ASW investigated the data. TJD performed the formal analysis. NS, AES, SL, HP, AES and TEAP assisted with interpreting the cause and impact of discrepancies. TJD and NS wrote the original draft. TJD, NS, AES, PWF, TEAP and ASW assisted with data visualisation. All authors were involved in the review and editing process.</p></fn><fn id="FN3" fn-type="conflict"><p id="P37"><bold>8.2 Conflicts of interest</bold></p><p id="P38">The authors have no conflicts of interest to declare.</p></fn><fn id="FN4"><p id="P39"><bold>8.4 Ethical approval</bold></p><p id="P40">Not applicable.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quainoo</surname><given-names>S</given-names></name><name><surname>Coolen</surname><given-names>JPM</given-names></name><name><surname>van Hijum</surname><given-names>S</given-names></name><name><surname>Huynen</surname><given-names>MA</given-names></name><name><surname>Melchers</surname><given-names>WJG</given-names></name><name><surname>van Schaik</surname><given-names>W</given-names></name><etal/></person-group><article-title>Whole-Genome Sequencing of Bacterial Pathogens: the Future of Nosocomial Outbreak Analysis</article-title><source>Clin Microbiol Rev</source><year>2017</year><volume>30</volume><issue>4</issue><fpage>1015</fpage><lpage>63</lpage><pub-id pub-id-type="pmcid">PMC5608882</pub-id><pub-id pub-id-type="pmid">28855266</pub-id><pub-id pub-id-type="doi">10.1128/CMR.00016-17</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quan</surname><given-names>TP</given-names></name><name><surname>Bawa</surname><given-names>Z</given-names></name><name><surname>Foster</surname><given-names>D</given-names></name><name><surname>Walker</surname><given-names>T</given-names></name><name><surname>Del Ojo Elias</surname><given-names>C</given-names></name><name><surname>Rathod</surname><given-names>P</given-names></name><etal/></person-group><article-title>Evaluation of Whole-Genome Sequencing for Mycobacterial Species Identification and Drug Susceptibility Testing in a Clinical Setting: a Large-Scale Prospective Assessment of Performance against Line Probe Assays and Phenotyping</article-title><source>J Clin Microbiol</source><year>2018</year><volume>56</volume><issue>2</issue><pub-id pub-id-type="pmcid">PMC5786738</pub-id><pub-id pub-id-type="pmid">29167290</pub-id><pub-id pub-id-type="doi">10.1128/JCM.01480-17</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bortolaia</surname><given-names>V</given-names></name><name><surname>Kaas</surname><given-names>RS</given-names></name><name><surname>Ruppe</surname><given-names>E</given-names></name><name><surname>Roberts</surname><given-names>MC</given-names></name><name><surname>Schwarz</surname><given-names>S</given-names></name><name><surname>Cattoir</surname><given-names>V</given-names></name><etal/></person-group><article-title>ResFinder 4.0 for predictions of phenotypes from genotypes</article-title><source>J Antimicrob Chemother</source><year>2020</year><volume>75</volume><issue>12</issue><fpage>3491</fpage><lpage>500</lpage><pub-id pub-id-type="pmcid">PMC7662176</pub-id><pub-id pub-id-type="pmid">32780112</pub-id><pub-id pub-id-type="doi">10.1093/jac/dkaa345</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alcock</surname><given-names>BP</given-names></name><name><surname>Raphenya</surname><given-names>AR</given-names></name><name><surname>Lau</surname><given-names>TTY</given-names></name><name><surname>Tsang</surname><given-names>KK</given-names></name><name><surname>Bouchard</surname><given-names>M</given-names></name><name><surname>Edalatmand</surname><given-names>A</given-names></name><etal/></person-group><article-title>CARD 2020: antibiotic resistome surveillance with the comprehensive antibiotic resistance database</article-title><source>Nucleic Acids Res</source><year>2020</year><volume>48</volume><issue>D1</issue><fpage>D517</fpage><lpage>d25</lpage><pub-id pub-id-type="pmcid">PMC7145624</pub-id><pub-id pub-id-type="pmid">31665441</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkz935</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feldgarden</surname><given-names>M</given-names></name><name><surname>Brover</surname><given-names>V</given-names></name><name><surname>Haft</surname><given-names>DH</given-names></name><name><surname>Prasad</surname><given-names>AB</given-names></name><name><surname>Slotta</surname><given-names>DJ</given-names></name><name><surname>Tolstoy</surname><given-names>I</given-names></name><etal/></person-group><article-title>Validating the AMRFinder Tool and Resistance Gene Database by Using Antimicrobial Resistance Genotype-Phenotype Correlations in a Collection of Isolates</article-title><source>Antimicrob Agents Chemother</source><year>2019</year><volume>63</volume><issue>11</issue><pub-id pub-id-type="pmcid">PMC6811410</pub-id><pub-id pub-id-type="pmid">31427293</pub-id><pub-id pub-id-type="doi">10.1128/AAC.00483-19</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname><given-names>M</given-names></name><name><surname>Mather</surname><given-names>AE</given-names></name><name><surname>Sánchez-Busó</surname><given-names>L</given-names></name><name><surname>Page</surname><given-names>AJ</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name><name><surname>Keane</surname><given-names>JA</given-names></name><etal/></person-group><article-title>ARIBA: rapid antimicrobial resistance genotyping directly from sequencing reads</article-title><source>Microb Genom</source><year>2017</year><volume>3</volume><issue>10</issue><elocation-id>e000131</elocation-id><pub-id pub-id-type="pmcid">PMC5695208</pub-id><pub-id pub-id-type="pmid">29177089</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000131</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inouye</surname><given-names>M</given-names></name><name><surname>Dashnow</surname><given-names>H</given-names></name><name><surname>Raven</surname><given-names>LA</given-names></name><name><surname>Schultz</surname><given-names>MB</given-names></name><name><surname>Pope</surname><given-names>BJ</given-names></name><name><surname>Tomita</surname><given-names>T</given-names></name><etal/></person-group><article-title>SRST2: Rapid genomic surveillance for public health and hospital microbiology labs</article-title><source>Genome medicine</source><year>2014</year><volume>6</volume><issue>11</issue><fpage>90</fpage><pub-id pub-id-type="pmcid">PMC4237778</pub-id><pub-id pub-id-type="pmid">25422674</pub-id><pub-id pub-id-type="doi">10.1186/s13073-014-0090-6</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clausen</surname><given-names>PT</given-names></name><name><surname>Zankari</surname><given-names>E</given-names></name><name><surname>Aarestrup</surname><given-names>FM</given-names></name><name><surname>Lund</surname><given-names>O</given-names></name></person-group><article-title>Benchmarking of methods for identification of antimicrobial resistance genes in bacterial whole genome data</article-title><source>J Antimicrob Chemother</source><year>2016</year><volume>71</volume><issue>9</issue><fpage>2484</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">27365186</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zankari</surname><given-names>E</given-names></name><name><surname>Allesøe</surname><given-names>R</given-names></name><name><surname>Joensen</surname><given-names>KG</given-names></name><name><surname>Cavaco</surname><given-names>LM</given-names></name><name><surname>Lund</surname><given-names>O</given-names></name><name><surname>Aarestrup</surname><given-names>FM</given-names></name></person-group><article-title>PointFinder: a novel web tool for WGS-based detection of antimicrobial resistance associated with chromosomal point mutations in bacterial pathogens</article-title><source>J Antimicrob Chemother</source><year>2017</year><volume>72</volume><issue>10</issue><fpage>2764</fpage><lpage>8</lpage><pub-id pub-id-type="pmcid">PMC5890747</pub-id><pub-id pub-id-type="pmid">29091202</pub-id><pub-id pub-id-type="doi">10.1093/jac/dkx217</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoesser</surname><given-names>N</given-names></name><name><surname>Batty</surname><given-names>EM</given-names></name><name><surname>Eyre</surname><given-names>DW</given-names></name><name><surname>Morgan</surname><given-names>M</given-names></name><name><surname>Wyllie</surname><given-names>DH</given-names></name><name><surname>Del Ojo Elias</surname><given-names>C</given-names></name><etal/></person-group><article-title>Predicting antimicrobial susceptibilities for Escherichia coli and Klebsiella pneumoniae isolates using whole genomic sequence data</article-title><source>J Antimicrob Chemother</source><year>2013</year><volume>68</volume><issue>10</issue><fpage>2234</fpage><lpage>44</lpage><pub-id pub-id-type="pmcid">PMC3772739</pub-id><pub-id pub-id-type="pmid">23722448</pub-id><pub-id pub-id-type="doi">10.1093/jac/dkt180</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shelburne</surname><given-names>SA</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Munita</surname><given-names>JM</given-names></name><name><surname>Sahasrabhojane</surname><given-names>P</given-names></name><name><surname>Shields</surname><given-names>RK</given-names></name><name><surname>Press</surname><given-names>EG</given-names></name><etal/></person-group><article-title>Whole-Genome Sequencing Accurately Identifies Resistance to Extended-Spectrum β-Lactams for Major Gram-Negative Bacterial Pathogens</article-title><source>Clin Infect Dis</source><year>2017</year><volume>65</volume><issue>5</issue><fpage>738</fpage><lpage>45</lpage><pub-id pub-id-type="pmcid">PMC5850535</pub-id><pub-id pub-id-type="pmid">28472260</pub-id><pub-id pub-id-type="doi">10.1093/cid/cix417</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stubberfield</surname><given-names>E</given-names></name><name><surname>AbuOun</surname><given-names>M</given-names></name><name><surname>Sayers</surname><given-names>E</given-names></name><name><surname>O’Connor</surname><given-names>HM</given-names></name><name><surname>Card</surname><given-names>RM</given-names></name><name><surname>Anjum</surname><given-names>MF</given-names></name></person-group><article-title>Use of whole genome sequencing of commensal Escherichia coli in pigs for antimicrobial resistance surveillance, United Kingdom, 2018</article-title><source>Euro Surveill</source><year>2019</year><volume>24</volume><issue>50</issue><pub-id pub-id-type="pmcid">PMC6918588</pub-id><pub-id pub-id-type="pmid">31847943</pub-id><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2019.24.50.1900136</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doyle</surname><given-names>RM</given-names></name><name><surname>O’Sullivan</surname><given-names>DM</given-names></name><name><surname>Aller</surname><given-names>SD</given-names></name><name><surname>Bruchmann</surname><given-names>S</given-names></name><name><surname>Clark</surname><given-names>T</given-names></name><name><surname>Coello Pelegrin</surname><given-names>A</given-names></name><etal/></person-group><article-title>Discordant bioinformatic predictions of antimicrobial resistance from whole-genome sequencing data of bacterial isolates: an inter-laboratory study</article-title><source>Microb Genom</source><year>2020</year><volume>6</volume><issue>2</issue><pub-id pub-id-type="pmcid">PMC7067211</pub-id><pub-id pub-id-type="pmid">32048983</pub-id><pub-id pub-id-type="doi">10.1099/mgen.0.000335</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><source>ABRicate</source><year>2020</year></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bankevich</surname><given-names>A</given-names></name><name><surname>Nurk</surname><given-names>S</given-names></name><name><surname>Antipov</surname><given-names>D</given-names></name><name><surname>Gurevich</surname><given-names>AA</given-names></name><name><surname>Dvorkin</surname><given-names>M</given-names></name><name><surname>Kulikov</surname><given-names>AS</given-names></name><etal/></person-group><article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title><source>J Comput Biol</source><year>2012</year><volume>19</volume><issue>5</issue><fpage>455</fpage><lpage>77</lpage><pub-id pub-id-type="pmcid">PMC3342519</pub-id><pub-id pub-id-type="pmid">22506599</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><etal/></person-group><article-title>Array programming with NumPy</article-title><source>Nature</source><year>2020</year><volume>585</volume><issue>7825</issue><fpage>357</fpage><lpage>62</lpage><pub-id pub-id-type="pmcid">PMC7759461</pub-id><pub-id pub-id-type="pmid">32939066</pub-id><pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJ</given-names></name><name><surname>Antao</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>JT</given-names></name><name><surname>Chapman</surname><given-names>BA</given-names></name><name><surname>Cox</surname><given-names>CJ</given-names></name><name><surname>Dalke</surname><given-names>A</given-names></name><etal/></person-group><article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>11</issue><fpage>1422</fpage><lpage>3</lpage><pub-id pub-id-type="pmcid">PMC2682512</pub-id><pub-id pub-id-type="pmid">19304878</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ellington</surname><given-names>MJ</given-names></name><name><surname>Ekelund</surname><given-names>O</given-names></name><name><surname>Aarestrup</surname><given-names>FM</given-names></name><name><surname>Canton</surname><given-names>R</given-names></name><name><surname>Doumith</surname><given-names>M</given-names></name><name><surname>Giske</surname><given-names>C</given-names></name><etal/></person-group><article-title>The role of whole genome sequencing in antimicrobial susceptibility testing of bacteria: report from the EUCAST Subcommittee</article-title><source>Clin Microbiol Infect</source><year>2017</year><volume>23</volume><issue>1</issue><fpage>2</fpage><lpage>22</lpage><pub-id pub-id-type="pmid">27890457</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname><given-names>TJ</given-names></name><name><surname>Stoesser</surname><given-names>N</given-names></name><name><surname>Sheppard</surname><given-names>AE</given-names></name><name><surname>Abuoun</surname><given-names>M</given-names></name><name><surname>Fowler</surname><given-names>P</given-names></name><name><surname>Swann</surname><given-names>J</given-names></name><etal/></person-group><article-title>Reconciling the Potentially Irreconcilable? Genotypic and Phenotypic Amoxicillin-Clavulanate Resistance in Escherichia coli</article-title><source>Antimicrob Agents Chemother</source><year>2020</year><volume>64</volume><issue>6</issue><pub-id pub-id-type="pmcid">PMC7269502</pub-id><pub-id pub-id-type="pmid">32205351</pub-id><pub-id pub-id-type="doi">10.1128/AAC.02026-19</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>AbuOun</surname><given-names>M</given-names></name><name><surname>O’Connor</surname><given-names>HM</given-names></name><name><surname>Stubberfield</surname><given-names>EJ</given-names></name><name><surname>Nunez-Garcia</surname><given-names>J</given-names></name><name><surname>Sayers</surname><given-names>E</given-names></name><name><surname>Crook</surname><given-names>DW</given-names></name><etal/></person-group><article-title>Characterizing Antimicrobial Resistant Escherichia coli and Associated Risk Factors in a Cross-Sectional Study of Pig Farms in Great Britain</article-title><source>Front Microbiol</source><year>2020</year><volume>11</volume><fpage>861</fpage><pub-id pub-id-type="pmcid">PMC7261845</pub-id><pub-id pub-id-type="pmid">32523560</pub-id><pub-id pub-id-type="doi">10.3389/fmicb.2020.00861</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zerbino</surname><given-names>DR</given-names></name></person-group><article-title>Using the Velvet de novo assembler for short-read sequencing technologies</article-title><source>Curr Protoc Bioinformatics</source><year>2010</year><comment>Chapter 11:Unit 11 5</comment><pub-id pub-id-type="pmcid">PMC2952100</pub-id><pub-id pub-id-type="pmid">20836074</pub-id><pub-id pub-id-type="doi">10.1002/0471250953.bi1105s31</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stoesser</surname><given-names>N</given-names></name><name><surname>Sheppard</surname><given-names>AE</given-names></name><name><surname>Peirano</surname><given-names>G</given-names></name><name><surname>Anson</surname><given-names>LW</given-names></name><name><surname>Pankhurst</surname><given-names>L</given-names></name><name><surname>Sebra</surname><given-names>R</given-names></name><etal/></person-group><article-title>Genomic epidemiology of global Klebsiella pneumoniae carbapenemase (KPC)-producing Escherichia coli</article-title><source>Sci Rep</source><year>2017</year><volume>7</volume><issue>1</issue><elocation-id>5917</elocation-id><pub-id pub-id-type="pmcid">PMC5517641</pub-id><pub-id pub-id-type="pmid">28725045</pub-id><pub-id pub-id-type="doi">10.1038/s41598-017-06256-2</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wirth</surname><given-names>T</given-names></name><name><surname>Falush</surname><given-names>D</given-names></name><name><surname>Lan</surname><given-names>R</given-names></name><name><surname>Colles</surname><given-names>F</given-names></name><name><surname>Mensa</surname><given-names>P</given-names></name><name><surname>Wieler</surname><given-names>LH</given-names></name><etal/></person-group><article-title>Sex and virulence in Escherichia coli: an evolutionary perspective</article-title><source>Mol Microbiol</source><year>2006</year><volume>60</volume><issue>5</issue><fpage>1136</fpage><lpage>51</lpage><pub-id pub-id-type="pmcid">PMC1557465</pub-id><pub-id pub-id-type="pmid">16689791</pub-id><pub-id pub-id-type="doi">10.1111/j.1365-2958.2006.05172.x</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McArthur</surname><given-names>AG</given-names></name><name><surname>Tsang</surname><given-names>KK</given-names></name></person-group><article-title>Antimicrobial resistance surveillance in the genomic age</article-title><source>Ann N Y Acad Sci</source><year>2017</year><volume>1388</volume><issue>1</issue><fpage>78</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">27875856</pub-id></element-citation></ref></ref-list></back><floats-group><boxed-text id="BX1" position="float" orientation="portrait"><label>3</label><caption><title>Impact statement</title></caption><p>Whole-genome sequencing is widely used for studying the epidemiology of antimicrobial resistance (AMR) genes in bacteria; however, there is some concern that outputs are highly dependent on the bioinformatics methods used. This work evaluates these concerns in detail by comparing four different, commonly used AMR gene typing methods using large simulated and real datasets. The results highlight performance issues for most methods in at least one of several simulated and real-life scenarios. However most discrepancies between methods were due to differential labelling of the same sequences related to the assumptions made regarding the underlying structure of the reference resistance gene database used (i.e. that resistance genes can be easily classified in well-defined groups). This study represents a major advance in quantifying and evaluating the nature of discrepancies between outputs of different AMR typing algorithms, with relevance for historic and future work using these algorithms. Some of the discrepancies can be resolved by choosing methods with fewer assumptions about the reference AMR gene database and manually resolving outputs generated using multiple programs. However, ideally new and better methods are needed.</p></boxed-text><fig id="F1" position="float"><label>Figure 1</label><caption><title>Methods to identify discrepancies.</title></caption><graphic xlink:href="EMS177474-f001"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><title>Identification of known single AMR gene variants in simulated contexts by bioinformatic method.</title><p>Note only cases where one or more methods were incorrect are shown (n=1,081). * signifies where genes were variably correctly identified across 10 repeats.</p></caption><graphic xlink:href="EMS177474-f002"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><title>Proportion of correct genotype calls for single AMR gene variants in simulated constructs by coverage depth and bioinformatics method.</title></caption><graphic xlink:href="EMS177474-f003"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><title>Gene identification concordance vs allele identification concordance.</title><p>Note panel a) the number isolates containing at least allele of the named genes (x-axis) stratified by method. Panel b) what proportion of all times a given gene was identified did the four methods agree, e.g. for every time <italic>bla</italic><sub>SHV</sub> it was discordantly reported by the four bioinformatic methods. Panel c) pairwise agreement between the different methods across all isolates.</p></caption><graphic xlink:href="EMS177474-f004"/></fig><fig id="F5" position="float"><label>Figure 5</label><caption><title>Genotype calls produced by a single method only, stratified by antibiotic class.</title></caption><graphic xlink:href="EMS177474-f005"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><title>Genotyping agreement across all four bioinformatics algorithms evaluated, stratified by gene.</title><p>Note colours on the left indicate which methods eed with one another, with circles the same colour indicating agreement. Colours in the main panel of the figure were used to identify the cause of the crepancy, as denoted in the figure key.. Cells (in the figure) were coloured if &gt; 90% of isolates were caused by a given discrepancy. Cells with less 10 lates were not investigated.</p></caption><graphic xlink:href="EMS177474-f006"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><title>Performance of genotyping methods in evaluating simulated constructs with two related allelic variants.</title><p>Percentage reported out of a total of 46,318 simulations performed for each method.</p></caption><table frame="box" rules="all"><thead><tr><th align="left" valign="top"/><th align="left" valign="top" colspan="4">Number of calls (%)</th></tr><tr><th align="left" valign="top">Genotyping call</th><th align="left" valign="top">ABRicate</th><th align="left" valign="top">ARIBA</th><th align="left" valign="top">KmerResistance</th><th align="left" valign="top">SRST2</th></tr></thead><tbody><tr><td align="left" valign="top">No correct calls</td><td align="left" valign="top">6355 (14%)</td><td align="left" valign="top">29571 (64%)</td><td align="left" valign="top">1795 (4%)</td><td align="left" valign="top">10298 (22%)</td></tr><tr><td align="left" valign="top">One correct call but additional incorrect calls</td><td align="left" valign="top">21012 (45%)</td><td align="left" valign="top">164 (&lt;1%)</td><td align="left" valign="top">1028 (2%)</td><td align="left" valign="top">184 (&lt;1%)</td></tr><tr><td align="left" valign="top">One correct call, no incorrect calls</td><td align="left" valign="top">415 (1%)</td><td align="left" valign="top">14500 (31%)</td><td align="left" valign="top">8150 (18%)</td><td align="left" valign="top">33319 (72%)</td></tr><tr><td align="left" valign="top">Two correct calls, but additional incorrect calls</td><td align="left" valign="top">6712 (14%)</td><td align="left" valign="top">404 (1%)</td><td align="left" valign="top">7 (&lt;1%)</td><td align="left" valign="top">517 (1%)</td></tr><tr><td align="left" valign="top">Two correct calls, no incorrect calls</td><td align="left" valign="top">11842 (26%)</td><td align="left" valign="top">1679 (4%)</td><td align="left" valign="top">35338 (76%)</td><td align="left" valign="top">2000 (4%)</td></tr></tbody></table></table-wrap></floats-group></article>